var km=Object.defineProperty;var Sm=(e,t,n)=>t in e?km(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var qt=(e,t,n)=>(Sm(e,typeof t!="symbol"?t+"":t,n),n);import{aa as qf,ab as Pm,l as es,a4 as Hs,C as xe,a7 as gi,R as Mf,a6 as Cm}from"./entry.39ed7a28.js";import{b as Bm,r as Df,e as Bl,c as Ut,d as Em,a as id,u as Lf,n as Dn,f as ri,T as _t,i as Im,S as Om,I as Rm,s as El,t as $m,g as Um}from"./sha256.0cfe4195.js";import{D as it}from"./decimal.0bdeb344.js";var no={},qm={get exports(){return no},set exports(e){no=e}};(function(e){(function(t){var n=function(w){var C,B=new Float64Array(16);if(w)for(C=0;C<w.length;C++)B[C]=w[C];return B},i=function(){throw new Error("no PRNG")},o=new Uint8Array(16),s=new Uint8Array(32);s[0]=9;var r=n(),a=n([1]),c=n([56129,1]),u=n([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),l=n([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),d=n([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),h=n([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),g=n([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function b(w,C,B,p){w[C]=B>>24&255,w[C+1]=B>>16&255,w[C+2]=B>>8&255,w[C+3]=B&255,w[C+4]=p>>24&255,w[C+5]=p>>16&255,w[C+6]=p>>8&255,w[C+7]=p&255}function v(w,C,B,p,O){var Q,Z=0;for(Q=0;Q<O;Q++)Z|=w[C+Q]^B[p+Q];return(1&Z-1>>>8)-1}function x(w,C,B,p){return v(w,C,B,p,16)}function P(w,C,B,p){return v(w,C,B,p,32)}function E(w,C,B,p){for(var O=p[0]&255|(p[1]&255)<<8|(p[2]&255)<<16|(p[3]&255)<<24,Q=B[0]&255|(B[1]&255)<<8|(B[2]&255)<<16|(B[3]&255)<<24,Z=B[4]&255|(B[5]&255)<<8|(B[6]&255)<<16|(B[7]&255)<<24,lt=B[8]&255|(B[9]&255)<<8|(B[10]&255)<<16|(B[11]&255)<<24,kt=B[12]&255|(B[13]&255)<<8|(B[14]&255)<<16|(B[15]&255)<<24,It=p[4]&255|(p[5]&255)<<8|(p[6]&255)<<16|(p[7]&255)<<24,St=C[0]&255|(C[1]&255)<<8|(C[2]&255)<<16|(C[3]&255)<<24,Ve=C[4]&255|(C[5]&255)<<8|(C[6]&255)<<16|(C[7]&255)<<24,Lt=C[8]&255|(C[9]&255)<<8|(C[10]&255)<<16|(C[11]&255)<<24,pe=C[12]&255|(C[13]&255)<<8|(C[14]&255)<<16|(C[15]&255)<<24,_e=p[8]&255|(p[9]&255)<<8|(p[10]&255)<<16|(p[11]&255)<<24,Ae=B[16]&255|(B[17]&255)<<8|(B[18]&255)<<16|(B[19]&255)<<24,ve=B[20]&255|(B[21]&255)<<8|(B[22]&255)<<16|(B[23]&255)<<24,me=B[24]&255|(B[25]&255)<<8|(B[26]&255)<<16|(B[27]&255)<<24,be=B[28]&255|(B[29]&255)<<8|(B[30]&255)<<16|(B[31]&255)<<24,ye=p[12]&255|(p[13]&255)<<8|(p[14]&255)<<16|(p[15]&255)<<24,Ft=O,Xt=Q,Dt=Z,zt=lt,Ht=kt,$t=It,st=St,rt=Ve,wt=Lt,pt=pe,gt=_e,xt=Ae,de=ve,Re=me,qe=be,$e=ye,H,je=0;je<20;je+=2)H=Ft+de|0,Ht^=H<<7|H>>>32-7,H=Ht+Ft|0,wt^=H<<9|H>>>32-9,H=wt+Ht|0,de^=H<<13|H>>>32-13,H=de+wt|0,Ft^=H<<18|H>>>32-18,H=$t+Xt|0,pt^=H<<7|H>>>32-7,H=pt+$t|0,Re^=H<<9|H>>>32-9,H=Re+pt|0,Xt^=H<<13|H>>>32-13,H=Xt+Re|0,$t^=H<<18|H>>>32-18,H=gt+st|0,qe^=H<<7|H>>>32-7,H=qe+gt|0,Dt^=H<<9|H>>>32-9,H=Dt+qe|0,st^=H<<13|H>>>32-13,H=st+Dt|0,gt^=H<<18|H>>>32-18,H=$e+xt|0,zt^=H<<7|H>>>32-7,H=zt+$e|0,rt^=H<<9|H>>>32-9,H=rt+zt|0,xt^=H<<13|H>>>32-13,H=xt+rt|0,$e^=H<<18|H>>>32-18,H=Ft+zt|0,Xt^=H<<7|H>>>32-7,H=Xt+Ft|0,Dt^=H<<9|H>>>32-9,H=Dt+Xt|0,zt^=H<<13|H>>>32-13,H=zt+Dt|0,Ft^=H<<18|H>>>32-18,H=$t+Ht|0,st^=H<<7|H>>>32-7,H=st+$t|0,rt^=H<<9|H>>>32-9,H=rt+st|0,Ht^=H<<13|H>>>32-13,H=Ht+rt|0,$t^=H<<18|H>>>32-18,H=gt+pt|0,xt^=H<<7|H>>>32-7,H=xt+gt|0,wt^=H<<9|H>>>32-9,H=wt+xt|0,pt^=H<<13|H>>>32-13,H=pt+wt|0,gt^=H<<18|H>>>32-18,H=$e+qe|0,de^=H<<7|H>>>32-7,H=de+$e|0,Re^=H<<9|H>>>32-9,H=Re+de|0,qe^=H<<13|H>>>32-13,H=qe+Re|0,$e^=H<<18|H>>>32-18;Ft=Ft+O|0,Xt=Xt+Q|0,Dt=Dt+Z|0,zt=zt+lt|0,Ht=Ht+kt|0,$t=$t+It|0,st=st+St|0,rt=rt+Ve|0,wt=wt+Lt|0,pt=pt+pe|0,gt=gt+_e|0,xt=xt+Ae|0,de=de+ve|0,Re=Re+me|0,qe=qe+be|0,$e=$e+ye|0,w[0]=Ft>>>0&255,w[1]=Ft>>>8&255,w[2]=Ft>>>16&255,w[3]=Ft>>>24&255,w[4]=Xt>>>0&255,w[5]=Xt>>>8&255,w[6]=Xt>>>16&255,w[7]=Xt>>>24&255,w[8]=Dt>>>0&255,w[9]=Dt>>>8&255,w[10]=Dt>>>16&255,w[11]=Dt>>>24&255,w[12]=zt>>>0&255,w[13]=zt>>>8&255,w[14]=zt>>>16&255,w[15]=zt>>>24&255,w[16]=Ht>>>0&255,w[17]=Ht>>>8&255,w[18]=Ht>>>16&255,w[19]=Ht>>>24&255,w[20]=$t>>>0&255,w[21]=$t>>>8&255,w[22]=$t>>>16&255,w[23]=$t>>>24&255,w[24]=st>>>0&255,w[25]=st>>>8&255,w[26]=st>>>16&255,w[27]=st>>>24&255,w[28]=rt>>>0&255,w[29]=rt>>>8&255,w[30]=rt>>>16&255,w[31]=rt>>>24&255,w[32]=wt>>>0&255,w[33]=wt>>>8&255,w[34]=wt>>>16&255,w[35]=wt>>>24&255,w[36]=pt>>>0&255,w[37]=pt>>>8&255,w[38]=pt>>>16&255,w[39]=pt>>>24&255,w[40]=gt>>>0&255,w[41]=gt>>>8&255,w[42]=gt>>>16&255,w[43]=gt>>>24&255,w[44]=xt>>>0&255,w[45]=xt>>>8&255,w[46]=xt>>>16&255,w[47]=xt>>>24&255,w[48]=de>>>0&255,w[49]=de>>>8&255,w[50]=de>>>16&255,w[51]=de>>>24&255,w[52]=Re>>>0&255,w[53]=Re>>>8&255,w[54]=Re>>>16&255,w[55]=Re>>>24&255,w[56]=qe>>>0&255,w[57]=qe>>>8&255,w[58]=qe>>>16&255,w[59]=qe>>>24&255,w[60]=$e>>>0&255,w[61]=$e>>>8&255,w[62]=$e>>>16&255,w[63]=$e>>>24&255}function S(w,C,B,p){for(var O=p[0]&255|(p[1]&255)<<8|(p[2]&255)<<16|(p[3]&255)<<24,Q=B[0]&255|(B[1]&255)<<8|(B[2]&255)<<16|(B[3]&255)<<24,Z=B[4]&255|(B[5]&255)<<8|(B[6]&255)<<16|(B[7]&255)<<24,lt=B[8]&255|(B[9]&255)<<8|(B[10]&255)<<16|(B[11]&255)<<24,kt=B[12]&255|(B[13]&255)<<8|(B[14]&255)<<16|(B[15]&255)<<24,It=p[4]&255|(p[5]&255)<<8|(p[6]&255)<<16|(p[7]&255)<<24,St=C[0]&255|(C[1]&255)<<8|(C[2]&255)<<16|(C[3]&255)<<24,Ve=C[4]&255|(C[5]&255)<<8|(C[6]&255)<<16|(C[7]&255)<<24,Lt=C[8]&255|(C[9]&255)<<8|(C[10]&255)<<16|(C[11]&255)<<24,pe=C[12]&255|(C[13]&255)<<8|(C[14]&255)<<16|(C[15]&255)<<24,_e=p[8]&255|(p[9]&255)<<8|(p[10]&255)<<16|(p[11]&255)<<24,Ae=B[16]&255|(B[17]&255)<<8|(B[18]&255)<<16|(B[19]&255)<<24,ve=B[20]&255|(B[21]&255)<<8|(B[22]&255)<<16|(B[23]&255)<<24,me=B[24]&255|(B[25]&255)<<8|(B[26]&255)<<16|(B[27]&255)<<24,be=B[28]&255|(B[29]&255)<<8|(B[30]&255)<<16|(B[31]&255)<<24,ye=p[12]&255|(p[13]&255)<<8|(p[14]&255)<<16|(p[15]&255)<<24,Ft=O,Xt=Q,Dt=Z,zt=lt,Ht=kt,$t=It,st=St,rt=Ve,wt=Lt,pt=pe,gt=_e,xt=Ae,de=ve,Re=me,qe=be,$e=ye,H,je=0;je<20;je+=2)H=Ft+de|0,Ht^=H<<7|H>>>32-7,H=Ht+Ft|0,wt^=H<<9|H>>>32-9,H=wt+Ht|0,de^=H<<13|H>>>32-13,H=de+wt|0,Ft^=H<<18|H>>>32-18,H=$t+Xt|0,pt^=H<<7|H>>>32-7,H=pt+$t|0,Re^=H<<9|H>>>32-9,H=Re+pt|0,Xt^=H<<13|H>>>32-13,H=Xt+Re|0,$t^=H<<18|H>>>32-18,H=gt+st|0,qe^=H<<7|H>>>32-7,H=qe+gt|0,Dt^=H<<9|H>>>32-9,H=Dt+qe|0,st^=H<<13|H>>>32-13,H=st+Dt|0,gt^=H<<18|H>>>32-18,H=$e+xt|0,zt^=H<<7|H>>>32-7,H=zt+$e|0,rt^=H<<9|H>>>32-9,H=rt+zt|0,xt^=H<<13|H>>>32-13,H=xt+rt|0,$e^=H<<18|H>>>32-18,H=Ft+zt|0,Xt^=H<<7|H>>>32-7,H=Xt+Ft|0,Dt^=H<<9|H>>>32-9,H=Dt+Xt|0,zt^=H<<13|H>>>32-13,H=zt+Dt|0,Ft^=H<<18|H>>>32-18,H=$t+Ht|0,st^=H<<7|H>>>32-7,H=st+$t|0,rt^=H<<9|H>>>32-9,H=rt+st|0,Ht^=H<<13|H>>>32-13,H=Ht+rt|0,$t^=H<<18|H>>>32-18,H=gt+pt|0,xt^=H<<7|H>>>32-7,H=xt+gt|0,wt^=H<<9|H>>>32-9,H=wt+xt|0,pt^=H<<13|H>>>32-13,H=pt+wt|0,gt^=H<<18|H>>>32-18,H=$e+qe|0,de^=H<<7|H>>>32-7,H=de+$e|0,Re^=H<<9|H>>>32-9,H=Re+de|0,qe^=H<<13|H>>>32-13,H=qe+Re|0,$e^=H<<18|H>>>32-18;w[0]=Ft>>>0&255,w[1]=Ft>>>8&255,w[2]=Ft>>>16&255,w[3]=Ft>>>24&255,w[4]=$t>>>0&255,w[5]=$t>>>8&255,w[6]=$t>>>16&255,w[7]=$t>>>24&255,w[8]=gt>>>0&255,w[9]=gt>>>8&255,w[10]=gt>>>16&255,w[11]=gt>>>24&255,w[12]=$e>>>0&255,w[13]=$e>>>8&255,w[14]=$e>>>16&255,w[15]=$e>>>24&255,w[16]=st>>>0&255,w[17]=st>>>8&255,w[18]=st>>>16&255,w[19]=st>>>24&255,w[20]=rt>>>0&255,w[21]=rt>>>8&255,w[22]=rt>>>16&255,w[23]=rt>>>24&255,w[24]=wt>>>0&255,w[25]=wt>>>8&255,w[26]=wt>>>16&255,w[27]=wt>>>24&255,w[28]=pt>>>0&255,w[29]=pt>>>8&255,w[30]=pt>>>16&255,w[31]=pt>>>24&255}function T(w,C,B,p){E(w,C,B,p)}function R(w,C,B,p){S(w,C,B,p)}var K=new Uint8Array([101,120,112,97,110,100,32,51,50,45,98,121,116,101,32,107]);function V(w,C,B,p,O,Q,Z){var lt=new Uint8Array(16),kt=new Uint8Array(64),It,St;for(St=0;St<16;St++)lt[St]=0;for(St=0;St<8;St++)lt[St]=Q[St];for(;O>=64;){for(T(kt,lt,Z,K),St=0;St<64;St++)w[C+St]=B[p+St]^kt[St];for(It=1,St=8;St<16;St++)It=It+(lt[St]&255)|0,lt[St]=It&255,It>>>=8;O-=64,C+=64,p+=64}if(O>0)for(T(kt,lt,Z,K),St=0;St<O;St++)w[C+St]=B[p+St]^kt[St];return 0}function W(w,C,B,p,O){var Q=new Uint8Array(16),Z=new Uint8Array(64),lt,kt;for(kt=0;kt<16;kt++)Q[kt]=0;for(kt=0;kt<8;kt++)Q[kt]=p[kt];for(;B>=64;){for(T(Z,Q,O,K),kt=0;kt<64;kt++)w[C+kt]=Z[kt];for(lt=1,kt=8;kt<16;kt++)lt=lt+(Q[kt]&255)|0,Q[kt]=lt&255,lt>>>=8;B-=64,C+=64}if(B>0)for(T(Z,Q,O,K),kt=0;kt<B;kt++)w[C+kt]=Z[kt];return 0}function tt(w,C,B,p,O){var Q=new Uint8Array(32);R(Q,p,O,K);for(var Z=new Uint8Array(8),lt=0;lt<8;lt++)Z[lt]=p[lt+16];return W(w,C,B,Z,Q)}function j(w,C,B,p,O,Q,Z){var lt=new Uint8Array(32);R(lt,Q,Z,K);for(var kt=new Uint8Array(8),It=0;It<8;It++)kt[It]=Q[It+16];return V(w,C,B,p,O,kt,lt)}var $=function(w){this.buffer=new Uint8Array(16),this.r=new Uint16Array(10),this.h=new Uint16Array(10),this.pad=new Uint16Array(8),this.leftover=0,this.fin=0;var C,B,p,O,Q,Z,lt,kt;C=w[0]&255|(w[1]&255)<<8,this.r[0]=C&8191,B=w[2]&255|(w[3]&255)<<8,this.r[1]=(C>>>13|B<<3)&8191,p=w[4]&255|(w[5]&255)<<8,this.r[2]=(B>>>10|p<<6)&7939,O=w[6]&255|(w[7]&255)<<8,this.r[3]=(p>>>7|O<<9)&8191,Q=w[8]&255|(w[9]&255)<<8,this.r[4]=(O>>>4|Q<<12)&255,this.r[5]=Q>>>1&8190,Z=w[10]&255|(w[11]&255)<<8,this.r[6]=(Q>>>14|Z<<2)&8191,lt=w[12]&255|(w[13]&255)<<8,this.r[7]=(Z>>>11|lt<<5)&8065,kt=w[14]&255|(w[15]&255)<<8,this.r[8]=(lt>>>8|kt<<8)&8191,this.r[9]=kt>>>5&127,this.pad[0]=w[16]&255|(w[17]&255)<<8,this.pad[1]=w[18]&255|(w[19]&255)<<8,this.pad[2]=w[20]&255|(w[21]&255)<<8,this.pad[3]=w[22]&255|(w[23]&255)<<8,this.pad[4]=w[24]&255|(w[25]&255)<<8,this.pad[5]=w[26]&255|(w[27]&255)<<8,this.pad[6]=w[28]&255|(w[29]&255)<<8,this.pad[7]=w[30]&255|(w[31]&255)<<8};$.prototype.blocks=function(w,C,B){for(var p=this.fin?0:2048,O,Q,Z,lt,kt,It,St,Ve,Lt,pe,_e,Ae,ve,me,be,ye,Ft,Xt,Dt,zt=this.h[0],Ht=this.h[1],$t=this.h[2],st=this.h[3],rt=this.h[4],wt=this.h[5],pt=this.h[6],gt=this.h[7],xt=this.h[8],de=this.h[9],Re=this.r[0],qe=this.r[1],$e=this.r[2],H=this.r[3],je=this.r[4],on=this.r[5],sn=this.r[6],De=this.r[7],tn=this.r[8],en=this.r[9];B>=16;)O=w[C+0]&255|(w[C+1]&255)<<8,zt+=O&8191,Q=w[C+2]&255|(w[C+3]&255)<<8,Ht+=(O>>>13|Q<<3)&8191,Z=w[C+4]&255|(w[C+5]&255)<<8,$t+=(Q>>>10|Z<<6)&8191,lt=w[C+6]&255|(w[C+7]&255)<<8,st+=(Z>>>7|lt<<9)&8191,kt=w[C+8]&255|(w[C+9]&255)<<8,rt+=(lt>>>4|kt<<12)&8191,wt+=kt>>>1&8191,It=w[C+10]&255|(w[C+11]&255)<<8,pt+=(kt>>>14|It<<2)&8191,St=w[C+12]&255|(w[C+13]&255)<<8,gt+=(It>>>11|St<<5)&8191,Ve=w[C+14]&255|(w[C+15]&255)<<8,xt+=(St>>>8|Ve<<8)&8191,de+=Ve>>>5|p,Lt=0,pe=Lt,pe+=zt*Re,pe+=Ht*(5*en),pe+=$t*(5*tn),pe+=st*(5*De),pe+=rt*(5*sn),Lt=pe>>>13,pe&=8191,pe+=wt*(5*on),pe+=pt*(5*je),pe+=gt*(5*H),pe+=xt*(5*$e),pe+=de*(5*qe),Lt+=pe>>>13,pe&=8191,_e=Lt,_e+=zt*qe,_e+=Ht*Re,_e+=$t*(5*en),_e+=st*(5*tn),_e+=rt*(5*De),Lt=_e>>>13,_e&=8191,_e+=wt*(5*sn),_e+=pt*(5*on),_e+=gt*(5*je),_e+=xt*(5*H),_e+=de*(5*$e),Lt+=_e>>>13,_e&=8191,Ae=Lt,Ae+=zt*$e,Ae+=Ht*qe,Ae+=$t*Re,Ae+=st*(5*en),Ae+=rt*(5*tn),Lt=Ae>>>13,Ae&=8191,Ae+=wt*(5*De),Ae+=pt*(5*sn),Ae+=gt*(5*on),Ae+=xt*(5*je),Ae+=de*(5*H),Lt+=Ae>>>13,Ae&=8191,ve=Lt,ve+=zt*H,ve+=Ht*$e,ve+=$t*qe,ve+=st*Re,ve+=rt*(5*en),Lt=ve>>>13,ve&=8191,ve+=wt*(5*tn),ve+=pt*(5*De),ve+=gt*(5*sn),ve+=xt*(5*on),ve+=de*(5*je),Lt+=ve>>>13,ve&=8191,me=Lt,me+=zt*je,me+=Ht*H,me+=$t*$e,me+=st*qe,me+=rt*Re,Lt=me>>>13,me&=8191,me+=wt*(5*en),me+=pt*(5*tn),me+=gt*(5*De),me+=xt*(5*sn),me+=de*(5*on),Lt+=me>>>13,me&=8191,be=Lt,be+=zt*on,be+=Ht*je,be+=$t*H,be+=st*$e,be+=rt*qe,Lt=be>>>13,be&=8191,be+=wt*Re,be+=pt*(5*en),be+=gt*(5*tn),be+=xt*(5*De),be+=de*(5*sn),Lt+=be>>>13,be&=8191,ye=Lt,ye+=zt*sn,ye+=Ht*on,ye+=$t*je,ye+=st*H,ye+=rt*$e,Lt=ye>>>13,ye&=8191,ye+=wt*qe,ye+=pt*Re,ye+=gt*(5*en),ye+=xt*(5*tn),ye+=de*(5*De),Lt+=ye>>>13,ye&=8191,Ft=Lt,Ft+=zt*De,Ft+=Ht*sn,Ft+=$t*on,Ft+=st*je,Ft+=rt*H,Lt=Ft>>>13,Ft&=8191,Ft+=wt*$e,Ft+=pt*qe,Ft+=gt*Re,Ft+=xt*(5*en),Ft+=de*(5*tn),Lt+=Ft>>>13,Ft&=8191,Xt=Lt,Xt+=zt*tn,Xt+=Ht*De,Xt+=$t*sn,Xt+=st*on,Xt+=rt*je,Lt=Xt>>>13,Xt&=8191,Xt+=wt*H,Xt+=pt*$e,Xt+=gt*qe,Xt+=xt*Re,Xt+=de*(5*en),Lt+=Xt>>>13,Xt&=8191,Dt=Lt,Dt+=zt*en,Dt+=Ht*tn,Dt+=$t*De,Dt+=st*sn,Dt+=rt*on,Lt=Dt>>>13,Dt&=8191,Dt+=wt*je,Dt+=pt*H,Dt+=gt*$e,Dt+=xt*qe,Dt+=de*Re,Lt+=Dt>>>13,Dt&=8191,Lt=(Lt<<2)+Lt|0,Lt=Lt+pe|0,pe=Lt&8191,Lt=Lt>>>13,_e+=Lt,zt=pe,Ht=_e,$t=Ae,st=ve,rt=me,wt=be,pt=ye,gt=Ft,xt=Xt,de=Dt,C+=16,B-=16;this.h[0]=zt,this.h[1]=Ht,this.h[2]=$t,this.h[3]=st,this.h[4]=rt,this.h[5]=wt,this.h[6]=pt,this.h[7]=gt,this.h[8]=xt,this.h[9]=de},$.prototype.finish=function(w,C){var B=new Uint16Array(10),p,O,Q,Z;if(this.leftover){for(Z=this.leftover,this.buffer[Z++]=1;Z<16;Z++)this.buffer[Z]=0;this.fin=1,this.blocks(this.buffer,0,16)}for(p=this.h[1]>>>13,this.h[1]&=8191,Z=2;Z<10;Z++)this.h[Z]+=p,p=this.h[Z]>>>13,this.h[Z]&=8191;for(this.h[0]+=p*5,p=this.h[0]>>>13,this.h[0]&=8191,this.h[1]+=p,p=this.h[1]>>>13,this.h[1]&=8191,this.h[2]+=p,B[0]=this.h[0]+5,p=B[0]>>>13,B[0]&=8191,Z=1;Z<10;Z++)B[Z]=this.h[Z]+p,p=B[Z]>>>13,B[Z]&=8191;for(B[9]-=8192,O=(p^1)-1,Z=0;Z<10;Z++)B[Z]&=O;for(O=~O,Z=0;Z<10;Z++)this.h[Z]=this.h[Z]&O|B[Z];for(this.h[0]=(this.h[0]|this.h[1]<<13)&65535,this.h[1]=(this.h[1]>>>3|this.h[2]<<10)&65535,this.h[2]=(this.h[2]>>>6|this.h[3]<<7)&65535,this.h[3]=(this.h[3]>>>9|this.h[4]<<4)&65535,this.h[4]=(this.h[4]>>>12|this.h[5]<<1|this.h[6]<<14)&65535,this.h[5]=(this.h[6]>>>2|this.h[7]<<11)&65535,this.h[6]=(this.h[7]>>>5|this.h[8]<<8)&65535,this.h[7]=(this.h[8]>>>8|this.h[9]<<5)&65535,Q=this.h[0]+this.pad[0],this.h[0]=Q&65535,Z=1;Z<8;Z++)Q=(this.h[Z]+this.pad[Z]|0)+(Q>>>16)|0,this.h[Z]=Q&65535;w[C+0]=this.h[0]>>>0&255,w[C+1]=this.h[0]>>>8&255,w[C+2]=this.h[1]>>>0&255,w[C+3]=this.h[1]>>>8&255,w[C+4]=this.h[2]>>>0&255,w[C+5]=this.h[2]>>>8&255,w[C+6]=this.h[3]>>>0&255,w[C+7]=this.h[3]>>>8&255,w[C+8]=this.h[4]>>>0&255,w[C+9]=this.h[4]>>>8&255,w[C+10]=this.h[5]>>>0&255,w[C+11]=this.h[5]>>>8&255,w[C+12]=this.h[6]>>>0&255,w[C+13]=this.h[6]>>>8&255,w[C+14]=this.h[7]>>>0&255,w[C+15]=this.h[7]>>>8&255},$.prototype.update=function(w,C,B){var p,O;if(this.leftover){for(O=16-this.leftover,O>B&&(O=B),p=0;p<O;p++)this.buffer[this.leftover+p]=w[C+p];if(B-=O,C+=O,this.leftover+=O,this.leftover<16)return;this.blocks(this.buffer,0,16),this.leftover=0}if(B>=16&&(O=B-B%16,this.blocks(w,C,O),C+=O,B-=O),B){for(p=0;p<B;p++)this.buffer[this.leftover+p]=w[C+p];this.leftover+=B}};function q(w,C,B,p,O,Q){var Z=new $(Q);return Z.update(B,p,O),Z.finish(w,C),0}function A(w,C,B,p,O,Q){var Z=new Uint8Array(16);return q(Z,0,B,p,O,Q),x(w,C,Z,0)}function f(w,C,B,p,O){var Q;if(B<32)return-1;for(j(w,0,C,0,B,p,O),q(w,16,w,32,B-32,w),Q=0;Q<16;Q++)w[Q]=0;return 0}function y(w,C,B,p,O){var Q,Z=new Uint8Array(32);if(B<32||(tt(Z,0,32,p,O),A(C,16,C,32,B-32,Z)!==0))return-1;for(j(w,0,C,0,B,p,O),Q=0;Q<32;Q++)w[Q]=0;return 0}function k(w,C){var B;for(B=0;B<16;B++)w[B]=C[B]|0}function U(w){var C,B,p=1;for(C=0;C<16;C++)B=w[C]+p+65535,p=Math.floor(B/65536),w[C]=B-p*65536;w[0]+=p-1+37*(p-1)}function D(w,C,B){for(var p,O=~(B-1),Q=0;Q<16;Q++)p=O&(w[Q]^C[Q]),w[Q]^=p,C[Q]^=p}function z(w,C){var B,p,O,Q=n(),Z=n();for(B=0;B<16;B++)Z[B]=C[B];for(U(Z),U(Z),U(Z),p=0;p<2;p++){for(Q[0]=Z[0]-65517,B=1;B<15;B++)Q[B]=Z[B]-65535-(Q[B-1]>>16&1),Q[B-1]&=65535;Q[15]=Z[15]-32767-(Q[14]>>16&1),O=Q[15]>>16&1,Q[14]&=65535,D(Z,Q,1-O)}for(B=0;B<16;B++)w[2*B]=Z[B]&255,w[2*B+1]=Z[B]>>8}function X(w,C){var B=new Uint8Array(32),p=new Uint8Array(32);return z(B,w),z(p,C),P(B,0,p,0)}function I(w){var C=new Uint8Array(32);return z(C,w),C[0]&1}function m(w,C){var B;for(B=0;B<16;B++)w[B]=C[2*B]+(C[2*B+1]<<8);w[15]&=32767}function M(w,C,B){for(var p=0;p<16;p++)w[p]=C[p]+B[p]}function Tt(w,C,B){for(var p=0;p<16;p++)w[p]=C[p]-B[p]}function ct(w,C,B){var p,O,Q=0,Z=0,lt=0,kt=0,It=0,St=0,Ve=0,Lt=0,pe=0,_e=0,Ae=0,ve=0,me=0,be=0,ye=0,Ft=0,Xt=0,Dt=0,zt=0,Ht=0,$t=0,st=0,rt=0,wt=0,pt=0,gt=0,xt=0,de=0,Re=0,qe=0,$e=0,H=B[0],je=B[1],on=B[2],sn=B[3],De=B[4],tn=B[5],en=B[6],Rn=B[7],dn=B[8],Pn=B[9],Cn=B[10],Bn=B[11],Mn=B[12],ni=B[13],ii=B[14],oi=B[15];p=C[0],Q+=p*H,Z+=p*je,lt+=p*on,kt+=p*sn,It+=p*De,St+=p*tn,Ve+=p*en,Lt+=p*Rn,pe+=p*dn,_e+=p*Pn,Ae+=p*Cn,ve+=p*Bn,me+=p*Mn,be+=p*ni,ye+=p*ii,Ft+=p*oi,p=C[1],Z+=p*H,lt+=p*je,kt+=p*on,It+=p*sn,St+=p*De,Ve+=p*tn,Lt+=p*en,pe+=p*Rn,_e+=p*dn,Ae+=p*Pn,ve+=p*Cn,me+=p*Bn,be+=p*Mn,ye+=p*ni,Ft+=p*ii,Xt+=p*oi,p=C[2],lt+=p*H,kt+=p*je,It+=p*on,St+=p*sn,Ve+=p*De,Lt+=p*tn,pe+=p*en,_e+=p*Rn,Ae+=p*dn,ve+=p*Pn,me+=p*Cn,be+=p*Bn,ye+=p*Mn,Ft+=p*ni,Xt+=p*ii,Dt+=p*oi,p=C[3],kt+=p*H,It+=p*je,St+=p*on,Ve+=p*sn,Lt+=p*De,pe+=p*tn,_e+=p*en,Ae+=p*Rn,ve+=p*dn,me+=p*Pn,be+=p*Cn,ye+=p*Bn,Ft+=p*Mn,Xt+=p*ni,Dt+=p*ii,zt+=p*oi,p=C[4],It+=p*H,St+=p*je,Ve+=p*on,Lt+=p*sn,pe+=p*De,_e+=p*tn,Ae+=p*en,ve+=p*Rn,me+=p*dn,be+=p*Pn,ye+=p*Cn,Ft+=p*Bn,Xt+=p*Mn,Dt+=p*ni,zt+=p*ii,Ht+=p*oi,p=C[5],St+=p*H,Ve+=p*je,Lt+=p*on,pe+=p*sn,_e+=p*De,Ae+=p*tn,ve+=p*en,me+=p*Rn,be+=p*dn,ye+=p*Pn,Ft+=p*Cn,Xt+=p*Bn,Dt+=p*Mn,zt+=p*ni,Ht+=p*ii,$t+=p*oi,p=C[6],Ve+=p*H,Lt+=p*je,pe+=p*on,_e+=p*sn,Ae+=p*De,ve+=p*tn,me+=p*en,be+=p*Rn,ye+=p*dn,Ft+=p*Pn,Xt+=p*Cn,Dt+=p*Bn,zt+=p*Mn,Ht+=p*ni,$t+=p*ii,st+=p*oi,p=C[7],Lt+=p*H,pe+=p*je,_e+=p*on,Ae+=p*sn,ve+=p*De,me+=p*tn,be+=p*en,ye+=p*Rn,Ft+=p*dn,Xt+=p*Pn,Dt+=p*Cn,zt+=p*Bn,Ht+=p*Mn,$t+=p*ni,st+=p*ii,rt+=p*oi,p=C[8],pe+=p*H,_e+=p*je,Ae+=p*on,ve+=p*sn,me+=p*De,be+=p*tn,ye+=p*en,Ft+=p*Rn,Xt+=p*dn,Dt+=p*Pn,zt+=p*Cn,Ht+=p*Bn,$t+=p*Mn,st+=p*ni,rt+=p*ii,wt+=p*oi,p=C[9],_e+=p*H,Ae+=p*je,ve+=p*on,me+=p*sn,be+=p*De,ye+=p*tn,Ft+=p*en,Xt+=p*Rn,Dt+=p*dn,zt+=p*Pn,Ht+=p*Cn,$t+=p*Bn,st+=p*Mn,rt+=p*ni,wt+=p*ii,pt+=p*oi,p=C[10],Ae+=p*H,ve+=p*je,me+=p*on,be+=p*sn,ye+=p*De,Ft+=p*tn,Xt+=p*en,Dt+=p*Rn,zt+=p*dn,Ht+=p*Pn,$t+=p*Cn,st+=p*Bn,rt+=p*Mn,wt+=p*ni,pt+=p*ii,gt+=p*oi,p=C[11],ve+=p*H,me+=p*je,be+=p*on,ye+=p*sn,Ft+=p*De,Xt+=p*tn,Dt+=p*en,zt+=p*Rn,Ht+=p*dn,$t+=p*Pn,st+=p*Cn,rt+=p*Bn,wt+=p*Mn,pt+=p*ni,gt+=p*ii,xt+=p*oi,p=C[12],me+=p*H,be+=p*je,ye+=p*on,Ft+=p*sn,Xt+=p*De,Dt+=p*tn,zt+=p*en,Ht+=p*Rn,$t+=p*dn,st+=p*Pn,rt+=p*Cn,wt+=p*Bn,pt+=p*Mn,gt+=p*ni,xt+=p*ii,de+=p*oi,p=C[13],be+=p*H,ye+=p*je,Ft+=p*on,Xt+=p*sn,Dt+=p*De,zt+=p*tn,Ht+=p*en,$t+=p*Rn,st+=p*dn,rt+=p*Pn,wt+=p*Cn,pt+=p*Bn,gt+=p*Mn,xt+=p*ni,de+=p*ii,Re+=p*oi,p=C[14],ye+=p*H,Ft+=p*je,Xt+=p*on,Dt+=p*sn,zt+=p*De,Ht+=p*tn,$t+=p*en,st+=p*Rn,rt+=p*dn,wt+=p*Pn,pt+=p*Cn,gt+=p*Bn,xt+=p*Mn,de+=p*ni,Re+=p*ii,qe+=p*oi,p=C[15],Ft+=p*H,Xt+=p*je,Dt+=p*on,zt+=p*sn,Ht+=p*De,$t+=p*tn,st+=p*en,rt+=p*Rn,wt+=p*dn,pt+=p*Pn,gt+=p*Cn,xt+=p*Bn,de+=p*Mn,Re+=p*ni,qe+=p*ii,$e+=p*oi,Q+=38*Xt,Z+=38*Dt,lt+=38*zt,kt+=38*Ht,It+=38*$t,St+=38*st,Ve+=38*rt,Lt+=38*wt,pe+=38*pt,_e+=38*gt,Ae+=38*xt,ve+=38*de,me+=38*Re,be+=38*qe,ye+=38*$e,O=1,p=Q+O+65535,O=Math.floor(p/65536),Q=p-O*65536,p=Z+O+65535,O=Math.floor(p/65536),Z=p-O*65536,p=lt+O+65535,O=Math.floor(p/65536),lt=p-O*65536,p=kt+O+65535,O=Math.floor(p/65536),kt=p-O*65536,p=It+O+65535,O=Math.floor(p/65536),It=p-O*65536,p=St+O+65535,O=Math.floor(p/65536),St=p-O*65536,p=Ve+O+65535,O=Math.floor(p/65536),Ve=p-O*65536,p=Lt+O+65535,O=Math.floor(p/65536),Lt=p-O*65536,p=pe+O+65535,O=Math.floor(p/65536),pe=p-O*65536,p=_e+O+65535,O=Math.floor(p/65536),_e=p-O*65536,p=Ae+O+65535,O=Math.floor(p/65536),Ae=p-O*65536,p=ve+O+65535,O=Math.floor(p/65536),ve=p-O*65536,p=me+O+65535,O=Math.floor(p/65536),me=p-O*65536,p=be+O+65535,O=Math.floor(p/65536),be=p-O*65536,p=ye+O+65535,O=Math.floor(p/65536),ye=p-O*65536,p=Ft+O+65535,O=Math.floor(p/65536),Ft=p-O*65536,Q+=O-1+37*(O-1),O=1,p=Q+O+65535,O=Math.floor(p/65536),Q=p-O*65536,p=Z+O+65535,O=Math.floor(p/65536),Z=p-O*65536,p=lt+O+65535,O=Math.floor(p/65536),lt=p-O*65536,p=kt+O+65535,O=Math.floor(p/65536),kt=p-O*65536,p=It+O+65535,O=Math.floor(p/65536),It=p-O*65536,p=St+O+65535,O=Math.floor(p/65536),St=p-O*65536,p=Ve+O+65535,O=Math.floor(p/65536),Ve=p-O*65536,p=Lt+O+65535,O=Math.floor(p/65536),Lt=p-O*65536,p=pe+O+65535,O=Math.floor(p/65536),pe=p-O*65536,p=_e+O+65535,O=Math.floor(p/65536),_e=p-O*65536,p=Ae+O+65535,O=Math.floor(p/65536),Ae=p-O*65536,p=ve+O+65535,O=Math.floor(p/65536),ve=p-O*65536,p=me+O+65535,O=Math.floor(p/65536),me=p-O*65536,p=be+O+65535,O=Math.floor(p/65536),be=p-O*65536,p=ye+O+65535,O=Math.floor(p/65536),ye=p-O*65536,p=Ft+O+65535,O=Math.floor(p/65536),Ft=p-O*65536,Q+=O-1+37*(O-1),w[0]=Q,w[1]=Z,w[2]=lt,w[3]=kt,w[4]=It,w[5]=St,w[6]=Ve,w[7]=Lt,w[8]=pe,w[9]=_e,w[10]=Ae,w[11]=ve,w[12]=me,w[13]=be,w[14]=ye,w[15]=Ft}function mt(w,C){ct(w,C,C)}function oe(w,C){var B=n(),p;for(p=0;p<16;p++)B[p]=C[p];for(p=253;p>=0;p--)mt(B,B),p!==2&&p!==4&&ct(B,B,C);for(p=0;p<16;p++)w[p]=B[p]}function Qt(w,C){var B=n(),p;for(p=0;p<16;p++)B[p]=C[p];for(p=250;p>=0;p--)mt(B,B),p!==1&&ct(B,B,C);for(p=0;p<16;p++)w[p]=B[p]}function Ie(w,C,B){var p=new Uint8Array(32),O=new Float64Array(80),Q,Z,lt=n(),kt=n(),It=n(),St=n(),Ve=n(),Lt=n();for(Z=0;Z<31;Z++)p[Z]=C[Z];for(p[31]=C[31]&127|64,p[0]&=248,m(O,B),Z=0;Z<16;Z++)kt[Z]=O[Z],St[Z]=lt[Z]=It[Z]=0;for(lt[0]=St[0]=1,Z=254;Z>=0;--Z)Q=p[Z>>>3]>>>(Z&7)&1,D(lt,kt,Q),D(It,St,Q),M(Ve,lt,It),Tt(lt,lt,It),M(It,kt,St),Tt(kt,kt,St),mt(St,Ve),mt(Lt,lt),ct(lt,It,lt),ct(It,kt,Ve),M(Ve,lt,It),Tt(lt,lt,It),mt(kt,lt),Tt(It,St,Lt),ct(lt,It,c),M(lt,lt,St),ct(It,It,lt),ct(lt,St,Lt),ct(St,kt,O),mt(kt,Ve),D(lt,kt,Q),D(It,St,Q);for(Z=0;Z<16;Z++)O[Z+16]=lt[Z],O[Z+32]=It[Z],O[Z+48]=kt[Z],O[Z+64]=St[Z];var pe=O.subarray(32),_e=O.subarray(16);return oe(pe,pe),ct(_e,_e,pe),z(w,_e),0}function fe(w,C){return Ie(w,C,s)}function se(w,C){return i(C,32),fe(w,C)}function ae(w,C,B){var p=new Uint8Array(32);return Ie(p,B,C),R(w,o,p,K)}var ci=f,nt=y;function dt(w,C,B,p,O,Q){var Z=new Uint8Array(32);return ae(Z,O,Q),ci(w,C,B,p,Z)}function Bt(w,C,B,p,O,Q){var Z=new Uint8Array(32);return ae(Z,O,Q),nt(w,C,B,p,Z)}var At=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591];function Rt(w,C,B,p){for(var O=new Int32Array(16),Q=new Int32Array(16),Z,lt,kt,It,St,Ve,Lt,pe,_e,Ae,ve,me,be,ye,Ft,Xt,Dt,zt,Ht,$t,st,rt,wt,pt,gt,xt,de=w[0],Re=w[1],qe=w[2],$e=w[3],H=w[4],je=w[5],on=w[6],sn=w[7],De=C[0],tn=C[1],en=C[2],Rn=C[3],dn=C[4],Pn=C[5],Cn=C[6],Bn=C[7],Mn=0;p>=128;){for(Ht=0;Ht<16;Ht++)$t=8*Ht+Mn,O[Ht]=B[$t+0]<<24|B[$t+1]<<16|B[$t+2]<<8|B[$t+3],Q[Ht]=B[$t+4]<<24|B[$t+5]<<16|B[$t+6]<<8|B[$t+7];for(Ht=0;Ht<80;Ht++)if(Z=de,lt=Re,kt=qe,It=$e,St=H,Ve=je,Lt=on,pe=sn,_e=De,Ae=tn,ve=en,me=Rn,be=dn,ye=Pn,Ft=Cn,Xt=Bn,st=sn,rt=Bn,wt=rt&65535,pt=rt>>>16,gt=st&65535,xt=st>>>16,st=(H>>>14|dn<<32-14)^(H>>>18|dn<<32-18)^(dn>>>41-32|H<<32-(41-32)),rt=(dn>>>14|H<<32-14)^(dn>>>18|H<<32-18)^(H>>>41-32|dn<<32-(41-32)),wt+=rt&65535,pt+=rt>>>16,gt+=st&65535,xt+=st>>>16,st=H&je^~H&on,rt=dn&Pn^~dn&Cn,wt+=rt&65535,pt+=rt>>>16,gt+=st&65535,xt+=st>>>16,st=At[Ht*2],rt=At[Ht*2+1],wt+=rt&65535,pt+=rt>>>16,gt+=st&65535,xt+=st>>>16,st=O[Ht%16],rt=Q[Ht%16],wt+=rt&65535,pt+=rt>>>16,gt+=st&65535,xt+=st>>>16,pt+=wt>>>16,gt+=pt>>>16,xt+=gt>>>16,Dt=gt&65535|xt<<16,zt=wt&65535|pt<<16,st=Dt,rt=zt,wt=rt&65535,pt=rt>>>16,gt=st&65535,xt=st>>>16,st=(de>>>28|De<<32-28)^(De>>>34-32|de<<32-(34-32))^(De>>>39-32|de<<32-(39-32)),rt=(De>>>28|de<<32-28)^(de>>>34-32|De<<32-(34-32))^(de>>>39-32|De<<32-(39-32)),wt+=rt&65535,pt+=rt>>>16,gt+=st&65535,xt+=st>>>16,st=de&Re^de&qe^Re&qe,rt=De&tn^De&en^tn&en,wt+=rt&65535,pt+=rt>>>16,gt+=st&65535,xt+=st>>>16,pt+=wt>>>16,gt+=pt>>>16,xt+=gt>>>16,pe=gt&65535|xt<<16,Xt=wt&65535|pt<<16,st=It,rt=me,wt=rt&65535,pt=rt>>>16,gt=st&65535,xt=st>>>16,st=Dt,rt=zt,wt+=rt&65535,pt+=rt>>>16,gt+=st&65535,xt+=st>>>16,pt+=wt>>>16,gt+=pt>>>16,xt+=gt>>>16,It=gt&65535|xt<<16,me=wt&65535|pt<<16,Re=Z,qe=lt,$e=kt,H=It,je=St,on=Ve,sn=Lt,de=pe,tn=_e,en=Ae,Rn=ve,dn=me,Pn=be,Cn=ye,Bn=Ft,De=Xt,Ht%16===15)for($t=0;$t<16;$t++)st=O[$t],rt=Q[$t],wt=rt&65535,pt=rt>>>16,gt=st&65535,xt=st>>>16,st=O[($t+9)%16],rt=Q[($t+9)%16],wt+=rt&65535,pt+=rt>>>16,gt+=st&65535,xt+=st>>>16,Dt=O[($t+1)%16],zt=Q[($t+1)%16],st=(Dt>>>1|zt<<32-1)^(Dt>>>8|zt<<32-8)^Dt>>>7,rt=(zt>>>1|Dt<<32-1)^(zt>>>8|Dt<<32-8)^(zt>>>7|Dt<<32-7),wt+=rt&65535,pt+=rt>>>16,gt+=st&65535,xt+=st>>>16,Dt=O[($t+14)%16],zt=Q[($t+14)%16],st=(Dt>>>19|zt<<32-19)^(zt>>>61-32|Dt<<32-(61-32))^Dt>>>6,rt=(zt>>>19|Dt<<32-19)^(Dt>>>61-32|zt<<32-(61-32))^(zt>>>6|Dt<<32-6),wt+=rt&65535,pt+=rt>>>16,gt+=st&65535,xt+=st>>>16,pt+=wt>>>16,gt+=pt>>>16,xt+=gt>>>16,O[$t]=gt&65535|xt<<16,Q[$t]=wt&65535|pt<<16;st=de,rt=De,wt=rt&65535,pt=rt>>>16,gt=st&65535,xt=st>>>16,st=w[0],rt=C[0],wt+=rt&65535,pt+=rt>>>16,gt+=st&65535,xt+=st>>>16,pt+=wt>>>16,gt+=pt>>>16,xt+=gt>>>16,w[0]=de=gt&65535|xt<<16,C[0]=De=wt&65535|pt<<16,st=Re,rt=tn,wt=rt&65535,pt=rt>>>16,gt=st&65535,xt=st>>>16,st=w[1],rt=C[1],wt+=rt&65535,pt+=rt>>>16,gt+=st&65535,xt+=st>>>16,pt+=wt>>>16,gt+=pt>>>16,xt+=gt>>>16,w[1]=Re=gt&65535|xt<<16,C[1]=tn=wt&65535|pt<<16,st=qe,rt=en,wt=rt&65535,pt=rt>>>16,gt=st&65535,xt=st>>>16,st=w[2],rt=C[2],wt+=rt&65535,pt+=rt>>>16,gt+=st&65535,xt+=st>>>16,pt+=wt>>>16,gt+=pt>>>16,xt+=gt>>>16,w[2]=qe=gt&65535|xt<<16,C[2]=en=wt&65535|pt<<16,st=$e,rt=Rn,wt=rt&65535,pt=rt>>>16,gt=st&65535,xt=st>>>16,st=w[3],rt=C[3],wt+=rt&65535,pt+=rt>>>16,gt+=st&65535,xt+=st>>>16,pt+=wt>>>16,gt+=pt>>>16,xt+=gt>>>16,w[3]=$e=gt&65535|xt<<16,C[3]=Rn=wt&65535|pt<<16,st=H,rt=dn,wt=rt&65535,pt=rt>>>16,gt=st&65535,xt=st>>>16,st=w[4],rt=C[4],wt+=rt&65535,pt+=rt>>>16,gt+=st&65535,xt+=st>>>16,pt+=wt>>>16,gt+=pt>>>16,xt+=gt>>>16,w[4]=H=gt&65535|xt<<16,C[4]=dn=wt&65535|pt<<16,st=je,rt=Pn,wt=rt&65535,pt=rt>>>16,gt=st&65535,xt=st>>>16,st=w[5],rt=C[5],wt+=rt&65535,pt+=rt>>>16,gt+=st&65535,xt+=st>>>16,pt+=wt>>>16,gt+=pt>>>16,xt+=gt>>>16,w[5]=je=gt&65535|xt<<16,C[5]=Pn=wt&65535|pt<<16,st=on,rt=Cn,wt=rt&65535,pt=rt>>>16,gt=st&65535,xt=st>>>16,st=w[6],rt=C[6],wt+=rt&65535,pt+=rt>>>16,gt+=st&65535,xt+=st>>>16,pt+=wt>>>16,gt+=pt>>>16,xt+=gt>>>16,w[6]=on=gt&65535|xt<<16,C[6]=Cn=wt&65535|pt<<16,st=sn,rt=Bn,wt=rt&65535,pt=rt>>>16,gt=st&65535,xt=st>>>16,st=w[7],rt=C[7],wt+=rt&65535,pt+=rt>>>16,gt+=st&65535,xt+=st>>>16,pt+=wt>>>16,gt+=pt>>>16,xt+=gt>>>16,w[7]=sn=gt&65535|xt<<16,C[7]=Bn=wt&65535|pt<<16,Mn+=128,p-=128}return p}function Yt(w,C,B){var p=new Int32Array(8),O=new Int32Array(8),Q=new Uint8Array(256),Z,lt=B;for(p[0]=1779033703,p[1]=3144134277,p[2]=1013904242,p[3]=2773480762,p[4]=1359893119,p[5]=2600822924,p[6]=528734635,p[7]=1541459225,O[0]=4089235720,O[1]=2227873595,O[2]=4271175723,O[3]=1595750129,O[4]=2917565137,O[5]=725511199,O[6]=4215389547,O[7]=327033209,Rt(p,O,C,B),B%=128,Z=0;Z<B;Z++)Q[Z]=C[lt-B+Z];for(Q[B]=128,B=256-128*(B<112?1:0),Q[B-9]=0,b(Q,B-8,lt/536870912|0,lt<<3),Rt(p,O,Q,B),Z=0;Z<8;Z++)b(w,8*Z,p[Z],O[Z]);return 0}function Nt(w,C){var B=n(),p=n(),O=n(),Q=n(),Z=n(),lt=n(),kt=n(),It=n(),St=n();Tt(B,w[1],w[0]),Tt(St,C[1],C[0]),ct(B,B,St),M(p,w[0],w[1]),M(St,C[0],C[1]),ct(p,p,St),ct(O,w[3],C[3]),ct(O,O,l),ct(Q,w[2],C[2]),M(Q,Q,Q),Tt(Z,p,B),Tt(lt,Q,O),M(kt,Q,O),M(It,p,B),ct(w[0],Z,lt),ct(w[1],It,kt),ct(w[2],kt,lt),ct(w[3],Z,It)}function Jt(w,C,B){var p;for(p=0;p<4;p++)D(w[p],C[p],B)}function Xe(w,C){var B=n(),p=n(),O=n();oe(O,C[2]),ct(B,C[0],O),ct(p,C[1],O),z(w,p),w[31]^=I(B)<<7}function ce(w,C,B){var p,O;for(k(w[0],r),k(w[1],a),k(w[2],a),k(w[3],r),O=255;O>=0;--O)p=B[O/8|0]>>(O&7)&1,Jt(w,C,p),Nt(C,w),Nt(w,w),Jt(w,C,p)}function Zt(w,C){var B=[n(),n(),n(),n()];k(B[0],d),k(B[1],h),k(B[2],a),ct(B[3],d,h),ce(w,B,C)}function Fe(w,C,B){var p=new Uint8Array(64),O=[n(),n(),n(),n()],Q;for(B||i(C,32),Yt(p,C,32),p[0]&=248,p[31]&=127,p[31]|=64,Zt(O,p),Xe(w,O),Q=0;Q<32;Q++)C[Q+32]=w[Q];return 0}var L=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]);function G(w,C){var B,p,O,Q;for(p=63;p>=32;--p){for(B=0,O=p-32,Q=p-12;O<Q;++O)C[O]+=B-16*C[p]*L[O-(p-32)],B=Math.floor((C[O]+128)/256),C[O]-=B*256;C[O]+=B,C[p]=0}for(B=0,O=0;O<32;O++)C[O]+=B-(C[31]>>4)*L[O],B=C[O]>>8,C[O]&=255;for(O=0;O<32;O++)C[O]-=B*L[O];for(p=0;p<32;p++)C[p+1]+=C[p]>>8,w[p]=C[p]&255}function Y(w){var C=new Float64Array(64),B;for(B=0;B<64;B++)C[B]=w[B];for(B=0;B<64;B++)w[B]=0;G(w,C)}function J(w,C,B,p){var O=new Uint8Array(64),Q=new Uint8Array(64),Z=new Uint8Array(64),lt,kt,It=new Float64Array(64),St=[n(),n(),n(),n()];Yt(O,p,32),O[0]&=248,O[31]&=127,O[31]|=64;var Ve=B+64;for(lt=0;lt<B;lt++)w[64+lt]=C[lt];for(lt=0;lt<32;lt++)w[32+lt]=O[32+lt];for(Yt(Z,w.subarray(32),B+32),Y(Z),Zt(St,Z),Xe(w,St),lt=32;lt<64;lt++)w[lt]=p[lt];for(Yt(Q,w,B+64),Y(Q),lt=0;lt<64;lt++)It[lt]=0;for(lt=0;lt<32;lt++)It[lt]=Z[lt];for(lt=0;lt<32;lt++)for(kt=0;kt<32;kt++)It[lt+kt]+=Q[lt]*O[kt];return G(w.subarray(32),It),Ve}function ot(w,C){var B=n(),p=n(),O=n(),Q=n(),Z=n(),lt=n(),kt=n();return k(w[2],a),m(w[1],C),mt(O,w[1]),ct(Q,O,u),Tt(O,O,w[2]),M(Q,w[2],Q),mt(Z,Q),mt(lt,Z),ct(kt,lt,Z),ct(B,kt,O),ct(B,B,Q),Qt(B,B),ct(B,B,O),ct(B,B,Q),ct(B,B,Q),ct(w[0],B,Q),mt(p,w[0]),ct(p,p,Q),X(p,O)&&ct(w[0],w[0],g),mt(p,w[0]),ct(p,p,Q),X(p,O)?-1:(I(w[0])===C[31]>>7&&Tt(w[0],r,w[0]),ct(w[3],w[0],w[1]),0)}function ft(w,C,B,p){var O,Q=new Uint8Array(32),Z=new Uint8Array(64),lt=[n(),n(),n(),n()],kt=[n(),n(),n(),n()];if(B<64||ot(kt,p))return-1;for(O=0;O<B;O++)w[O]=C[O];for(O=0;O<32;O++)w[O+32]=p[O];if(Yt(Z,w,B),Y(Z),ce(lt,kt,Z),Zt(kt,C.subarray(32)),Nt(lt,kt),Xe(Q,lt),B-=64,P(C,0,Q,0)){for(O=0;O<B;O++)w[O]=0;return-1}for(O=0;O<B;O++)w[O]=C[O+64];return B}var yt=32,ht=24,bt=32,vt=16,ut=32,jt=32,Kt=32,Wt=32,Ge=32,Vt=ht,Gt=bt,On=vt,te=64,ue=32,_n=64,Ye=32,Me=64;t.lowlevel={crypto_core_hsalsa20:R,crypto_stream_xor:j,crypto_stream:tt,crypto_stream_salsa20_xor:V,crypto_stream_salsa20:W,crypto_onetimeauth:q,crypto_onetimeauth_verify:A,crypto_verify_16:x,crypto_verify_32:P,crypto_secretbox:f,crypto_secretbox_open:y,crypto_scalarmult:Ie,crypto_scalarmult_base:fe,crypto_box_beforenm:ae,crypto_box_afternm:ci,crypto_box:dt,crypto_box_open:Bt,crypto_box_keypair:se,crypto_hash:Yt,crypto_sign:J,crypto_sign_keypair:Fe,crypto_sign_open:ft,crypto_secretbox_KEYBYTES:yt,crypto_secretbox_NONCEBYTES:ht,crypto_secretbox_ZEROBYTES:bt,crypto_secretbox_BOXZEROBYTES:vt,crypto_scalarmult_BYTES:ut,crypto_scalarmult_SCALARBYTES:jt,crypto_box_PUBLICKEYBYTES:Kt,crypto_box_SECRETKEYBYTES:Wt,crypto_box_BEFORENMBYTES:Ge,crypto_box_NONCEBYTES:Vt,crypto_box_ZEROBYTES:Gt,crypto_box_BOXZEROBYTES:On,crypto_sign_BYTES:te,crypto_sign_PUBLICKEYBYTES:ue,crypto_sign_SECRETKEYBYTES:_n,crypto_sign_SEEDBYTES:Ye,crypto_hash_BYTES:Me,gf:n,D:u,L,pack25519:z,unpack25519:m,M:ct,A:M,S:mt,Z:Tt,pow2523:Qt,add:Nt,set25519:k,modL:G,scalarmult:ce,scalarbase:Zt};function Tn(w,C){if(w.length!==yt)throw new Error("bad key size");if(C.length!==ht)throw new Error("bad nonce size")}function an(w,C){if(w.length!==Kt)throw new Error("bad public key size");if(C.length!==Wt)throw new Error("bad secret key size")}function le(){for(var w=0;w<arguments.length;w++)if(!(arguments[w]instanceof Uint8Array))throw new TypeError("unexpected type, use Uint8Array")}function mo(w){for(var C=0;C<w.length;C++)w[C]=0}t.randomBytes=function(w){var C=new Uint8Array(w);return i(C,w),C},t.secretbox=function(w,C,B){le(w,C,B),Tn(B,C);for(var p=new Uint8Array(bt+w.length),O=new Uint8Array(p.length),Q=0;Q<w.length;Q++)p[Q+bt]=w[Q];return f(O,p,p.length,C,B),O.subarray(vt)},t.secretbox.open=function(w,C,B){le(w,C,B),Tn(B,C);for(var p=new Uint8Array(vt+w.length),O=new Uint8Array(p.length),Q=0;Q<w.length;Q++)p[Q+vt]=w[Q];return p.length<32||y(O,p,p.length,C,B)!==0?null:O.subarray(bt)},t.secretbox.keyLength=yt,t.secretbox.nonceLength=ht,t.secretbox.overheadLength=vt,t.scalarMult=function(w,C){if(le(w,C),w.length!==jt)throw new Error("bad n size");if(C.length!==ut)throw new Error("bad p size");var B=new Uint8Array(ut);return Ie(B,w,C),B},t.scalarMult.base=function(w){if(le(w),w.length!==jt)throw new Error("bad n size");var C=new Uint8Array(ut);return fe(C,w),C},t.scalarMult.scalarLength=jt,t.scalarMult.groupElementLength=ut,t.box=function(w,C,B,p){var O=t.box.before(B,p);return t.secretbox(w,C,O)},t.box.before=function(w,C){le(w,C),an(w,C);var B=new Uint8Array(Ge);return ae(B,w,C),B},t.box.after=t.secretbox,t.box.open=function(w,C,B,p){var O=t.box.before(B,p);return t.secretbox.open(w,C,O)},t.box.open.after=t.secretbox.open,t.box.keyPair=function(){var w=new Uint8Array(Kt),C=new Uint8Array(Wt);return se(w,C),{publicKey:w,secretKey:C}},t.box.keyPair.fromSecretKey=function(w){if(le(w),w.length!==Wt)throw new Error("bad secret key size");var C=new Uint8Array(Kt);return fe(C,w),{publicKey:C,secretKey:new Uint8Array(w)}},t.box.publicKeyLength=Kt,t.box.secretKeyLength=Wt,t.box.sharedKeyLength=Ge,t.box.nonceLength=Vt,t.box.overheadLength=t.secretbox.overheadLength,t.sign=function(w,C){if(le(w,C),C.length!==_n)throw new Error("bad secret key size");var B=new Uint8Array(te+w.length);return J(B,w,w.length,C),B},t.sign.open=function(w,C){if(le(w,C),C.length!==ue)throw new Error("bad public key size");var B=new Uint8Array(w.length),p=ft(B,w,w.length,C);if(p<0)return null;for(var O=new Uint8Array(p),Q=0;Q<O.length;Q++)O[Q]=B[Q];return O},t.sign.detached=function(w,C){for(var B=t.sign(w,C),p=new Uint8Array(te),O=0;O<p.length;O++)p[O]=B[O];return p},t.sign.detached.verify=function(w,C,B){if(le(w,C,B),C.length!==te)throw new Error("bad signature size");if(B.length!==ue)throw new Error("bad public key size");var p=new Uint8Array(te+w.length),O=new Uint8Array(te+w.length),Q;for(Q=0;Q<te;Q++)p[Q]=C[Q];for(Q=0;Q<w.length;Q++)p[Q+te]=w[Q];return ft(O,p,p.length,B)>=0},t.sign.keyPair=function(){var w=new Uint8Array(ue),C=new Uint8Array(_n);return Fe(w,C),{publicKey:w,secretKey:C}},t.sign.keyPair.fromSecretKey=function(w){if(le(w),w.length!==_n)throw new Error("bad secret key size");for(var C=new Uint8Array(ue),B=0;B<C.length;B++)C[B]=w[32+B];return{publicKey:C,secretKey:new Uint8Array(w)}},t.sign.keyPair.fromSeed=function(w){if(le(w),w.length!==Ye)throw new Error("bad seed size");for(var C=new Uint8Array(ue),B=new Uint8Array(_n),p=0;p<32;p++)B[p]=w[p];return Fe(C,B,!0),{publicKey:C,secretKey:B}},t.sign.publicKeyLength=ue,t.sign.secretKeyLength=_n,t.sign.seedLength=Ye,t.sign.signatureLength=te,t.hash=function(w){le(w);var C=new Uint8Array(Me);return Yt(C,w,w.length),C},t.hash.hashLength=Me,t.verify=function(w,C){return le(w,C),w.length===0||C.length===0||w.length!==C.length?!1:v(w,0,C,0,w.length)===0},t.setPRNG=function(w){i=w},function(){var w=typeof self<"u"?self.crypto||self.msCrypto:null;if(w&&w.getRandomValues){var C=65536;t.setPRNG(function(B,p){var O,Q=new Uint8Array(p);for(O=0;O<p;O+=C)w.getRandomValues(Q.subarray(O,O+Math.min(p-O,C)));for(O=0;O<p;O++)B[O]=Q[O];mo(Q)})}else typeof Bm<"u"&&(w=Df,w&&w.randomBytes&&t.setPRNG(function(B,p){var O,Q=w.randomBytes(p);for(O=0;O<p;O++)B[O]=Q[O];mo(Q)}))}()})(e.exports?e.exports:self.nacl=self.nacl||{})})(qm);var bi={},jn={};Object.defineProperty(jn,"__esModule",{value:!0});jn.output=jn.exists=jn.hash=jn.bytes=jn.bool=jn.number=void 0;function mc(e){if(!Number.isSafeInteger(e)||e<0)throw new Error(`Wrong positive integer: ${e}`)}jn.number=mc;function Nf(e){if(typeof e!="boolean")throw new Error(`Expected boolean, not ${e}`)}jn.bool=Nf;function od(e,...t){if(!(e instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(t.length>0&&!t.includes(e.length))throw new TypeError(`Expected Uint8Array of length ${t}, not of length=${e.length}`)}jn.bytes=od;function Ff(e){if(typeof e!="function"||typeof e.create!="function")throw new Error("Hash should be wrapped by utils.wrapConstructor");mc(e.outputLen),mc(e.blockLen)}jn.hash=Ff;function jf(e,t=!0){if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}jn.exists=jf;function zf(e,t){od(e);const n=t.outputLen;if(e.length<n)throw new Error(`digestInto() expects output buffer of length at least ${n}`)}jn.output=zf;const Mm={number:mc,bool:Nf,bytes:od,hash:Ff,exists:jf,output:zf};jn.default=Mm;var ar={},Hf={},ms={},Lc={};Object.defineProperty(Lc,"__esModule",{value:!0});Lc.crypto=void 0;Lc.crypto={node:void 0,web:typeof self=="object"&&"crypto"in self?self.crypto:void 0};(function(e){/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */Object.defineProperty(e,"__esModule",{value:!0}),e.randomBytes=e.wrapConstructorWithOpts=e.wrapConstructor=e.checkOpts=e.Hash=e.concatBytes=e.toBytes=e.utf8ToBytes=e.asyncLoop=e.nextTick=e.hexToBytes=e.bytesToHex=e.isLE=e.rotr=e.createView=e.u32=e.u8=void 0;const t=Lc,n=T=>new Uint8Array(T.buffer,T.byteOffset,T.byteLength);e.u8=n;const i=T=>new Uint32Array(T.buffer,T.byteOffset,Math.floor(T.byteLength/4));e.u32=i;const o=T=>new DataView(T.buffer,T.byteOffset,T.byteLength);e.createView=o;const s=(T,R)=>T<<32-R|T>>>R;if(e.rotr=s,e.isLE=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68,!e.isLE)throw new Error("Non little-endian hardware is not supported");const r=Array.from({length:256},(T,R)=>R.toString(16).padStart(2,"0"));function a(T){if(!(T instanceof Uint8Array))throw new Error("Uint8Array expected");let R="";for(let K=0;K<T.length;K++)R+=r[T[K]];return R}e.bytesToHex=a;function c(T){if(typeof T!="string")throw new TypeError("hexToBytes: expected string, got "+typeof T);if(T.length%2)throw new Error("hexToBytes: received invalid unpadded hex");const R=new Uint8Array(T.length/2);for(let K=0;K<R.length;K++){const V=K*2,W=T.slice(V,V+2),tt=Number.parseInt(W,16);if(Number.isNaN(tt)||tt<0)throw new Error("Invalid byte sequence");R[K]=tt}return R}e.hexToBytes=c;const u=async()=>{};e.nextTick=u;async function l(T,R,K){let V=Date.now();for(let W=0;W<T;W++){K(W);const tt=Date.now()-V;tt>=0&&tt<R||(await(0,e.nextTick)(),V+=tt)}}e.asyncLoop=l;function d(T){if(typeof T!="string")throw new TypeError(`utf8ToBytes expected string, got ${typeof T}`);return new TextEncoder().encode(T)}e.utf8ToBytes=d;function h(T){if(typeof T=="string"&&(T=d(T)),!(T instanceof Uint8Array))throw new TypeError(`Expected input type is Uint8Array (got ${typeof T})`);return T}e.toBytes=h;function g(...T){if(!T.every(V=>V instanceof Uint8Array))throw new Error("Uint8Array list expected");if(T.length===1)return T[0];const R=T.reduce((V,W)=>V+W.length,0),K=new Uint8Array(R);for(let V=0,W=0;V<T.length;V++){const tt=T[V];K.set(tt,W),W+=tt.length}return K}e.concatBytes=g;class b{clone(){return this._cloneInto()}}e.Hash=b;const v=T=>Object.prototype.toString.call(T)==="[object Object]"&&T.constructor===Object;function x(T,R){if(R!==void 0&&(typeof R!="object"||!v(R)))throw new TypeError("Options should be object or undefined");return Object.assign(T,R)}e.checkOpts=x;function P(T){const R=V=>T().update(h(V)).digest(),K=T();return R.outputLen=K.outputLen,R.blockLen=K.blockLen,R.create=()=>T(),R}e.wrapConstructor=P;function E(T){const R=(V,W)=>T(W).update(h(V)).digest(),K=T({});return R.outputLen=K.outputLen,R.blockLen=K.blockLen,R.create=V=>T(V),R}e.wrapConstructorWithOpts=E;function S(T=32){if(t.crypto.web)return t.crypto.web.getRandomValues(new Uint8Array(T));if(t.crypto.node)return new Uint8Array(t.crypto.node.randomBytes(T).buffer);throw new Error("The environment doesn't have randomBytes function")}e.randomBytes=S})(ms);(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.hmac=void 0;const t=jn,n=ms;class i extends n.Hash{constructor(r,a){super(),this.finished=!1,this.destroyed=!1,t.default.hash(r);const c=(0,n.toBytes)(a);if(this.iHash=r.create(),typeof this.iHash.update!="function")throw new TypeError("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const u=this.blockLen,l=new Uint8Array(u);l.set(c.length>u?r.create().update(c).digest():c);for(let d=0;d<l.length;d++)l[d]^=54;this.iHash.update(l),this.oHash=r.create();for(let d=0;d<l.length;d++)l[d]^=106;this.oHash.update(l),l.fill(0)}update(r){return t.default.exists(this),this.iHash.update(r),this}digestInto(r){t.default.exists(this),t.default.bytes(r,this.outputLen),this.finished=!0,this.iHash.digestInto(r),this.oHash.update(r),this.oHash.digestInto(r),this.destroy()}digest(){const r=new Uint8Array(this.oHash.outputLen);return this.digestInto(r),r}_cloneInto(r){r||(r=Object.create(Object.getPrototypeOf(this),{}));const{oHash:a,iHash:c,finished:u,destroyed:l,blockLen:d,outputLen:h}=this;return r=r,r.finished=u,r.destroyed=l,r.blockLen=d,r.outputLen=h,r.oHash=a._cloneInto(r.oHash),r.iHash=c._cloneInto(r.iHash),r}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}}const o=(s,r,a)=>new i(s,r).update(a).digest();e.hmac=o,e.hmac.create=(s,r)=>new i(s,r)})(Hf);Object.defineProperty(ar,"__esModule",{value:!0});ar.pbkdf2Async=ar.pbkdf2=void 0;const qa=jn,Dm=Hf,Qs=ms;function Kf(e,t,n,i){qa.default.hash(e);const o=(0,Qs.checkOpts)({dkLen:32,asyncTick:10},i),{c:s,dkLen:r,asyncTick:a}=o;if(qa.default.number(s),qa.default.number(r),qa.default.number(a),s<1)throw new Error("PBKDF2: iterations (c) should be >= 1");const c=(0,Qs.toBytes)(t),u=(0,Qs.toBytes)(n),l=new Uint8Array(r),d=Dm.hmac.create(e,c),h=d._cloneInto().update(u);return{c:s,dkLen:r,asyncTick:a,DK:l,PRF:d,PRFSalt:h}}function Gf(e,t,n,i,o){return e.destroy(),t.destroy(),i&&i.destroy(),o.fill(0),n}function Lm(e,t,n,i){const{c:o,dkLen:s,DK:r,PRF:a,PRFSalt:c}=Kf(e,t,n,i);let u;const l=new Uint8Array(4),d=(0,Qs.createView)(l),h=new Uint8Array(a.outputLen);for(let g=1,b=0;b<s;g++,b+=a.outputLen){const v=r.subarray(b,b+a.outputLen);d.setInt32(0,g,!1),(u=c._cloneInto(u)).update(l).digestInto(h),v.set(h.subarray(0,v.length));for(let x=1;x<o;x++){a._cloneInto(u).update(h).digestInto(h);for(let P=0;P<v.length;P++)v[P]^=h[P]}}return Gf(a,c,r,u,h)}ar.pbkdf2=Lm;async function Nm(e,t,n,i){const{c:o,dkLen:s,asyncTick:r,DK:a,PRF:c,PRFSalt:u}=Kf(e,t,n,i);let l;const d=new Uint8Array(4),h=(0,Qs.createView)(d),g=new Uint8Array(c.outputLen);for(let b=1,v=0;v<s;b++,v+=c.outputLen){const x=a.subarray(v,v+c.outputLen);h.setInt32(0,b,!1),(l=u._cloneInto(l)).update(d).digestInto(g),x.set(g.subarray(0,x.length)),await(0,Qs.asyncLoop)(o-1,r,P=>{c._cloneInto(l).update(g).digestInto(g);for(let E=0;E<x.length;E++)x[E]^=g[E]})}return Gf(c,u,a,l,g)}ar.pbkdf2Async=Nm;var cr={},ha={};Object.defineProperty(ha,"__esModule",{value:!0});ha.SHA2=void 0;const Ju=jn,Dr=ms;function Fm(e,t,n,i){if(typeof e.setBigUint64=="function")return e.setBigUint64(t,n,i);const o=BigInt(32),s=BigInt(4294967295),r=Number(n>>o&s),a=Number(n&s),c=i?4:0,u=i?0:4;e.setUint32(t+c,r,i),e.setUint32(t+u,a,i)}let jm=class extends Dr.Hash{constructor(t,n,i,o){super(),this.blockLen=t,this.outputLen=n,this.padOffset=i,this.isLE=o,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(t),this.view=(0,Dr.createView)(this.buffer)}update(t){Ju.default.exists(this);const{view:n,buffer:i,blockLen:o}=this;t=(0,Dr.toBytes)(t);const s=t.length;for(let r=0;r<s;){const a=Math.min(o-this.pos,s-r);if(a===o){const c=(0,Dr.createView)(t);for(;o<=s-r;r+=o)this.process(c,r);continue}i.set(t.subarray(r,r+a),this.pos),this.pos+=a,r+=a,this.pos===o&&(this.process(n,0),this.pos=0)}return this.length+=t.length,this.roundClean(),this}digestInto(t){Ju.default.exists(this),Ju.default.output(t,this),this.finished=!0;const{buffer:n,view:i,blockLen:o,isLE:s}=this;let{pos:r}=this;n[r++]=128,this.buffer.subarray(r).fill(0),this.padOffset>o-r&&(this.process(i,0),r=0);for(let d=r;d<o;d++)n[d]=0;Fm(i,o-8,BigInt(this.length*8),s),this.process(i,0);const a=(0,Dr.createView)(t),c=this.outputLen;if(c%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const u=c/4,l=this.get();if(u>l.length)throw new Error("_sha2: outputLen bigger than state");for(let d=0;d<u;d++)a.setUint32(4*d,l[d],s)}digest(){const{buffer:t,outputLen:n}=this;this.digestInto(t);const i=t.slice(0,n);return this.destroy(),i}_cloneInto(t){t||(t=new this.constructor),t.set(...this.get());const{blockLen:n,buffer:i,length:o,finished:s,destroyed:r,pos:a}=this;return t.length=o,t.pos=a,t.finished=s,t.destroyed=r,o%n&&t.buffer.set(i),t}};ha.SHA2=jm;Object.defineProperty(cr,"__esModule",{value:!0});cr.sha224=cr.sha256=void 0;const zm=ha,Si=ms,Hm=(e,t,n)=>e&t^~e&n,Km=(e,t,n)=>e&t^e&n^t&n,Gm=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),yo=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),wo=new Uint32Array(64);let Wf=class extends zm.SHA2{constructor(){super(64,32,8,!1),this.A=yo[0]|0,this.B=yo[1]|0,this.C=yo[2]|0,this.D=yo[3]|0,this.E=yo[4]|0,this.F=yo[5]|0,this.G=yo[6]|0,this.H=yo[7]|0}get(){const{A:t,B:n,C:i,D:o,E:s,F:r,G:a,H:c}=this;return[t,n,i,o,s,r,a,c]}set(t,n,i,o,s,r,a,c){this.A=t|0,this.B=n|0,this.C=i|0,this.D=o|0,this.E=s|0,this.F=r|0,this.G=a|0,this.H=c|0}process(t,n){for(let d=0;d<16;d++,n+=4)wo[d]=t.getUint32(n,!1);for(let d=16;d<64;d++){const h=wo[d-15],g=wo[d-2],b=(0,Si.rotr)(h,7)^(0,Si.rotr)(h,18)^h>>>3,v=(0,Si.rotr)(g,17)^(0,Si.rotr)(g,19)^g>>>10;wo[d]=v+wo[d-7]+b+wo[d-16]|0}let{A:i,B:o,C:s,D:r,E:a,F:c,G:u,H:l}=this;for(let d=0;d<64;d++){const h=(0,Si.rotr)(a,6)^(0,Si.rotr)(a,11)^(0,Si.rotr)(a,25),g=l+h+Hm(a,c,u)+Gm[d]+wo[d]|0,v=((0,Si.rotr)(i,2)^(0,Si.rotr)(i,13)^(0,Si.rotr)(i,22))+Km(i,o,s)|0;l=u,u=c,c=a,a=r+g|0,r=s,s=o,o=i,i=g+v|0}i=i+this.A|0,o=o+this.B|0,s=s+this.C|0,r=r+this.D|0,a=a+this.E|0,c=c+this.F|0,u=u+this.G|0,l=l+this.H|0,this.set(i,o,s,r,a,c,u,l)}roundClean(){wo.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}},Wm=class extends Wf{constructor(){super(),this.A=-1056596264,this.B=914150663,this.C=812702999,this.D=-150054599,this.E=-4191439,this.F=1750603025,this.G=1694076839,this.H=-1090891868,this.outputLen=28}};cr.sha256=(0,Si.wrapConstructor)(()=>new Wf);cr.sha224=(0,Si.wrapConstructor)(()=>new Wm);var Ui={},Xf={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.add=e.toBig=e.split=e.fromBig=void 0;const t=BigInt(2**32-1),n=BigInt(32);function i(j,$=!1){return $?{h:Number(j&t),l:Number(j>>n&t)}:{h:Number(j>>n&t)|0,l:Number(j&t)|0}}e.fromBig=i;function o(j,$=!1){let q=new Uint32Array(j.length),A=new Uint32Array(j.length);for(let f=0;f<j.length;f++){const{h:y,l:k}=i(j[f],$);[q[f],A[f]]=[y,k]}return[q,A]}e.split=o;const s=(j,$)=>BigInt(j>>>0)<<n|BigInt($>>>0);e.toBig=s;const r=(j,$,q)=>j>>>q,a=(j,$,q)=>j<<32-q|$>>>q,c=(j,$,q)=>j>>>q|$<<32-q,u=(j,$,q)=>j<<32-q|$>>>q,l=(j,$,q)=>j<<64-q|$>>>q-32,d=(j,$,q)=>j>>>q-32|$<<64-q,h=(j,$)=>$,g=(j,$)=>j,b=(j,$,q)=>j<<q|$>>>32-q,v=(j,$,q)=>$<<q|j>>>32-q,x=(j,$,q)=>$<<q-32|j>>>64-q,P=(j,$,q)=>j<<q-32|$>>>64-q;function E(j,$,q,A){const f=($>>>0)+(A>>>0);return{h:j+q+(f/2**32|0)|0,l:f|0}}e.add=E;const S=(j,$,q)=>(j>>>0)+($>>>0)+(q>>>0),T=(j,$,q,A)=>$+q+A+(j/2**32|0)|0,R=(j,$,q,A)=>(j>>>0)+($>>>0)+(q>>>0)+(A>>>0),K=(j,$,q,A,f)=>$+q+A+f+(j/2**32|0)|0,V=(j,$,q,A,f)=>(j>>>0)+($>>>0)+(q>>>0)+(A>>>0)+(f>>>0),W=(j,$,q,A,f,y)=>$+q+A+f+y+(j/2**32|0)|0,tt={fromBig:i,split:o,toBig:e.toBig,shrSH:r,shrSL:a,rotrSH:c,rotrSL:u,rotrBH:l,rotrBL:d,rotr32H:h,rotr32L:g,rotlSH:b,rotlSL:v,rotlBH:x,rotlBL:P,add:E,add3L:S,add3H:T,add4L:R,add4H:K,add5H:W,add5L:V};e.default=tt})(Xf);Object.defineProperty(Ui,"__esModule",{value:!0});Ui.sha384=Ui.sha512_256=Ui.sha512_224=Ui.sha512=Ui.SHA512=void 0;const Xm=ha,Le=Xf,Nc=ms,[Vm,Jm]=Le.default.split(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(e=>BigInt(e))),bo=new Uint32Array(80),vo=new Uint32Array(80);let fa=class extends Xm.SHA2{constructor(){super(128,64,16,!1),this.Ah=1779033703,this.Al=-205731576,this.Bh=-1150833019,this.Bl=-2067093701,this.Ch=1013904242,this.Cl=-23791573,this.Dh=-1521486534,this.Dl=1595750129,this.Eh=1359893119,this.El=-1377402159,this.Fh=-1694144372,this.Fl=725511199,this.Gh=528734635,this.Gl=-79577749,this.Hh=1541459225,this.Hl=327033209}get(){const{Ah:t,Al:n,Bh:i,Bl:o,Ch:s,Cl:r,Dh:a,Dl:c,Eh:u,El:l,Fh:d,Fl:h,Gh:g,Gl:b,Hh:v,Hl:x}=this;return[t,n,i,o,s,r,a,c,u,l,d,h,g,b,v,x]}set(t,n,i,o,s,r,a,c,u,l,d,h,g,b,v,x){this.Ah=t|0,this.Al=n|0,this.Bh=i|0,this.Bl=o|0,this.Ch=s|0,this.Cl=r|0,this.Dh=a|0,this.Dl=c|0,this.Eh=u|0,this.El=l|0,this.Fh=d|0,this.Fl=h|0,this.Gh=g|0,this.Gl=b|0,this.Hh=v|0,this.Hl=x|0}process(t,n){for(let S=0;S<16;S++,n+=4)bo[S]=t.getUint32(n),vo[S]=t.getUint32(n+=4);for(let S=16;S<80;S++){const T=bo[S-15]|0,R=vo[S-15]|0,K=Le.default.rotrSH(T,R,1)^Le.default.rotrSH(T,R,8)^Le.default.shrSH(T,R,7),V=Le.default.rotrSL(T,R,1)^Le.default.rotrSL(T,R,8)^Le.default.shrSL(T,R,7),W=bo[S-2]|0,tt=vo[S-2]|0,j=Le.default.rotrSH(W,tt,19)^Le.default.rotrBH(W,tt,61)^Le.default.shrSH(W,tt,6),$=Le.default.rotrSL(W,tt,19)^Le.default.rotrBL(W,tt,61)^Le.default.shrSL(W,tt,6),q=Le.default.add4L(V,$,vo[S-7],vo[S-16]),A=Le.default.add4H(q,K,j,bo[S-7],bo[S-16]);bo[S]=A|0,vo[S]=q|0}let{Ah:i,Al:o,Bh:s,Bl:r,Ch:a,Cl:c,Dh:u,Dl:l,Eh:d,El:h,Fh:g,Fl:b,Gh:v,Gl:x,Hh:P,Hl:E}=this;for(let S=0;S<80;S++){const T=Le.default.rotrSH(d,h,14)^Le.default.rotrSH(d,h,18)^Le.default.rotrBH(d,h,41),R=Le.default.rotrSL(d,h,14)^Le.default.rotrSL(d,h,18)^Le.default.rotrBL(d,h,41),K=d&g^~d&v,V=h&b^~h&x,W=Le.default.add5L(E,R,V,Jm[S],vo[S]),tt=Le.default.add5H(W,P,T,K,Vm[S],bo[S]),j=W|0,$=Le.default.rotrSH(i,o,28)^Le.default.rotrBH(i,o,34)^Le.default.rotrBH(i,o,39),q=Le.default.rotrSL(i,o,28)^Le.default.rotrBL(i,o,34)^Le.default.rotrBL(i,o,39),A=i&s^i&a^s&a,f=o&r^o&c^r&c;P=v|0,E=x|0,v=g|0,x=b|0,g=d|0,b=h|0,{h:d,l:h}=Le.default.add(u|0,l|0,tt|0,j|0),u=a|0,l=c|0,a=s|0,c=r|0,s=i|0,r=o|0;const y=Le.default.add3L(j,q,f);i=Le.default.add3H(y,tt,$,A),o=y|0}({h:i,l:o}=Le.default.add(this.Ah|0,this.Al|0,i|0,o|0)),{h:s,l:r}=Le.default.add(this.Bh|0,this.Bl|0,s|0,r|0),{h:a,l:c}=Le.default.add(this.Ch|0,this.Cl|0,a|0,c|0),{h:u,l}=Le.default.add(this.Dh|0,this.Dl|0,u|0,l|0),{h:d,l:h}=Le.default.add(this.Eh|0,this.El|0,d|0,h|0),{h:g,l:b}=Le.default.add(this.Fh|0,this.Fl|0,g|0,b|0),{h:v,l:x}=Le.default.add(this.Gh|0,this.Gl|0,v|0,x|0),{h:P,l:E}=Le.default.add(this.Hh|0,this.Hl|0,P|0,E|0),this.set(i,o,s,r,a,c,u,l,d,h,g,b,v,x,P,E)}roundClean(){bo.fill(0),vo.fill(0)}destroy(){this.buffer.fill(0),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}};Ui.SHA512=fa;let Zm=class extends fa{constructor(){super(),this.Ah=-1942145080,this.Al=424955298,this.Bh=1944164710,this.Bl=-1982016298,this.Ch=502970286,this.Cl=855612546,this.Dh=1738396948,this.Dl=1479516111,this.Eh=258812777,this.El=2077511080,this.Fh=2011393907,this.Fl=79989058,this.Gh=1067287976,this.Gl=1780299464,this.Hh=286451373,this.Hl=-1848208735,this.outputLen=28}},Ym=class extends fa{constructor(){super(),this.Ah=573645204,this.Al=-64227540,this.Bh=-1621794909,this.Bl=-934517566,this.Ch=596883563,this.Cl=1867755857,this.Dh=-1774684391,this.Dl=1497426621,this.Eh=-1775747358,this.El=-1467023389,this.Fh=-1101128155,this.Fl=1401305490,this.Gh=721525244,this.Gl=746961066,this.Hh=246885852,this.Hl=-2117784414,this.outputLen=32}},Qm=class extends fa{constructor(){super(),this.Ah=-876896931,this.Al=-1056596264,this.Bh=1654270250,this.Bl=914150663,this.Ch=-1856437926,this.Cl=812702999,this.Dh=355462360,this.Dl=-150054599,this.Eh=1731405415,this.El=-4191439,this.Fh=-1900787065,this.Fl=1750603025,this.Gh=-619958771,this.Gl=1694076839,this.Hh=1203062813,this.Hl=-1090891868,this.outputLen=48}};Ui.sha512=(0,Nc.wrapConstructor)(()=>new fa);Ui.sha512_224=(0,Nc.wrapConstructor)(()=>new Zm);Ui.sha512_256=(0,Nc.wrapConstructor)(()=>new Ym);Ui.sha384=(0,Nc.wrapConstructor)(()=>new Qm);var sd={};(function(e){/*! scure-base - MIT License (c) 2022 Paul Miller (paulmillr.com) */Object.defineProperty(e,"__esModule",{value:!0}),e.bytes=e.stringToBytes=e.str=e.bytesToString=e.hex=e.utf8=e.bech32m=e.bech32=e.base58check=e.base58xmr=e.base58xrp=e.base58flickr=e.base58=e.base64urlnopad=e.base64url=e.base64=e.base32crockford=e.base32hex=e.base32=e.base16=e.utils=e.assertNumber=void 0;function t($){if(!Number.isSafeInteger($))throw new Error(`Wrong integer: ${$}`)}e.assertNumber=t;function n(...$){const q=(y,k)=>U=>y(k(U)),A=Array.from($).reverse().reduce((y,k)=>y?q(y,k.encode):k.encode,void 0),f=$.reduce((y,k)=>y?q(y,k.decode):k.decode,void 0);return{encode:A,decode:f}}function i($){return{encode:q=>{if(!Array.isArray(q)||q.length&&typeof q[0]!="number")throw new Error("alphabet.encode input should be an array of numbers");return q.map(A=>{if(A<0||A>=$.length)throw new Error(`Digit index outside alphabet: ${A} (alphabet: ${$.length})`);return $[A]})},decode:q=>{if(!Array.isArray(q)||q.length&&typeof q[0]!="string")throw new Error("alphabet.decode input should be array of strings");return q.map(A=>{if(typeof A!="string")throw new Error(`alphabet.decode: not string element=${A}`);const f=$.indexOf(A);if(f===-1)throw new Error(`Unknown letter: "${A}". Allowed: ${$}`);return f})}}}function o($=""){if(typeof $!="string")throw new Error("join separator should be string");return{encode:q=>{if(!Array.isArray(q)||q.length&&typeof q[0]!="string")throw new Error("join.encode input should be array of strings");for(let A of q)if(typeof A!="string")throw new Error(`join.encode: non-string input=${A}`);return q.join($)},decode:q=>{if(typeof q!="string")throw new Error("join.decode input should be string");return q.split($)}}}function s($,q="="){if(typeof q!="string")throw new Error("padding chr should be string");return{encode(A){if(!Array.isArray(A)||A.length&&typeof A[0]!="string")throw new Error("padding.encode input should be array of strings");for(let f of A)if(typeof f!="string")throw new Error(`padding.encode: non-string input=${f}`);for(;A.length*$%8;)A.push(q);return A},decode(A){if(!Array.isArray(A)||A.length&&typeof A[0]!="string")throw new Error("padding.encode input should be array of strings");for(let y of A)if(typeof y!="string")throw new Error(`padding.decode: non-string input=${y}`);let f=A.length;if(f*$%8)throw new Error("Invalid padding: string should have whole number of bytes");for(;f>0&&A[f-1]===q;f--)if(!((f-1)*$%8))throw new Error("Invalid padding: string has too much padding");return A.slice(0,f)}}}function r($){if(typeof $!="function")throw new Error("normalize fn should be function");return{encode:q=>q,decode:q=>$(q)}}function a($,q,A){if(q<2)throw new Error(`convertRadix: wrong from=${q}, base cannot be less than 2`);if(A<2)throw new Error(`convertRadix: wrong to=${A}, base cannot be less than 2`);if(!Array.isArray($))throw new Error("convertRadix: data should be array");if(!$.length)return[];let f=0;const y=[],k=Array.from($);for(k.forEach(U=>{if(U<0||U>=q)throw new Error(`Wrong integer: ${U}`)});;){let U=0,D=!0;for(let z=f;z<k.length;z++){const X=k[z],I=q*U+X;if(!Number.isSafeInteger(I)||q*U/q!==U||I-X!==q*U)throw new Error("convertRadix: carry overflow");U=I%A;const m=Math.floor(I/A);if(k[z]=m,!Number.isSafeInteger(m)||m*A+U!==I)throw new Error("convertRadix: carry overflow");if(D)m?D=!1:f=z;else continue}if(y.push(U),D)break}for(let U=0;U<$.length-1&&$[U]===0;U++)y.push(0);return y.reverse()}const c=($,q)=>q?c(q,$%q):$,u=($,q)=>$+(q-c($,q));function l($,q,A,f){if(!Array.isArray($))throw new Error("convertRadix2: data should be array");if(q<=0||q>32)throw new Error(`convertRadix2: wrong from=${q}`);if(A<=0||A>32)throw new Error(`convertRadix2: wrong to=${A}`);if(u(q,A)>32)throw new Error(`convertRadix2: carry overflow from=${q} to=${A} carryBits=${u(q,A)}`);let y=0,k=0;const U=2**A-1,D=[];for(const z of $){if(z>=2**q)throw new Error(`convertRadix2: invalid data word=${z} from=${q}`);if(y=y<<q|z,k+q>32)throw new Error(`convertRadix2: carry overflow pos=${k} from=${q}`);for(k+=q;k>=A;k-=A)D.push((y>>k-A&U)>>>0);y&=2**k-1}if(y=y<<A-k&U,!f&&k>=q)throw new Error("Excess padding");if(!f&&y)throw new Error(`Non-zero padding: ${y}`);return f&&k>0&&D.push(y>>>0),D}function d($){return{encode:q=>{if(!(q instanceof Uint8Array))throw new Error("radix.encode input should be Uint8Array");return a(Array.from(q),2**8,$)},decode:q=>{if(!Array.isArray(q)||q.length&&typeof q[0]!="number")throw new Error("radix.decode input should be array of strings");return Uint8Array.from(a(q,$,2**8))}}}function h($,q=!1){if($<=0||$>32)throw new Error("radix2: bits should be in (0..32]");if(u(8,$)>32||u($,8)>32)throw new Error("radix2: carry overflow");return{encode:A=>{if(!(A instanceof Uint8Array))throw new Error("radix2.encode input should be Uint8Array");return l(Array.from(A),8,$,!q)},decode:A=>{if(!Array.isArray(A)||A.length&&typeof A[0]!="number")throw new Error("radix2.decode input should be array of strings");return Uint8Array.from(l(A,$,8,q))}}}function g($){if(typeof $!="function")throw new Error("unsafeWrapper fn should be function");return function(...q){try{return $.apply(null,q)}catch{}}}function b($,q){if(typeof q!="function")throw new Error("checksum fn should be function");return{encode(A){if(!(A instanceof Uint8Array))throw new Error("checksum.encode: input should be Uint8Array");const f=q(A).slice(0,$),y=new Uint8Array(A.length+$);return y.set(A),y.set(f,A.length),y},decode(A){if(!(A instanceof Uint8Array))throw new Error("checksum.decode: input should be Uint8Array");const f=A.slice(0,-$),y=q(f).slice(0,$),k=A.slice(-$);for(let U=0;U<$;U++)if(y[U]!==k[U])throw new Error("Invalid checksum");return f}}}e.utils={alphabet:i,chain:n,checksum:b,radix:d,radix2:h,join:o,padding:s},e.base16=n(h(4),i("0123456789ABCDEF"),o("")),e.base32=n(h(5),i("ABCDEFGHIJKLMNOPQRSTUVWXYZ234567"),s(5),o("")),e.base32hex=n(h(5),i("0123456789ABCDEFGHIJKLMNOPQRSTUV"),s(5),o("")),e.base32crockford=n(h(5),i("0123456789ABCDEFGHJKMNPQRSTVWXYZ"),o(""),r($=>$.toUpperCase().replace(/O/g,"0").replace(/[IL]/g,"1"))),e.base64=n(h(6),i("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"),s(6),o("")),e.base64url=n(h(6),i("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_"),s(6),o("")),e.base64urlnopad=n(h(6),i("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_"),o(""));const v=$=>n(d(58),i($),o(""));e.base58=v("123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"),e.base58flickr=v("123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"),e.base58xrp=v("rpshnaf39wBUDNEGHJKLM4PQRST7VWXYZ2bcdeCg65jkm8oFqi1tuvAxyz");const x=[0,2,3,5,6,7,9,10,11];e.base58xmr={encode($){let q="";for(let A=0;A<$.length;A+=8){const f=$.subarray(A,A+8);q+=e.base58.encode(f).padStart(x[f.length],"1")}return q},decode($){let q=[];for(let A=0;A<$.length;A+=11){const f=$.slice(A,A+11),y=x.indexOf(f.length),k=e.base58.decode(f);for(let U=0;U<k.length-y;U++)if(k[U]!==0)throw new Error("base58xmr: wrong padding");q=q.concat(Array.from(k.slice(k.length-y)))}return Uint8Array.from(q)}};const P=$=>n(b(4,q=>$($(q))),e.base58);e.base58check=P;const E=n(i("qpzry9x8gf2tvdw0s3jn54khce6mua7l"),o("")),S=[996825010,642813549,513874426,1027748829,705979059];function T($){const q=$>>25;let A=($&33554431)<<5;for(let f=0;f<S.length;f++)(q>>f&1)===1&&(A^=S[f]);return A}function R($,q,A=1){const f=$.length;let y=1;for(let k=0;k<f;k++){const U=$.charCodeAt(k);if(U<33||U>126)throw new Error(`Invalid prefix (${$})`);y=T(y)^U>>5}y=T(y);for(let k=0;k<f;k++)y=T(y)^$.charCodeAt(k)&31;for(let k of q)y=T(y)^k;for(let k=0;k<6;k++)y=T(y);return y^=A,E.encode(l([y%2**30],30,5,!1))}function K($){const q=$==="bech32"?1:734539939,A=h(5),f=A.decode,y=A.encode,k=g(f);function U(I,m,M=90){if(typeof I!="string")throw new Error(`bech32.encode prefix should be string, not ${typeof I}`);if(!Array.isArray(m)||m.length&&typeof m[0]!="number")throw new Error(`bech32.encode words should be array of numbers, not ${typeof m}`);const Tt=I.length+7+m.length;if(M!==!1&&Tt>M)throw new TypeError(`Length ${Tt} exceeds limit ${M}`);const ct=I.toLowerCase(),mt=R(ct,m,q);return`${ct}1${E.encode(m)}${mt}`}function D(I,m=90){if(typeof I!="string")throw new Error(`bech32.decode input should be string, not ${typeof I}`);if(I.length<8||m!==!1&&I.length>m)throw new TypeError(`Wrong string length: ${I.length} (${I}). Expected (8..${m})`);const M=I.toLowerCase();if(I!==M&&I!==I.toUpperCase())throw new Error("String must be lowercase or uppercase");I=M;const Tt=I.lastIndexOf("1");if(Tt===0||Tt===-1)throw new Error('Letter "1" must be present between prefix and data only');const ct=I.slice(0,Tt),mt=I.slice(Tt+1);if(mt.length<6)throw new Error("Data must be at least 6 characters long");const oe=E.decode(mt).slice(0,-6),Qt=R(ct,oe,q);if(!mt.endsWith(Qt))throw new Error(`Invalid checksum in ${I}: expected "${Qt}"`);return{prefix:ct,words:oe}}const z=g(D);function X(I){const{prefix:m,words:M}=D(I,!1);return{prefix:m,words:M,bytes:f(M)}}return{encode:U,decode:D,decodeToBytes:X,decodeUnsafe:z,fromWords:f,fromWordsUnsafe:k,toWords:y}}e.bech32=K("bech32"),e.bech32m=K("bech32m"),e.utf8={encode:$=>new TextDecoder().decode($),decode:$=>new TextEncoder().encode($)},e.hex=n(h(4),i("0123456789abcdef"),o(""),r($=>{if(typeof $!="string"||$.length%2)throw new TypeError(`hex.decode: expected string, got ${typeof $} with length ${$.length}`);return $.toLowerCase()}));const V={utf8:e.utf8,hex:e.hex,base16:e.base16,base32:e.base32,base64:e.base64,base64url:e.base64url,base58:e.base58,base58xmr:e.base58xmr},W="Invalid encoding type. Available types: utf8, hex, base16, base32, base64, base64url, base58, base58xmr",tt=($,q)=>{if(typeof $!="string"||!V.hasOwnProperty($))throw new TypeError(W);if(!(q instanceof Uint8Array))throw new TypeError("bytesToString() expects Uint8Array");return V[$].encode(q)};e.bytesToString=tt,e.str=e.bytesToString;const j=($,q)=>{if(!V.hasOwnProperty($))throw new TypeError(W);if(typeof q!="string")throw new TypeError("stringToBytes() expects string");return V[$].decode(q)};e.stringToBytes=j,e.bytes=e.stringToBytes})(sd);Object.defineProperty(bi,"__esModule",{value:!0});var Vf=bi.mnemonicToSeedSync=bi.mnemonicToSeed=bi.validateMnemonic=bi.entropyToMnemonic=bi.mnemonicToEntropy=bi.generateMnemonic=void 0;/*! scure-bip39 - MIT License (c) 2022 Patricio Palladino, Paul Miller (paulmillr.com) */const Jf=jn,Zf=ar,ty=cr,Yf=Ui,ey=ms,Ma=sd,ny=e=>e[0]==="";function Qf(e){if(typeof e!="string")throw new TypeError(`Invalid mnemonic type: ${typeof e}`);return e.normalize("NFKD")}function rd(e){const t=Qf(e),n=t.split(" ");if(![12,15,18,21,24].includes(n.length))throw new Error("Invalid mnemonic");return{nfkd:t,words:n}}function t0(e){Jf.default.bytes(e,16,20,24,28,32)}function iy(e,t=128){if(Jf.default.number(t),t%32!==0||t>256)throw new TypeError("Invalid entropy");return i0((0,ey.randomBytes)(t/8),e)}bi.generateMnemonic=iy;const oy=e=>{const t=8-e.length/4;return new Uint8Array([(0,ty.sha256)(e)[0]>>t<<t])};function e0(e){if(!Array.isArray(e)||e.length!==2**11||typeof e[0]!="string")throw new Error("Worlist: expected array of 2048 strings");return e.forEach(t=>{if(typeof t!="string")throw new Error(`Wordlist: non-string element: ${t}`)}),Ma.utils.chain(Ma.utils.checksum(1,oy),Ma.utils.radix2(11,!0),Ma.utils.alphabet(e))}function n0(e,t){const{words:n}=rd(e),i=e0(t).decode(n);return t0(i),i}bi.mnemonicToEntropy=n0;function i0(e,t){return t0(e),e0(t).encode(e).join(ny(t)?"":" ")}bi.entropyToMnemonic=i0;function sy(e,t){try{n0(e,t)}catch{return!1}return!0}bi.validateMnemonic=sy;const o0=e=>Qf(`mnemonic${e}`);function ry(e,t=""){return(0,Zf.pbkdf2Async)(Yf.sha512,rd(e).nfkd,o0(t),{c:2048,dkLen:64})}bi.mnemonicToSeed=ry;function ay(e,t=""){return(0,Zf.pbkdf2)(Yf.sha512,rd(e).nfkd,o0(t),{c:2048,dkLen:64})}Vf=bi.mnemonicToSeedSync=ay;/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */const cy=e=>new Uint32Array(e.buffer,e.byteOffset,Math.floor(e.byteLength/4)),Zu=e=>new DataView(e.buffer,e.byteOffset,e.byteLength),Xi=(e,t)=>e<<32-t|e>>>t,uy=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;if(!uy)throw new Error("Non little-endian hardware is not supported");const ly=Array.from({length:256},(e,t)=>t.toString(16).padStart(2,"0"));function s0(e){if(!(e instanceof Uint8Array))throw new Error("Uint8Array expected");let t="";for(let n=0;n<e.length;n++)t+=ly[e[n]];return t}function r0(e){if(typeof e!="string")throw new TypeError("hexToBytes: expected string, got "+typeof e);if(e.length%2)throw new Error("hexToBytes: received invalid unpadded hex");const t=new Uint8Array(e.length/2);for(let n=0;n<t.length;n++){const i=n*2,o=e.slice(i,i+2),s=Number.parseInt(o,16);if(Number.isNaN(s)||s<0)throw new Error("Invalid byte sequence");t[n]=s}return t}function dy(e){if(typeof e!="string")throw new TypeError(`utf8ToBytes expected string, got ${typeof e}`);return new TextEncoder().encode(e)}function pa(e){if(typeof e=="string"&&(e=dy(e)),!(e instanceof Uint8Array))throw new TypeError(`Expected input type is Uint8Array (got ${typeof e})`);return e}let ad=class{clone(){return this._cloneInto()}};function ga(e){const t=i=>e().update(pa(i)).digest(),n=e();return t.outputLen=n.outputLen,t.blockLen=n.blockLen,t.create=()=>e(),t}function hy(e){const t=(i,o)=>e(o).update(pa(i)).digest(),n=e({});return t.outputLen=n.outputLen,t.blockLen=n.blockLen,t.create=i=>e(i),t}function Il(e){if(!Number.isSafeInteger(e)||e<0)throw new Error(`Wrong positive integer: ${e}`)}function fy(e){if(typeof e!="boolean")throw new Error(`Expected boolean, not ${e}`)}function a0(e,...t){if(!(e instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(t.length>0&&!t.includes(e.length))throw new TypeError(`Expected Uint8Array of length ${t}, not of length=${e.length}`)}function py(e){if(typeof e!="function"||typeof e.create!="function")throw new Error("Hash should be wrapped by utils.wrapConstructor");Il(e.outputLen),Il(e.blockLen)}function gy(e,t=!0){if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}function _y(e,t){a0(e);const n=t.outputLen;if(e.length<n)throw new Error(`digestInto() expects output buffer of length at least ${n}`)}const vi={number:Il,bool:fy,bytes:a0,hash:py,exists:gy,output:_y};function my(e,t,n,i){if(typeof e.setBigUint64=="function")return e.setBigUint64(t,n,i);const o=BigInt(32),s=BigInt(4294967295),r=Number(n>>o&s),a=Number(n&s),c=i?4:0,u=i?0:4;e.setUint32(t+c,r,i),e.setUint32(t+u,a,i)}let c0=class extends ad{constructor(t,n,i,o){super(),this.blockLen=t,this.outputLen=n,this.padOffset=i,this.isLE=o,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(t),this.view=Zu(this.buffer)}update(t){vi.exists(this);const{view:n,buffer:i,blockLen:o}=this;t=pa(t);const s=t.length;for(let r=0;r<s;){const a=Math.min(o-this.pos,s-r);if(a===o){const c=Zu(t);for(;o<=s-r;r+=o)this.process(c,r);continue}i.set(t.subarray(r,r+a),this.pos),this.pos+=a,r+=a,this.pos===o&&(this.process(n,0),this.pos=0)}return this.length+=t.length,this.roundClean(),this}digestInto(t){vi.exists(this),vi.output(t,this),this.finished=!0;const{buffer:n,view:i,blockLen:o,isLE:s}=this;let{pos:r}=this;n[r++]=128,this.buffer.subarray(r).fill(0),this.padOffset>o-r&&(this.process(i,0),r=0);for(let c=r;c<o;c++)n[c]=0;my(i,o-8,BigInt(this.length*8),s),this.process(i,0);const a=Zu(t);this.get().forEach((c,u)=>a.setUint32(4*u,c,s))}digest(){const{buffer:t,outputLen:n}=this;this.digestInto(t);const i=t.slice(0,n);return this.destroy(),i}_cloneInto(t){t||(t=new this.constructor),t.set(...this.get());const{blockLen:n,buffer:i,length:o,finished:s,destroyed:r,pos:a}=this;return t.length=o,t.pos=a,t.finished=s,t.destroyed=r,o%n&&t.buffer.set(i),t}};const yy=(e,t,n)=>e&t^~e&n,wy=(e,t,n)=>e&t^e&n^t&n,by=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),To=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),Ao=new Uint32Array(64);let vy=class extends c0{constructor(){super(64,32,8,!1),this.A=To[0]|0,this.B=To[1]|0,this.C=To[2]|0,this.D=To[3]|0,this.E=To[4]|0,this.F=To[5]|0,this.G=To[6]|0,this.H=To[7]|0}get(){const{A:t,B:n,C:i,D:o,E:s,F:r,G:a,H:c}=this;return[t,n,i,o,s,r,a,c]}set(t,n,i,o,s,r,a,c){this.A=t|0,this.B=n|0,this.C=i|0,this.D=o|0,this.E=s|0,this.F=r|0,this.G=a|0,this.H=c|0}process(t,n){for(let d=0;d<16;d++,n+=4)Ao[d]=t.getUint32(n,!1);for(let d=16;d<64;d++){const h=Ao[d-15],g=Ao[d-2],b=Xi(h,7)^Xi(h,18)^h>>>3,v=Xi(g,17)^Xi(g,19)^g>>>10;Ao[d]=v+Ao[d-7]+b+Ao[d-16]|0}let{A:i,B:o,C:s,D:r,E:a,F:c,G:u,H:l}=this;for(let d=0;d<64;d++){const h=Xi(a,6)^Xi(a,11)^Xi(a,25),g=l+h+yy(a,c,u)+by[d]+Ao[d]|0,v=(Xi(i,2)^Xi(i,13)^Xi(i,22))+wy(i,o,s)|0;l=u,u=c,c=a,a=r+g|0,r=s,s=o,o=i,i=g+v|0}i=i+this.A|0,o=o+this.B|0,s=s+this.C|0,r=r+this.D|0,a=a+this.E|0,c=c+this.F|0,u=u+this.G|0,l=l+this.H|0,this.set(i,o,s,r,a,c,u,l)}roundClean(){Ao.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}};const Ty=ga(()=>new vy),Da=BigInt(2**32-1),Ol=BigInt(32);function u0(e,t=!1){return t?{h:Number(e&Da),l:Number(e>>Ol&Da)}:{h:Number(e>>Ol&Da)|0,l:Number(e&Da)|0}}function Ay(e,t=!1){let n=new Uint32Array(e.length),i=new Uint32Array(e.length);for(let o=0;o<e.length;o++){const{h:s,l:r}=u0(e[o],t);[n[o],i[o]]=[s,r]}return[n,i]}const xy=(e,t)=>BigInt(e>>>0)<<Ol|BigInt(t>>>0),ky=(e,t,n)=>e>>>n,Sy=(e,t,n)=>e<<32-n|t>>>n,Py=(e,t,n)=>e>>>n|t<<32-n,Cy=(e,t,n)=>e<<32-n|t>>>n,By=(e,t,n)=>e<<64-n|t>>>n-32,Ey=(e,t,n)=>e>>>n-32|t<<64-n,Iy=(e,t)=>t,Oy=(e,t)=>e,Ry=(e,t,n)=>e<<n|t>>>32-n,$y=(e,t,n)=>t<<n|e>>>32-n,Uy=(e,t,n)=>t<<n-32|e>>>64-n,qy=(e,t,n)=>e<<n-32|t>>>64-n;function My(e,t,n,i){const o=(t>>>0)+(i>>>0);return{h:e+n+(o/2**32|0)|0,l:o|0}}const Dy=(e,t,n)=>(e>>>0)+(t>>>0)+(n>>>0),Ly=(e,t,n,i)=>t+n+i+(e/2**32|0)|0,Ny=(e,t,n,i)=>(e>>>0)+(t>>>0)+(n>>>0)+(i>>>0),Fy=(e,t,n,i,o)=>t+n+i+o+(e/2**32|0)|0,jy=(e,t,n,i,o)=>(e>>>0)+(t>>>0)+(n>>>0)+(i>>>0)+(o>>>0),zy=(e,t,n,i,o,s)=>t+n+i+o+s+(e/2**32|0)|0,ke={fromBig:u0,split:Ay,toBig:xy,shrSH:ky,shrSL:Sy,rotrSH:Py,rotrSL:Cy,rotrBH:By,rotrBL:Ey,rotr32H:Iy,rotr32L:Oy,rotlSH:Ry,rotlSL:$y,rotlBH:Uy,rotlBL:qy,add:My,add3L:Dy,add3H:Ly,add4L:Ny,add4H:Fy,add5H:zy,add5L:jy},[l0,d0,h0]=[[],[],[]],Hy=BigInt(0),Lr=BigInt(1),Ky=BigInt(2),Gy=BigInt(7),Wy=BigInt(256),Xy=BigInt(113);for(let e=0,t=Lr,n=1,i=0;e<24;e++){[n,i]=[i,(2*n+3*i)%5],l0.push(2*(5*i+n)),d0.push((e+1)*(e+2)/2%64);let o=Hy;for(let s=0;s<7;s++)t=(t<<Lr^(t>>Gy)*Xy)%Wy,t&Ky&&(o^=Lr<<(Lr<<BigInt(s))-Lr);h0.push(o)}const[Vy,Jy]=ke.split(h0,!0),sh=(e,t,n)=>n>32?ke.rotlBH(e,t,n):ke.rotlSH(e,t,n),rh=(e,t,n)=>n>32?ke.rotlBL(e,t,n):ke.rotlSL(e,t,n);function Zy(e,t=24){const n=new Uint32Array(10);for(let i=24-t;i<24;i++){for(let r=0;r<10;r++)n[r]=e[r]^e[r+10]^e[r+20]^e[r+30]^e[r+40];for(let r=0;r<10;r+=2){const a=(r+8)%10,c=(r+2)%10,u=n[c],l=n[c+1],d=sh(u,l,1)^n[a],h=rh(u,l,1)^n[a+1];for(let g=0;g<50;g+=10)e[r+g]^=d,e[r+g+1]^=h}let o=e[2],s=e[3];for(let r=0;r<24;r++){const a=d0[r],c=sh(o,s,a),u=rh(o,s,a),l=l0[r];o=e[l],s=e[l+1],e[l]=c,e[l+1]=u}for(let r=0;r<50;r+=10){for(let a=0;a<10;a++)n[a]=e[r+a];for(let a=0;a<10;a++)e[r+a]^=~n[(a+2)%10]&n[(a+4)%10]}e[0]^=Vy[i],e[1]^=Jy[i]}n.fill(0)}let f0=class p0 extends ad{constructor(t,n,i,o=!1,s=24){if(super(),this.blockLen=t,this.suffix=n,this.outputLen=i,this.enableXOF=o,this.rounds=s,this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,vi.number(i),0>=this.blockLen||this.blockLen>=200)throw new Error("Sha3 supports only keccak-f1600 function");this.state=new Uint8Array(200),this.state32=cy(this.state)}keccak(){Zy(this.state32,this.rounds),this.posOut=0,this.pos=0}update(t){vi.exists(this);const{blockLen:n,state:i}=this;t=pa(t);const o=t.length;for(let s=0;s<o;){const r=Math.min(n-this.pos,o-s);for(let a=0;a<r;a++)i[this.pos++]^=t[s++];this.pos===n&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;const{state:t,suffix:n,pos:i,blockLen:o}=this;t[i]^=n,n&128&&i===o-1&&this.keccak(),t[o-1]^=128,this.keccak()}writeInto(t){vi.exists(this,!1),vi.bytes(t),this.finish();const n=this.state,{blockLen:i}=this;for(let o=0,s=t.length;o<s;){this.posOut>=i&&this.keccak();const r=Math.min(i-this.posOut,s-o);t.set(n.subarray(this.posOut,this.posOut+r),o),this.posOut+=r,o+=r}return t}xofInto(t){if(!this.enableXOF)throw new Error("XOF is not possible for this instance");return this.writeInto(t)}xof(t){return vi.number(t),this.xofInto(new Uint8Array(t))}digestInto(t){if(vi.output(t,this),this.finished)throw new Error("digest() was already called");return this.writeInto(t),this.destroy(),t}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,this.state.fill(0)}_cloneInto(t){const{blockLen:n,suffix:i,outputLen:o,rounds:s,enableXOF:r}=this;return t||(t=new p0(n,i,o,r,s)),t.state32.set(this.state32),t.pos=this.pos,t.posOut=this.posOut,t.finished=this.finished,t.rounds=s,t.suffix=i,t.outputLen=o,t.enableXOF=r,t.destroyed=this.destroyed,t}};const Jo=(e,t,n)=>ga(()=>new f0(t,e,n));Jo(6,144,224/8);const ur=Jo(6,136,256/8);Jo(6,104,384/8);Jo(6,72,512/8);Jo(1,144,224/8);Jo(1,136,256/8);Jo(1,104,384/8);Jo(1,72,512/8);const g0=(e,t,n)=>hy((i={})=>new f0(t,e,i.dkLen===void 0?n:i.dkLen,!0));g0(31,168,128/8);g0(31,136,256/8);let _0=class extends ad{constructor(t,n){super(),this.finished=!1,this.destroyed=!1,vi.hash(t);const i=pa(n);if(this.iHash=t.create(),typeof this.iHash.update!="function")throw new TypeError("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const o=this.blockLen,s=new Uint8Array(o);s.set(i.length>o?t.create().update(i).digest():i);for(let r=0;r<s.length;r++)s[r]^=54;this.iHash.update(s),this.oHash=t.create();for(let r=0;r<s.length;r++)s[r]^=106;this.oHash.update(s),s.fill(0)}update(t){return vi.exists(this),this.iHash.update(t),this}digestInto(t){vi.exists(this),vi.bytes(t,this.outputLen),this.finished=!0,this.iHash.digestInto(t),this.oHash.update(t),this.oHash.digestInto(t),this.destroy()}digest(){const t=new Uint8Array(this.oHash.outputLen);return this.digestInto(t),t}_cloneInto(t){t||(t=Object.create(Object.getPrototypeOf(this),{}));const{oHash:n,iHash:i,finished:o,destroyed:s,blockLen:r,outputLen:a}=this;return t=t,t.finished=o,t.destroyed=s,t.blockLen=r,t.outputLen=a,t.oHash=n._cloneInto(t.oHash),t.iHash=i._cloneInto(t.iHash),t}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}};const cd=(e,t,n)=>new _0(e,t).update(n).digest();cd.create=(e,t)=>new _0(e,t);const[Yy,Qy]=ke.split(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(e=>BigInt(e))),xo=new Uint32Array(80),ko=new Uint32Array(80);let ud=class extends c0{constructor(){super(128,64,16,!1),this.Ah=1779033703,this.Al=-205731576,this.Bh=-1150833019,this.Bl=-2067093701,this.Ch=1013904242,this.Cl=-23791573,this.Dh=-1521486534,this.Dl=1595750129,this.Eh=1359893119,this.El=-1377402159,this.Fh=-1694144372,this.Fl=725511199,this.Gh=528734635,this.Gl=-79577749,this.Hh=1541459225,this.Hl=327033209}get(){const{Ah:t,Al:n,Bh:i,Bl:o,Ch:s,Cl:r,Dh:a,Dl:c,Eh:u,El:l,Fh:d,Fl:h,Gh:g,Gl:b,Hh:v,Hl:x}=this;return[t,n,i,o,s,r,a,c,u,l,d,h,g,b,v,x]}set(t,n,i,o,s,r,a,c,u,l,d,h,g,b,v,x){this.Ah=t|0,this.Al=n|0,this.Bh=i|0,this.Bl=o|0,this.Ch=s|0,this.Cl=r|0,this.Dh=a|0,this.Dl=c|0,this.Eh=u|0,this.El=l|0,this.Fh=d|0,this.Fl=h|0,this.Gh=g|0,this.Gl=b|0,this.Hh=v|0,this.Hl=x|0}process(t,n){for(let S=0;S<16;S++,n+=4)xo[S]=t.getUint32(n),ko[S]=t.getUint32(n+=4);for(let S=16;S<80;S++){const T=xo[S-15]|0,R=ko[S-15]|0,K=ke.rotrSH(T,R,1)^ke.rotrSH(T,R,8)^ke.shrSH(T,R,7),V=ke.rotrSL(T,R,1)^ke.rotrSL(T,R,8)^ke.shrSL(T,R,7),W=xo[S-2]|0,tt=ko[S-2]|0,j=ke.rotrSH(W,tt,19)^ke.rotrBH(W,tt,61)^ke.shrSH(W,tt,6),$=ke.rotrSL(W,tt,19)^ke.rotrBL(W,tt,61)^ke.shrSL(W,tt,6),q=ke.add4L(V,$,ko[S-7],ko[S-16]),A=ke.add4H(q,K,j,xo[S-7],xo[S-16]);xo[S]=A|0,ko[S]=q|0}let{Ah:i,Al:o,Bh:s,Bl:r,Ch:a,Cl:c,Dh:u,Dl:l,Eh:d,El:h,Fh:g,Fl:b,Gh:v,Gl:x,Hh:P,Hl:E}=this;for(let S=0;S<80;S++){const T=ke.rotrSH(d,h,14)^ke.rotrSH(d,h,18)^ke.rotrBH(d,h,41),R=ke.rotrSL(d,h,14)^ke.rotrSL(d,h,18)^ke.rotrBL(d,h,41),K=d&g^~d&v,V=h&b^~h&x,W=ke.add5L(E,R,V,Qy[S],ko[S]),tt=ke.add5H(W,P,T,K,Yy[S],xo[S]),j=W|0,$=ke.rotrSH(i,o,28)^ke.rotrBH(i,o,34)^ke.rotrBH(i,o,39),q=ke.rotrSL(i,o,28)^ke.rotrBL(i,o,34)^ke.rotrBL(i,o,39),A=i&s^i&a^s&a,f=o&r^o&c^r&c;P=v|0,E=x|0,v=g|0,x=b|0,g=d|0,b=h|0,{h:d,l:h}=ke.add(u|0,l|0,tt|0,j|0),u=a|0,l=c|0,a=s|0,c=r|0,s=i|0,r=o|0;const y=ke.add3L(j,q,f);i=ke.add3H(y,tt,$,A),o=y|0}({h:i,l:o}=ke.add(this.Ah|0,this.Al|0,i|0,o|0)),{h:s,l:r}=ke.add(this.Bh|0,this.Bl|0,s|0,r|0),{h:a,l:c}=ke.add(this.Ch|0,this.Cl|0,a|0,c|0),{h:u,l}=ke.add(this.Dh|0,this.Dl|0,u|0,l|0),{h:d,l:h}=ke.add(this.Eh|0,this.El|0,d|0,h|0),{h:g,l:b}=ke.add(this.Fh|0,this.Fl|0,g|0,b|0),{h:v,l:x}=ke.add(this.Gh|0,this.Gl|0,v|0,x|0),{h:P,l:E}=ke.add(this.Hh|0,this.Hl|0,P|0,E|0),this.set(i,o,s,r,a,c,u,l,d,h,g,b,v,x,P,E)}roundClean(){xo.fill(0),ko.fill(0)}destroy(){this.buffer.fill(0),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}},tw=class extends ud{constructor(){super(),this.Ah=573645204,this.Al=-64227540,this.Bh=-1621794909,this.Bl=-934517566,this.Ch=596883563,this.Cl=1867755857,this.Dh=-1774684391,this.Dl=1497426621,this.Eh=-1775747358,this.El=-1467023389,this.Fh=-1101128155,this.Fl=1401305490,this.Gh=721525244,this.Gl=746961066,this.Hh=246885852,this.Hl=-2117784414,this.outputLen=32}},ew=class extends ud{constructor(){super(),this.Ah=-876896931,this.Al=-1056596264,this.Bh=1654270250,this.Bl=914150663,this.Ch=-1856437926,this.Cl=812702999,this.Dh=355462360,this.Dl=-150054599,this.Eh=1731405415,this.El=-4191439,this.Fh=-1900787065,this.Fl=1750603025,this.Gh=-619958771,this.Gl=1694076839,this.Hh=1203062813,this.Hl=-1090891868,this.outputLen=48}};const m0=ga(()=>new ud);ga(()=>new tw);ga(()=>new ew);var Rl={},nw={get exports(){return Rl},set exports(e){Rl=e}},yc={},iw={get exports(){return yc},set exports(e){yc=e}},y0=function(t,n){return function(){for(var o=new Array(arguments.length),s=0;s<o.length;s++)o[s]=arguments[s];return t.apply(n,o)}},ow=y0,ld=Object.prototype.toString,dd=function(e){return function(t){var n=ld.call(t);return e[n]||(e[n]=n.slice(8,-1).toLowerCase())}}(Object.create(null));function ys(e){return e=e.toLowerCase(),function(n){return dd(n)===e}}function hd(e){return Array.isArray(e)}function wc(e){return typeof e>"u"}function sw(e){return e!==null&&!wc(e)&&e.constructor!==null&&!wc(e.constructor)&&typeof e.constructor.isBuffer=="function"&&e.constructor.isBuffer(e)}var w0=ys("ArrayBuffer");function rw(e){var t;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?t=ArrayBuffer.isView(e):t=e&&e.buffer&&w0(e.buffer),t}function aw(e){return typeof e=="string"}function cw(e){return typeof e=="number"}function b0(e){return e!==null&&typeof e=="object"}function tc(e){if(dd(e)!=="object")return!1;var t=Object.getPrototypeOf(e);return t===null||t===Object.prototype}var uw=ys("Date"),lw=ys("File"),dw=ys("Blob"),hw=ys("FileList");function fd(e){return ld.call(e)==="[object Function]"}function fw(e){return b0(e)&&fd(e.pipe)}function pw(e){var t="[object FormData]";return e&&(typeof FormData=="function"&&e instanceof FormData||ld.call(e)===t||fd(e.toString)&&e.toString()===t)}var gw=ys("URLSearchParams");function _w(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}function mw(){return typeof navigator<"u"&&(navigator.product==="ReactNative"||navigator.product==="NativeScript"||navigator.product==="NS")?!1:typeof window<"u"&&typeof document<"u"}function pd(e,t){if(!(e===null||typeof e>"u"))if(typeof e!="object"&&(e=[e]),hd(e))for(var n=0,i=e.length;n<i;n++)t.call(null,e[n],n,e);else for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.call(null,e[o],o,e)}function $l(){var e={};function t(o,s){tc(e[s])&&tc(o)?e[s]=$l(e[s],o):tc(o)?e[s]=$l({},o):hd(o)?e[s]=o.slice():e[s]=o}for(var n=0,i=arguments.length;n<i;n++)pd(arguments[n],t);return e}function yw(e,t,n){return pd(t,function(o,s){n&&typeof o=="function"?e[s]=ow(o,n):e[s]=o}),e}function ww(e){return e.charCodeAt(0)===65279&&(e=e.slice(1)),e}function bw(e,t,n,i){e.prototype=Object.create(t.prototype,i),e.prototype.constructor=e,n&&Object.assign(e.prototype,n)}function vw(e,t,n){var i,o,s,r={};t=t||{};do{for(i=Object.getOwnPropertyNames(e),o=i.length;o-- >0;)s=i[o],r[s]||(t[s]=e[s],r[s]=!0);e=Object.getPrototypeOf(e)}while(e&&(!n||n(e,t))&&e!==Object.prototype);return t}function Tw(e,t,n){e=String(e),(n===void 0||n>e.length)&&(n=e.length),n-=t.length;var i=e.indexOf(t,n);return i!==-1&&i===n}function Aw(e){if(!e)return null;var t=e.length;if(wc(t))return null;for(var n=new Array(t);t-- >0;)n[t]=e[t];return n}var xw=function(e){return function(t){return e&&t instanceof e}}(typeof Uint8Array<"u"&&Object.getPrototypeOf(Uint8Array)),ei={isArray:hd,isArrayBuffer:w0,isBuffer:sw,isFormData:pw,isArrayBufferView:rw,isString:aw,isNumber:cw,isObject:b0,isPlainObject:tc,isUndefined:wc,isDate:uw,isFile:lw,isBlob:dw,isFunction:fd,isStream:fw,isURLSearchParams:gw,isStandardBrowserEnv:mw,forEach:pd,merge:$l,extend:yw,trim:_w,stripBOM:ww,inherits:bw,toFlatObject:vw,kindOf:dd,kindOfTest:ys,endsWith:Tw,toArray:Aw,isTypedArray:xw,isFileList:hw},Os=ei;function ah(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}var v0=function(t,n,i){if(!n)return t;var o;if(i)o=i(n);else if(Os.isURLSearchParams(n))o=n.toString();else{var s=[];Os.forEach(n,function(c,u){c===null||typeof c>"u"||(Os.isArray(c)?u=u+"[]":c=[c],Os.forEach(c,function(d){Os.isDate(d)?d=d.toISOString():Os.isObject(d)&&(d=JSON.stringify(d)),s.push(ah(u)+"="+ah(d))}))}),o=s.join("&")}if(o){var r=t.indexOf("#");r!==-1&&(t=t.slice(0,r)),t+=(t.indexOf("?")===-1?"?":"&")+o}return t},kw=ei;function Fc(){this.handlers=[]}Fc.prototype.use=function(t,n,i){return this.handlers.push({fulfilled:t,rejected:n,synchronous:i?i.synchronous:!1,runWhen:i?i.runWhen:null}),this.handlers.length-1};Fc.prototype.eject=function(t){this.handlers[t]&&(this.handlers[t]=null)};Fc.prototype.forEach=function(t){kw.forEach(this.handlers,function(i){i!==null&&t(i)})};var Sw=Fc,Pw=ei,Cw=function(t,n){Pw.forEach(t,function(o,s){s!==n&&s.toUpperCase()===n.toUpperCase()&&(t[n]=o,delete t[s])})},T0=ei;function lr(e,t,n,i,o){Error.call(this),this.message=e,this.name="AxiosError",t&&(this.code=t),n&&(this.config=n),i&&(this.request=i),o&&(this.response=o)}T0.inherits(lr,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:this.config,code:this.code,status:this.response&&this.response.status?this.response.status:null}}});var A0=lr.prototype,x0={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED"].forEach(function(e){x0[e]={value:e}});Object.defineProperties(lr,x0);Object.defineProperty(A0,"isAxiosError",{value:!0});lr.from=function(e,t,n,i,o,s){var r=Object.create(A0);return T0.toFlatObject(e,r,function(c){return c!==Error.prototype}),lr.call(r,e.message,t,n,i,o),r.name=e.name,s&&Object.assign(r,s),r};var kr=lr,k0={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},Di=ei;function Bw(e,t){t=t||new FormData;var n=[];function i(s){return s===null?"":Di.isDate(s)?s.toISOString():Di.isArrayBuffer(s)||Di.isTypedArray(s)?typeof Blob=="function"?new Blob([s]):Buffer.from(s):s}function o(s,r){if(Di.isPlainObject(s)||Di.isArray(s)){if(n.indexOf(s)!==-1)throw Error("Circular reference detected in "+r);n.push(s),Di.forEach(s,function(c,u){if(!Di.isUndefined(c)){var l=r?r+"."+u:u,d;if(c&&!r&&typeof c=="object"){if(Di.endsWith(u,"{}"))c=JSON.stringify(c);else if(Di.endsWith(u,"[]")&&(d=Di.toArray(c))){d.forEach(function(h){!Di.isUndefined(h)&&t.append(l,i(h))});return}}o(c,l)}}),n.pop()}else t.append(r,i(s))}return o(e),t}var S0=Bw,Yu,ch;function Ew(){if(ch)return Yu;ch=1;var e=kr;return Yu=function(n,i,o){var s=o.config.validateStatus;!o.status||!s||s(o.status)?n(o):i(new e("Request failed with status code "+o.status,[e.ERR_BAD_REQUEST,e.ERR_BAD_RESPONSE][Math.floor(o.status/100)-4],o.config,o.request,o))},Yu}var Qu,uh;function Iw(){if(uh)return Qu;uh=1;var e=ei;return Qu=e.isStandardBrowserEnv()?function(){return{write:function(i,o,s,r,a,c){var u=[];u.push(i+"="+encodeURIComponent(o)),e.isNumber(s)&&u.push("expires="+new Date(s).toGMTString()),e.isString(r)&&u.push("path="+r),e.isString(a)&&u.push("domain="+a),c===!0&&u.push("secure"),document.cookie=u.join("; ")},read:function(i){var o=document.cookie.match(new RegExp("(^|;\\s*)("+i+")=([^;]*)"));return o?decodeURIComponent(o[3]):null},remove:function(i){this.write(i,"",Date.now()-864e5)}}}():function(){return{write:function(){},read:function(){return null},remove:function(){}}}(),Qu}var Ow=function(t){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(t)},Rw=function(t,n){return n?t.replace(/\/+$/,"")+"/"+n.replace(/^\/+/,""):t},$w=Ow,Uw=Rw,P0=function(t,n){return t&&!$w(n)?Uw(t,n):n},tl,lh;function qw(){if(lh)return tl;lh=1;var e=ei,t=["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"];return tl=function(i){var o={},s,r,a;return i&&e.forEach(i.split(`
`),function(u){if(a=u.indexOf(":"),s=e.trim(u.substr(0,a)).toLowerCase(),r=e.trim(u.substr(a+1)),s){if(o[s]&&t.indexOf(s)>=0)return;s==="set-cookie"?o[s]=(o[s]?o[s]:[]).concat([r]):o[s]=o[s]?o[s]+", "+r:r}}),o},tl}var el,dh;function Mw(){if(dh)return el;dh=1;var e=ei;return el=e.isStandardBrowserEnv()?function(){var n=/(msie|trident)/i.test(navigator.userAgent),i=document.createElement("a"),o;function s(r){var a=r;return n&&(i.setAttribute("href",a),a=i.href),i.setAttribute("href",a),{href:i.href,protocol:i.protocol?i.protocol.replace(/:$/,""):"",host:i.host,search:i.search?i.search.replace(/^\?/,""):"",hash:i.hash?i.hash.replace(/^#/,""):"",hostname:i.hostname,port:i.port,pathname:i.pathname.charAt(0)==="/"?i.pathname:"/"+i.pathname}}return o=s(window.location.href),function(a){var c=e.isString(a)?s(a):a;return c.protocol===o.protocol&&c.host===o.host}}():function(){return function(){return!0}}(),el}var nl,hh;function jc(){if(hh)return nl;hh=1;var e=kr,t=ei;function n(i){e.call(this,i??"canceled",e.ERR_CANCELED),this.name="CanceledError"}return t.inherits(n,e,{__CANCEL__:!0}),nl=n,nl}var il,fh;function Dw(){return fh||(fh=1,il=function(t){var n=/^([-+\w]{1,25})(:?\/\/|:)/.exec(t);return n&&n[1]||""}),il}var ol,ph;function gh(){if(ph)return ol;ph=1;var e=ei,t=Ew(),n=Iw(),i=v0,o=P0,s=qw(),r=Mw(),a=k0,c=kr,u=jc(),l=Dw();return ol=function(h){return new Promise(function(b,v){var x=h.data,P=h.headers,E=h.responseType,S;function T(){h.cancelToken&&h.cancelToken.unsubscribe(S),h.signal&&h.signal.removeEventListener("abort",S)}e.isFormData(x)&&e.isStandardBrowserEnv()&&delete P["Content-Type"];var R=new XMLHttpRequest;if(h.auth){var K=h.auth.username||"",V=h.auth.password?unescape(encodeURIComponent(h.auth.password)):"";P.Authorization="Basic "+btoa(K+":"+V)}var W=o(h.baseURL,h.url);R.open(h.method.toUpperCase(),i(W,h.params,h.paramsSerializer),!0),R.timeout=h.timeout;function tt(){if(R){var q="getAllResponseHeaders"in R?s(R.getAllResponseHeaders()):null,A=!E||E==="text"||E==="json"?R.responseText:R.response,f={data:A,status:R.status,statusText:R.statusText,headers:q,config:h,request:R};t(function(k){b(k),T()},function(k){v(k),T()},f),R=null}}if("onloadend"in R?R.onloadend=tt:R.onreadystatechange=function(){!R||R.readyState!==4||R.status===0&&!(R.responseURL&&R.responseURL.indexOf("file:")===0)||setTimeout(tt)},R.onabort=function(){R&&(v(new c("Request aborted",c.ECONNABORTED,h,R)),R=null)},R.onerror=function(){v(new c("Network Error",c.ERR_NETWORK,h,R,R)),R=null},R.ontimeout=function(){var A=h.timeout?"timeout of "+h.timeout+"ms exceeded":"timeout exceeded",f=h.transitional||a;h.timeoutErrorMessage&&(A=h.timeoutErrorMessage),v(new c(A,f.clarifyTimeoutError?c.ETIMEDOUT:c.ECONNABORTED,h,R)),R=null},e.isStandardBrowserEnv()){var j=(h.withCredentials||r(W))&&h.xsrfCookieName?n.read(h.xsrfCookieName):void 0;j&&(P[h.xsrfHeaderName]=j)}"setRequestHeader"in R&&e.forEach(P,function(A,f){typeof x>"u"&&f.toLowerCase()==="content-type"?delete P[f]:R.setRequestHeader(f,A)}),e.isUndefined(h.withCredentials)||(R.withCredentials=!!h.withCredentials),E&&E!=="json"&&(R.responseType=h.responseType),typeof h.onDownloadProgress=="function"&&R.addEventListener("progress",h.onDownloadProgress),typeof h.onUploadProgress=="function"&&R.upload&&R.upload.addEventListener("progress",h.onUploadProgress),(h.cancelToken||h.signal)&&(S=function(q){R&&(v(!q||q&&q.type?new u:q),R.abort(),R=null)},h.cancelToken&&h.cancelToken.subscribe(S),h.signal&&(h.signal.aborted?S():h.signal.addEventListener("abort",S))),x||(x=null);var $=l(W);if($&&["http","https","file"].indexOf($)===-1){v(new c("Unsupported protocol "+$+":",c.ERR_BAD_REQUEST,h));return}R.send(x)})},ol}var sl,_h;function Lw(){return _h||(_h=1,sl=null),sl}var Ln=ei,mh=Cw,yh=kr,Nw=k0,Fw=S0,jw={"Content-Type":"application/x-www-form-urlencoded"};function wh(e,t){!Ln.isUndefined(e)&&Ln.isUndefined(e["Content-Type"])&&(e["Content-Type"]=t)}function zw(){var e;return(typeof XMLHttpRequest<"u"||typeof process<"u"&&Object.prototype.toString.call(process)==="[object process]")&&(e=gh()),e}function Hw(e,t,n){if(Ln.isString(e))try{return(t||JSON.parse)(e),Ln.trim(e)}catch(i){if(i.name!=="SyntaxError")throw i}return(n||JSON.stringify)(e)}var zc={transitional:Nw,adapter:zw(),transformRequest:[function(t,n){if(mh(n,"Accept"),mh(n,"Content-Type"),Ln.isFormData(t)||Ln.isArrayBuffer(t)||Ln.isBuffer(t)||Ln.isStream(t)||Ln.isFile(t)||Ln.isBlob(t))return t;if(Ln.isArrayBufferView(t))return t.buffer;if(Ln.isURLSearchParams(t))return wh(n,"application/x-www-form-urlencoded;charset=utf-8"),t.toString();var i=Ln.isObject(t),o=n&&n["Content-Type"],s;if((s=Ln.isFileList(t))||i&&o==="multipart/form-data"){var r=this.env&&this.env.FormData;return Fw(s?{"files[]":t}:t,r&&new r)}else if(i||o==="application/json")return wh(n,"application/json"),Hw(t);return t}],transformResponse:[function(t){var n=this.transitional||zc.transitional,i=n&&n.silentJSONParsing,o=n&&n.forcedJSONParsing,s=!i&&this.responseType==="json";if(s||o&&Ln.isString(t)&&t.length)try{return JSON.parse(t)}catch(r){if(s)throw r.name==="SyntaxError"?yh.from(r,yh.ERR_BAD_RESPONSE,this,null,this.response):r}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:Lw()},validateStatus:function(t){return t>=200&&t<300},headers:{common:{Accept:"application/json, text/plain, */*"}}};Ln.forEach(["delete","get","head"],function(t){zc.headers[t]={}});Ln.forEach(["post","put","patch"],function(t){zc.headers[t]=Ln.merge(jw)});var gd=zc,Kw=ei,Gw=gd,Ww=function(t,n,i){var o=this||Gw;return Kw.forEach(i,function(r){t=r.call(o,t,n)}),t},rl,bh;function C0(){return bh||(bh=1,rl=function(t){return!!(t&&t.__CANCEL__)}),rl}var vh=ei,al=Ww,Xw=C0(),Vw=gd,Jw=jc();function cl(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new Jw}var Zw=function(t){cl(t),t.headers=t.headers||{},t.data=al.call(t,t.data,t.headers,t.transformRequest),t.headers=vh.merge(t.headers.common||{},t.headers[t.method]||{},t.headers),vh.forEach(["delete","get","head","post","put","patch","common"],function(o){delete t.headers[o]});var n=t.adapter||Vw.adapter;return n(t).then(function(o){return cl(t),o.data=al.call(t,o.data,o.headers,t.transformResponse),o},function(o){return Xw(o)||(cl(t),o&&o.response&&(o.response.data=al.call(t,o.response.data,o.response.headers,t.transformResponse))),Promise.reject(o)})},yi=ei,B0=function(t,n){n=n||{};var i={};function o(l,d){return yi.isPlainObject(l)&&yi.isPlainObject(d)?yi.merge(l,d):yi.isPlainObject(d)?yi.merge({},d):yi.isArray(d)?d.slice():d}function s(l){if(yi.isUndefined(n[l])){if(!yi.isUndefined(t[l]))return o(void 0,t[l])}else return o(t[l],n[l])}function r(l){if(!yi.isUndefined(n[l]))return o(void 0,n[l])}function a(l){if(yi.isUndefined(n[l])){if(!yi.isUndefined(t[l]))return o(void 0,t[l])}else return o(void 0,n[l])}function c(l){if(l in n)return o(t[l],n[l]);if(l in t)return o(void 0,t[l])}var u={url:r,method:r,data:r,baseURL:a,transformRequest:a,transformResponse:a,paramsSerializer:a,timeout:a,timeoutMessage:a,withCredentials:a,adapter:a,responseType:a,xsrfCookieName:a,xsrfHeaderName:a,onUploadProgress:a,onDownloadProgress:a,decompress:a,maxContentLength:a,maxBodyLength:a,beforeRedirect:a,transport:a,httpAgent:a,httpsAgent:a,cancelToken:a,socketPath:a,responseEncoding:a,validateStatus:c};return yi.forEach(Object.keys(t).concat(Object.keys(n)),function(d){var h=u[d]||s,g=h(d);yi.isUndefined(g)&&h!==c||(i[d]=g)}),i},ul,Th;function E0(){return Th||(Th=1,ul={version:"0.27.2"}),ul}var Yw=E0().version,Do=kr,_d={};["object","boolean","number","function","string","symbol"].forEach(function(e,t){_d[e]=function(i){return typeof i===e||"a"+(t<1?"n ":" ")+e}});var Ah={};_d.transitional=function(t,n,i){function o(s,r){return"[Axios v"+Yw+"] Transitional option '"+s+"'"+r+(i?". "+i:"")}return function(s,r,a){if(t===!1)throw new Do(o(r," has been removed"+(n?" in "+n:"")),Do.ERR_DEPRECATED);return n&&!Ah[r]&&(Ah[r]=!0,console.warn(o(r," has been deprecated since v"+n+" and will be removed in the near future"))),t?t(s,r,a):!0}};function Qw(e,t,n){if(typeof e!="object")throw new Do("options must be an object",Do.ERR_BAD_OPTION_VALUE);for(var i=Object.keys(e),o=i.length;o-- >0;){var s=i[o],r=t[s];if(r){var a=e[s],c=a===void 0||r(a,s,e);if(c!==!0)throw new Do("option "+s+" must be "+c,Do.ERR_BAD_OPTION_VALUE);continue}if(n!==!0)throw new Do("Unknown option "+s,Do.ERR_BAD_OPTION)}}var tb={assertOptions:Qw,validators:_d},I0=ei,eb=v0,xh=Sw,kh=Zw,Hc=B0,nb=P0,O0=tb,Rs=O0.validators;function dr(e){this.defaults=e,this.interceptors={request:new xh,response:new xh}}dr.prototype.request=function(t,n){typeof t=="string"?(n=n||{},n.url=t):n=t||{},n=Hc(this.defaults,n),n.method?n.method=n.method.toLowerCase():this.defaults.method?n.method=this.defaults.method.toLowerCase():n.method="get";var i=n.transitional;i!==void 0&&O0.assertOptions(i,{silentJSONParsing:Rs.transitional(Rs.boolean),forcedJSONParsing:Rs.transitional(Rs.boolean),clarifyTimeoutError:Rs.transitional(Rs.boolean)},!1);var o=[],s=!0;this.interceptors.request.forEach(function(g){typeof g.runWhen=="function"&&g.runWhen(n)===!1||(s=s&&g.synchronous,o.unshift(g.fulfilled,g.rejected))});var r=[];this.interceptors.response.forEach(function(g){r.push(g.fulfilled,g.rejected)});var a;if(!s){var c=[kh,void 0];for(Array.prototype.unshift.apply(c,o),c=c.concat(r),a=Promise.resolve(n);c.length;)a=a.then(c.shift(),c.shift());return a}for(var u=n;o.length;){var l=o.shift(),d=o.shift();try{u=l(u)}catch(h){d(h);break}}try{a=kh(u)}catch(h){return Promise.reject(h)}for(;r.length;)a=a.then(r.shift(),r.shift());return a};dr.prototype.getUri=function(t){t=Hc(this.defaults,t);var n=nb(t.baseURL,t.url);return eb(n,t.params,t.paramsSerializer)};I0.forEach(["delete","get","head","options"],function(t){dr.prototype[t]=function(n,i){return this.request(Hc(i||{},{method:t,url:n,data:(i||{}).data}))}});I0.forEach(["post","put","patch"],function(t){function n(i){return function(s,r,a){return this.request(Hc(a||{},{method:t,headers:i?{"Content-Type":"multipart/form-data"}:{},url:s,data:r}))}}dr.prototype[t]=n(),dr.prototype[t+"Form"]=n(!0)});var ib=dr,ll,Sh;function ob(){if(Sh)return ll;Sh=1;var e=jc();function t(n){if(typeof n!="function")throw new TypeError("executor must be a function.");var i;this.promise=new Promise(function(r){i=r});var o=this;this.promise.then(function(s){if(o._listeners){var r,a=o._listeners.length;for(r=0;r<a;r++)o._listeners[r](s);o._listeners=null}}),this.promise.then=function(s){var r,a=new Promise(function(c){o.subscribe(c),r=c}).then(s);return a.cancel=function(){o.unsubscribe(r)},a},n(function(r){o.reason||(o.reason=new e(r),i(o.reason))})}return t.prototype.throwIfRequested=function(){if(this.reason)throw this.reason},t.prototype.subscribe=function(i){if(this.reason){i(this.reason);return}this._listeners?this._listeners.push(i):this._listeners=[i]},t.prototype.unsubscribe=function(i){if(this._listeners){var o=this._listeners.indexOf(i);o!==-1&&this._listeners.splice(o,1)}},t.source=function(){var i,o=new t(function(r){i=r});return{token:o,cancel:i}},ll=t,ll}var dl,Ph;function sb(){return Ph||(Ph=1,dl=function(t){return function(i){return t.apply(null,i)}}),dl}var hl,Ch;function rb(){if(Ch)return hl;Ch=1;var e=ei;return hl=function(n){return e.isObject(n)&&n.isAxiosError===!0},hl}var Bh=ei,ab=y0,ec=ib,cb=B0,ub=gd;function R0(e){var t=new ec(e),n=ab(ec.prototype.request,t);return Bh.extend(n,ec.prototype,t),Bh.extend(n,t),n.create=function(o){return R0(cb(e,o))},n}var mi=R0(ub);mi.Axios=ec;mi.CanceledError=jc();mi.CancelToken=ob();mi.isCancel=C0();mi.VERSION=E0().version;mi.toFormData=S0;mi.AxiosError=kr;mi.Cancel=mi.CanceledError;mi.all=function(t){return Promise.all(t)};mi.spread=sb();mi.isAxiosError=rb();iw.exports=mi;yc.default=mi;(function(e){e.exports=yc})(nw);const ds=qf(Rl);async function lb(e){var t;const{params:n,method:i,url:o,headers:s,body:r,overrides:a}=e,c={headers:s,method:i,url:o,params:n,data:r,withCredentials:(t=a==null?void 0:a.WITH_CREDENTIALS)!=null?t:!0};try{const u=await ds(c);return{status:u.status,statusText:u.statusText,data:u.data,headers:u.headers,config:u.config}}catch(u){const l=u;if(l.response)return l.response;throw u}}var Ul={},db={get exports(){return Ul},set exports(e){Ul=e}};(function(e){var t=Object.prototype.hasOwnProperty,n="~";function i(){}Object.create&&(i.prototype=Object.create(null),new i().__proto__||(n=!1));function o(c,u,l){this.fn=c,this.context=u,this.once=l||!1}function s(c,u,l,d,h){if(typeof l!="function")throw new TypeError("The listener must be a function");var g=new o(l,d||c,h),b=n?n+u:u;return c._events[b]?c._events[b].fn?c._events[b]=[c._events[b],g]:c._events[b].push(g):(c._events[b]=g,c._eventsCount++),c}function r(c,u){--c._eventsCount===0?c._events=new i:delete c._events[u]}function a(){this._events=new i,this._eventsCount=0}a.prototype.eventNames=function(){var u=[],l,d;if(this._eventsCount===0)return u;for(d in l=this._events)t.call(l,d)&&u.push(n?d.slice(1):d);return Object.getOwnPropertySymbols?u.concat(Object.getOwnPropertySymbols(l)):u},a.prototype.listeners=function(u){var l=n?n+u:u,d=this._events[l];if(!d)return[];if(d.fn)return[d.fn];for(var h=0,g=d.length,b=new Array(g);h<g;h++)b[h]=d[h].fn;return b},a.prototype.listenerCount=function(u){var l=n?n+u:u,d=this._events[l];return d?d.fn?1:d.length:0},a.prototype.emit=function(u,l,d,h,g,b){var v=n?n+u:u;if(!this._events[v])return!1;var x=this._events[v],P=arguments.length,E,S;if(x.fn){switch(x.once&&this.removeListener(u,x.fn,void 0,!0),P){case 1:return x.fn.call(x.context),!0;case 2:return x.fn.call(x.context,l),!0;case 3:return x.fn.call(x.context,l,d),!0;case 4:return x.fn.call(x.context,l,d,h),!0;case 5:return x.fn.call(x.context,l,d,h,g),!0;case 6:return x.fn.call(x.context,l,d,h,g,b),!0}for(S=1,E=new Array(P-1);S<P;S++)E[S-1]=arguments[S];x.fn.apply(x.context,E)}else{var T=x.length,R;for(S=0;S<T;S++)switch(x[S].once&&this.removeListener(u,x[S].fn,void 0,!0),P){case 1:x[S].fn.call(x[S].context);break;case 2:x[S].fn.call(x[S].context,l);break;case 3:x[S].fn.call(x[S].context,l,d);break;case 4:x[S].fn.call(x[S].context,l,d,h);break;default:if(!E)for(R=1,E=new Array(P-1);R<P;R++)E[R-1]=arguments[R];x[S].fn.apply(x[S].context,E)}}return!0},a.prototype.on=function(u,l,d){return s(this,u,l,d,!1)},a.prototype.once=function(u,l,d){return s(this,u,l,d,!0)},a.prototype.removeListener=function(u,l,d,h){var g=n?n+u:u;if(!this._events[g])return this;if(!l)return r(this,g),this;var b=this._events[g];if(b.fn)b.fn===l&&(!h||b.once)&&(!d||b.context===d)&&r(this,g);else{for(var v=0,x=[],P=b.length;v<P;v++)(b[v].fn!==l||h&&!b[v].once||d&&b[v].context!==d)&&x.push(b[v]);x.length?this._events[g]=x.length===1?x[0]:x:r(this,g)}return this},a.prototype.removeAllListeners=function(u){var l;return u?(l=n?n+u:u,this._events[l]&&r(this,l)):(this._events=new i,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=n,a.EventEmitter=a,e.exports=a})(db);var $0=Object.defineProperty,hb=Object.getOwnPropertyDescriptor,Kc=(e,t)=>{for(var n in t)$0(e,n,{get:t[n],enumerable:!0})},un=(e,t,n,i)=>{for(var o=i>1?void 0:i?hb(t,n):t,s=e.length-1,r;s>=0;s--)(r=e[s])&&(o=(i?r(t,n,o):r(o))||o);return i&&o&&$0(t,n,o),o},fb=/^m(\/[0-9]+')+$/,U0=e=>e.replace("'",""),pb="ed25519 seed",gb=2147483648,q0=e=>{const n=cd.create(m0,pb).update(r0(e)).digest(),i=n.slice(0,32),o=n.slice(32);return{key:i,chainCode:o}},M0=({key:e,chainCode:t},n)=>{const i=new ArrayBuffer(4);new DataView(i).setUint32(0,n);const o=new Uint8Array(i),s=new Uint8Array([0]),r=new Uint8Array([...s,...e,...o]),a=cd.create(m0,t).update(r).digest(),c=a.slice(0,32),u=a.slice(32);return{key:c,chainCode:u}},_b=(e,t=!0)=>{const i=no.sign.keyPair.fromSeed(e).secretKey.subarray(32),o=new Uint8Array([0]);return t?new Uint8Array([...o,...i]):i},D0=e=>fb.test(e)?!e.split("/").slice(1).map(U0).some(Number.isNaN):!1,L0=(e,t,n=gb)=>{if(!D0(e))throw new Error("Invalid derivation path");const{key:i,chainCode:o}=q0(t);return e.split("/").slice(1).map(U0).map(r=>parseInt(r,10)).reduce((r,a)=>M0(r,a+n),{key:i,chainCode:o})},mb="1.20.0";async function zr(e){return new Promise(t=>{setTimeout(t,e)})}var Eh="/v1";function yb(e){let t=`${e}`;return t.endsWith("/")&&(t=t.substring(0,t.length-1)),t.endsWith(Eh)||(t=`${t}${Eh}`),t}var N0=2e5,F0=20,j0=20,bc="0x1::aptos_coin::AptosCoin";function Gc(e){let t,n,i;return typeof e=="object"?(t=e.hashFunction,n=e.ttlMs,i=e.tags):t=e,(o,s,r)=>{if(r.value!=null)r.value=Ih(r.value,t,n,i);else if(r.get!=null)r.get=Ih(r.get,t,n,i);else throw new Error("Only put a Memoize() decorator on a method or get accessor.")}}function z0(e,t){return Gc({ttlMs:e,hashFunction:t})}var nc=new Map;function wb(e){const t=new Set;for(const n of e){const i=nc.get(n);if(i)for(const o of i)t.has(o)||(o.clear(),t.add(o))}return t.size}function Ih(e,t,n=0,i){const o=Symbol("__memoized_map__");return function(...s){let r;const a=this;a.hasOwnProperty(o)||Object.defineProperty(a,o,{configurable:!1,enumerable:!1,writable:!1,value:new Map});const c=a[o];if(Array.isArray(i))for(const u of i)nc.has(u)?nc.get(u).push(c):nc.set(u,[c]);if(t||s.length>0||n>0){let u;t===!0?u=s.map(h=>h.toString()).join("!"):t?u=t.apply(a,s):u=s[0];const l=`${u}__timestamp`;let d=!1;if(n>0)if(!c.has(l))d=!0;else{const h=c.get(l);d=Date.now()-h>n}c.has(u)&&!d?r=c.get(u):(r=e.apply(a,s),c.set(u,r),n>0&&c.set(l,Date.now()))}else{const u=a;c.has(u)?r=c.get(u):(r=e.apply(a,s),c.set(u,r))}return r}}var md=class extends Error{constructor(e,t,n){super(n),this.name="AptosApiError",this.url=t.url,this.status=t.status,this.statusText=t.statusText,this.data=t.data,this.request=e}},bb={400:"Bad Request",401:"Unauthorized",403:"Forbidden",404:"Not Found",429:"Too Many Requests",500:"Internal Server Error",502:"Bad Gateway",503:"Service Unavailable"};async function vb(e,t,n,i,o,s){const r={...s==null?void 0:s.HEADERS,"x-aptos-client":`aptos-ts-sdk/${mb}`,"content-type":i??"application/json"};return s!=null&&s.TOKEN&&(r.Authorization=`Bearer ${s==null?void 0:s.TOKEN}`),await lb({url:e,method:t,body:n,params:o,headers:r,overrides:s})}async function yd(e){const{url:t,endpoint:n,method:i,body:o,contentType:s,params:r,overrides:a}=e,c=`${t}/${n??""}`,u=await vb(c,i,o,s,r,a),l={status:u.status,statusText:u.statusText,data:u.data,headers:u.headers,config:u.config,url:c};if(l.status>=200&&l.status<300)return l;const d=bb[l.status];throw new md(e,l,d??"Generic Error")}async function ui(e){return await yd({...e,method:"GET"})}async function ns(e){return await yd({...e,method:"POST"})}async function Oh(e){const t=[];let n;const i=e.params;for(;;){i.start=n;const o=await ui({url:e.url,endpoint:e.endpoint,params:i,originMethod:e.originMethod,overrides:e.overrides});if(n=o.headers["x-aptos-cursor"],delete o.headers,t.push(...o.data),n==null)break}return t}var vc={mainnet:"https://indexer.mainnet.aptoslabs.com/v1/graphql",testnet:"https://indexer-testnet.staging.gcp.aptosdev.com/v1/graphql",devnet:"https://indexer-devnet.staging.gcp.aptosdev.com/v1/graphql"},H0={mainnet:"https://fullnode.mainnet.aptoslabs.com/v1",testnet:"https://fullnode.testnet.aptoslabs.com/v1",devnet:"https://fullnode.devnet.aptoslabs.com/v1",local:"http://localhost:8080/v1"},ql={"https://fullnode.mainnet.aptoslabs.com/v1":"mainnet","https://fullnode.testnet.aptoslabs.com/v1":"testnet","https://fullnode.devnet.aptoslabs.com/v1":"devnet","http://localhost:8080/v1":"local"},K0=(e=>(e.MAINNET="mainnet",e.TESTNET="testnet",e.DEVNET="devnet",e.LOCAL="local",e))(K0||{}),Et=class{static fromBuffer(t){return Et.fromUint8Array(t)}static fromUint8Array(t){return new Et(s0(t))}static ensure(t){return typeof t=="string"?new Et(t):t}constructor(t){t.startsWith("0x")?this.hexString=t:this.hexString=`0x${t}`}hex(){return this.hexString}noPrefix(){return this.hexString.slice(2)}toString(){return this.hex()}toShortString(){return`0x${this.hexString.replace(/^0x0*/,"")}`}toUint8Array(){return Uint8Array.from(r0(this.noPrefix()))}},re={};Kc(re,{AccountAddress:()=>nn,AccountAuthenticator:()=>Ko,AccountAuthenticatorEd25519:()=>Td,AccountAuthenticatorMultiEd25519:()=>Ad,ArgumentABI:()=>ba,AuthenticationKey:()=>fs,ChainId:()=>eu,ChangeSet:()=>Lb,Ed25519PublicKey:()=>Oi,Ed25519Signature:()=>Yi,EntryFunction:()=>ss,EntryFunctionABI:()=>hr,FeePayerRawTransaction:()=>Yc,Identifier:()=>Yn,Module:()=>V0,ModuleId:()=>hs,MultiAgentRawTransaction:()=>Zc,MultiEd25519PublicKey:()=>_a,MultiEd25519Signature:()=>Wc,MultiSig:()=>Pd,MultiSigTransactionPayload:()=>Sd,RawTransaction:()=>xs,RawTransactionWithData:()=>Cd,RotationProofChallenge:()=>Fb,Script:()=>Jc,ScriptABI:()=>du,SignedTransaction:()=>ma,StructTag:()=>Xo,Transaction:()=>J0,TransactionArgument:()=>Ki,TransactionArgumentAddress:()=>cu,TransactionArgumentBool:()=>lu,TransactionArgumentU128:()=>ru,TransactionArgumentU16:()=>iu,TransactionArgumentU256:()=>au,TransactionArgumentU32:()=>ou,TransactionArgumentU64:()=>su,TransactionArgumentU8:()=>nu,TransactionArgumentU8Vector:()=>uu,TransactionAuthenticator:()=>Sr,TransactionAuthenticatorEd25519:()=>Xc,TransactionAuthenticatorFeePayer:()=>vd,TransactionAuthenticatorMultiAgent:()=>bd,TransactionAuthenticatorMultiEd25519:()=>Vc,TransactionPayload:()=>ya,TransactionPayloadEntryFunction:()=>tu,TransactionPayloadMultisig:()=>Bd,TransactionPayloadScript:()=>Qc,TransactionScriptABI:()=>hu,TypeArgumentABI:()=>wa,TypeTag:()=>Qn,TypeTagAddress:()=>Go,TypeTagBool:()=>bs,TypeTagParser:()=>As,TypeTagParserError:()=>X0,TypeTagSigner:()=>xd,TypeTagStruct:()=>Wo,TypeTagU128:()=>Ts,TypeTagU16:()=>Pr,TypeTagU256:()=>Br,TypeTagU32:()=>Cr,TypeTagU64:()=>vs,TypeTagU8:()=>fo,TypeTagVector:()=>Er,UserTransaction:()=>Ed,WriteSet:()=>Nb,objectStructTag:()=>Ub,optionStructTag:()=>$b,stringStructTag:()=>kd});var G0={};Kc(G0,{Deserializer:()=>wd,Serializer:()=>gn,bcsSerializeBool:()=>Ib,bcsSerializeBytes:()=>Uo,bcsSerializeFixedBytes:()=>Rb,bcsSerializeStr:()=>Ob,bcsSerializeU128:()=>Bb,bcsSerializeU16:()=>Pb,bcsSerializeU256:()=>Eb,bcsSerializeU32:()=>Cb,bcsSerializeU8:()=>Ml,bcsSerializeUint64:()=>Sb,bcsToBytes:()=>zi,deserializeVector:()=>hi,serializeVector:()=>Zn,serializeVectorWithFunc:()=>kb});var Tb=2**8-1,Ab=2**16-1,na=2**32-1,tr=BigInt(2**64)-BigInt(1),W0=BigInt(2**128)-BigInt(1),xb=BigInt(2**256)-BigInt(1),gn=class{constructor(){this.buffer=new ArrayBuffer(64),this.offset=0}ensureBufferWillHandleSize(t){for(;this.buffer.byteLength<this.offset+t;){const n=new ArrayBuffer(this.buffer.byteLength*2);new Uint8Array(n).set(new Uint8Array(this.buffer)),this.buffer=n}}serialize(t){this.ensureBufferWillHandleSize(t.length),new Uint8Array(this.buffer,this.offset).set(t),this.offset+=t.length}serializeWithFunction(t,n,i){this.ensureBufferWillHandleSize(n);const o=new DataView(this.buffer,this.offset);t.apply(o,[0,i,!0]),this.offset+=n}serializeStr(t){const n=new TextEncoder;this.serializeBytes(n.encode(t))}serializeBytes(t){this.serializeU32AsUleb128(t.length),this.serialize(t)}serializeFixedBytes(t){this.serialize(t)}serializeBool(t){if(typeof t!="boolean")throw new Error("Value needs to be a boolean");const n=t?1:0;this.serialize(new Uint8Array([n]))}serializeU8(t){this.serialize(new Uint8Array([t]))}serializeU16(t){this.serializeWithFunction(DataView.prototype.setUint16,2,t)}serializeU32(t){this.serializeWithFunction(DataView.prototype.setUint32,4,t)}serializeU64(t){const n=BigInt(t.toString())&BigInt(na),i=BigInt(t.toString())>>BigInt(32);this.serializeU32(Number(n)),this.serializeU32(Number(i))}serializeU128(t){const n=BigInt(t.toString())&tr,i=BigInt(t.toString())>>BigInt(64);this.serializeU64(n),this.serializeU64(i)}serializeU256(t){const n=BigInt(t.toString())&W0,i=BigInt(t.toString())>>BigInt(128);this.serializeU128(n),this.serializeU128(i)}serializeU32AsUleb128(t){let n=t;const i=[];for(;n>>>7;)i.push(n&127|128),n>>>=7;i.push(n),this.serialize(new Uint8Array(i))}getBytes(){return new Uint8Array(this.buffer).slice(0,this.offset)}};un([ws(0,Tb)],gn.prototype,"serializeU8",1);un([ws(0,Ab)],gn.prototype,"serializeU16",1);un([ws(0,na)],gn.prototype,"serializeU32",1);un([ws(BigInt(0),tr)],gn.prototype,"serializeU64",1);un([ws(BigInt(0),W0)],gn.prototype,"serializeU128",1);un([ws(BigInt(0),xb)],gn.prototype,"serializeU256",1);un([ws(0,na)],gn.prototype,"serializeU32AsUleb128",1);function ws(e,t,n){return(i,o,s)=>{const r=s.value;return s.value=function(c){const u=BigInt(c.toString());if(u>BigInt(t.toString())||u<BigInt(e.toString()))throw new Error(n||"Value is out of range");r.apply(this,[c])},s}}var wd=class{constructor(t){this.buffer=new ArrayBuffer(t.length),new Uint8Array(this.buffer).set(t,0),this.offset=0}read(t){if(this.offset+t>this.buffer.byteLength)throw new Error("Reached to the end of buffer");const n=this.buffer.slice(this.offset,this.offset+t);return this.offset+=t,n}deserializeStr(){const t=this.deserializeBytes();return new TextDecoder().decode(t)}deserializeBytes(){const t=this.deserializeUleb128AsU32();return new Uint8Array(this.read(t))}deserializeFixedBytes(t){return new Uint8Array(this.read(t))}deserializeBool(){const t=new Uint8Array(this.read(1))[0];if(t!==1&&t!==0)throw new Error("Invalid boolean value");return t===1}deserializeU8(){return new DataView(this.read(1)).getUint8(0)}deserializeU16(){return new DataView(this.read(2)).getUint16(0,!0)}deserializeU32(){return new DataView(this.read(4)).getUint32(0,!0)}deserializeU64(){const t=this.deserializeU32(),n=this.deserializeU32();return BigInt(BigInt(n)<<BigInt(32)|BigInt(t))}deserializeU128(){const t=this.deserializeU64(),n=this.deserializeU64();return BigInt(n<<BigInt(64)|t)}deserializeU256(){const t=this.deserializeU128(),n=this.deserializeU128();return BigInt(n<<BigInt(128)|t)}deserializeUleb128AsU32(){let t=BigInt(0),n=0;for(;t<na;){const i=this.deserializeU8();if(t|=BigInt(i&127)<<BigInt(n),!(i&128))break;n+=7}if(t>na)throw new Error("Overflow while parsing uleb128-encoded uint32 value");return Number(t)}};function Zn(e,t){t.serializeU32AsUleb128(e.length),e.forEach(n=>{n.serialize(t)})}function kb(e,t){const n=new gn;n.serializeU32AsUleb128(e.length);const i=n[t];return e.forEach(o=>{i.call(n,o)}),n.getBytes()}function hi(e,t){const n=e.deserializeUleb128AsU32(),i=[];for(let o=0;o<n;o+=1)i.push(t.deserialize(e));return i}function zi(e){const t=new gn;return e.serialize(t),t.getBytes()}function Sb(e){const t=new gn;return t.serializeU64(e),t.getBytes()}function Ml(e){const t=new gn;return t.serializeU8(e),t.getBytes()}function Pb(e){const t=new gn;return t.serializeU16(e),t.getBytes()}function Cb(e){const t=new gn;return t.serializeU32(e),t.getBytes()}function Bb(e){const t=new gn;return t.serializeU128(e),t.getBytes()}function Eb(e){const t=new gn;return t.serializeU256(e),t.getBytes()}function Ib(e){const t=new gn;return t.serializeBool(e),t.getBytes()}function Ob(e){const t=new gn;return t.serializeStr(e),t.getBytes()}function Uo(e){const t=new gn;return t.serializeBytes(e),t.getBytes()}function Rb(e){const t=new gn;return t.serializeFixedBytes(e),t.getBytes()}var Pi=class{constructor(t){if(t.length!==Pi.LENGTH)throw new Error("Expected address of length 32");this.address=t}static fromHex(t){let n=Et.ensure(t);n.noPrefix().length%2!==0&&(n=new Et(`0${n.noPrefix()}`));const i=n.toUint8Array();if(i.length>Pi.LENGTH)throw new Error("Hex string is too long. Address's length is 32 bytes.");if(i.length===Pi.LENGTH)return new Pi(i);const o=new Uint8Array(Pi.LENGTH);return o.set(i,Pi.LENGTH-i.length),new Pi(o)}static isValid(t){if(t==="")return!1;let n=Et.ensure(t);return n.noPrefix().length%2!==0&&(n=new Et(`0${n.noPrefix()}`)),n.toUint8Array().length<=Pi.LENGTH}toHexString(){return Et.fromUint8Array(this.address).hex()}serialize(t){t.serializeFixedBytes(this.address)}static deserialize(t){return new Pi(t.deserializeFixedBytes(Pi.LENGTH))}static standardizeAddress(t){const n=t.toLowerCase();return`0x${(n.startsWith("0x")?n.slice(2):n).padStart(64,"0")}`}},nn=Pi;nn.LENGTH=32;nn.CORE_CODE_ADDRESS=Pi.fromHex("0x1");var ic=class{constructor(t){if(t.length!==ic.LENGTH)throw new Error(`Ed25519PublicKey length should be ${ic.LENGTH}`);this.value=t}toBytes(){return this.value}serialize(t){t.serializeBytes(this.value)}static deserialize(t){const n=t.deserializeBytes();return new ic(n)}},Oi=ic;Oi.LENGTH=32;var oc=class{constructor(t){if(this.value=t,t.length!==oc.LENGTH)throw new Error(`Ed25519Signature length should be ${oc.LENGTH}`)}serialize(t){t.serializeBytes(this.value)}static deserialize(t){const n=t.deserializeBytes();return new oc(n)}},Yi=oc;Yi.LENGTH=64;var Dl=32,_a=class{constructor(t,n){if(this.public_keys=t,this.threshold=n,n>Dl)throw new Error(`"threshold" cannot be larger than ${Dl}`)}toBytes(){const t=new Uint8Array(this.public_keys.length*Oi.LENGTH+1);return this.public_keys.forEach((n,i)=>{t.set(n.value,i*Oi.LENGTH)}),t[this.public_keys.length*Oi.LENGTH]=this.threshold,t}serialize(t){t.serializeBytes(this.toBytes())}static deserialize(t){const n=t.deserializeBytes(),i=n[n.length-1],o=[];for(let s=0;s<n.length-1;s+=Oi.LENGTH){const r=s;o.push(new Oi(n.subarray(r,r+Oi.LENGTH)))}return new _a(o,i)}},Hr=class{constructor(t,n){if(this.signatures=t,this.bitmap=n,n.length!==Hr.BITMAP_LEN)throw new Error(`"bitmap" length should be ${Hr.BITMAP_LEN}`)}toBytes(){const t=new Uint8Array(this.signatures.length*Yi.LENGTH+Hr.BITMAP_LEN);return this.signatures.forEach((n,i)=>{t.set(n.value,i*Yi.LENGTH)}),t.set(this.bitmap,this.signatures.length*Yi.LENGTH),t}static createBitmap(t){const i=new Uint8Array([0,0,0,0]),o=new Set;return t.forEach(s=>{if(s>=Dl)throw new Error(`Invalid bit value ${s}.`);if(o.has(s))throw new Error("Duplicated bits detected.");o.add(s);const r=Math.floor(s/8);let a=i[r];a|=128>>s%8,i[r]=a}),i}serialize(t){t.serializeBytes(this.toBytes())}static deserialize(t){const n=t.deserializeBytes(),i=n.subarray(n.length-4),o=[];for(let s=0;s<n.length-i.length;s+=Yi.LENGTH){const r=s;o.push(new Yi(n.subarray(r,r+Yi.LENGTH)))}return new Hr(o,i)}},Wc=Hr;Wc.BITMAP_LEN=4;var Sr=class{static deserialize(t){const n=t.deserializeUleb128AsU32();switch(n){case 0:return Xc.load(t);case 1:return Vc.load(t);case 2:return bd.load(t);case 3:return vd.load(t);default:throw new Error(`Unknown variant index for TransactionAuthenticator: ${n}`)}}},Xc=class extends Sr{constructor(t,n){super(),this.public_key=t,this.signature=n}serialize(t){t.serializeU32AsUleb128(0),this.public_key.serialize(t),this.signature.serialize(t)}static load(t){const n=Oi.deserialize(t),i=Yi.deserialize(t);return new Xc(n,i)}},Vc=class extends Sr{constructor(t,n){super(),this.public_key=t,this.signature=n}serialize(t){t.serializeU32AsUleb128(1),this.public_key.serialize(t),this.signature.serialize(t)}static load(t){const n=_a.deserialize(t),i=Wc.deserialize(t);return new Vc(n,i)}},bd=class extends Sr{constructor(t,n,i){super(),this.sender=t,this.secondary_signer_addresses=n,this.secondary_signers=i}serialize(t){t.serializeU32AsUleb128(2),this.sender.serialize(t),Zn(this.secondary_signer_addresses,t),Zn(this.secondary_signers,t)}static load(t){const n=Ko.deserialize(t),i=hi(t,nn),o=hi(t,Ko);return new bd(n,i,o)}},vd=class extends Sr{constructor(e,t,n,i){super(),this.sender=e,this.secondary_signer_addresses=t,this.secondary_signers=n,this.fee_payer=i}serialize(e){e.serializeU32AsUleb128(3),this.sender.serialize(e),Zn(this.secondary_signer_addresses,e),Zn(this.secondary_signers,e),this.fee_payer.address.serialize(e),this.fee_payer.authenticator.serialize(e)}static load(e){const t=Ko.deserialize(e),n=hi(e,nn),i=hi(e,Ko),o=nn.deserialize(e),s=Ko.deserialize(e),r={address:o,authenticator:s};return new vd(t,n,i,r)}},Ko=class{static deserialize(t){const n=t.deserializeUleb128AsU32();switch(n){case 0:return Td.load(t);case 1:return Ad.load(t);default:throw new Error(`Unknown variant index for AccountAuthenticator: ${n}`)}}},Td=class extends Ko{constructor(t,n){super(),this.public_key=t,this.signature=n}serialize(t){t.serializeU32AsUleb128(0),this.public_key.serialize(t),this.signature.serialize(t)}static load(t){const n=Oi.deserialize(t),i=Yi.deserialize(t);return new Td(n,i)}},Ad=class extends Ko{constructor(t,n){super(),this.public_key=t,this.signature=n}serialize(t){t.serializeU32AsUleb128(1),this.public_key.serialize(t),this.signature.serialize(t)}static load(t){const n=_a.deserialize(t),i=Wc.deserialize(t);return new Ad(n,i)}},Yn=class{constructor(t){this.value=t}serialize(t){t.serializeStr(this.value)}static deserialize(t){const n=t.deserializeStr();return new Yn(n)}},Qn=class{static deserialize(t){const n=t.deserializeUleb128AsU32();switch(n){case 0:return bs.load(t);case 1:return fo.load(t);case 2:return vs.load(t);case 3:return Ts.load(t);case 4:return Go.load(t);case 5:return xd.load(t);case 6:return Er.load(t);case 7:return Wo.load(t);case 8:return Pr.load(t);case 9:return Cr.load(t);case 10:return Br.load(t);default:throw new Error(`Unknown variant index for TypeTag: ${n}`)}}},bs=class extends Qn{serialize(t){t.serializeU32AsUleb128(0)}static load(t){return new bs}},fo=class extends Qn{serialize(t){t.serializeU32AsUleb128(1)}static load(t){return new fo}},Pr=class extends Qn{serialize(t){t.serializeU32AsUleb128(8)}static load(t){return new Pr}},Cr=class extends Qn{serialize(t){t.serializeU32AsUleb128(9)}static load(t){return new Cr}},vs=class extends Qn{serialize(t){t.serializeU32AsUleb128(2)}static load(t){return new vs}},Ts=class extends Qn{serialize(t){t.serializeU32AsUleb128(3)}static load(t){return new Ts}},Br=class extends Qn{serialize(t){t.serializeU32AsUleb128(10)}static load(t){return new Br}},Go=class extends Qn{serialize(t){t.serializeU32AsUleb128(4)}static load(t){return new Go}},xd=class extends Qn{serialize(t){t.serializeU32AsUleb128(5)}static load(t){return new xd}},Er=class extends Qn{constructor(t){super(),this.value=t}serialize(t){t.serializeU32AsUleb128(6),this.value.serialize(t)}static load(t){const n=Qn.deserialize(t);return new Er(n)}},Wo=class extends Qn{constructor(t){super(),this.value=t}serialize(t){t.serializeU32AsUleb128(7),this.value.serialize(t)}static load(t){const n=Xo.deserialize(t);return new Wo(n)}isStringTypeTag(){return this.value.module_name.value==="string"&&this.value.name.value==="String"&&this.value.address.toHexString()===nn.CORE_CODE_ADDRESS.toHexString()}},Xo=class{constructor(t,n,i,o){this.address=t,this.module_name=n,this.name=i,this.type_args=o}static fromString(t){const n=new As(t).parseTypeTag();return new Xo(n.value.address,n.value.module_name,n.value.name,n.value.type_args)}serialize(t){this.address.serialize(t),this.module_name.serialize(t),this.name.serialize(t),Zn(this.type_args,t)}static deserialize(t){const n=nn.deserialize(t),i=Yn.deserialize(t),o=Yn.deserialize(t),s=hi(t,Qn);return new Xo(n,i,o,s)}},kd=new Xo(nn.fromHex("0x1"),new Yn("string"),new Yn("String"),[]);function $b(e){return new Xo(nn.fromHex("0x1"),new Yn("option"),new Yn("Option"),[e])}function Ub(e){return new Xo(nn.fromHex("0x1"),new Yn("object"),new Yn("Object"),[e])}function qo(e){throw new X0(e)}function Rh(e){return!!e.match(/\s/)}function $h(e){return!!e.match(/[_A-Za-z0-9]/g)}function qb(e){return!!e.match(/T\d+/g)}function Mb(e,t){const n=e[t];if(n===":"){if(e.slice(t,t+2)==="::")return[["COLON","::"],2];qo("Unrecognized token.")}else{if(n==="<")return[["LT","<"],1];if(n===">")return[["GT",">"],1];if(n===",")return[["COMMA",","],1];if(Rh(n)){let i="";for(let o=t;o<e.length;o+=1){const s=e[o];if(Rh(s))i=`${i}${s}`;else break}return[["SPACE",i],i.length]}else if($h(n)){let i="";for(let o=t;o<e.length;o+=1){const s=e[o];if($h(s))i=`${i}${s}`;else break}return qb(i)?[["GENERIC",i],i.length]:[["IDENT",i],i.length]}}throw new Error("Unrecognized token.")}function Db(e){let t=0;const n=[];for(;t<e.length;){const[i,o]=Mb(e,t);i[0]!=="SPACE"&&n.push(i),t+=o}return n}var As=class{constructor(t,n){this.typeTags=[],this.tokens=Db(t),this.typeTags=n||[]}consume(t){const n=this.tokens.shift();(!n||n[1]!==t)&&qo("Invalid type tag.")}consumeWholeGeneric(){for(this.consume("<");this.tokens[0][1]!==">";)this.tokens[0][1]==="<"&&this.consumeWholeGeneric(),this.tokens.shift();this.consume(">")}parseCommaList(t,n){const i=[];for(this.tokens.length<=0&&qo("Invalid type tag.");this.tokens[0][1]!==t&&(i.push(this.parseTypeTag()),!(this.tokens.length>0&&this.tokens[0][1]===t||(this.consume(","),this.tokens.length>0&&this.tokens[0][1]===t&&n)));)this.tokens.length<=0&&qo("Invalid type tag.");return i}parseTypeTag(){this.tokens.length===0&&qo("Invalid type tag.");const[t,n]=this.tokens.shift();if(n==="u8")return new fo;if(n==="u16")return new Pr;if(n==="u32")return new Cr;if(n==="u64")return new vs;if(n==="u128")return new Ts;if(n==="u256")return new Br;if(n==="bool")return new bs;if(n==="address")return new Go;if(n==="vector"){this.consume("<");const i=this.parseTypeTag();return this.consume(">"),new Er(i)}if(n==="string")return new Wo(kd);if(t==="IDENT"&&(n.startsWith("0x")||n.startsWith("0X"))){const i=nn.fromHex(n);this.consume("::");const[o,s]=this.tokens.shift();o!=="IDENT"&&qo("Invalid type tag."),this.consume("::");const[r,a]=this.tokens.shift();if(r!=="IDENT"&&qo("Invalid type tag."),nn.CORE_CODE_ADDRESS.toHexString()===i.toHexString()&&s==="object"&&a==="Object")return this.consumeWholeGeneric(),new Go;let c=[];this.tokens.length>0&&this.tokens[0][1]==="<"&&(this.consume("<"),c=this.parseCommaList(">",!0),this.consume(">"));const u=new Xo(i,new Yn(s),new Yn(a),c);return new Wo(u)}if(t==="GENERIC"){this.typeTags.length===0&&qo("Can't convert generic type since no typeTags were specified.");const i=parseInt(n.substring(1),10);return new As(this.typeTags[i]).parseTypeTag()}throw new Error("Invalid type tag.")}},X0=class extends Error{constructor(e){super(e),this.name="TypeTagParserError"}},xs=class{constructor(t,n,i,o,s,r,a){this.sender=t,this.sequence_number=n,this.payload=i,this.max_gas_amount=o,this.gas_unit_price=s,this.expiration_timestamp_secs=r,this.chain_id=a}serialize(t){this.sender.serialize(t),t.serializeU64(this.sequence_number),this.payload.serialize(t),t.serializeU64(this.max_gas_amount),t.serializeU64(this.gas_unit_price),t.serializeU64(this.expiration_timestamp_secs),this.chain_id.serialize(t)}static deserialize(t){const n=nn.deserialize(t),i=t.deserializeU64(),o=ya.deserialize(t),s=t.deserializeU64(),r=t.deserializeU64(),a=t.deserializeU64(),c=eu.deserialize(t);return new xs(n,i,o,s,r,a,c)}},Jc=class{constructor(t,n,i){this.code=t,this.ty_args=n,this.args=i}serialize(t){t.serializeBytes(this.code),Zn(this.ty_args,t),Zn(this.args,t)}static deserialize(t){const n=t.deserializeBytes(),i=hi(t,Qn),o=hi(t,Ki);return new Jc(n,i,o)}},ss=class{constructor(t,n,i,o){this.module_name=t,this.function_name=n,this.ty_args=i,this.args=o}static natural(t,n,i,o){return new ss(hs.fromStr(t),new Yn(n),i,o)}static natual(t,n,i,o){return ss.natural(t,n,i,o)}serialize(t){this.module_name.serialize(t),this.function_name.serialize(t),Zn(this.ty_args,t),t.serializeU32AsUleb128(this.args.length),this.args.forEach(n=>{t.serializeBytes(n)})}static deserialize(t){const n=hs.deserialize(t),i=Yn.deserialize(t),o=hi(t,Qn),s=t.deserializeUleb128AsU32(),r=[];for(let c=0;c<s;c+=1)r.push(t.deserializeBytes());const a=r;return new ss(n,i,o,a)}},Sd=class{constructor(t){this.transaction_payload=t}serialize(t){t.serializeU32AsUleb128(0),this.transaction_payload.serialize(t)}static deserialize(t){return t.deserializeUleb128AsU32(),new Sd(ss.deserialize(t))}},Pd=class{constructor(t,n){this.multisig_address=t,this.transaction_payload=n}serialize(t){this.multisig_address.serialize(t),this.transaction_payload===void 0?t.serializeBool(!1):(t.serializeBool(!0),this.transaction_payload.serialize(t))}static deserialize(t){const n=nn.deserialize(t),i=t.deserializeBool();let o;return i&&(o=Sd.deserialize(t)),new Pd(n,o)}},V0=class{constructor(t){this.code=t}serialize(t){t.serializeBytes(this.code)}static deserialize(t){const n=t.deserializeBytes();return new V0(n)}},hs=class{constructor(t,n){this.address=t,this.name=n}static fromStr(t){const n=t.split("::");if(n.length!==2)throw new Error("Invalid module id.");return new hs(nn.fromHex(new Et(n[0])),new Yn(n[1]))}serialize(t){this.address.serialize(t),this.name.serialize(t)}static deserialize(t){const n=nn.deserialize(t),i=Yn.deserialize(t);return new hs(n,i)}},Lb=class{serialize(t){throw new Error("Not implemented.")}static deserialize(t){throw new Error("Not implemented.")}},Nb=class{serialize(t){throw new Error("Not implmented.")}static deserialize(t){throw new Error("Not implmented.")}},ma=class{constructor(t,n){this.raw_txn=t,this.authenticator=n}serialize(t){this.raw_txn.serialize(t),this.authenticator.serialize(t)}static deserialize(t){const n=xs.deserialize(t),i=Sr.deserialize(t);return new ma(n,i)}},Cd=class{static deserialize(t){const n=t.deserializeUleb128AsU32();switch(n){case 0:return Zc.load(t);case 1:return Yc.load(t);default:throw new Error(`Unknown variant index for RawTransactionWithData: ${n}`)}}},Zc=class extends Cd{constructor(t,n){super(),this.raw_txn=t,this.secondary_signer_addresses=n}serialize(t){t.serializeU32AsUleb128(0),this.raw_txn.serialize(t),Zn(this.secondary_signer_addresses,t)}static load(t){const n=xs.deserialize(t),i=hi(t,nn);return new Zc(n,i)}},Yc=class extends Cd{constructor(e,t,n){super(),this.raw_txn=e,this.secondary_signer_addresses=t,this.fee_payer_address=n}serialize(e){e.serializeU32AsUleb128(1),this.raw_txn.serialize(e),Zn(this.secondary_signer_addresses,e),this.fee_payer_address.serialize(e)}static load(e){const t=xs.deserialize(e),n=hi(e,nn),i=nn.deserialize(e);return new Yc(t,n,i)}},ya=class{static deserialize(t){const n=t.deserializeUleb128AsU32();switch(n){case 0:return Qc.load(t);case 2:return tu.load(t);case 3:return Bd.load(t);default:throw new Error(`Unknown variant index for TransactionPayload: ${n}`)}}},Qc=class extends ya{constructor(t){super(),this.value=t}serialize(t){t.serializeU32AsUleb128(0),this.value.serialize(t)}static load(t){const n=Jc.deserialize(t);return new Qc(n)}},tu=class extends ya{constructor(t){super(),this.value=t}serialize(t){t.serializeU32AsUleb128(2),this.value.serialize(t)}static load(t){const n=ss.deserialize(t);return new tu(n)}},Bd=class extends ya{constructor(t){super(),this.value=t}serialize(t){t.serializeU32AsUleb128(3),this.value.serialize(t)}static load(t){const n=Pd.deserialize(t);return new Bd(n)}},eu=class{constructor(t){this.value=t}serialize(t){t.serializeU8(this.value)}static deserialize(t){const n=t.deserializeU8();return new eu(n)}},Ki=class{static deserialize(t){const n=t.deserializeUleb128AsU32();switch(n){case 0:return nu.load(t);case 1:return su.load(t);case 2:return ru.load(t);case 3:return cu.load(t);case 4:return uu.load(t);case 5:return lu.load(t);case 6:return iu.load(t);case 7:return ou.load(t);case 8:return au.load(t);default:throw new Error(`Unknown variant index for TransactionArgument: ${n}`)}}},nu=class extends Ki{constructor(t){super(),this.value=t}serialize(t){t.serializeU32AsUleb128(0),t.serializeU8(this.value)}static load(t){const n=t.deserializeU8();return new nu(n)}},iu=class extends Ki{constructor(t){super(),this.value=t}serialize(t){t.serializeU32AsUleb128(6),t.serializeU16(this.value)}static load(t){const n=t.deserializeU16();return new iu(n)}},ou=class extends Ki{constructor(t){super(),this.value=t}serialize(t){t.serializeU32AsUleb128(7),t.serializeU32(this.value)}static load(t){const n=t.deserializeU32();return new ou(n)}},su=class extends Ki{constructor(t){super(),this.value=t}serialize(t){t.serializeU32AsUleb128(1),t.serializeU64(this.value)}static load(t){const n=t.deserializeU64();return new su(n)}},ru=class extends Ki{constructor(t){super(),this.value=t}serialize(t){t.serializeU32AsUleb128(2),t.serializeU128(this.value)}static load(t){const n=t.deserializeU128();return new ru(n)}},au=class extends Ki{constructor(t){super(),this.value=t}serialize(t){t.serializeU32AsUleb128(8),t.serializeU256(this.value)}static load(t){const n=t.deserializeU256();return new au(n)}},cu=class extends Ki{constructor(t){super(),this.value=t}serialize(t){t.serializeU32AsUleb128(3),this.value.serialize(t)}static load(t){const n=nn.deserialize(t);return new cu(n)}},uu=class extends Ki{constructor(t){super(),this.value=t}serialize(t){t.serializeU32AsUleb128(4),t.serializeBytes(this.value)}static load(t){const n=t.deserializeBytes();return new uu(n)}},lu=class extends Ki{constructor(t){super(),this.value=t}serialize(t){t.serializeU32AsUleb128(5),t.serializeBool(this.value)}static load(t){const n=t.deserializeBool();return new lu(n)}},J0=class{getHashSalt(){const t=ur.create();return t.update("APTOS::Transaction"),t.digest()}static deserialize(t){const n=t.deserializeUleb128AsU32();switch(n){case 0:return Ed.load(t);default:throw new Error(`Unknown variant index for Transaction: ${n}`)}}},Ed=class extends J0{constructor(t){super(),this.value=t}hash(){const t=ur.create();return t.update(this.getHashSalt()),t.update(zi(this)),t.digest()}serialize(t){t.serializeU32AsUleb128(0),this.value.serialize(t)}static load(t){return new Ed(ma.deserialize(t))}},wa=class{constructor(t){this.name=t}serialize(t){t.serializeStr(this.name)}static deserialize(t){const n=t.deserializeStr();return new wa(n)}},ba=class{constructor(t,n){this.name=t,this.type_tag=n}serialize(t){t.serializeStr(this.name),this.type_tag.serialize(t)}static deserialize(t){const n=t.deserializeStr(),i=Qn.deserialize(t);return new ba(n,i)}},du=class{static deserialize(t){const n=t.deserializeUleb128AsU32();switch(n){case 0:return hu.load(t);case 1:return hr.load(t);default:throw new Error(`Unknown variant index for TransactionPayload: ${n}`)}}},hu=class extends du{constructor(t,n,i,o,s){super(),this.name=t,this.doc=n,this.code=i,this.ty_args=o,this.args=s}serialize(t){t.serializeU32AsUleb128(0),t.serializeStr(this.name),t.serializeStr(this.doc),t.serializeBytes(this.code),Zn(this.ty_args,t),Zn(this.args,t)}static load(t){const n=t.deserializeStr(),i=t.deserializeStr(),o=t.deserializeBytes(),s=hi(t,wa),r=hi(t,ba);return new hu(n,i,o,s,r)}},hr=class extends du{constructor(t,n,i,o,s){super(),this.name=t,this.module_name=n,this.doc=i,this.ty_args=o,this.args=s}serialize(t){t.serializeU32AsUleb128(1),t.serializeStr(this.name),this.module_name.serialize(t),t.serializeStr(this.doc),Zn(this.ty_args,t),Zn(this.args,t)}static load(t){const n=t.deserializeStr(),i=hs.deserialize(t),o=t.deserializeStr(),s=hi(t,wa),r=hi(t,ba);return new hr(n,i,o,s,r)}},Ls=class{constructor(t){if(t.length!==Ls.LENGTH)throw new Error("Expected a byte array of length 32");this.bytes=t}static fromMultiEd25519PublicKey(t){const n=t.toBytes(),i=new Uint8Array(n.length+1);i.set(n),i.set([Ls.MULTI_ED25519_SCHEME],n.length);const o=ur.create();return o.update(i),new Ls(o.digest())}static fromEd25519PublicKey(t){const n=t.value,i=new Uint8Array(n.length+1);i.set(n),i.set([Ls.ED25519_SCHEME],n.length);const o=ur.create();return o.update(i),new Ls(o.digest())}derivedAddress(){return Et.fromUint8Array(this.bytes)}},fs=Ls;fs.LENGTH=32;fs.MULTI_ED25519_SCHEME=1;fs.ED25519_SCHEME=0;fs.DERIVE_RESOURCE_ACCOUNT_SCHEME=255;var Fb=class{constructor(t,n,i,o,s,r,a){this.accountAddress=t,this.moduleName=n,this.structName=i,this.sequenceNumber=o,this.originator=s,this.currentAuthKey=r,this.newPublicKey=a}serialize(t){this.accountAddress.serialize(t),t.serializeStr(this.moduleName),t.serializeStr(this.structName),t.serializeU64(this.sequenceNumber),this.originator.serialize(t),this.currentAuthKey.serialize(t),t.serializeBytes(this.newPublicKey)}},sc=class{static fromAptosAccountObject(t){return new sc(Et.ensure(t.privateKeyHex).toUint8Array(),t.address)}static isValidPath(t){return/^m\/44'\/637'\/[0-9]+'\/[0-9]+'\/[0-9]+'+$/.test(t)}static fromDerivePath(t,n){if(!sc.isValidPath(t))throw new Error("Invalid derivation path");const i=n.trim().split(/\s+/).map(s=>s.toLowerCase()).join(" "),{key:o}=L0(t,s0(Vf(i)));return new sc(o)}constructor(t,n){t?this.signingKey=no.sign.keyPair.fromSeed(t.slice(0,32)):this.signingKey=no.sign.keyPair(),this.accountAddress=Et.ensure(n||this.authKey().hex())}address(){return this.accountAddress}authKey(){const t=new Oi(this.signingKey.publicKey);return fs.fromEd25519PublicKey(t).derivedAddress()}static getResourceAccountAddress(t,n){const i=zi(nn.fromHex(t)),o=new Uint8Array([...i,...n,fs.DERIVE_RESOURCE_ACCOUNT_SCHEME]),s=ur.create();return s.update(o),Et.fromUint8Array(s.digest())}static getCollectionID(t,n){const i=new TextEncoder().encode(`${t}::${n}`),o=Ty.create();return o.update(i),Et.fromUint8Array(o.digest())}pubKey(){return Et.fromUint8Array(this.signingKey.publicKey)}signBuffer(t){const n=no.sign.detached(t,this.signingKey.secretKey);return Et.fromUint8Array(n)}signHexString(t){const n=Et.ensure(t).toUint8Array();return this.signBuffer(n)}verifySignature(t,n){const i=Et.ensure(t).toUint8Array(),o=Et.ensure(n).toUint8Array();return no.sign.detached.verify(i,o,this.signingKey.publicKey)}toPrivateKeyObject(){return{address:this.address().hex(),publicKeyHex:this.pubKey().hex(),privateKeyHex:Et.fromUint8Array(this.signingKey.secretKey.slice(0,32)).hex()}}},ia=sc;un([Gc()],ia.prototype,"authKey",1);function Ni(e){return e instanceof ia?e.address():Et.ensure(e)}var va=`
    fragment CurrentTokenOwnershipFields on current_token_ownerships_v2 {
  token_standard
  token_properties_mutated_v1
  token_data_id
  table_type_v1
  storage_id
  property_version_v1
  owner_address
  last_transaction_version
  last_transaction_timestamp
  is_soulbound_v2
  is_fungible_v2
  amount
  current_token_data {
    collection_id
    description
    is_fungible_v2
    largest_property_version_v1
    last_transaction_timestamp
    last_transaction_version
    maximum
    supply
    token_data_id
    token_name
    token_properties
    token_standard
    token_uri
    current_collection {
      collection_id
      collection_name
      creator_address
      current_supply
      description
      last_transaction_timestamp
      last_transaction_version
      max_supply
      mutable_description
      mutable_uri
      table_handle_v1
      token_standard
      total_minted_v2
      uri
    }
  }
}
    `,jb=`
    fragment TokenDataFields on current_token_datas {
  creator_address
  collection_name
  description
  metadata_uri
  name
  token_data_id_hash
  collection_data_id_hash
}
    `,zb=`
    fragment CollectionDataFields on current_collection_datas {
  metadata_uri
  supply
  description
  collection_name
  collection_data_id_hash
  table_handle
  creator_address
}
    `,Z0=`
    fragment TokenActivitiesFields on token_activities_v2 {
  after_value
  before_value
  entry_function_id_str
  event_account_address
  event_index
  from_address
  is_fungible_v2
  property_version_v1
  to_address
  token_amount
  token_data_id
  token_standard
  transaction_timestamp
  transaction_version
  type
}
    `,Hb=`
    query getAccountCoinsDataCount($address: String) {
  current_fungible_asset_balances_aggregate(
    where: {owner_address: {_eq: $address}}
  ) {
    aggregate {
      count
    }
  }
}
    `,Kb=`
    query getAccountCoinsData($where_condition: current_fungible_asset_balances_bool_exp!, $offset: Int, $limit: Int, $order_by: [current_fungible_asset_balances_order_by!]) {
  current_fungible_asset_balances(
    where: $where_condition
    offset: $offset
    limit: $limit
    order_by: $order_by
  ) {
    amount
    asset_type
    is_frozen
    is_primary
    last_transaction_timestamp
    last_transaction_version
    owner_address
    storage_id
    token_standard
    metadata {
      token_standard
      symbol
      supply_aggregator_table_key_v1
      supply_aggregator_table_handle_v1
      project_uri
      name
      last_transaction_version
      last_transaction_timestamp
      icon_uri
      decimals
      creator_address
      asset_type
    }
  }
}
    `,Gb=`
    query getAccountCurrentTokens($address: String!, $offset: Int, $limit: Int) {
  current_token_ownerships(
    where: {owner_address: {_eq: $address}, amount: {_gt: 0}}
    order_by: [{last_transaction_version: desc}, {creator_address: asc}, {collection_name: asc}, {name: asc}]
    offset: $offset
    limit: $limit
  ) {
    amount
    current_token_data {
      ...TokenDataFields
    }
    current_collection_data {
      ...CollectionDataFields
    }
    last_transaction_version
    property_version
  }
}
    ${jb}
${zb}`,Wb=`
    query getAccountTokensCount($where_condition: current_token_ownerships_v2_bool_exp, $offset: Int, $limit: Int) {
  current_token_ownerships_v2_aggregate(
    where: $where_condition
    offset: $offset
    limit: $limit
  ) {
    aggregate {
      count
    }
  }
}
    `,Xb=`
    query getAccountTransactionsCount($address: String) {
  account_transactions_aggregate(where: {account_address: {_eq: $address}}) {
    aggregate {
      count
    }
  }
}
    `,Vb=`
    query getAccountTransactionsData($where_condition: account_transactions_bool_exp!, $offset: Int, $limit: Int, $order_by: [account_transactions_order_by!]) {
  account_transactions(
    where: $where_condition
    order_by: $order_by
    limit: $limit
    offset: $offset
  ) {
    token_activities_v2 {
      ...TokenActivitiesFields
    }
    transaction_version
    account_address
  }
}
    ${Z0}`,Jb=`
    query getCollectionData($where_condition: current_collections_v2_bool_exp!, $offset: Int, $limit: Int, $order_by: [current_collections_v2_order_by!]) {
  current_collections_v2(
    where: $where_condition
    offset: $offset
    limit: $limit
    order_by: $order_by
  ) {
    collection_id
    collection_name
    creator_address
    current_supply
    description
    last_transaction_timestamp
    last_transaction_version
    max_supply
    mutable_description
    mutable_uri
    table_handle_v1
    token_standard
    total_minted_v2
    uri
  }
}
    `,Zb=`
    query getCollectionsWithOwnedTokens($where_condition: current_collection_ownership_v2_view_bool_exp!, $offset: Int, $limit: Int, $order_by: [current_collection_ownership_v2_view_order_by!]) {
  current_collection_ownership_v2_view(
    where: $where_condition
    offset: $offset
    limit: $limit
    order_by: $order_by
  ) {
    current_collection {
      collection_id
      collection_name
      creator_address
      current_supply
      description
      last_transaction_timestamp
      last_transaction_version
      mutable_description
      max_supply
      mutable_uri
      table_handle_v1
      token_standard
      total_minted_v2
      uri
    }
    collection_id
    collection_name
    collection_uri
    creator_address
    distinct_tokens
    last_transaction_version
    owner_address
    single_token_uri
  }
}
    `,Yb=`
    query getCurrentObjects($where_condition: current_objects_bool_exp, $offset: Int, $limit: Int, $order_by: [current_objects_order_by!]) {
  current_objects(
    where: $where_condition
    offset: $offset
    limit: $limit
    order_by: $order_by
  ) {
    allow_ungated_transfer
    state_key_hash
    owner_address
    object_address
    last_transaction_version
    last_guid_creation_num
    is_deleted
  }
}
    `,Qb=`
    query getDelegatedStakingActivities($delegatorAddress: String, $poolAddress: String) {
  delegated_staking_activities(
    where: {delegator_address: {_eq: $delegatorAddress}, pool_address: {_eq: $poolAddress}}
  ) {
    amount
    delegator_address
    event_index
    event_type
    pool_address
    transaction_version
  }
}
    `,t1=`
    query getIndexerLedgerInfo {
  ledger_infos {
    chain_id
  }
}
    `,e1=`
    query getNumberOfDelegators($poolAddress: String) {
  num_active_delegator_per_pool(
    where: {pool_address: {_eq: $poolAddress}, num_active_delegator: {_gt: "0"}}
    distinct_on: pool_address
  ) {
    num_active_delegator
    pool_address
  }
}
    `,n1=`
    query getOwnedTokens($where_condition: current_token_ownerships_v2_bool_exp!, $offset: Int, $limit: Int, $order_by: [current_token_ownerships_v2_order_by!]) {
  current_token_ownerships_v2(
    where: $where_condition
    offset: $offset
    limit: $limit
    order_by: $order_by
  ) {
    ...CurrentTokenOwnershipFields
  }
}
    ${va}`,i1=`
    query getOwnedTokensByTokenData($where_condition: current_token_ownerships_v2_bool_exp!, $offset: Int, $limit: Int, $order_by: [current_token_ownerships_v2_order_by!]) {
  current_token_ownerships_v2(
    where: $where_condition
    offset: $offset
    limit: $limit
    order_by: $order_by
  ) {
    ...CurrentTokenOwnershipFields
  }
}
    ${va}`,o1=`
    query getTokenActivities($where_condition: token_activities_v2_bool_exp!, $offset: Int, $limit: Int, $order_by: [token_activities_v2_order_by!]) {
  token_activities_v2(
    where: $where_condition
    order_by: $order_by
    offset: $offset
    limit: $limit
  ) {
    ...TokenActivitiesFields
  }
}
    ${Z0}`,s1=`
    query getTokenActivitiesCount($token_id: String) {
  token_activities_v2_aggregate(where: {token_data_id: {_eq: $token_id}}) {
    aggregate {
      count
    }
  }
}
    `,r1=`
    query getTokenCurrentOwnerData($where_condition: current_token_ownerships_v2_bool_exp!, $offset: Int, $limit: Int, $order_by: [current_token_ownerships_v2_order_by!]) {
  current_token_ownerships_v2(
    where: $where_condition
    offset: $offset
    limit: $limit
    order_by: $order_by
  ) {
    ...CurrentTokenOwnershipFields
  }
}
    ${va}`,a1=`
    query getTokenData($where_condition: current_token_datas_v2_bool_exp, $offset: Int, $limit: Int, $order_by: [current_token_datas_v2_order_by!]) {
  current_token_datas_v2(
    where: $where_condition
    offset: $offset
    limit: $limit
    order_by: $order_by
  ) {
    collection_id
    description
    is_fungible_v2
    largest_property_version_v1
    last_transaction_timestamp
    last_transaction_version
    maximum
    supply
    token_data_id
    token_name
    token_properties
    token_standard
    token_uri
    current_collection {
      collection_id
      collection_name
      creator_address
      current_supply
      description
      last_transaction_timestamp
      last_transaction_version
      max_supply
      mutable_description
      mutable_uri
      table_handle_v1
      token_standard
      total_minted_v2
      uri
    }
  }
}
    `,c1=`
    query getTokenOwnedFromCollection($where_condition: current_token_ownerships_v2_bool_exp!, $offset: Int, $limit: Int, $order_by: [current_token_ownerships_v2_order_by!]) {
  current_token_ownerships_v2(
    where: $where_condition
    offset: $offset
    limit: $limit
    order_by: $order_by
  ) {
    ...CurrentTokenOwnershipFields
  }
}
    ${va}`,u1=`
    query getTokenOwnersData($where_condition: current_token_ownerships_v2_bool_exp!, $offset: Int, $limit: Int, $order_by: [current_token_ownerships_v2_order_by!]) {
  current_token_ownerships_v2(
    where: $where_condition
    offset: $offset
    limit: $limit
    order_by: $order_by
  ) {
    ...CurrentTokenOwnershipFields
  }
}
    ${va}`,l1=`
    query getTopUserTransactions($limit: Int) {
  user_transactions(limit: $limit, order_by: {version: desc}) {
    version
  }
}
    `,d1=`
    query getUserTransactions($where_condition: user_transactions_bool_exp!, $offset: Int, $limit: Int, $order_by: [user_transactions_order_by!]) {
  user_transactions(
    order_by: $order_by
    where: $where_condition
    limit: $limit
    offset: $offset
  ) {
    version
  }
}
    `;function fu(e,t,n){if(!(t!=null&&t.includes(typeof e)))throw new Error(n||`Invalid arg: ${e} type should be ${t instanceof Array?t.join(" or "):t}`)}function Id(e){if(fu(e,["boolean","string"]),typeof e=="boolean")return e;if(e==="true")return!0;if(e==="false")return!1;throw new Error("Invalid boolean string.")}function rs(e){if(fu(e,["number","string"]),typeof e=="number")return e;const t=Number.parseInt(e,10);if(Number.isNaN(t))throw new Error("Invalid number string.");return t}function as(e){return fu(e,["number","bigint","string"]),BigInt(e)}function pu(e,t,n){Od(e,t,n)}function Od(e,t,n,i){if(t instanceof bs)n.serializeBool(Id(e));else if(t instanceof fo)n.serializeU8(rs(e));else if(t instanceof Pr)n.serializeU16(rs(e));else if(t instanceof Cr)n.serializeU32(rs(e));else if(t instanceof vs)n.serializeU64(as(e));else if(t instanceof Ts)n.serializeU128(as(e));else if(t instanceof Br)n.serializeU256(as(e));else if(t instanceof Go)Y0(e,n);else if(t instanceof Er)h1(e,t,n);else if(t instanceof Wo)f1(e,t,n);else throw new Error("Unsupported arg type.")}function Y0(e,t){let n;if(typeof e=="string"||e instanceof Et)n=nn.fromHex(e);else if(e instanceof nn)n=e;else throw new Error("Invalid account address.");n.serialize(t)}function h1(e,t,n,i){if(t.value instanceof fo){if(e instanceof Uint8Array){n.serializeBytes(e);return}if(e instanceof Et){n.serializeBytes(e.toUint8Array());return}if(typeof e=="string"){n.serializeStr(e);return}}if(!Array.isArray(e))throw new Error("Invalid vector args.");n.serializeU32AsUleb128(e.length),e.forEach(o=>Od(o,t.value,n))}function f1(e,t,n,i){const{address:o,module_name:s,name:r,type_args:a}=t.value,c=`${Et.fromUint8Array(o.address).toShortString()}::${s.value}::${r.value}`;if(c==="0x1::string::String")fu(e,["string"]),n.serializeStr(e);else if(c==="0x1::object::Object")Y0(e,n);else if(c==="0x1::option::Option"){if(a.length!==1)throw new Error(`Option has the wrong number of type arguments ${a.length}`);p1(e,a[0],n)}else throw new Error("Unsupported struct type in function argument")}function p1(e,t,n,i){e==null?n.serializeU32AsUleb128(0):(n.serializeU32AsUleb128(1),Od(e,t,n))}function Q0(e,t){if(t instanceof bs)return new lu(Id(e));if(t instanceof fo)return new nu(rs(e));if(t instanceof Pr)return new iu(rs(e));if(t instanceof Cr)return new ou(rs(e));if(t instanceof vs)return new su(as(e));if(t instanceof Ts)return new ru(as(e));if(t instanceof Br)return new au(as(e));if(t instanceof Go){let n;if(typeof e=="string"||e instanceof Et)n=nn.fromHex(e);else if(e instanceof nn)n=e;else throw new Error("Invalid account address.");return new cu(n)}if(t instanceof Er&&t.value instanceof fo){if(!(e instanceof Uint8Array))throw new Error(`${e} should be an instance of Uint8Array`);return new uu(e)}throw new Error("Unknown type for TransactionArgument.")}var g1="APTOS::RawTransaction",Uh="APTOS::RawTransactionWithData",Fi=class{constructor(t,n){this.rawTxnBuilder=n,this.signingFunction=t}build(t,n,i){if(!this.rawTxnBuilder)throw new Error("this.rawTxnBuilder doesn't exist.");return this.rawTxnBuilder.build(t,n,i)}static getSigningMessage(t){const n=ur.create();if(t instanceof xs)n.update(g1);else if(t instanceof Zc)n.update(Uh);else if(t instanceof Yc)n.update(Uh);else throw new Error("Unknown transaction type.");const i=n.digest(),o=zi(t),s=new Uint8Array(i.length+o.length);return s.set(i),s.set(o,i.length),s}},rc=class extends Fi{constructor(t,n,i){super(t,i),this.publicKey=n}rawToSigned(t){const n=Fi.getSigningMessage(t),i=this.signingFunction(n),o=new Xc(new Oi(this.publicKey),i);return new ma(t,o)}sign(t){return zi(this.rawToSigned(t))}},tp=class extends Fi{constructor(t,n){super(t),this.publicKey=n}rawToSigned(t){const n=Fi.getSigningMessage(t),i=this.signingFunction(n),o=new Vc(this.publicKey,i);return new ma(t,o)}sign(t){return zi(this.rawToSigned(t))}},Tc=class{constructor(t,n){this.abiMap=new Map,t.forEach(i=>{const o=new wd(i),s=du.deserialize(o);let r;if(s instanceof hr){const a=s,{address:c,name:u}=a.module_name;r=`${Et.fromUint8Array(c.address).toShortString()}::${u.value}::${a.name}`}else r=s.name;if(this.abiMap.has(r))throw new Error("Found conflicting ABI interfaces");this.abiMap.set(r,s)}),this.builderConfig={maxGasAmount:BigInt(N0),expSecFromNow:F0,...n}}static toBCSArgs(t,n){if(t.length!==n.length)throw new Error("Wrong number of args provided.");return n.map((i,o)=>{const s=new gn;return pu(i,t[o].type_tag,s),s.getBytes()})}static toTransactionArguments(t,n){if(t.length!==n.length)throw new Error("Wrong number of args provided.");return n.map((i,o)=>Q0(i,t[o].type_tag))}setSequenceNumber(t){this.builderConfig.sequenceNumber=BigInt(t)}buildTransactionPayload(t,n,i){const o=n.map(a=>new As(a).parseTypeTag());let s;if(!this.abiMap.has(t))throw new Error(`Cannot find function: ${t}`);const r=this.abiMap.get(t);if(r instanceof hr){const a=r,c=Tc.toBCSArgs(a.args,i);s=new tu(new ss(a.module_name,new Yn(a.name),o,c))}else if(r instanceof hu){const a=r,c=Tc.toTransactionArguments(a.args,i);s=new Qc(new Jc(a.code,o,c))}else throw new Error("Unknown ABI format.");return s}build(t,n,i){const{sender:o,sequenceNumber:s,gasUnitPrice:r,maxGasAmount:a,expSecFromNow:c,chainId:u}=this.builderConfig;if(!r)throw new Error("No gasUnitPrice provided.");const l=o instanceof nn?o:nn.fromHex(o),d=BigInt(Math.floor(Date.now()/1e3)+Number(c)),h=this.buildTransactionPayload(t,n,i);if(h)return new xs(l,BigInt(s),h,BigInt(a),BigInt(r),d,new eu(Number(u)));throw new Error("Invalid ABI.")}},pn=class{constructor(t,n){this.aptosClient=t,this.builderConfig=n}async fetchABI(t){const i=(await this.aptosClient.getAccountModules(t)).map(s=>s.abi).flatMap(s=>s.exposed_functions.filter(r=>r.is_entry).map(r=>({fullName:`${s.address}::${s.name}::${r.name}`,...r}))),o=new Map;return i.forEach(s=>{o.set(s.fullName,s)}),o}async build(t,n,i){if(t=(T=>T.replace(/^0[xX]0*/g,"0x"))(t),t.split("::").length!==3)throw new Error("'func' needs to be a fully qualified function name in format <address>::<module>::<function>, e.g. 0x1::coin::transfer");const[r,a]=t.split("::"),c=await this.fetchABI(r);if(!c.has(t))throw new Error(`${t} doesn't exist.`);const u=c.get(t),d=u.params.filter(T=>T!=="signer"&&T!=="&signer").map((T,R)=>new ba(`var${R}`,new As(T,n).parseTypeTag())),h=new hr(u.name,hs.fromStr(`${r}::${a}`),"",u.generic_type_params.map((T,R)=>new wa(`${R}`)),d),{sender:g,...b}=this.builderConfig,v=g instanceof nn?Et.fromUint8Array(g.address):g,[{sequence_number:x},P,{gas_estimate:E}]=await Promise.all([b!=null&&b.sequenceNumber?Promise.resolve({sequence_number:b==null?void 0:b.sequenceNumber}):this.aptosClient.getAccount(v),b!=null&&b.chainId?Promise.resolve(b==null?void 0:b.chainId):this.aptosClient.getChainId(),b!=null&&b.gasUnitPrice?Promise.resolve({gas_estimate:b==null?void 0:b.gasUnitPrice}):this.aptosClient.estimateGasPrice()]);return new Tc([zi(h)],{sender:g,sequenceNumber:x,chainId:P,gasUnitPrice:BigInt(E),...b}).build(t,n,i)}};un([z0(10*60*1e3)],pn.prototype,"fetchABI",1);var Ns=class{constructor(t,n,i=!1){if(!t)throw new Error("Node URL cannot be empty.");i?this.nodeUrl=t:this.nodeUrl=yb(t),this.config=n==null?{}:{...n}}async getAccount(t){const{data:n}=await ui({url:this.nodeUrl,endpoint:`accounts/${Et.ensure(t).hex()}`,originMethod:"getAccount",overrides:{...this.config}});return n}async getAccountTransactions(t,n){const{data:i}=await ui({url:this.nodeUrl,endpoint:`accounts/${Et.ensure(t).hex()}/transactions`,originMethod:"getAccountTransactions",params:{start:n==null?void 0:n.start,limit:n==null?void 0:n.limit},overrides:{...this.config}});return i}async getAccountModules(t,n){return await Oh({url:this.nodeUrl,endpoint:`accounts/${t}/modules`,params:{ledger_version:n==null?void 0:n.ledgerVersion,limit:1e3},originMethod:"getAccountModules",overrides:{...this.config}})}async getAccountModule(t,n,i){const{data:o}=await ui({url:this.nodeUrl,endpoint:`accounts/${Et.ensure(t).hex()}/module/${n}`,originMethod:"getAccountModule",params:{ledger_version:i==null?void 0:i.ledgerVersion},overrides:{...this.config}});return o}async getAccountResources(t,n){return await Oh({url:this.nodeUrl,endpoint:`accounts/${t}/resources`,params:{ledger_version:n==null?void 0:n.ledgerVersion,limit:9999},originMethod:"getAccountResources",overrides:{...this.config}})}async getAccountResource(t,n,i){const{data:o}=await ui({url:this.nodeUrl,endpoint:`accounts/${Et.ensure(t).hex()}/resource/${n}`,originMethod:"getAccountResource",params:{ledger_version:i==null?void 0:i.ledgerVersion},overrides:{...this.config}});return o}static generateBCSTransaction(t,n){return new rc(o=>{const s=t.signBuffer(o);return new re.Ed25519Signature(s.toUint8Array())},t.pubKey().toUint8Array()).sign(n)}static generateBCSSimulation(t,n){return new rc(o=>{const s=new Uint8Array(64);return new re.Ed25519Signature(s)},t.pubKey().toUint8Array()).sign(n)}async generateTransaction(t,n,i){const o={sender:t};if(i!=null&&i.sequence_number&&(o.sequenceNumber=i.sequence_number),i!=null&&i.gas_unit_price&&(o.gasUnitPrice=i.gas_unit_price),i!=null&&i.max_gas_amount&&(o.maxGasAmount=i.max_gas_amount),i!=null&&i.expiration_timestamp_secs){const r=Number.parseInt(i.expiration_timestamp_secs,10);o.expSecFromNow=r-Math.floor(Date.now()/1e3)}return new pn(this,o).build(n.function,n.type_arguments,n.arguments)}async generateFeePayerTransaction(t,n,i,o=[],s){const r=await this.generateTransaction(t,n,s),a=o.map(u=>nn.fromHex(u));return new re.FeePayerRawTransaction(r,a,nn.fromHex(i))}async submitFeePayerTransaction(t,n,i,o=[]){const s=new re.TransactionAuthenticatorFeePayer(n,t.secondary_signer_addresses,o,{address:t.fee_payer_address,authenticator:i}),r=zi(new re.SignedTransaction(t.raw_txn,s));return await this.submitSignedBCSTransaction(r)}async signMultiTransaction(t,n){const i=new re.Ed25519Signature(t.signBuffer(Fi.getSigningMessage(n)).toUint8Array()),o=new re.AccountAuthenticatorEd25519(new re.Ed25519PublicKey(t.signingKey.publicKey),i);return Promise.resolve(o)}async signTransaction(t,n){return Promise.resolve(Ns.generateBCSTransaction(t,n))}async getEventsByCreationNumber(t,n,i){const{data:o}=await ui({url:this.nodeUrl,endpoint:`accounts/${Et.ensure(t).hex()}/events/${n}`,originMethod:"getEventsByCreationNumber",params:{start:i==null?void 0:i.start,limit:i==null?void 0:i.limit},overrides:{...this.config}});return o}async getEventsByEventHandle(t,n,i,o){const{data:s}=await ui({url:this.nodeUrl,endpoint:`accounts/${Et.ensure(t).hex()}/events/${n}/${i}`,originMethod:"getEventsByEventHandle",params:{start:o==null?void 0:o.start,limit:o==null?void 0:o.limit},overrides:{...this.config}});return s}async submitTransaction(t){return this.submitSignedBCSTransaction(t)}async simulateTransaction(t,n,i){let o;return t instanceof ia?o=Ns.generateBCSSimulation(t,n):t instanceof _a?o=new tp(()=>{const{threshold:r}=t,a=[],c=[];for(let l=0;l<r;l+=1)a.push(l),c.push(new re.Ed25519Signature(new Uint8Array(64)));const u=re.MultiEd25519Signature.createBitmap(a);return new re.MultiEd25519Signature(c,u)},t).sign(n):o=new rc(()=>{const r=new Uint8Array(64);return new re.Ed25519Signature(r)},t.toBytes()).sign(n),this.submitBCSSimulation(o,i)}async submitSignedBCSTransaction(t){const{data:n}=await ns({url:this.nodeUrl,body:t,endpoint:"transactions",originMethod:"submitSignedBCSTransaction",contentType:"application/x.aptos.signed_transaction+bcs",overrides:{...this.config}});return n}async submitBCSSimulation(t,n){var i,o,s;const r={estimate_gas_unit_price:(i=n==null?void 0:n.estimateGasUnitPrice)!=null?i:!1,estimate_max_gas_amount:(o=n==null?void 0:n.estimateMaxGasAmount)!=null?o:!1,estimate_prioritized_gas_unit_price:(s=n==null?void 0:n.estimatePrioritizedGasUnitPrice)!=null?s:!1},{data:a}=await ns({url:this.nodeUrl,body:t,endpoint:"transactions/simulate",params:r,originMethod:"submitBCSSimulation",contentType:"application/x.aptos.signed_transaction+bcs",overrides:{...this.config}});return a}async getTransactions(t){var n;const{data:i}=await ui({url:this.nodeUrl,endpoint:"transactions",originMethod:"getTransactions",params:{start:(n=t==null?void 0:t.start)==null?void 0:n.toString(),limit:t==null?void 0:t.limit},overrides:{...this.config}});return i}async getTransactionByHash(t){const{data:n}=await ui({url:this.nodeUrl,endpoint:`transactions/by_hash/${t}`,originMethod:"getTransactionByHash",overrides:{...this.config}});return n}async getTransactionByVersion(t){const{data:n}=await ui({url:this.nodeUrl,endpoint:`transactions/by_version/${t}`,originMethod:"getTransactionByVersion",overrides:{...this.config}});return n}async transactionPending(t){try{return(await this.getTransactionByHash(t)).type==="pending_transaction"}catch(n){if((n==null?void 0:n.status)===404)return!0;throw n}}async waitForTransactionWithResult(t,n){var i,o;const s=(i=n==null?void 0:n.timeoutSecs)!=null?i:j0,r=(o=n==null?void 0:n.checkSuccess)!=null?o:!1;let a=!0,c=0,u;for(;a&&!(c>=s);){try{if(u=await this.getTransactionByHash(t),a=u.type==="pending_transaction",!a)break}catch(l){const d=l instanceof pi,h=d&&l.status!==404&&l.status>=400&&l.status<500;if(!d||h)throw l}await zr(1e3),c+=1}if(u===void 0)throw new Error(`Waiting for transaction ${t} failed`);if(a)throw new ep(`Waiting for transaction ${t} timed out after ${s} seconds`,u);if(!r)return u;if(!(u!=null&&u.success))throw new np(`Transaction ${t} failed with an error: ${u.vm_status}`,u);return u}async waitForTransaction(t,n){await this.waitForTransactionWithResult(t,n)}async getLedgerInfo(){const{data:t}=await ui({url:this.nodeUrl,originMethod:"getLedgerInfo",overrides:{...this.config}});return t}async getChainId(){return(await this.getLedgerInfo()).chain_id}async getTableItem(t,n,i){var o;return(await ns({url:this.nodeUrl,body:n,endpoint:`tables/${t}/item`,originMethod:"getTableItem",params:{ledger_version:(o=i==null?void 0:i.ledgerVersion)==null?void 0:o.toString()},overrides:{...this.config}})).data}async generateRawTransaction(t,n,i){const[{sequence_number:o},s,{gas_estimate:r}]=await Promise.all([i!=null&&i.providedSequenceNumber?Promise.resolve({sequence_number:i.providedSequenceNumber}):this.getAccount(t),this.getChainId(),i!=null&&i.gasUnitPrice?Promise.resolve({gas_estimate:i.gasUnitPrice}):this.estimateGasPrice()]),{maxGasAmount:a,gasUnitPrice:c,expireTimestamp:u}={maxGasAmount:BigInt(N0),gasUnitPrice:BigInt(r),expireTimestamp:BigInt(Math.floor(Date.now()/1e3)+F0),...i};return new re.RawTransaction(re.AccountAddress.fromHex(t),BigInt(o),n,a,c,u,new re.ChainId(s))}async generateSignSubmitTransaction(t,n,i){const o=await this.generateRawTransaction(t.address(),n,i),s=Ns.generateBCSTransaction(t,o);return(await this.submitSignedBCSTransaction(s)).hash}async signAndSubmitTransaction(t,n){const i=Ns.generateBCSTransaction(t,n);return(await this.submitSignedBCSTransaction(i)).hash}async publishPackage(t,n,i,o){const s=new gn;Zn(i,s);const r=new re.TransactionPayloadEntryFunction(re.EntryFunction.natural("0x1::code","publish_package_txn",[],[Uo(n),s.getBytes()]));return this.generateSignSubmitTransaction(t,r,o)}async createResourceAccountAndPublishPackage(t,n,i,o,s){const r=new gn;Zn(o,r);const a=new re.TransactionPayloadEntryFunction(re.EntryFunction.natural("0x1::resource_account","create_resource_account_and_publish_package",[],[Uo(n),Uo(i),r.getBytes()]));return this.generateSignSubmitTransaction(t,a,s)}async generateSignSubmitWaitForTransaction(t,n,i){const o=await this.generateSignSubmitTransaction(t,n,i);return this.waitForTransactionWithResult(o,i)}async estimateGasPrice(){const{data:t}=await ui({url:this.nodeUrl,endpoint:"estimate_gas_price",originMethod:"estimateGasPrice",overrides:{...this.config}});return t}async estimateMaxGasAmount(t){const n=`0x1::coin::CoinStore<${bc}>`,[{gas_estimate:i},o]=await Promise.all([this.estimateGasPrice(),this.getAccountResources(t)]),s=o.find(a=>a.type===n);return BigInt(s.data.coin.value)/BigInt(i)}async rotateAuthKeyEd25519(t,n,i){const{sequence_number:o,authentication_key:s}=await this.getAccount(t.address()),r=new ia(n),a=new re.RotationProofChallenge(re.AccountAddress.CORE_CODE_ADDRESS,"account","RotationProofChallenge",BigInt(o),re.AccountAddress.fromHex(t.address()),new re.AccountAddress(new Et(s).toUint8Array()),r.pubKey().toUint8Array()),c=Et.fromUint8Array(zi(a)),u=t.signHexString(c),l=r.signHexString(c),d=new re.TransactionPayloadEntryFunction(re.EntryFunction.natural("0x1::account","rotate_authentication_key",[],[Ml(0),Uo(t.pubKey().toUint8Array()),Ml(0),Uo(r.pubKey().toUint8Array()),Uo(u.toUint8Array()),Uo(l.toUint8Array())])),h=await this.generateRawTransaction(t.address(),d,i),g=Ns.generateBCSTransaction(t,h);return this.submitSignedBCSTransaction(g)}async lookupOriginalAddress(t){const n=await this.getAccountResource("0x1","0x1::account::OriginatingAddress"),{address_map:{handle:i}}=n.data,o=await this.getTableItem(i,{key_type:"address",value_type:"address",key:Et.ensure(t).hex()});return new Et(o)}async getBlockByHeight(t,n){const{data:i}=await ui({url:this.nodeUrl,endpoint:`blocks/by_height/${t}`,originMethod:"getBlockByHeight",params:{with_transactions:n},overrides:{...this.config}});return i}async getBlockByVersion(t,n){const{data:i}=await ui({url:this.nodeUrl,endpoint:`blocks/by_version/${t}`,originMethod:"getBlockByVersion",params:{with_transactions:n},overrides:{...this.config}});return i}async view(t,n){const{data:i}=await ns({url:this.nodeUrl,body:t,endpoint:"view",originMethod:"getTableItem",params:{ledger_version:n},overrides:{...this.config}});return i}clearCache(t){wb(t)}},Ce=Ns;un([Un],Ce.prototype,"getAccount",1);un([Un],Ce.prototype,"getAccountTransactions",1);un([Un,z0(10*60*1e3)],Ce.prototype,"getAccountModules",1);un([Un],Ce.prototype,"getAccountModule",1);un([Un],Ce.prototype,"getAccountResources",1);un([Un],Ce.prototype,"getAccountResource",1);un([Un],Ce.prototype,"getEventsByCreationNumber",1);un([Un],Ce.prototype,"getEventsByEventHandle",1);un([Un],Ce.prototype,"submitSignedBCSTransaction",1);un([Un],Ce.prototype,"submitBCSSimulation",1);un([Un],Ce.prototype,"getTransactions",1);un([Un],Ce.prototype,"getTransactionByHash",1);un([Un],Ce.prototype,"getTransactionByVersion",1);un([Un],Ce.prototype,"getLedgerInfo",1);un([Gc()],Ce.prototype,"getChainId",1);un([Un],Ce.prototype,"getTableItem",1);un([Un,Gc({ttlMs:5*60*1e3,tags:["gas_estimates"]})],Ce.prototype,"estimateGasPrice",1);un([Un],Ce.prototype,"estimateMaxGasAmount",1);un([Un],Ce.prototype,"getBlockByHeight",1);un([Un],Ce.prototype,"getBlockByVersion",1);un([Un],Ce.prototype,"view",1);var ep=class extends Error{constructor(t,n){super(t),this.lastSubmittedTransaction=n}},np=class extends Error{constructor(t,n){super(t),this.transaction=n}},pi=class extends Error{constructor(t,n,i,o){super(n),this.status=t,this.message=n,this.errorCode=i,this.vmErrorCode=o}};function Un(e,t,n){const i=n.value;return n.value=async function(...s){var r,a;try{return await i.apply(this,[...s])}catch(c){throw c instanceof md?new pi(c.status,JSON.stringify({message:c.message,...c.data}),(r=c.data)==null?void 0:r.error_code,(a=c.data)==null?void 0:a.vm_error_code):c}},n}var An=class{constructor(t,n){this.endpoint=t,this.config=n}static validateAddress(t){if(t.length<66)throw new Error(`${t} is less than 66 chars long.`)}async queryIndexer(t){const n=await ns({url:this.endpoint,body:t,overrides:{WITH_CREDENTIALS:!1,...this.config}});if(n.data.errors)throw new pi(n.data.errors[0].extensions.code,JSON.stringify({message:n.data.errors[0].message,error_code:n.data.errors[0].extensions.code}));return n.data.data}async getIndexerLedgerInfo(){const t={query:t1};return this.queryIndexer(t)}async getAccountNFTs(t,n){const i=Et.ensure(t).hex();An.validateAddress(i);const o={query:Gb,variables:{address:i,offset:n==null?void 0:n.offset,limit:n==null?void 0:n.limit}};return this.queryIndexer(o)}async getTokenActivities(t,n){var i,o;const s=Et.ensure(t).hex();An.validateAddress(s);const r={token_data_id:{_eq:s}};n!=null&&n.tokenStandard&&(r.token_standard={_eq:n==null?void 0:n.tokenStandard});const a={query:o1,variables:{where_condition:r,offset:(i=n==null?void 0:n.options)==null?void 0:i.offset,limit:(o=n==null?void 0:n.options)==null?void 0:o.limit,order_by:n==null?void 0:n.orderBy}};return this.queryIndexer(a)}async getTokenActivitiesCount(t){const n={query:s1,variables:{token_id:t}};return this.queryIndexer(n)}async getAccountTokensCount(t,n){var i,o;const s={owner_address:{_eq:t},amount:{_gt:"0"}};n!=null&&n.tokenStandard&&(s.token_standard={_eq:n==null?void 0:n.tokenStandard});const r=Et.ensure(t).hex();An.validateAddress(r);const a={query:Wb,variables:{where_condition:s,offset:(i=n==null?void 0:n.options)==null?void 0:i.offset,limit:(o=n==null?void 0:n.options)==null?void 0:o.limit}};return this.queryIndexer(a)}async getTokenData(t,n){var i,o;const s=Et.ensure(t).hex();An.validateAddress(s);const r={token_data_id:{_eq:s}};n!=null&&n.tokenStandard&&(r.token_standard={_eq:n==null?void 0:n.tokenStandard});const a={query:a1,variables:{where_condition:r,offset:(i=n==null?void 0:n.options)==null?void 0:i.offset,limit:(o=n==null?void 0:n.options)==null?void 0:o.limit,order_by:n==null?void 0:n.orderBy}};return this.queryIndexer(a)}async getTokenOwnersData(t,n,i){var o,s;const r=Et.ensure(t).hex();An.validateAddress(r);const a={token_data_id:{_eq:r},amount:{_gt:"0"}};n&&(a.property_version_v1={_eq:n}),i!=null&&i.tokenStandard&&(a.token_standard={_eq:i==null?void 0:i.tokenStandard});const c={query:u1,variables:{where_condition:a,offset:(o=i==null?void 0:i.options)==null?void 0:o.offset,limit:(s=i==null?void 0:i.options)==null?void 0:s.limit,order_by:i==null?void 0:i.orderBy}};return this.queryIndexer(c)}async getTokenCurrentOwnerData(t,n,i){var o,s;const r=Et.ensure(t).hex();An.validateAddress(r);const a={token_data_id:{_eq:r},amount:{_gt:"0"}};n&&(a.property_version_v1={_eq:n}),i!=null&&i.tokenStandard&&(a.token_standard={_eq:i==null?void 0:i.tokenStandard});const c={query:r1,variables:{where_condition:a,offset:(o=i==null?void 0:i.options)==null?void 0:o.offset,limit:(s=i==null?void 0:i.options)==null?void 0:s.limit,order_by:i==null?void 0:i.orderBy}};return this.queryIndexer(c)}async getOwnedTokens(t,n){var i,o;const s=Et.ensure(t).hex();An.validateAddress(s);const r={owner_address:{_eq:s},amount:{_gt:0}};n!=null&&n.tokenStandard&&(r.token_standard={_eq:n==null?void 0:n.tokenStandard});const a={query:n1,variables:{where_condition:r,offset:(i=n==null?void 0:n.options)==null?void 0:i.offset,limit:(o=n==null?void 0:n.options)==null?void 0:o.limit,order_by:n==null?void 0:n.orderBy}};return this.queryIndexer(a)}async getOwnedTokensByTokenData(t,n){var i,o;const s=Et.ensure(t).hex();An.validateAddress(s);const r={token_data_id:{_eq:s},amount:{_gt:0}};n!=null&&n.tokenStandard&&(r.token_standard={_eq:n==null?void 0:n.tokenStandard});const a={query:i1,variables:{where_condition:r,offset:(i=n==null?void 0:n.options)==null?void 0:i.offset,limit:(o=n==null?void 0:n.options)==null?void 0:o.limit,order_by:n==null?void 0:n.orderBy}};return this.queryIndexer(a)}async getTokenOwnedFromCollectionAddress(t,n,i){var o,s;const r=Et.ensure(t).hex();An.validateAddress(r);const a=Et.ensure(n).hex();An.validateAddress(a);const c={owner_address:{_eq:r},current_token_data:{collection_id:{_eq:a}},amount:{_gt:0}};i!=null&&i.tokenStandard&&(c.token_standard={_eq:i==null?void 0:i.tokenStandard});const u={query:c1,variables:{where_condition:c,offset:(o=i==null?void 0:i.options)==null?void 0:o.offset,limit:(s=i==null?void 0:i.options)==null?void 0:s.limit,order_by:i==null?void 0:i.orderBy}};return this.queryIndexer(u)}async getTokenOwnedFromCollectionNameAndCreatorAddress(t,n,i,o){const s=await this.getCollectionAddress(i,n,o);return await this.getTokenOwnedFromCollectionAddress(t,s,o)}async getCollectionData(t,n,i){var o,s;const r=Et.ensure(t).hex();An.validateAddress(r);const a={collection_name:{_eq:n},creator_address:{_eq:r}};i!=null&&i.tokenStandard&&(a.token_standard={_eq:i==null?void 0:i.tokenStandard});const c={query:Jb,variables:{where_condition:a,offset:(o=i==null?void 0:i.options)==null?void 0:o.offset,limit:(s=i==null?void 0:i.options)==null?void 0:s.limit,order_by:i==null?void 0:i.orderBy}};return this.queryIndexer(c)}async getCollectionAddress(t,n,i){return(await this.getCollectionData(t,n,i)).current_collections_v2[0].collection_id}async getCollectionsWithOwnedTokens(t,n){var i,o;const s=Et.ensure(t).hex();An.validateAddress(s);const r={owner_address:{_eq:s}};n!=null&&n.tokenStandard&&(r.current_collection={token_standard:{_eq:n==null?void 0:n.tokenStandard}});const a={query:Zb,variables:{where_condition:r,offset:(i=n==null?void 0:n.options)==null?void 0:i.offset,limit:(o=n==null?void 0:n.options)==null?void 0:o.limit,order_by:n==null?void 0:n.orderBy}};return this.queryIndexer(a)}async getAccountTransactionsCount(t){const n=Et.ensure(t).hex();An.validateAddress(n);const i={query:Xb,variables:{address:n}};return this.queryIndexer(i)}async getAccountTransactionsData(t,n){var i,o;const s=Et.ensure(t).hex();An.validateAddress(s);const a={query:Vb,variables:{where_condition:{account_address:{_eq:s}},offset:(i=n==null?void 0:n.options)==null?void 0:i.offset,limit:(o=n==null?void 0:n.options)==null?void 0:o.limit,order_by:n==null?void 0:n.orderBy}};return this.queryIndexer(a)}async getTopUserTransactions(t){const n={query:l1,variables:{limit:t}};return this.queryIndexer(n)}async getUserTransactions(t){var n,i;const o={version:{_lte:t==null?void 0:t.startVersion}},s={query:d1,variables:{where_condition:o,offset:(n=t==null?void 0:t.options)==null?void 0:n.offset,limit:(i=t==null?void 0:t.options)==null?void 0:i.limit,order_by:t==null?void 0:t.orderBy}};return this.queryIndexer(s)}async getDelegatedStakingActivities(t,n){const i=Et.ensure(t).hex(),o=Et.ensure(n).hex();An.validateAddress(i),An.validateAddress(o);const s={query:Qb,variables:{delegatorAddress:i,poolAddress:o}};return this.queryIndexer(s)}async getNumberOfDelegators(t){const n=Et.ensure(t).hex();An.validateAddress(n);const i={query:e1,variables:{poolAddress:n}};return this.queryIndexer(i)}async getAccountCoinsData(t,n){var i,o;const s=Et.ensure(t).hex();An.validateAddress(s);const a={query:Kb,variables:{where_condition:{owner_address:{_eq:s}},offset:(i=n==null?void 0:n.options)==null?void 0:i.offset,limit:(o=n==null?void 0:n.options)==null?void 0:o.limit,order_by:n==null?void 0:n.orderBy}};return this.queryIndexer(a)}async getAccountCoinsDataCount(t){const n=Et.ensure(t).hex();An.validateAddress(n);const i={query:Hb,variables:{address:n}};return this.queryIndexer(i)}async getAccountOwnedObjects(t,n){var i,o;const s=Et.ensure(t).hex();An.validateAddress(s);const a={query:Yb,variables:{where_condition:{owner_address:{_eq:s}},offset:(i=n==null?void 0:n.options)==null?void 0:i.offset,limit:(o=n==null?void 0:n.options)==null?void 0:o.limit,order_by:n==null?void 0:n.orderBy}};return this.queryIndexer(a)}},oa=class{constructor(t,n,i=!1){let o=null,s=null;if(typeof t=="object"&&_1(t)?(o=t.fullnodeUrl,s=t.indexerUrl,this.network="CUSTOM"):(o=H0[t],s=vc[t],this.network=t),this.network==="CUSTOM"&&!o)throw new Error("fullnode url is not provided");s&&(this.indexerClient=new An(s,n)),this.aptosClient=new Ce(o,n,i)}};function ip(e,t,n){Object.getOwnPropertyNames(t.prototype).forEach(i=>{const o=Object.getOwnPropertyDescriptor(t.prototype,i);o&&(o.value=function(...s){return this[n][i](...s)},Object.defineProperty(e.prototype,i,o))}),Object.getOwnPropertyNames(t).forEach(i=>{const o=Object.getOwnPropertyDescriptor(t,i);o&&(o.value=function(...s){return this[n][i](...s)},!e.hasOwnProperty.call(e,i)&&Object.defineProperty(e,i,o))})}ip(oa,Ce,"aptosClient");ip(oa,An,"indexerClient");function _1(e){return e.fullnodeUrl!==void 0&&typeof e.fullnodeUrl=="string"}var Rd=class{constructor(t,n){this.type=t,this.value=n}},gu=class{constructor(){this.data={}}setProperty(t,n){this.data[t]=n}};function _u(e){let t;return e==="string"||e==="String"?t=new Wo(kd):t=new As(e).parseTypeTag(),t}function Ac(e,t){if(e.length!==t.length)throw new Error("Length of property values and types not match");const n=new Array;return t.forEach((i,o)=>{try{const s=_u(i),r=new gn;pu(e[o],s,r),n.push(r.getBytes())}catch{n.push(new TextEncoder().encode(e[o]))}}),n}function Ll(e,t){if(!e||!t)throw new Error("value or type can not be empty");try{const n=_u(t),i=new gn;return pu(e,n,i),i.getBytes()}catch{return new TextEncoder().encode(e)}}function $d(e){const t=e.map.data,n=new gu;return t.forEach(i=>{const{key:o}=i,s=i.value.value,r=i.value.type,a=_u(r),c=op(a,s),u=new Rd(r,c);n.setProperty(o,u)}),n}function op(e,t){const n=new wd(new Et(t).toUint8Array());let i="";return e instanceof fo?i=n.deserializeU8().toString():e instanceof vs?i=n.deserializeU64().toString():e instanceof Ts?i=n.deserializeU128().toString():e instanceof bs?i=n.deserializeBool()?"true":"false":e instanceof Go?i=Et.fromUint8Array(n.deserializeFixedBytes(32)).hex():e instanceof Wo&&e.isStringTypeTag()?i=n.deserializeStr():i=t,i}var sp={};Kc(sp,{PropertyMap:()=>gu,PropertyValue:()=>Rd,Token:()=>ap,TokenData:()=>rp});var rp=class{constructor(t,n,i,o,s,r,a,c){this.collection=t,this.description=n,this.name=i,this.maximum=o,this.supply=s,this.uri=r,this.default_properties=$d(a),this.mutability_config=c}},ap=class{constructor(t,n,i){this.id=t,this.amount=n,this.token_properties=$d(i)}},m1=class{constructor(t){this.aptosClient=t}async createCollection(t,n,i,o,s=tr,r){const c=await new pn(this.aptosClient,{sender:t.address(),...r}).build("0x3::token::create_collection_script",[],[n,i,o,s,[!1,!1,!1]]),u=Ce.generateBCSTransaction(t,c);return(await this.aptosClient.submitSignedBCSTransaction(u)).hash}async createToken(t,n,i,o,s,r,a=tr,c=t.address(),u=0,l=0,d=[],h=[],g=[],b){const x=await new pn(this.aptosClient,{sender:t.address(),...b}).build("0x3::token::create_token_script",[],[n,i,o,s,a,r,c,u,l,[!1,!1,!1,!1,!1],d,Ac(h,g),g]),P=Ce.generateBCSTransaction(t,x);return(await this.aptosClient.submitSignedBCSTransaction(P)).hash}async createTokenWithMutabilityConfig(t,n,i,o,s,r,a=tr,c=t.address(),u=0,l=0,d=[],h=[],g=[],b=[!1,!1,!1,!1,!1],v){const P=await new pn(this.aptosClient,{sender:t.address(),...v}).build("0x3::token::create_token_script",[],[n,i,o,s,a,r,c,u,l,b,d,h,g]),E=Ce.generateBCSTransaction(t,P);return(await this.aptosClient.submitSignedBCSTransaction(E)).hash}async offerToken(t,n,i,o,s,r,a=0,c){const l=await new pn(this.aptosClient,{sender:t.address(),...c}).build("0x3::token_transfers::offer_script",[],[n,i,o,s,a,r]),d=Ce.generateBCSTransaction(t,l);return(await this.aptosClient.submitSignedBCSTransaction(d)).hash}async claimToken(t,n,i,o,s,r=0,a){const u=await new pn(this.aptosClient,{sender:t.address(),...a}).build("0x3::token_transfers::claim_script",[],[n,i,o,s,r]),l=Ce.generateBCSTransaction(t,u);return(await this.aptosClient.submitSignedBCSTransaction(l)).hash}async cancelTokenOffer(t,n,i,o,s,r=0,a){const u=await new pn(this.aptosClient,{sender:t.address(),...a}).build("0x3::token_transfers::cancel_offer_script",[],[n,i,o,s,r]),l=Ce.generateBCSTransaction(t,u);return(await this.aptosClient.submitSignedBCSTransaction(l)).hash}async directTransferToken(t,n,i,o,s,r,a=0,c){const l=await new pn(this.aptosClient,{sender:t.address(),...c}).build("0x3::token::direct_transfer_script",[],[i,o,s,a,r]),d=new re.MultiAgentRawTransaction(l,[re.AccountAddress.fromHex(n.address())]),h=new re.Ed25519Signature(t.signBuffer(Fi.getSigningMessage(d)).toUint8Array()),g=new re.AccountAuthenticatorEd25519(new re.Ed25519PublicKey(t.signingKey.publicKey),h),b=new re.Ed25519Signature(n.signBuffer(Fi.getSigningMessage(d)).toUint8Array()),v=new re.AccountAuthenticatorEd25519(new re.Ed25519PublicKey(n.signingKey.publicKey),b),x=new re.TransactionAuthenticatorMultiAgent(g,[re.AccountAddress.fromHex(n.address())],[v]),P=zi(new re.SignedTransaction(l,x));return(await this.aptosClient.submitSignedBCSTransaction(P)).hash}async directTransferTokenWithFeePayer(t,n,i,o,s,r,a,c=0,u){const d=await new pn(this.aptosClient,{sender:t.address(),...u}).build("0x3::token::direct_transfer_script",[],[i,o,s,c,r]),h=new re.FeePayerRawTransaction(d,[re.AccountAddress.fromHex(n.address())],re.AccountAddress.fromHex(a.address())),g=new re.Ed25519Signature(t.signBuffer(Fi.getSigningMessage(h)).toUint8Array()),b=new re.AccountAuthenticatorEd25519(new re.Ed25519PublicKey(t.signingKey.publicKey),g),v=new re.Ed25519Signature(n.signBuffer(Fi.getSigningMessage(h)).toUint8Array()),x=new re.AccountAuthenticatorEd25519(new re.Ed25519PublicKey(n.signingKey.publicKey),v),P=new re.Ed25519Signature(a.signBuffer(Fi.getSigningMessage(h)).toUint8Array()),E=new re.AccountAuthenticatorEd25519(new re.Ed25519PublicKey(a.signingKey.publicKey),P),S=new re.TransactionAuthenticatorFeePayer(b,[re.AccountAddress.fromHex(n.address())],[x],{address:re.AccountAddress.fromHex(a.address()),authenticator:E}),T=zi(new re.SignedTransaction(d,S));return(await this.aptosClient.submitSignedBCSTransaction(T)).hash}async optInTokenTransfer(t,n,i){const s=await new pn(this.aptosClient,{sender:t.address(),...i}).build("0x3::token::opt_in_direct_transfer",[],[n]),r=Ce.generateBCSTransaction(t,s);return(await this.aptosClient.submitSignedBCSTransaction(r)).hash}async transferWithOptIn(t,n,i,o,s,r,a,c){const l=await new pn(this.aptosClient,{sender:t.address(),...c}).build("0x3::token::transfer_with_opt_in",[],[n,i,o,s,r,a]),d=Ce.generateBCSTransaction(t,l);return(await this.aptosClient.submitSignedBCSTransaction(d)).hash}async burnByCreator(t,n,i,o,s,r,a){const u=await new pn(this.aptosClient,{sender:t.address(),...a}).build("0x3::token::burn_by_creator",[],[n,i,o,s,r]),l=Ce.generateBCSTransaction(t,u);return(await this.aptosClient.submitSignedBCSTransaction(l)).hash}async burnByOwner(t,n,i,o,s,r,a){const u=await new pn(this.aptosClient,{sender:t.address(),...a}).build("0x3::token::burn",[],[n,i,o,s,r]),l=Ce.generateBCSTransaction(t,u);return(await this.aptosClient.submitSignedBCSTransaction(l)).hash}async mutateTokenProperties(t,n,i,o,s,r,a,c,u,l,d){const g=await new pn(this.aptosClient,{sender:t.address(),...d}).build("0x3::token::mutate_token_properties",[],[n,i,o,s,r,a,c,u,l]),b=Ce.generateBCSTransaction(t,g);return(await this.aptosClient.submitSignedBCSTransaction(b)).hash}async getCollectionData(t,n){const o=(await this.aptosClient.getAccountResources(t)).find(c=>c.type==="0x3::token::Collections"),{handle:s}=o.data.collection_data,r={key_type:"0x1::string::String",value_type:"0x3::token::CollectionData",key:n};return await this.aptosClient.getTableItem(s,r)}async getTokenData(t,n,i){const o=t instanceof Et?t.hex():t,s=await this.aptosClient.getAccountResource(o,"0x3::token::Collections"),{handle:r}=s.data.token_data,c={key_type:"0x3::token::TokenDataId",value_type:"0x3::token::TokenData",key:{creator:o,collection:n,name:i}},u=await this.aptosClient.getTableItem(r,c);return new rp(u.collection,u.description,u.name,u.maximum,u.supply,u.uri,u.default_properties,u.mutability_config)}async getToken(t,n,i,o="0"){const s={creator:t instanceof Et?t.hex():t,collection:n,name:i};return this.getTokenForAccount(t,{token_data_id:s,property_version:o})}async getTokenForAccount(t,n){const i=await this.aptosClient.getAccountResource(t instanceof Et?t.hex():t,"0x3::token::TokenStore"),{handle:o}=i.data.tokens,s={key_type:"0x3::token::TokenId",value_type:"0x3::token::Token",key:n};try{const r=await this.aptosClient.getTableItem(o,s);return new ap(r.id,r.amount,r.token_properties)}catch(r){return(r==null?void 0:r.status)===404?{id:n,amount:"0",token_properties:new gu}:r}}},xc=class{constructor(e){this.assetType="0x1::fungible_asset::Metadata",this.provider=e}async transfer(e,t,n,i,o){const s=await this.generateTransfer(e,t,n,i,o);return await this.provider.signAndSubmitTransaction(e,s)}async getPrimaryBalance(e,t){const n={function:"0x1::primary_fungible_store::balance",type_arguments:[this.assetType],arguments:[Et.ensure(e).hex(),Et.ensure(t).hex()]},i=await this.provider.view(n);return BigInt(i[0])}async generateTransfer(e,t,n,i,o){return await new pn(this.provider,{sender:e.address(),...o}).build("0x1::primary_fungible_store::transfer",[this.assetType],[Et.ensure(t).hex(),Et.ensure(n).hex(),i])}},$s={BOOLEAN:"bool",U8:"u8",U16:"u16",U32:"u32",U64:"u64",U128:"u128",U256:"u256",ADDRESS:"address",VECTOR:"vector<u8>",STRING:"string"},y1=class{constructor(e){this.tokenType="0x4::token::Token",this.provider=e}async submitTransaction(e,t,n,i,o){const r=await new pn(this.provider,{sender:e.address(),...o}).build(`0x4::aptos_token::${t}`,n,i),a=Ce.generateBCSTransaction(e,r);return(await this.provider.submitSignedBCSTransaction(a)).hash}async createCollection(e,t,n,i,o=tr,s,r){var a,c,u,l,d,h,g,b,v,x,P;return this.submitTransaction(e,"create_collection",[],[t,o,n,i,(a=s==null?void 0:s.mutableDescription)!=null?a:!0,(c=s==null?void 0:s.mutableRoyalty)!=null?c:!0,(u=s==null?void 0:s.mutableURI)!=null?u:!0,(l=s==null?void 0:s.mutableTokenDescription)!=null?l:!0,(d=s==null?void 0:s.mutableTokenName)!=null?d:!0,(h=s==null?void 0:s.mutableTokenProperties)!=null?h:!0,(g=s==null?void 0:s.mutableTokenURI)!=null?g:!0,(b=s==null?void 0:s.tokensBurnableByCreator)!=null?b:!0,(v=s==null?void 0:s.tokensFreezableByCreator)!=null?v:!0,(x=s==null?void 0:s.royaltyNumerator)!=null?x:0,(P=s==null?void 0:s.royaltyDenominator)!=null?P:1],r)}async mint(e,t,n,i,o,s=[],r=[],a=[],c){return this.submitTransaction(e,"mint",[],[t,n,i,o,s,r,Ac(a,r)],c)}async mintSoulBound(e,t,n,i,o,s,r=[],a=[],c=[],u){return this.submitTransaction(e,"mint_soul_bound",[],[t,n,i,o,r,a,Ac(c,a),s.address().hex()],u)}async burnToken(e,t,n,i){return this.submitTransaction(e,"burn",[n||this.tokenType],[Et.ensure(t).hex()],i)}async freezeTokenTransafer(e,t,n,i){return this.submitTransaction(e,"freeze_transfer",[n||this.tokenType],[Et.ensure(t).hex()],i)}async unfreezeTokenTransafer(e,t,n,i){return this.submitTransaction(e,"unfreeze_transfer",[n||this.tokenType],[Et.ensure(t).hex()],i)}async setTokenDescription(e,t,n,i,o){return this.submitTransaction(e,"set_description",[i||this.tokenType],[Et.ensure(t).hex(),n],o)}async setTokenName(e,t,n,i,o){return this.submitTransaction(e,"set_name",[i||this.tokenType],[Et.ensure(t).hex(),n],o)}async setTokenURI(e,t,n,i,o){return this.submitTransaction(e,"set_uri",[i||this.tokenType],[Et.ensure(t).hex(),n],o)}async addTokenProperty(e,t,n,i,o,s,r){return this.submitTransaction(e,"add_property",[s||this.tokenType],[Et.ensure(t).hex(),n,$s[i],Ll(o,$s[i])],r)}async removeTokenProperty(e,t,n,i,o){return this.submitTransaction(e,"remove_property",[i||this.tokenType],[Et.ensure(t).hex(),n],o)}async updateTokenProperty(e,t,n,i,o,s,r){return this.submitTransaction(e,"update_property",[s||this.tokenType],[Et.ensure(t).hex(),n,$s[i],Ll(o,$s[i])],r)}async addTypedProperty(e,t,n,i,o,s,r){return this.submitTransaction(e,"add_typed_property",[s||this.tokenType,$s[i]],[Et.ensure(t).hex(),n,o],r)}async updateTypedProperty(e,t,n,i,o,s,r){return this.submitTransaction(e,"update_typed_property",[s||this.tokenType,$s[i]],[Et.ensure(t).hex(),n,o],r)}async transferTokenOwnership(e,t,n,i,o){const r=await new pn(this.provider,{sender:e.address(),...o}).build("0x1::object::transfer",[i||this.tokenType],[Et.ensure(t).hex(),Et.ensure(n).hex()]),a=Ce.generateBCSTransaction(e,r);return(await this.provider.submitSignedBCSTransaction(a)).hash}async transfer(e,t){let n=t;if(n==null&&(n=(await this.provider.getTokenData(Et.ensure(e.tokenAddress).hex())).current_token_datas_v2[0].is_fungible_v2),n){const s=e;return await new xc(this.provider).transfer(s.owner,s.tokenAddress,s.recipient,s.amount,s.extraArgs)}const i=e;return await this.transferTokenOwnership(i.owner,i.tokenAddress,i.recipient,i.tokenType,i.extraArgs)}async burnObject(e,t,n,i){const s=await new pn(this.provider,{sender:e.address(),...i}).build("0x1::object::burn",[n||"0x1::object::ObjectCore"],[Et.ensure(t).hex()]),r=Ce.generateBCSTransaction(e,s);return(await this.provider.submitSignedBCSTransaction(r)).hash}},Nl="0x1::aptos_account::transfer_coins",cp="0x1::coin::transfer",w1=class{constructor(e){this.aptosClient=e}async transfer(e,t,n,i){var o,s,r;const a=((o=i==null?void 0:i.coinType)!=null?o:"").toString().includes("::");if(i!=null&&i.coinType&&!a&&nn.isValid(i.coinType)){console.warn("to transfer a fungible asset, use `FungibleAssetClient()` class for better support");const v=new oa({fullnodeUrl:this.aptosClient.nodeUrl,indexerUrl:(s=vc[ql[this.aptosClient.nodeUrl]])!=null?s:this.aptosClient.nodeUrl});return await new xc(v).transfer(e,i==null?void 0:i.coinType,Ni(t),n)}const c=(r=i==null?void 0:i.coinType)!=null?r:bc;let u;(i==null?void 0:i.createReceiverIfMissing)===void 0?u=Nl:u=i!=null&&i.createReceiverIfMissing?Nl:cp;const l=Ni(t),h=await new pn(this.aptosClient,{sender:e.address(),...i}).build(u,[c],[l,n]),g=Ce.generateBCSTransaction(e,h);return(await this.aptosClient.submitSignedBCSTransaction(g)).hash}async checkBalance(e,t){var n,i,o;const s=((n=t==null?void 0:t.coinType)!=null?n:"").toString().includes("::");if(t!=null&&t.coinType&&!s&&nn.isValid(t.coinType)){console.warn("to check balance of a fungible asset, use `FungibleAssetClient()` class for better support");const l=new oa({fullnodeUrl:this.aptosClient.nodeUrl,indexerUrl:(i=vc[ql[this.aptosClient.nodeUrl]])!=null?i:this.aptosClient.nodeUrl});return await new xc(l).getPrimaryBalance(Ni(e),t==null?void 0:t.coinType)}const a=`0x1::coin::CoinStore<${(o=t==null?void 0:t.coinType)!=null?o:bc}>`,c=Ni(e),u=await this.aptosClient.getAccountResource(c,a);return BigInt(u.data.coin.value)}},b1=class extends Ce{constructor(e,t,n){if(super(e,n),!t)throw new Error("Faucet URL cannot be empty.");this.faucetUrl=t,this.config=n}async fundAccount(e,t,n=j0){const{data:i}=await ns({url:this.faucetUrl,endpoint:"mint",body:null,params:{address:Et.ensure(e).noPrefix(),amount:t},overrides:{...this.config},originMethod:"fundAccount"}),o=[];for(let s=0;s<i.length;s+=1){const r=i[s];o.push(this.waitForTransaction(r,{timeoutSecs:n}))}return await Promise.all(o),i}},Fl={testnet:"0x5f8fd2347449685cf41d4db97926ec3a096eaf381332be4f1318ad4d16a8497c",mainnet:"0x867ed1f6bf916171b1de3ee92849b8978b7d1b9e0a8cc982a3d19d535dfd9c0c"},ao=/^[a-z\d][a-z\d-]{1,61}[a-z\d]$/,up=new RegExp("^(?:(?<subdomain>[^.]+)\\.(?!apt$))?(?<domain>[^.]+)(?:\\.apt)?$"),v1=class{constructor(e,t){var n;if(this.provider=e,!Fl[this.provider.network]&&!t)throw new Error("Error: For custom providers, you must pass in a contract address");this.contractAddress=(n=Fl[this.provider.network])!=null?n:t}async getPrimaryNameByAddress(e){const n=(await this.provider.getAccountResource(this.contractAddress,`${this.contractAddress}::domains::ReverseLookupRegistryV1`)).data,{handle:i}=n.registry,o={key_type:"address",value_type:`${this.contractAddress}::domains::NameRecordKeyV1`,key:e};try{const s=await this.provider.getTableItem(i,o);return s.subdomain_name.vec[0]?`${s.subdomain_name.vec[0]}.${s.domain_name}`:s.domain_name}catch(s){if(s.status===404)return null;throw new Error(s)}}async getAddressByName(e){var t,n;const{domain:i,subdomain:o}=(n=(t=e.match(up))==null?void 0:t.groups)!=null?n:{};if(!i)return null;const s=o?await this.getRegistrationForSubdomainName(i,o):await this.getRegistrationForDomainName(i);return s===null?null:s.target}async mintAptosName(e,t,n=1,i){if(t.match(ao)===null)throw new pi(400,`Name ${t} is not valid`);const o=await this.getRegistrationForDomainName(t);if(o&&Math.ceil(Date.now()/1e3)<o.expirationTimestampSeconds)throw new pi(400,`Name ${t} is not available`);const r=await new pn(this.provider.aptosClient,{sender:e.address(),...i}).build(`${this.contractAddress}::domains::register_domain`,[],[t,n]),a=Ce.generateBCSTransaction(e,r);return(await this.provider.submitSignedBCSTransaction(a)).hash}async mintAptosSubdomain(e,t,n,i,o){if(n.match(ao)===null)throw new pi(400,`Domain name ${n} is not valid`);if(t.match(ao)===null)throw new pi(400,`Subdomain name ${t} is not valid`);const s=await this.getRegistrationForSubdomainName(n,t);if(s&&Math.ceil(Date.now()/1e3)<s.expirationTimestampSeconds)throw new pi(400,`Name ${t}.${n} is not available`);const r=await this.getRegistrationForDomainName(n);if(r===null)throw new pi(400,`Domain name ${n} does not exist`);const a=Math.ceil(Date.now()/1e3);if(r.expirationTimestampSeconds<a)throw new pi(400,`Domain name ${n} expired`);const c=i||r.expirationTimestampSeconds;if(c<a)throw new pi(400,`Expiration for ${t}.${n} is before now`);const l=await new pn(this.provider.aptosClient,{sender:e.address(),...o}).build(`${this.contractAddress}::domains::register_subdomain`,[],[t,n,c]),d=Ce.generateBCSTransaction(e,l);return(await this.provider.submitSignedBCSTransaction(d)).hash}async setSubdomainAddress(e,t,n,i,o){const s=nn.standardizeAddress(i);if(n.match(ao)===null)throw new pi(400,`Name ${n} is not valid`);if(t.match(ao)===null)throw new pi(400,`Name ${t} is not valid`);const a=await new pn(this.provider.aptosClient,{sender:e.address(),...o}).build(`${this.contractAddress}::domains::set_subdomain_address`,[],[t,n,s]),c=Ce.generateBCSTransaction(e,a);return(await this.provider.submitSignedBCSTransaction(c)).hash}async initReverseLookupRegistry(e,t){const i=await new pn(this.provider.aptosClient,{sender:e.address(),...t}).build(`${this.contractAddress}::domains::init_reverse_lookup_registry_v1`,[],[]),o=Ce.generateBCSTransaction(e,i);return(await this.provider.submitSignedBCSTransaction(o)).hash}async getRegistrationForDomainName(e){if(e.match(ao)===null)return null;const n=(await this.provider.getAccountResource(this.contractAddress,`${this.contractAddress}::domains::NameRegistryV1`)).data,{handle:i}=n.registry,o={key_type:`${this.contractAddress}::domains::NameRecordKeyV1`,value_type:`${this.contractAddress}::domains::NameRecordV1`,key:{subdomain_name:{vec:[]},domain_name:e}};try{const s=await this.provider.getTableItem(i,o);return{target:s.target_address.vec.length===1?s.target_address.vec[0]:null,expirationTimestampSeconds:s.expiration_time_sec}}catch(s){if(s.status===404)return null;throw new Error(s)}}async getRegistrationForSubdomainName(e,t){if(e.match(ao)===null||t.match(ao)===null)return null;const i=(await this.provider.getAccountResource(this.contractAddress,`${this.contractAddress}::domains::NameRegistryV1`)).data,{handle:o}=i.registry,s={key_type:`${this.contractAddress}::domains::NameRecordKeyV1`,value_type:`${this.contractAddress}::domains::NameRecordV1`,key:{subdomain_name:{vec:[t]},domain_name:e}};try{const r=await this.provider.getTableItem(o,s);return{target:r.target_address.vec.length===1?r.target_address.vec[0]:null,expirationTimestampSeconds:r.expiration_time_sec}}catch(r){if(r.status===404)return null;throw new Error(r)}}},La=()=>Math.floor(Date.now()/1e3),lp=class{constructor(e,t,n,i,o){this.lastUncommintedNumber=null,this.currentNumber=null,this.lock=!1,this.provider=e,this.account=t,this.maxWaitTime=n,this.maximumInFlight=i,this.sleepTime=o}async nextSequenceNumber(){for(;this.lock;)await zr(this.sleepTime);this.lock=!0;let e=BigInt(0);try{if((this.lastUncommintedNumber===null||this.currentNumber===null)&&await this.initialize(),this.currentNumber-this.lastUncommintedNumber>=this.maximumInFlight){await this.update();const t=La();for(;this.currentNumber-this.lastUncommintedNumber>=this.maximumInFlight;)await zr(this.sleepTime),La()-t>this.maxWaitTime?(console.warn(`Waited over 30 seconds for a transaction to commit, resyncing ${this.account.address()}`),await this.initialize()):await this.update()}e=this.currentNumber,this.currentNumber+=BigInt(1)}catch(t){console.error("error in getting next sequence number for this account",t)}finally{this.lock=!1}return e}async initialize(){const{sequence_number:e}=await this.provider.getAccount(this.account.address());this.currentNumber=BigInt(e),this.lastUncommintedNumber=BigInt(e)}async update(){const{sequence_number:e}=await this.provider.getAccount(this.account.address());return this.lastUncommintedNumber=BigInt(e),this.lastUncommintedNumber}async synchronize(){if(this.lastUncommintedNumber!==this.currentNumber){for(;this.lock;)await zr(this.sleepTime);this.lock=!0;try{await this.update();const e=La();for(;this.lastUncommintedNumber!==this.currentNumber;)La()-e>this.maxWaitTime?(console.warn(`Waited over 30 seconds for a transaction to commit, resyncing ${this.account.address()}`),await this.initialize()):(await zr(this.sleepTime),await this.update())}catch(e){console.error("error in synchronizing this account sequence number with the one on chain",e)}finally{this.lock=!1}}}},fl=class{constructor(){this.queue=[],this.resolveMap=new Map,this.counter=0,this.cancelled=!1}enqueue(e){if(this.resolveMap.size>0){const t=this.resolveMap.get(0);if(t){this.resolveMap.delete(0),t(e);return}}this.queue.push(e)}async dequeue(){return this.queue.length>0?Promise.resolve(this.queue.shift()):new Promise(t=>{this.counter+=1,this.resolveMap.set(this.counter,t)})}isEmpty(){return this.queue.length===0}cancel(){this.cancelled=!0,this.resolveMap.forEach(async e=>{e(await Promise.reject(new jl("Task cancelled")))}),this.resolveMap.clear(),this.queue.length=0}isCancelled(){return this.cancelled}},jl=class extends Error{constructor(e){super(e)}},qh="fulfilled",dp=(e=>(e.TransactionSent="transactionSent",e.TransactionSendFailed="transactionsendFailed",e.TransactionExecuted="transactionExecuted",e.TransactionExecutionFailed="transactionexecutionFailed",e))(dp||{}),T1=class extends Ul{constructor(e,t,n=30,i=100,o=10){super(),this.taskQueue=new fl,this.transactionsQueue=new fl,this.outstandingTransactions=new fl,this.sentTransactions=[],this.executedTransactions=[],this.provider=e,this.account=t,this.started=!1,this.accountSequnceNumber=new lp(e,t,n,i,o)}async submitNextTransaction(){try{for(;;){if(this.transactionsQueue.isEmpty())return;const e=await this.accountSequnceNumber.nextSequenceNumber();if(e===null)return;const t=await this.generateNextTransaction(this.account,e);if(!t)return;const n=this.provider.submitSignedBCSTransaction(t);await this.outstandingTransactions.enqueue([n,e])}}catch(e){if(e instanceof jl)return;console.log(e)}}async processTransactions(){try{for(;;){const e=[],t=[];let[n,i]=await this.outstandingTransactions.dequeue();for(e.push(n),t.push(i);!this.outstandingTransactions.isEmpty();)[n,i]=await this.outstandingTransactions.dequeue(),e.push(n),t.push(i);const o=await Promise.allSettled(e);for(let s=0;s<o.length&&s<t.length;s+=1){const r=o[s];i=t[s],r.status===qh?(this.sentTransactions.push([r.value.hash,i,null]),this.emit("transactionSent",[this.sentTransactions.length,r.value.hash]),await this.checkTransaction(r,i)):(this.sentTransactions.push([r.status,i,r.reason]),this.emit("transactionsendFailed",[this.sentTransactions.length,r.reason]))}}}catch(e){if(e instanceof jl)return;console.log(e)}}async checkTransaction(e,t){const n=[];n.push(this.provider.waitForTransactionWithResult(e.value.hash,{checkSuccess:!0}));const i=await Promise.allSettled(n);for(let o=0;o<i.length;o+=1){const s=i[o];s.status===qh?(this.executedTransactions.push([s.value.hash,t,null]),this.emit("transactionExecuted",[this.executedTransactions.length,s.value.hash])):(this.executedTransactions.push([s.status,t,s.reason]),this.emit("transactionexecutionFailed",[this.executedTransactions.length,s.reason]))}}async push(e){await this.transactionsQueue.enqueue(e)}async generateNextTransaction(e,t){if(this.transactionsQueue.isEmpty())return;const n=await this.transactionsQueue.dequeue(),i=await this.provider.generateRawTransaction(e.address(),n,{providedSequenceNumber:t});return Ce.generateBCSTransaction(e,i)}async run(){try{for(;!this.taskQueue.isCancelled();)await(await this.taskQueue.dequeue())()}catch(e){throw new Error(e)}}start(){if(this.started)throw new Error("worker has already started");this.started=!0,this.taskQueue.enqueue(()=>this.submitNextTransaction()),this.taskQueue.enqueue(()=>this.processTransactions()),this.run()}stop(){if(this.taskQueue.isCancelled())throw new Error("worker has already stopped");this.started=!1,this.taskQueue.cancel()}},hp={};Kc(hp,{AptosErrorCode:()=>fp,MoveFunctionVisibility:()=>pp,RoleType:()=>gp});var fp=(e=>(e.ACCOUNT_NOT_FOUND="account_not_found",e.RESOURCE_NOT_FOUND="resource_not_found",e.MODULE_NOT_FOUND="module_not_found",e.STRUCT_FIELD_NOT_FOUND="struct_field_not_found",e.VERSION_NOT_FOUND="version_not_found",e.TRANSACTION_NOT_FOUND="transaction_not_found",e.TABLE_ITEM_NOT_FOUND="table_item_not_found",e.BLOCK_NOT_FOUND="block_not_found",e.STATE_VALUE_NOT_FOUND="state_value_not_found",e.VERSION_PRUNED="version_pruned",e.BLOCK_PRUNED="block_pruned",e.INVALID_INPUT="invalid_input",e.INVALID_TRANSACTION_UPDATE="invalid_transaction_update",e.SEQUENCE_NUMBER_TOO_OLD="sequence_number_too_old",e.VM_ERROR="vm_error",e.HEALTH_CHECK_FAILED="health_check_failed",e.MEMPOOL_IS_FULL="mempool_is_full",e.INTERNAL_ERROR="internal_error",e.WEB_FRAMEWORK_ERROR="web_framework_error",e.BCS_NOT_SUPPORTED="bcs_not_supported",e.API_DISABLED="api_disabled",e))(fp||{}),pp=(e=>(e.PRIVATE="private",e.PUBLIC="public",e.FRIEND="friend",e))(pp||{}),gp=(e=>(e.VALIDATOR="validator",e.FULL_NODE="full_node",e))(gp||{}),_p=(e=>(e.AccountAddress="account_address",e.TransactionVersion="transaction_version",e))(_p||{}),mp=(e=>(e.AccountAddress="account_address",e.MinBlockHeight="min_block_height",e.NumDistinctVersions="num_distinct_versions",e))(mp||{}),yp=(e=>(e.AccountAddress="account_address",e.TransactionVersion="transaction_version",e))(yp||{}),wp=(e=>(e.Address="address",e.TransactionVersion="transaction_version",e))(wp||{}),bp=(e=>(e.BlockHeight="block_height",e.Epoch="epoch",e.FailedProposerIndices="failed_proposer_indices",e.Id="id",e.PreviousBlockVotesBitvec="previous_block_votes_bitvec",e.Proposer="proposer",e.Round="round",e.Timestamp="timestamp",e.Version="version",e))(bp||{}),vp=(e=>(e.ActivityType="activity_type",e.Amount="amount",e.BlockHeight="block_height",e.CoinType="coin_type",e.EntryFunctionIdStr="entry_function_id_str",e.EventAccountAddress="event_account_address",e.EventCreationNumber="event_creation_number",e.EventIndex="event_index",e.EventSequenceNumber="event_sequence_number",e.IsGasFee="is_gas_fee",e.IsTransactionSuccess="is_transaction_success",e.OwnerAddress="owner_address",e.TransactionTimestamp="transaction_timestamp",e.TransactionVersion="transaction_version",e))(vp||{}),Tp=(e=>(e.Amount="amount",e.CoinType="coin_type",e.CoinTypeHash="coin_type_hash",e.OwnerAddress="owner_address",e.TransactionTimestamp="transaction_timestamp",e.TransactionVersion="transaction_version",e))(Tp||{}),Ap=(e=>(e.CoinType="coin_type",e.CoinTypeHash="coin_type_hash",e.CreatorAddress="creator_address",e.Decimals="decimals",e.Name="name",e.SupplyAggregatorTableHandle="supply_aggregator_table_handle",e.SupplyAggregatorTableKey="supply_aggregator_table_key",e.Symbol="symbol",e.TransactionCreatedTimestamp="transaction_created_timestamp",e.TransactionVersionCreated="transaction_version_created",e))(Ap||{}),xp=(e=>(e.CoinType="coin_type",e.CoinTypeHash="coin_type_hash",e.Supply="supply",e.TransactionEpoch="transaction_epoch",e.TransactionTimestamp="transaction_timestamp",e.TransactionVersion="transaction_version",e))(xp||{}),kp=(e=>(e.CollectionDataIdHash="collection_data_id_hash",e.CollectionName="collection_name",e.CreatorAddress="creator_address",e.Description="description",e.DescriptionMutable="description_mutable",e.Maximum="maximum",e.MaximumMutable="maximum_mutable",e.MetadataUri="metadata_uri",e.Supply="supply",e.TableHandle="table_handle",e.TransactionTimestamp="transaction_timestamp",e.TransactionVersion="transaction_version",e.UriMutable="uri_mutable",e))(kp||{}),Sp=(e=>(e.Domain="domain",e.ExpirationTimestamp="expiration_timestamp",e.IsDeleted="is_deleted",e.LastTransactionVersion="last_transaction_version",e.RegisteredAddress="registered_address",e.Subdomain="subdomain",e.TokenName="token_name",e))(Sp||{}),Pp=(e=>(e.Domain="domain",e.ExpirationTimestamp="expiration_timestamp",e.IsPrimary="is_primary",e.LastTransactionVersion="last_transaction_version",e.RegisteredAddress="registered_address",e.Subdomain="subdomain",e.TokenName="token_name",e))(Pp||{}),Cp=(e=>(e.Amount="amount",e.CoinType="coin_type",e.CoinTypeHash="coin_type_hash",e.LastTransactionTimestamp="last_transaction_timestamp",e.LastTransactionVersion="last_transaction_version",e.OwnerAddress="owner_address",e))(Cp||{}),Bp=(e=>(e.CollectionDataIdHash="collection_data_id_hash",e.CollectionName="collection_name",e.CreatorAddress="creator_address",e.Description="description",e.DescriptionMutable="description_mutable",e.LastTransactionTimestamp="last_transaction_timestamp",e.LastTransactionVersion="last_transaction_version",e.Maximum="maximum",e.MaximumMutable="maximum_mutable",e.MetadataUri="metadata_uri",e.Supply="supply",e.TableHandle="table_handle",e.UriMutable="uri_mutable",e))(Bp||{}),Ep=(e=>(e.CollectionId="collection_id",e.CollectionName="collection_name",e.CollectionUri="collection_uri",e.CreatorAddress="creator_address",e.DistinctTokens="distinct_tokens",e.LastTransactionVersion="last_transaction_version",e.OwnerAddress="owner_address",e.SingleTokenUri="single_token_uri",e))(Ep||{}),Ip=(e=>(e.CollectionId="collection_id",e.CollectionName="collection_name",e.CreatorAddress="creator_address",e.CurrentSupply="current_supply",e.Description="description",e.LastTransactionTimestamp="last_transaction_timestamp",e.LastTransactionVersion="last_transaction_version",e.MaxSupply="max_supply",e.MutableDescription="mutable_description",e.MutableUri="mutable_uri",e.TableHandleV1="table_handle_v1",e.TokenStandard="token_standard",e.TotalMintedV2="total_minted_v2",e.Uri="uri",e))(Ip||{}),Op=(e=>(e.ActiveTableHandle="active_table_handle",e.InactiveTableHandle="inactive_table_handle",e.LastTransactionVersion="last_transaction_version",e.OperatorCommissionPercentage="operator_commission_percentage",e.StakingPoolAddress="staking_pool_address",e.TotalCoins="total_coins",e.TotalShares="total_shares",e))(Op||{}),Rp=(e=>(e.DelegationPoolAddress="delegation_pool_address",e.DelegatorAddress="delegator_address",e.LastTransactionTimestamp="last_transaction_timestamp",e.LastTransactionVersion="last_transaction_version",e.PendingVoter="pending_voter",e.TableHandle="table_handle",e.Voter="voter",e))(Rp||{}),$p=(e=>(e.DelegatorAddress="delegator_address",e.LastTransactionVersion="last_transaction_version",e.ParentTableHandle="parent_table_handle",e.PoolAddress="pool_address",e.PoolType="pool_type",e.Shares="shares",e.TableHandle="table_handle",e))($p||{}),Up=(e=>(e.Amount="amount",e.AssetType="asset_type",e.IsFrozen="is_frozen",e.IsPrimary="is_primary",e.LastTransactionTimestamp="last_transaction_timestamp",e.LastTransactionVersion="last_transaction_version",e.OwnerAddress="owner_address",e.StorageId="storage_id",e.TokenStandard="token_standard",e))(Up||{}),qp=(e=>(e.AllowUngatedTransfer="allow_ungated_transfer",e.IsDeleted="is_deleted",e.LastGuidCreationNum="last_guid_creation_num",e.LastTransactionVersion="last_transaction_version",e.ObjectAddress="object_address",e.OwnerAddress="owner_address",e.StateKeyHash="state_key_hash",e))(qp||{}),Mp=(e=>(e.LastTransactionVersion="last_transaction_version",e.OperatorAddress="operator_address",e.StakingPoolAddress="staking_pool_address",e.VoterAddress="voter_address",e))(Mp||{}),Dp=(e=>(e.DecodedKey="decoded_key",e.DecodedValue="decoded_value",e.IsDeleted="is_deleted",e.Key="key",e.KeyHash="key_hash",e.LastTransactionVersion="last_transaction_version",e.TableHandle="table_handle",e))(Dp||{}),Lp=(e=>(e.CollectionDataIdHash="collection_data_id_hash",e.CollectionName="collection_name",e.CreatorAddress="creator_address",e.DefaultProperties="default_properties",e.Description="description",e.DescriptionMutable="description_mutable",e.LargestPropertyVersion="largest_property_version",e.LastTransactionTimestamp="last_transaction_timestamp",e.LastTransactionVersion="last_transaction_version",e.Maximum="maximum",e.MaximumMutable="maximum_mutable",e.MetadataUri="metadata_uri",e.Name="name",e.PayeeAddress="payee_address",e.PropertiesMutable="properties_mutable",e.RoyaltyMutable="royalty_mutable",e.RoyaltyPointsDenominator="royalty_points_denominator",e.RoyaltyPointsNumerator="royalty_points_numerator",e.Supply="supply",e.TokenDataIdHash="token_data_id_hash",e.UriMutable="uri_mutable",e))(Lp||{}),Np=(e=>(e.CollectionId="collection_id",e.Description="description",e.IsFungibleV2="is_fungible_v2",e.LargestPropertyVersionV1="largest_property_version_v1",e.LastTransactionTimestamp="last_transaction_timestamp",e.LastTransactionVersion="last_transaction_version",e.Maximum="maximum",e.Supply="supply",e.TokenDataId="token_data_id",e.TokenName="token_name",e.TokenProperties="token_properties",e.TokenStandard="token_standard",e.TokenUri="token_uri",e))(Np||{}),Fp=(e=>(e.Amount="amount",e.CollectionDataIdHash="collection_data_id_hash",e.CollectionName="collection_name",e.CreatorAddress="creator_address",e.LastTransactionTimestamp="last_transaction_timestamp",e.LastTransactionVersion="last_transaction_version",e.Name="name",e.OwnerAddress="owner_address",e.PropertyVersion="property_version",e.TableType="table_type",e.TokenDataIdHash="token_data_id_hash",e.TokenProperties="token_properties",e))(Fp||{}),jp=(e=>(e.Amount="amount",e.IsFungibleV2="is_fungible_v2",e.IsSoulboundV2="is_soulbound_v2",e.LastTransactionTimestamp="last_transaction_timestamp",e.LastTransactionVersion="last_transaction_version",e.OwnerAddress="owner_address",e.PropertyVersionV1="property_version_v1",e.StorageId="storage_id",e.TableTypeV1="table_type_v1",e.TokenDataId="token_data_id",e.TokenPropertiesMutatedV1="token_properties_mutated_v1",e.TokenStandard="token_standard",e))(jp||{}),zp=(e=>(e.Amount="amount",e.CollectionDataIdHash="collection_data_id_hash",e.CollectionId="collection_id",e.CollectionName="collection_name",e.CreatorAddress="creator_address",e.FromAddress="from_address",e.LastTransactionTimestamp="last_transaction_timestamp",e.LastTransactionVersion="last_transaction_version",e.Name="name",e.PropertyVersion="property_version",e.TableHandle="table_handle",e.ToAddress="to_address",e.TokenDataId="token_data_id",e.TokenDataIdHash="token_data_id_hash",e))(zp||{}),Hp=(e=>(e.Asc="ASC",e.Desc="DESC",e))(Hp||{}),Kp=(e=>(e.Amount="amount",e.DelegatorAddress="delegator_address",e.EventIndex="event_index",e.EventType="event_type",e.PoolAddress="pool_address",e.TransactionVersion="transaction_version",e))(Kp||{}),Gp=(e=>(e.FirstTransactionVersion="first_transaction_version",e.StakingPoolAddress="staking_pool_address",e))(Gp||{}),Wp=(e=>(e.DelegatorAddress="delegator_address",e.PoolAddress="pool_address",e))(Wp||{}),Xp=(e=>(e.AccountAddress="account_address",e.CreationNumber="creation_number",e.Data="data",e.EventIndex="event_index",e.SequenceNumber="sequence_number",e.TransactionBlockHeight="transaction_block_height",e.TransactionVersion="transaction_version",e.Type="type",e))(Xp||{}),Vp=(e=>(e.Amount="amount",e.AssetType="asset_type",e.BlockHeight="block_height",e.EntryFunctionIdStr="entry_function_id_str",e.EventIndex="event_index",e.GasFeePayerAddress="gas_fee_payer_address",e.IsFrozen="is_frozen",e.IsGasFee="is_gas_fee",e.IsTransactionSuccess="is_transaction_success",e.OwnerAddress="owner_address",e.StorageId="storage_id",e.TokenStandard="token_standard",e.TransactionTimestamp="transaction_timestamp",e.TransactionVersion="transaction_version",e.Type="type",e))(Vp||{}),Jp=(e=>(e.AssetType="asset_type",e.CreatorAddress="creator_address",e.Decimals="decimals",e.IconUri="icon_uri",e.LastTransactionTimestamp="last_transaction_timestamp",e.LastTransactionVersion="last_transaction_version",e.Name="name",e.ProjectUri="project_uri",e.SupplyAggregatorTableHandleV1="supply_aggregator_table_handle_v1",e.SupplyAggregatorTableKeyV1="supply_aggregator_table_key_v1",e.Symbol="symbol",e.TokenStandard="token_standard",e))(Jp||{}),Zp=(e=>(e.Db="db",e.IsIndexerUp="is_indexer_up",e))(Zp||{}),Yp=(e=>(e.ChainId="chain_id",e))(Yp||{}),Qp=(e=>(e.Address="address",e.TransactionVersion="transaction_version",e))(Qp||{}),tg=(e=>(e.BuyItNowPrice="buy_it_now_price",e.CoinType="coin_type",e.CollectionId="collection_id",e.ContractAddress="contract_address",e.CurrentBidPrice="current_bid_price",e.CurrentBidder="current_bidder",e.EntryFunctionIdStr="entry_function_id_str",e.ExpirationTime="expiration_time",e.FeeScheduleId="fee_schedule_id",e.IsDeleted="is_deleted",e.LastTransactionTimestamp="last_transaction_timestamp",e.LastTransactionVersion="last_transaction_version",e.ListingId="listing_id",e.Marketplace="marketplace",e.Seller="seller",e.StartingBidPrice="starting_bid_price",e.TokenAmount="token_amount",e.TokenDataId="token_data_id",e.TokenStandard="token_standard",e))(tg||{}),eg=(e=>(e.Buyer="buyer",e.CoinType="coin_type",e.CollectionId="collection_id",e.CollectionOfferId="collection_offer_id",e.ContractAddress="contract_address",e.EntryFunctionIdStr="entry_function_id_str",e.ExpirationTime="expiration_time",e.FeeScheduleId="fee_schedule_id",e.IsDeleted="is_deleted",e.ItemPrice="item_price",e.LastTransactionTimestamp="last_transaction_timestamp",e.LastTransactionVersion="last_transaction_version",e.Marketplace="marketplace",e.RemainingTokenAmount="remaining_token_amount",e.TokenStandard="token_standard",e))(eg||{}),ng=(e=>(e.CoinType="coin_type",e.CollectionId="collection_id",e.ContractAddress="contract_address",e.EntryFunctionIdStr="entry_function_id_str",e.FeeScheduleId="fee_schedule_id",e.IsDeleted="is_deleted",e.LastTransactionTimestamp="last_transaction_timestamp",e.LastTransactionVersion="last_transaction_version",e.ListingId="listing_id",e.Marketplace="marketplace",e.Price="price",e.Seller="seller",e.TokenAmount="token_amount",e.TokenDataId="token_data_id",e.TokenStandard="token_standard",e))(ng||{}),ig=(e=>(e.Buyer="buyer",e.CoinType="coin_type",e.CollectionId="collection_id",e.ContractAddress="contract_address",e.EntryFunctionIdStr="entry_function_id_str",e.ExpirationTime="expiration_time",e.FeeScheduleId="fee_schedule_id",e.IsDeleted="is_deleted",e.LastTransactionTimestamp="last_transaction_timestamp",e.LastTransactionVersion="last_transaction_version",e.Marketplace="marketplace",e.OfferId="offer_id",e.Price="price",e.TokenAmount="token_amount",e.TokenDataId="token_data_id",e.TokenStandard="token_standard",e))(ig||{}),og=(e=>(e.Buyer="buyer",e.CoinType="coin_type",e.CollectionId="collection_id",e.CollectionName="collection_name",e.ContractAddress="contract_address",e.CreatorAddress="creator_address",e.EntryFunctionIdStr="entry_function_id_str",e.EventIndex="event_index",e.EventType="event_type",e.FeeScheduleId="fee_schedule_id",e.Marketplace="marketplace",e.OfferOrListingId="offer_or_listing_id",e.Price="price",e.PropertyVersion="property_version",e.Seller="seller",e.TokenAmount="token_amount",e.TokenDataId="token_data_id",e.TokenName="token_name",e.TokenStandard="token_standard",e.TransactionTimestamp="transaction_timestamp",e.TransactionVersion="transaction_version",e))(og||{}),sg=(e=>(e.AssetUri="asset_uri",e.CdnAnimationUri="cdn_animation_uri",e.CdnImageUri="cdn_image_uri",e.CdnJsonUri="cdn_json_uri",e.RawAnimationUri="raw_animation_uri",e.RawImageUri="raw_image_uri",e))(sg||{}),rg=(e=>(e.NumActiveDelegator="num_active_delegator",e.PoolAddress="pool_address",e))(rg||{}),ag=(e=>(e.Asc="asc",e.AscNullsFirst="asc_nulls_first",e.AscNullsLast="asc_nulls_last",e.Desc="desc",e.DescNullsFirst="desc_nulls_first",e.DescNullsLast="desc_nulls_last",e))(ag||{}),cg=(e=>(e.LastSuccessVersion="last_success_version",e.LastUpdated="last_updated",e.Processor="processor",e))(cg||{}),ug=(e=>(e.NumVotes="num_votes",e.ProposalId="proposal_id",e.ShouldPass="should_pass",e.StakingPoolAddress="staking_pool_address",e.TransactionTimestamp="transaction_timestamp",e.TransactionVersion="transaction_version",e.VoterAddress="voter_address",e))(ug||{}),lg=(e=>(e.DecodedKey="decoded_key",e.DecodedValue="decoded_value",e.Key="key",e.TableHandle="table_handle",e.TransactionVersion="transaction_version",e.WriteSetChangeIndex="write_set_change_index",e))(lg||{}),dg=(e=>(e.Handle="handle",e.KeyType="key_type",e.ValueType="value_type",e))(dg||{}),hg=(e=>(e.CoinAmount="coin_amount",e.CoinType="coin_type",e.CollectionDataIdHash="collection_data_id_hash",e.CollectionName="collection_name",e.CreatorAddress="creator_address",e.EventAccountAddress="event_account_address",e.EventCreationNumber="event_creation_number",e.EventIndex="event_index",e.EventSequenceNumber="event_sequence_number",e.FromAddress="from_address",e.Name="name",e.PropertyVersion="property_version",e.ToAddress="to_address",e.TokenAmount="token_amount",e.TokenDataIdHash="token_data_id_hash",e.TransactionTimestamp="transaction_timestamp",e.TransactionVersion="transaction_version",e.TransferType="transfer_type",e))(hg||{}),fg=(e=>(e.AfterValue="after_value",e.BeforeValue="before_value",e.EntryFunctionIdStr="entry_function_id_str",e.EventAccountAddress="event_account_address",e.EventIndex="event_index",e.FromAddress="from_address",e.IsFungibleV2="is_fungible_v2",e.PropertyVersionV1="property_version_v1",e.ToAddress="to_address",e.TokenAmount="token_amount",e.TokenDataId="token_data_id",e.TokenStandard="token_standard",e.TransactionTimestamp="transaction_timestamp",e.TransactionVersion="transaction_version",e.Type="type",e))(fg||{}),pg=(e=>(e.CollectionDataIdHash="collection_data_id_hash",e.CollectionName="collection_name",e.CreatorAddress="creator_address",e.DefaultProperties="default_properties",e.Description="description",e.DescriptionMutable="description_mutable",e.LargestPropertyVersion="largest_property_version",e.Maximum="maximum",e.MaximumMutable="maximum_mutable",e.MetadataUri="metadata_uri",e.Name="name",e.PayeeAddress="payee_address",e.PropertiesMutable="properties_mutable",e.RoyaltyMutable="royalty_mutable",e.RoyaltyPointsDenominator="royalty_points_denominator",e.RoyaltyPointsNumerator="royalty_points_numerator",e.Supply="supply",e.TokenDataIdHash="token_data_id_hash",e.TransactionTimestamp="transaction_timestamp",e.TransactionVersion="transaction_version",e.UriMutable="uri_mutable",e))(pg||{}),gg=(e=>(e.Amount="amount",e.CollectionDataIdHash="collection_data_id_hash",e.CollectionName="collection_name",e.CreatorAddress="creator_address",e.Name="name",e.OwnerAddress="owner_address",e.PropertyVersion="property_version",e.TableHandle="table_handle",e.TableType="table_type",e.TokenDataIdHash="token_data_id_hash",e.TransactionTimestamp="transaction_timestamp",e.TransactionVersion="transaction_version",e))(gg||{}),_g=(e=>(e.CollectionDataIdHash="collection_data_id_hash",e.CollectionName="collection_name",e.CreatorAddress="creator_address",e.Name="name",e.PropertyVersion="property_version",e.TokenDataIdHash="token_data_id_hash",e.TokenProperties="token_properties",e.TransactionTimestamp="transaction_timestamp",e.TransactionVersion="transaction_version",e))(_g||{}),mg=(e=>(e.BlockHeight="block_height",e.EntryFunctionIdStr="entry_function_id_str",e.Epoch="epoch",e.ExpirationTimestampSecs="expiration_timestamp_secs",e.GasUnitPrice="gas_unit_price",e.MaxGasAmount="max_gas_amount",e.ParentSignatureType="parent_signature_type",e.Sender="sender",e.SequenceNumber="sequence_number",e.Timestamp="timestamp",e.Version="version",e))(mg||{});const q4=Object.freeze(Object.defineProperty({__proto__:null,APTOS_COIN:bc,AccountSequenceNumber:lp,Account_Transactions_Select_Column:_p,Address_Events_Summary_Select_Column:mp,Address_Version_From_Events_Select_Column:yp,Address_Version_From_Move_Resources_Select_Column:wp,AnsClient:v1,ApiError:pi,AptosAccount:ia,AptosApiError:md,AptosClient:Ce,AptosToken:y1,BCS:G0,Block_Metadata_Transactions_Select_Column:bp,CKDPriv:M0,COIN_TRANSFER:cp,CoinClient:w1,Coin_Activities_Select_Column:vp,Coin_Balances_Select_Column:Tp,Coin_Infos_Select_Column:Ap,Coin_Supply_Select_Column:xp,Collection_Datas_Select_Column:kp,Current_Ans_Lookup_Select_Column:Sp,Current_Aptos_Names_Select_Column:Pp,Current_Coin_Balances_Select_Column:Cp,Current_Collection_Datas_Select_Column:Bp,Current_Collection_Ownership_V2_View_Select_Column:Ep,Current_Collections_V2_Select_Column:Ip,Current_Delegated_Staking_Pool_Balances_Select_Column:Op,Current_Delegated_Voter_Select_Column:Rp,Current_Delegator_Balances_Select_Column:$p,Current_Fungible_Asset_Balances_Select_Column:Up,Current_Objects_Select_Column:qp,Current_Staking_Pool_Voter_Select_Column:Mp,Current_Table_Items_Select_Column:Dp,Current_Token_Datas_Select_Column:Lp,Current_Token_Datas_V2_Select_Column:Np,Current_Token_Ownerships_Select_Column:Fp,Current_Token_Ownerships_V2_Select_Column:jp,Current_Token_Pending_Claims_Select_Column:zp,Cursor_Ordering:Hp,Delegated_Staking_Activities_Select_Column:Kp,Delegated_Staking_Pools_Select_Column:Gp,Delegator_Distinct_Pool_Select_Column:Wp,Events_Select_Column:Xp,FailedTransactionError:np,FaucetClient:b1,FungibleAssetClient:xc,Fungible_Asset_Activities_Select_Column:Vp,Fungible_Asset_Metadata_Select_Column:Jp,HexString:Et,IndexerClient:An,Indexer_Status_Select_Column:Zp,Ledger_Infos_Select_Column:Yp,Move_Resources_Select_Column:Qp,Network:K0,NetworkToIndexerAPI:vc,NetworkToNodeAPI:H0,Nft_Marketplace_V2_Current_Nft_Marketplace_Auctions_Select_Column:tg,Nft_Marketplace_V2_Current_Nft_Marketplace_Collection_Offers_Select_Column:eg,Nft_Marketplace_V2_Current_Nft_Marketplace_Listings_Select_Column:ng,Nft_Marketplace_V2_Current_Nft_Marketplace_Token_Offers_Select_Column:ig,Nft_Marketplace_V2_Nft_Marketplace_Activities_Select_Column:og,Nft_Metadata_Crawler_Parsed_Asset_Uris_Select_Column:sg,NodeAPIToNetwork:ql,Num_Active_Delegator_Per_Pool_Select_Column:rg,Order_By:ag,Processor_Status_Select_Column:cg,PropertyMap:gu,PropertyValue:Rd,Proposal_Votes_Select_Column:ug,Provider:oa,TRANSFER_COINS:Nl,Table_Items_Select_Column:lg,Table_Metadatas_Select_Column:dg,TokenClient:m1,TokenTypes:sp,Token_Activities_Select_Column:hg,Token_Activities_V2_Select_Column:fg,Token_Datas_Select_Column:pg,Token_Ownerships_Select_Column:gg,Tokens_Select_Column:_g,TransactionBuilder:Fi,TransactionBuilderABI:Tc,TransactionBuilderEd25519:rc,TransactionBuilderMultiEd25519:tp,TransactionBuilderRemoteABI:pn,TransactionWorker:T1,TransactionWorkerEvents:dp,TxnBuilderTypes:re,TypeTagParser:As,Types:hp,User_Transactions_Select_Column:mg,WaitForTransactionError:ep,ansContractsMap:Fl,aptosRequest:yd,argToTransactionArgument:Q0,derivePath:L0,deserializePropertyMap:$d,deserializeValueBasedOnTypeTag:op,ensureBigInt:as,ensureBoolean:Id,ensureNumber:rs,get:ui,getAddressFromAccountOrAddress:Ni,getMasterKeyFromSeed:q0,getPropertyType:_u,getPropertyValueRaw:Ac,getPublicKey:_b,getSinglePropertyValueRaw:Ll,isValidPath:D0,nameComponentPattern:ao,namePattern:up,post:ns,serializeArg:pu},Symbol.toStringTag,{value:"Module"}));var Ti={},zn={};Object.defineProperty(zn,"__esModule",{value:!0});zn.output=zn.exists=zn.hash=zn.bytes=zn.bool=zn.number=void 0;function kc(e){if(!Number.isSafeInteger(e)||e<0)throw new Error(`Wrong positive integer: ${e}`)}zn.number=kc;function yg(e){if(typeof e!="boolean")throw new Error(`Expected boolean, not ${e}`)}zn.bool=yg;function Ud(e,...t){if(!(e instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(t.length>0&&!t.includes(e.length))throw new TypeError(`Expected Uint8Array of length ${t}, not of length=${e.length}`)}zn.bytes=Ud;function wg(e){if(typeof e!="function"||typeof e.create!="function")throw new Error("Hash should be wrapped by utils.wrapConstructor");kc(e.outputLen),kc(e.blockLen)}zn.hash=wg;function bg(e,t=!0){if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}zn.exists=bg;function vg(e,t){Ud(e);const n=t.outputLen;if(e.length<n)throw new Error(`digestInto() expects output buffer of length at least ${n}`)}zn.output=vg;const A1={number:kc,bool:yg,bytes:Ud,hash:wg,exists:bg,output:vg};zn.default=A1;var fr={},Tg={},ks={},mu={};Object.defineProperty(mu,"__esModule",{value:!0});mu.crypto=void 0;mu.crypto={node:void 0,web:typeof self=="object"&&"crypto"in self?self.crypto:void 0};(function(e){/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */Object.defineProperty(e,"__esModule",{value:!0}),e.randomBytes=e.wrapConstructorWithOpts=e.wrapConstructor=e.checkOpts=e.Hash=e.concatBytes=e.toBytes=e.utf8ToBytes=e.asyncLoop=e.nextTick=e.hexToBytes=e.bytesToHex=e.isLE=e.rotr=e.createView=e.u32=e.u8=void 0;const t=mu,n=T=>new Uint8Array(T.buffer,T.byteOffset,T.byteLength);e.u8=n;const i=T=>new Uint32Array(T.buffer,T.byteOffset,Math.floor(T.byteLength/4));e.u32=i;const o=T=>new DataView(T.buffer,T.byteOffset,T.byteLength);e.createView=o;const s=(T,R)=>T<<32-R|T>>>R;if(e.rotr=s,e.isLE=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68,!e.isLE)throw new Error("Non little-endian hardware is not supported");const r=Array.from({length:256},(T,R)=>R.toString(16).padStart(2,"0"));function a(T){if(!(T instanceof Uint8Array))throw new Error("Uint8Array expected");let R="";for(let K=0;K<T.length;K++)R+=r[T[K]];return R}e.bytesToHex=a;function c(T){if(typeof T!="string")throw new TypeError("hexToBytes: expected string, got "+typeof T);if(T.length%2)throw new Error("hexToBytes: received invalid unpadded hex");const R=new Uint8Array(T.length/2);for(let K=0;K<R.length;K++){const V=K*2,W=T.slice(V,V+2),tt=Number.parseInt(W,16);if(Number.isNaN(tt)||tt<0)throw new Error("Invalid byte sequence");R[K]=tt}return R}e.hexToBytes=c;const u=async()=>{};e.nextTick=u;async function l(T,R,K){let V=Date.now();for(let W=0;W<T;W++){K(W);const tt=Date.now()-V;tt>=0&&tt<R||(await(0,e.nextTick)(),V+=tt)}}e.asyncLoop=l;function d(T){if(typeof T!="string")throw new TypeError(`utf8ToBytes expected string, got ${typeof T}`);return new TextEncoder().encode(T)}e.utf8ToBytes=d;function h(T){if(typeof T=="string"&&(T=d(T)),!(T instanceof Uint8Array))throw new TypeError(`Expected input type is Uint8Array (got ${typeof T})`);return T}e.toBytes=h;function g(...T){if(!T.every(V=>V instanceof Uint8Array))throw new Error("Uint8Array list expected");if(T.length===1)return T[0];const R=T.reduce((V,W)=>V+W.length,0),K=new Uint8Array(R);for(let V=0,W=0;V<T.length;V++){const tt=T[V];K.set(tt,W),W+=tt.length}return K}e.concatBytes=g;class b{clone(){return this._cloneInto()}}e.Hash=b;const v=T=>Object.prototype.toString.call(T)==="[object Object]"&&T.constructor===Object;function x(T,R){if(R!==void 0&&(typeof R!="object"||!v(R)))throw new TypeError("Options should be object or undefined");return Object.assign(T,R)}e.checkOpts=x;function P(T){const R=V=>T().update(h(V)).digest(),K=T();return R.outputLen=K.outputLen,R.blockLen=K.blockLen,R.create=()=>T(),R}e.wrapConstructor=P;function E(T){const R=(V,W)=>T(W).update(h(V)).digest(),K=T({});return R.outputLen=K.outputLen,R.blockLen=K.blockLen,R.create=V=>T(V),R}e.wrapConstructorWithOpts=E;function S(T=32){if(t.crypto.web)return t.crypto.web.getRandomValues(new Uint8Array(T));if(t.crypto.node)return new Uint8Array(t.crypto.node.randomBytes(T).buffer);throw new Error("The environment doesn't have randomBytes function")}e.randomBytes=S})(ks);(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.hmac=void 0;const t=zn,n=ks;class i extends n.Hash{constructor(r,a){super(),this.finished=!1,this.destroyed=!1,t.default.hash(r);const c=(0,n.toBytes)(a);if(this.iHash=r.create(),typeof this.iHash.update!="function")throw new TypeError("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const u=this.blockLen,l=new Uint8Array(u);l.set(c.length>u?r.create().update(c).digest():c);for(let d=0;d<l.length;d++)l[d]^=54;this.iHash.update(l),this.oHash=r.create();for(let d=0;d<l.length;d++)l[d]^=106;this.oHash.update(l),l.fill(0)}update(r){return t.default.exists(this),this.iHash.update(r),this}digestInto(r){t.default.exists(this),t.default.bytes(r,this.outputLen),this.finished=!0,this.iHash.digestInto(r),this.oHash.update(r),this.oHash.digestInto(r),this.destroy()}digest(){const r=new Uint8Array(this.oHash.outputLen);return this.digestInto(r),r}_cloneInto(r){r||(r=Object.create(Object.getPrototypeOf(this),{}));const{oHash:a,iHash:c,finished:u,destroyed:l,blockLen:d,outputLen:h}=this;return r=r,r.finished=u,r.destroyed=l,r.blockLen=d,r.outputLen=h,r.oHash=a._cloneInto(r.oHash),r.iHash=c._cloneInto(r.iHash),r}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}}const o=(s,r,a)=>new i(s,r).update(a).digest();e.hmac=o,e.hmac.create=(s,r)=>new i(s,r)})(Tg);Object.defineProperty(fr,"__esModule",{value:!0});fr.pbkdf2Async=fr.pbkdf2=void 0;const Na=zn,x1=Tg,er=ks;function Ag(e,t,n,i){Na.default.hash(e);const o=(0,er.checkOpts)({dkLen:32,asyncTick:10},i),{c:s,dkLen:r,asyncTick:a}=o;if(Na.default.number(s),Na.default.number(r),Na.default.number(a),s<1)throw new Error("PBKDF2: iterations (c) should be >= 1");const c=(0,er.toBytes)(t),u=(0,er.toBytes)(n),l=new Uint8Array(r),d=x1.hmac.create(e,c),h=d._cloneInto().update(u);return{c:s,dkLen:r,asyncTick:a,DK:l,PRF:d,PRFSalt:h}}function xg(e,t,n,i,o){return e.destroy(),t.destroy(),i&&i.destroy(),o.fill(0),n}function k1(e,t,n,i){const{c:o,dkLen:s,DK:r,PRF:a,PRFSalt:c}=Ag(e,t,n,i);let u;const l=new Uint8Array(4),d=(0,er.createView)(l),h=new Uint8Array(a.outputLen);for(let g=1,b=0;b<s;g++,b+=a.outputLen){const v=r.subarray(b,b+a.outputLen);d.setInt32(0,g,!1),(u=c._cloneInto(u)).update(l).digestInto(h),v.set(h.subarray(0,v.length));for(let x=1;x<o;x++){a._cloneInto(u).update(h).digestInto(h);for(let P=0;P<v.length;P++)v[P]^=h[P]}}return xg(a,c,r,u,h)}fr.pbkdf2=k1;async function S1(e,t,n,i){const{c:o,dkLen:s,asyncTick:r,DK:a,PRF:c,PRFSalt:u}=Ag(e,t,n,i);let l;const d=new Uint8Array(4),h=(0,er.createView)(d),g=new Uint8Array(c.outputLen);for(let b=1,v=0;v<s;b++,v+=c.outputLen){const x=a.subarray(v,v+c.outputLen);h.setInt32(0,b,!1),(l=u._cloneInto(l)).update(d).digestInto(g),x.set(g.subarray(0,x.length)),await(0,er.asyncLoop)(o-1,r,P=>{c._cloneInto(l).update(g).digestInto(g);for(let E=0;E<x.length;E++)x[E]^=g[E]})}return xg(c,u,a,l,g)}fr.pbkdf2Async=S1;var pr={},Ta={};Object.defineProperty(Ta,"__esModule",{value:!0});Ta.SHA2=void 0;const pl=zn,Nr=ks;function P1(e,t,n,i){if(typeof e.setBigUint64=="function")return e.setBigUint64(t,n,i);const o=BigInt(32),s=BigInt(4294967295),r=Number(n>>o&s),a=Number(n&s),c=i?4:0,u=i?0:4;e.setUint32(t+c,r,i),e.setUint32(t+u,a,i)}let C1=class extends Nr.Hash{constructor(t,n,i,o){super(),this.blockLen=t,this.outputLen=n,this.padOffset=i,this.isLE=o,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(t),this.view=(0,Nr.createView)(this.buffer)}update(t){pl.default.exists(this);const{view:n,buffer:i,blockLen:o}=this;t=(0,Nr.toBytes)(t);const s=t.length;for(let r=0;r<s;){const a=Math.min(o-this.pos,s-r);if(a===o){const c=(0,Nr.createView)(t);for(;o<=s-r;r+=o)this.process(c,r);continue}i.set(t.subarray(r,r+a),this.pos),this.pos+=a,r+=a,this.pos===o&&(this.process(n,0),this.pos=0)}return this.length+=t.length,this.roundClean(),this}digestInto(t){pl.default.exists(this),pl.default.output(t,this),this.finished=!0;const{buffer:n,view:i,blockLen:o,isLE:s}=this;let{pos:r}=this;n[r++]=128,this.buffer.subarray(r).fill(0),this.padOffset>o-r&&(this.process(i,0),r=0);for(let d=r;d<o;d++)n[d]=0;P1(i,o-8,BigInt(this.length*8),s),this.process(i,0);const a=(0,Nr.createView)(t),c=this.outputLen;if(c%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const u=c/4,l=this.get();if(u>l.length)throw new Error("_sha2: outputLen bigger than state");for(let d=0;d<u;d++)a.setUint32(4*d,l[d],s)}digest(){const{buffer:t,outputLen:n}=this;this.digestInto(t);const i=t.slice(0,n);return this.destroy(),i}_cloneInto(t){t||(t=new this.constructor),t.set(...this.get());const{blockLen:n,buffer:i,length:o,finished:s,destroyed:r,pos:a}=this;return t.length=o,t.pos=a,t.finished=s,t.destroyed=r,o%n&&t.buffer.set(i),t}};Ta.SHA2=C1;Object.defineProperty(pr,"__esModule",{value:!0});pr.sha224=pr.sha256=void 0;const B1=Ta,Ci=ks,E1=(e,t,n)=>e&t^~e&n,I1=(e,t,n)=>e&t^e&n^t&n,O1=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),So=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),Po=new Uint32Array(64);class kg extends B1.SHA2{constructor(){super(64,32,8,!1),this.A=So[0]|0,this.B=So[1]|0,this.C=So[2]|0,this.D=So[3]|0,this.E=So[4]|0,this.F=So[5]|0,this.G=So[6]|0,this.H=So[7]|0}get(){const{A:t,B:n,C:i,D:o,E:s,F:r,G:a,H:c}=this;return[t,n,i,o,s,r,a,c]}set(t,n,i,o,s,r,a,c){this.A=t|0,this.B=n|0,this.C=i|0,this.D=o|0,this.E=s|0,this.F=r|0,this.G=a|0,this.H=c|0}process(t,n){for(let d=0;d<16;d++,n+=4)Po[d]=t.getUint32(n,!1);for(let d=16;d<64;d++){const h=Po[d-15],g=Po[d-2],b=(0,Ci.rotr)(h,7)^(0,Ci.rotr)(h,18)^h>>>3,v=(0,Ci.rotr)(g,17)^(0,Ci.rotr)(g,19)^g>>>10;Po[d]=v+Po[d-7]+b+Po[d-16]|0}let{A:i,B:o,C:s,D:r,E:a,F:c,G:u,H:l}=this;for(let d=0;d<64;d++){const h=(0,Ci.rotr)(a,6)^(0,Ci.rotr)(a,11)^(0,Ci.rotr)(a,25),g=l+h+E1(a,c,u)+O1[d]+Po[d]|0,v=((0,Ci.rotr)(i,2)^(0,Ci.rotr)(i,13)^(0,Ci.rotr)(i,22))+I1(i,o,s)|0;l=u,u=c,c=a,a=r+g|0,r=s,s=o,o=i,i=g+v|0}i=i+this.A|0,o=o+this.B|0,s=s+this.C|0,r=r+this.D|0,a=a+this.E|0,c=c+this.F|0,u=u+this.G|0,l=l+this.H|0,this.set(i,o,s,r,a,c,u,l)}roundClean(){Po.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}}class R1 extends kg{constructor(){super(),this.A=-1056596264,this.B=914150663,this.C=812702999,this.D=-150054599,this.E=-4191439,this.F=1750603025,this.G=1694076839,this.H=-1090891868,this.outputLen=28}}pr.sha256=(0,Ci.wrapConstructor)(()=>new kg);pr.sha224=(0,Ci.wrapConstructor)(()=>new R1);var qi={},Sg={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.add=e.toBig=e.split=e.fromBig=void 0;const t=BigInt(2**32-1),n=BigInt(32);function i(j,$=!1){return $?{h:Number(j&t),l:Number(j>>n&t)}:{h:Number(j>>n&t)|0,l:Number(j&t)|0}}e.fromBig=i;function o(j,$=!1){let q=new Uint32Array(j.length),A=new Uint32Array(j.length);for(let f=0;f<j.length;f++){const{h:y,l:k}=i(j[f],$);[q[f],A[f]]=[y,k]}return[q,A]}e.split=o;const s=(j,$)=>BigInt(j>>>0)<<n|BigInt($>>>0);e.toBig=s;const r=(j,$,q)=>j>>>q,a=(j,$,q)=>j<<32-q|$>>>q,c=(j,$,q)=>j>>>q|$<<32-q,u=(j,$,q)=>j<<32-q|$>>>q,l=(j,$,q)=>j<<64-q|$>>>q-32,d=(j,$,q)=>j>>>q-32|$<<64-q,h=(j,$)=>$,g=(j,$)=>j,b=(j,$,q)=>j<<q|$>>>32-q,v=(j,$,q)=>$<<q|j>>>32-q,x=(j,$,q)=>$<<q-32|j>>>64-q,P=(j,$,q)=>j<<q-32|$>>>64-q;function E(j,$,q,A){const f=($>>>0)+(A>>>0);return{h:j+q+(f/2**32|0)|0,l:f|0}}e.add=E;const S=(j,$,q)=>(j>>>0)+($>>>0)+(q>>>0),T=(j,$,q,A)=>$+q+A+(j/2**32|0)|0,R=(j,$,q,A)=>(j>>>0)+($>>>0)+(q>>>0)+(A>>>0),K=(j,$,q,A,f)=>$+q+A+f+(j/2**32|0)|0,V=(j,$,q,A,f)=>(j>>>0)+($>>>0)+(q>>>0)+(A>>>0)+(f>>>0),W=(j,$,q,A,f,y)=>$+q+A+f+y+(j/2**32|0)|0,tt={fromBig:i,split:o,toBig:e.toBig,shrSH:r,shrSL:a,rotrSH:c,rotrSL:u,rotrBH:l,rotrBL:d,rotr32H:h,rotr32L:g,rotlSH:b,rotlSL:v,rotlBH:x,rotlBL:P,add:E,add3L:S,add3H:T,add4L:R,add4H:K,add5H:W,add5L:V};e.default=tt})(Sg);Object.defineProperty(qi,"__esModule",{value:!0});qi.sha384=qi.sha512_256=qi.sha512_224=qi.sha512=qi.SHA512=void 0;const $1=Ta,Ne=Sg,yu=ks,[U1,q1]=Ne.default.split(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(e=>BigInt(e))),Co=new Uint32Array(80),Bo=new Uint32Array(80);let Aa=class extends $1.SHA2{constructor(){super(128,64,16,!1),this.Ah=1779033703,this.Al=-205731576,this.Bh=-1150833019,this.Bl=-2067093701,this.Ch=1013904242,this.Cl=-23791573,this.Dh=-1521486534,this.Dl=1595750129,this.Eh=1359893119,this.El=-1377402159,this.Fh=-1694144372,this.Fl=725511199,this.Gh=528734635,this.Gl=-79577749,this.Hh=1541459225,this.Hl=327033209}get(){const{Ah:t,Al:n,Bh:i,Bl:o,Ch:s,Cl:r,Dh:a,Dl:c,Eh:u,El:l,Fh:d,Fl:h,Gh:g,Gl:b,Hh:v,Hl:x}=this;return[t,n,i,o,s,r,a,c,u,l,d,h,g,b,v,x]}set(t,n,i,o,s,r,a,c,u,l,d,h,g,b,v,x){this.Ah=t|0,this.Al=n|0,this.Bh=i|0,this.Bl=o|0,this.Ch=s|0,this.Cl=r|0,this.Dh=a|0,this.Dl=c|0,this.Eh=u|0,this.El=l|0,this.Fh=d|0,this.Fl=h|0,this.Gh=g|0,this.Gl=b|0,this.Hh=v|0,this.Hl=x|0}process(t,n){for(let S=0;S<16;S++,n+=4)Co[S]=t.getUint32(n),Bo[S]=t.getUint32(n+=4);for(let S=16;S<80;S++){const T=Co[S-15]|0,R=Bo[S-15]|0,K=Ne.default.rotrSH(T,R,1)^Ne.default.rotrSH(T,R,8)^Ne.default.shrSH(T,R,7),V=Ne.default.rotrSL(T,R,1)^Ne.default.rotrSL(T,R,8)^Ne.default.shrSL(T,R,7),W=Co[S-2]|0,tt=Bo[S-2]|0,j=Ne.default.rotrSH(W,tt,19)^Ne.default.rotrBH(W,tt,61)^Ne.default.shrSH(W,tt,6),$=Ne.default.rotrSL(W,tt,19)^Ne.default.rotrBL(W,tt,61)^Ne.default.shrSL(W,tt,6),q=Ne.default.add4L(V,$,Bo[S-7],Bo[S-16]),A=Ne.default.add4H(q,K,j,Co[S-7],Co[S-16]);Co[S]=A|0,Bo[S]=q|0}let{Ah:i,Al:o,Bh:s,Bl:r,Ch:a,Cl:c,Dh:u,Dl:l,Eh:d,El:h,Fh:g,Fl:b,Gh:v,Gl:x,Hh:P,Hl:E}=this;for(let S=0;S<80;S++){const T=Ne.default.rotrSH(d,h,14)^Ne.default.rotrSH(d,h,18)^Ne.default.rotrBH(d,h,41),R=Ne.default.rotrSL(d,h,14)^Ne.default.rotrSL(d,h,18)^Ne.default.rotrBL(d,h,41),K=d&g^~d&v,V=h&b^~h&x,W=Ne.default.add5L(E,R,V,q1[S],Bo[S]),tt=Ne.default.add5H(W,P,T,K,U1[S],Co[S]),j=W|0,$=Ne.default.rotrSH(i,o,28)^Ne.default.rotrBH(i,o,34)^Ne.default.rotrBH(i,o,39),q=Ne.default.rotrSL(i,o,28)^Ne.default.rotrBL(i,o,34)^Ne.default.rotrBL(i,o,39),A=i&s^i&a^s&a,f=o&r^o&c^r&c;P=v|0,E=x|0,v=g|0,x=b|0,g=d|0,b=h|0,{h:d,l:h}=Ne.default.add(u|0,l|0,tt|0,j|0),u=a|0,l=c|0,a=s|0,c=r|0,s=i|0,r=o|0;const y=Ne.default.add3L(j,q,f);i=Ne.default.add3H(y,tt,$,A),o=y|0}({h:i,l:o}=Ne.default.add(this.Ah|0,this.Al|0,i|0,o|0)),{h:s,l:r}=Ne.default.add(this.Bh|0,this.Bl|0,s|0,r|0),{h:a,l:c}=Ne.default.add(this.Ch|0,this.Cl|0,a|0,c|0),{h:u,l}=Ne.default.add(this.Dh|0,this.Dl|0,u|0,l|0),{h:d,l:h}=Ne.default.add(this.Eh|0,this.El|0,d|0,h|0),{h:g,l:b}=Ne.default.add(this.Fh|0,this.Fl|0,g|0,b|0),{h:v,l:x}=Ne.default.add(this.Gh|0,this.Gl|0,v|0,x|0),{h:P,l:E}=Ne.default.add(this.Hh|0,this.Hl|0,P|0,E|0),this.set(i,o,s,r,a,c,u,l,d,h,g,b,v,x,P,E)}roundClean(){Co.fill(0),Bo.fill(0)}destroy(){this.buffer.fill(0),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}};qi.SHA512=Aa;class M1 extends Aa{constructor(){super(),this.Ah=-1942145080,this.Al=424955298,this.Bh=1944164710,this.Bl=-1982016298,this.Ch=502970286,this.Cl=855612546,this.Dh=1738396948,this.Dl=1479516111,this.Eh=258812777,this.El=2077511080,this.Fh=2011393907,this.Fl=79989058,this.Gh=1067287976,this.Gl=1780299464,this.Hh=286451373,this.Hl=-1848208735,this.outputLen=28}}let D1=class extends Aa{constructor(){super(),this.Ah=573645204,this.Al=-64227540,this.Bh=-1621794909,this.Bl=-934517566,this.Ch=596883563,this.Cl=1867755857,this.Dh=-1774684391,this.Dl=1497426621,this.Eh=-1775747358,this.El=-1467023389,this.Fh=-1101128155,this.Fl=1401305490,this.Gh=721525244,this.Gl=746961066,this.Hh=246885852,this.Hl=-2117784414,this.outputLen=32}},L1=class extends Aa{constructor(){super(),this.Ah=-876896931,this.Al=-1056596264,this.Bh=1654270250,this.Bl=914150663,this.Ch=-1856437926,this.Cl=812702999,this.Dh=355462360,this.Dl=-150054599,this.Eh=1731405415,this.El=-4191439,this.Fh=-1900787065,this.Fl=1750603025,this.Gh=-619958771,this.Gl=1694076839,this.Hh=1203062813,this.Hl=-1090891868,this.outputLen=48}};qi.sha512=(0,yu.wrapConstructor)(()=>new Aa);qi.sha512_224=(0,yu.wrapConstructor)(()=>new M1);qi.sha512_256=(0,yu.wrapConstructor)(()=>new D1);qi.sha384=(0,yu.wrapConstructor)(()=>new L1);Object.defineProperty(Ti,"__esModule",{value:!0});var Pg=Ti.mnemonicToSeedSync=Ti.mnemonicToSeed=Ti.validateMnemonic=Ti.entropyToMnemonic=Ti.mnemonicToEntropy=Ti.generateMnemonic=void 0;/*! scure-bip39 - MIT License (c) 2022 Patricio Palladino, Paul Miller (paulmillr.com) */const Cg=zn,Bg=fr,N1=pr,Eg=qi,F1=ks,Fa=sd,j1=e=>e[0]==="";function Ig(e){if(typeof e!="string")throw new TypeError(`Invalid mnemonic type: ${typeof e}`);return e.normalize("NFKD")}function qd(e){const t=Ig(e),n=t.split(" ");if(![12,15,18,21,24].includes(n.length))throw new Error("Invalid mnemonic");return{nfkd:t,words:n}}function Og(e){Cg.default.bytes(e,16,20,24,28,32)}function z1(e,t=128){if(Cg.default.number(t),t%32!==0||t>256)throw new TypeError("Invalid entropy");return Ug((0,F1.randomBytes)(t/8),e)}Ti.generateMnemonic=z1;const H1=e=>{const t=8-e.length/4;return new Uint8Array([(0,N1.sha256)(e)[0]>>t<<t])};function Rg(e){if(!Array.isArray(e)||e.length!==2**11||typeof e[0]!="string")throw new Error("Worlist: expected array of 2048 strings");return e.forEach(t=>{if(typeof t!="string")throw new Error(`Wordlist: non-string element: ${t}`)}),Fa.utils.chain(Fa.utils.checksum(1,H1),Fa.utils.radix2(11,!0),Fa.utils.alphabet(e))}function $g(e,t){const{words:n}=qd(e),i=Rg(t).decode(n);return Og(i),i}Ti.mnemonicToEntropy=$g;function Ug(e,t){return Og(e),Rg(t).encode(e).join(j1(t)?"":" ")}Ti.entropyToMnemonic=Ug;function K1(e,t){try{$g(e,t)}catch{return!1}return!0}Ti.validateMnemonic=K1;const qg=e=>Ig(`mnemonic${e}`);function G1(e,t=""){return(0,Bg.pbkdf2Async)(Eg.sha512,qd(e).nfkd,qg(t),{c:2048,dkLen:64})}Ti.mnemonicToSeed=G1;function W1(e,t=""){return(0,Bg.pbkdf2)(Eg.sha512,qd(e).nfkd,qg(t),{c:2048,dkLen:64})}Pg=Ti.mnemonicToSeedSync=W1;/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */const X1=e=>new Uint32Array(e.buffer,e.byteOffset,Math.floor(e.byteLength/4)),gl=e=>new DataView(e.buffer,e.byteOffset,e.byteLength),V1=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;if(!V1)throw new Error("Non little-endian hardware is not supported");const J1=Array.from({length:256},(e,t)=>t.toString(16).padStart(2,"0"));function Mg(e){if(!(e instanceof Uint8Array))throw new Error("Uint8Array expected");let t="";for(let n=0;n<e.length;n++)t+=J1[e[n]];return t}function Dg(e){if(typeof e!="string")throw new TypeError("hexToBytes: expected string, got "+typeof e);if(e.length%2)throw new Error("hexToBytes: received invalid unpadded hex");const t=new Uint8Array(e.length/2);for(let n=0;n<t.length;n++){const i=n*2,o=e.slice(i,i+2),s=Number.parseInt(o,16);if(Number.isNaN(s)||s<0)throw new Error("Invalid byte sequence");t[n]=s}return t}function Z1(e){if(typeof e!="string")throw new TypeError(`utf8ToBytes expected string, got ${typeof e}`);return new TextEncoder().encode(e)}function xa(e){if(typeof e=="string"&&(e=Z1(e)),!(e instanceof Uint8Array))throw new TypeError(`Expected input type is Uint8Array (got ${typeof e})`);return e}class Md{clone(){return this._cloneInto()}}function wu(e){const t=i=>e().update(xa(i)).digest(),n=e();return t.outputLen=n.outputLen,t.blockLen=n.blockLen,t.create=()=>e(),t}function Y1(e){const t=(i,o)=>e(o).update(xa(i)).digest(),n=e({});return t.outputLen=n.outputLen,t.blockLen=n.blockLen,t.create=i=>e(i),t}function zl(e){if(!Number.isSafeInteger(e)||e<0)throw new Error(`Wrong positive integer: ${e}`)}function Q1(e){if(typeof e!="boolean")throw new Error(`Expected boolean, not ${e}`)}function Lg(e,...t){if(!(e instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(t.length>0&&!t.includes(e.length))throw new TypeError(`Expected Uint8Array of length ${t}, not of length=${e.length}`)}function tv(e){if(typeof e!="function"||typeof e.create!="function")throw new Error("Hash should be wrapped by utils.wrapConstructor");zl(e.outputLen),zl(e.blockLen)}function ev(e,t=!0){if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}function nv(e,t){Lg(e);const n=t.outputLen;if(e.length<n)throw new Error(`digestInto() expects output buffer of length at least ${n}`)}const Ai={number:zl,bool:Q1,bytes:Lg,hash:tv,exists:ev,output:nv},ja=BigInt(2**32-1),Hl=BigInt(32);function Ng(e,t=!1){return t?{h:Number(e&ja),l:Number(e>>Hl&ja)}:{h:Number(e>>Hl&ja)|0,l:Number(e&ja)|0}}function iv(e,t=!1){let n=new Uint32Array(e.length),i=new Uint32Array(e.length);for(let o=0;o<e.length;o++){const{h:s,l:r}=Ng(e[o],t);[n[o],i[o]]=[s,r]}return[n,i]}const ov=(e,t)=>BigInt(e>>>0)<<Hl|BigInt(t>>>0),sv=(e,t,n)=>e>>>n,rv=(e,t,n)=>e<<32-n|t>>>n,av=(e,t,n)=>e>>>n|t<<32-n,cv=(e,t,n)=>e<<32-n|t>>>n,uv=(e,t,n)=>e<<64-n|t>>>n-32,lv=(e,t,n)=>e>>>n-32|t<<64-n,dv=(e,t)=>t,hv=(e,t)=>e,fv=(e,t,n)=>e<<n|t>>>32-n,pv=(e,t,n)=>t<<n|e>>>32-n,gv=(e,t,n)=>t<<n-32|e>>>64-n,_v=(e,t,n)=>e<<n-32|t>>>64-n;function mv(e,t,n,i){const o=(t>>>0)+(i>>>0);return{h:e+n+(o/2**32|0)|0,l:o|0}}const yv=(e,t,n)=>(e>>>0)+(t>>>0)+(n>>>0),wv=(e,t,n,i)=>t+n+i+(e/2**32|0)|0,bv=(e,t,n,i)=>(e>>>0)+(t>>>0)+(n>>>0)+(i>>>0),vv=(e,t,n,i,o)=>t+n+i+o+(e/2**32|0)|0,Tv=(e,t,n,i,o)=>(e>>>0)+(t>>>0)+(n>>>0)+(i>>>0)+(o>>>0),Av=(e,t,n,i,o,s)=>t+n+i+o+s+(e/2**32|0)|0,Se={fromBig:Ng,split:iv,toBig:ov,shrSH:sv,shrSL:rv,rotrSH:av,rotrSL:cv,rotrBH:uv,rotrBL:lv,rotr32H:dv,rotr32L:hv,rotlSH:fv,rotlSL:pv,rotlBH:gv,rotlBL:_v,add:mv,add3L:yv,add3H:wv,add4L:bv,add4H:vv,add5H:Av,add5L:Tv},[Fg,jg,zg]=[[],[],[]],xv=BigInt(0),Fr=BigInt(1),kv=BigInt(2),Sv=BigInt(7),Pv=BigInt(256),Cv=BigInt(113);for(let e=0,t=Fr,n=1,i=0;e<24;e++){[n,i]=[i,(2*n+3*i)%5],Fg.push(2*(5*i+n)),jg.push((e+1)*(e+2)/2%64);let o=xv;for(let s=0;s<7;s++)t=(t<<Fr^(t>>Sv)*Cv)%Pv,t&kv&&(o^=Fr<<(Fr<<BigInt(s))-Fr);zg.push(o)}const[Bv,Ev]=Se.split(zg,!0),Mh=(e,t,n)=>n>32?Se.rotlBH(e,t,n):Se.rotlSH(e,t,n),Dh=(e,t,n)=>n>32?Se.rotlBL(e,t,n):Se.rotlSL(e,t,n);function Iv(e,t=24){const n=new Uint32Array(10);for(let i=24-t;i<24;i++){for(let r=0;r<10;r++)n[r]=e[r]^e[r+10]^e[r+20]^e[r+30]^e[r+40];for(let r=0;r<10;r+=2){const a=(r+8)%10,c=(r+2)%10,u=n[c],l=n[c+1],d=Mh(u,l,1)^n[a],h=Dh(u,l,1)^n[a+1];for(let g=0;g<50;g+=10)e[r+g]^=d,e[r+g+1]^=h}let o=e[2],s=e[3];for(let r=0;r<24;r++){const a=jg[r],c=Mh(o,s,a),u=Dh(o,s,a),l=Fg[r];o=e[l],s=e[l+1],e[l]=c,e[l+1]=u}for(let r=0;r<50;r+=10){for(let a=0;a<10;a++)n[a]=e[r+a];for(let a=0;a<10;a++)e[r+a]^=~n[(a+2)%10]&n[(a+4)%10]}e[0]^=Bv[i],e[1]^=Ev[i]}n.fill(0)}class bu extends Md{constructor(t,n,i,o=!1,s=24){if(super(),this.blockLen=t,this.suffix=n,this.outputLen=i,this.enableXOF=o,this.rounds=s,this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,Ai.number(i),0>=this.blockLen||this.blockLen>=200)throw new Error("Sha3 supports only keccak-f1600 function");this.state=new Uint8Array(200),this.state32=X1(this.state)}keccak(){Iv(this.state32,this.rounds),this.posOut=0,this.pos=0}update(t){Ai.exists(this);const{blockLen:n,state:i}=this;t=xa(t);const o=t.length;for(let s=0;s<o;){const r=Math.min(n-this.pos,o-s);for(let a=0;a<r;a++)i[this.pos++]^=t[s++];this.pos===n&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;const{state:t,suffix:n,pos:i,blockLen:o}=this;t[i]^=n,n&128&&i===o-1&&this.keccak(),t[o-1]^=128,this.keccak()}writeInto(t){Ai.exists(this,!1),Ai.bytes(t),this.finish();const n=this.state,{blockLen:i}=this;for(let o=0,s=t.length;o<s;){this.posOut>=i&&this.keccak();const r=Math.min(i-this.posOut,s-o);t.set(n.subarray(this.posOut,this.posOut+r),o),this.posOut+=r,o+=r}return t}xofInto(t){if(!this.enableXOF)throw new Error("XOF is not possible for this instance");return this.writeInto(t)}xof(t){return Ai.number(t),this.xofInto(new Uint8Array(t))}digestInto(t){if(Ai.output(t,this),this.finished)throw new Error("digest() was already called");return this.writeInto(t),this.destroy(),t}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,this.state.fill(0)}_cloneInto(t){const{blockLen:n,suffix:i,outputLen:o,rounds:s,enableXOF:r}=this;return t||(t=new bu(n,i,o,r,s)),t.state32.set(this.state32),t.pos=this.pos,t.posOut=this.posOut,t.finished=this.finished,t.rounds=s,t.suffix=i,t.outputLen=o,t.enableXOF=r,t.destroyed=this.destroyed,t}}const Zo=(e,t,n)=>wu(()=>new bu(t,e,n));Zo(6,144,224/8);const gr=Zo(6,136,256/8);Zo(6,104,384/8);Zo(6,72,512/8);Zo(1,144,224/8);Zo(1,136,256/8);Zo(1,104,384/8);Zo(1,72,512/8);const Hg=(e,t,n)=>Y1((i={})=>new bu(t,e,i.dkLen===void 0?n:i.dkLen,!0));Hg(31,168,128/8);Hg(31,136,256/8);class Kg extends Md{constructor(t,n){super(),this.finished=!1,this.destroyed=!1,Ai.hash(t);const i=xa(n);if(this.iHash=t.create(),typeof this.iHash.update!="function")throw new TypeError("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const o=this.blockLen,s=new Uint8Array(o);s.set(i.length>o?t.create().update(i).digest():i);for(let r=0;r<s.length;r++)s[r]^=54;this.iHash.update(s),this.oHash=t.create();for(let r=0;r<s.length;r++)s[r]^=106;this.oHash.update(s),s.fill(0)}update(t){return Ai.exists(this),this.iHash.update(t),this}digestInto(t){Ai.exists(this),Ai.bytes(t,this.outputLen),this.finished=!0,this.iHash.digestInto(t),this.oHash.update(t),this.oHash.digestInto(t),this.destroy()}digest(){const t=new Uint8Array(this.oHash.outputLen);return this.digestInto(t),t}_cloneInto(t){t||(t=Object.create(Object.getPrototypeOf(this),{}));const{oHash:n,iHash:i,finished:o,destroyed:s,blockLen:r,outputLen:a}=this;return t=t,t.finished=o,t.destroyed=s,t.blockLen=r,t.outputLen=a,t.oHash=n._cloneInto(t.oHash),t.iHash=i._cloneInto(t.iHash),t}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}}const Dd=(e,t,n)=>new Kg(e,t).update(n).digest();Dd.create=(e,t)=>new Kg(e,t);function Ov(e,t,n,i){if(typeof e.setBigUint64=="function")return e.setBigUint64(t,n,i);const o=BigInt(32),s=BigInt(4294967295),r=Number(n>>o&s),a=Number(n&s),c=i?4:0,u=i?0:4;e.setUint32(t+c,r,i),e.setUint32(t+u,a,i)}class Rv extends Md{constructor(t,n,i,o){super(),this.blockLen=t,this.outputLen=n,this.padOffset=i,this.isLE=o,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(t),this.view=gl(this.buffer)}update(t){Ai.exists(this);const{view:n,buffer:i,blockLen:o}=this;t=xa(t);const s=t.length;for(let r=0;r<s;){const a=Math.min(o-this.pos,s-r);if(a===o){const c=gl(t);for(;o<=s-r;r+=o)this.process(c,r);continue}i.set(t.subarray(r,r+a),this.pos),this.pos+=a,r+=a,this.pos===o&&(this.process(n,0),this.pos=0)}return this.length+=t.length,this.roundClean(),this}digestInto(t){Ai.exists(this),Ai.output(t,this),this.finished=!0;const{buffer:n,view:i,blockLen:o,isLE:s}=this;let{pos:r}=this;n[r++]=128,this.buffer.subarray(r).fill(0),this.padOffset>o-r&&(this.process(i,0),r=0);for(let c=r;c<o;c++)n[c]=0;Ov(i,o-8,BigInt(this.length*8),s),this.process(i,0);const a=gl(t);this.get().forEach((c,u)=>a.setUint32(4*u,c,s))}digest(){const{buffer:t,outputLen:n}=this;this.digestInto(t);const i=t.slice(0,n);return this.destroy(),i}_cloneInto(t){t||(t=new this.constructor),t.set(...this.get());const{blockLen:n,buffer:i,length:o,finished:s,destroyed:r,pos:a}=this;return t.length=o,t.pos=a,t.finished=s,t.destroyed=r,o%n&&t.buffer.set(i),t}}const[$v,Uv]=Se.split(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(e=>BigInt(e))),Eo=new Uint32Array(80),Io=new Uint32Array(80);class Ld extends Rv{constructor(){super(128,64,16,!1),this.Ah=1779033703,this.Al=-205731576,this.Bh=-1150833019,this.Bl=-2067093701,this.Ch=1013904242,this.Cl=-23791573,this.Dh=-1521486534,this.Dl=1595750129,this.Eh=1359893119,this.El=-1377402159,this.Fh=-1694144372,this.Fl=725511199,this.Gh=528734635,this.Gl=-79577749,this.Hh=1541459225,this.Hl=327033209}get(){const{Ah:t,Al:n,Bh:i,Bl:o,Ch:s,Cl:r,Dh:a,Dl:c,Eh:u,El:l,Fh:d,Fl:h,Gh:g,Gl:b,Hh:v,Hl:x}=this;return[t,n,i,o,s,r,a,c,u,l,d,h,g,b,v,x]}set(t,n,i,o,s,r,a,c,u,l,d,h,g,b,v,x){this.Ah=t|0,this.Al=n|0,this.Bh=i|0,this.Bl=o|0,this.Ch=s|0,this.Cl=r|0,this.Dh=a|0,this.Dl=c|0,this.Eh=u|0,this.El=l|0,this.Fh=d|0,this.Fl=h|0,this.Gh=g|0,this.Gl=b|0,this.Hh=v|0,this.Hl=x|0}process(t,n){for(let S=0;S<16;S++,n+=4)Eo[S]=t.getUint32(n),Io[S]=t.getUint32(n+=4);for(let S=16;S<80;S++){const T=Eo[S-15]|0,R=Io[S-15]|0,K=Se.rotrSH(T,R,1)^Se.rotrSH(T,R,8)^Se.shrSH(T,R,7),V=Se.rotrSL(T,R,1)^Se.rotrSL(T,R,8)^Se.shrSL(T,R,7),W=Eo[S-2]|0,tt=Io[S-2]|0,j=Se.rotrSH(W,tt,19)^Se.rotrBH(W,tt,61)^Se.shrSH(W,tt,6),$=Se.rotrSL(W,tt,19)^Se.rotrBL(W,tt,61)^Se.shrSL(W,tt,6),q=Se.add4L(V,$,Io[S-7],Io[S-16]),A=Se.add4H(q,K,j,Eo[S-7],Eo[S-16]);Eo[S]=A|0,Io[S]=q|0}let{Ah:i,Al:o,Bh:s,Bl:r,Ch:a,Cl:c,Dh:u,Dl:l,Eh:d,El:h,Fh:g,Fl:b,Gh:v,Gl:x,Hh:P,Hl:E}=this;for(let S=0;S<80;S++){const T=Se.rotrSH(d,h,14)^Se.rotrSH(d,h,18)^Se.rotrBH(d,h,41),R=Se.rotrSL(d,h,14)^Se.rotrSL(d,h,18)^Se.rotrBL(d,h,41),K=d&g^~d&v,V=h&b^~h&x,W=Se.add5L(E,R,V,Uv[S],Io[S]),tt=Se.add5H(W,P,T,K,$v[S],Eo[S]),j=W|0,$=Se.rotrSH(i,o,28)^Se.rotrBH(i,o,34)^Se.rotrBH(i,o,39),q=Se.rotrSL(i,o,28)^Se.rotrBL(i,o,34)^Se.rotrBL(i,o,39),A=i&s^i&a^s&a,f=o&r^o&c^r&c;P=v|0,E=x|0,v=g|0,x=b|0,g=d|0,b=h|0,{h:d,l:h}=Se.add(u|0,l|0,tt|0,j|0),u=a|0,l=c|0,a=s|0,c=r|0,s=i|0,r=o|0;const y=Se.add3L(j,q,f);i=Se.add3H(y,tt,$,A),o=y|0}({h:i,l:o}=Se.add(this.Ah|0,this.Al|0,i|0,o|0)),{h:s,l:r}=Se.add(this.Bh|0,this.Bl|0,s|0,r|0),{h:a,l:c}=Se.add(this.Ch|0,this.Cl|0,a|0,c|0),{h:u,l}=Se.add(this.Dh|0,this.Dl|0,u|0,l|0),{h:d,l:h}=Se.add(this.Eh|0,this.El|0,d|0,h|0),{h:g,l:b}=Se.add(this.Fh|0,this.Fl|0,g|0,b|0),{h:v,l:x}=Se.add(this.Gh|0,this.Gl|0,v|0,x|0),{h:P,l:E}=Se.add(this.Hh|0,this.Hl|0,P|0,E|0),this.set(i,o,s,r,a,c,u,l,d,h,g,b,v,x,P,E)}roundClean(){Eo.fill(0),Io.fill(0)}destroy(){this.buffer.fill(0),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}}class qv extends Ld{constructor(){super(),this.Ah=573645204,this.Al=-64227540,this.Bh=-1621794909,this.Bl=-934517566,this.Ch=596883563,this.Cl=1867755857,this.Dh=-1774684391,this.Dl=1497426621,this.Eh=-1775747358,this.El=-1467023389,this.Fh=-1101128155,this.Fl=1401305490,this.Gh=721525244,this.Gl=746961066,this.Hh=246885852,this.Hl=-2117784414,this.outputLen=32}}class Mv extends Ld{constructor(){super(),this.Ah=-876896931,this.Al=-1056596264,this.Bh=1654270250,this.Bl=914150663,this.Ch=-1856437926,this.Cl=812702999,this.Dh=355462360,this.Dl=-150054599,this.Eh=1731405415,this.El=-4191439,this.Fh=-1900787065,this.Fl=1750603025,this.Gh=-619958771,this.Gl=1694076839,this.Hh=1203062813,this.Hl=-1090891868,this.outputLen=48}}const Gg=wu(()=>new Ld);wu(()=>new qv);wu(()=>new Mv);var Wg=typeof self=="object"?self.FormData:window.FormData,Xg=Object.defineProperty,Dv=Object.getOwnPropertyDescriptor,vu=(e,t)=>{for(var n in t)Xg(e,n,{get:t[n],enumerable:!0})},ln=(e,t,n,i)=>{for(var o=i>1?void 0:i?Dv(t,n):t,s=e.length-1,r;s>=0;s--)(r=e[s])&&(o=(i?r(t,n,o):r(o))||o);return i&&o&&Xg(t,n,o),o},Lv=/^m(\/[0-9]+')+$/,Vg=e=>e.replace("'",""),Nv="ed25519 seed",Fv=2147483648,jv=e=>{const n=Dd.create(Gg,Nv).update(Dg(e)).digest(),i=n.slice(0,32),o=n.slice(32);return{key:i,chainCode:o}},zv=({key:e,chainCode:t},n)=>{const i=new ArrayBuffer(4);new DataView(i).setUint32(0,n);const o=new Uint8Array(i),s=new Uint8Array([0]),r=new Uint8Array([...s,...e,...o]),a=Dd.create(Gg,t).update(r).digest(),c=a.slice(0,32),u=a.slice(32);return{key:c,chainCode:u}},Hv=e=>Lv.test(e)?!e.split("/").slice(1).map(Vg).some(Number.isNaN):!1,Kv=(e,t,n=Fv)=>{if(!Hv(e))throw new Error("Invalid derivation path");const{key:i,chainCode:o}=jv(t);return e.split("/").slice(1).map(Vg).map(r=>parseInt(r,10)).reduce((r,a)=>zv(r,a+n),{key:i,chainCode:o})},Be=class{static fromBuffer(e){return Be.fromUint8Array(e)}static fromUint8Array(e){return new Be(Mg(e))}static ensure(e){return typeof e=="string"?new Be(e):e}constructor(e){e.startsWith("0x")?this.hexString=e:this.hexString=`0x${e}`}hex(){return this.hexString}noPrefix(){return this.hexString.slice(2)}toString(){return this.hex()}toShortString(){return`0x${this.hexString.replace(/^0x0*/,"")}`}toUint8Array(){return Uint8Array.from(Dg(this.noPrefix()))}};async function Gv(e){return new Promise(t=>{setTimeout(t,e)})}var Lh="/v1";function Wv(e){let t=`${e}`;return t.endsWith("/")&&(t=t.substring(0,t.length-1)),t.endsWith(Lh)||(t=`${t}${Lh}`),t}var Jg=2e5,Zg=20,Xv=20,Vv="0x1::aptos_coin::AptosCoin";function Tu(e){let t,n,i;return typeof e=="object"?(t=e.hashFunction,n=e.ttlMs,i=e.tags):t=e,(o,s,r)=>{if(r.value!=null)r.value=Nh(r.value,t,n,i);else if(r.get!=null)r.get=Nh(r.get,t,n,i);else throw new Error("Only put a Memoize() decorator on a method or get accessor.")}}function Jv(e,t){return Tu({ttlMs:e,hashFunction:t})}var ac=new Map;function Zv(e){const t=new Set;for(const n of e){const i=ac.get(n);if(i)for(const o of i)t.has(o)||(o.clear(),t.add(o))}return t.size}function Nh(e,t,n=0,i){const o=Symbol("__memoized_map__");return function(...s){let r;const a=this;a.hasOwnProperty(o)||Object.defineProperty(a,o,{configurable:!1,enumerable:!1,writable:!1,value:new Map});const c=a[o];if(Array.isArray(i))for(const u of i)ac.has(u)?ac.get(u).push(c):ac.set(u,[c]);if(t||s.length>0||n>0){let u;t===!0?u=s.map(h=>h.toString()).join("!"):t?u=t.apply(a,s):u=s[0];const l=`${u}__timestamp`;let d=!1;if(n>0)if(!c.has(l))d=!0;else{const h=c.get(l);d=Date.now()-h>n}c.has(u)&&!d?r=c.get(u):(r=e.apply(a,s),c.set(u,r),n>0&&c.set(l,Date.now()))}else{const u=a;c.has(u)?r=c.get(u):(r=e.apply(a,s),c.set(u,r))}return r}}async function Fh(e,t,n,i){var o;const s=[];let r;for(;;){const a=await e(Be.ensure(t).hex(),(o=i==null?void 0:i.ledgerVersion)==null?void 0:o.toString(),r,n);if(r=a.__headers["x-aptos-cursor"],delete a.__headers,s.push(...a),r==null)break}return s}var Yv={mainnet:"https://indexer.mainnet.aptoslabs.com/v1/graphql",testnet:"https://indexer-testnet.staging.gcp.aptosdev.com/v1/graphql",devnet:"https://indexer-devnet.staging.gcp.aptosdev.com/v1/graphql"},Qv={mainnet:"https://fullnode.mainnet.aptoslabs.com/v1",testnet:"https://fullnode.testnet.aptoslabs.com/v1",devnet:"https://fullnode.devnet.aptoslabs.com/v1"},F={};vu(F,{AccountAddress:()=>Sn,AccountAuthenticator:()=>ra,AccountAuthenticatorEd25519:()=>jd,AccountAuthenticatorMultiEd25519:()=>zd,ArgumentABI:()=>Oa,AuthenticationKey:()=>gs,ChainId:()=>Cu,ChangeSet:()=>dT,Ed25519PublicKey:()=>Ri,Ed25519Signature:()=>Qi,EntryFunction:()=>cs,EntryFunctionABI:()=>br,Identifier:()=>di,Module:()=>Qg,ModuleId:()=>ps,MultiAgentRawTransaction:()=>Su,MultiEd25519PublicKey:()=>ka,MultiEd25519Signature:()=>Au,MultiSig:()=>Gd,MultiSigTransactionPayload:()=>Kd,RawTransaction:()=>Ur,RawTransactionWithData:()=>t_,RotationProofChallenge:()=>fT,Script:()=>Pa,ScriptABI:()=>Uu,SignedTransaction:()=>Ca,StructTag:()=>_r,Transaction:()=>e_,TransactionArgument:()=>Gi,TransactionArgumentAddress:()=>yr,TransactionArgumentBool:()=>$u,TransactionArgumentU128:()=>Ou,TransactionArgumentU16:()=>Eu,TransactionArgumentU256:()=>Ru,TransactionArgumentU32:()=>Iu,TransactionArgumentU64:()=>mr,TransactionArgumentU8:()=>Bu,TransactionArgumentU8Vector:()=>wr,TransactionAuthenticator:()=>Sa,TransactionAuthenticatorEd25519:()=>xu,TransactionAuthenticatorMultiAgent:()=>Fd,TransactionAuthenticatorMultiEd25519:()=>ku,TransactionPayload:()=>Ba,TransactionPayloadEntryFunction:()=>Pu,TransactionPayloadMultisig:()=>Wd,TransactionPayloadScript:()=>Ea,TransactionScriptABI:()=>qu,TypeArgumentABI:()=>Ia,TypeTag:()=>ti,TypeTagAddress:()=>Es,TypeTagBool:()=>Ps,TypeTagSigner:()=>Hd,TypeTagStruct:()=>Is,TypeTagU128:()=>Bs,TypeTagU16:()=>Ir,TypeTagU256:()=>Rr,TypeTagU32:()=>Or,TypeTagU64:()=>Cs,TypeTagU8:()=>po,TypeTagVector:()=>$r,UserTransaction:()=>Xd,WriteSet:()=>hT});var at={};vu(at,{Deserializer:()=>Nd,Serializer:()=>In,bcsSerializeBool:()=>cT,bcsSerializeBytes:()=>Fs,bcsSerializeFixedBytes:()=>lT,bcsSerializeStr:()=>uT,bcsSerializeU128:()=>aT,bcsSerializeU16:()=>sT,bcsSerializeU32:()=>rT,bcsSerializeU8:()=>Kl,bcsSerializeUint64:()=>oT,bcsToBytes:()=>_o,deserializeVector:()=>Mi,serializeVector:()=>xi,serializeVectorWithFunc:()=>iT});var tT=2**8-1,eT=2**16-1,sa=2**32-1,Zr=BigInt(2**64)-BigInt(1),Yg=BigInt(2**128)-BigInt(1),nT=BigInt(2**256)-BigInt(1),In=class{constructor(){this.buffer=new ArrayBuffer(64),this.offset=0}ensureBufferWillHandleSize(e){for(;this.buffer.byteLength<this.offset+e;){const t=new ArrayBuffer(this.buffer.byteLength*2);new Uint8Array(t).set(new Uint8Array(this.buffer)),this.buffer=t}}serialize(e){this.ensureBufferWillHandleSize(e.length),new Uint8Array(this.buffer,this.offset).set(e),this.offset+=e.length}serializeWithFunction(e,t,n){this.ensureBufferWillHandleSize(t);const i=new DataView(this.buffer,this.offset);e.apply(i,[0,n,!0]),this.offset+=t}serializeStr(e){const t=new TextEncoder;this.serializeBytes(t.encode(e))}serializeBytes(e){this.serializeU32AsUleb128(e.length),this.serialize(e)}serializeFixedBytes(e){this.serialize(e)}serializeBool(e){if(typeof e!="boolean")throw new Error("Value needs to be a boolean");const t=e?1:0;this.serialize(new Uint8Array([t]))}serializeU8(e){this.serialize(new Uint8Array([e]))}serializeU16(e){this.serializeWithFunction(DataView.prototype.setUint16,2,e)}serializeU32(e){this.serializeWithFunction(DataView.prototype.setUint32,4,e)}serializeU64(e){const t=BigInt(e.toString())&BigInt(sa),n=BigInt(e.toString())>>BigInt(32);this.serializeU32(Number(t)),this.serializeU32(Number(n))}serializeU128(e){const t=BigInt(e.toString())&Zr,n=BigInt(e.toString())>>BigInt(64);this.serializeU64(t),this.serializeU64(n)}serializeU256(e){const t=BigInt(e.toString())&Yg,n=BigInt(e.toString())>>BigInt(128);this.serializeU128(t),this.serializeU128(n)}serializeU32AsUleb128(e){let t=e;const n=[];for(;t>>>7;)n.push(t&127|128),t>>>=7;n.push(t),this.serialize(new Uint8Array(n))}getBytes(){return new Uint8Array(this.buffer).slice(0,this.offset)}};ln([Ss(0,tT)],In.prototype,"serializeU8",1);ln([Ss(0,eT)],In.prototype,"serializeU16",1);ln([Ss(0,sa)],In.prototype,"serializeU32",1);ln([Ss(BigInt(0),Zr)],In.prototype,"serializeU64",1);ln([Ss(BigInt(0),Yg)],In.prototype,"serializeU128",1);ln([Ss(BigInt(0),nT)],In.prototype,"serializeU256",1);ln([Ss(0,sa)],In.prototype,"serializeU32AsUleb128",1);function Ss(e,t,n){return(i,o,s)=>{const r=s.value;return s.value=function(c){const u=BigInt(c.toString());if(u>BigInt(t.toString())||u<BigInt(e.toString()))throw new Error(n||"Value is out of range");r.apply(this,[c])},s}}var Nd=class{constructor(e){this.buffer=new ArrayBuffer(e.length),new Uint8Array(this.buffer).set(e,0),this.offset=0}read(e){if(this.offset+e>this.buffer.byteLength)throw new Error("Reached to the end of buffer");const t=this.buffer.slice(this.offset,this.offset+e);return this.offset+=e,t}deserializeStr(){const e=this.deserializeBytes();return new TextDecoder().decode(e)}deserializeBytes(){const e=this.deserializeUleb128AsU32();return new Uint8Array(this.read(e))}deserializeFixedBytes(e){return new Uint8Array(this.read(e))}deserializeBool(){const e=new Uint8Array(this.read(1))[0];if(e!==1&&e!==0)throw new Error("Invalid boolean value");return e===1}deserializeU8(){return new DataView(this.read(1)).getUint8(0)}deserializeU16(){return new DataView(this.read(2)).getUint16(0,!0)}deserializeU32(){return new DataView(this.read(4)).getUint32(0,!0)}deserializeU64(){const e=this.deserializeU32(),t=this.deserializeU32();return BigInt(BigInt(t)<<BigInt(32)|BigInt(e))}deserializeU128(){const e=this.deserializeU64(),t=this.deserializeU64();return BigInt(t<<BigInt(64)|e)}deserializeU256(){const e=this.deserializeU128(),t=this.deserializeU128();return BigInt(t<<BigInt(128)|e)}deserializeUleb128AsU32(){let e=BigInt(0),t=0;for(;e<sa;){const n=this.deserializeU8();if(e|=BigInt(n&127)<<BigInt(t),!(n&128))break;t+=7}if(e>sa)throw new Error("Overflow while parsing uleb128-encoded uint32 value");return Number(e)}};function xi(e,t){t.serializeU32AsUleb128(e.length),e.forEach(n=>{n.serialize(t)})}function iT(e,t){const n=new In;n.serializeU32AsUleb128(e.length);const i=n[t];return e.forEach(o=>{i.call(n,o)}),n.getBytes()}function Mi(e,t){const n=e.deserializeUleb128AsU32(),i=[];for(let o=0;o<n;o+=1)i.push(t.deserialize(e));return i}function _o(e){const t=new In;return e.serialize(t),t.getBytes()}function oT(e){const t=new In;return t.serializeU64(e),t.getBytes()}function Kl(e){const t=new In;return t.serializeU8(e),t.getBytes()}function sT(e){const t=new In;return t.serializeU16(e),t.getBytes()}function rT(e){const t=new In;return t.serializeU32(e),t.getBytes()}function aT(e){const t=new In;return t.serializeU128(e),t.getBytes()}function cT(e){const t=new In;return t.serializeBool(e),t.getBytes()}function uT(e){const t=new In;return t.serializeStr(e),t.getBytes()}function Fs(e){const t=new In;return t.serializeBytes(e),t.getBytes()}function lT(e){const t=new In;return t.serializeFixedBytes(e),t.getBytes()}var Bi=class{constructor(e){if(e.length!==Bi.LENGTH)throw new Error("Expected address of length 32");this.address=e}static fromHex(e){let t=Be.ensure(e);t.noPrefix().length%2!==0&&(t=new Be(`0${t.noPrefix()}`));const n=t.toUint8Array();if(n.length>Bi.LENGTH)throw new Error("Hex string is too long. Address's length is 32 bytes.");if(n.length===Bi.LENGTH)return new Bi(n);const i=new Uint8Array(Bi.LENGTH);return i.set(n,Bi.LENGTH-n.length),new Bi(i)}static isValid(e){if(e==="")return!1;let t=Be.ensure(e);return t.noPrefix().length%2!==0&&(t=new Be(`0${t.noPrefix()}`)),t.toUint8Array().length<=Bi.LENGTH}toHexString(){return Be.fromUint8Array(this.address).hex()}serialize(e){e.serializeFixedBytes(this.address)}static deserialize(e){return new Bi(e.deserializeFixedBytes(Bi.LENGTH))}},Sn=Bi;Sn.LENGTH=32;Sn.CORE_CODE_ADDRESS=Bi.fromHex("0x1");var cc=class{constructor(e){if(e.length!==cc.LENGTH)throw new Error(`Ed25519PublicKey length should be ${cc.LENGTH}`);this.value=e}toBytes(){return this.value}serialize(e){e.serializeBytes(this.value)}static deserialize(e){const t=e.deserializeBytes();return new cc(t)}},Ri=cc;Ri.LENGTH=32;var uc=class{constructor(e){if(this.value=e,e.length!==uc.LENGTH)throw new Error(`Ed25519Signature length should be ${uc.LENGTH}`)}serialize(e){e.serializeBytes(this.value)}static deserialize(e){const t=e.deserializeBytes();return new uc(t)}},Qi=uc;Qi.LENGTH=64;var Gl=32,ka=class{constructor(e,t){if(this.public_keys=e,this.threshold=t,t>Gl)throw new Error(`"threshold" cannot be larger than ${Gl}`)}toBytes(){const e=new Uint8Array(this.public_keys.length*Ri.LENGTH+1);return this.public_keys.forEach((t,n)=>{e.set(t.value,n*Ri.LENGTH)}),e[this.public_keys.length*Ri.LENGTH]=this.threshold,e}serialize(e){e.serializeBytes(this.toBytes())}static deserialize(e){const t=e.deserializeBytes(),n=t[t.length-1],i=[];for(let o=0;o<t.length-1;o+=Ri.LENGTH){const s=o;i.push(new Ri(t.subarray(s,s+Ri.LENGTH)))}return new ka(i,n)}},Kr=class{constructor(e,t){if(this.signatures=e,this.bitmap=t,t.length!==Kr.BITMAP_LEN)throw new Error(`"bitmap" length should be ${Kr.BITMAP_LEN}`)}toBytes(){const e=new Uint8Array(this.signatures.length*Qi.LENGTH+Kr.BITMAP_LEN);return this.signatures.forEach((t,n)=>{e.set(t.value,n*Qi.LENGTH)}),e.set(this.bitmap,this.signatures.length*Qi.LENGTH),e}static createBitmap(e){const n=new Uint8Array([0,0,0,0]),i=new Set;return e.forEach(o=>{if(o>=Gl)throw new Error(`Invalid bit value ${o}.`);if(i.has(o))throw new Error("Duplicated bits detected.");i.add(o);const s=Math.floor(o/8);let r=n[s];r|=128>>o%8,n[s]=r}),n}serialize(e){e.serializeBytes(this.toBytes())}static deserialize(e){const t=e.deserializeBytes(),n=t.subarray(t.length-4),i=[];for(let o=0;o<t.length-n.length;o+=Qi.LENGTH){const s=o;i.push(new Qi(t.subarray(s,s+Qi.LENGTH)))}return new Kr(i,n)}},Au=Kr;Au.BITMAP_LEN=4;var Sa=class{static deserialize(e){const t=e.deserializeUleb128AsU32();switch(t){case 0:return xu.load(e);case 1:return ku.load(e);case 2:return Fd.load(e);default:throw new Error(`Unknown variant index for TransactionAuthenticator: ${t}`)}}},xu=class extends Sa{constructor(e,t){super(),this.public_key=e,this.signature=t}serialize(e){e.serializeU32AsUleb128(0),this.public_key.serialize(e),this.signature.serialize(e)}static load(e){const t=Ri.deserialize(e),n=Qi.deserialize(e);return new xu(t,n)}},ku=class extends Sa{constructor(e,t){super(),this.public_key=e,this.signature=t}serialize(e){e.serializeU32AsUleb128(1),this.public_key.serialize(e),this.signature.serialize(e)}static load(e){const t=ka.deserialize(e),n=Au.deserialize(e);return new ku(t,n)}},Fd=class extends Sa{constructor(e,t,n){super(),this.sender=e,this.secondary_signer_addresses=t,this.secondary_signers=n}serialize(e){e.serializeU32AsUleb128(2),this.sender.serialize(e),xi(this.secondary_signer_addresses,e),xi(this.secondary_signers,e)}static load(e){const t=ra.deserialize(e),n=Mi(e,Sn),i=Mi(e,ra);return new Fd(t,n,i)}},ra=class{static deserialize(e){const t=e.deserializeUleb128AsU32();switch(t){case 0:return jd.load(e);case 1:return zd.load(e);default:throw new Error(`Unknown variant index for AccountAuthenticator: ${t}`)}}},jd=class extends ra{constructor(e,t){super(),this.public_key=e,this.signature=t}serialize(e){e.serializeU32AsUleb128(0),this.public_key.serialize(e),this.signature.serialize(e)}static load(e){const t=Ri.deserialize(e),n=Qi.deserialize(e);return new jd(t,n)}},zd=class extends ra{constructor(e,t){super(),this.public_key=e,this.signature=t}serialize(e){e.serializeU32AsUleb128(1),this.public_key.serialize(e),this.signature.serialize(e)}static load(e){const t=ka.deserialize(e),n=Au.deserialize(e);return new zd(t,n)}},di=class{constructor(e){this.value=e}serialize(e){e.serializeStr(this.value)}static deserialize(e){const t=e.deserializeStr();return new di(t)}},ti=class{static deserialize(e){const t=e.deserializeUleb128AsU32();switch(t){case 0:return Ps.load(e);case 1:return po.load(e);case 2:return Cs.load(e);case 3:return Bs.load(e);case 4:return Es.load(e);case 5:return Hd.load(e);case 6:return $r.load(e);case 7:return Is.load(e);case 8:return Ir.load(e);case 9:return Or.load(e);case 10:return Rr.load(e);default:throw new Error(`Unknown variant index for TypeTag: ${t}`)}}},Ps=class extends ti{serialize(e){e.serializeU32AsUleb128(0)}static load(e){return new Ps}},po=class extends ti{serialize(e){e.serializeU32AsUleb128(1)}static load(e){return new po}},Ir=class extends ti{serialize(e){e.serializeU32AsUleb128(1)}static load(e){return new Ir}},Or=class extends ti{serialize(e){e.serializeU32AsUleb128(1)}static load(e){return new Or}},Cs=class extends ti{serialize(e){e.serializeU32AsUleb128(2)}static load(e){return new Cs}},Bs=class extends ti{serialize(e){e.serializeU32AsUleb128(3)}static load(e){return new Bs}},Rr=class extends ti{serialize(e){e.serializeU32AsUleb128(1)}static load(e){return new Rr}},Es=class extends ti{serialize(e){e.serializeU32AsUleb128(4)}static load(e){return new Es}},Hd=class extends ti{serialize(e){e.serializeU32AsUleb128(5)}static load(e){return new Hd}},$r=class extends ti{constructor(e){super(),this.value=e}serialize(e){e.serializeU32AsUleb128(6),this.value.serialize(e)}static load(e){const t=ti.deserialize(e);return new $r(t)}},Is=class extends ti{constructor(e){super(),this.value=e}serialize(e){e.serializeU32AsUleb128(7),this.value.serialize(e)}static load(e){const t=_r.deserialize(e);return new Is(t)}isStringTypeTag(){return this.value.module_name.value==="string"&&this.value.name.value==="String"&&this.value.address.toHexString()===Sn.fromHex("0x1").toHexString()}},_r=class{constructor(e,t,n,i){this.address=e,this.module_name=t,this.name=n,this.type_args=i}static fromString(e){if(e.includes("<"))throw new Error("Not implemented");const t=e.split("::");if(t.length!==3)throw new Error("Invalid struct tag string literal.");return new _r(Sn.fromHex(t[0]),new di(t[1]),new di(t[2]),[])}serialize(e){this.address.serialize(e),this.module_name.serialize(e),this.name.serialize(e),xi(this.type_args,e)}static deserialize(e){const t=Sn.deserialize(e),n=di.deserialize(e),i=di.deserialize(e),o=Mi(e,ti);return new _r(t,n,i,o)}},Ur=class{constructor(e,t,n,i,o,s,r){this.sender=e,this.sequence_number=t,this.payload=n,this.max_gas_amount=i,this.gas_unit_price=o,this.expiration_timestamp_secs=s,this.chain_id=r}serialize(e){this.sender.serialize(e),e.serializeU64(this.sequence_number),this.payload.serialize(e),e.serializeU64(this.max_gas_amount),e.serializeU64(this.gas_unit_price),e.serializeU64(this.expiration_timestamp_secs),this.chain_id.serialize(e)}static deserialize(e){const t=Sn.deserialize(e),n=e.deserializeU64(),i=Ba.deserialize(e),o=e.deserializeU64(),s=e.deserializeU64(),r=e.deserializeU64(),a=Cu.deserialize(e);return new Ur(t,n,i,o,s,r,a)}},Pa=class{constructor(e,t,n){this.code=e,this.ty_args=t,this.args=n}serialize(e){e.serializeBytes(this.code),xi(this.ty_args,e),xi(this.args,e)}static deserialize(e){const t=e.deserializeBytes(),n=Mi(e,ti),i=Mi(e,Gi);return new Pa(t,n,i)}},cs=class{constructor(e,t,n,i){this.module_name=e,this.function_name=t,this.ty_args=n,this.args=i}static natural(e,t,n,i){return new cs(ps.fromStr(e),new di(t),n,i)}static natual(e,t,n,i){return cs.natural(e,t,n,i)}serialize(e){this.module_name.serialize(e),this.function_name.serialize(e),xi(this.ty_args,e),e.serializeU32AsUleb128(this.args.length),this.args.forEach(t=>{e.serializeBytes(t)})}static deserialize(e){const t=ps.deserialize(e),n=di.deserialize(e),i=Mi(e,ti),o=e.deserializeUleb128AsU32(),s=[];for(let a=0;a<o;a+=1)s.push(e.deserializeBytes());const r=s;return new cs(t,n,i,r)}},Kd=class{constructor(e){this.transaction_payload=e}serialize(e){e.serializeU32AsUleb128(0),this.transaction_payload.serialize(e)}static deserialize(e){return new Kd(cs.deserialize(e))}},Gd=class{constructor(e,t){this.multisig_address=e,this.transaction_payload=t}serialize(e){this.multisig_address.serialize(e),this.transaction_payload===void 0?e.serializeBool(!1):(e.serializeBool(!0),this.transaction_payload.serialize(e))}static deserialize(e){const t=Sn.deserialize(e),n=e.deserializeBool();let i;return n&&(i=Kd.deserialize(e)),new Gd(t,i)}},Qg=class{constructor(e){this.code=e}serialize(e){e.serializeBytes(this.code)}static deserialize(e){const t=e.deserializeBytes();return new Qg(t)}},ps=class{constructor(e,t){this.address=e,this.name=t}static fromStr(e){const t=e.split("::");if(t.length!==2)throw new Error("Invalid module id.");return new ps(Sn.fromHex(new Be(t[0])),new di(t[1]))}serialize(e){this.address.serialize(e),this.name.serialize(e)}static deserialize(e){const t=Sn.deserialize(e),n=di.deserialize(e);return new ps(t,n)}},dT=class{serialize(e){throw new Error("Not implemented.")}static deserialize(e){throw new Error("Not implemented.")}},hT=class{serialize(e){throw new Error("Not implmented.")}static deserialize(e){throw new Error("Not implmented.")}},Ca=class{constructor(e,t){this.raw_txn=e,this.authenticator=t}serialize(e){this.raw_txn.serialize(e),this.authenticator.serialize(e)}static deserialize(e){const t=Ur.deserialize(e),n=Sa.deserialize(e);return new Ca(t,n)}},t_=class{static deserialize(e){const t=e.deserializeUleb128AsU32();switch(t){case 0:return Su.load(e);default:throw new Error(`Unknown variant index for RawTransactionWithData: ${t}`)}}},Su=class extends t_{constructor(e,t){super(),this.raw_txn=e,this.secondary_signer_addresses=t}serialize(e){e.serializeU32AsUleb128(0),this.raw_txn.serialize(e),xi(this.secondary_signer_addresses,e)}static load(e){const t=Ur.deserialize(e),n=Mi(e,Sn);return new Su(t,n)}},Ba=class{static deserialize(e){const t=e.deserializeUleb128AsU32();switch(t){case 0:return Ea.load(e);case 2:return Pu.load(e);case 3:return Wd.load(e);default:throw new Error(`Unknown variant index for TransactionPayload: ${t}`)}}},Ea=class extends Ba{constructor(e){super(),this.value=e}serialize(e){e.serializeU32AsUleb128(0),this.value.serialize(e)}static load(e){const t=Pa.deserialize(e);return new Ea(t)}},Pu=class extends Ba{constructor(e){super(),this.value=e}serialize(e){e.serializeU32AsUleb128(2),this.value.serialize(e)}static load(e){const t=cs.deserialize(e);return new Pu(t)}},Wd=class extends Ba{constructor(e){super(),this.value=e}serialize(e){e.serializeU32AsUleb128(3),this.value.serialize(e)}static load(e){const t=Gd.deserialize(e);return new Wd(t)}},Cu=class{constructor(e){this.value=e}serialize(e){e.serializeU8(this.value)}static deserialize(e){const t=e.deserializeU8();return new Cu(t)}},Gi=class{static deserialize(e){const t=e.deserializeUleb128AsU32();switch(t){case 0:return Bu.load(e);case 1:return mr.load(e);case 2:return Ou.load(e);case 3:return yr.load(e);case 4:return wr.load(e);case 5:return $u.load(e);case 6:return Eu.load(e);case 7:return Iu.load(e);case 8:return Ru.load(e);default:throw new Error(`Unknown variant index for TransactionArgument: ${t}`)}}},Bu=class extends Gi{constructor(e){super(),this.value=e}serialize(e){e.serializeU32AsUleb128(0),e.serializeU8(this.value)}static load(e){const t=e.deserializeU8();return new Bu(t)}},Eu=class extends Gi{constructor(e){super(),this.value=e}serialize(e){e.serializeU32AsUleb128(6),e.serializeU16(this.value)}static load(e){const t=e.deserializeU16();return new Eu(t)}},Iu=class extends Gi{constructor(e){super(),this.value=e}serialize(e){e.serializeU32AsUleb128(7),e.serializeU32(this.value)}static load(e){const t=e.deserializeU32();return new Iu(t)}},mr=class extends Gi{constructor(e){super(),this.value=e}serialize(e){e.serializeU32AsUleb128(1),e.serializeU64(this.value)}static load(e){const t=e.deserializeU64();return new mr(t)}},Ou=class extends Gi{constructor(e){super(),this.value=e}serialize(e){e.serializeU32AsUleb128(2),e.serializeU128(this.value)}static load(e){const t=e.deserializeU128();return new Ou(t)}},Ru=class extends Gi{constructor(e){super(),this.value=e}serialize(e){e.serializeU32AsUleb128(8),e.serializeU256(this.value)}static load(e){const t=e.deserializeU256();return new Ru(t)}},yr=class extends Gi{constructor(e){super(),this.value=e}serialize(e){e.serializeU32AsUleb128(3),this.value.serialize(e)}static load(e){const t=Sn.deserialize(e);return new yr(t)}},wr=class extends Gi{constructor(e){super(),this.value=e}serialize(e){e.serializeU32AsUleb128(4),e.serializeBytes(this.value)}static load(e){const t=e.deserializeBytes();return new wr(t)}},$u=class extends Gi{constructor(e){super(),this.value=e}serialize(e){e.serializeU32AsUleb128(5),e.serializeBool(this.value)}static load(e){const t=e.deserializeBool();return new $u(t)}},e_=class{getHashSalt(){const e=gr.create();return e.update("APTOS::Transaction"),e.digest()}static deserialize(e){const t=e.deserializeUleb128AsU32();switch(t){case 0:return Xd.load(e);default:throw new Error(`Unknown variant index for Transaction: ${t}`)}}},Xd=class extends e_{constructor(e){super(),this.value=e}hash(){const e=gr.create();return e.update(this.getHashSalt()),e.update(_o(this)),e.digest()}serialize(e){e.serializeU32AsUleb128(0),this.value.serialize(e)}static load(e){return new Xd(Ca.deserialize(e))}},Ia=class{constructor(e){this.name=e}serialize(e){e.serializeStr(this.name)}static deserialize(e){const t=e.deserializeStr();return new Ia(t)}},Oa=class{constructor(e,t){this.name=e,this.type_tag=t}serialize(e){e.serializeStr(this.name),this.type_tag.serialize(e)}static deserialize(e){const t=e.deserializeStr(),n=ti.deserialize(e);return new Oa(t,n)}},Uu=class{static deserialize(e){const t=e.deserializeUleb128AsU32();switch(t){case 0:return qu.load(e);case 1:return br.load(e);default:throw new Error(`Unknown variant index for TransactionPayload: ${t}`)}}},qu=class extends Uu{constructor(e,t,n,i,o){super(),this.name=e,this.doc=t,this.code=n,this.ty_args=i,this.args=o}serialize(e){e.serializeU32AsUleb128(0),e.serializeStr(this.name),e.serializeStr(this.doc),e.serializeBytes(this.code),xi(this.ty_args,e),xi(this.args,e)}static load(e){const t=e.deserializeStr(),n=e.deserializeStr(),i=e.deserializeBytes(),o=Mi(e,Ia),s=Mi(e,Oa);return new qu(t,n,i,o,s)}},br=class extends Uu{constructor(e,t,n,i,o){super(),this.name=e,this.module_name=t,this.doc=n,this.ty_args=i,this.args=o}serialize(e){e.serializeU32AsUleb128(1),e.serializeStr(this.name),this.module_name.serialize(e),e.serializeStr(this.doc),xi(this.ty_args,e),xi(this.args,e)}static load(e){const t=e.deserializeStr(),n=ps.deserialize(e),i=e.deserializeStr(),o=Mi(e,Ia),s=Mi(e,Oa);return new br(t,n,i,o,s)}},js=class{constructor(e){if(e.length!==js.LENGTH)throw new Error("Expected a byte array of length 32");this.bytes=e}static fromMultiEd25519PublicKey(e){const t=e.toBytes(),n=new Uint8Array(t.length+1);n.set(t),n.set([js.MULTI_ED25519_SCHEME],t.length);const i=gr.create();return i.update(n),new js(i.digest())}static fromEd25519PublicKey(e){const t=e.value,n=new Uint8Array(t.length+1);n.set(t),n.set([js.ED25519_SCHEME],t.length);const i=gr.create();return i.update(n),new js(i.digest())}derivedAddress(){return Be.fromUint8Array(this.bytes)}},gs=js;gs.LENGTH=32;gs.MULTI_ED25519_SCHEME=1;gs.ED25519_SCHEME=0;gs.DERIVE_RESOURCE_ACCOUNT_SCHEME=255;var fT=class{constructor(e,t,n,i,o,s,r){this.accountAddress=e,this.moduleName=t,this.structName=n,this.sequenceNumber=i,this.originator=o,this.currentAuthKey=s,this.newPublicKey=r}serialize(e){this.accountAddress.serialize(e),e.serializeStr(this.moduleName),e.serializeStr(this.structName),e.serializeU64(this.sequenceNumber),this.originator.serialize(e),this.currentAuthKey.serialize(e),e.serializeBytes(this.newPublicKey)}},lc=class{static fromAptosAccountObject(e){return new lc(Be.ensure(e.privateKeyHex).toUint8Array(),e.address)}static fromDerivePath(e,t){if(!lc.isValidPath(e))throw new Error("Invalid derivation path");const n=t.trim().split(/\s+/).map(o=>o.toLowerCase()).join(" "),{key:i}=Kv(e,Mg(Pg(n)));return new lc(i)}constructor(e,t){e?this.signingKey=no.sign.keyPair.fromSeed(e.slice(0,32)):this.signingKey=no.sign.keyPair(),this.accountAddress=Be.ensure(t||this.authKey().hex())}address(){return this.accountAddress}authKey(){const e=new Ri(this.signingKey.publicKey);return gs.fromEd25519PublicKey(e).derivedAddress()}static getResourceAccountAddress(e,t){const n=_o(Sn.fromHex(e)),i=new Uint8Array([...n,...t,gs.DERIVE_RESOURCE_ACCOUNT_SCHEME]),o=gr.create();return o.update(i),Be.fromUint8Array(o.digest())}pubKey(){return Be.fromUint8Array(this.signingKey.publicKey)}signBuffer(e){const t=no.sign(e,this.signingKey.secretKey);return Be.fromUint8Array(t.slice(0,64))}signHexString(e){const t=Be.ensure(e).toUint8Array();return this.signBuffer(t)}toPrivateKeyObject(){return{address:this.address().hex(),publicKeyHex:this.pubKey().hex(),privateKeyHex:Be.fromUint8Array(this.signingKey.secretKey.slice(0,32)).hex()}}},aa=lc;aa.isValidPath=e=>!!/^m\/44'\/637'\/[0-9]+'\/[0-9]+'\/[0-9]+'+$/.test(e);ln([Tu()],aa.prototype,"authKey",1);function vr(e){return e instanceof aa?e.address():Be.ensure(e)}var pT=`
    fragment TokenDataFields on current_token_datas {
  creator_address
  collection_name
  description
  metadata_uri
  name
  token_data_id_hash
  collection_data_id_hash
}
    `,gT=`
    fragment CollectionDataFields on current_collection_datas {
  metadata_uri
  supply
  description
  collection_name
  collection_data_id_hash
  table_handle
  creator_address
}
    `,_T=`
    query getAccountCurrentTokens($address: String!, $offset: Int, $limit: Int) {
  current_token_ownerships(
    where: {owner_address: {_eq: $address}, amount: {_gt: 0}}
    order_by: [{last_transaction_version: desc}, {creator_address: asc}, {collection_name: asc}, {name: asc}]
    offset: $offset
    limit: $limit
  ) {
    amount
    current_token_data {
      ...TokenDataFields
    }
    current_collection_data {
      ...CollectionDataFields
    }
    last_transaction_version
    property_version
  }
}
    ${pT}
${gT}`,mT=`
    query getTokenActivities($idHash: String!) {
  token_activities(where: {token_data_id_hash: {_eq: $idHash}}) {
    creator_address
    collection_name
    name
    token_data_id_hash
    collection_data_id_hash
    from_address
    to_address
    transaction_version
    transaction_timestamp
    property_version
    transfer_type
    event_sequence_number
    token_amount
  }
}
    `,n_=class{constructor(e){this.endpoint=e}async queryIndexer(e){const{data:t}=await ds.post(this.endpoint,e);if(t.errors)throw new Error(`Indexer data error ${t.errors}`);return t.data}async getAccountNFTs(e,t){const n={query:_T,variables:{address:e,offset:t==null?void 0:t.offset,limit:t==null?void 0:t.limit}};return this.queryIndexer(n)}async getTokenActivities(e){const t={query:mT,variables:{idHash:e}};return this.queryIndexer(t)}},yT={};vu(yT,{$AccountData:()=>$T,$AccountSignature:()=>UT,$AccountSignature_Ed25519Signature:()=>qT,$AccountSignature_MultiEd25519Signature:()=>MT,$Address:()=>DT,$AptosError:()=>LT,$AptosErrorCode:()=>NT,$Block:()=>FT,$BlockMetadataTransaction:()=>jT,$DecodedTableData:()=>zT,$DeleteModule:()=>KT,$DeleteResource:()=>GT,$DeleteTableItem:()=>WT,$DeletedTableData:()=>HT,$DirectWriteSet:()=>XT,$Ed25519Signature:()=>VT,$EncodeSubmissionRequest:()=>JT,$EntryFunctionId:()=>ZT,$EntryFunctionPayload:()=>YT,$Event:()=>QT,$EventGuid:()=>tA,$GasEstimation:()=>eA,$GenesisPayload:()=>nA,$GenesisPayload_WriteSetPayload:()=>iA,$GenesisTransaction:()=>oA,$HashValue:()=>sA,$HealthCheckSuccess:()=>rA,$HexEncodedBytes:()=>aA,$IdentifierWrapper:()=>cA,$IndexResponse:()=>uA,$ModuleBundlePayload:()=>lA,$MoveAbility:()=>dA,$MoveFunction:()=>hA,$MoveFunctionGenericTypeParam:()=>fA,$MoveFunctionVisibility:()=>pA,$MoveModule:()=>gA,$MoveModuleBytecode:()=>_A,$MoveModuleId:()=>mA,$MoveResource:()=>yA,$MoveScriptBytecode:()=>wA,$MoveStruct:()=>bA,$MoveStructField:()=>vA,$MoveStructGenericTypeParam:()=>TA,$MoveStructTag:()=>AA,$MoveStructValue:()=>xA,$MoveType:()=>kA,$MoveValue:()=>SA,$MultiAgentSignature:()=>PA,$MultiEd25519Signature:()=>CA,$MultisigPayload:()=>BA,$MultisigTransactionPayload:()=>EA,$PendingTransaction:()=>IA,$RawTableItemRequest:()=>OA,$RoleType:()=>RA,$ScriptPayload:()=>$A,$ScriptWriteSet:()=>UA,$StateCheckpointTransaction:()=>qA,$StateKeyWrapper:()=>MA,$SubmitTransactionRequest:()=>DA,$TableItemRequest:()=>LA,$Transaction:()=>NA,$TransactionPayload:()=>GA,$TransactionPayload_EntryFunctionPayload:()=>WA,$TransactionPayload_ModuleBundlePayload:()=>XA,$TransactionPayload_MultisigPayload:()=>VA,$TransactionPayload_ScriptPayload:()=>JA,$TransactionSignature:()=>QA,$TransactionSignature_Ed25519Signature:()=>tx,$TransactionSignature_MultiAgentSignature:()=>ex,$TransactionSignature_MultiEd25519Signature:()=>nx,$Transaction_BlockMetadataTransaction:()=>FA,$Transaction_GenesisTransaction:()=>jA,$Transaction_PendingTransaction:()=>zA,$Transaction_StateCheckpointTransaction:()=>HA,$Transaction_UserTransaction:()=>KA,$TransactionsBatchSingleSubmissionFailure:()=>ZA,$TransactionsBatchSubmissionResult:()=>YA,$U128:()=>ix,$U256:()=>ox,$U64:()=>sx,$UserTransaction:()=>rx,$VersionedEvent:()=>ax,$ViewRequest:()=>cx,$WriteModule:()=>ux,$WriteResource:()=>lx,$WriteSet:()=>dx,$WriteSetChange:()=>px,$WriteSetChange_DeleteModule:()=>gx,$WriteSetChange_DeleteResource:()=>_x,$WriteSetChange_DeleteTableItem:()=>mx,$WriteSetChange_WriteModule:()=>yx,$WriteSetChange_WriteResource:()=>wx,$WriteSetChange_WriteTableItem:()=>bx,$WriteSetPayload:()=>vx,$WriteSet_DirectWriteSet:()=>hx,$WriteSet_ScriptWriteSet:()=>fx,$WriteTableItem:()=>Tx,AccountsService:()=>u_,ApiError:()=>ca,AptosErrorCode:()=>m_,AptosGeneratedClient:()=>__,BaseHttpRequest:()=>i_,BlocksService:()=>l_,CancelError:()=>o_,CancelablePromise:()=>s_,EventsService:()=>d_,GeneralService:()=>h_,MoveFunctionVisibility:()=>y_,OpenAPI:()=>RT,RoleType:()=>w_,TablesService:()=>f_,TransactionsService:()=>p_,ViewService:()=>g_});var i_=class{constructor(e){this.config=e}},ca=class extends Error{constructor(e,t,n){super(n),this.name="ApiError",this.url=t.url,this.status=t.status,this.statusText=t.statusText,this.body=t.body,this.request=e}},o_=class extends Error{constructor(e){super(e),this.name="CancelError"}get isCancelled(){return!0}},s_=class{constructor(e){this._isResolved=!1,this._isRejected=!1,this._isCancelled=!1,this._cancelHandlers=[],this._promise=new Promise((t,n)=>{this._resolve=t,this._reject=n;const i=r=>{var a;this._isResolved||this._isRejected||this._isCancelled||(this._isResolved=!0,(a=this._resolve)==null||a.call(this,r))},o=r=>{var a;this._isResolved||this._isRejected||this._isCancelled||(this._isRejected=!0,(a=this._reject)==null||a.call(this,r))},s=r=>{this._isResolved||this._isRejected||this._isCancelled||this._cancelHandlers.push(r)};return Object.defineProperty(s,"isResolved",{get:()=>this._isResolved}),Object.defineProperty(s,"isRejected",{get:()=>this._isRejected}),Object.defineProperty(s,"isCancelled",{get:()=>this._isCancelled}),e(i,o,s)})}then(e,t){return this._promise.then(e,t)}catch(e){return this._promise.catch(e)}finally(e){return this._promise.finally(e)}cancel(){var e;if(!(this._isResolved||this._isRejected||this._isCancelled)){if(this._isCancelled=!0,this._cancelHandlers.length)try{for(const t of this._cancelHandlers)t()}catch(t){console.warn("Cancellation threw an error",t);return}this._cancelHandlers.length=0,(e=this._reject)==null||e.call(this,new o_("Request aborted"))}}get isCancelled(){return this._isCancelled}},r_=class{constructor(e=new Map){this.jar=e}setCookie(e,t){var n;const i=e.origin.toLowerCase();this.jar.has(i)||this.jar.set(i,[]);const o=r_.parse(t);this.jar.set(i,[...((n=this.jar.get(i))==null?void 0:n.filter(s=>s.name!==o.name))||[],o])}getCookies(e){var t;const n=e.origin.toLowerCase();return this.jar.get(n)?((t=this.jar.get(n))==null?void 0:t.filter(i=>!i.expires||i.expires>new Date))||[]:[]}static parse(e){if(typeof e!="string")throw new Error("argument str must be a string");const t=e.split(";").map(i=>i.trim());let n;if(t.length>0){const[i,o]=t[0].split("=");if(!i||!o)throw new Error("Invalid cookie");n={name:i,value:o}}else throw new Error("Invalid cookie");return t.slice(1).forEach(i=>{const[o,s]=i.split("=");if(!o.trim())throw new Error("Invalid cookie");const r=o.toLowerCase(),a=(s==null?void 0:s.charAt(0))==="'"||(s==null?void 0:s.charAt(0))==='"'?s==null?void 0:s.slice(1,-1):s;if(r==="expires"&&(n.expires=new Date(a)),r==="path"&&(n.path=a),r==="samesite"){if(a!=="Lax"&&a!=="None"&&a!=="Strict")throw new Error("Invalid cookie SameSite value");n.sameSite=a}r==="secure"&&(n.secure=!0)}),n}},a_=new r_;ds.interceptors.response.use(e=>(Array.isArray(e.headers["set-cookie"])&&e.headers["set-cookie"].forEach(t=>{a_.setCookie(new URL(e.config.url),t)}),e));ds.interceptors.request.use(function(e){const t=a_.getCookies(new URL(e.url));return(t==null?void 0:t.length)>0&&e.headers&&(e.headers.cookie=t.map(n=>`${n.name}=${n.value}`).join("; ")),e});var Vd=e=>e!=null,Mu=e=>typeof e=="string",_l=e=>Mu(e)&&e!=="",c_=e=>typeof e=="object"&&typeof e.type=="string"&&typeof e.stream=="function"&&typeof e.arrayBuffer=="function"&&typeof e.constructor=="function"&&typeof e.constructor.name=="string"&&/^(Blob|File)$/.test(e.constructor.name)&&/^(Blob|File)$/.test(e[Symbol.toStringTag]),wT=e=>e instanceof Wg,bT=e=>e>=200&&e<300,vT=e=>btoa(e),TT=e=>{const t=[],n=(o,s)=>{t.push(`${encodeURIComponent(o)}=${encodeURIComponent(String(s))}`)},i=(o,s)=>{Vd(s)&&(Array.isArray(s)?s.forEach(r=>{i(o,r)}):typeof s=="object"?Object.entries(s).forEach(([r,a])=>{i(`${o}[${r}]`,a)}):n(o,s))};return Object.entries(e).forEach(([o,s])=>{i(o,s)}),t.length>0?`?${t.join("&")}`:""},AT=(e,t)=>{const n=e.ENCODE_PATH||encodeURI,i=t.url.replace("{api-version}",e.VERSION).replace(/{(.*?)}/g,(s,r)=>{var a;return(a=t.path)!=null&&a.hasOwnProperty(r)?n(String(t.path[r])):s}),o=`${e.BASE}${i}`;return t.query?`${o}${TT(t.query)}`:o},xT=e=>{if(e.formData){const t=new Wg,n=(i,o)=>{Mu(o)||c_(o)?t.append(i,o):t.append(i,JSON.stringify(o))};return Object.entries(e.formData).filter(([i,o])=>Vd(o)).forEach(([i,o])=>{Array.isArray(o)?o.forEach(s=>n(i,s)):n(i,o)}),t}},za=async(e,t)=>typeof t=="function"?t(e):t,kT=async(e,t,n)=>{const i=await za(t,e.TOKEN),o=await za(t,e.USERNAME),s=await za(t,e.PASSWORD),r=await za(t,e.HEADERS),a=typeof(n==null?void 0:n.getHeaders)=="function"&&(n==null?void 0:n.getHeaders())||{},c=Object.entries({Accept:"application/json",...r,...t.headers,...a}).filter(([u,l])=>Vd(l)).reduce((u,[l,d])=>({...u,[l]:String(d)}),{});if(_l(i)&&(c.Authorization=`Bearer ${i}`),_l(o)&&_l(s)){const u=vT(`${o}:${s}`);c.Authorization=`Basic ${u}`}return t.body&&(t.mediaType?c["Content-Type"]=t.mediaType:c_(t.body)?c["Content-Type"]=t.body.type||"application/octet-stream":Mu(t.body)?c["Content-Type"]="text/plain":wT(t.body)||(c["Content-Type"]="application/json")),c},ST=e=>{if(e.body)return e.body},PT=async(e,t,n,i,o,s,r)=>{const a=ds.CancelToken.source(),c={url:n,headers:s,data:i??o,method:t.method,withCredentials:e.WITH_CREDENTIALS,cancelToken:a.token};Object.keys(e.HEADERS||{}).filter(l=>l.toLowerCase()==="accept").map(l=>e.HEADERS[l]).includes("application/x-bcs")&&(c.responseType="arraybuffer"),r(()=>a.cancel("The user aborted a request."));try{return await ds.request(c)}catch(l){const d=l;if(d.response)return d.response;throw l}},CT=(e,t)=>{if(t){const n=e.headers[t];if(Mu(n))return n}},BT=e=>{if(e.status!==204)return e.data},ET=(e,t)=>{const i={400:"Bad Request",401:"Unauthorized",403:"Forbidden",404:"Not Found",429:"Too Many Requests",500:"Internal Server Error",502:"Bad Gateway",503:"Service Unavailable",...e.errors}[t.status];if(i)throw new ca(e,t,i);if(!t.ok)throw new ca(e,t,"Generic Error")},IT=(e,t)=>new s_(async(n,i,o)=>{try{const s=AT(e,t),r=xT(t),a=ST(t),c=await kT(e,t,r);if(!o.isCancelled){const u=await PT(e,t,s,a,r,c,o),l=BT(u),d=CT(u,t.responseHeader),h={url:s,ok:bT(u.status),status:u.status,statusText:u.statusText,body:d??l};ET(t,h);const g=h.body;try{g.__headers=u.headers}catch{}n(g)}}catch(s){i(s)}}),OT=class extends i_{constructor(e){super(e)}request(e){return IT(this.config,e)}},u_=class{constructor(e){this.httpRequest=e}getAccount(e,t){return this.httpRequest.request({method:"GET",url:"/accounts/{address}",path:{address:e},query:{ledger_version:t}})}getAccountResources(e,t,n,i){return this.httpRequest.request({method:"GET",url:"/accounts/{address}/resources",path:{address:e},query:{ledger_version:t,start:n,limit:i}})}getAccountModules(e,t,n,i){return this.httpRequest.request({method:"GET",url:"/accounts/{address}/modules",path:{address:e},query:{ledger_version:t,start:n,limit:i}})}getAccountResource(e,t,n){return this.httpRequest.request({method:"GET",url:"/accounts/{address}/resource/{resource_type}",path:{address:e,resource_type:t},query:{ledger_version:n}})}getAccountModule(e,t,n){return this.httpRequest.request({method:"GET",url:"/accounts/{address}/module/{module_name}",path:{address:e,module_name:t},query:{ledger_version:n}})}},l_=class{constructor(e){this.httpRequest=e}getBlockByHeight(e,t){return this.httpRequest.request({method:"GET",url:"/blocks/by_height/{block_height}",path:{block_height:e},query:{with_transactions:t}})}getBlockByVersion(e,t){return this.httpRequest.request({method:"GET",url:"/blocks/by_version/{version}",path:{version:e},query:{with_transactions:t}})}},d_=class{constructor(e){this.httpRequest=e}getEventsByCreationNumber(e,t,n,i){return this.httpRequest.request({method:"GET",url:"/accounts/{address}/events/{creation_number}",path:{address:e,creation_number:t},query:{start:n,limit:i}})}getEventsByEventHandle(e,t,n,i,o){return this.httpRequest.request({method:"GET",url:"/accounts/{address}/events/{event_handle}/{field_name}",path:{address:e,event_handle:t,field_name:n},query:{start:i,limit:o}})}},h_=class{constructor(e){this.httpRequest=e}spec(){return this.httpRequest.request({method:"GET",url:"/spec"})}healthy(e){return this.httpRequest.request({method:"GET",url:"/-/healthy",query:{duration_secs:e}})}getLedgerInfo(){return this.httpRequest.request({method:"GET",url:"/"})}},f_=class{constructor(e){this.httpRequest=e}getTableItem(e,t,n){return this.httpRequest.request({method:"POST",url:"/tables/{table_handle}/item",path:{table_handle:e},query:{ledger_version:n},body:t,mediaType:"application/json"})}getRawTableItem(e,t,n){return this.httpRequest.request({method:"POST",url:"/tables/{table_handle}/raw_item",path:{table_handle:e},query:{ledger_version:n},body:t,mediaType:"application/json"})}},p_=class{constructor(e){this.httpRequest=e}getTransactions(e,t){return this.httpRequest.request({method:"GET",url:"/transactions",query:{start:e,limit:t}})}submitTransaction(e){return this.httpRequest.request({method:"POST",url:"/transactions",body:e,mediaType:"application/json"})}getTransactionByHash(e){return this.httpRequest.request({method:"GET",url:"/transactions/by_hash/{txn_hash}",path:{txn_hash:e}})}getTransactionByVersion(e){return this.httpRequest.request({method:"GET",url:"/transactions/by_version/{txn_version}",path:{txn_version:e}})}getAccountTransactions(e,t,n){return this.httpRequest.request({method:"GET",url:"/accounts/{address}/transactions",path:{address:e},query:{start:t,limit:n}})}submitBatchTransactions(e){return this.httpRequest.request({method:"POST",url:"/transactions/batch",body:e,mediaType:"application/json"})}simulateTransaction(e,t,n,i){return this.httpRequest.request({method:"POST",url:"/transactions/simulate",query:{estimate_max_gas_amount:t,estimate_gas_unit_price:n,estimate_prioritized_gas_unit_price:i},body:e,mediaType:"application/json"})}encodeSubmission(e){return this.httpRequest.request({method:"POST",url:"/transactions/encode_submission",body:e,mediaType:"application/json"})}estimateGasPrice(){return this.httpRequest.request({method:"GET",url:"/estimate_gas_price"})}},g_=class{constructor(e){this.httpRequest=e}view(e,t){return this.httpRequest.request({method:"POST",url:"/view",query:{ledger_version:t},body:e,mediaType:"application/json"})}},__=class{constructor(e,t=OT){var n,i,o,s;this.request=new t({BASE:(n=e==null?void 0:e.BASE)!=null?n:"/v1",VERSION:(i=e==null?void 0:e.VERSION)!=null?i:"1.2.0",WITH_CREDENTIALS:(o=e==null?void 0:e.WITH_CREDENTIALS)!=null?o:!1,CREDENTIALS:(s=e==null?void 0:e.CREDENTIALS)!=null?s:"include",TOKEN:e==null?void 0:e.TOKEN,USERNAME:e==null?void 0:e.USERNAME,PASSWORD:e==null?void 0:e.PASSWORD,HEADERS:e==null?void 0:e.HEADERS,ENCODE_PATH:e==null?void 0:e.ENCODE_PATH}),this.accounts=new u_(this.request),this.blocks=new l_(this.request),this.events=new d_(this.request),this.general=new h_(this.request),this.tables=new f_(this.request),this.transactions=new p_(this.request),this.view=new g_(this.request)}},RT={BASE:"/v1",VERSION:"1.2.0",WITH_CREDENTIALS:!1,CREDENTIALS:"include",TOKEN:void 0,USERNAME:void 0,PASSWORD:void 0,HEADERS:void 0,ENCODE_PATH:void 0},m_=(e=>(e.ACCOUNT_NOT_FOUND="account_not_found",e.RESOURCE_NOT_FOUND="resource_not_found",e.MODULE_NOT_FOUND="module_not_found",e.STRUCT_FIELD_NOT_FOUND="struct_field_not_found",e.VERSION_NOT_FOUND="version_not_found",e.TRANSACTION_NOT_FOUND="transaction_not_found",e.TABLE_ITEM_NOT_FOUND="table_item_not_found",e.BLOCK_NOT_FOUND="block_not_found",e.VERSION_PRUNED="version_pruned",e.BLOCK_PRUNED="block_pruned",e.INVALID_INPUT="invalid_input",e.INVALID_TRANSACTION_UPDATE="invalid_transaction_update",e.SEQUENCE_NUMBER_TOO_OLD="sequence_number_too_old",e.VM_ERROR="vm_error",e.HEALTH_CHECK_FAILED="health_check_failed",e.MEMPOOL_IS_FULL="mempool_is_full",e.INTERNAL_ERROR="internal_error",e.WEB_FRAMEWORK_ERROR="web_framework_error",e.BCS_NOT_SUPPORTED="bcs_not_supported",e.API_DISABLED="api_disabled",e))(m_||{}),y_=(e=>(e.PRIVATE="private",e.PUBLIC="public",e.FRIEND="friend",e))(y_||{}),w_=(e=>(e.VALIDATOR="validator",e.FULL_NODE="full_node",e))(w_||{}),$T={description:`Account data

    A simplified version of the onchain Account resource`,properties:{sequence_number:{type:"U64",isRequired:!0},authentication_key:{type:"HexEncodedBytes",isRequired:!0}}},UT={type:"one-of",description:`Account signature scheme

    The account signature scheme allows you to have two types of accounts:

    1. A single Ed25519 key account, one private key
    2. A k-of-n multi-Ed25519 key account, multiple private keys, such that k-of-n must sign a transaction.`,contains:[{type:"AccountSignature_Ed25519Signature"},{type:"AccountSignature_MultiEd25519Signature"}]},qT={type:"all-of",contains:[{properties:{type:{type:"string",isRequired:!0}}},{type:"Ed25519Signature"}]},MT={type:"all-of",contains:[{properties:{type:{type:"string",isRequired:!0}}},{type:"MultiEd25519Signature"}]},DT={type:"string",description:`A hex encoded 32 byte Aptos account address.

    This is represented in a string as a 64 character hex string, sometimes
    shortened by stripping leading 0s, and adding a 0x.

    For example, address 0x0000000000000000000000000000000000000000000000000000000000000001 is represented as 0x1.
    `,format:"hex"},LT={description:`This is the generic struct we use for all API errors, it contains a string
    message and an Aptos API specific error code.`,properties:{message:{type:"string",description:"A message describing the error",isRequired:!0},error_code:{type:"AptosErrorCode",isRequired:!0},vm_error_code:{type:"number",description:"A code providing VM error details when submitting transactions to the VM",format:"uint64"}}},NT={type:"Enum"},FT={description:`A Block with or without transactions

    This contains the information about a transactions along with
    associated transactions if requested`,properties:{block_height:{type:"U64",isRequired:!0},block_hash:{type:"HashValue",isRequired:!0},block_timestamp:{type:"U64",isRequired:!0},first_version:{type:"U64",isRequired:!0},last_version:{type:"U64",isRequired:!0},transactions:{type:"array",contains:{type:"Transaction"}}}},jT={description:`A block metadata transaction

    This signifies the beginning of a block, and contains information
    about the specific block`,properties:{version:{type:"U64",isRequired:!0},hash:{type:"HashValue",isRequired:!0},state_change_hash:{type:"HashValue",isRequired:!0},event_root_hash:{type:"HashValue",isRequired:!0},state_checkpoint_hash:{type:"HashValue"},gas_used:{type:"U64",isRequired:!0},success:{type:"boolean",description:"Whether the transaction was successful",isRequired:!0},vm_status:{type:"string",description:"The VM status of the transaction, can tell useful information in a failure",isRequired:!0},accumulator_root_hash:{type:"HashValue",isRequired:!0},changes:{type:"array",contains:{type:"WriteSetChange"},isRequired:!0},id:{type:"HashValue",isRequired:!0},epoch:{type:"U64",isRequired:!0},round:{type:"U64",isRequired:!0},events:{type:"array",contains:{type:"Event"},isRequired:!0},previous_block_votes_bitvec:{type:"array",contains:{type:"number",format:"uint8"},isRequired:!0},proposer:{type:"Address",isRequired:!0},failed_proposer_indices:{type:"array",contains:{type:"number",format:"uint32"},isRequired:!0},timestamp:{type:"U64",isRequired:!0}}},zT={description:"Decoded table data",properties:{key:{description:"Key of table in JSON",properties:{},isRequired:!0},key_type:{type:"string",description:"Type of key",isRequired:!0},value:{description:"Value of table in JSON",properties:{},isRequired:!0},value_type:{type:"string",description:"Type of value",isRequired:!0}}},HT={description:"Deleted table data",properties:{key:{description:"Deleted key",properties:{},isRequired:!0},key_type:{type:"string",description:"Deleted key type",isRequired:!0}}},KT={description:"Delete a module",properties:{address:{type:"Address",isRequired:!0},state_key_hash:{type:"string",description:"State key hash",isRequired:!0},module:{type:"MoveModuleId",isRequired:!0}}},GT={description:"Delete a resource",properties:{address:{type:"Address",isRequired:!0},state_key_hash:{type:"string",description:"State key hash",isRequired:!0},resource:{type:"MoveStructTag",isRequired:!0}}},WT={description:"Delete a table item",properties:{state_key_hash:{type:"string",isRequired:!0},handle:{type:"HexEncodedBytes",isRequired:!0},key:{type:"HexEncodedBytes",isRequired:!0},data:{type:"DeletedTableData"}}},XT={properties:{changes:{type:"array",contains:{type:"WriteSetChange"},isRequired:!0},events:{type:"array",contains:{type:"Event"},isRequired:!0}}},VT={description:"A single Ed25519 signature",properties:{public_key:{type:"HexEncodedBytes",isRequired:!0},signature:{type:"HexEncodedBytes",isRequired:!0}}},JT={description:"Request to encode a submission",properties:{sender:{type:"Address",isRequired:!0},sequence_number:{type:"U64",isRequired:!0},max_gas_amount:{type:"U64",isRequired:!0},gas_unit_price:{type:"U64",isRequired:!0},expiration_timestamp_secs:{type:"U64",isRequired:!0},payload:{type:"TransactionPayload",isRequired:!0},secondary_signers:{type:"array",contains:{type:"Address"}}}},ZT={type:"string",description:"Entry function id is string representation of a entry function defined on-chain.\n\n    Format: `{address}::{module name}::{function name}`\n\n    Both `module name` and `function name` are case-sensitive.\n    "},YT={description:"Payload which runs a single entry function",properties:{function:{type:"EntryFunctionId",isRequired:!0},type_arguments:{type:"array",contains:{type:"MoveType"},isRequired:!0},arguments:{type:"array",contains:{properties:{}},isRequired:!0}}},QT={description:"An event from a transaction",properties:{guid:{type:"EventGuid",isRequired:!0},sequence_number:{type:"U64",isRequired:!0},type:{type:"MoveType",isRequired:!0},data:{description:"The JSON representation of the event",properties:{},isRequired:!0}}},tA={properties:{creation_number:{type:"U64",isRequired:!0},account_address:{type:"Address",isRequired:!0}}},eA={description:"Struct holding the outputs of the estimate gas API",properties:{deprioritized_gas_estimate:{type:"number",description:"The deprioritized estimate for the gas unit price",format:"uint64"},gas_estimate:{type:"number",description:"The current estimate for the gas unit price",isRequired:!0,format:"uint64"},prioritized_gas_estimate:{type:"number",description:"The prioritized estimate for the gas unit price",format:"uint64"}}},nA={type:"one-of",description:"The writeset payload of the Genesis transaction",contains:[{type:"GenesisPayload_WriteSetPayload"}]},iA={type:"all-of",contains:[{properties:{type:{type:"string",isRequired:!0}}},{type:"WriteSetPayload"}]},oA={description:`The genesis transaction

    This only occurs at the genesis transaction (version 0)`,properties:{version:{type:"U64",isRequired:!0},hash:{type:"HashValue",isRequired:!0},state_change_hash:{type:"HashValue",isRequired:!0},event_root_hash:{type:"HashValue",isRequired:!0},state_checkpoint_hash:{type:"HashValue"},gas_used:{type:"U64",isRequired:!0},success:{type:"boolean",description:"Whether the transaction was successful",isRequired:!0},vm_status:{type:"string",description:"The VM status of the transaction, can tell useful information in a failure",isRequired:!0},accumulator_root_hash:{type:"HashValue",isRequired:!0},changes:{type:"array",contains:{type:"WriteSetChange"},isRequired:!0},payload:{type:"GenesisPayload",isRequired:!0},events:{type:"array",contains:{type:"Event"},isRequired:!0}}},sA={type:"string"},rA={description:"Representation of a successful healthcheck",properties:{message:{type:"string",isRequired:!0}}},aA={type:"string",description:"All bytes (Vec<u8>) data is represented as hex-encoded string prefixed with `0x` and fulfilled with\n    two hex digits per byte.\n\n    Unlike the `Address` type, HexEncodedBytes will not trim any zeros.\n    ",format:"hex"},cA={type:"string"},uA={description:`The struct holding all data returned to the client by the
    index endpoint (i.e., GET "/").  Only for responding in JSON`,properties:{chain_id:{type:"number",description:"Chain ID of the current chain",isRequired:!0,format:"uint8"},epoch:{type:"U64",isRequired:!0},ledger_version:{type:"U64",isRequired:!0},oldest_ledger_version:{type:"U64",isRequired:!0},ledger_timestamp:{type:"U64",isRequired:!0},node_role:{type:"RoleType",isRequired:!0},oldest_block_height:{type:"U64",isRequired:!0},block_height:{type:"U64",isRequired:!0},git_hash:{type:"string",description:`Git hash of the build of the API endpoint.  Can be used to determine the exact
            software version used by the API endpoint.`}}},lA={properties:{modules:{type:"array",contains:{type:"MoveModuleBytecode"},isRequired:!0}}},dA={type:"string"},hA={description:"Move function",properties:{name:{type:"IdentifierWrapper",isRequired:!0},visibility:{type:"MoveFunctionVisibility",isRequired:!0},is_entry:{type:"boolean",description:"Whether the function can be called as an entry function directly in a transaction",isRequired:!0},generic_type_params:{type:"array",contains:{type:"MoveFunctionGenericTypeParam"},isRequired:!0},params:{type:"array",contains:{type:"MoveType"},isRequired:!0},return:{type:"array",contains:{type:"MoveType"},isRequired:!0}}},fA={description:"Move function generic type param",properties:{constraints:{type:"array",contains:{type:"MoveAbility"},isRequired:!0}}},pA={type:"Enum"},gA={description:"A Move module",properties:{address:{type:"Address",isRequired:!0},name:{type:"IdentifierWrapper",isRequired:!0},friends:{type:"array",contains:{type:"MoveModuleId"},isRequired:!0},exposed_functions:{type:"array",contains:{type:"MoveFunction"},isRequired:!0},structs:{type:"array",contains:{type:"MoveStruct"},isRequired:!0}}},_A={description:"Move module bytecode along with it's ABI",properties:{bytecode:{type:"HexEncodedBytes",isRequired:!0},abi:{type:"MoveModule"}}},mA={type:"string",description:`Move module id is a string representation of Move module.

    Format: \`{address}::{module name}\`

    \`address\` should be hex-encoded 32 byte account address that is prefixed with \`0x\`.

    Module name is case-sensitive.
    `},yA={description:"A parsed Move resource",properties:{type:{type:"MoveStructTag",isRequired:!0},data:{type:"MoveStructValue",isRequired:!0}}},wA={description:"Move script bytecode",properties:{bytecode:{type:"HexEncodedBytes",isRequired:!0},abi:{type:"MoveFunction"}}},bA={description:"A move struct",properties:{name:{type:"IdentifierWrapper",isRequired:!0},is_native:{type:"boolean",description:"Whether the struct is a native struct of Move",isRequired:!0},abilities:{type:"array",contains:{type:"MoveAbility"},isRequired:!0},generic_type_params:{type:"array",contains:{type:"MoveStructGenericTypeParam"},isRequired:!0},fields:{type:"array",contains:{type:"MoveStructField"},isRequired:!0}}},vA={description:"Move struct field",properties:{name:{type:"IdentifierWrapper",isRequired:!0},type:{type:"MoveType",isRequired:!0}}},TA={description:"Move generic type param",properties:{constraints:{type:"array",contains:{type:"MoveAbility"},isRequired:!0}}},AA={type:"string",description:"String representation of a MoveStructTag (on-chain Move struct type). This exists so you\n    can specify MoveStructTags as path / query parameters, e.g. for get_events_by_event_handle.\n\n    It is a combination of:\n    1. `move_module_address`, `module_name` and `struct_name`, all joined by `::`\n    2. `struct generic type parameters` joined by `, `\n\n    Examples:\n     * `0x1::coin::CoinStore<0x1::aptos_coin::AptosCoin>`\n     * `0x1::account::Account`\n\n    Note:\n    1. Empty chars should be ignored when comparing 2 struct tag ids.\n    2. When used in an URL path, should be encoded by url-encoding (AKA percent-encoding).\n\n    See [doc](https://aptos.dev/concepts/accounts) for more details.\n    ",pattern:"^0x[0-9a-zA-Z:_<>]+$"},xA={description:'This is a JSON representation of some data within an account resource. More specifically,\n    it is a map of strings to arbitrary JSON values / objects, where the keys are top level\n    fields within the given resource.\n\n    To clarify, you might query for 0x1::account::Account and see the example data.\n\n    Move `bool` type value is serialized into `boolean`.\n\n    Move `u8`, `u16` and `u32` type value is serialized into `integer`.\n\n    Move `u64`, `u128` and `u256` type value is serialized into `string`.\n\n    Move `address` type value (32 byte Aptos account address) is serialized into a HexEncodedBytes string.\n    For example:\n    - `0x1`\n    - `0x1668f6be25668c1a17cd8caf6b8d2f25`\n\n    Move `vector` type value is serialized into `array`, except `vector<u8>` which is serialized into a\n    HexEncodedBytes string with `0x` prefix.\n    For example:\n    - `vector<u64>{255, 255}` => `["255", "255"]`\n    - `vector<u8>{255, 255}` => `0xffff`\n\n    Move `struct` type value is serialized into `object` that looks like this (except some Move stdlib types, see the following section):\n    ```json\n    {\n        field1_name: field1_value,\n        field2_name: field2_value,\n        ......\n    }\n    ```\n\n    For example:\n    `{ "created": "0xa550c18", "role_id": "0" }`\n\n     **Special serialization for Move stdlib types**:\n    - [0x1::string::String](https://github.com/aptos-labs/aptos-core/blob/main/language/move-stdlib/docs/ascii.md)\n    is serialized into `string`. For example, struct value `0x1::string::String{bytes: b"Hello World!"}`\n    is serialized as `"Hello World!"` in JSON.\n    ',properties:{}},kA={type:"string",description:`String representation of an on-chain Move type tag that is exposed in transaction payload.
    Values:
    - bool
    - u8
    - u16
    - u32
    - u64
    - u128
    - u256
    - address
    - signer
    - vector: \`vector<{non-reference MoveTypeId}>\`
    - struct: \`{address}::{module_name}::{struct_name}::<{generic types}>\`

    Vector type value examples:
    - \`vector<u8>\`
    - \`vector<vector<u64>>\`
    - \`vector<0x1::coin::CoinStore<0x1::aptos_coin::AptosCoin>>\`

    Struct type value examples:
    - \`0x1::coin::CoinStore<0x1::aptos_coin::AptosCoin>
    - \`0x1::account::Account\`

    Note:
    1. Empty chars should be ignored when comparing 2 struct tag ids.
    2. When used in an URL path, should be encoded by url-encoding (AKA percent-encoding).
    `,pattern:"^(bool|u8|u64|u128|address|signer|vector<.+>|0x[0-9a-zA-Z:_<, >]+)$"},SA={type:"any-of",description:"An enum of the possible Move value types",contains:[{type:"number",format:"uint8"},{type:"number",format:"uint16"},{type:"number",format:"uint32"},{type:"U64"},{type:"U128"},{type:"U256"},{type:"boolean"},{type:"Address"},{type:"array",contains:{type:"MoveValue"}},{type:"HexEncodedBytes"},{type:"MoveStructValue"},{type:"string"}]},PA={description:`Multi agent signature for multi agent transactions

    This allows you to have transactions across multiple accounts`,properties:{sender:{type:"AccountSignature",isRequired:!0},secondary_signer_addresses:{type:"array",contains:{type:"Address"},isRequired:!0},secondary_signers:{type:"array",contains:{type:"AccountSignature"},isRequired:!0}}},CA={description:`A Ed25519 multi-sig signature

    This allows k-of-n signing for a transaction`,properties:{public_keys:{type:"array",contains:{type:"HexEncodedBytes"},isRequired:!0},signatures:{type:"array",contains:{type:"HexEncodedBytes"},isRequired:!0},threshold:{type:"number",description:"The number of signatures required for a successful transaction",isRequired:!0,format:"uint8"},bitmap:{type:"HexEncodedBytes",isRequired:!0}}},BA={description:`A multisig transaction that allows an owner of a multisig account to execute a pre-approved
    transaction as the multisig account.`,properties:{multisig_address:{type:"Address",isRequired:!0},transaction_payload:{type:"MultisigTransactionPayload"}}},EA={type:"any-of",contains:[{type:"EntryFunctionPayload"}]},IA={description:"A transaction waiting in mempool",properties:{hash:{type:"HashValue",isRequired:!0},sender:{type:"Address",isRequired:!0},sequence_number:{type:"U64",isRequired:!0},max_gas_amount:{type:"U64",isRequired:!0},gas_unit_price:{type:"U64",isRequired:!0},expiration_timestamp_secs:{type:"U64",isRequired:!0},payload:{type:"TransactionPayload",isRequired:!0},signature:{type:"TransactionSignature"}}},OA={description:"Table Item request for the GetTableItemRaw API",properties:{key:{type:"HexEncodedBytes",isRequired:!0}}},RA={type:"Enum"},$A={description:"Payload which runs a script that can run multiple functions",properties:{code:{type:"MoveScriptBytecode",isRequired:!0},type_arguments:{type:"array",contains:{type:"MoveType"},isRequired:!0},arguments:{type:"array",contains:{properties:{}},isRequired:!0}}},UA={properties:{execute_as:{type:"Address",isRequired:!0},script:{type:"ScriptPayload",isRequired:!0}}},qA={description:"A state checkpoint transaction",properties:{version:{type:"U64",isRequired:!0},hash:{type:"HashValue",isRequired:!0},state_change_hash:{type:"HashValue",isRequired:!0},event_root_hash:{type:"HashValue",isRequired:!0},state_checkpoint_hash:{type:"HashValue"},gas_used:{type:"U64",isRequired:!0},success:{type:"boolean",description:"Whether the transaction was successful",isRequired:!0},vm_status:{type:"string",description:"The VM status of the transaction, can tell useful information in a failure",isRequired:!0},accumulator_root_hash:{type:"HashValue",isRequired:!0},changes:{type:"array",contains:{type:"WriteSetChange"},isRequired:!0},timestamp:{type:"U64",isRequired:!0}}},MA={type:"string",description:`Representation of a StateKey as a hex string. This is used for cursor based pagination.
    `},DA={description:`A request to submit a transaction

    This requires a transaction and a signature of it`,properties:{sender:{type:"Address",isRequired:!0},sequence_number:{type:"U64",isRequired:!0},max_gas_amount:{type:"U64",isRequired:!0},gas_unit_price:{type:"U64",isRequired:!0},expiration_timestamp_secs:{type:"U64",isRequired:!0},payload:{type:"TransactionPayload",isRequired:!0},signature:{type:"TransactionSignature",isRequired:!0}}},LA={description:"Table Item request for the GetTableItem API",properties:{key_type:{type:"MoveType",isRequired:!0},value_type:{type:"MoveType",isRequired:!0},key:{description:"The value of the table item's key",properties:{},isRequired:!0}}},NA={type:"one-of",description:"Enum of the different types of transactions in Aptos",contains:[{type:"Transaction_PendingTransaction"},{type:"Transaction_UserTransaction"},{type:"Transaction_GenesisTransaction"},{type:"Transaction_BlockMetadataTransaction"},{type:"Transaction_StateCheckpointTransaction"}]},FA={type:"all-of",contains:[{properties:{type:{type:"string",isRequired:!0}}},{type:"BlockMetadataTransaction"}]},jA={type:"all-of",contains:[{properties:{type:{type:"string",isRequired:!0}}},{type:"GenesisTransaction"}]},zA={type:"all-of",contains:[{properties:{type:{type:"string",isRequired:!0}}},{type:"PendingTransaction"}]},HA={type:"all-of",contains:[{properties:{type:{type:"string",isRequired:!0}}},{type:"StateCheckpointTransaction"}]},KA={type:"all-of",contains:[{properties:{type:{type:"string",isRequired:!0}}},{type:"UserTransaction"}]},GA={type:"one-of",description:"An enum of the possible transaction payloads",contains:[{type:"TransactionPayload_EntryFunctionPayload"},{type:"TransactionPayload_ScriptPayload"},{type:"TransactionPayload_ModuleBundlePayload"},{type:"TransactionPayload_MultisigPayload"}]},WA={type:"all-of",contains:[{properties:{type:{type:"string",isRequired:!0}}},{type:"EntryFunctionPayload"}]},XA={type:"all-of",contains:[{properties:{type:{type:"string",isRequired:!0}}},{type:"ModuleBundlePayload"}]},VA={type:"all-of",contains:[{properties:{type:{type:"string",isRequired:!0}}},{type:"MultisigPayload"}]},JA={type:"all-of",contains:[{properties:{type:{type:"string",isRequired:!0}}},{type:"ScriptPayload"}]},ZA={description:"Information telling which batch submission transactions failed",properties:{error:{type:"AptosError",isRequired:!0},transaction_index:{type:"number",description:"The index of which transaction failed, same as submission order",isRequired:!0,format:"uint64"}}},YA={description:`Batch transaction submission result

    Tells which transactions failed`,properties:{transaction_failures:{type:"array",contains:{type:"TransactionsBatchSingleSubmissionFailure"},isRequired:!0}}},QA={type:"one-of",description:"An enum representing the different transaction signatures available",contains:[{type:"TransactionSignature_Ed25519Signature"},{type:"TransactionSignature_MultiEd25519Signature"},{type:"TransactionSignature_MultiAgentSignature"}]},tx={type:"all-of",contains:[{properties:{type:{type:"string",isRequired:!0}}},{type:"Ed25519Signature"}]},ex={type:"all-of",contains:[{properties:{type:{type:"string",isRequired:!0}}},{type:"MultiAgentSignature"}]},nx={type:"all-of",contains:[{properties:{type:{type:"string",isRequired:!0}}},{type:"MultiEd25519Signature"}]},ix={type:"string",description:`A string containing a 128-bit unsigned integer.

    We represent u128 values as a string to ensure compatibility with languages such
    as JavaScript that do not parse u128s in JSON natively.
    `,format:"uint128"},ox={type:"string",description:`A string containing a 256-bit unsigned integer.

    We represent u256 values as a string to ensure compatibility with languages such
    as JavaScript that do not parse u256s in JSON natively.
    `,format:"uint256"},sx={type:"string",description:`A string containing a 64-bit unsigned integer.

    We represent u64 values as a string to ensure compatibility with languages such
    as JavaScript that do not parse u64s in JSON natively.
    `,format:"uint64"},rx={description:"A transaction submitted by a user to change the state of the blockchain",properties:{version:{type:"U64",isRequired:!0},hash:{type:"HashValue",isRequired:!0},state_change_hash:{type:"HashValue",isRequired:!0},event_root_hash:{type:"HashValue",isRequired:!0},state_checkpoint_hash:{type:"HashValue"},gas_used:{type:"U64",isRequired:!0},success:{type:"boolean",description:"Whether the transaction was successful",isRequired:!0},vm_status:{type:"string",description:"The VM status of the transaction, can tell useful information in a failure",isRequired:!0},accumulator_root_hash:{type:"HashValue",isRequired:!0},changes:{type:"array",contains:{type:"WriteSetChange"},isRequired:!0},sender:{type:"Address",isRequired:!0},sequence_number:{type:"U64",isRequired:!0},max_gas_amount:{type:"U64",isRequired:!0},gas_unit_price:{type:"U64",isRequired:!0},expiration_timestamp_secs:{type:"U64",isRequired:!0},payload:{type:"TransactionPayload",isRequired:!0},signature:{type:"TransactionSignature"},events:{type:"array",contains:{type:"Event"},isRequired:!0},timestamp:{type:"U64",isRequired:!0}}},ax={description:"An event from a transaction with a version",properties:{version:{type:"U64",isRequired:!0},guid:{type:"EventGuid",isRequired:!0},sequence_number:{type:"U64",isRequired:!0},type:{type:"MoveType",isRequired:!0},data:{description:"The JSON representation of the event",properties:{},isRequired:!0}}},cx={description:"View request for the Move View Function API",properties:{function:{type:"EntryFunctionId",isRequired:!0},type_arguments:{type:"array",contains:{type:"MoveType"},isRequired:!0},arguments:{type:"array",contains:{properties:{}},isRequired:!0}}},ux={description:"Write a new module or update an existing one",properties:{address:{type:"Address",isRequired:!0},state_key_hash:{type:"string",description:"State key hash",isRequired:!0},data:{type:"MoveModuleBytecode",isRequired:!0}}},lx={description:"Write a resource or update an existing one",properties:{address:{type:"Address",isRequired:!0},state_key_hash:{type:"string",description:"State key hash",isRequired:!0},data:{type:"MoveResource",isRequired:!0}}},dx={type:"one-of",description:"The associated writeset with a payload",contains:[{type:"WriteSet_ScriptWriteSet"},{type:"WriteSet_DirectWriteSet"}]},hx={type:"all-of",contains:[{properties:{type:{type:"string",isRequired:!0}}},{type:"DirectWriteSet"}]},fx={type:"all-of",contains:[{properties:{type:{type:"string",isRequired:!0}}},{type:"ScriptWriteSet"}]},px={type:"one-of",description:"A final state change of a transaction on a resource or module",contains:[{type:"WriteSetChange_DeleteModule"},{type:"WriteSetChange_DeleteResource"},{type:"WriteSetChange_DeleteTableItem"},{type:"WriteSetChange_WriteModule"},{type:"WriteSetChange_WriteResource"},{type:"WriteSetChange_WriteTableItem"}]},gx={type:"all-of",contains:[{properties:{type:{type:"string",isRequired:!0}}},{type:"DeleteModule"}]},_x={type:"all-of",contains:[{properties:{type:{type:"string",isRequired:!0}}},{type:"DeleteResource"}]},mx={type:"all-of",contains:[{properties:{type:{type:"string",isRequired:!0}}},{type:"DeleteTableItem"}]},yx={type:"all-of",contains:[{properties:{type:{type:"string",isRequired:!0}}},{type:"WriteModule"}]},wx={type:"all-of",contains:[{properties:{type:{type:"string",isRequired:!0}}},{type:"WriteResource"}]},bx={type:"all-of",contains:[{properties:{type:{type:"string",isRequired:!0}}},{type:"WriteTableItem"}]},vx={description:"A writeset payload, used only for genesis",properties:{write_set:{type:"WriteSet",isRequired:!0}}},Tx={description:"Change set to write a table item",properties:{state_key_hash:{type:"string",isRequired:!0},handle:{type:"HexEncodedBytes",isRequired:!0},key:{type:"HexEncodedBytes",isRequired:!0},value:{type:"HexEncodedBytes",isRequired:!0},data:{type:"DecodedTableData"}}},Ax=new _r(Sn.fromHex("0x1"),new di("string"),new di("String"),[]);function Du(e,t,n){if(!(t!=null&&t.includes(typeof e)))throw new Error(n||`Invalid arg: ${e} type should be ${t instanceof Array?t.join(" or "):t}`)}function Yo(e){throw new Error(e)}function jh(e){return!!e.match(/\s/)}function zh(e){return!!e.match(/[_A-Za-z0-9]/g)}function xx(e,t){const n=e[t];if(n===":"){if(e.slice(t,t+2)==="::")return[["COLON","::"],2];Yo("Unrecognized token.")}else{if(n==="<")return[["LT","<"],1];if(n===">")return[["GT",">"],1];if(n===",")return[["COMMA",","],1];if(jh(n)){let i="";for(let o=t;o<e.length;o+=1){const s=e[o];if(jh(s))i=`${i}${s}`;else break}return[["SPACE",i],i.length]}else if(zh(n)){let i="";for(let o=t;o<e.length;o+=1){const s=e[o];if(zh(s))i=`${i}${s}`;else break}return[["IDENT",i],i.length]}}throw new Error("Unrecognized token.")}function kx(e){let t=0;const n=[];for(;t<e.length;){const[i,o]=xx(e,t);i[0]!=="SPACE"&&n.push(i),t+=o}return n}var Lu=class{constructor(e){this.tokens=kx(e)}consume(e){const t=this.tokens.shift();(!t||t[1]!==e)&&Yo("Invalid type tag.")}parseCommaList(e,t){const n=[];for(this.tokens.length<=0&&Yo("Invalid type tag.");this.tokens[0][1]!==e&&(n.push(this.parseTypeTag()),!(this.tokens.length>0&&this.tokens[0][1]===e||(this.consume(","),this.tokens.length>0&&this.tokens[0][1]===e&&t)));)this.tokens.length<=0&&Yo("Invalid type tag.");return n}parseTypeTag(){this.tokens.length===0&&Yo("Invalid type tag.");const[e,t]=this.tokens.shift();if(t==="u8")return new po;if(t==="u16")return new Ir;if(t==="u32")return new Or;if(t==="u64")return new Cs;if(t==="u128")return new Bs;if(t==="u256")return new Rr;if(t==="bool")return new Ps;if(t==="address")return new Es;if(t==="vector"){this.consume("<");const n=this.parseTypeTag();return this.consume(">"),new $r(n)}if(e==="IDENT"&&(t.startsWith("0x")||t.startsWith("0X"))){const n=t;this.consume("::");const[i,o]=this.tokens.shift();i!=="IDENT"&&Yo("Invalid type tag."),this.consume("::");const[s,r]=this.tokens.shift();s!=="IDENT"&&Yo("Invalid type tag.");let a=[];this.tokens.length>0&&this.tokens[0][1]==="<"&&(this.consume("<"),a=this.parseCommaList(">",!0),this.consume(">"));const c=new _r(Sn.fromHex(n),new di(o),new di(r),a);return new Is(c)}throw new Error("Invalid type tag.")}};function b_(e){if(Du(e,["boolean","string"]),typeof e=="boolean")return e;if(e==="true")return!0;if(e==="false")return!1;throw new Error("Invalid boolean string.")}function nr(e){if(Du(e,["number","string"]),typeof e=="number")return e;const t=Number.parseInt(e,10);if(Number.isNaN(t))throw new Error("Invalid number string.");return t}function ir(e){return Du(e,["number","bigint","string"]),BigInt(e)}function Jd(e,t,n){if(t instanceof Ps){n.serializeBool(b_(e));return}if(t instanceof po){n.serializeU8(nr(e));return}if(t instanceof Ir){n.serializeU16(nr(e));return}if(t instanceof Or){n.serializeU32(nr(e));return}if(t instanceof Cs){n.serializeU64(ir(e));return}if(t instanceof Bs){n.serializeU128(ir(e));return}if(t instanceof Rr){n.serializeU256(ir(e));return}if(t instanceof Es){let i;if(typeof e=="string"||e instanceof Be)i=Sn.fromHex(e);else if(e instanceof Sn)i=e;else throw new Error("Invalid account address.");i.serialize(n);return}if(t instanceof $r){if(t.value instanceof po){if(e instanceof Uint8Array){n.serializeBytes(e);return}if(typeof e=="string"){n.serializeStr(e);return}}if(!Array.isArray(e))throw new Error("Invalid vector args.");n.serializeU32AsUleb128(e.length),e.forEach(i=>Jd(i,t.value,n));return}if(t instanceof Is){const{address:i,module_name:o,name:s}=t.value;if(`${Be.fromUint8Array(i.address).toShortString()}::${o.value}::${s.value}`!="0x1::string::String")throw new Error("The only supported struct arg is of type 0x1::string::String");Du(e,["string"]),n.serializeStr(e);return}throw new Error("Unsupported arg type.")}function Sx(e,t){if(t instanceof Ps)return new $u(b_(e));if(t instanceof po)return new Bu(nr(e));if(t instanceof Ir)return new Eu(nr(e));if(t instanceof Or)return new Iu(nr(e));if(t instanceof Cs)return new mr(ir(e));if(t instanceof Bs)return new Ou(ir(e));if(t instanceof Rr)return new Ru(ir(e));if(t instanceof Es){let n;if(typeof e=="string"||e instanceof Be)n=Sn.fromHex(e);else if(e instanceof Sn)n=e;else throw new Error("Invalid account address.");return new yr(n)}if(t instanceof $r&&t.value instanceof po){if(!(e instanceof Uint8Array))throw new Error(`${e} should be an instance of Uint8Array`);return new wr(e)}throw new Error("Unknown type for TransactionArgument.")}var Px="APTOS::RawTransaction",Cx="APTOS::RawTransactionWithData",Tr=class{constructor(e,t){this.rawTxnBuilder=t,this.signingFunction=e}build(e,t,n){if(!this.rawTxnBuilder)throw new Error("this.rawTxnBuilder doesn't exist.");return this.rawTxnBuilder.build(e,t,n)}static getSigningMessage(e){const t=gr.create();if(e instanceof Ur)t.update(Px);else if(e instanceof Su)t.update(Cx);else throw new Error("Unknown transaction type.");const n=t.digest(),i=_o(e),o=new Uint8Array(n.length+i.length);return o.set(n),o.set(i,n.length),o}},dc=class extends Tr{constructor(e,t,n){super(e,n),this.publicKey=t}rawToSigned(e){const t=Tr.getSigningMessage(e),n=this.signingFunction(t),i=new xu(new Ri(this.publicKey),n);return new Ca(e,i)}sign(e){return _o(this.rawToSigned(e))}},Bx=class extends Tr{constructor(e,t){super(e),this.publicKey=t}rawToSigned(e){const t=Tr.getSigningMessage(e),n=this.signingFunction(t),i=new ku(this.publicKey,n);return new Ca(e,i)}sign(e){return _o(this.rawToSigned(e))}},Sc=class{constructor(e,t){this.abiMap=new Map,e.forEach(n=>{const i=new Nd(n),o=Uu.deserialize(i);let s;if(o instanceof br){const r=o,{address:a,name:c}=r.module_name;s=`${Be.fromUint8Array(a.address).toShortString()}::${c.value}::${r.name}`}else s=o.name;if(this.abiMap.has(s))throw new Error("Found conflicting ABI interfaces");this.abiMap.set(s,o)}),this.builderConfig={maxGasAmount:BigInt(Jg),expSecFromNow:Zg,...t}}static toBCSArgs(e,t){if(e.length!==t.length)throw new Error("Wrong number of args provided.");return t.map((n,i)=>{const o=new In;return Jd(n,e[i].type_tag,o),o.getBytes()})}static toTransactionArguments(e,t){if(e.length!==t.length)throw new Error("Wrong number of args provided.");return t.map((n,i)=>Sx(n,e[i].type_tag))}setSequenceNumber(e){this.builderConfig.sequenceNumber=BigInt(e)}buildTransactionPayload(e,t,n){const i=t.map(r=>new Lu(r).parseTypeTag());let o;if(!this.abiMap.has(e))throw new Error(`Cannot find function: ${e}`);const s=this.abiMap.get(e);if(s instanceof br){const r=s,a=Sc.toBCSArgs(r.args,n);o=new Pu(new cs(r.module_name,new di(r.name),i,a))}else if(s instanceof qu){const r=s,a=Sc.toTransactionArguments(r.args,n);o=new Ea(new Pa(r.code,i,a))}else throw new Error("Unknown ABI format.");return o}build(e,t,n){const{sender:i,sequenceNumber:o,gasUnitPrice:s,maxGasAmount:r,expSecFromNow:a,chainId:c}=this.builderConfig;if(!s)throw new Error("No gasUnitPrice provided.");const u=i instanceof Sn?i:Sn.fromHex(i),l=BigInt(Math.floor(Date.now()/1e3)+Number(a)),d=this.buildTransactionPayload(e,t,n);if(d)return new Ur(u,BigInt(o),d,BigInt(r),BigInt(s),l,new Cu(Number(c)));throw new Error("Invalid ABI.")}},v_=class{constructor(e,t){this.aptosClient=e,this.builderConfig=t}async fetchABI(e){const n=(await this.aptosClient.getAccountModules(e)).map(o=>o.abi).flatMap(o=>o.exposed_functions.filter(s=>s.is_entry).map(s=>({fullName:`${o.address}::${o.name}::${s.name}`,...s}))),i=new Map;return n.forEach(o=>{i.set(o.fullName,o)}),i}async build(e,t,n){if(e=(S=>S.replace(/^0[xX]0*/g,"0x"))(e),e.split("::").length!==3)throw new Error("'func' needs to be a fully qualified function name in format <address>::<module>::<function>, e.g. 0x1::coins::transfer");const[s,r]=e.split("::"),a=await this.fetchABI(s);if(!a.has(e))throw new Error(`${e} doesn't exist.`);const c=a.get(e),l=c.params.filter(S=>S!=="signer"&&S!=="&signer").map((S,T)=>new Oa(`var${T}`,new Lu(S).parseTypeTag())),d=new br(c.name,ps.fromStr(`${s}::${r}`),"",c.generic_type_params.map((S,T)=>new Ia(`${T}`)),l),{sender:h,...g}=this.builderConfig,b=h instanceof Sn?Be.fromUint8Array(h.address):h,[{sequence_number:v},x,{gas_estimate:P}]=await Promise.all([g!=null&&g.sequenceNumber?Promise.resolve({sequence_number:g==null?void 0:g.sequenceNumber}):this.aptosClient.getAccount(b),g!=null&&g.chainId?Promise.resolve(g==null?void 0:g.chainId):this.aptosClient.getChainId(),g!=null&&g.gasUnitPrice?Promise.resolve({gas_estimate:g==null?void 0:g.gasUnitPrice}):this.aptosClient.estimateGasPrice()]);return new Sc([_o(d)],{sender:h,sequenceNumber:v,chainId:x,gasUnitPrice:BigInt(P),...g}).build(e,t,n)}};ln([Jv(10*60*1e3)],v_.prototype,"fetchABI",1);var Gr=class{constructor(e,t,n=!1){if(!e)throw new Error("Node URL cannot be empty.");const i=t==null?{}:{...t};n?this.nodeUrl=e:this.nodeUrl=Wv(e),i.BASE=this.nodeUrl,(t==null?void 0:t.WITH_CREDENTIALS)===!1?i.WITH_CREDENTIALS=!1:i.WITH_CREDENTIALS=!0,this.client=new __(i)}async getAccount(e){return this.client.accounts.getAccount(Be.ensure(e).hex())}async getAccountTransactions(e,t){var n;return this.client.transactions.getAccountTransactions(Be.ensure(e).hex(),(n=t==null?void 0:t.start)==null?void 0:n.toString(),t==null?void 0:t.limit)}async getAccountModules(e,t){const n=this.client.accounts.getAccountModules.bind({httpRequest:this.client.request});return await Fh(n,e,1e3,t)}async getAccountModule(e,t,n){var i;return this.client.accounts.getAccountModule(Be.ensure(e).hex(),t,(i=n==null?void 0:n.ledgerVersion)==null?void 0:i.toString())}async getAccountResources(e,t){const n=this.client.accounts.getAccountResources.bind({httpRequest:this.client.request});return await Fh(n,e,9999,t)}async getAccountResource(e,t,n){var i;return this.client.accounts.getAccountResource(Be.ensure(e).hex(),t,(i=n==null?void 0:n.ledgerVersion)==null?void 0:i.toString())}static generateBCSTransaction(e,t){return new dc(i=>{const o=e.signBuffer(i);return new F.Ed25519Signature(o.toUint8Array())},e.pubKey().toUint8Array()).sign(t)}static generateBCSSimulation(e,t){return new dc(i=>{const o=new Uint8Array(64);return new F.Ed25519Signature(o)},e.pubKey().toUint8Array()).sign(t)}async generateTransaction(e,t,n){const i={sender:e};if(n!=null&&n.sequence_number&&(i.sequenceNumber=n.sequence_number),n!=null&&n.gas_unit_price&&(i.gasUnitPrice=n.gas_unit_price),n!=null&&n.max_gas_amount&&(i.maxGasAmount=n.max_gas_amount),n!=null&&n.expiration_timestamp_secs){const s=Number.parseInt(n.expiration_timestamp_secs,10);i.expSecFromNow=s-Math.floor(Date.now()/1e3)}return new v_(this,i).build(t.function,t.type_arguments,t.arguments)}async signTransaction(e,t){return Promise.resolve(Gr.generateBCSTransaction(e,t))}async getEventsByCreationNumber(e,t,n){var i;return this.client.events.getEventsByCreationNumber(Be.ensure(e).hex(),t.toString(),(i=n==null?void 0:n.start)==null?void 0:i.toString(),n==null?void 0:n.limit)}async getEventsByEventHandle(e,t,n,i){var o;return this.client.events.getEventsByEventHandle(Be.ensure(e).hex(),t,n,(o=i==null?void 0:i.start)==null?void 0:o.toString(),i==null?void 0:i.limit)}async submitTransaction(e){return this.submitSignedBCSTransaction(e)}async simulateTransaction(e,t,n){let i;return e instanceof aa?i=Gr.generateBCSSimulation(e,t):e instanceof ka?i=new Bx(()=>{const{threshold:s}=e,r=[],a=[];for(let u=0;u<s;u+=1)r.push(u),a.push(new F.Ed25519Signature(new Uint8Array(64)));const c=F.MultiEd25519Signature.createBitmap(r);return new F.MultiEd25519Signature(a,c)},e).sign(t):i=new dc(()=>{const s=new Uint8Array(64);return new F.Ed25519Signature(s)},e.toBytes()).sign(t),this.submitBCSSimulation(i,n)}async submitSignedBCSTransaction(e){return this.client.request.request({url:"/transactions",method:"POST",body:e,mediaType:"application/x.aptos.signed_transaction+bcs"})}async submitBCSSimulation(e,t){var n,i,o;const s={estimate_gas_unit_price:(n=t==null?void 0:t.estimateGasUnitPrice)!=null?n:!1,estimate_max_gas_amount:(i=t==null?void 0:t.estimateMaxGasAmount)!=null?i:!1,estimate_prioritized_gas_unit_price:(o=t==null?void 0:t.estimatePrioritizedGasUnitPrice)!=null?o:!1};return this.client.request.request({url:"/transactions/simulate",query:s,method:"POST",body:e,mediaType:"application/x.aptos.signed_transaction+bcs"})}async getTransactions(e){var t;return this.client.transactions.getTransactions((t=e==null?void 0:e.start)==null?void 0:t.toString(),e==null?void 0:e.limit)}async getTransactionByHash(e){return this.client.transactions.getTransactionByHash(e)}async getTransactionByVersion(e){return this.client.transactions.getTransactionByVersion(e.toString())}async transactionPending(e){try{return(await this.client.transactions.getTransactionByHash(e)).type==="pending_transaction"}catch(t){if((t==null?void 0:t.status)===404)return!0;throw t}}async waitForTransactionWithResult(e,t){var n,i;const o=(n=t==null?void 0:t.timeoutSecs)!=null?n:Xv,s=(i=t==null?void 0:t.checkSuccess)!=null?i:!1;let r=!0,a=0,c;for(;r&&!(a>=o);){try{if(c=await this.client.transactions.getTransactionByHash(e),r=c.type==="pending_transaction",!r)break}catch(u){const l=u instanceof ca,d=l&&u.status!==404&&u.status>=400&&u.status<500;if(!l||d)throw u}await Gv(1e3),a+=1}if(c===void 0)throw new Error(`Waiting for transaction ${e} failed`);if(r)throw new Ix(`Waiting for transaction ${e} timed out after ${o} seconds`,c);if(!s)return c;if(!(c!=null&&c.success))throw new Ox(`Transaction ${e} committed to the blockchain but execution failed`,c);return c}async waitForTransaction(e,t){await this.waitForTransactionWithResult(e,t)}async getLedgerInfo(){return this.client.general.getLedgerInfo()}async getChainId(){return(await this.getLedgerInfo()).chain_id}async getTableItem(e,t,n){var i;return await this.client.tables.getTableItem(e,t,(i=n==null?void 0:n.ledgerVersion)==null?void 0:i.toString())}async generateRawTransaction(e,t,n){const[{sequence_number:i},o,{gas_estimate:s}]=await Promise.all([this.getAccount(e),this.getChainId(),n!=null&&n.gasUnitPrice?Promise.resolve({gas_estimate:n.gasUnitPrice}):this.estimateGasPrice()]),{maxGasAmount:r,gasUnitPrice:a,expireTimestamp:c}={maxGasAmount:BigInt(Jg),gasUnitPrice:BigInt(s),expireTimestamp:BigInt(Math.floor(Date.now()/1e3)+Zg),...n};return new F.RawTransaction(F.AccountAddress.fromHex(e),BigInt(i),t,r,a,c,new F.ChainId(o))}async generateSignSubmitTransaction(e,t,n){const i=await this.generateRawTransaction(e.address(),t,n),o=Gr.generateBCSTransaction(e,i);return(await this.submitSignedBCSTransaction(o)).hash}async publishPackage(e,t,n,i){const o=new In;xi(n,o);const s=new F.TransactionPayloadEntryFunction(F.EntryFunction.natural("0x1::code","publish_package_txn",[],[Fs(t),o.getBytes()]));return this.generateSignSubmitTransaction(e,s,i)}async generateSignSubmitWaitForTransaction(e,t,n){const i=await this.generateSignSubmitTransaction(e,t,n);return this.waitForTransactionWithResult(i,n)}async estimateGasPrice(){return this.client.transactions.estimateGasPrice()}async estimateMaxGasAmount(e){const t=`0x1::coin::CoinStore<${Vv}>`,[{gas_estimate:n},i]=await Promise.all([this.estimateGasPrice(),this.getAccountResources(e)]),o=i.find(r=>r.type===t);return BigInt(o.data.coin.value)/BigInt(n)}async rotateAuthKeyEd25519(e,t,n){const{sequence_number:i,authentication_key:o}=await this.getAccount(e.address()),s=new aa(t),r=new F.RotationProofChallenge(F.AccountAddress.CORE_CODE_ADDRESS,"account","RotationProofChallenge",BigInt(i),F.AccountAddress.fromHex(e.address()),new F.AccountAddress(new Be(o).toUint8Array()),s.pubKey().toUint8Array()),a=Be.fromUint8Array(_o(r)),c=e.signHexString(a),u=s.signHexString(a),l=new F.TransactionPayloadEntryFunction(F.EntryFunction.natural("0x1::account","rotate_authentication_key",[],[Kl(0),Fs(e.pubKey().toUint8Array()),Kl(0),Fs(s.pubKey().toUint8Array()),Fs(c.toUint8Array()),Fs(u.toUint8Array())])),d=await this.generateRawTransaction(e.address(),l,n),h=Gr.generateBCSTransaction(e,d);return this.submitSignedBCSTransaction(h)}async lookupOriginalAddress(e){const t=await this.getAccountResource("0x1","0x1::account::OriginatingAddress"),{address_map:{handle:n}}=t.data,i=await this.getTableItem(n,{key_type:"address",value_type:"address",key:Be.ensure(e).hex()});return new Be(i)}async getBlockByHeight(e,t){return this.client.blocks.getBlockByHeight(e,t)}async getBlockByVersion(e,t){return this.client.blocks.getBlockByVersion(e,t)}async view(e,t){return this.client.view.view(e,t)}clearCache(e){Zv(e)}},cn=Gr;ln([qn],cn.prototype,"getAccount",1);ln([qn],cn.prototype,"getAccountTransactions",1);ln([qn],cn.prototype,"getAccountModules",1);ln([qn],cn.prototype,"getAccountModule",1);ln([qn],cn.prototype,"getAccountResources",1);ln([qn],cn.prototype,"getAccountResource",1);ln([qn],cn.prototype,"getEventsByCreationNumber",1);ln([qn],cn.prototype,"getEventsByEventHandle",1);ln([qn],cn.prototype,"submitSignedBCSTransaction",1);ln([qn],cn.prototype,"submitBCSSimulation",1);ln([qn],cn.prototype,"getTransactions",1);ln([qn],cn.prototype,"getTransactionByHash",1);ln([qn],cn.prototype,"getTransactionByVersion",1);ln([qn],cn.prototype,"getLedgerInfo",1);ln([Tu()],cn.prototype,"getChainId",1);ln([qn],cn.prototype,"getTableItem",1);ln([qn,Tu({ttlMs:5*60*1e3,tags:["gas_estimates"]})],cn.prototype,"estimateGasPrice",1);ln([qn],cn.prototype,"estimateMaxGasAmount",1);ln([qn],cn.prototype,"getBlockByHeight",1);ln([qn],cn.prototype,"getBlockByVersion",1);ln([qn],cn.prototype,"view",1);var Ex=class extends Error{constructor(e,t,n,i){super(t),this.status=e,this.message=t,this.errorCode=n,this.vmErrorCode=i}},Ix=class extends Error{constructor(e,t){super(e),this.lastSubmittedTransaction=t}},Ox=class extends Error{constructor(e,t){super(e),this.transaction=t}};function qn(e,t,n){const i=n.value;return n.value=async function(...s){var r,a;try{return await i.apply(this,[...s])}catch(c){throw c instanceof ca?new Ex(c.status,JSON.stringify({message:c.message,...c.body}),(r=c.body)==null?void 0:r.error_code,(a=c.body)==null?void 0:a.vm_error_code):c}},n}var T_=class{constructor(e,t,n=!1){let i=null,o=null;if(typeof e=="object"&&Rx(e)?(i=e.fullnodeUrl,o=e.indexerUrl):(i=Qv[e],o=Yv[e]),!i||!o)throw new Error("network is not provided");this.aptosClient=new cn(i,t,n),this.indexerClient=new n_(o)}};function A_(e,t,n){Object.getOwnPropertyNames(t.prototype).forEach(i=>{const o=Object.getOwnPropertyDescriptor(t.prototype,i);o&&(o.value=function(...s){return this[n][i](...s)},Object.defineProperty(e.prototype,i,o))})}A_(T_,cn,"aptosClient");A_(T_,n_,"indexerClient");function Rx(e){return e.fullnodeUrl!==void 0&&typeof e.fullnodeUrl=="string"&&e.indexerUrl!==void 0&&typeof e.indexerUrl=="string"}var $x="a11ceb0b0500000006010004020408030c0a05161d073339086c400000010100020700010307000104030100010504020007060c0508000800030503010801000405080008000304060c0801050306737472696e6705746f6b656e06537472696e6707546f6b656e4964136372656174655f746f6b656e5f69645f726177087472616e73666572000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000030000010c0b010b020b030b0411000c070b000b070b050b06110102",Ux=["01186372656174655F636F6C6C656374696F6E5F736372697074000000000000000000000000000000000000000000000000000000000000000305746F6B656E3020637265617465206120656D70747920746F6B656E20636F6C6C656374696F6E207769746820706172616D65746572730005046E616D6507000000000000000000000000000000000000000000000000000000000000000106737472696E6706537472696E67000B6465736372697074696F6E07000000000000000000000000000000000000000000000000000000000000000106737472696E6706537472696E67000375726907000000000000000000000000000000000000000000000000000000000000000106737472696E6706537472696E6700076D6178696D756D020E6D75746174655F73657474696E670600","01136372656174655F746F6B656E5F736372697074000000000000000000000000000000000000000000000000000000000000000305746F6B656E1D2063726561746520746F6B656E20776974682072617720696E70757473000D0A636F6C6C656374696F6E07000000000000000000000000000000000000000000000000000000000000000106737472696E6706537472696E6700046E616D6507000000000000000000000000000000000000000000000000000000000000000106737472696E6706537472696E67000B6465736372697074696F6E07000000000000000000000000000000000000000000000000000000000000000106737472696E6706537472696E67000762616C616E636502076D6178696D756D020375726907000000000000000000000000000000000000000000000000000000000000000106737472696E6706537472696E670015726F79616C74795F70617965655F61646472657373041A726F79616C74795F706F696E74735F64656E6F6D696E61746F720218726F79616C74795F706F696E74735F6E756D657261746F72020E6D75746174655F73657474696E6706000D70726F70657274795F6B6579730607000000000000000000000000000000000000000000000000000000000000000106737472696E6706537472696E67000F70726F70657274795F76616C7565730606010E70726F70657274795F74797065730607000000000000000000000000000000000000000000000000000000000000000106737472696E6706537472696E6700","01166469726563745f7472616e736665725f736372697074000000000000000000000000000000000000000000000000000000000000000305746f6b656e0000051063726561746f72735f61646472657373040a636f6c6c656374696f6e07000000000000000000000000000000000000000000000000000000000000000106737472696e6706537472696e6700046e616d6507000000000000000000000000000000000000000000000000000000000000000106737472696e6706537472696e67001070726f70657274795f76657273696f6e0206616d6f756e7402","010C6F666665725F73637269707400000000000000000000000000000000000000000000000000000000000000030F746F6B656E5F7472616E7366657273000006087265636569766572040763726561746F72040A636F6C6C656374696F6E07000000000000000000000000000000000000000000000000000000000000000106737472696E6706537472696E6700046E616D6507000000000000000000000000000000000000000000000000000000000000000106737472696E6706537472696E67001070726F70657274795F76657273696F6E0206616D6F756E7402","010C636C61696D5F73637269707400000000000000000000000000000000000000000000000000000000000000030F746F6B656E5F7472616E73666572730000050673656E646572040763726561746F72040A636F6C6C656374696F6E07000000000000000000000000000000000000000000000000000000000000000106737472696E6706537472696E6700046E616D6507000000000000000000000000000000000000000000000000000000000000000106737472696E6706537472696E67001070726F70657274795F76657273696F6E02","011363616E63656C5F6F666665725F73637269707400000000000000000000000000000000000000000000000000000000000000030F746F6B656E5F7472616E7366657273000005087265636569766572040763726561746F72040A636F6C6C656374696F6E07000000000000000000000000000000000000000000000000000000000000000106737472696E6706537472696E6700046E616D6507000000000000000000000000000000000000000000000000000000000000000106737472696E6706537472696E67001070726F70657274795F76657273696F6E02","01176d75746174655f746f6b656e5f70726f70657274696573000000000000000000000000000000000000000000000000000000000000000305746f6b656eba02206d75746174652074686520746f6b656e2070726f706572747920616e64207361766520746865206e65772070726f706572747920696e20546f6b656e53746f72650a2069662074686520746f6b656e2070726f70657274795f76657273696f6e20697320302c2077652077696c6c206372656174652061206e65772070726f70657274795f76657273696f6e2070657220746f6b656e20746f2067656e65726174652061206e657720746f6b656e5f69642070657220746f6b656e0a2069662074686520746f6b656e2070726f70657274795f76657273696f6e206973206e6f7420302c2077652077696c6c206a75737420757064617465207468652070726f70657274794d617020616e642075736520746865206578697374696e6720746f6b656e5f6964202870726f70657274795f76657273696f6e2900090b746f6b656e5f6f776e6572040763726561746f72040f636f6c6c656374696f6e5f6e616d6507000000000000000000000000000000000000000000000000000000000000000106737472696e6706537472696e67000a746f6b656e5f6e616d6507000000000000000000000000000000000000000000000000000000000000000106737472696e6706537472696e670016746f6b656e5f70726f70657274795f76657273696f6e0206616d6f756e7402046b6579730607000000000000000000000000000000000000000000000000000000000000000106737472696e6706537472696e67000676616c7565730606010574797065730607000000000000000000000000000000000000000000000000000000000000000106737472696e6706537472696e6700","01166f70745f696e5f6469726563745f7472616e73666572000000000000000000000000000000000000000000000000000000000000000305746f6b656e000001066f70745f696e00","01046275726e000000000000000000000000000000000000000000000000000000000000000305746f6b656e20204275726e206120746f6b656e2062792074686520746f6b656e206f776e657200051063726561746f72735f61646472657373040a636f6c6c656374696f6e07000000000000000000000000000000000000000000000000000000000000000106737472696e6706537472696e6700046e616d6507000000000000000000000000000000000000000000000000000000000000000106737472696e6706537472696e67001070726f70657274795f76657273696f6e0206616d6f756e7402","010f6275726e5f62795f63726561746f72000000000000000000000000000000000000000000000000000000000000000305746f6b656e6a204275726e206120746f6b656e2062792063726561746f72207768656e2074686520746f6b656e2773204255524e41424c455f42595f43524541544f5220697320747275650a2054686520746f6b656e206973206f776e65642061742061646472657373206f776e65720005056f776e6572040a636f6c6c656374696f6e07000000000000000000000000000000000000000000000000000000000000000106737472696e6706537472696e6700046e616d6507000000000000000000000000000000000000000000000000000000000000000106737472696e6706537472696e67001070726f70657274795f76657273696f6e0206616d6f756e7402"],x_=class{constructor(e,t){this.type=e,this.value=t}},Zd=class{constructor(){this.data={}}setProperty(e,t){this.data[e]=t}};function k_(e){let t;return e==="string"||e==="String"?t=new Is(Ax):t=new Lu(e).parseTypeTag(),t}function qx(e,t){if(e.length!==t.length)throw new Error("Length of property values and types not match");const n=new Array;return t.forEach((i,o)=>{try{const s=k_(i),r=new In;Jd(e[o],s,r),n.push(r.getBytes())}catch{n.push(new TextEncoder().encode(e[o]))}}),n}function S_(e){const t=e.map.data,n=new Zd;return t.forEach(i=>{const{key:o}=i,s=i.value.value,r=i.value.type,a=k_(r),c=Mx(a,s),u=new x_(r,c);n.setProperty(o,u)}),n}function Mx(e,t){const n=new Nd(new Be(t).toUint8Array());let i="";return e instanceof po?i=n.deserializeU8().toString():e instanceof Cs?i=n.deserializeU64().toString():e instanceof Bs?i=n.deserializeU128().toString():e instanceof Ps?i=n.deserializeBool()?"true":"false":e instanceof Es?i=Be.fromUint8Array(n.deserializeFixedBytes(32)).hex():e instanceof Is&&e.isStringTypeTag()?i=n.deserializeStr():i=t,i}var Dx={};vu(Dx,{PropertyMap:()=>Zd,PropertyValue:()=>x_,Token:()=>C_,TokenData:()=>P_});var P_=class{constructor(e,t,n,i,o,s,r,a){this.collection=e,this.description=t,this.name=n,this.maximum=i,this.supply=o,this.uri=s,this.default_properties=S_(r),this.mutability_config=a}},C_=class{constructor(e,t,n){this.id=e,this.amount=t,this.token_properties=S_(n)}},Lx=class{constructor(e){this.aptosClient=e,this.transactionBuilder=new Sc(Ux.map(t=>new Be(t).toUint8Array()))}async createCollection(e,t,n,i,o=Zr,s){const r=this.transactionBuilder.buildTransactionPayload("0x3::token::create_collection_script",[],[t,n,i,o,[!1,!1,!1]]);return this.aptosClient.generateSignSubmitTransaction(e,r,s)}async createToken(e,t,n,i,o,s,r=Zr,a=e.address(),c=0,u=0,l=[],d=[],h=[],g){const b=this.transactionBuilder.buildTransactionPayload("0x3::token::create_token_script",[],[t,n,i,o,r,s,a,c,u,[!1,!1,!1,!1,!1],l,qx(d,h),h]);return this.aptosClient.generateSignSubmitTransaction(e,b,g)}async createTokenWithMutabilityConfig(e,t,n,i,o,s,r=Zr,a=e.address(),c=0,u=0,l=[],d=[],h=[],g=[!1,!1,!1,!1,!1],b){const v=this.transactionBuilder.buildTransactionPayload("0x3::token::create_token_script",[],[t,n,i,o,r,s,a,c,u,g,l,d,h]);return this.aptosClient.generateSignSubmitTransaction(e,v,b)}async offerToken(e,t,n,i,o,s,r=0,a){const c=this.transactionBuilder.buildTransactionPayload("0x3::token_transfers::offer_script",[],[t,n,i,o,r,s]);return this.aptosClient.generateSignSubmitTransaction(e,c,a)}async claimToken(e,t,n,i,o,s=0,r){const a=this.transactionBuilder.buildTransactionPayload("0x3::token_transfers::claim_script",[],[t,n,i,o,s]);return this.aptosClient.generateSignSubmitTransaction(e,a,r)}async cancelTokenOffer(e,t,n,i,o,s=0,r){const a=this.transactionBuilder.buildTransactionPayload("0x3::token_transfers::cancel_offer_script",[],[t,n,i,o,s]);return this.aptosClient.generateSignSubmitTransaction(e,a,r)}async directTransferToken(e,t,n,i,o,s,r=0,a){const c=this.transactionBuilder.buildTransactionPayload("0x3::token::direct_transfer_script",[],[n,i,o,r,s]),u=await this.aptosClient.generateRawTransaction(e.address(),c,a),l=new F.MultiAgentRawTransaction(u,[F.AccountAddress.fromHex(t.address())]),d=new F.Ed25519Signature(e.signBuffer(Tr.getSigningMessage(l)).toUint8Array()),h=new F.AccountAuthenticatorEd25519(new F.Ed25519PublicKey(e.signingKey.publicKey),d),g=new F.Ed25519Signature(t.signBuffer(Tr.getSigningMessage(l)).toUint8Array()),b=new F.AccountAuthenticatorEd25519(new F.Ed25519PublicKey(t.signingKey.publicKey),g),v=new F.TransactionAuthenticatorMultiAgent(h,[F.AccountAddress.fromHex(t.address())],[b]),x=_o(new F.SignedTransaction(u,v));return(await this.aptosClient.submitSignedBCSTransaction(x)).hash}async optInTokenTransfer(e,t,n){const i=this.transactionBuilder.buildTransactionPayload("0x3::token::opt_in_direct_transfer",[],[t]);return this.aptosClient.generateSignSubmitTransaction(e,i,n)}async transferWithOptIn(e,t,n,i,o,s,r,a){const c=new Ea(new Pa(new Be($x).toUint8Array(),[],[new yr(F.AccountAddress.fromHex(t)),new wr(new TextEncoder().encode(n)),new wr(new TextEncoder().encode(i)),new mr(BigInt(o)),new yr(F.AccountAddress.fromHex(s)),new mr(BigInt(r))]));return this.aptosClient.generateSignSubmitTransaction(e,c,a)}async burnByCreator(e,t,n,i,o,s,r){const a=this.transactionBuilder.buildTransactionPayload("0x3::token::burn_by_creator",[],[t,n,i,o,s]);return this.aptosClient.generateSignSubmitTransaction(e,a,r)}async burnByOwner(e,t,n,i,o,s,r){const a=this.transactionBuilder.buildTransactionPayload("0x3::token::burn",[],[t,n,i,o,s]);return this.aptosClient.generateSignSubmitTransaction(e,a,r)}async mutateTokenProperties(e,t,n,i,o,s,r,a,c,u,l){const d=this.transactionBuilder.buildTransactionPayload("0x3::token::mutate_token_properties",[],[t,n,i,o,s,r,a,c,u]);return this.aptosClient.generateSignSubmitTransaction(e,d,l)}async getCollectionData(e,t){const i=(await this.aptosClient.getAccountResources(e)).find(a=>a.type==="0x3::token::Collections"),{handle:o}=i.data.collection_data,s={key_type:"0x1::string::String",value_type:"0x3::token::CollectionData",key:t};return await this.aptosClient.getTableItem(o,s)}async getTokenData(e,t,n){const i=e instanceof Be?e.hex():e,o=await this.aptosClient.getAccountResource(i,"0x3::token::Collections"),{handle:s}=o.data.token_data,a={key_type:"0x3::token::TokenDataId",value_type:"0x3::token::TokenData",key:{creator:i,collection:t,name:n}},c=await this.aptosClient.getTableItem(s,a);return new P_(c.collection,c.description,c.name,c.maximum,c.supply,c.uri,c.default_properties,c.mutability_config)}async getToken(e,t,n,i="0"){const o={creator:e instanceof Be?e.hex():e,collection:t,name:n};return this.getTokenForAccount(e,{token_data_id:o,property_version:i})}async getTokenForAccount(e,t){const n=await this.aptosClient.getAccountResource(e instanceof Be?e.hex():e,"0x3::token::TokenStore"),{handle:i}=n.data.tokens,o={key_type:"0x3::token::TokenId",value_type:"0x3::token::Token",key:t};try{const s=await this.aptosClient.getTableItem(i,o);return new C_(s.id,s.amount,s.token_properties)}catch(s){return(s==null?void 0:s.status)===404?{id:t,amount:"0",token_properties:new Zd}:s}}},_={},Nx={get exports(){return _},set exports(e){_=e}};(function(e){(function(t,n){function i(A,f){if(!A)throw new Error(f||"Assertion failed")}function o(A,f){A.super_=f;var y=function(){};y.prototype=f.prototype,A.prototype=new y,A.prototype.constructor=A}function s(A,f,y){if(s.isBN(A))return A;this.negative=0,this.words=null,this.length=0,this.red=null,A!==null&&((f==="le"||f==="be")&&(y=f,f=10),this._init(A||0,f||10,y||"be"))}typeof t=="object"?t.exports=s:n.BN=s,s.BN=s,s.wordSize=26;var r;try{typeof window<"u"&&typeof window.Buffer<"u"?r=window.Buffer:r=Df.Buffer}catch{}s.isBN=function(f){return f instanceof s?!0:f!==null&&typeof f=="object"&&f.constructor.wordSize===s.wordSize&&Array.isArray(f.words)},s.max=function(f,y){return f.cmp(y)>0?f:y},s.min=function(f,y){return f.cmp(y)<0?f:y},s.prototype._init=function(f,y,k){if(typeof f=="number")return this._initNumber(f,y,k);if(typeof f=="object")return this._initArray(f,y,k);y==="hex"&&(y=16),i(y===(y|0)&&y>=2&&y<=36),f=f.toString().replace(/\s+/g,"");var U=0;f[0]==="-"&&(U++,this.negative=1),U<f.length&&(y===16?this._parseHex(f,U,k):(this._parseBase(f,y,U),k==="le"&&this._initArray(this.toArray(),y,k)))},s.prototype._initNumber=function(f,y,k){f<0&&(this.negative=1,f=-f),f<67108864?(this.words=[f&67108863],this.length=1):f<4503599627370496?(this.words=[f&67108863,f/67108864&67108863],this.length=2):(i(f<9007199254740992),this.words=[f&67108863,f/67108864&67108863,1],this.length=3),k==="le"&&this._initArray(this.toArray(),y,k)},s.prototype._initArray=function(f,y,k){if(i(typeof f.length=="number"),f.length<=0)return this.words=[0],this.length=1,this;this.length=Math.ceil(f.length/3),this.words=new Array(this.length);for(var U=0;U<this.length;U++)this.words[U]=0;var D,z,X=0;if(k==="be")for(U=f.length-1,D=0;U>=0;U-=3)z=f[U]|f[U-1]<<8|f[U-2]<<16,this.words[D]|=z<<X&67108863,this.words[D+1]=z>>>26-X&67108863,X+=24,X>=26&&(X-=26,D++);else if(k==="le")for(U=0,D=0;U<f.length;U+=3)z=f[U]|f[U+1]<<8|f[U+2]<<16,this.words[D]|=z<<X&67108863,this.words[D+1]=z>>>26-X&67108863,X+=24,X>=26&&(X-=26,D++);return this._strip()};function a(A,f){var y=A.charCodeAt(f);if(y>=48&&y<=57)return y-48;if(y>=65&&y<=70)return y-55;if(y>=97&&y<=102)return y-87;i(!1,"Invalid character in "+A)}function c(A,f,y){var k=a(A,y);return y-1>=f&&(k|=a(A,y-1)<<4),k}s.prototype._parseHex=function(f,y,k){this.length=Math.ceil((f.length-y)/6),this.words=new Array(this.length);for(var U=0;U<this.length;U++)this.words[U]=0;var D=0,z=0,X;if(k==="be")for(U=f.length-1;U>=y;U-=2)X=c(f,y,U)<<D,this.words[z]|=X&67108863,D>=18?(D-=18,z+=1,this.words[z]|=X>>>26):D+=8;else{var I=f.length-y;for(U=I%2===0?y+1:y;U<f.length;U+=2)X=c(f,y,U)<<D,this.words[z]|=X&67108863,D>=18?(D-=18,z+=1,this.words[z]|=X>>>26):D+=8}this._strip()};function u(A,f,y,k){for(var U=0,D=0,z=Math.min(A.length,y),X=f;X<z;X++){var I=A.charCodeAt(X)-48;U*=k,I>=49?D=I-49+10:I>=17?D=I-17+10:D=I,i(I>=0&&D<k,"Invalid character"),U+=D}return U}s.prototype._parseBase=function(f,y,k){this.words=[0],this.length=1;for(var U=0,D=1;D<=67108863;D*=y)U++;U--,D=D/y|0;for(var z=f.length-k,X=z%U,I=Math.min(z,z-X)+k,m=0,M=k;M<I;M+=U)m=u(f,M,M+U,y),this.imuln(D),this.words[0]+m<67108864?this.words[0]+=m:this._iaddn(m);if(X!==0){var Tt=1;for(m=u(f,M,f.length,y),M=0;M<X;M++)Tt*=y;this.imuln(Tt),this.words[0]+m<67108864?this.words[0]+=m:this._iaddn(m)}this._strip()},s.prototype.copy=function(f){f.words=new Array(this.length);for(var y=0;y<this.length;y++)f.words[y]=this.words[y];f.length=this.length,f.negative=this.negative,f.red=this.red};function l(A,f){A.words=f.words,A.length=f.length,A.negative=f.negative,A.red=f.red}if(s.prototype._move=function(f){l(f,this)},s.prototype.clone=function(){var f=new s(null);return this.copy(f),f},s.prototype._expand=function(f){for(;this.length<f;)this.words[this.length++]=0;return this},s.prototype._strip=function(){for(;this.length>1&&this.words[this.length-1]===0;)this.length--;return this._normSign()},s.prototype._normSign=function(){return this.length===1&&this.words[0]===0&&(this.negative=0),this},typeof Symbol<"u"&&typeof Symbol.for=="function")try{s.prototype[Symbol.for("nodejs.util.inspect.custom")]=d}catch{s.prototype.inspect=d}else s.prototype.inspect=d;function d(){return(this.red?"<BN-R: ":"<BN: ")+this.toString(16)+">"}var h=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"],g=[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],b=[0,0,33554432,43046721,16777216,48828125,60466176,40353607,16777216,43046721,1e7,19487171,35831808,62748517,7529536,11390625,16777216,24137569,34012224,47045881,64e6,4084101,5153632,6436343,7962624,9765625,11881376,14348907,17210368,20511149,243e5,28629151,33554432,39135393,45435424,52521875,60466176];s.prototype.toString=function(f,y){f=f||10,y=y|0||1;var k;if(f===16||f==="hex"){k="";for(var U=0,D=0,z=0;z<this.length;z++){var X=this.words[z],I=((X<<U|D)&16777215).toString(16);D=X>>>24-U&16777215,U+=2,U>=26&&(U-=26,z--),D!==0||z!==this.length-1?k=h[6-I.length]+I+k:k=I+k}for(D!==0&&(k=D.toString(16)+k);k.length%y!==0;)k="0"+k;return this.negative!==0&&(k="-"+k),k}if(f===(f|0)&&f>=2&&f<=36){var m=g[f],M=b[f];k="";var Tt=this.clone();for(Tt.negative=0;!Tt.isZero();){var ct=Tt.modrn(M).toString(f);Tt=Tt.idivn(M),Tt.isZero()?k=ct+k:k=h[m-ct.length]+ct+k}for(this.isZero()&&(k="0"+k);k.length%y!==0;)k="0"+k;return this.negative!==0&&(k="-"+k),k}i(!1,"Base should be between 2 and 36")},s.prototype.toNumber=function(){var f=this.words[0];return this.length===2?f+=this.words[1]*67108864:this.length===3&&this.words[2]===1?f+=4503599627370496+this.words[1]*67108864:this.length>2&&i(!1,"Number can only safely store up to 53 bits"),this.negative!==0?-f:f},s.prototype.toJSON=function(){return this.toString(16,2)},r&&(s.prototype.toBuffer=function(f,y){return this.toArrayLike(r,f,y)}),s.prototype.toArray=function(f,y){return this.toArrayLike(Array,f,y)};var v=function(f,y){return f.allocUnsafe?f.allocUnsafe(y):new f(y)};s.prototype.toArrayLike=function(f,y,k){this._strip();var U=this.byteLength(),D=k||Math.max(1,U);i(U<=D,"byte array longer than desired length"),i(D>0,"Requested array length <= 0");var z=v(f,D),X=y==="le"?"LE":"BE";return this["_toArrayLike"+X](z,U),z},s.prototype._toArrayLikeLE=function(f,y){for(var k=0,U=0,D=0,z=0;D<this.length;D++){var X=this.words[D]<<z|U;f[k++]=X&255,k<f.length&&(f[k++]=X>>8&255),k<f.length&&(f[k++]=X>>16&255),z===6?(k<f.length&&(f[k++]=X>>24&255),U=0,z=0):(U=X>>>24,z+=2)}if(k<f.length)for(f[k++]=U;k<f.length;)f[k++]=0},s.prototype._toArrayLikeBE=function(f,y){for(var k=f.length-1,U=0,D=0,z=0;D<this.length;D++){var X=this.words[D]<<z|U;f[k--]=X&255,k>=0&&(f[k--]=X>>8&255),k>=0&&(f[k--]=X>>16&255),z===6?(k>=0&&(f[k--]=X>>24&255),U=0,z=0):(U=X>>>24,z+=2)}if(k>=0)for(f[k--]=U;k>=0;)f[k--]=0},Math.clz32?s.prototype._countBits=function(f){return 32-Math.clz32(f)}:s.prototype._countBits=function(f){var y=f,k=0;return y>=4096&&(k+=13,y>>>=13),y>=64&&(k+=7,y>>>=7),y>=8&&(k+=4,y>>>=4),y>=2&&(k+=2,y>>>=2),k+y},s.prototype._zeroBits=function(f){if(f===0)return 26;var y=f,k=0;return y&8191||(k+=13,y>>>=13),y&127||(k+=7,y>>>=7),y&15||(k+=4,y>>>=4),y&3||(k+=2,y>>>=2),y&1||k++,k},s.prototype.bitLength=function(){var f=this.words[this.length-1],y=this._countBits(f);return(this.length-1)*26+y};function x(A){for(var f=new Array(A.bitLength()),y=0;y<f.length;y++){var k=y/26|0,U=y%26;f[y]=A.words[k]>>>U&1}return f}s.prototype.zeroBits=function(){if(this.isZero())return 0;for(var f=0,y=0;y<this.length;y++){var k=this._zeroBits(this.words[y]);if(f+=k,k!==26)break}return f},s.prototype.byteLength=function(){return Math.ceil(this.bitLength()/8)},s.prototype.toTwos=function(f){return this.negative!==0?this.abs().inotn(f).iaddn(1):this.clone()},s.prototype.fromTwos=function(f){return this.testn(f-1)?this.notn(f).iaddn(1).ineg():this.clone()},s.prototype.isNeg=function(){return this.negative!==0},s.prototype.neg=function(){return this.clone().ineg()},s.prototype.ineg=function(){return this.isZero()||(this.negative^=1),this},s.prototype.iuor=function(f){for(;this.length<f.length;)this.words[this.length++]=0;for(var y=0;y<f.length;y++)this.words[y]=this.words[y]|f.words[y];return this._strip()},s.prototype.ior=function(f){return i((this.negative|f.negative)===0),this.iuor(f)},s.prototype.or=function(f){return this.length>f.length?this.clone().ior(f):f.clone().ior(this)},s.prototype.uor=function(f){return this.length>f.length?this.clone().iuor(f):f.clone().iuor(this)},s.prototype.iuand=function(f){var y;this.length>f.length?y=f:y=this;for(var k=0;k<y.length;k++)this.words[k]=this.words[k]&f.words[k];return this.length=y.length,this._strip()},s.prototype.iand=function(f){return i((this.negative|f.negative)===0),this.iuand(f)},s.prototype.and=function(f){return this.length>f.length?this.clone().iand(f):f.clone().iand(this)},s.prototype.uand=function(f){return this.length>f.length?this.clone().iuand(f):f.clone().iuand(this)},s.prototype.iuxor=function(f){var y,k;this.length>f.length?(y=this,k=f):(y=f,k=this);for(var U=0;U<k.length;U++)this.words[U]=y.words[U]^k.words[U];if(this!==y)for(;U<y.length;U++)this.words[U]=y.words[U];return this.length=y.length,this._strip()},s.prototype.ixor=function(f){return i((this.negative|f.negative)===0),this.iuxor(f)},s.prototype.xor=function(f){return this.length>f.length?this.clone().ixor(f):f.clone().ixor(this)},s.prototype.uxor=function(f){return this.length>f.length?this.clone().iuxor(f):f.clone().iuxor(this)},s.prototype.inotn=function(f){i(typeof f=="number"&&f>=0);var y=Math.ceil(f/26)|0,k=f%26;this._expand(y),k>0&&y--;for(var U=0;U<y;U++)this.words[U]=~this.words[U]&67108863;return k>0&&(this.words[U]=~this.words[U]&67108863>>26-k),this._strip()},s.prototype.notn=function(f){return this.clone().inotn(f)},s.prototype.setn=function(f,y){i(typeof f=="number"&&f>=0);var k=f/26|0,U=f%26;return this._expand(k+1),y?this.words[k]=this.words[k]|1<<U:this.words[k]=this.words[k]&~(1<<U),this._strip()},s.prototype.iadd=function(f){var y;if(this.negative!==0&&f.negative===0)return this.negative=0,y=this.isub(f),this.negative^=1,this._normSign();if(this.negative===0&&f.negative!==0)return f.negative=0,y=this.isub(f),f.negative=1,y._normSign();var k,U;this.length>f.length?(k=this,U=f):(k=f,U=this);for(var D=0,z=0;z<U.length;z++)y=(k.words[z]|0)+(U.words[z]|0)+D,this.words[z]=y&67108863,D=y>>>26;for(;D!==0&&z<k.length;z++)y=(k.words[z]|0)+D,this.words[z]=y&67108863,D=y>>>26;if(this.length=k.length,D!==0)this.words[this.length]=D,this.length++;else if(k!==this)for(;z<k.length;z++)this.words[z]=k.words[z];return this},s.prototype.add=function(f){var y;return f.negative!==0&&this.negative===0?(f.negative=0,y=this.sub(f),f.negative^=1,y):f.negative===0&&this.negative!==0?(this.negative=0,y=f.sub(this),this.negative=1,y):this.length>f.length?this.clone().iadd(f):f.clone().iadd(this)},s.prototype.isub=function(f){if(f.negative!==0){f.negative=0;var y=this.iadd(f);return f.negative=1,y._normSign()}else if(this.negative!==0)return this.negative=0,this.iadd(f),this.negative=1,this._normSign();var k=this.cmp(f);if(k===0)return this.negative=0,this.length=1,this.words[0]=0,this;var U,D;k>0?(U=this,D=f):(U=f,D=this);for(var z=0,X=0;X<D.length;X++)y=(U.words[X]|0)-(D.words[X]|0)+z,z=y>>26,this.words[X]=y&67108863;for(;z!==0&&X<U.length;X++)y=(U.words[X]|0)+z,z=y>>26,this.words[X]=y&67108863;if(z===0&&X<U.length&&U!==this)for(;X<U.length;X++)this.words[X]=U.words[X];return this.length=Math.max(this.length,X),U!==this&&(this.negative=1),this._strip()},s.prototype.sub=function(f){return this.clone().isub(f)};function P(A,f,y){y.negative=f.negative^A.negative;var k=A.length+f.length|0;y.length=k,k=k-1|0;var U=A.words[0]|0,D=f.words[0]|0,z=U*D,X=z&67108863,I=z/67108864|0;y.words[0]=X;for(var m=1;m<k;m++){for(var M=I>>>26,Tt=I&67108863,ct=Math.min(m,f.length-1),mt=Math.max(0,m-A.length+1);mt<=ct;mt++){var oe=m-mt|0;U=A.words[oe]|0,D=f.words[mt]|0,z=U*D+Tt,M+=z/67108864|0,Tt=z&67108863}y.words[m]=Tt|0,I=M|0}return I!==0?y.words[m]=I|0:y.length--,y._strip()}var E=function(f,y,k){var U=f.words,D=y.words,z=k.words,X=0,I,m,M,Tt=U[0]|0,ct=Tt&8191,mt=Tt>>>13,oe=U[1]|0,Qt=oe&8191,Ie=oe>>>13,fe=U[2]|0,se=fe&8191,ae=fe>>>13,ci=U[3]|0,nt=ci&8191,dt=ci>>>13,Bt=U[4]|0,At=Bt&8191,Rt=Bt>>>13,Yt=U[5]|0,Nt=Yt&8191,Jt=Yt>>>13,Xe=U[6]|0,ce=Xe&8191,Zt=Xe>>>13,Fe=U[7]|0,L=Fe&8191,G=Fe>>>13,Y=U[8]|0,J=Y&8191,ot=Y>>>13,ft=U[9]|0,yt=ft&8191,ht=ft>>>13,bt=D[0]|0,vt=bt&8191,ut=bt>>>13,jt=D[1]|0,Kt=jt&8191,Wt=jt>>>13,Ge=D[2]|0,Vt=Ge&8191,Gt=Ge>>>13,On=D[3]|0,te=On&8191,ue=On>>>13,_n=D[4]|0,Ye=_n&8191,Me=_n>>>13,Tn=D[5]|0,an=Tn&8191,le=Tn>>>13,mo=D[6]|0,w=mo&8191,C=mo>>>13,B=D[7]|0,p=B&8191,O=B>>>13,Q=D[8]|0,Z=Q&8191,lt=Q>>>13,kt=D[9]|0,It=kt&8191,St=kt>>>13;k.negative=f.negative^y.negative,k.length=19,I=Math.imul(ct,vt),m=Math.imul(ct,ut),m=m+Math.imul(mt,vt)|0,M=Math.imul(mt,ut);var Ve=(X+I|0)+((m&8191)<<13)|0;X=(M+(m>>>13)|0)+(Ve>>>26)|0,Ve&=67108863,I=Math.imul(Qt,vt),m=Math.imul(Qt,ut),m=m+Math.imul(Ie,vt)|0,M=Math.imul(Ie,ut),I=I+Math.imul(ct,Kt)|0,m=m+Math.imul(ct,Wt)|0,m=m+Math.imul(mt,Kt)|0,M=M+Math.imul(mt,Wt)|0;var Lt=(X+I|0)+((m&8191)<<13)|0;X=(M+(m>>>13)|0)+(Lt>>>26)|0,Lt&=67108863,I=Math.imul(se,vt),m=Math.imul(se,ut),m=m+Math.imul(ae,vt)|0,M=Math.imul(ae,ut),I=I+Math.imul(Qt,Kt)|0,m=m+Math.imul(Qt,Wt)|0,m=m+Math.imul(Ie,Kt)|0,M=M+Math.imul(Ie,Wt)|0,I=I+Math.imul(ct,Vt)|0,m=m+Math.imul(ct,Gt)|0,m=m+Math.imul(mt,Vt)|0,M=M+Math.imul(mt,Gt)|0;var pe=(X+I|0)+((m&8191)<<13)|0;X=(M+(m>>>13)|0)+(pe>>>26)|0,pe&=67108863,I=Math.imul(nt,vt),m=Math.imul(nt,ut),m=m+Math.imul(dt,vt)|0,M=Math.imul(dt,ut),I=I+Math.imul(se,Kt)|0,m=m+Math.imul(se,Wt)|0,m=m+Math.imul(ae,Kt)|0,M=M+Math.imul(ae,Wt)|0,I=I+Math.imul(Qt,Vt)|0,m=m+Math.imul(Qt,Gt)|0,m=m+Math.imul(Ie,Vt)|0,M=M+Math.imul(Ie,Gt)|0,I=I+Math.imul(ct,te)|0,m=m+Math.imul(ct,ue)|0,m=m+Math.imul(mt,te)|0,M=M+Math.imul(mt,ue)|0;var _e=(X+I|0)+((m&8191)<<13)|0;X=(M+(m>>>13)|0)+(_e>>>26)|0,_e&=67108863,I=Math.imul(At,vt),m=Math.imul(At,ut),m=m+Math.imul(Rt,vt)|0,M=Math.imul(Rt,ut),I=I+Math.imul(nt,Kt)|0,m=m+Math.imul(nt,Wt)|0,m=m+Math.imul(dt,Kt)|0,M=M+Math.imul(dt,Wt)|0,I=I+Math.imul(se,Vt)|0,m=m+Math.imul(se,Gt)|0,m=m+Math.imul(ae,Vt)|0,M=M+Math.imul(ae,Gt)|0,I=I+Math.imul(Qt,te)|0,m=m+Math.imul(Qt,ue)|0,m=m+Math.imul(Ie,te)|0,M=M+Math.imul(Ie,ue)|0,I=I+Math.imul(ct,Ye)|0,m=m+Math.imul(ct,Me)|0,m=m+Math.imul(mt,Ye)|0,M=M+Math.imul(mt,Me)|0;var Ae=(X+I|0)+((m&8191)<<13)|0;X=(M+(m>>>13)|0)+(Ae>>>26)|0,Ae&=67108863,I=Math.imul(Nt,vt),m=Math.imul(Nt,ut),m=m+Math.imul(Jt,vt)|0,M=Math.imul(Jt,ut),I=I+Math.imul(At,Kt)|0,m=m+Math.imul(At,Wt)|0,m=m+Math.imul(Rt,Kt)|0,M=M+Math.imul(Rt,Wt)|0,I=I+Math.imul(nt,Vt)|0,m=m+Math.imul(nt,Gt)|0,m=m+Math.imul(dt,Vt)|0,M=M+Math.imul(dt,Gt)|0,I=I+Math.imul(se,te)|0,m=m+Math.imul(se,ue)|0,m=m+Math.imul(ae,te)|0,M=M+Math.imul(ae,ue)|0,I=I+Math.imul(Qt,Ye)|0,m=m+Math.imul(Qt,Me)|0,m=m+Math.imul(Ie,Ye)|0,M=M+Math.imul(Ie,Me)|0,I=I+Math.imul(ct,an)|0,m=m+Math.imul(ct,le)|0,m=m+Math.imul(mt,an)|0,M=M+Math.imul(mt,le)|0;var ve=(X+I|0)+((m&8191)<<13)|0;X=(M+(m>>>13)|0)+(ve>>>26)|0,ve&=67108863,I=Math.imul(ce,vt),m=Math.imul(ce,ut),m=m+Math.imul(Zt,vt)|0,M=Math.imul(Zt,ut),I=I+Math.imul(Nt,Kt)|0,m=m+Math.imul(Nt,Wt)|0,m=m+Math.imul(Jt,Kt)|0,M=M+Math.imul(Jt,Wt)|0,I=I+Math.imul(At,Vt)|0,m=m+Math.imul(At,Gt)|0,m=m+Math.imul(Rt,Vt)|0,M=M+Math.imul(Rt,Gt)|0,I=I+Math.imul(nt,te)|0,m=m+Math.imul(nt,ue)|0,m=m+Math.imul(dt,te)|0,M=M+Math.imul(dt,ue)|0,I=I+Math.imul(se,Ye)|0,m=m+Math.imul(se,Me)|0,m=m+Math.imul(ae,Ye)|0,M=M+Math.imul(ae,Me)|0,I=I+Math.imul(Qt,an)|0,m=m+Math.imul(Qt,le)|0,m=m+Math.imul(Ie,an)|0,M=M+Math.imul(Ie,le)|0,I=I+Math.imul(ct,w)|0,m=m+Math.imul(ct,C)|0,m=m+Math.imul(mt,w)|0,M=M+Math.imul(mt,C)|0;var me=(X+I|0)+((m&8191)<<13)|0;X=(M+(m>>>13)|0)+(me>>>26)|0,me&=67108863,I=Math.imul(L,vt),m=Math.imul(L,ut),m=m+Math.imul(G,vt)|0,M=Math.imul(G,ut),I=I+Math.imul(ce,Kt)|0,m=m+Math.imul(ce,Wt)|0,m=m+Math.imul(Zt,Kt)|0,M=M+Math.imul(Zt,Wt)|0,I=I+Math.imul(Nt,Vt)|0,m=m+Math.imul(Nt,Gt)|0,m=m+Math.imul(Jt,Vt)|0,M=M+Math.imul(Jt,Gt)|0,I=I+Math.imul(At,te)|0,m=m+Math.imul(At,ue)|0,m=m+Math.imul(Rt,te)|0,M=M+Math.imul(Rt,ue)|0,I=I+Math.imul(nt,Ye)|0,m=m+Math.imul(nt,Me)|0,m=m+Math.imul(dt,Ye)|0,M=M+Math.imul(dt,Me)|0,I=I+Math.imul(se,an)|0,m=m+Math.imul(se,le)|0,m=m+Math.imul(ae,an)|0,M=M+Math.imul(ae,le)|0,I=I+Math.imul(Qt,w)|0,m=m+Math.imul(Qt,C)|0,m=m+Math.imul(Ie,w)|0,M=M+Math.imul(Ie,C)|0,I=I+Math.imul(ct,p)|0,m=m+Math.imul(ct,O)|0,m=m+Math.imul(mt,p)|0,M=M+Math.imul(mt,O)|0;var be=(X+I|0)+((m&8191)<<13)|0;X=(M+(m>>>13)|0)+(be>>>26)|0,be&=67108863,I=Math.imul(J,vt),m=Math.imul(J,ut),m=m+Math.imul(ot,vt)|0,M=Math.imul(ot,ut),I=I+Math.imul(L,Kt)|0,m=m+Math.imul(L,Wt)|0,m=m+Math.imul(G,Kt)|0,M=M+Math.imul(G,Wt)|0,I=I+Math.imul(ce,Vt)|0,m=m+Math.imul(ce,Gt)|0,m=m+Math.imul(Zt,Vt)|0,M=M+Math.imul(Zt,Gt)|0,I=I+Math.imul(Nt,te)|0,m=m+Math.imul(Nt,ue)|0,m=m+Math.imul(Jt,te)|0,M=M+Math.imul(Jt,ue)|0,I=I+Math.imul(At,Ye)|0,m=m+Math.imul(At,Me)|0,m=m+Math.imul(Rt,Ye)|0,M=M+Math.imul(Rt,Me)|0,I=I+Math.imul(nt,an)|0,m=m+Math.imul(nt,le)|0,m=m+Math.imul(dt,an)|0,M=M+Math.imul(dt,le)|0,I=I+Math.imul(se,w)|0,m=m+Math.imul(se,C)|0,m=m+Math.imul(ae,w)|0,M=M+Math.imul(ae,C)|0,I=I+Math.imul(Qt,p)|0,m=m+Math.imul(Qt,O)|0,m=m+Math.imul(Ie,p)|0,M=M+Math.imul(Ie,O)|0,I=I+Math.imul(ct,Z)|0,m=m+Math.imul(ct,lt)|0,m=m+Math.imul(mt,Z)|0,M=M+Math.imul(mt,lt)|0;var ye=(X+I|0)+((m&8191)<<13)|0;X=(M+(m>>>13)|0)+(ye>>>26)|0,ye&=67108863,I=Math.imul(yt,vt),m=Math.imul(yt,ut),m=m+Math.imul(ht,vt)|0,M=Math.imul(ht,ut),I=I+Math.imul(J,Kt)|0,m=m+Math.imul(J,Wt)|0,m=m+Math.imul(ot,Kt)|0,M=M+Math.imul(ot,Wt)|0,I=I+Math.imul(L,Vt)|0,m=m+Math.imul(L,Gt)|0,m=m+Math.imul(G,Vt)|0,M=M+Math.imul(G,Gt)|0,I=I+Math.imul(ce,te)|0,m=m+Math.imul(ce,ue)|0,m=m+Math.imul(Zt,te)|0,M=M+Math.imul(Zt,ue)|0,I=I+Math.imul(Nt,Ye)|0,m=m+Math.imul(Nt,Me)|0,m=m+Math.imul(Jt,Ye)|0,M=M+Math.imul(Jt,Me)|0,I=I+Math.imul(At,an)|0,m=m+Math.imul(At,le)|0,m=m+Math.imul(Rt,an)|0,M=M+Math.imul(Rt,le)|0,I=I+Math.imul(nt,w)|0,m=m+Math.imul(nt,C)|0,m=m+Math.imul(dt,w)|0,M=M+Math.imul(dt,C)|0,I=I+Math.imul(se,p)|0,m=m+Math.imul(se,O)|0,m=m+Math.imul(ae,p)|0,M=M+Math.imul(ae,O)|0,I=I+Math.imul(Qt,Z)|0,m=m+Math.imul(Qt,lt)|0,m=m+Math.imul(Ie,Z)|0,M=M+Math.imul(Ie,lt)|0,I=I+Math.imul(ct,It)|0,m=m+Math.imul(ct,St)|0,m=m+Math.imul(mt,It)|0,M=M+Math.imul(mt,St)|0;var Ft=(X+I|0)+((m&8191)<<13)|0;X=(M+(m>>>13)|0)+(Ft>>>26)|0,Ft&=67108863,I=Math.imul(yt,Kt),m=Math.imul(yt,Wt),m=m+Math.imul(ht,Kt)|0,M=Math.imul(ht,Wt),I=I+Math.imul(J,Vt)|0,m=m+Math.imul(J,Gt)|0,m=m+Math.imul(ot,Vt)|0,M=M+Math.imul(ot,Gt)|0,I=I+Math.imul(L,te)|0,m=m+Math.imul(L,ue)|0,m=m+Math.imul(G,te)|0,M=M+Math.imul(G,ue)|0,I=I+Math.imul(ce,Ye)|0,m=m+Math.imul(ce,Me)|0,m=m+Math.imul(Zt,Ye)|0,M=M+Math.imul(Zt,Me)|0,I=I+Math.imul(Nt,an)|0,m=m+Math.imul(Nt,le)|0,m=m+Math.imul(Jt,an)|0,M=M+Math.imul(Jt,le)|0,I=I+Math.imul(At,w)|0,m=m+Math.imul(At,C)|0,m=m+Math.imul(Rt,w)|0,M=M+Math.imul(Rt,C)|0,I=I+Math.imul(nt,p)|0,m=m+Math.imul(nt,O)|0,m=m+Math.imul(dt,p)|0,M=M+Math.imul(dt,O)|0,I=I+Math.imul(se,Z)|0,m=m+Math.imul(se,lt)|0,m=m+Math.imul(ae,Z)|0,M=M+Math.imul(ae,lt)|0,I=I+Math.imul(Qt,It)|0,m=m+Math.imul(Qt,St)|0,m=m+Math.imul(Ie,It)|0,M=M+Math.imul(Ie,St)|0;var Xt=(X+I|0)+((m&8191)<<13)|0;X=(M+(m>>>13)|0)+(Xt>>>26)|0,Xt&=67108863,I=Math.imul(yt,Vt),m=Math.imul(yt,Gt),m=m+Math.imul(ht,Vt)|0,M=Math.imul(ht,Gt),I=I+Math.imul(J,te)|0,m=m+Math.imul(J,ue)|0,m=m+Math.imul(ot,te)|0,M=M+Math.imul(ot,ue)|0,I=I+Math.imul(L,Ye)|0,m=m+Math.imul(L,Me)|0,m=m+Math.imul(G,Ye)|0,M=M+Math.imul(G,Me)|0,I=I+Math.imul(ce,an)|0,m=m+Math.imul(ce,le)|0,m=m+Math.imul(Zt,an)|0,M=M+Math.imul(Zt,le)|0,I=I+Math.imul(Nt,w)|0,m=m+Math.imul(Nt,C)|0,m=m+Math.imul(Jt,w)|0,M=M+Math.imul(Jt,C)|0,I=I+Math.imul(At,p)|0,m=m+Math.imul(At,O)|0,m=m+Math.imul(Rt,p)|0,M=M+Math.imul(Rt,O)|0,I=I+Math.imul(nt,Z)|0,m=m+Math.imul(nt,lt)|0,m=m+Math.imul(dt,Z)|0,M=M+Math.imul(dt,lt)|0,I=I+Math.imul(se,It)|0,m=m+Math.imul(se,St)|0,m=m+Math.imul(ae,It)|0,M=M+Math.imul(ae,St)|0;var Dt=(X+I|0)+((m&8191)<<13)|0;X=(M+(m>>>13)|0)+(Dt>>>26)|0,Dt&=67108863,I=Math.imul(yt,te),m=Math.imul(yt,ue),m=m+Math.imul(ht,te)|0,M=Math.imul(ht,ue),I=I+Math.imul(J,Ye)|0,m=m+Math.imul(J,Me)|0,m=m+Math.imul(ot,Ye)|0,M=M+Math.imul(ot,Me)|0,I=I+Math.imul(L,an)|0,m=m+Math.imul(L,le)|0,m=m+Math.imul(G,an)|0,M=M+Math.imul(G,le)|0,I=I+Math.imul(ce,w)|0,m=m+Math.imul(ce,C)|0,m=m+Math.imul(Zt,w)|0,M=M+Math.imul(Zt,C)|0,I=I+Math.imul(Nt,p)|0,m=m+Math.imul(Nt,O)|0,m=m+Math.imul(Jt,p)|0,M=M+Math.imul(Jt,O)|0,I=I+Math.imul(At,Z)|0,m=m+Math.imul(At,lt)|0,m=m+Math.imul(Rt,Z)|0,M=M+Math.imul(Rt,lt)|0,I=I+Math.imul(nt,It)|0,m=m+Math.imul(nt,St)|0,m=m+Math.imul(dt,It)|0,M=M+Math.imul(dt,St)|0;var zt=(X+I|0)+((m&8191)<<13)|0;X=(M+(m>>>13)|0)+(zt>>>26)|0,zt&=67108863,I=Math.imul(yt,Ye),m=Math.imul(yt,Me),m=m+Math.imul(ht,Ye)|0,M=Math.imul(ht,Me),I=I+Math.imul(J,an)|0,m=m+Math.imul(J,le)|0,m=m+Math.imul(ot,an)|0,M=M+Math.imul(ot,le)|0,I=I+Math.imul(L,w)|0,m=m+Math.imul(L,C)|0,m=m+Math.imul(G,w)|0,M=M+Math.imul(G,C)|0,I=I+Math.imul(ce,p)|0,m=m+Math.imul(ce,O)|0,m=m+Math.imul(Zt,p)|0,M=M+Math.imul(Zt,O)|0,I=I+Math.imul(Nt,Z)|0,m=m+Math.imul(Nt,lt)|0,m=m+Math.imul(Jt,Z)|0,M=M+Math.imul(Jt,lt)|0,I=I+Math.imul(At,It)|0,m=m+Math.imul(At,St)|0,m=m+Math.imul(Rt,It)|0,M=M+Math.imul(Rt,St)|0;var Ht=(X+I|0)+((m&8191)<<13)|0;X=(M+(m>>>13)|0)+(Ht>>>26)|0,Ht&=67108863,I=Math.imul(yt,an),m=Math.imul(yt,le),m=m+Math.imul(ht,an)|0,M=Math.imul(ht,le),I=I+Math.imul(J,w)|0,m=m+Math.imul(J,C)|0,m=m+Math.imul(ot,w)|0,M=M+Math.imul(ot,C)|0,I=I+Math.imul(L,p)|0,m=m+Math.imul(L,O)|0,m=m+Math.imul(G,p)|0,M=M+Math.imul(G,O)|0,I=I+Math.imul(ce,Z)|0,m=m+Math.imul(ce,lt)|0,m=m+Math.imul(Zt,Z)|0,M=M+Math.imul(Zt,lt)|0,I=I+Math.imul(Nt,It)|0,m=m+Math.imul(Nt,St)|0,m=m+Math.imul(Jt,It)|0,M=M+Math.imul(Jt,St)|0;var $t=(X+I|0)+((m&8191)<<13)|0;X=(M+(m>>>13)|0)+($t>>>26)|0,$t&=67108863,I=Math.imul(yt,w),m=Math.imul(yt,C),m=m+Math.imul(ht,w)|0,M=Math.imul(ht,C),I=I+Math.imul(J,p)|0,m=m+Math.imul(J,O)|0,m=m+Math.imul(ot,p)|0,M=M+Math.imul(ot,O)|0,I=I+Math.imul(L,Z)|0,m=m+Math.imul(L,lt)|0,m=m+Math.imul(G,Z)|0,M=M+Math.imul(G,lt)|0,I=I+Math.imul(ce,It)|0,m=m+Math.imul(ce,St)|0,m=m+Math.imul(Zt,It)|0,M=M+Math.imul(Zt,St)|0;var st=(X+I|0)+((m&8191)<<13)|0;X=(M+(m>>>13)|0)+(st>>>26)|0,st&=67108863,I=Math.imul(yt,p),m=Math.imul(yt,O),m=m+Math.imul(ht,p)|0,M=Math.imul(ht,O),I=I+Math.imul(J,Z)|0,m=m+Math.imul(J,lt)|0,m=m+Math.imul(ot,Z)|0,M=M+Math.imul(ot,lt)|0,I=I+Math.imul(L,It)|0,m=m+Math.imul(L,St)|0,m=m+Math.imul(G,It)|0,M=M+Math.imul(G,St)|0;var rt=(X+I|0)+((m&8191)<<13)|0;X=(M+(m>>>13)|0)+(rt>>>26)|0,rt&=67108863,I=Math.imul(yt,Z),m=Math.imul(yt,lt),m=m+Math.imul(ht,Z)|0,M=Math.imul(ht,lt),I=I+Math.imul(J,It)|0,m=m+Math.imul(J,St)|0,m=m+Math.imul(ot,It)|0,M=M+Math.imul(ot,St)|0;var wt=(X+I|0)+((m&8191)<<13)|0;X=(M+(m>>>13)|0)+(wt>>>26)|0,wt&=67108863,I=Math.imul(yt,It),m=Math.imul(yt,St),m=m+Math.imul(ht,It)|0,M=Math.imul(ht,St);var pt=(X+I|0)+((m&8191)<<13)|0;return X=(M+(m>>>13)|0)+(pt>>>26)|0,pt&=67108863,z[0]=Ve,z[1]=Lt,z[2]=pe,z[3]=_e,z[4]=Ae,z[5]=ve,z[6]=me,z[7]=be,z[8]=ye,z[9]=Ft,z[10]=Xt,z[11]=Dt,z[12]=zt,z[13]=Ht,z[14]=$t,z[15]=st,z[16]=rt,z[17]=wt,z[18]=pt,X!==0&&(z[19]=X,k.length++),k};Math.imul||(E=P);function S(A,f,y){y.negative=f.negative^A.negative,y.length=A.length+f.length;for(var k=0,U=0,D=0;D<y.length-1;D++){var z=U;U=0;for(var X=k&67108863,I=Math.min(D,f.length-1),m=Math.max(0,D-A.length+1);m<=I;m++){var M=D-m,Tt=A.words[M]|0,ct=f.words[m]|0,mt=Tt*ct,oe=mt&67108863;z=z+(mt/67108864|0)|0,oe=oe+X|0,X=oe&67108863,z=z+(oe>>>26)|0,U+=z>>>26,z&=67108863}y.words[D]=X,k=z,z=U}return k!==0?y.words[D]=k:y.length--,y._strip()}function T(A,f,y){return S(A,f,y)}s.prototype.mulTo=function(f,y){var k,U=this.length+f.length;return this.length===10&&f.length===10?k=E(this,f,y):U<63?k=P(this,f,y):U<1024?k=S(this,f,y):k=T(this,f,y),k},s.prototype.mul=function(f){var y=new s(null);return y.words=new Array(this.length+f.length),this.mulTo(f,y)},s.prototype.mulf=function(f){var y=new s(null);return y.words=new Array(this.length+f.length),T(this,f,y)},s.prototype.imul=function(f){return this.clone().mulTo(f,this)},s.prototype.imuln=function(f){var y=f<0;y&&(f=-f),i(typeof f=="number"),i(f<67108864);for(var k=0,U=0;U<this.length;U++){var D=(this.words[U]|0)*f,z=(D&67108863)+(k&67108863);k>>=26,k+=D/67108864|0,k+=z>>>26,this.words[U]=z&67108863}return k!==0&&(this.words[U]=k,this.length++),y?this.ineg():this},s.prototype.muln=function(f){return this.clone().imuln(f)},s.prototype.sqr=function(){return this.mul(this)},s.prototype.isqr=function(){return this.imul(this.clone())},s.prototype.pow=function(f){var y=x(f);if(y.length===0)return new s(1);for(var k=this,U=0;U<y.length&&y[U]===0;U++,k=k.sqr());if(++U<y.length)for(var D=k.sqr();U<y.length;U++,D=D.sqr())y[U]!==0&&(k=k.mul(D));return k},s.prototype.iushln=function(f){i(typeof f=="number"&&f>=0);var y=f%26,k=(f-y)/26,U=67108863>>>26-y<<26-y,D;if(y!==0){var z=0;for(D=0;D<this.length;D++){var X=this.words[D]&U,I=(this.words[D]|0)-X<<y;this.words[D]=I|z,z=X>>>26-y}z&&(this.words[D]=z,this.length++)}if(k!==0){for(D=this.length-1;D>=0;D--)this.words[D+k]=this.words[D];for(D=0;D<k;D++)this.words[D]=0;this.length+=k}return this._strip()},s.prototype.ishln=function(f){return i(this.negative===0),this.iushln(f)},s.prototype.iushrn=function(f,y,k){i(typeof f=="number"&&f>=0);var U;y?U=(y-y%26)/26:U=0;var D=f%26,z=Math.min((f-D)/26,this.length),X=67108863^67108863>>>D<<D,I=k;if(U-=z,U=Math.max(0,U),I){for(var m=0;m<z;m++)I.words[m]=this.words[m];I.length=z}if(z!==0)if(this.length>z)for(this.length-=z,m=0;m<this.length;m++)this.words[m]=this.words[m+z];else this.words[0]=0,this.length=1;var M=0;for(m=this.length-1;m>=0&&(M!==0||m>=U);m--){var Tt=this.words[m]|0;this.words[m]=M<<26-D|Tt>>>D,M=Tt&X}return I&&M!==0&&(I.words[I.length++]=M),this.length===0&&(this.words[0]=0,this.length=1),this._strip()},s.prototype.ishrn=function(f,y,k){return i(this.negative===0),this.iushrn(f,y,k)},s.prototype.shln=function(f){return this.clone().ishln(f)},s.prototype.ushln=function(f){return this.clone().iushln(f)},s.prototype.shrn=function(f){return this.clone().ishrn(f)},s.prototype.ushrn=function(f){return this.clone().iushrn(f)},s.prototype.testn=function(f){i(typeof f=="number"&&f>=0);var y=f%26,k=(f-y)/26,U=1<<y;if(this.length<=k)return!1;var D=this.words[k];return!!(D&U)},s.prototype.imaskn=function(f){i(typeof f=="number"&&f>=0);var y=f%26,k=(f-y)/26;if(i(this.negative===0,"imaskn works only with positive numbers"),this.length<=k)return this;if(y!==0&&k++,this.length=Math.min(k,this.length),y!==0){var U=67108863^67108863>>>y<<y;this.words[this.length-1]&=U}return this._strip()},s.prototype.maskn=function(f){return this.clone().imaskn(f)},s.prototype.iaddn=function(f){return i(typeof f=="number"),i(f<67108864),f<0?this.isubn(-f):this.negative!==0?this.length===1&&(this.words[0]|0)<=f?(this.words[0]=f-(this.words[0]|0),this.negative=0,this):(this.negative=0,this.isubn(f),this.negative=1,this):this._iaddn(f)},s.prototype._iaddn=function(f){this.words[0]+=f;for(var y=0;y<this.length&&this.words[y]>=67108864;y++)this.words[y]-=67108864,y===this.length-1?this.words[y+1]=1:this.words[y+1]++;return this.length=Math.max(this.length,y+1),this},s.prototype.isubn=function(f){if(i(typeof f=="number"),i(f<67108864),f<0)return this.iaddn(-f);if(this.negative!==0)return this.negative=0,this.iaddn(f),this.negative=1,this;if(this.words[0]-=f,this.length===1&&this.words[0]<0)this.words[0]=-this.words[0],this.negative=1;else for(var y=0;y<this.length&&this.words[y]<0;y++)this.words[y]+=67108864,this.words[y+1]-=1;return this._strip()},s.prototype.addn=function(f){return this.clone().iaddn(f)},s.prototype.subn=function(f){return this.clone().isubn(f)},s.prototype.iabs=function(){return this.negative=0,this},s.prototype.abs=function(){return this.clone().iabs()},s.prototype._ishlnsubmul=function(f,y,k){var U=f.length+k,D;this._expand(U);var z,X=0;for(D=0;D<f.length;D++){z=(this.words[D+k]|0)+X;var I=(f.words[D]|0)*y;z-=I&67108863,X=(z>>26)-(I/67108864|0),this.words[D+k]=z&67108863}for(;D<this.length-k;D++)z=(this.words[D+k]|0)+X,X=z>>26,this.words[D+k]=z&67108863;if(X===0)return this._strip();for(i(X===-1),X=0,D=0;D<this.length;D++)z=-(this.words[D]|0)+X,X=z>>26,this.words[D]=z&67108863;return this.negative=1,this._strip()},s.prototype._wordDiv=function(f,y){var k=this.length-f.length,U=this.clone(),D=f,z=D.words[D.length-1]|0,X=this._countBits(z);k=26-X,k!==0&&(D=D.ushln(k),U.iushln(k),z=D.words[D.length-1]|0);var I=U.length-D.length,m;if(y!=="mod"){m=new s(null),m.length=I+1,m.words=new Array(m.length);for(var M=0;M<m.length;M++)m.words[M]=0}var Tt=U.clone()._ishlnsubmul(D,1,I);Tt.negative===0&&(U=Tt,m&&(m.words[I]=1));for(var ct=I-1;ct>=0;ct--){var mt=(U.words[D.length+ct]|0)*67108864+(U.words[D.length+ct-1]|0);for(mt=Math.min(mt/z|0,67108863),U._ishlnsubmul(D,mt,ct);U.negative!==0;)mt--,U.negative=0,U._ishlnsubmul(D,1,ct),U.isZero()||(U.negative^=1);m&&(m.words[ct]=mt)}return m&&m._strip(),U._strip(),y!=="div"&&k!==0&&U.iushrn(k),{div:m||null,mod:U}},s.prototype.divmod=function(f,y,k){if(i(!f.isZero()),this.isZero())return{div:new s(0),mod:new s(0)};var U,D,z;return this.negative!==0&&f.negative===0?(z=this.neg().divmod(f,y),y!=="mod"&&(U=z.div.neg()),y!=="div"&&(D=z.mod.neg(),k&&D.negative!==0&&D.iadd(f)),{div:U,mod:D}):this.negative===0&&f.negative!==0?(z=this.divmod(f.neg(),y),y!=="mod"&&(U=z.div.neg()),{div:U,mod:z.mod}):this.negative&f.negative?(z=this.neg().divmod(f.neg(),y),y!=="div"&&(D=z.mod.neg(),k&&D.negative!==0&&D.isub(f)),{div:z.div,mod:D}):f.length>this.length||this.cmp(f)<0?{div:new s(0),mod:this}:f.length===1?y==="div"?{div:this.divn(f.words[0]),mod:null}:y==="mod"?{div:null,mod:new s(this.modrn(f.words[0]))}:{div:this.divn(f.words[0]),mod:new s(this.modrn(f.words[0]))}:this._wordDiv(f,y)},s.prototype.div=function(f){return this.divmod(f,"div",!1).div},s.prototype.mod=function(f){return this.divmod(f,"mod",!1).mod},s.prototype.umod=function(f){return this.divmod(f,"mod",!0).mod},s.prototype.divRound=function(f){var y=this.divmod(f);if(y.mod.isZero())return y.div;var k=y.div.negative!==0?y.mod.isub(f):y.mod,U=f.ushrn(1),D=f.andln(1),z=k.cmp(U);return z<0||D===1&&z===0?y.div:y.div.negative!==0?y.div.isubn(1):y.div.iaddn(1)},s.prototype.modrn=function(f){var y=f<0;y&&(f=-f),i(f<=67108863);for(var k=(1<<26)%f,U=0,D=this.length-1;D>=0;D--)U=(k*U+(this.words[D]|0))%f;return y?-U:U},s.prototype.modn=function(f){return this.modrn(f)},s.prototype.idivn=function(f){var y=f<0;y&&(f=-f),i(f<=67108863);for(var k=0,U=this.length-1;U>=0;U--){var D=(this.words[U]|0)+k*67108864;this.words[U]=D/f|0,k=D%f}return this._strip(),y?this.ineg():this},s.prototype.divn=function(f){return this.clone().idivn(f)},s.prototype.egcd=function(f){i(f.negative===0),i(!f.isZero());var y=this,k=f.clone();y.negative!==0?y=y.umod(f):y=y.clone();for(var U=new s(1),D=new s(0),z=new s(0),X=new s(1),I=0;y.isEven()&&k.isEven();)y.iushrn(1),k.iushrn(1),++I;for(var m=k.clone(),M=y.clone();!y.isZero();){for(var Tt=0,ct=1;!(y.words[0]&ct)&&Tt<26;++Tt,ct<<=1);if(Tt>0)for(y.iushrn(Tt);Tt-- >0;)(U.isOdd()||D.isOdd())&&(U.iadd(m),D.isub(M)),U.iushrn(1),D.iushrn(1);for(var mt=0,oe=1;!(k.words[0]&oe)&&mt<26;++mt,oe<<=1);if(mt>0)for(k.iushrn(mt);mt-- >0;)(z.isOdd()||X.isOdd())&&(z.iadd(m),X.isub(M)),z.iushrn(1),X.iushrn(1);y.cmp(k)>=0?(y.isub(k),U.isub(z),D.isub(X)):(k.isub(y),z.isub(U),X.isub(D))}return{a:z,b:X,gcd:k.iushln(I)}},s.prototype._invmp=function(f){i(f.negative===0),i(!f.isZero());var y=this,k=f.clone();y.negative!==0?y=y.umod(f):y=y.clone();for(var U=new s(1),D=new s(0),z=k.clone();y.cmpn(1)>0&&k.cmpn(1)>0;){for(var X=0,I=1;!(y.words[0]&I)&&X<26;++X,I<<=1);if(X>0)for(y.iushrn(X);X-- >0;)U.isOdd()&&U.iadd(z),U.iushrn(1);for(var m=0,M=1;!(k.words[0]&M)&&m<26;++m,M<<=1);if(m>0)for(k.iushrn(m);m-- >0;)D.isOdd()&&D.iadd(z),D.iushrn(1);y.cmp(k)>=0?(y.isub(k),U.isub(D)):(k.isub(y),D.isub(U))}var Tt;return y.cmpn(1)===0?Tt=U:Tt=D,Tt.cmpn(0)<0&&Tt.iadd(f),Tt},s.prototype.gcd=function(f){if(this.isZero())return f.abs();if(f.isZero())return this.abs();var y=this.clone(),k=f.clone();y.negative=0,k.negative=0;for(var U=0;y.isEven()&&k.isEven();U++)y.iushrn(1),k.iushrn(1);do{for(;y.isEven();)y.iushrn(1);for(;k.isEven();)k.iushrn(1);var D=y.cmp(k);if(D<0){var z=y;y=k,k=z}else if(D===0||k.cmpn(1)===0)break;y.isub(k)}while(!0);return k.iushln(U)},s.prototype.invm=function(f){return this.egcd(f).a.umod(f)},s.prototype.isEven=function(){return(this.words[0]&1)===0},s.prototype.isOdd=function(){return(this.words[0]&1)===1},s.prototype.andln=function(f){return this.words[0]&f},s.prototype.bincn=function(f){i(typeof f=="number");var y=f%26,k=(f-y)/26,U=1<<y;if(this.length<=k)return this._expand(k+1),this.words[k]|=U,this;for(var D=U,z=k;D!==0&&z<this.length;z++){var X=this.words[z]|0;X+=D,D=X>>>26,X&=67108863,this.words[z]=X}return D!==0&&(this.words[z]=D,this.length++),this},s.prototype.isZero=function(){return this.length===1&&this.words[0]===0},s.prototype.cmpn=function(f){var y=f<0;if(this.negative!==0&&!y)return-1;if(this.negative===0&&y)return 1;this._strip();var k;if(this.length>1)k=1;else{y&&(f=-f),i(f<=67108863,"Number is too big");var U=this.words[0]|0;k=U===f?0:U<f?-1:1}return this.negative!==0?-k|0:k},s.prototype.cmp=function(f){if(this.negative!==0&&f.negative===0)return-1;if(this.negative===0&&f.negative!==0)return 1;var y=this.ucmp(f);return this.negative!==0?-y|0:y},s.prototype.ucmp=function(f){if(this.length>f.length)return 1;if(this.length<f.length)return-1;for(var y=0,k=this.length-1;k>=0;k--){var U=this.words[k]|0,D=f.words[k]|0;if(U!==D){U<D?y=-1:U>D&&(y=1);break}}return y},s.prototype.gtn=function(f){return this.cmpn(f)===1},s.prototype.gt=function(f){return this.cmp(f)===1},s.prototype.gten=function(f){return this.cmpn(f)>=0},s.prototype.gte=function(f){return this.cmp(f)>=0},s.prototype.ltn=function(f){return this.cmpn(f)===-1},s.prototype.lt=function(f){return this.cmp(f)===-1},s.prototype.lten=function(f){return this.cmpn(f)<=0},s.prototype.lte=function(f){return this.cmp(f)<=0},s.prototype.eqn=function(f){return this.cmpn(f)===0},s.prototype.eq=function(f){return this.cmp(f)===0},s.red=function(f){return new $(f)},s.prototype.toRed=function(f){return i(!this.red,"Already a number in reduction context"),i(this.negative===0,"red works only with positives"),f.convertTo(this)._forceRed(f)},s.prototype.fromRed=function(){return i(this.red,"fromRed works only with numbers in reduction context"),this.red.convertFrom(this)},s.prototype._forceRed=function(f){return this.red=f,this},s.prototype.forceRed=function(f){return i(!this.red,"Already a number in reduction context"),this._forceRed(f)},s.prototype.redAdd=function(f){return i(this.red,"redAdd works only with red numbers"),this.red.add(this,f)},s.prototype.redIAdd=function(f){return i(this.red,"redIAdd works only with red numbers"),this.red.iadd(this,f)},s.prototype.redSub=function(f){return i(this.red,"redSub works only with red numbers"),this.red.sub(this,f)},s.prototype.redISub=function(f){return i(this.red,"redISub works only with red numbers"),this.red.isub(this,f)},s.prototype.redShl=function(f){return i(this.red,"redShl works only with red numbers"),this.red.shl(this,f)},s.prototype.redMul=function(f){return i(this.red,"redMul works only with red numbers"),this.red._verify2(this,f),this.red.mul(this,f)},s.prototype.redIMul=function(f){return i(this.red,"redMul works only with red numbers"),this.red._verify2(this,f),this.red.imul(this,f)},s.prototype.redSqr=function(){return i(this.red,"redSqr works only with red numbers"),this.red._verify1(this),this.red.sqr(this)},s.prototype.redISqr=function(){return i(this.red,"redISqr works only with red numbers"),this.red._verify1(this),this.red.isqr(this)},s.prototype.redSqrt=function(){return i(this.red,"redSqrt works only with red numbers"),this.red._verify1(this),this.red.sqrt(this)},s.prototype.redInvm=function(){return i(this.red,"redInvm works only with red numbers"),this.red._verify1(this),this.red.invm(this)},s.prototype.redNeg=function(){return i(this.red,"redNeg works only with red numbers"),this.red._verify1(this),this.red.neg(this)},s.prototype.redPow=function(f){return i(this.red&&!f.red,"redPow(normalNum)"),this.red._verify1(this),this.red.pow(this,f)};var R={k256:null,p224:null,p192:null,p25519:null};function K(A,f){this.name=A,this.p=new s(f,16),this.n=this.p.bitLength(),this.k=new s(1).iushln(this.n).isub(this.p),this.tmp=this._tmp()}K.prototype._tmp=function(){var f=new s(null);return f.words=new Array(Math.ceil(this.n/13)),f},K.prototype.ireduce=function(f){var y=f,k;do this.split(y,this.tmp),y=this.imulK(y),y=y.iadd(this.tmp),k=y.bitLength();while(k>this.n);var U=k<this.n?-1:y.ucmp(this.p);return U===0?(y.words[0]=0,y.length=1):U>0?y.isub(this.p):y.strip!==void 0?y.strip():y._strip(),y},K.prototype.split=function(f,y){f.iushrn(this.n,0,y)},K.prototype.imulK=function(f){return f.imul(this.k)};function V(){K.call(this,"k256","ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f")}o(V,K),V.prototype.split=function(f,y){for(var k=4194303,U=Math.min(f.length,9),D=0;D<U;D++)y.words[D]=f.words[D];if(y.length=U,f.length<=9){f.words[0]=0,f.length=1;return}var z=f.words[9];for(y.words[y.length++]=z&k,D=10;D<f.length;D++){var X=f.words[D]|0;f.words[D-10]=(X&k)<<4|z>>>22,z=X}z>>>=22,f.words[D-10]=z,z===0&&f.length>10?f.length-=10:f.length-=9},V.prototype.imulK=function(f){f.words[f.length]=0,f.words[f.length+1]=0,f.length+=2;for(var y=0,k=0;k<f.length;k++){var U=f.words[k]|0;y+=U*977,f.words[k]=y&67108863,y=U*64+(y/67108864|0)}return f.words[f.length-1]===0&&(f.length--,f.words[f.length-1]===0&&f.length--),f};function W(){K.call(this,"p224","ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001")}o(W,K);function tt(){K.call(this,"p192","ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff")}o(tt,K);function j(){K.call(this,"25519","7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed")}o(j,K),j.prototype.imulK=function(f){for(var y=0,k=0;k<f.length;k++){var U=(f.words[k]|0)*19+y,D=U&67108863;U>>>=26,f.words[k]=D,y=U}return y!==0&&(f.words[f.length++]=y),f},s._prime=function(f){if(R[f])return R[f];var y;if(f==="k256")y=new V;else if(f==="p224")y=new W;else if(f==="p192")y=new tt;else if(f==="p25519")y=new j;else throw new Error("Unknown prime "+f);return R[f]=y,y};function $(A){if(typeof A=="string"){var f=s._prime(A);this.m=f.p,this.prime=f}else i(A.gtn(1),"modulus must be greater than 1"),this.m=A,this.prime=null}$.prototype._verify1=function(f){i(f.negative===0,"red works only with positives"),i(f.red,"red works only with red numbers")},$.prototype._verify2=function(f,y){i((f.negative|y.negative)===0,"red works only with positives"),i(f.red&&f.red===y.red,"red works only with red numbers")},$.prototype.imod=function(f){return this.prime?this.prime.ireduce(f)._forceRed(this):(l(f,f.umod(this.m)._forceRed(this)),f)},$.prototype.neg=function(f){return f.isZero()?f.clone():this.m.sub(f)._forceRed(this)},$.prototype.add=function(f,y){this._verify2(f,y);var k=f.add(y);return k.cmp(this.m)>=0&&k.isub(this.m),k._forceRed(this)},$.prototype.iadd=function(f,y){this._verify2(f,y);var k=f.iadd(y);return k.cmp(this.m)>=0&&k.isub(this.m),k},$.prototype.sub=function(f,y){this._verify2(f,y);var k=f.sub(y);return k.cmpn(0)<0&&k.iadd(this.m),k._forceRed(this)},$.prototype.isub=function(f,y){this._verify2(f,y);var k=f.isub(y);return k.cmpn(0)<0&&k.iadd(this.m),k},$.prototype.shl=function(f,y){return this._verify1(f),this.imod(f.ushln(y))},$.prototype.imul=function(f,y){return this._verify2(f,y),this.imod(f.imul(y))},$.prototype.mul=function(f,y){return this._verify2(f,y),this.imod(f.mul(y))},$.prototype.isqr=function(f){return this.imul(f,f.clone())},$.prototype.sqr=function(f){return this.mul(f,f)},$.prototype.sqrt=function(f){if(f.isZero())return f.clone();var y=this.m.andln(3);if(i(y%2===1),y===3){var k=this.m.add(new s(1)).iushrn(2);return this.pow(f,k)}for(var U=this.m.subn(1),D=0;!U.isZero()&&U.andln(1)===0;)D++,U.iushrn(1);i(!U.isZero());var z=new s(1).toRed(this),X=z.redNeg(),I=this.m.subn(1).iushrn(1),m=this.m.bitLength();for(m=new s(2*m*m).toRed(this);this.pow(m,I).cmp(X)!==0;)m.redIAdd(X);for(var M=this.pow(m,U),Tt=this.pow(f,U.addn(1).iushrn(1)),ct=this.pow(f,U),mt=D;ct.cmp(z)!==0;){for(var oe=ct,Qt=0;oe.cmp(z)!==0;Qt++)oe=oe.redSqr();i(Qt<mt);var Ie=this.pow(M,new s(1).iushln(mt-Qt-1));Tt=Tt.redMul(Ie),M=Ie.redSqr(),ct=ct.redMul(M),mt=Qt}return Tt},$.prototype.invm=function(f){var y=f._invmp(this.m);return y.negative!==0?(y.negative=0,this.imod(y).redNeg()):this.imod(y)},$.prototype.pow=function(f,y){if(y.isZero())return new s(1).toRed(this);if(y.cmpn(1)===0)return f.clone();var k=4,U=new Array(1<<k);U[0]=new s(1).toRed(this),U[1]=f;for(var D=2;D<U.length;D++)U[D]=this.mul(U[D-1],f);var z=U[0],X=0,I=0,m=y.bitLength()%26;for(m===0&&(m=26),D=y.length-1;D>=0;D--){for(var M=y.words[D],Tt=m-1;Tt>=0;Tt--){var ct=M>>Tt&1;if(z!==U[0]&&(z=this.sqr(z)),ct===0&&X===0){I=0;continue}X<<=1,X|=ct,I++,!(I!==k&&(D!==0||Tt!==0))&&(z=this.mul(z,U[X]),I=0,X=0)}m=26}return z},$.prototype.convertTo=function(f){var y=f.umod(this.m);return y===f?y.clone():y},$.prototype.convertFrom=function(f){var y=f.clone();return y.red=null,y},s.mont=function(f){return new q(f)};function q(A){$.call(this,A),this.shift=this.m.bitLength(),this.shift%26!==0&&(this.shift+=26-this.shift%26),this.r=new s(1).iushln(this.shift),this.r2=this.imod(this.r.sqr()),this.rinv=this.r._invmp(this.m),this.minv=this.rinv.mul(this.r).isubn(1).div(this.m),this.minv=this.minv.umod(this.r),this.minv=this.r.sub(this.minv)}o(q,$),q.prototype.convertTo=function(f){return this.imod(f.ushln(this.shift))},q.prototype.convertFrom=function(f){var y=this.imod(f.mul(this.rinv));return y.red=null,y},q.prototype.imul=function(f,y){if(f.isZero()||y.isZero())return f.words[0]=0,f.length=1,f;var k=f.imul(y),U=k.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),D=k.isub(U).iushrn(this.shift),z=D;return D.cmp(this.m)>=0?z=D.isub(this.m):D.cmpn(0)<0&&(z=D.iadd(this.m)),z._forceRed(this)},q.prototype.mul=function(f,y){if(f.isZero()||y.isZero())return new s(0)._forceRed(this);var k=f.mul(y),U=k.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),D=k.isub(U).iushrn(this.shift),z=D;return D.cmp(this.m)>=0?z=D.isub(this.m):D.cmpn(0)<0&&(z=D.iadd(this.m)),z._forceRed(this)},q.prototype.invm=function(f){var y=this.imod(f._invmp(this.m).mul(this.r2));return y._forceRed(this)}})(e,Pm)})(Nx);var Fx="Invariant failed";function jx(e,t){if(!e)throw new Error(Fx)}const B_="3.7.5",zx=B_,Hx=typeof atob=="function",Kx=typeof btoa=="function",qr=typeof Buffer=="function",Hh=typeof TextDecoder=="function"?new TextDecoder:void 0,Kh=typeof TextEncoder=="function"?new TextEncoder:void 0,Gx="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",Wr=Array.prototype.slice.call(Gx),Ha=(e=>{let t={};return e.forEach((n,i)=>t[n]=i),t})(Wr),Wx=/^(?:[A-Za-z\d+\/]{4})*?(?:[A-Za-z\d+\/]{2}(?:==)?|[A-Za-z\d+\/]{3}=?)?$/,Jn=String.fromCharCode.bind(String),Gh=typeof Uint8Array.from=="function"?Uint8Array.from.bind(Uint8Array):e=>new Uint8Array(Array.prototype.slice.call(e,0)),E_=e=>e.replace(/=/g,"").replace(/[+\/]/g,t=>t=="+"?"-":"_"),I_=e=>e.replace(/[^A-Za-z0-9\+\/]/g,""),O_=e=>{let t,n,i,o,s="";const r=e.length%3;for(let a=0;a<e.length;){if((n=e.charCodeAt(a++))>255||(i=e.charCodeAt(a++))>255||(o=e.charCodeAt(a++))>255)throw new TypeError("invalid character found");t=n<<16|i<<8|o,s+=Wr[t>>18&63]+Wr[t>>12&63]+Wr[t>>6&63]+Wr[t&63]}return r?s.slice(0,r-3)+"===".substring(r):s},Yd=Kx?e=>btoa(e):qr?e=>Buffer.from(e,"binary").toString("base64"):O_,Wl=qr?e=>Buffer.from(e).toString("base64"):e=>{let n=[];for(let i=0,o=e.length;i<o;i+=4096)n.push(Jn.apply(null,e.subarray(i,i+4096)));return Yd(n.join(""))},hc=(e,t=!1)=>t?E_(Wl(e)):Wl(e),Xx=e=>{if(e.length<2){var t=e.charCodeAt(0);return t<128?e:t<2048?Jn(192|t>>>6)+Jn(128|t&63):Jn(224|t>>>12&15)+Jn(128|t>>>6&63)+Jn(128|t&63)}else{var t=65536+(e.charCodeAt(0)-55296)*1024+(e.charCodeAt(1)-56320);return Jn(240|t>>>18&7)+Jn(128|t>>>12&63)+Jn(128|t>>>6&63)+Jn(128|t&63)}},Vx=/[\uD800-\uDBFF][\uDC00-\uDFFFF]|[^\x00-\x7F]/g,R_=e=>e.replace(Vx,Xx),Wh=qr?e=>Buffer.from(e,"utf8").toString("base64"):Kh?e=>Wl(Kh.encode(e)):e=>Yd(R_(e)),or=(e,t=!1)=>t?E_(Wh(e)):Wh(e),Xh=e=>or(e,!0),Jx=/[\xC0-\xDF][\x80-\xBF]|[\xE0-\xEF][\x80-\xBF]{2}|[\xF0-\xF7][\x80-\xBF]{3}/g,Zx=e=>{switch(e.length){case 4:var t=(7&e.charCodeAt(0))<<18|(63&e.charCodeAt(1))<<12|(63&e.charCodeAt(2))<<6|63&e.charCodeAt(3),n=t-65536;return Jn((n>>>10)+55296)+Jn((n&1023)+56320);case 3:return Jn((15&e.charCodeAt(0))<<12|(63&e.charCodeAt(1))<<6|63&e.charCodeAt(2));default:return Jn((31&e.charCodeAt(0))<<6|63&e.charCodeAt(1))}},$_=e=>e.replace(Jx,Zx),U_=e=>{if(e=e.replace(/\s+/g,""),!Wx.test(e))throw new TypeError("malformed base64.");e+="==".slice(2-(e.length&3));let t,n="",i,o;for(let s=0;s<e.length;)t=Ha[e.charAt(s++)]<<18|Ha[e.charAt(s++)]<<12|(i=Ha[e.charAt(s++)])<<6|(o=Ha[e.charAt(s++)]),n+=i===64?Jn(t>>16&255):o===64?Jn(t>>16&255,t>>8&255):Jn(t>>16&255,t>>8&255,t&255);return n},Qd=Hx?e=>atob(I_(e)):qr?e=>Buffer.from(e,"base64").toString("binary"):U_,q_=qr?e=>Gh(Buffer.from(e,"base64")):e=>Gh(Qd(e).split("").map(t=>t.charCodeAt(0))),M_=e=>q_(D_(e)),Yx=qr?e=>Buffer.from(e,"base64").toString("utf8"):Hh?e=>Hh.decode(q_(e)):e=>$_(Qd(e)),D_=e=>I_(e.replace(/[-_]/g,t=>t=="-"?"+":"/")),Xl=e=>Yx(D_(e)),Qx=e=>{if(typeof e!="string")return!1;const t=e.replace(/\s+/g,"").replace(/={0,2}$/,"");return!/[^\s0-9a-zA-Z\+/]/.test(t)||!/[^\s0-9a-zA-Z\-_]/.test(t)},L_=e=>({value:e,enumerable:!1,writable:!0,configurable:!0}),N_=function(){const e=(t,n)=>Object.defineProperty(String.prototype,t,L_(n));e("fromBase64",function(){return Xl(this)}),e("toBase64",function(t){return or(this,t)}),e("toBase64URI",function(){return or(this,!0)}),e("toBase64URL",function(){return or(this,!0)}),e("toUint8Array",function(){return M_(this)})},F_=function(){const e=(t,n)=>Object.defineProperty(Uint8Array.prototype,t,L_(n));e("toBase64",function(t){return hc(this,t)}),e("toBase64URI",function(){return hc(this,!0)}),e("toBase64URL",function(){return hc(this,!0)})},t6=()=>{N_(),F_()},sr={version:B_,VERSION:zx,atob:Qd,atobPolyfill:U_,btoa:Yd,btoaPolyfill:O_,fromBase64:Xl,toBase64:or,encode:or,encodeURI:Xh,encodeURL:Xh,utob:R_,btou:$_,decode:Xl,isValid:Qx,fromUint8Array:hc,toUint8Array:M_,extendString:N_,extendUint8Array:F_,extendBuiltins:t6};function ml(e,t){var n={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},i,o,s,r;return r={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(r[Symbol.iterator]=function(){return this}),r;function a(u){return function(l){return c([u,l])}}function c(u){if(i)throw new TypeError("Generator is already executing.");for(;r&&(r=0,u[0]&&(n=0)),n;)try{if(i=1,o&&(s=u[0]&2?o.return:u[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,u[1])).done)return s;switch(o=0,s&&(u=[u[0]&2,s.value]),u[0]){case 0:case 1:s=u;break;case 4:return n.label++,{value:u[1],done:!1};case 5:n.label++,o=u[1],u=[0];continue;case 7:u=n.ops.pop(),n.trys.pop();continue;default:if(s=n.trys,!(s=s.length>0&&s[s.length-1])&&(u[0]===6||u[0]===2)){n=0;continue}if(u[0]===3&&(!s||u[1]>s[0]&&u[1]<s[3])){n.label=u[1];break}if(u[0]===6&&n.label<s[1]){n.label=s[1],s=u;break}if(s&&n.label<s[2]){n.label=s[2],n.ops.push(u);break}s[2]&&n.ops.pop(),n.trys.pop();continue}u=t.call(e,n)}catch(l){u=[6,l],o=0}finally{i=s=0}if(u[0]&5)throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}}var Lo;(function(e){e[e.EQUAL=0]="EQUAL",e[e.GREATER=1]="GREATER",e[e.LESS=-1]="LESS"})(Lo||(Lo={}));var e6=function(){function e(t){this.compare=t||e.defaultCompareFunction}return e.defaultCompareFunction=function(t,n){return t===n?Lo.EQUAL:t<n?Lo.LESS:Lo.GREATER},e.prototype.equal=function(t,n){return this.compare(t,n)===Lo.EQUAL},e.prototype.lessThan=function(t,n){return this.compare(t,n)===Lo.LESS},e.prototype.greaterThan=function(t,n){return this.compare(t,n)===Lo.GREATER},e.prototype.lessThanOrEqual=function(t,n){return this.lessThan(t,n)||this.equal(t,n)},e.prototype.greaterThanOrEqual=function(t,n){return this.greaterThan(t,n)||this.equal(t,n)},e.prototype.reverse=function(){var t=this.compare;this.compare=function(n,i){return t(i,n)}},e}(),Vh=function(){function e(t){this.value=t,this.next=null}return e}(),Jh=function(){function e(t){this.value=t,this.next=null,this.prev=null}return e}();/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */var Vl=function(e,t){return Vl=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var o in i)i.hasOwnProperty(o)&&(n[o]=i[o])},Vl(e,t)};function Mr(e,t){Vl(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}function ua(e,t){var n={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},i,o,s,r;return r={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(r[Symbol.iterator]=function(){return this}),r;function a(u){return function(l){return c([u,l])}}function c(u){if(i)throw new TypeError("Generator is already executing.");for(;n;)try{if(i=1,o&&(s=u[0]&2?o.return:u[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,u[1])).done)return s;switch(o=0,s&&(u=[u[0]&2,s.value]),u[0]){case 0:case 1:s=u;break;case 4:return n.label++,{value:u[1],done:!1};case 5:n.label++,o=u[1],u=[0];continue;case 7:u=n.ops.pop(),n.trys.pop();continue;default:if(s=n.trys,!(s=s.length>0&&s[s.length-1])&&(u[0]===6||u[0]===2)){n=0;continue}if(u[0]===3&&(!s||u[1]>s[0]&&u[1]<s[3])){n.label=u[1];break}if(u[0]===6&&n.label<s[1]){n.label=s[1],s=u;break}if(s&&n.label<s[2]){n.label=s[2],n.ops.push(u);break}s[2]&&n.ops.pop(),n.trys.pop();continue}u=t.call(e,n)}catch(l){u=[6,l],o=0}finally{i=s=0}if(u[0]&5)throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}}function n6(e,t){var n=typeof Symbol=="function"&&e[Symbol.iterator];if(!n)return e;var i=n.call(e),o,s=[],r;try{for(;(t===void 0||t-- >0)&&!(o=i.next()).done;)s.push(o.value)}catch(a){r={error:a}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}return s}function Hi(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(n6(arguments[t]));return e}var i6="obfuse error occur";function Pc(e,t){if(!e)throw new Error("[linked-list] "+(t||i6))}var o6=-1,j_=function(){function e(){for(var t=this,n=[],i=0;i<arguments.length;i++)n[i]=arguments[i];this._head=null,this._tail=null,this._length=0,this.compare=new e6,n.length>0&&n.forEach(function(o){t.append(o)})}return Object.defineProperty(e.prototype,"head",{get:function(){return this._head?this._head.value:void 0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"tail",{get:function(){return this._tail?this._tail.value:void 0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"length",{get:function(){return this._length},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"loopLength",{get:function(){var t=!1,n=1;if(!this._head)return 0;for(var i=this._head,o=this._head;o.next&&o.next.next;)if(o=o.next.next,i=i.next,i===o){t=!0;break}if(t){for(o=o.next;i!==o;)n++,o=o.next;return n}else return 0},enumerable:!0,configurable:!0}),e.prototype.getNode=function(t){var n=this._length;Pc(n>0&&t>=0&&t<n,"[linked-list] index "+t+" out of scope of list, which length is "+n);for(var i=this._head,o=0;o<t;)i=i.next,o++;return i},e.prototype.get=function(t){var n=this.getNode(t);return n?n.value:null},e.prototype.find=function(t){var n=t.value,i=t.callback;if(!this._head)return null;for(var o=this._head;o;){if(i&&i(o.value)||n!==void 0&&this.compare.equal(o.value,n))return o;o=o.next}return null},e.prototype.indexOf=function(t){if(!this._head)return o6;for(var n=this._head,i=-1;n.next;){if(i++,this.compare.equal(n.value,t))return i;n=n.next}return n===this._tail&&this.compare.equal(n.value,t)&&(i+=1),i},e.prototype.first=function(t){Pc(t>=0,"[linked-list] param 'num' ("+t+") should not less than 0");for(var n=this.iterator(),i=[],o=Math.min(t,this.length),s=0;s<o;s++){var r=n.next();i.push(r.value)}return i},e.prototype.toArray=function(){return Hi(this)},e.prototype.isEmpty=function(){return this._head===null},e.prototype.iterator=function(){var t;return ua(this,function(n){switch(n.label){case 0:t=this._head,n.label=1;case 1:return t?[4,t.value]:[3,3];case 2:return n.sent(),t=t.next,[3,1];case 3:return[2]}})},e.prototype[Symbol.iterator]=function(){return this.iterator()},e}(),la=function(e){Mr(t,e);function t(){for(var n=[],i=0;i<arguments.length;i++)n[i]=arguments[i];return e.apply(this,Hi(n))||this}return t.prototype.append=function(n){var i=new Vh(n);return this._tail?(this._tail.next=i,this._tail=i):this._head=this._tail=i,this._length++,!0},t.prototype.prepend=function(n){var i=new Vh(n);return this._head?(i.next=this._head,this._head=i):this._head=this._tail=i,this._length++,!0},t.prototype.remove=function(n){var i=this._head;if(i){if(this.compare.equal(i.value,n))return i.next?(this._head=i.next,i.next=null):this._head=this._tail=null,this._length--,n;for(var o=i;;){if(this.compare.equal(i.value,n))return i.next?o.next=i.next:(this._tail=o,this._tail.next=null),i.next=null,this._length--,n;if(i.next)o=i,i=i.next;else return}}},t.prototype.removeHead=function(){var n=this._head;if(n)return this._head.next?(this._head=n.next,n.next=null):(this._head=null,this._tail=null),this._length--,n.value},t.prototype.removeTail=function(){var n=this._tail;if(n){if(!this._head.next)this._head=null,this._tail=null;else{for(var i=this._head;i.next!==n;)i=i.next;i.next=null,this._tail=i}return this._length--,n.value}},t.prototype.reverse=function(){if(this._head){var n=this._head,i=null,o;for(this._tail=this._head;n!==null;)o=n.next,n.next=i,i=n,n=o;this._head=i}},t.prototype.clone=function(){var n=this.toArray();return new(t.bind.apply(t,Hi([void 0],n)))},t}(j_),s6=function(e){Mr(t,e);function t(){for(var n=[],i=0;i<arguments.length;i++)n[i]=arguments[i];var o=e.apply(this,Hi(n))||this;return o.cyclization(),o}return t.prototype.iterator=function(){var n;return ua(this,function(i){switch(i.label){case 0:n=this._head,i.label=1;case 1:return n?[4,n.value]:[3,3];case 2:return i.sent(),n=n.next,n===this._head&&(n=null),[3,1];case 3:return[2]}})},t.prototype.circleIterator=function(){var n;return ua(this,function(i){switch(i.label){case 0:n=this._head,i.label=1;case 1:return n?[4,n.value]:[3,3];case 2:return i.sent(),n=n.next,[3,1];case 3:return[2]}})},t.prototype[Symbol.iterator]=function(){return this.iterator()},t.prototype.mapToNormalListFn=function(n){for(var i=[],o=1;o<arguments.length;o++)i[o-1]=arguments[o];this.breakCircle();var s=e.prototype[n].apply(this,i);return this.cyclization(),s},t.prototype.getNode=function(n){return this.mapToNormalListFn("getNode",n)},t.prototype.append=function(n){return this.mapToNormalListFn("append",n)},t.prototype.prepend=function(n){return this.mapToNormalListFn("prepend",n)},t.prototype.find=function(n){return this.mapToNormalListFn("find",n)},t.prototype.indexOf=function(n){return this.mapToNormalListFn("indexOf",n)},t.prototype.remove=function(n){return this.mapToNormalListFn("remove",n)},t.prototype.removeHead=function(){return this.mapToNormalListFn("removeHead")},t.prototype.removeTail=function(){return this.mapToNormalListFn("removeTail")},t.prototype.first=function(n){Pc(n>=0,"[linked-list] param 'num' ("+n+") should not less than 0");for(var i=this.circleIterator(),o=[],s=0;s<n;s++){var r=i.next();o.push(r.value)}return o},t.prototype.toArray=function(){return this.mapToNormalListFn("toArray")},t.prototype.reverse=function(){return this.mapToNormalListFn("reverse")},t}(la);(function(e){Mr(t,e);function t(){for(var n=[],i=0;i<arguments.length;i++)n[i]=arguments[i];var o=e.apply(this,Hi(n))||this;return o.cyclization(),o}return t.prototype.breakCircle=function(){this._tail&&this._tail.next===this._head&&(this._tail.next=null)},t.prototype.cyclization=function(){this._tail&&this._tail.next===null&&(this._tail.next=this._head)},t.prototype.clone=function(){var n=this.toArray();return new(t.bind.apply(t,Hi([void 0],n)))},t})(s6);var r6=function(e){Mr(t,e);function t(){for(var n=[],i=0;i<arguments.length;i++)n[i]=arguments[i];return e.apply(this,Hi(n))||this}return t.prototype.append=function(n){var i=new Jh(n);return this._tail?(this._tail.next=i,i.prev=this._tail,this._tail=i):this._head=this._tail=i,this._length++,!0},t.prototype.prepend=function(n){var i=new Jh(n);return this._head?(i.next=this._head,this._head.prev=i,this._head=i):this._head=this._tail=i,this._length++,!0},t.prototype.remove=function(n){var i=this._head;if(i){if(this.compare.equal(i.value,n))return i.next?(this._head=i.next,this._head.prev=null,i.next=i.prev=null):this._head=this._tail=null,this._length--,n;for(;;){if(this.compare.equal(i.value,n))return i.next?(i.prev.next=i.next,i.next.prev=i.prev,i.next=i.prev=null):(i.prev.next=null,this._tail=i.prev,i.next=i.prev=null),this._length--,i.value;if(i.next)i=i.next;else return}}},t.prototype.removeHead=function(){var n=this._head;if(n)return this._head.next?(n.next.prev=null,this._head=n.next,n.next=null):(this._head=null,this._tail=null),this._length--,n.value},t.prototype.removeTail=function(){var n=this._tail;if(n)return this._head.next?(n.prev.next=null,this._tail=n.prev,n.next=n.prev=null):(this._head=null,this._tail=null),this._length--,n.value},t.prototype.reverse=function(){if(this._head){var n=this._head,i=null,o;for(this._tail=this._head;n!==null;)o=n.next,n.next=i,n.prev=o,i=n,n=o;this._head=i}},t.prototype.clone=function(){var n=this.toArray();return new(t.bind.apply(t,Hi([void 0],n)))},t}(j_),a6=function(e){Mr(t,e);function t(){for(var n=[],i=0;i<arguments.length;i++)n[i]=arguments[i];var o=e.apply(this,Hi(n))||this;return o.cyclization(),o}return t.prototype.iterator=function(){var n;return ua(this,function(i){switch(i.label){case 0:n=this._head,i.label=1;case 1:return n?[4,n.value]:[3,3];case 2:return i.sent(),n=n.next,n===this._head&&(n=null),[3,1];case 3:return[2]}})},t.prototype.circleIterator=function(){var n;return ua(this,function(i){switch(i.label){case 0:n=this._head,i.label=1;case 1:return n?[4,n.value]:[3,3];case 2:return i.sent(),n=n.next,[3,1];case 3:return[2]}})},t.prototype[Symbol.iterator]=function(){return this.iterator()},t.prototype.mapToNormalListFn=function(n){for(var i=[],o=1;o<arguments.length;o++)i[o-1]=arguments[o];this.breakCircle();var s=e.prototype[n].apply(this,i);return this.cyclization(),s},t.prototype.getNode=function(n){return this.mapToNormalListFn("getNode",n)},t.prototype.append=function(n){return this.mapToNormalListFn("append",n)},t.prototype.prepend=function(n){return this.mapToNormalListFn("prepend",n)},t.prototype.find=function(n){return this.mapToNormalListFn("find",n)},t.prototype.indexOf=function(n){return this.mapToNormalListFn("indexOf",n)},t.prototype.remove=function(n){return this.mapToNormalListFn("remove",n)},t.prototype.removeHead=function(){return this.mapToNormalListFn("removeHead")},t.prototype.removeTail=function(){return this.mapToNormalListFn("removeTail")},t.prototype.first=function(n){Pc(n>=0,"[linked-list] param 'num' ("+n+") should not less than 0");for(var i=this.circleIterator(),o=[],s=0;s<n;s++){var r=i.next();o.push(r.value)}return o},t.prototype.toArray=function(){return this.mapToNormalListFn("toArray")},t.prototype.reverse=function(){return this.mapToNormalListFn("reverse")},t}(r6);(function(e){Mr(t,e);function t(){for(var n=[],i=0;i<arguments.length;i++)n[i]=arguments[i];var o=e.apply(this,Hi(n))||this;return o.cyclization(),o}return t.prototype.breakCircle=function(){this._tail&&this._head&&this._tail.next===this._head&&(this._tail.next=null,this._head.prev=null)},t.prototype.cyclization=function(){this._head&&this._tail&&this._tail.next===null&&(this._tail.next=this._head,this._head.prev=this._tail)},t.prototype.clone=function(){var n=this.toArray();return new(t.bind.apply(t,Hi([void 0],n)))},t})(a6);/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */function c6(e,t){var n=typeof Symbol=="function"&&e[Symbol.iterator];if(!n)return e;var i=n.call(e),o,s=[],r;try{for(;(t===void 0||t-- >0)&&!(o=i.next()).done;)s.push(o.value)}catch(a){r={error:a}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}return s}function u6(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(c6(arguments[t]));return e}var l6=function(){function e(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];this.queue=new(la.bind.apply(la,u6([void 0],t)))}return Object.defineProperty(e.prototype,"length",{get:function(){return this.queue.length},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"peek",{get:function(){return this.queue.head},enumerable:!0,configurable:!0}),e.prototype.isEmpty=function(){return this.queue.isEmpty()},e.prototype.enqueue=function(t){return this.queue.append(t)},e.prototype.dequeue=function(){var t=this.queue.removeHead();return typeof t<"u"?t:void 0},e.prototype.toArray=function(){return this.queue.toArray()},e}();/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */function d6(e,t){var n=typeof Symbol=="function"&&e[Symbol.iterator];if(!n)return e;var i=n.call(e),o,s=[],r;try{for(;(t===void 0||t-- >0)&&!(o=i.next()).done;)s.push(o.value)}catch(a){r={error:a}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}return s}function h6(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(d6(arguments[t]));return e}var yl=function(){function e(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];this.stack=new(la.bind.apply(la,h6([void 0],t)))}return Object.defineProperty(e.prototype,"length",{get:function(){return this.stack.length},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"peek",{get:function(){return this.stack.tail},enumerable:!0,configurable:!0}),e.prototype.isEmpty=function(){return this.stack.isEmpty()},e.prototype.push=function(t){return this.stack.append(t)},e.prototype.pop=function(){var t=this.stack.removeTail();return typeof t<"u"?t:void 0},e.prototype.popBottom=function(){var t=this.stack.removeHead();return typeof t<"u"?t:void 0},e.prototype.toArray=function(){return this.stack.toArray()},e}(),z_=function(){function e(t,n,i){i===void 0&&(i=0),this.startVertex=t,this.endVertex=n,this.weight=i}return e.prototype.getKey=function(){var t=this.startVertex.getKey(),n=this.endVertex.getKey();return t+"_"+n},e.prototype.reverse=function(){var t=this.startVertex;return this.startVertex=this.endVertex,this.endVertex=t,this},e.prototype.clone=function(){return new e(this.startVertex,this.endVertex,this.weight)},e.prototype.toString=function(){return this.getKey()},e}();function Jl(e,t,n){if(n===void 0&&(n="cc-graph"),!e)throw new Error((n?"["+n+"]":"")+" Invariant failed: "+t)}function f6(e,t){t===void 0&&(t=!0);var n=typeof e<"u"&&e!==null;return t?n&&e!=="undefined"&&e!=="null":n}var Cc=function(){function e(t){Jl(f6(t),"Graph vertex must have a value"),this.value=t,this.edges=new Map}return e.prototype.addEdge=function(t){return this.edges.set(t.getKey(),t),this},e.prototype.deleteEdge=function(t){this.edges.delete(t.getKey())},e.prototype.getNeighbors=function(){var t=this,n=this.getEdges(),i=function(o){return o.startVertex===t?o.endVertex:o.startVertex};return n.map(i)},e.prototype.getEdges=function(){return Array.from(this.edges.values())},e.prototype.getDegree=function(){return this.getEdges().length},e.prototype.hasEdge=function(t){var n=this.getEdges().find(function(i){return i===t});return!!n},e.prototype.hasNeighbor=function(t){var n=this.getEdges().find(function(i){return i.startVertex===t||i.endVertex===t});return!!n},e.prototype.findEdge=function(t){var n=function(o){return o.startVertex===t||o.endVertex===t},i=this.getEdges().find(n);return i||null},e.prototype.getKey=function(){return this.value},e.prototype.deleteAllEdges=function(){var t=this;return this.getEdges().forEach(function(n){return t.deleteEdge(n)}),this},e.prototype.toString=function(t){return t?t(this.value):""+this.value},e}();function Zh(e,t,n,i){if(e){t.push(e),i.set(e.getKey(),!0);var o=e.getNeighbors().filter(function(s){return!i.get(s.getKey())});n.push(o)}}function Yh(e,t,n){var i=e.pop();i&&n.set(i.getKey(),!1),t.pop()}var H_=function(){function e(t){t===void 0&&(t=!1),this.vertices={},this.edges={},this.isDirected=t}return e.prototype.addVertex=function(t){return this.vertices[t.getKey()]=t,this},e.prototype.getVertexByKey=function(t){return this.vertices[t]},e.prototype.getNeighbors=function(t){return t.getNeighbors()},e.prototype.getAllVertices=function(){return Object.values(this.vertices)},e.prototype.getAllEdges=function(){return Object.values(this.edges)},e.prototype.addEdge=function(t,n){if(n===void 0&&(n=!1),this.edges[t.getKey()]){if(n)return this;Jl(!1,"Edge has already been added before")}var i=this.getVertexByKey(t.startVertex.getKey()),o=this.getVertexByKey(t.endVertex.getKey());if(i||(this.addVertex(t.startVertex),i=this.getVertexByKey(t.startVertex.getKey())),o||(this.addVertex(t.endVertex),o=this.getVertexByKey(t.endVertex.getKey())),this.edges[t.getKey()]=t,this.isDirected)i.addEdge(t);else{i.addEdge(t);var s=t.clone();o.addEdge(s.reverse())}return this},e.prototype.deleteEdge=function(t,n){if(n===void 0&&(n=!1),!this.edges[t.getKey()]){if(n)return this;Jl(!1,"Edge not found in graph")}delete this.edges[t.getKey()];var i=this.getVertexByKey(t.startVertex.getKey()),o=this.getVertexByKey(t.endVertex.getKey());return i.deleteEdge(t),o.deleteEdge(t),this},e.prototype.findEdge=function(t,n){var i=this.getVertexByKey(t.getKey());return i?i.findEdge(n):null},e.prototype.getWeight=function(){return this.getAllEdges().reduce(function(t,n){return t+n.weight},0)},e.prototype.reverse=function(){var t=this;return this.getAllEdges().forEach(function(n){t.deleteEdge(n),n.reverse(),t.addEdge(n)}),this},e.prototype.getVerticesIndices=function(){var t={};return this.getAllVertices().forEach(function(n,i){t[n.getKey()]=i}),t},e.prototype.getAdjacencyMatrix=function(){var t=this,n=this.getAllVertices(),i=this.getVerticesIndices(),o=Array(n.length).fill(null).map(function(){return Array(n.length).fill(1/0)});return n.forEach(function(s,r){s.getNeighbors().forEach(function(a){var c=i[a.getKey()],u=t.findEdge(s,a);u&&(o[r][c]=u.weight)})}),o},e.prototype.toString=function(){return Object.keys(this.vertices).toString()},e.prototype.bfs=function(t){var n,i,o;return ml(this,function(s){switch(s.label){case 0:n=new Map,i=new l6,i.enqueue(t),s.label=1;case 1:return i.isEmpty()?[3,4]:(o=i.dequeue(),o&&!n.has(o.getKey())?[4,o]:[3,3]);case 2:s.sent(),n.set(o.getKey(),o),o.getNeighbors().forEach(function(r){return i.enqueue(r)}),s.label=3;case 3:return[3,1];case 4:return[2]}})},e.prototype.dfs=function(t){var n,i,o;return ml(this,function(s){switch(s.label){case 0:n=new Map,i=new yl,i.push(t),s.label=1;case 1:return i.isEmpty()?[3,4]:(o=i.pop(),o&&!n.has(o.getKey())?[4,o]:[3,3]);case 2:s.sent(),n.set(o.getKey(),o),o.getNeighbors().forEach(function(r){return i.push(r)}),s.label=3;case 3:return[3,1];case 4:return[2]}})},e.prototype.findAllPath=function(t,n){var i,o,s,r,a,c,u;return ml(this,function(l){switch(l.label){case 0:return i=[],t!==n?[3,2]:(i.push(t),[4,i]);case 1:return l.sent(),[2];case 2:o=new Map,s=new yl,r=new yl,Zh(t,s,r,o),l.label=3;case 3:if(s.isEmpty())return[3,6];if(a=r.pop(),a&&a.length)c=a.shift(),r.push(a),c&&Zh(c,s,r,o);else return r.push(a),Yh(s,r,o),[3,3];return u=s.peek,u!==n?[3,5]:[4,s.toArray()];case 4:l.sent(),Yh(s,r,o),l.label=5;case 5:return[3,3];case 6:return[2]}})},e}();it.config({precision:64,rounding:it.ROUND_DOWN,toExpNeg:-64,toExpPos:64});var li=it,Wn=class extends Error{constructor(t,n){super(t),this.message=t,this.errorCode=n}static isClmmpoolsErrorCode(t,n){return t instanceof Wn&&t.errorCode===n}},Pt=new _(0),us=new _(1),Nu=new _(2);Nu.pow(new _(128));var Bc=Nu.pow(new _(64)).sub(us),p6=Nu.pow(new _(128)).sub(us),Te=class{static toX64_BN(t){return t.mul(new _(2).pow(new _(64)))}static toX64_Decimal(t){return t.mul(li.pow(2,64))}static toX64(t){return new _(t.mul(li.pow(2,64)).floor().toFixed())}static fromX64(t){return new li(t.toString()).mul(li.pow(2,-64))}static fromX64_Decimal(t){return t.mul(li.pow(2,-64))}static fromX64_BN(t){return t.div(new _(2).pow(new _(64)))}static shiftRightRoundUp(t){let n=t.shrn(64);return t.mod(Bc).gt(Pt)&&(n=n.add(us)),n}static divRoundUp(t,n){return t.mod(n).eq(Pt)?t.div(n):t.div(n).add(new _(1))}static subUnderflowU128(t,n){return t.lt(n)?t.sub(n).add(p6):t.sub(n)}static checkUnsignedSub(t,n){const i=t.sub(n);if(i.isNeg())throw new Wn("Unsigned integer sub overflow","UnsignedIntegerOverflow");return i}static checkMul(t,n,i){const o=t.mul(n);if(this.isOverflow(o,i))throw new Wn("Multiplication overflow","MultiplicationOverflow");return o}static checkMulDivFloor(t,n,i,o){if(i.eq(Pt))throw new Wn("Devide by zero","DivideByZero");const s=t.mul(n).div(i);if(this.isOverflow(s,o))throw new Wn("Multiplication div overflow","MulDivOverflow");return s}static checkMulDivCeil(t,n,i,o){if(i.eq(Pt))throw new Wn("Devide by zero","DivideByZero");const s=t.mul(n).add(i.sub(us)).div(i);if(this.isOverflow(s,o))throw new Wn("Multiplication div overflow","MulDivOverflow");return s}static checkMulDivRound(t,n,i,o){if(i.eq(Pt))throw new Wn("Devide by zero","DivideByZero");const s=t.mul(n.add(i.shrn(1))).div(i);if(this.isOverflow(s,o))throw new Wn("Multiplication div overflow","MulDivOverflow");return s}static checkMulShiftRight(t,n,i,o){const s=t.mul(n).div(new _(2).pow(new _(i)));if(this.isOverflow(s,o))throw new Wn("Multiplication shift right overflow","MulShiftRightOverflow");return s}static checkMulShiftRight64RoundUpIf(t,n,i,o){const s=t.mul(n),a=o&&s.and(Bc).gt(Pt)?s.shrn(64).add(us):s.shrn(64);if(this.isOverflow(a,i))throw new Wn("Multiplication shift right overflow","MulShiftRightOverflow");return a}static checkMulShiftLeft(t,n,i,o){const s=t.mul(n).shln(i);if(this.isOverflow(s,o))throw new Wn("Multiplication shift left overflow","MulShiftLeftOverflow");return s}static checkDivRoundUpIf(t,n,i){if(n.eq(Pt))throw new Wn("Devide by zero","DivideByZero");return i?this.divRoundUp(t,n):t.div(n)}static isOverflow(t,n){return t.gte(Nu.pow(new _(n)))}};function K_(e){return{coinA:e.coinTypeA.toString(),coinB:e.coinTypeB.toString(),currentSqrtPrice:new _(e.current_sqrt_price),currentTickIndex:e.current_tick_index,feeGrowthGlobalA:new _(e.fee_growth_global_a),feeGrowthGlobalB:new _(e.fee_growth_global_b),feeProtocolCoinA:new _(e.fee_protocol_coin_a),feeProtocolCoinB:new _(e.fee_protocol_coin_b),feeRate:e.fee_rate,liquidity:new _(e.liquidity),tickIndexes:[],tickSpacing:Number(e.tickSpacing),ticks:[],collection_name:e.collectionName}}function g6(e){const t=new _(e);return t.lt(Pt)?{bits:t.neg().xor(new _(2).pow(new _(64)).sub(new _(1))).add(new _(1)).toString()}:{bits:t.toString()}}var G_="0x1::coin::CoinInfo",W_="0x1::coin::CoinStore",Qh="0x3::token::TokenStore",_6="0x3::token::WithdrawEvent",m6="PoolLiquidityCoin",is="clmm_router",X_="factory",V_="Pools",y6="pool",w6="Pool",b6="crowdsale",v6="CrowdsalePool",T6="fairlaunch",A6="FairlaunchPool",Vi="cetus_script",J_="cscoin",Z_="liquidity",Zl="scripts";function x6(e){return e.startsWith("0x")?`${e.slice(2)}`:e}function to(e){let t="";const n=x6(e),i=n.length/2;for(let o=0;o<i;o++)t+=String.fromCharCode(parseInt(n.substr(o*2,2),16));return k6(t)}function k6(e){let t,n,i,o,s,r;for(t="",i=e.length,n=0;n<i;)switch(o=e.charCodeAt(n++),o>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:t+=e.charAt(n-1);break;case 12:case 13:s=e.charCodeAt(n++),t+=String.fromCharCode((o&31)<<6|s&63);break;case 14:s=e.charCodeAt(n++),r=e.charCodeAt(n++),t+=String.fromCharCode((o&15)<<12|(s&63)<<6|(r&63)<<0);break}return t}var S6=/^0x1::coin::CoinStore<(.+)>$/;function Pe(e,...t){const n=Array.isArray(t[t.length-1])?t.pop():[];let o=[e,...t].filter(Boolean).join("::");return n&&n.length&&(o+=`<${n.join(", ")}>`),o}function tf(e){return Pe(Be.fromUint8Array(e.value.address.address).hex(),e.value.module_name.value,e.value.name.value,[])}function P6(e){const t=e.value.type_args[0],n=e.value.type_args[1],i=tf(t),o=tf(n),s=Pe(Be.fromUint8Array(e.value.address.address).hex(),e.value.module_name.value,e.value.name.value,[i,o]);return{coinA:i,coinB:o,lpAddress:s}}function th(e){var t;let n=e.replace(/\s/g,"");const i=n.match(/(<.+>)$/),o=(t=i==null?void 0:i[0])==null?void 0:t.match(/(\w+::\w+::\w+)(?:<.*?>(?!>))?/g);if(o)return n=n.slice(0,n.indexOf("<")),{...th(n),type_arguments:[...o]};const s=n.split("::");return{full_address:n,address:s[0],module:s[1],name:s[2],type_arguments:[]}}function ef(e){const t=e.match(S6);return t?t[1]:""}function C6(e){return`${W_}<${e}>`}function B6(e){return`${G_}<${e}>`}var Fu=class{constructor(t,n=0){this.overdueTime=n,this.value=t}getCacheData(){return this.value===null?null:this.overdueTime===0?this.value:Date.parse(new Date().toString())>this.overdueTime?(this.value=null,null):this.value}},nf=443636,of=-443636,ju="79226673515401279992447579055",zu="4295048016",Ks=new _(1e6),Ec=class{static getDefaultSqrtPriceLimit(t){return new _(t?zu:ju)}static getDefaultOtherAmountThreshold(t){return t?Pt:Bc}},Ic=class{constructor(t,n){this.toString=()=>`${this.numerator.toString()}/${this.denominator.toString()}`,this.numerator=t,this.denominator=n}static fromDecimal(t){return Ic.fromFraction(t.toDecimalPlaces(1).mul(10).toNumber(),1e3)}static fromFraction(t,n){const i=typeof t=="number"?new _(t.toString()):t,o=typeof n=="number"?new _(n.toString()):n;return new Ic(i,o)}},E6=14,I6="59543866431248",O6="184467440737095516",R6="15793534762490258745";function $6(e,t,n){const i=e.toTwos(n).shln(t);return i.imaskn(n+1),i.fromTwos(n)}function ze(e,t,n){const i=e.toTwos(n).shrn(t);return i.imaskn(n-t+1),i.fromTwos(n-t)}function U6(e){let t;return e&1?t=new _("79232123823359799118286999567"):t=new _("79228162514264337593543950336"),e&2&&(t=ze(t.mul(new _("79236085330515764027303304731")),96,256)),e&4&&(t=ze(t.mul(new _("79244008939048815603706035061")),96,256)),e&8&&(t=ze(t.mul(new _("79259858533276714757314932305")),96,256)),e&16&&(t=ze(t.mul(new _("79291567232598584799939703904")),96,256)),e&32&&(t=ze(t.mul(new _("79355022692464371645785046466")),96,256)),e&64&&(t=ze(t.mul(new _("79482085999252804386437311141")),96,256)),e&128&&(t=ze(t.mul(new _("79736823300114093921829183326")),96,256)),e&256&&(t=ze(t.mul(new _("80248749790819932309965073892")),96,256)),e&512&&(t=ze(t.mul(new _("81282483887344747381513967011")),96,256)),e&1024&&(t=ze(t.mul(new _("83390072131320151908154831281")),96,256)),e&2048&&(t=ze(t.mul(new _("87770609709833776024991924138")),96,256)),e&4096&&(t=ze(t.mul(new _("97234110755111693312479820773")),96,256)),e&8192&&(t=ze(t.mul(new _("119332217159966728226237229890")),96,256)),e&16384&&(t=ze(t.mul(new _("179736315981702064433883588727")),96,256)),e&32768&&(t=ze(t.mul(new _("407748233172238350107850275304")),96,256)),e&65536&&(t=ze(t.mul(new _("2098478828474011932436660412517")),96,256)),e&131072&&(t=ze(t.mul(new _("55581415166113811149459800483533")),96,256)),e&262144&&(t=ze(t.mul(new _("38992368544603139932233054999993551")),96,256)),ze(t,32,256)}function q6(e){const t=Math.abs(e);let n;return t&1?n=new _("18445821805675392311"):n=new _("18446744073709551616"),t&2&&(n=ze(n.mul(new _("18444899583751176498")),64,256)),t&4&&(n=ze(n.mul(new _("18443055278223354162")),64,256)),t&8&&(n=ze(n.mul(new _("18439367220385604838")),64,256)),t&16&&(n=ze(n.mul(new _("18431993317065449817")),64,256)),t&32&&(n=ze(n.mul(new _("18417254355718160513")),64,256)),t&64&&(n=ze(n.mul(new _("18387811781193591352")),64,256)),t&128&&(n=ze(n.mul(new _("18329067761203520168")),64,256)),t&256&&(n=ze(n.mul(new _("18212142134806087854")),64,256)),t&512&&(n=ze(n.mul(new _("17980523815641551639")),64,256)),t&1024&&(n=ze(n.mul(new _("17526086738831147013")),64,256)),t&2048&&(n=ze(n.mul(new _("16651378430235024244")),64,256)),t&4096&&(n=ze(n.mul(new _("15030750278693429944")),64,256)),t&8192&&(n=ze(n.mul(new _("12247334978882834399")),64,256)),t&16384&&(n=ze(n.mul(new _("8131365268884726200")),64,256)),t&32768&&(n=ze(n.mul(new _("3584323654723342297")),64,256)),t&65536&&(n=ze(n.mul(new _("696457651847595233")),64,256)),t&131072&&(n=ze(n.mul(new _("26294789957452057")),64,256)),t&262144&&(n=ze(n.mul(new _("37481735321082")),64,256)),n}var Ze=class{static priceToSqrtPriceX64(t,n,i){return Te.toX64(t.mul(li.pow(10,i-n)).sqrt())}static sqrtPriceX64ToPrice(t,n,i){return Te.fromX64(t).pow(2).mul(li.pow(10,n-i))}static tickIndexToSqrtPriceX64(t){return t>0?new _(U6(t)):new _(q6(t))}static sqrtPriceX64ToTickIndex(t){if(t.gt(new _(ju))||t.lt(new _(zu)))throw new Error("Provided sqrtPrice is not within the supported sqrtPrice range.");const n=t.bitLength()-1,i=new _(n-64),o=$6(i,32,128);let s=new _("8000000000000000","hex"),r=0,a=new _(0),c=n>=64?t.shrn(n-63):t.shln(63-n);for(;s.gt(new _(0))&&r<E6;){c=c.mul(c);const v=c.shrn(127);c=c.shrn(63+v.toNumber()),a=a.add(s.mul(v)),s=s.shrn(1),r+=1}const u=a.shrn(32),d=o.add(u).mul(new _(I6)),h=ze(d.sub(new _(O6)),64,128).toNumber(),g=ze(d.add(new _(R6)),64,128).toNumber();return h===g?h:Ze.tickIndexToSqrtPriceX64(g).lte(t)?g:h}static tickIndexToPrice(t,n,i){return Ze.sqrtPriceX64ToPrice(Ze.tickIndexToSqrtPriceX64(t),n,i)}static priceToTickIndex(t,n,i){return Ze.sqrtPriceX64ToTickIndex(Ze.priceToSqrtPriceX64(t,n,i))}static priceToInitializableTickIndex(t,n,i,o){return Ze.getInitializableTickIndex(Ze.priceToTickIndex(t,n,i),o)}static getInitializableTickIndex(t,n){return t-t%n}static getNextInitializableTickIndex(t,n){return Ze.getInitializableTickIndex(t,n)+n}static getPrevInitializableTickIndex(t,n){return Ze.getInitializableTickIndex(t,n)-n}};function Y_(e){const t=[];for(const n of e){const i={index:Number(BigInt.asIntN(64,BigInt(n.index.bits)).toString()),sqrtPrice:new _(n.sqrt_price),liquidityNet:new _(BigInt.asIntN(64,BigInt(n.liquidity_net.bits)).toString()),liquidityGross:new _(n.liquidity_gross),feeGrowthOutsideA:new _(n.fee_growth_outside_a),feeGrowthOutsideB:new _(n.fee_growth_outside_b),rewardersGrowthOutside:[new _(n.rewarders_growth_outside[0]),new _(n.rewarders_growth_outside[1]),new _(n.rewarders_growth_outside[2])]};t.push(i)}return t}function sf(e){return e.isAxiosError,e}function we(e){return li.isDecimal(e)?e:new li(e===void 0?0:e)}function eh(e){return we(10).pow(we(e).abs())}function M6(e){return e!=null&&e!==""&&!isNaN(Number(e.toString()))}new _(365);new _(24);new _(3600);new _(.5);function D6(e,t,n,i,o,s){const r=new it(e.toString()).div(new it(10**n)),a=new it(t.toString()).div(new it(10**i));return r.mul(o).add(a.mul(s))}function L6(e,t,n,i,o,s,r,a,c,u,l,d,h,g,b,v,x,P,E,S,T,R,K,V){const W=new it(d),tt=new it(h),j=new it(v),$=new it(x),q=new it(P),A=new it(E),f=new it(S),y=new it(T),k=new it(R),U=new it(K),D=new it(V),z=Ze.tickIndexToSqrtPriceX64(t),X=Ze.tickIndexToSqrtPriceX64(n),I=Te.toX64_Decimal(Te.fromX64(z)).round(),m=Te.toX64_Decimal(Te.fromX64(X)).round(),M=Te.toX64_Decimal(Te.fromX64(i)).round();let Tt;const ct=W.mul(new it(10**s)).mul(m.mul(I)).div(m.sub(I)).round(),mt=tt.mul(new it(10**r)).div(m.sub(I)).round();e<t?Tt=ct:e>n?Tt=mt:Tt=it.min(ct,mt);const oe=Tt.mul(M.sub(I)),Ie=Tt.mul(m.sub(M)).div(M.mul(m)).div(new it(10**s)).mul(f).add(oe.div(new it(10**r).mul(y))),fe=D6(g,b,s,r,f,y),se=Ie.div(fe),ae=Tt.eq(new it(0))?new it(0):new it(l/1e4).mul(j).mul(new it(Tt.toString()).div(new it(o.toString()).add(new it(Tt.toString())))).div(Ie),ci=se.eq(new it(0))?new it(0):se.mul(new it(36500/7)).div(Ie),nt=$.div(new it(10**a)).mul(k).mul(ci),dt=q.div(new it(10**c)).mul(U).mul(ci),Bt=A.div(new it(10**u)).mul(D).mul(ci);return{feeAPR:ae,posRewarder0APR:nt,posRewarder1APR:dt,posRewarder2APR:Bt}}function N6(e,t,n,i){const o=Math.max(e,n),r=Math.min(t,i)-o,a=t-e,c=i-n,u=new it(a.toString()),l=new it(c.toString()),d=new it(r.toString());let h=new it("0");return r<0?h=new it("0"):a===r?h=l.div(d):c===r?h=d.div(u):h=d.mul(d).div(l).div(u),h}function F6(e){const{clmmpool:t,position:n,tickLower:i,tickUpper:o}=e,{current_tick_index:s,fee_growth_global_a:r,fee_growth_global_b:a}=t;console.log({currentTickIndex:s,feeGrowthGlobalAX64:r,feeGrowthGlobalBX64:a});const{tick_lower_index:c,tick_upper_index:u,liquidity:l,fee_owed_a:d,fee_owed_b:h,fee_growth_inside_a:g,fee_growth_inside_b:b}=n,{feeGrowthOutsideA:v,feeGrowthOutsideB:x}=i,{feeGrowthOutsideA:P,feeGrowthOutsideB:E}=o;let S=null,T=null;s<Number(c)?(S=Te.subUnderflowU128(new _(r),new _(v)),T=Te.subUnderflowU128(new _(a),new _(x))):(S=v,T=x);let R=null,K=null;s<Number(u)?(R=P,K=E):(R=Te.subUnderflowU128(new _(r),new _(P)),K=Te.subUnderflowU128(new _(a),new _(E)));const V=Te.subUnderflowU128(Te.subUnderflowU128(new _(r),new _(S)),new _(R)),W=Te.subUnderflowU128(Te.subUnderflowU128(new _(a),new _(T)),new _(K)),tt=Te.subUnderflowU128(new _(V),new _(g)).mul(new _(l)).shrn(64),j=Te.subUnderflowU128(new _(W),new _(b)).mul(new _(l)).shrn(64),$=new _(we(d).add(we(tt.toString())).toString()),q=new _(we(h).add(we(j.toString())).toString());return{feeOwedA:$,feeOwedB:q}}var Oo=1e9,j6=5*60*1e3,Ka=24*60*60*1e3;function rf(e){return Date.parse(new Date().toString())+e}var z6=class{constructor(t){this._cache={},this._sdk=t}get sdk(){return this._sdk}async getPoolImmutablesResource(t=!1){const n=this._sdk.sdkOptions.networkOptions.launchpad.cetusLaunchpad,i=`${n}_getMmutablesPools`,o=this.getCacheData(i);let s;if(!t&&o!=null)s=o;else{const r=Pe(n,X_,V_),a=await this._sdk.Resources.fetchAccountResource(n,r);s=JSON.parse(JSON.stringify(a==null?void 0:a.data)),this.updateCache(i,s,Ka)}return s}async getLaunchpadPools(t=[],n=0,i=100,o=null,s=!1){const r=this._sdk.sdkOptions.networkOptions.launchpad.cetusLaunchpad,a=[],u=(await this.getPoolImmutablesResource(s)).data.data,l=t.length>0;for(let d=0;d<u.length;d+=1){const h=u[d],{pool_address:g,creater_address:b,pool_type:v}=h.value;if(o==="fixed_price"&&v!==0||o==="fair_launch"&&v===0||l&&!t.includes(g))continue;if(!l){const W=Number(d);if(W<n||W>=n+i)continue}const x=h.key,P=Pe(x.coin_raise.account_address,to(x.coin_raise.module_name),to(x.coin_raise.struct_name)),E=Pe(x.coin_sale.account_address,to(x.coin_sale.module_name),to(x.coin_sale.struct_name)),S=Li.buildLaunchpadPoolType(v===0,r,E,P),T={coin_type_sale:E,coin_type_raise:P,pool_type:S,pool_address:g,creator:b,pool_mode:v===0?"fixed_price":"fair_launch"},R=await this.getLaunchpadPoolState(T.pool_address,T.pool_type,T.pool_mode),K={...T,...R};await this.calculateLaunchpadPoolField(K),a.push(K);const V=`${g}_pool`;this.updateCache(V,K,Ka)}return a}async getLaunchpadPool(t,n=!0){const i=`${t}_pool`,o=this.getCacheData(i);let s;if(o!==null&&!n&&(s=o),s==null)return(await this.getLaunchpadPools([t]))[0];const r=await this.getLaunchpadPoolState(t,s.pool_type,s.pool_mode),a={...s,...r};return await this.calculateLaunchpadPoolField(a),this.updateCache(i,a,Ka),a}async getSpecifyCoinDecimals(t){const n={};(await this._sdk.Token.getSpecifyTokenListByCache(t)).forEach(r=>{n[r.address]=r.decimals});const o=t.filter(r=>n[r]===void 0);return(await this._sdk.Resources.getSpecifyCoinInfos(o)).forEach(r=>{n[r.coinAddress]=Number(r.decimals)}),n}async calculateLaunchpadPoolField(t){const n=await this.getSpecifyCoinDecimals([t.coin_type_sale,t.coin_type_raise]),i=Number(n[t.coin_type_sale]),o=Number(n[t.coin_type_raise]);if(t.initialize_price=Li.priceFixToReal(t.initialize_price,i,o),Li.isFixedPricePool(t))t.raise_total=Li.raiseTotalAmount(t,i,o);else{t.raise_total=Li.raiseTotalAmount(t,i,o);const r=we(t.raise_coin_amount).div(we(10).pow(we(o))),a=we(t.sale_total).div(we(10).pow(we(i)));a.toNumber()>0?t.price=r.div(a).toNumber():t.price=0}return Li.updatePoolStaus(t),!0}async getLaunchpadPoolState(t,n,i,o=!0){const s=`${t}_${n}_getLaunchpadPoolState`;if(!o){const u=this.getCacheData(s);if(u!==null)return u}const r=await this._sdk.Resources.fetchAccountResource(t,n),a=JSON.parse(JSON.stringify(r==null?void 0:r.data)),c=Li.buildLaunchpadFixedPoolState(i,a);return this.updateCache(s,c,Ka),c}async getOwnerLaunchpadCoins(t){const n=await this._sdk.Resources.getCoinStores(t),i=[];return n.forEach(o=>{const s=th(o.coinAddress);s.module===J_&&i.push({coin_type_sale:s.type_arguments[0],coin_type_raise:s.type_arguments[1],coin_address:o.coinAddress,balance:Number(o.coin.value)})}),i}async getSimplePosition(t){const n=await this._sdk.Resources.fetchAccountResource(t,Pe(this._sdk.sdkOptions.networkOptions.launchpad.cetusLaunchpad,"clmmProxy","LockedPosition")),i=JSON.parse(JSON.stringify(n==null?void 0:n.data));return{position_name:i.token_id.token_data_id.name,collection:i.token_id.token_data_id.collection,creator:i.token_id.token_data_id.creator,unlock_time:i.unlock_time,is_redeem:i.is_redeem}}async hasPoolWhitelist(t){const{launchpad:n}=this._sdk.sdkOptions.networkOptions,i={handle:"",exist:!1};try{const o=await this._sdk.Resources.fetchAccountResource(t,Pe(n.cetusLaunchpad,"whitelist","Whitelist")),s=JSON.parse(JSON.stringify(o==null?void 0:o.data));return i.exist=Number(s.users.length)>0,i.handle=s.users.inner.handle,i}catch(o){console.log(o)}return i}async inPoolWhitelist(t,n){if(!n.exist)return!1;try{return await this._sdk.client.getTableItem(n.handle,{key_type:"address",value_type:"u8",key:t}),!0}catch(i){console.log(i)}return!1}buildLaunchpadCoinType(t,n){return Pe(this._sdk.sdkOptions.networkOptions.launchpad.crowdCoin,"cscoin","CS",[t,n])}creatPoolTransactionPayload(t,n=!1){const{launchpad:i}=this.sdk.sdkOptions.networkOptions,o="is_admin"in t,s=`${i.cetusLaunchpad}::${Vi}`,r=o?t.is_admin?"create_crowdsale_pool_authority":"create_crowdsale_pool":"create_fairlaunch_pool",a=Li.priceRealToFix(t.initialize_price,t.sale_decimals,t.raise_decimals);console.log("fixPrice:",a);const c=Ze.priceToSqrtPriceX64(we(t.initialize_price),t.sale_decimals,t.raise_decimals).toString();return o?Li.buildCreatCrowdsalePoolPayload(t,c,a,s,r,n):Li.buildCreatFairlaunchPoolPayload(t,c,a,s,r,n)}updatePoolTransactionPayload(t,n=!1){const{launchpad:i}=this.sdk.sdkOptions.networkOptions,o=`${i.cetusLaunchpad}::${Vi}`,s="update_pool";if(n){const u=[new F.TypeTagStruct(F.StructTag.fromString(t.coin_type_sale)),new F.TypeTagStruct(F.StructTag.fromString(t.coin_type_raise))],l=[at.bcsToBytes(F.AccountAddress.fromHex(t.pool_addr)),at.bcsSerializeUint64(t.start_time),at.bcsSerializeUint64(t.liquidity_rate*100),at.bcsSerializeUint64(t.activity_duration),at.bcsSerializeUint64(t.calmdown_duraction),at.bcsSerializeUint64(t.settle_duration),at.bcsSerializeUint64(t.locked_duration)];return new F.TransactionPayloadEntryFunction(F.EntryFunction.natural(o,s,u,l))}const r=Pe(o,s),a=[t.coin_type_sale,t.coin_type_raise],c=[t.pool_addr,t.start_time,t.liquidity_rate*100,t.activity_duration,t.calmdown_duraction,t.settle_duration,t.locked_duration];return{type:"entry_function_payload",function:r,type_arguments:a,arguments:c}}purchaseTransactionPayload(t,n=!1){const{launchpad:i}=this.sdk.sdkOptions.networkOptions,o=`${i.cetusLaunchpad}::${Vi}`,s="purchase";if(n){const u=[new F.TypeTagStruct(F.StructTag.fromString(t.coin_type_sale)),new F.TypeTagStruct(F.StructTag.fromString(t.coin_type_raise))],l=[at.bcsToBytes(F.AccountAddress.fromHex(t.pool_addr)),at.bcsSerializeUint64(t.raise_amount_in)];return new F.TransactionPayloadEntryFunction(F.EntryFunction.natural(o,s,u,l))}const r=Pe(o,s),a=[t.coin_type_sale,t.coin_type_raise],c=[t.pool_addr,t.raise_amount_in];return{type:"entry_function_payload",function:r,type_arguments:a,arguments:c}}revokeTransactionPayload(t,n=!1){const{launchpad:i}=this.sdk.sdkOptions.networkOptions,o=`${i.cetusLaunchpad}::${Vi}`,s="revoke";if(n){const u=[new F.TypeTagStruct(F.StructTag.fromString(t.coin_type_sale)),new F.TypeTagStruct(F.StructTag.fromString(t.coin_type_raise))],l=[at.bcsToBytes(F.AccountAddress.fromHex(t.pool_addr)),at.bcsSerializeUint64(t.cs_coin_amount)];return new F.TransactionPayloadEntryFunction(F.EntryFunction.natural(o,s,u,l))}const r=Pe(o,s),a=[t.coin_type_sale,t.coin_type_raise],c=[t.pool_addr,t.cs_coin_amount];return{type:"entry_function_payload",function:r,type_arguments:a,arguments:c}}settleTransactionPayload(t,n=!1){const{launchpad:i}=this.sdk.sdkOptions.networkOptions,o=`${i.cetusLaunchpad}::${Vi}`,s=t.pool_mode==="fixed_price",r=s?"crowd_sale_settle":"fair_launch_settle";if(n){const u=[new F.TypeTagStruct(F.StructTag.fromString(t.coin_type_sale)),new F.TypeTagStruct(F.StructTag.fromString(t.coin_type_raise))];return s?new F.TransactionPayloadEntryFunction(F.EntryFunction.natural(o,r,u,[])):new F.TransactionPayloadEntryFunction(F.EntryFunction.natural(o,r,u,[at.bcsSerializeU128(BigInt(t.initialize_sqrt_price))]))}const a=Pe(o,r),c=[t.coin_type_sale,t.coin_type_raise];return{type:"entry_function_payload",function:a,type_arguments:c,arguments:s?[]:[t.initialize_sqrt_price]}}claimTransactionPayload(t,n=!1){const{launchpad:i}=this.sdk.sdkOptions.networkOptions,o=`${i.cetusLaunchpad}::${Vi}`,s="claim";if(n){const u=[new F.TypeTagStruct(F.StructTag.fromString(t.coin_type_sale)),new F.TypeTagStruct(F.StructTag.fromString(t.coin_type_raise))],l=[at.bcsToBytes(F.AccountAddress.fromHex(t.pool_addr)),at.bcsSerializeUint64(t.cs_coin_amount)];return new F.TransactionPayloadEntryFunction(F.EntryFunction.natural(o,s,u,l))}const r=Pe(o,s),a=[t.coin_type_sale,t.coin_type_raise],c=[t.pool_addr,t.cs_coin_amount];return{type:"entry_function_payload",function:r,type_arguments:a,arguments:c}}claimFeeTransactionPayload(t,n=!1){const{launchpad:i}=this.sdk.sdkOptions.networkOptions,o=`${i.cetusLaunchpad}::${Vi}`,s="claim_fee";if(n){const u=[new F.TypeTagStruct(F.StructTag.fromString(t.coin_type_sale)),new F.TypeTagStruct(F.StructTag.fromString(t.coin_type_raise))],l=[at.bcsToBytes(F.AccountAddress.fromHex(t.pool_addr))];return new F.TransactionPayloadEntryFunction(F.EntryFunction.natural(o,s,u,l))}const r=Pe(o,s),a=[t.coin_type_sale,t.coin_type_raise],c=[t.pool_addr];return{type:"entry_function_payload",function:r,type_arguments:a,arguments:c}}withdrawTransactionPayload(t,n=!1){const{launchpad:i}=this.sdk.sdkOptions.networkOptions,o=`${i.cetusLaunchpad}::${Vi}`,s=t.is_withdraw_sale?"withdraw_sale":"withdraw_raise";if(n){const u=[new F.TypeTagStruct(F.StructTag.fromString(t.coin_type_sale)),new F.TypeTagStruct(F.StructTag.fromString(t.coin_type_raise))],l=[at.bcsToBytes(F.AccountAddress.fromHex(t.pool_addr))];return new F.TransactionPayloadEntryFunction(F.EntryFunction.natural(o,s,u,l))}const r=Pe(o,s),a=[t.coin_type_sale,t.coin_type_raise],c=[t.pool_addr];return{type:"entry_function_payload",function:r,type_arguments:a,arguments:c}}redeemPositionTransactionPayload(t,n=!1){const{launchpad:i}=this.sdk.sdkOptions.networkOptions,o=`${i.cetusLaunchpad}::${Vi}`,s="redeem_position";if(n){const c=[new F.TypeTagStruct(F.StructTag.fromString(t.coin_type_sale)),new F.TypeTagStruct(F.StructTag.fromString(t.coin_type_raise))];return new F.TransactionPayloadEntryFunction(F.EntryFunction.natural(o,s,c,[]))}const r=Pe(o,s),a=[t.coin_type_sale,t.coin_type_raise];return{type:"entry_function_payload",function:r,type_arguments:a,arguments:[]}}userToWhitelistTransactionPayload(t,n=!1){const{launchpad:i}=this.sdk.sdkOptions.networkOptions,o=`${i.cetusLaunchpad}::${Vi}`,s=t.isAdd?"add_user_to_whitelist":"remove_user_from_whitelist";if(n){const u=[new F.TypeTagStruct(F.StructTag.fromString(t.coin_type_sale)),new F.TypeTagStruct(F.StructTag.fromString(t.coin_type_raise))],l=[at.bcsToBytes(F.AccountAddress.fromHex(t.user_addr))];return new F.TransactionPayloadEntryFunction(F.EntryFunction.natural(o,s,u,l))}const r=Pe(o,s),a=[t.coin_type_sale,t.coin_type_raise],c=[t.user_addr];return{type:"entry_function_payload",function:r,type_arguments:a,arguments:c}}updateCache(t,n,i=j6){let o=this._cache[t];o?(o.overdueTime=rf(i),o.value=n):o=new Fu(n,rf(i)),this._cache[t]=o}getCacheData(t){const n=this._cache[t];return n!==void 0&&n.getCacheData()?n.value:null}};function H6(e,t,n,i){const o=e.shln(64),s=n.sub(t);return i?Te.divRoundUp(o,s):o.div(s)}var Li=class{static minSettlePurchaseAmount(t){return we(t.sale_total).mul(t.initialize_price).mul(t.least_raise_rate).toNumber()}static get_sale_liquidity_amount(t,n,i,o,s,r){const a=Yl.getMinIndex(t),c=Yl.getMaxIndex(t),u=this.priceRealToFix(o,s,r),l=new _(n*u*i),d=new _(Ze.priceToSqrtPriceX64(we(u),0,0).toString()),h=H6(l,Ze.tickIndexToSqrtPriceX64(a),d,!1);return n2(d,Ze.tickIndexToSqrtPriceX64(c),h,!0).toString()}static raiseTotalAmount(t,n,i){const o=we(n-i).abs().toNumber();return n>i?Number(we(t.sale_total).mul(t.initialize_price).div(we(10).pow(we(o))).toString()):Number(we(t.sale_total).mul(t.initialize_price).mul(we(10).pow(we(o))).toString())}static priceRealToFix(t,n,i){const o=we(n-i).toNumber();return Number(we(t).div(we(10).pow(we(o))).toString())}static priceFixToReal(t,n,i){const o=we(n-i).toNumber();return Number(we(t).mul(we(10).pow(we(o))).toString())}static buildLaunchpadPoolType(t,n,i,o){return t?Pe(Pe(n,b6,v6),[i,o]):Pe(Pe(n,T6,A6),[i,o])}static isFixedPricePool(t){return t.pool_mode==="fixed_price"}static getFairLaunchSettleSqrtPrice(t,n,i){if(t.pool_status!=="Settle")throw new Error("The pool is not in settle ");const o=Ze.priceToSqrtPriceX64(we(t.price),n,i).toString();return console.log("sqrtPrice: ",o.toString()),o.toString()}static async updatePoolStaus(t){const n=Li.isFixedPricePool(t),i=Number(we(Date.now()/1e3).toFixed(0));if(t.end_activity_time=Number(t.start_activity_time)+Number(t.activity_duration),n)if(t.end_settle_time=Number(t.end_activity_time)+Number(t.settle_duration),t.is_settle)t.pool_status="Ended";else if(i<Number(t.start_activity_time))t.pool_status="Upcoming";else if(i>=t.start_activity_time&&i<t.end_activity_time)t.pool_status="Live";else if(i>=t.end_activity_time&&i<t.end_settle_time){const o=t.raise_coin_amount,s=we(t.raise_total).mul(we(t.least_raise_rate)).toNumber();o<s?t.pool_status="Failed":t.pool_status="Settle"}else t.pool_status="Failed";else if(t.end_calm_down_time=Number(t.end_activity_time)+Number(t.calmdown_duration),t.end_settle_time=Number(t.end_calm_down_time)+Number(t.settle_duration),t.is_settle)t.pool_status="Ended";else if(i<Number(t.start_activity_time))t.pool_status="Upcoming";else if(i>=t.start_activity_time&&i<t.end_activity_time)t.pool_status="Live";else if(i>=t.end_activity_time&&i<t.end_calm_down_time)t.pool_status="Calmdown";else if(i>=t.end_calm_down_time&&i<t.end_settle_time){const o=t.raise_coin_amount,s=we(t.raise_total).mul(we(t.least_raise_rate)).toNumber();o<s?t.pool_status="Failed":t.pool_status="Settle"}else t.pool_status="Failed";return!0}static buildLaunchpadFixedPoolState(t,n){return t==="fixed_price"?{sale_coin_amount:n.sale_coin.value,raise_coin_amount:n.raise_coin.value,activity_duration:n.activity_duration,clmm_pool_address:n.clmm_pool_address,cs_burn_cap:n.cs_burn_cap.dummy_field,cs_mint_cap:n.cs_mint_cap.dummy_field,fee_amount:n.fee_amount,fee_rate:n.fee_rate,initialize_price:Number(n.initialize_price)/Oo,initialize_sqrt_price:BigInt(n.initialize_sqrt_price),is_settle:n.is_settle,least_raise_rate:Number(n.least_raise_rate)/100,liquidity_rate:Number(n.liquidity_rate)/100,locked_duration:n.locked_duration,sale_total:n.sale_total,raise_total:0,settle_duration:n.settle_duration,start_activity_time:n.start_time,unused_raise:n.unused_raise,unused_sale:n.unused_sale,has_whiteList:n.has_white_list,pool_status:"Upcoming",end_activity_time:0,end_settle_time:0}:{price:0,sale_coin_amount:0,raise_coin_amount:n.raise_coin.value,sale_total:n.sale_coin.value,raise_total:0,calmdown_duration:n.calmdown_duration,initialize_price:Number(n.price)/Oo,activity_duration:n.activity_duration,clmm_pool_address:n.clmm_pool_address,cs_burn_cap:n.cs_burn_cap.dummy_field,cs_mint_cap:n.cs_mint_cap.dummy_field,fee_amount:n.fee_amount,fee_rate:n.fee_rate,is_settle:n.is_settle,least_raise_rate:Number(n.least_raise_amount)/100,liquidity_rate:Number(n.liquidity_rate)/100,locked_duration:n.locked_duration,settle_duration:n.settle_duration,start_activity_time:n.start_time,has_whiteList:n.has_white_list,pool_status:"Upcoming",end_activity_time:0,end_calm_down_time:0,end_settle_time:0}}static buildCreatCrowdsalePoolPayload(t,n,i,o,s,r=!1){if(r){const l=[new F.TypeTagStruct(F.StructTag.fromString(t.coin_type_sale)),new F.TypeTagStruct(F.StructTag.fromString(t.coin_type_raise))],d=t.is_admin?[at.bcsSerializeU128(i*Oo),at.bcsSerializeU128(BigInt(n)),at.bcsSerializeUint64(t.tick_spacing),at.bcsSerializeUint64(t.sale_total),at.bcsSerializeUint64(t.start_time),at.bcsSerializeUint64(t.least_raise_rate*100),at.bcsSerializeUint64(t.activity_duration),at.bcsSerializeUint64(t.settle_duration),at.bcsSerializeUint64(t.locked_duration),at.bcsSerializeU8(0)]:[at.bcsSerializeU128(i*Oo),at.bcsSerializeU128(BigInt(n)),at.bcsSerializeUint64(t.tick_spacing),at.bcsSerializeUint64(t.sale_total),at.bcsSerializeUint64(t.start_time),at.bcsSerializeUint64(t.least_raise_rate*100),at.bcsSerializeUint64(t.liquidity_rate*100),at.bcsSerializeUint64(t.activity_duration),at.bcsSerializeUint64(t.settle_duration),at.bcsSerializeUint64(t.locked_duration),at.bcsSerializeU8(0)];return new F.TransactionPayloadEntryFunction(F.EntryFunction.natural(o,s,l,d))}const a=Pe(o,s),c=[t.coin_type_sale,t.coin_type_raise],u=t.is_admin?[i*Oo,n,t.tick_spacing,t.sale_total,t.start_time,t.least_raise_rate*100,t.activity_duration,t.settle_duration,t.locked_duration,0]:[i*Oo,n,t.tick_spacing,t.sale_total,t.start_time,t.least_raise_rate*100,t.liquidity_rate*100,t.activity_duration,t.settle_duration,t.locked_duration,0];return{type:"entry_function_payload",function:a,type_arguments:c,arguments:u}}static buildCreatFairlaunchPoolPayload(t,n,i,o,s,r=!1){if(r){const l=[new F.TypeTagStruct(F.StructTag.fromString(t.coin_type_sale)),new F.TypeTagStruct(F.StructTag.fromString(t.coin_type_raise))],d=[at.bcsSerializeU128(i*Oo),at.bcsSerializeU128(BigInt(n)),at.bcsSerializeUint64(t.tick_spacing),at.bcsSerializeUint64(t.sale_total),at.bcsSerializeUint64(t.start_time),at.bcsSerializeUint64(t.least_raise_rate*100),at.bcsSerializeUint64(t.liquidity_rate*100),at.bcsSerializeUint64(t.activity_duration),at.bcsSerializeUint64(t.calmdown_duraction),at.bcsSerializeUint64(t.settle_duration),at.bcsSerializeUint64(t.locked_duration)];return new F.TransactionPayloadEntryFunction(F.EntryFunction.natural(o,s,l,d))}const a=Pe(o,s),c=[t.coin_type_sale,t.coin_type_raise],u=[i*Oo,n,t.tick_spacing,t.sale_total,t.start_time,t.liquidity_rate*100,at.bcsSerializeUint64(t.least_raise_rate*100),t.activity_duration,t.calmdown_duraction,t.settle_duration,t.locked_duration];return{type:"entry_function_payload",function:a,type_arguments:c,arguments:u}}};function K6(e){let t;switch(e){case 5:t=5;break;case 10:t=10;break;case 20:t=20;break;case 25:t=25;break;case 50:t=50;break;case 100:t=100;break;default:t=1}const n=100/t+1,i=new Array(n);for(let o=0;o<n;o+=1)i[o]=o*t;return i}function fc(e,t){const n=K6(t),i=new Array(n.length);for(let o=0;o<n.length;o+=1)i[o]=e.muln(n[o]).divn(100);return i}function G6(e,t,n,i){for(let o=t;o<e;o+=1)n.amountInArray[o]=n.amountInArray[o].add(i.amountIn),n.amountOutArray[o]=n.amountOutArray[o].add(i.amountOut),n.feeAmountArray[o]=n.feeAmountArray[o].add(i.feeAmount);return n}function W6(e,t,n,i,o){let s=new _(i.liquidity),{currentSqrtPrice:r}=i,a={amountInArray:[],amountOutArray:[],feeAmountArray:[],nextSqrtPriceArray:[],isExceed:[]};n.forEach(()=>{a.amountInArray.push(Pt),a.amountOutArray.push(Pt),a.feeAmountArray.push(Pt),a.nextSqrtPriceArray.push(Pt)});let c,u;const l=Ec.getDefaultSqrtPriceLimit(e),d=n.length;let h=n[1],g=1,b;e?b=o.sort((v,x)=>x.index-v.index):b=o.sort((v,x)=>v.index-x.index);for(const v of b){if(e){if(i.currentTickIndex<v.index)continue}else if(i.currentTickIndex>v.index)continue;if(v===null)continue;e&&l.gt(v.sqrtPrice)||!e&&l.lt(v.sqrtPrice)?c=l:c=v.sqrtPrice;let x={amountIn:Pt,amountOut:Pt,nextSqrtPrice:Pt,feeAmount:Pt};const P=r,E=s;let S=h,T=g;for(let R=g;R<d;R+=1){const K=em(r,c,s,h,new _(i.feeRate),t);if(x=K,K.amountIn.eq(Pt)||(h=t?h.sub(K.amountIn.add(K.feeAmount)):h.sub(K.amountOut)),h.eq(Pt))a.amountInArray[R]=a.amountInArray[R].add(K.amountIn),a.amountOutArray[R]=a.amountOutArray[R].add(K.amountOut),a.feeAmountArray[R]=a.feeAmountArray[R].add(K.feeAmount),K.nextSqrtPrice.eq(v.sqrtPrice)?(u=e?v.liquidityNet.mul(new _(-1)):v.liquidityNet,s=u.gt(Pt)?s.add(u):s.sub(u.abs()),r=v.sqrtPrice):r=K.nextSqrtPrice,a.amountInArray[R]=a.amountInArray[R].add(a.feeAmountArray[R]),a.nextSqrtPriceArray[R]=r,s=E,r=P,R!==d-1&&(h=S.add(n[R+1].sub(n[T]))),g+=1;else{a=G6(d,R,a,K),S=h,T=g;break}}if(g===d)break;x.nextSqrtPrice.eq(v.sqrtPrice)?(u=e?v.liquidityNet.mul(new _(-1)):v.liquidityNet,s=u.gt(Pt)?s.add(u):s.sub(u.abs()),r=v.sqrtPrice):r=x.nextSqrtPrice}return t?n.forEach((v,x)=>{a.isExceed.push(a.amountInArray[x].lt(v))}):n.forEach((v,x)=>{a.isExceed.push(a.amountOutArray[x].lt(v))}),a}var X6=class{constructor(e,t,n,i,o,s){this.minSplitUnit=t,this.a2b=i,this.byAmountIn=o,this.clmmpool=n,this.ticks=s,this.amountArray=[],this.createSplitSwapParams=this.createSplitSwapParams.bind(this),this.createSplitSwapParams(e,t),this.splitSwapResult={amountInArray:[],amountOutArray:[],feeAmountArray:[],nextSqrtPriceArray:[],isExceed:[]},this.computeSwap=this.computeSwap.bind(this)}createSplitSwapParams(e,t){const n=fc(e,t);this.amountArray=n}computeSwap(){const e=K_(this.clmmpool);return this.splitSwapResult=W6(this.a2b,this.byAmountIn,this.amountArray,e,this.ticks),this.splitSwapResult}},Yl=class{static getMinIndex(t){return of+Math.abs(of)%t}static getMaxIndex(t){return nf-nf%t}};function V6(e,t,n,i,o,s){const r=e.rewarder_infos,a=[];for(let c=0;c<r.length;c+=1){let u=s[c];t!==null&&(e.current_tick_index<i?u=s[c].sub(new _(t.rewardersGrowthOutside[c])):u=t.rewardersGrowthOutside[c]);let l=new _(0);n!==null&&(e.current_tick_index>=o?l=s[c].sub(new _(n.rewardersGrowthOutside[c])):l=n.rewardersGrowthOutside[c]);const d=Te.subUnderflowU128(Te.subUnderflowU128(new _(s[c]),new _(u)),new _(l));a.push(d)}return a}function J6(e){if(e){const t={};return e.maxGasAmount&&(t.maxGasAmount=BigInt(e.maxGasAmount)),e.gasUnitPrice&&(t.gasUnitPrice=BigInt(e.gasUnitPrice)),e.expireTimestamp&&(t.expireTimestamp=BigInt(e.expireTimestamp)),t}}function Z6(e,t){return new dc(i=>{const o=new Uint8Array(64);return new F.Ed25519Signature(o)},e.toUint8Array()).sign(t)}function Y6(e){if(e){const t={};return e.maxGasAmount&&(t.max_gas_amount=e.maxGasAmount.toString()),e.gasUnitPrice&&(t.gas_unit_price=e.gasUnitPrice.toString()),e.expireTimestamp&&(t.expiration_timestamp_secs=e.expireTimestamp.toString()),t}}async function Q6(e,t,n,i,o=!0){if(n instanceof F.TransactionPayload){const l=await e.generateRawTransaction(t.address,n,J6(i)),d=Z6(t.pubkey,l),h=await e.submitBCSSimulation(d);return o&&console.log(h[0]),h[0]}const s=n,r=await e.generateTransaction(t.address,s,Y6(i)),a={type:"ed25519_signature",public_key:t.pubkey.hex(),signature:Be.fromUint8Array(new Uint8Array(64)).hex()},c={sender:t.address.hex(),sequence_number:r.sequence_number.toString(),max_gas_amount:r.max_gas_amount.toString(),gas_unit_price:r.gas_unit_price.toString(),expiration_timestamp_secs:r.expiration_timestamp_secs.toString(),payload:s,signature:a},u=await e.client.transactions.simulateTransaction(c);return o&&console.log(u[0]),u[0]}async function Ga(e,t,n,i){return Q6(e,t,n,i,!1)}function af(e,t){const n=new at.Serializer;n.serializeU32AsUleb128(e.length);const i=n[t];return e.forEach(o=>{n.serializeU32AsUleb128(o.length),o.forEach(s=>{i.call(n,s)})}),n.getBytes()}function t2(e){const t=new at.Serializer;return t.serializeU32AsUleb128(e.length),e.forEach(n=>{t.serializeU32AsUleb128(n.length),n.forEach(i=>{i.serialize(t)})}),t.getBytes()}function e2(e){const t=new at.Serializer;return t.serializeU32AsUleb128(e.length),e.forEach(n=>{n.serialize(t)}),t.getBytes()}function n2(e,t,n,i){const o=e.gt(t)?e.sub(t):t.sub(e),s=n.mul(o).shln(64),r=e.mul(t),a=s.div(r),c=s.mod(r);return i&&!c.eq(Pt)?a.add(new _(1)):a}function Q_(e,t,n,i){if(n.eq(Pt))return e;const o=Te.checkMulShiftLeft(e,t,64,256),s=t.shln(64),r=Te.checkMul(e,n,256);if(!i&&s.lte(r))throw new Wn("getNextSqrtPriceAUp - Unable to divide liquidityShl64 by product","DivideByZero");const a=i?Te.checkDivRoundUpIf(o,s.add(r),!0):Te.checkDivRoundUpIf(o,s.sub(r),!0);if(a.lt(new _(zu)))throw new Wn("getNextSqrtPriceAUp - Next sqrt price less than min sqrt price","CoinAmountMinSubceeded ");if(a.gt(new _(ju)))throw new Wn("getNextSqrtPriceAUp - Next sqrt price greater than max sqrt price","CoinAmountMaxExceeded");return a}function tm(e,t,n,i){const o=Te.checkDivRoundUpIf(n.shln(64),t,!i),s=i?e.add(o):e.sub(o);if(s.lt(new _(zu))||s.gt(new _(ju)))throw new Wn("getNextSqrtPriceAUp - Next sqrt price out of bounds","SqrtPriceOutOfBounds");return s}function i2(e,t,n,i){return i?Q_(e,t,n,!0):tm(e,t,n,!0)}function o2(e,t,n,i){return i?tm(e,t,n,!1):Q_(e,t,n,!1)}function cf(e,t,n,i){const o=e.gt(t)?e.sub(t):t.sub(e);if(n.lte(Pt)||o.eq(Pt))return Pt;let s;if(i){const r=new _(n).mul(new _(o)).shln(64),a=t.mul(e),c=r.div(a);s=r.mod(a).eq(Pt)?c:c.add(us)}else{const r=new _(n).mul(new _(o));s=r.and(Bc).gt(Pt)?r.shrn(64).add(us):r.shrn(64)}return s}function uf(e,t,n,i){const o=e.gt(t)?e.sub(t):t.sub(e);if(n.lte(Pt)||o.eq(Pt))return Pt;let s;if(i)s=n.mul(o).shrn(64);else{const r=n.mul(o).shln(64),a=t.mul(e);s=r.div(a)}return s}function em(e,t,n,i,o,s){if(n===Pt)return{amountIn:Pt,amountOut:Pt,nextSqrtPrice:t,feeAmount:Pt};const r=e.gte(t);let a,c,u,l;if(s){const d=Te.checkMulDivFloor(i,Te.checkUnsignedSub(Ks,o),Ks,64),h=cf(e,t,n,r);h.gt(d)?(a=d,l=Te.checkUnsignedSub(i,d),u=i2(e,n,d,r)):(a=h,l=Te.checkMulDivCeil(a,o,Ks.sub(o),64),u=t),c=uf(e,u,n,r)}else{const d=uf(e,t,n,r);d.gt(i)?(c=i,u=o2(e,n,i,r)):(c=d,u=t),a=cf(e,u,n,r),l=Te.checkMulDivCeil(a,o,Ks.sub(o),64)}return{amountIn:a,amountOut:c,nextSqrtPrice:u,feeAmount:l}}function s2(e,t,n,i,o){let s=n,r=i.liquidity,{currentSqrtPrice:a}=i;const c={amountIn:Pt,amountOut:Pt,feeAmount:Pt,refAmount:Pt,nextSqrtPrice:Pt,crossTickNum:0};let u,l;const d=Ec.getDefaultSqrtPriceLimit(e);for(const h of o){if(e){if(i.currentTickIndex<h.index)continue}else if(i.currentTickIndex>h.index)continue;if(h===null)continue;e&&d.gt(h.sqrtPrice)||!e&&d.lt(h.sqrtPrice)?u=d:u=h.sqrtPrice;const g=em(a,u,r,s,new _(i.feeRate),t);if(g.amountIn.eq(Pt)||(s=t?s.sub(g.amountIn.add(g.feeAmount)):s.sub(g.amountOut)),c.amountIn=c.amountIn.add(g.amountIn),c.amountOut=c.amountOut.add(g.amountOut),c.feeAmount=c.feeAmount.add(g.feeAmount),g.nextSqrtPrice.eq(h.sqrtPrice)?(l=e?h.liquidityNet.mul(new _(-1)):h.liquidityNet,r=l.gt(Pt)?r.add(l):r.sub(l.abs()),a=h.sqrtPrice):a=g.nextSqrtPrice,c.crossTickNum+=1,s.eq(Pt))break}return c.amountIn=c.amountIn.add(c.feeAmount),c.nextSqrtPrice=a,c}function Gs(e,t,n){const i=_.min(e,t),o=_.max(e,t),s=Te.fromX64_BN(n.mul(o).mul(i)),r=o.sub(i);return s.div(r)}function Ws(e,t,n){const i=_.min(e,t),s=_.max(e,t).sub(i);return n.shln(64).div(s)}var Ei=class{constructor(){}static getFeeRate(t){return Ic.fromFraction(t,1e6)}static updateFeeRate(t,n,i,o,s){const r=Te.checkMulDivCeil(n,new _(o),Ks,64),a=i===0?Pt:Te.checkMulDivFloor(n,new _(i),Ks,64),c=n.mul(r).mul(a);if(s?t.feeProtocolCoinA=t.feeProtocolCoinA.add(r):t.feeProtocolCoinB=t.feeProtocolCoinB.add(r),c.eq(Pt)||t.liquidity.eq(Pt))return{refFee:a,clmm:t};const u=c.shln(64).div(t.liquidity);return s?t.feeGrowthGlobalA=t.feeGrowthGlobalA.add(u):t.feeGrowthGlobalB=t.feeGrowthGlobalB.add(u),{refFee:a,clmm:t}}static getProtocolFeeRate(t){return Ic.fromFraction(t,1e4)}static getCoinAmountFromLiquidity(t,n,i,o,s){const r=new li(t.toString()),a=new li(n.toString()),c=new li(i.toString()),u=new li(o.toString());let l,d;return n.lt(i)?(l=Te.toX64_Decimal(r).mul(u.sub(c)).div(c.mul(u)),d=new li(0)):n.lt(o)?(l=Te.toX64_Decimal(r).mul(u.sub(a)).div(a.mul(u)),d=Te.fromX64_Decimal(r.mul(a.sub(c)))):(l=new li(0),d=Te.fromX64_Decimal(r.mul(u.sub(c)))),s?{coinA:new _(l.ceil().toString()),coinB:new _(d.ceil().toString())}:{coinA:new _(l.floor().toString()),coinB:new _(d.floor().toString())}}static estimateLiquidityFromcoinAmounts(t,n,i,o){if(n>i)throw new Error("lower tick cannot be greater than lower tick");const s=Ze.sqrtPriceX64ToTickIndex(t),r=Ze.tickIndexToSqrtPriceX64(n),a=Ze.tickIndexToSqrtPriceX64(i);if(s<n)return Gs(r,a,o.coinA);if(s>=i)return Ws(a,r,o.coinB);const c=Gs(t,a,o.coinA),u=Ws(t,r,o.coinB);return _.min(c,u)}static estLiquidityAndcoinAmountFromOneAmounts(t,n,i,o,s,r,a){const c=Ze.sqrtPriceX64ToTickIndex(a),u=Ze.tickIndexToSqrtPriceX64(t),l=Ze.tickIndexToSqrtPriceX64(n);let d;if(c<t){if(!o)throw new Error("lower tick cannot calculate liquidity by coinB");d=Gs(u,l,i)}else if(c>n){if(o)throw new Error("upper tick cannot calculate liquidity by coinA");d=Ws(l,u,i)}else o?d=Gs(a,l,i):d=Ws(a,u,i);const h=Ei.getCoinAmountFromLiquidity(d,a,u,l,s),g=h.coinA.mul(new _(1+r)),b=h.coinB.mul(new _(1+r));return{tokenMaxA:g,tokenMaxB:b,liquidityAmount:d}}static estCoinAmountsFromTotalAmount(t,n,i,o,s,r){const{ratioA:a,ratioB:c}=Ei.calculateDepositRatioFixTokenA(t,n,i);console.log({ratioA:a,ratioB:c});const u=we(o).mul(a).div(s),l=we(o).mul(c).div(r);return{amountA:u,amountB:l}}static calculateDepositRatioFixTokenA(t,n,i){const o=new _(1),{tokenMaxB:s}=Ei.estLiquidityAndcoinAmountFromOneAmounts(t,n,o,!0,!0,0,i),r=Ze.sqrtPriceX64ToPrice(i,0,0),a=we(o.toString()).mul(r),c=a.add(s.toString()),u=a.div(c),l=we(s.toString()).div(c);return{ratioA:u,ratioB:l}}},r2=class{constructor(t){this._cache={},this._sdk=t}get sdk(){return this._sdk}async fetchAccountResource(t,n,i=0){let o=this._cache[t+n];if(o!=null&&o.getCacheData())return o.value;const s=await this.sdk.Resources.fetchAccountResource(t,n);return o=new Fu(s,i),this._cache[t+n]=o,s}calculateRates(t){const{currentPool:n}=t,i=K_(n);let o;t.a2b?o=t.swapTicks.sort((h,g)=>g.index-h.index):o=t.swapTicks.sort((h,g)=>h.index-g.index);const s=s2(t.a2b,t.byAmountIn,t.amount,i,o);let r=!1;t.byAmountIn?r=s.amountIn.lt(t.amount):r=s.amountOut.lt(t.amount);const a=Ec.getDefaultSqrtPriceLimit(t.a2b);t.a2b&&s.nextSqrtPrice.lt(a)&&(r=!0),!t.a2b&&s.nextSqrtPrice.gt(a)&&(r=!0);let c=0;s.crossTickNum>6&&s.crossTickNum<40&&(c=22e3*(s.crossTickNum-6)),s.crossTickNum>40&&(r=!0);const u=Ze.sqrtPriceX64ToPrice(i.currentSqrtPrice,t.decimalsA,t.decimalsB).toNumber(),l=Ze.sqrtPriceX64ToPrice(s.nextSqrtPrice,t.decimalsA,t.decimalsB).toNumber(),d=Math.abs(u-l)/u*100;return{estimatedAmountIn:s.amountIn,estimatedAmountOut:s.amountOut,estimatedEndSqrtPrice:s.nextSqrtPrice,estimatedFeeAmount:s.feeAmount,isExceed:r,extraComputeLimit:c,amount:t.amount,aToB:t.a2b,byAmountIn:t.byAmountIn,priceImpactPct:d}}transformSwapData(t){const{modules:n}=this._sdk.sdkOptions.networkOptions,i=t.filter(r=>r.type!=="write_resource"?!1:r.data.type===`${n.ClmmIntegrate}::calculator::CalculatedSwapResult`);return i.length===0?[]:i[0].data.data.data||[]}async preswap(t){const{modules:n,simulationAccount:i}=this.sdk.sdkOptions.networkOptions,o=new cn(this.sdk.sdkOptions.rpcUrl),s=`${n.ClmmIntegrate}::scripts`,r="calculate_swap_result",a=[new F.TypeTagStruct(F.StructTag.fromString(t.pool.coinTypeA)),new F.TypeTagStruct(F.StructTag.fromString(t.pool.coinTypeB))],c=[at.bcsToBytes(F.AccountAddress.fromHex(t.pool.poolAddress)),at.bcsSerializeBool(t.a2b),at.bcsSerializeBool(t.by_amount_in),at.bcsSerializeUint64(BigInt(t.amount))],u=new F.TransactionPayloadEntryFunction(F.EntryFunction.natural(s,r,a,c)),l=vr(i.address),d=await o.generateRawTransaction(l,u),h=vr(i.pubkey),g=new F.Ed25519PublicKey(h.toUint8Array()),b=await o.simulateTransaction(g,d),v=this.transformSwapData(b[0].changes),x=Ze.sqrtPriceX64ToPrice(new _(t.pool.current_sqrt_price),t.decimalsA,t.decimalsB).toNumber(),P=Ze.sqrtPriceX64ToPrice(new _(v.after_sqrt_price),t.decimalsA,t.decimalsB).toNumber(),E=Math.abs(x-P)/x*100;return{estimatedAmountIn:v.amount_in&&v.fee_amount?new _(v.amount_in).add(new _(v.fee_amount)).toString():"",estimatedAmountOut:v.amount_out,estimatedEndSqrtPrice:v.after_sqrt_price,estimatedFeeAmount:v.fee_amount,isExceed:v.is_exceed,amount:t.amount,aToB:t.a2b,byAmountIn:t.by_amount_in,priceImpactPct:E}}createSwapTransactionPayload(t,n=!1){const{modules:i}=this.sdk.sdkOptions.networkOptions,o=`${i.LiquidswapDeployer}::${is}`,s="swap",r=Ec.getDefaultSqrtPriceLimit(t.a_to_b);if(n){const u=[new F.TypeTagStruct(F.StructTag.fromString(t.coinTypeA)),new F.TypeTagStruct(F.StructTag.fromString(t.coinTypeB))],l=[at.bcsToBytes(F.AccountAddress.fromHex(t.pool_addr)),at.bcsSerializeBool(t.a_to_b),at.bcsSerializeBool(t.by_amount_in),at.bcsSerializeUint64(BigInt(t.amount)),at.bcsSerializeUint64(BigInt(t.amount_limit)),at.bcsSerializeU128(BigInt(r.toString())),at.bcsSerializeStr(t.partner)];return new F.TransactionPayloadEntryFunction(F.EntryFunction.natural(o,s,u,l))}const a=[t.pool_addr,t.a_to_b,t.by_amount_in,t.amount,t.amount_limit,r.toString(),t.partner],c=[t.coinTypeA,t.coinTypeB];return{type:"entry_function_payload",function:Pe(o,s),type_arguments:c,arguments:a}}},a2=class{constructor(t){this._sdk=t}get sdk(){return this._sdk}createAddLiquidityTransactionPayload(t,n=!1){const{modules:i}=this.sdk.sdkOptions.networkOptions,o=!("delta_liquidity"in t),s=`${i.LiquidswapDeployer}::${is}`,r=o?"add_liquidity_fix_token":"add_liquidity";if(n){const d=[new F.TypeTagStruct(F.StructTag.fromString(t.coinTypeA)),new F.TypeTagStruct(F.StructTag.fromString(t.coinTypeB))],h=o?[at.bcsToBytes(F.AccountAddress.fromHex(t.pool)),at.bcsSerializeUint64(Number(t.amount_a)),at.bcsSerializeUint64(Number(t.amount_b)),at.bcsSerializeBool(t.fix_amount_a),at.bcsSerializeUint64(BigInt.asUintN(64,BigInt(t.tick_lower))),at.bcsSerializeUint64(BigInt.asUintN(64,BigInt(t.tick_upper))),at.bcsSerializeBool(t.is_open),at.bcsSerializeUint64(t.index)]:[at.bcsToBytes(F.AccountAddress.fromHex(t.pool)),at.bcsSerializeU128(t.delta_liquidity.toNumber()),at.bcsSerializeUint64(Number(t.max_amount_a)),at.bcsSerializeUint64(Number(t.max_amount_b)),at.bcsSerializeUint64(BigInt.asUintN(64,BigInt(t.tick_lower))),at.bcsSerializeUint64(BigInt.asUintN(64,BigInt(t.tick_upper))),at.bcsSerializeBool(t.is_open),at.bcsSerializeUint64(t.index)];return new F.TransactionPayloadEntryFunction(F.EntryFunction.natural(s,r,d,h))}const a=BigInt.asUintN(64,BigInt(t.tick_lower)).toString(),c=BigInt.asUintN(64,BigInt(t.tick_upper)).toString(),u=o?[t.pool,t.amount_a,t.amount_b,t.fix_amount_a,a,c,t.is_open,t.index]:[t.pool,t.delta_liquidity.toString(),String(t.max_amount_a),String(t.max_amount_b),a,c,t.is_open,t.index],l=[t.coinTypeA,t.coinTypeB];return{type:"entry_function_payload",function:Pe(s,r),type_arguments:l,arguments:u}}removeLiquidityTransactionPayload(t,n=!1){jx(t.delta_liquidity.gtn(0));const{modules:i}=this.sdk.sdkOptions.networkOptions,o=`${i.LiquidswapDeployer}::${is}`,s=`${i.ClmmIntegrate}::${Z_}`,r=["remove_liquidity","remove_all_liquidity","remove_all_liquidity_for_two","remove_all_liquidity_for_three"];let a,c,u=[];if(t.rewards_num===0){if(n){const l=[new F.TypeTagStruct(F.StructTag.fromString(t.coinTypeA)),new F.TypeTagStruct(F.StructTag.fromString(t.coinTypeB))],d=[at.bcsToBytes(F.AccountAddress.fromHex(t.pool)),at.bcsSerializeU128(t.delta_liquidity.toNumber()),at.bcsSerializeUint64(t.min_amount_a),at.bcsSerializeUint64(t.min_amount_b),at.bcsSerializeUint64(t.pos_index),at.bcsSerializeBool(t.is_close)];return new F.TransactionPayloadEntryFunction(F.EntryFunction.natural(o,r[0],l,d))}a=Pe(o,r[0]),c=[t.coinTypeA,t.coinTypeB],u=[t.pool,t.delta_liquidity.toNumber(),t.min_amount_a,t.min_amount_b,t.pos_index,t.is_close]}else if(t.rewards_num===1){if(n){const l=[new F.TypeTagStruct(F.StructTag.fromString(t.coinTypeA)),new F.TypeTagStruct(F.StructTag.fromString(t.coinTypeB)),new F.TypeTagStruct(F.StructTag.fromString(t.coinTypeC))],d=[at.bcsToBytes(F.AccountAddress.fromHex(t.pool)),at.bcsSerializeU128(t.delta_liquidity.toNumber()),at.bcsSerializeUint64(t.min_amount_a),at.bcsSerializeUint64(t.min_amount_b),at.bcsSerializeUint64(t.pos_index),at.bcsSerializeBool(t.is_close)];return new F.TransactionPayloadEntryFunction(F.EntryFunction.natural(s,r[1],l,d))}a=Pe(s,r[1]),c=[t.coinTypeA,t.coinTypeB,t.coinTypeC],u=[t.pool,t.delta_liquidity.toNumber(),t.min_amount_a,t.min_amount_b,t.pos_index,t.is_close]}else if(t.rewards_num===2){if(n){const l=[new F.TypeTagStruct(F.StructTag.fromString(t.coinTypeA)),new F.TypeTagStruct(F.StructTag.fromString(t.coinTypeB)),new F.TypeTagStruct(F.StructTag.fromString(t.coinTypeC)),new F.TypeTagStruct(F.StructTag.fromString(t.coinTypeD))],d=[at.bcsToBytes(F.AccountAddress.fromHex(t.pool)),at.bcsSerializeU128(t.delta_liquidity.toNumber()),at.bcsSerializeUint64(t.min_amount_a),at.bcsSerializeUint64(t.min_amount_b),at.bcsSerializeUint64(t.pos_index),at.bcsSerializeBool(t.is_close)];return new F.TransactionPayloadEntryFunction(F.EntryFunction.natural(s,r[2],l,d))}a=Pe(s,r[2]),c=[t.coinTypeA,t.coinTypeB,t.coinTypeC,t.coinTypeD],u=[t.pool,t.delta_liquidity.toNumber(),t.min_amount_a,t.min_amount_b,t.pos_index,t.is_close]}else{if(n){const l=[new F.TypeTagStruct(F.StructTag.fromString(t.coinTypeA)),new F.TypeTagStruct(F.StructTag.fromString(t.coinTypeB)),new F.TypeTagStruct(F.StructTag.fromString(t.coinTypeC)),new F.TypeTagStruct(F.StructTag.fromString(t.coinTypeD)),new F.TypeTagStruct(F.StructTag.fromString(t.coinTypeE))],d=[at.bcsToBytes(F.AccountAddress.fromHex(t.pool)),at.bcsSerializeU128(t.delta_liquidity.toNumber()),at.bcsSerializeUint64(t.min_amount_a),at.bcsSerializeUint64(t.min_amount_b),at.bcsSerializeUint64(t.pos_index),at.bcsSerializeBool(t.is_close)];return new F.TransactionPayloadEntryFunction(F.EntryFunction.natural(s,r[3],l,d))}a=Pe(s,r[3]),c=[t.coinTypeA,t.coinTypeB,t.coinTypeC,t.coinTypeD,t.coinTypeE],u=[t.pool,t.delta_liquidity.toNumber(),t.min_amount_a,t.min_amount_b,t.pos_index,t.is_close]}return{type:"entry_function_payload",function:a,type_arguments:c,arguments:u}}closePositionTransactionPayload(t,n=!1){const{modules:i}=this.sdk.sdkOptions.networkOptions,o=`${i.LiquidswapDeployer}::${is}`,s="close_position";if(n){const u=[new F.TypeTagStruct(F.StructTag.fromString(t.coinTypeA)),new F.TypeTagStruct(F.StructTag.fromString(t.coinTypeB))],l=[at.bcsToBytes(F.AccountAddress.fromHex(t.pool_address)),at.bcsSerializeUint64(t.pos_index)];return new F.TransactionPayloadEntryFunction(F.EntryFunction.natural(o,s,u,l))}const r=Pe(o,s),a=[t.coinTypeA,t.coinTypeB],c=[t.pool_address,t.pos_index];return{type:"entry_function_payload",function:r,type_arguments:a,arguments:c}}collectFeeTransactionPayload(t,n=!1){const{modules:i}=this.sdk.sdkOptions.networkOptions,o=`${i.LiquidswapDeployer}::${is}`,s="collect_fee";if(n){const u=[new F.TypeTagStruct(F.StructTag.fromString(t.coinTypeA)),new F.TypeTagStruct(F.StructTag.fromString(t.coinTypeB))],l=[at.bcsToBytes(F.AccountAddress.fromHex(t.pool)),at.bcsSerializeUint64(t.pos_index)];return new F.TransactionPayloadEntryFunction(F.EntryFunction.natural(o,s,u,l))}const r=Pe(o,s),a=[t.coinTypeA,t.coinTypeB],c=[t.pool,t.pos_index];return{type:"entry_function_payload",function:r,type_arguments:a,arguments:c}}};function c2(e){let t="";const i=new Lu(e).parseTypeTag().value.type_args;if(i.length>0){const o=i[0];o.value.name.value===m6||o.value.name.value===J_?t=P6(o).lpAddress:t=Pe(Be.fromUint8Array(o.value.address.address).toShortString(),o.value.module_name.value,o.value.name.value,[])}return t}var u2=5*60*1e3,Ji=24*60*60*1e3;function lf(e){return Date.parse(new Date().toString())+e}var l2=class{constructor(e){this._cache={},this._sdk=e}get sdk(){return this._sdk}async getPoolImmutablesResource(e=!1){const t=this._sdk.sdkOptions.networkOptions.modules.LiquidswapDeployer,n=`${t}_getMmutablesPools`,i=this.getCacheData(n);let o;if(!e&&i!=null)o=i;else{const r=Pe(t,X_,V_),a=await this.fetchAccountResource(t,r);o=JSON.parse(JSON.stringify(a==null?void 0:a.data.data)),this.updateCache(n,o,Ji)}return o.data}buildPoolImmutables(e,t,n){const i=n.key,o=Pe(i.coin_type_a.account_address,to(i.coin_type_a.module_name),to(i.coin_type_a.struct_name)),s=Pe(i.coin_type_b.account_address,to(i.coin_type_b.module_name),to(i.coin_type_b.struct_name)),r=Pe(Pe(t,y6,w6),[o,s]);return{coinTypeA:o,coinTypeB:s,poolType:r,poolAddress:e,tickSpacing:i.tick_spacing}}async getPoolImmutables(e=[],t=0,n=100,i=!0){const o=this._sdk.sdkOptions.networkOptions.modules.LiquidswapDeployer,s=[],r=await this.getPoolImmutablesResource(i),a=e.length>0;for(let c=0;c<r.length;c+=1){const u=r[c],l=u.value;if(!(a&&!e.includes(l))){if(!a){const d=Number(c);if(d<t||d>=t+n)continue}s.push(this.buildPoolImmutables(l,o,u))}}return s}async getPools(e=[],t=0,n=100){const i=[],o=(await this.sdk.getGlobalConfig()).is_pause,s=await this.getPoolImmutables(e,t,n,!1);for(let r=0;r<s.length;r+=1){const a=s[r],c=await this.getPoolState(a.poolAddress,a.poolType,o),u={...a,...c};i.push(u);const l=`${a.poolAddress}_pool`;this.updateCache(l,u,Ji)}return i}async getPool(e,t=!0){const n=`${e}_pool`,i=this.getCacheData(n);let o;if(i!==null&&!t&&(o=i),o==null)return(await this.getPools([e]))[0];const s=(await this.sdk.getGlobalConfig(!0)).is_pause,r=await this.getPoolState(e,o.poolType,s),a={...o,...r};return this.updateCache(n,a,Ji),a}async getPoolState(e,t,n,i=!0){const o=`${e}_${t}getPool`;if(!i){const l=this.getCacheData(o);if(l!==null)return l}const s=await this.fetchAccountResource(e,t),r=JSON.parse(JSON.stringify(s==null?void 0:s.data)),a=r.rewarder_infos,c=[];a.forEach(l=>{const d=Pe(l.coin_type.account_address,to(l.coin_type.module_name),to(l.coin_type.struct_name)),h=Te.fromX64(new _(l.emissions_per_second)),g=Math.floor(h.toNumber()*60*60*24);c.push({...l,coinAddress:d,emissionsEveryDay:g})});const u={coinAmountA:r.coin_a.value,coinAmountB:r.coin_b.value,current_sqrt_price:r.current_sqrt_price,current_tick_index:Number(BigInt.asIntN(64,BigInt(r.current_tick_index.bits)).toString()),fee_growth_global_a:r.fee_growth_global_a,fee_growth_global_b:r.fee_growth_global_b,fee_protocol_coin_a:r.fee_protocol_coin_a,fee_protocol_coin_b:r.fee_protocol_coin_b,fee_rate:r.fee_rate,liquidity:r.liquidity,index:r.index,positionIndex:r.position_index,tick_indexes_handle:r.tick_indexes.handle,ticks_handle:r.ticks.handle,positions_handle:r.positions.handle,collectionName:r.collection_name,uri:r.uri,is_pause:n||r.is_pause,rewarder_infos:c,rewarder_last_updated_time:r.rewarder_last_updated_time};return this.updateCache(o,u,Ji),u}async getTickDataByIndex(e,t){const n=await this._sdk.client.getTableItem(e,{key_type:`${this.sdk.sdkOptions.networkOptions.modules.IntegerMate}::i64::I64`,value_type:`${this.sdk.sdkOptions.networkOptions.modules.LiquidswapDeployer}::pool::Tick`,key:g6(t)}),i=JSON.parse(JSON.stringify(n));return{index:i.index,sqrtPrice:i.sqrt_price,liquidityGross:i.liquidity_gross,liquidityNet:i.liquidity_net,feeGrowthOutsideA:i.fee_growth_outside_a,feeGrowthOutsideB:i.fee_growth_outside_b,rewardersGrowthOutside:i.rewarders_growth_outside}}async getPoolLowerAndUpperTicks(e,t){const n=[],i=[],o=t.ticks_handle,s=await this.sdk.Resources.getPositionList(e,[t]);for(const r of s){const a=await this.sdk.Resources.getTickDataByIndex(o,r.tick_lower_index),c=await this.sdk.Resources.getTickDataByIndex(o,r.tick_upper_index);n.push(a),i.push(c)}return[n,i]}async getPositionInfoByIndex(e,t){const n=await this._sdk.client.getTableItem(e,{key_type:"u64",value_type:`${this.sdk.sdkOptions.networkOptions.modules.LiquidswapDeployer}::pool::Position`,key:t.toString()}),i=JSON.parse(JSON.stringify(n));return{name:"",pool:i.pool,liquidity:i.liquidity,tick_lower_index:BigInt.asIntN(64,BigInt(i.tick_lower_index.bits)).toString(),tick_upper_index:BigInt.asIntN(64,BigInt(i.tick_upper_index.bits)).toString(),fee_growth_inside_a:i.fee_growth_inside_a,fee_growth_inside_b:i.fee_growth_inside_b,fee_owed_a:i.fee_owed_a,fee_owed_b:i.fee_owed_b,reward_amount_owed_0:i.rewarder_infos[0].amount_owed,reward_amount_owed_1:i.rewarder_infos[1].amount_owed,reward_amount_owed_2:i.rewarder_infos[2].amount_owed,reward_growth_inside_0:i.rewarder_infos[0].growth_inside,reward_growth_inside_1:i.rewarder_infos[1].growth_inside,reward_growth_inside_2:i.rewarder_infos[2].growth_inside,index:t}}createPositionName(e,t){return`Cetus LP | Pool${e}-${t}`}async getPositionInfo(e,t,n=!0){if(M6(t)){const i=await this.getPositionInfoByIndex(e.positions_handle,Number(t));return i.name=this.createPositionName(e.index,i.index),i}return this.getPositionInfoByTokenName(e.poolAddress,e.positions_handle,e.collectionName,t,n)}async getPositionIndex(e,t,n,i=!1){const o=`${e}_${t}_${n}_getPositionIndex`;if(!i){const a=this.getCacheData(o);if(a!==null)return a}const s=await this._sdk.tokenClient.getTokenData(e,t,n),r=JSON.parse(JSON.stringify(s)).default_properties.data.index.value;return this.updateCache(o,r,Ji),r}async getPositionInfoByTokenName(e,t,n,i,o=!0){const s=`${e}_${n}_${i}_getPositionInfo`;if(!o){const c=this.getCacheData(s);if(c!==null)return c}const r=await this.getPositionIndex(e,n,i,!1),a=await this.getPositionInfoByIndex(t,r);return a.name=i,this.updateCache(s,a,Ji),a}async getGlobalConfig(e,t=!0){const n=`${e}_getGlobalConfig`;if(!t){const r=this.getCacheData(n);if(r!==null)return r}const i=await this.fetchAccountResource(e,Pe(e,"config","GlobalConfig")),o=JSON.parse(JSON.stringify(i)).data,s={protocol_fee_rate:o.protocol_fee_rate,is_pause:o.is_pause};return this.updateCache(n,s,Ji),s}async getSpecifyCoinInfos(e){const t=[];for(const n of e){const i=`${n}_getCoinInfos`,o=this.getCacheData(i);if(o!==null)t.push(o);else{const s=th(n).address,r=await this._sdk.Resources.fetchAccountResource(s,B6(n));if(r!=null){const a={coinAddress:n,...r.data};t.push(a),this.updateCache(i,a,Ji)}}}return t}async getCoinInfos(e,t=!0){const n=`${e}_getCoinInfos`;if(!t){const s=this.getCacheData(n);if(s!==null)return s}const i=await this.fetchAccountResources(e),o=[];return i==null||i.forEach(s=>{if(s.type.startsWith(G_)){const r=c2(s.type);r.length>0&&o.push({coinAddress:r,...s.data})}}),this.updateCache(n,o,Ji),o}async getCoinStores(e,t=!0){const n=`${e}_getCoinStores`;if(!t){const s=this.getCacheData(n);if(s!==null)return s}const i=await this.fetchAccountResources(e),o=[];return i==null||i.forEach(s=>{if(s.type.startsWith(W_)){const r=ef(s.type);r.length>0&&o.push({coinAddress:r,...s.data})}}),this.updateCache(n,o,Ji),o}async getCoinStore(e,t){const n=await this.fetchAccountResource(e,C6(t));if(n){const i=ef(n.type);if(i.length>0)return{coinAddress:i,...n.data}}return null}async getPositionList(e,t){const n=[];if(t.length===0)return[];const i=await this.getFilterTokenEvent(e);for(let o=0;o<i.length;o++){const s=i[o];try{for(const r of t)if(s.creator===r.poolAddress){const a=await this.getPositionInfoByTokenName(s.creator,r.positions_handle,s.collection,s.name);a.pool.length>0&&n.push({...s,...a})}}catch(r){console.log(r)}}return n}async getCollectionList(e){return await this.getFilterTokenEvent(e)}async getFilterTokenEvent(e){const t=[],n=[];let i=[];try{i=await this._sdk.client.getEventsByEventHandle(e,Qh,"deposit_events")}catch(s){console.log(s)}i.forEach(s=>{t.push({key:`${s.data.id.token_data_id.creator}_${s.data.id.token_data_id.name}`,creator:s.data.id.token_data_id.creator,name:s.data.id.token_data_id.name,collection:s.data.id.token_data_id.collection,count:0})});let o=[];try{o=await this._sdk.client.getEventsByEventHandle(e,Qh,"withdraw_events")}catch(s){console.log(s)}return o.forEach(s=>{if(s.type===_6){for(const r of t)if(r.count===0&&r.key===`${s.data.id.token_data_id.creator}_${s.data.id.token_data_id.name}`){r.count-=1;break}}}),t.forEach(s=>{s.count===0&&n.push({...s})}),n}async fetchAccountResource(e,t){var n;try{return await this._sdk.client.getAccountResource(e,t)}catch(i){if(sf(i)&&((n=i.response)==null?void 0:n.status)===404)return null;throw i}}async fetchAccountResources(e){var t;try{return await this._sdk.client.getAccountResources(e)}catch(n){if(sf(n)&&((t=n.response)==null?void 0:t.status)===404)return null;throw n}}updateCache(e,t,n=u2){let i=this._cache[e];i?(i.overdueTime=lf(n),i.value=t):i=new Fu(t,lf(n)),this._cache[e]=i}getCacheData(e){const t=this._cache[e];return t!==void 0&&t.getCacheData()?t.value:null}},d2=class{constructor(t){this._sdk=t}get sdk(){return this._sdk}creatPoolTransactionPayload(t,n=!1){const{modules:i}=this.sdk.sdkOptions.networkOptions,o=t.delta_liquidity.gt(Pt),s=o?`${i.LiquidswapDeployer}::${Z_}`:`${i.LiquidswapDeployer}::${is}`,r=o?"create_and_add_liquidity":"create_pool";if(n){const l=[new F.TypeTagStruct(F.StructTag.fromString(t.coinTypeA)),new F.TypeTagStruct(F.StructTag.fromString(t.coinTypeB))],d=o?[at.bcsSerializeUint64(t.tick_spacing),at.bcsSerializeU128(BigInt(t.initialize_sqrt_price.toString())),at.bcsSerializeStr(t.uri),at.bcsSerializeU128(BigInt(t.delta_liquidity.toString())),at.bcsSerializeUint64(BigInt(t.max_amount_a.toString())),at.bcsSerializeUint64(BigInt(t.max_amount_b.toString())),at.bcsSerializeUint64(BigInt.asUintN(64,BigInt(t.tick_lower))),at.bcsSerializeUint64(BigInt.asUintN(64,BigInt(t.tick_upper)))]:[at.bcsSerializeUint64(t.tick_spacing),at.bcsSerializeU128(BigInt(t.initialize_sqrt_price.toString())),at.bcsSerializeStr(t.uri)];return new F.TransactionPayloadEntryFunction(F.EntryFunction.natural(s,r,l,d))}const a=Pe(s,r),c=[t.coinTypeA,t.coinTypeB],u=o?[t.tick_spacing.toString(),t.initialize_sqrt_price.toString(),t.uri.toString(),t.delta_liquidity.toString(),t.max_amount_a.toString(),t.max_amount_b.toString(),BigInt.asUintN(64,BigInt(t.tick_lower)).toString(),BigInt.asUintN(64,BigInt(t.tick_upper)).toString()]:[t.tick_spacing.toString(),t.initialize_sqrt_price.toString(),t.uri.toString()];return{type:"entry_function_payload",function:a,type_arguments:c,arguments:u}}},h2=class{constructor(t){this._sdk=t,this.growthGlobal=[Pt,Pt,Pt]}get sdk(){return this._sdk}async listRewarderInfosFromClmmpool(t){const n=await this.sdk.Resources.getPool(t),i=[];for(const o of n.rewarder_infos)i.push(o);return i}async emissionsEveryDay(t){const n=await this.listRewarderInfosFromClmmpool(t);if(!n)return null;const i=[];for(const o of n){const s=Te.fromX64(new _(o.emissions_per_second));i.push({emissions:Math.floor(s.toNumber()*60*60*24),coin_address:o.coinAddress})}return i}async collectRewarderAmount(t,n){const i=await this.sdk.Resources.getPositionInfo(t,n);return i?{reward_amount_owed_0:i.reward_amount_owed_0,reward_amount_owed_1:i.reward_amount_owed_1,reward_amount_owed_2:i.reward_amount_owed_2}:null}async updatePoolRewarder(t,n){const i=await this.sdk.Resources.getPool(t),o=i.rewarder_last_updated_time;if(i.rewarder_last_updated_time=n,i.liquidity===0||n.eq(o))return i;const s=n.div(new _(1e3)).sub(new _(o)).add(new _(15)),r=i.rewarder_infos;for(let a=0;a<r.length;a+=1){const c=r[a],u=Te.checkMulDivFloor(s,new _(c.emissions_per_second),new _(i.liquidity),128);this.growthGlobal[a]=new _(c.growth_global).add(new _(u))}return i}async posRewardersAmount(t,n,i,o){const s=Date.parse(new Date().toString()),r=await this.updatePoolRewarder(t,new _(s)),a=await this.sdk.Resources.getPositionInfo(r,n),c=parseInt(a.tick_lower_index,10),u=parseInt(a.tick_upper_index,10),l=V6(r,i,o,c,u,this.growthGlobal),d=[],h=[];if(l.length>0){const g=Te.subUnderflowU128(l[0],new _(a.reward_growth_inside_0)),b=Te.checkMulShiftRight(new _(a.liquidity),g,64,256);d.push(l[0]),h.push({amount_owed:new _(a.reward_amount_owed_0).add(b),coin_address:r.rewarder_infos[0].coinAddress})}if(l.length>1){const g=Te.subUnderflowU128(l[1],new _(a.reward_growth_inside_1)),b=Te.checkMulShiftRight(new _(a.liquidity),g,64,256);d.push(l[1]),h.push({amount_owed:new _(a.reward_amount_owed_1).add(b),coin_address:r.rewarder_infos[1].coinAddress})}if(l.length>2){const g=Te.subUnderflowU128(l[2],new _(a.reward_growth_inside_2)),b=Te.checkMulShiftRight(new _(a.liquidity),g,64,256);d.push(l[2]),h.push({amount_owed:new _(a.reward_amount_owed_2).add(b),coin_address:r.rewarder_infos[2].coinAddress})}return h}async poolRewardersAmount(t,n,i,o){const s=Date.parse(new Date().toString()),r=await this.updatePoolRewarder(n,new _(s)),a=await this.sdk.Resources.getPositionList(t,[r]),c=[Pt,Pt,Pt];for(let u=0;u<a.length;u+=1){const l=await this.posRewardersAmount(n,a[u],i[u],o[u]);for(let d=0;d<3;d+=1)c[d]=c[d].add(l[d].amount_owed)}return c}collectPosRewarderTransactionPayload(t,n=!1){const{modules:i}=this.sdk.sdkOptions.networkOptions,o=`${i.LiquidswapDeployer}::${is}`,s="collect_rewarder";if(n){const u=[new F.TypeTagStruct(F.StructTag.fromString(t.coinTypeA)),new F.TypeTagStruct(F.StructTag.fromString(t.coinTypeB)),new F.TypeTagStruct(F.StructTag.fromString(t.coinTypeC))],l=[at.bcsToBytes(F.AccountAddress.fromHex(t.pool_address)),at.bcsSerializeU8(t.index),at.bcsSerializeUint64(t.pos_index)];return new F.TransactionPayloadEntryFunction(F.EntryFunction.natural(o,s,u,l))}const r=Pe(o,s),a=[t.coinTypeA,t.coinTypeB,t.coinTypeC],c=[t.pool_address,t.index,t.pos_index];return{type:"entry_function_payload",function:r,type_arguments:a,arguments:c}}collectPoolRewarderTransactionPayload(t,n=!1){if(t.rewarder_nums===1){const s={pool_address:t.pool_address,index:0,pos_index:t.pos_index,coinTypeA:t.coinTypeA,coinTypeB:t.coinTypeB,coinTypeC:t.coinTypeC};return this.collectPosRewarderTransactionPayload(s,n)}const{modules:i}=this.sdk.sdkOptions.networkOptions,o=`${i.ClmmIntegrate}::${Zl}`;if(t.rewarder_nums===2){const s="collect_rewarder_for_two";if(n){const u=[new F.TypeTagStruct(F.StructTag.fromString(t.coinTypeA)),new F.TypeTagStruct(F.StructTag.fromString(t.coinTypeB)),new F.TypeTagStruct(F.StructTag.fromString(t.coinTypeC)),new F.TypeTagStruct(F.StructTag.fromString(t.coinTypeD))],l=[at.bcsToBytes(F.AccountAddress.fromHex(t.pool_address)),at.bcsSerializeUint64(t.pos_index)];return new F.TransactionPayloadEntryFunction(F.EntryFunction.natural(o,s,u,l))}const r=Pe(o,s),a=[t.coinTypeA,t.coinTypeB,t.coinTypeC,t.coinTypeD],c=[t.pool_address,t.pos_index];return{type:"entry_function_payload",function:r,type_arguments:a,arguments:c}}if(t.rewarder_nums===3){const s="collect_rewarder_for_three";if(n){const u=[new F.TypeTagStruct(F.StructTag.fromString(t.coinTypeA)),new F.TypeTagStruct(F.StructTag.fromString(t.coinTypeB)),new F.TypeTagStruct(F.StructTag.fromString(t.coinTypeC)),new F.TypeTagStruct(F.StructTag.fromString(t.coinTypeD)),new F.TypeTagStruct(F.StructTag.fromString(t.coinTypeE))],l=[at.bcsToBytes(F.AccountAddress.fromHex(t.pool_address)),at.bcsSerializeUint64(t.pos_index)];return new F.TransactionPayloadEntryFunction(F.EntryFunction.natural(o,s,u,l))}const r=Pe(o,s),a=[t.coinTypeA,t.coinTypeB,t.coinTypeC,t.coinTypeD,t.coinTypeE],c=[t.pool_address,t.pos_index];return{type:"entry_function_payload",function:r,type_arguments:a,arguments:c}}}},f2=5*60*1e3,Wa=24*60*60*1e3;function df(e){return Date.parse(new Date().toString())+e}var p2=class{constructor(t){this._cache={},this._sdk=t}get sdk(){return this._sdk}async getOwnerTokenList(t,n,i=!1){const o="getAllRegisteredTokenList";if(!i){const d=this.getCacheData(o);if(d!==null)return d}const{modules:s}=this._sdk.sdkOptions.networkOptions,r=`${s.TokenDeployer}::coin_list`,a="fetch_full_list",c=new F.TransactionPayloadEntryFunction(F.EntryFunction.natural(r,a,[],[at.bcsToBytes(F.AccountAddress.fromHex(n))])),u=await Ga(new cn(this.sdk.sdkOptions.rpcUrl),t,c),l=this.transformTokenData(u.changes);return this.updateCache(o,l,Wa),l}async getTokenListByCoinType(t,n=0,i=20){const{fraphQLUrl:o}=this._sdk.sdkOptions;if(!o)throw Error("The fraphQLUrl is not configured in the SDK");const s={query:`query MyQuery {
  coin_infos(
  limit: ${i}, offset: ${n},  order_by: {name: desc}, where: {  coin_type: {_regex: "${t}"}}
  ) {
    coin_type
    symbol
    name
    decimals
    creator_address
    coin_type_hash
  }
}
`,variables:null,operationName:"MyQuery"},r=await ds.post(o,s),a=[];return r.data.data.coin_infos.forEach(c=>{a.push({address:c.coin_type,symbol:c.symbol,official_symbol:c.symbol,decimals:c.decimals,name:c.name,coingecko_id:"",project_url:"",logo_url:""})}),a}async getSpecifyTokenListByCache(t){const n="getAllRegisteredTokenList",i=this.getCacheData(n),o=[];if(i!==null){const s=i;for(const r of t)for(const a of s)if(r===a.address){o.push(a);continue}}return o}async getAllRegisteredTokenList(t,n=!1){const i="getAllRegisteredTokenList";if(!n){const d=this.getCacheData(i);if(d!==null)return d}const{modules:o}=this._sdk.sdkOptions.networkOptions,s=`${o.TokenDeployer}::coin_list`,r="fetch_all_registered_coin_info",a=new cn(this.sdk.sdkOptions.rpcUrl),c=new F.TransactionPayloadEntryFunction(F.EntryFunction.natural(s,r,[],[])),u=await Ga(a,t,c),l=this.transformTokenData(u.changes);return this.updateCache(i,l,Wa),l}transformTokenData(t){const n=[],{modules:i}=this._sdk.sdkOptions.networkOptions,o=t.filter(a=>a.type!=="write_resource"?!1:a.data.type===`${i.TokenDeployer}::coin_list::CoinList<${i.TokenDeployer}::coin_list::CoinInfo>`);if(o.length===0)return n;const r=o[0].data.data;return"full_list"in r&&r.full_list.value_list.forEach(a=>{const c={...a},u=a.extensions.data;for(const l of u){if(l.key==="labels")try{l.value=JSON.parse(decodeURIComponent(sr.decode(l.value)))}catch{}c[l.key]=l.value}n.push(c)}),n}async getAllRegisteredPoolList(t,n=!1){const i="getAllRegisteredPoolList";if(!n){const d=this.getCacheData(i);if(d!==null)return d}const{modules:o}=this._sdk.sdkOptions.networkOptions,s=`${o.TokenDeployer}::lp_list`,r="fetch_all_registered_coin_info",a=new cn(this.sdk.sdkOptions.rpcUrl),c=new F.TransactionPayloadEntryFunction(F.EntryFunction.natural(s,r,[],[])),u=await Ga(a,t,c),l=this.transformPoolData(u.changes);return this.updateCache(i,l,Wa),l}async getOwnerPoolList(t,n,i=!1){const o="getAllRegisteredPoolList";if(!i){const d=this.getCacheData(o);if(d!==null)return d}const{modules:s}=this._sdk.sdkOptions.networkOptions,r=`${s.TokenDeployer}::lp_list`,a="fetch_full_list",c=new F.TransactionPayloadEntryFunction(F.EntryFunction.natural(r,a,[],[at.bcsToBytes(F.AccountAddress.fromHex(n))])),u=await Ga(new cn(this.sdk.sdkOptions.rpcUrl),t,c),l=this.transformPoolData(u.changes);return this.updateCache(o,l,Wa),l}transformPoolData(t){const n=[],{modules:i}=this._sdk.sdkOptions.networkOptions,o=t.filter(a=>a.type!=="write_resource"?!1:a.data.type===`${i.TokenDeployer}::lp_list::PoolList<${i.TokenDeployer}::lp_list::PoolInfo>`);if(o.length===0)return n;const r=o[0].data.data;return"full_list"in r&&r.full_list.value_list.forEach(a=>{const c={...a},u=a.extensions.data;for(const l of u){if(l.key==="labels")try{l.value=JSON.parse(decodeURIComponent(sr.decode(l.value)))}catch{}c[l.key]=l.value}n.push(c)}),n}async getOwnerWarpPoolList(t,n,i=!1){const o=await this.getOwnerTokenList(n,t,i),s=await this.getOwnerPoolList(n,t,i),r=[];for(const a of s){for(const c of o)c.address===a.coin_a_address&&(a.coinA=c),c.address===a.coin_b_address&&(a.coinB=c);r.push(a)}return r}async getWarpPoolList(t,n=!1){const i=await this.getAllRegisteredTokenList(t,n),o=await this.getAllRegisteredPoolList(t,n),s=[];for(const r of o){for(const a of i)a.address===r.coin_a_address&&(r.coinA=a),a.address===r.coin_b_address&&(r.coinB=a);s.push(r)}return s}updateCache(t,n,i=f2){let o=this._cache[t];o?(o.overdueTime=df(i),o.value=n):o=new Fu(n,df(i)),this._cache[t]=o}getCacheData(t){const n=this._cache[t];return n!==void 0&&n.getCacheData()?n.value:null}},g2=3e4,mn={maxAmountOut:Pt,isExceed:!1,path:[]};function hf(e,t){return{pair:`${e}-${t}`,reversePair:`${t}-${e}`}}function _2(e,t,n,i){const o=e.length;if(!e.length)throw new Error("routerTable is empty");if(o!==t.length)throw new Error("routerTable length not equal to feeRateArray length");let s=i?Pt:new _(2).pow(new _(64)),r=[];const a=100/(e[0].length-1);switch(o){case 1:{s=e[0][e[0].length-1],n[0][n[0].length-1]||r.push({feeRate:t[0],percent:100});break}case 2:{for(let c=0;c<e[0].length;c+=1){const u=e[0].length-c-1,l=e[0][c].add(e[1][u]);if(l.gt(s)&&i||l.lt(s)&&!i)if(!n[0][c]&&!n[1][u])r=[],s=l,c>0&&r.push({feeRate:t[0],percent:c*a}),u>0&&r.push({feeRate:t[1],percent:u*a});else continue}break}case 3:{for(let c=0;c<e[0].length;c+=1)for(let u=0;u<e[0].length-c;u+=1){const l=e[0].length-c-u-1,d=e[0][c].add(e[1][u]).add(e[2][l]);if(d.gt(s)&&i||d.lt(s)&&!i){if(n[0][c]||n[1][u]||n[2][l])continue;r=[],s=d,c>0&&r.push({feeRate:t[0],percent:a*c}),u>0&&r.push({feeRate:t[1],percent:u*a}),l>0&&r.push({feeRate:t[2],percent:l*a})}}break}case 4:{for(let c=0;c<e[0].length;c+=1)for(let u=0;u<e[0].length-c;u+=1)for(let l=0;l<e[0].length-c-u;l+=1){const d=e[0].length-c-u-l-1,h=e[0][c].add(e[1][u]).add(e[2][l]).add(e[3][d]);if(h.gt(s)&&i||h.lt(s)&&!i){if(n[0][c]||n[1][u]||n[2][l]||n[3][d])continue;r=[],s=h,c>0&&r.push({feeRate:t[0],percent:a*c}),u>0&&r.push({feeRate:t[1],percent:u*a}),l>0&&r.push({feeRate:t[2],percent:l*a}),d>0&&r.push({feeRate:t[3],percent:d*a})}}break}}return r.length===0||s.eq(Pt)?{maxAmountOut:Pt,path:[],isExceed:!0}:{maxAmountOut:s,path:r,isExceed:!1}}var m2=class{constructor(t){this.pathProviders=[],this.coinProviders={coins:[]},this.graph=new H_,this._coinSymbolMap=new Map,this._coinAddressMap=new Map,this.poolAddressMap=new Map,this.poolMap=new Map,this.ticksMap=new Map,this._sdk=t,this.leastRefreshTime=Date.now(),this.createTxParams={partitionQuantities:[],swapDirects:[],poolAddresses:[],percents:[],totalAmounts:[],partner:"",amountLimit:"0",amountOut:"0",coinTypes:[]},this.splitUnit=50,this.poolDirectionMap=new Map,this.isInited=!1,this.getPoolAddressMapAndDirection=this.getPoolAddressMapAndDirection.bind(this),this.setCoinList=this.setCoinList.bind(this),this.loadGraph=this.loadGraph.bind(this),this.addCoinProvider=this.addCoinProvider.bind(this),this.addPathProvider=this.addPathProvider.bind(this),this.splitSwap=this.splitSwap.bind(this),this.splitSwapForRouter=this.splitSwapForRouter.bind(this),this.splitSwapForRouters=this.splitSwapForRouters.bind(this),this.refreshPoolofSwapRouter=this.refreshPoolofSwapRouter.bind(this),this.getBestSplitResultInOnePair=this.getBestSplitResultInOnePair.bind(this),this.findBestSplitPriceWithOneSkip=this.findBestSplitPriceWithOneSkip.bind(this),this.findBestSplitPriceWithTwoSkip=this.findBestSplitPriceWithTwoSkip.bind(this),this.findBestSplitPriceWithThreeSkip=this.findBestSplitPriceWithThreeSkip.bind(this),this.findBestSplitPrice=this.findBestSplitPrice.bind(this),this.price=this.price.bind(this),this.routerSwap=this.routerSwap.bind(this)}get sdk(){return this._sdk}getPoolAddressMapAndDirection(t,n){const{pair:i,reversePair:o}=hf(t,n);let s=this.poolAddressMap.get(i);if(s!=null)return{addressMap:s,direction:!0};if(s=this.poolAddressMap.get(o),s!=null)return{addressMap:s,direction:!1}}async setCoinList(){this.coinProviders.coins.forEach(t=>{this._coinSymbolMap.set(t.symbol,t),this._coinAddressMap.set(t.address,t)})}loadGraph(){return this.pathProviders.forEach(t=>{const{paths:n}=t;n.forEach(i=>{var o,s;const r=(o=this.graph.getVertexByKey(i.base))!=null?o:new Cc(i.base),a=(s=this.graph.getVertexByKey(i.quote))!=null?s:new Cc(i.quote);this.graph.addEdge(new z_(r,a));const c=this._coinSymbolMap.get(i.base),u=this._coinSymbolMap.get(i.quote);if(c!=null&&u!=null){const l=hf(i.base,i.quote).pair;this.poolAddressMap.set(l,i.addressMap)}})}),this}addPathProvider(t){return this.pathProviders.push(t),this}addCoinProvider(t){return this.coinProviders=t,this}tokenInfo(t){return this._coinAddressMap.has(t)?this._coinAddressMap.get(t):this._coinSymbolMap.get(t)}getCreateTxParams(){return this.createTxParams}isPoolDirectionSet(t){return this.poolDirectionMap.get(t)!=null}getPoolDirection(t){if(this.isPoolDirectionSet(t))return this.poolDirectionMap.get(t)}setPoolDirection(t,n){this.poolDirectionMap.set(t,n)}getBestSplitResultInOnePair(t,n,i,o,s,r){if(o.eq(Pt))return{maxAmountOut:Pt,path:[],isExceed:!1};console.log(o.toString());const a=[],c=[],u=[],l=this.getPoolAddressMapAndDirection(n,i),d=l==null?void 0:l.addressMap;if(d)for(const[h,g]of d.entries()){const b=this.poolMap.get(g),v=this.poolDirectionMap.get(g),x=s===v,P=this.ticksMap.get(g),S=new X6(o,t,b,x,r,P).computeSwap();r?a.push(S.amountOutArray):a.push(S.amountInArray),u.push(S.isExceed),c.push(h)}return _2(a.slice(0,4),c.slice(0,4),u.slice(0,4),r)}findBestSplitPriceWithOneSkip(t,n,i,o,s){const r={maxAmountOut:new _(0),path:[],poolAddresses:[],totalAmounts:[],percents:[],isExceed:!1},a=[],c=[],u=[],l=[];if(!s){let g=mn,b=mn;if(o){if(g=this.getBestSplitResultInOnePair(50,t[0][0],t[0][1],n,i[0][0],o),g.isExceed||(b=this.getBestSplitResultInOnePair(5,t[0][2],t[0][3],g.maxAmountOut,i[0][1],o),b.isExceed))return r.isExceed=!0,r;r.maxAmountOut=b.maxAmountOut}else{if(b=this.getBestSplitResultInOnePair(5,t[0][2],t[0][3],n,i[0][1],o),b.isExceed||(g=this.getBestSplitResultInOnePair(5,t[0][0],t[0][1],b.maxAmountOut,i[0][0],o),g.isExceed))return r.isExceed=!0,r;r.maxAmountOut=g.maxAmountOut}a.push(g.path),a.push([]),a.push(b.path);const v=[],x=[],P=[];g.path.forEach(V=>{var W;o?v.push(n.muln(V.percent).divn(100)):v.push(b.maxAmountOut.muln(V.percent).divn(100)),P.push(V.percent);const tt=(W=this.getPoolAddressMapAndDirection(t[0][0],t[0][1]))==null?void 0:W.addressMap.get(V.feeRate);x.push(tt)});const E=[],S=[],T=[];b.path.forEach(V=>{var W;o?E.push(g.maxAmountOut.muln(V.percent).divn(100)):E.push(n.muln(V.percent).divn(100)),T.push(V.percent);const tt=(W=this.getPoolAddressMapAndDirection(t[0][2],t[0][3]))==null?void 0:W.addressMap.get(V.feeRate);S.push(tt)});let R=Pt;v.forEach(V=>{R=R.add(V)});const K=Pt;return E.forEach(V=>{K.add(V)}),c.push(R.toString()),c.push(Pt.toString()),u.push(P),u.push([]),u.push(T),l.push(x),l.push([]),l.push(S),r.totalAmounts=c,r.path=a,r.percents=u,r.poolAddresses=l,o?r.maxAmountOut=b.maxAmountOut:r.maxAmountOut=g.maxAmountOut,r.path.length||(r.isExceed=!0),r}let d=Pt;o||(d=new _(2).pow(new _(64)));const h=fc(n,this.splitUnit);for(let g=0;g<h.length;g+=1){const b=this.getBestSplitResultInOnePair(50,t[0][0],t[0][1],h[g],i[0][0],o);if(b.isExceed)continue;let v=mn,x=mn;if(o){if(v=this.getBestSplitResultInOnePair(50,t[1][0],t[1][1],h[h.length-g-1],i[1][0],o),v.isExceed||(x=this.getBestSplitResultInOnePair(5,t[1][2],t[1][3],v.maxAmountOut,i[1][1],o),x.isExceed))continue}else if(x=this.getBestSplitResultInOnePair(50,t[1][2],t[1][3],h[h.length-g-1],i[1][1],o),x.isExceed||(v=this.getBestSplitResultInOnePair(5,t[1][0],t[1][1],x.maxAmountOut,i[1][0],o),v.isExceed))continue;const P=[],E=[],S=[];b.path.forEach(A=>{var f;P.push(n.muln(g*this.splitUnit).divn(100).muln(A.percent).divn(100)),S.push(A.percent);const y=(f=this.getPoolAddressMapAndDirection(t[0][0],t[0][1]))==null?void 0:f.addressMap.get(A.feeRate);E.push(y)});const T=[],R=[],K=[];v.path.forEach(A=>{var f;o?T.push(n.muln((h.length-g-1)*this.splitUnit).divn(100).muln(A.percent).divn(100)):T.push(x.maxAmountOut.muln(A.percent).divn(100)),K.push(A.percent);const y=(f=this.getPoolAddressMapAndDirection(t[1][0],t[1][1]))==null?void 0:f.addressMap.get(A.feeRate);R.push(y)});const V=[],W=[],tt=[];x.path.forEach(A=>{var f;o?V.push(v.maxAmountOut.muln(A.percent).divn(100)):V.push(n.muln((h.length-g-1)*this.splitUnit).divn(100).muln(A.percent).divn(100)),tt.push(A.percent);const y=(f=this.getPoolAddressMapAndDirection(t[1][2],t[1][3]))==null?void 0:f.addressMap.get(A.feeRate);W.push(y)});const j=[],$=[],q=[];if(x.maxAmountOut.add(b.maxAmountOut).gt(d)||v.maxAmountOut.add(b.maxAmountOut).lt(d)){o?d=x.maxAmountOut.add(b.maxAmountOut):d=v.maxAmountOut.add(b.maxAmountOut);let A=Pt;P.forEach(y=>{A=A.add(y)});const f=Pt;T.forEach(y=>{f.add(y)}),j.push(v.path),j.push(b.path),j.push(x.path),$.push(f.toString()),$.push(A.toString()),u.push(K),u.push(S),u.push(tt),q.push(R),q.push(E),q.push(W),r.maxAmountOut=d,r.path=j,r.totalAmounts=$,r.percents=u,r.poolAddresses=q,r.path.length||(r.isExceed=!0)}}return r}findBestSplitPriceWithTwoSkip(t,n,i,o,s){const r={maxAmountOut:Pt,path:[],totalAmounts:[],percents:[],poolAddresses:[],isExceed:!1},a=fc(n,this.splitUnit);let c=Pt;if(o||(c=new _(2).pow(new _(64))),!s){for(let u=0;u<a.length;u+=1){let l=mn,d=mn,h=mn,g=mn;if(o){if(l=this.getBestSplitResultInOnePair(5,t[0][0],t[0][1],a[u],i[1][0],o),l.isExceed||(d=this.getBestSplitResultInOnePair(5,t[0][2],t[0][3],l.maxAmountOut,i[1][1],o),d.isExceed)||(h=this.getBestSplitResultInOnePair(5,t[1][0],t[1][1],a[a.length-u-1],i[1][0],o),h.isExceed)||(g=this.getBestSplitResultInOnePair(5,t[1][2],t[1][3],h.maxAmountOut,i[1][1],o),g.isExceed))continue}else if(d=this.getBestSplitResultInOnePair(5,t[0][2],t[0][3],a[u],i[1][1],o),d.isExceed||(l=this.getBestSplitResultInOnePair(5,t[0][0],t[0][1],d.maxAmountOut,i[1][0],o),l.isExceed)||(g=this.getBestSplitResultInOnePair(5,t[1][2],t[1][3],a[a.length-u-1],i[1][1],o),g.isExceed)||(h=this.getBestSplitResultInOnePair(5,t[1][0],t[1][1],g.maxAmountOut,i[1][0],o),h.isExceed))continue;const b=[],v=[],x=[];l.path.forEach(f=>{var y;o?b.push(n.muln(u*this.splitUnit).divn(100).muln(f.percent).divn(100)):b.push(d.maxAmountOut.muln(f.percent).divn(100)),x.push(f.percent);const k=(y=this.getPoolAddressMapAndDirection(t[0][0],t[0][1]))==null?void 0:y.addressMap.get(f.feeRate);v.push(k)});const P=[],E=[],S=[];d.path.forEach(f=>{var y;o?P.push(l.maxAmountOut.muln(f.percent).divn(100)):P.push(n.muln(u*this.splitUnit).divn(100).muln(f.percent).divn(100)),S.push(f.percent);const k=(y=this.getPoolAddressMapAndDirection(t[0][2],t[0][3]))==null?void 0:y.addressMap.get(f.feeRate);E.push(k)});const T=[],R=[],K=[];h.path.forEach(f=>{var y;o?T.push(n.muln((a.length-u-1)*this.splitUnit).divn(100).muln(f.percent).divn(100)):T.push(g.maxAmountOut.muln(f.percent).divn(100)),K.push(f.percent);const k=(y=this.getPoolAddressMapAndDirection(t[1][0],t[1][1]))==null?void 0:y.addressMap.get(f.feeRate);R.push(k)});const V=[],W=[],tt=[];g.path.forEach(f=>{var y;o?V.push(h.maxAmountOut.muln(f.percent).divn(100)):V.push(n.muln((a.length-u-1)*this.splitUnit).divn(100).muln(f.percent).divn(100)),tt.push(f.percent);const k=(y=this.getPoolAddressMapAndDirection(t[1][1],t[1][2]))==null?void 0:y.addressMap.get(f.feeRate);W.push(k)});const j=[],$=[],q=[],A=[];if(d.maxAmountOut.add(g.maxAmountOut).gt(c)&&o||!o&&l.maxAmountOut.add(h.maxAmountOut).lt(c)){o?c=d.maxAmountOut.add(g.maxAmountOut):c=l.maxAmountOut.add(h.maxAmountOut);let f=Pt;b.forEach(k=>{f=f.add(k)});let y=Pt;T.forEach(k=>{y=y.add(k)}),j.push(l.path),j.push(d.path),j.push([]),j.push(h.path),j.push(g.path),$.push(f.toString()),$.push(y.toString()),$.push(Pt.toString()),A.push(x),A.push(K),A.push([]),A.push(S),A.push(tt),q.push(v),q.push(R),q.push([]),q.push(E),q.push(W),r.maxAmountOut=c,r.percents=A,r.totalAmounts=$,r.path=j,r.poolAddresses=q}}return r.path.length||(r.isExceed=!0),r}for(let u=0;u<a.length;u+=1)for(let l=0;l<a.length-u-1;l+=1){const d=a.length-u-l-1,h=this.getBestSplitResultInOnePair(5,t[0][0],t[0][1],a[d],i[0][0],o);if(h.isExceed)continue;let g=mn,b=mn,v=mn,x=mn;if(o){if(g=this.getBestSplitResultInOnePair(5,t[1][0],t[1][1],a[l],i[1][0],o),g.isExceed||(b=this.getBestSplitResultInOnePair(5,t[1][2],t[1][3],g.maxAmountOut,i[1][1],o),b.isExceed)||(v=this.getBestSplitResultInOnePair(5,t[2][0],t[2][1],a[u],i[2][0],o),v.isExceed)||(x=this.getBestSplitResultInOnePair(5,t[2][2],t[2][3],v.maxAmountOut,i[2][1],o),x.isExceed))continue}else if(b=this.getBestSplitResultInOnePair(5,t[1][2],t[1][3],a[l],i[1][1],o),b.isExceed||(g=this.getBestSplitResultInOnePair(5,t[1][0],t[1][1],b.maxAmountOut,i[1][0],o),g.isExceed)||(x=this.getBestSplitResultInOnePair(5,t[2][2],t[2][3],a[u],i[2][1],o),x.isExceed)||(v=this.getBestSplitResultInOnePair(5,t[2][0],t[2][1],x.maxAmountOut,i[2][0],o),v.isExceed))continue;const P=[],E=[],S=[];g.path.forEach(I=>{var m;o?P.push(n.muln(l*this.splitUnit).divn(100).muln(I.percent).divn(100)):P.push(b.maxAmountOut.muln(I.percent).divn(100)),S.push(I.percent);const M=(m=this.getPoolAddressMapAndDirection(t[1][0],t[1][1]))==null?void 0:m.addressMap.get(I.feeRate);E.push(M)});const T=[],R=[],K=[];b.path.forEach(I=>{var m;o?T.push(g.maxAmountOut.muln(I.percent).divn(100)):T.push(n.muln(l*this.splitUnit).divn(100).muln(I.percent).divn(100)),K.push(I.percent);const M=(m=this.getPoolAddressMapAndDirection(t[1][2],t[1][3]))==null?void 0:m.addressMap.get(I.feeRate);R.push(M)});const V=[],W=[],tt=[];v.path.forEach(I=>{var m;o?V.push(n.muln(u*this.splitUnit).divn(100).muln(I.percent).divn(100)):V.push(x.maxAmountOut.muln(I.percent).divn(100)),tt.push(I.percent);const M=(m=this.getPoolAddressMapAndDirection(t[2][0],t[2][1]))==null?void 0:m.addressMap.get(I.feeRate);W.push(M)});const j=[],$=[],q=[];x.path.forEach(I=>{var m;o?j.push(v.maxAmountOut.muln(I.percent).divn(100)):j.push(n.muln(u*this.splitUnit).divn(100).muln(I.percent).divn(100)),q.push(I.percent);const M=(m=this.getPoolAddressMapAndDirection(t[2][2],t[2][3]))==null?void 0:m.addressMap.get(I.feeRate);$.push(M)});const A=[],f=[],y=[];h.path.forEach(I=>{var m;A.push(n.muln(d*this.splitUnit).divn(100).muln(I.percent).divn(100)),y.push(I.percent);const M=(m=this.getPoolAddressMapAndDirection(t[0][0],t[0][1]))==null?void 0:m.addressMap.get(I.feeRate);f.push(M)});let k=Pt;o?k=h.maxAmountOut.add(b.maxAmountOut).add(x.maxAmountOut):k=h.maxAmountOut.add(g.maxAmountOut).add(v.maxAmountOut);const U=[],D=[],z=[],X=[];if(k.gt(c)&&o||k.lt(c)&&!o){let I=Pt;P.forEach(Tt=>{I=I.add(Tt)});let m=Pt;V.forEach(Tt=>{m=m.add(Tt)});let M=Pt;A.forEach(Tt=>{M=M.add(Tt)}),c=k,U.push(g.path),U.push(v.path),U.push(h.path),U.push(b.path),U.push(x.path),D.push(I.toString()),D.push(m.toString()),D.push(M.toString()),z.push(S),z.push(tt),z.push(y),z.push(K),z.push(q),X.push(E),X.push(W),X.push(f),X.push(R),X.push($),r.maxAmountOut=k,r.path=U,r.totalAmounts=D,r.poolAddresses=X,r.percents=z}}return r.path.length||(r.isExceed=!0),r}findBestSplitPriceWithThreeSkip(t,n,i,o,s){const r={maxAmountOut:new _(0),path:[],totalAmounts:[],percents:[],poolAddresses:[],isExceed:!1};let a=Pt;o||(a=new _(2).pow(new _(64)));const c=fc(n,this.splitUnit);for(let u=0;u<c.length;u+=1)for(let l=0;l<c.length-u-1;l+=1)if(s)for(let d=0;d<c.length-u-l-1;d+=1){const h=c.length-u-l-d-1,g=this.getBestSplitResultInOnePair(5,t[0][0],t[0][1],c[d],i[0][0],o);let b=mn,v=mn,x=mn,P=mn,E=mn,S=mn;if(o){if(b=this.getBestSplitResultInOnePair(5,t[1][0],t[1][1],c[l],i[1][0],o),b.isExceed||(v=this.getBestSplitResultInOnePair(5,t[1][2],t[1][3],b.maxAmountOut,i[1][1],o),v.isExceed)||(x=this.getBestSplitResultInOnePair(5,t[2][0],t[2][1],c[u],i[2][0],o),x.isExceed)||(P=this.getBestSplitResultInOnePair(5,t[2][2],t[2][3],x.maxAmountOut,i[2][1],o),P.isExceed)||(E=this.getBestSplitResultInOnePair(5,t[3][0],t[3][1],c[h],i[3][0],o),E.isExceed)||(S=this.getBestSplitResultInOnePair(5,t[3][2],t[3][3],E.maxAmountOut,i[3][1],o),S.isExceed))continue}else if(v=this.getBestSplitResultInOnePair(5,t[1][2],t[1][3],c[l],i[1][1],o),v.isExceed||(b=this.getBestSplitResultInOnePair(5,t[1][0],t[1][1],v.maxAmountOut,i[1][0],o),b.isExceed)||(P=this.getBestSplitResultInOnePair(5,t[2][2],t[2][3],c[u],i[2][1],o),P.isExceed)||(x=this.getBestSplitResultInOnePair(5,t[2][0],t[2][1],P.maxAmountOut,i[2][0],o),x.isExceed)||(S=this.getBestSplitResultInOnePair(5,t[3][2],t[3][3],c[h],i[3][1],o),S.isExceed)||(E=this.getBestSplitResultInOnePair(5,t[3][0],t[3][1],S.maxAmountOut,i[3][0],o),E.isExceed))continue;const T=[],R=[],K=[];b.path.forEach(fe=>{var se;o?T.push(n.muln(l*this.splitUnit).divn(100).muln(fe.percent).divn(100)):T.push(v.maxAmountOut.muln(fe.percent).divn(100)),K.push(fe.percent);const ae=(se=this.getPoolAddressMapAndDirection(t[1][0],t[1][1]))==null?void 0:se.addressMap.get(fe.feeRate);R.push(ae)});const V=[],W=[],tt=[];v.path.forEach(fe=>{var se;o?V.push(b.maxAmountOut.muln(fe.percent).divn(100)):V.push(n.muln(l*this.splitUnit).divn(100).muln(fe.percent).divn(100)),tt.push(fe.percent);const ae=(se=this.getPoolAddressMapAndDirection(t[1][2],t[1][3]))==null?void 0:se.addressMap.get(fe.feeRate);W.push(ae)});const j=[],$=[],q=[];x.path.forEach(fe=>{var se;o?j.push(n.muln(u*this.splitUnit).divn(100).muln(fe.percent).divn(100)):j.push(P.maxAmountOut.muln(fe.percent).divn(100)),q.push(fe.percent);const ae=(se=this.getPoolAddressMapAndDirection(t[2][0],t[2][1]))==null?void 0:se.addressMap.get(fe.feeRate);$.push(ae)});const A=[],f=[],y=[];P.path.forEach(fe=>{var se;o?A.push(x.maxAmountOut.muln(fe.percent).divn(100)):A.push(n.muln(u*this.splitUnit).divn(100).muln(fe.percent).divn(100)),y.push(fe.percent);const ae=(se=this.getPoolAddressMapAndDirection(t[2][2],t[2][3]))==null?void 0:se.addressMap.get(fe.feeRate);f.push(ae)});const k=[],U=[],D=[];E.path.forEach(fe=>{var se;o?k.push(n.muln(h*this.splitUnit).divn(100).muln(fe.percent).divn(100)):k.push(S.maxAmountOut.muln(fe.percent).divn(100)),D.push(fe.percent);const ae=(se=this.getPoolAddressMapAndDirection(t[3][0],t[3][1]))==null?void 0:se.addressMap.get(fe.feeRate);U.push(ae)});const z=[],X=[],I=[];S.path.forEach(fe=>{var se;o?z.push(E.maxAmountOut.muln(fe.percent).divn(100)):z.push(n.muln(h*this.splitUnit).divn(100).muln(fe.percent).divn(100)),I.push(fe.percent);const ae=(se=this.getPoolAddressMapAndDirection(t[3][2],t[3][3]))==null?void 0:se.addressMap.get(fe.feeRate);X.push(ae)});const m=[],M=[],Tt=[];g.path.forEach(fe=>{var se;m.push(n.muln(d*this.splitUnit).divn(100).muln(fe.percent).divn(100)),Tt.push(fe.percent);const ae=(se=this.getPoolAddressMapAndDirection(t[0][0],t[0][1]))==null?void 0:se.addressMap.get(fe.feeRate);M.push(ae)});let ct=Pt;o?ct=g.maxAmountOut.add(v.maxAmountOut).add(P.maxAmountOut).add(S.maxAmountOut):ct=g.maxAmountOut.add(b.maxAmountOut).add(x.maxAmountOut).add(E.maxAmountOut);const mt=[],oe=[],Qt=[],Ie=[];if(ct.gt(a)&&o||!o&&ct.lt(a)){let fe=Pt;T.forEach(nt=>{fe=fe.add(nt)});let se=Pt;j.forEach(nt=>{se=se.add(nt)});let ae=Pt;k.forEach(nt=>{ae=ae.add(nt)});let ci=Pt;m.forEach(nt=>{ci=ci.add(nt)}),a=ct,mt.push(b.path),mt.push(x.path),mt.push(E.path),mt.push(g.path),mt.push(v.path),mt.push(P.path),mt.push(S.path),oe.push(fe.toString()),oe.push(se.toString()),oe.push(ae.toString()),oe.push(ci.toString()),Qt.push(K),Qt.push(q),Qt.push(D),Qt.push(Tt),Qt.push(tt),Qt.push(y),Qt.push(I),Ie.push(R),Ie.push($),Ie.push(U),Ie.push(M),Ie.push(W),Ie.push(f),Ie.push(X),r.maxAmountOut=ct,r.path=mt,r.totalAmounts=oe,r.percents=Qt,r.poolAddresses=Ie}}else{const d=c.length-u-l-1;let h=mn,g=mn,b=mn,v=mn,x=mn,P=mn;if(o){if(h=this.getBestSplitResultInOnePair(5,t[0][0],t[0][1],c[l],i[0][0],o),h.isExceed||(g=this.getBestSplitResultInOnePair(5,t[0][2],t[0][3],h.maxAmountOut,i[0][1],o),g.isExceed)||(b=this.getBestSplitResultInOnePair(5,t[1][0],t[1][1],c[u],i[1][0],o),b.isExceed)||(v=this.getBestSplitResultInOnePair(5,t[1][2],t[1][3],b.maxAmountOut,i[1][1],o),v.isExceed)||(x=this.getBestSplitResultInOnePair(5,t[2][0],t[2][1],c[d],i[2][0],o),x.isExceed)||(P=this.getBestSplitResultInOnePair(5,t[2][2],t[2][3],b.maxAmountOut,i[2][1],o),P.isExceed))continue}else if(g=this.getBestSplitResultInOnePair(5,t[0][2],t[0][3],c[l],i[0][1],o),g.isExceed||(h=this.getBestSplitResultInOnePair(5,t[0][0],t[0][1],g.maxAmountOut,i[0][0],o),h.isExceed)||(v=this.getBestSplitResultInOnePair(5,t[1][2],t[1][3],c[u],i[1][1],o),v.isExceed)||(b=this.getBestSplitResultInOnePair(5,t[1][0],t[1][1],v.maxAmountOut,i[1][0],o),b.isExceed)||(P=this.getBestSplitResultInOnePair(5,t[2][2],t[2][3],c[d],i[2][1],o),P.isExceed)||(x=this.getBestSplitResultInOnePair(5,t[2][0],t[2][1],v.maxAmountOut,i[2][0],o),x.isExceed))continue;const E=[],S=[],T=[];h.path.forEach(ct=>{var mt;o?E.push(n.muln(l*this.splitUnit).divn(100).muln(ct.percent).divn(100)):E.push(g.maxAmountOut.muln(ct.percent).divn(100)),T.push(ct.percent);const oe=(mt=this.getPoolAddressMapAndDirection(t[0][0],t[0][1]))==null?void 0:mt.addressMap.get(ct.feeRate);S.push(oe)});const R=[],K=[],V=[];g.path.forEach(ct=>{var mt;o?R.push(h.maxAmountOut.muln(ct.percent).divn(100)):R.push(n.muln(l*this.splitUnit).divn(100).muln(ct.percent).divn(100)),V.push(ct.percent);const oe=(mt=this.getPoolAddressMapAndDirection(t[0][2],t[0][3]))==null?void 0:mt.addressMap.get(ct.feeRate);K.push(oe)});const W=[],tt=[],j=[];b.path.forEach(ct=>{var mt;o?W.push(n.muln(u*this.splitUnit).divn(100).muln(ct.percent).divn(100)):W.push(v.maxAmountOut.muln(ct.percent).divn(100)),j.push(ct.percent);const oe=(mt=this.getPoolAddressMapAndDirection(t[1][0],t[1][1]))==null?void 0:mt.addressMap.get(ct.feeRate);tt.push(oe)});const $=[],q=[],A=[];v.path.forEach(ct=>{var mt;o?$.push(b.maxAmountOut.muln(ct.percent).divn(100)):$.push(n.muln(u*this.splitUnit).divn(100).muln(ct.percent).divn(100)),A.push(ct.percent);const oe=(mt=this.getPoolAddressMapAndDirection(t[1][2],t[1][3]))==null?void 0:mt.addressMap.get(ct.feeRate);q.push(oe)});const f=[],y=[],k=[];x.path.forEach(ct=>{var mt;o?f.push(n.muln(d*this.splitUnit).divn(100).muln(ct.percent).divn(100)):f.push(P.maxAmountOut.muln(ct.percent).divn(100)),k.push(ct.percent);const oe=(mt=this.getPoolAddressMapAndDirection(t[2][0],t[2][1]))==null?void 0:mt.addressMap.get(ct.feeRate);y.push(oe)});const U=[],D=[],z=[];P.path.forEach(ct=>{var mt;o?U.push(x.maxAmountOut.muln(ct.percent).divn(100)):U.push(n.muln(d*this.splitUnit).divn(100).muln(ct.percent).divn(100)),z.push(ct.percent);const oe=(mt=this.getPoolAddressMapAndDirection(t[2][2],t[2][3]))==null?void 0:mt.addressMap.get(ct.feeRate);D.push(oe)});const X=[],I=[],m=[],M=[];let Tt=Pt;if(o?Tt=g.maxAmountOut.add(v.maxAmountOut).add(P.maxAmountOut):Tt=h.maxAmountOut.add(b.maxAmountOut).add(x.maxAmountOut),Tt.gt(a)&&o||Tt.lt(a)&&!o){let ct=Pt;E.forEach(Qt=>{ct=ct.add(Qt)});let mt=Pt;W.forEach(Qt=>{mt=mt.add(Qt)});let oe=Pt;f.forEach(Qt=>{oe=oe.add(Qt)}),a=Tt,X.push(h.path),X.push(b.path),X.push(x.path),X.push([]),X.push(g.path),X.push(v.path),X.push(P.path),I.push(ct.toString()),I.push(mt.toString()),I.push(oe.toString()),I.push(Pt.toString()),m.push(T),m.push(j),m.push(k),m.push([]),m.push(V),m.push(A),m.push(z),M.push(S),M.push(tt),M.push(y),M.push([]),M.push(K),M.push(q),M.push(D),r.maxAmountOut=Tt,r.path=X,r.percents=m,r.totalAmounts=I,r.poolAddresses=M}}return r.path.length||(r.isExceed=!0),r}findBestSplitPrice(t,n,i,o,s,r){var a,c,u,l;let d=t.length,h=!1;t[0].length===2&&(h=!0,d-=1);let g={maxAmountOut:Pt,path:[],poolAddresses:[],totalAmounts:[],percents:[],isExceed:!1},b={maxAmountOut:Pt,path:[],isExceed:!1};const v=[],x=[];let P=Pt;const E=[];switch(console.log(d,"skipNumber"),d){case 0:b=this.getBestSplitResultInOnePair(50,t[0][0],t[0][1],n,i[0][0],o),g.maxAmountOut=b.maxAmountOut,g.path.push(b.path),b.path.forEach(W=>{var tt;const j=(tt=this.getPoolAddressMapAndDirection(t[0][0],t[0][1]))==null?void 0:tt.addressMap.get(W.feeRate);v.push(j);const $=n.muln(W.percent).divn(100);x.push($),E.push(W.percent)}),x.forEach(W=>{P=P.add(W)}),g.percents.push(E),g.totalAmounts.push(P.toString()),g.poolAddresses.push(v);break;case 1:g=this.findBestSplitPriceWithOneSkip(t,n,i,o,h);break;case 2:g=this.findBestSplitPriceWithTwoSkip(t,n,i,o,h);break;case 3:g=this.findBestSplitPriceWithThreeSkip(t,n,i,o,h);break}if(g.isExceed)return g;const S=[];for(let W=0;W<g.path.length;W+=1){const{length:tt}=g.path[W];S.push(tt)}const T=[];if(d!==0)if(h){for(let tt=1;tt<1+d;tt+=1){const j=[];if(S[tt-1]>0)for(let $=0;$<S[tt-1];$+=1)j.push(i[tt][0]);T.push(j)}const W=[];for(let tt=0;tt<S[d];tt+=1)if(S[d]>0)for(let j=0;j<S[d];j+=1)W.push(i[0][0]);T.push(W);for(let tt=1;tt<1+d;tt+=1){const j=[];if(S[tt+d]>0)for(let $=0;$<S[tt+d];$+=1)j.push(i[tt][1]);T.push(j)}}else{for(let W=0;W<d;W+=1){const tt=[];if(S[W]>0)for(let j=0;j<S[W];j+=1)tt.push(i[W][0]);T.push(tt)}T.push([]);for(let W=0;W<d;W+=1){const tt=[];if(S[W+d+1]>0)for(let j=0;j<S[W+d+1];j+=1)tt.push(i[W][1]);T.push(tt)}}else T.push([i[0][0]]);for(let W=0;W<g.poolAddresses.length;W+=1)for(let tt=0;tt<g.poolAddresses[W].length;tt+=1){const j=this.getPoolDirection(g.poolAddresses[W][tt]);j&&(T[W][tt]=T[W][tt]&&j)}const R=[],K=(a=this._coinSymbolMap.get(t[0][0]))==null?void 0:a.address;R.push(K);for(let W=0;W<t.length;W+=1)if(t[W].length!==2){const tt=(c=this._coinSymbolMap.get(t[W][1]))==null?void 0:c.address;R.push(tt)}if(t[0].length===2){const W=(u=this._coinSymbolMap.get(t[0][1]))==null?void 0:u.address;R.push(W)}else{const W=(l=this._coinSymbolMap.get(t[0][t[0].length-1]))==null?void 0:l.address;R.push(W)}const V=o?g.maxAmountOut.muln((1-s)*1e5).divn(1e5).toString():g.maxAmountOut.muln((1+s)*1e5).divn(1e5).toString();return this.createTxParams={partitionQuantities:S,swapDirects:T,poolAddresses:g.poolAddresses,totalAmounts:g.totalAmounts,percents:g.percents,amountLimit:V,amountOut:n.toString(),partner:r,coinTypes:R},g}async price(t,n,i,o,s,r){var a,c;const u=this.tokenInfo(t),l=this.tokenInfo(n);if(u===void 0||l===void 0)return;const d=this.graph.getVertexByKey(u.symbol),h=this.graph.getVertexByKey(l.symbol),g=this.graph.findAllPath(d,h),b=Array.from(g),v=[],x=[],P=[];for(let E=0;E<b.length;E+=1){const S=b[E];if(S.length>3)continue;const T=[],R=[];for(let K=0;K<S.length-1;K+=1){const V=S[K].value.toString(),W=S[K+1].value.toString(),tt=(a=this.getPoolAddressMapAndDirection(V,W))==null?void 0:a.addressMap,j=(c=this.getPoolAddressMapAndDirection(V,W))==null?void 0:c.direction;tt!==void 0&&j!==void 0&&(R.push(j),T.push(V),T.push(W),tt.forEach($=>{v.push($)}))}if(P.push(R),x.push(T),T.length===2&&x.length>1){const K=x[0].slice();x[0]=T,x[x.length-1]=K;const V=P[0].slice();P[0]=R,P[x.length-1]=V}}return await this.refreshPoolofSwapRouter(v),this.findBestSplitPrice(x,i,P,o,s,r)}async routerSwap(t,n,i,o,s,r){const a=await this.price(t,n,i,o,s,r),c=this.getCreateTxParams();if(a.isExceed)return{maxAmountOut:a.maxAmountOut,path:a.path,poolAddresses:a.poolAddresses,percents:a.percents,totalAmounts:a.totalAmounts,isExceed:a.isExceed,totalPercents:[],showRouters:[],gasFee:0};const u=this.splitSwapForRouters(c,o,!0),{simulationAccount:l}=this.sdk.sdkOptions.networkOptions,d=new cn(this.sdk.sdkOptions.rpcUrl),h=vr(l.address),g=await d.generateRawTransaction(h,u),b=vr(l.pubkey),v=new F.Ed25519PublicKey(b.toUint8Array()),x=await d.simulateTransaction(v,g),P=x[0].gas_used,E=x[0].gas_unit_price,S=parseInt(P,10)*parseInt(E,10),T=[];let R=Pt;a.totalAmounts.forEach(V=>{R=R.add(new _(V))}),a.totalAmounts.forEach(V=>{let W;R.isZero()?W=0:W=Number(V)/Number(R.toString())*100,T.push(W)});const K=[];for(let V=0;V<a.totalAmounts.length;V+=1){const W={amount:a.totalAmounts[V],poolAddress:[]};V===Math.floor(a.poolAddresses.length/2)?a.poolAddresses[V].length>0&&(W.poolAddress.push(a.poolAddresses[V]),K.unshift(W)):a.poolAddresses[V].length>0&&(W.poolAddress.push(a.poolAddresses[V],a.poolAddresses[V+Math.floor(a.poolAddresses.length/2)+1]),K.push(W))}return{maxAmountOut:a.maxAmountOut,path:a.path,poolAddresses:a.poolAddresses,percents:a.percents,totalAmounts:a.totalAmounts,isExceed:a.isExceed,totalPercents:T,showRouters:K,gasFee:S}}splitSwap(t,n,i=!1){const{modules:o}=this.sdk.sdkOptions.networkOptions,s=`${o.ClmmIntegrate}::${Zl}`,r=n?"exact_input_split_swap":"exact_output_split_swap",a=[];t.poolAddresses.forEach(h=>{const g=[];h.forEach(b=>{g.push(F.AccountAddress.fromHex(b))}),a.push(g)});const c=[at.bcsSerializeUint64(t.partitionQuantities[0]),at.serializeVectorWithFunc(t.swapDirects[0],"serializeBool"),e2(a[0]),at.serializeVectorWithFunc(t.percents[0],"serializeU64"),at.bcsSerializeUint64(parseInt(t.totalAmounts[0],10)),at.bcsSerializeUint64(parseInt(t.amountLimit,10)),at.bcsSerializeStr(t.partner)];if(i){const h=[];for(const g of t.coinTypes){const b=new F.TypeTagStruct(F.StructTag.fromString(g));h.push(b)}return new F.TransactionPayloadEntryFunction(F.EntryFunction.natural(s,r,h,c))}const u=Pe(s,r),l=t.coinTypes,d=[t.partitionQuantities[0],t.swapDirects[0],t.poolAddresses[0],t.percents[0],t.totalAmounts[0],t.amountLimit,t.partner];return{type:"entry_function_payload",function:u,type_arguments:l,arguments:d}}splitSwapForRouter(t,n,i,o=!1){const{modules:s}=this.sdk.sdkOptions.networkOptions,r=`${s.ClmmIntegrate}::${Zl}`,a=[];t.poolAddresses.forEach(h=>{const g=[];h.forEach(b=>{g.push(F.AccountAddress.fromHex(b))}),a.push(g)});const c=[at.serializeVectorWithFunc(t.partitionQuantities,"serializeU64"),af(t.swapDirects,"serializeBool"),t2(a),af(t.percents,"serializeU64"),at.serializeVectorWithFunc(t.totalAmounts,"serializeU64"),at.bcsSerializeUint64(parseInt(t.amountLimit,10)),at.bcsSerializeStr(t.partner)];if(o){const h=[];for(const g of t.coinTypes){const b=new F.TypeTagStruct(F.StructTag.fromString(g));h.push(b)}return new F.TransactionPayloadEntryFunction(F.EntryFunction.natural(r,i,h,c))}const u=[t.partitionQuantities,t.swapDirects,t.poolAddresses,t.percents,t.totalAmounts,t.amountLimit,t.partner],l=Pe(r,i),d=t.coinTypes;return{type:"entry_function_payload",function:l,type_arguments:d,arguments:u}}splitSwapForRouters(t,n,i=!1){const{length:o}=t.partitionQuantities;let s;switch(o){case 3:n?s="exact_input_split_swap_for_router_three":s="exact_output_split_swap_for_router_three";break;case 5:n?s="exact_input_split_swap_for_router_four":s="exact_output_split_swap_for_router_four";break;case 7:n?s="exact_input_split_swap_for_router_five":s="exact_output_split_swap_for_router_five";break;default:return this.splitSwap(t,n,i)}return this.splitSwapForRouter(t,n,s,i)}findUnFetchPools(t){const n=[];for(const i of t)this.poolMap.get(i)==null&&n.push(i);return n}async refreshPoolofSwapRouter(t){var n,i,o;const s=Date.now();if(this.isInited){const a=this.findUnFetchPools(t);if(s-this.leastRefreshTime<g2&&a.length===0)return}else this.isInited=!0;const r=await this._sdk.Resources.getPools(t);for(let a=0;a<t.length;a+=1)if(this.poolMap.set(r[a].poolAddress,r[a]),this.getPoolDirection(r[a].poolAddress)==null){const c=(n=this._coinAddressMap.get(r[a].coinTypeA))==null?void 0:n.symbol,u=(i=this._coinAddressMap.get(r[a].coinTypeB))==null?void 0:i.symbol,l=(o=this.getPoolAddressMapAndDirection(c,u))==null?void 0:o.direction;this.poolDirectionMap.set(r[a].poolAddress,l);const d=await this._sdk.Fetcher.fetchTicks({pool:r[a].poolAddress,coinTypeA:r[a].coinTypeA,coinTypeB:r[a].coinTypeB}),h=Y_(d);this.ticksMap.set(r[a].poolAddress,h)}this.leastRefreshTime=s}},y2=class{constructor(e){this._sdk=e}get sdk(){return this._sdk}transformTickData(e){const t=[],{modules:n}=this._sdk.sdkOptions.networkOptions,i=e.filter(r=>r.type!=="write_resource"?!1:r.data.type===`${n.FetcherDeployer}::fetcher::FetchTicksResult`);if(i.length===0)return{ticks:t,index:0,offset:0};const s=i[0].data.data;return{ticks:s.ticks||[],index:Number(s.index),offset:Number(s.offset)}}async getTicks(e){const{modules:t,simulationAccount:n}=this.sdk.sdkOptions.networkOptions,i=new cn(this.sdk.sdkOptions.rpcUrl),o=`${t.FetcherDeployer}::scripts`,s="fetch_ticks",r=[new F.TypeTagStruct(F.StructTag.fromString(e.coinTypeA)),new F.TypeTagStruct(F.StructTag.fromString(e.coinTypeB))],a=[at.bcsToBytes(F.AccountAddress.fromHex(e.pool)),at.bcsSerializeUint64(e.index),at.bcsSerializeUint64(e.offset),at.bcsSerializeUint64(e.limit)],c=new F.TransactionPayloadEntryFunction(F.EntryFunction.natural(o,s,r,a)),u=vr(n.address),l=await i.generateRawTransaction(u,c),d=vr(n.pubkey),h=new F.Ed25519PublicKey(d.toUint8Array()),g=await i.simulateTransaction(h,l);return this.transformTickData(g[0].changes)}async fetchTicks(e){let t=[],n=0,i=0;const o=512;for(;;){const s=await this.getTicks({pool:e.pool,coinTypeA:e.coinTypeA,coinTypeB:e.coinTypeB,index:n,offset:i,limit:o});if(t=[...t,...s.ticks],s.ticks.length<o)break;s.offset<999?(i=s.offset+1,n=s.index):(n=s.index+1,i=0)}return t}},w2=class{constructor(e){this.globalConfig={protocol_fee_rate:"",is_pause:!1},this._sdkOptions=e,this._client=new cn(e.rpcUrl),this._tokenClient=new Lx(this._client),this._swap=new r2(this),this._position=new a2(this),this._resources=new l2(this),this._pool=new d2(this),this._rewarder=new h2(this),this._router=new m2(this),this._token=new p2(this),this._fetcher=new y2(this),this._launchpad=new z6(this),this.globalConfig.protocol_fee_rate=""}async getGlobalConfig(e=!1){return(this.globalConfig.protocol_fee_rate.length===0||e)&&(this.globalConfig=await this._resources.getGlobalConfig(this._sdkOptions.networkOptions.modules.LiquidswapDeployer)),this.globalConfig}get client(){return this._client}get tokenClient(){return this._tokenClient}get Swap(){return this._swap}get Position(){return this._position}get Pool(){return this._pool}get Resources(){return this._resources}get Rewarder(){return this._rewarder}get Token(){return this._token}get Router(){return this._router}get Fetcher(){return this._fetcher}get Launchpad(){return this._launchpad}get sdkOptions(){return this._sdkOptions}};function yn(e,t){const n=eh(t);return we(e).div(n).toString()}function Nn(e,t){const n=eh(t);return we(e).mul(n)}function b2(e){const t=e.split("x");let n=e;return t[1][0]==="0"&&(n=t[0]+"x"+t[1].slice(1)),n}const iP=(e,t)=>JSON.stringify(e)===JSON.stringify(t),ff=e=>{switch(e){case"account":return"account";case"token":return"";case"nftAddress":return"token";case"tx":return"txn";case"poolAddress":return"account"}},v2=e=>{switch(e){case"account":return"address";case"token":return"object";case"tx":return"txblock";case"poolAddress":return"object";case"nftAddress":return"object";case"coin":return"object"}},nm=e=>{switch(e){case"account":return"address";case"token":return"object";case"tx":return"tx";case"poolAddress":return"object";case"nftAddress":return"object";case"coin":return"coin"}},pf=e=>{switch(e){case"account":return"account";case"token":return"object";case"tx":return"txblock";case"poolAddress":return"object";case"nftAddress":return"object";case"coin":return"coin"}};function oP(){const t=(localStorage.getItem("theme")||"sui")=="sui"?"Sui":"Aptos";return localStorage.getItem(`${t}-currentExplorerName`)||Bl[t][0].name}function Oc(e,t,n){const i=localStorage.getItem("theme")||"sui",o=i=="sui"?"Sui":"Aptos";console.log(e,"url###111");const s=e.indexOf("suivision")>-1?"SuiVision":e.indexOf("suiscan")>-1?"Suiscan":"";console.log(e,s,"url##");const r=Ut[o].network;let a;return o=="Aptos"?t=="nftAddress"?a=`${e}/${ff(t)}/${n}/0?network=${r}`:a=`${e}/${ff(t)}/${n}?network=${r}`:s=="SuiVision"?a=`${e}/${pf(t)}/${n}`:s=="Suiscan"?a=`${e}/${r}/${nm(t)}/${n}`:a=`${e}/${v2(t)}/${n}?network=${r}`,console.log("href, chain, chainName, url, urlName, network==>",t,pf(t),a,i,o,e,s,r),a}function sP(e,t){const n="Sui",i=Bl[n][2].link,o=Bl[n][2].name,s=Ut[n].network;let r;return o=="Suiscan"&&(r=`${i}/${s}/${nm(e)}/${t}`),r}function Rc(e,t){const n=eh(we(t));return Number(we(e).mul(n))}function rP(e){const t=e.toString(),n=t.indexOf(".");if(n!==-1){for(let i=n+1;i<t.length;i++)if(t[i]!=="0")return i-n-1}return-1}function aP(e,t){let n=e,i=t;if(e.includes("sui::SUI")&&e.includes("sui::SUI")){if(e.slice(-10)===t.slice(-10))return!0}else return e[2]=="0"&&(n=e.slice(0,2)+e.slice(3)),t[2]=="0"&&(i=t.slice(0,2)+t.slice(3)),(n==null?void 0:n.toLowerCase())==(i==null?void 0:i.toLowerCase());return!1}const cP=e=>it.isDecimal(e)?e:new it(e===void 0?0:e),T2=(e,t,n=!0)=>{if(`${e}`=="0")return!parseFloat(t)||!n?0:"0.".padEnd(t+2,"0");if(!e)return"--";const i=parseFloat(e),o=e.toString(),s=i<0;let r=o;if(o.toLowerCase().includes("e")){const a=o.match(/(\d+?)(?:\.(\d*))?e([+-])(\d+)/),c=a[1],u=a[2],l=a[3],d=a[4];let h="",g=u?u.substr(d):"";if(g&&(g=`.${g}`),l!=="-"){for(let b=0;b<d;b+=1){const v=u[b]||"0";h+=v}r=c+h+g}else{let b="0";for(let v=0;v<d;v+=1)h=(c[c.length-v-1]||"0")+h;c.length>d&&(b=c.substr(0,c.length-d)),r=`${b}.${h}${u}`}}if(t&&n){let a=`${r.split(".")[0]}.`;const c=r.split(".")[1]||"";for(let u=0;u<t;u+=1)a+=c[u]||"0";r=a}if(r.length>14){const a=r.split(".");a[0].length>14?r=`${a[0].slice(0,14)}+`:(r=r.slice(0,13),r.indexOf(".")===12&&(r=r.slice(0,12)))}return`${s?"-":""}${r}`};function fn(e,t){if(t=t>-1?t:0,`${e}`=="0")return parseFloat(t)?"0.".padEnd(t+2,"0"):"0";if(!e)return"--";let n=!1;parseFloat(e)<0&&(n=!0);const i=`${Math.abs(parseFloat(e))}`;if(i==="NaN")return"--";let o=i;if(i.toLowerCase().includes("e")){if(i.toLowerCase().includes("+"))return T2(i,t);const r=i.toLowerCase().split("e");let a=r[0];const c=Math.abs(parseFloat(r[1]));let u="",l=a.length,d;for(r[0].split(".")[1]&&(a=r[0].split(".")[0]+r[0].split(".")[1],l=r[0].split(".")[0].length),d=0;d<c-l;d+=1)u+="0";o=`0.${u}${a}`}if(`${t}`!="0"&&!t||`${parseFloat(e)}`=="NaN")return(n?"-":"")+o;const s=o.split(".");if(t===0)o=parseInt(o,10);else if(t>0&&s[1])if(s[1].length>t)if(s[1].includes("999999999")){const r=parseFloat(o).toFixed(t+1);o=r.slice(0,r.length-1)}else o=`${s[0]}.${s[1].slice(0,t)}`;else o=parseFloat(o).toFixed(t);else o=parseFloat(o).toFixed(t);if(o.length>=14&&o.includes(".")){const r=o.split(".");r[0].length>14?o=`${r[0].slice(0,14)}+`:(o=o.slice(0,13),o.indexOf(".")===12&&(o=o.slice(0,12)))}return(n?"-":"")+o}function A2(e,t){const n=String(e);if(!n.includes("."))return n;const i=n.split("."),o=i[0],s=i[1].slice(0,t);return os(s)?`${o}.${os(s)}`:`${o}`}function os(e){return e.replace(/(\s|0|\.)+$/g,"")}function jo(e,t){if(typeof e=="number"&&isNaN(e)||!Number(e))return 0;if(!String(e).includes("."))return e;const n=String(e).split(".");if(n[1]&&n[1].length<=t&&Number(n[1]))return e;const i=Math.pow(10,-t);if(Number(e)<i)return n[1]&&os(n[1])?n[0]+"."+os(n[1]):n[0];const o=A2(e,t),s=String(o).split(".");return o==="--"?"--":s[1]&&os(String(s[1]))?s[0]+"."+os(String(s[1])):s[0]}const x2=(e,t=0)=>isNaN(e)||!e?e:(e=String(e),Number(e)==0?0:!isNaN(t)&&t?(t===0&&(e=e.split(".")[0]),e.replace(/(\d+)(\.\d+)?/,(n,i,o)=>i.replace(/(\d)(?=(?:\d{3})+$)/g,"$1,")+(o?o.slice(0,t+1):""))):e.replace(/^\d+/,n=>n.replace(/(\d)(?=(?:\d{3})+$)/g,"$1,")));function k2(e,t){const i=String(e).split(".");let o=!0;if(!i[1]||i[1]&&i[1].length<=t||i[0]!=="0")return!1;if(i&&i[1]&&i[0]==="0"&&i[1][i[1].length-1]==="1")for(let s=0;s<i[1].length-1;s++)i[1]!=="0"&&(o=!1);else o=!1;return o}function S2(e){const t=String(e);if(!t.includes("."))return e;const n=t.split("."),i=n[0],o=os(n[1]);return o&&`${i}.${o}`}const eo=(e,t,n=2)=>{if(e==""||typeof e=="string"&&e.indexOf("+")>-1)return e;if(isNaN(e)||Number(e)==0)return"0";const i=jo(e,t),o=Math.pow(10,-t);return Number(i)&&Math.abs(Number(i))<=o||k2(i,t)?eo(e,t+n):S2(i)};function uP(e){if(e){const t=e.toString(),n=t.indexOf(".")>-1?/(\d)(?=(\d{3})+\.)/g:/(\d)(?=(?:\d{3})+$)/g;return t.replace(n,"$1,")}}function P2(e){return Object.keys(e).length===0}function Kn(e){return e.toString().length===1?"0"+e:e}function gf(e){const t=e.getFullYear(),n=e.getMonth()+1,i=e.getDate();return t+"-"+Kn(n)+"-"+Kn(i)}function C2(e){const t=e.getMonth()+1,n=e.getDate();return Kn(t)+"/"+Kn(n)}function _f(e){const t=e.getHours(),n=e.getMinutes(),i=e.getSeconds();return Kn(t)+":"+Kn(n)+":"+Kn(i)}function B2(e){const t=e.getHours(),n=e.getMinutes();return Kn(t)+":"+Kn(n)}const lP=(e,t)=>{if(e){const n=new Date(Number(e));if(!t)return gf(n)+" "+_f(n);switch(t){case"HMS":return _f(n);case"YMD":return gf(n);case"MD":return C2(n);case"HM":return B2(n)}}},dP=(e,t)=>isNaN(e)||!e?e:Number(e)<1e-6&&Number(e)!==0?"<0.000001":x2(jo(String(e),t),t);function hP(e){const t=e.replace("%","");return Number(t)}function fP(e,t=1){return!e||isNaN(Number(e))?e:Math.abs(String(e))<1e3?eo(e,t):eo(Number(e)/1e3,t)+"k"}const Xs=async e=>new Promise(t=>{setTimeout(()=>{t(1)},e)}),pP=e=>e>=1e9?(e/1e9).toFixed(1)+"b":e>=1e6?(e/1e6).toFixed(1)+"m":e>=1e3?(e/1e3).toFixed(1)+"k":e.toString();function gP(e){const t=Number(eo(e,2));return t>=1e9?(t/1e9).toFixed(1).replace(/\B(?=(\d{3})+(?!\d))/g,",")+"b":t>=1e6?(t/1e6).toFixed(1).replace(/\B(?=(\d{3})+(?!\d))/g,",")+"m":t.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")}const _P=(e,t)=>e>=1e9?(e/1e9).toFixed(t)+"b":e>=1e6?(e/1e6).toFixed(t)+"m":e>=1e3?(e/1e3).toFixed(t)+"k":e.toString(),mP=e=>{const t=Math.floor(e/1e3),n=Math.floor(new Date().getTime()/1e3),i=60,o=60*i,s=24*o,r=30*s,a=365*s,c=n-t;if(c<i)return"recently";if(c<o){const u=Math.floor(c/i);return u==1?`${u} minute ago`:`${u} minutes ago`}else if(c<s){const u=Math.floor(c/o);return u==1?`${u} hour ago`:`${u} hours ago`}else if(c<r){const u=Math.floor(c/s);return u==1?`${u} day ago`:`${u} days ago`}else if(c<a){const u=Math.floor(c/r);return u==1?`${u} mouth ago`:`${u} mouths ago`}else{const u=Math.floor(c/a);return u==1?`${u} year ago`:`${u} years ago`}},yP=(e,t)=>{if(e){const n=new Date(e);if(!t)return mf(n)+" "+yf(n);switch(t){case"HMS":return yf(n);case"YMD":return mf(n);case"MD":return E2(n);case"HM":return I2(n)}}};function mf(e){const t=e.getUTCFullYear(),n=e.getUTCMonth()+1,i=e.getUTCDate();return t+"-"+Kn(n)+"-"+Kn(i)}function E2(e){const t=e.getUTCMonth()+1,n=e.getUTCDate();return Kn(t)+"/"+Kn(n)}function yf(e){const t=e.getUTCHours(),n=e.getUTCMinutes(),i=e.getUTCSeconds();return Kn(t)+":"+Kn(n)+":"+Kn(i)}function I2(e){const t=e.getUTCHours(),n=e.getUTCMinutes();return Kn(t)+":"+Kn(n)}var O2=Em();const R2=qf(O2),$2=-443636;function wP(e,t){const n=U2(e),i=(n-$2)%t;return i>t/2?n-i+t:n-i}const im=new it("1.0001");function U2(e){return e.log(im).toDP(0,it.ROUND_HALF_UP).toNumber()}function bP(e){return im.pow(e)}function pc(e,t,n){const i=Math.abs(e)%t;return e>0?i>t/2||n&&t<=2?e+t-i:e-i:i>t/2?e-t+i:e+i}function q2(){const e=Ut.Aptos.liquidswapDeployer,t={rpcUrl:localStorage.getItem("Aptos-currentRpclocal2")||Ut.Aptos.rpcUrl,fraphQLUrl:Ut.Aptos.fraphQLUrl,networkOptions:{nativeToken:"0x1::aptos_coin::AptosCoin",launchpad:{cetusLaunchpad:Ut.Aptos.Launchpad,crowdCoin:Ut.Aptos.LaunchpadCrowdCoin},simulationAccount:{pubkey:Ut.Aptos.accountPublicKey,address:Ut.Aptos.accountAddress},modules:{LiquidswapDeployer:e,ClmmIntegrate:Ut.Aptos.clmmIntegrate,FetcherDeployer:Ut.Aptos.fetcher,TokenDeployer:Ut.Aptos.TokenDeployer,IntegerMate:Ut.Aptos.IntegerMate}}},n=new w2(t),i=id(),o=Lf(),s=es(()=>o),r=es(()=>s.value.currentExplorer),{$notify:a}=Hs(),c=nt=>{const{$notify:dt}=Hs();dt.success({key:nt.hash+"loading",icon:xe("img",{class:{"notify-icon":!0,"loading-animate":!0},src:s.value.theme=="default"?"/image/img-loading@2x.png":"/sui-image/img-loading.png"}),message:xe("div",{class:"notification-title"},[xe("span",{innerHTML:nt.title},null)]),description:xe("div",{class:"notification-title"},[xe("div",{class:"notification-text",innerHTML:gi.global.t("newAdd.confirmingTransaction")},null),xe("a",{href:Oc(r.value,"tx",nt.hash),target:"_blank",innerHTML:gi.global.t("common.viewTransaction")},null)]),duration:0,class:"ant-notification-copy ant-notification-swap"})},u=nt=>{a.success({icon:xe("svg",{class:{icon:!0},"aria-hidden":!0},[xe("use",{"xlink:href":"#icon-icon-change1"})]),message:xe("div",{class:"notification-title"},[xe("span",{innerHTML:`${nt.title} `+gi.global.t("newAdd.success")},null)]),description:xe("div",{class:"notification-title"},[xe("div",{class:"notification-text",innerHTML:nt.desc},null),xe("a",{href:Oc(r.value,"tx",nt.hash),target:"_blank",innerHTML:gi.global.t("common.viewTransaction")},null)]),duration:4.5,class:"ant-notification-copy ant-notification-swap"})},l=nt=>{a.error({icon:xe("svg",{class:{icon:!0},"aria-hidden":!0},[xe("use",{"xlink:href":"#icon-a-icon-Shutdown"})]),message:xe("div",{class:"notification-title"},[xe("span",{innerHTML:`${nt} `+gi.global.t("newAdd.failed")},null)]),description:gi.global.t("newAdd.somethingWrong"),duration:4.5,class:"ant-notification-copy ant-notification-error"})},d=async(nt,dt=!1)=>{const Bt=await n.client.waitForTransactionWithResult(nt.hash);if(console.log("watchTransaction###res###",Bt),Bt&&Bt.success){a.close(nt.hash+"loading"),console.log("watchTransaction#####success"),u(nt);const At={walletAddress:i.address,chainName:"Aptos",...nt,...Bt,date:new Date().getTime()+6048e5};return o.setTransactionList(At),dt?{status:!0,nftInfo:Bt.events.filter(Nt=>Nt.type.includes("CreateTokenDataEvent"))}:!0}else{if(Bt&&!Bt.success)return a.close(nt.hash+"loading"),console.log("watchTransaction#####error"),l(nt.title),!1;console.log("watchTransaction#####one more"),setTimeout(()=>d(nt,dt),3e3)}},h=async(nt,dt=!1)=>{const Bt=await n.client.waitForTransactionWithResult(nt.hash);if(console.log("watchTransaction###res###",Bt),Bt&&Bt.success){console.log("watchTransaction#####success");const At={walletAddress:i.address,chainName:"Aptos",...nt,...Bt,date:new Date().getTime()+6048e5};o.setTransactionList(At)}},g=async nt=>{try{const dt=await n.Resources.getCoinStores(nt),Bt=[];return dt.forEach(At=>{let Rt="";At.coinAddress.includes("0x0000000000000000000000000000000000000000000000000000000000000001")?Rt=At.coinAddress.replace(/0x0000000000000000000000000000000000000000000000000000000000000001/,"0x1"):Rt=At.coinAddress,Bt.push({...At,coinAddress:Rt})}),Bt}catch{return[]}},b=async nt=>{try{i.setLoading(!0);const dt=await g(nt),Bt={};dt.forEach(At=>{const Rt=At?At.coin.value:"0";Bt[At.coinAddress]={...At,balance:Rt}}),console.log("1212###assets####",Bt),i.setAssets(Bt),i.setLoading(!1)}catch(dt){console.log("getAccount##error###",dt),i.setLoading(!1),i.setAssets({})}},v=async()=>{const nt={pubkey:Ni(Ut.Aptos.accountPublicKey),address:Ni(Ut.Aptos.accountAddress)},dt=await n.Token.getAllRegisteredTokenList(nt);return console.log("0215####tokenList####",dt),dt},x=async(nt,dt,Bt)=>n.Resources.getPoolState(nt,dt,Bt),P=async nt=>{const dt={pubkey:Ni(Ut.Aptos.accountPublicKey),address:Ni(Ut.Aptos.accountAddress)};return await n.Token.getOwnerWarpPoolList(Ut.Aptos.TokenDeployer,dt)},E=async nt=>await n.Resources.getPool(nt);return{setTransations:h,showTransitionPending:c,showTransitionSuccess:u,showTransitionError:l,watchTransaction:d,getAccount:b,getPoolState:x,getPools:async nt=>await n.Resources.getPools(nt),getPool:E,registerCoin:nt=>({function:"0x1::managed_coin::register",type_arguments:[nt],arguments:[],type:"entry_function_payload"}),estLiquidityAndcoinAmountFromOneAmounts:nt=>{console.log("estLiquidityAndcoinAmountFromOneAmounts###params####",nt);const{tokenA:dt,tokenB:Bt,lowerTick:At,upperTick:Rt,coinAmount:Yt,iscoinA:Nt,roundUp:Jt,slippage:Xe,curSqrtPrice:ce}=nt,Zt=Ei.estLiquidityAndcoinAmountFromOneAmounts(At,Rt,Yt,Nt,Jt,Xe,ce),Fe=dt.decimals,L=Bt.decimals,{tokenMaxA:G,tokenMaxB:Y,liquidityAmount:J}=Zt;return{tokenMaxAOrigin:G.toString(),tokenMaxBOrigin:Y.toString(),tokenMaxA:yn(G.toString(),Fe),tokenMaxB:yn(Y.toString(),L),liquidityAmount:J}},getCoinAmountFromLiquidity:nt=>{const{pool:dt,position:Bt,roundUp:At}=nt,Rt=Number(Bt.tick_lower_index),Yt=Number(Bt.tick_upper_index),Nt=Ze.tickIndexToSqrtPriceX64(Rt),Jt=Ze.tickIndexToSqrtPriceX64(Yt),Xe=Ei.getCoinAmountFromLiquidity(new _(Bt.liquidity),new _(dt.current_sqrt_price),Nt,Jt,At),ce=yn(Xe.coinA.toString(),dt.coinA.decimals),Zt=yn(Xe.coinB.toString(),dt.coinB.decimals);return{coinaAmount:ce,coinbAmount:Zt}},getAddLiquidityTransactionPayload:async nt=>{const{pool:dt,amount:Bt,fix_amount_a:At,roundUp:Rt,tick_lower:Yt,tick_upper:Nt,index:Jt,slippage:Xe}=nt;console.log(nt,"===>params411");const ce=await E(dt.poolAddress),Zt=At?Nn(Bt,dt.token_a.decimals):Nn(Bt,dt.token_b.decimals),Fe=Ze.sqrtPriceX64ToTickIndex(new _(ce.current_sqrt_price));let L,G;if(Fe>=Yt&&Fe<=Nt){const J=Ei.estLiquidityAndcoinAmountFromOneAmounts(Yt,Nt,new _(Zt.toString()),At,Rt,Xe,new _(ce.current_sqrt_price));L=At?Zt.toNumber():J.tokenMaxA.toNumber(),G=At?J.tokenMaxB.toNumber():Zt.toNumber()}else Fe>Nt?(L=0,G=Zt.toNumber()):Fe<Yt&&(L=Zt.toNumber(),G=0);return n.Position.createAddLiquidityTransactionPayload({pool:dt.poolAddress,coinTypeA:dt.token_a.address,coinTypeB:dt.token_b.address,amount_a:L,amount_b:G,fix_amount_a:At,tick_lower:Yt,tick_upper:Nt,is_open:!Jt,index:Jt})},getRemoveLiquidityTransactionPayload:async nt=>{const{pool:dt,coinTypeA:Bt,coinTypeB:At,coinTypeC:Rt,coinTypeD:Yt,coinTypeE:Nt,position:Jt,delta_liquidity:Xe,rewards_num:ce}=nt;console.log("getRemoveLiquidityTransactionPayload####delta_liquidity#####",Xe.toString());const Zt=await E(dt.poolAddress),Fe={...dt,...Zt},L=Number(Jt.tick_lower_index),G=Number(Jt.tick_upper_index),Y=Ze.tickIndexToSqrtPriceX64(L),J=Ze.tickIndexToSqrtPriceX64(G),ot=Ei.getCoinAmountFromLiquidity(Xe,new _(Fe.current_sqrt_price),Y,J,!0),ft=we(ot.coinA.toString()).mul(we(1-nt.slippage/100)),yt=we(ot.coinB.toString()).mul(we(1-nt.slippage/100));return await n.Position.removeLiquidityTransactionPayload({pool:dt.poolAddress,coinTypeA:Bt,coinTypeB:At,coinTypeC:Rt,coinTypeD:Yt,coinTypeE:Nt,delta_liquidity:Xe,min_amount_a:Number(fn(ft.toString(),0)),min_amount_b:Number(fn(yt.toString(),0)),pos_index:nt.position.index,is_close:!1,rewards_num:ce})},getCollectFeeTransactionPayload:async nt=>{console.log("1130###getCollectFeeTransactionPayload###params",{pool:nt.pool.poolAddress,coinTypeA:nt.pool.token_a.address,coinTypeB:nt.pool.token_b.address,pos_index:nt.position.index});const dt=await n.Position.collectFeeTransactionPayload({pool:nt.pool.poolAddress,coinTypeA:nt.pool.token_a.address,coinTypeB:nt.pool.token_b.address,pos_index:nt.position.index});return console.log("1130###getCollectFeeTransactionPayload###result##",dt),dt},getPositionList:async(nt,dt)=>{if(Ut.Aptos.network==="mainnet"){const Bt={operationName:"AccountTokensData",variables:{owner_address:nt,limit:1e5,offset:0},query:`query AccountTokensData($owner_address: String, $limit: Int, $offset: Int) {
  current_token_ownerships(
    where: {owner_address: {_eq: $owner_address}, amount: {_gt: "0"}}
    limit: $limit
    offset: $offset
  ) {
    token_data_id_hash
 creator_address
 name
    collection_name
  table_type
    property_version
    amount
    __typename
  }
}`},At=await $fetch("https://indexer.mainnet.aptoslabs.com/v1/graphql",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(Bt)});console.log("0116###pools####",dt);const Rt=At&&At.data&&At.data.current_token_ownerships||[];console.log("###list",Rt);const Yt=[];for(let Nt=0;Nt<Rt.length;Nt++){const Jt=Rt[Nt],Xe=dt[b2(Jt.creator_address)];if(console.log(Xe,"##pool"),Xe){const ce=Jt.name.split("-")[1],Zt=Xe.positions_handle,Fe=await n.Resources.getPositionInfoByIndex(Zt,ce);Yt.push({...Fe,tokenName:Jt.name})}}return console.log("0221###aptos###getPositionList###",Yt),Yt}else{const Bt=Object.values(dt);console.log(Bt,"###poolList");const At=await n.Resources.getPositionList(nt,Bt);return console.log("0221###aptos###getPositionList###list###",At),At}},getPositionInfo:async(nt,dt,Bt,At="")=>({...await n.Resources.getPositionInfo(nt,Bt),tokenName:Bt,collectionName:dt}),getSwapTransactionPayload:async nt=>{const{pool:dt,a2b:Bt,byAmountIn:At,amount:Rt,slippage:Yt}=nt,Nt=dt.poolAddress||dt.address,Jt=dt.token_a.decimals,Xe=dt.token_b.decimals,ce=await E(dt.address);let Zt;Bt&&At||!Bt&&!At?Zt=Nn(Rt,Jt):Zt=Nn(Rt,Xe);const Fe=await n.Swap.preswap({pool:ce,decimalsA:Jt,decimalsB:Xe,a2b:Bt,by_amount_in:At,amount:Zt.toString()});console.log("1130###getSwapTransactionPayload###preSwapRes###",Fe),console.log("1130###getSwapTransactionPayload###preSwapRes.estimatedAmountOut###",Fe.estimatedAmountOut.toString()),console.log("1130###getSwapTransactionPayload###preSwapRes.estimatedAmountIn###",Fe.estimatedAmountIn.toString());const L=we(Fe.estimatedAmountOut.toString()),G=we(Fe.estimatedAmountIn.toString()),Y=At?L.sub(L.mul(Yt)):G.add(G.mul(Yt));console.log("1130###amountLimit####",Y.toString()),console.log("1130###swap##params###",{pool_addr:Nt,coinTypeA:dt.token_a.address,coinTypeB:dt.token_b.address,a_to_b:Fe.aToB,by_amount_in:Fe.byAmountIn,amount:Fe.amount.toString(),amount_limit:fn(Y.toString(),0)||""});const J=n.Swap.createSwapTransactionPayload({pool_addr:Nt,coinTypeA:dt.token_a.address,coinTypeB:dt.token_b.address,a_to_b:Fe.aToB,by_amount_in:Fe.byAmountIn,amount:Fe.amount.toString(),amount_limit:fn(Y.toString(),0)||"",partner:""});return console.log("1130###swap##result###",J),J},getCoin:nt=>({type:"entry_function_payload",function:"0x84dc9d921d277db5047dcb17addc2ecfbddfad087dd4ea825b2d17785755cb29::cetus_faucet",arguments:[],type_arguments:[]}),preSwap:async nt=>{const{pool:dt,a2b:Bt,byAmountIn:At,amount:Rt}=nt;console.log(nt,"===>params");const Yt=dt.coinA.decimals,Nt=dt.coinB.decimals;let Jt=dt;dt.coinTypeA||(Jt={...dt,poolAddress:dt.address,coinTypeA:dt.coinA.address,coinTypeB:dt.coinB.address});let Xe;Bt&&At||!Bt&&!At?Xe=Nn(Rt,Yt):Xe=Nn(Rt,Nt);const ce=await n.Swap.preswap({pool:Jt,decimalsA:Yt,decimalsB:Nt,a2b:Bt,by_amount_in:At,amount:Xe.toString()});return{...ce,estimatedAmountIn:jo(yn(ce.estimatedAmountIn.toString(),Bt?Yt:Nt),Bt?Yt:Nt),estimatedAmountOut:jo(yn(ce.estimatedAmountOut.toString(),Bt?Nt:Yt),Bt?Nt:Yt),priceImpactPct:fn(ce.priceImpactPct,2)}},getTicks:async nt=>{try{return{list:await n.Fetcher.fetchTicks({pool:nt.poolAddress,coinTypeA:nt.coinTypeA,coinTypeB:nt.coinTypeB}),address:nt.poolAddress}}catch(dt){console.log("getTicks Error###",dt)}},TickMath:Ze,TickUtil:Yl,ClmmPoolUtil:Ei,getNearestTickByTick:pc,getTickDataFromUrlData:Y_,getCollectFeesQuote:async nt=>{console.log(nt,"params====>");const{pool:dt,position:Bt,tickLowerData:At,tickUpperData:Rt}=nt,Yt=F6({clmmpool:dt,position:Bt,tickLower:At,tickUpper:Rt}),Nt=yn(Yt.feeOwedA.toString(),dt.token_a.decimals),Jt=yn(Yt.feeOwedB.toString(),dt.token_b.decimals);return console.log("0118###useApots###result.feeOwedA.toString()###",Yt.feeOwedA.toString()),console.log("0118###useApots###result.feeOwedB.toString()###",Yt.feeOwedB.toString()),console.log("0118###useApots###feeOwedA###",Nt),console.log("0118###useApots###feeOwedB###",Jt),{feeOwedA:Number(Nt)>99999999999||Number(Nt)<0?"0":Nt,feeOwedB:Number(Jt)>99999999999||Number(Jt)<0?"0":Jt}},mintCoin:nt=>({function:`${Ut.Aptos.faucetObjectId}::coin::mint`,type_arguments:[`${Ut.Aptos.faucetObjectId}::coin::${nt.name}`],arguments:[nt.amount],type:"entry_function_payload"}),getNftHash:nt=>{const dt=`${nt.creator}::${nt.collection}::${nt.name}`;return R2(dt).toString()},getCollectRewarderTransactionPayload:nt=>n.Rewarder.collectPoolRewarderTransactionPayload(nt),getPosRewardersAmount:async nt=>{console.log(JSON.stringify(nt),"=====>params792");const{poolAddress:dt,positionName:Bt,tickLowerData:At,tickUpperData:Rt}=nt;return await n.Rewarder.posRewardersAmount(dt,Bt,At,Rt)},getTokenList:v,getTickDataByIndex:async(nt,dt)=>(console.log(nt,dt,"getTickDataByIndex"),await n.Resources.getTickDataByIndex(nt,dt)),initSwapRouter:async nt=>{n.Router.addPathProvider(nt),await n.Router.setCoinList({pubkey:Ni(Ut.Aptos.accountPublicKey),address:Ni(Ut.Aptos.accountAddress)}),await n.Router.loadGraph()},getSwapRouter:async(nt,dt)=>await n.Router.price(nt,dt),getEstPositionAPRWithDelta:async(nt,dt,Bt,At,Rt,Yt,Nt,Jt,Xe,ce,Zt,Fe,L,G,Y,J,ot,ft,yt,ht,bt,vt,ut,jt)=>await L6(nt,dt,Bt,At,Rt,Yt,Nt,Jt,Xe,ce,Zt,Fe,L,G,Y,J,ot,ft,yt,ht,bt,vt,ut,jt),getPriceImpactPct:(nt,dt,Bt)=>{const At=Ze.sqrtPriceX64ToPrice(new _(nt.current_sqrt_price),nt.coinA.decimals,nt.coinB.decimals).toNumber(),Rt=Bt?At:1/At,Yt=Math.abs(Rt-Number(dt))/Number(Rt)*100;return Number(fn(Yt,2))},getLpList:P,getEstPositionAPRWithMulti:async(nt,dt,Bt,At)=>await N6(nt,dt,Bt,At),getCreatPoolTransactionPayload:async nt=>{const{coinTypeA:dt,coinTypeB:Bt,tick_lower:At,tick_upper:Rt,tick_spacing:Yt,initialize_sqrt_price:Nt,max_amount_a:Jt,max_amount_b:Xe,slippage:ce,fix_amount_a:Zt,decimalsA:Fe,decimalsB:L,liquidityInput:G}=nt;console.log(nt,"params===>");const Y=Zt?Nn(Jt,Fe):Nn(Xe,L);console.log(Y,"===>coinAmount");const J=Ze.sqrtPriceX64ToTickIndex(new _(Nt));let ot,ft;const yt=Ze.tickIndexToSqrtPriceX64(At),ht=Ze.tickIndexToSqrtPriceX64(Rt);console.log(yt,"===>minPriceX64"),console.log(ht,"===>maxPriceX64");let bt;return J>At&&J<Rt?(bt=Ei.estLiquidityAndcoinAmountFromOneAmounts(At,Rt,new _(Y.toString()),Zt,!0,ce,new _(Nt)),ot=Zt?Y.toNumber():bt.tokenMaxA.toNumber(),ft=Zt?bt.tokenMaxB.toNumber():Y.toNumber()):J>=Rt?(bt=Ws(yt,ht,new _(Y.toString())),ot=new _(G.tokenMaxA*Math.pow(10,Fe)),ft=new _(G.tokenMaxB*Math.pow(10,L))):J<=At&&(bt=Gs(yt,ht,new _(Y.toString())),ot=new _(G.tokenMaxA*Math.pow(10,Fe)),ft=new _(G.tokenMaxB*Math.pow(10,L))),console.log(bt,"===>preAddResult"),await n.Pool.creatPoolTransactionPayload({coinTypeA:dt,coinTypeB:Bt,tick_spacing:Yt,initialize_sqrt_price:new _(Nt),uri:"",delta_liquidity:J>At&&J<Rt?bt.liquidityAmount:bt,max_amount_a:ot,max_amount_b:ft,tick_lower:At,tick_upper:Rt},!0)},getTokenListByCoinType:async()=>await n.Token.getTokenListByCoinType("",0,99999),getPoolImmutables:async()=>await n.Resources.getPoolImmutables(),estimateLiquidityForCoinA:Gs,estimateLiquidityForCoinB:Ws,getTokenBySymbol:async(nt,dt)=>{if(!dt)return null;let Bt=null;for(const At in nt){const Rt=nt[At];if(Rt.address.toUpperCase()===dt.toUpperCase()){Bt=Rt;break}}return Bt},estCoinAmountsFromTotalAmount:nt=>{const{lowerTick:dt,upperTick:Bt,decimalsA:At,decimalsB:Rt,curSqrtPrice:Yt,totalAmount:Nt,tokenPriceA:Jt,tokenPriceB:Xe}=nt;console.log(JSON.stringify({...nt,curSqrtPrice:Yt.toString()}),"params===>");const ce=Ei.estCoinAmountsFromTotalAmount(dt,Bt,Yt,Nt,Jt,Xe);console.log("coinAmounts: ",ce);const Zt=Rc(ce.amountA.toFixed(At,it.ROUND_UP).toString(),At),Fe=Rc(ce.amountB.toFixed(Rt,it.ROUND_UP).toString(),Rt),L={coinA:new _(Zt),coinB:new _(Fe)};return{amountA:yn(Zt.toString(),At),amountB:yn(Fe.toString(),Rt),tokenAmountsInfo:L}},getCreateAddLiquidityPayload:async nt=>{const{curSqrtPrice:dt,tickLower:Bt,tickUpper:At,tokenAmounts:Rt,pool:Yt,slippage:Nt}=nt;console.log(JSON.stringify(nt),"####getCreateAddLiquidityPayload 1593");const Jt=Ei.estimateLiquidityFromcoinAmounts(dt,Bt,At,Rt),Xe=new it(Rt.coinA.toString()).mul(1+Nt),ce=new it(Rt.coinB.toString()).mul(1+Nt),Zt={coinTypeA:Yt.coinTypeA,coinTypeB:Yt.coinTypeB,tick_lower:Bt,tick_upper:At,pool:Yt.address,delta_liquidity:Jt,max_amount_a:it.ceil(Xe).toString(),max_amount_b:it.ceil(ce).toString(),is_open:!0,index:0};return console.log(JSON.stringify(Zt),"==>addLiquidityPayloadParams"),await n.Position.createAddLiquidityTransactionPayload(Zt)},calculateDepositRatioFixTokenA:(nt,dt,Bt)=>Ei.calculateDepositRatioFixTokenA(nt,dt,Bt)}}let Xa;const M2=new Uint8Array(16);function D2(){if(!Xa&&(Xa=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!Xa))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return Xa(M2)}const Gn=[];for(let e=0;e<256;++e)Gn.push((e+256).toString(16).slice(1));function L2(e,t=0){return Gn[e[t+0]]+Gn[e[t+1]]+Gn[e[t+2]]+Gn[e[t+3]]+"-"+Gn[e[t+4]]+Gn[e[t+5]]+"-"+Gn[e[t+6]]+Gn[e[t+7]]+"-"+Gn[e[t+8]]+Gn[e[t+9]]+"-"+Gn[e[t+10]]+Gn[e[t+11]]+Gn[e[t+12]]+Gn[e[t+13]]+Gn[e[t+14]]+Gn[e[t+15]]}const N2=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),wf={randomUUID:N2};function bf(e,t,n){if(wf.randomUUID&&!t&&!e)return wf.randomUUID();e=e||{};const i=e.random||(e.rng||D2)();if(i[6]=i[6]&15|64,i[8]=i[8]&63|128,t){n=n||0;for(let o=0;o<16;++o)t[n+o]=i[o];return t}return L2(i)}var F2=Object.defineProperty,j2=(e,t,n)=>t in e?F2(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,z2=(e,t,n)=>(j2(e,typeof t!="symbol"?t+"":t,n),n),Hu=5*60*1e3,vn=24*60*60*1e3;function so(e){return Date.parse(new Date().toString())+e}var Ra=class{constructor(t,n=0){qt(this,"overdueTime");qt(this,"value");this.overdueTime=n,this.value=t}isValid(){return this.value===null?!1:this.overdueTime===0?!0:!(Date.parse(new Date().toString())>this.overdueTime)}};it.config({precision:64,rounding:it.ROUND_DOWN,toExpNeg:-64,toExpPos:64});var Xn=it,Mt=class extends Error{constructor(n,i){super(n);qt(this,"message");qt(this,"errorCode");this.message=n,this.errorCode=i}static isClmmpoolsErrorCode(n,i){return n instanceof Mt&&n.errorCode===i}},ie=new _(0),io=new _(1),Ku=new _(2);Ku.pow(new _(128));var Ar=Ku.pow(new _(64)).sub(io),H2=Ku.pow(new _(128)).sub(io),Ue=class{static toX64_BN(t){return t.mul(new _(2).pow(new _(64)))}static toX64_Decimal(t){return t.mul(Xn.pow(2,64))}static toX64(t){return new _(t.mul(Xn.pow(2,64)).floor().toFixed())}static fromX64(t){return new Xn(t.toString()).mul(Xn.pow(2,-64))}static fromX64_Decimal(t){return t.mul(Xn.pow(2,-64))}static fromX64_BN(t){return t.div(new _(2).pow(new _(64)))}static shiftRightRoundUp(t){let n=t.shrn(64);return t.mod(Ar).gt(ie)&&(n=n.add(io)),n}static divRoundUp(t,n){return t.mod(n).eq(ie)?t.div(n):t.div(n).add(new _(1))}static subUnderflowU128(t,n){return t.lt(n)?t.sub(n).add(H2):t.sub(n)}static checkUnsignedSub(t,n){const i=t.sub(n);if(i.isNeg())throw new Mt("Unsigned integer sub overflow","UnsignedIntegerOverflow");return i}static checkMul(t,n,i){const o=t.mul(n);if(this.isOverflow(o,i))throw new Mt("Multiplication overflow","MultiplicationOverflow");return o}static checkMulDivFloor(t,n,i,o){if(i.eq(ie))throw new Mt("Devide by zero","DivideByZero");const s=t.mul(n).div(i);if(this.isOverflow(s,o))throw new Mt("Multiplication div overflow","MulDivOverflow");return s}static checkMulDivCeil(t,n,i,o){if(i.eq(ie))throw new Mt("Devide by zero","DivideByZero");const s=t.mul(n).add(i.sub(io)).div(i);if(this.isOverflow(s,o))throw new Mt("Multiplication div overflow","MulDivOverflow");return s}static checkMulDivRound(t,n,i,o){if(i.eq(ie))throw new Mt("Devide by zero","DivideByZero");const s=t.mul(n.add(i.shrn(1))).div(i);if(this.isOverflow(s,o))throw new Mt("Multiplication div overflow","MulDivOverflow");return s}static checkMulShiftRight(t,n,i,o){const s=t.mul(n).div(new _(2).pow(new _(i)));if(this.isOverflow(s,o))throw new Mt("Multiplication shift right overflow","MulShiftRightOverflow");return s}static checkMulShiftRight64RoundUpIf(t,n,i,o){const s=t.mul(n),a=o&&s.and(Ar).gt(ie)?s.shrn(64).add(io):s.shrn(64);if(this.isOverflow(a,i))throw new Mt("Multiplication shift right overflow","MulShiftRightOverflow");return a}static checkMulShiftLeft(t,n,i,o){const s=t.mul(n).shln(i);if(this.isOverflow(s,o))throw new Mt("Multiplication shift left overflow","MulShiftLeftOverflow");return s}static checkDivRoundUpIf(t,n,i){if(n.eq(ie))throw new Mt("Devide by zero","DivideByZero");return i?this.divRoundUp(t,n):t.div(n)}static isOverflow(t,n){return t.gte(Ku.pow(new _(n)))}static sign(t){return t.testn(127)?1:0}static is_neg(t){return this.sign(t)===1}static abs_u128(t){return t.gt(ie)?t:this.u128_neg(t.subn(1))}static u128_neg(t){return t.uxor(new _("ffffffffffffffffffffffffffffffff",16))}static neg(t){return this.is_neg(t)?t.abs():this.neg_from(t)}static abs(t){return this.sign(t)===0?t:this.u128_neg(t.sub(new _(1)))}static neg_from(t){return t.eq(ie)?t:this.u128_neg(t).add(new _(1)).or(new _(1).shln(127))}};function K2(e){return{coinA:e.coinTypeA,coinB:e.coinTypeB,currentSqrtPrice:new _(e.current_sqrt_price),currentTickIndex:e.current_tick_index,feeGrowthGlobalA:new _(e.fee_growth_global_a),feeGrowthGlobalB:new _(e.fee_growth_global_b),feeProtocolCoinA:new _(e.fee_protocol_coin_a),feeProtocolCoinB:new _(e.fee_protocol_coin_b),feeRate:new _(e.fee_rate),liquidity:new _(e.liquidity),tickIndexes:[],tickSpacing:Number(e.tickSpacing),ticks:[],collection_name:""}}var vf=443636,Tf=-443636,Gu="79226673515401279992447579055",Wu="4295048016",Vs=new _(1e6),bn="0x0000000000000000000000000000000000000000000000000000000000000006",G2="partner",gc="pool_script",ls="pool_script_v2",Xr="router",wl="router_with_partner",_s="fetcher_script",W2="expect_swap",Af="utils",bl="custodian_v2",X2="clob_v2",V2="endpoints_v2";function hn(e){if(e.config===void 0)throw new Mt(`package: ${e.package_id}  not config in sdk SdkOptions`,"InvalidConfig");return e.config}var J2=14,Z2="59543866431248",Y2="184467440737095516",Q2="15793534762490258745",tk=443636;function ek(e,t,n){const i=e.toTwos(n).shln(t);return i.imaskn(n+1),i.fromTwos(n)}function He(e,t,n){const i=e.toTwos(n).shrn(t);return i.imaskn(n-t+1),i.fromTwos(n-t)}function nk(e){let t;return e&1?t=new _("79232123823359799118286999567"):t=new _("79228162514264337593543950336"),e&2&&(t=He(t.mul(new _("79236085330515764027303304731")),96,256)),e&4&&(t=He(t.mul(new _("79244008939048815603706035061")),96,256)),e&8&&(t=He(t.mul(new _("79259858533276714757314932305")),96,256)),e&16&&(t=He(t.mul(new _("79291567232598584799939703904")),96,256)),e&32&&(t=He(t.mul(new _("79355022692464371645785046466")),96,256)),e&64&&(t=He(t.mul(new _("79482085999252804386437311141")),96,256)),e&128&&(t=He(t.mul(new _("79736823300114093921829183326")),96,256)),e&256&&(t=He(t.mul(new _("80248749790819932309965073892")),96,256)),e&512&&(t=He(t.mul(new _("81282483887344747381513967011")),96,256)),e&1024&&(t=He(t.mul(new _("83390072131320151908154831281")),96,256)),e&2048&&(t=He(t.mul(new _("87770609709833776024991924138")),96,256)),e&4096&&(t=He(t.mul(new _("97234110755111693312479820773")),96,256)),e&8192&&(t=He(t.mul(new _("119332217159966728226237229890")),96,256)),e&16384&&(t=He(t.mul(new _("179736315981702064433883588727")),96,256)),e&32768&&(t=He(t.mul(new _("407748233172238350107850275304")),96,256)),e&65536&&(t=He(t.mul(new _("2098478828474011932436660412517")),96,256)),e&131072&&(t=He(t.mul(new _("55581415166113811149459800483533")),96,256)),e&262144&&(t=He(t.mul(new _("38992368544603139932233054999993551")),96,256)),He(t,32,256)}function ik(e){const t=Math.abs(e);let n;return t&1?n=new _("18445821805675392311"):n=new _("18446744073709551616"),t&2&&(n=He(n.mul(new _("18444899583751176498")),64,256)),t&4&&(n=He(n.mul(new _("18443055278223354162")),64,256)),t&8&&(n=He(n.mul(new _("18439367220385604838")),64,256)),t&16&&(n=He(n.mul(new _("18431993317065449817")),64,256)),t&32&&(n=He(n.mul(new _("18417254355718160513")),64,256)),t&64&&(n=He(n.mul(new _("18387811781193591352")),64,256)),t&128&&(n=He(n.mul(new _("18329067761203520168")),64,256)),t&256&&(n=He(n.mul(new _("18212142134806087854")),64,256)),t&512&&(n=He(n.mul(new _("17980523815641551639")),64,256)),t&1024&&(n=He(n.mul(new _("17526086738831147013")),64,256)),t&2048&&(n=He(n.mul(new _("16651378430235024244")),64,256)),t&4096&&(n=He(n.mul(new _("15030750278693429944")),64,256)),t&8192&&(n=He(n.mul(new _("12247334978882834399")),64,256)),t&16384&&(n=He(n.mul(new _("8131365268884726200")),64,256)),t&32768&&(n=He(n.mul(new _("3584323654723342297")),64,256)),t&65536&&(n=He(n.mul(new _("696457651847595233")),64,256)),t&131072&&(n=He(n.mul(new _("26294789957452057")),64,256)),t&262144&&(n=He(n.mul(new _("37481735321082")),64,256)),n}var We=class{static priceToSqrtPriceX64(t,n,i){return Ue.toX64(t.mul(Xn.pow(10,i-n)).sqrt())}static sqrtPriceX64ToPrice(t,n,i){return Ue.fromX64(t).pow(2).mul(Xn.pow(10,n-i))}static tickIndexToSqrtPriceX64(t){return t>0?new _(nk(t)):new _(ik(t))}static sqrtPriceX64ToTickIndex(t){if(t.gt(new _(Gu))||t.lt(new _(Wu)))throw new Mt("Provided sqrtPrice is not within the supported sqrtPrice range.","InvalidSqrtPrice");const n=t.bitLength()-1,i=new _(n-64),o=ek(i,32,128);let s=new _("8000000000000000","hex"),r=0,a=new _(0),c=n>=64?t.shrn(n-63):t.shln(63-n);for(;s.gt(new _(0))&&r<J2;){c=c.mul(c);const v=c.shrn(127);c=c.shrn(63+v.toNumber()),a=a.add(s.mul(v)),s=s.shrn(1),r+=1}const u=a.shrn(32),d=o.add(u).mul(new _(Z2)),h=He(d.sub(new _(Y2)),64,128).toNumber(),g=He(d.add(new _(Q2)),64,128).toNumber();return h===g?h:We.tickIndexToSqrtPriceX64(g).lte(t)?g:h}static tickIndexToPrice(t,n,i){return We.sqrtPriceX64ToPrice(We.tickIndexToSqrtPriceX64(t),n,i)}static priceToTickIndex(t,n,i){return We.sqrtPriceX64ToTickIndex(We.priceToSqrtPriceX64(t,n,i))}static priceToInitializableTickIndex(t,n,i,o){return We.getInitializableTickIndex(We.priceToTickIndex(t,n,i),o)}static getInitializableTickIndex(t,n){return t-t%n}static getNextInitializableTickIndex(t,n){return We.getInitializableTickIndex(t,n)+n}static getPrevInitializableTickIndex(t,n){return We.getInitializableTickIndex(t,n)-n}};function ok(e){const t=[];for(const n of e){const i={objectId:n.objectId,index:Number(Vo(BigInt(n.index)).toString()),sqrtPrice:n.sqrtPrice,liquidityNet:new _(BigInt.asIntN(128,BigInt(BigInt(n.liquidityNet.toString()))).toString()),liquidityGross:n.liquidityGross,feeGrowthOutsideA:n.feeGrowthOutsideA,feeGrowthOutsideB:n.feeGrowthOutsideB,rewardersGrowthOutside:[new _(n.rewardersGrowthOutside[0]),new _(n.rewardersGrowthOutside[1]),new _(n.rewardersGrowthOutside[2])]};t.push(i)}return t}function sk(e){return Je(e).add(Je(tk))}new _(365);new _(24);new _(3600);new _(.5);function rk(e,t,n,i){const o=Math.max(e,n),r=Math.min(t,i)-o,a=t-e,c=i-n,u=new it(a.toString()),l=new it(c.toString()),d=new it(r.toString());let h=new it("0");return r<0?h=new it("0"):a===r?h=l.div(d):c===r?h=d.div(u):h=d.mul(d).div(l).div(u),h}var No=class{static getDefaultSqrtPriceLimit(t){return new _(t?Wu:Gu)}static getDefaultOtherAmountThreshold(t){return t?ie:Ar}};function om(e,t,n,i){if(n.eq(ie))return e;const o=Ue.checkMulShiftLeft(e,t,64,256),s=t.shln(64),r=Ue.checkMul(e,n,256);if(!i&&s.lte(r))throw new Mt("getNextSqrtPriceAUp - Unable to divide liquidityShl64 by product","DivideByZero");const a=i?Ue.checkDivRoundUpIf(o,s.add(r),!0):Ue.checkDivRoundUpIf(o,s.sub(r),!0);if(a.lt(new _(Wu)))throw new Mt("getNextSqrtPriceAUp - Next sqrt price less than min sqrt price","CoinAmountMinSubceeded ");if(a.gt(new _(Gu)))throw new Mt("getNextSqrtPriceAUp - Next sqrt price greater than max sqrt price","CoinAmountMaxExceeded");return a}function sm(e,t,n,i){const o=Ue.checkDivRoundUpIf(n.shln(64),t,!i),s=i?e.add(o):e.sub(o);if(s.lt(new _(Wu))||s.gt(new _(Gu)))throw new Mt("getNextSqrtPriceAUp - Next sqrt price out of bounds","SqrtPriceOutOfBounds");return s}function ak(e,t,n,i){return i?om(e,t,n,!0):sm(e,t,n,!0)}function ck(e,t,n,i){return i?sm(e,t,n,!1):om(e,t,n,!1)}function xf(e,t,n,i){const o=e.gt(t)?e.sub(t):t.sub(e);if(n.lte(ie)||o.eq(ie))return ie;let s;if(i){const r=new _(n).mul(new _(o)).shln(64),a=t.mul(e),c=r.div(a);s=r.mod(a).eq(ie)?c:c.add(io)}else{const r=new _(n).mul(new _(o));s=r.and(Ar).gt(ie)?r.shrn(64).add(io):r.shrn(64)}return s}function kf(e,t,n,i){const o=e.gt(t)?e.sub(t):t.sub(e);if(n.lte(ie)||o.eq(ie))return ie;let s;if(i)s=n.mul(o).shrn(64);else{const r=n.mul(o).shln(64),a=t.mul(e);s=r.div(a)}return s}function uk(e,t,n,i,o,s){if(n===ie)return{amountIn:ie,amountOut:ie,nextSqrtPrice:t,feeAmount:ie};const r=e.gte(t);let a,c,u,l;if(s){const d=Ue.checkMulDivFloor(i,Ue.checkUnsignedSub(Vs,o),Vs,64),h=xf(e,t,n,r);h.gt(d)?(a=d,l=Ue.checkUnsignedSub(i,d),u=ak(e,n,d,r)):(a=h,l=Ue.checkMulDivCeil(a,o,Vs.sub(o),64),u=t),c=kf(e,u,n,r)}else{const d=kf(e,t,n,r);d.gt(i)?(c=i,u=ck(e,n,i,r)):(c=d,u=t),a=xf(e,u,n,r),l=Ue.checkMulDivCeil(a,o,Vs.sub(o),64)}return{amountIn:a,amountOut:c,nextSqrtPrice:u,feeAmount:l}}function lk(e,t,n,i,o){let s=n,r=i.liquidity,{currentSqrtPrice:a}=i;const c={amountIn:ie,amountOut:ie,feeAmount:ie,refAmount:ie,nextSqrtPrice:ie,crossTickNum:0};let u,l;const d=No.getDefaultSqrtPriceLimit(e);for(const h of o){if(e&&i.currentTickIndex<h.index||!e&&i.currentTickIndex>=h.index||h===null)continue;e&&d.gt(h.sqrtPrice)||!e&&d.lt(h.sqrtPrice)?u=d:u=h.sqrtPrice;const g=uk(a,u,r,s,i.feeRate,t);if(g.amountIn.eq(ie)||(s=t?s.sub(g.amountIn.add(g.feeAmount)):s.sub(g.amountOut)),c.amountIn=c.amountIn.add(g.amountIn),c.amountOut=c.amountOut.add(g.amountOut),c.feeAmount=c.feeAmount.add(g.feeAmount),g.nextSqrtPrice.eq(h.sqrtPrice)?(l=h.liquidityNet.mul(new _(-1)),e?Ue.is_neg(l)?r=r.add(new _(ji(BigInt(l.toString()),128))):r=r.add(l):Ue.is_neg(l)?r=r.sub(new _(ji(BigInt(l.toString()),128))):r=r.sub(l),a=h.sqrtPrice):a=g.nextSqrtPrice,c.crossTickNum+=1,s.eq(ie))break}return c.amountIn=c.amountIn.add(c.feeAmount),c.nextSqrtPrice=a,c}function Vr(e,t,n){const i=_.min(e,t),o=_.max(e,t),s=Ue.fromX64_BN(n.mul(o).mul(i)),r=o.sub(i);return s.div(r)}function Jr(e,t,n){const i=_.min(e,t),s=_.max(e,t).sub(i);return n.shln(64).div(s)}var Ii=class{static updateFeeRate(t,n,i,o,s){const r=Ue.checkMulDivCeil(n,new _(o),Vs,64),a=i===0?ie:Ue.checkMulDivFloor(n,new _(i),Vs,64),c=n.mul(r).mul(a);if(s?t.feeProtocolCoinA=t.feeProtocolCoinA.add(r):t.feeProtocolCoinB=t.feeProtocolCoinB.add(r),c.eq(ie)||t.liquidity.eq(ie))return{refFee:a,clmm:t};const u=c.shln(64).div(t.liquidity);return s?t.feeGrowthGlobalA=t.feeGrowthGlobalA.add(u):t.feeGrowthGlobalB=t.feeGrowthGlobalB.add(u),{refFee:a,clmm:t}}static getCoinAmountFromLiquidity(t,n,i,o,s){const r=new Xn(t.toString()),a=new Xn(n.toString()),c=new Xn(i.toString()),u=new Xn(o.toString());let l,d;return n.lt(i)?(l=Ue.toX64_Decimal(r).mul(u.sub(c)).div(c.mul(u)),d=new Xn(0)):n.lt(o)?(l=Ue.toX64_Decimal(r).mul(u.sub(a)).div(a.mul(u)),d=Ue.fromX64_Decimal(r.mul(a.sub(c)))):(l=new Xn(0),d=Ue.fromX64_Decimal(r.mul(u.sub(c)))),s?{coinA:new _(l.ceil().toString()),coinB:new _(d.ceil().toString())}:{coinA:new _(l.floor().toString()),coinB:new _(d.floor().toString())}}static estLiquidityAndcoinAmountFromOneAmounts(t,n,i,o,s,r,a){const c=We.sqrtPriceX64ToTickIndex(a),u=We.tickIndexToSqrtPriceX64(t),l=We.tickIndexToSqrtPriceX64(n);let d;if(c<t){if(!o)throw new Mt("lower tick cannot calculate liquidity by coinB","NotSupportedThisCoin");d=Vr(u,l,i)}else if(c>n){if(o)throw new Mt("upper tick cannot calculate liquidity by coinA","NotSupportedThisCoin");d=Jr(l,u,i)}else o?d=Vr(a,l,i):d=Jr(a,u,i);const h=Ii.getCoinAmountFromLiquidity(d,a,u,l,s),g=s?Je(h.coinA.toString()).mul(1+r).toString():Je(h.coinA.toString()).mul(1-r).toString(),b=s?Je(h.coinB.toString()).mul(1+r).toString():Je(h.coinB.toString()).mul(1-r).toString();return{coinAmountA:h.coinA,coinAmountB:h.coinB,tokenMaxA:s?new _(Xn.ceil(g).toString()):new _(Xn.floor(g).toString()),tokenMaxB:s?new _(Xn.ceil(b).toString()):new _(Xn.floor(b).toString()),liquidityAmount:d,fix_amount_a:o}}static estimateLiquidityFromcoinAmounts(t,n,i,o){if(n>i)throw new Mt("lower tick cannot be greater than lower tick","InvalidTwoTickIndex");const s=We.sqrtPriceX64ToTickIndex(t),r=We.tickIndexToSqrtPriceX64(n),a=We.tickIndexToSqrtPriceX64(i);if(s<n)return Vr(r,a,o.coinA);if(s>=i)return Jr(a,r,o.coinB);const c=Vr(t,a,o.coinA),u=Jr(t,r,o.coinB);return _.min(c,u)}static estCoinAmountsFromTotalAmount(t,n,i,o,s,r){const{ratioA:a,ratioB:c}=Ii.calculateDepositRatioFixTokenA(t,n,i),u=Je(o).mul(a).div(s),l=Je(o).mul(c).div(r);return{amountA:u,amountB:l}}static calculateDepositRatioFixTokenA(t,n,i){const o=new _(1e8),{coinAmountB:s}=Ii.estLiquidityAndcoinAmountFromOneAmounts(t,n,o,!0,!0,0,i),r=We.sqrtPriceX64ToPrice(i,0,0),a=Je(o.toString()).mul(r),c=a.add(s.toString()),u=a.div(c),l=Je(s.toString()).div(c);return{ratioA:u,ratioB:l}}};function dk(e){return e.startsWith("0x")?`${e.slice(2)}`:e}var hk=0,rm=1,fk=2;function Sf(e,t){return e===t?hk:e<t?rm:fk}function pk(e,t){let n=0;const i=e.length<=t.length?e.length:t.length,o=Sf(e.length,t.length);for(;n<i;){const s=Sf(e.charCodeAt(n),t.charCodeAt(n));if(n+=1,s!==0)return s}return o}function Ql(e,t){return pk(e,t)===rm}function Pf(e,...t){const n=Array.isArray(t[t.length-1])?t.pop():[];let o=[e,...t].filter(Boolean).join("::");return n&&n.length&&(o+=`<${n.join(", ")}>`),o}function ge(e){var t;try{let n=e.replace(/\s/g,"");const i=n.match(/(<.+>)$/),o=(t=i==null?void 0:i[0])==null?void 0:t.match(/(\w+::\w+::\w+)(?:<.*?>(?!>))?/g);if(o){n=n.slice(0,n.indexOf("<"));const u={...ge(n),type_arguments:o.map(l=>ge(l).source_address)};return u.type_arguments=u.type_arguments.map(l=>wn.isSuiCoin(l)?l:ge(l).source_address),u.source_address=Pf(u.full_address,u.type_arguments),u}const s=n.split("::"),a={full_address:n,address:n===cm||n===wk?"0x2":Dn(s[0]),module:s[1],name:s[2],type_arguments:[],source_address:""};return a.full_address=`${a.address}::${a.module}::${a.name}`,a.source_address=Pf(a.full_address,a.type_arguments),a}catch{return{full_address:e,address:"",module:"",name:"",type_arguments:[],source_address:e}}}function ho(e){return ge(e).source_address}function gk(e){return e.toLowerCase().startsWith("0x")?Dn(e):e}var _k=(e,t=!0)=>{const n=e.split("::"),i=n.shift();let o=Dn(i);return t&&(o=dk(o)),`${o}::${n.join("::")}`};function am(e){for(const t in e){const n=typeof e[t];if(n==="object")am(e[t]);else if(n==="string"){const i=e[t];i&&!i.includes("::")&&(e[t]=gk(i))}}}var mk="0x2::coin::Coin",yk=/^0x2::coin::Coin<(.+)>$/,cm="0x2::sui::SUI",wk="0x0000000000000000000000000000000000000000000000000000000000000002::sui::SUI",wn=class{static getCoinTypeArg(t){const n=t.type.match(yk);return n?n[1]:null}static isSUI(t){const n=wn.getCoinTypeArg(t);return n?wn.getCoinSymbol(n)==="SUI":!1}static getCoinSymbol(t){return t.substring(t.lastIndexOf(":")+1)}static getBalance(t){return BigInt(t.fields.balance)}static totalBalance(t,n){let i=BigInt(0);return t.forEach(o=>{n===o.coinAddress&&(i+=BigInt(o.balance))}),i}static getID(t){return t.fields.id.id}static getCoinTypeFromArg(t){return`${mk}<${t}>`}static getFaucetCoins(t){const{events:n}=t,i=[];return n==null||n.forEach(o=>{const{type:s}=o;if(ge(s).name==="InitEvent"){const r=o.parsedJson;i.push({transactionModule:o.transactionModule,suplyID:r.suplyID,decimals:r.decimals})}}),i}static getCoinAssets(t,n){const i=[];return n.forEach(o=>{ho(o.coinAddress)===ho(t)&&i.push(o)}),i}static isSuiCoin(t){return ge(t).full_address===cm}static selectCoinObjectIdGreaterThanOrEqual(t,n,i=[]){const o=wn.selectCoinAssetGreaterThanOrEqual(t,n,i),s=o.selectedCoins.map(c=>c.coinObjectId),r=o.remainingCoins,a=o.selectedCoins.map(c=>c.balance.toString());return{objectArray:s,remainCoins:r,amountArray:a}}static selectCoinAssetGreaterThanOrEqual(t,n,i=[]){const o=wn.sortByBalance(t.filter(u=>!i.includes(u.coinObjectId))),s=wn.calculateTotalBalance(o);if(s<n)return{selectedCoins:[],remainingCoins:o};if(s===n)return{selectedCoins:o,remainingCoins:[]};let r=BigInt(0);const a=[],c=[...o];for(;r<s;){const u=n-r,l=c.findIndex(h=>h.balance>=u);if(l!==-1){a.push(c[l]),c.splice(l,1);break}const d=c.pop();d.balance>0&&(a.push(d),r+=d.balance)}return{selectedCoins:wn.sortByBalance(a),remainingCoins:wn.sortByBalance(c)}}static sortByBalance(t){return t.sort((n,i)=>n.balance<i.balance?-1:n.balance>i.balance?1:0)}static sortByBalanceDes(t){return t.sort((n,i)=>n.balance>i.balance?-1:n.balance<i.balance?0:1)}static calculateTotalBalance(t){return t.reduce((n,i)=>n+i.balance,BigInt(0))}};function bk(e,t,n){let i=new _(0),o=new _(0);e.current_tick_index<t.index?(i=Ue.subUnderflowU128(new _(e.fee_growth_global_a),new _(t.feeGrowthOutsideA)),o=Ue.subUnderflowU128(new _(e.fee_growth_global_b),new _(t.feeGrowthOutsideB))):(i=new _(t.feeGrowthOutsideA),o=new _(t.feeGrowthOutsideB));let s=new _(0),r=new _(0);e.current_tick_index<n.index?(s=new _(n.feeGrowthOutsideA),r=new _(n.feeGrowthOutsideB)):(s=Ue.subUnderflowU128(new _(e.fee_growth_global_a),new _(n.feeGrowthOutsideA)),r=Ue.subUnderflowU128(new _(e.fee_growth_global_b),new _(n.feeGrowthOutsideB)));const a=Ue.subUnderflowU128(Ue.subUnderflowU128(new _(e.fee_growth_global_a),i),s),c=Ue.subUnderflowU128(Ue.subUnderflowU128(new _(e.fee_growth_global_b),o),r);return{fee_growth_inside_a:a,fee_growth_inside_b:c}}function vk(e,t,n){const i=Ue.subUnderflowU128(t,new _(e.fee_growth_inside_a)),o=new _(e.liquidity).mul(i).shrn(64),s=Ue.subUnderflowU128(n,new _(e.fee_growth_inside_b)),r=new _(e.liquidity).mul(s).shrn(64),a=new _(e.fee_owed_a).add(o),c=new _(e.fee_owed_b).add(r);return{position_id:e.pos_object_id,feeOwedA:a,feeOwedB:c}}function Tk(e){const{fee_growth_inside_a:t,fee_growth_inside_b:n}=bk(e.clmmpool,e.tickLower,e.tickUpper);return vk(e.position,t,n)}function Ak(e,{numerator:t,denominator:n},i){return i?e.mul(n.add(t)).div(n):e.mul(n).div(n.add(t))}function Je(e){return it.isDecimal(e)?e:new it(e===void 0?0:e)}function $a(e){return e.data}function um(e){if(e.error&&"object_id"in e.error&&"version"in e.error&&"digest"in e.error){const{error:t}=e;return{objectId:t.object_id,version:t.version,digest:t.digest}}}function lm(e){if(e.error&&"object_id"in e.error&&!("version"in e.error)&&!("digest"in e.error))return e.error.object_id}function xk(e){if("reference"in e)return e.reference;const t=$a(e);return t?{objectId:t.objectId,version:t.version,digest:t.digest}:um(e)}function rr(e){var t;return"objectId"in e?e.objectId:((t=xk(e))==null?void 0:t.objectId)??lm(e)}function kk(e){return e.data!==void 0}function Sk(e){return e.content!==void 0}function dm(e){const t="data"in e?$a(e):e;if(!(!t||!Sk(t)||t.content.dataType!=="moveObject"))return t.content}function nh(e){var t;return(t=dm(e))==null?void 0:t.type}function Pk(e){var n;const t=kk(e)?e.data:e;return!(t!=null&&t.type)&&"data"in e?((n=t==null?void 0:t.content)==null?void 0:n.dataType)==="package"?"package":nh(e):t==null?void 0:t.type}function ih(e){var t;return(t=$a(e))==null?void 0:t.previousTransaction}function Ck(e){var t;return(t=$a(e))==null?void 0:t.owner}function Bk(e){var n;const t=(n=$a(e))==null?void 0:n.display;return t||{data:null,error:null}}function zo(e){var n;const t=(n=dm(e))==null?void 0:n.fields;if(t)return"fields"in t?t.fields:t}function ji(e,t=32){return BigInt.asUintN(t,BigInt(e)).toString()}function Vo(e,t=32){return Number(BigInt.asIntN(t,BigInt(e)))}function Ek(e,t,n){const i=ge(e).name,o=ge(t).name;return`${i}-${o}[${n}]`}function vl(e){const t=nh(e),n=ge(t),i=zo(e);if(i==null)throw new Mt(`Pool id ${rr(e)} not exists.`,"InvalidPoolObject");const o=[];i.rewarder_manager.fields.rewarders.forEach(r=>{const{emissions_per_second:a}=r.fields,c=Ue.fromX64(new _(a)),u=Math.floor(c.toNumber()*60*60*24);o.push({emissions_per_second:a,coinAddress:ge(r.fields.reward_coin.fields.name).source_address,growth_global:r.fields.growth_global,emissionsEveryDay:u})});const s={poolAddress:rr(e),poolType:t,coinTypeA:n.type_arguments[0],coinTypeB:n.type_arguments[1],coinAmountA:i.coin_a,coinAmountB:i.coin_b,current_sqrt_price:i.current_sqrt_price,current_tick_index:Vo(BigInt(i.current_tick_index.fields.bits)),fee_growth_global_a:i.fee_growth_global_a,fee_growth_global_b:i.fee_growth_global_b,fee_protocol_coin_a:i.fee_protocol_coin_a,fee_protocol_coin_b:i.fee_protocol_coin_b,fee_rate:i.fee_rate,is_pause:i.is_pause,liquidity:i.liquidity,position_manager:{positions_handle:i.position_manager.fields.positions.fields.id.id,size:i.position_manager.fields.positions.fields.size},rewarder_infos:o,rewarder_last_updated_time:i.rewarder_manager.fields.last_updated_time,tickSpacing:i.tick_spacing,ticks_handle:i.tick_manager.fields.ticks.fields.id.id,uri:i.url,index:Number(i.index),name:""};return s.name=Ek(s.coinTypeA,s.coinTypeB,s.tickSpacing),s}function Ik(e){const t=Bk(e).data,n={creator:"",description:"",image_url:"",link:"",name:"",project_url:""};return t&&(n.creator=t.creator,n.description=t.description,n.image_url=t.image_url,n.link=t.link,n.name=t.name,n.project_url=t.project_url),n}function _c(e){var r,a;if(e.error!=null||((a=(r=e.data)==null?void 0:r.content)==null?void 0:a.dataType)!=="moveObject")throw new Mt(`Position not exists. Get Position error:${e.error}`,"InvalidPositionObject");let t={creator:"",description:"",image_url:"",link:"",name:"",project_url:""},n={...t,pos_object_id:"",owner:"",type:"",coin_type_a:"",coin_type_b:"",liquidity:"",tick_lower_index:0,tick_upper_index:0,index:0,pool:"",reward_amount_owed_0:"0",reward_amount_owed_1:"0",reward_amount_owed_2:"0",reward_growth_inside_0:"0",reward_growth_inside_1:"0",reward_growth_inside_2:"0",fee_growth_inside_a:"0",fee_owed_a:"0",fee_growth_inside_b:"0",fee_owed_b:"0",position_status:"Exists"},i=zo(e);if(i){const c=nh(e),u=Ck(e);"nft"in i?(i=i.nft.fields,t.description=i.description,t.name=i.name,t.link=i.url):t=Ik(e),n={...t,pos_object_id:i.id.id,owner:u.AddressOwner,type:c,coin_type_a:i.coin_type_a.fields.name,coin_type_b:i.coin_type_b.fields.name,liquidity:i.liquidity,tick_lower_index:Vo(BigInt(i.tick_lower_index.fields.bits)),tick_upper_index:Vo(BigInt(i.tick_upper_index.fields.bits)),index:i.index,pool:i.pool,reward_amount_owed_0:"0",reward_amount_owed_1:"0",reward_amount_owed_2:"0",reward_growth_inside_0:"0",reward_growth_inside_1:"0",reward_growth_inside_2:"0",fee_growth_inside_a:"0",fee_owed_a:"0",fee_growth_inside_b:"0",fee_owed_b:"0",position_status:"Exists"}}const o=um(e);o&&(n.pos_object_id=o.objectId,n.position_status="Deleted");const s=lm(e);return s&&(n.pos_object_id=s,n.position_status="NotExists"),n}function hm(e){const t={reward_amount_owed_0:"0",reward_amount_owed_1:"0",reward_amount_owed_2:"0",reward_growth_inside_0:"0",reward_growth_inside_1:"0",reward_growth_inside_2:"0"};e="fields"in e?e.fields:e,e.rewards.forEach((s,r)=>{const{amount_owned:a,growth_inside:c}="fields"in s?s.fields:s;r===0?(t.reward_amount_owed_0=a,t.reward_growth_inside_0=c):r===1?(t.reward_amount_owed_1=a,t.reward_growth_inside_1=c):r===2&&(t.reward_amount_owed_2=a,t.reward_growth_inside_2=c)});const n="fields"in e.tick_lower_index?e.tick_lower_index.fields.bits:e.tick_lower_index.bits,i="fields"in e.tick_upper_index?e.tick_upper_index.fields.bits:e.tick_upper_index.bits;return{liquidity:e.liquidity,tick_lower_index:Vo(BigInt(n)),tick_upper_index:Vo(BigInt(i)),...t,fee_growth_inside_a:e.fee_growth_inside_a,fee_owed_a:e.fee_owned_a,fee_growth_inside_b:e.fee_growth_inside_b,fee_owed_b:e.fee_owned_b,pos_object_id:e.position_id}}function Tl(e){var o,s;if(e.error!=null||((s=(o=e.data)==null?void 0:o.content)==null?void 0:s.dataType)!=="moveObject")throw new Mt(`Tick not exists. Get tick data error:${e.error}`,"InvalidTickObject");const n=zo(e).value.fields.value.fields;return{objectId:rr(e),index:Vo(BigInt(n.index.fields.bits)),sqrtPrice:new _(n.sqrt_price),liquidityNet:new _(n.liquidity_net.fields.bits),liquidityGross:new _(n.liquidity_gross),feeGrowthOutsideA:new _(n.fee_growth_outside_a),feeGrowthOutsideB:new _(n.fee_growth_outside_b),rewardersGrowthOutside:n.rewards_growth_outside}}function Ok(e){if(!e||!e.index||!e.sqrt_price||!e.liquidity_net||!e.liquidity_gross||!e.fee_growth_outside_a||!e.fee_growth_outside_b)throw new Mt("Invalid tick fields.","InvalidTickFields");const t=Vo(BigInt(e.index.bits)),n=new _(e.sqrt_price),i=new _(e.liquidity_net.bits),o=new _(e.liquidity_gross),s=new _(e.fee_growth_outside_a),r=new _(e.fee_growth_outside_b),a=e.rewards_growth_outside||[];return{objectId:"",index:t,sqrtPrice:n,liquidityNet:i,liquidityGross:o,feeGrowthOutsideA:s,feeGrowthOutsideB:r,rewardersGrowthOutside:a}}var jr=class{static getMinIndex(e){return Tf+Math.abs(Tf)%e}static getMaxIndex(e){return vf-vf%e}};function CP(e,t){const n=Math.abs(e)%t;return e>0?n>t/2?e+t-n:e-n:n>t/2?e-t+n:e+n}function Rk(e,t,n,i,o,s){const r=e.rewarder_infos,a=[];for(let c=0;c<r.length;c+=1){let u=s[c];t!==null&&(e.current_tick_index<i?u=s[c].sub(new _(t.rewardersGrowthOutside[c])):u=t.rewardersGrowthOutside[c]);let l=new _(0);n!==null&&(e.current_tick_index>=o?l=s[c].sub(new _(n.rewardersGrowthOutside[c])):l=n.rewardersGrowthOutside[c]);const d=Ue.subUnderflowU128(Ue.subUnderflowU128(new _(s[c]),new _(u)),new _(l));a.push(d)}return a}function $c(e){const t=wn.isSuiCoin(e.coinTypeA),n=wn.isSuiCoin(e.coinTypeB);return{isAdjustCoinA:t,isAdjustCoinB:n}}function $k(e,t){return it.ceil(Je(e).div(1+t)).toString()}var ee=class{static createCollectRewarderAndFeeParams(t,n,i,o,s,r){s===void 0&&(s=[...o]),r===void 0&&(r=[...o]);const a=ho(i.coinTypeA),c=ho(i.coinTypeB);if(i.collect_fee){const l=ee.buildCoinForAmount(n,s,BigInt(0),a,!1);s=l.remainCoins;const d=ee.buildCoinForAmount(n,r,BigInt(0),c,!1);r=d.remainCoins,n=t.Position.createCollectFeePaylod({pool_id:i.pool_id,pos_id:i.pos_id,coinTypeA:i.coinTypeA,coinTypeB:i.coinTypeB},n,l.targetCoin,d.targetCoin)}const u=[];return i.rewarder_coin_types.forEach(l=>{switch(ho(l)){case a:u.push(ee.buildCoinForAmount(n,s,BigInt(0),l,!1).targetCoin);break;case c:u.push(ee.buildCoinForAmount(n,r,BigInt(0),l,!1).targetCoin);break;default:u.push(ee.buildCoinForAmount(n,o,BigInt(0),l,!1).targetCoin);break}}),n=t.Rewarder.createCollectRewarderPaylod(i,n,u),n}static async adjustTransactionForGas(t,n,i,o){o.setSender(t.senderAddress);const s=wn.selectCoinAssetGreaterThanOrEqual(n,i).selectedCoins;if(s.length===0)throw new Mt("Insufficient balance","InsufficientBalance");const r=wn.calculateTotalBalance(n);if(r-i>1e9)return{fixAmount:i};const a=await t.fullClient.calculationTxGas(o);if(wn.selectCoinAssetGreaterThanOrEqual(n,BigInt(a),s.map(u=>u.coinObjectId)).selectedCoins.length===0){const u=BigInt(a)+BigInt(500);if(r-i<u){if(i-=u,i<0)throw new Mt("gas Insufficient balance","InsufficientBalance");const l=new _t;return{fixAmount:i,newTx:l}}}return{fixAmount:i}}static async buildAddLiquidityFixTokenForGas(t,n,i,o){let s=await ee.buildAddLiquidityFixToken(t,n,i);const{isAdjustCoinA:r}=$c(i),a=r?i.amount_a:i.amount_b,c=await ee.adjustTransactionForGas(t,wn.getCoinAssets(r?i.coinTypeA:i.coinTypeB,n),BigInt(a),s),{fixAmount:u}=c,{newTx:l}=c;if(l!==void 0){let d,h;if(r)i.amount_a=Number(u),d=ee.buildAddLiquidityFixTokenCoinInput(l,!i.fix_amount_a,u.toString(),i.slippage,i.coinTypeA,n,!1),h=ee.buildAddLiquidityFixTokenCoinInput(l,i.fix_amount_a,i.amount_b,i.slippage,i.coinTypeB,n,!1);else return i.amount_b=Number(u),d=ee.buildAddLiquidityFixTokenCoinInput(l,!i.fix_amount_a,i.amount_a,i.slippage,i.coinTypeA,n,!1),h=ee.buildAddLiquidityFixTokenCoinInput(l,i.fix_amount_a,u.toString(),i.slippage,i.coinTypeB,n,!1),i=ee.fixAddLiquidityFixTokenParams(i,o.slippage,o.curSqrtPrice),s=await ee.buildAddLiquidityFixTokenArgs(l,t,n,i,d,h),s}return s}static async buildAddLiquidityFixToken(t,n,i){if(t.senderAddress.length===0)throw Error("this config sdk senderAddress is empty");let o=new _t;const s=ee.buildAddLiquidityFixTokenCoinInput(o,!i.fix_amount_a,i.amount_a,i.slippage,i.coinTypeA,n,!1),r=ee.buildAddLiquidityFixTokenCoinInput(o,i.fix_amount_a,i.amount_b,i.slippage,i.coinTypeB,n,!1);return o=ee.buildAddLiquidityFixTokenArgs(o,t,n,i,s,r),o}static buildAddLiquidityFixTokenCoinInput(t,n,i,o,s,r,a=!0){return n?ee.buildCoinForAmountInterval(t,r,{amountSecond:BigInt($k(i,o)),amountFirst:BigInt(i)},s,a):ee.buildCoinForAmount(t,r,BigInt(i),s,a)}static fixAddLiquidityFixTokenParams(t,n,i){const o=t.fix_amount_a?t.amount_a:t.amount_b,s=Ii.estLiquidityAndcoinAmountFromOneAmounts(Number(t.tick_lower),Number(t.tick_upper),new _(o),t.fix_amount_a,!0,n,i);return t.amount_a=t.fix_amount_a?t.amount_a:s.tokenMaxA.toNumber(),t.amount_b=t.fix_amount_a?s.tokenMaxB.toNumber():t.amount_b,t}static buildAddLiquidityFixTokenArgs(t,n,i,o,s,r){const a=[o.coinTypeA,o.coinTypeB],c=o.is_open?"open_position_with_liquidity_by_fix_coin":"add_liquidity_by_fix_coin",{clmm_pool:u,integrate:l}=n.sdkOptions;o.is_open||(t=ee.createCollectRewarderAndFeeParams(n,t,o,i,s.remainCoins,r.remainCoins));const d=hn(u),h=o.is_open?[t.object(d.global_config_id),t.object(o.pool_id),t.pure(ji(BigInt(o.tick_lower)).toString()),t.pure(ji(BigInt(o.tick_upper)).toString()),s.targetCoin,r.targetCoin,t.pure(o.amount_a),t.pure(o.amount_b),t.pure(o.fix_amount_a),t.object(bn)]:[t.object(d.global_config_id),t.object(o.pool_id),t.object(o.pos_id),s.targetCoin,r.targetCoin,t.pure(o.amount_a),t.pure(o.amount_b),t.pure(o.fix_amount_a),t.object(bn)];return t.moveCall({target:`${l.published_at}::${ls}::${c}`,typeArguments:a,arguments:h}),t}static async buildSwapTransactionForGas(t,n,i,o){let s=ee.buildSwapTransaction(t,n,i);s.setSender(t.senderAddress);const r=await ee.adjustTransactionForGas(t,wn.getCoinAssets(n.a2b?n.coinTypeA:n.coinTypeB,i),BigInt(n.by_amount_in?n.amount:n.amount_limit),s),{fixAmount:a,newTx:c}=r;if(c!==void 0){c.setSender(t.senderAddress),n.by_amount_in?n.amount=a.toString():n.amount_limit=a.toString(),n=await ee.fixSwapParams(t,n,o);const u=ee.buildCoinForAmount(s,i,n.a2b?BigInt(n.by_amount_in?n.amount:n.amount_limit):BigInt(0),n.coinTypeA),l=ee.buildCoinForAmount(s,i,n.a2b?BigInt(0):BigInt(n.by_amount_in?n.amount:n.amount_limit),n.coinTypeB);s=ee.buildSwapTransactionArgs(c,n,t.sdkOptions,u,l)}return s}static buildSwapTransaction(t,n,i){let o=new _t;o.setSender(t.senderAddress);const s=ee.buildCoinForAmount(o,i,n.a2b?BigInt(n.by_amount_in?n.amount:n.amount_limit):BigInt(0),n.coinTypeA,!1),r=ee.buildCoinForAmount(o,i,n.a2b?BigInt(0):BigInt(n.by_amount_in?n.amount:n.amount_limit),n.coinTypeB,!1);return o=ee.buildSwapTransactionArgs(o,n,t.sdkOptions,s,r),o}static buildSwapTransactionArgs(t,n,i,o,s){const{clmm_pool:r,integrate:a}=i,c=No.getDefaultSqrtPriceLimit(n.a2b),u=[n.coinTypeA,n.coinTypeB],{global_config_id:l}=hn(r);if(l===void 0)throw Error("clmm.config.global_config_id is undefined");const d=n.swap_partner!==void 0,h=d?n.a2b?"swap_a2b_with_partner":"swap_b2a_with_partner":n.a2b?"swap_a2b":"swap_b2a",g=d?[t.pure(l),t.pure(n.pool_id),t.pure(n.swap_partner),o.targetCoin,s.targetCoin,t.pure(n.by_amount_in),t.pure(n.amount),t.pure(n.amount_limit),t.pure(c.toString()),t.pure(bn)]:[t.pure(l),t.pure(n.pool_id),o.targetCoin,s.targetCoin,t.pure(n.by_amount_in),t.pure(n.amount),t.pure(n.amount_limit),t.pure(c.toString()),t.pure(bn)];return t.moveCall({target:`${a.published_at}::${ls}::${h}`,typeArguments:u,arguments:g}),t}static async buildSwapTransactionWithoutTransferCoinsForGas(t,n,i,o){let{tx:s,coinABs:r}=ee.buildSwapTransactionWithoutTransferCoins(t,n,i);s.setSender(t.senderAddress);const a=await ee.adjustTransactionForGas(t,wn.getCoinAssets(n.a2b?n.coinTypeA:n.coinTypeB,i),BigInt(n.by_amount_in?n.amount:n.amount_limit),s),{fixAmount:c,newTx:u}=a;if(u!==void 0){u.setSender(t.senderAddress),n.by_amount_in?n.amount=c.toString():n.amount_limit=c.toString(),n=await ee.fixSwapParams(t,n,o);const l=ee.buildCoinForAmount(s,i,n.a2b?BigInt(n.by_amount_in?n.amount:n.amount_limit):BigInt(0),n.coinTypeA,!1,!0),d=ee.buildCoinForAmount(s,i,n.a2b?BigInt(0):BigInt(n.by_amount_in?n.amount:n.amount_limit),n.coinTypeB,!1,!0),h=ee.buildSwapTransactionWithoutTransferCoinArgs(t,u,n,t.sdkOptions,l,d);s=h.tx,r=h.txRes}return{tx:s,coinABs:r}}static buildSwapTransactionWithoutTransferCoins(t,n,i){const o=new _t;o.setSender(t.senderAddress);const s=ee.buildCoinForAmount(o,i,n.a2b?BigInt(n.by_amount_in?n.amount:n.amount_limit):BigInt(0),n.coinTypeA,!1,!0),r=ee.buildCoinForAmount(o,i,n.a2b?BigInt(0):BigInt(n.by_amount_in?n.amount:n.amount_limit),n.coinTypeB,!1,!0),a=ee.buildSwapTransactionWithoutTransferCoinArgs(t,o,n,t.sdkOptions,s,r);return{tx:a.tx,coinABs:a.txRes}}static buildSwapTransactionWithoutTransferCoinArgs(t,n,i,o,s,r){const{clmm_pool:a,integrate:c}=o,u=No.getDefaultSqrtPriceLimit(i.a2b),{global_config_id:l}=hn(a);if(l===void 0)throw Error("clmm.config.global_config_id is undefined");const d=i.swap_partner!==void 0,h=d?"swap_with_partner":"swap",g=d?wl:Xr,b=d?[n.pure(l),n.pure(i.pool_id),n.pure(i.swap_partner),s.targetCoin,r.targetCoin,n.pure(i.a2b),n.pure(i.by_amount_in),n.pure(i.amount),n.pure(u.toString()),n.pure(!1),n.pure(bn)]:[n.pure(l),n.pure(i.pool_id),s.targetCoin,r.targetCoin,n.pure(i.a2b),n.pure(i.by_amount_in),n.pure(i.amount),n.pure(u.toString()),n.pure(!1),n.pure(bn)],v=[i.coinTypeA,i.coinTypeB],x=n.moveCall({target:`${c.published_at}::${g}::${h}`,typeArguments:v,arguments:b});if(i.by_amount_in){const P=i.a2b?i.coinTypeB:i.coinTypeA,E=i.a2b?x[1]:x[0],S=Number(i.amount_limit);this.checkCoinThreshold(t,i.by_amount_in,n,E,S,P)}return{tx:n,txRes:x}}static async fixSwapParams(t,n,i){const{currentPool:o}=i;try{const s=await t.Swap.preswap({decimalsA:i.decimalsA,decimalsB:i.decimalsB,a2b:n.a2b,byAmountIn:n.by_amount_in,amount:n.amount,pool:o,currentSqrtPrice:o.current_sqrt_price,coinTypeA:o.coinTypeA,coinTypeB:o.coinTypeB}),r=i.byAmountIn?s.estimatedAmountOut:s.estimatedAmountIn,a=Ak(r,i.slippage,!i.byAmountIn);n.amount_limit=a.toString()}catch(s){console.log("fixSwapParams",s)}return n}static async syncBuildCoinInputForAmount(t,n,i,o,s=!0){if(t.senderAddress.length===0)throw Error("this config sdk senderAddress is empty");const r=await t.getOwnerCoinAssets(t.senderAddress,o);return ee.buildCoinForAmount(n,r,i,o,s).targetCoin}static buildCoinForAmount(t,n,i,o,s=!0,r=!1){const a=wn.getCoinAssets(o,n);if(i===BigInt(0)&&a.length===0)return ee.buildZeroValueCoin(n,t,o,s);const c=wn.calculateTotalBalance(a);if(c<i)throw new Mt(`The amount(${c}) is Insufficient balance for ${o} , expect ${i} `,"InsufficientBalance");return ee.buildCoin(t,n,a,i,o,s,r)}static buildCoin(t,n,i,o,s,r=!0,a=!1){if(wn.isSuiCoin(s)){if(r){const S=t.splitCoins(t.gas,[t.pure(o.toString())]);return{targetCoin:t.makeMoveVec({objects:[S]}),remainCoins:n,tragetCoinAmount:o.toString(),isMintZeroCoin:!1,originalSplitedCoin:t.gas}}if(o===0n&&i.length>1){const S=wn.selectCoinObjectIdGreaterThanOrEqual(i,o);return{targetCoin:t.object(S.objectArray[0]),remainCoins:S.remainCoins,tragetCoinAmount:S.amountArray[0],isMintZeroCoin:!1}}const P=wn.selectCoinObjectIdGreaterThanOrEqual(i,o);return{targetCoin:t.splitCoins(t.gas,[t.pure(o.toString())]),remainCoins:P.remainCoins,tragetCoinAmount:o.toString(),isMintZeroCoin:!1,originalSplitedCoin:t.gas}}const c=wn.selectCoinObjectIdGreaterThanOrEqual(i,o),u=c.amountArray.reduce((P,E)=>Number(P)+Number(E),0).toString(),l=c.objectArray;if(r)return{targetCoin:t.makeMoveVec({objects:l.map(P=>t.object(P))}),remainCoins:c.remainCoins,tragetCoinAmount:c.amountArray.reduce((P,E)=>Number(P)+Number(E),0).toString(),isMintZeroCoin:!1};const[d,...h]=l,g=t.object(d);let b=g,v=c.amountArray.reduce((P,E)=>Number(P)+Number(E),0).toString(),x;return h.length>0&&t.mergeCoins(g,h.map(P=>t.object(P))),a&&Number(u)>Number(o)&&(b=t.splitCoins(g,[t.pure(o.toString())]),v=o.toString(),x=g),{targetCoin:b,remainCoins:c.remainCoins,originalSplitedCoin:x,tragetCoinAmount:v,isMintZeroCoin:!1}}static buildZeroValueCoin(t,n,i,o=!0){const s=ee.callMintZeroValueCoin(n,i);let r;return o?r=n.makeMoveVec({objects:[s]}):r=s,{targetCoin:r,remainCoins:t,isMintZeroCoin:!0,tragetCoinAmount:"0"}}static buildCoinForAmountInterval(t,n,i,o,s=!0){const r=wn.getCoinAssets(o,n);if(i.amountFirst===BigInt(0))return r.length>0?ee.buildCoin(t,[...n],[...r],i.amountFirst,o,s):ee.buildZeroValueCoin(n,t,o,s);const a=wn.calculateTotalBalance(r);if(a>=i.amountFirst)return ee.buildCoin(t,[...n],[...r],i.amountFirst,o,s);if(a<i.amountSecond)throw new Mt(`The amount(${a}) is Insufficient balance for ${o} , expect ${i.amountSecond} `,"InsufficientBalance");return ee.buildCoin(t,[...n],[...r],i.amountSecond,o,s)}static async buildRouterSwapTransaction(t,n,i,o,s){let r=new _t;return n.paths.length>1&&(n.partner=""),r=await this.buildRouterBasePathTx(t,n,i,o,r,s),r}static async buildRouterBasePathTx(t,n,i,o,s,r){const a=n.paths.filter(T=>T&&T.poolAddress),c=Number(a.reduce((T,R)=>T.add(R.amountIn),ie).toString()),u=Number(a.reduce((T,R)=>T.add(R.amountOut),ie).toString()),l=Math.round(i?Number(u.toString())*(1-n.priceSlippagePoint):Number(c.toString())*(1+n.priceSlippagePoint)),d=n.paths[0].coinType[0],h=n.paths[0].coinType[n.paths[0].coinType.length-1],g=ee.buildCoinForAmount(s,o,BigInt(i?c:l),d,!1,!0),b=g.originalSplitedCoin!==void 0,v=ee.buildCoinForAmount(s,o,0n,h,!1),x=await this.buildRouterBasePathReturnCoins(t,n,i,g,v,s),P=[],{toCoin:E,fromCoin:S}=x;if(s=x.tx,v.isMintZeroCoin?P.push({coinType:h,coin:E}):v.originalSplitedCoin!==void 0?s.mergeCoins(v.originalSplitedCoin,[E]):s.mergeCoins(v.targetCoin,[E]),b){const T=g==null?void 0:g.originalSplitedCoin;s.mergeCoins(T,[S])}else P.push({coinType:d,coin:S});for(let T=0;T<P.length;T++)this.buildTransferCoin(t,s,P[T].coin,P[T].coinType,r);return s}static async buildRouterBasePathReturnCoins(t,n,i,o,s,r){const{clmm_pool:a,integrate:c}=t.sdkOptions,u=hn(a).global_config_id,l=n.paths.filter(T=>T&&T.poolAddress),d=Number(l.reduce((T,R)=>T.add(R.amountIn),ie).toString()),h=Number(l.reduce((T,R)=>T.add(R.amountOut),ie).toString()),g=Math.round(i?Number(h.toString())*(1-n.priceSlippagePoint):Number(d.toString())*(1+n.priceSlippagePoint)),b=n.paths[0].coinType[0],v=n.paths[0].coinType[n.paths[0].coinType.length-1];let x=o.targetCoin,P;s.isMintZeroCoin||s.originalSplitedCoin!==void 0?P=s.targetCoin:P=ee.callMintZeroValueCoin(r,v);const E=n.partner==="",S=E?Xr:wl;for(const T of l)if(T.poolAddress.length===1){const R=T.a2b[0],K={amount:Number(T.amountIn.toString()),amountLimit:g,poolCoinA:T.a2b[0]?b:v,poolCoinB:T.a2b[0]?v:b},V=E?"swap":"swap_with_partner",W=R?x:P,tt=R?P:x,j=i?T.amountIn.toString():T.amountOut.toString(),$=No.getDefaultSqrtPriceLimit(R).toString(),q=E?[r.object(u),r.object(T.poolAddress[0]),W,tt,r.pure(R),r.pure(i),r.pure(j),r.pure($),r.pure(!1),r.object(bn)]:[r.object(u),r.object(T.poolAddress[0]),r.pure(n.partner),W,tt,r.pure(R),r.pure(i),r.pure(j),r.pure($),r.pure(!1),r.object(bn)],A=[K.poolCoinA,K.poolCoinB],f=r.moveCall({target:`${t.sdkOptions.integrate.published_at}::${S}::${V}`,typeArguments:A,arguments:q});x=R?f[0]:f[1],P=R?f[1]:f[0]}else{const R=i?T.amountIn:T.rawAmountLimit[0],K=i?0:T.amountOut;let V="";T.a2b[0]?T.a2b[1]?V="swap_ab_bc":V="swap_ab_cb":T.a2b[1]?V="swap_ba_bc":V="swap_ba_cb",E||(V=`${V}_with_partner`);const W=No.getDefaultSqrtPriceLimit(T.a2b[0]),tt=No.getDefaultSqrtPriceLimit(T.a2b[1]),j=E?[r.object(u),r.object(T.poolAddress[0]),r.object(T.poolAddress[1]),x,P,r.pure(i),r.pure(R.toString()),r.pure(K.toString()),r.pure(W.toString()),r.pure(tt.toString()),r.object(bn)]:[r.object(u),r.object(T.poolAddress[0]),r.object(T.poolAddress[1]),r.pure(n.partner),x,P,r.pure(i),r.pure(R.toString()),r.pure(K.toString()),r.pure(W.toString()),r.pure(tt.toString()),r.object(bn)],$=[T.coinType[0],T.coinType[1],T.coinType[2]],q=r.moveCall({target:`${c.published_at}::${S}::${V}`,typeArguments:$,arguments:j});x=q[0],P=q[1]}return this.checkCoinThreshold(t,i,r,P,g,v),{fromCoin:x,toCoin:P,tx:r}}static async buildAggregatorSwapReturnCoins(t,n,i,o,s,r,a,c){if(c==null){if(t.senderAddress.length===0)throw Error("recipient and this config sdk senderAddress all not set");c=t.senderAddress}n.splitPaths.length>1&&(s="");let u,l;const d=n.splitPaths.some(h=>h.basePaths.some(g=>g.label==="Deepbook"));if((!n.byAmountIn||n.splitPaths.length===1)&&!d){const h=[];for(const v of n.splitPaths){const x=[],P=[],E=[],S=[];for(let R=0;R<v.basePaths.length;R+=1){const K=v.basePaths[R];x.push(K.direction),P.push(K.poolAddress),E.push(new _(K.inputAmount.toString())),R===0?S.push(K.fromCoin,K.toCoin):S.push(K.toCoin)}const T={amountIn:new _(v.inputAmount.toString()),amountOut:new _(v.outputAmount.toString()),poolAddress:P,a2b:x,rawAmountLimit:E,isExceed:!1,coinType:S};h.push(T)}const g={paths:h,partner:s,priceSlippagePoint:r},b=await this.buildRouterBasePathReturnCoins(t,g,n.byAmountIn,i,o,a);u=b.fromCoin,l=b.toCoin,a=b.tx}else{const h=Math.round(n.outputAmount*(1-r));u=i.targetCoin,o.isMintZeroCoin||o.originalSplitedCoin!==void 0?l=o.targetCoin:l=ee.callMintZeroValueCoin(a,n.toCoin);let g=!1,b;if(d){const[v,x]=Cf.createAccountCap(c,t.sdkOptions,a);a=x,b=v,g=!0}for(let v=0;v<n.splitPaths.length;v+=1){const x=n.splitPaths[v];let P;for(let E=0;E<x.basePaths.length;E+=1){const S=x.basePaths[E];if(S.label==="Deepbook")if(E===0)if(x.basePaths.length===1){const T=this.buildDeepbookBasePathTx(t,S,a,b,u,l,!1);u=T.from,l=T.to}else{P=ee.callMintZeroValueCoin(a,S.toCoin);const T=this.buildDeepbookBasePathTx(t,S,a,b,u,P,!1);u=T.from,P=T.to}else{const T=this.buildDeepbookBasePathTx(t,S,a,b,P,l,!0);P=T.from,l=T.to}if(S.label==="Cetus")if(E===0)if(x.basePaths.length===1){const T=this.buildClmmBasePathTx(t,S,a,n.byAmountIn,u,l,!1,s);u=T.from,l=T.to}else{P=ee.callMintZeroValueCoin(a,S.toCoin);const T=this.buildClmmBasePathTx(t,S,a,n.byAmountIn,u,P,!1,s);u=T.from,P=T.to}else{const T=this.buildClmmBasePathTx(t,S,a,n.byAmountIn,P,l,!0,s);P=T.from,l=T.to,a.moveCall({target:`${t.sdkOptions.integrate.published_at}::${Af}::send_coin`,typeArguments:[S.fromCoin],arguments:[P,a.pure(c)]})}}}this.checkCoinThreshold(t,n.byAmountIn,a,l,h,n.toCoin),g&&(a=Cf.deleteAccountCapByObject(b,t.sdkOptions,a))}return{fromCoin:u,toCoin:l,tx:a}}static async buildAggregatorSwapTransaction(t,n,i,o,s,r){let a=new _t;const c=n.byAmountIn?Math.round(n.outputAmount*(1-s)):Math.round(n.inputAmount*(1+s)),u=ee.buildCoinForAmount(a,i,n.byAmountIn?BigInt(n.inputAmount):BigInt(c),n.fromCoin,!1,!0),l=u.originalSplitedCoin!=null,d=ee.buildCoinForAmount(a,i,0n,n.toCoin,!1),h=await this.buildAggregatorSwapReturnCoins(t,n,u,d,o,s,a,r),{fromCoin:g,toCoin:b}=h;a=h.tx;const v=[];if(d.isMintZeroCoin?v.push({coinType:n.toCoin,coin:b}):d.originalSplitedCoin!=null?a.mergeCoins(d.originalSplitedCoin,[b]):a.mergeCoins(d.targetCoin,[b]),l){const x=u.originalSplitedCoin;a.mergeCoins(x,[g])}else v.push({coinType:n.fromCoin,coin:g});for(let x=0;x<v.length;x++)this.buildTransferCoin(t,a,v[x].coin,v[x].coinType,r);return a}static checkCoinThreshold(t,n,i,o,s,r){n&&i.moveCall({target:`${t.sdkOptions.integrate.published_at}::${Xr}::check_coin_threshold`,typeArguments:[r],arguments:[o,i.pure(s)]})}static buildDeepbookBasePathTx(t,n,i,o,s,r,a){const c=n.direction?s:r,u=n.direction?r:s,l=[i.object(n.poolAddress),o,i.pure(n.inputAmount),i.pure(0),i.pure(n.direction),c,u,i.pure(a),i.object(bn)],d=n.direction?[n.fromCoin,n.toCoin]:[n.toCoin,n.fromCoin],h=i.moveCall({target:`${t.sdkOptions.deepbook_endpoint_v2.published_at}::endpoints_v2::swap`,typeArguments:d,arguments:l});return s=n.direction?h[0]:h[1],r=n.direction?h[1]:h[0],{from:s,to:r,tx:i}}static buildClmmBasePathTx(t,n,i,o,s,r,a,c){const{clmm_pool:u,integrate:l}=t.sdkOptions,d=hn(u).global_config_id;let h=n.direction?s:r,g=n.direction?r:s;const b=c==="",v=b?Xr:wl,x=b?"swap":"swap_with_partner",P=o?n.inputAmount.toString():n.outputAmount.toString(),E=No.getDefaultSqrtPriceLimit(n.direction),S=b?[i.object(d),i.object(n.poolAddress),h,g,i.pure(n.direction),i.pure(o),i.pure(P),i.pure(E.toString()),i.pure(a),i.object(bn)]:[i.object(d),i.object(n.poolAddress),i.pure(c),h,g,i.pure(n.direction),i.pure(o),i.pure(P),i.pure(E.toString()),i.pure(a),i.object(bn)],T=n.direction?[n.fromCoin,n.toCoin]:[n.toCoin,n.fromCoin],R=i.moveCall({target:`${l.published_at}::${v}::${x}`,typeArguments:T,arguments:S});return h=R[0],g=R[1],s=n.direction?h:g,r=n.direction?g:h,{from:s,to:r,tx:i}}static buildCoinTypePair(t,n){const i=[];if(t.length===2){const o=[];o.push(t[0],t[1]),i.push(o)}else{const o=[];o.push(t[0],t[t.length-1]),i.push(o);for(let s=1;s<t.length-1;s+=1){if(n[s-1]===0)continue;const r=[];r.push(t[0],t[s],t[t.length-1]),i.push(r)}}return i}static buildTransferCoinToSender(t,n,i,o){n.moveCall({target:`${t.sdkOptions.integrate.published_at}::${Af}::transfer_coin_to_sender`,typeArguments:[o],arguments:[i]})}static buildTransferCoin(t,n,i,o,s){s!=null?n.transferObjects([i],n.pure(s)):ee.buildTransferCoinToSender(t,n,i,o)}},$n=ee;z2($n,"callMintZeroValueCoin",(e,t)=>e.moveCall({target:"0x2::coin::zero",typeArguments:[t]}));function si(e){return!(!e.startsWith("0x")||e.length!==66)}var Us=new _(1e9),Cf=class{static createAccountCap(t,n,i,o=!1){if(t.length===0)throw Error("this config sdk senderAddress is empty");const{deepbook:s}=n,[r]=i.moveCall({target:`${s.published_at}::${X2}::create_account`,typeArguments:[],arguments:[]});return o&&i.transferObjects([r],i.pure(t)),[r,i]}static deleteAccountCap(t,n,i){const{deepbook:o}=n,s=[i.pure(t)];return i.moveCall({target:`${o.published_at}::${bl}::delete_account_cap`,typeArguments:[],arguments:s}),i}static deleteAccountCapByObject(t,n,i){const{deepbook:o}=n,s=[t];return i.moveCall({target:`${o.published_at}::${bl}::delete_account_cap`,typeArguments:[],arguments:s}),i}static async getAccountCap(t){const n=await t.fullClient.getOwnedObjectsByPage(t.senderAddress,{options:{showType:!0,showContent:!0,showDisplay:!0,showOwner:!0},filter:{MoveModule:{package:t.sdkOptions.deepbook.package_id,module:bl}}});return n.data.length===0?"":n.data[0].data.objectId}static async getPools(t){const n=t.sdkOptions.deepbook.package_id,i=[];try{(await t.fullClient.queryEventsByPage({MoveEventType:`${n}::clob_v2::PoolCreated`})).data.forEach(s=>{const r=s.parsedJson;r&&i.push({poolID:r.pool_id,tickSize:Number(r.tick_size),lotSize:Number(r.lot_size),takerFeeRate:Number(r.taker_fee_rate),makerRebateRate:Number(r.maker_rebate_rate),baseAsset:r.base_asset.name,quoteAsset:r.quote_asset.name})})}catch(o){console.log("getPoolImmutables",o)}return i}static async getPoolAsks(t,n,i,o){var g;const{simulationAccount:s}=t.sdkOptions,{deepbook_endpoint_v2:r}=t.sdkOptions,a=new _t,c=[],u=[i,o],l=[a.pure(n),a.pure("0"),a.pure("999999999999"),a.pure(bn)];a.moveCall({target:`${r.published_at}::endpoints_v2::get_level2_book_status_ask_side`,arguments:l,typeArguments:u});const h=(g=(await t.fullClient.devInspectTransactionBlock({transactionBlock:a,sender:s.address})).events)==null?void 0:g.filter(b=>ge(b.type).name==="BookStatus");if(h.length===0)return c;for(let b=0;b<h[0].parsedJson.depths.length;b++){const v=h[0].parsedJson.price[b],x=h[0].parsedJson.depths[b],P={price:parseInt(v,10),quantity:parseInt(x,10)};c.push(P)}return c}static async getPoolBids(t,n,i,o){var g;const{simulationAccount:s}=t.sdkOptions,{deepbook_endpoint_v2:r}=t.sdkOptions,a=new _t,c=[],u=[i,o],l=[a.pure(n),a.pure("0"),a.pure("999999999999"),a.pure(bn)];a.moveCall({target:`${r.published_at}::endpoints_v2::get_level2_book_status_bid_side`,arguments:l,typeArguments:u});const h=(g=(await t.fullClient.devInspectTransactionBlock({transactionBlock:a,sender:s.address})).events)==null?void 0:g.filter(b=>ge(b.type).name==="BookStatus");if(h.length===0)return c;for(let b=0;b<h[0].parsedJson.depths.length;b++){const v=h[0].parsedJson.price[b],x=h[0].parsedJson.depths[b],P={price:parseInt(v,10),quantity:parseInt(x,10)};c.push(P)}return c}static async preSwap(t,n,i,o){let s=!1,r=ie,a=new _(o),c=ie;const u=new _(o);if(i){let l=await this.getPoolBids(t,n.poolID,n.baseAsset,n.quoteAsset);l===null&&(s=!0),l=l.sort((d,h)=>h.price-d.price);for(let d=0;d<l.length;d+=1){const h=new _(l[d].quantity),g=new _(l[d].price),b=h.mul(new _(g)).mul(new _(n.takerFeeRate)).div(Us).div(Us);if(a.gt(h))a=a.sub(h),r=r.add(h.mul(g).div(Us).sub(b)),c=c.add(b);else{const v=a.mul(new _(l[d].price)).div(Us),x=v.mul(new _(n.takerFeeRate)).div(Us);r=r.add(v.sub(x)),a=a.sub(a),c=c.add(x)}if(a.eq(ie))break}}else{const l=await this.getPoolAsks(t,n.poolID,n.baseAsset,n.quoteAsset);l===null&&(s=!0);for(let d=0;d<l.length;d+=1){const h=new _(l[d].price).mul(new _(l[d].quantity)).div(new _(1e9)),g=h.mul(new _(n.takerFeeRate)).div(Us),b=h.add(g);if(a.gt(h))r=r.add(new _(l[d].quantity)),a=a.sub(b),c=c.add(g);else{const v=new _(l[d].quantity).div(new _(n.lotSize)),x=b.div(v),P=a.div(x);r=r.add(P.muln(n.lotSize)),a=a.sub(P.mul(x)),c=c.add(P.div(v).mul(g))}if(a.eq(ie))break}}return{poolAddress:n.poolID,estimatedAmountIn:u.sub(a).toNumber(),estimatedAmountOut:r.toNumber(),estimatedFeeAmount:c,isExceed:s,amount:Number(o),aToB:i,byAmountIn:!0}}static async simulateSwap(t,n,i,o,s,r){var K;const{deepbook_endpoint_v2:a}=t.sdkOptions;let c=new _t;const u=await this.getAccountCap(t);let l;if(u===""){const V=this.createAccountCap(t.senderAddress,t.sdkOptions,c),W=V[0];c=V[1],l=W}else l=c.pure(u);const d=await t.getOwnerCoinAssets(t.senderAddress),h=$n.buildCoinForAmount(c,d,BigInt(r),i,!1),g=h==null?void 0:h.targetCoin,b=$n.buildCoinForAmount(c,d,BigInt(r),o,!1),v=b==null?void 0:b.targetCoin,x=[i,o],P=[c.pure(n),l,c.pure(r),c.pure(0),c.pure(s),g,v,c.pure(bn)];c.moveCall({target:`${a.published_at}::${V2}::swap`,arguments:P,typeArguments:x});const{simulationAccount:E}=t.sdkOptions,T=(K=(await t.fullClient.devInspectTransactionBlock({transactionBlock:c,sender:E.address})).events)==null?void 0:K.filter(V=>ge(V.type).name==="DeepbookSwapEvent");if(T.length===0)return null;const R=T[0].parsedJson;return{poolAddress:R.pool,estimatedAmountIn:R.amount_in,estimatedAmountOut:R.amount_out,aToB:R.atob}}},Uk=class{constructor(e){qt(this,"_sdk");qt(this,"_cache",{});this._sdk=e}get sdk(){return this._sdk}async getPositionList(e,t="all"){const n={data:[],hasNextPage:!0},i=await this._sdk.fullClient.getDynamicFieldsByPage(e,t);n.hasNextPage=i.hasNextPage,n.nextCursor=i.nextCursor;const o=i.data.map(r=>{var a,c;if(r.error!=null||((c=(a=r.data)==null?void 0:a.content)==null?void 0:c.dataType)!=="moveObject")throw new Mt(`when getPositionList get position objects error: ${r.error}, please check the rpc, contracts address config and position id.`,"InvalidConfig");return r.name.value}),s=await this._sdk.Position.getSipmlePositionList(o);return n.data=s,n}async getPoolImmutables(e=[],t=0,n=100,i=!1){const{package_id:o}=this._sdk.sdkOptions.clmm_pool,s=`${o}_getInitPoolEvent`,r=this.getCache(s,i),a=[],c=[];if(r!==void 0&&a.push(...r),a.length===0)try{(await this._sdk.fullClient.queryEventsByPage({MoveEventType:`${o}::factory::CreatePoolEvent`})).data.forEach(d=>{const h=d.parsedJson;h&&a.push({poolAddress:h.pool_id,tickSpacing:h.tick_spacing,coinTypeA:ge(h.coin_type_a).full_address,coinTypeB:ge(h.coin_type_b).full_address})}),this.updateCache(s,a,vn)}catch(l){console.log("getPoolImmutables",l)}const u=e.length>0;for(let l=0;l<a.length;l+=1){const d=a[l];u&&!e.includes(d.poolAddress)||!u&&(l<t||l>=t+n)||c.push(d)}return c}async getPools(e=[],t=0,n=100){var r,a,c;const i=[];let o=[];e.length>0?o=[...e]:(await this.getPoolImmutables([],t,n,!1)).forEach(l=>o.push(l.poolAddress));const s=await this._sdk.fullClient.batchGetObjects(o,{showContent:!0,showType:!0});for(const u of s){if(u.error!=null||((a=(r=u.data)==null?void 0:r.content)==null?void 0:a.dataType)!=="moveObject")throw new Mt(`getPools error code: ${((c=u.error)==null?void 0:c.code)??"unknown error"}, please check config and object ids`,"InvalidPoolObject");const l=vl(u);i.push(l);const d=`${l.poolAddress}_getPoolObject`;this.updateCache(d,l,vn)}return i}async getPoolImmutablesWithPage(e="all",t=!1){const{package_id:n}=this._sdk.sdkOptions.clmm_pool,i=[],o={data:[],hasNextPage:!1},s=e==="all",r=`${n}_getPoolImmutables`;if(s){const a=this.getCache(r,t);a&&i.push(...a)}if(i.length===0)try{const a=`${n}::factory::CreatePoolEvent`,c=await this._sdk.fullClient.queryEventsByPage({MoveEventType:a},e);o.hasNextPage=c.hasNextPage,o.nextCursor=c.nextCursor,c.data.forEach(u=>{const l=u.parsedJson;if(l){const d={poolAddress:l.pool_id,tickSpacing:l.tick_spacing,coinTypeA:ge(l.coin_type_a).full_address,coinTypeB:ge(l.coin_type_b).full_address};i.push(d)}})}catch(a){console.log("getPoolImmutables",a)}return o.data=i,s&&this.updateCache(`${n}_getPoolImmutables`,i,vn),o}async getPoolsWithPage(e=[]){var o,s,r;const t=[];let n=[];e.length>0?n=[...e]:(await this.getPoolImmutablesWithPage()).data.forEach(c=>n.push(c.poolAddress));const i=await this._sdk.fullClient.batchGetObjects(n,{showContent:!0,showType:!0});for(const a of i){if(a.error!=null||((s=(o=a.data)==null?void 0:o.content)==null?void 0:s.dataType)!=="moveObject")throw new Mt(`getPoolWithPages error code: ${((r=a.error)==null?void 0:r.code)??"unknown error"}, please check config and object ids`,"InvalidPoolObject");const c=vl(a);t.push(c);const u=`${c.poolAddress}_getPoolObject`;this.updateCache(u,c,vn)}return t}async getPool(e,t=!0){var r,a,c;const n=`${e}_getPoolObject`,i=this.getCache(n,t);if(i!==void 0)return i;const o=await this._sdk.fullClient.getObject({id:e,options:{showType:!0,showContent:!0}});if(o.error!=null||((a=(r=o.data)==null?void 0:r.content)==null?void 0:a.dataType)!=="moveObject")throw new Mt(`getPool error code: ${((c=o.error)==null?void 0:c.code)??"unknown error"}, please check config and object id`,"InvalidPoolObject");const s=vl(o);return this.updateCache(n,s),s}async creatPoolsTransactionPayload(e){for(const n of e)if(Ql(ri(n.coinTypeA),ri(n.coinTypeB))){const i=n.coinTypeB;n.coinTypeB=n.coinTypeA,n.coinTypeA=i}return await this.creatPool(e)}async creatPoolTransactionPayload(e){if(Ql(ri(e.coinTypeA),ri(e.coinTypeB))){const t=e.coinTypeB;e.coinTypeB=e.coinTypeA,e.coinTypeA=t}return"fix_amount_a"in e?await this.creatPoolAndAddLiquidity(e):await this.creatPool([e])}async getClmmConfigs(e=!1){const{package_id:t}=this._sdk.sdkOptions.clmm_pool,n=`${t}_getInitEvent`,i=this.getCache(n,e);if(i!==void 0)return i;const o=await this._sdk.fullClient.getObject({id:t,options:{showPreviousTransaction:!0}}),s=ih(o),r=(await this._sdk.fullClient.queryEventsByPage({Transaction:s})).data,a={pools_id:"",global_config_id:"",global_vault_id:"",admin_cap_id:""};return r.length>0&&(r.forEach(c=>{const u=c.parsedJson;if(c.type)switch(ge(c.type).full_address){case`${t}::config::InitConfigEvent`:a.global_config_id=u.global_config_id,a.admin_cap_id=u.admin_cap_id;break;case`${t}::factory::InitFactoryEvent`:a.pools_id=u.pools_id;break;case`${t}::rewarder::RewarderInitEvent`:a.global_vault_id=u.global_vault_id;break;case`${t}::partner::InitPartnerEvent`:a.partners_id=u.partners_id;break}}),this.updateCache(n,a,vn)),a}async getSuiTransactionResponse(e,t=!1){const n=`${e}_getSuiTransactionResponse`,i=this.getCache(n,t);if(i!==void 0)return i;let o;try{o=await this._sdk.fullClient.getTransactionBlock({digest:e,options:{showEvents:!0,showEffects:!0,showBalanceChanges:!0,showInput:!0,showObjectChanges:!0}})}catch{o=await this._sdk.fullClient.getTransactionBlock({digest:e,options:{showEvents:!0,showEffects:!0}})}return this.updateCache(n,o,vn),o}async creatPool(e){const t=new _t,{integrate:n,clmm_pool:i}=this.sdk.sdkOptions,o=hn(i),s=o.global_config_id,r=o.pools_id;return e.forEach(a=>{const c=[t.object(s),t.object(r),t.pure(a.tick_spacing.toString()),t.pure(a.initialize_sqrt_price),t.pure(a.uri),t.object(bn)];t.moveCall({target:`${n.published_at}::${gc}::create_pool`,typeArguments:[a.coinTypeA,a.coinTypeB],arguments:c})}),t}async creatPoolAndAddLiquidity(e){if(!si(this._sdk.senderAddress))throw new Mt("this config sdk senderAddress is not set right","InvalidSendAddress");const t=new _t,{integrate:n,clmm_pool:i}=this.sdk.sdkOptions,o=hn(i),s=o.global_config_id,r=o.pools_id,a=await this._sdk.getOwnerCoinAssets(this._sdk.senderAddress),c=$n.buildAddLiquidityFixTokenCoinInput(t,!e.fix_amount_a,e.amount_a,e.slippage,e.coinTypeA,a,!1),u=$n.buildAddLiquidityFixTokenCoinInput(t,e.fix_amount_a,e.amount_b,e.slippage,e.coinTypeB,a,!1),l=[t.pure(s),t.pure(r),t.pure(e.tick_spacing.toString()),t.pure(e.initialize_sqrt_price),t.pure(e.uri),c.targetCoin,u.targetCoin,t.pure(ji(BigInt(e.tick_lower)).toString()),t.pure(ji(BigInt(e.tick_upper)).toString()),t.pure(e.amount_a),t.pure(e.amount_b),t.pure(e.fix_amount_a),t.pure(bn)];return t.moveCall({target:`${n.published_at}::${ls}::create_pool_with_liquidity`,typeArguments:[e.coinTypeA,e.coinTypeB],arguments:l}),t}async fetchTicks(e){let t=[],n=[];for(;;){const o=await this.getTicks({pool_id:e.pool_id,coinTypeA:e.coinTypeA,coinTypeB:e.coinTypeB,start:n,limit:512});if(t=[...t,...o],o.length<512)break;n=[o[o.length-1].index]}return t}async getTicks(e){var c;const{integrate:t,simulationAccount:n}=this.sdk.sdkOptions,i=[],o=[e.coinTypeA,e.coinTypeB],s=new _t,r=[s.pure(e.pool_id),s.pure(e.start),s.pure(e.limit.toString())];if(s.moveCall({target:`${t.published_at}::${_s}::fetch_ticks`,arguments:r,typeArguments:o}),!si(n.address))throw new Mt("this config simulationAccount is not set right","InvalidSimulateAccount");const a=await this.sdk.fullClient.devInspectTransactionBlock({transactionBlock:s,sender:n.address});if(a.error!=null)throw new Mt(`getTicks error code: ${a.error??"unknown error"}, please check config and tick object ids`,"InvalidTickObjectId");return(c=a.events)==null||c.forEach(u=>{ge(u.type).name==="FetchTicksResultEvent"&&u.parsedJson.ticks.forEach(l=>{i.push(Ok(l))})}),i}async fetchPositionRewardList(e){var r;const{integrate:t,simulationAccount:n}=this.sdk.sdkOptions,i=[];let o=[];const s=512;for(;;){const a=[e.coinTypeA,e.coinTypeB],c=new _t,u=[c.object(e.pool_id),c.pure(o,"u64"),c.pure(s.toString(),"u64")];if(c.moveCall({target:`${t.published_at}::${_s}::fetch_positions`,arguments:u,typeArguments:a}),!si(n.address))throw new Mt("this config simulationAccount is not set right","InvalidSimulateAccount");const l=await this.sdk.fullClient.devInspectTransactionBlock({transactionBlock:c,sender:n.address});if(l.error!=null)throw new Mt(`fetch position reward error code: ${l.error??"unknown error"}, please check config and tick object ids`,"InvalidPositionRewardObject");const d=[];if((r=l==null?void 0:l.events)==null||r.forEach(h=>{ge(h.type).name==="FetchPositionsEvent"&&h.parsedJson.positions.forEach(g=>{const b=hm(g);d.push(b)})}),i.push(...d),d.length<s)break;o=[d[d.length-1].pos_object_id]}return i}async fetchTicksByRpc(e){let t=[],n=null;const i=512;for(;;){const o=[],s=await this.sdk.fullClient.getDynamicFields({parentId:e,cursor:n,limit:i});if(n=s.nextCursor,s.data.forEach(r=>{ge(r.objectType).module==="skip_list"&&o.push(r.objectId)}),t=[...t,...await this.getTicksByRpc(o)],n===null||s.data.length<i)break}return t}async getTicksByRpc(e){var i,o,s;const t=[],n=await this.sdk.fullClient.batchGetObjects(e,{showContent:!0,showType:!0});for(const r of n){if(r.error!=null||((o=(i=r.data)==null?void 0:i.content)==null?void 0:o.dataType)!=="moveObject")throw new Mt(`getTicksByRpc error code: ${((s=r.error)==null?void 0:s.code)??"unknown error"}, please check config and tick object ids`,"InvalidTickObjectId");const a=Tl(r);a!=null&&t.push(a)}return t}async getTickDataByIndex(e,t){var o,s;const n={type:"u64",value:ji(BigInt(sk(t).toString())).toString()},i=await this.sdk.fullClient.getDynamicFieldObject({parentId:e,name:n});if(i.error!=null||((s=(o=i.data)==null?void 0:o.content)==null?void 0:s.dataType)!=="moveObject")throw new Mt(`get tick by index: ${t} error: ${i.error}`,"InvalidTickIndex");return Tl(i)}async getTickDataByObjectId(e){var n,i,o;const t=await this.sdk.fullClient.getObject({id:e,options:{showContent:!0}});if(t.error!=null||((i=(n=t.data)==null?void 0:n.content)==null?void 0:i.dataType)!=="moveObject")throw new Mt(`getTicksByRpc error code: ${((o=t.error)==null?void 0:o.code)??"unknown error"}, please check config and tick object ids`,"InvalidTickObjectId");return Tl(t)}async getPartnerRefFeeAmount(e){var a,c;const t=await this._sdk.fullClient.batchGetObjects([e],{showOwner:!0,showContent:!0,showDisplay:!0,showType:!0});if(t[0].error!=null||((c=(a=t[0].data)==null?void 0:a.content)==null?void 0:c.dataType)!=="moveObject")throw new Mt(`get partner by object id: ${e} error: ${t[0].error}`,"NotFoundPartnerObject");const n=t[0].data.content.fields.balances,i=await this._sdk.fullClient.getDynamicFieldsByPage(n.fields.id.id),o=[];i.data.forEach(u=>{var l,d;if(u.error!=null||((d=(l=u.data)==null?void 0:l.content)==null?void 0:d.dataType)!=="moveObject")throw new Mt(`when getPartnerRefFeeAmount get partner object error: ${u.error}, please check the rpc, contracts address config and position id.`,"InvalidConfig");o.push(u.objectId)});const s=[];return(await this._sdk.fullClient.batchGetObjects(o,{showOwner:!0,showContent:!0,showDisplay:!0,showType:!0})).forEach(u=>{var d,h;if(u.error!=null||((h=(d=u.data)==null?void 0:d.content)==null?void 0:h.dataType)!=="moveObject")throw new Mt(`get coin by object id: ${u.data.objectId} error: ${u.error}`,"InvalidParnterRefFeeFields");const l={coinAddress:u.data.content.fields.name,coinObjectId:u.data.objectId,balance:BigInt(u.data.content.fields.value)};s.push(l)}),s}async claimPartnerRefFeePayload(e,t,n){const i=new _t,{clmm_pool:o}=this.sdk.sdkOptions,{global_config_id:s}=hn(o),r=[n],a=[i.object(s),i.object(e),i.object(t)];return i.moveCall({target:`${o.published_at}::${G2}::claim_ref_fee`,arguments:a,typeArguments:r}),i}updateCache(e,t,n=Hu){let i=this._cache[e];i?(i.overdueTime=so(n),i.value=t):i=new Ra(t,so(n)),this._cache[e]=i}getCache(e,t=!1){const n=this._cache[e],i=n==null?void 0:n.isValid();if(!t&&i)return n.value;i||delete this._cache[e]}},qk=class{constructor(e){qt(this,"_sdk");qt(this,"_cache",{});this._sdk=e}get sdk(){return this._sdk}buildPositionType(){return`${this._sdk.sdkOptions.clmm_pool.package_id}::position::Position`}async getPositionList(e,t=[]){const n=[],i=await this._sdk.fullClient.getOwnedObjectsByPage(e,{options:{showType:!0,showContent:!0,showDisplay:!0,showOwner:!0},filter:{Package:this._sdk.sdkOptions.clmm_pool.package_id}}),o=t.length>0;for(const s of i.data)if(ge(s.data.type).full_address===this.buildPositionType()){const a=_c(s),c=`${a.pos_object_id}_getPositionList`;this.updateCache(c,a,vn),o?t.includes(a.pool)&&n.push(a):n.push(a)}return n}async getPosition(e,t,n=!0){let i=await this.getSimplePosition(t);return n&&(i=await this.updatePositionRewarders(e,i)),i}async getPositionById(e,t=!0){const n=await this.getSimplePosition(e);if(t){const i=await this._sdk.Pool.getPool(n.pool,!1);return await this.updatePositionRewarders(i.position_manager.positions_handle,n)}return n}async getSimplePosition(e){const t=`${e}_getPositionList`;let n=this.getSimplePositionByCache(e);if(n===void 0){const i=await this.sdk.fullClient.getObject({id:e,options:{showContent:!0,showType:!0,showDisplay:!0,showOwner:!0}});n=_c(i),this.updateCache(t,n,vn)}return n}getSimplePositionByCache(e){const t=`${e}_getPositionList`;return this.getCache(t)}async getSipmlePositionList(e){const t=[],n=[];return e.forEach(i=>{const o=this.getSimplePositionByCache(i);o?t.push(o):n.push(i)}),n.length>0&&(await this._sdk.fullClient.batchGetObjects(n,{showOwner:!0,showContent:!0,showDisplay:!0,showType:!0})).forEach(o=>{const s=_c(o);t.push(s);const r=`${s.pos_object_id}_getPositionList`;this.updateCache(r,s,vn)}),t}async updatePositionRewarders(e,t){const n=await this.getPositionRewarders(e,t.pos_object_id);return{...t,...n}}async getPositionRewarders(e,t){try{const n=await this._sdk.fullClient.getDynamicFieldObject({parentId:e,name:{type:"0x2::object::ID",value:t}}),o=zo(n.data).value.fields.value;return hm(o)}catch(n){console.log(n);return}}async fetchPosFeeAmount(e){var c;const{clmm_pool:t,integrate:n,simulationAccount:i}=this.sdk.sdkOptions,o=new _t;for(const u of e){const l=[u.coinTypeA,u.coinTypeB],d=[o.object(hn(t).global_config_id),o.object(u.poolAddress),o.pure(u.positionId)];o.moveCall({target:`${n.published_at}::${_s}::fetch_position_fees`,arguments:d,typeArguments:l})}if(!si(i.address))throw new Mt("this config simulationAccount is not set right","InvalidSimulateAccount");const s=await this.sdk.fullClient.devInspectTransactionBlock({transactionBlock:o,sender:i.address});if(s.error!=null)throw new Mt(`fetch position fee error code: ${s.error??"unknown error"}, please check config and postion and pool object ids`,"InvalidPoolObject");const r=(c=s.events)==null?void 0:c.filter(u=>ge(u.type).name==="FetchPositionFeesEvent");if(r.length===0)return[];const a=[];for(let u=0;u<r.length;u+=1){const{parsedJson:l}=r[u],d={feeOwedA:new _(l.fee_owned_a),feeOwedB:new _(l.fee_owned_b),position_id:l.position_id};a.push(d)}return a}async batchFetchPositionFees(e){const t=[];for(const i of e){const o=await this._sdk.Position.getPositionById(i,!1),s=await this._sdk.Pool.getPool(o.pool,!1);t.push({poolAddress:s.poolAddress,positionId:o.pos_object_id,coinTypeA:s.coinTypeA,coinTypeB:s.coinTypeB})}const n={};if(t.length>0){const i=await this.fetchPosFeeAmount(t);for(const o of i)n[o.position_id]=o;return n}return n}async createAddLiquidityFixTokenPayload(e,t){if(!si(this._sdk.senderAddress))throw new Mt("this config sdk senderAddress is not set right","InvalidSendAddress");const n=await this._sdk.getOwnerCoinAssets(this._sdk.senderAddress);if(t){const{isAdjustCoinA:i,isAdjustCoinB:o}=$c(e);if(e=e,e.fix_amount_a&&i||!e.fix_amount_a&&o)return await $n.buildAddLiquidityFixTokenForGas(this._sdk,n,e,t)}return $n.buildAddLiquidityFixToken(this._sdk,n,e)}async createAddLiquidityPayload(e){const{integrate:t,clmm_pool:n}=this._sdk.sdkOptions;if(!si(this._sdk.senderAddress))throw new Mt("this config sdk senderAddress is not set right","InvalidSendAddress");const i=ji(BigInt(e.tick_lower)).toString(),o=ji(BigInt(e.tick_upper)).toString(),s=[e.coinTypeA,e.coinTypeB];let r=new _t;const a=!Im(e.pos_id),c=BigInt(e.max_amount_a),u=BigInt(e.max_amount_b),l=await this._sdk.getOwnerCoinAssets(this._sdk.senderAddress),d=$n.buildCoinForAmount(r,l,c,e.coinTypeA,!1),h=$n.buildCoinForAmount(r,l,u,e.coinTypeB,!1);return a?r.moveCall({target:`${t.published_at}::${ls}::open_position_with_liquidity`,typeArguments:s,arguments:[r.object(hn(n).global_config_id),r.object(e.pool_id),r.pure(i),r.pure(o),d.targetCoin,h.targetCoin,r.pure(e.max_amount_a),r.pure(e.max_amount_b),r.pure(e.delta_liquidity),r.object(bn)]}):(r=$n.createCollectRewarderAndFeeParams(this._sdk,r,e,l,d.remainCoins,h.remainCoins),r.moveCall({target:`${t.published_at}::${ls}::add_liquidity`,typeArguments:s,arguments:[r.object(hn(n).global_config_id),r.object(e.pool_id),r.object(e.pos_id),d.targetCoin,h.targetCoin,r.pure(e.max_amount_a),r.pure(e.max_amount_b),r.pure(e.delta_liquidity),r.object(bn)]})),r}async removeLiquidityTransactionPayload(e){if(!si(this._sdk.senderAddress))throw new Mt("this config sdk senderAddress is not set right","InvalidSendAddress");const{clmm_pool:t,integrate:n}=this.sdk.sdkOptions,i="remove_liquidity";let o=new _t;const s=[e.coinTypeA,e.coinTypeB],r=await this._sdk.getOwnerCoinAssets(this._sdk.senderAddress);o=$n.createCollectRewarderAndFeeParams(this._sdk,o,e,r);const a=[o.object(hn(t).global_config_id),o.object(e.pool_id),o.object(e.pos_id),o.pure(e.delta_liquidity),o.pure(e.min_amount_a),o.pure(e.min_amount_b),o.object(bn)];return o.moveCall({target:`${n.published_at}::${gc}::${i}`,typeArguments:s,arguments:a}),o}async closePositionTransactionPayload(e){if(!si(this._sdk.senderAddress))throw new Mt("this config sdk senderAddress is not set right","InvalidSendAddress");const{clmm_pool:t,integrate:n}=this.sdk.sdkOptions;let i=new _t;const o=[e.coinTypeA,e.coinTypeB],s=await this._sdk.getOwnerCoinAssets(this._sdk.senderAddress);return i=$n.createCollectRewarderAndFeeParams(this._sdk,i,e,s),i.moveCall({target:`${n.published_at}::${gc}::close_position`,typeArguments:o,arguments:[i.object(hn(t).global_config_id),i.object(e.pool_id),i.object(e.pos_id),i.pure(e.min_amount_a),i.pure(e.min_amount_b),i.object(bn)]}),i}openPositionTransactionPayload(e){const{clmm_pool:t,integrate:n}=this.sdk.sdkOptions,i=new _t,o=[e.coinTypeA,e.coinTypeB],s=ji(BigInt(e.tick_lower)).toString(),r=ji(BigInt(e.tick_upper)).toString(),a=[i.pure(hn(t).global_config_id),i.pure(e.pool_id),i.pure(s),i.pure(r)];return i.moveCall({target:`${n.published_at}::${gc}::open_position`,typeArguments:o,arguments:a}),i}async collectFeeTransactionPayload(e){if(!si(this._sdk.senderAddress))throw new Mt("this config sdk senderAddress is not set right","InvalidSendAddress");const t=await this._sdk.getOwnerCoinAssets(this._sdk.senderAddress,null,!0),n=new _t,i=$n.buildCoinForAmount(n,t,BigInt(0),e.coinTypeA,!1),o=$n.buildCoinForAmount(n,t,BigInt(0),e.coinTypeB,!1);return this.createCollectFeePaylod(e,n,i.targetCoin,o.targetCoin),n}createCollectFeePaylod(e,t,n,i){const{clmm_pool:o,integrate:s}=this.sdk.sdkOptions,r=[e.coinTypeA,e.coinTypeB],a=[t.object(hn(o).global_config_id),t.object(e.pool_id),t.object(e.pos_id),n,i];return t.moveCall({target:`${s.published_at}::${ls}::collect_fee`,typeArguments:r,arguments:a}),t}async calculateFee(e){const t=await this.collectFeeTransactionPayload(e);if(!si(this._sdk.senderAddress))throw new Mt("this config sdk senderAddress is not set right","InvalidSendAddress");const n=await this._sdk.fullClient.devInspectTransactionBlock({transactionBlock:t,sender:this._sdk.senderAddress});for(const i of n.events)if(ge(i.type).name==="CollectFeeEvent"){const o=i.parsedJson;return{feeOwedA:o.amount_a,feeOwedB:o.amount_b}}return{feeOwedA:"0",feeOwedB:"0"}}updateCache(e,t,n=Hu){let i=this._cache[e];i?(i.overdueTime=so(n),i.value=t):i=new Ra(t,so(n)),this._cache[e]=i}getCache(e,t=!1){const n=this._cache[e],i=n==null?void 0:n.isValid();if(!t&&i)return n.value;i||delete this._cache[e]}},Mk=class{constructor(e){qt(this,"_sdk");qt(this,"growthGlobal");this._sdk=e,this.growthGlobal=[ie,ie,ie]}get sdk(){return this._sdk}async emissionsEveryDay(e){const n=(await this.sdk.Pool.getPool(e)).rewarder_infos;if(!n)return null;const i=[];for(const o of n){const s=Ue.fromX64(new _(o.emissions_per_second));i.push({emissions:Math.floor(s.toNumber()*60*60*24),coin_address:o.coinAddress})}return i}async updatePoolRewarder(e,t){const n=await this.sdk.Pool.getPool(e),i=n.rewarder_last_updated_time;if(n.rewarder_last_updated_time=t.toString(),Number(n.liquidity)===0||t.eq(new _(i)))return n;const o=t.div(new _(1e3)).sub(new _(i)).add(new _(15)),s=n.rewarder_infos;for(let r=0;r<s.length;r+=1){const a=s[r],c=Ue.checkMulDivFloor(o,new _(a.emissions_per_second),new _(n.liquidity),128);this.growthGlobal[r]=new _(a.growth_global).add(new _(c))}return n}async posRewardersAmount(e,t,n){const i=Date.parse(new Date().toString()),o=await this.updatePoolRewarder(e,new _(i)),s=await this.sdk.Position.getPositionRewarders(t,n);if(s===void 0)return[];const r=o.ticks_handle,a=await this.sdk.Pool.getTickDataByIndex(r,s.tick_lower_index),c=await this.sdk.Pool.getTickDataByIndex(r,s.tick_upper_index);return this.posRewardersAmountInternal(o,s,a,c)}async poolRewardersAmount(e,t){const n=Date.parse(new Date().toString()),i=await this.updatePoolRewarder(t,new _(n)),o=await this.sdk.Position.getPositionList(e,[t]),s=await this.getPoolLowerAndUpperTicks(i.ticks_handle,o),r=[ie,ie,ie];for(let a=0;a<o.length;a+=1){const c=await this.posRewardersAmountInternal(i,o[a],s[0][a],s[1][a]);for(let u=0;u<3;u+=1)r[u]=r[u].add(c[u].amount_owed)}return r}posRewardersAmountInternal(e,t,n,i){const o=t.tick_lower_index,s=t.tick_upper_index,r=Rk(e,n,i,o,s,this.growthGlobal),a=[],c=[];if(r.length>0){let u=Ue.subUnderflowU128(r[0],new _(t.reward_growth_inside_0));u.gt(new _("3402823669209384634633745948738404"))&&(u=io);const l=Ue.checkMulShiftRight(new _(t.liquidity),u,64,128);a.push(r[0]),c.push({amount_owed:new _(t.reward_amount_owed_0).add(l),coin_address:e.rewarder_infos[0].coinAddress})}if(r.length>1){let u=Ue.subUnderflowU128(r[1],new _(t.reward_growth_inside_1));u.gt(new _("3402823669209384634633745948738404"))&&(u=io);const l=Ue.checkMulShiftRight(new _(t.liquidity),u,64,128);a.push(r[1]),c.push({amount_owed:new _(t.reward_amount_owed_1).add(l),coin_address:e.rewarder_infos[1].coinAddress})}if(r.length>2){let u=Ue.subUnderflowU128(r[2],new _(t.reward_growth_inside_2));u.gt(new _("3402823669209384634633745948738404"))&&(u=io);const l=Ue.checkMulShiftRight(new _(t.liquidity),u,64,128);a.push(r[2]),c.push({amount_owed:new _(t.reward_amount_owed_2).add(l),coin_address:e.rewarder_infos[2].coinAddress})}return c}async batchFetchPositionRewarders(e){const t=[];for(const i of e){const o=await this._sdk.Position.getPositionById(i,!1),s=await this._sdk.Pool.getPool(o.pool,!1);t.push({poolAddress:s.poolAddress,positionId:o.pos_object_id,coinTypeA:s.coinTypeA,coinTypeB:s.coinTypeB,rewarderInfo:s.rewarder_infos})}const n={};if(t.length>0){const i=await this.fetchPosRewardersAmount(t);for(const o of i)n[o.positionId]=o.rewarderAmountOwed;return n}return n}async fetchPositionRewarders(e,t){const n={poolAddress:e.poolAddress,positionId:t,coinTypeA:e.coinTypeA,coinTypeB:e.coinTypeB,rewarderInfo:e.rewarder_infos};return(await this.fetchPosRewardersAmount([n]))[0].rewarderAmountOwed}async batchFetchPositionFees(e){const t=[];for(const i of e){const o=await this._sdk.Position.getPositionById(i,!1),s=await this._sdk.Pool.getPool(o.pool,!1);t.push({poolAddress:s.poolAddress,positionId:o.pos_object_id,coinTypeA:s.coinTypeA,coinTypeB:s.coinTypeB})}const n={};if(t.length>0){const i=await this.fetchPosFeeAmount(t);for(const o of i)n[o.position_id]=o;return n}return n}async fetchPosFeeAmount(e){var c;const{clmm_pool:t,integrate:n,simulationAccount:i}=this.sdk.sdkOptions,o=new _t;for(const u of e){const l=[u.coinTypeA,u.coinTypeB],d=[o.object(hn(t).global_config_id),o.object(u.poolAddress),o.pure(u.positionId)];o.moveCall({target:`${n.published_at}::${_s}::fetch_position_fees`,arguments:d,typeArguments:l})}const r=(c=(await this.sdk.fullClient.devInspectTransactionBlock({transactionBlock:o,sender:i.address})).events)==null?void 0:c.filter(u=>ge(u.type).name==="FetchPositionFeesEvent");if(r.length===0)return[];const a=[];for(let u=0;u<r.length;u+=1){const{parsedJson:l}=r[u],d={feeOwedA:new _(l.fee_owned_a),feeOwedB:new _(l.fee_owned_b),position_id:l.position_id};a.push(d)}return a}async fetchPosRewardersAmount(e){var c;const{clmm_pool:t,integrate:n,simulationAccount:i}=this.sdk.sdkOptions,o=new _t;for(const u of e){const l=[u.coinTypeA,u.coinTypeB],d=[o.object(hn(t).global_config_id),o.object(u.poolAddress),o.pure(u.positionId),o.object(bn)];o.moveCall({target:`${n.published_at}::${_s}::fetch_position_rewards`,arguments:d,typeArguments:l})}if(!si(i.address))throw new Mt(`this config simulationAccount: ${i.address} is not set right`,"InvalidSimulateAccount");const s=await this.sdk.fullClient.devInspectTransactionBlock({transactionBlock:o,sender:i.address});if(s.error!=null)throw new Mt(`fetch position rewards error code: ${s.error??"unknown error"}, please check config and params`,"InvalidConfig");const r=(c=s.events)==null?void 0:c.filter(u=>ge(u.type).name==="FetchPositionRewardsEvent");if(r.length===0)return[];if(r.length!==e.length)throw new Mt("valueData.length !== params.pools.length");const a=[];for(let u=0;u<r.length;u+=1){const l={poolAddress:e[u].poolAddress,positionId:e[u].positionId,rewarderAmountOwed:[]};for(let d=0;d<e[u].rewarderInfo.length;d+=1)l.rewarderAmountOwed.push({amount_owed:new _(r[u].parsedJson.data[d]),coin_address:e[u].rewarderInfo[d].coinAddress});a.push(l)}return a}async fetchPoolRewardersAmount(e,t){const n=await this.sdk.Pool.getPool(t),i=await this.sdk.Position.getPositionList(e,[t]),o=[];for(const a of i)o.push({poolAddress:n.poolAddress,positionId:a.pos_object_id,rewarderInfo:n.rewarder_infos,coinTypeA:n.coinTypeA,coinTypeB:n.coinTypeB});const s=await this.fetchPosRewardersAmount(o),r=[ie,ie,ie];if(s!=null)for(const a of s)for(let c=0;c<a.rewarderAmountOwed.length;c+=1)r[c]=r[c].add(a.rewarderAmountOwed[c].amount_owed);return r}async getPoolLowerAndUpperTicks(e,t){const n=[],i=[];for(const o of t){const s=await this.sdk.Pool.getTickDataByIndex(e,o.tick_lower_index),r=await this.sdk.Pool.getTickDataByIndex(e,o.tick_upper_index);n.push(s),i.push(r)}return[n,i]}async collectRewarderTransactionPayload(e){if(!si(this._sdk.senderAddress))throw new Mt("this config sdk senderAddress is not set right","InvalidSendAddress");const t=await this._sdk.getOwnerCoinAssets(this._sdk.senderAddress,null);let n=new _t;return n=$n.createCollectRewarderAndFeeParams(this._sdk,n,e,t),n}createCollectRewarderPaylod(e,t,n){const{clmm_pool:i,integrate:o}=this.sdk.sdkOptions,s=hn(i),r=[e.coinTypeA,e.coinTypeB];return e.rewarder_coin_types.forEach((a,c)=>{t&&t.moveCall({target:`${o.published_at}::${ls}::collect_reward`,typeArguments:[...r,a],arguments:[t.object(s.global_config_id),t.object(e.pool_id),t.object(e.pos_id),t.object(s.global_vault_id),n[c],t.object(bn)]})}),t}};function Va(e,t){return{pair:`${e}-${t}`,reversePair:`${t}-${e}`}}var Dk=class{constructor(e){qt(this,"graph");qt(this,"pathProviders");qt(this,"coinProviders");qt(this,"_coinAddressMap");qt(this,"poolAddressMap");qt(this,"_sdk");this.pathProviders=[],this.coinProviders={coins:[]},this.graph=new H_(!1),this._coinAddressMap=new Map,this.poolAddressMap=new Map,this._sdk=e,this.getPoolAddressMapAndDirection=this.getPoolAddressMapAndDirection.bind(this),this.setCoinList=this.setCoinList.bind(this),this.loadGraph=this.loadGraph.bind(this),this.addCoinProvider=this.addCoinProvider.bind(this),this.addPathProvider=this.addPathProvider.bind(this),this.preRouterSwapA2B2C=this.preRouterSwapA2B2C.bind(this),this.price=this.price.bind(this),this.getPoolWithTVL=this.getPoolWithTVL.bind(this)}get sdk(){return this._sdk}getPoolAddressMapAndDirection(e,t){const{pair:n,reversePair:i}=Va(e,t);let o=this.poolAddressMap.get(n);if(o!=null)return{addressMap:o,direction:!0};if(o=this.poolAddressMap.get(i),o!=null)return{addressMap:o,direction:!1}}setCoinList(){this.coinProviders.coins.forEach(e=>{this._coinAddressMap.set(e.address,e)})}loadGraph(e,t){this.addCoinProvider(e),this.addPathProvider(t),this.setCoinList(),this.pathProviders.forEach(n=>{const{paths:i}=n;i.forEach(o=>{const s=this.graph.getVertexByKey(o.base)??new Cc(o.base),r=this.graph.getVertexByKey(o.quote)??new Cc(o.quote);this.graph.addEdge(new z_(s,r));const a=this._coinAddressMap.get(o.base),c=this._coinAddressMap.get(o.quote);if(a!=null&&c!=null){const u=Va(o.base,o.quote).pair;this.poolAddressMap.set(u,o.addressMap)}})})}addPathProvider(e){for(let t=0;t<e.paths.length;t+=1){const{base:n,quote:i}=e.paths[t];n.localeCompare(i)<0&&(e.paths[t].base=i,e.paths[t].quote=n),n==="0x2::sui::SUI"&&(e.paths[t].base=i,e.paths[t].quote=n),i==="0x2::sui::SUI"&&(e.paths[t].base=n,e.paths[t].quote=i)}return this.pathProviders.push(e),this}addCoinProvider(e){return this.coinProviders=e,this}tokenInfo(e){return this._coinAddressMap.get(e)}getFeeRate(e,t,n){const i=Va(e,t).pair,o=this.poolAddressMap.get(i);if(o!=null){for(const[a,c]of o.entries())if(c===n)return a*100}const s=Va(e,t).reversePair,r=this.poolAddressMap.get(s);if(r!=null){for(const[a,c]of r.entries())if(c===n)return a*100}return 0}async price(e,t,n,i,o,s,r){const a=this.tokenInfo(e),c=this.tokenInfo(t);if(a===void 0||c===void 0)throw new Mt("From/To coin is undefined","InvalidCoin");const u=this.graph.getVertexByKey(a.address),l=this.graph.getVertexByKey(c.address),d=this.graph.findAllPath(u,l),h=Array.from(d);if(h.length===0)throw new Mt("No find valid path in coin graph","NotFoundPath");let g=[];for(let j=0;j<h.length;j+=1){const $=h[j];if($.length>3)continue;const q=[],A=[],f=[],y=[];for(let k=0;k<$.length-1;k+=1){const U=$[k].value.toString(),D=$[k+1].value.toString(),z=this.getPoolAddressMapAndDirection(U,D),X=z==null?void 0:z.addressMap,I=z==null?void 0:z.direction;X!=null&&I!=null&&(A.push(I),q.push(U),q.push(D),X.forEach(m=>{k===0?f.push(m):y.push(m)}))}for(const k of f)if(y.length>0)for(const U of y){const D={stepNums:2,poolAB:k,poolBC:U,a2b:A[0],b2c:A[1],amount:n,byAmountIn:i,coinTypeA:q[0],coinTypeB:q[1],coinTypeC:q[3]};g.push(D)}else{const U={stepNums:1,poolAB:k,poolBC:void 0,a2b:A[0],b2c:void 0,amount:n,byAmountIn:i,coinTypeA:q[0],coinTypeB:q[1],coinTypeC:void 0};g.push(U)}}const b=g.filter(j=>j.stepNums===1),v=g.filter(j=>j.stepNums!==1);let x=[];try{x=await this.getPoolWithTVL()}catch{x=[]}if(x.length>0){const j=new Map(x.map($=>[$.poolAddress,$]));v.sort(($,q)=>{let A=0,f=0;if(j.has($.poolAB)&&j.has($.poolBC)){const y=j.get($.poolAB),k=j.get($.poolBC);A=Math.min(y.tvl,k.tvl)}if(j.has(q.poolAB)&&j.has(q.poolBC)){const y=j.get(q.poolAB),k=j.get(q.poolBC);f=Math.min(y.tvl,k.tvl)}return f-A})}if(g=[...b,...v],g.length===0){if(r!=null){const j=await this.sdk.Swap.preSwapWithMultiPool(r),$={amountIn:new _(j.estimatedAmountIn),amountOut:new _(j.estimatedAmountOut),poolAddress:[j.poolAddress],a2b:[j.aToB],rawAmountLimit:i?[j.estimatedAmountOut]:[j.estimatedAmountIn],isExceed:j.isExceed,coinType:[e,t]},q={paths:[$],partner:s,priceSlippagePoint:o};return{amountIn:new _(j.estimatedAmountIn),amountOut:new _(j.estimatedAmountOut),paths:[$],a2b:j.aToB,b2c:void 0,byAmountIn:i,isExceed:j.isExceed,targetSqrtPrice:[j.estimatedEndSqrtPrice],currentSqrtPrice:[j.estimatedStartSqrtPrice],coinTypeA:e,coinTypeB:t,coinTypeC:void 0,createTxParams:q}}throw new Mt("No parameters available for service downgrade","NoDowngradeNeedParams")}const P=await this.preRouterSwapA2B2C(g.slice(0,16));if(P==null){if(r!=null){const $=await this.sdk.Swap.preSwapWithMultiPool(r),q={amountIn:new _($.estimatedAmountIn),amountOut:new _($.estimatedAmountOut),poolAddress:[$.poolAddress],a2b:[$.aToB],rawAmountLimit:i?[$.estimatedAmountOut]:[$.estimatedAmountIn],isExceed:$.isExceed,coinType:[e,t]},A={paths:[q],partner:s,priceSlippagePoint:o};return{amountIn:new _($.estimatedAmountIn),amountOut:new _($.estimatedAmountOut),paths:[q],a2b:$.aToB,b2c:void 0,byAmountIn:i,isExceed:$.isExceed,targetSqrtPrice:[$.estimatedEndSqrtPrice],currentSqrtPrice:[$.estimatedStartSqrtPrice],coinTypeA:e,coinTypeB:t,coinTypeC:void 0,createTxParams:A}}return{amountIn:ie,amountOut:ie,paths:[],a2b:!1,b2c:!1,byAmountIn:i,isExceed:!0,targetSqrtPrice:[],currentSqrtPrice:[],coinTypeA:"",coinTypeB:"",coinTypeC:void 0,createTxParams:void 0}}const E=P.index,S=g[E].poolBC!=null?[g[E].poolAB,g[E].poolBC]:[g[E].poolAB],T=i?[P.amountMedium,P.amountOut]:[P.amountIn,P.amountMedium],R=[];R.push(g[E].a2b),P.stepNum>1&&R.push(g[E].b2c);const K=[];K.push(g[E].coinTypeA),K.push(g[E].coinTypeB),P.stepNum>1&&K.push(g[E].coinTypeC);const V={amountIn:P.amountIn,amountOut:P.amountOut,poolAddress:S,a2b:R,rawAmountLimit:T,isExceed:P.isExceed,coinType:K},W={paths:[V],partner:s,priceSlippagePoint:o};return{amountIn:P.amountIn,amountOut:P.amountOut,paths:[V],a2b:g[E].a2b,b2c:P.stepNum>1?g[E].b2c:void 0,byAmountIn:i,isExceed:P.isExceed,targetSqrtPrice:P.targetSqrtPrice,currentSqrtPrice:P.currentSqrtPrice,coinTypeA:g[E].coinTypeA,coinTypeB:g[E].coinTypeB,coinTypeC:P.stepNum>1?g[E].coinTypeC:void 0,createTxParams:W}}async preRouterSwapA2B2C(e){var d;if(e.length===0)return null;const{integrate:t,simulationAccount:n}=this.sdk.sdkOptions,i=new _t;for(const h of e)if(h.stepNums>1){const g=[i.object(h.poolAB),i.object(h.poolBC),i.pure(h.a2b),i.pure(h.b2c),i.pure(h.byAmountIn),i.pure(h.amount.toString())],b=[];h.a2b?b.push(h.coinTypeA,h.coinTypeB):b.push(h.coinTypeB,h.coinTypeA),h.b2c?b.push(h.coinTypeB,h.coinTypeC):b.push(h.coinTypeC,h.coinTypeB),i.moveCall({target:`${t.published_at}::${Xr}::calculate_router_swap_result`,typeArguments:b,arguments:g})}else{const g=[i.pure(h.poolAB),i.pure(h.a2b),i.pure(h.byAmountIn),i.pure(h.amount.toString())],b=h.a2b?[h.coinTypeA,h.coinTypeB]:[h.coinTypeB,h.coinTypeA];i.moveCall({target:`${t.published_at}::${W2}::get_expect_swap_result`,arguments:g,typeArguments:b})}if(!si(n.address))throw new Mt("this config simulationAccount is not set right","InvalidSimulateAccount");const s=(d=(await this.sdk.fullClient.devInspectTransactionBlock({transactionBlock:i,sender:n.address})).events)==null?void 0:d.filter(h=>ge(h.type).name==="CalculatedRouterSwapResultEvent"||ge(h.type).name==="ExpectSwapResultEvent");if(s.length===0)return null;let r=e[0].byAmountIn?ie:Ar,a=0;for(let h=0;h<s.length;h+=1)if(!s[h].parsedJson.data.is_exceed)if(e[0].byAmountIn){const g=new _(s[h].parsedJson.data.amount_out);g.gt(r)&&(a=h,r=g)}else{const g=e[h].stepNums>1?new _(s[h].parsedJson.data.amount_in):new _(s[h].parsedJson.data.amount_in).add(new _(s[h].parsedJson.data.fee_amount));g.lt(r)&&(a=h,r=g)}const c=[],u=[];return e[a].stepNums>1?(u.push(s[a].parsedJson.data.target_sqrt_price_ab,s[a].parsedJson.data.target_sqrt_price_cd),c.push(s[a].parsedJson.data.current_sqrt_price_ab,s[a].parsedJson.data.current_sqrt_price_cd)):(u.push(s[a].parsedJson.data.after_sqrt_price),c.push(s[a].parsedJson.current_sqrt_price)),{index:a,amountIn:e[0].byAmountIn?e[a].amount:r,amountMedium:s[a].parsedJson.data.amount_medium,amountOut:e[0].byAmountIn?r:e[a].amount,targetSqrtPrice:u,currentSqrtPrice:c,isExceed:s[a].parsedJson.data.is_exceed,stepNum:e[a].stepNums}}async getPoolWithTVL(){const e=[],{swapCountUrl:t}=this._sdk.sdkOptions;if(!t)return e;let n;try{n=await fetch(t)}catch{throw new Mt(`Failed to get pool list with liquidity from ${t}.`,"InvalidSwapCountUrl")}let i;try{i=await n.json()}catch{throw new Mt(`Failed tp [arse response from ${t}].`,"InvalidSwapCountUrl")}if(i.code!==200)throw new Mt(`Failed to get pool list from ${t}. Statu code is ${i.code}.`,"InvalidSwapCountUrl");const{pools:o}=i.data;for(const s of o)e.push({poolAddress:s.swap_account,tvl:Number(s.tvl_in_usd)});return e}},Lk=class{constructor(e){qt(this,"_sdk");qt(this,"calculateSingleImpact",(e,t)=>t.minus(e).div(t).mul(100));this._sdk=e}get sdk(){return this._sdk}calculateSwapFee(e){let t=Je(0);return e.forEach(n=>{const i=n.basePaths.length;if(i>0){const o=n.basePaths[0],s=o.label==="Cetus"?new it(o.feeRate).div(10**6):new it(o.feeRate).div(10**9),r=Je(o.inputAmount).div(10**o.fromDecimal).mul(s);if(t=t.add(r),i>1){const a=n.basePaths[1],c=o.direction?o.currentPrice:new it(1).div(o.currentPrice),u=a.direction?a.currentPrice:new it(1).div(a.currentPrice),l=a.label==="Cetus"?new it(a.feeRate).div(10**6):new it(a.feeRate).div(10**9),h=Je(a.outputAmount).div(10**a.toDecimal).mul(l).div(c.mul(u));t=t.add(h)}}}),t.toString()}calculateSwapPriceImpact(e){let t=Je(0);return e.forEach(n=>{const i=n.basePaths.length;if(i===1){const o=n.basePaths[0],s=Je(o.outputAmount).div(10**o.toDecimal),r=Je(o.inputAmount).div(10**o.fromDecimal),a=s.div(r),c=o.direction?new it(o.currentPrice):new it(1).div(o.currentPrice);t=t.add(this.calculateSingleImpact(a,c))}if(i===2){const o=n.basePaths[0],s=n.basePaths[1],r=o.direction?new it(o.currentPrice):new it(1).div(o.currentPrice),a=s.direction?new it(s.currentPrice):new it(1).div(s.currentPrice),c=r.mul(a),u=new it(s.outputAmount).div(10**s.toDecimal),l=new it(o.inputAmount).div(10**o.fromDecimal),d=u.div(l);t=t.add(this.calculateSingleImpact(d,c))}}),t.toString()}async preSwapWithMultiPool(e){var u;const{integrate:t,simulationAccount:n}=this.sdk.sdkOptions,i=new _t,o=[e.coinTypeA,e.coinTypeB];for(let l=0;l<e.poolAddresses.length;l+=1){const d=[i.pure(e.poolAddresses[l]),i.pure(e.a2b),i.pure(e.byAmountIn),i.pure(e.amount)];i.moveCall({target:`${t.published_at}::${_s}::calculate_swap_result`,arguments:d,typeArguments:o})}if(!si(n.address))throw new Mt("this config simulationAccount is not set right","InvalidSimulateAccount");const s=await this.sdk.fullClient.devInspectTransactionBlock({transactionBlock:i,sender:n.address});if(s.error!=null)throw new Mt(`pre swap with multi pools error code: ${s.error??"unknown error"}, please check config and params`,"InvalidConfig");const r=(u=s.events)==null?void 0:u.filter(l=>ge(l.type).name==="CalculatedSwapResultEvent");if(r.length===0)return null;if(r.length!==e.poolAddresses.length)throw new Mt("valueData.length !== params.pools.length","ParamsLengthNotEqual");let a=e.byAmountIn?ie:Ar,c=0;for(let l=0;l<r.length;l+=1)if(!r[l].parsedJson.data.is_exceed)if(e.byAmountIn){const d=new _(r[l].parsedJson.data.amount_out);d.gt(a)&&(c=l,a=d)}else{const d=new _(r[l].parsedJson.data.amount_out);d.lt(a)&&(c=l,a=d)}return this.transformSwapWithMultiPoolData({poolAddress:e.poolAddresses[c],a2b:e.a2b,byAmountIn:e.byAmountIn,amount:e.amount,coinTypeA:e.coinTypeA,coinTypeB:e.coinTypeB},r[c].parsedJson)}async preswap(e){var c;const{integrate:t,simulationAccount:n}=this.sdk.sdkOptions,i=new _t,o=[e.coinTypeA,e.coinTypeB],s=[i.pure(e.pool.poolAddress),i.pure(e.a2b),i.pure(e.byAmountIn),i.pure(e.amount)];if(i.moveCall({target:`${t.published_at}::${_s}::calculate_swap_result`,arguments:s,typeArguments:o}),!si(n.address))throw new Mt("this config simulationAccount is not set right","InvalidSimulateAccount");const r=await this.sdk.fullClient.devInspectTransactionBlock({transactionBlock:i,sender:n.address});if(r.error!=null)throw new Mt(`preswap error code: ${r.error??"unknown error"}, please check config and params`,"InvalidConfig");const a=(c=r.events)==null?void 0:c.filter(u=>ge(u.type).name==="CalculatedSwapResultEvent");return a.length===0?null:this.transformSwapData(e,a[0].parsedJson.data)}transformSwapData(e,t){const n=t.amount_in&&t.fee_amount?new _(t.amount_in).add(new _(t.fee_amount)).toString():"";return{poolAddress:e.pool.poolAddress,currentSqrtPrice:e.currentSqrtPrice,estimatedAmountIn:n,estimatedAmountOut:t.amount_out,estimatedEndSqrtPrice:t.after_sqrt_price,estimatedFeeAmount:t.fee_amount,isExceed:t.is_exceed,amount:e.amount,aToB:e.a2b,byAmountIn:e.byAmountIn}}transformSwapWithMultiPoolData(e,t){const{data:n}=t,i=n.amount_in&&n.fee_amount?new _(n.amount_in).add(new _(n.fee_amount)).toString():"";return{poolAddress:e.poolAddress,estimatedAmountIn:i,estimatedAmountOut:n.amount_out,estimatedEndSqrtPrice:n.after_sqrt_price,estimatedStartSqrtPrice:t.current_sqrt_price,estimatedFeeAmount:n.fee_amount,isExceed:n.is_exceed,amount:e.amount,aToB:e.a2b,byAmountIn:e.byAmountIn}}calculateRates(e){const{currentPool:t}=e,n=K2(t);let i;e.a2b?i=e.swapTicks.sort((d,h)=>h.index-d.index):i=e.swapTicks.sort((d,h)=>d.index-h.index);const o=lk(e.a2b,e.byAmountIn,e.amount,n,i);let s=!1;e.byAmountIn?s=o.amountIn.lt(e.amount):s=o.amountOut.lt(e.amount);const r=No.getDefaultSqrtPriceLimit(e.a2b);e.a2b&&o.nextSqrtPrice.lt(r)&&(s=!0),!e.a2b&&o.nextSqrtPrice.gt(r)&&(s=!0);let a=0;o.crossTickNum>6&&o.crossTickNum<40&&(a=22e3*(o.crossTickNum-6)),o.crossTickNum>40&&(s=!0);const c=We.sqrtPriceX64ToPrice(n.currentSqrtPrice,e.decimalsA,e.decimalsB).toNumber(),u=We.sqrtPriceX64ToPrice(o.nextSqrtPrice,e.decimalsA,e.decimalsB).toNumber(),l=Math.abs(c-u)/c*100;return{estimatedAmountIn:o.amountIn,estimatedAmountOut:o.amountOut,estimatedEndSqrtPrice:o.nextSqrtPrice,estimatedFeeAmount:o.feeAmount,isExceed:s,extraComputeLimit:a,amount:e.amount,aToB:e.a2b,byAmountIn:e.byAmountIn,priceImpactPct:l}}async createSwapTransactionPayload(e,t){if(this._sdk.senderAddress.length===0)throw Error("this config sdk senderAddress is empty");const n=await this._sdk.getOwnerCoinAssets(this._sdk.senderAddress);if(t){const{isAdjustCoinA:i,isAdjustCoinB:o}=$c(e);if(e.a2b&&i||!e.a2b&&o)return await $n.buildSwapTransactionForGas(this._sdk,e,n,t)}return $n.buildSwapTransaction(this.sdk,e,n)}async createSwapTransactionWithoutTransferCoinsPayload(e,t){if(this._sdk.senderAddress.length===0)throw Error("this config sdk senderAddress is empty");const n=await this._sdk.getOwnerCoinAssets(this._sdk.senderAddress);if(t){const{isAdjustCoinA:i,isAdjustCoinB:o}=$c(e);if(e.a2b&&i||!e.a2b&&o)return await $n.buildSwapTransactionWithoutTransferCoinsForGas(this._sdk,e,n,t)}return $n.buildSwapTransactionWithoutTransferCoins(this.sdk,e,n)}},Nk=class{constructor(e){qt(this,"_sdk");qt(this,"_cache",{});this._sdk=e}get sdk(){return this._sdk}async getAllRegisteredTokenList(e=!1){return await this.factchTokenList("",e)}async getOwnerTokenList(e="",t=!1){return await this.factchTokenList(e,t)}async getAllRegisteredPoolList(e=!1){return await this.factchPoolList("",e)}async getOwnerPoolList(e="",t=!1){return await this.factchPoolList(e,t)}async getWarpPoolList(e=!1){return await this.factchWarpPoolList("","",e)}async getOwnerWarpPoolList(e="",t="",n=!1){return await this.factchWarpPoolList(e,t,n)}async getTokenListByCoinTypes(e){const t={},n="getAllRegisteredTokenList",i=this.getCache(n);if(i!==void 0){const s=i;for(const r of e)for(const a of s)if(ho(r)===ho(a.address)){t[r]=a;continue}}const o=e.filter(s=>t[s]===void 0);for(const s of o){const r=`${s}_metadata`,a=this.getCache(r);if(a!==void 0)t[s]=a;else{const c=await this._sdk.fullClient.getCoinMetadata({coinType:s});if(c){const u={id:c.id,name:c.name,symbol:c.symbol,official_symbol:c.symbol,coingecko_id:"",decimals:c.decimals,project_url:"",logo_url:c.iconUrl,address:s};t[s]=u,this.updateCache(r,u,vn)}}}return t}async factchTokenList(e="",t=!1){var d;const{simulationAccount:n,token:i}=this.sdk.sdkOptions,o="getAllRegisteredTokenList",s=this.getCache(o,t);if(s!==void 0)return s;const r=e.length>0,a=512;let c=0,u=[];if(i===void 0)throw Error("please config token ofsdkOptions");const l=hn(i);for(;;){const h=new _t;h.moveCall({target:`${i.published_at}::coin_list::${r?"fetch_full_list_with_limit":"fetch_all_registered_coin_info_with_limit"}`,arguments:r?[h.pure(l.coin_registry_id),h.pure(e),h.pure(c),h.pure(a)]:[h.pure(l.coin_registry_id),h.pure(c),h.pure(a)]});const g=await this.sdk.fullClient.devInspectTransactionBlock({transactionBlock:h,sender:n.address}),b=[];if((d=g.events)==null||d.forEach(v=>{ge(v.type).full_address===`${i.published_at}::coin_list::FetchCoinListEvent`&&v.parsedJson.full_list.value_list.forEach(P=>{b.push(this.transformData(P,!1))})}),u=[...u,...b],b.length<a)break;c=u.length}return u}async factchPoolList(e="",t=!1){var d;const{simulationAccount:n,token:i}=this.sdk.sdkOptions,o="getAllRegisteredPoolList",s=this.getCache(o,t);if(s!==void 0)return s;let r=[];const a=512;let c=0;const u=e.length>0;if(i===void 0)throw Error("please config token ofsdkOptions");const l=hn(i);for(;;){const h=new _t;if(h.moveCall({target:`${i.published_at}::lp_list::${u?"fetch_full_list_with_limit":"fetch_all_registered_coin_info_with_limit"}`,arguments:u?[h.pure(l.pool_registry_id),h.pure(e),h.pure(c),h.pure(a)]:[h.pure(l.pool_registry_id),h.pure(c),h.pure(a)]}),!si(n.address))throw new Mt("this config simulationAccount is not set right","InvalidSimulateAccount");const g=await this.sdk.fullClient.devInspectTransactionBlock({transactionBlock:h,sender:n.address}),b=[];if((d=g.events)==null||d.forEach(v=>{ge(v.type).full_address===`${i.published_at}::lp_list::FetchPoolListEvent`&&v.parsedJson.full_list.value_list.forEach(P=>{b.push(this.transformData(P,!0))})}),r=[...r,...b],b.length<a)break;c=r.length}return r}async factchWarpPoolList(e="",t="",n=!1){const i=await this.factchPoolList(e,n);if(i.length===0)return[];const o=await this.factchTokenList(t,n),s=[];for(const r of i){for(const a of o)a.address===r.coin_a_address&&(r.coinA=a),a.address===r.coin_b_address&&(r.coinB=a);s.push(r)}return s}async getTokenConfigEvent(e=!1){const t=this._sdk.sdkOptions.token.package_id,n=`${t}_getTokenConfigEvent`,i=this.getCache(n,e);if(i!==void 0)return i;const o=await this._sdk.fullClient.getObject({id:t,options:{showPreviousTransaction:!0}}),s=ih(o),r=await this._sdk.fullClient.queryEventsByPage({Transaction:s}),a={coin_registry_id:"",pool_registry_id:"",coin_list_owner:"",pool_list_owner:""};return r.data.length>0&&r.data.forEach(c=>{const u=ge(c.type);if(c.transactionModule==="coin_list")switch(u.name){case"InitListEvent":a.coin_list_owner=c.parsedJson.list_id;break;case"InitRegistryEvent":a.coin_registry_id=c.parsedJson.registry_id;break}else if(c.transactionModule==="lp_list")switch(u.name){case"InitListEvent<address>":a.pool_list_owner=c.parsedJson.list_id;break;case"InitRegistryEvent<address>":a.pool_registry_id=c.parsedJson.registry_id;break}}),a.coin_registry_id.length>0&&this.updateCache(n,a,vn),a}transformData(e,t){const n={...e};if(t)try{n.coin_a_address=ge(n.coin_a_address).full_address,n.coin_b_address=ge(n.coin_b_address).full_address}catch{}else n.address=ge(n.address).full_address;if(e.extensions){const i=e.extensions.contents;for(const o of i){const{key:s}=o;let{value:r}=o;if(s==="labels")try{r=JSON.parse(decodeURIComponent(sr.decode(r)))}catch{}s==="pyth_id"&&(r=Dn(r)),n[s]=r}delete n.extensions}return n}updateCache(e,t,n=Hu){let i=this._cache[e];i?(i.overdueTime=so(n),i.value=t):i=new Ra(t,so(n)),this._cache[e]=i}getCache(e,t=!1){const n=this._cache[e],i=n==null?void 0:n.isValid();if(!t&&i)return n.value;i||delete this._cache[e]}},Fk=class{constructor(e){qt(this,"_sdk");this._sdk=e}get sdk(){return this._sdk}calculatePrice(e,t,n,i,o){const s=i?t:n,r=i?n:t;return o==="Cetus"?We.sqrtPriceX64ToPrice(e,s,r):new it(e.toString()).div(new it(10).pow(new it(r+9-s)))}parseJsonResult(e){return{isExceed:e.is_exceed,isTimeout:e.is_timeout,inputAmount:e.input_amount,outputAmount:e.output_amount,fromCoin:e.from_coin,toCoin:e.to_coin,byAmountIn:e.by_amount_in,splitPaths:e.split_paths.map(n=>({pathIndex:n.path_index,lastQuoteOutput:n.last_quote_output,percent:n.percent,basePaths:n.best_path.map(o=>({direction:o.direction,label:o.label,poolAddress:o.provider,fromCoin:o.from_coin,toCoin:o.to_coin,outputAmount:o.output_amount,inputAmount:o.input_amount,feeRate:o.fee_rate,currentSqrtPrice:new _(o.current_sqrt_price.toString()),afterSqrtPrice:o.label==="Cetus"?new _(o.after_sqrt_price.toString()):ie,fromDecimal:o.from_decimal,toDecimal:o.to_decimal,currentPrice:this.calculatePrice(new _(o.current_sqrt_price.toString()),o.from_decimal,o.to_decimal,o.direction,o.label)})),inputAmount:n.input_amount,outputAmount:n.output_amount}))}}async fetchWithTimeout(e,t,n){const i=new AbortController,o=setTimeout(()=>i.abort(),n);try{const s=await fetch(e,{...t,signal:i.signal});return clearTimeout(o),s}catch{return null}}async fetchAndParseData(e,t){try{const i=await this.fetchWithTimeout(e,t,1500);return i.status===200?this.parseJsonResult(await i.json()):null}catch{return null}}async getBestRouter(e,t,n,i,o,s,r,a,c=!1,u=!1,l=[]){let d=null,h="v2",g={},b=this.sdk.sdkOptions.aggregatorUrl;if(l.length>0){const v=new URL(b);b=`${v.protocol}//${v.hostname}/router_with_lp_changes`,g={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({from:e,to:t,amount:n,by_amount_in:i,order_split:c,external_router:u,sender_address:"None",request_id:encodeURIComponent(bf()),lp_changes:l})}}else b=`
      ${b}?from=${encodeURIComponent(e)}&to=${encodeURIComponent(t)}&amount=${encodeURIComponent(n)}&by_amount_in=${encodeURIComponent(i)}&order_split=${encodeURIComponent(c)}&external_router=${encodeURIComponent(u)}&sender_address=''&request_id=${encodeURIComponent(bf())}
      `;if(d=await this.fetchAndParseData(b,g),d!=null&&d.isTimeout||d==null){const v=await this.sdk.Router.price(e,t,new _(n),i,o,s,a),x=[];for(const E of v.paths){const S=[];if(E.poolAddress.length>1){const R=this.sdk.Router.tokenInfo(E.coinType[0]).decimals,K=this.sdk.Router.tokenInfo(E.coinType[1]).decimals,V=E.a2b[0]?We.sqrtPriceX64ToPrice(new _(v.currentSqrtPrice[0]),R,K):We.sqrtPriceX64ToPrice(new _(v.currentSqrtPrice[0]),K,R),W={direction:E.a2b[0],label:"Cetus",poolAddress:E.poolAddress[0],fromCoin:E.coinType[0],toCoin:E.coinType[1],feeRate:this.sdk.Router.getFeeRate(E.coinType[0],E.coinType[1],E.poolAddress[0]),outputAmount:v.byAmountIn?E.rawAmountLimit[0].toString():E.rawAmountLimit[1].toString(),inputAmount:E.amountIn.toString(),currentSqrtPrice:v.currentSqrtPrice[0],currentPrice:V,fromDecimal:R,toDecimal:K},tt=this.sdk.Router.tokenInfo(E.coinType[1]).decimals,j=this.sdk.Router.tokenInfo(E.coinType[2]).decimals,$=E.a2b[1]?We.sqrtPriceX64ToPrice(new _(v.currentSqrtPrice[1]),tt,j):We.sqrtPriceX64ToPrice(new _(v.currentSqrtPrice[1]),j,tt),q={direction:E.a2b[1],label:"Cetus",poolAddress:E.poolAddress[1],fromCoin:E.coinType[1],toCoin:E.coinType[2],feeRate:this.sdk.Router.getFeeRate(E.coinType[1],E.coinType[2],E.poolAddress[1]),outputAmount:E.amountOut.toString(),inputAmount:v.byAmountIn?E.rawAmountLimit[0].toString():E.rawAmountLimit[1].toString(),currentSqrtPrice:v.currentSqrtPrice[1],currentPrice:$,fromDecimal:tt,toDecimal:j};S.push(W,q)}else{const R=this.sdk.Router.tokenInfo(E.coinType[0]).decimals,K=this.sdk.Router.tokenInfo(E.coinType[1]).decimals,V=E.a2b[0]?We.sqrtPriceX64ToPrice(new _(v.currentSqrtPrice[0]),R,K):We.sqrtPriceX64ToPrice(new _(v.currentSqrtPrice[0]),K,R),W={direction:E.a2b[0],label:"Cetus",poolAddress:E.poolAddress[0],fromCoin:E.coinType[0],toCoin:E.coinType[1],feeRate:this.sdk.Router.getFeeRate(E.coinType[0],E.coinType[1],E.poolAddress[0]),outputAmount:E.amountOut.toString(),inputAmount:E.amountIn.toString(),currentSqrtPrice:v.currentSqrtPrice[0],currentPrice:V,fromDecimal:R,toDecimal:K};S.push(W)}const T={percent:Number(E.amountIn)/Number(v.amountIn)*100,inputAmount:Number(E.amountIn.toString()),outputAmount:Number(E.amountOut.toString()),pathIndex:0,lastQuoteOutput:0,basePaths:S};x.push(T)}const P={isExceed:v.isExceed,isTimeout:!0,inputAmount:Number(v.amountIn.toString()),outputAmount:Number(v.amountOut.toString()),fromCoin:v.coinTypeA,toCoin:v.coinTypeC!=null?v.coinTypeC:v.coinTypeB,byAmountIn:v.byAmountIn,splitPaths:x};h="v1",d=P}return{result:d,version:h}}},jk=class{constructor(e){qt(this,"_sdk");qt(this,"_cache",{});this._sdk=e}get sdk(){return this._sdk}setTokenListCache(e){const{coin_list_handle:t}=hn(this.sdk.sdkOptions.cetus_config),n=`${t}_getCoinConfigs`,i=this.getCache(n),o=i?[...i,...e]:e;this.updateCache(n,o,vn)}async getTokenListByCoinTypes(e){const t={},{coin_list_handle:n}=hn(this.sdk.sdkOptions.cetus_config),i=`${n}_getCoinConfigs`,o=this.getCache(i);if(o!==void 0){const r=o;for(const a of e)for(const c of r)if(ho(a)===ho(c.address)){t[a]=c;continue}}const s=e.filter(r=>t[r]===void 0);for(const r of s){const a=`${r}_metadata`,c=this.getCache(a);if(c!==void 0)t[r]=c;else{const u=await this._sdk.fullClient.getCoinMetadata({coinType:r});if(u){const l={id:u.id,pyth_id:"",name:u.name,symbol:u.symbol,official_symbol:u.symbol,coingecko_id:"",decimals:u.decimals,project_url:"",logo_url:u.iconUrl,address:r};t[r]=l,this.updateCache(a,l,vn)}else console.log(`not found ${r}`)}}return t}async getCoinConfigs(e=!1,t=!0){const{coin_list_handle:n}=hn(this.sdk.sdkOptions.cetus_config),i=`${n}_getCoinConfigs`,o=this.getCache(i,e);if(o)return o;const r=(await this._sdk.fullClient.getDynamicFieldsByPage(n)).data.map(u=>u.objectId),a=await this._sdk.fullClient.batchGetObjects(r,{showContent:!0}),c=[];return a.forEach(u=>{var d,h;if(u.error!=null||((h=(d=u.data)==null?void 0:d.content)==null?void 0:h.dataType)!=="moveObject")throw new Mt(`when getCoinConfigs get objects error: ${u.error}, please check the rpc and contracts address config.`,"InvalidConfig");const l=this.buildCoinConfig(u,t);this.updateCache(`${n}_${l.address}_getCoinConfig`,l,vn),c.push({...l})}),this.updateCache(i,c,vn),c}async getCoinConfig(e,t=!1,n=!0){var c,u;const{coin_list_handle:i}=hn(this.sdk.sdkOptions.cetus_config),o=`${i}_${e}_getCoinConfig`,s=this.getCache(o,t);if(s)return s;const r=await this._sdk.fullClient.getDynamicFieldObject({parentId:i,name:{type:"0x1::type_name::TypeName",value:{name:_k(e)}}});if(r.error!=null||((u=(c=r.data)==null?void 0:c.content)==null?void 0:u.dataType)!=="moveObject")throw new Mt(`when getCoinConfig get object error: ${r.error}, please check the rpc and contracts address config.`,"InvalidConfig");const a=this.buildCoinConfig(r,n);return this.updateCache(o,a,vn),a}buildCoinConfig(e,t=!0){let n=zo(e);n=n.value.fields;const i={...n};return i.id=rr(e),i.address=ge(n.coin_type.fields.name).full_address,n.pyth_id&&(i.pyth_id=Dn(n.pyth_id)),this.transformExtensions(i,n.extension_fields.fields.contents,t),delete i.coin_type,i}async getClmmPoolConfigs(e=!1,t=!0){const{clmm_pools_handle:n}=hn(this.sdk.sdkOptions.cetus_config),i=`${n}_getClmmPoolConfigs`,o=this.getCache(i,e);if(o)return o;const r=(await this._sdk.fullClient.getDynamicFieldsByPage(n)).data.map(u=>u.objectId),a=await this._sdk.fullClient.batchGetObjects(r,{showContent:!0}),c=[];return a.forEach(u=>{var d,h;if(u.error!=null||((h=(d=u.data)==null?void 0:d.content)==null?void 0:h.dataType)!=="moveObject")throw new Mt(`when getClmmPoolsConfigs get objects error: ${u.error}, please check the rpc and contracts address config.`,"InvalidConfig");const l=this.buildClmmPoolConfig(u,t);this.updateCache(`${l.pool_address}_getClmmPoolConfig`,l,vn),c.push({...l})}),this.updateCache(i,c,vn),c}async getClmmPoolConfig(e,t=!1,n=!0){const{clmm_pools_handle:i}=hn(this.sdk.sdkOptions.cetus_config),o=`${e}_getClmmPoolConfig`,s=this.getCache(o,t);if(s)return s;const r=await this._sdk.fullClient.getDynamicFieldObject({parentId:i,name:{type:"address",value:e}}),a=this.buildClmmPoolConfig(r,n);return this.updateCache(o,a,vn),a}buildClmmPoolConfig(e,t=!0){let n=zo(e);n=n.value.fields;const i={...n};return i.id=rr(e),i.pool_address=Dn(n.pool_address),this.transformExtensions(i,n.extension_fields.fields.contents,t),i}async getLaunchpadPoolConfigs(e=!1,t=!0){const{launchpad_pools_handle:n}=hn(this.sdk.sdkOptions.cetus_config),i=`${n}_getLaunchpadPoolConfigs`,o=this.getCache(i,e);if(o)return o;const r=(await this._sdk.fullClient.getDynamicFieldsByPage(n)).data.map(u=>u.objectId),a=await this._sdk.fullClient.batchGetObjects(r,{showContent:!0}),c=[];return a.forEach(u=>{var d,h;if(u.error!=null||((h=(d=u.data)==null?void 0:d.content)==null?void 0:h.dataType)!=="moveObject")throw new Mt(`when getCoinConfigs get objects error: ${u.error}, please check the rpc and contracts address config.`,"InvalidConfig");const l=this.buildLaunchpadPoolConfig(u,t);this.updateCache(`${l.pool_address}_getLaunchpadPoolConfig`,l,vn),c.push({...l})}),this.updateCache(i,c,vn),c}async getLaunchpadPoolConfig(e,t=!1,n=!0){const{launchpad_pools_handle:i}=hn(this.sdk.sdkOptions.cetus_config),o=`${e}_getLaunchpadPoolConfig`,s=this.getCache(o,t);if(s)return s;const r=await this._sdk.fullClient.getDynamicFieldObject({parentId:i,name:{type:"address",value:e}}),a=this.buildLaunchpadPoolConfig(r,n);return this.updateCache(o,a,vn),a}buildLaunchpadPoolConfig(e,t=!0){let n=zo(e);n=n.value.fields;const i={...n};i.id=rr(e),i.pool_address=Dn(n.pool_address),this.transformExtensions(i,n.extension_fields.fields.contents,t);const o=[];n.social_media.fields.contents.forEach(s=>{o.push({name:s.fields.value.fields.name,link:s.fields.value.fields.link})}),i.social_media=o;try{i.regulation=decodeURIComponent(sr.decode(i.regulation).replace(/%/g,"%25"))}catch{i.regulation=sr.decode(i.regulation)}return i}transformExtensions(e,t,n=!0){const i=[];for(const o of t){const{key:s}=o.fields;let{value:r}=o.fields;if(s==="labels")try{r=JSON.parse(decodeURIComponent(sr.decode(r)))}catch{}n&&(e[s]=r),i.push({key:s,value:r})}delete e.extension_fields,n||(e.extensions=i)}async getCetusConfig(e=!1){const t=this._sdk.sdkOptions.cetus_config.package_id,n=`${t}_getCetusConfig`,i=this.getCache(n,e);if(i!==void 0)return i;const o=await this._sdk.fullClient.getObject({id:t,options:{showPreviousTransaction:!0}}),s=ih(o),r=await this._sdk.fullClient.queryEventsByPage({Transaction:s});let a={coin_list_id:"",launchpad_pools_id:"",clmm_pools_id:"",admin_cap_id:"",global_config_id:"",coin_list_handle:"",launchpad_pools_handle:"",clmm_pools_handle:""};if(r.data.length>0)for(const c of r.data)switch(ge(c.type).name){case"InitCoinListEvent":a.coin_list_id=c.parsedJson.coin_list_id;break;case"InitLaunchpadPoolsEvent":a.launchpad_pools_id=c.parsedJson.launchpad_pools_id;break;case"InitClmmPoolsEvent":a.clmm_pools_id=c.parsedJson.pools_id;break;case"InitConfigEvent":a.global_config_id=c.parsedJson.global_config_id,a.admin_cap_id=c.parsedJson.admin_cap_id;break}return a=await this.getCetusConfigHandle(a),a.clmm_pools_id.length>0&&this.updateCache(n,a,vn),a}async getCetusConfigHandle(e){const t=[e.clmm_pools_id,e.coin_list_id,e.launchpad_pools_id];return(await this._sdk.fullClient.multiGetObjects({ids:t,options:{showContent:!0}})).forEach(i=>{var r,a;if(i.error!=null||((a=(r=i.data)==null?void 0:r.content)==null?void 0:a.dataType)!=="moveObject")throw new Mt(`when getCetusConfigHandle get objects error: ${i.error}, please check the rpc and contracts address config.`,"InvalidConfigHandle");const o=zo(i),s=Pk(i);switch(ge(s).name){case"ClmmPools":e.clmm_pools_handle=o.pools.fields.id.id;break;case"CoinList":e.coin_list_handle=o.coins.fields.id.id;break;case"LaunchpadPools":e.launchpad_pools_handle=o.pools.fields.id.id;break}}),e}updateCache(e,t,n=Hu){let i=this._cache[e];i?(i.overdueTime=so(n),i.value=t):i=new Ra(t,so(n)),this._cache[e]=i}getCache(e,t=!1){try{const n=this._cache[e];if(!n)return;if(t||!n.isValid()){delete this._cache[e];return}return n.value}catch(n){console.error(`Error accessing cache for key ${e}:`,n);return}}},zk=class extends Om{async queryEventsByPage(e,t="all"){let n=[],i=!0;const o=t==="all";let s=o?null:t.cursor;do{const r=await this.queryEvents({query:e,cursor:s,limit:o?null:t.limit});r.data?(n=[...n,...r.data],i=r.hasNextPage,s=r.nextCursor):i=!1}while(o&&i);return{data:n,nextCursor:s,hasNextPage:i}}async getOwnedObjectsByPage(e,t,n="all"){let i=[],o=!0;const s=n==="all";let r=s?null:n.cursor;do{const a=await this.getOwnedObjects({owner:e,...t,cursor:r,limit:s?null:n.limit});a.data?(i=[...i,...a.data],o=a.hasNextPage,r=a.nextCursor):o=!1}while(s&&o);return{data:i,nextCursor:r,hasNextPage:o}}async getDynamicFieldsByPage(e,t="all"){let n=[],i=!0;const o=t==="all";let s=o?null:t.cursor;do{const r=await this.getDynamicFields({parentId:e,cursor:s,limit:o?null:t.limit});r.data?(n=[...n,...r.data],i=r.hasNextPage,s=r.nextCursor):i=!1}while(o&&i);return{data:n,nextCursor:s,hasNextPage:i}}async batchGetObjects(e,t,n=50){let i=[];try{for(let o=0;o<Math.ceil(e.length/n);o++){const s=await this.multiGetObjects({ids:e.slice(o*n,n*(o+1)),options:t});i=[...i,...s]}}catch(o){console.log(o)}return i}async calculationTxGas(e){const{sender:t}=e.blockData;if(t===void 0)throw Error("sdk sender is empty");const n=await this.devInspectTransactionBlock({transactionBlock:e,sender:t}),{gasUsed:i}=n.effects;return Number(i.computationCost)+Number(i.storageCost)-Number(i.storageRebate)}async sendTransaction(e,t){try{return await this.signAndExecuteTransactionBlock({transactionBlock:t,signer:e,options:{showEffects:!0,showEvents:!0}})}catch(n){console.log("error: ",n)}}async sendSimulationTransaction(e,t,n=!0){try{if(n)return await this.devInspectTransactionBlock({transactionBlock:e,sender:t});const o={ProgrammableTransaction:{inputs:e.blockData.inputs.map(c=>{const{type:u,value:l}=c;return u==="object"?Rm.SharedObjectRef({objectId:l,initialSharedVersion:0,mutable:!0}):l}),transactions:e.blockData.transactions}},s=El.TransactionKind.serialize(o,{maxSize:131072}).toBytes(),r=$m(s);return await this.transport.request({method:"sui_devInspectTransactionBlock",params:[t,r,null,null]})}catch(i){console.log("devInspectTransactionBlock error",i)}}},Mo=class{constructor(e){qt(this,"_cache",{});qt(this,"_rpcModule");qt(this,"_pool");qt(this,"_position");qt(this,"_swap");qt(this,"_rewarder");qt(this,"_router");qt(this,"_router_v2");qt(this,"_token");qt(this,"_config");qt(this,"_sdkOptions");qt(this,"_senderAddress","");this._sdkOptions=e,this._rpcModule=new zk({url:e.fullRpcUrl}),this._swap=new Lk(this),this._pool=new Uk(this),this._position=new qk(this),this._rewarder=new Mk(this),this._router=new Dk(this),this._router_v2=new Fk(this),this._token=new Nk(this),this._config=new jk(this),am(this._sdkOptions)}get senderAddress(){return this._senderAddress}set senderAddress(e){this._senderAddress=e}get Swap(){return this._swap}get fullClient(){return this._rpcModule}get sdkOptions(){return this._sdkOptions}get Pool(){return this._pool}get Position(){return this._position}get Rewarder(){return this._rewarder}get Router(){return this._router}get RouterV2(){return this._router_v2}get CetusConfig(){return this._config}get Token(){return this._token}async getOwnerCoinAssets(e,t,n=!0){const i=[];let o=null;const s=`${this.sdkOptions.fullRpcUrl}_${e}_${t}_getOwnerCoinAssets`,r=this.getCache(s,n);if(r)return r;for(;;){const a=await(t?this.fullClient.getCoins({owner:e,coinType:t,cursor:o}):this.fullClient.getAllCoins({owner:e,cursor:o}));if(a.data.forEach(c=>{BigInt(c.balance)>0&&i.push({coinAddress:ge(c.coinType).source_address,coinObjectId:c.coinObjectId,balance:BigInt(c.balance)})}),o=a.nextCursor,!a.hasNextPage)break}return this.updateCache(s,i,30*1e3),i}async getOwnerCoinBalances(e,t){let n=[];return t?n=[await this.fullClient.getBalance({owner:e,coinType:t})]:n=[...await this.fullClient.getAllBalances({owner:e})],n}updateCache(e,t,n=vn){let i=this._cache[e];i?(i.overdueTime=so(n),i.value=t):i=new Ra(t,so(n)),this._cache[e]=i}getCache(e,t=!1){const n=this._cache[e],i=n==null?void 0:n.isValid();if(!t&&i)return n.value;i||delete this._cache[e]}},Hk=Mo,Kk=Object.defineProperty,Gk=(e,t,n)=>t in e?Kk(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,Wk=(e,t,n)=>(Gk(e,typeof t!="symbol"?t+"":t,n),n),go=5*60*1e3,Ee=24*60*60*1e3;function En(e){return Date.parse(new Date().toString())+e}var Wi=class{constructor(e,t=0){qt(this,"overdueTime");qt(this,"value");this.overdueTime=t,this.value=e}isValid(){return this.value===null?!1:this.overdueTime===0?!0:!(Date.parse(new Date().toString())>this.overdueTime)}};it.config({precision:64,rounding:it.ROUND_DOWN,toExpNeg:-64,toExpPos:64});var Vn=it,xn=class extends Error{constructor(t,n){super(t);qt(this,"message");qt(this,"errorCode");this.message=t,this.errorCode=n}static isClmmpoolsErrorCode(t,n){return t instanceof xn&&t.errorCode===n}},kn=new _(0),Yr=new _(1),Xu=new _(2);Xu.pow(new _(128));var td=Xu.pow(new _(64)).sub(Yr),Xk=Xu.pow(new _(128)).sub(Yr),uo=class{static toX64_BN(e){return e.mul(new _(2).pow(new _(64)))}static toX64_Decimal(e){return e.mul(Vn.pow(2,64))}static toX64(e){return new _(e.mul(Vn.pow(2,64)).floor().toFixed())}static fromX64(e){return new Vn(e.toString()).mul(Vn.pow(2,-64))}static fromX64_Decimal(e){return e.mul(Vn.pow(2,-64))}static fromX64_BN(e){return e.div(new _(2).pow(new _(64)))}static shiftRightRoundUp(e){let t=e.shrn(64);return e.mod(td).gt(kn)&&(t=t.add(Yr)),t}static divRoundUp(e,t){return e.mod(t).eq(kn)?e.div(t):e.div(t).add(new _(1))}static subUnderflowU128(e,t){return e.lt(t)?e.sub(t).add(Xk):e.sub(t)}static checkUnsignedSub(e,t){const n=e.sub(t);if(n.isNeg())throw new xn("Unsigned integer sub overflow","UnsignedIntegerOverflow");return n}static checkMul(e,t,n){const i=e.mul(t);if(this.isOverflow(i,n))throw new xn("Multiplication overflow","MultiplicationOverflow");return i}static checkMulDivFloor(e,t,n,i){if(n.eq(kn))throw new xn("Devide by zero","DivideByZero");const o=e.mul(t).div(n);if(this.isOverflow(o,i))throw new xn("Multiplication div overflow","MulDivOverflow");return o}static checkMulDivCeil(e,t,n,i){if(n.eq(kn))throw new xn("Devide by zero","DivideByZero");const o=e.mul(t).add(n.sub(Yr)).div(n);if(this.isOverflow(o,i))throw new xn("Multiplication div overflow","MulDivOverflow");return o}static checkMulDivRound(e,t,n,i){if(n.eq(kn))throw new xn("Devide by zero","DivideByZero");const o=e.mul(t.add(n.shrn(1))).div(n);if(this.isOverflow(o,i))throw new xn("Multiplication div overflow","MulDivOverflow");return o}static checkMulShiftRight(e,t,n,i){const o=e.mul(t).div(new _(2).pow(new _(n)));if(this.isOverflow(o,i))throw new xn("Multiplication shift right overflow","MulShiftRightOverflow");return o}static checkMulShiftRight64RoundUpIf(e,t,n,i){const o=e.mul(t),r=i&&o.and(td).gt(kn)?o.shrn(64).add(Yr):o.shrn(64);if(this.isOverflow(r,n))throw new xn("Multiplication shift right overflow","MulShiftRightOverflow");return r}static checkMulShiftLeft(e,t,n,i){const o=e.mul(t).shln(n);if(this.isOverflow(o,i))throw new xn("Multiplication shift left overflow","MulShiftLeftOverflow");return o}static checkDivRoundUpIf(e,t,n){if(t.eq(kn))throw new xn("Devide by zero","DivideByZero");return n?this.divRoundUp(e,t):e.div(t)}static isOverflow(e,t){return e.gte(Xu.pow(new _(t)))}static sign(e){return e.testn(127)?1:0}static is_neg(e){return this.sign(e)===1}static abs_u128(e){return e.gt(kn)?e:this.u128_neg(e.subn(1))}static u128_neg(e){return e.uxor(new _("ffffffffffffffffffffffffffffffff",16))}static neg(e){return this.is_neg(e)?e.abs():this.neg_from(e)}static abs(e){return this.sign(e)===0?e:this.u128_neg(e.sub(new _(1)))}static neg_from(e){return e.eq(kn)?e:this.u128_neg(e).add(new _(1)).or(new _(1).shln(127))}},Vk=443636,Jk=-443636,fm="79226673515401279992447579055",pm="4295048016",Bf=new _(1e6),Ot="0x0000000000000000000000000000000000000000000000000000000000000006",Zk="pool_script",ed="pool_script_v2",Js="router",Al="router_with_partner",Qr="fetcher_script",Ef="utils",xl="custodian_v2",Yk="clob_v2",Qk="endpoints_v2",gm=(e=>(e.Deleted="Deleted",e.Exists="Exists",e.NotExists="NotExists",e))(gm||{});function et(e){if(e.config===void 0)throw new xn(`package: ${e.package_id}  not config in sdk SdkOptions`,"InvalidConfig");return e.config}var tS=14,eS="59543866431248",nS="184467440737095516",iS="15793534762490258745";function oS(e,t,n){const i=e.toTwos(n).shln(t);return i.imaskn(n+1),i.fromTwos(n)}function Ke(e,t,n){const i=e.toTwos(n).shrn(t);return i.imaskn(n-t+1),i.fromTwos(n-t)}function sS(e){let t;return e&1?t=new _("79232123823359799118286999567"):t=new _("79228162514264337593543950336"),e&2&&(t=Ke(t.mul(new _("79236085330515764027303304731")),96,256)),e&4&&(t=Ke(t.mul(new _("79244008939048815603706035061")),96,256)),e&8&&(t=Ke(t.mul(new _("79259858533276714757314932305")),96,256)),e&16&&(t=Ke(t.mul(new _("79291567232598584799939703904")),96,256)),e&32&&(t=Ke(t.mul(new _("79355022692464371645785046466")),96,256)),e&64&&(t=Ke(t.mul(new _("79482085999252804386437311141")),96,256)),e&128&&(t=Ke(t.mul(new _("79736823300114093921829183326")),96,256)),e&256&&(t=Ke(t.mul(new _("80248749790819932309965073892")),96,256)),e&512&&(t=Ke(t.mul(new _("81282483887344747381513967011")),96,256)),e&1024&&(t=Ke(t.mul(new _("83390072131320151908154831281")),96,256)),e&2048&&(t=Ke(t.mul(new _("87770609709833776024991924138")),96,256)),e&4096&&(t=Ke(t.mul(new _("97234110755111693312479820773")),96,256)),e&8192&&(t=Ke(t.mul(new _("119332217159966728226237229890")),96,256)),e&16384&&(t=Ke(t.mul(new _("179736315981702064433883588727")),96,256)),e&32768&&(t=Ke(t.mul(new _("407748233172238350107850275304")),96,256)),e&65536&&(t=Ke(t.mul(new _("2098478828474011932436660412517")),96,256)),e&131072&&(t=Ke(t.mul(new _("55581415166113811149459800483533")),96,256)),e&262144&&(t=Ke(t.mul(new _("38992368544603139932233054999993551")),96,256)),Ke(t,32,256)}function rS(e){const t=Math.abs(e);let n;return t&1?n=new _("18445821805675392311"):n=new _("18446744073709551616"),t&2&&(n=Ke(n.mul(new _("18444899583751176498")),64,256)),t&4&&(n=Ke(n.mul(new _("18443055278223354162")),64,256)),t&8&&(n=Ke(n.mul(new _("18439367220385604838")),64,256)),t&16&&(n=Ke(n.mul(new _("18431993317065449817")),64,256)),t&32&&(n=Ke(n.mul(new _("18417254355718160513")),64,256)),t&64&&(n=Ke(n.mul(new _("18387811781193591352")),64,256)),t&128&&(n=Ke(n.mul(new _("18329067761203520168")),64,256)),t&256&&(n=Ke(n.mul(new _("18212142134806087854")),64,256)),t&512&&(n=Ke(n.mul(new _("17980523815641551639")),64,256)),t&1024&&(n=Ke(n.mul(new _("17526086738831147013")),64,256)),t&2048&&(n=Ke(n.mul(new _("16651378430235024244")),64,256)),t&4096&&(n=Ke(n.mul(new _("15030750278693429944")),64,256)),t&8192&&(n=Ke(n.mul(new _("12247334978882834399")),64,256)),t&16384&&(n=Ke(n.mul(new _("8131365268884726200")),64,256)),t&32768&&(n=Ke(n.mul(new _("3584323654723342297")),64,256)),t&65536&&(n=Ke(n.mul(new _("696457651847595233")),64,256)),t&131072&&(n=Ke(n.mul(new _("26294789957452057")),64,256)),t&262144&&(n=Ke(n.mul(new _("37481735321082")),64,256)),n}var he=class{static priceToSqrtPriceX64(e,t,n){return uo.toX64(e.mul(Vn.pow(10,n-t)).sqrt())}static sqrtPriceX64ToPrice(e,t,n){return uo.fromX64(e).pow(2).mul(Vn.pow(10,t-n))}static tickIndexToSqrtPriceX64(e){return e>0?new _(sS(e)):new _(rS(e))}static sqrtPriceX64ToTickIndex(e){if(e.gt(new _(fm))||e.lt(new _(pm)))throw new xn("Provided sqrtPrice is not within the supported sqrtPrice range.","InvalidSqrtPrice");const t=e.bitLength()-1,n=new _(t-64),i=oS(n,32,128);let o=new _("8000000000000000","hex"),s=0,r=new _(0),a=t>=64?e.shrn(t-63):e.shln(63-t);for(;o.gt(new _(0))&&s<tS;){a=a.mul(a);const b=a.shrn(127);a=a.shrn(63+b.toNumber()),r=r.add(o.mul(b)),o=o.shrn(1),s+=1}const c=r.shrn(32),l=i.add(c).mul(new _(eS)),d=Ke(l.sub(new _(nS)),64,128).toNumber(),h=Ke(l.add(new _(iS)),64,128).toNumber();return d===h?d:he.tickIndexToSqrtPriceX64(h).lte(e)?h:d}static tickIndexToPrice(e,t,n){return he.sqrtPriceX64ToPrice(he.tickIndexToSqrtPriceX64(e),t,n)}static priceToTickIndex(e,t,n){return he.sqrtPriceX64ToTickIndex(he.priceToSqrtPriceX64(e,t,n))}static priceToInitializableTickIndex(e,t,n,i){return he.getInitializableTickIndex(he.priceToTickIndex(e,t,n),i)}static getInitializableTickIndex(e,t){return e-e%t}static getNextInitializableTickIndex(e,t){return he.getInitializableTickIndex(e,t)+t}static getPrevInitializableTickIndex(e,t){return he.getInitializableTickIndex(e,t)-t}};new _(365);new _(24);new _(3600);new _(.5);var Fo=class{static getDefaultSqrtPriceLimit(e){return new _(e?pm:fm)}static getDefaultOtherAmountThreshold(e){return e?kn:td}};function Ja(e,t,n){const i=_.min(e,t),o=_.max(e,t),s=uo.fromX64_BN(n.mul(o).mul(i)),r=o.sub(i);return s.div(r)}function Za(e,t,n){const i=_.min(e,t),s=_.max(e,t).sub(i);return n.shln(64).div(s)}var Hn=class{static updateFeeRate(e,t,n,i,o){const s=uo.checkMulDivCeil(t,new _(i),Bf,64),r=n===0?kn:uo.checkMulDivFloor(t,new _(n),Bf,64),a=t.mul(s).mul(r);if(o?e.feeProtocolCoinA=e.feeProtocolCoinA.add(s):e.feeProtocolCoinB=e.feeProtocolCoinB.add(s),a.eq(kn)||e.liquidity.eq(kn))return{refFee:r,clmm:e};const c=a.shln(64).div(e.liquidity);return o?e.feeGrowthGlobalA=e.feeGrowthGlobalA.add(c):e.feeGrowthGlobalB=e.feeGrowthGlobalB.add(c),{refFee:r,clmm:e}}static getCoinAmountFromLiquidity(e,t,n,i,o){const s=new Vn(e.toString()),r=new Vn(t.toString()),a=new Vn(n.toString()),c=new Vn(i.toString());let u,l;return t.lt(n)?(u=uo.toX64_Decimal(s).mul(c.sub(a)).div(a.mul(c)),l=new Vn(0)):t.lt(i)?(u=uo.toX64_Decimal(s).mul(c.sub(r)).div(r.mul(c)),l=uo.fromX64_Decimal(s.mul(r.sub(a)))):(u=new Vn(0),l=uo.fromX64_Decimal(s.mul(c.sub(a)))),o?{coinA:new _(u.ceil().toString()),coinB:new _(l.ceil().toString())}:{coinA:new _(u.floor().toString()),coinB:new _(l.floor().toString())}}static estLiquidityAndcoinAmountFromOneAmounts(e,t,n,i,o,s,r){const a=he.sqrtPriceX64ToTickIndex(r),c=he.tickIndexToSqrtPriceX64(e),u=he.tickIndexToSqrtPriceX64(t);let l;if(a<e){if(!i)throw new xn("lower tick cannot calculate liquidity by coinB","NotSupportedThisCoin");l=Ja(c,u,n)}else if(a>t){if(i)throw new xn("upper tick cannot calculate liquidity by coinA","NotSupportedThisCoin");l=Za(u,c,n)}else i?l=Ja(r,u,n):l=Za(r,c,n);const d=Hn.getCoinAmountFromLiquidity(l,r,c,u,o),h=o?N(d.coinA.toString()).mul(1+s).toString():N(d.coinA.toString()).mul(1-s).toString(),g=o?N(d.coinB.toString()).mul(1+s).toString():N(d.coinB.toString()).mul(1-s).toString();return{coinAmountA:d.coinA,coinAmountB:d.coinB,tokenMaxA:o?new _(Vn.ceil(h).toString()):new _(Vn.floor(h).toString()),tokenMaxB:o?new _(Vn.ceil(g).toString()):new _(Vn.floor(g).toString()),liquidityAmount:l,fix_amount_a:i}}static estimateLiquidityFromcoinAmounts(e,t,n,i){if(t>n)throw new xn("lower tick cannot be greater than lower tick","InvalidTwoTickIndex");const o=he.sqrtPriceX64ToTickIndex(e),s=he.tickIndexToSqrtPriceX64(t),r=he.tickIndexToSqrtPriceX64(n);if(o<t)return Ja(s,r,i.coinA);if(o>=n)return Za(r,s,i.coinB);const a=Ja(e,r,i.coinA),c=Za(e,s,i.coinB);return _.min(a,c)}static estCoinAmountsFromTotalAmount(e,t,n,i,o,s){const{ratioA:r,ratioB:a}=Hn.calculateDepositRatioFixTokenA(e,t,n),c=N(i).mul(r).div(o),u=N(i).mul(a).div(s);return{amountA:c,amountB:u}}static calculateDepositRatioFixTokenA(e,t,n){const i=new _(1e8),{coinAmountB:o}=Hn.estLiquidityAndcoinAmountFromOneAmounts(e,t,i,!0,!0,0,n),s=he.sqrtPriceX64ToPrice(n,0,0),r=N(i.toString()).mul(s),a=r.add(o.toString()),c=r.div(a),u=N(o.toString()).div(a);return{ratioA:c,ratioB:u}}};function aS(e){return e.startsWith("0x")?`${e.slice(2)}`:e}var cS=0,_m=1,uS=2;function If(e,t){return e===t?cS:e<t?_m:uS}function lS(e,t){let n=0;const i=e.length<=t.length?e.length:t.length,o=If(e.length,t.length);for(;n<i;){const s=If(e.charCodeAt(n),t.charCodeAt(n));if(n+=1,s!==0)return s}return o}function dS(e,t){return lS(e,t)===_m}function Uc(e,...t){const n=Array.isArray(t[t.length-1])?t.pop():[];let o=[e,...t].filter(Boolean).join("::");return n&&n.length&&(o+=`<${n.join(", ")}>`),o}function Ct(e){var t;try{let n=e.replace(/\s/g,"");const i=n.match(/(<.+>)$/),o=(t=i==null?void 0:i[0])==null?void 0:t.match(/(\w+::\w+::\w+)(?:<.*?>(?!>))?/g);if(o){n=n.slice(0,n.indexOf("<"));const u={...Ct(n),type_arguments:o.map(l=>Ct(l).source_address)};return u.type_arguments=u.type_arguments.map(l=>Qe.isSuiCoin(l)?l:Ct(l).source_address),u.source_address=Uc(u.full_address,u.type_arguments),u}const s=n.split("::"),a={full_address:n,address:n===qc||n===gS?"0x2":Dn(s[0]),module:s[1],name:s[2],type_arguments:[],source_address:""};return a.full_address=`${a.address}::${a.module}::${a.name}`,a.source_address=Uc(a.full_address,a.type_arguments),a}catch{return{full_address:e,address:"",module:"",name:"",type_arguments:[],source_address:e}}}function oo(e){return Ct(e).source_address}function hS(e){return e.toLowerCase().startsWith("0x")?Dn(e):e}function mm(e){for(const t in e){const n=typeof e[t];if(n==="object")mm(e[t]);else if(n==="string"){const i=e[t];i&&!i.includes("::")&&(e[t]=hS(i))}}}var fS="0x2::coin::Coin",pS=/^0x2::coin::Coin<(.+)>$/,qc="0x2::sui::SUI",gS="0x0000000000000000000000000000000000000000000000000000000000000002::sui::SUI",Qe=class{static getCoinTypeArg(e){const t=e.type.match(pS);return t?t[1]:null}static isSUI(e){const t=Qe.getCoinTypeArg(e);return t?Qe.getCoinSymbol(t)==="SUI":!1}static getCoinSymbol(e){return e.substring(e.lastIndexOf(":")+1)}static getBalance(e){return BigInt(e.fields.balance)}static totalBalance(e,t){let n=BigInt(0);return e.forEach(i=>{t===i.coinAddress&&(n+=BigInt(i.balance))}),n}static getID(e){return e.fields.id.id}static getCoinTypeFromArg(e){return`${fS}<${e}>`}static getFaucetCoins(e){const{events:t}=e,n=[];return t==null||t.forEach(i=>{const{type:o}=i;if(Ct(o).name==="InitEvent"){const s=i.parsedJson;n.push({transactionModule:i.transactionModule,suplyID:s.suplyID,decimals:s.decimals})}}),n}static getCoinAssets(e,t){const n=[];return t.forEach(i=>{oo(i.coinAddress)===oo(e)&&n.push(i)}),n}static isSuiCoin(e){return Ct(e).full_address===qc}static selectCoinObjectIdGreaterThanOrEqual(e,t,n=[]){const i=Qe.selectCoinAssetGreaterThanOrEqual(e,t,n),o=i.selectedCoins.map(a=>a.coinObjectId),s=i.remainingCoins,r=i.selectedCoins.map(a=>a.balance.toString());return{objectArray:o,remainCoins:s,amountArray:r}}static selectCoinAssetGreaterThanOrEqual(e,t,n=[]){const i=Qe.sortByBalance(e.filter(c=>!n.includes(c.coinObjectId))),o=Qe.calculateTotalBalance(i);if(o<t)return{selectedCoins:[],remainingCoins:i};if(o===t)return{selectedCoins:i,remainingCoins:[]};let s=BigInt(0);const r=[],a=[...i];for(;s<o;){const c=t-s,u=a.findIndex(d=>d.balance>=c);if(u!==-1){r.push(a[u]),a.splice(u,1);break}const l=a.pop();l.balance>0&&(r.push(l),s+=l.balance)}return{selectedCoins:Qe.sortByBalance(r),remainingCoins:Qe.sortByBalance(a)}}static sortByBalance(e){return e.sort((t,n)=>t.balance<n.balance?-1:t.balance>n.balance?1:0)}static sortByBalanceDes(e){return e.sort((t,n)=>t.balance>n.balance?-1:t.balance<n.balance?0:1)}static calculateTotalBalance(e){return e.reduce((t,n)=>t+n.balance,BigInt(0))}},ta=class{constructor(e,t){qt(this,"numerator");qt(this,"denominator");this.toString=()=>`${this.numerator.toString()}/${this.denominator.toString()}`,this.numerator=e,this.denominator=t}static fromDecimal(e){return ta.fromFraction(e.toDecimalPlaces(1).mul(10).toNumber(),1e3)}static fromFraction(e,t){const n=typeof e=="number"?new _(e.toString()):e,i=typeof t=="number"?new _(t.toString()):t;return new ta(n,i)}};function nd(e,{numerator:t,denominator:n},i){return i?e.mul(n.add(t)).div(n):e.mul(n).div(n.add(t))}function kl(e,t,n){return{tokenMaxA:nd(e.coinA,t,n),tokenMaxB:nd(e.coinB,t,n)}}function N(e){return it.isDecimal(e)?e:new it(e===void 0?0:e)}function _S(e){return N(10).pow(N(e).abs())}function Ua(e){return e.data}function ym(e){if(e.error&&"object_id"in e.error&&"version"in e.error&&"digest"in e.error){const{error:t}=e;return{objectId:t.object_id,version:t.version,digest:t.digest}}}function wm(e){if(e.error&&"object_id"in e.error&&!("version"in e.error)&&!("digest"in e.error))return e.error.object_id}function mS(e){if("reference"in e)return e.reference;const t=Ua(e);return t?{objectId:t.objectId,version:t.version,digest:t.digest}:ym(e)}function da(e){var t;return"objectId"in e?e.objectId:((t=mS(e))==null?void 0:t.objectId)??wm(e)}function yS(e){return e.data!==void 0}function wS(e){return e.content!==void 0}function bm(e){const t="data"in e?Ua(e):e;if(!(!t||!wS(t)||t.content.dataType!=="moveObject"))return t.content}function ro(e){var t;return(t=bm(e))==null?void 0:t.type}function xr(e){var n;const t=yS(e)?e.data:e;return!(t!=null&&t.type)&&"data"in e?((n=t==null?void 0:t.content)==null?void 0:n.dataType)==="package"?"package":ro(e):t==null?void 0:t.type}function vm(e){var t;return(t=Ua(e))==null?void 0:t.previousTransaction}function Mc(e){var t;return(t=Ua(e))==null?void 0:t.owner}function bS(e){var n;const t=(n=Ua(e))==null?void 0:n.display;return t||{data:null,error:null}}function Oe(e){var n;const t=(n=bm(e))==null?void 0:n.fields;if(t)return"fields"in t?t.fields:t}function vS(e,t){const n=_S(N(t));return Number(N(e).mul(n))}function Ho(e,t=32){return BigInt.asUintN(t,BigInt(e)).toString()}function _i(e,t=32){return Number(BigInt.asIntN(t,BigInt(e)))}function Vu(e){const t=bS(e).data,n={creator:"",description:"",image_url:"",link:"",name:"",project_url:""};return t&&(n.creator=t.creator,n.description=t.description,n.image_url=t.image_url,n.link=t.link,n.name=t.name,n.project_url=t.project_url),n}function oh(e){var r,a;if(e.error!=null||((a=(r=e.data)==null?void 0:r.content)==null?void 0:a.dataType)!=="moveObject")throw new xn(`Position not exists. Get Position error:${e.error}`,"InvalidPositionObject");let t={creator:"",description:"",image_url:"",link:"",name:"",project_url:""},n={...t,pos_object_id:"",owner:"",type:"",coin_type_a:"",coin_type_b:"",liquidity:"",tick_lower_index:0,tick_upper_index:0,index:0,pool:"",reward_amount_owed_0:"0",reward_amount_owed_1:"0",reward_amount_owed_2:"0",reward_growth_inside_0:"0",reward_growth_inside_1:"0",reward_growth_inside_2:"0",fee_growth_inside_a:"0",fee_owed_a:"0",fee_growth_inside_b:"0",fee_owed_b:"0",position_status:"Exists"},i=Oe(e);if(i){const c=ro(e),u=Mc(e);"nft"in i?(i=i.nft.fields,t.description=i.description,t.name=i.name,t.link=i.url):t=Vu(e),n={...t,pos_object_id:i.id.id,owner:u.AddressOwner,type:c,coin_type_a:i.coin_type_a.fields.name,coin_type_b:i.coin_type_b.fields.name,liquidity:i.liquidity,tick_lower_index:_i(BigInt(i.tick_lower_index.fields.bits)),tick_upper_index:_i(BigInt(i.tick_upper_index.fields.bits)),index:i.index,pool:i.pool,reward_amount_owed_0:"0",reward_amount_owed_1:"0",reward_amount_owed_2:"0",reward_growth_inside_0:"0",reward_growth_inside_1:"0",reward_growth_inside_2:"0",fee_growth_inside_a:"0",fee_owed_a:"0",fee_growth_inside_b:"0",fee_owed_b:"0",position_status:"Exists"}}const o=ym(e);o&&(n.pos_object_id=o.objectId,n.position_status="Deleted");const s=wm(e);return s&&(n.pos_object_id=s,n.position_status="NotExists"),n}function TS(e){const t=Qe.isSuiCoin(e.coinTypeA),n=Qe.isSuiCoin(e.coinTypeB);return{isAdjustCoinA:t,isAdjustCoinB:n}}function AS(e,t){return it.ceil(N(e).div(1+t)).toString()}var ne=class{static createCollectRewarderAndFeeParams(e,t,n,i,o,s){o===void 0&&(o=[...i]),s===void 0&&(s=[...i]);const r=oo(n.coinTypeA),a=oo(n.coinTypeB);if(n.collect_fee){const u=ne.buildCoinForAmount(t,o,BigInt(0),r,!1);o=u.remainCoins;const l=ne.buildCoinForAmount(t,s,BigInt(0),a,!1);s=l.remainCoins,t=e.Position.createCollectFeePaylod({pool_id:n.pool_id,pos_id:n.pos_id,coinTypeA:n.coinTypeA,coinTypeB:n.coinTypeB},t,u.targetCoin,l.targetCoin)}const c=[];return n.rewarder_coin_types.forEach(u=>{switch(oo(u)){case r:c.push(ne.buildCoinForAmount(t,o,BigInt(0),u,!1).targetCoin);break;case a:c.push(ne.buildCoinForAmount(t,s,BigInt(0),u,!1).targetCoin);break;default:c.push(ne.buildCoinForAmount(t,i,BigInt(0),u,!1).targetCoin);break}}),t=e.Rewarder.createCollectRewarderPaylod(n,t,c),t}static async adjustTransactionForGas(e,t,n,i){i.setSender(e.senderAddress);const o=Qe.selectCoinAssetGreaterThanOrEqual(t,n).selectedCoins;if(o.length===0)throw new xn("Insufficient balance","InsufficientBalance");const s=Qe.calculateTotalBalance(t);if(s-n>1e9)return{fixAmount:n};const r=await e.fullClient.calculationTxGas(i);if(Qe.selectCoinAssetGreaterThanOrEqual(t,BigInt(r),o.map(c=>c.coinObjectId)).selectedCoins.length===0){const c=BigInt(r)+BigInt(500);if(s-n<c){if(n-=c,n<0)throw new xn("gas Insufficient balance","InsufficientBalance");const u=new _t;return{fixAmount:n,newTx:u}}}return{fixAmount:n}}static async buildAddLiquidityFixTokenForGas(e,t,n,i){let o=await ne.buildAddLiquidityFixToken(e,t,n);const{isAdjustCoinA:s}=TS(n),r=s?n.amount_a:n.amount_b,a=await ne.adjustTransactionForGas(e,Qe.getCoinAssets(s?n.coinTypeA:n.coinTypeB,t),BigInt(r),o),{fixAmount:c}=a,{newTx:u}=a;if(u!==void 0){let l,d;if(s)n.amount_a=Number(c),l=ne.buildAddLiquidityFixTokenCoinInput(u,!n.fix_amount_a,c.toString(),n.slippage,n.coinTypeA,t,!1),d=ne.buildAddLiquidityFixTokenCoinInput(u,n.fix_amount_a,n.amount_b,n.slippage,n.coinTypeB,t,!1);else return n.amount_b=Number(c),l=ne.buildAddLiquidityFixTokenCoinInput(u,!n.fix_amount_a,n.amount_a,n.slippage,n.coinTypeA,t,!1),d=ne.buildAddLiquidityFixTokenCoinInput(u,n.fix_amount_a,c.toString(),n.slippage,n.coinTypeB,t,!1),n=ne.fixAddLiquidityFixTokenParams(n,i.slippage,i.curSqrtPrice),o=await ne.buildAddLiquidityFixTokenArgs(u,e,t,n,l,d),o}return o}static async buildAddLiquidityFixToken(e,t,n){if(e.senderAddress.length===0)throw Error("this config sdk senderAddress is empty");let i=new _t;const o=ne.buildAddLiquidityFixTokenCoinInput(i,!n.fix_amount_a,n.amount_a,n.slippage,n.coinTypeA,t,!1),s=ne.buildAddLiquidityFixTokenCoinInput(i,n.fix_amount_a,n.amount_b,n.slippage,n.coinTypeB,t,!1);return i=ne.buildAddLiquidityFixTokenArgs(i,e,t,n,o,s),i}static buildAddLiquidityFixTokenCoinInput(e,t,n,i,o,s,r=!0){return t?ne.buildCoinForAmountInterval(e,s,{amountSecond:BigInt(AS(n,i)),amountFirst:BigInt(n)},o,r):ne.buildCoinForAmount(e,s,BigInt(n),o,r)}static fixAddLiquidityFixTokenParams(e,t,n){const i=e.fix_amount_a?e.amount_a:e.amount_b,o=Hn.estLiquidityAndcoinAmountFromOneAmounts(Number(e.tick_lower),Number(e.tick_upper),new _(i),e.fix_amount_a,!0,t,n);return e.amount_a=e.fix_amount_a?e.amount_a:o.tokenMaxA.toNumber(),e.amount_b=e.fix_amount_a?o.tokenMaxB.toNumber():e.amount_b,e}static buildAddLiquidityFixTokenArgs(e,t,n,i,o,s){const r=[i.coinTypeA,i.coinTypeB],a=i.is_open?"open_position_with_liquidity_by_fix_coin":"add_liquidity_by_fix_coin",{clmm_pool:c,integrate:u}=t.sdkOptions;i.is_open||(e=ne.createCollectRewarderAndFeeParams(t,e,i,n,o.remainCoins,s.remainCoins));const l=et(c),d=i.is_open?[e.object(l.global_config_id),e.object(i.pool_id),e.pure(Ho(BigInt(i.tick_lower)).toString()),e.pure(Ho(BigInt(i.tick_upper)).toString()),o.targetCoin,s.targetCoin,e.pure(i.amount_a),e.pure(i.amount_b),e.pure(i.fix_amount_a),e.object(Ot)]:[e.object(l.global_config_id),e.object(i.pool_id),e.object(i.pos_id),o.targetCoin,s.targetCoin,e.pure(i.amount_a),e.pure(i.amount_b),e.pure(i.fix_amount_a),e.object(Ot)];return e.moveCall({target:`${u.published_at}::${ed}::${a}`,typeArguments:r,arguments:d}),e}static async buildSwapTransactionForGas(e,t,n,i){let o=ne.buildSwapTransaction(e,t,n);o.setSender(e.senderAddress);const s=await ne.adjustTransactionForGas(e,Qe.getCoinAssets(t.a2b?t.coinTypeA:t.coinTypeB,n),BigInt(t.by_amount_in?t.amount:t.amount_limit),o),{fixAmount:r,newTx:a}=s;if(a!==void 0){a.setSender(e.senderAddress),t.by_amount_in?t.amount=r.toString():t.amount_limit=r.toString(),t=await ne.fixSwapParams(e,t,i);const c=ne.buildCoinForAmount(o,n,t.a2b?BigInt(t.by_amount_in?t.amount:t.amount_limit):BigInt(0),t.coinTypeA),u=ne.buildCoinForAmount(o,n,t.a2b?BigInt(0):BigInt(t.by_amount_in?t.amount:t.amount_limit),t.coinTypeB);o=ne.buildSwapTransactionArgs(a,t,e.sdkOptions,c,u)}return o}static buildSwapTransaction(e,t,n){let i=new _t;i.setSender(e.senderAddress);const o=ne.buildCoinForAmount(i,n,t.a2b?BigInt(t.by_amount_in?t.amount:t.amount_limit):BigInt(0),t.coinTypeA,!1),s=ne.buildCoinForAmount(i,n,t.a2b?BigInt(0):BigInt(t.by_amount_in?t.amount:t.amount_limit),t.coinTypeB,!1);return i=ne.buildSwapTransactionArgs(i,t,e.sdkOptions,o,s),i}static buildSwapTransactionArgs(e,t,n,i,o){const{clmm_pool:s,integrate:r}=n,a=Fo.getDefaultSqrtPriceLimit(t.a2b),c=[t.coinTypeA,t.coinTypeB],{global_config_id:u}=et(s);if(u===void 0)throw Error("clmm.config.global_config_id is undefined");const l=t.swap_partner!==void 0,d=l?t.a2b?"swap_a2b_with_partner":"swap_b2a_with_partner":t.a2b?"swap_a2b":"swap_b2a",h=l?[e.pure(u),e.pure(t.pool_id),e.pure(t.swap_partner),i.targetCoin,o.targetCoin,e.pure(t.by_amount_in),e.pure(t.amount),e.pure(t.amount_limit),e.pure(a.toString()),e.pure(Ot)]:[e.pure(u),e.pure(t.pool_id),i.targetCoin,o.targetCoin,e.pure(t.by_amount_in),e.pure(t.amount),e.pure(t.amount_limit),e.pure(a.toString()),e.pure(Ot)];return e.moveCall({target:`${r.published_at}::${ed}::${d}`,typeArguments:c,arguments:h}),e}static async buildSwapTransactionWithoutTransferCoinsForGas(e,t,n,i){let{tx:o,coinABs:s}=ne.buildSwapTransactionWithoutTransferCoins(e,t,n);o.setSender(e.senderAddress);const r=await ne.adjustTransactionForGas(e,Qe.getCoinAssets(t.a2b?t.coinTypeA:t.coinTypeB,n),BigInt(t.by_amount_in?t.amount:t.amount_limit),o),{fixAmount:a,newTx:c}=r;if(c!==void 0){c.setSender(e.senderAddress),t.by_amount_in?t.amount=a.toString():t.amount_limit=a.toString(),t=await ne.fixSwapParams(e,t,i);const u=ne.buildCoinForAmount(o,n,t.a2b?BigInt(t.by_amount_in?t.amount:t.amount_limit):BigInt(0),t.coinTypeA,!1,!0),l=ne.buildCoinForAmount(o,n,t.a2b?BigInt(0):BigInt(t.by_amount_in?t.amount:t.amount_limit),t.coinTypeB,!1,!0),d=ne.buildSwapTransactionWithoutTransferCoinArgs(e,c,t,e.sdkOptions,u,l);o=d.tx,s=d.txRes}return{tx:o,coinABs:s}}static buildSwapTransactionWithoutTransferCoins(e,t,n){const i=new _t;i.setSender(e.senderAddress);const o=ne.buildCoinForAmount(i,n,t.a2b?BigInt(t.by_amount_in?t.amount:t.amount_limit):BigInt(0),t.coinTypeA,!1,!0),s=ne.buildCoinForAmount(i,n,t.a2b?BigInt(0):BigInt(t.by_amount_in?t.amount:t.amount_limit),t.coinTypeB,!1,!0),r=ne.buildSwapTransactionWithoutTransferCoinArgs(e,i,t,e.sdkOptions,o,s);return{tx:r.tx,coinABs:r.txRes}}static buildSwapTransactionWithoutTransferCoinArgs(e,t,n,i,o,s){const{clmm_pool:r,integrate:a}=i,c=Fo.getDefaultSqrtPriceLimit(n.a2b),{global_config_id:u}=et(r);if(u===void 0)throw Error("clmm.config.global_config_id is undefined");const l=n.swap_partner!==void 0,d=l?"swap_with_partner":"swap",h=l?Al:Js,g=l?[t.pure(u),t.pure(n.pool_id),t.pure(n.swap_partner),o.targetCoin,s.targetCoin,t.pure(n.a2b),t.pure(n.by_amount_in),t.pure(n.amount),t.pure(c.toString()),t.pure(!1),t.pure(Ot)]:[t.pure(u),t.pure(n.pool_id),o.targetCoin,s.targetCoin,t.pure(n.a2b),t.pure(n.by_amount_in),t.pure(n.amount),t.pure(c.toString()),t.pure(!1),t.pure(Ot)],b=[n.coinTypeA,n.coinTypeB],v=t.moveCall({target:`${a.published_at}::${h}::${d}`,typeArguments:b,arguments:g});if(n.by_amount_in){const x=n.a2b?n.coinTypeB:n.coinTypeA,P=n.a2b?v[1]:v[0],E=Number(n.amount_limit);this.checkCoinThreshold(e,n.by_amount_in,t,P,E,x)}return{tx:t,txRes:v}}static async fixSwapParams(e,t,n){const{currentPool:i}=n;try{const o=await e.Swap.preswap({decimalsA:n.decimalsA,decimalsB:n.decimalsB,a2b:t.a2b,byAmountIn:t.by_amount_in,amount:t.amount,pool:i,currentSqrtPrice:i.current_sqrt_price,coinTypeA:i.coinTypeA,coinTypeB:i.coinTypeB}),s=n.byAmountIn?o.estimatedAmountOut:o.estimatedAmountIn,r=nd(s,n.slippage,!n.byAmountIn);t.amount_limit=r.toString()}catch(o){console.log("fixSwapParams",o)}return t}static async syncBuildCoinInputForAmount(e,t,n,i,o=!0){if(e.senderAddress.length===0)throw Error("this config sdk senderAddress is empty");const s=await e.getOwnerCoinAssets(e.senderAddress,i);return ne.buildCoinForAmount(t,s,n,i,o).targetCoin}static buildCoinForAmount(e,t,n,i,o=!0,s=!1){const r=Qe.getCoinAssets(i,t);if(n===BigInt(0)&&r.length===0)return ne.buildZeroValueCoin(t,e,i,o);const a=Qe.calculateTotalBalance(r);if(a<n)throw new xn(`The amount(${a}) is Insufficient balance for ${i} , expect ${n} `,"InsufficientBalance");return ne.buildCoin(e,t,r,n,i,o,s)}static buildCoin(e,t,n,i,o,s=!0,r=!1){if(Qe.isSuiCoin(o)){if(s){const E=e.splitCoins(e.gas,[e.pure(i.toString())]);return{targetCoin:e.makeMoveVec({objects:[E]}),remainCoins:t,tragetCoinAmount:i.toString(),isMintZeroCoin:!1,originalSplitedCoin:e.gas}}if(i===0n&&n.length>1){const E=Qe.selectCoinObjectIdGreaterThanOrEqual(n,i);return{targetCoin:e.object(E.objectArray[0]),remainCoins:E.remainCoins,tragetCoinAmount:E.amountArray[0],isMintZeroCoin:!1}}const x=Qe.selectCoinObjectIdGreaterThanOrEqual(n,i);return{targetCoin:e.splitCoins(e.gas,[e.pure(i.toString())]),remainCoins:x.remainCoins,tragetCoinAmount:i.toString(),isMintZeroCoin:!1,originalSplitedCoin:e.gas}}const a=Qe.selectCoinObjectIdGreaterThanOrEqual(n,i),c=a.amountArray.reduce((x,P)=>Number(x)+Number(P),0).toString(),u=a.objectArray;if(s)return{targetCoin:e.makeMoveVec({objects:u.map(x=>e.object(x))}),remainCoins:a.remainCoins,tragetCoinAmount:a.amountArray.reduce((x,P)=>Number(x)+Number(P),0).toString(),isMintZeroCoin:!1};const[l,...d]=u,h=e.object(l);let g=h,b=a.amountArray.reduce((x,P)=>Number(x)+Number(P),0).toString(),v;return d.length>0&&e.mergeCoins(h,d.map(x=>e.object(x))),r&&Number(c)>Number(i)&&(g=e.splitCoins(h,[e.pure(i.toString())]),b=i.toString(),v=h),{targetCoin:g,remainCoins:a.remainCoins,originalSplitedCoin:v,tragetCoinAmount:b,isMintZeroCoin:!1}}static buildZeroValueCoin(e,t,n,i=!0){const o=ne.callMintZeroValueCoin(t,n);let s;return i?s=t.makeMoveVec({objects:[o]}):s=o,{targetCoin:s,remainCoins:e,isMintZeroCoin:!0,tragetCoinAmount:"0"}}static buildCoinForAmountInterval(e,t,n,i,o=!0){const s=Qe.getCoinAssets(i,t);if(n.amountFirst===BigInt(0))return s.length>0?ne.buildCoin(e,[...t],[...s],n.amountFirst,i,o):ne.buildZeroValueCoin(t,e,i,o);const r=Qe.calculateTotalBalance(s);if(r>=n.amountFirst)return ne.buildCoin(e,[...t],[...s],n.amountFirst,i,o);if(r<n.amountSecond)throw new xn(`The amount(${r}) is Insufficient balance for ${i} , expect ${n.amountSecond} `,"InsufficientBalance");return ne.buildCoin(e,[...t],[...s],n.amountSecond,i,o)}static async buildRouterSwapTransaction(e,t,n,i,o){let s=new _t;return t.paths.length>1&&(t.partner=""),s=await this.buildRouterBasePathTx(e,t,n,i,s,o),s}static async buildRouterBasePathTx(e,t,n,i,o,s){const r=t.paths.filter(S=>S&&S.poolAddress),a=Number(r.reduce((S,T)=>S.add(T.amountIn),kn).toString()),c=Number(r.reduce((S,T)=>S.add(T.amountOut),kn).toString()),u=Math.round(n?Number(c.toString())*(1-t.priceSlippagePoint):Number(a.toString())*(1+t.priceSlippagePoint)),l=t.paths[0].coinType[0],d=t.paths[0].coinType[t.paths[0].coinType.length-1],h=ne.buildCoinForAmount(o,i,BigInt(n?a:u),l,!1,!0),g=h.originalSplitedCoin!==void 0,b=ne.buildCoinForAmount(o,i,0n,d,!1),v=await this.buildRouterBasePathReturnCoins(e,t,n,h,b,o),x=[],{toCoin:P,fromCoin:E}=v;if(o=v.tx,b.isMintZeroCoin?x.push({coinType:d,coin:P}):b.originalSplitedCoin!==void 0?o.mergeCoins(b.originalSplitedCoin,[P]):o.mergeCoins(b.targetCoin,[P]),g){const S=h==null?void 0:h.originalSplitedCoin;o.mergeCoins(S,[E])}else x.push({coinType:l,coin:E});for(let S=0;S<x.length;S++)this.buildTransferCoin(e,o,x[S].coin,x[S].coinType,s);return o}static async buildRouterBasePathReturnCoins(e,t,n,i,o,s){const{clmm_pool:r,integrate:a}=e.sdkOptions,c=et(r).global_config_id,u=t.paths.filter(S=>S&&S.poolAddress),l=Number(u.reduce((S,T)=>S.add(T.amountIn),kn).toString()),d=Number(u.reduce((S,T)=>S.add(T.amountOut),kn).toString()),h=Math.round(n?Number(d.toString())*(1-t.priceSlippagePoint):Number(l.toString())*(1+t.priceSlippagePoint)),g=t.paths[0].coinType[0],b=t.paths[0].coinType[t.paths[0].coinType.length-1];let v=i.targetCoin,x;o.isMintZeroCoin||o.originalSplitedCoin!==void 0?x=o.targetCoin:x=ne.callMintZeroValueCoin(s,b);const P=t.partner==="",E=P?Js:Al;for(const S of u)if(S.poolAddress.length===1){const T=S.a2b[0],R={amount:Number(S.amountIn.toString()),amountLimit:h,poolCoinA:S.a2b[0]?g:b,poolCoinB:S.a2b[0]?b:g},K=P?"swap":"swap_with_partner",V=T?v:x,W=T?x:v,tt=n?S.amountIn.toString():S.amountOut.toString(),j=Fo.getDefaultSqrtPriceLimit(T).toString(),$=P?[s.object(c),s.object(S.poolAddress[0]),V,W,s.pure(T),s.pure(n),s.pure(tt),s.pure(j),s.pure(!1),s.object(Ot)]:[s.object(c),s.object(S.poolAddress[0]),s.pure(t.partner),V,W,s.pure(T),s.pure(n),s.pure(tt),s.pure(j),s.pure(!1),s.object(Ot)],q=[R.poolCoinA,R.poolCoinB],A=s.moveCall({target:`${e.sdkOptions.integrate.published_at}::${E}::${K}`,typeArguments:q,arguments:$});v=T?A[0]:A[1],x=T?A[1]:A[0]}else{const T=n?S.amountIn:S.rawAmountLimit[0],R=n?0:S.amountOut;let K="";S.a2b[0]?S.a2b[1]?K="swap_ab_bc":K="swap_ab_cb":S.a2b[1]?K="swap_ba_bc":K="swap_ba_cb",P||(K=`${K}_with_partner`);const V=Fo.getDefaultSqrtPriceLimit(S.a2b[0]),W=Fo.getDefaultSqrtPriceLimit(S.a2b[1]),tt=P?[s.object(c),s.object(S.poolAddress[0]),s.object(S.poolAddress[1]),v,x,s.pure(n),s.pure(T.toString()),s.pure(R.toString()),s.pure(V.toString()),s.pure(W.toString()),s.object(Ot)]:[s.object(c),s.object(S.poolAddress[0]),s.object(S.poolAddress[1]),s.pure(t.partner),v,x,s.pure(n),s.pure(T.toString()),s.pure(R.toString()),s.pure(V.toString()),s.pure(W.toString()),s.object(Ot)],j=[S.coinType[0],S.coinType[1],S.coinType[2]],$=s.moveCall({target:`${a.published_at}::${E}::${K}`,typeArguments:j,arguments:tt});v=$[0],x=$[1]}return this.checkCoinThreshold(e,n,s,x,h,b),{fromCoin:v,toCoin:x,tx:s}}static async buildAggregatorSwapReturnCoins(e,t,n,i,o,s,r,a){if(a==null){if(e.senderAddress.length===0)throw Error("recipient and this config sdk senderAddress all not set");a=e.senderAddress}t.splitPaths.length>1&&(o="");let c,u;const l=t.splitPaths.some(d=>d.basePaths.some(h=>h.label==="Deepbook"));if((!t.byAmountIn||t.splitPaths.length===1)&&!l){const d=[];for(const b of t.splitPaths){const v=[],x=[],P=[],E=[];for(let T=0;T<b.basePaths.length;T+=1){const R=b.basePaths[T];v.push(R.direction),x.push(R.poolAddress),P.push(new _(R.inputAmount.toString())),T===0?E.push(R.fromCoin,R.toCoin):E.push(R.toCoin)}const S={amountIn:new _(b.inputAmount.toString()),amountOut:new _(b.outputAmount.toString()),poolAddress:x,a2b:v,rawAmountLimit:P,isExceed:!1,coinType:E};d.push(S)}const h={paths:d,partner:o,priceSlippagePoint:s},g=await this.buildRouterBasePathReturnCoins(e,h,t.byAmountIn,n,i,r);c=g.fromCoin,u=g.toCoin,r=g.tx}else{const d=Math.round(t.outputAmount*(1-s));c=n.targetCoin,i.isMintZeroCoin||i.originalSplitedCoin!==void 0?u=i.targetCoin:u=ne.callMintZeroValueCoin(r,t.toCoin);let h=!1,g;if(l){const[b,v]=Of.createAccountCap(a,e.sdkOptions,r);r=v,g=b,h=!0}for(let b=0;b<t.splitPaths.length;b+=1){const v=t.splitPaths[b];let x;for(let P=0;P<v.basePaths.length;P+=1){const E=v.basePaths[P];if(E.label==="Deepbook")if(P===0)if(v.basePaths.length===1){const S=this.buildDeepbookBasePathTx(e,E,r,g,c,u,!1);c=S.from,u=S.to}else{x=ne.callMintZeroValueCoin(r,E.toCoin);const S=this.buildDeepbookBasePathTx(e,E,r,g,c,x,!1);c=S.from,x=S.to}else{const S=this.buildDeepbookBasePathTx(e,E,r,g,x,u,!0);x=S.from,u=S.to}if(E.label==="Cetus")if(P===0)if(v.basePaths.length===1){const S=this.buildClmmBasePathTx(e,E,r,t.byAmountIn,c,u,!1,o);c=S.from,u=S.to}else{x=ne.callMintZeroValueCoin(r,E.toCoin);const S=this.buildClmmBasePathTx(e,E,r,t.byAmountIn,c,x,!1,o);c=S.from,x=S.to}else{const S=this.buildClmmBasePathTx(e,E,r,t.byAmountIn,x,u,!0,o);x=S.from,u=S.to,r.moveCall({target:`${e.sdkOptions.integrate.published_at}::${Ef}::send_coin`,typeArguments:[E.fromCoin],arguments:[x,r.pure(a)]})}}}this.checkCoinThreshold(e,t.byAmountIn,r,u,d,t.toCoin),h&&(r=Of.deleteAccountCapByObject(g,e.sdkOptions,r))}return{fromCoin:c,toCoin:u,tx:r}}static async buildAggregatorSwapTransaction(e,t,n,i,o,s){let r=new _t;const a=t.byAmountIn?Math.round(t.outputAmount*(1-o)):Math.round(t.inputAmount*(1+o)),c=ne.buildCoinForAmount(r,n,t.byAmountIn?BigInt(t.inputAmount):BigInt(a),t.fromCoin,!1,!0),u=c.originalSplitedCoin!=null,l=ne.buildCoinForAmount(r,n,0n,t.toCoin,!1),d=await this.buildAggregatorSwapReturnCoins(e,t,c,l,i,o,r,s),{fromCoin:h,toCoin:g}=d;r=d.tx;const b=[];if(l.isMintZeroCoin?b.push({coinType:t.toCoin,coin:g}):l.originalSplitedCoin!=null?r.mergeCoins(l.originalSplitedCoin,[g]):r.mergeCoins(l.targetCoin,[g]),u){const v=c.originalSplitedCoin;r.mergeCoins(v,[h])}else b.push({coinType:t.fromCoin,coin:h});for(let v=0;v<b.length;v++)this.buildTransferCoin(e,r,b[v].coin,b[v].coinType,s);return r}static checkCoinThreshold(e,t,n,i,o,s){t&&n.moveCall({target:`${e.sdkOptions.integrate.published_at}::${Js}::check_coin_threshold`,typeArguments:[s],arguments:[i,n.pure(o)]})}static buildDeepbookBasePathTx(e,t,n,i,o,s,r){const a=t.direction?o:s,c=t.direction?s:o,u=[n.object(t.poolAddress),i,n.pure(t.inputAmount),n.pure(0),n.pure(t.direction),a,c,n.pure(r),n.object(Ot)],l=t.direction?[t.fromCoin,t.toCoin]:[t.toCoin,t.fromCoin],d=n.moveCall({target:`${e.sdkOptions.deepbook_endpoint_v2.published_at}::endpoints_v2::swap`,typeArguments:l,arguments:u});return o=t.direction?d[0]:d[1],s=t.direction?d[1]:d[0],{from:o,to:s,tx:n}}static buildClmmBasePathTx(e,t,n,i,o,s,r,a){const{clmm_pool:c,integrate:u}=e.sdkOptions,l=et(c).global_config_id;let d=t.direction?o:s,h=t.direction?s:o;const g=a==="",b=g?Js:Al,v=g?"swap":"swap_with_partner",x=i?t.inputAmount.toString():t.outputAmount.toString(),P=Fo.getDefaultSqrtPriceLimit(t.direction),E=g?[n.object(l),n.object(t.poolAddress),d,h,n.pure(t.direction),n.pure(i),n.pure(x),n.pure(P.toString()),n.pure(r),n.object(Ot)]:[n.object(l),n.object(t.poolAddress),n.pure(a),d,h,n.pure(t.direction),n.pure(i),n.pure(x),n.pure(P.toString()),n.pure(r),n.object(Ot)],S=t.direction?[t.fromCoin,t.toCoin]:[t.toCoin,t.fromCoin],T=n.moveCall({target:`${u.published_at}::${b}::${v}`,typeArguments:S,arguments:E});return d=T[0],h=T[1],o=t.direction?d:h,s=t.direction?h:d,{from:o,to:s,tx:n}}static buildCoinTypePair(e,t){const n=[];if(e.length===2){const i=[];i.push(e[0],e[1]),n.push(i)}else{const i=[];i.push(e[0],e[e.length-1]),n.push(i);for(let o=1;o<e.length-1;o+=1){if(t[o-1]===0)continue;const s=[];s.push(e[0],e[o],e[e.length-1]),n.push(s)}}return n}static buildTransferCoinToSender(e,t,n,i){t.moveCall({target:`${e.sdkOptions.integrate.published_at}::${Ef}::transfer_coin_to_sender`,typeArguments:[i],arguments:[n]})}static buildTransferCoin(e,t,n,i,o){o!=null?t.transferObjects([n],t.pure(o)):ne.buildTransferCoinToSender(e,t,n,i)}},rn=ne;Wk(rn,"callMintZeroValueCoin",(e,t)=>e.moveCall({target:"0x2::coin::zero",typeArguments:[t]}));var qs=new _(1e9),Of=class{static createAccountCap(e,t,n,i=!1){if(e.length===0)throw Error("this config sdk senderAddress is empty");const{deepbook:o}=t,[s]=n.moveCall({target:`${o.published_at}::${Yk}::create_account`,typeArguments:[],arguments:[]});return i&&n.transferObjects([s],n.pure(e)),[s,n]}static deleteAccountCap(e,t,n){const{deepbook:i}=t,o=[n.pure(e)];return n.moveCall({target:`${i.published_at}::${xl}::delete_account_cap`,typeArguments:[],arguments:o}),n}static deleteAccountCapByObject(e,t,n){const{deepbook:i}=t,o=[e];return n.moveCall({target:`${i.published_at}::${xl}::delete_account_cap`,typeArguments:[],arguments:o}),n}static async getAccountCap(e){const t=await e.fullClient.getOwnedObjectsByPage(e.senderAddress,{options:{showType:!0,showContent:!0,showDisplay:!0,showOwner:!0},filter:{MoveModule:{package:e.sdkOptions.deepbook.package_id,module:xl}}});return t.data.length===0?"":t.data[0].data.objectId}static async getPools(e){const t=e.sdkOptions.deepbook.package_id,n=[];try{(await e.fullClient.queryEventsByPage({MoveEventType:`${t}::clob_v2::PoolCreated`})).data.forEach(o=>{const s=o.parsedJson;s&&n.push({poolID:s.pool_id,tickSize:Number(s.tick_size),lotSize:Number(s.lot_size),takerFeeRate:Number(s.taker_fee_rate),makerRebateRate:Number(s.maker_rebate_rate),baseAsset:s.base_asset.name,quoteAsset:s.quote_asset.name})})}catch(i){console.log("getPoolImmutables",i)}return n}static async getPoolAsks(e,t,n,i){var h;const{simulationAccount:o}=e.sdkOptions,{deepbook_endpoint_v2:s}=e.sdkOptions,r=new _t,a=[],c=[n,i],u=[r.pure(t),r.pure("0"),r.pure("999999999999"),r.pure(Ot)];r.moveCall({target:`${s.published_at}::endpoints_v2::get_level2_book_status_ask_side`,arguments:u,typeArguments:c});const d=(h=(await e.fullClient.devInspectTransactionBlock({transactionBlock:r,sender:o.address})).events)==null?void 0:h.filter(g=>Ct(g.type).name==="BookStatus");if(d.length===0)return a;for(let g=0;g<d[0].parsedJson.depths.length;g++){const b=d[0].parsedJson.price[g],v=d[0].parsedJson.depths[g],x={price:parseInt(b,10),quantity:parseInt(v,10)};a.push(x)}return a}static async getPoolBids(e,t,n,i){var h;const{simulationAccount:o}=e.sdkOptions,{deepbook_endpoint_v2:s}=e.sdkOptions,r=new _t,a=[],c=[n,i],u=[r.pure(t),r.pure("0"),r.pure("999999999999"),r.pure(Ot)];r.moveCall({target:`${s.published_at}::endpoints_v2::get_level2_book_status_bid_side`,arguments:u,typeArguments:c});const d=(h=(await e.fullClient.devInspectTransactionBlock({transactionBlock:r,sender:o.address})).events)==null?void 0:h.filter(g=>Ct(g.type).name==="BookStatus");if(d.length===0)return a;for(let g=0;g<d[0].parsedJson.depths.length;g++){const b=d[0].parsedJson.price[g],v=d[0].parsedJson.depths[g],x={price:parseInt(b,10),quantity:parseInt(v,10)};a.push(x)}return a}static async preSwap(e,t,n,i){let o=!1,s=kn,r=new _(i),a=kn;const c=new _(i);if(n){let u=await this.getPoolBids(e,t.poolID,t.baseAsset,t.quoteAsset);u===null&&(o=!0),u=u.sort((l,d)=>d.price-l.price);for(let l=0;l<u.length;l+=1){const d=new _(u[l].quantity),h=new _(u[l].price),g=d.mul(new _(h)).mul(new _(t.takerFeeRate)).div(qs).div(qs);if(r.gt(d))r=r.sub(d),s=s.add(d.mul(h).div(qs).sub(g)),a=a.add(g);else{const b=r.mul(new _(u[l].price)).div(qs),v=b.mul(new _(t.takerFeeRate)).div(qs);s=s.add(b.sub(v)),r=r.sub(r),a=a.add(v)}if(r.eq(kn))break}}else{const u=await this.getPoolAsks(e,t.poolID,t.baseAsset,t.quoteAsset);u===null&&(o=!0);for(let l=0;l<u.length;l+=1){const d=new _(u[l].price).mul(new _(u[l].quantity)).div(new _(1e9)),h=d.mul(new _(t.takerFeeRate)).div(qs),g=d.add(h);if(r.gt(d))s=s.add(new _(u[l].quantity)),r=r.sub(g),a=a.add(h);else{const b=new _(u[l].quantity).div(new _(t.lotSize)),v=g.div(b),x=r.div(v);s=s.add(x.muln(t.lotSize)),r=r.sub(x.mul(v)),a=a.add(x.div(b).mul(h))}if(r.eq(kn))break}}return{poolAddress:t.poolID,estimatedAmountIn:c.sub(r).toNumber(),estimatedAmountOut:s.toNumber(),estimatedFeeAmount:a,isExceed:o,amount:Number(i),aToB:n,byAmountIn:!0}}static async simulateSwap(e,t,n,i,o,s){var R;const{deepbook_endpoint_v2:r}=e.sdkOptions;let a=new _t;const c=await this.getAccountCap(e);let u;if(c===""){const K=this.createAccountCap(e.senderAddress,e.sdkOptions,a),V=K[0];a=K[1],u=V}else u=a.pure(c);const l=await e.getOwnerCoinAssets(e.senderAddress),d=rn.buildCoinForAmount(a,l,BigInt(s),n,!1),h=d==null?void 0:d.targetCoin,g=rn.buildCoinForAmount(a,l,BigInt(s),i,!1),b=g==null?void 0:g.targetCoin,v=[n,i],x=[a.pure(t),u,a.pure(s),a.pure(0),a.pure(o),h,b,a.pure(Ot)];a.moveCall({target:`${r.published_at}::${Qk}::swap`,arguments:x,typeArguments:v});const{simulationAccount:P}=e.sdkOptions,S=(R=(await e.fullClient.devInspectTransactionBlock({transactionBlock:a,sender:P.address})).events)==null?void 0:R.filter(K=>Ct(K.type).name==="DeepbookSwapEvent");if(S.length===0)return null;const T=S[0].parsedJson;return{poolAddress:T.pool,estimatedAmountIn:T.amount_in,estimatedAmountOut:T.amount_out,aToB:T.atob}}},Sl="router",Zs=1e4,Ro=class{static buildPoolImmutables(e){const{fields:t}=e.value.fields.value;return{clmm_pool_id:Ct(t.clmm_pool_id).address,booster_type:Ct(t.booster_type.fields.name).source_address,pool_id:Ct(t.pool_id).address,coinTypeA:Ct(t.coin_type_a.fields.name).source_address,coinTypeB:Ct(t.coin_type_b.fields.name).source_address}}static buildPoolState(e){const t=Oe(e),n=[];return t.config.fields.contents.forEach(o=>{n.push({lock_day:Number(o.fields.key),multiplier:Number(N(o.fields.value).div(Zs))})}),{basic_percent:Number(N(t.basic_percent).div(Zs)),balances:{balances_handle:t.balances.fields.id.id,size:t.balances.fields.size},config:n,lock_positions:{lock_positions_handle:t.lock_positions.fields.id.id,size:t.lock_positions.fields.size},is_open:t.is_open,index:Number(t.index),pool_id:da(e)}}static buildLockNFT(e){const t=Ct(da(e)).address;return{lock_clmm_position:oh(e),locked_nft_id:t}}static buildLockPositionInfo(e){const t=Oe(e),{value:n}=t.value.fields;return{type:n.type,position_id:n.fields.position_id,start_time:Number(n.fields.start_time),lock_period:Number(n.fields.lock_period),end_time:Number(n.fields.end_time),growth_rewarder:n.fields.growth_rewarder,rewarder_owned:n.fields.rewarder_owned,is_settled:n.fields.is_settled}}static isLocked(e){return e.end_time>Date.parse(new Date().toString())/1e3}},xS=class{constructor(e){qt(this,"_sdk");qt(this,"_cache",{});this._sdk=e}get sdk(){return this._sdk}async getPoolImmutables(e=!1){var s;const{booster:t}=this._sdk.sdkOptions,n=`${t.package_id}_getPoolImmutables`,i=this.getCache(n,e),o=[];if(i!==void 0)o.push(...i);else{const r=[];(s=(await this._sdk.ClmmSDK.fullClient.getDynamicFieldsByPage(et(t).booster_pool_handle)).data)==null||s.forEach(u=>{r.push(u.objectId)});const c=await this._sdk.ClmmSDK.fullClient.batchGetObjects(r,{showContent:!0});for(const u of c){const l=Oe(u);if(l){const d=Ro.buildPoolImmutables(l);this.updateCache(`${d.pool_id}_getPoolImmutable`,d,Ee),o.push(d)}}}return this.updateCache(n,o,Ee),o}async getPoolImmutable(e){const{booster:t}=this._sdk.sdkOptions,n=`${e}_getPoolImmutable`,i=this.getCache(n);if(i!==void 0)return i;const o=await this._sdk.ClmmSDK.fullClient.getDynamicFieldObject({parentId:et(t).booster_pool_handle,name:{type:"0x2::object::ID",value:e}}),s=Oe(o),r=Ro.buildPoolImmutables(s);return this.updateCache(n,r,Ee),r}async getPools(){const e=[],n=(await this.getPoolImmutables()).map(o=>o.pool_id),i=await this._sdk.ClmmSDK.fullClient.batchGetObjects(n,{showType:!0,showContent:!0});for(const o of i){const s=Ro.buildPoolState(o);if(s){const r={...await this.getPoolImmutable(s.pool_id),...s};e.push(r);const a=`${r.pool_id}_getPoolObject`;this.updateCache(a,r,Ee)}}return e}async getPool(e,t=!0){const n=`${e}_getPoolObject`,i=this.getCache(n,t),o=await this.getPoolImmutable(e);if(i!==void 0)return{...o,...i};const s=await this._sdk.ClmmSDK.fullClient.getObject({id:e,options:{showContent:!0,showType:!0}}),r=Ro.buildPoolState(s),a={...o,...r};return this.updateCache(n,a,Ee),a}async getPoolHandleId(e){const t=await this._sdk.ClmmSDK.fullClient.getObject({id:e,options:{showContent:!0}}),n=Oe(t);return n?n.list.fields.id.id:""}async getBoosterInitConfigs(){var i;const{package_id:e}=this.sdk.sdkOptions.booster,t=(i=await this._sdk.ClmmSDK.fullClient.queryEventsByPage({MoveEventType:`${e}::config::InitEvent`}))==null?void 0:i.data,n={booster_config_id:"",booster_pool_handle:""};return t.length>0&&t.forEach(o=>{const s=o.parsedJson;s&&(n.booster_config_id=s.config_id)}),n.booster_pool_handle=await this.getPoolHandleId(n.booster_config_id),n}async getOwnerBoosterPositions(e,t,n){const{booster:i}=this.sdk.sdkOptions,o=[],s=[],r=`${i.package_id}::lock_nft::LockNFT<${this._sdk.ClmmSDK.Position.buildPositionType()}>`,a=await this._sdk.ClmmSDK.fullClient.getOwnedObjectsByPage(e,{options:{showType:!0,showContent:!0,showOwner:!0},filter:{StructType:r}});for(const u of a.data)if(Ct(ro(u)).source_address===r&&u.data){const d=Ro.buildLockNFT(u);this.updateCache(`${d.locked_nft_id}_getBoosterPositionById`,d,Ee),d&&(t===void 0||t===d.lock_clmm_position.pool)&&o.push(d)}const c=await this.getLockPositionInfos(n,o.map(u=>u.locked_nft_id));for(const u of o)for(const l of c)if(u.lock_clmm_position.pos_object_id===l.position_id){s.push({...u,...l});break}return s}async getBoosterPosition(e,t){const n=`${t}_getBoosterPositionById`,i=this.getCache(n);let o;if(i!==void 0)o=i;else{const r=await this._sdk.ClmmSDK.fullClient.getObject({id:t,options:{showContent:!0,showOwner:!0}});o=Ro.buildLockNFT(r),this.updateCache(n,o,Ee)}const s=await this.getLockPositionInfo(e,t);return{...o,...s}}async getLockPositionInfos(e,t=[]){var s;const n=await this._sdk.ClmmSDK.fullClient.getDynamicFieldsByPage(e),i=[],o=[];return(s=n.data)==null||s.forEach(r=>{t.length>0?t.includes(r.name.value)&&i.push(r.objectId):i.push(r.objectId)}),i.length>0&&(await this._sdk.ClmmSDK.fullClient.batchGetObjects(i,{showContent:!0})).forEach(a=>{const c=Ro.buildLockPositionInfo(a);c&&o.push(c)}),o}async getLockPositionInfo(e,t){const n=await this._sdk.ClmmSDK.fullClient.getDynamicFieldObject({parentId:e,name:{type:"0x2::object::ID",value:t}});return Ro.buildLockPositionInfo(n)}calculateXCetusRewarder(e,t,n){let i=t.basic_percent,o="0";e.forEach(a=>{a.coin_address===t.booster_type&&(console.log("find ",t.booster_type),o=a.amount_owed.toString())}),n.is_settled||t.config.forEach(a=>{a.lock_day===n.lock_period&&(i=a.multiplier)});const s=N(o).sub(n.growth_rewarder).mul(i);return N(n.rewarder_owned).add(s).toString()}lockPositionPayload(e){const{booster:t}=this.sdk.sdkOptions,{clmm_pool:n}=this.sdk.ClmmSDK.sdkOptions,i=new _t;return i.moveCall({target:`${t.published_at}::${Sl}::lock_position`,typeArguments:[e.booster_type,e.coinTypeA,e.coinTypeB],arguments:[i.pure(et(t).booster_config_id),i.pure(et(n).global_config_id),i.pure(e.booster_pool_id),i.pure(e.clmm_pool_id),i.pure(e.clmm_position_id),i.pure(e.lock_day),i.pure(Ot)]}),i}canceLockPositionPayload(e){const{booster:t}=this.sdk.sdkOptions,n=new _t;return n.moveCall({target:`${t.published_at}::${Sl}::cancel_lock`,typeArguments:[e.booster_type],arguments:[n.pure(et(t).booster_config_id),n.pure(e.booster_pool_id),n.pure(e.lock_nft_id),n.pure(Ot)]}),n}redeemPayload(e){const{booster:t,xcetus:n}=this.sdk.sdkOptions,{clmm_pool:i}=this.sdk.ClmmSDK.sdkOptions,o=new _t,s=et(n);return o.moveCall({target:`${t.published_at}::${Sl}::redeem`,typeArguments:[e.booster_type,e.coinTypeA,e.coinTypeB],arguments:[o.pure(et(t).booster_config_id),o.pure(et(i).global_config_id),o.pure(e.booster_pool_id),o.pure(e.lock_nft_id),o.pure(e.clmm_pool_id),o.pure(s.lock_manager_id),o.pure(s.xcetus_manager_id),o.pure(e.ve_nft_id),o.pure(Ot)]}),o}updateCache(e,t,n=go){let i=this._cache[e];i?(i.overdueTime=En(n),i.value=t):i=new Wi(t,En(n)),this._cache[e]=i}getCache(e,t=!1){const n=this._cache[e];if(!t&&(n!=null&&n.isValid()))return n.value;delete this._cache[e]}},fi="router",Tm=1e9,ai=class{static priceRealToFix(e,t,n){const i=N(t-n).toNumber();return Number(N(e).div(N(10).pow(N(i))).toString())}static priceFixToReal(e,t,n){const i=N(t-n).toNumber();return Number(N(e).mul(N(10).pow(N(i))).toString())}static raiseTotalAmount(e,t,n){const i=N(t-n).abs().toNumber();return t>n?Number(N(e.total_supply).mul(e.current_price).div(N(10).pow(N(i))).toString()):Number(N(e.total_supply).mul(e.current_price).mul(N(10).pow(N(i))).toString())}static buildLaunchPadPool(e){const t=ro(e),n=Ct(t),i=Oe(e),o={coin_type_sale:n.type_arguments[0],coin_type_raise:n.type_arguments[1],pool_address:Dn(da(e)),is_settle:i.is_settle,current_price:N(i.initialize_price).div(N(Tm)).toString(),price:i.initialize_price,min_price:"0",max_price:"0",sale_coin_amount:i.sale_coin,raise_coin_amount:i.raise_coin,total_purchase_amount:i.reality_raise_total,total_supply:i.sale_total,min_purchase:i.min_purchase,max_purchase:i.max_purchase,complete_raise_limit:i.least_raise_amount,softcap:i.softcap,max_raise_amount:i.hardcap,sale_decimals:0,raise_decimals:0,liquidity_injection_ratio:Number(i.liquidity_rate)/1e4,is_cancel:i.is_cancel,duration_summary:{start_time:Number(i.duration_manager.fields.start_time),end_time:0,settle_end_time:0,purchase_duration:Number(i.duration_manager.fields.activity_duration),settle_duration:Number(i.duration_manager.fields.settle_duration),lock_up_duration:Number(i.duration_manager.fields.locked_duration)},white_summary:{white_handle:i.white_list.fields.users.fields.id.id,protection_hard_cap:i.white_list.fields.hard_cap_total,protection_limit_used:i.white_list.fields.purchase_total,size:Number(i.white_list.fields.users.fields.size)},unused_sale:i.unused_sale,harvest_raise:i.harvest_raise,tick_spacing:Number(i.tick_spacing),owner:i.recipient,purchase_summary:{purchase_handle:i.purchase_list.fields.id.id,size:Number(i.purchase_list.fields.size)},pool_status:"Failed"};return ai.updatePoolStatus(o),o}static updatePoolStatus(e){const t=Number(N(Date.now()/1e3).toFixed(0)),{duration_summary:n}=e,i=n.start_time+n.purchase_duration,o=i+n.settle_duration;if(n.end_time=i,n.settle_end_time=o,e.is_settle)e.pool_status="Ended";else if(e.is_cancel)e.pool_status="Canceled";else if(t<n.start_time)e.pool_status="Upcoming";else if(t>n.start_time&&t<i)e.pool_status="Live";else if(t>i&&t<o){const s=e.raise_coin_amount;Number(s)<Number(e.complete_raise_limit)?e.pool_status="Failed":e.pool_status="Settle"}return e}static async calculatePoolPrice(e,t){const n=await e.ClmmSDK.CetusConfig.getTokenListByCoinTypes([t.coin_type_sale,t.coin_type_raise]),i=n[t.coin_type_sale].decimals,o=n[t.coin_type_raise].decimals;t.min_price=this.priceFixToReal(Number(N(t.softcap).div(N(t.total_supply))),i,o).toString(),t.max_price=this.priceFixToReal(Number(N(t.max_raise_amount).div(N(t.total_supply))),i,o).toString(),t.current_price=this.priceFixToReal(Number(t.current_price),i,o).toString(),t.sale_decimals=i,t.raise_decimals=o}static async getWithdrawRaise(e){return e.pool_status==="Ended"?e.harvest_raise:"0"}static async getWithdrawSale(e){return e.pool_status==="Ended"?e.unused_sale:e.sale_coin_amount}static async getHistoryWithdrawRaise(e,t){if(t.pool_status==="Ended"){if(N(t.harvest_raise).equals(N(0))){const i=await e.Launchpad.getSettleEvent(t.pool_address);i&&(t.harvest_raise=i.unused_raise)}const n=_.min(new _(t.total_purchase_amount),new _(t.max_raise_amount));return N(n.toString()).mul(1-t.liquidity_injection_ratio).toString()}return"0"}static async getHistoryWithdrawSale(e,t){if(t.pool_status==="Ended"){const n=await e.Launchpad.getSettleEvent(t.pool_address);return n&&(t.unused_sale=n.unused_sale),t.unused_sale}return"0"}static async getOverrecruitReverseAmount(e,t){const n=await e.Launchpad.getPurchaseMarks(e.ClmmSDK.senderAddress,[t.pool_address],!1);if(n.length>0){const i=n[0].purchased_raise_amount,o=(await e.Launchpad.getPurchaseAmount(t.white_summary.white_handle,e.ClmmSDK.senderAddress)).safe_purchased_amount,{protection_limit_used:s}=t.white_summary;return N(i).sub(o).div(N(t.total_purchase_amount).sub(s)).mul(N(t.total_purchase_amount).sub(t.max_raise_amount)).toString()}return"0"}static async getCanPurchaseAmount(e,t){const n=await ai.getOverrecruitReverseAmount(e,t),i=await e.Launchpad.getPurchaseMarks(e.ClmmSDK.senderAddress,[t.pool_address],!1);if(i){const o=i[0].purchased_raise_amount;N(o).sub(n).div(t.current_price)}return"0"}},kS=class{constructor(e){qt(this,"_sdk");qt(this,"_cache",{});this._sdk=e}get sdk(){return this._sdk}async getPoolImmutables(e=[],t=0,n=100,i=!1){var l;const{package_id:o}=this._sdk.sdkOptions.launchpad;if(o===void 0)throw Error("sdk.sdkOptions.launchpad is undefined");const s=`${o}_getPoolImmutables`,r=this.getCache(s,i),a=[],c=[];if(r!==void 0&&a.push(...r),a.length===0)try{((l=await this._sdk.ClmmSDK.fullClient.queryEventsByPage({MoveEventType:`${o}::factory::CreatePoolEvent`}))==null?void 0:l.data).forEach(h=>{const g=h.parsedJson;g&&a.push({pool_address:g.pool_id,coin_type_sale:Ct(g.sale_coin.name).full_address,coin_type_raise:Ct(g.raise_coin.name).full_address})}),this.updateCache(s,a,Ee)}catch(d){console.log("getPoolImmutables",d)}const u=e.length>0;for(let d=0;d<a.length;d+=1){const h=a[d];if(!(u&&!e.includes(h.pool_address))){if(!u){const g=d;if(g<t||g>=t+n)continue}c.push(h)}}return c}async getPoolImmutablesWithPage(e="all",t=!1){const{package_id:n}=this._sdk.sdkOptions.launchpad,i=`${n}_getPoolImmutables`,o=[],s={data:[],hasNextPage:!1},r=e==="all";if(r){const a=this.getCache(i,t);a&&o.push(...a)}if(o.length===0)try{const a=await this._sdk.ClmmSDK.fullClient.queryEventsByPage({MoveEventType:`${n}::factory::CreatePoolEvent`},e);s.hasNextPage=a.hasNextPage,s.nextCursor=a.nextCursor,a.data.forEach(c=>{const u=c.parsedJson;u&&o.push({pool_address:u.pool_id,coin_type_sale:Ct(u.sale_coin.name).full_address,coin_type_raise:Ct(u.raise_coin.name).full_address})})}catch(a){console.log("getPoolImmutables",a)}return s.data=o,r&&this.updateCache(i,o,Ee),s}async getPools(e=[],t=0,n=100){const i=[];let o=[];e.length>0?o=[...e]:(await this.getPoolImmutables([],t,n,!1)).forEach(a=>{o.push(a.pool_address)});const s=await this._sdk.ClmmSDK.fullClient.batchGetObjects(o,{showType:!0,showContent:!0});for(const r of s){const a=ai.buildLaunchPadPool(r);await ai.calculatePoolPrice(this._sdk,a),i.push(a);const c=`${a.pool_address}_getPoolObject`;this.updateCache(c,a,Ee)}return i}async getPool(e,t=!0){const n=`${e}_getPoolObject`,i=this.getCache(n,t);if(i!==void 0){const r=i;return ai.updatePoolStatus(r),r}const o=await this._sdk.ClmmSDK.fullClient.getObject({id:e,options:{showContent:!0,showType:!0}}),s=ai.buildLaunchPadPool(o);return await ai.calculatePoolPrice(this._sdk,s),this.updateCache(n,s),s}async getInitConfig(e=!1){var c;const t=this._sdk.sdkOptions.launchpad.package_id,n=`${t}_getInitEvent`,i=this.getCache(n,e);if(i!==void 0)return i;const o=await this._sdk.ClmmSDK.fullClient.getObject({id:t,options:{showPreviousTransaction:!0}}),s=vm(o),r=(c=await this._sdk.ClmmSDK.fullClient.queryEventsByPage({Transaction:s}))==null?void 0:c.data,a={pools_id:"",admin_cap_id:"",config_cap_id:""};return r.length>0&&(r.forEach(u=>{const l=u.parsedJson;if(l)switch(Ct(u.type).full_address){case`${t}::config::InitConfigEvent`:a.admin_cap_id=l.admin_cap_id,a.config_cap_id=l.config_cap_id;break;case`${t}::factory::InitFactoryEvent`:a.pools_id=l.pools_id;break}}),this.updateCache(n,a,Ee)),a}async getLockNFT(e,t=!1){const n=`${e}_getLockNFT`,i=this.getCache(n,t);if(i!==void 0)return i;const o=await this._sdk.ClmmSDK.fullClient.getObject({id:e,options:{showType:!0,showContent:!0,showDisplay:!0,showOwner:!0}});if(!o.error)return oh(o)}async getLockNFTList(e){var o;const{package_id:t}=this._sdk.ClmmSDK.sdkOptions.clmm_pool,{sdkOptions:n}=this._sdk,i=[];try{const s=(o=await this._sdk.ClmmSDK.fullClient.queryEventsByPage({MoveEventType:`${n.launchpad.package_id}::lock::LockNFTEvent`}))==null?void 0:o.data;for(const r of s){const a=r.parsedJson;if(a){const c={locked_time:Number(a.locked_time),end_lock_time:Number(a.end_lock_time),nft_type:a.nft_type_name.name,lock_nft_id:a.lock_nft_id,recipient:a.recipient};if(e===c.recipient&&`${t}`===Ct(c.nft_type).address){const u=await this.getLockNFT(c.lock_nft_id);if(u){const l=Ct(u.coin_type_a).full_address,d=Ct(u.coin_type_b).full_address;i.push({...u,coin_type_a:l,coin_type_b:d,...c})}}}}return i}catch(s){return console.log("getLockNFTList:",s),[]}}async creatPoolTransactionPayload(e){const{launchpad:t}=this.sdk.sdkOptions,n=et(t);if(this.assertLuanchpadConfig(),this._sdk.ClmmSDK.senderAddress.length===0)throw Error("this config sdk senderAddress is empty");const i=ai.priceRealToFix(Number(e.initialize_price),e.sale_decimals,e.raise_decimals),o=new _t,s=N(e.total_supply).add(N(e.total_supply).mul(N(e.liquidity_rate))).toNumber(),r=await rn.syncBuildCoinInputForAmount(this._sdk.ClmmSDK,o,BigInt(s),e.coin_type_sale),a=[o.pure(n.admin_cap_id),o.pure(n.config_cap_id),o.pure(n.pools_id),o.pure(ri(e.recipient)),o.pure((i*Tm).toString()),r,o.pure(e.total_supply.toString()),o.pure(e.min_purchase.toString()),o.pure(e.max_purchase.toString()),o.pure(e.least_raise_amount.toString()),o.pure(e.hardcap.toString()),o.pure((e.liquidity_rate*1e3).toString()),o.pure(e.start_time.toString()),o.pure(e.activity_duration.toString()),o.pure(e.settle_duration.toString()),o.pure(e.locked_duration.toString()),o.pure(e.tick_spacing.toString()),o.pure(Ot)],c=[e.coin_type_sale,e.coin_type_raise];return o.moveCall({target:`${t.published_at}::${fi}::create_launch_pool`,typeArguments:c,arguments:a}),o}async creatPurchasePayload(e){const{launchpad:t}=this.sdk.sdkOptions;if(this._sdk.ClmmSDK.senderAddress.length===0)throw Error("this config sdk senderAddress is empty");const n=new _t,i=await rn.syncBuildCoinInputForAmount(this._sdk.ClmmSDK,n,BigInt(e.purchase_amount),e.coin_type_raise),o=(await this.getPurchaseMarks(this._sdk.ClmmSDK.senderAddress,[e.pool_address],!1))[0],s=[e.coin_type_sale,e.coin_type_raise];let r;return o?r=[n.pure(e.pool_address),n.pure(et(t).config_cap_id),n.pure(o.id),i,n.pure(e.purchase_amount.toString()),n.pure(Ot)]:r=[n.pure(e.pool_address),n.pure(et(t).config_cap_id),i,n.pure(e.purchase_amount.toString()),n.pure(Ot)],n.moveCall({target:`${t.published_at}::${fi}::${o===void 0?"create_and_purchase":"purchase"}`,typeArguments:s,arguments:r}),n}async creatClaimPayload(e){const{launchpad:t}=this.sdk.sdkOptions;if(this._sdk.ClmmSDK.senderAddress.length===0)throw Error("this config sdk senderAddress is empty");const n=(await this.getPurchaseMarks(this._sdk.ClmmSDK.senderAddress,[e.pool_address],!1))[0],i=new _t,o=[e.coin_type_sale,e.coin_type_raise],s=[i.pure(e.pool_address),i.pure(et(t).config_cap_id),i.pure(n==null?void 0:n.id),i.pure(Ot)];return i.moveCall({target:`${t.published_at}::${fi}::claim`,typeArguments:o,arguments:s}),i}async creatSettlePayload(e){const{launchpad:t}=this.sdk.sdkOptions,{clmm_pool:n}=this.sdk.ClmmSDK.sdkOptions;if(this._sdk.ClmmSDK.senderAddress.length===0)throw Error("this config sdk senderAddress is empty");this.assertLuanchpadConfig();const i=et(n),{clmm_args:o}=e,s=new _t;s.setSender(this.sdk.ClmmSDK.senderAddress);const r=[e.coin_type_sale,e.coin_type_raise];if(o){const a=o.opposite?he.priceToSqrtPriceX64(N(1).div(o.current_price),o.raise_decimals,o.sale_decimals).toString():he.priceToSqrtPriceX64(N(o.current_price),o.sale_decimals,o.raise_decimals).toString(),c=BigInt(a)<BigInt(o.clmm_sqrt_price),u=o.opposite?c?e.coin_type_raise:e.coin_type_sale:c?e.coin_type_sale:e.coin_type_raise,l=await this._sdk.ClmmSDK.getOwnerCoinAssets(this._sdk.ClmmSDK.senderAddress,u);let d=Qe.calculateTotalBalance(l);Qe.isSuiCoin(u)&&(d-=BigInt(2e8));const g=rn.buildCoinForAmount(s,l,d,u).targetCoin,b=o.opposite?c?"settle_with_reverse_clmm_only_with_a":"settle_with_reverse_clmm_only_with_b":c?"settle_only_with_a":"settle_only_with_b",v=[s.pure(e.pool_address),s.pure(et(t).config_cap_id),s.pure(o.clmm_pool_address),s.pure(i.global_config_id),s.pure(a),g,s.pure(Ot)];s.moveCall({target:`${t.published_at}::${fi}::${b}`,typeArguments:r,arguments:v})}else s.moveCall({target:`${t.published_at}::${fi}::settle`,typeArguments:r,arguments:[s.pure(e.pool_address),s.pure(et(t).config_cap_id),s.pure(Ot)]});return s}creatWithdrawPayload(e){const{launchpad:t}=this.sdk.sdkOptions,n=new _t,i=[e.coin_type_sale,e.coin_type_raise],o=[n.object(e.pool_address),n.object(et(t).config_cap_id),n.object(Ot)];return e.sale_amount>BigInt(0)&&n.moveCall({target:`${t.published_at}::${fi}::withdraw_sale`,typeArguments:i,arguments:o}),e.raise_amount>BigInt(0)&&n.moveCall({target:`${t.published_at}::${fi}::withdraw_raise`,typeArguments:i,arguments:o}),n}addUserToWhitelisPayload(e){const{launchpad:t}=this.sdk.sdkOptions;this.assertLuanchpadConfig();const n=new _t,i=[e.coin_type_sale,e.coin_type_raise];return e.user_addrs.forEach(o=>{const s=[n.object(et(t).admin_cap_id),n.object(et(t).config_cap_id),n.object(e.pool_address),n.object(o),n.pure(e.safe_limit_amount),n.object(Ot)];n.moveCall({target:`${t.published_at}::${fi}::add_user_to_whitelist`,typeArguments:i,arguments:s})}),n}updateWhitelistCapPayload(e){const{launchpad:t}=this.sdk.sdkOptions;this.assertLuanchpadConfig();const n=new _t,i=[e.coin_type_sale,e.coin_type_raise];return e.safe_limit_amount>0&&n.moveCall({target:`${t.published_at}::${fi}::update_whitelist_member_safe_limit_amount`,typeArguments:i,arguments:[n.object(et(t).admin_cap_id),n.object(et(t).config_cap_id),n.object(e.pool_address),n.pure(e.white_list_member),n.pure(e.safe_limit_amount),n.object(Ot)]}),e.hard_cap_total>0&&n.moveCall({target:`${t.published_at}::${fi}::update_whitelist_hard_cap_total`,typeArguments:i,arguments:[n.object(et(t).admin_cap_id),n.object(et(t).config_cap_id),n.object(e.pool_address),n.pure(e.hard_cap_total),n.object(Ot)]}),n}creatRemoveWhitelistPayload(e){const{launchpad:t}=this.sdk.sdkOptions;this.assertLuanchpadConfig();const n=new _t,i=[e.coin_type_sale,e.coin_type_raise];return e.user_addrs.forEach(o=>{const s=[n.object(et(t).admin_cap_id),n.object(et(t).config_cap_id),n.object(e.pool_address),n.object(o),n.object(Ot)];n.moveCall({target:`${t.published_at}::${fi}::remove_user_from_whitelist`,typeArguments:i,arguments:s})}),n}creatCancelPoolPayload(e){const{launchpad:t}=this.sdk.sdkOptions;this.assertLuanchpadConfig();const n=new _t,i=[e.coin_type_sale,e.coin_type_raise],o=[n.pure(et(t).admin_cap_id),n.pure(et(t).config_cap_id),n.pure(e.pool_address),n.pure(Ot)];return n.moveCall({target:`${t.published_at}::${fi}::cancel`,typeArguments:i,arguments:o}),n}updateRecipientPayload(e){const{launchpad:t}=this.sdk.sdkOptions;this.assertLuanchpadConfig();const n=new _t,i=[e.coin_type_sale,e.coin_type_raise],o=[n.pure(et(t).admin_cap_id),n.pure(et(t).config_cap_id),n.pure(e.pool_address),n.pure(e.new_recipient),n.pure(Ot)];return n.moveCall({target:`${t.published_at}::${fi}::update_recipient_address`,typeArguments:i,arguments:o}),n}updatePoolDuractionPayload(e){const{launchpad:t}=this.sdk.sdkOptions;this.assertLuanchpadConfig();const n=new _t,i=[e.coin_type_sale,e.coin_type_raise],o=[n.pure(et(t).admin_cap_id),n.pure(et(t).config_cap_id),n.pure(e.pool_address),n.pure(e.activity_duration),n.pure(e.settle_duration),n.pure(e.lock_duration),n.pure(Ot)];return n.moveCall({target:`${t.published_at}::${fi}::update_pool_duration`,typeArguments:i,arguments:o}),n}creatUnlockNftPayload(e){const{launchpad:t}=this.sdk.sdkOptions;if(et(t)===void 0)throw Error("getPackagerConfigs(launchpad)  is null");const n=new _t,i=[e.nft_type],o=[n.pure(e.lock_nft),n.pure(Ot)];return n.moveCall({target:`${t.published_at}::lock::unlock_nft`,typeArguments:i,arguments:o}),n}async isAdminCap(e){const{launchpad:t}=this._sdk.sdkOptions;if(et(t)===void 0)throw Error("launchpad config is empty");const n=`${e}_isAdminCap`,i=this.getCache(n);if(i)return i;const o=await this._sdk.ClmmSDK.fullClient.getObject({id:et(t).admin_cap_id,options:{showType:!0,showOwner:!0}});console.log(o);const s=xr(o),r=Mc(o);let a=!1;return r&&s&&Ct(s).source_address===`${t.package_id}::config::AdminCap`&&(a=ri(r.AddressOwner)===ri(e)),this.updateCache(n,a,Ee),a}async isWhiteListUser(e,t){const n={type:"address",value:t};try{const i=await this._sdk.ClmmSDK.fullClient.getDynamicFieldObject({parentId:e,name:n});return!!(i&&i.data)}catch{return!1}}async getPurchaseAmount(e,t){var i;const n={type:"address",value:t};try{const o=await this._sdk.ClmmSDK.fullClient.getDynamicFieldObject({parentId:e,name:n}),s=Oe(o);if(console.log(s),s)return(i=s==null?void 0:s.value)==null?void 0:i.fields}catch{}return{safe_limit_amount:"0",safe_purchased_amount:"0"}}async getPurchaseMarks(e,t=[],n=!0){const{launchpad:i}=this._sdk.sdkOptions,o=`${t}_getPurchaseMark`,s=this.getCache(o,n);if(!n&&s!==void 0)return s;let r=null;const a=[];for(;;){const c=await this._sdk.ClmmSDK.fullClient.getOwnedObjects({owner:e,options:{showType:!0,showContent:!0,showDisplay:!0},cursor:r});for(const u of c.data){const{fields:l}=u.data.content;if(Ct(ro(u)).source_address===`${i.package_id}::pool::PurchaseMark`){console.log("fields: ",l);const h={id:l.id.id,pool_id:Ct(l.pool_id).address,purchased_raise_amount:l.purchase_total,obtain_sale_amount:l.obtain_sale_amount,used_raise_amount:l.used_raise_amount};t.length>0?t.includes(h.pool_id)&&a.push(h):a.push(h)}}if(c.hasNextPage)r=c.nextCursor;else break}return this.updateCache(o,a,Ee),a}async getSettleEvent(e){const{launchpad:t}=this._sdk.sdkOptions,n=`${e}_getPurchaseMark`,i=this.getCache(n);if(i!==void 0)return i;const o=await this._sdk.ClmmSDK.fullClient.queryEventsByPage({MoveEventType:`${t.package_id}::pool::SettleEvent`});for(const s of o.data){const r=s.parsedJson;if(e===Dn(r.pool_id)){const a={pool_id:r.pool_id,settle_price:r.settle_price,unused_sale:r.unused_sale,unused_raise:r.unused_raise,white_purchase_total:r.white_purchase_total};return this.updateCache(n,a,Ee),a}}}buildLaunchpadCoinType(e,t){return Uc(this._sdk.sdkOptions.launchpad.package_id,"pool","PoolLiquidityCoin",[e,t])}assertLuanchpadConfig(){const{launchpad:e}=this.sdk.sdkOptions;if(et(e)===void 0)throw Error("sdk getPackagerConfigs(launchpad) is null")}updateCache(e,t,n=go){let i=this._cache[e];i?(i.overdueTime=En(n),i.value=t):i=new Wi(t,En(n)),this._cache[e]=i}getCache(e,t=!1){const n=this._cache[e];if(!t&&(n!=null&&n.isValid()))return n.value;delete this._cache[e]}},$o=class{static buildPoolImmutables(e){const{fields:t}=e.value.fields.value;return{clmm_pool_id:Ct(t.clmm_pool_id).address,bonus_type:Ct(t.bonus_type.fields.name).source_address,pool_id:Ct(t.pool_id).address,coinTypeA:Ct(t.coin_type_a.fields.name).source_address,coinTypeB:Ct(t.coin_type_b.fields.name).source_address}}static buildPoolState(e){const t=Oe(e),n=[];return t.config.fields.contents.forEach(o=>{n.push({rate:Number(N(o.fields.key).div(Zs)),multiplier:Number(N(o.fields.value).div(Zs))})}),{balance:t.balance,config:n,is_open:t.is_open,index:Number(t.index),start_time:Number(t.start_time),interval_day:Number(t.interval_day),minimum_percent_to_reward:Number(N(t.minimum_percent_to_reward).div(Zs)),rewarders:{rewarder_handle:t.rewarders.fields.id.id,size:Number(t.rewarders.fields.size)},whale_nfts:{whale_nfts_handle:t.whale_nfts.fields.id.id,size:Number(t.whale_nfts.fields.size)},points:{point_handle:t.points.fields.id.id,size:Number(t.points.fields.size)}}}static buildMarkerPositions(e){const{contents:t}=e.value.fields.value.fields,n=[],i=e.id.id;return t.forEach(o=>{const{key:s,value:r}=o.fields,a={id:s,period_id:i,bonus_num:r.fields.bonus_num,point:r.fields.point,is_burn:r.fields.is_burn,point_after_multiplier:r.fields.point_after_multiplier,percent:Number(N(r.fields.percent).div(Zs)),fee_share_rate:0,is_redeemed:r.fields.is_redeemed};n.push(a)}),n}static buildPoolBonusInfo(e){const{fields:t,type:n}=e.value.fields.value;return{type:n,time:Number(t.time),settle_time:Number(t.settle_time),settled_num:t.settled_num,is_settled:t.is_settled,basis_bonus:t.basis_bonus,total_bonus:t.total_bonus,is_vacant:t.is_vacant,redeemed_num:t.redeemed_num}}static getBonusPercent(e,t){let n=0;for(const i of e)t>=i.rate&&i.rate>n&&(n=i.multiplier);return n}},Rf="router",SS=class{constructor(e){qt(this,"_sdk");qt(this,"_cache",{});this._sdk=e}get sdk(){return this._sdk}async getPoolImmutables(e=!1){var s;const{maker_bonus:t}=this._sdk.sdkOptions,n=`${t.package_id}_getPoolImmutables`,i=this.getCache(n,e),o=[];if(i!==void 0)o.push(...i);else{const r=[];(s=(await this._sdk.ClmmSDK.fullClient.getDynamicFieldsByPage(et(t).maker_pool_handle)).data)==null||s.forEach(u=>{r.push(u.objectId)});const c=await this._sdk.ClmmSDK.fullClient.batchGetObjects(r,{showContent:!0});for(const u of c){const l=Oe(u);l&&o.push($o.buildPoolImmutables(l))}}return o}async getPoolImmutable(e){const{maker_bonus:t}=this._sdk.sdkOptions,n=`${t.package_id}_getPoolImmutables`,i=this.getCache(n);if(i!==void 0){const r=i.filter(a=>e===a.pool_id);if(r.length>0)return r[0]}const o=await this._sdk.ClmmSDK.fullClient.getDynamicFieldObject({parentId:et(t).maker_pool_handle,name:{type:"0x2::object::ID",value:e}}),s=Oe(o);return $o.buildPoolImmutables(s)}async getPools(){const e=[],t=await this.getPoolImmutables(),n=t.map(s=>s.pool_id),i=await this._sdk.ClmmSDK.fullClient.batchGetObjects(n,{showType:!0,showContent:!0});let o=0;for(const s of i){const r=$o.buildPoolState(s);if(r){const a={...t[o],...r};e.push(a);const c=`${a.pool_id}_getPoolObject`;this.updateCache(c,a,Ee)}o+=1}return e}async getPool(e,t=!0){const n=`${e}_getPoolObject`,i=this.getCache(n,t),o=await this.getPoolImmutable(e);if(i!==void 0)return i;const s=await this._sdk.ClmmSDK.fullClient.getObject({id:e,options:{showContent:!0,showType:!0}}),r=$o.buildPoolState(s),a={...o,...r};return this.updateCache(n,a,Ee),a}async getPoolHandleId(e){const t=await this._sdk.ClmmSDK.fullClient.getObject({id:e,options:{showContent:!0}}),n=Oe(t);return n?n.list.fields.id.id:""}async getMakerPoolPeriods(e,t=!1){const n=[],i=`${e.pool_id}_getMakerPoolPeriods`,o=this.getCache(i,t);return o!==void 0?o:((await this._sdk.ClmmSDK.fullClient.getDynamicFieldsByPage(e.whale_nfts.whale_nfts_handle)).data.forEach(r=>{const a={id:r.objectId,start_time:0,end_time:0,period:Number(r.name.value)};a.start_time=Number(N(e.start_time).add(N(e.interval_day).mul(24*3600).mul(a.period)).toFixed(0,it.ROUND_DOWN)),a.end_time=Number(N(a.start_time).add(N(e.interval_day).mul(24*3600)).toFixed(0,it.ROUND_DOWN)),n.push(a)}),this.updateCache(i,n,Ee),n)}async getMakerBonusInitConfigs(){var i;const{package_id:e}=this.sdk.sdkOptions.maker_bonus,t=(i=await this._sdk.ClmmSDK.fullClient.queryEventsByPage({MoveEventType:`${e}::config::InitEvent`}))==null?void 0:i.data,n={maker_config_id:"",maker_pool_handle:""};return t.length>0&&t.forEach(o=>{const s=o.parsedJson;s&&(n.maker_config_id=s.config_id)}),n.maker_pool_handle=await this.getPoolHandleId(n.maker_config_id),n}async getPoolMarkerPositionList(e,t,n=!1){const i={},o=[];n||t.forEach(s=>{const r=`${e}_${s.period}_getPoolMarkerPositionList`,a=this.getCache(r);a!==void 0?i[s.period]=a:(i[s.period]=[],o.push(s))});try{o.length>0&&(await this._sdk.ClmmSDK.fullClient.batchGetObjects(o.map(a=>a.id),{showContent:!0})).forEach(a=>{const c=Oe(a),u=$o.buildMarkerPositions(c);if(u.length>0){const{period_id:l}=u[0],d=t.filter(h=>h.id===l)[0];i[d.period]=u}});const s=[];for(const r in i)i[r].forEach(c=>{s.push(c)});if(s.length>0){const r=await this._sdk.ClmmSDK.Position.getSipmlePositionList(s.map(a=>a.id));for(const a of s)for(const c of r)if(a.id===c.pos_object_id){a.clmm_position=c;break}}}catch(s){console.log(s)}for(const s in i){const r=`${e}_${s}_getPoolMarkerPositionList`;this.updateCache(r,i[s],Ee)}return i}async updateXCetusRewarderAndFee(e,t,n){const i=await this.calculateTotalPointsAfterMultiper(e,n);for(const o of t)await this.calculateXCetusRewarder(e,o,n.period,i);return t}async calculateXCetusRewarder(e,t,n,i){const o=await this.getPoolBonusInfo(e.rewarders.rewarder_handle,n),{fee_share_rate:s}=this.calculateFeeShareRate(e,t,i),r=N(s).mul(o.total_bonus);return t.is_redeemed?t.bonus_num="0":t.bonus_num=r.toString(),t.bonus_num}calculateFeeShareRate(e,t,n){const i=$o.getBonusPercent(e.config,t.percent),o=N(t.point).mul(i),s=N(o).div(n);return t.point_after_multiplier=o.toString(),t.fee_share_rate=Number(s),{fee_share_rate:Number(s),points_after_multiper:o.toString()}}async calculateTotalPointsAfterMultiper(e,t){const n=await this.getPoolMarkerPositionList(e.whale_nfts.whale_nfts_handle,[t]);let i=N(0);const o=n[t.period];for(const s of o){const r=$o.getBonusPercent(e.config,s.percent),a=N(s.point).mul(r);i=i.add(a)}return i.toString()}async calculateAllXCetusRewarder(e){const t=this._sdk.ClmmSDK.senderAddress;let n=N(0);const i=[];for(const o of e){const s=await this._sdk.MakerModule.getMakerPoolPeriods(o),r=await this._sdk.MakerModule.getPoolMarkerPositionList(o.whale_nfts.whale_nfts_handle,s),a=[];for(const c of s){const u=r[c.period].filter(l=>{var d;return t.length===0?!1:((d=l.clmm_position)==null?void 0:d.owner)===t});u.length>0&&(await this._sdk.MakerModule.updateXCetusRewarderAndFee(o,u,c),u.forEach(l=>{var d;((d=l.clmm_position)==null?void 0:d.position_status)===gm.Exists&&N(l.bonus_num).greaterThan(0)&&(n=n.add(l.bonus_num),a.includes(l.clmm_position.pos_object_id)||a.push(l.clmm_position.pos_object_id))}))}i.push({bonus_type:o.bonus_type,pool_id:o.pool_id,nft_ids:a})}return{claimtotal:n,claimRecord:i}}async getPoolBonusInfo(e,t,n=!1){const i=`${e}_${t}_getPoolBonusInfo`,o=this.getCache(i,n);if(o!==void 0)return o;const s=await this.sdk.ClmmSDK.fullClient.getDynamicFieldObject({parentId:e,name:{type:"u64",value:t.toString()}}),r=Oe(s),a=$o.buildPoolBonusInfo(r);return this.updateCache(i,a,go),a}claimPayload(e){const{maker_bonus:t,xcetus:n}=this.sdk.sdkOptions,i=new _t;return i.moveCall({target:`${t.published_at}::${Rf}::claim`,typeArguments:[e.bonus_type],arguments:[i.pure(et(t).maker_config_id),i.pure(e.market_pool_id),i.pure(e.position_nft_id),i.pure(e.phase),i.pure(et(n).lock_manager_id),i.pure(et(n).xcetus_manager_id),i.pure(e.ve_nft_id)]}),i}claimAllPayload(e){const{maker_bonus:t,xcetus:n}=this.sdk.sdkOptions,i=new _t;return e.whale_nfts.forEach(o=>{o.nft_ids.forEach(s=>{i.moveCall({target:`${t.published_at}::${Rf}::claim_all`,typeArguments:[o.bonus_type],arguments:[i.object(et(t).maker_config_id),i.object(o.pool_id),i.object(s),i.object(et(n).lock_manager_id),i.object(et(n).xcetus_manager_id),i.object(e.ve_nft_id)]})})}),i}updateCache(e,t,n=go){let i=this._cache[e];i?(i.overdueTime=En(n),i.value=t):i=new Wi(t,En(n)),this._cache[e]=i}getCache(e,t=!1){const n=this._cache[e];if(!t&&(n!=null&&n.isValid()))return n.value;delete this._cache[e]}},Ms="router",Pl="router",ea=24*3600,Dc=1e3,$i=1e11,Qo=class{static buildVeNFTDividendInfo(e){const t={id:e.id.id,ve_nft_id:e.name,rewards:[]};return e.value.fields.value.fields.dividends.fields.contents.forEach(n=>{const i=[];n.fields.value.fields.contents.forEach(o=>{i.push({coin_type:Ct(o.fields.key.fields.name).source_address,amount:o.fields.value})}),t.rewards.push({period:Number(n.fields.key),rewards:i})}),t}static buildDividendManager(e){const t={id:e.id.id,dividends:{id:e.dividends.fields.id.id,size:e.dividends.fields.size},venft_dividends:{id:e.venft_dividends.fields.id.id,size:e.venft_dividends.fields.size},bonus_types:[],start_time:Number(e.start_time),interval_day:Number(e.interval_day),balances:{id:e.balances.fields.id.id,size:e.balances.fields.size},is_open:e.is_open};return e.bonus_types.forEach(n=>{t.bonus_types.push(Ct(n.fields.name).source_address)}),t}static buildLockUpManager(e){return{id:e.id.id,balance:e.balance,treasury_manager:e.treasury_manager,extra_treasury:e.extra_treasury,lock_infos:{lock_handle_id:e.lock_infos.fields.id.id,size:Number(e.lock_infos.fields.size)},type_name:oo(e.type_name.fields.name),min_lock_day:Number(e.min_lock_day),max_lock_day:Number(e.max_lock_day),package_version:Number(e.package_version),max_percent_numerator:Number(e.max_percent_numerator),min_percent_numerator:Number(e.min_percent_numerator)}}static buildLockCetus(e){const t=e.fields,n={id:t.id.id,type:Ct(e.type).source_address,locked_start_time:Number(t.locked_start_time),locked_until_time:Number(t.locked_until_time),cetus_amount:t.balance,xcetus_amount:"0",lock_day:0};return n.lock_day=(n.locked_until_time-n.locked_start_time)/ea,n}static getAvailableXCetus(e,t){let n=N(0);return t.forEach(i=>{n=n.add(i.xcetus_amount)}),N(e.xcetus_balance).sub(n).toString()}static getWaitUnLockCetuss(e){return e.filter(t=>!Qo.isLocked(t))}static getLockingCetuss(e){return e.filter(t=>Qo.isLocked(t))}static isLocked(e){return e.locked_until_time>Date.parse(new Date().toString())/1e3}static buildDividendRewardTypeList(e){const t=new Set;return e.forEach(n=>{n.rewards.forEach(i=>{t.add(i.coin_type)})}),Array.from(t)}static getNextStartTime(e){const t=Date.now()/1e3,{start_time:n,interval_day:i}=e,o=Math.ceil((t-n)/(i*ea));return n+o*i*ea}},PS=class{constructor(e){qt(this,"_sdk");qt(this,"_cache",{});this._sdk=e}get sdk(){return this._sdk}async getOwnerVeNFT(e,t=!0){const{xcetus:n}=this.sdk.sdkOptions,i=`${e}_getLockUpManagerEvent`,o=this.getCache(i,t);if(o!==void 0)return o;let s;const r=`${n.package_id}::xcetus::VeNFT`;return(await this._sdk.ClmmSDK.fullClient.getOwnedObjectsByPage(e,{options:{showType:!0,showContent:!0,showDisplay:!0},filter:{StructType:r}})).data.forEach(c=>{const u=Ct(ro(c)).source_address;if(u===r&&c.data&&c.data.content){const{fields:l}=c.data.content;s={...Vu(c),id:l.id.id,index:l.index,type:u,xcetus_balance:l.xcetus_balance},this.updateCache(i,s,Ee)}}),s}async getOwnerLockCetuss(e){const{xcetus:t}=this.sdk.sdkOptions,n=[],i=`${t.package_id}::lock_coin::LockedCoin<${this.buileCetusCoinType()}>`,o=await this._sdk.ClmmSDK.fullClient.getOwnedObjectsByPage(e,{options:{showType:!0,showContent:!0},filter:{StructType:i}});for(const s of o.data)if(Ct(ro(s)).source_address===i&&s.data){const a=Qo.buildLockCetus(s.data.content);a.xcetus_amount=await this.getXCetusAmount(a.id),n.push(a)}return n}async getLockCetus(e){var n;const t=await this._sdk.ClmmSDK.fullClient.getObject({id:e,options:{showType:!0,showContent:!0}});if((n=t.data)!=null&&n.content){const i=Qo.buildLockCetus(t.data.content);return i.xcetus_amount=await this.getXCetusAmount(i.id),i}}async getOwnerCetusCoins(e){return await this._sdk.ClmmSDK.getOwnerCoinAssets(e,this.buileCetusCoinType())}mintVeNFTPayload(){const{xcetus:e}=this.sdk.sdkOptions,t=new _t;return t.moveCall({target:`${e.published_at}::${Ms}::mint_venft`,typeArguments:[],arguments:[t.pure(et(e).xcetus_manager_id)]}),t}async convertPayload(e){const{xcetus:t}=this.sdk.sdkOptions,n=new _t,i=this.buileCetusCoinType(),o=await rn.syncBuildCoinInputForAmount(this._sdk.ClmmSDK,n,BigInt(e.amount),i);return e.venft_id===void 0?n.moveCall({target:`${t.published_at}::${Ms}::mint_and_convert`,typeArguments:[],arguments:[n.object(et(t).lock_manager_id),n.object(et(t).xcetus_manager_id),o,n.pure(e.amount)]}):n.moveCall({target:`${t.published_at}::${Ms}::convert`,typeArguments:[],arguments:[n.object(et(t).lock_manager_id),n.object(et(t).xcetus_manager_id),o,n.pure(e.amount),n.pure(e.venft_id)]}),n}redeemLockPayload(e){const{xcetus:t}=this.sdk.sdkOptions,n=new _t;return n.moveCall({target:`${t.published_at}::${Ms}::redeem_lock`,typeArguments:[],arguments:[n.pure(et(t).lock_manager_id),n.pure(et(t).xcetus_manager_id),n.pure(e.venft_id),n.pure(e.amount),n.pure(e.lock_day),n.pure(Ot)]}),n}redeemPayload(e){const{xcetus:t}=this.sdk.sdkOptions,n=new _t;return n.moveCall({target:`${t.published_at}::${Ms}::redeem`,typeArguments:[],arguments:[n.pure(et(t).lock_manager_id),n.pure(et(t).xcetus_manager_id),n.pure(e.venft_id),n.pure(e.lock_id),n.pure(Ot)]}),n}redeemDividendPayload(e,t){const{xcetus:n,xcetus_dividends:i}=this.sdk.sdkOptions,o=new _t;return t.forEach(s=>{o.moveCall({target:`${n.published_at}::${Pl}::redeem`,typeArguments:[s],arguments:[o.object(et(i).dividend_manager_id),o.object(e)]})}),o}redeemDividendV2Payload(e,t,n){const{xcetus_dividends:i}=this.sdk.sdkOptions;let o=new _t;return t.filter(r=>n.includes(r)).length>0&&(o=this.redeemDividendXTokenPayload(e,o)),t.forEach(r=>{n.includes(r)||o.moveCall({target:`${i.published_at}::${Pl}::redeem_v2`,typeArguments:[r],arguments:[o.object(et(i).dividend_manager_id),o.object(e),o.object(Ot)]})}),o}redeemDividendXTokenPayload(e,t){const{xcetus_dividends:n,xcetus:i}=this.sdk.sdkOptions,{xcetus_manager_id:o,lock_manager_id:s}=et(i),{dividend_manager_id:r}=et(n);return t=t===void 0?new _t:t,t.moveCall({target:`${n.published_at}::${Pl}::redeem_xtoken`,typeArguments:[],arguments:[t.object(s),t.object(o),t.object(r),t.object(e),t.object(Ot)]}),t}buileCetusCoinType(){return`${this.sdk.sdkOptions.cetus_faucet.package_id}::cetus::CETUS`}buileXTokenCoinType(e=this._sdk.sdkOptions.xcetus.package_id,t="xcetus",n="XCETUS"){return`${e}::${t}::${n}`}cancelRedeemPayload(e){const{xcetus:t}=this.sdk.sdkOptions,n=new _t;return n.moveCall({target:`${t.published_at}::${Ms}::cancel_redeem_lock`,typeArguments:[],arguments:[n.pure(et(t).lock_manager_id),n.pure(et(t).xcetus_manager_id),n.pure(e.venft_id),n.pure(e.lock_id),n.pure(Ot)]}),n}async getInitConfigs(){var r,a;const{package_id:e}=this.sdk.sdkOptions.xcetus,t=`${e}_getInitFactoryEvent`,n=this.getCache(t);if(n!==void 0)return n;const i=(r=await this._sdk.ClmmSDK.fullClient.queryEventsByPage({MoveEventType:`${e}::xcetus::InitEvent`}))==null?void 0:r.data,o={xcetus_manager_id:"",lock_manager_id:"",lock_handle_id:""};i.length>0&&i.forEach(c=>{const u=c.parsedJson;u&&(o.xcetus_manager_id=u.xcetus_manager)});const s=(a=await this._sdk.ClmmSDK.fullClient.queryEventsByPage({MoveEventType:`${e}::locking::InitializeEvent`}))==null?void 0:a.data;return s.length>0&&s.forEach(c=>{const u=c.parsedJson;u&&(o.lock_manager_id=u.lock_manager)}),o.lock_manager_id.length>0&&(o.lock_handle_id=(await this.getLockUpManager(o.lock_manager_id)).lock_infos.lock_handle_id),this.updateCache(t,o,Ee),o}async getLockUpManager(e=et(this.sdk.sdkOptions.xcetus).lock_manager_id,t=!1){const n=`${e}_getLockUpManager`,i=this.getCache(n,t);if(i!==void 0)return i;const o=await this.sdk.ClmmSDK.fullClient.getObject({id:e,options:{showContent:!0}}),s=Qo.buildLockUpManager(Oe(o));return this.updateCache(n,s,Ee),s}async getDividendConfigs(){var s;const{package_id:e}=this.sdk.sdkOptions.xcetus_dividends,t=`${e}_getDividendManagerEvent`,n=this.getCache(t);if(n!==void 0)return n;const i=(s=await this._sdk.ClmmSDK.fullClient.queryEventsByPage({MoveEventType:`${e}::dividend::InitEvent`}))==null?void 0:s.data,o={dividend_manager_id:"",dividend_admin_id:"",dividend_settle_id:""};return i.length>0&&i.forEach(r=>{const a=r.parsedJson;a&&(o.dividend_manager_id=a.manager_id,o.dividend_admin_id=a.admin_id,o.dividend_settle_id=a.settle_id,this.updateCache(t,o,Ee))}),o}async getDividendManager(e=!1){const{dividend_manager_id:t}=et(this._sdk.sdkOptions.xcetus_dividends),n=`${t}_getDividendManager`,i=this.getCache(n,e);if(i!==void 0)return i;const o=await this._sdk.ClmmSDK.fullClient.getObject({id:t,options:{showContent:!0}}),s=Oe(o),r=Qo.buildDividendManager(s);return this.updateCache(n,r,Ee),r}async getXcetusManager(e=!0){const{xcetus_manager_id:t}=et(this._sdk.sdkOptions.xcetus),n=`${t}_getXcetusManager`,i=this.getCache(n,e);if(i)return i;const o=await this._sdk.ClmmSDK.fullClient.getObject({id:t,options:{showContent:!0}}),s=Oe(o),r={id:s.id.id,index:Number(s.index),has_venft:{handle:s.has_venft.fields.id.id,size:s.has_venft.fields.size},nfts:{handle:s.nfts.fields.id.id,size:s.nfts.fields.size},total_locked:s.total_locked,treasury:s.treasury.fields.total_supply.fields.value};return this.updateCache(n,r),r}async getVeNFTDividendInfo(e,t){try{const n=await this._sdk.ClmmSDK.fullClient.getDynamicFieldObject({parentId:e,name:{type:"0x2::object::ID",value:t}}),i=Oe(n);return Qo.buildVeNFTDividendInfo(i)}catch{return}}async redeemNum(e,t){if(BigInt(e)===BigInt(0))return{amountOut:"0",percent:"0"};const n=await this.getLockUpManager(et(this._sdk.sdkOptions.xcetus).lock_manager_id),i=N($i).mul(N(n.max_lock_day).sub(N(t))).mul(N(n.max_percent_numerator).sub(N(n.min_percent_numerator))).div(N(n.max_lock_day).sub(N(n.min_lock_day))),o=N($i).mul(N(n.max_percent_numerator)).sub(i).div(N(Dc)).div($i);return{amountOut:N(o).mul(N(e)).round().toString(),percent:o.toString()}}async reverseRedeemNum(e,t){if(BigInt(e)===BigInt(0))return{amountOut:"0",percent:"0"};const n=await this.getLockUpManager(et(this._sdk.sdkOptions.xcetus).lock_manager_id),i=N($i).mul(N(n.max_lock_day).sub(N(t))).mul(N(n.max_percent_numerator).sub(N(n.min_percent_numerator))).div(N(n.max_lock_day).sub(N(n.min_lock_day))),o=N($i).mul(N(n.max_percent_numerator)).sub(i).div(N(Dc)).div($i);return{amountOut:N(e).div(o).toFixed(0,it.ROUND_UP),percent:o.toString()}}async getXCetusAmount(e){const{lock_handle_id:t}=et(this._sdk.sdkOptions.xcetus),n=`${e}_getXCetusAmount`,i=this.getCache(n);if(i!==void 0)return i;try{const o=await this.sdk.ClmmSDK.fullClient.getDynamicFieldObject({parentId:t,name:{type:"0x2::object::ID",value:e}}),s=Oe(o);if(s){const{xcetus_amount:r}=s.value.fields.value.fields;return this.updateCache(n,r,Ee),r}}catch{}return"0"}async getVeNftAmount(e,t){try{const n=await this.sdk.ClmmSDK.fullClient.getDynamicFieldObject({parentId:e,name:{type:"0x2::object::ID",value:t}}),i=Oe(n);if(i){const{lock_amount:o,xcetus_amount:s}=i.value.fields.value.fields;return{lock_amount:o,xcetus_amount:s}}}catch{}return{lock_amount:"0",xcetus_amount:"0"}}async getPhaseDividendInfo(e,t=!1){const i=(await this.getDividendManager()).dividends.id,o=`${i}_${e}_getPhaseDividendInfo`,s=this._sdk.getCache(o,t);if(s)return s;try{const r=await this._sdk.ClmmSDK.fullClient.getDynamicFieldObject({parentId:i,name:{type:"u64",value:e}}),a=Oe(r),c=a.value.fields.value.fields,u=c.redeemed_num.fields.contents.map(g=>({name:g.fields.key.fields.name,value:g.fields.value})),l=c.bonus_types.map(g=>g.fields.name),d=c.bonus.fields.contents.map(g=>({name:g.fields.key.fields.name,value:g.fields.value})),h={id:da(r),phase:a.name,settled_num:c.settled_num,register_time:c.register_time,redeemed_num:u,is_settled:c.is_settled,bonus_types:l,bonus:d,phase_end_time:""};return this.updateCache(o,h),h}catch{}}updateCache(e,t,n=go){let i=this._cache[e];i?(i.overdueTime=En(n),i.value=t):i=new Wi(t,En(n)),this._cache[e]=i}getCache(e,t=!1){const n=this._cache[e];if(!t&&(n!=null&&n.isValid()))return n.value;delete this._cache[e]}},CS="factory",ki="oversubscribe_pool",Am=1e6,zs=1e18,Ds="router",Cl="router",Ya="router",$f={curve:{strategy:3,both_side:{div_width:10,ratios:[.333333,.266666,.2,.133333,.066666]},one_side:{div_width:5,ratios:[.333333,.266666,.2,.133333,.066666]}},bidAsk:{strategy:4,both_side:{div_width:10,ratios:[.172413793,.137931034,.103448276,.068965517,.034482759,.068965517,.103448276,.137931034,.172413793]},one_side:{div_width:5,ratios:[.066666667,.13333333,.2,.266666667,.333333333]}}};function BS(e){return"master_address"in e}var ES="router",IS="vaults",OS=1e4,Fn=class{static buildIdoPoolImmutables(e){return{pool_address:Dn(e.pool_id),coin_type_sale:Ct(e.sale_coin_type.name).full_address,coin_type_raise:Ct(e.raise_coin_type.name).full_address,tick_spacing:Number(e.tick_spacing),total_supply:e.total_supply,min_purchase:e.min_purchase_amount,max_purchase:e.max_purchase_amount}}static buildIdoPool(e){const t=ro(e),n=Ct(t),i=Oe(e);console.log("fields:",i);const o={pool_address:Dn(i.id.id),coin_type_sale:n.type_arguments[0],coin_type_raise:n.type_arguments[1],tick_spacing:Number(i.tick_spacing),total_supply:i.total_supply,min_purchase:i.min_purchase_amount,max_purchase:i.max_purchase_amount},s={start_time:Number(i.duration_manager.fields.start_time),lock_up_duration:Number(i.duration_manager.fields.lock_up_duration),purchase_duration:Number(i.duration_manager.fields.purchase_duration),end_time:0};s.end_time=s.start_time+s.purchase_duration;const r={complete_raise_limit:i.complete_raise_limit,liquidity_injection_ratio:N(i.liquidity_injection_ratio).div(Am).toNumber(),current_sqrt_price_min:i.current_sqrt_price_min,current_sqrt_price_max:i.current_sqrt_price_max,owner:i.owner,sale_coin_amount:i.sale_coin,raise_coin_amount:i.raise_coin,price:i.price,current_price:i.price,duration_summary:s,is_cancelled:i.is_cancelled,is_liquidity_injected:i.is_liquidity_injected,liquidity_used_raise_amount:i.liquidity_used_raise_amount,liquidity_used_sale_amount:i.liquidity_used_sale_amount,purchase_summary:{size:Number(i.purchase_manager.fields.purchases.fields.size),purchase_handle:i.purchase_manager.fields.purchases.fields.id.id},total_purchase_amount:i.total_purchase_amount,white_summary:{white_list_id:i.white_list.fields.id.id,protection_limit_used:i.white_list.fields.protection_limit_used,protection_hard_cap:i.white_list.fields.protection_hard_cap,white_handle:i.white_list.fields.addresses.fields.id.id,size:Number(i.white_list.fields.addresses.fields.size)},pool_status:"Upcoming",max_raise_amount:"",sale_decimals:0,raise_decimals:0,is_withdrawn:i.is_withdrawn};return Fn.updatePoolStatus(r),{...o,...r}}static is_init_period(e){return Number(N(Date.now()/1e3).toFixed(0))<e.start_time}static is_purchase_period(e){const t=Number(N(Date.now()/1e3).toFixed(0));return t>=e.start_time&&t<=e.start_time+e.purchase_duration}static is_claim_period(e){const t=Number(N(Date.now()/1e3).toFixed(0)),n=e.start_time+e.purchase_duration;return t>n}static is_can_inject_liquidity(e){return!e.is_cancelled&&e.liquidity_injection_ratio!==0&&Fn.is_claim_period(e.duration_summary)&&!e.is_liquidity_injected}static is_can_withdraw(e){return e.is_withdrawn?!1:Fn.is_sale_failed(e)?!0:(e.liquidity_injection_ratio===0||e.is_liquidity_injected)&&Fn.is_claim_period(e.duration_summary)}static is_sale_failed(e){return!!(e.is_cancelled||Fn.is_claim_period(e.duration_summary)&&N(e.total_purchase_amount).lessThan(e.complete_raise_limit))}static buildPurchaseInfo(e){return{...e.value.fields.value.fields,owner:e.name}}static calculateRedeemAmount(e,t){let n,i;if(Fn.is_sale_failed(e))n="0",i="0";else if(t.is_redeemed)n=t.obtained_sale_amount,i=t.used_raise_amount;else if(N(e.total_purchase_amount).lessThanOrEqualTo(e.max_raise_amount))n=N(t.purchased_raise_amount).mul(zs).div(e.price).toString(),i=t.purchased_raise_amount;else{const s=Fn.redeemForSaleOversubcribeV2(e,t);n=s.user_obtained_sale_amount,i=s.user_used_raise_amount_ceil}n=it.floor(n);const o=it.floor(N(t.purchased_raise_amount).sub(i).toString());return{obtained_sale_amount:n,refunded_raise_amount:o}}static calculateWithdrawAmount(e){let t,n;const i=N(e.total_supply).mul(e.liquidity_injection_ratio);if(Fn.is_sale_failed(e))t="0",n=N(i).add(e.total_supply);else{const{max_raise_amount:o}=e;N(e.total_purchase_amount).greaterThanOrEqualTo(o)?(t=N(o).sub(e.liquidity_used_raise_amount).toString(),n="0"):(t=N(e.total_purchase_amount).sub(e.liquidity_used_raise_amount),n=N(e.total_supply).add(i).sub(e.liquidity_used_sale_amount).sub(Fn.get_sold_amount(e)))}return{obtained_raise_amount:it.floor(t).toString(),refunded_sale_amount:it.ceil(n).toString()}}static get_sold_amount(e){return N(e.total_purchase_amount).greaterThanOrEqualTo(e.max_raise_amount)?e.total_supply:N(e.total_purchase_amount).mul(zs).div(e.price)}static redeemForSaleOversubcribe(e,t){const n=t.protection_raise_amount,i=N(t.purchased_raise_amount).sub(n),o=e.max_raise_amount,{protection_limit_used:s}=e.white_summary,r=N(o).sub(s),a=N(e.total_purchase_amount).sub(s),c=it.ceil(i.mul(r).div(a).add(n)),u=it.floor(i.mul(r).div(a).add(n));return{user_obtained_sale_amount:it.floor(N(e.total_supply).mul(u).div(o)),user_used_raise_amount_ceil:c}}static redeemForSaleOversubcribeV2(e,t){const n=t.protection_raise_amount,i=N(t.purchased_raise_amount).sub(n),o=e.max_raise_amount,{protection_limit_used:s}=e.white_summary,r=N(o).sub(s),a=N(e.total_purchase_amount).sub(s),c=N(n).mul(a).add(N(i).mul(r)).mul(zs).div(N(a).mul(e.price)),u=it.ceil(c.mul(e.price).div(zs));return{user_obtained_sale_amount:c,user_used_raise_amount_ceil:u}}static raiseTotalAmount(e){const t=N(e.sale_decimals-e.raise_decimals).abs().toNumber();return e.sale_decimals>e.raise_decimals?N(e.total_supply).mul(e.current_price).div(N(10).pow(N(t))).toString():N(e.total_supply).mul(e.current_price).mul(N(10).pow(N(t))).toString()}static updatePoolStatus(e){const t=Number(N(Date.now()/1e3).toFixed(0)),n=e.duration_summary,i=n.start_time+n.purchase_duration;e.is_cancelled?e.pool_status="Canceled":t<n.start_time?e.pool_status="Upcoming":t>n.start_time&&t<i?e.pool_status="Live":N(e.total_purchase_amount).lessThan(e.complete_raise_limit)?e.pool_status="Failed":e.pool_status="Ended"}static async calculatePoolUiPrice(e,t){const n=await e.ClmmSDK.CetusConfig.getTokenListByCoinTypes([t.coin_type_sale,t.coin_type_raise]),i=n[t.coin_type_sale].decimals,o=n[t.coin_type_raise].decimals;t.current_price=ai.priceFixToReal(Number(N(t.price).div(N(zs)).toString()),i,o).toString(),t.sale_decimals=i,t.raise_decimals=o,t.max_raise_amount=this.raiseTotalAmount(t)}},IP=class{constructor(e){qt(this,"_sdk");this._sdk=e}async getPools(e=[],t=!1){const n=[];if(e.length>0){if(e.filter(o=>{const s=`${o}_getPool`,r=this._sdk.getCache(s,t);return r?(n.push(r),!1):!0}).length>0){const o=await this._sdk.ClmmSDK.fullClient.batchGetObjects(e,{showType:!0,showContent:!0});for(const s of o){const r=await this.buildIdoWarpPool(s);r&&n.push(r)}}}else(await this._sdk.Ido.getPools()).forEach(o=>{n.push({...o,version:"2"})});return n.forEach(i=>{const o=`${i.pool_address}_getPool`;this._sdk.updateCache(o,i)}),n}async getPool(e,t=!0){const n=`${e}_getPool`,i=this._sdk.getCache(n,t);if(i)return i;const o=await this._sdk.ClmmSDK.fullClient.getObject({id:e,options:{showContent:!0,showType:!0}}),s=await this.buildIdoWarpPool(o);return this._sdk.updateCache(n,s),s}async getJoinPools(e,t){const n=[],i=t.filter(s=>s.version==="1"),o=t.filter(s=>s.version==="2");if(i.length>0){const s=await this._sdk.Launchpad.getPurchaseMarks(e,i.map(r=>r.pool_address),!1);i.forEach(r=>{for(const a of s)if(a.pool_id===r.pool_address){n.push(r);break}})}for(const s of o)await this._sdk.Ido.getPurchaseInfo(s.purchase_summary.purchase_handle,e,!1)&&n.push(s);return n}async getOwnerPools(e,t){return t.filter(n=>n.owner===ri(e))}async creatPurchasePayload(e,t){return e.version==="1"?await this._sdk.Launchpad.creatPurchasePayload({pool_address:e.pool_address,purchase_amount:t,coin_type_sale:e.coin_type_sale,coin_type_raise:e.coin_type_raise}):await this._sdk.Ido.creatPurchasePayload({pool_address:e.pool_address,coin_type_sale:e.coin_type_sale,coin_type_raise:e.coin_type_raise,purchase_handle:e.purchase_summary.purchase_handle,raise_amount:t.toString()})}async creatRedeemPayload(e){return e.version==="1"?await this._sdk.Launchpad.creatClaimPayload({pool_address:e.pool_address,coin_type_sale:e.coin_type_sale,coin_type_raise:e.coin_type_raise}):await this._sdk.Ido.redeemPayload({pool_address:e.pool_address,coin_type_sale:e.coin_type_sale,coin_type_raise:e.coin_type_raise,purchase_handle:e.purchase_summary.purchase_handle})}async creatWithdrawPayload(e){if(e.version==="1"){const n=await ai.getWithdrawSale(e),i=await ai.getWithdrawRaise(e);return this._sdk.Launchpad.creatWithdrawPayload({pool_address:e.pool_address,coin_type_sale:e.coin_type_sale,coin_type_raise:e.coin_type_raise,sale_amount:BigInt(n),raise_amount:BigInt(i)})}return this._sdk.Ido.withdrawPayload({pool_address:e.pool_address,coin_type_sale:e.coin_type_sale,coin_type_raise:e.coin_type_raise})}unlockNftPayload(e,t){return e.version==="1"?this._sdk.Launchpad.creatUnlockNftPayload(t):this._sdk.Ido.unlockNftPayload({lock_nft_id:t.lock_nft,nft_type:t.nft_type})}async getLockNFTList(e){let t=[];return e.version==="1"&&(t=await this._sdk.Launchpad.getLockNFTList(e.owner)),t=await this._sdk.Ido.getLockNFTList(e.owner),t.filter(i=>{const o=Ct(i.coin_type_a).full_address,s=Ct(i.coin_type_b).full_address,r=Ct(e.coin_type_sale).full_address,a=Ct(e.coin_type_raise).full_address;return o===r&&s===a||o===a&&s===r})}async isWhiteListUser(e,t){return t.version==="1"?await this._sdk.Launchpad.isWhiteListUser(t.white_summary.white_handle,e):!!await this._sdk.Ido.getWhiteProtectionLimit(t.white_summary.white_handle,e)}async getPurchaseInfo(e,t){if(t.version==="1"){const i=await this._sdk.Launchpad.getPurchaseMarks(e,[t.pool_address]);return i.length>0?i[0]:void 0}return await this._sdk.Ido.getPurchaseInfo(t.purchase_summary.purchase_handle,e)}async getwhiteProtectionInfo(e,t,n=!1){if(t.version==="1")return await this._sdk.Launchpad.getPurchaseAmount(t.white_summary.white_handle,e);const i=await this._sdk.Ido.getPurchaseInfo(t.purchase_summary.purchase_handle,e,n);if(i)return{safe_limit_amount:i.protection_raise_limit,safe_purchased_amount:i.protection_raise_amount};const o=await this._sdk.Ido.getWhiteProtectionLimit(t.white_summary.white_handle,e,!1);return o?{safe_limit_amount:o,safe_purchased_amount:"0"}:{safe_limit_amount:"0",safe_purchased_amount:"0"}}async calculateWithdrawAmount(e){if(e.version==="1"){const t=await ai.getHistoryWithdrawRaise(this._sdk,e),n=await ai.getHistoryWithdrawSale(this._sdk,e);return{obtained_raise_amount:t,refunded_sale_amount:n}}return Fn.calculateWithdrawAmount(e)}async buildIdoWarpPool(e){const t=xr(e);if(console.log(this._sdk.sdkOptions.ido.package_id,Ct(t).address,"buildIdoWarpPool"),Ct(t).address===this._sdk.sdkOptions.ido.package_id){const n=Fn.buildIdoPool(e);return await Fn.calculatePoolUiPrice(this._sdk,n),{...n,version:"2"}}if(Ct(t).address===this._sdk.sdkOptions.launchpad.package_id){const n=ai.buildLaunchPadPool(e);return await ai.calculatePoolPrice(this._sdk,n),{...n,version:"1"}}}},ts=class{static buildVeNFTDividendInfo(e){const t={id:e.id.id,ve_nft_id:e.name,rewards:[]};return e.value.fields.value.fields.dividends.fields.contents.forEach(n=>{const i=[];n.fields.value.fields.contents.forEach(o=>{i.push({coin_type:Ct(o.fields.key.fields.name).source_address,amount:o.fields.value})}),t.rewards.push({period:Number(n.fields.key),rewards:i})}),t}static buildDividendManager(e){const t={id:e.id.id,dividends:{id:e.dividends.fields.id.id,size:e.dividends.fields.size},venft_dividends:{id:e.venft_dividends.fields.id.id,size:e.venft_dividends.fields.size},bonus_types:[],start_time:Number(e.start_time),interval_day:Number(e.interval_day),balances:{id:e.balances.fields.id.id,size:e.balances.fields.size},is_open:e.is_open};return e.bonus_types.forEach(n=>{t.bonus_types.push(Ct(n.fields.name).source_address)}),t}static buildLockUpManager(e){return{id:e.id.id,balance:e.balance,treasury_manager:e.treasury_manager,extra_treasury:e.extra_treasury,lock_infos:{lock_handle_id:e.lock_infos.fields.id.id,size:Number(e.lock_infos.fields.size)},type_name:oo(e.type_name.fields.name),min_lock_day:Number(e.min_lock_day),max_lock_day:Number(e.max_lock_day),package_version:Number(e.package_version),max_percent_numerator:Number(e.max_percent_numerator),min_percent_numerator:Number(e.min_percent_numerator)}}static buildLockToken(e){const t=e.fields,n={id:t.id.id,type:Ct(e.type).source_address,locked_start_time:Number(t.locked_start_time),locked_until_time:Number(t.locked_until_time),token_amount:t.balance,xtoken_amount:"0",lock_day:0};return n.lock_day=(n.locked_until_time-n.locked_start_time)/ea,n}static getAvailableXToken(e,t){let n=N(0);return t.forEach(i=>{n=n.add(i.xtoken_amount)}),N(e.xtoken_balance).sub(n).toString()}static getWaitUnLockTokens(e){return e.filter(t=>!ts.isLocked(t))}static getLockingTokens(e){return e.filter(t=>ts.isLocked(t))}static buildDividendRewardTypeList(e){const t=new Set;return e.forEach(n=>{n.rewards.forEach(i=>{t.add(i.coin_type)})}),Array.from(t)}static isLocked(e){return e.locked_until_time>Date.parse(new Date().toString())/1e3}static getNextStartTime(e,t=ea){const n=Date.now()/1e3,{start_time:i,interval_day:o}=e,s=Math.ceil((n-i)/(o*t));return i+s*o*t}},co=class{static getDefaultStrategyConfig(e){let t;switch(e){case 4:t=$f.bidAsk;break;default:t=$f.curve;break}return t}static geTickIndexRange(e,t,n,i){let o,s;switch(e=he.getInitializableTickIndex(e,t),i){case"left":e>0?(s=N(e).sub(t).toNumber(),o=N(e).mul(N(1).add(n)).toDecimalPlaces(0).toNumber()):(s=N(e).sub(t).toNumber(),o=N(e).mul(N(1).sub(n)).toDecimalPlaces(0).toNumber());break;case"right":e>0?(s=N(e).mul(N(1).add(n)).toDecimalPlaces(0).toNumber(),o=N(e).add(t).toNumber()):(s=N(e).mul(N(1).sub(n)).toDecimalPlaces(0).toNumber(),o=N(e).add(t).toNumber());break;default:e>0?(o=N(e).mul(N(1).sub(n)).toDecimalPlaces(0).toNumber(),s=N(e).mul(N(1).add(n)).toDecimalPlaces(0).toNumber()):(o=N(e).mul(N(1).add(n)).toDecimalPlaces(0).toNumber(),s=N(e).mul(N(1).sub(n)).toDecimalPlaces(0).toNumber());break}if(o=he.getInitializableTickIndex(o,t),s=he.getInitializableTickIndex(s,t),o<Jk)throw Error("Tick lower value is below the minimum allowed value.");if(s>Vk)throw Error("Tick upper value is above the maximum allowed value.");return{tick_lower:o,tick_upper:s}}static getCreateLiquidityBins(e,t){let n=[];switch(t){case 4:n=co.getCreateBidAskLiquidityBins(e);break;default:n=co.getCreateCurveLiquidityBins(e);break}return n}static getCreateBidAskLiquidityBins(e){const t=N(Math.floor(N(e.tick_upper).sub(e.tick_lower).div(e.div_width).toNumber())).abs(),n=[],i=e.ratios;let o,s;for(let r=0;r<i.length;r++){let a,c;e.tick_upper<=e.curr_tick?(c=N(e.tick_upper).sub(t.mul(r)).toNumber(),a=N(c).sub(t).toNumber()):e.tick_lower>=e.curr_tick?(a=N(e.tick_lower).add(t.mul(r)).toNumber(),c=N(e.tick_lower).add(t.mul(r+1)).toNumber()):r===4?(a=N(e.tick_lower).add(t.mul(r)).toNumber(),c=N(a).add(t.mul(2)).toNumber()):r>4?(a=N(e.tick_lower).add(t.mul(r+1)).toNumber(),c=N(a).add(t).toNumber()):(a=N(e.tick_lower).add(t.mul(r)).toNumber(),c=N(a).add(t).toNumber()),o=he.getInitializableTickIndex(a,e.tick_spacing),s=he.getInitializableTickIndex(c,e.tick_spacing),n.push({tick_lower:o,tick_upper:s,ratio:i[r],liquidity:"0"})}return n}static getCreateCurveLiquidityBins(e){const t=N(Math.floor(N(e.tick_upper).sub(e.tick_lower).div(e.div_width).toNumber())).abs(),n=[],i=e.ratios;for(let o=0;o<i.length;o++){let s,r;e.tick_upper<=e.curr_tick?(r=e.tick_upper,s=N(e.tick_upper).sub(t.mul(o+1)).toNumber()):e.tick_lower>=e.curr_tick?(s=e.tick_lower,r=N(s).add(t.mul(o+1)).toNumber()):(s=N(e.curr_tick).sub(t.mul(o+1)).toNumber(),r=N(e.curr_tick).add(t.mul(o+1)).toNumber()),n.push({tick_lower:he.getInitializableTickIndex(s,e.tick_spacing),tick_upper:he.getInitializableTickIndex(r,e.tick_spacing),ratio:i[o],liquidity:"0"})}return n}static calculateAddLiquidityInputs(e){const t=new _(he.tickIndexToSqrtPriceX64(e.curr_tick)),n=co.calculateCoinRatios(e.curr_tick,e.liquidity_bins),i=e.liquidity_bins.map((o,s)=>{const r=n[s],a=N(e.coin_amount).mul(e.fix_amount_a?r.coinRatioA:r.coinRatioB).toFixed(0).toString();try{return{...Hn.estLiquidityAndcoinAmountFromOneAmounts(o.tick_lower,o.tick_upper,new _(a),e.fix_amount_a,!0,e.slippage,t),...o}}catch{return{coinAmountA:new _(0),coinAmountB:new _(0),tokenMaxA:new _(0),tokenMaxB:new _(0),liquidityAmount:new _(0),fix_amount_a:!e.fix_amount_a,...o}}});return co.fixLiquidityInputs(t,e.slippage,i,!0)}static fixLiquidityInputs(e,t,n,i){const o=n.filter(r=>r.liquidityAmount.gt(kn));if(o.length===0)return[];const s=o[0];return n.map(r=>{if(r.liquidityAmount.eq(kn)){const a=N(s.liquidityAmount.toString()).mul(r.ratio).div(s.ratio).toFixed(0),c=he.tickIndexToSqrtPriceX64(r.tick_lower),u=he.tickIndexToSqrtPriceX64(r.tick_upper),l=Hn.getCoinAmountFromLiquidity(new _(a.toString()),e,c,u,!1);return{coinAmountA:l.coinA,coinAmountB:l.coinB,liquidityAmount:new _(a.toString()),fix_amount_a:r.fix_amount_a,...kl(l,ta.fromDecimal(N(t).mul(100)),i)}}return r})}static calculateCoinRatios(e,t){const n=new _(he.tickIndexToSqrtPriceX64(e)),i=[];let o=N(0),s=N(0);const r=t.map(u=>{const l=N(vS(100,6).toString()).mul(u.ratio).toFixed(0).toString(),d=he.tickIndexToSqrtPriceX64(u.tick_lower),h=he.tickIndexToSqrtPriceX64(u.tick_upper),g=Hn.getCoinAmountFromLiquidity(new _(l),n,d,h,!0);return o=o.add(g.coinA.toString()),s=s.add(g.coinB.toString()),{...g,liquidity:l}}),a=[],c=[];return r.forEach((u,l)=>{const d={coinRatioA:o.eq(N(0))?0:N(u.coinA.toString()).div(o).toNumber(),coinRatioB:s.eq(N(0))?0:N(u.coinB.toString()).div(s).toNumber(),liquiditys:u.liquidity,tick_lower:t[l].tick_lower,tick_upper:t[l].tick_upper};i.push(d),a.push(o.eq(N(0))?0:N(u.coinA.toString()).div(o).toNumber()),c.push(s.eq(N(0))?0:N(u.coinB.toString()).div(s).toNumber())}),i}static calculateCloseMasterLiquidityInputs(e){const t=new _(he.tickIndexToSqrtPriceX64(e.curr_tick));return e.positions.map(i=>{const o=new _(i.liquidity),s=he.tickIndexToSqrtPriceX64(i.tick_lower_index),r=he.tickIndexToSqrtPriceX64(i.tick_upper_index),a=Hn.getCoinAmountFromLiquidity(o,t,s,r,!1),c=ta.fromDecimal(N(e.slippage).mul(100)),{tokenMaxA:u,tokenMaxB:l}=kl(a,c,!1);return{coinAmountA:a.coinA,coinAmountB:a.coinB,tokenMaxA:u,tokenMaxB:l,liquidityAmount:o,fix_amount_a:!1}})}static calculateRemoveMasterLiquidityInputs(e){const t=new _(he.tickIndexToSqrtPriceX64(e.curr_tick)),{fix_token:n}=e;if(n){const o=e.positions.map((a,c)=>({tick_lower:a.tick_lower_index,tick_upper:a.tick_upper_index,ratio:e.ratios[c]})),s=co.calculateCoinRatios(e.curr_tick,o),r=e.positions.map((a,c)=>{const u=s[c],l=N(n.coin_amount).mul(n.fix_amount_a?u.coinRatioA:u.coinRatioB).toFixed(0).toString();try{const d=Hn.estLiquidityAndcoinAmountFromOneAmounts(a.tick_lower_index,a.tick_upper_index,new _(l),n.fix_amount_a,!1,e.slippage,t);return{...d,tick_lower:a.tick_lower_index,tick_upper:a.tick_upper_index,liquidity:d.liquidityAmount.toString(),ratio:e.ratios[c]}}catch{return{coinAmountA:new _(0),coinAmountB:new _(0),tokenMaxA:new _(0),tokenMaxB:new _(0),liquidityAmount:new _(0),fix_amount_a:!n.fix_amount_a,tick_lower:a.tick_lower_index,tick_upper:a.tick_upper_index,liquidity:"0",ratio:e.ratios[c]}}});return co.fixLiquidityInputs(t,e.slippage,r,!1)}return e.positions.map((o,s)=>{const r=e.ratios[s];let a=N(e.liquidity).mul(r).toFixed(0);N(a).greaterThan(o.liquidity)&&(a=o.liquidity);const c=he.tickIndexToSqrtPriceX64(o.tick_lower_index),u=he.tickIndexToSqrtPriceX64(o.tick_upper_index),l=Hn.getCoinAmountFromLiquidity(new _(a),t,c,u,!1),d=ta.fromDecimal(N(e.slippage).mul(100)),{tokenMaxA:h,tokenMaxB:g}=kl(l,d,!1);return{coinAmountA:l.coinA,coinAmountB:l.coinB,tokenMaxA:h,tokenMaxB:g,liquidityAmount:new _(a),fix_amount_a:!1}})}static buildMasterPosition(e){return{coin_type_a:Ct(e.coin_type_a.fields.name).full_address,coin_type_b:Ct(e.coin_type_b.fields.name).full_address,description:e.description,id:e.id.id,index:e.index,liquidity:e.liquidity,name:e.name,pool:e.pool,tick_lower_index:_i(BigInt(e.tick_lower_index.fields.bits)),tick_upper_index:_i(BigInt(e.tick_upper_index.fields.bits)),url:e.url}}static buildMasterNFT(e){const t=Oe(e);if(t){const n={id:t.id.id,pool_id:t.pool_id,index:Number(t.index),strategy:Number(t.strategy),tick_lower_index:_i(BigInt(t.tick_lower_index)),tick_upper_index:_i(BigInt(t.tick_upper_index)),positions:[],...Vu(e)};return n.positions=t.positions.map(i=>co.buildMasterPosition(i.fields)),n}}},Zi=class{static generateNextTickRange(e,t,n){const i=e-t/2,o=e+t/2;return{new_tick_lower:Zi.getValidTickIndex(i,n),new_tick_upper:Zi.getValidTickIndex(o,n)}}static calculateDepositRatio(e,t,n){const i=he.sqrtPriceX64ToTickIndex(n);if(i<e)return{ratioA:new it(1),ratioB:new it(0)};if(i>t)return{ratioA:new it(0),ratioB:new it(1)};const o=new _(1e8),{coinAmountB:s}=Hn.estLiquidityAndcoinAmountFromOneAmounts(e,t,o,!0,!0,0,n),r=he.sqrtPriceX64ToPrice(n,0,0),a=N(o.toString()).mul(r),c=a.add(s.toString()),u=a.div(c),l=N(s.toString()).div(c);return{ratioA:u,ratioB:l}}static getValidTickIndex(e,t){if(e%t===0)return e;let n;if(e>0?n=e-e%t+t:e<0?n=e+Math.abs(e)%t-t:n=e,n%t!==0)throw new Error("Assertion failed: res % tickSpacing == 0");if(Math.abs(n)<Math.abs(e))throw new Error("Assertion failed: res.abs() >= tickIndex");return n}static get_lp_amount_by_liquidity(e,t){return e.total_supply==="0"?"0":N(e.total_supply).mul(t).div(e.liquidity).toFixed(0,it.ROUND_DOWN).toString()}static get_share_liquidity_by_amount(e,t){return e.total_supply==="0"?"0":N(t).mul(e.liquidity).div(e.total_supply).toFixed(0,it.ROUND_DOWN).toString()}static get_protocol_fee_amount(e,t){return N(t).mul(e.protocol_fee_rate).div(OS).toFixed(0,it.ROUND_CEIL)}static buildFramsPositionNFT(e){const t=e.clmm_postion.fields;return{id:e.id.id,url:t.url,pool_id:e.pool_id,coinTypeA:Ct(t.coin_type_a.fields.name).full_address,coinTypeB:Ct(t.coin_type_b.fields.name).full_address,description:t.description,name:t.name,liquidity:t.liquidity,clmm_position_id:t.id.id,clmm_pool_id:t.pool,tick_lower_index:_i(BigInt(t.tick_lower_index.fields.bits)),tick_upper_index:_i(BigInt(t.tick_upper_index.fields.bits)),rewards:[]}}static buildPool(e){const t=Oe(e),n=xr(e),{positions:i}=t;if(t&&i.length>0){const o=Zi.buildFramsPositionNFT(i[0].fields);return{id:t.id.id,pool_id:t.pool,protocol_fee_rate:t.protocol_fee_rate,is_pause:t.is_pause,harvest_assets:{harvest_assets_handle:t.harvest_assets.fields.id.id,size:Number(t.harvest_assets.fields.size)},lp_token_type:Ct(n).type_arguments[0],total_supply:t.lp_token_treasury.fields.total_supply.fields.value,liquidity:t.liquidity,max_quota:t.max_quota,status:t.status===1?"STATUS_RUNNING":"STATUS_REBALANCING",quota_based_type:t.quota_based_type.fields.name,position:o}}}},Ys=class{static calculatePositionShare(e,t,n,i,o,s,r){if(t<=o||e>=s)return"0";let a=0;e<o?a=o:a=e;let c=0;t<s?c=t:c=s;const u=he.tickIndexToSqrtPriceX64(a),l=he.tickIndexToSqrtPriceX64(c),{coinA:d,coinB:h}=Hn.getCoinAmountFromLiquidity(new _(n),new _(r),u,l,!0);return N(d.toString()).mul(i).div(1e12).add(h.toString()).toString()}static buildFramsPool(e){const t=Oe(e);if(t)try{const n=[];return t.rewarders.forEach(o=>{n.push({reward_coin:Ct(o.fields.name).full_address,last_reward_time:"",emission_per_second:"",total_allocate_point:"",allocate_point:""})}),{id:t.id.id,clmm_pool_id:t.clmm_pool_id,effective_tick_lower:_i(BigInt(t.effective_tick_lower.fields.bits)),effective_tick_upper:_i(BigInt(t.effective_tick_upper.fields.bits)),total_share:t.total_share,rewarders:n,positions:{positions_handle:t.positions.fields.id.id,size:t.positions.fields.size},sqrt_price:t.sqrt_price}}catch(n){console.log(n)}}static buildFramsPositionNFT(e){const t=Oe(e);if(t){const n=t.clmm_postion.fields;return{id:t.id.id,url:n.url,pool_id:t.pool_id,coinTypeA:Ct(n.coin_type_a.fields.name).full_address,coinTypeB:Ct(n.coin_type_b.fields.name).full_address,description:n.description,name:n.name,liquidity:n.liquidity,clmm_position_id:n.id.id,clmm_pool_id:n.pool,tick_lower_index:_i(BigInt(n.tick_lower_index.fields.bits)),tick_upper_index:_i(BigInt(n.tick_upper_index.fields.bits)),rewards:[]}}}},RS=class{constructor(e){qt(this,"_sdk");qt(this,"_cache",{});this._sdk=e}get sdk(){return this._sdk}async getPoolImmutables(e="all",t=!1){const{package_id:n}=this._sdk.sdkOptions.ido,i=`${n}_getPoolImmutables`,o=this.getCache(i,t),s={data:[],hasNextPage:!1},r=[];if(o!==void 0&&r.push(...o),r.length===0)try{const a=await this._sdk.ClmmSDK.fullClient.queryEventsByPage({MoveEventType:`${n}::oversubscribe_pool::CreatePoolEvent`},e);a.data.forEach(c=>{const u=c.parsedJson;if(u){const l=Fn.buildIdoPoolImmutables(u);r.push(l)}}),s.hasNextPage=a.hasNextPage,s.nextCursor=a.nextCursor,this.updateCache(i,r,Ee)}catch(a){console.log("getPoolImmutables",a)}return s.data=r,s}async getPools(e=[],t=!1){const n=[];let i=[];e.length>0?i=[...e]:(await this.getPoolImmutables("all",t)).data.forEach(r=>{i.push(r.pool_address)});const o=await this._sdk.ClmmSDK.fullClient.batchGetObjects(i,{showType:!0,showContent:!0});for(const s of o){const r=Fn.buildIdoPool(s);await Fn.calculatePoolUiPrice(this._sdk,r),n.push(r);const a=`${r.pool_address}_getPoolObject`;this.updateCache(a,r,Ee)}return n}async getPool(e,t=!0){const n=`${e}_getPoolObject`,i=this.getCache(n,t);if(i!==void 0)return i;const o=await this._sdk.ClmmSDK.fullClient.getObject({id:e,options:{showContent:!0,showType:!0}}),s=Fn.buildIdoPool(o);return await Fn.calculatePoolUiPrice(this._sdk,s),this.updateCache(n,s),s}async getIdoConfigs(e=!1){var c;const{package_id:t}=this._sdk.sdkOptions.ido,n=`${t}_getInitEvent`,i=this.getCache(n,e);if(i!==void 0)return i;const o=await this._sdk.ClmmSDK.fullClient.getObject({id:t,options:{showPreviousTransaction:!0}}),s=vm(o),r=(c=await this._sdk.ClmmSDK.fullClient.queryEventsByPage({Transaction:s}))==null?void 0:c.data,a={pools_id:"",admin_cap_id:"",package_version_id:""};return r.length>0&&(r.forEach(u=>{console.log("item: ",u);const l=u.parsedJson;if(l)switch(Ct(u.type).full_address){case`${t}::config::InitConfigEvent`:a.admin_cap_id=l.admin_cap_id,a.package_version_id=l.package_version_id;break;case`${t}::factory::InitFactoryEvent`:a.pools_id=l.pools_id;break}}),this.updateCache(n,a,Ee)),a}async getPurchaseInfo(e,t,n=!0){const i=`${e}_${t}_getPurchaseInfo`,o=this.getCache(i,n);if(o)return o;try{const s=await this._sdk.ClmmSDK.fullClient.getDynamicFieldObject({parentId:e,name:{type:"address",value:t}}),r=Fn.buildPurchaseInfo(Oe(s));return this.updateCache(i,r,go),r}catch{return}}async getLockNFT(e,t=!1){const n=`${e}_getLockNFT`,i=this.getCache(n,t);if(i!==void 0)return i;const o=await this._sdk.ClmmSDK.fullClient.getObject({id:e,options:{showType:!0,showContent:!0,showDisplay:!0,showOwner:!0}});if(!o.error)return oh(o)}async getLockNFTList(e){var o;const{clmm_pool:t}=this._sdk.ClmmSDK.sdkOptions,{ido:n}=this._sdk.sdkOptions,i=[];try{const s=(o=await this._sdk.ClmmSDK.fullClient.getOwnedObjectsByPage(e,{filter:{StructType:`${n.package_id}::lock::LockedNFT<${t.package_id}::position::Position>`},options:{showContent:!0}}))==null?void 0:o.data;for(const r of s){const a=Oe(r);if(a){const c=a.nft.fields,u={locked_at:Number(a.locked_at),lock_duration:Number(a.lock_duration),lock_nft_id:a.id.id,type:a.nft.type,...c};u.end_lock_time=u.locked_at+u.lock_duration,u.coin_type_a=Ct(c.coin_type_a.fields.name).full_address,u.coin_type_b=Ct(c.coin_type_b.fields.name).full_address,u.id=c.id.id,u.tick_lower_index=_i(BigInt(c.tick_lower_index.fields.bits)),u.tick_upper_index=_i(BigInt(c.tick_upper_index.fields.bits)),i.push(u)}}return i}catch(s){return console.log("getLockNFTList:",s),[]}}async creatPool(e){const{ido:t}=this.sdk.sdkOptions;dS(ri(e.coin_type_sale),ri(e.coin_type_raise))&&(e.price_min=N(1).div(e.price_max).toNumber(),e.price_max=N(1).div(e.price_min).toNumber());const i=ai.priceRealToFix(Number(e.price),e.sale_decimals,e.raise_decimals),o=he.priceToSqrtPriceX64(N(e.price_min),e.sale_decimals,e.raise_decimals).toString(),s=he.priceToSqrtPriceX64(N(e.price_max),e.sale_decimals,e.raise_decimals).toString(),r=new _t,a=N(e.total_supply).add(N(e.total_supply).mul(N(e.liquidity_injection_ratio))).toNumber(),c=await this._sdk.ClmmSDK.getOwnerCoinAssets(this._sdk.ClmmSDK.senderAddress,e.coin_type_sale),u=rn.buildCoinForAmount(r,c,BigInt(a),e.coin_type_sale,!1),l=[r.pure(et(t).admin_cap_id),r.pure(et(t).package_version_id),r.pure(et(t).pools_id),r.pure(ri(e.owner)),r.pure(N(i).mul(zs).toString()),r.pure(e.total_supply),r.pure(e.complete_raise_limit),r.pure(e.min_purchase_amount),r.pure(e.max_purchase_amount),r.pure(e.start_time),r.pure(e.purchase_duration),r.pure(e.lock_up_duration),r.pure((e.liquidity_injection_ratio*Am).toString()),r.pure(o),r.pure(s),r.pure(e.tick_spacing.toString()),u.targetCoin,r.pure(e.protection_hard_cap.toString()),r.pure(Ot)],d=[e.coin_type_sale,e.coin_type_raise];return r.moveCall({target:`${t.published_at}::${CS}::create_oversubscribe_pool`,typeArguments:d,arguments:l}),r}async creatPurchasePayload(e){const{ido:t}=this.sdk.sdkOptions,n=new _t,i=await this.getPurchaseInfo(e.purchase_handle,this._sdk.ClmmSDK.senderAddress,!1),o=await this._sdk.ClmmSDK.getOwnerCoinAssets(this._sdk.ClmmSDK.senderAddress,e.coin_type_raise),s=rn.buildCoinForAmount(n,o,BigInt(e.raise_amount),e.coin_type_raise,!1),r=[e.coin_type_sale,e.coin_type_raise];let a,c;return i?(c="purchase",a=[n.object(et(t).package_version_id),n.object(e.pool_address),n.object(i.purchase_certificate_id),n.pure(e.raise_amount.toString()),s.targetCoin,n.pure(Ot)]):(c="create_certificate_and_purchase",a=[n.object(et(t).package_version_id),n.object(e.pool_address),n.pure(e.raise_amount.toString()),s.targetCoin,n.pure(Ot)]),n.moveCall({target:`${t.published_at}::${ki}::${c}`,typeArguments:r,arguments:a}),n}async redeemPayload(e){const{ido:t}=this.sdk.sdkOptions,n=await this.getPurchaseInfo(e.purchase_handle,this._sdk.ClmmSDK.senderAddress,!1);if(n===void 0)throw Error("get purchase certificate fail");const i=new _t,o=[e.coin_type_sale,e.coin_type_raise],s=[i.pure(et(t).package_version_id),i.pure(e.pool_address),i.pure(n.purchase_certificate_id),i.pure(Ot)];return i.moveCall({target:`${t.published_at}::${ki}::redeem`,typeArguments:o,arguments:s}),i}injectLiquidityPayload(e){const{ido:t}=this.sdk.sdkOptions,{clmm_pool:n}=this.sdk.ClmmSDK.sdkOptions,i=new _t,o=[e.coin_type_sale,e.coin_type_raise],s=e.is_reverse?"inject_liquidity_with_reverse_clmm_pool":"inject_liquidity_with_forward_clmm_pool",r=[i.pure(et(t).package_version_id),i.pure(e.pool_address),i.pure(et(n).global_config_id),i.pure(e.clmm_pool_address),i.pure(Ot)];return i.moveCall({target:`${t.published_at}::${ki}::${s}`,typeArguments:o,arguments:r}),i}unPauseInjectLiquidity(e){const{ido:t}=this.sdk.sdkOptions,{integrate:n,clmm_pool:i}=this.sdk.ClmmSDK.sdkOptions,o=new _t;o.moveCall({target:`${n.published_at}::${Zk}::unpause_pool`,typeArguments:[e.coin_type_a,e.coin_type_b],arguments:[o.object(et(i).global_config_id),o.object(e.clmm_pool_address)]});const s=[e.coin_type_sale,e.coin_type_raise],r=e.is_reverse?"inject_liquidity_with_reverse_clmm_pool":"inject_liquidity_with_forward_clmm_pool",a=[o.object(et(t).package_version_id),o.object(e.pool_address),o.object(et(i).global_config_id),o.object(e.clmm_pool_address),o.object(Ot)];return o.moveCall({target:`${t.published_at}::${ki}::${r}`,typeArguments:s,arguments:a}),o}async findClmmPoolForLiquidity(e){let t=null,n=!1;const i=await this.sdk.ClmmSDK.Pool.getPoolImmutables();for(const o of i){if(o.coinTypeA===e.coin_type_sale&&o.coinTypeB===e.coin_type_raise&&Number(o.tickSpacing)===e.tick_spacing){t=await this._sdk.ClmmSDK.Pool.getPool(o.poolAddress);break}if(o.coinTypeA===e.coin_type_raise&&o.coinTypeB===e.coin_type_sale&&Number(o.tickSpacing)===e.tick_spacing){t=await this._sdk.ClmmSDK.Pool.getPool(o.poolAddress),n=!0;break}}return t&&(N(t.current_sqrt_price).lessThanOrEqualTo(e.current_sqrt_price_min)||N(t.current_sqrt_price).greaterThanOrEqualTo(e.current_sqrt_price_max))?(console.log("clmmPool: ",t.poolAddress),{is_reverse:n,clmmPool:null}):{is_reverse:n,clmmPool:t}}withdrawPayload(e){const{ido:t}=this.sdk.sdkOptions,n=new _t,i=[e.coin_type_sale,e.coin_type_raise],o=[n.object(et(t).package_version_id),n.object(e.pool_address),n.object(Ot)];return n.moveCall({target:`${t.published_at}::${ki}::withdraw`,typeArguments:i,arguments:o}),n}updateWhitelistCapPayload(e){const{ido:t}=this.sdk.sdkOptions,n=new _t,i=[e.coin_type_sale,e.coin_type_raise];return e.add_whites&&e.add_whites.addresses.length>0&&n.moveCall({target:`${t.published_at}::${ki}::add_white_listed_addresses`,typeArguments:i,arguments:[n.object(et(t).admin_cap_id),n.object(et(t).package_version_id),n.object(e.pool_address),n.makeMoveVec({type:"address",objects:e.add_whites.addresses.map(o=>n.object(Dn(o)))}),n.pure(e.add_whites.protection_limit),n.object(Ot)]}),e.remove_whites&&e.remove_whites.length>0&&n.moveCall({target:`${t.published_at}::${ki}::remove_white_listed_addresses`,typeArguments:i,arguments:[n.object(et(t).admin_cap_id),n.object(et(t).package_version_id),n.object(e.pool_address),n.makeMoveVec({type:"address",objects:e.remove_whites.map(o=>n.object(Dn(o)))}),n.object(Ot)]}),e.update_whites&&e.update_whites.forEach(o=>{n.moveCall({target:`${t.published_at}::${ki}::update_white_listed_address`,typeArguments:i,arguments:[n.object(et(t).admin_cap_id),n.object(et(t).package_version_id),n.object(e.pool_address),n.object(o.address),n.pure(o.protection_limit),n.object(Ot)]})}),n}creatCancelPoolPayload(e){const{ido:t}=this.sdk.sdkOptions,n=new _t,i=[e.coin_type_sale,e.coin_type_raise],o=[n.pure(et(t).admin_cap_id),n.pure(et(t).package_version_id),n.pure(e.pool_address),n.pure(Ot)];return n.moveCall({target:`${t.published_at}::${ki}::cancel`,typeArguments:i,arguments:o}),n}updatePoolOwnerPayload(e,t){const{ido:n}=this.sdk.sdkOptions;t=t===void 0?new _t:t;const i=[e.coin_type_sale,e.coin_type_raise],o=[t.object(et(n).admin_cap_id),t.object(et(n).package_version_id),t.object(e.pool_address),t.object(e.new_owner),t.object(Ot)];return t.moveCall({target:`${n.published_at}::${ki}::update_pool_owner`,typeArguments:i,arguments:o}),t}updatePoolDuractionPayload(e,t){const{ido:n}=this.sdk.sdkOptions;t=t===void 0?new _t:t;const i=[e.coin_type_sale,e.coin_type_raise],o=[t.object(et(n).admin_cap_id),t.object(et(n).package_version_id),t.object(e.pool_address),t.pure(e.start_time),t.pure(e.purchase_duration),t.pure(e.lock_duration),t.object(Ot)];return t.moveCall({target:`${n.published_at}::${ki}::update_pool_duration`,typeArguments:i,arguments:o}),t}updateProtectionHardCapPayload(e,t){const{ido:n}=this.sdk.sdkOptions;t=t===void 0?new _t:t;const i=[e.coin_type_sale,e.coin_type_raise],o=[t.object(et(n).admin_cap_id),t.object(et(n).package_version_id),t.object(e.pool_address),t.pure(e.protection_hard_cap),t.object(Ot)];return t.moveCall({target:`${n.published_at}::${ki}::update_protection_hard_cap`,typeArguments:i,arguments:o}),t}unlockNftPayload(e){const{ido:t}=this.sdk.sdkOptions,n=new _t,i=[e.nft_type],o=[n.pure(e.lock_nft_id),n.pure(Ot)];return n.moveCall({target:`${t.published_at}::lock::unlock_nft`,typeArguments:i,arguments:o}),n}async isAdminCap(e){const{ido:t}=this._sdk.sdkOptions,n=`${t.package_id}_${e}_isAdminCap`,i=this.getCache(n);if(i)return i;const o=await this._sdk.ClmmSDK.fullClient.getObject({id:et(t).admin_cap_id,options:{showType:!0,showOwner:!0}});console.log(o);const s=xr(o),r=Mc(o);let a=!1;return r&&s&&Ct(s).source_address===`${t.package_id}::config::AdminCap`&&(a=ri(r.AddressOwner)===ri(e)),this.updateCache(n,a,Ee),a}async getWhiteProtectionLimit(e,t,n=!0){const i=`${e}_${t}_getWhiteProtectionLimit`,o=this._sdk.getCache(i,n);if(o)return o;try{const s=await this._sdk.ClmmSDK.fullClient.getDynamicFieldObject({parentId:e,name:{type:"address",value:t}});if(s&&s.data){const r=Oe(s);return this._sdk.updateCache(i,r.value),r.value}return}catch{return}}async getWhiteList(e,t){var i;const n={type:"address",value:t};try{const o=await this._sdk.ClmmSDK.fullClient.getDynamicFieldObject({parentId:e,name:n}),s=Oe(o);if(console.log(s),s)return(i=s==null?void 0:s.value)==null?void 0:i.fields}catch{}return{safe_limit_amount:"0",safe_purchased_amount:"0"}}async getAdminAddress(){const{ido:e}=this._sdk.sdkOptions,t=`${et(e).admin_cap_id}_getAdminAddress`,n=this.getCache(t);if(n)return n;const i=await this._sdk.ClmmSDK.fullClient.getObject({id:et(e).admin_cap_id,options:{showType:!0,showOwner:!0}});console.log(i);const o=xr(i),s=Mc(i);if(s&&o&&Ct(o).source_address===`${e.package_id}::config::AdminCap`){const a=ri(s.AddressOwner);return this.updateCache(t,a,Ee),a}return""}updateCache(e,t,n=Ee){let i=this._cache[e];i?(i.overdueTime=En(n),i.value=t):i=new Wi(t,En(n)),this._cache[e]=i}getCache(e,t=!1){const n=this._cache[e];if(!t&&(n!=null&&n.isValid()))return n.value;delete this._cache[e]}},$S=class{constructor(e){qt(this,"_sdk");qt(this,"_cache",{});this._sdk=e}get sdk(){return this._sdk}async getOwnerVeNFT(e,t=!0){const{xtoken:n}=this.sdk.sdkOptions,i=`${e}_getLockUpManagerEvent`,o=this.getCache(i,t);if(o!==void 0)return o;let s;const r=`${n.package_id}::xtoken::VeNFT`;return(await this._sdk.ClmmSDK.fullClient.getOwnedObjectsByPage(e,{options:{showType:!0,showContent:!0,showDisplay:!0},filter:{StructType:r}})).data.forEach(c=>{const u=Ct(ro(c)).source_address;if(u===r&&c.data&&c.data.content){const{fields:l}=c.data.content;s={...Vu(c),id:l.id.id,index:l.index,type:u,xtoken_balance:l.xtoken_balance},this.updateCache(i,s,Ee)}}),s}async getOwnerLockTokens(e){const{xtoken:t}=this.sdk.sdkOptions,n=[],i=`${t.package_id}::lock_coin::LockedCoin<${this.buileTokenCoinType()}>`,o=await this._sdk.ClmmSDK.fullClient.getOwnedObjectsByPage(e,{options:{showType:!0,showContent:!0},filter:{StructType:i}});for(const s of o.data)if(Ct(ro(s)).source_address===i&&s.data){const a=ts.buildLockToken(s.data.content),c=await this.getLockXToken(a.id);c&&(a.xtoken_amount=c.xtoken_amount),n.push(a)}return n}async getLockToken(e){var n;const t=await this._sdk.ClmmSDK.fullClient.getObject({id:e,options:{showType:!0,showContent:!0}});if((n=t.data)!=null&&n.content){const i=ts.buildLockToken(t.data.content),o=await this.getLockXToken(i.id);return o&&(i.xtoken_amount=o.xtoken_amount),i}}async getOwnerTokenCoins(e){return await this._sdk.ClmmSDK.getOwnerCoinAssets(e,this.buileTokenCoinType())}mintVeNFTPayload(){const{xtoken:e}=this.sdk.sdkOptions,t=new _t;return t.moveCall({target:`${e.published_at}::${Ds}::mint_venft`,typeArguments:[],arguments:[t.pure(et(e).xtoken_manager_id)]}),t}async convertPayload(e){const{xtoken:t}=this.sdk.sdkOptions,n=new _t,i=this.buileTokenCoinType(),o=await rn.syncBuildCoinInputForAmount(this._sdk.ClmmSDK,n,BigInt(e.amount),i);return e.venft_id===void 0?n.moveCall({target:`${t.published_at}::${Ds}::mint_and_convert`,typeArguments:[],arguments:[n.object(et(t).lock_manager_id),n.object(et(t).xtoken_manager_id),o,n.pure(e.amount)]}):n.moveCall({target:`${t.published_at}::${Ds}::convert`,typeArguments:[],arguments:[n.object(et(t).lock_manager_id),n.object(et(t).xtoken_manager_id),o,n.pure(e.amount),n.pure(e.venft_id)]}),n}redeemLockPayload(e){const{xtoken:t}=this.sdk.sdkOptions,n=new _t;return n.moveCall({target:`${t.published_at}::${Ds}::redeem_lock`,typeArguments:[],arguments:[n.pure(et(t).lock_manager_id),n.pure(et(t).xtoken_manager_id),n.pure(e.venft_id),n.pure(e.amount),n.pure(e.lock_day),n.pure(Ot)]}),n}redeemPayload(e){const{xtoken:t}=this.sdk.sdkOptions,n=new _t;return n.moveCall({target:`${t.published_at}::${Ds}::redeem`,typeArguments:[],arguments:[n.pure(et(t).lock_manager_id),n.pure(et(t).xtoken_manager_id),n.pure(e.venft_id),n.pure(e.lock_id),n.pure(Ot)]}),n}redeemDividendPayload(e,t){const{xtoken_dividends:n}=this.sdk.sdkOptions,i=new _t;return t.forEach(o=>{i.moveCall({target:`${n.published_at}::${Cl}::redeem`,typeArguments:[o],arguments:[i.object(et(n).dividend_manager_id),i.object(e)]})}),i}redeemDividendV2Payload(e,t,n){const{xtoken_dividends:i}=this.sdk.sdkOptions;let o=new _t;return t.filter(r=>n.includes(r)).length>0&&(o=this.redeemDividendXTokenPayload(e,o)),t.forEach(r=>{n.includes(r)||o.moveCall({target:`${i.published_at}::${Cl}::redeem_v2`,typeArguments:[r],arguments:[o.object(et(i).dividend_manager_id),o.object(e),o.object(Ot)]})}),o}redeemDividendXTokenPayload(e,t){const{xtoken_dividends:n,xtoken:i}=this.sdk.sdkOptions,{xtoken_manager_id:o,lock_manager_id:s}=et(i),{dividend_manager_id:r}=et(n);return t=t===void 0?new _t:t,t.moveCall({target:`${n.published_at}::${Cl}::redeem_xtoken`,typeArguments:[],arguments:[t.object(s),t.object(o),t.object(r),t.object(e),t.object(Ot)]}),t}buileTokenCoinType(){return`${this.sdk.sdkOptions.token_faucet.package_id}::token::TOKEN`}buileXTokenCoinType(e=this._sdk.sdkOptions.xtoken.package_id,t="xtoken",n="XTOKEN"){return`${e}::${t}::${n}`}cancelRedeemPayload(e){const{xtoken:t}=this.sdk.sdkOptions,n=new _t;return n.moveCall({target:`${t.published_at}::${Ds}::cancel_redeem_lock`,typeArguments:[],arguments:[n.pure(et(t).lock_manager_id),n.pure(et(t).xtoken_manager_id),n.pure(e.venft_id),n.pure(e.lock_id),n.pure(Ot)]}),n}async getInitConfigs(){var r,a;const{package_id:e}=this.sdk.sdkOptions.xtoken,t=`${e}_getInitFactoryEvent`,n=this.getCache(t);if(n!==void 0)return n;const i=(r=await this._sdk.ClmmSDK.fullClient.queryEventsByPage({MoveEventType:`${e}::xtoken::InitEvent`}))==null?void 0:r.data,o={xtoken_manager_id:"",lock_manager_id:"",lock_handle_id:""};i.length>0&&i.forEach(c=>{const u=c.parsedJson;u&&(o.xtoken_manager_id=u.xtoken_manager)});const s=(a=await this._sdk.ClmmSDK.fullClient.queryEventsByPage({MoveEventType:`${e}::locking::InitializeEvent`}))==null?void 0:a.data;return s.length>0&&s.forEach(c=>{const u=c.parsedJson;u&&(o.lock_manager_id=u.lock_manager)}),o.lock_handle_id=(await this.getLockUpManager(o.lock_manager_id)).lock_infos.lock_handle_id,this.updateCache(t,o,Ee),o}async getLockUpManager(e=et(this.sdk.sdkOptions.xtoken).lock_manager_id,t=!1){const n=`${e}_getLockUpManagerEvent`,i=this.getCache(n,t);if(i!==void 0)return i;const o=await this.sdk.ClmmSDK.fullClient.getObject({id:e,options:{showContent:!0}}),s=ts.buildLockUpManager(Oe(o));return this.updateCache(n,s,Ee),s}async getLockInfoHandle(e){const t=`${e}_getLockInfoHandle`,n=this.getCache(t);if(n!==void 0)return n;let i="";const o=await this.sdk.ClmmSDK.fullClient.getObject({id:e,options:{showContent:!0}}),s=Oe(o);return s&&(i=s.lock_infos.fields.id.id,this.updateCache(t,i,Ee)),i}async getDividendConfigs(){var s;const{package_id:e}=this.sdk.sdkOptions.xtoken_dividends,t=`${e}_getDividendManagerEvent`,n=this.getCache(t);if(n!==void 0)return n;const i=(s=await this._sdk.ClmmSDK.fullClient.queryEventsByPage({MoveEventType:`${e}::dividend::InitEvent`}))==null?void 0:s.data,o={dividend_manager_id:"",dividend_admin_id:"",dividend_settle_id:""};return i.length>0&&i.forEach(r=>{const a=r.parsedJson;a&&(o.dividend_manager_id=a.manager_id,o.dividend_admin_id=a.admin_id,o.dividend_settle_id=a.settle_id,this.updateCache(t,o,Ee))}),o}async getDividendManager(e=!1){const{dividend_manager_id:t}=et(this.sdk.sdkOptions.xtoken_dividends),n=`${t}_getDividendManager`,i=this.getCache(n,e);if(i!==void 0)return i;const o=await this._sdk.ClmmSDK.fullClient.getObject({id:t,options:{showContent:!0}}),s=Oe(o),r=ts.buildDividendManager(s);return this.updateCache(n,r,Ee),r}async getXcetusManager(e=!0){const{xtoken_manager_id:t}=et(this.sdk.sdkOptions.xtoken),n=`${t}_getXcetusManager`,i=this.getCache(n,e);if(i)return i;const o=await this._sdk.ClmmSDK.fullClient.getObject({id:t,options:{showContent:!0}}),s=Oe(o),r={id:s.id.id,index:Number(s.index),has_venft:{handle:s.has_venft.fields.id.id,size:s.has_venft.fields.size},nfts:{handle:s.nfts.fields.id.id,size:s.nfts.fields.size},total_locked:s.total_locked,treasury:s.treasury.fields.total_supply.fields.value};return this.updateCache(n,r),r}async getVeNFTDividendInfo(e,t){try{const n=await this._sdk.ClmmSDK.fullClient.getDynamicFieldObject({parentId:e,name:{type:"0x2::object::ID",value:t}}),i=Oe(n);return ts.buildVeNFTDividendInfo(i)}catch{return}}async redeemNum(e,t){if(BigInt(e)===BigInt(0))return{amountOut:"0",percent:"0"};const n=await this.getLockUpManager(),i=N($i).mul(N(n.max_lock_day).sub(N(t))).mul(N(n.max_percent_numerator).sub(N(n.min_percent_numerator))).div(N(n.max_lock_day).sub(N(n.min_lock_day))),o=N($i).mul(N(n.max_percent_numerator)).sub(i).div(N(Dc)).div($i);return{amountOut:N(o).mul(N(e)).round().toString(),percent:o.toString()}}async reverseRedeemNum(e,t){if(BigInt(e)===BigInt(0))return{amountOut:"0",percent:"0"};const n=await this.getLockUpManager(),i=N($i).mul(N(n.max_lock_day).sub(N(t))).mul(N(n.max_percent_numerator).sub(N(n.min_percent_numerator))).div(N(n.max_lock_day).sub(N(n.min_lock_day))),o=N($i).mul(N(n.max_percent_numerator)).sub(i).div(N(Dc)).div($i);return{amountOut:N(e).div(o).toFixed(0,it.ROUND_UP),percent:o.toString()}}async getLockXToken(e){const{lock_handle_id:t}=et(this._sdk.sdkOptions.xtoken),n=`${e}_getXTokenAmount`,i=this.getCache(n);if(i)return i;try{const o=await this.sdk.ClmmSDK.fullClient.getDynamicFieldObject({parentId:t,name:{type:"0x2::object::ID",value:e}}),s=Oe(o);if(s){const r=s.value.fields.value.fields;return this.updateCache(n,r,Ee),r}}catch{}}async getVeNftAmount(e,t){try{const n=await this.sdk.ClmmSDK.fullClient.getDynamicFieldObject({parentId:e,name:{type:"0x2::object::ID",value:t}}),i=Oe(n);if(i){const{lock_amount:o,xtoken_amount:s}=i.value.fields.value.fields;return{lock_amount:o,xtoken_amount:s}}}catch{}return{lock_amount:"0",xtoken_amount:"0"}}async getPhaseDividendInfo(e,t=!1){const i=(await this.getDividendManager()).dividends.id,o=`${i}_${e}_getPhaseDividendInfo`,s=this._sdk.getCache(o,t);if(s)return s;try{const r=await this._sdk.ClmmSDK.fullClient.getDynamicFieldObject({parentId:i,name:{type:"u64",value:e}}),a=Oe(r),c=a.value.fields.value.fields,u=c.redeemed_num.fields.contents.map(g=>({name:g.fields.key.fields.name,value:g.fields.value})),l=c.bonus_types.map(g=>g.fields.name),d=c.bonus.fields.contents.map(g=>({name:g.fields.key.fields.name,value:g.fields.value})),h={id:da(r),phase:a.name,settled_num:c.settled_num,register_time:c.register_time,redeemed_num:u,is_settled:c.is_settled,bonus_types:l,bonus:d,phase_end_time:""};return this.updateCache(o,h),h}catch{}}updateCache(e,t,n=go){let i=this._cache[e];i?(i.overdueTime=En(n),i.value=t):i=new Wi(t,En(n)),this._cache[e]=i}getCache(e,t=!1){const n=this._cache[e];if(!t&&(n!=null&&n.isValid()))return n.value;delete this._cache[e]}},US=class{constructor(e){qt(this,"_sdk");qt(this,"_cache",{});this._sdk=e}get sdk(){return this._sdk}async addMasterLiquidity(e){var v,x;const{liquidity_stratefy:t}=this._sdk.sdkOptions,{clmm_pool:n}=this._sdk.ClmmSDK.sdkOptions,i=await this._sdk.ClmmSDK.getOwnerCoinAssets(this._sdk.ClmmSDK.senderAddress);let o=N(0),s=N(0);const r=[],a=[],c=[],u=[],l=[];e.liquidity_bins.forEach((P,E)=>{const S=e.amounts_a[E],T=e.amounts_b[E],R=e.bins_fix_amount_a[E];o=o.add(S),s=s.add(T),r.push(S),a.push(T),c.push(Ho(BigInt(P.tick_lower)).toString()),u.push(Ho(BigInt(P.tick_upper)).toString()),l.push(R)});const d=[e.coinTypeA,e.coinTypeB],h=new _t,g=(v=rn.buildAddLiquidityFixTokenCoinInput(h,!e.fix_amount_a,o.toString(),e.slippage,e.coinTypeA,i,!1))==null?void 0:v.targetCoin,b=(x=rn.buildAddLiquidityFixTokenCoinInput(h,e.fix_amount_a,s.toString(),e.slippage,e.coinTypeB,i,!1))==null?void 0:x.targetCoin;return BS(e)?h.moveCall({target:`${t.published_at}::router::increase_liquidity`,typeArguments:d,arguments:[h.object(et(t).master_manger_id),h.object(e.master_address),h.object(et(n).global_config_id),h.object(e.pool_address),g,b,h.pure(r.map(P=>h.pure(P,"u64"))),h.pure(a.map(P=>h.pure(P,"u64"))),h.pure(l.map(P=>h.pure(P,"bool"))),h.object(Ot)]}):h.moveCall({target:`${t.published_at}::router::create_master_liquidity`,typeArguments:d,arguments:[h.object(et(t).master_manger_id),h.object(et(n).global_config_id),h.object(e.pool_address),g,b,h.pure(c.map(P=>h.pure(P,"u32"))),h.pure(u.map(P=>h.pure(P,"u32"))),h.pure(r.map(P=>h.pure(P,"u64"))),h.pure(a.map(P=>h.pure(P,"u64"))),h.pure(l.map(P=>h.pure(P,"bool"))),h.pure(e.strategy),h.pure(Ho(BigInt(e.tick_lower)).toString()),h.pure(Ho(BigInt(e.tick_upper)).toString()),h.object(Ot)]}),h}buildMasterNFTType(){return`${this._sdk.sdkOptions.liquidity_stratefy.package_id}::master_liquidity::MasterLiquidity`}async getMasterNFTList(e,t=[]){const n=[],i=await this._sdk.ClmmSDK.fullClient.getOwnedObjectsByPage(e,{options:{showType:!0,showContent:!0,showDisplay:!0,showOwner:!0},filter:{Package:this._sdk.sdkOptions.liquidity_stratefy.package_id}}),o=t.length>0;for(const s of i.data)if(Ct(s.data.type).full_address===this.buildMasterNFTType()){const a=co.buildMasterNFT(s);if(a){const c=`${a.id}_masterNFT`;this.updateCache(c,a,Ee),o?t.includes(a.pool_id)&&n.push(a):n.push(a)}}return n}async getMasterNFT(e,t=!1){const n="$masterId}_masterNFT",i=this.getCache(n,t);if(i)return i;try{const o=await this._sdk.ClmmSDK.fullClient.getObject({id:e,options:{showType:!0,showContent:!0,showDisplay:!0,showOwner:!0}});if(Ct(o.data.type).full_address===this.buildMasterNFTType()){const r=co.buildMasterNFT(o);return r&&this.updateCache(n,r,Ee),r}}catch(o){console.log(o)}}async fetchMasterPositionInfos(e){var a;const t={},{clmm_pool:n,integrate:i,simulationAccount:o}=this.sdk.ClmmSDK.sdkOptions,s=new _t;return e.forEach(c=>{c.position_ids.forEach(u=>{const l=[c.coinTypeA,c.coinTypeB],d=[s.object(et(n).global_config_id),s.object(c.pool_id),s.object(u)];s.moveCall({target:`${i.published_at}::${Qr}::fetch_position_fees`,arguments:d,typeArguments:l}),s.moveCall({target:`${i.published_at}::${Qr}::fetch_position_rewards`,arguments:[...d,s.object(Ot)],typeArguments:l})})}),(a=(await this.sdk.ClmmSDK.fullClient.devInspectTransactionBlock({transactionBlock:s,sender:o.address})).events)==null||a.forEach(c=>{const{parsedJson:u}=c,{position_id:l}=u;let d=t[l];switch(d===void 0&&(d={position_id:l,feeOwedA:"0",feeOwedB:"0",rewarders:[]},t[l]=d),Ct(c.type).name){case"FetchPositionFeesEvent":d.feeOwedA=u.fee_owned_a,d.feeOwedB=u.fee_owned_b;break;case"FetchPositionRewardsEvent":d.rewarders=u.data;break}}),t}async getLiquidityStrategyConfigs(e=!1){const{package_id:t}=this._sdk.sdkOptions.liquidity_stratefy,n=`${t}_getLiquidityStrategyConfigst`,i=this.getCache(n,e);if(i!==void 0)return i;const o=(await this._sdk.ClmmSDK.fullClient.queryEventsByPage({MoveEventType:`${t}::master_liquidity::MasterLiquidityManagerCreatedEvent`})).data,s={master_manger_id:"",master_liquidity_handle:""};if(o.length>0){for(const r of o){const a=r.parsedJson;s.master_manger_id=a.id;const c=await this._sdk.ClmmSDK.fullClient.getObject({id:a.id,options:{showContent:!0}}),u=Oe(c);s.master_liquidity_handle=u.position_maps.fields.id.id;break}this.updateCache(n,s,Ee)}return s}removeMasterLiquidity(e){const{clmm_pool:t}=this.sdk.ClmmSDK.sdkOptions,{liquidity_stratefy:n}=this.sdk.sdkOptions,i=new _t,o=[e.coinTypeA,e.coinTypeB];this.collectReward({coinTypeA:e.coinTypeA,coinTypeB:e.coinTypeB,collect_fee:!1,rewarder_coin_types:e.rewarder_coin_types,master_address:e.master_address,pool_address:e.pool_address},i);const s=[i.object(et(n).master_manger_id),i.object(e.pool_address),i.object(e.master_address),i.object(et(t).global_config_id),i.pure(e.delta_liquidities.map(r=>i.pure(r,"u128"))),i.pure(e.min_amounts_a.map(r=>i.pure(r,"u64"))),i.pure(e.min_amounts_b.map(r=>i.pure(r,"u64"))),i.object(Ot)];return i.moveCall({target:`${n.published_at}::${Ya}::remove_liquidity`,typeArguments:o,arguments:s}),i}closeMasterLiquidity(e){const{clmm_pool:t}=this.sdk.ClmmSDK.sdkOptions,{liquidity_stratefy:n}=this.sdk.sdkOptions,i=new _t,o=[e.coinTypeA,e.coinTypeB];return this.collectReward({coinTypeA:e.coinTypeA,coinTypeB:e.coinTypeB,collect_fee:!1,rewarder_coin_types:e.rewarder_coin_types,master_address:e.master_address,pool_address:e.pool_address},i),i.moveCall({target:`${n.published_at}::${Ya}::close_master_liquidity`,typeArguments:o,arguments:[i.object(et(n).master_manger_id),i.object(e.master_address),i.object(et(t).global_config_id),i.object(e.pool_address),i.pure(e.min_amounts_a.map(s=>i.pure(s,"u64"))),i.pure(e.min_amounts_b.map(s=>i.pure(s,"u64"))),i.object(Ot)]}),i}collectFee(e,t){const{clmm_pool:n}=this.sdk.ClmmSDK.sdkOptions,{liquidity_stratefy:i}=this.sdk.sdkOptions;t=t===void 0?new _t:t;const o=[e.coinTypeA,e.coinTypeB],s=[t.object(et(i).master_manger_id),t.object(e.master_address),t.object(et(n).global_config_id),t.object(e.pool_address)];return t.moveCall({target:`${i.published_at}::${Ya}::collect_fee`,typeArguments:o,arguments:s}),t}collectReward(e,t){const{clmm_pool:n}=this.sdk.ClmmSDK.sdkOptions,{liquidity_stratefy:i}=this.sdk.sdkOptions;return t=t===void 0?new _t:t,e.collect_fee&&this.collectFee({...e},t),e.rewarder_coin_types.forEach(o=>{const s=[e.coinTypeA,e.coinTypeB,o];if(t){const r=[t.object(et(i).master_manger_id),t.object(e.master_address),t.object(et(n).global_config_id),t.object(e.pool_address),t.object(et(n).global_vault_id),t.object(Ot)];t.moveCall({target:`${i.published_at}::${Ya}::collect_reward`,typeArguments:s,arguments:r})}}),t}updateCache(e,t,n=go){let i=this._cache[e];i?(i.overdueTime=En(n),i.value=t):i=new Wi(t,En(n)),this._cache[e]=i}getCache(e,t=!1){const n=this._cache[e],i=n==null?void 0:n.isValid();if(!t&&i)return n.value;i||delete this._cache[e]}},qS=class{constructor(e){qt(this,"_sdk");qt(this,"_cache",{});this._sdk=e}get sdk(){return this._sdk}buildCoinInput(e,t,n,i,o){const{selectedCoins:s,remainingCoins:r}=Qe.selectCoinAssetGreaterThanOrEqual(t,BigInt(i)),a=Qe.calculateTotalBalance(s);if(a<BigInt(i))throw new Error(`The amount(${a}) is Insufficient balance for ${n} , expect ${i} `);const c=a-BigInt(i);let u;if(Qe.isSuiCoin(n))u=e.splitCoins(e.gas,[e.pure(i)]);else{const[l,...d]=s.map(h=>h.coinObjectId);u=e.object(l),d.length>0?o?e.mergeCoins(u,[...d.map(h=>e.object(h)),o]):e.mergeCoins(u,[...d.map(h=>e.object(h))]):o&&e.mergeCoins(u,[o])}return{selectedUnusedAmount:c,coinInput:u,remainingCoins:r}}async deposit(e){var d,h;console.log("1110 deposit : ",{params:e});const{vaults:t,frams:n}=this._sdk.sdkOptions,{clmm_pool:i}=this._sdk.ClmmSDK.sdkOptions,o=await this._sdk.ClmmSDK.getOwnerCoinAssets(this._sdk.getVerifySenderAddress()),s=new _t;let r,a;if(e.swapParams){const g=await this.handleDepositSwap(e,s,o);r=g.primaryCoinAInputs,a=g.primaryCoinBInputs}else r=(d=rn.buildAddLiquidityFixTokenCoinInput(s,!e.fix_amount_a,e.amount_a,e.slippage,e.coinTypeA,o,!1))==null?void 0:d.targetCoin,a=(h=rn.buildAddLiquidityFixTokenCoinInput(s,e.fix_amount_a,e.amount_b,e.slippage,e.coinTypeB,o,!1))==null?void 0:h.targetCoin;const c=et(t),u=et(n),l=et(i);return s.moveCall({target:`${t.published_at}::${ES}::deposit`,typeArguments:[e.coinTypeA,e.coinTypeB,e.lp_token_type],arguments:[s.object(c.vaults_manager_id),s.object(e.vault_id),s.object(u.rewarder_manager_id),s.object(u.global_config_id),s.object(e.farming_pool),s.object(l.global_config_id),s.object(e.clmm_pool),r,a,s.pure(e.amount_a),s.pure(e.amount_b),s.pure(e.fix_amount_a),s.object(Ot)]}),s}async handleDepositSwap(e,t,n){const{clmm_pool:i,integrate:o}=this._sdk.ClmmSDK.sdkOptions,{swap_amount:s,a2b:r,route_obj:a,staking_id:c}=e.swapParams,u=r?e.coinTypeA:e.coinTypeB,l=rn.buildCoinForAmount(t,n,BigInt(s),u,!1),d=BigInt(l.tragetCoinAmount)-BigInt(s);let h=[];if(c){const P=this.requestStakeCoin(c,t,l.targetCoin),E=rn.buildCoinForAmount(t,l.remainCoins,BigInt(0),u,!1).targetCoin;h=r?[E,P]:[P,E]}else if(a){const P=rn.buildCoinForAmount(t,n,0n,r?e.coinTypeB:e.coinTypeA,!1),E=await rn.buildAggregatorSwapReturnCoins(this._sdk.ClmmSDK,a,l,P,"",e.slippage,t);h=r?[E.fromCoin,E.toCoin]:[E.toCoin,E.fromCoin],console.log("swapCoinInputTo.isMintZeroCoin: ",P),!P.isMintZeroCoin&&P.originalSplitedCoin===void 0&&t.transferObjects([P.targetCoin],t.pure(this._sdk.getVerifySenderAddress()))}else{const P=rn.buildCoinForAmount(t,n,0n,r?e.coinTypeB:e.coinTypeA,!1),E=Fo.getDefaultSqrtPriceLimit(r).toString();h=t.moveCall({target:`${o.published_at}::${Js}::swap`,typeArguments:[e.coinTypeA,e.coinTypeB],arguments:[t.object(et(i).global_config_id),t.object(e.clmm_pool),r?l.targetCoin:P.targetCoin,r?P.targetCoin:l.targetCoin,t.pure(r),t.pure(!0),t.pure(s),t.pure(E),t.pure(!1),t.object(Ot)]})}let g,b;const v=h[0],x=h[1];if(r){const P=BigInt(e.amount_a)-d;Qe.isSuiCoin(u)?(t.transferObjects([v],t.pure(this._sdk.getVerifySenderAddress())),g=t.splitCoins(t.gas,[t.pure(e.amount_a)])):P>0n?g=this.buildCoinInput(t,l.remainCoins,u,P,v).coinInput:g=v,b=x}else{g=v;const P=BigInt(e.amount_b)-d;Qe.isSuiCoin(u)?(t.transferObjects([x],t.pure(this._sdk.getVerifySenderAddress())),b=t.splitCoins(t.gas,[t.pure(e.amount_b)])):P>0n?b=this.buildCoinInput(t,l.remainCoins,u,P,x).coinInput:b=x}return{primaryCoinAInputs:g,primaryCoinBInputs:b}}async remove(e){console.log({params:e});const{vaults:t,frams:n}=this.sdk.sdkOptions,{clmm_pool:i,integrate:o}=this._sdk.ClmmSDK.sdkOptions,s=new _t,r=await this._sdk.ClmmSDK.getOwnerCoinAssets(this._sdk.getVerifySenderAddress(),e.lp_token_type),a=rn.buildCoinForAmount(s,r,BigInt(e.lp_token_amount),e.lp_token_type,!1).targetCoin,c=et(t),u=et(n),l=et(i),d=[e.coinTypeA,e.coinTypeB,e.lp_token_type],h=s.moveCall({target:`${t.published_at}::${IS}::remove`,typeArguments:d,arguments:[s.object(c.vaults_manager_id),s.object(e.vault_id),s.object(u.rewarder_manager_id),s.object(u.global_config_id),s.object(e.farming_pool),s.object(l.global_config_id),s.object(e.clmm_pool),a,s.pure(e.lp_token_amount),s.pure(e.min_amount_a),s.pure(e.min_amount_b),s.object(Ot)]}),g=h[0],b=h[1];if(e.swapParams){const{a2b:v,swap_amount:x,route_obj:P}=e.swapParams;if(P){const E={targetCoin:v?g:b,remainCoins:[],isMintZeroCoin:!1,tragetCoinAmount:""},S={targetCoin:v?b:g,remainCoins:[],isMintZeroCoin:!1,tragetCoinAmount:""},T=await rn.buildAggregatorSwapReturnCoins(this._sdk.ClmmSDK,P,E,S,"",e.slippage,s),R=v?[T.fromCoin,T.toCoin]:[T.toCoin,T.fromCoin];v?s.mergeCoins(R[1],[b]):s.mergeCoins(R[0],[g]),s.transferObjects([...R],s.pure(this._sdk.getVerifySenderAddress()))}else{const E=Fo.getDefaultSqrtPriceLimit(v).toString(),S=s.moveCall({target:`${o.published_at}::${Js}::swap`,typeArguments:[e.coinTypeA,e.coinTypeB],arguments:[s.object(et(i).global_config_id),s.object(e.clmm_pool),g,b,s.pure(v),s.pure(!0),s.pure(x),s.pure(E),s.pure(!0),s.object(Ot)]});s.transferObjects([S[0],S[1]],s.pure(this._sdk.getVerifySenderAddress()))}}else s.transferObjects([g,b],s.pure(this._sdk.getVerifySenderAddress()));return s}async getVaultList(e="all"){const{vaults:t}=this._sdk.sdkOptions,n=await this._sdk.ClmmSDK.fullClient.queryEventsByPage({MoveEventType:`${t.package_id}::vaults::CreateEvent`},e),i=n.data.map(r=>r.parsedJson.id),o=await this._sdk.ClmmSDK.fullClient.batchGetObjects(i,{showType:!0,showContent:!0,showDisplay:!0,showOwner:!0}),s=[];return o.forEach(r=>{const a=Zi.buildPool(r);a&&(a.staking_id=this.findHaedalStakeId(a.position.coinTypeA,a.position.coinTypeB),this.savePoolToCache(a),s.push(a))}),n.data=s,n}findHaedalStakeId(e,t){var s;const{haedal:n}=this._sdk.sdkOptions,{support_stakings:i}=et(n);return i.length===0?void 0:((s=i.filter(r=>{const a=Ct(r.from_coin_type).full_address,c=Ct(r.to_coin_type).full_address,u=Ct(e).full_address,l=Ct(t).full_address;return u===a&&l===c||u===c&&l===a})[0])==null?void 0:s.staking_id)||void 0}savePoolToCache(e){const t=`${e.id}_mirrorPool`;this.updateCache(t,e,Ee)}readPoolFromCache(e,t=!1){const n=`${e}_mirrorPool`;return this.getCache(n,t)}async calculateMaxAvailable(e){var v;const{integrate:t,simulationAccount:n}=this.sdk.ClmmSDK.sdkOptions,i=new _t,o=he.tickIndexToSqrtPriceX64(e.lowerTick),s=he.tickIndexToSqrtPriceX64(e.upperTick),r=new _(e.curSqrtPrice),a=Hn.getCoinAmountFromLiquidity(new _(e.input_amount),r,o,s,!1),c=[e.coinTypeA,e.coinTypeB];i.moveCall({target:`${t.published_at}::${Qr}::calculate_swap_result`,arguments:[i.object(e.clmm_pool),i.pure(!0),i.pure(!0),i.pure(a.coinA.toString())],typeArguments:c}),i.moveCall({target:`${t.published_at}::${Qr}::calculate_swap_result`,arguments:[i.object(e.clmm_pool),i.pure(!1),i.pure(!0),i.pure(a.coinB.toString())],typeArguments:c});const l=(v=(await this.sdk.ClmmSDK.fullClient.devInspectTransactionBlock({transactionBlock:i,sender:n.address})).events)==null?void 0:v.filter(x=>Ct(x.type).name==="CalculatedSwapResultEvent");if(l.length===0)return null;const d=l[0].parsedJson.data,h=l[1].parsedJson.data,g=N(a.coinB.toString()).add(d.amount_out),b=N(a.coinA.toString()).add(h.amount_out);return{maxAmountB:g,maxAmountA:b}}async calculateRemoveSwapAmount(e,t){const n=Zi.calculateDepositRatio(e.lowerTick,e.upperTick,new _(e.curSqrtPrice)),i=e.fix_amount_a?n.ratioA:n.ratioB;console.log({fixRatio:i});let o=N(e.receive_amount).mul(i),s,r;if(e.removeLiquidity){const v=he.tickIndexToSqrtPriceX64(e.lowerTick),x=he.tickIndexToSqrtPriceX64(e.upperTick),P=Hn.getCoinAmountFromLiquidity(new _(e.removeLiquidity),new _(e.curSqrtPrice),v,x,!1);r=e.removeLiquidity,s=e.fix_amount_a?P.coinB.toString():P.coinA.toString(),o=e.fix_amount_a?N(P.coinA.toString()):N(P.coinB.toString())}else{const v=Hn.estLiquidityAndcoinAmountFromOneAmounts(e.lowerTick,e.upperTick,new _(o.toFixed(0)),e.fix_amount_a,!1,.2,new _(e.curSqrtPrice));r=v.liquidityAmount.toString(),s=e.fix_amount_a?v.coinAmountB.toString():v.coinAmountA.toString()}console.log({fixAmount:o,otherSideAmount:s});const a=!e.fix_amount_a,c=await this.clmmPreSwap(e.clmm_pool,e.curSqrtPrice,a,N(s),e.coinTypeA,e.coinTypeB,!0,e.priceSplitPoint,e.use_route,[{pool_id:e.clmm_pool,tick_lower:e.lowerTick,tick_upper:e.upperTick,delta_liquidity:Number(r),is_increase:!1}]);console.log({data:c,range:t});const u=o.add(c.amount_out),l=N(e.receive_amount),d=l.sub(u);if(console.log(`: ${u.toString()} , : ${e.receive_amount}, : ${d.toString()} `),(!e.removeLiquidity||e.removeLiquidity&&t)&&d.abs().greaterThan(l.mul(.01))){const v=u.lessThan(l);let x,P;t?v?(x=N(r),P=t.right):(x=t.left,P=N(r)):(x=N(v?r:0),P=N(v?e.maxLiquidity:r));const E=N(x).add(P).div(2).toFixed(0);if(console.log({left:x.toString(),right:P.toString(),midLiquidity:E.toString()}),!t||t&&t.count<15&&x<P)return await this.calculateRemoveSwapAmount({...e,removeLiquidity:E},{left:x,right:P,count:t?t.count+1:0})}const h=c.amount_in&&c.fee_amount?new _(c.amount_in).add(new _(c.fee_amount)).toString():c.amount_in,g=c.amount_out,{is_exceed:b}=c;return{swapInAmount:h,swapOutAmount:g,liquidity:r,is_exceed:b,routeObj:c.route_obj,request_id:e.request_id}}async calculateHaedalDepositFixSui(e){const t=e.inputSuiAmount.mul(e.remainRate),n=e.inputSuiAmount.sub(e.swapSuiAmount),i=e.exchangeRate?e.exchangeRate:await this.getExchangeRateForHaedal(e.staking_id,e.shouldRequestStake,Number(e.swapSuiAmount.toFixed(0))),o=e.swapSuiAmount.div(i).toFixed(0);console.log({swapAmount:e.swapSuiAmount.toString(),hasuiAmount:o.toString(),leftSuiAmount:e.leftSuiAmount.toString(),rightSuiAmount:e.rightSuiAmount.toString(),exchangeRate:i});const s=Hn.estLiquidityAndcoinAmountFromOneAmounts(e.lowerTick,e.upperTick,new _(o.toString()),!e.fixCoinA,!0,0,new _(e.curSqrtPrice)),r=e.fixCoinA?s.coinAmountA.toString():s.coinAmountB.toString(),a=N(n).sub(r);return console.log({useSuiAmount:r.toString(),hasuiAmount:o.toString(),remainSui:n.toString(),remainSuiLimit:t.toString(),actRemainSui:a.toString(),rebalanceCount:e.rebalanceCount}),a.greaterThanOrEqualTo(0)&&a.lessThanOrEqualTo(t)||e.rebalanceCount>12||e.leftSuiAmount.greaterThanOrEqualTo(e.rightSuiAmount)?{swapInAmount:e.swapSuiAmount.toFixed(0),swapOutAmount:o,afterSqrtPrice:e.curSqrtPrice,fixAmountA:!e.fixCoinA,is_exceed:!0,request_id:"",staking_id:e.staking_id}:a.lessThan(0)?await this.calculateHaedalDepositFixSui({...e,rightSuiAmount:e.swapSuiAmount,swapSuiAmount:e.swapSuiAmount.add(e.leftSuiAmount).div(2),exchangeRate:i,rebalanceCount:e.rebalanceCount+1}):a.greaterThan(t)?await this.calculateHaedalDepositFixSui({...e,leftSuiAmount:e.swapSuiAmount,swapSuiAmount:e.swapSuiAmount.add(e.rightSuiAmount).div(2),exchangeRate:i,rebalanceCount:e.rebalanceCount+1}):null}async calculateDepositSwapAmount(e,t=!1){const n=he.sqrtPriceX64ToTickIndex(new _(e.curSqrtPrice)),{ratioA:i,ratioB:o}=Zi.calculateDepositRatio(e.lowerTick,e.upperTick,new _(e.curSqrtPrice));console.log("1110 calculateDepositSwapAmount params: ",{...e,currentTick:n,adjustBestAmount:t});const s=N(e.input_amount).mul(e.fix_amount_a?i:o);let r=N(e.input_amount).sub(s);console.log("1110 ",{fixAmount:s.toString(),swapAmount:r.toString()});const a=e.fix_amount_a;if(r.toFixed(0)==="0")return null;if(e.staking_id){if(Qe.isSuiCoin(e.coinTypeA)&&e.fix_amount_a||Qe.isSuiCoin(e.coinTypeB)&&!e.fix_amount_a){const K=await this.calculateHaedalDepositFixSui({inputSuiAmount:N(e.input_amount),swapSuiAmount:r,lowerTick:e.lowerTick,upperTick:e.upperTick,curSqrtPrice:e.curSqrtPrice,remainRate:e.remainRate?e.remainRate:.01,fixCoinA:e.fix_amount_a,rebalanceCount:0,shouldRequestStake:e.shouldRequestStake,leftSuiAmount:a?new it(r.toFixed(0)):new it(0),rightSuiAmount:a?new it(e.input_amount):new it(r.toFixed(0)),staking_id:e.staking_id});return K?{...K,request_id:e.request_id}:null}throw Error("Only support fix sui")}const c=n<e.lowerTick||n>e.upperTick,u={clmm_pool:e.clmm_pool,curSqrtPrice:e.curSqrtPrice,a2b:a,amount_a:a?new it(e.input_amount):new it(0),amount_b:a?new it(0):new it(e.input_amount),amount_left:a?new it(r.toFixed(0)):new it(0),amount_right:a?new it(e.input_amount):new it(r.toFixed(0)),lowerTick:e.lowerTick,upperTick:e.upperTick,tick_spacing:2,coinTypeA:e.coinTypeA,coinTypeB:e.coinTypeB,useRoute:e.use_route,remainRate:e.remainRate?e.remainRate:.01,priceSplitPoint:e.priceSplitPoint},l=t&&n<=e.upperTick;let d=l?await this.calculateRebalance(u):await this.clmmPreSwap(e.clmm_pool,e.curSqrtPrice,a,r,e.coinTypeA,e.coinTypeB,!0,e.priceSplitPoint,e.use_route),h=d.after_sqrt_price;const g=he.sqrtPriceX64ToTickIndex(new _(h));console.log("1110  : ",{...d,currentTick:g},null,2);const b=g<e.lowerTick||g>e.upperTick;if(c!==b&&!l&&g<=e.upperTick){console.log("1110 , swap: ");const{ratioA:K,ratioB:V}=Zi.calculateDepositRatio(e.lowerTick,e.upperTick,new _(h));console.log("1110 ",{newAfterRatioA:K,newAfterRatioB:V}),r=N(e.input_amount).sub(N(e.input_amount).mul(e.fix_amount_a?K:V)),u.amount_left=a?new it(r.toFixed(0)):new it(0),u.amount_right=a?new it(e.input_amount):new it(r.toFixed(0)),d=await this.calculateRebalance(u),h=d.after_sqrt_price;const W=he.sqrtPriceX64ToTickIndex(new _(h));console.log("1110 : ",{lowerTick:e.lowerTick,upperTick:e.upperTick,currentTick:W,afterSqrtPrice:h})}const{ratioA:v,ratioB:x}=Zi.calculateDepositRatio(e.lowerTick,e.upperTick,new _(h));console.log("1110 1",{afterRatioA:v,afterRatioB:x,data:d});let P=x.div(v).sub(o.div(i)).greaterThan("0");const E=d.amount_in&&d.fee_amount?new _(d.amount_in).add(new _(d.fee_amount)).toString():d.amount_in,S=d.amount_out,{is_exceed:T}=d;if(g<e.lowerTick)P=!0;else if(g>e.upperTick)P=!1;else{const K=P===a?new _(N(e.input_amount).sub(E).toString()):new _(S),V=Hn.estLiquidityAndcoinAmountFromOneAmounts(e.lowerTick,e.upperTick,K,P,!0,0,new _(h)),W=V.coinAmountA,tt=V.coinAmountB,j=N(e.fix_amount_a?W.toString():tt.toString()).add(E);console.log("1110 :",{preAmountTotal:j.toString(),fixAmountA:P}),j.greaterThanOrEqualTo(e.input_amount)&&(P=!P)}const R={swapInAmount:E,swapOutAmount:S,afterSqrtPrice:h,is_exceed:T,fixAmountA:P,routeObj:d.route_obj,request_id:e.request_id,use_Haedal_stake:!1};return console.log(R),R}async calculateHaedalDepositSwapAmount(e){const t=he.sqrtPriceX64ToTickIndex(new _(e.curSqrtPrice)),{ratioA:n,ratioB:i}=Zi.calculateDepositRatio(e.lowerTick,e.upperTick,new _(e.curSqrtPrice));console.log("1110 calculateDepositSwapAmount params: ",{...e,currentTick:t});const o=N(e.input_amount).mul(e.fix_amount_a?n:i),s=N(e.input_amount).sub(o);console.log("1110 ",{fixAmount:o.toString(),swapAmount:s.toString()});const r=e.fix_amount_a;if(s.toFixed(0)==="0")return null;if(e.staking_id){if(Qe.isSuiCoin(e.coinTypeA)&&e.fix_amount_a||Qe.isSuiCoin(e.coinTypeB)&&!e.fix_amount_a){const a=await this.calculateHaedalDepositFixSui({inputSuiAmount:N(e.input_amount),swapSuiAmount:s,lowerTick:e.lowerTick,upperTick:e.upperTick,curSqrtPrice:e.curSqrtPrice,remainRate:e.remainRate?e.remainRate:.01,fixCoinA:e.fix_amount_a,rebalanceCount:0,shouldRequestStake:e.shouldRequestStake,leftSuiAmount:r?new it(s.toFixed(0)):new it(0),rightSuiAmount:r?new it(e.input_amount):new it(s.toFixed(0)),staking_id:e.staking_id});return a?{...a,request_id:e.request_id}:null}throw Error("Only support fix sui")}return null}async calculateRebalance(e){const{clmm_pool:t,a2b:n,curSqrtPrice:i,amount_a:o,amount_b:s,lowerTick:r,upperTick:a,amount_left:c,amount_right:u,coinTypeA:l,coinTypeB:d,useRoute:h,priceSplitPoint:g,remainRate:b}=e,v=async(x,P,E)=>{const S=x.plus(P).div(2),T=await this.clmmPreSwap(t,i,n,S,l,d,!0,g,h);if(T.amount_out==="0")return T;if(T.after_sqrt_price||(T.after_sqrt_price=e.curSqrtPrice),T.is_exceed)return P=S,v(x,P,E+1);const R=n?o.sub(T.amount_in):o.add(T.amount_out),K=n?s.add(T.amount_out):s.sub(T.amount_in),V=he.sqrtPriceX64ToTickIndex(new _(T.after_sqrt_price)),W=Hn.estLiquidityAndcoinAmountFromOneAmounts(r,a,new _(R.toString()),!0,!0,1,new _(T.after_sqrt_price)),tt=new it(W.coinAmountA.toString()),j=new it(W.coinAmountB.toString());if(console.log("1110 swap ",{preRes:T,left:x.toString(),right:P.toString(),mid:S.toString(),afterPoolTickIndex:V,afterA:R.toString(),afterB:K.toString(),usedA:tt.toString(),usedB:toString(),count:E}),tt.toString()!==R.toString())throw new Error("usedA does not match afterA");if(K.lessThan(j))n?x=S:P=S;else{n?P=S:x=S;const $=K.sub(j),q=K.mul(b);if(console.log("1110 amount ",{remainingB:$.toString(),maxRemainingB:q.toString(),remainRate:b,count:E}),q.sub($).greaterThanOrEqualTo(0))return console.log("break"),{...T,remainingB:$}}return x.greaterThan(P)||P.sub(x).lessThan(10)?T:v(x,P,E+1)};return c.greaterThanOrEqualTo(u)?v(new it(0),c,0):v(c,u,0)}async clmmPreSwap(e,t,n,i,o,s,r,a,c,u){var P;if(c)try{const E=await this._sdk.ClmmSDK.RouterV2.getBestRouter(n?o:s,n?s:o,Number(i.toFixed(0)),r,a,"",void 0,void 0,!0,!1,u);if(!E.result)throw new Error("route unavailable");const{result:S}=E;let T=t;return S.splitPaths.forEach(R=>{const K=R.basePaths.find(V=>V.poolAddress.toLowerCase()===e.toLowerCase());K&&(T=K.afterSqrtPrice.toString())}),{amount_in:S.inputAmount.toString(),amount_out:S.outputAmount.toString(),after_sqrt_price:T,is_exceed:S.isExceed,route_obj:S}}catch{throw new Error("route unavailable")}const{integrate:l,simulationAccount:d}=this.sdk.ClmmSDK.sdkOptions,h=new _t,g=[o,s],b=[h.pure(e),h.pure(n),h.pure(r),h.pure(i.toFixed(0))];h.moveCall({target:`${l.published_at}::${Qr}::calculate_swap_result`,arguments:b,typeArguments:g});const x=(P=(await this.sdk.ClmmSDK.fullClient.devInspectTransactionBlock({transactionBlock:h,sender:d.address})).events)==null?void 0:P.filter(E=>Ct(E.type).name==="CalculatedSwapResultEvent");return x.length===0?null:x[0].parsedJson.data}async getVault(e,t=!1){const n=this.readPoolFromCache(e,t);if(n)return n;try{const i=await this._sdk.ClmmSDK.fullClient.getObject({id:e,options:{showType:!0,showContent:!0,showDisplay:!0,showOwner:!0}}),o=Zi.buildPool(i);if(o)return o.staking_id=this.findHaedalStakeId(o.position.coinTypeA,o.position.coinTypeB),this.savePoolToCache(o),o}catch(i){console.log(i)}}async getVaultsConfigs(e=!1){const{package_id:t}=this._sdk.sdkOptions.vaults,n=`${t}_getMirrorPoolConfigs`,i=this.getCache(n,e);if(i!==void 0)return i;const o=(await this._sdk.ClmmSDK.fullClient.queryEventsByPage({MoveEventType:`${t}::vaults::InitEvent`})).data,s={admin_cap_id:"",vaults_manager_id:"",vaults_pool_handle:""};if(o.length>0){for(const r of o){const a=r.parsedJson;s.admin_cap_id=a.admin_cap_id,s.vaults_manager_id=a.manager_id;const c=await this._sdk.ClmmSDK.fullClient.getObject({id:s.vaults_manager_id,options:{showContent:!0}}),u=Oe(c);s.vaults_pool_handle=u.vault_to_pool_maps.fields.id.id;break}this.updateCache(n,s,Ee)}return s}async getExchangeRateForHaedal(e,t,n){const{haedal:i}=this._sdk.sdkOptions,{simulationAccount:o}=this._sdk.ClmmSDK.sdkOptions;try{const s=new _t;t?await this.requestStake(e,n||1e9,s):s.moveCall({target:`${i.published_at}::staking::get_exchange_rate`,typeArguments:[],arguments:[s.object(e)]});const r=await this._sdk.ClmmSDK.fullClient.devInspectTransactionBlock({transactionBlock:s,sender:t?this._sdk.ClmmSDK.senderAddress:o.address});if(console.log("getExchangeRateForHaedal res: ",r),t){const u=r.events.find(g=>g.type.includes("UserStaked")),{sui_amount:l,st_amount:d}=u.parsedJson,h=N(l).div(d).toString();return console.log({st_amount:d,sui_amount:l,rate:h}),h}const a=r.results[0].returnValues[0][0],c=El.de("u64",Uint8Array.from(a))/1e6;return console.log("rate ",El.de("u64",Uint8Array.from(a))),c.toString()}catch(s){console.log("getExchangeRateForHaedal",s)}return"0"}requestStakeCoin(e,t,n){const{haedal:i}=this._sdk.sdkOptions;return t.moveCall({target:`${i.published_at}::staking::request_stake_coin`,typeArguments:[],arguments:[t.object(Dn("0x5")),t.object(e),n,t.pure(Dn("0x0"))]})}async requestStake(e,t,n){const{haedal:i}=this._sdk.sdkOptions,o=await this._sdk.ClmmSDK.getOwnerCoinAssets(this._sdk.getVerifySenderAddress(),qc);n=n||new _t;let s;if(t>95e10){const[r,...a]=o;a.length>0&&n.mergeCoins(n.object(r.coinObjectId),a.map(c=>n.object(c.coinObjectId))),s=n.splitCoins(n.object(r.coinObjectId),[t])}else s=rn.buildCoinForAmount(n,o,BigInt(t),qc,!1,!0).targetCoin;return n.moveCall({target:`${i.published_at}::interface::request_stake`,typeArguments:[],arguments:[n.object(Dn("0x5")),n.object(e),s,n.pure(Dn("0x0"))]}),n}updateCache(e,t,n=go){let i=this._cache[e];i?(i.overdueTime=En(n),i.value=t):i=new Wi(t,En(n)),this._cache[e]=i}getCache(e,t=!1){const n=this._cache[e],i=n==null?void 0:n.isValid();if(!t&&i)return n.value;i||delete this._cache[e]}},Qa=class{static buildOrderLimitEvent(e){const{events:t}=e,n=[];return t&&t.forEach(i=>{const o=Ct(i.type).name;if(o==="OrderPlacedEvent"||o==="OrderCanceledEvent"||o==="FlashLoanEvent"){const s={digest:e.digest,type:o,timestampMs:e.timestampMs,parsedJson:i.parsedJson};n.push(s)}}),n}static buildLimitOrderInfo(e){const t=Oe(e),n=xr(e);if(t&&n)try{const i=Ct(n),o={pay_coin_type:i.type_arguments[0],target_coin_type:i.type_arguments[1],balance:t.balance,canceled_ts:t.canceled_ts==="18446744073709551615"?0:Number(t.canceled_ts),id:t.id.id,obtained_amount:t.obtained_amount,owner:t.owner,rate:t.rate,expire_ts:Number(t.expire_ts),total_pay_amount:t.total_pay_amount,status:"Running",created_ts:Number(t.created_ts)};if(o.canceled_ts===0)o.status="Running";else if(Number(o.obtained_amount)===0)o.status="Cancelled";else{const s=N(o.total_pay_amount).mul(1e20).div(o.rate).toFixed(0);o.obtained_amount===s?o.status="Completed":o.status="Cancelled"}return o}catch(i){console.log(i)}}static calculateFormatRate(e,t,n){const i=20+t-n;return N(e).mul(N(10).pow(i)).toString()}static calculateRate(e,t,n){const i=20+t-n;return Number(e)/10**i}},MS=class{constructor(e){qt(this,"_sdk");qt(this,"_cache",{});this._sdk=e}get sdk(){return this._sdk}async getLimitOrderTokenList(){const{limit_order:e}=this._sdk.sdkOptions,{token_list_handle:t}=et(e),{fullClient:n}=this._sdk.ClmmSDK,o=(await n.getDynamicFieldsByPage(t)).data.map(r=>r.objectId);return(await n.batchGetObjects(o,{showContent:!0})).map(r=>{const{fields:a}=r.data.content;return{coin_type:Ct(a.name.fields.name).full_address,min_trade_amount:Number(a.value)}})}async getLimitOrderPoolList(){const{limit_order:e}=this._sdk.sdkOptions,{rate_orders_indexer_handle:t}=et(e),{fullClient:n}=this._sdk.ClmmSDK,o=(await n.getDynamicFieldsByPage(t)).data.map(r=>r.objectId);return(await n.batchGetObjects(o,{showContent:!0})).map(r=>{const{fields:a}=r.data.content.fields.value,c={pay_coin_type:Ct(a.pay_coin.fields.name).full_address,target_coin_type:Ct(a.target_coin.fields.name).full_address,indexer_id:a.indexer_id};return this._sdk.updateCache(`${c.pay_coin_type}_${c.target_coin_type}`,c.indexer_id),c})}async getPoolIndexerId(e,t){const n=this._sdk.getCache(`${e}_${t}`);try{if(n===void 0){const o=(await this.getLimitOrderPoolList()).filter(s=>Ct(s.pay_coin_type).full_address===Ct(e).full_address&&Ct(s.target_coin_type).full_address===Ct(t).full_address);if(o.length>0)return o[0].indexer_id}}catch{}return n}async getOwnerLimitOrderList(e,t){const{fullClient:n}=this._sdk.ClmmSDK,i={data:[],hasNextPage:!1};try{const o=await this.getUserIndexerHandle(e);if(!o)return i;const s=await n.getDynamicFieldsByPage(o,t);i.hasNextPage=s.hasNextPage,i.nextCursor=s.nextCursor;const r=s.data.map(u=>u.name.value),c=(await n.batchGetObjects(r,{showContent:!0})).map(u=>Qa.buildLimitOrderInfo(u)).filter(u=>u!==void 0);i.data=c}catch(o){console.error("Error in getOwnerLimitOrderList:",o)}return i}async getLimitOrderConfigs(){const{package_id:e}=this._sdk.sdkOptions.limit_order,t={rate_orders_indexer_id:"",rate_orders_indexer_handle:"",global_config_id:"",token_list_handle:"",user_orders_indexer_id:"",user_orders_indexer_handle:""},n=(await this._sdk.ClmmSDK.fullClient.queryEventsByPage({MoveEventType:`${e}::limit_order::InitEvent`})).data;if(n.length>0){const o=n[0].parsedJson;t.rate_orders_indexer_id=o.rate_orders_indexer_id,t.user_orders_indexer_id=o.user_orders_indexer_id;const s=await this._sdk.ClmmSDK.fullClient.getObject({id:t.rate_orders_indexer_id,options:{showContent:!0}});t.rate_orders_indexer_handle=Oe(s).list.fields.id.id;const r=await this._sdk.ClmmSDK.fullClient.getObject({id:t.user_orders_indexer_id,options:{showContent:!0}});t.user_orders_indexer_handle=Oe(r).indexer.fields.id.id}const i=(await this._sdk.ClmmSDK.fullClient.queryEventsByPage({MoveEventType:`${e}::config::InitFactoryEvent`})).data;if(i.length>0){const o=i[0].parsedJson;t.global_config_id=o.global_config_id;const s=await this._sdk.ClmmSDK.fullClient.getObject({id:t.global_config_id,options:{showContent:!0}}),r=Oe(s);t.token_list_handle=r.token_white_list.fields.id.id}return t}async getLimitOrder(e){const{fullClient:t}=this._sdk.ClmmSDK;try{const n=await t.getObject({id:e,options:{showContent:!0}});return Qa.buildLimitOrderInfo(n)}catch(n){console.error("Error in getLimitOrder:",n);return}}async getLimitOrderLogs(e){const{fullClient:t}=this._sdk.ClmmSDK;try{const n=await t.queryTransactionBlocks({filter:{ChangedObject:e},options:{showEvents:!0}}),i=[];return n.data.forEach(o=>{i.push(...Qa.buildOrderLimitEvent(o))}),i}catch(n){return console.error("Error in getLimitOrderLogs:",n),[]}}buildRateOrdersIndexerType(e){const{limit_order:t}=this._sdk.sdkOptions;return Uc(`${t.package_id}::limit_order::RateOrdersIndexer`,[e.pay_coin_type,e.target_coin_type])}async placeLimitOrder(e){const{limit_order:t}=this._sdk.sdkOptions,{user_orders_indexer_id:n,global_config_id:i,rate_orders_indexer_id:o}=et(t),s=await this._sdk.ClmmSDK.getOwnerCoinAssets(this._sdk.ClmmSDK.senderAddress,e.pay_coin_type),r=new _t,a=await this.getPoolIndexerId(e.pay_coin_type,e.target_coin_type),c=rn.buildCoinForAmount(r,s,BigInt(e.pay_coin_amount),e.pay_coin_type,!1,!0);return r.moveCall({target:`${t.published_at}::limit_order::${a===void 0?"create_indexer_and_place_limit_order":"place_limit_order"}`,typeArguments:[e.pay_coin_type,e.target_coin_type],arguments:[r.object(i),a===void 0?r.object(o):r.object(a),r.object(n),c.targetCoin,r.pure(Qa.calculateFormatRate(e.rate,e.pay_decimal,e.target_decimal)),r.pure(e.expired_ts),r.object(Ot)]}),r}async cancelOrdersByOwner(e){const{limit_order:t}=this._sdk.sdkOptions,{global_config_id:n}=et(t),i=new _t,o={};for(let s=0;s<e.length;s++){const r=e[s],a=await this.getPoolIndexerId(r.pay_coin_type,r.target_coin_type);if(a===void 0)throw Error("not found indexerId");o[r.order_id]=a}return e.forEach(s=>{i.moveCall({target:`${t.published_at}::limit_order::cancel_order_by_owner`,typeArguments:[s.pay_coin_type,s.target_coin_type],arguments:[i.object(n),i.object(o[s.order_id]),i.object(s.order_id),i.object(Ot)]})}),i}async getUserIndexerHandle(e){const{fullClient:t}=this._sdk.ClmmSDK,{limit_order:n}=this._sdk.sdkOptions;let i=this.getUserIndexerHandleByCache(e);if(i===void 0){const o=new _t;o.moveCall({target:`${n.published_at}::limit_order::get_orders_indexer_by_owner`,typeArguments:[],arguments:[o.pure(e),o.object(et(n).user_orders_indexer_id)]}),i=(await t.devInspectTransactionBlock({transactionBlock:o,sender:this._sdk.ClmmSDK.sdkOptions.simulationAccount.address})).events[0].parsedJson.orders_table_id,i&&this.saveUserIndexerHandleByCache(e,i)}return i}getUserIndexerHandleByCache(e){const t=`getUserIndexerHandleByCache_${e}`;return this.getCache(t)}saveUserIndexerHandleByCache(e,t){const n=`getUserIndexerHandleByCache_${e}`;return this.updateCache(n,t)}updateCache(e,t,n=Ee){let i=this._cache[e];i?(i.overdueTime=En(n),i.value=t):i=new Wi(t,En(n)),this._cache[e]=i}getCache(e,t=!1){const n=this._cache[e],i=n==null?void 0:n.isValid();if(!t&&i)return n.value;i||delete this._cache[e]}},DS=class{constructor(e){qt(this,"_sdk");qt(this,"_cache",{});this._sdk=e}get sdk(){return this._sdk}async getFramsPoolList(e="all"){const{package_id:t}=this._sdk.sdkOptions.frams,n={data:[],hasNextPage:!1};try{const i=await this._sdk.ClmmSDK.fullClient.queryEventsByPage({MoveEventType:`${t}::pool::CreatePoolEvent`},e),o=i.data.map(s=>s.parsedJson.pool_id);if(n.hasNextPage=i.hasNextPage,n.nextCursor=i.nextCursor,o.length>0){const s=await this._sdk.ClmmSDK.fullClient.batchGetObjects(o,{showType:!0,showContent:!0});for(const r of s){const a=Ys.buildFramsPool(r);a&&(a.rewarders=await this.getFramsRewarderConfig(a.clmm_pool_id,a.rewarders.map(c=>c.reward_coin)),n.data.push(a),this.updateCache(a.id,a))}}}catch(i){console.log("getFramsPoolList error ",i)}return n}async getFramsPool(e,t=!1){const n=this.getCache(e,t);if(n)return n;const i=await this._sdk.ClmmSDK.fullClient.getObject({id:e,options:{showType:!0,showContent:!0}}),o=Ys.buildFramsPool(i.data);return o&&(o.rewarders=await this.getFramsRewarderConfig(o.clmm_pool_id,o.rewarders.map(s=>s.reward_coin)),this.updateCache(o.id,o)),o}async getFramsRewarderConfig(e,t,n=!1){const{frams:i}=this._sdk.sdkOptions,o=[];for(const s of t){const r=`getFramsRewarderConfig_${s}_${e}`,a=this.getCache(r,n);if(a)o.push(a);else try{const c=await this._sdk.ClmmSDK.fullClient.getDynamicFieldObject({parentId:et(i).rewarder_manager_handle,name:{type:"0x1::type_name::TypeName",value:aS(s)}}),{fields:u}=c.data.content.fields.value.fields.value,l={reward_coin:s,last_reward_time:u.last_reward_time,emission_per_second:u.emission_per_second,total_allocate_point:u.total_allocate_point,allocate_point:""},d=u.pools.fields.id.id,h=await this._sdk.ClmmSDK.fullClient.getDynamicFieldObject({parentId:d,name:{type:"0x2::object::ID",value:e}}),{allocate_point:g}=h.data.content.fields.value.fields.value.fields;l.allocate_point=g,this.updateCache(r,l),o.push(l)}catch(c){console.log(c)}}return o}async getOwnedFramsPositionNFTList(e,t=[],n=!1,i=!0,o="all"){const{package_id:s}=this._sdk.sdkOptions.frams,r={data:[],hasNextPage:!1};let a={};const c=[],u=t.length>0,l=await this._sdk.ClmmSDK.fullClient.getOwnedObjectsByPage(e,{filter:{StructType:`${s}::pool::WrappedPositionNFT`},options:{showContent:!0}},o);r.hasNextPage=l.hasNextPage,r.nextCursor=l.nextCursor;for(const d of l.data){const h=Ys.buildFramsPositionNFT(d);if(h)if(u){if(t.includes(h.pool_id)){c.push(h);let g=a[h.pool_id];g?g.push(h):g=[h],a[h.pool_id]=g}}else c.push(h)}if(n&&c.length>0){const d=await this.calculateFarmingRewards(c.map(h=>({pool_id:h.pool_id,position_nft_id:h.id,clmm_pool_id:h.clmm_pool_id})),i);u?(a={},c.forEach(h=>{d[h.id]&&(h.rewards=d[h.id]);let b=a[h.pool_id];b?b.push(h):b=[h],a[h.pool_id]=b})):c.forEach(h=>{d[h.id]&&(h.rewards=d[h.id])})}return u?a:(r.data=c,r)}async getFramsPositionNFT(e,t=!0){const n=await this._sdk.ClmmSDK.fullClient.getObject({id:e,options:{showContent:!0,showType:!0}}),i=Ys.buildFramsPositionNFT(n);if(t&&i){const o=await this.calculateFarmingRewards([{pool_id:i.pool_id,position_nft_id:i.id}]);o[i.id]&&(i.rewards=o[i.id])}return i}async calculateFarmingRewards(e,t=!0){var a;const{frams:n}=this._sdk.sdkOptions,i=new _t,{rewarder_manager_id:o,global_config_id:s}=et(n);e.forEach(c=>{i.moveCall({target:`${n.published_at}::router::accumulated_position_rewards`,typeArguments:[],arguments:[i.object(s),i.object(o),i.object(c.pool_id),i.pure(c.position_nft_id,"address"),i.object(Ot)]})});const r={};try{const c=await this._sdk.ClmmSDK.fullClient.sendSimulationTransaction(i,this._sdk.ClmmSDK.senderAddress,t);console.log({simulateRes:c});const u=(a=c==null?void 0:c.events)==null?void 0:a.filter(l=>Ct(l.type).name==="AccumulatedPositionRewardsEvent");if(u&&u.length>0)for(let l=0;l<u.length;l+=1){const{parsedJson:d}=u[l],h=[];d.rewards.contents.forEach(g=>{h.push({rewarder_type:Ct(g.key.name).full_address,rewarder_amount:g.value})}),r[d.wrapped_position_id]=h}}catch(c){console.log(c)}return r}depositPayload(e,t){const{frams:n}=this.sdk.sdkOptions;t=t||new _t;const{global_config_id:i,rewarder_manager_id:o}=et(n);return t.moveCall({target:`${n.published_at}::router::deposit`,typeArguments:[],arguments:[t.object(i),t.object(o),t.object(e.pool_id),t.object(e.clmm_position_id),t.object(Ot)]}),t}async withdrawPayload(e,t){const{frams:n}=this.sdk.sdkOptions,{global_config_id:i,rewarder_manager_id:o}=et(n);return t=t||new _t,t=await this.harvestPayload({pool_id:e.pool_id,position_nft_id:e.position_nft_id},t),t.moveCall({target:`${n.published_at}::router::withdraw`,typeArguments:[],arguments:[t.object(i),t.object(o),t.object(e.pool_id),t.object(e.position_nft_id),t.object(Ot)]}),t}async batchHarvestPayload(e,t){t=t||new _t;for(const n of e)await this.harvestPayload(n,t);return t}async harvestPayload(e,t){const{frams:n}=this.sdk.sdkOptions;t=t||new _t;const i=await this.getFramsPool(e.pool_id,!1);if(i===void 0)throw Error(`not found ${e.pool_id}`);const{global_config_id:o,rewarder_manager_id:s}=et(n);if("collect_fee"in e&&(e.collect_fee||e.clmm_rewarder_types.length>0)){const a=await this._sdk.ClmmSDK.getOwnerCoinAssets(this._sdk.ClmmSDK.senderAddress);t=await this.buildCollectRewarderAndFeeParams({clmm_pool_id:e.clmm_pool_id,position_nft_id:e.position_nft_id,coinTypeA:e.coinTypeA,coinTypeB:e.coinTypeB,collectFee:e.collect_fee,clmm_rewarder_types:e.clmm_rewarder_types},t,a)}return i.rewarders.forEach(a=>{t&&t.moveCall({target:`${n.published_at}::router::harvest`,typeArguments:[a.reward_coin],arguments:[t.object(o),t.object(s),t.object(e.pool_id),t.object(e.position_nft_id),t.object(Ot)]})}),t}async claimFeeAndClmmReward(e){const t=new _t,n=await this._sdk.ClmmSDK.getOwnerCoinAssets(this._sdk.ClmmSDK.senderAddress);return await this.buildCollectRewarderAndFeeParams({clmm_pool_id:e.clmm_pool_id,position_nft_id:e.position_nft_id,coinTypeA:e.coinTypeA,coinTypeB:e.coinTypeB,collectFee:e.collect_fee,clmm_rewarder_types:e.clmm_rewarder_types},t,n),t}async openPositionAddLiquidityStakePaylod(e){const t=new _t,{clmm_pool:n,integrate:i}=this._sdk.ClmmSDK.sdkOptions,o=et(n),s=t.moveCall({target:`${n.published_at}::pool::open_position`,typeArguments:[e.coinTypeA,e.coinTypeB],arguments:[t.object(o.global_config_id),t.object(e.clmm_pool_id),t.pure(Ho(BigInt(e.tick_lower)).toString()),t.pure(Ho(BigInt(e.tick_upper)).toString())]}),r=await this._sdk.ClmmSDK.getOwnerCoinAssets(this._sdk.ClmmSDK.senderAddress),a=rn.buildCoinForAmount(t,r,BigInt(e.amount_a),e.coinTypeA,!1),c=rn.buildCoinForAmount(t,r,BigInt(e.amount_b),e.coinTypeB,!1);t.moveCall({target:`${i.published_at}::${ed}::add_liquidity_by_fix_coin`,typeArguments:[e.coinTypeA,e.coinTypeB],arguments:[t.object(o.global_config_id),t.object(e.clmm_pool_id),s,a.targetCoin,c.targetCoin,t.pure(e.amount_a.toString()),t.pure(e.amount_b.toString()),t.pure(e.fix_amount_a),t.object(Ot)]});const{frams:u}=this.sdk.sdkOptions,{global_config_id:l,rewarder_manager_id:d}=et(u);return t.moveCall({target:`${u.published_at}::router::deposit`,typeArguments:[],arguments:[t.object(l),t.object(d),t.object(e.pool_id),s,t.object(Ot)]}),t}async addLiquidityPayload(e,t){const{frams:n}=this.sdk.sdkOptions,{clmm_pool:i}=this.sdk.ClmmSDK.sdkOptions;t=t||new _t;const o=et(n),s=et(i),r=await this._sdk.ClmmSDK.getOwnerCoinAssets(this._sdk.ClmmSDK.senderAddress),a=rn.buildCoinForAmount(t,r,BigInt(e.amount_limit_a),e.coinTypeA,!1),c=rn.buildCoinForAmount(t,r,BigInt(e.amount_limit_b),e.coinTypeB,!1);if(e.collect_rewarder&&(t=await this.harvestPayload({pool_id:e.pool_id,position_nft_id:e.position_nft_id,clmm_pool_id:e.clmm_pool_id},t)),e.collect_fee||e.clmm_rewarder_types.length>0){const u=await this._sdk.ClmmSDK.getOwnerCoinAssets(this._sdk.ClmmSDK.senderAddress);t=await this.buildCollectRewarderAndFeeParams({clmm_pool_id:e.clmm_pool_id,position_nft_id:e.position_nft_id,coinTypeA:e.coinTypeA,coinTypeB:e.coinTypeB,collectFee:e.collect_fee,clmm_rewarder_types:e.clmm_rewarder_types},t,u,a.remainCoins,c.remainCoins)}return t.moveCall({target:`${n.published_at}::router::add_liquidity`,typeArguments:[e.coinTypeA,e.coinTypeB],arguments:[t.object(o.global_config_id),t.object(s.global_config_id),t.object(o.rewarder_manager_id),t.object(e.pool_id),t.object(e.clmm_pool_id),t.object(e.position_nft_id),a.targetCoin,c.targetCoin,t.pure(e.amount_limit_a),t.pure(e.amount_limit_b),t.pure(e.delta_liquidity),t.object(Ot)]}),t}async addLiquidityFixCoinPayload(e,t){const{frams:n}=this.sdk.sdkOptions,{clmm_pool:i}=this.sdk.ClmmSDK.sdkOptions;t=t||new _t;const o=et(n),s=et(i),r=await this._sdk.ClmmSDK.getOwnerCoinAssets(this._sdk.ClmmSDK.senderAddress),a=rn.buildCoinForAmount(t,r,BigInt(e.amount_a),e.coinTypeA,!1),c=rn.buildCoinForAmount(t,r,BigInt(e.amount_b),e.coinTypeB,!1);if(e.collect_rewarder&&(t=await this.harvestPayload({pool_id:e.pool_id,position_nft_id:e.position_nft_id,clmm_pool_id:e.clmm_pool_id},t)),e.collect_fee||e.clmm_rewarder_types.length>0){const u=await this._sdk.ClmmSDK.getOwnerCoinAssets(this._sdk.ClmmSDK.senderAddress);t=await this.buildCollectRewarderAndFeeParams({clmm_pool_id:e.clmm_pool_id,position_nft_id:e.position_nft_id,coinTypeA:e.coinTypeA,coinTypeB:e.coinTypeB,collectFee:e.collect_fee,clmm_rewarder_types:e.clmm_rewarder_types},t,u,a.remainCoins,c.remainCoins)}return t.moveCall({target:`${n.published_at}::router::add_liquidity_fix_coin`,typeArguments:[e.coinTypeA,e.coinTypeB],arguments:[t.object(o.global_config_id),t.object(s.global_config_id),t.object(o.rewarder_manager_id),t.object(e.pool_id),t.object(e.clmm_pool_id),t.object(e.position_nft_id),a.targetCoin,c.targetCoin,t.pure(e.amount_a.toString()),t.pure(e.amount_b.toString()),t.pure(e.fix_amount_a),t.object(Ot)]}),t}async removeLiquidityPayload(e,t){const{frams:n}=this.sdk.sdkOptions,{clmm_pool:i}=this.sdk.ClmmSDK.sdkOptions;t=t||new _t;const o=et(n),s=et(i);if(e.collect_rewarder&&(!e.unstake||e.close_position)&&(t=await this.harvestPayload({pool_id:e.pool_id,position_nft_id:e.position_nft_id,clmm_pool_id:e.clmm_pool_id},t)),e.clmm_rewarder_types.length>0){const r=await this._sdk.ClmmSDK.getOwnerCoinAssets(this._sdk.ClmmSDK.senderAddress);t=await this.buildCollectRewarderAndFeeParams({clmm_pool_id:e.clmm_pool_id,position_nft_id:e.position_nft_id,coinTypeA:e.coinTypeA,coinTypeB:e.coinTypeB,collectFee:!1,clmm_rewarder_types:e.clmm_rewarder_types},t,r)}if(e.close_position){if(e.clmm_position_id===void 0)throw Error("close_position need clmm_position_id");t.moveCall({target:`${n.published_at}::router::close_position`,typeArguments:[e.coinTypeA,e.coinTypeB],arguments:[t.object(o.global_config_id),t.object(o.rewarder_manager_id),t.object(e.pool_id),t.object(s.global_config_id),t.object(e.clmm_pool_id),t.object(e.position_nft_id),t.pure(e.min_amount_a),t.pure(e.min_amount_b),t.object(Ot)]})}else t.moveCall({target:`${n.published_at}::router::remove_liquidity`,typeArguments:[e.coinTypeA,e.coinTypeB],arguments:[t.object(o.global_config_id),t.object(s.global_config_id),t.object(o.rewarder_manager_id),t.object(e.pool_id),t.object(e.clmm_pool_id),t.object(e.position_nft_id),t.pure(e.delta_liquidity),t.pure(e.min_amount_a),t.pure(e.min_amount_b),t.object(Ot)]}),e.unstake&&this.withdrawPayload({pool_id:e.pool_id,position_nft_id:e.position_nft_id});return t}async buildCollectRewarderAndFeeParams(e,t,n,i,o){i===void 0&&(i=[...n]),o===void 0&&(o=[...n]);const s=oo(e.coinTypeA),r=oo(e.coinTypeB);e.collectFee&&this.collectFeePayload({clmm_pool_id:e.clmm_pool_id,position_nft_id:e.position_nft_id,coinTypeA:e.coinTypeA,coinTypeB:e.coinTypeB},t);const a=[];return e.clmm_rewarder_types.forEach(c=>{switch(oo(c)){case s:a.push(rn.buildCoinForAmount(t,i,BigInt(0),c,!1).targetCoin);break;case r:a.push(rn.buildCoinForAmount(t,o,BigInt(0),c,!1).targetCoin);break;default:a.push(rn.buildCoinForAmount(t,n,BigInt(0),c,!1).targetCoin);break}}),this.collectClmmRewardPayload({clmm_pool_id:e.clmm_pool_id,position_nft_id:e.position_nft_id,clmm_rewarder_types:e.clmm_rewarder_types,coinTypeA:e.coinTypeA,coinTypeB:e.coinTypeB,reward_coins:a},t),t}collectFeePayload(e,t){const{frams:n}=this.sdk.sdkOptions,{clmm_pool:i}=this.sdk.ClmmSDK.sdkOptions;t=t||new _t;const o=et(n),s=et(i);return t.moveCall({target:`${n.published_at}::router::collect_fee`,typeArguments:[e.coinTypeA,e.coinTypeB],arguments:[t.object(o.global_config_id),t.object(s.global_config_id),t.object(e.clmm_pool_id),t.object(e.position_nft_id)]}),t}async collectClmmRewardPayload(e,t){var a;const{frams:n}=this.sdk.sdkOptions,{clmm_pool:i}=this.sdk.ClmmSDK.sdkOptions;t=t||new _t;let o=e.reward_coins;if(e.clmm_rewarder_types.length>0&&o===void 0){o=[];const c=await this._sdk.ClmmSDK.getOwnerCoinAssets(this._sdk.ClmmSDK.senderAddress);e.clmm_rewarder_types.forEach(u=>{o.push(rn.buildCoinForAmount(t,c,BigInt(0),u,!1).targetCoin)})}const s=et(n),r=et(i);return(a=e.clmm_rewarder_types)==null||a.forEach((c,u)=>{t&&t.moveCall({target:`${n.published_at}::router::collect_clmm_reward`,typeArguments:[c,e.coinTypeA,e.coinTypeB],arguments:[t.object(s.global_config_id),t.object(r.global_config_id),t.object(e.clmm_pool_id),t.object(e.position_nft_id),t.object(r.global_vault_id),o[u],t.object(Ot)]})}),t}async getFrarmsConfigs(){const{package_id:e}=this._sdk.sdkOptions.frams,t={global_config_id:"",rewarder_manager_id:"",rewarder_manager_handle:""},n=(await this._sdk.ClmmSDK.fullClient.queryEventsByPage({MoveEventType:`${e}::config::InitConfigEvent`})).data;if(n.length>0){const o=n[0].parsedJson;t.global_config_id=o.global_config_id,t.admin_cap_id=o.admin_cap_id}const i=(await this._sdk.ClmmSDK.fullClient.queryEventsByPage({MoveEventType:`${e}::rewarder::InitRewarderManagerEvent`})).data;if(i.length>0){const o=i[0].parsedJson;t.rewarder_manager_id=o.id;const s=await this._sdk.ClmmSDK.fullClient.getObject({id:t.rewarder_manager_id,options:{showContent:!0}});t.rewarder_manager_handle=s.data.content.fields.rewarders.fields.id.id}return t}updateCache(e,t,n=Ee){let i=this._cache[e];i?(i.overdueTime=En(n),i.value=t):i=new Wi(t,En(n)),this._cache[e]=i}getCache(e,t=!1){const n=this._cache[e];if(!t&&(n!=null&&n.isValid()))return n.value;delete this._cache[e]}},LS=class{constructor(e,t){qt(this,"_cache",{});qt(this,"_sdkOptions");qt(this,"_launchpad");qt(this,"_ido");qt(this,"_xcetusModule");qt(this,"_xtokenModule");qt(this,"_boosterModule");qt(this,"_makerModule");qt(this,"_clmmSDK");qt(this,"_liquidityStrategy");qt(this,"_vaults");qt(this,"_limitOrder");qt(this,"_farmsModule");this._sdkOptions=e,this._clmmSDK=t,this._launchpad=new kS(this),this._ido=new RS(this),this._xcetusModule=new PS(this),this._xtokenModule=new $S(this),this._boosterModule=new xS(this),this._makerModule=new SS(this),this._vaults=new qS(this),this._limitOrder=new MS(this),this._farmsModule=new DS(this),this._liquidityStrategy=new US(this),mm(this._sdkOptions)}get ClmmSDK(){return this._clmmSDK}get sdkOptions(){return this._sdkOptions}get Launchpad(){return this._launchpad}get Ido(){return this._ido}get XToken(){return this._xtokenModule}get XCetusModule(){return this._xcetusModule}get BoosterModule(){return this._boosterModule}get MakerModule(){return this._makerModule}get LiquidityStrategy(){return this._liquidityStrategy}get Vaults(){return this._vaults}get LimitOrder(){return this._limitOrder}get Farms(){return this._farmsModule}getVerifySenderAddress(){const{senderAddress:e}=this.ClmmSDK;if(e.length===0||!Um(e))throw Error("this clmm config sdk senderAddess is illegal");return e}updateCache(e,t,n=Ee){let i=this._cache[e];i?(i.overdueTime=En(n),i.value=t):i=new Wi(t,En(n)),this._cache[e]=i}getCache(e,t=!1){const n=this._cache[e];if(!t&&(n!=null&&n.isValid()))return n.value;delete this._cache[e]}},xm=LS;function NS(e){const t={fullRpcUrl:localStorage.getItem(`${e}-currentRpclocal2`)||Ut[e||"Sui"].fullRpcUrl,simulationAccount:Ut[e||"Sui"].simulationAccount,cetus_config:Ut[e||"Sui"].cetus_config,clmm_pool:Ut[e||"Sui"].clmm_pool,integrate:Ut[e||"Sui"].integrate,deepbook:Ut[e||"Sui"].deepbook,deepbook_endpoint_v2:Ut[e||"Sui"].deepbook_endpoint_v2,aggregatorUrl:Ut[e||"Sui"].aggregatorUrl,swapCountUrl:Ut[e||"Sui"].swapCountUrl},n={launchpad:Ut[e||"Sui"].launchpad,ido:Ut[e||"Sui"].ido,xcetus:Ut[e||"Sui"].xcetus,xcetus_dividends:Ut[e||"Sui"].xcetus_dividends,cetus_faucet:Ut[e||"Sui"].cetus_faucet,xtoken:Ut[e||"Sui"].xtoken,xtoken_dividends:Ut[e||"Sui"].xtoken_dividends,token_faucet:Ut[e||"Sui"].token_faucet,booster:Ut[e||"Sui"].booster,maker_bonus:Ut[e||"Sui"].maker_bonus,liquidity_stratefy:Ut[e||"Sui"].liquidity_stratefy,vaults:Ut[e||"Sui"].vaults,frams:Ut[e||"Sui"].frams};console.log("defaultNetworkOptions####",t);const i=new Mo(t),o=new xm(n,i),s=id(),r=es(()=>s),a=Lf(),c=es(()=>a),u=jS();es(()=>u),Mf(()=>{r.value.address&&(i.senderAddress=r.value.address)});const l=es(()=>r.value.walletName),{$notify:d}=Hs(),h=L=>{const{$notify:G}=Hs();G.success({key:L.hash+"loading",icon:xe("img",{class:{"notify-icon":!0,"loading-animate":!0},src:c.value.theme=="default"?"/image/img-loading@2x.png":"/sui-image/img-loading.png"}),message:xe("div",{class:"notification-title"},[xe("span",{innerHTML:L.title},null)]),description:xe("div",{class:"notification-title"},[xe("div",{class:"notification-text",innerHTML:gi.global.t("newAdd.confirmingTransaction")},null),xe("a",{href:Oc(c.value.currentExplorer,"tx",window.encodeURIComponent(L.hash)),target:"_blank",innerHTML:gi.global.t("common.viewTransaction")},null)]),duration:0,class:"ant-notification-copy ant-notification-swap"})},g=L=>{const{$notify:G}=Hs();G.success({icon:xe("svg",{class:{icon:!0},"aria-hidden":!0},[xe("use",{"xlink:href":"#icon-icon-change1"})]),message:xe("div",{class:"notification-title"},[xe("span",{innerHTML:`${L.title} `+gi.global.t("newAdd.success")},null)]),description:xe("div",{class:"notification-title"},[xe("div",{class:"notification-text",innerHTML:L.desc},null),xe("a",{href:Oc(c.value.currentExplorer,"tx",window.encodeURIComponent(L.hash)),target:"_blank",innerHTML:gi.global.t("common.viewTransaction")},null)]),duration:4.5,class:"ant-notification-copy ant-notification-swap"})},b=L=>{d.error({icon:xe("svg",{class:{icon:!0},"aria-hidden":!0},[xe("use",{"xlink:href":"#icon-a-icon-Shutdown"})]),message:xe("div",{class:"notification-title"},[xe("span",{innerHTML:`${L} `+gi.global.t("newAdd.failed")},null)]),description:gi.global.t("newAdd.somethingWrong"),duration:4.5,class:"ant-notification-copy ant-notification-error"})},v=async(L,G=!1)=>{var J,ot,ft,yt,ht;const{$notify:Y}=Hs();try{let bt={};if(console.log("watchTransaction params: ",L),!L.res||!((J=L==null?void 0:L.res)!=null&&J.digest)||!((ot=L==null?void 0:L.res)!=null&&ot.effects)){const vt=await Xs(2e3);bt=await i.Pool.getSuiTransactionResponse(L.hash),console.log("0503###watchTransaction###res###",bt)}else bt=L.res;if(console.log("0411###watchTransaction###res###",bt),console.log(L,"====>params"),((yt=(ft=bt==null?void 0:bt.effects)==null?void 0:ft.status)==null?void 0:yt.status)==="success"){Y.close(L.hash+"loading"),g(L);const vt={walletAddress:s.address,chainName:"Sui",...L,...bt,date:new Date().getTime()+6048e5};if(G)if(console.log("0222###watchTransaction###isGetNftInfo true###res####",bt),bt.events){const jt=bt.events.filter(Kt=>Kt.type.includes("OpenPositionEvent"));return{status:!0,nftInfo:jt[0]&&((ht=jt[0])==null?void 0:ht.parsedJson),res:bt}}else return{status:!0,nftInfo:bt.effects.events,res:bt};return!0}else{if(bt&&bt.effects&&bt.effects.status&&bt.effects.status.status!=="success")return Y.close(L.hash+"loading"),b(L.title),!1;setTimeout(()=>v(L),3e3)}}catch(bt){return console.log("watchTransaction###error###",bt),Y.close(L.hash+"loading"),Y.error({icon:xe("svg",{class:{icon:!0},"aria-hidden":!0},[xe("use",{"xlink:href":"#icon-a-icon-Shutdown"})]),message:xe("div",{class:"notification-title"},[xe("span",{innerHTML:`${L.title} Failed`},null)]),duration:4.5,description:"Something went wrong",class:"ant-notification-copy ant-notification-error"}),!0}},x=async L=>{var J,ot,ft,yt,ht,bt;L.setSenderIfNotSet(r.value.address);const G=await L.build({client:i.fullClient}),Y=await i.fullClient.dryRunTransactionBlock({transactionBlock:G});if(console.log("0503###simulate###simulateRes###",Y),((ot=(J=Y==null?void 0:Y.effects)==null?void 0:J.status)==null?void 0:ot.status)==="failure"){console.log("0424###simulateRes###error###",(yt=(ft=Y==null?void 0:Y.effects)==null?void 0:ft.status)==null?void 0:yt.error);const vt=(bt=(ht=Y==null?void 0:Y.effects)==null?void 0:ht.status)==null?void 0:bt.error,ut=/\("(.+?)"\)/g,jt=vt.match(ut),Kt=jt&&jt[0]&&jt[0].match(/\w+/g)||"",Wt=jt&&jt[1]&&jt[1].match(/\w+/g)||"",Ge=vt.substr(vt.lastIndexOf("}, ")+3),Vt=Ge&&Ge.split(")"),Gt=Vt&&Vt[0]||"";throw Kt&&Kt[0]==="factory"&&Wt&&Wt[0]=="create_pool_internal"&&Gt==="1"?(d.error({icon:xe("svg",{class:{icon:!0},"aria-hidden":!0},[xe("use",{"xlink:href":"#icon-a-icon-Shutdown"})]),message:xe("div",{class:"notification-title"},[xe("span",{innerHTML:"Transaction "+gi.global.t("newAdd.failed")},null)]),description:"Pool is existed",duration:4.5,class:"ant-notification-copy ant-notification-error"}),new Error("pool is existed")):(d.error({icon:xe("svg",{class:{icon:!0},"aria-hidden":!0},[xe("use",{"xlink:href":"#icon-a-icon-Shutdown"})]),message:xe("div",{class:"notification-title"},[xe("span",{innerHTML:"Transaction "+gi.global.t("newAdd.failed")},null)]),description:vt,duration:4.5,class:"ant-notification-copy ant-notification-error"}),new Error(vt))}else return Y},P=L=>({transactionBlock:L,options:{showEffects:!0,showEvents:!0,showInput:!0,showRawInput:!0,showObjectChanges:!0,showBalanceChanges:!0}}),E=async(L,G=!1)=>{var J,ot;await Xs(2e3);const Y=await i.Pool.getSuiTransactionResponse(L.hash);if(((ot=(J=Y==null?void 0:Y.effects)==null?void 0:J.status)==null?void 0:ot.status)==="success"){d.close(L.hash+"loading"),g(L);const ft={walletAddress:s.address,chainName:"Sui",...L,...Y,date:new Date().getTime()+6048e5};a.setTransactionList(ft)}},S=async L=>{try{s.setLoading(!0);const G=await i.getOwnerCoinAssets(L),Y={};return G.forEach(J=>{var ot,ft;if(J&&J.coinAddress){const yt=J?J.balance.toString():"0",ht={...J,balance:yt};Y[J.coinAddress]={...J,balance:(ot=Y[J.coinAddress])!=null&&ot.balance?Je(yt).plus(Y[J.coinAddress].balance).toString():yt,objects:(ft=Y[J.coinAddress])!=null&&ft.objects?[...Y[J.coinAddress].objects,ht]:[ht]}}}),console.log("0411###assets###",Y),s.setAssets(Y),s.setLoading(!1),Y}catch{s.setLoading(!1)}},T=async()=>{try{console.log("getTokenList sdk: ",i);const L=await i.CetusConfig.getCoinConfigs();console.log("0907###tokenList###",L);let G=[],Y=[],J=[];return L.forEach(ot=>{let ft=ot;if(ot.address.includes("::sui::SUI")){const yt=ge(ot.address).full_address;ft={...ft,address:yt}}ft.coin_priority?Y.push(ft):J.push({...ft,coin_priority:"0"})}),Y=Y.sort((ot,ft)=>Number(ot==null?void 0:ot.coin_priority)<Number(ft==null?void 0:ft.coin_priority)?1:-1),J=J.sort((ot,ft)=>ot.symbol.charCodeAt(0)-ft.symbol.charCodeAt(0)),G=[...Y,...J],console.log("0517###haveCoinPriority###",Y),console.log("0517###notHaveCoinPriority###",J),console.log("0517###tokenList###",G),G}catch(L){return console.log("0517###getTokenList###error###",L),[]}},R=async L=>{var Y;const G=[];try{const J=await i.Pool.getPools([]),ot=await T(),ft={};ot.forEach(vt=>{ft[vt.address]=vt});const yt=await i.CetusConfig.getClmmPoolConfigs(),ht={};yt.forEach(vt=>{ht[vt.address]=vt});let bt={};try{const ut=(e=="Aptos"?await fetch(`${Ut.Aptos.api}/v2/sui/swap/count`).then(jt=>jt.json()):await fetch(`${Ut.Sui.api}/v2/sui/swap/count`).then(jt=>jt.json())).data;bt=Object.fromEntries(ut.pools.map(jt=>[jt.swap_account,{...jt,apr_7day:e=="Aptos"?jt.apr_7day:jt.apr_24h}]))}catch{}console.log("0426###getLpListFromContract###poolImmutables###",J),console.log("0426###getLpListFromContract###tokenObj###",ft),console.log("0426###getLpListFromContract###lpObj###",ht),console.log("0426###getLpListFromContract###addressLpTokens###",bt);for(let vt=0;vt<J.length;vt++){const ut=J[vt];if(ht[ut.poolAddress]||!ht[ut.poolAddress]){let jt=ft[ut.coinTypeA],Kt=ft[ut.coinTypeB];jt||(jt=(await i.CetusConfig.getTokenListByCoinTypes([ut.coinTypeA]))[ut.coinTypeA]),Kt||(Kt=(await i.CetusConfig.getTokenListByCoinTypes([ut.coinTypeB]))[ut.coinTypeB]);let Wt=!1;fe(jt.address,Kt.address)&&(Wt=!0);const Ge=bt[ut.poolAddress]?((Y=bt[ut.poolAddress])==null?void 0:Y.is_forward)===!1:Wt;let Vt={};ht[ut.poolAddress]&&(Vt={...Vt,...ht[ut.poolAddress]}),Vt={...Vt,address:ut.poolAddress,coinA:jt,coinB:Kt,coin_a_address:ut.coinTypeA,coin_b_address:ut.coinTypeB,decimals:6,fee:Number(ut.fee_rate)/1e6,tickSpacing:ut.tickSpacing,symbol:`${jt==null?void 0:jt.symbol}-${Kt==null?void 0:Kt.symbol}`,name:`${jt==null?void 0:jt.symbol}-${Kt==null?void 0:Kt.symbol}`,needReverse:Ge},(!L||!L[ut.coinTypeA]&&!L[ut.coinTypeB])&&G.push(Vt)}}return console.log("0426###getLpListFromContract###result###",G),G}catch(J){console.log("getLpListFromContract###err##",J)}},K=async L=>{var G,Y;try{const J=[],ot=await fetch(`${Ut[e||"Sui"].api}/v2/sui/pools_info`).then(ht=>ht.json());if(!((G=ot==null?void 0:ot.data)!=null&&G.lp_list)){const ht=await R(L);if(ht)return ht}console.log(L,"===>newFilterCoinsObj");const ft=((Y=ot==null?void 0:ot.data)==null?void 0:Y.lp_list)||[];console.log("0426###getLpList###lpList###",ft),console.log("0426###getLpList###res###",ot);const yt=["0xabf2af71ab3ed7c6c3bb557b984a9158f500fc8cebce2572239d1f7690930be8","0x473ab0306ff8952d473b10bb4c3516c632edeb0725f6bb3cda6c474d0ffc883f","0xd40feebfcf7935d40c9e82c9cb437442fee6b70a4be84d94764d0d89bb28ab07"];return ft.forEach(ht=>{var jt,Kt,Wt,Ge;const bt=(ht==null?void 0:ht.is_forward)===!1,vt=[],ut=yt.includes(ht.address);if(ht.is_display_rewarder){const Vt=(Wt=(Kt=(jt=ht==null?void 0:ht.object)==null?void 0:jt.rewarder_manager)==null?void 0:Kt.fields)==null?void 0:Wt.rewarders;Vt&&Vt.forEach(Gt=>{var te,ue,_n,Ye,Me,Tn,an,le,mo;const On=new it((te=Gt==null?void 0:Gt.fields)==null?void 0:te.emissions_per_second).mul(it.pow(2,-64));console.log("extractStructTagFromType###",ge((Ye=(_n=(ue=Gt==null?void 0:Gt.fields)==null?void 0:ue.reward_coin)==null?void 0:_n.fields)==null?void 0:Ye.name).source_address),vt.push({coinAddress:ge((an=(Tn=(Me=Gt==null?void 0:Gt.fields)==null?void 0:Me.reward_coin)==null?void 0:Tn.fields)==null?void 0:an.name).source_address,emissionsEveryDay:Math.floor(On.toNumber()*60*60*24),emissions_per_second:(le=Gt==null?void 0:Gt.fields)==null?void 0:le.emissions_per_second,growth_global:(mo=Gt==null?void 0:Gt.fields)==null?void 0:mo.growth_global})}),console.log("0426###rewarders###item###",ht),console.log("0426###rewarders###",Vt,"###rewarderInfo###",vt)}(!L||!L[ht.coin_a.address]&&!L[ht.coin_b.address]&&!L[ge(ht.coin_a.address).full_address]&&!L[ge(ht.coin_b.address).full_address])&&J.push({...ht,coinA:{...ht.coin_a,address:ge(ht.coin_a.address).full_address},coinB:{...ht.coin_b,address:ge(ht.coin_b.address).full_address},rewarderInfo:vt,needReverse:bt,is_pause:(Ge=ht==null?void 0:ht.object)==null?void 0:Ge.is_pause,isStableFarming:ut})}),console.log("0426###getLpList###result###",J),J}catch(J){console.log("0426###getLpList###err###",J);const ot=await R(L);if(console.log(ot,"result===>"),ot)return ot}},V=async(L=[])=>{console.log(L,"getPoolslist##");const Y=await new Mo(t).Pool.getPools(L,0,1e3);if(console.log("0330###getPools###pools###",Y),L.length===0){const J={};return Y.forEach(ot=>{J[ot.poolAddress]={...ot,rate:Je(ot.fee_rate).div(Math.pow(10,6)).toString()}}),J}else return Y},W=async L=>await new Mo(t).Pool.getPool(L),tt=L=>{const G=new _t;return G.moveCall({target:`${Ut[e||"Sui"].faucet.faucet_display}::${L.transactionModule}::faucet`,typeArguments:[],arguments:[G.pure(L.suplyID)]}),P(G)},j=L=>{var Y,J,ot,ft,yt;let G;return L!=null&&L.digest?G={hash:L==null?void 0:L.digest,status:(J=(Y=L==null?void 0:L.effects)==null?void 0:Y.status)==null?void 0:J.status,res:L}:L!=null&&L.effects&&(G={hash:(ot=L==null?void 0:L.effects)==null?void 0:ot.transactionDigest,status:(yt=(ft=L==null?void 0:L.effects)==null?void 0:ft.status)==null?void 0:yt.status,res:L}),G},$=async L=>{try{const{data:G}=await fetch(`${Ut.Sui.api}/v2/sui/ticks?address=${L.poolAddress}&limit=512&orderBy=index`).then(Y=>Y.json());if(G&&G.list&&G.list.length>0)return{list:G.list.map(J=>({objectId:J.object_id,index:J.index,sqrtPrice:new _(J.sqrt_price),liquidityNet:new _(J.liquidity_net),liquidityGross:new _(J.liquidity_gross),feeGrowthOutsideA:new _(J.fee_growth_outside_a),feeGrowthOutsideB:new _(J.fee_growth_outside_b),rewardersGrowthOutside:J.rewards_growth_outside})),address:G.address};{const Y=await i.Pool.fetchTicks({pool_id:L.poolAddress,coinTypeA:L.coinTypeA,coinTypeB:L.coinTypeB});return console.log("0330###getTicks####sui####",Y),{list:Y,address:L.poolAddress}}}catch(G){console.log("0330###getTicks Error###",G);const Y=await i.Pool.fetchTicks({pool_id:L.poolAddress,coinTypeA:L.coinTypeA,coinTypeB:L.coinTypeB});return console.log("0330###getTicks####sui####",Y),{list:Y,address:L.poolAddress}}},q=async(L,G,Y,J)=>await rk(L,G,Y,J),A=L=>{var jt,Kt;const{pool:G,position:Y,roundUp:J}=L,ot=Number(Y.tick_lower_index),ft=Number(Y.tick_upper_index),yt=We.tickIndexToSqrtPriceX64(ot),ht=We.tickIndexToSqrtPriceX64(ft),bt=Ii.getCoinAmountFromLiquidity(new _(Y.liquidity),new _(G.current_sqrt_price),yt,ht,J),vt=yn(bt.coinA.toString(),(jt=G==null?void 0:G.coinA)==null?void 0:jt.decimals),ut=yn(bt.coinB.toString(),(Kt=G==null?void 0:G.coinB)==null?void 0:Kt.decimals);return{coinaAmount:vt,coinbAmount:ut}},f=L=>{const{tokenA:G,tokenB:Y,lowerTick:J,upperTick:ot,coinAmount:ft,iscoinA:yt,roundUp:ht,slippage:bt,curSqrtPrice:vt}=L;console.log(vt.toString(),L,"==>params");const ut=Ii.estLiquidityAndcoinAmountFromOneAmounts(J,ot,ft,yt,ht,bt,vt),jt=G.decimals,Kt=Y.decimals,{tokenMaxA:Wt,tokenMaxB:Ge,liquidityAmount:Vt,coinAmountA:Gt,coinAmountB:On}=ut;return console.log(Wt.toString(),"===>tokenMaxA.toString()"),console.log(Ge.toString(),"===>tokenMaxB.toString()"),console.log(Gt.toString(),"===>coinAmountA.toString()"),console.log(On.toString(),"===>coinAmountB.toString()"),console.log(ut,"result===>"),console.log(ut.liquidityAmount.toString(),"liquidityAmount===>"),console.log(jt,"===>coinaDecimals"),{tokenMaxAOrigin:Wt.toString(),tokenMaxBOrigin:Ge.toString(),tokenMaxA:yn(Gt.toString(),jt),tokenMaxB:yn(On.toString(),Kt),liquidityAmount:Vt}},y=async L=>{var Ye,Me,Tn,an;const{pool:G,amount:Y,fix_amount_a:J,roundUp:ot,tick_lower:ft,tick_upper:yt,index:ht,slippage:bt,coinTypeC:vt,coinTypeD:ut,coinTypeE:jt,curSqrtPrice:Kt,positionInfo:Wt,farmPoolInfo:Ge}=L,Vt=await W(G.poolAddress);console.log(L.curSqrtPrice.toString(),"###getAddLiquidityTransactionPayload 732 params"),console.log(Vt,"###newPool");const Gt=J?Nn(Y,G.token_a.decimals):Nn(Y,G.token_b.decimals),On=We.sqrtPriceX64ToTickIndex(new _(Vt.current_sqrt_price));console.log(Vt.current_sqrt_price.toString(),L.curSqrtPrice.toString(),"curSqrtPrice##610");let te,ue;if(On>=ft&&On<=yt){const le=Ii.estLiquidityAndcoinAmountFromOneAmounts(ft,yt,new _(Gt.toString()),J,ot,bt,new _(Vt.current_sqrt_price));console.log(le,le.tokenMaxA.toNumber(),le.tokenMaxB.toNumber(),"===>preAddResult.coinAmountA.toNumber()"),te=J?Gt.toNumber():le.tokenMaxA.toNumber(),ue=J?le.tokenMaxB.toNumber():Gt.toNumber()}else On>yt?(te=0,ue=Gt.toNumber()):On<ft&&(te=Gt.toNumber(),ue=0);console.log(L,"===>params742"),console.log("0330###createAddLiquidityTransactionPayload###params###",{coinTypeA:G.token_a.address,coinTypeB:G.token_b.address,pool_id:G.poolAddress,tick_lower:ft<-443636?-443636:ft,tick_upper:yt>443636?443636:yt,fix_amount_a:J,amount_a:te,amount_b:ue,is_open:!ht,pos_id:ht});let _n;if(((Ye=Wt==null?void 0:Wt.value)==null?void 0:Ye.positionSource)==="farming"){console.log("0103 getAddLiquidityTransactionPayload positionInfo: ",Wt);const le=[];vt&&le.push(vt),ut&&le.push(ut),jt&&le.push(jt),_n=await o.Farms.addLiquidityFixCoinPayload({pool_id:(Me=Wt==null?void 0:Wt.value)==null?void 0:Me.pool_id,coinTypeA:G.token_a.address,coinTypeB:G.token_b.address,position_nft_id:(Tn=Wt==null?void 0:Wt.value)==null?void 0:Tn.id,clmm_pool_id:(an=Wt==null?void 0:Wt.value)==null?void 0:an.clmm_pool_id,amount_a:te,amount_b:ue,collect_fee:!0,collect_rewarder:!1,fix_amount_a:J,clmm_rewarder_types:le})}else if(!ht)console.log(Ge,"farmPoolInfo##"),Ge?_n=await o.Farms.openPositionAddLiquidityStakePaylod({pool_id:Ge.id,coinTypeA:G.token_a.address,coinTypeB:G.token_b.address,clmm_pool_id:Ge.clmm_pool_id,amount_a:te.toString(),amount_b:ue.toString(),fix_amount_a:J,tick_lower:ft,tick_upper:yt}):_n=await i.Position.createAddLiquidityFixTokenPayload({coinTypeA:G.token_a.address,coinTypeB:G.token_b.address,pool_id:G.poolAddress,tick_lower:ft<-443636?-443636:ft,tick_upper:yt>443636?443636:yt,fix_amount_a:J,amount_a:te,amount_b:ue,is_open:!ht,pos_id:"",collect_fee:!1,rewarder_coin_types:[],slippage:bt},{slippage:bt,curSqrtPrice:Kt});else{const le=[];vt&&le.push(vt),ut&&le.push(ut),jt&&le.push(jt),_n=await i.Position.createAddLiquidityFixTokenPayload({coinTypeA:G.token_a.address,coinTypeB:G.token_b.address,pool_id:G.poolAddress,tick_lower:ft<-443636?-443636:ft,tick_upper:yt>443636?443636:yt,fix_amount_a:J,amount_a:te,amount_b:ue,is_open:!ht,pos_id:ht,collect_fee:L.collect_fee,rewarder_coin_types:[...le],slippage:bt},{slippage:bt,curSqrtPrice:Kt})}return console.log("0330###sui##getAddLiquidityTransactionPayload###",_n),P(_n)},k=(L,G,Y)=>{const J=We.sqrtPriceX64ToPrice(new _(L.current_sqrt_price),L.coinA.decimals,L.coinB.decimals).toNumber(),ot=Y?J:1/J,ft=Je(ot).minus(Je(G)).div(Je(ot)).mul(100);return ft.gt(100)?100:(console.log(ft.toString(),"1143"),Number(fn(ft.abs().toString(),2)))},U=async L=>{const{pool:G,a2b:Y,byAmountIn:J,amount:ot}=L;console.log("0221###sui###preSwap###",L);const ft=G.coinA.decimals,yt=G.coinB.decimals,ht=G!=null&&G.current_sqrt_price?G:await W(G.address);let bt;Y&&J||!Y&&!J?bt=Nn(ot,ft):bt=Nn(ot,yt);const vt=await i.Swap.preswap({pool:ht,current_sqrt_price:ht.current_sqrt_price,coinTypeA:ht.coinTypeA,coinTypeB:ht.coinTypeB,decimalsA:ft,decimalsB:yt,a2b:Y,byAmountIn:J,amount:bt.toString()});return console.log("0221###sui###preSwap###result###",vt),{...vt,estimatedAmountIn:jo(yn(vt.estimatedAmountIn.toString(),Y?ft:yt),Y?ft:yt),estimatedAmountOut:jo(yn(vt.estimatedAmountOut.toString(),Y?yt:ft),Y?yt:ft),priceImpactPct:fn(vt.priceImpactPct,2)}},D=async L=>{console.log("0412###getSwapTransactionPayload###params###",L);const{pool:G,a2b:Y,byAmountIn:J,amount:ot,slippage:ft}=L,yt=G.poolAddress,ht=G.token_a.decimals,bt=G.token_b.decimals;let vt;Y&&J||!Y&&!J?vt=Nn(ot,ht):vt=Nn(ot,bt);const ut=await i.Swap.preswap({pool:G,current_sqrt_price:G.current_sqrt_price,coinTypeA:G.coinTypeA,coinTypeB:G.coinTypeB,decimalsA:ht,decimalsB:bt,a2b:Y,by_amount_in:J,amount:vt.toString()}),jt=Je(ut.estimatedAmountOut.toString()),Kt=Je(ut.estimatedAmountIn.toString()),Wt=J?jt.sub(jt.mul(ft)):Kt.add(Kt.mul(ft));console.log("0221###sui###swap##params123456###",{pool_id:yt,a2b:ut.aToB,by_amount_in:ut.byAmountIn,amount:ut.amount.toString(),amount_limit:fn(Wt.toString(),0)||"",coinTypeA:G.token_a.address,coinTypeB:G.token_b.address});const Ge=await i.Swap.createSwapTransactionPayload({pool_id:yt,a2b:ut.aToB,by_amount_in:ut.byAmountIn,amount:ut.amount.toString(),amount_limit:fn(Wt.toString(),0)||"",coinTypeA:G.token_a.address,coinTypeB:G.token_b.address});return console.log("0221###sui###swap##tx###",Ge),P(Ge)},z=async(L,G)=>{const Y=new Mo(t);console.log(G,"pools982");const J=Object.values(G).map(ft=>ft.address);return console.log(J,"#poolList"),await Y.Position.getPositionList(L,J)},X=async(L,G,Y,J="")=>{const ot=new Mo(t);return console.log(L.position_manager.positions_handle,J,"===>pool.position_manager.positions_handle, pos"),{...await ot.Position.getPosition(L.position_manager.positions_handle,J),tokenName:Y,collectionName:G}},I=async L=>{const Y=await new Mo(t).Position.getPositionById(L);return console.log("0503###getPositionById###result###",Y),Y},m=async(L,G)=>(console.log(L,G,"getTickDataByIndex"),await i.Pool.getTickDataByIndex(L,G)),M=async L=>{const{pool:G,position:Y,tickLowerData:J,tickUpperData:ot}=L,ft=await W(G.poolAddress),yt=Tk({clmmpool:ft,position:Y,tickLower:J,tickUpper:ot}),ht=yn(yt.feeOwedA.toString(),G.token_a.decimals),bt=yn(yt.feeOwedB.toString(),G.token_b.decimals);return{feeOwedA:Number(ht)>99999999999||Number(ht)<0?"0":ht,feeOwedB:Number(bt)>99999999999||Number(bt)<0?"0":bt}},Tt=async L=>{const{poolAddress:G,pos:Y,positionHandle:J}=L;return await i.Rewarder.posRewardersAmount(G,J,Y)},ct=L=>L.pos_object_id,mt=async L=>{const{pool:G,coinTypeA:Y,coinTypeB:J,coinTypeC:ot,coinTypeD:ft,coinTypeE:yt,position:ht,delta_liquidity:bt,rewards_num:vt,positionInfo:ut}=L;console.log("getRemoveLiquidityTransactionPayload params##",L);const jt=await W(G.poolAddress),Kt={...G,...jt},Wt=Number(ht.tick_lower_index),Ge=Number(ht.tick_upper_index),Vt=We.tickIndexToSqrtPriceX64(Wt),Gt=We.tickIndexToSqrtPriceX64(Ge),On=Ii.getCoinAmountFromLiquidity(bt,new _(Kt.current_sqrt_price),Vt,Gt,!0),te=Je(On.coinA.toString()).mul(Je(1-L.slippage)),ue=Je(On.coinB.toString()).mul(Je(1-L.slippage)),Ye=[Y,J,ot,ft,yt].filter(an=>!!an);let Me;console.log("0331###remove###params###",{coin_types:Ye,min_amount_a:fn(te.toString(),0),min_amount_b:fn(ue.toString(),0),pool_id:G.poolAddress,pos_id:L.position.pos_object_id}),console.log("0331###delta_liquidity.toString()###",bt.toString()),console.log("0331###position.liquidity###",ht.liquidity);const Tn=[];return ot&&Tn.push(ot),ft&&Tn.push(ft),yt&&Tn.push(yt),(ut==null?void 0:ut.positionSource)==="farming"?bt.toString()===ht.liquidity?(console.log({pool_id:ut==null?void 0:ut.pool_id,coinTypeA:Y,coinTypeB:J,position_nft_id:ut==null?void 0:ut.id,clmm_pool_id:ut==null?void 0:ut.clmm_pool_id,min_amount_a:fn(te.toString(),0)||"",min_amount_b:fn(ue.toString(),0)||"",collect_fee:!0,collect_rewarder:!0,clmm_rewarder_types:[...Tn],delta_liquidity:ut==null?void 0:ut.liquidity,unstake:!0,close_position:!0,clmm_position_id:L.position.clmm_position_id},"1191##"),Me=await o.Farms.removeLiquidityPayload({pool_id:ut==null?void 0:ut.pool_id,coinTypeA:Y,coinTypeB:J,position_nft_id:ut==null?void 0:ut.id,clmm_pool_id:ut==null?void 0:ut.clmm_pool_id,min_amount_a:fn(te.toString(),0)||"",min_amount_b:fn(ue.toString(),0)||"",collect_fee:!0,collect_rewarder:!0,clmm_rewarder_types:[...Tn],delta_liquidity:ut==null?void 0:ut.liquidity,unstake:!0,close_position:!0,clmm_position_id:L.position.clmm_position_id}),console.log(Me,"result#####1210")):Me=await o.Farms.removeLiquidityPayload({pool_id:ut==null?void 0:ut.pool_id,coinTypeA:Y,coinTypeB:J,position_nft_id:ut==null?void 0:ut.id,clmm_pool_id:ut==null?void 0:ut.clmm_pool_id,min_amount_a:fn(te.toString(),0)||"",min_amount_b:fn(ue.toString(),0)||"",collect_rewarder:!1,clmm_rewarder_types:[...Tn],delta_liquidity:bt.toString(),unstake:!1,close_position:!1}):bt.toString()===ht.liquidity?Me=await i.Position.closePositionTransactionPayload({coinTypeA:Y,coinTypeB:J,min_amount_a:fn(te.toString(),0)||"",min_amount_b:fn(ue.toString(),0)||"",rewarder_coin_types:[...Tn],pool_id:G.poolAddress,pos_id:L.position.pos_object_id,collect_fee:!0}):(console.log(Tn,"==>rewarder_coin_types"),Me=await i.Position.removeLiquidityTransactionPayload({coinTypeA:Y,coinTypeB:J,delta_liquidity:bt.toString(),min_amount_a:fn(te.toString(),0)||"",min_amount_b:fn(ue.toString(),0)||"",pool_id:G.poolAddress,pos_id:L.position.pos_object_id,collect_fee:!0,rewarder_coin_types:[...Tn]})),console.log("0331###remove###result####",Me),P(Me)},oe=async(L,G)=>{const Y=[];L.coinTypeC&&Y.push(L.coinTypeC),L.coinTypeD&&Y.push(L.coinTypeD),L.coinTypeE&&Y.push(L.coinTypeE),console.log("0423###getCollectRewarderTransactionPayload###params###",{pool_id:L.pool_address,pos_id:L.pos_index,rewarder_coin_types:[...Y],coinTypeA:L.coinTypeA,coinTypeB:L.coinTypeB,collect_fee:!1}),console.log(G,"##getCollectRewarderTransactionPayload");let J;if(G.positionSource=="farming"){const ot={coinTypeA:G.coinTypeA,coinTypeB:G.coinTypeB,clmm_pool_id:G.clmm_pool_id,position_nft_id:G.id,clmm_rewarder_types:Y,collect_fee:!0};J=await o.Farms.claimFeeAndClmmReward(ot)}else J=await i.Rewarder.collectRewarderTransactionPayload({pool_id:L.pool_address,pos_id:L.pos_index,rewarder_coin_types:[...Y],coinTypeA:L.coinTypeA,coinTypeB:L.coinTypeB,collect_fee:L.collect_fee});return P(J)},Qt=async L=>{console.log("1130###getCollectFeeTransactionPayload###params",{pool:L.pool.poolAddress,coinTypeA:L.pool.token_a.address,coinTypeB:L.pool.token_b.address,pos_index:L.position.index});const G=await i.Position.collectFeeTransactionPayload({coinTypeA:L.pool.token_a.address,coinTypeB:L.pool.token_b.address,pool_id:L.pool.poolAddress,pos_id:L.position.pos_object_id});return console.log("1130###getCollectFeeTransactionPayload###result##",G),P(G)},Ie=async()=>await i.Pool.getPoolImmutables(),fe=(L,G)=>!!Ql(ri(L),ri(G)),se=async L=>{const{coinTypeA:G,coinTypeB:Y,decimalsA:J,decimalsB:ot,amountA:ft,amountB:yt,minPrice:ht,maxPrice:bt,fix_amount_a:vt,tick_spacing:ut,slippage:jt,price:Kt}=L;console.log(L,"###getCreatPoolTransactionPayload 1201");const Wt=We.priceToSqrtPriceX64(Je(Kt),J,ot);console.log("0407###getCreatPoolTransactionPayload###currentSqrtPrice###",Wt);const Ge=We.priceToTickIndex(Je(Kt),J,ot);console.log("0407###getCreatPoolTransactionPayload###currentTickIndex###",Ge);let Vt,Gt;if(ht==="0"&&bt==="")Vt=jr.getMinIndex(Number(ut)),Gt=jr.getMaxIndex(Number(ut));else{const Tn=Number(ht)==0?-443636:We.priceToTickIndex(Je(ht),J,ot),an=We.priceToTickIndex(Je(bt),J,ot);Vt=pc(Tn,Number(ut)),Gt=pc(an,Number(ut))}console.log("0407###getCreatPoolTransactionPayload###tick_lower###",Vt),console.log("0407###getCreatPoolTransactionPayload###tick_upper###",Gt);const On=vt?Nn(ft,J):Nn(yt,ot);let te,ue;We.tickIndexToSqrtPriceX64(Vt),We.tickIndexToSqrtPriceX64(Gt);let _n;Ge>=Vt&&Ge<=Gt?(_n=Ii.estLiquidityAndcoinAmountFromOneAmounts(Vt,Gt,new _(On.toString()),vt,!0,jt,Wt),te=vt?On.toString():_n.tokenMaxA.toString(),ue=vt?_n.tokenMaxB.toString():On.toString()):Ge>Gt?(te="0",ue=Je(yt).mul(Je(Math.pow(10,ot))).toString()):Ge<Vt&&(te=Je(ft).mul(Je(Math.pow(10,J))).toString(),ue="0"),Vt<-443636&&(Vt=jr.getMinIndex(Number(ut))),Gt>443636&&(Gt=Vt=jr.getMaxIndex(Number(ut))),console.log("0407####create pool params###",JSON.stringify({tick_spacing:ut,initialize_sqrt_price:Wt.toString(),uri:"",fix_amount_a:vt,amount_a:te,amount_b:ue,tick_lower:Vt,tick_upper:Gt,coinTypeA:G,coinTypeB:Y}));const Ye=await i.Pool.creatPoolTransactionPayload({tick_spacing:ut,initialize_sqrt_price:Wt.toString(),uri:"",fix_amount_a:vt,amount_a:te,amount_b:ue,slippage:jt,tick_lower:Vt,tick_upper:Gt,coinTypeA:G,coinTypeB:Y});console.log("0412####result###",Ye);const Me=await x(Ye);return console.log("0412####simulateRes###",Me),P(Ye)},ae=L=>{const G=L.split("0x");return"0x"+(G[1][0]==="0"?G[1].substring(1):G[1])};return{setTransations:E,showTransitionPending:h,showTransitionSuccess:g,showTransitionError:b,watchTransaction:v,getAccount:S,getTokenList:T,getLpList:K,getPools:V,getPool:W,mintCoin:tt,handleTx:j,TickUtil:jr,TickMath:We,getNearestTickByTick:pc,getTicks:$,getEstPositionAPRWithMulti:q,getCoinAmountFromLiquidity:A,estLiquidityAndcoinAmountFromOneAmounts:f,getAddLiquidityTransactionPayload:y,getTickDataFromUrlData:ok,getPriceImpactPct:k,preSwap:U,getSwapTransactionPayload:D,getPositionList:z,getTickDataByIndex:m,getCollectFeesQuote:M,getPosRewardersAmount:Tt,getNftHash:ct,getPositionInfo:X,getRemoveLiquidityTransactionPayload:mt,getCollectRewarderTransactionPayload:oe,getCollectFeeTransactionPayload:Qt,getPoolImmutables:Ie,estimateLiquidityForCoinA:Vr,estimateLiquidityForCoinB:Jr,getCreatPoolTransactionPayload:se,getTokenListByCoinType:async L=>{const G=localStorage.getItem("coinMatedataLocal"),Y=G?JSON.parse(G):{};try{let J=[];const ot=[];if(L&&typeof L=="string"){if(Y[ae(L)])return[Y[ae(L)]];J=[ae(L)]}else{const bt=[];if(L.forEach(vt=>{Y[ae(vt)]?ot.push(Y[ae(vt)]):bt.push(ae(vt))}),bt.length===0)return ot;J=[...bt]}const ft=await i.CetusConfig.getTokenListByCoinTypes(J);console.log("0714###getTokenListByCoinType###result###",ft);const yt=[],ht={};return Object.values(ft).forEach(bt=>{const vt={...bt,address:ge(bt.address).full_address};yt.push(vt),ht[bt.address]=vt}),console.log("0714###getTokenListByCoinType###formatResult###",yt),localStorage.setItem("coinMatedataLocal",JSON.stringify({...Y,...ht})),[...yt,...ot]}catch{return[]}},getIsSortedSymbols:fe,getPositionById:I,d:Je,getTokenBySymbol:async(L,G)=>{if(!G)return null;let Y=null;console.log("getTokenBySymbol###tokensObj###",L);for(const J in L){const ot=L[J];if(ot.address.toUpperCase()===ge(G).full_address.toUpperCase()){Y=ot;break}}if(!Y){const J=G.split("0x"),ot="0x"+(J[1][0]==="0"?J[1].substring(1):J[1]),ft=await i.CetusConfig.getTokenListByCoinTypes([ot]);ft&&ft[ot]&&(Y={...ft[ot],isSelfBuilt:!0,address:ge(G).full_address})}return Y},preSwapWithMultiPool:async L=>{const{a2b:G,byAmountIn:Y,amount:J,decimalsA:ot,decimalsB:ft}=L;let yt;G&&Y||!G&&!Y?yt=Nn(J,ot):yt=Nn(J,ft);const ht=await i.Swap.preSwapWithMultiPool({poolAddresses:L.poolAddresses,coinTypeA:L.coinTypeA,coinTypeB:L.coinTypeB,a2b:G,byAmountIn:Y,amount:yt});return{...ht,estimatedAmountIn:jo(yn(ht.estimatedAmountIn.toString(),G?ot:ft),G?ot:ft),estimatedAmountOut:jo(yn(ht.estimatedAmountOut.toString(),G?ft:ot),G?ft:ot)}},initSwapRouter:async(L,G)=>{console.log(L,"===>paths"),console.log(G,"===>coins"),i.Router.loadGraph(G,L),console.log(i,"sdk===>1826")},getSwapRouter:async(L,G,Y,J,ot,ft="",yt,ht)=>{const bt=L.value.decimals,vt=G.value.decimals,ut=localStorage.getItem("swapOrderSplit"),jt=localStorage.getItem("includeRoutes"),Kt=ut=="open"||!ut,Wt=jt=="open";let Ge;try{return Ge=await i.RouterV2.getBestRouter(L.value.address,G.value.address,Y,J,ot,ft,i.senderAddress,yt,Kt,Wt,ht),{amountIn:yn(Ge.result.inputAmount.toString(),bt),amountOut:yn(Ge.result.outputAmount.toString(),vt),...Ge.result}}catch(Vt){console.log(Vt)}},getSwapRouterPayload:async(L,G)=>{const Y=new Mo(t);Y.senderAddress=r.value.address,console.log(L,"===>createTxParams");const J=await Y.getOwnerCoinAssets((Y==null?void 0:Y.senderAddress)||r.value.address);console.log(J,"===>allCoinAsset");const ot=await $n.buildAggregatorSwapTransaction(Y,L,J,"",G);return P(ot)},fetchPosRewardersAmount:async L=>{const G=await i.Rewarder.fetchPosRewardersAmount([L]),Y=G&&G[0];return Y&&Y.rewarderAmountOwed},estCoinAmountsFromTotalAmount:L=>{const{lowerTick:G,upperTick:Y,decimalsA:J,decimalsB:ot,curSqrtPrice:ft,totalAmount:yt,tokenPriceA:ht,tokenPriceB:bt}=L;console.log(JSON.stringify({...L,curSqrtPrice:ft.toString()}),"params===>");const vt=Ii.estCoinAmountsFromTotalAmount(G,Y,ft,yt,ht,bt);console.log("coinAmounts: ",vt);const ut=Rc(vt.amountA.toFixed(J,it.ROUND_UP).toString(),J),jt=Rc(vt.amountB.toFixed(ot,it.ROUND_UP).toString(),ot),Kt={coinA:new _(ut),coinB:new _(jt)};return{amountA:yn(ut.toString(),J),amountB:yn(jt.toString(),ot),tokenAmountsInfo:Kt}},getCreateAddLiquidityPayload:async L=>{const{curSqrtPrice:G,tickLower:Y,tickUpper:J,tokenAmounts:ot,pool:ft,slippage:yt}=L;console.log(JSON.stringify(L),"####getCreateAddLiquidityPayload 1593");const ht=Ii.estimateLiquidityFromcoinAmounts(G,Y,J,ot),bt=new it(ot.coinA.toString()).mul(1+yt),vt=new it(ot.coinB.toString()).mul(1+yt),ut={coinTypeA:ft.coinTypeA,coinTypeB:ft.coinTypeB,pool_id:ft.address,tick_lower:Y,tick_upper:J,delta_liquidity:ht.toString(),max_amount_a:it.ceil(bt).toString(),max_amount_b:it.ceil(vt).toString(),pos_id:"",rewarder_coin_types:[],collect_fee:!1};console.log(JSON.stringify(ut),"==>addLiquidityPayloadParams");const jt=await i.Position.createAddLiquidityPayload(ut);return P(jt)},calculateDepositRatioFixTokenA:(L,G,Y)=>Ii.calculateDepositRatioFixTokenA(L,G,Y),signAndExecuteTransactionBlock:async(L,G)=>{var J;console.log("0319 signAndExecuteTransactionBlock###wallet###",L),console.log("0319 signAndExecuteTransactionBlock###payload###",G),console.log("0319 signAndExecuteTransactionBlock###sdk.senderAddress###",i.senderAddress);let Y;try{G.transactionBlock.setSender(i.senderAddress),console.log("0321 signAndExecuteTransactionBlock start build: ",new Date().getTime());const ft=await G.transactionBlock.build({client:i.fullClient});console.log("0321 signAndExecuteTransactionBlock buildTxb: ",ft),Y=_t.from(ft),console.log("0321 signAndExecuteTransactionBlock start end: ",new Date().getTime())}catch(ot){console.log("0319 signAndExecuteTransactionBlock error: ",ot)}if(console.log("0319 signAndExecuteTransactionBlock wallet.getState(): ",L.getState()),console.log("0319 signAndExecuteTransactionBlock wallet?.name: ",L==null?void 0:L.name),console.log("0319 signAndExecuteTransactionBlock wallet: ",L),(L==null?void 0:L.name)==="MSafe Wallet"||l.value==="MSafe Wallet"){console.log("signAndExecuteTransactionBlock MSafe Wallet Start");const ot=(J=L.getState())==null?void 0:J.currentAccount;console.log("signAndExecuteTransactionBlock MSafe Wallet account: ",ot);const ft=G.transactionBlock;return ft.setSender(i.senderAddress),console.log("signAndExecuteTransactionBlock MSafe Wallet txb: ",ft),await L.signAndExecuteTransactionBlock({transactionBlock:ft,account:ot,chain:"sui:mainnet"})}else return await L.signAndExecuteTransactionBlock({transactionBlock:Y||G.transactionBlock})},getAllPosition:async(L,G=[])=>{const Y=await i.fullClient.getOwnedObjects({owner:L,options:{showType:!0,showContent:!0,showOwner:!0,showDisplay:!0},filter:{MatchAny:[{Package:i.sdkOptions.clmm_pool.package_id},{StructType:`${Ut[e||"Sui"].frams.package_id}::pool::WrappedPositionNFT`}]}}),J=()=>`${i.sdkOptions.clmm_pool.package_id}::position::Position`,ot=()=>`${Ut[e||"Sui"].frams.package_id}::pool::WrappedPositionNFT`,ft=[],yt=[],ht=G.length>0;for(const bt of Y.data){const vt=ge(bt.data.type);if(vt.full_address===J()){const ut=_c(bt);ht?G.includes(ut.pool)&&ft.push(ut):ft.push(ut)}if(vt.full_address===ot()){const ut=Ys.buildFramsPositionNFT(bt);ht?G.includes(ut.clmm_pool_id)&&yt.push(ut):yt.push(ut)}}return console.log("farmsPosition",yt),{clmmPosition:ft,farmsPosition:yt}},getFullClient:()=>i.fullClient}}function wi(e){let t={};return!e||e==="Aptos"?t=q2():t=NS(e),{...t}}const lo="0x26b3bc67befc214058ca78ea9a2690298d731a2d4309485ec3d40198063c4abc",FS=[{base_symbol:`${lo}::btc::BTC`,price:"175181.584616",quote_symbol:"USD"},{base_symbol:`${lo}::eth::ETH`,price:"1471.343485",quote_symbol:"USD"},{base_symbol:`${lo}::usdc::USDC`,price:"0.998772",quote_symbol:"USD"},{base_symbol:`${lo}::usdt::USDT`,price:"0.949513",quote_symbol:"USD"},{base_symbol:`${lo}::busd::BUSD`,price:"1",quote_symbol:"USD"},{base_symbol:"0x2::sui::SUI",price:"1",quote_symbol:"USD"}],OP=[{symbol:"USDT",name:"CetusUSDT",num:"200",amount:"200000000",transactionModule:"usdt",address:`${lo}::usdt::USDT`,suplyID:"0x0a842204e4a64afe0da14749443754714343d1d9d246d71080bde331fc22de55",decimals:6},{symbol:"USDC",name:"CetusUSDC",num:"200",amount:"200000000",transactionModule:"usdc",address:`${lo}::usdc::USDC`,suplyID:"0xdf6cb5a605e6f91120ac2fe925b897ca44a393b53ad33d52634263774adc9db3",decimals:6},{symbol:"ETH",name:"CetusETH",num:"0.1",amount:"100000000",transactionModule:"eth",address:`${lo}::eth::ETH`,suplyID:"0x093839657619586c99aa4ab883df94919be0a03eff6ee8206c0d546b2853e158",decimals:8},{symbol:"BTC",name:"CetusBTC",num:"0.01",amount:"10000000",transactionModule:"btc",address:`${lo}::btc::BTC`,suplyID:"0x9742b5d1812263e1d9fea29467c39cf860ad1aed0993867485aa1c04c720f670",decimals:8}];it.config({precision:64,rounding:it.ROUND_DOWN,toExpNeg:-64,toExpPos:64});function Uf(e){const t={launchpad:Ut[e||"Sui"].launchpad,ido:Ut[e||"Sui"].ido,xcetus:Ut[e||"Sui"].xcetus,xcetus_dividends:Ut[e||"Sui"].xcetus_dividends,cetus_faucet:Ut[e||"Sui"].cetus_faucet,xtoken:Ut[e||"Sui"].xtoken,xtoken_dividends:Ut[e||"Sui"].xtoken_dividends,token_faucet:Ut[e||"Sui"].token_faucet,booster:Ut[e||"Sui"].booster,maker_bonus:Ut[e||"Sui"].maker_bonus,liquidity_stratefy:Ut[e||"Sui"].liquidity_stratefy,vaults:Ut[e||"Sui"].vaults,frams:Ut[e||"Sui"].frams},n={fullRpcUrl:localStorage.getItem(`${e}-currentRpclocal2`)||Ut[e||"Sui"].fullRpcUrl,simulationAccount:Ut[e||"Sui"].simulationAccount,cetus_config:Ut[e||"Sui"].cetus_config,clmm_pool:Ut[e||"Sui"].clmm_pool,integrate:Ut[e||"Sui"].integrate,deepbook:Ut[e||"Sui"].deepbook,deepbook_endpoint_v2:Ut[e||"Sui"].deepbook_endpoint_v2,aggregatorUrl:Ut[e||"Sui"].aggregatorUrl},i=new Hk(n),o=new xm(t,i),s=id(),r=es(()=>s);Mf(()=>{r.value.address&&(i.senderAddress=r.value.address)});const a=E=>({transactionBlock:E,options:{showEffects:!0,showEvents:!0,showInput:!0,showRawInput:!0,showObjectChanges:!0,showBalanceChanges:!0}}),c=async()=>{const E=await o.Farms.getFramsPoolList();return console.log(E.data,"##poolData.data"),E.data},u=async(E,S)=>{const T=await o.Farms.getOwnedFramsPositionNFTList(o.ClmmSDK.senderAddress,E,S);return T&&!P2(T)?T.data?T.data:Object.values(T)[0]:[]},l=async(E,S)=>{console.log(E,S,"farmsDeposit##");const T=await o.Farms.depositPayload({pool_id:S,clmm_position_id:E.clmm_position_id});return a(T)},d=async(E,S)=>{console.log(E,S,"####positionNftId");const T=await o.Farms.withdrawPayload({pool_id:E,position_nft_id:S});return a(T)},h=async E=>await o.Farms.calculateFarmingRewards(E,!1),g=async E=>{const S=await o.Farms.harvestPayload(E);return a(S)},b=async E=>{console.log(E,"##batchHarvest");const S=await o.Farms.batchHarvestPayload(E);return a(S)},v=(E,S,T)=>{const R=E.tick_lower_index,K=E.tick_upper_index,{liquidity:V}=E,{price:W,effective_tick_lower:tt,effective_tick_upper:j,total_wrapped_amount:$}=S;console.log(S,"farmPoolInfo##");const q=Ys.calculatePositionShare(R,K,V,W,tt,j,T);return new it(q).div(new it($)).mul(100).toString()};return console.log(i,"###clmmSdk"),{getFramsPoolList:c,getOwnedFramsPositionNFTList:u,farmsDeposit:l,farmsWithdraw:d,calculateFarmingRewards:h,harvestFarms:g,batchHarvest:b,calculatePositionShare:v,fetchPosFeeAmount:async E=>{const S=await i.Position.fetchPosFeeAmount(E);return console.log("fetchPosFeeAmount:",S),[{feeOwedA:new it(S[0].feeOwedA.toString()).div(Math.pow(10,E[0].decimalA)).toString(),feeOwedB:new it(S[0].feeOwedB.toString()).div(Math.pow(10,E[0].decimalB)).toString()}]},getFramsPositionNFT:async E=>await o.Farms.getFramsPositionNFT(E,!0)}}const jS=Cm("pool",{state:()=>({tokens:[],tokensObj:{},pools:[],poolsObj:{},myPositions:[],addressLpTokens:{},addressTokens:{},currentPositionLoading:!1,myPositionsLoading:!0,poolsLoading:!0,RATES:{},currentPositionInfo:{},poolConfigList:[],feeOwedObj:{},rewarderObj:{},chinaTokens:[],chinaTokensObj:{},getPoolInfoSuccess:!1,recommendRangesObj:{},allTokenObj:{},isTokenLoading:!0,poolPriceConfigObj:{},defaultPoolInfo:{},poolConfigObj:{},openPool:[],routerPoolConfigObj:{},tokensWarningObj:{},currentChain:"",liquidityCurrentPoolInfo:{},positionDetailCurrentTab:"increase",positionActionAmount:{fromCoinAmount:"",toCoinAmount:""},currentPoolTab:"All",currentPoolMoreInfo:{},poolPositions:[],autoPoolNum:"--",tokenExternalPriceObj:{}}),actions:{async setLiquidityCurrentPoolInfo(e){this.liquidityCurrentPoolInfo=e},async setCurrentPoolMoreInfo(e){this.currentPoolMoreInfo=e},async setChainPoolConfigList(e){this.poolConfigList=e,this.pools=e},async setCurrentPoolTab(e){this.currentPoolTab=e},async setPoolConfigList(e,t){const i=await wi(e).getLpList(t),o=[],s=[],r=[];i.forEach(c=>{var l,d,h;const u={...c,token_a:{...c==null?void 0:c.coinA,logoURI:(l=c==null?void 0:c.coinA)==null?void 0:l.logo_url},token_b:{...c==null?void 0:c.coinB,logoURI:(d=c==null?void 0:c.coinB)==null?void 0:d.logo_url},isFarming:c.is_display_rewarder&&(c.rewarder_display1||c.rewarder_display2||c.rewarder_display3),chain:e==="Aptos"?"aptos":"sui",fee_rate:c.fee*1e4,routerSymbol:[c.coin_a_address,c.coin_b_address].sort(function(g,b){return b.localeCompare(g)}).join("-")};c.is_closed||o.push(u),e=="Sui"&&!((h=c.object)!=null&&h.is_pause)&&s.push(u),r.push(u)}),console.log("0509###setPoolConfigList###",s),this.poolConfigList=e=="Aptos"?o:s,this.poolConfigObj=e=="Aptos"?Object.fromEntries(o.map((c,u)=>[c.address,c])):Object.fromEntries(s.map((c,u)=>[c.address,c]));const a=r.filter(c=>!c.is_pause);this.openPool=a,this.routerPoolConfigObj=Object.fromEntries(a.map((c,u)=>[c.address,c]))},async getRecommendRanges(e){var n;let t=null;if(e&&e.includes("Sui")?t=await $fetch(`${Ut[e].api}/v2/sui/liquidity/recommend_ranges`):t=await $fetch(`${Ut.Aptos.api}/v2/liquidity/recommend_ranges`),(n=t==null?void 0:t.data)!=null&&n.list){const i=Object.fromEntries(t.data.list.map((o,s)=>[o.address,o]));this.recommendRangesObj=i,this.poolPriceConfigObj=i}else this.recommendRangesObj={},this.poolPriceConfigObj={}},async setPools(e,t){this.poolsLoading=!0,this.getPoolInfoSuccess=!1,this.poolsObj={},this.currentChain=t;const n=wi(t);if((t==null?void 0:t.toLowerCase())==="aptos"){if(e&&e.length>0){for(let i=0;i<e.length&&t===this.currentChain;i++){const o=e[i],s=await n.getPools([o.address]);this.defaultPoolInfo[s[0].poolAddress]=s[0],this.poolsObj[s[0].poolAddress]={...o,...s[0],fee:Number(s[0].fee_rate)/1e6},this.addressLpTokens=this.poolsObj,this.poolsLoading=!1,await Xs(500)}this.getPoolInfoSuccess=!0}}else if(e&&e.length>0){const i=await n.getPools([]),o={};for(let s=0;s<e.length;s++){const r=e[s];console.log(r,"==>data");const a=i[r.address];a?o[r.address]={...r,...a,fee:Number(a==null?void 0:a.fee_rate)/1e6}:o[r.address]={...r}}console.log("0605###setPools###result###",o),this.poolsObj=o,this.addressLpTokens=o,this.poolsLoading=!1,this.getPoolInfoSuccess=!0}},async setSinglePool(e,t,n){const o=await wi(n).getPool(e.address);console.log(t,"recommendRangesInfo");const s={...e,...o,fee:o.fee_rate/1e6,type:(t==null?void 0:t.type)||""};console.log("0506###setSinglePool###result###",s),this.poolsObj[e.address]=s,console.log(this.poolsObj,"===>173"),this.addressLpTokens[e.address]=s},async updateCurrentPools(e,t){const n=wi(t),i=this.poolsObj[e];if(console.log(i,"===>currentPool"),i){let o={};t&&t.includes("Sui")?o=await n.getPool((i==null?void 0:i.poolAddress)||(i==null?void 0:i.address)):o=await n.getPoolState(i.poolAddress,i.poolType,!1),console.log("0411###debug###newInfo####",o);const s={...this.poolsObj},r={...s[e],...o};console.log("0411###debug###newCurrentInfo####",r),s[e]={...r},console.log("0411###debug###newPoolsObj####",s),this.poolsObj=s}},async setTokens(e){const t=[];console.log("0613###setTokens####111111###",e);const n=wi(e);console.log("0613###setTokens####22222###contract###",n);const i=await n.getTokenList();console.log("0613###setTokens####22222###res###",i),i.forEach(s=>{t.push({...s,logoURI:s.logo_url,chain:e.toLowerCase()})}),console.log(t,"result===>237"),this.tokens=t;const o=Object.fromEntries(t.map((s,r)=>[s.address,s]));o["0x2::sui::SUI"]&&!o["0x0000000000000000000000000000000000000000000000000000000000000002::sui::SUI"]&&(o["0x0000000000000000000000000000000000000000000000000000000000000002::sui::SUI"]=o["0x2::sui::SUI"]),this.tokensObj=o,this.tokensWarningObj={"0x0000000000000000000000000000000000000000000000000000000000000002::sui::SUI":{},...Object.fromEntries(t.map((s,r)=>[s.address,s]))},this.isTokenLoading=!1,console.log(this.tokensWarningObj,"===>this.tokensWarningObj ")},async setChinaTokens(e){const n=await wi(e).getTokenListByCoinType();console.log(n,"chinares===>");const i=[];n.forEach(o=>{i.push({...o,logoURI:e=="Aptos"?"https://archive.cetus.zone/assets/image/default1.png":"https://archive.cetus.zone/assets/image/default2.png",logo_url:e=="Aptos"?"https://archive.cetus.zone/assets/image/default1.png":"https://archive.cetus.zone/assets/image/default2.png"})}),this.chinaTokens=i,this.chinaTokensObj=Object.fromEntries(i.map((o,s)=>[o.address,o]))},setCurrentPositionLoading(e){this.currentPositionLoading=e},setMyPositionsLoading(e){this.myPositionsLoading=e},async setRates(e){let t={};if(e&&e.includes("Sui"))try{t=await $fetch(`${Ut.Sui.api}/v2/sui/price`)}catch(o){console.log("sui pric api error ###",o),t={data:{prices:FS}}}else t=await $fetch(`${Ut.Aptos.api}/v2/price`);const n=t.data.prices||[],i=[];n.forEach(o=>{o.base_symbol=="0x0000000000000000000000000000000000000000000000000000000000000002::sui::SUI"?i.push({...o},{...o,base_symbol:"0x2::sui::SUI"}):i.push(o)}),this.RATES=Object.fromEntries(i.map(o=>[o.base_symbol,o])),console.log(this.RATES,"===>this.RATES")},async getMyPositons(e,t,n){console.log("0507###getMyPositons###start###",t),this.setMyPositionsLoading(!0);const i=wi(n);let o=[],s=[];if(n=="Sui"){const{clmmPosition:l,farmsPosition:d}=await i.getAllPosition(e,t);o=l,s=d}else o=await i.getPositionList(e,t)||[];let r=[];n=="Sui"&&(r=s.map(l=>{const d=[];let h=new it(0);return l.rewards.forEach(g=>{var S;const b=g.rewarder_type=="0x0000000000000000000000000000000000000000000000000000000000000002::sui::SUI"?"0x2::sui::SUI":g.rewarder_type,v=this.tokensObj[b],x=((S=this.RATES[b])==null?void 0:S.price)||0,P=new it(g.rewarder_amount).div(new it(Math.pow(10,v.decimals))),E=P.mul(new it(x));h=h.add(E),P.toNumber()>0&&d.push({...g,amount:P,rewarderAmountUsd:E.toString(),address:b,symbol:v.symbol})}),{...l,rewards:d,farmingRewardTotalUsd:h.toNumber()}}),console.log("farmingPositionList:",r)),console.log("0507###getMyPositons###positionList###",o),o.length<1&&this.setMyPositionsLoading(!1);const a=r.concat(o);console.log(a,"##allPositionList");const c=[];a.forEach(l=>{var R,K,V,W;const d=t[l.pool||l.clmm_pool_id];let h,g,b,v,x="",P,E,S,T;if(console.log("allPositionList item:",l),l.liquidity&&l.liquidity!=="0"&&d){const tt={creator:l.creator,collection:l.collection,name:l.name};n==="Aptos"?T=i.getNftHash(tt):T=i.getNftHash(l);const j=d.token_a.decimals,$=d.token_b.decimals;console.log(d,"poolInf=====>"),d!=null&&d.current_sqrt_price&&(b=i.TickMath.sqrtPriceX64ToPrice(d==null?void 0:d.current_sqrt_price,j,$).toString(),v=new it(1).div(i.TickMath.sqrtPriceX64ToPrice(d==null?void 0:d.current_sqrt_price,j,$)).toString()),l.tick_lower_index==i.TickUtil.getMinIndex(Number(d.tickSpacing))?h="0":h=i.TickMath.tickIndexToPrice(Number(l.tick_lower_index),j,$).toString(),l.tick_upper_index==i.TickUtil.getMaxIndex(Number(d.tickSpacing))?g="":(g=i.TickMath.tickIndexToPrice(Number(l.tick_upper_index),j,$).toString(),console.log("0523###maxPrice###2222###",g));const q=d.needReverse?((K=this.tokensObj[d.coinB.address])==null?void 0:K.labels)||[]:((R=this.tokensObj[d.coinA.address])==null?void 0:R.labels)||[],A=d.needReverse?((V=this.tokensObj[d.coinA.address])==null?void 0:V.labels)||[]:((W=this.tokensObj[d.coinB.address])==null?void 0:W.labels)||[],f=[...new Set(q.concat(A))],y=i.getCoinAmountFromLiquidity({pool:d,position:l,roundUp:n!="Sui"}),k=y.coinaAmount,U=y.coinbAmount;console.log(b,"===>currentPrice");const D=Number(U)+Number(k)*Number(b);let z=(Number(k)*Number(b)/D*100).toFixed(0),X=(U/D*100).toFixed(0);h=="0"&&g==""&&(z="50",X="50"),d.isPause?x="Closed":Number(b)>=Number(h)&&(g===""||Number(b)<=Number(g))?x="Active":(Number(b)>Number(g)||Number(b)<Number(h))&&(x="Inactive"),console.log("0323###this.tokensObj####",this.tokensObj),console.log("0323###this.tokensObj[poolInfo.token_a.address]####",this.tokensObj[d.token_a.address]),console.log("0323###poolInfo.token_a.address####",d.token_a.address),console.log("0323###poolInfo.token_b.address####",d.token_b.address);let I={},m={};n==="Aptos"?(I={...d.token_a,...this.tokensObj[d.token_a.address],logoURI:this.tokensObj[d.token_a.address].logo_url},m={...d.token_b,...this.tokensObj[d.token_b.address],logoURI:this.tokensObj[d.token_b.address].logo_url}):(I=d==null?void 0:d.token_a,m=d==null?void 0:d.token_b),c.push({...d,...l,labels:f,totalAmount:D,token_a:I,token_b:m,tokenARates:P,tokenBRates:E,amountA:k,amountB:U,fromPercent:z,toPercent:X,amountUSD:S,tokenName:l.tokenName||l.name,currentStatus:x,positionLiquidity:l.liquidity,nftHash:T,currentPrice:b,currentPriceReverse:v,minPrice:eo(h,12),maxPrice:eo(g,12),positionSource:l.id?"farming":"clmm",farmingRewardTotalUsd:l.id?l.farmingRewardTotalUsd:0})}});const u=c.sort((l,d)=>d.amountUSD-l.amountUSD);this.myPositions=u,this.setMyPositionsLoading(!1),this.getPendingFees(u,n),this.getRewarderV2(u,n),console.log(u,"===>this.myPositions")},async setCurrentPositionInfo(e,t,n,i,o="",s=""){var g,b,v,x,P,E;const r=wi(i);let a;i=="Sui"&&(a=Uf(i));let c=null,u=null,l=null,d=null,h=null;if(e&&o||i==="Aptos"?(c=this.addressLpTokens&&this.addressLpTokens[e],u=await r.getPool(e),h=this.poolConfigObj[e],console.log(h,"===>poolConfig"),l={...c,...u,...h},console.log(l,"423"),d=await r.getPositionInfo(l,t,n,o)):i!=="Aptos"&&(console.log("0414###setCurrentPositionInfo###",o),d=s=="farming"?await a.getFramsPositionNFT(o):await r.getPositionById(o),console.log(d,"setCurrentPositionInfo:positionInfo"),u=s=="farming"?await r.getPool(d.clmm_pool_id):await r.getPool(d.pool),c=this.addressLpTokens&&this.addressLpTokens[d.pool||this.addressLpTokens.poolAddress],h=this.poolConfigObj[d.clmm_pool_id||d.pool],console.log(this.poolConfigObj[d.clmm_pool_id],"##this.poolConfigObj[poolAddress]"),l={...c,...u,...h},console.log("poolInfoNew:",c,u),console.log("0414###setCurrentPositionInfo###positionInfo###",d),console.log("0414###setCurrentPositionInfo###poolInfo###",l)),console.log("setCurrentPositionInfo:",l),d&&l){let S,T,R,K,V="",W,tt,j,$,q,A=0,f=0,y;const k={creator:d.pool,collection:d.collectionName,name:d.name};i==="Aptos"?y=r.getNftHash(k):y=r.getNftHash(d),console.log("0329###setCurrentPositionInfo###poolInfo###",l),console.log("0329###setCurrentPositionInfo###positionInfo###",d);let U=0,D=0;if(l!=null&&l.token_a&&(l!=null&&l.token_b))U=(g=l==null?void 0:l.token_a)==null?void 0:g.decimals,D=(b=l==null?void 0:l.token_b)==null?void 0:b.decimals;else{const z=(await r.getTokenListByCoinType(l==null?void 0:l.coinTypeA))[0],X=(await r.getTokenListByCoinType(l==null?void 0:l.coinTypeB))[0];U=z==null?void 0:z.decimals,D=X==null?void 0:X.decimals,l.coinA=z,l.coinB=X,l.token_a=z,l.token_b=X}if(console.log("fee"),l){try{let mt;if(s!=="farming"){const oe=await r.getTickDataByIndex(l.ticks_handle,Number(d.tick_lower_index)),Qt=await r.getTickDataByIndex(l.ticks_handle,Number(d.tick_upper_index));mt=await r.getCollectFeesQuote({pool:l,position:d,tickLowerData:oe,tickUpperData:Qt})}else{console.log(l,l.token_a,"setCurrentPositionInfo:poolInfo");const oe=[{poolAddress:l.poolAddress,positionId:d.clmm_position_id,coinTypeA:l.coinTypeA,coinTypeB:l.coinTypeB,decimalA:l.token_a.decimals,decimalB:l.token_b.decimals}];console.log(oe,"params###");const Qt=await a.fetchPosFeeAmount(oe);console.log(Qt,"##farmingPositionFee"),mt=Qt[0]}console.log(mt,"setCurrentPositionInfo feeOwn:"),mt&&(A=Number(mt.feeOwedA),f=Number(mt.feeOwedB))}catch(mt){console.log("0314###getCollectFeesQuote###error####",mt)}console.log("0413####setCurrentPositionInfo###poolInfo###",l),R=r.TickMath.sqrtPriceX64ToPrice(l.current_sqrt_price,U,D).toString(),K=new it(1).div(r.TickMath.sqrtPriceX64ToPrice(l==null?void 0:l.current_sqrt_price,U,D)).toString(),d.tick_lower_index==r.TickUtil.getMinIndex(Number(l.tickSpacing))?S="0":S=r.TickMath.tickIndexToPrice(Number(d.tick_lower_index),U,D).toString(),d.tick_upper_index==r.TickUtil.getMaxIndex(Number(l.tickSpacing))?T="":T=r.TickMath.tickIndexToPrice(Number(d.tick_upper_index),U,D).toString(),W=d.tick_lower_index,tt=d.tick_upper_index;const z=r.getCoinAmountFromLiquidity({pool:l,position:d,roundUp:i!="Sui"});let X,I,m;console.log(R,"===>currentPrice522"),R&&R>0&&($=z==null?void 0:z.coinaAmount,q=z==null?void 0:z.coinbAmount,console.log(z,"===>amountInfo"),console.log(R,"===>currentPrice"),m=Number(q)+Number($)*Number(R),console.log(m,"===>totalAmount"),X=(Number($)*Number(R)/m*100).toFixed(0),console.log(X,"===>fromPercent"),I=(Number(q/Number(m))*100).toFixed(0),console.log(I,"==>toPercent"));let M;const Tt=z.coinaAmount*((v=this.RATES[l==null?void 0:l.token_a.address])==null?void 0:v.price),ct=z.coinbAmount*((x=this.RATES[l==null?void 0:l.token_b.address])==null?void 0:x.price);(P=this.RATES[l==null?void 0:l.token_a.address])!=null&&P.price&&((E=this.RATES[l==null?void 0:l.token_b.address])!=null&&E.price)&&(M=Tt+ct),console.log(M,"==>totalAmountUSD"),l.isPause?V="Closed":Number(R)>=Number(S)&&(T===""||Number(R)<=Number(T))?V="Active":(Number(R)>Number(T)||Number(R)<Number(S))&&(V="Inactive"),this.currentPositionInfo={...d,poolInfo:l,token_a:{...l.token_a,...this.tokensObj[l.token_a.address]},token_b:{...l.token_b,...this.tokensObj[l.token_b.address]},current_tick_index:l.current_tick_index,current_sqrt_price:l.current_sqrt_price,tickSpacing:l.tickSpacing,fee:l.fee,poolAddress:l.poolAddress,address:l.address,is_display_rewarder:l.is_display_rewarder,nftHash:y,feeOwedA:A,feeOwedB:f,currentStatus:V,amountA:$,amountB:q,tokenARates:Tt,tokenBRates:ct,amountUSD:j,totalAmount:m,totalAmountUSD:M,currentPrice:R,currentPriceReverse:K,minPrice:eo(S,12),minTick:W,maxTick:tt,maxPrice:eo(T,12),fromPercent:X||"--",toPercent:I||"--",tokenName:d.tokenName||d.name,positionSource:d.id?"farming":"clmm"},this.currentPositionLoading=!1,console.log("positionInfo.value",this.currentPositionInfo)}}},async getPendingFees(e,t){var s,r;const n=this.RATES,i=wi(t);let o;t=="Sui"&&(o=Uf("Sui")),console.log("0302###getPendingFees####result###",e);for(let a=0;a<e.length;a++){const c=e[a],u=await i.getPool(c.poolAddress),l={...u,token_a:(c==null?void 0:c.token_a)||this.tokensObj&&this.tokensObj[u.coinTypeA]||this.chinaTokensObj&&this.chinaTokensObj[u.coinTypeA],token_b:(c==null?void 0:c.token_b)||this.tokensObj&&this.tokensObj[u.coinTypeB]||this.chinaTokensObj&&this.chinaTokensObj[u.coinTypeB]};let d;if(e[a].positionSource=="farming"){console.log("result[i]:",e[a]);const S=[{poolAddress:c.poolAddress,positionId:c.clmm_position_id,coinTypeA:c.coinTypeA,coinTypeB:c.coinTypeB,decimalA:c.token_a.decimals,decimalB:c.token_b.decimals}],T=await o.fetchPosFeeAmount(S);console.log(T,"##farmingPositionFee"),d=T[0]}else if(u){const S=await i.getTickDataByIndex(u.ticks_handle,Number(c.tick_lower_index)),T=await i.getTickDataByIndex(u.ticks_handle,Number(c.tick_upper_index));console.log("0323####getPendingFees###pool###",u),console.log("0323####getPendingFees###positionItem.collection###",c.collection),console.log("0323####getPendingFees###positionItem.tokenName###",c.tokenName),console.log("0323####getPendingFees###positionItem###",c);const R=t==="Aptos"?"":c.pos_object_id,K=await i.getPositionInfo(u,c.collection,c.tokenName,R);console.log("0302###positionInfo",K),console.log("0302###resultPool###",l),console.log(u,"pool====>654"),d=await i.getCollectFeesQuote({pool:l,position:K,tickLowerData:S,tickUpperData:T})}console.log("0330###getPendingFees###feeOwn###",d);const h=[],g=Number(d.feeOwedA),b=Number(d.feeOwedB);let v,x,P;n&&n[l.token_a.address]&&n[l.token_b.address]?(x=g*((s=n[l.token_a.address])==null?void 0:s.price),P=b*((r=n[l.token_b.address])==null?void 0:r.price),v=x+P):v="--",h.push({amount:g,amountUSD:x,...l.token_a,logoURI:l.token_a.logo_url},{amount:b,amountUSD:P,...l.token_b,logoURI:l.token_b.logo_url});const E=this.poolConfigObj&&this.poolConfigObj[u.poolAddress];console.log(E,"poolConfigInfo===>710"),this.feeOwedObj[c.tokenName]={feesResult:E.needReverse?h.reverse():h,feeOwed:v},console.log(this.feeOwedObj,"===>this.feeOwedObj"),await Xs(1e3)}},async getRewarder(e,t){const n=wi(t),i=this;console.log(e,"===>results");for(let o=0;o<e.length;o++)if(e[o].rewarder_infos&&e[o].rewarder_infos.length>0){const s=e[o];console.log(o,"i===>"),console.log(s,"===>positionItem"),console.log(s.ticks_handle,"===>positionItem.ticks_handle"),console.log(s.tick_lower_index,"===>positionItem.tick_lower_index"),console.log(s.tick_upper_index,"===>positionItem.tick_upper_index");const r=await n.getTickDataByIndex(s.ticks_handle,Number(s.tick_lower_index)),a=await n.getTickDataByIndex(s.ticks_handle,Number(s.tick_upper_index));let c=[];t==="Aptos"?c=await n.getPosRewardersAmount({poolAddress:s.poolAddress,positionName:s.tokenName,tickLowerData:r,tickUpperData:a}):c=await n.getPosRewardersAmount({poolAddress:s.poolAddress,pos:s.pos_object_id,positionHandle:s.position_manager.positions_handle}),console.log(c,"rewarderInfo===>");const u=[];let l=0;c.forEach((d,h)=>{var x;const g=i.tokensObj[d.coin_address].decimals,b=d.amount_owed.toString(),v=fn(new it(b).div(Math.pow(10,g)).toString(),g);if(s[`rewarder_display${h+1}`]||Number(v)>0){const P=i.tokensObj[d.coin_address];console.log(d.amount_owed.toString(),"===>element.amount_owed.toString()");const E=(x=i.RATES[d.coin_address])==null?void 0:x.price;console.log(E,"price===>"),console.log(v,"==>amount");const S=Number(v)*E;l+=S,u.push({...d,...P,amount:v,amountUSD:S,amount_owed:d.amount_owed.toString()}),i.rewarderObj[s.tokenName]={pendingRewarderArr:u,pendingRewarderView:Number(fn(l,2)),pendingRewarder:l}}}),console.log(i.rewarderObj,"===>_this.rewarderObj"),await Xs(1e3)}},async getRewarderV2(e,t){const n=wi(t),i=this;console.log(e,"===>results");for(let o=0;o<e.length;o++){const s=e[o];if(e[o].rewarder_infos&&e[o].rewarder_infos.length>0){console.log(s,"===>positionItem");const r=await n.getTickDataByIndex(s.ticks_handle,Number(s.tick_lower_index)),a=await n.getTickDataByIndex(s.ticks_handle,Number(s.tick_upper_index));let c=[];t==="Aptos"?c=await n.getPosRewardersAmount({poolAddress:s.poolAddress,positionName:s.tokenName,tickLowerData:r,tickUpperData:a}):(console.log("###fetchPosRewardersAmount"),console.log({poolAddress:s.poolAddress,positionId:s.positionSource=="clmm"?s.pos_object_id:s.clmm_position_id,coinTypeA:s.coinTypeA,coinTypeB:s.coinTypeB,rewarderInfo:s.rewarder_infos},"955##"),c=await n.fetchPosRewardersAmount({poolAddress:s.poolAddress,positionId:s.positionSource=="clmm"?s.pos_object_id:s.clmm_position_id,coinTypeA:s.coinTypeA,coinTypeB:s.coinTypeB,rewarderInfo:s.rewarder_infos}),console.log(c,"###rewarderInfo"));const u=[];let l=0;c.forEach((d,h)=>{var x;const g=i.tokensObj[d.coin_address].decimals,b=d.amount_owed.toString(),v=fn(new it(b).div(Math.pow(10,g)).toString(),g);if(s[`rewarder_display${h+1}`]||Number(v)>0){const P=i.tokensObj[d.coin_address],E=((x=i.RATES[d.coin_address])==null?void 0:x.price)||0;console.log(E,"price===>"),console.log(v,"==>amount");const S=Number(v)*E;l+=S,u.push({...d,...P,amount:v,amountUSD:S,amount_owed:d.amount_owed.toString()}),i.rewarderObj[s.tokenName]={pendingRewarderArr:u,pendingRewarderView:Number(fn(l,2)),pendingRewarder:l}}}),await Xs(1e3)}console.log(i.rewarderObj,"===>_this.rewarderObj")}},setAllTokenObj(e){console.log(e,"===>allTokenObj"),this.allTokenObj=e},async trappingTokenObj(e,t,n){const i={};e.forEach(r=>{!t[r.coinA.address]&&!i[r.coinA.address]&&(i[r.coinA.address]=r),!t[r.coinB.address]&&!i[r.coinB.address]&&(i[r.coinB.address]=r)}),console.log("trappingTokenObj###lackTokensObj####",i);const o=wi(n),s=Object.keys(i);if(console.log("trappingTokenObj###params###",s),s.length>0){const r=await o.getTokenListByCoinType(s);console.log("trappingTokenObj###result###",r);const a={};r.forEach(c=>{a[c.address]={...c,isSelfBuilt:!0}}),this.tokensObj={...this.tokensObj,...a}}},setNewTokens(e){console.log("setNewTokens#######newTokenObj###",e),this.tokensObj={...this.tokensObj,...e},console.log("setNewTokens###this.tokensObj####",this.tokensObj)},setPositionDetailCurrentTab(e){e!=this.positionDetailCurrentTab&&(this.positionActionAmount={},this.positionDetailCurrentTab=e)},setPositionActionAmount(e){this.positionActionAmount=e},async getMyPositonsByPool(e,t,n){console.log("0507###getMyPositons###start###",t),this.myPositionsLoading=!0;let i={};const o=wi(n);if(!t.current_sqrt_price){const h=await o.getPool(t.address)||{};i={...t,...h}}let s=[],r=[],a=[],c=[];if(n=="Sui"){const{clmmPosition:h,farmsPosition:g}=await o.getAllPosition(e,[t.address]);a=h,c=g,r=c.filter(b=>{if(b.clmm_pool_id==i.address)return b}),s=r.map(b=>{const v=[];let x=new it(0);return b.rewards.forEach(P=>{var V;const E=P.rewarder_type=="0x0000000000000000000000000000000000000000000000000000000000000002::sui::SUI"?"0x2::sui::SUI":P.rewarder_type,S=this.tokensObj[E],T=((V=this.RATES[E])==null?void 0:V.price)||0,R=new it(P.rewarder_amount).div(new it(Math.pow(10,S.decimals))),K=R.mul(new it(T));x=x.add(K),R.toNumber()>0&&v.push({...P,amount:R,rewarderAmountUsd:K.toString(),address:E,symbol:S.symbol})}),{...b,rewards:v,farmingRewardTotalUsd:x.toNumber()}}),console.log("farmingPositionList:",s)}else a=await o.getPositionList(e,{[t.address]:i})||[];console.log(s,"###farmingPositionList"),console.log("0507###getMyPositons###positionList###",a),console.log("###poolInfo",i),a.length<1&&this.setMyPositionsLoading(!1);const u=s.concat(a);console.log("allPositionList:",u);const l=[];u.forEach(h=>{let g,b,v,x="",P,E,S,T;if(h.liquidity&&h.liquidity!=="0"&&i){const R={creator:h.creator,collection:h.collection,name:h.name};n==="Aptos"?T=o.getNftHash(R):T=o.getNftHash(h);const K=i.token_a.decimals,V=i.token_b.decimals;console.log(i,"poolInf=====>"),v=o.TickMath.sqrtPriceX64ToPrice(i.current_sqrt_price,K,V).toString(),h.tick_lower_index==o.TickUtil.getMinIndex(Number(i.tickSpacing))?g="0":g=o.TickMath.tickIndexToPrice(Number(h.tick_lower_index),K,V).toString(),h.tick_upper_index==o.TickUtil.getMaxIndex(Number(i.tickSpacing))?b="":(b=o.TickMath.tickIndexToPrice(Number(h.tick_upper_index),K,V).toString(),console.log("0523###maxPrice###2222###",b));const W=o.getCoinAmountFromLiquidity({pool:i,position:h,roundUp:n!="Sui"}),tt=W.coinaAmount,j=W.coinbAmount;console.log(v,"===>currentPrice");const $=Number(j)+Number(tt)*Number(v);let q=(Number(tt)*Number(v)/$*100).toFixed(0),A=(j/$*100).toFixed(0);g=="0"&&b==""&&(q="50",A="50"),i.isPause?x="Closed":Number(v)>=Number(g)&&(b===""||Number(v)<=Number(b))?x="Active":(Number(v)>Number(b)||Number(v)<Number(g))&&(x="Inactive"),console.log("0323###this.tokensObj####",this.tokensObj),console.log("0323###this.tokensObj[poolInfo.token_a.address]####",this.tokensObj[i.token_a.address]),console.log("0323###poolInfo.token_a.address####",i.token_a.address),console.log("0323###poolInfo.token_b.address####",i.token_b.address);let f={},y={};n==="Aptos"?(f={...i.token_a,...this.tokensObj[i.token_a.address],logoURI:this.tokensObj[i.token_a.address].logo_url},y={...i.token_b,...this.tokensObj[i.token_b.address],logoURI:this.tokensObj[i.token_b.address].logo_url}):(f=i==null?void 0:i.token_a,y=i==null?void 0:i.token_b),l.push({...i,...h,totalAmount:$,token_a:f,token_b:y,tokenARates:P,tokenBRates:E,amountA:tt,amountB:j,fromPercent:q,toPercent:A,amountUSD:S,tokenName:h.tokenName||h.name,currentStatus:x,positionLiquidity:h.liquidity,nftHash:T,currentPrice:v,minPrice:eo(g,12),maxPrice:eo(b,12),positionSource:h.id?"farming":"clmm",farmingRewardTotalUsd:h.id?h.farmingRewardTotalUsd:0})}});const d=l.sort((h,g)=>g.liquidity-h.liquidity);console.log(d,"==>myPositionsByPool"),this.poolPositions=d,this.setMyPositionsLoading(!1),this.getPendingFees(d,n),this.getRewarderV2(d,n),console.log(d,"===>this.myPositions")},setAutoPoolNum(e){this.autoPoolNum=e},setTokenExternalPrice(e,t){this.tokenExternalPriceObj[e]=t},clearCurrentPositionInfo(){this.currentPositionInfo={}}}});export{xm as $,lP as A,oP as B,Ii as C,_P as D,mP as E,sP as F,CP as G,Mo as H,LS as I,Jr as J,Vr as K,gP as L,uP as M,Ze as N,Ei as O,Hk as P,ge as Q,Je as R,iP as S,We as T,jr as U,Zi as V,Fn as W,Qo as X,IP as Y,aP as Z,_k as _,x2 as a,yP as a0,OP as a1,q4 as a2,Et as a3,_ as b,P2 as c,eo as d,wi as e,rP as f,Oc as g,pP as h,wP as i,jo as j,hP as k,Xs as l,Uf as m,fP as n,cP as o,yn as p,fn as q,dP as r,A2 as s,bP as t,jS as u,Ws as v,Gs as w,q2 as x,we as y,Nn as z};
