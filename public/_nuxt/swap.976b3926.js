import{_ as rn}from"./refresh-icon.3df7c7c1.js";import{_ as cn}from"./assets-card.54d6d767.js";import{u as Ne,a as no,c as $e,s as ie,e as Y,i as qe,d as le,r as De,p as yo,b as dn,f as Ee}from"./pool.3ecfc54d.js";import{e as Re,a as Je,a0 as Po,a1 as $o,r as g,m as R,D as x,q as Oe,o as d,f as w,h as o,c as H,x as q,t as V,j as ee,v as u,z as pe,u as X,J as No,S as Ro,p as _e,k as Be,a6 as mn,i as he,w as re,L as Oo,W as _o,Q as Bo,F as oo,s as ko,B as Fo,b as Io,l as vn,y as pn,C as gn,a8 as We}from"./entry.dec4f018.js";/* empty css              *//* empty css              */import{u as Fe,c as ve,a as fn}from"./sha256.0d877cc3.js";import"./decimal.633e31ee.js";import{i as ce}from"./import-icon.de3e6c66.js";import{D as s}from"./decimal.0e8aa3f1.js";import{_ as hn}from"./network-tips.ba94556c.js";import{_ as Cn}from"./coin-select.83ba19e7.js";import{_ as wn}from"./swap-setting.4099b4f8.js";/* empty css              */import{_ as bn}from"./token-warning-modal.4d72cbec.js";import{u as An}from"./swapRouter.83a4dfb3.js";import{_ as Sn}from"./img-leverage_2x.1c577303.js";/* empty css              */import"./token-warning.6e01bf92.js";/* empty css              */import"./img-no-Positions_2x.33467ecb.js";/* empty css              */import"./icon-selected_3x.09e9a6f0.js";const yn=""+globalThis.__publicAssetsURL("sui-image/route-view.png");const kn=Je({props:{swapLoading:{type:Boolean,default:!1},fromCoinAmount:{type:String,default:""},toCoinAmount:{type:String,default:""},fromCoin:{type:Object,default:()=>({})},toCoin:{type:Object,default:()=>({})},fixedFromCoin:{type:Boolean,default:!0},impact:{type:String,default:""},insufficientLiquidity:{type:Boolean,default:!1},oneToAmount:{type:String,default:""},oneFromAmount:{type:String,default:""},suiPreSwapdata:{type:Object,default:()=>({})},suiSwapFee:{type:String,default:""},swapRouterLoading:{type:Boolean,default:!1}},setup(e){const v=Po($o,{style:{fontSize:"20px",color:"#75C8FF"},spin:!0}),A=g(!1),b=Fe(),O=R(()=>b),W=R(()=>O.value.slippage),m=R(()=>O.isShowRouterModal);x(()=>e,$=>{console.log($,"==>newValue")},{immediate:!0,deep:!0});const _=Ne(),B=R(()=>_),z=no("Sui"),P=g(0),D=g([]),j=g({});x(()=>e.suiPreSwapdata,async $=>{var p;if(console.log($,"===>suiPreSwapdata"),$&&!$e($)){let U=[];(p=$==null?void 0:$.splitPaths)==null||p.forEach(t=>{t==null||t.basePaths.forEach(async l=>{U.push(l.label),console.log(l.toCoin,"==>basePath.toCoin"),console.log(l.fromCoin,"==>basePath.fromCoin")})});const{splitPaths:y}=$,L=y&&y[0]&&y[0].basePaths;if(y&&y.length==1&&L&&L.length==2){const t=L[0].toCoin=="0x0000000000000000000000000000000000000000000000000000000000000002::sui::SUI"?"0x2::sui::SUI":L[0].toCoin;j.value=B.value.tokensObj[t]||(await z.getTokenListByCoinType[t])[0],console.log(j.value,"===>coinTypeB.value")}else j.value="";D.value=Array.from(new Set(U)),P.value=D.value.length,console.log(D.value,"===>sourcesArr.value"),console.log(j.value,"===>coinTypeB")}},{immediate:!0});const J=g(0),S=g(0);return x(()=>[e.fromCoinAmount,e.toCoinAmount,e.fromCoin,e.toCoin,e.fixedFromCoin,W.value],([$,p,U,y,L,t])=>{if($&&p&&U&&y&&t)if(L){const l=new s(p).mul(new s(t/100));S.value=new s(p).sub(l).toString()}else{const l=new s($).mul(new s(t/100));J.value=new s($).add(l).toString()}},{immediate:!0}),{sFixD:ie,getCoinIcon:$=>{var p;return($==null?void 0:$.logoURI)||($==null?void 0:$.logo_url)||((p=B.value.tokensObj[$==null?void 0:$.address])==null?void 0:p.logo_url)||(O.theme==="default"?ce("/image/coins/unknown.png"):ce("/image/coins/sui-unknown.png"))},indicator:v,rateChange:A,slippage:W,isShowRouterModal:m,indexStore:b,maximumSold:J,minimumReceived:S,addCommom:Y,pathLength:P,sourcesArr:D,coinTypeB:j}}}),be=e=>(_e("data-v-14ef988f"),e=e(),Be(),e),In={key:0,class:"swap-info"},Pn={class:"loading-swap"},$n={key:1,class:"swap-rate"},Nn={key:0},Rn={key:0},On={key:1},_n={key:0},Bn=be(()=>o("div",null,[o("svg",{class:"icon icon-up","aria-hidden":"true"},[o("use",{"xlink:href":"#icon-exchange_up1"})])],-1)),Fn=be(()=>o("div",null,[o("svg",{class:"icon icon-down","aria-hidden":"true"},[o("use",{"xlink:href":"#icon-exchange_down1"})])],-1)),Tn=[Bn,Fn],Un={key:2},Mn={class:"trade-info"},jn={class:"trade-block"},Ln=be(()=>o("div",{class:"lebal"},"Price Impact",-1)),Dn={key:0,class:"icon","aria-hidden":"true"},En=be(()=>o("use",{"xlink:href":"#icon-icon-warning1"},null,-1)),Wn=[En],qn={class:"trade-block"},Jn={class:"lebal"},Qn={key:0,class:"text"},Xn={class:"trade-block"},zn=be(()=>o("div",{class:"lebal"},"Fee",-1)),Hn={key:0,class:"text"},Yn={key:0,class:"trade-block"},Zn=be(()=>o("div",{class:"lebal"},"Route",-1)),Kn={key:0,class:"text text-box"},Gn=["src"],Vn={key:1,class:"text text-box"},xn=["src"],ea=["src"],oa=be(()=>o("img",{src:yn,alt:""},null,-1));function na(e,v,A,b,O,W){var z,P,D,j;const m=No,_=Ro,B=Oe("image");return e.swapLoading||Number(e.fromCoinAmount)&&Number(e.toCoinAmount)&&!e.insufficientLiquidity?(d(),w("div",In,[o("div",Pn,[e.swapLoading||e.swapRouterLoading?(d(),H(m,{key:0,size:"small",indicator:e.indicator},null,8,["indicator"])):q("",!0),e.swapLoading?e.swapLoading?(d(),w("span",Un,"Best route and price")):q("",!0):(d(),w("div",$n,[e.rateChange?(d(),w("span",On,[e.fromCoinAmount&&e.toCoinAmount?(d(),w("span",_n,[V(o("img",null,null,512),[[B,e.getCoinIcon(e.toCoin)]]),ee(" 1 "+u(e.toCoin.symbol)+" ≈ ",1),V(o("img",null,null,512),[[B,e.getCoinIcon(e.fromCoin)]]),ee(u(e.oneFromAmount==1/0?0:e.oneFromAmount)+" "+u(e.fromCoin.symbol),1)])):(d(),H(m,{key:1,indicator:e.indicator},null,8,["indicator"]))])):(d(),w("span",Nn,[V(o("img",null,null,512),[[B,e.getCoinIcon(e.fromCoin)]]),ee(" 1 "+u(e.fromCoin.symbol)+" ≈ ",1),e.fromCoinAmount&&e.toCoinAmount?(d(),w("span",Rn,[V(o("img",null,null,512),[[B,e.getCoinIcon(e.toCoin)]]),ee(u(e.oneToAmount==1/0?0:e.oneToAmount)+" "+u(e.toCoin.symbol),1)])):(d(),H(m,{key:1,indicator:e.indicator},null,8,["indicator"]))])),o("div",{class:"right",onClick:v[0]||(v[0]=J=>e.rateChange=!e.rateChange)},Tn)]))]),o("div",Mn,[o("div",jn,[Ln,e.swapRouterLoading?(d(),H(_,{key:1,paragraph:!1,active:""})):(d(),w("div",{key:0,class:pe(["text",e.impact<1?"impact-s":e.impact<10&&e.impact>=1?"impact-w":"impact-e"])},[ee(u(e.impact<.01?"<0.01":e.impact>100?"100":e.impact)+"% ",1),e.impact>=10?(d(),w("svg",Dn,Wn)):q("",!0)],2))]),o("div",qn,[o("div",Jn,u(e.fixedFromCoin?e.$t("common.minimumReceived"):e.$t("common.maximumSold")),1),e.swapRouterLoading?(d(),H(_,{key:1,paragraph:!1,active:""})):(d(),w("div",Qn,u(e.fixedFromCoin?("addCommom"in e?e.addCommom:X(Y))(("sFixD"in e?e.sFixD:X(ie))(e.minimumReceived,e.toCoin.decimals)):("addCommom"in e?e.addCommom:X(Y))(("sFixD"in e?e.sFixD:X(ie))(e.maximumSold,e.fromCoin.decimals)))+" "+u(e.fixedFromCoin?e.toCoin.symbol:e.fromCoin.symbol),1))]),o("div",Xn,[zn,e.swapRouterLoading?(d(),H(_,{key:1,paragraph:!1,active:""})):(d(),w("div",Hn,u(e.suiSwapFee)+" "+u(e.fromCoin.symbol),1))]),e.insufficientLiquidity?q("",!0):(d(),w("div",Yn,[Zn,e.swapRouterLoading?(d(),H(_,{key:1,paragraph:!1,active:""})):(d(),w("div",{key:0,class:"text",onClick:v[1]||(v[1]=J=>e.indexStore.setIsShowRouterModal(!e.isShowRouterModal))},[!e.swapRouterLoading&&e.suiPreSwapdata&&e.suiPreSwapdata.splitPaths&&e.suiPreSwapdata.splitPaths.length==1?(d(),w("div",Kn,[o("span",null,u(e.fromCoin.symbol)+" "+u(e.coinTypeB&&((z=e.coinTypeB)!=null&&z.symbol)?`> ${(P=e.coinTypeB)==null?void 0:P.symbol}`:"")+" > "+u(e.toCoin.symbol),1),o("img",{src:e.sourcesArr[0]=="Deepbook"?"/sui-image/logo_deepbook@2x.png":"/sui-image/logo_cetus@2x.png",alt:""},null,8,Gn)])):e.swapRouterLoading?q("",!0):(d(),w("div",Vn,[ee(u((j=(D=e.suiPreSwapdata)==null?void 0:D.splitPaths)==null?void 0:j.length)+" Streams ",1),e.sourcesArr[0]?(d(),w("img",{key:0,src:e.sourcesArr[0]=="Deepbook"?"/sui-image/logo_deepbook@2x.png":"/sui-image/logo_cetus@2x.png",alt:""},null,8,xn)):q("",!0),e.sourcesArr[1]?(d(),w("img",{key:1,src:e.sourcesArr[1]=="Deepbook"?"/sui-image/logo_deepbook@2x.png":"/sui-image/logo_cetus@2x.png",alt:""},null,8,ea)):q("",!0)])),oa]))]))])])):q("",!0)}const aa=Re(kn,[["render",na],["__scopeId","data-v-14ef988f"]]);async function ta(e,v){var W,m,_;const A=e==="0x2::sui::SUI"?"0x0000000000000000000000000000000000000000000000000000000000000002::sui::SUI":e,b=`${ve.Sui.api}/v2/sui/coin/kline?coin_address=${A}&interval=day&market=${v}`,O=await $fetch(b);return console.log("0621###getprice###res###",O),{price:((m=(W=O==null?void 0:O.data)==null?void 0:W.list)==null?void 0:m.reverse())||[],daily_rate:(_=O==null?void 0:O.data)==null?void 0:_.daily_rate.replace("%","")}}async function sa(e){const{prices:v}=await $fetch(`https://api.coingecko.com/api/v3/coins/${e}/market_chart?vs_currency=usd&id=${e}&days=7&interval=daily`,{headers:{Connection:"keep-alive",Accept:"*/*"}}),b=(await $fetch(`https://api.coingecko.com/api/v3/coins/markets?ids=${e}&vs_currency=usd&price_change_percentage=24h`,{headers:{Connection:"keep-alive",Accept:"*/*"}}))[0].price_change_percentage_24h,O=[];return v.forEach(W=>{O.push({price:new s(W[1]).toString(),timestamp:W[0]})}),{price:O,daily_rate:b}}const ia={props:{coin:{type:Object,default:()=>({})},refresh:{type:Boolean,default:!1},id:{type:String,default:""},market:{type:String,default:""}},setup(e,v){const{$echarts:A}=mn();let b=null,O;const W=g(!0),m=Fe(),_=R(()=>m),B=R(()=>_.value.chainName),z=R(()=>ve[B.value]),P=Ne(),D=R(()=>P),j=(t,l,E)=>{O={xAxis:{type:"category",boundaryGap:!1,show:!1,data:l},yAxis:{type:"value",show:!1,min:function(M){return M.min-M.min*.1},max:function(M){return M.max+M.max*.1}},grid:{top:1,right:1,bottom:1,left:1},tooltip:{trigger:"axis",borderWidth:0,padding:0,backgroundColor:"transparent",axisPointer:{lineStyle:{color:_.value.chainName=="Aptos"?"#68FFD8":"#76C8FF"}},formatter:function(M){return`<div class="chart-tip">
              <div>${M&&M[0]&&M[0].name}</div>
              <div>$${le(M&&M[0]&&M[0].value,4)}</div>
            </chart-tip>`}},color:{type:"linear",x:0,y:0,x2:0,y2:1,colorStops:[{offset:0,color:_.value.chainName=="Aptos"?"#0C4535":"#2E546D"},{offset:1,color:_.value.chainName=="Aptos"?"#151817":"#1B1B1B"}]},series:[{data:t,type:"line",showSymbol:!1,areaStyle:{},lineStyle:{color:_.value.chainName=="Aptos"?"#68FFD8":"#76C8FF",width:2,type:"solid"}}]},O&&b.clear(),O&&b.setOption(O,!0),b.resize(),W.value=!1},J=g(""),S=g(""),Z=async t=>{var ge,F;const l=[],E=[],{price:M,daily_rate:Se}=B.value==="Aptos"?await sa(t):await ta(t,e.market);J.value=Se,S.value=M&&M.length>1&&M[M.length-1].price,B.value==="Aptos"?M.forEach(K=>{l.push(K.price);const i=De(Number(K.timestamp),"MD"),r=De(Number(K.timestamp),"HM");E.push(i+" "+r)}):M.forEach(K=>{l.push(K.price);const i=De(new s(K.timestamp).mul(1e3).toNumber(),"MD"),r=De(new s(K.timestamp).mul(1e3).toNumber(),"HM");E.push(i+" "+r)});let ne=document.getElementById(`main${(ge=e.coin)==null?void 0:ge.name}`);b=A.init(ne),j(l,E,(F=e.coin)==null?void 0:F.name)};x(()=>e.id,(t,l)=>{console.log(t,l,"===>oldValue"),console.log(!W.value,"!isFirst.value"),t&&(J.value="",S.value="",setTimeout(()=>{Z(t)},1e3))},{immediate:!0});const $=g(""),p=g(""),U=g(""),y=g("");x(()=>[D.value.tokensObj,e.coin],([t,l])=>{var E,M;t&&l&&t[l.address]&&(console.log(t[l.address],"===>newValue[coin.address]"),p.value=((E=t[l.address])==null?void 0:E.labels)&&((M=t[l.address])==null?void 0:M.labels[0]),$.value=t[l.address].name,U.value=t[l.address].symbol,y.value=t[l.address].address)},{immediate:!0,deep:!0}),x(()=>e.refresh,t=>{t&&Z(e.id)});const L=R(()=>_.value.theme);return console.log(e.coin.address=="0x2::sui::SUI","0x2::sui::SUI"),{theme:L,store:m,importIcon:ce,fixD:qe,config:z,price_rate_24h:J,nowPrice:S,coinName:$,coinLabels:p,coinSymbol:U,address:y,decimalUi:le}}},la="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAAAk1BMVEUAAADn2v/m2//r2//v4//n2v/55P/n2v/o3P//+P/m2v/n2f/n2v/n2v/n2v/n2v/n2v/o2//p2//n3f/o3v/n2f/n2v/n2v/n2v/n2v/n2//o2v/q3f/r4f/u3f/n2v/o2v/n2//p3P/o3P/m2v/n2v/n2f/n2v/o2f/n2//r3f/t3P/n2v/m2v/o2v/r3v/m2f/tUDLHAAAAMHRSTlMAl5oyFNMJqSwFhvvr5d7Yr2FGNSD0zb2lkIltOhkOxoJoT0D48aJzWFYlHeB8Wief0nHAAAABSElEQVQ4y52Q53LCMBCEZWK5g0swBpveQknZ93+6rFxAHkSYyf6x9+67JqHLKxOZRzJJbWHStkCn0Fo8pG0XuvJv0dciBjVZb+dZeoxABb38MlbpXeucr5z2QwdUf8vX1h0ByLT9aAeCGlez4Ozw5zoE4nvFBJB0yymUhqp0B2DT5ec0O+YlWlUMJsCqAwJA8jNV1W4RAnuvqepeYwWsOR/AkfM9ji8YjYBTC3wCZyEq1jvKnoCQP8X90j0wF2IGuM2jArjUE8sWAPAmxACwavtDf623XJsBtoqa2zcm4MI8Ag7iNZkBeAcVc8cUOPhPgJjP4I/UzkYgKtWxpQqaAGfMvvUATIUBaOQHAEb2M2CZcj4OnrhJasDYXYVQ9Vpe2LJ/BeWyf4/oAXlC25e9uI0IqswRJulX/BOwXgG2JPCCIPA3sXmM/QK1PTc8LGCPoAAAAABJRU5ErkJggg==",ua="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAACM9JREFUWEeVV2lwU9cV/u59i1YLWZItb9iWw2JWsxXCQMIyJAOdkJSEtsDQhE7Slpl2OoXOdJpf4R/9kU7STtqmDBm2pnQaICkOZUoISUigQFhM7BhsTGUbGyNbsqzNT09v69yr2IjdOfr3dO493znnO8slGKO8H/6VV8vY3tDM1OpMbtCTMzKiZir8tETskESX7pZ9SYl6GiWXumVN6M2hsVxNHqW0/8ovlpqaeWBguMOnG9oj9dl9oiBZJY4Jg1Sma9dPeevTh9l44IV7el70y/FxF26lr1Ybps71iiQ7JrjLEHKVwinKcIs2WDQABW5kDBWdyXZcS1xBMpfiNgUqWkH35G6tODn3paq9sfsBuS+A/c2bl6azQ8cTuYjADpU7vFgenAGf5IIJi/9GxLJMECKCCAEIci0EsQoxpRUfd7+H3kwfV/PIQaPI7l2xfsbb90TjHgB7mjZtTeUGX89qKSJTAasqZqPa6YdhmgB5WAYMwLIAIoBIdRDFIG4kzuLIjRNQTQ12yW15pODWF2fvfLMwEnfcuK/5laVJpf+EoqXIOMmOF6oeh1O0ca/HLkyXgRFBpUooRhaHOhsRz6U5CL+jcnlhJEYBvHVljd+WcUQSap/gkWzYWLsEhBBYzKsCoYSA/ZiwVFAA7JtpWdDv0GXnLEAoBhUq8bdrOzGUS2OcrcyQXdngS1Pe55wYBfDu5Z939qVbayQqYEPNYrhF+2iuiUVAKYEJE9FsGmlN4eDsooyYQtE3nEPI48SEIgdM04Q1miqLp4VItVDhxN62PyNn6qhwT+3a0PCn2lEALPSxTPcJVmYry2diYlEFDMvkDjDDWUPD1UQPwul+JHQFqqFy5DKRoFoibmQsdKUFrAjWYl1dBWQWuVHXGAgKqehphOOncbjzIAQqWWXuOp4Krrbv8uZoJN3mL5ad2Fj7ZN44Cy0IwukIzsU6ENeGkTMMeB1VaChdBYHK6IidRmfiS5hEQFYHRCpjeTCEKZ4KOEQ7yGgMdRBpEiTHdLzb+hoGlBjK3PWxjQ1/CZBdl77nTanZwZyhkjVV30G5w8dzJxCKrxPdOBvtQMrIgqXB7wxhofeXOHbkJEzdwvxFM9HrPIxw/DxEIoLBZudkKqLS6UPIVYIqlx8OKnOHZM9z6E83YX/7TkiCzaoOlvnIrgs/2RXLdmyyURE/m/gUdNPgnverCXx0qxlRNcUvZTmfV7IRXx3N4vMvTnLSzZw+CwvXetGaakROz4AQRsl8NfL8AXAIEuqLKjHXXw2HYzYkeQLebv4NFD2LcteU3WTfV5ujkVSbv9YVwOrKeTz8IhXwef8VNA12ceIx45RQLCh9GV8c7MPZc2d4cKdMmoYl6ypwTT2C4dwQKOF9q0DyLcswDcwqrsEC/zR4fD/Ev9u3oy3ZgfHemTGyu+nlXDTzP+mJkslo8Nbymmdl9WHPeXSk+zmYvBBUu+cimF6JwwePcw/nLZgF14xWXI19AkKF0fIcQSAQietppgaZUKyqmI6JZT9FS/+/cKznOEpcdRrZcf4HZlIdIM9VzuP5YpA1S0dj7wXcyMRuA+AVIaCh9Bl4zalQVQ1mURTn+/ZDM4ZB7vJeIDJqPHOgGml0JS9CpjJWVczEpMB30ZfpwD+uH4DHVmKRP5xZaWqGSn4UWgIPYy4BhnUVH/ZexE0lXhCBfOMxTR0O2QOR2pDKRkEpY0w+9yPC9NiIDhUvgKIn0BE/izpnOZaW18PvrEfOVPHXq3/nRCR/PLPSZBWwoWYRim1uTsB4LsMBxHJ5At4t+cxa3DADfFezzKtTBlaDqgAOswjPPjYT1R4fTAhQLQPvXPsPJMFukR3n15lJNUJWljfwUcsIN5BN4sjNi0how5x8DxTLQk6hkGQLgs3i/GFtWlcJlEERhga4XAKeqK3DrMB40G+aU68Sxwc9X8JjK7XInqZXcgOZ69Kc4hosCtQDhOLmcAxHbl7CsJHjhHyYaAowHJGRSwswTAIqmJCcJuxeA04HxeKKiZgWqIAAgc8VFuFL8TBORdtR4npMI//8eku0e6jJX2IrwvraRZyE11MRHL15CQbz6BEAYFrQNQJDZ3XCeh+byBZcdgGLg5NR76n8hiP5viASioM3zoJFodo7K0Y+uPLaro7Bk5tEQvDjumVwCDKah7pw7FYL2GAasxQEihXk44GJvKzZ58J5yhza0fERNNPEBN+Tu8kn4W3elv5zg6qukPn+EGYX1+FUtA1N8S6I9zSWMcBhHdI7HotLpxQOW36QAbs8FMbJgXbYRIc1vXS+j+N+r+XX0a7ERb9dEPF0WQNOD7QhoibvWwEPJiR416x0+PBM5RxIRCwY9vn0sC67N/wphg0NNePmxL4//fcBDuBoePvS9shnJ1g/KBJFpHX9W+1A7A5GMIlQrKmejxLZc8/6xsj8WaQFzYleXv+TgkuWrwq9mh/HTA62/rYzHD9bw2pbN7N83H4b0Q0DcwIhLPRPhHBX6lgptye78XGkDYZlsAbV9cLU391eSJihQz2v+pP9tyJRpVPIg8ixtXpMGNhkFEHxfPUClNqY97ePMeOx7BAO9Vzgy2nAUWt4SsuCz1dtv3MlG0lFV+z8ibQ6SCgoNEMBpfIjS1G3DExyl2NZcBrsgpTfFQnlaWkZ6sR/Y2HkTA1um8+q8c/joR+BeE+XaWzbtrU31fw6B0EEsOcXZXv/Xf2+MDRsz1scmIzZvhAvXbYXDKlpnOpvRZeSgGHp3HiFe8bWZ+u3PXgtH7mUkTISv3Y8qoRHG4Fh5UBRAKQAOgPwVHAGphWPR1RJoiURxvX0IA85Exb2YPGkFYWePzACI38wTlhJ60JP8nK1ZmS5OUYuxg0+jPgEYp/ZtmygWHbzMtMswuc/EzZsqjwN3cRD5o7k/G5SPfKxyaKRHo4duJVu9bFmNRZWsiZT5p466Hb6197P68I7xnQhO8A6ZiJrvaGZ6dWKnvSoelpUtPwL3CF5YRPdukP0JCXqbhxnJ1uWhbaN6Xn+f1F23aMaO2HeAAAAAElFTkSuQmCC";const ra=e=>(_e("data-v-1fbf26d3"),e=e(),Be(),e),ca={class:"token-info"},da={class:"token-info-padding"},ma={class:"token-info-header"},va={class:"left"},pa=["onerror"],ga={class:"name"},fa={class:"desc"},ha={key:0},Ca={class:"right"},wa={class:"price-info"},ba={key:0,src:la,alt:""},Aa={key:1,src:ua,alt:""},Sa={class:"token-info-footer"},ya={class:"left"},ka={class:"address"},Ia={key:0,class:"pc-address"},Pa={key:1,class:"pc-address"},$a={class:"h5-address"},Na=ra(()=>o("use",{"xlink:href":"#icon-icon-copy1"},null,-1)),Ra=[Na],Oa={class:"right"},_a=["id"];function Ba(e,v,A,b,O,W){var B;const m=Oo,_=Oe("image");return d(),w("div",ca,[o("div",da,[o("div",ma,[o("div",va,[V(o("img",{onerror:b.theme=="default"?b.importIcon("/image/coins/unknown.png"):b.importIcon("/image/coins/sui-unknown.png")},null,8,pa),[[_,A.coin.logoURI||b.importIcon(`/image/coins/${A.coin.symbol.toLowerCase()}.png`)]]),o("div",null,[o("div",ga,u(b.coinSymbol),1),o("div",fa,[o("span",null,[ee(u(b.coinName)+" ",1),b.theme!=="sui"?(d(),w("span",ha,u(b.coinLabels?`(${b.coinLabels})`:""),1)):q("",!0)])])])]),o("div",Ca,[he(m,{placement:"top","arrow-point-at-center":""},{title:re(()=>[ee(u(A.market==="pyth"?"Data source: Pyth Network":"Data source: CoinGecko"),1)]),default:re(()=>[o("div",wa,[A.market==="pyth"?(d(),w("img",ba)):(d(),w("img",Aa)),o("span",null,"$"+u(b.nowPrice?Number(b.nowPrice)<1?b.decimalUi(b.nowPrice,4):b.fixD(b.nowPrice,2):"--"),1),b.price_rate_24h?(d(),w("i",{key:2,class:pe(b.price_rate_24h>0?"up":b.price_rate_24h<0?"down":"up")},u(b.price_rate_24h>0?`+ ${b.fixD(b.price_rate_24h,2)}`:b.price_rate_24h<0?+`${b.fixD(b.price_rate_24h,2)}`:`+${b.fixD(b.price_rate_24h,2)}`)+"%",3)):q("",!0)])]),_:1})])]),o("div",Sa,[o("div",ya,[o("div",ka,[A.coin&&b.address!=="0x2::sui::SUI"?(d(),w("span",Ia,u(A.coin&&A.coin.address.substr(0,13))+" ... "+u(A.coin&&A.coin.address.substr(A.coin.address.length-13,13)),1)):(d(),w("span",Pa,u(A.coin&&A.coin.address),1)),o("span",$a,u(A.coin&&A.coin.address.substr(0,4))+" ... "+u(A.coin&&A.coin.address.substr(A.coin.address.length-4,4)),1),(d(),w("svg",{class:"icon","aria-hidden":"true",onClick:v[0]||(v[0]=z=>b.store.copy(A.coin&&A.coin.address))},Ra))])]),o("div",Oa,[o("div",{id:`main${(B=A.coin)==null?void 0:B.name}`,class:"main"},null,8,_a)])])])])}const Fa=Re(ia,[["render",Ba],["__scopeId","data-v-1fbf26d3"]]);const Ta=Je({components:{Modal:_o},props:{fromCoin:{type:Object,default:()=>({})},toCoin:{type:Object,default:()=>({})},fromCoinAmount:{type:String,default:""},toCoinAmount:{type:String,default:""},suiPreSwapdata:{type:Object,default:()=>({})}},setup(e){const v=Ne(),A=no("Sui"),b=R(()=>v);R(()=>{var P,D;return(D=(P=b.value)==null?void 0:P.poolInfo)==null?void 0:D.needReverse});const O=g([]),W=g({});x(()=>[e.suiPreSwapdata,e.fromCoin,e.toCoin],([P,D,j])=>{if(P&&!$e(P)){let J=[];P.splitPaths.forEach(U=>{const y={...U,amountIn:new s(U.inputAmount).div(new s(Math.pow(10,D.decimals))).toString(),amountOut:new s(U.outputAmount).div(new s(Math.pow(10,j.decimals))).toString()},L=U.basePaths.map(t=>({...t,...b.value.routerPoolConfigObj[t.poolAddress],feeRate:new s(t.feeRate).div(new s(Math.pow(10,t.label=="Cetus"?6:9)))}));J.push({...y,basePaths:L}),console.log(U,"===>splitPath")}),O.value=J;const S=[];let Z=new s(0);J.forEach(U=>{const y=new s(U.percent).gt(0)?new s(U.percent).div(100).mul(100).toString():0,L=ie(y,2);Z=Z.plus(L);const t=L.split(".");S.push({value:L,int:t[0],decimal:t[1],pathIndex:U.pathIndex})});let $=new s(100).minus(Z).toNumber();const p=S.sort((U,y)=>Number(y.decimal)-Number(U.decimal));if($)for(let U=0;U<p.length&&$;U++)p[U].value=new s(p[U].value).plus(.01).toString(),$=new s($).minus(.01).toNumber();W.value=Object.fromEntries(p.map((U,y)=>[U.pathIndex,U])),console.log(p,"===>sortByDecimalPart"),console.log(J,"===>routerArr")}},{immediate:!0});const m=Fe(),_=R(()=>m);return{addCommom:Y,routerStep:O,getCoinIcon:P=>{var D;return console.log("获取logo"),console.log(b.value.tokensObj,"==>pools.value.tokensObj217"),(P==null?void 0:P.logoURI)||(P==null?void 0:P.logo_url)||((D=b.value.tokensObj[(P==null?void 0:P.address)=="0x0000000000000000000000000000000000000000000000000000000000000002::sui::SUI"?"0x2::sui::SUI":P==null?void 0:P.address])==null?void 0:D.logo_url)||(_.value.theme==="default"?ce("/image/coins/unknown.png"):ce("/image/coins/sui-unknown.png"))},getDeepBookLogo:async P=>{var j;const D=await A.getTokenListByCoinType([P]);return D&&D.length>0?(j=D[0])==null?void 0:j.logo_url:""},percentObj:W}}}),Qe=e=>(_e("data-v-c7ed38ed"),e=e(),Be(),e),Ua=Qe(()=>o("svg",{class:"icon modal-icon-close","aria-hidden":"true"},[o("use",{"xlink:href":"#icon-a-icon-Shutdown"})],-1)),Ma={class:"route-top"},ja={class:"token-a"},La={alt:""},Da={class:"token-num"},Ea={class:"token-symbol"},Wa={class:"token-b"},qa={class:"token-num"},Ja={class:"token-symbol"},Qa={alt:""},Xa={class:"route-bottom"},za=Qe(()=>o("div",{class:"left-round"},null,-1)),Ha=Qe(()=>o("div",{class:"right-round"},null,-1)),Ya={class:"percent-text"},Za={class:"amount"},Ka={class:"symbol"},Ga={class:"percent-ratio"},Va={class:"percent-text"},xa={class:"amount"},et={class:"symbol"},ot={class:"pool-info-box"},nt={key:0,class:"icon","aria-hidden":"true"},at=Qe(()=>o("use",{"xlink:href":"#icon-icon_on1"},null,-1)),tt=[at],st={class:"pool-info"},it={class:"pool-info-top"},lt={class:"token-a-img",alt:""},ut={class:"token-b-img",alt:""},rt={class:"source"},ct=["src"];function dt(e,v,A,b,O,W){const m=Bo("Modal"),_=Oe("image");return d(),H(m,{title:"Route",width:"600px",visible:!0,footer:null,onCancel:v[0]||(v[0]=B=>e.$emit("onClose"))},{closeIcon:re(()=>[Ua]),default:re(()=>{var B,z,P,D;return[o("div",Ma,[o("div",ja,[V(o("img",La,null,512),[[_,(B=e.fromCoin)==null?void 0:B.logo_url]]),o("span",Da,u(("addCommom"in e?e.addCommom:X(Y))(e.fromCoinAmount)),1),o("span",Ea,u((z=e.fromCoin)==null?void 0:z.symbol),1)]),o("div",Wa,[o("span",qa,u(("addCommom"in e?e.addCommom:X(Y))(e.toCoinAmount)),1),o("span",Ja,u((P=e.toCoin)==null?void 0:P.symbol),1),V(o("img",Qa,null,512),[[_,(D=e.toCoin)==null?void 0:D.logo_url]])])]),o("div",Xa,[za,Ha,(d(!0),w(oo,null,ko(e.routerStep,(j,J)=>(d(),w("div",{key:J,class:pe(["route-path",J!==0?"route-path-active":""])},[o("div",{class:pe(["percent",J!==0?"percent-active":""])},[o("div",Ya,[o("div",Za,u(("addCommom"in e?e.addCommom:X(Y))(j.amountIn)),1),o("div",Ka,u(e.fromCoin.symbol),1),o("span",Ga,"("+u(e.percentObj&&e.percentObj[j.pathIndex].value)+"%)",1)]),o("div",Va,[o("div",xa,u(("addCommom"in e?e.addCommom:X(Y))(j.amountOut)),1),o("div",et,u(e.toCoin.symbol),1)])],2),o("div",ot,[j.basePaths&&j.basePaths.length>1?(d(),w("svg",nt,tt)):q("",!0),(d(!0),w(oo,null,ko(j.basePaths,(S,Z)=>(d(),w("div",{key:Z},[o("div",st,[o("div",it,[V(o("img",lt,null,512),[[_,S.label=="Cetus"?e.getCoinIcon({address:S.fromCoin}):e.getDeepBookLogo(S.fromCoin)]]),V(o("img",ut,null,512),[[_,S.label=="Cetus"?e.getCoinIcon({address:S.toCoin}):e.getDeepBookLogo(S.toCoin)]]),o("span",null,u((S==null?void 0:S.feeRate)*100)+"%",1)]),o("div",rt,[o("img",{src:S.label=="Cetus"?"/sui-image/logo_cetus@2x.png":"/sui-image/logo_deepbook@2x.png",alt:""},null,8,ct),o("span",null,u(S.label=="Cetus"?"Cetus":"DeepBook"),1)])])]))),128))])],2))),128))])]}),_:1})}const mt=Re(Ta,[["render",dt],["__scopeId","data-v-c7ed38ed"]]),vt=Je({components:{Modal:_o},props:{fromCoin:{type:Object,default:()=>({})},toCoin:{type:Object,default:()=>({})},fromCoinAmount:{type:String,required:!0},toCoinAmount:{type:String,required:!0},slippage:{type:String,default:""},impact:{type:Number,required:!1},fixedFromCoin:{type:Boolean,default:!1},fee:{type:String,required:!1},formatFee:{type:String,default:""},isShowAccept:{type:Boolean,default:!1},swapLoading:{type:Boolean,required:!1},oneFromAmount:{type:String,default:""},oneToAmount:{type:String,default:""},suiPreSwapdata:{type:Object,default:()=>({})}},setup(e,v){const A=Ne(),b=R(()=>A),O=Fe(),W=R(()=>O),m=S=>{var Z;return(S==null?void 0:S.logoURI)||(S==null?void 0:S.logo_url)||((Z=b.value.tokensObj[S==null?void 0:S.address])==null?void 0:Z.logo_url)||(W.value.theme==="default"?ce("/image/coins/unknown.png"):ce("/image/coins/sui-unknown.png"))},_=g(!1),B=R(()=>W.value.chainName),z=async()=>{v.emit("to-swap")};g([]);const P=g(0),D=g(""),j=g(""),J=R(()=>W.value.slippage);return x(()=>[e.fromCoinAmount,e.toCoinAmount,e.fromCoin,e.toCoin,e.fixedFromCoin,J.value],([S,Z,$,p,U,y])=>{if(console.log(Z,S,y,"===>"),S&&Z&&$&&p&&y)if(U){const L=new s(Z).mul(new s(y/100));j.value=new s(Z).sub(L).toString()}else{const L=new s(S).mul(new s(y/100));D.value=new s(S).add(L).toString()}},{immediate:!0}),console.log(e,"swapLoading===>"),{getCoinIcon:m,addCommom:Y,sFixD:ie,rateChange:_,chainName:B,clickNextBtn:z,pathLength:P,maximumSold:D,minimumReceived:j,decimalUi:le}}});const Ce=e=>(_e("data-v-621e0b0a"),e=e(),Be(),e),pt=Ce(()=>o("svg",{class:"icon modal-icon-close","aria-hidden":"true"},[o("use",{"xlink:href":"#icon-a-icon-Shutdown"})],-1)),gt={class:"new-swap-contnet"},ft={class:"coin-info"},ht={class:"from-coin-info"},Ct={class:"left"},wt={class:"coin-amount"},bt={class:"coin-symbol"},At={class:"right"},St={class:"to-coin-info"},yt={class:"left"},kt={class:"coin-amount"},It={class:"coin-symbol"},Pt={class:"right"},$t=Ce(()=>o("div",{class:"to-swap-logo"},null,-1)),Nt={class:"coin-rate"},Rt={key:0},Ot={class:"left"},_t=Ce(()=>o("div",null,[o("svg",{class:"icon icon-up","aria-hidden":"true"},[o("use",{"xlink:href":"#icon-exchange_up1"})])],-1)),Bt=Ce(()=>o("div",null,[o("svg",{class:"icon icon-down","aria-hidden":"true"},[o("use",{"xlink:href":"#icon-exchange_down1"})])],-1)),Ft=[_t,Bt],Tt={key:1},Ut={class:"left"},Mt=Ce(()=>o("div",null,[o("svg",{class:"icon icon-up","aria-hidden":"true"},[o("use",{"xlink:href":"#icon-exchange_up1"})])],-1)),jt=Ce(()=>o("div",null,[o("svg",{class:"icon icon-down","aria-hidden":"true"},[o("use",{"xlink:href":"#icon-exchange_down1"})])],-1)),Lt=[Mt,jt],Dt={class:"bottom"},Et={class:"induction"},Wt={class:"item"},qt={class:"induction-text"},Jt={class:"induction-value"},Qt={class:"item"},Xt={class:"induction-text"},zt={class:"induction-value"},Ht={class:"item"},Yt={class:"induction-text"},Zt={key:0,class:"icon","aria-hidden":"true"},Kt=Ce(()=>o("use",{"xlink:href":"#icon-icon-warning1"},null,-1)),Gt=[Kt],Vt={class:"item"},xt={class:"induction-text"},es={key:0,class:"induction-value"},os={key:1,class:"induction-value"},ns={key:0,class:"price-updated"},as=Ce(()=>o("span",null,"Price updated",-1));function ts(e,v,A,b,O,W){const m=Fo,_=Bo("Modal"),B=Oe("image");return d(),H(_,{width:"440px",visible:!0,footer:null,title:e.$t("button.swap"),class:"add-liquidity-modal",onCancel:v[4]||(v[4]=z=>e.$emit("on-close"))},{closeIcon:re(()=>[pt]),default:re(()=>[o("div",gt,[o("div",ft,[o("div",ht,[o("div",Ct,[o("div",wt,u(e.fromCoinAmount&&("addCommom"in e?e.addCommom:X(Y))(e.fromCoinAmount)),1),o("div",bt,u(e.fromCoin&&e.fromCoin.symbol),1)]),o("div",At,[V(o("img",null,null,512),[[B,e.fromCoin&&e.fromCoin.logoURI||e.getCoinIcon(e.fromCoin)]])])]),o("div",St,[o("div",yt,[o("div",kt,u(e.toCoinAmount&&("addCommom"in e?e.addCommom:X(Y))(e.toCoinAmount)),1),o("div",It,u(e.toCoin&&e.toCoin.symbol),1)]),o("div",Pt,[V(o("img",null,null,512),[[B,e.toCoin&&e.toCoin.logoURI||e.getCoinIcon(e.toCoin)]])]),$t]),o("div",Nt,[e.rateChange?(d(),w("div",Tt,[o("div",Ut,[V(o("img",null,null,512),[[B,e.toCoin&&e.toCoin.logoURI||e.getCoinIcon(e.toCoin)]]),o("span",null,"1 "+u(e.toCoin&&e.toCoin.symbol)+" ≈",1),V(o("img",null,null,512),[[B,e.fromCoin&&e.fromCoin.logoURI||e.getCoinIcon(e.fromCoin)]]),o("span",null,u(("decimalUi"in e?e.decimalUi:X(le))(e.oneFromAmount,e.fromCoin.decimals))+" "+u(e.fromCoin.symbol),1)]),o("div",{class:"right",onClick:v[1]||(v[1]=z=>e.rateChange=!e.rateChange)},Lt)])):(d(),w("div",Rt,[o("div",Ot,[V(o("img",null,null,512),[[B,e.fromCoin&&e.fromCoin.logoURI||e.getCoinIcon(e.fromCoin)]]),o("span",null,"1 "+u(e.fromCoin&&e.fromCoin.symbol)+" ≈",1),V(o("img",null,null,512),[[B,e.toCoin&&e.toCoin.logoURI||e.getCoinIcon(e.toCoin)]]),o("span",null,u(("decimalUi"in e?e.decimalUi:X(le))(e.oneToAmount,e.toCoin.decimals))+" "+u(e.toCoin.symbol),1)]),o("div",{class:"right",onClick:v[0]||(v[0]=z=>e.rateChange=!e.rateChange)},Ft)]))])]),o("div",Dt,[o("div",Et,[o("div",Wt,[o("div",qt,u(e.$t("modal.slippageTolerance")),1),o("div",Jt,u(e.slippage)+"%",1)]),o("div",Qt,[o("div",Xt,u(e.fixedFromCoin?e.$t("common.minimumReceived"):e.$t("common.maximumSold")),1),o("div",zt,u(e.fixedFromCoin?("addCommom"in e?e.addCommom:X(Y))(("sFixD"in e?e.sFixD:X(ie))(e.minimumReceived,e.toCoin.decimals)):("addCommom"in e?e.addCommom:X(Y))(("sFixD"in e?e.sFixD:X(ie))(e.maximumSold,e.fromCoin.decimals)))+" "+u(e.fixedFromCoin?e.toCoin.symbol:e.fromCoin.symbol),1)]),o("div",Ht,[o("div",Yt,u(e.$t("common.priceImpact")),1),o("div",{class:pe(["induction-value",e.impact<1?"impact-s":e.impact<10&&e.impact>=1?"impact-w":"impact-e"])},[ee(u(e.impact<.01?"<0.01":e.impact>100?"100":e.impact)+"% ",1),e.impact>=10?(d(),w("svg",Zt,Gt)):q("",!0)],2)]),o("div",Vt,[o("div",xt,u(e.$t("common.fee")),1),e.chainName=="Aptos"?(d(),w("div",es,u(e.formatFee)+" "+u(e.fromCoin.symbol)+" ("+u(e.fee*100)+"%) ",1)):(d(),w("div",os,u(e.fee)+" "+u(e.fromCoin.symbol),1))])])])]),e.isShowAccept?(d(),w("div",ns,[as,he(m,{class:"accept-btn",loading:e.swapLoading,onClick:v[2]||(v[2]=z=>e.$emit("accept"))},{default:re(()=>[ee("Accept")]),_:1},8,["loading"])])):(d(),H(m,{key:1,class:"big-btn swap-confirm-btn",onClick:v[3]||(v[3]=z=>e.clickNextBtn())},{default:re(()=>[ee(u(e.$t("button.confirmSwap")),1)]),_:1}))]),_:1},8,["title"])}const ss=Re(vt,[["render",ts],["__scopeId","data-v-621e0b0a"]]),is=Je({setup(){const e=Io(),v=Po($o,{style:{fontSize:"12px",color:"#fff",paddingBottom:"3px"},spin:!0}),{t:A,locale:b}=vn(),O=Fe(),W=Ne(),m=R(()=>W);let _=g(!1),B=g(!1),z=g(!1),P=g(!1),D=g(!1),j=g(!1);const J=g("fromCoin"),S=g(""),Z=g(""),$=g(!1),p=g(!0),U=g(!1),y=g(!1),L=g(!1),t=g(""),l=g(""),E=g(20),M=g(0),Se=g(null),ne=g(!1),ge=R(()=>O.slippage),F=R(()=>O.chainName),K=R(()=>F.value?no(F.value):{}),i=g(),r=g(),Xe=R(()=>ve&&ve[F.value]&&ve[F.value].hasRouter),ao=R(()=>W.getPoolInfoSuccess),To=R(()=>{var n;return k.value&&((n=k.value)!=null&&n.is_pause)?"Pool Closed":!i.value||!r.value?A("modal.selectTokenModalTitle"):!Number(t.value)&&!Number(l.value)?A("button.enterAmount"):!Xe.value&&!k.value&&ao.value?"Pool Not Found":Xe.value&&ke.value?"No Available Route":(console.log(ne.value,"===>insufficientLiquidity.value"),ne.value?A("button.insufficientLiquidity"):Number(t.value)>Number(se.value)?A("button.insufficientBalance",{name:i.value.symbol}):A("button.swap"))}),Uo=n=>{var c,a,f,C;J.value=n,n==="fromCoin"?(S.value=((c=r.value)==null?void 0:c.address)||"",Z.value=((a=i.value)==null?void 0:a.address)||""):(S.value=((f=i.value)==null?void 0:f.address)||"",Z.value=((C=r.value)==null?void 0:C.address)||""),$.value=!0},ze=g({}),He=g({}),Mo=n=>{J.value==="fromCoin"?(ze.value=n,Ke(n)):(He.value=n,Ke(n))},jo=n=>{n==="fromCoin"?(p.value=!0,F.value==="Aptos"?t.value=se.value>0?i.value.symbol=="APT"?new s(Number(se.value)).sub(new s(.1)).lt(new s(0))?"0":new s(Number(se.value)).sub(new s(.1)).toString():String(se.value):"":t.value=se.value>0?i.value.symbol=="SUI"?new s(Number(se.value)).sub(new s(.05)).lt(new s(0))?"0":new s(Number(se.value)).sub(new s(.05)).toString():String(se.value):""):(p.value=!1,F.value==="Aptos"?l.value=ue.value>0?r.value.symbol=="APT"?new s(Number(ue.value)).sub(new s(.1)).lt(new s(0))?"0":new s(Number(ue.value)).sub(new s(.1)).toString():String(ue.value):"":l.value=ue.value>0?r.value.symbol=="SUI"?new s(Number(ue.value)).sub(new s(.05)).lt(new s(0))?"0":new s(Number(ue.value)).sub(new s(.05)).toString():String(ue.value):"")},Lo=n=>{n==="fromCoin"?(p.value=!0,t.value=se.value>0?ie(new s(Number(se.value)).div(2).toString(),i.value.decimals).toString():""):(p.value=!1,l.value=ue.value>0?ie(new s(Number(ue.value)).div(2).toString(),r.value.decimals).toString():"")};pn(()=>{to()}),gn(()=>{clearInterval(Se.value)});const Ye=R(()=>O),Ze=()=>{!k.value&&!Xe.value||(clearInterval(Se.value),W.setPoolConfigList(Ye.value.chainName,Ye.value.filterCoinsObj),M.value=0,B.value=!0,k.value&&W.updateCurrentPools(k.value.poolAddress,F.value),Ie(p.value?t.value:l.value),te.value.address&&K.value.getAccount(te.value.address),O.getStatsData(F.value,Ye.value.filterCoinsObj),setTimeout(()=>{B.value=!1,to()},1e3))};x(()=>M.value,n=>{console.log(n,"newValue===>650")},{immediate:!0});const to=()=>{Se.value=setInterval(()=>{B.value=!1,U.value||M.value<E.value&&(M.value+=1,M.value===E.value&&(F.value=="Aptos"?(k.value&&k.value.poolAddress&&W.updateCurrentPools(k.value.poolAddress,F.value),Ze()):j.value||Ze(),M.value=0,B.value=!0))},1e3)};x(p,We((n,c)=>{p.value=n},500));const ye=g(!1);x(t,We((n,c)=>{n&&n!==0&&p.value&&(M.value=0,Ie(n)),n==""&&p.value&&(l.value="")},500)),x(l,We((n,c)=>{n&&n!==0&&!p.value&&(M.value=0,Ie(n)),n==""&&!p.value&&(t.value="")},500));const Te=g(1e-4),Ue=async n=>{let c=n;if(console.log(c,"poolInfo====>"),F.value==="Aptos"&&!c.current_sqrt_price&&t.value&&l.value){const a=await K.value.getPools([c.address]);a&&a[0]&&(c={...n,...a[0],fee:Number(a[0].fee_rate)/1e6})}if(c.current_sqrt_price&&t.value&&l.value){const f=(i.value.address===c.coinA.address&&r.value.address===c.coinB.address?0:1)==0,C=new s(t.value),h=new s(l.value),N=C.sub(C.mul(new s(c.fee)));console.log("getImpact###poolInfo.fee####",c.fee),console.log("getImpact###fAmount####",C.toString()),console.log("getImpact###tAmount####",h.toString()),console.log("getImpact###f####",N.toString());const Q=h.div(N);console.log("getImpact####rates####",Q.toString());const I=K.value.getPriceImpactPct(c,Q.toString(),f);return console.log(I,"t===>"),I}return"--"},so=g(0),io=g(0),lo=g(),ae=g({}),Do=async n=>{if(k.value&&(console.log(Number(t.value)==0,"===>Number(fromCoinAmount.value)==0"),!(p.value&&Number(t.value)==0)&&!(!p.value&&Number(l.value)==0)))if(i.value&&r.value&&(t.value||l.value)){y.value=!0,L.value=!0,ne.value=!1;const c=i.value.address===k.value.coinA.address&&r.value.address===k.value.coinB.address?0:1;console.log(k.value,"poolInfo=====>451"),console.log(p.value?t.value:l.value,"fixedFromCoin.value ? fromCoinAmount.value : toCoinAmount.value"),console.log(c,"===>direct");try{let a=await K.value.preSwap({pool:k.value,a2b:c==0,byAmountIn:p.value,amount:p.value?t.value:l.value});console.log(a,"preSwapRespreSwapRes"),ne.value=a==null?void 0:a.isExceed,lo.value=a==null?void 0:a.estimatedFeeAmount,p.value?(l.value=a.estimatedAmountOut,me.value=(Number(a.estimatedAmountOut)/n).toString(),de.value=(n/Number(a.estimatedAmountOut)).toString()):(t.value=a.estimatedAmountIn,me.value=(n/Number(a.estimatedAmountIn)).toString(),de.value=(Number(a.estimatedAmountIn)/n).toString()),console.log(de.value,me.value,"===>831"),so.value=new s(l.value).div(t.value).toString(),io.value=new s(t.value).div(l.value).toString(),console.log("0524###getAmount###toAddLiquidiPoolInfo.value ###",ae.value),console.log("0524###getAmount###poolInfo.value ###",k.value),Te.value=F.value=="Aptos"?await Ue(k.value):await Ue(ae.value||k.value),y.value=!1,L.value=!1}catch(a){console.log("pre swap error",a),y.value=!1,L.value=!1}}else p.value?l.value="":t.value="",y.value=!1,L.value=!1},Eo=fn(),te=R(()=>Eo),Wo=g({}),de=g(""),me=g(""),se=R(()=>te.value.assets&&i.value&&te.value.assets[i.value.address]?yo(te.value.assets[i.value.address].balance,i.value.decimals):0),ue=R(()=>te.value.assets&&r.value&&te.value.assets[r.value.address]?yo(te.value.assets[r.value.address].balance,r.value.decimals):0),qo=Io();x(()=>m.value.tokensObj,async n=>{if(!$e(n)){console.log(n,"===>newValue626"),console.log(qo,"===>route625");const c=e?e.currentRoute.value.query.to:"",a=e?e.currentRoute.value.query.from:"";a?i.value=await K.value.getTokenBySymbol(n,a):!a&&!i.value&&(i.value=await K.value.getTokenBySymbol(n,ve[F.value].swapDefaultPair.fromCoin),console.log(i.value,"===>fromCoin.value")),c?r.value=await K.value.getTokenBySymbol(n,c):!c&&!r.value&&(r.value=await K.value.getTokenBySymbol(n,ve[F.value].swapDefaultPair.toCoin)),!a&&c&&(i.value="",console.log("我清空了fromCoin"))}},{immediate:!0});const k=R(()=>{var n,c,a,f,C;if(i.value&&r.value){let h=null,N={};if(console.log(r.value.address,"===>toCoin.value.address930"),Object.values(m.value.poolConfigList).forEach(I=>{var T,G,oe,we;(I.coinA.address.toUpperCase()===((T=i.value.address)==null?void 0:T.toUpperCase())&&I.coinB.address.toUpperCase()===((G=r.value.address)==null?void 0:G.toUpperCase())||I.coinB.address.toUpperCase()===((oe=i.value.address)==null?void 0:oe.toUpperCase())&&I.coinA.address.toUpperCase()===((we=r.value.address)==null?void 0:we.toUpperCase()))&&(console.log(I,"p===>"),N[I.address]={...I})}),F.value=="Aptos"&&m.value.poolsObj&&!$e(m.value.poolsObj))for(const I in m.value.poolsObj){const T=m.value.poolsObj[I];(T.token_a.address.toUpperCase()===((n=i.value.address)==null?void 0:n.toUpperCase())&&T.token_b.address.toUpperCase()===((c=r.value.address)==null?void 0:c.toUpperCase())||T.token_b.address.toUpperCase()===((a=i.value.address)==null?void 0:a.toUpperCase())&&T.token_a.address.toUpperCase()===((f=r.value.address)==null?void 0:f.toUpperCase()))&&(N[T.address]={...T})}console.log(N,"===>currentPoolsObj");const Q=Object.values(N).sort((I,T)=>I.fee-T.fee);console.log("0507####swap###poolInfo###poolSortList###",Q);for(let I=0;I<Q.length;I++)if(!((C=Q[I])!=null&&C.is_pause)){h=Q[I];break}return h=Object.values(N).sort((I,T)=>I.fee-T.fee)[0],console.log(N,"currentPoolsObj===>"),console.log("0507####swap###poolInfo###info###",h),h&&!$e(h)?h:null}return null}),uo=g(!0),ro=g(!1),Jo=async n=>{n&&F.value=="Aptos"&&(Ie(p.value?t.value:l.value),ro.value=!0,n.coinA.symbol.toLowerCase()===i.value.symbol.toLowerCase()&&n.coinB.symbol.toLowerCase()===r.value.symbol.toLowerCase()?uo.value=!0:uo.value=!1,ne.value=!1)};x(()=>k.value,(n,c)=>{n&&(!c||n.address!==c.address||n.current_sqrt_price!==c.current_sqrt_price)&&Jo(n)},{immediate:!0,deep:!0});const Qo=R(()=>m.value.tokensObj&&i.value&&i.value.address&&m.value.tokensObj[i.value.address]&&m.value.tokensObj[i.value.address].logoURI),Xo=R(()=>(console.log(m.value.tokensObj,"===>pools.value.tokensObj"),m.value.tokensObj&&r.value&&r.value.address&&m.value.tokensObj[r.value.address]&&m.value.tokensObj[r.value.address].logoURI)),zo=R(()=>F.value==="Aptos"?m.value.tokensObj&&i.value&&i.value.address&&m.value.tokensObj[i.value.address]&&m.value.tokensObj[i.value.address].coingecko_id||null:m.value.tokensObj&&i.value&&i.value.address||null),Ho=R(()=>F.value==="Aptos"?m.value.tokensObj&&r.value&&r.value.address&&m.value.tokensObj[r.value.address]&&m.value.tokensObj[r.value.address].coingecko_id||null:m.value.tokensObj&&r.value&&r.value.address||null),Yo=R(()=>{var n,c,a,f,C,h,N,Q,I;return(a=(c=m==null?void 0:m.value)==null?void 0:c.tokensObj[(n=i==null?void 0:i.value)==null?void 0:n.address])!=null&&a.pyth_id&&((h=(C=m==null?void 0:m.value)==null?void 0:C.tokensObj[(f=i==null?void 0:i.value)==null?void 0:f.address])==null?void 0:h.pyth_id)!=="0x0000000000000000000000000000000000000000000000000000000000000000"?"pyth":(I=(Q=m==null?void 0:m.value)==null?void 0:Q.tokensObj[(N=i==null?void 0:i.value)==null?void 0:N.address])!=null&&I.coingecko_id?"coingecko":null}),Zo=R(()=>{var n,c,a,f,C,h,N,Q,I;return(a=(c=m==null?void 0:m.value)==null?void 0:c.tokensObj[(n=r==null?void 0:r.value)==null?void 0:n.address])!=null&&a.pyth_id&&((h=(C=m==null?void 0:m.value)==null?void 0:C.tokensObj[(f=r==null?void 0:r.value)==null?void 0:f.address])==null?void 0:h.pyth_id)!=="0x0000000000000000000000000000000000000000000000000000000000000000"?"pyth":(I=(Q=m==null?void 0:m.value)==null?void 0:Q.tokensObj[(N=r==null?void 0:r.value)==null?void 0:N.address])!=null&&I.coingecko_id?"coingecko":null}),Ko=R(()=>{var f,C,h;const n=new s(t.value);console.log(ae.value,"===>toAddLiquidiPoolInfo"),console.log((f=ae==null?void 0:ae.value)==null?void 0:f.fee,"toAddLiquidiPoolInfo?.value?.fee");const c=new s(F.value=="Aptos"?(C=k==null?void 0:k.value)==null?void 0:C.fee:(h=ae==null?void 0:ae.value)==null?void 0:h.fee),a=n.mul(c).toString();return console.log(a,"===>fee"),Number(a)<1/Math.pow(10,i.value.decimals)?`<${new s(1).div(new s(Math.pow(10,i.value.decimals))).toString()}`:ie(a,i.value.decimals)}),{setIsShowSuccess:Go,setIsShowRejected:co,setIsShowWaiting:Me,setTransactionDesc:Vo,setTransactionTxid:mo}=O,xo=async()=>{var c,a,f,C,h,N,Q,I;j.value=!1,y.value=!0,clearInterval(Pe),window.clearInterval(Pe),mo(""),Vo(A("tips.swapping",{from:`${t.value} ${(c=i.value)==null?void 0:c.symbol}`,to:`${l.value} ${(a=r.value)==null?void 0:a.symbol}`})),Me(!0);let n;F.value=="Aptos"&&(n=i.value.address===k.value.token_a.address&&r.value.address===k.value.token_b.address?0:1);try{console.log("0221####swap start####",F.value,"###",K),console.log("0412###toSwap###poolInfo.value###",k.value);let T;F.value=="Aptos"?T=await K.value.getSwapTransactionPayload({pool:k.value,a2b:n==0,byAmountIn:p.value,amount:p.value?t.value:l.value,slippage:Number(ge.value)/100}):(console.log(ae.value,"===>toAddLiquidiPoolInfo.value"),T=await je.value.swapRouterContract.getSwapRouterPayload(Le.value,Number(ge.value)/100)),console.log("0221####swap###swapPayload###",T);let G;if(F.value==="Aptos")G=await te.value.currentWallet.signAndSubmitTransaction(T);else{console.log("0221###swap###sui##signAndExecuteTransaction前###",F.value,"###swapPayload###",T);const oe=await te.value.currentWallet.signAndExecuteTransactionBlock(T);console.log("0221###sui swap res###",oe),G=K.value.handleTx(oe),console.log("0221###swap###sui##tx###",G)}if(G&&G.hash){mo(G.hash),Me(!1),Go(!0);const oe={title:A("tips.swap"),desc:A("tips.swapSuccessText",{from:`${t.value} ${(f=i.value)==null?void 0:f.symbol}`,to:`${l.value} ${(C=r.value)==null?void 0:C.symbol}`}),hash:G.hash,tit:"Swap",type:"liquidity",action:"swap",isHaveSui:i.value.address==ve[F.value].currentChainTokenAddress||r.value.address==ve[F.value].currentChainTokenAddress,icon:"icon-icon-swap1",tokenInfo:{tokena:`${(h=i.value)==null?void 0:h.address}`,numa:`- ${t.value}`,logoa:m.value.tokensObj&&i.value&&i.value.address&&m.value.tokensObj[i.value.address]&&m.value.tokensObj[i.value.address].logoURI,tokenb:`${(N=r.value)==null?void 0:N.address}`,numb:`+ ${l.value}`,logob:m.value.tokensObj&&r.value&&r.value.address&&m.value.tokensObj[r.value.address]&&m.value.tokensObj[r.value.address].logoURI},text:`Pay ${t.value} ${(Q=i.value)==null?void 0:Q.symbol} to receive ${l.value} ${(I=r.value)==null?void 0:I.symbol}`};F.value!=="Aptos"&&(oe.res=G.res),K.value.showTransitionPending(oe);const we=await K.value.watchTransaction(oe);console.log("0221###swap###transitionStatus####",we),we&&setTimeout(()=>{F.value=="Aptos"&&W.updateCurrentPools(k.value.poolAddress,F.value),K.value.getAccount(te.value.address)},1e3)}else Me(!1),co(!0);t.value="",l.value="",y.value=!1}catch(T){t.value="",l.value="",console.log("Swap Error###",T),y.value=!1,Me(!1),co(!0)}},en=n=>{var c;return(n==null?void 0:n.logoURI)||(n==null?void 0:n.logo_url)||((c=m.value.tokensObj[n==null?void 0:n.address])==null?void 0:c.logo_url)||(O.theme==="default"?ce("/image/coins/unknown.png"):ce("/image/coins/sui-unknown.png"))},vo=g([]);x(()=>[i.value,r.value,m.value.poolConfigList],([n,c,a])=>{if(a&&a.length>0&&n&&c){const f=[];a.forEach(C=>{var h,N,Q,I;(C.coinA.address.toUpperCase()===((h=n.address)==null?void 0:h.toUpperCase())&&C.coinB.address.toUpperCase()===((N=c.address)==null?void 0:N.toUpperCase())||C.coinB.address.toUpperCase()===((Q=n.address)==null?void 0:Q.toUpperCase())&&C.coinA.address.toUpperCase()===((I=c.address)==null?void 0:I.toUpperCase()))&&(C!=null&&C.is_pause||f.push(C.address))}),console.log(f,"result===>"),vo.value=f}},{immediate:!0});const Ke=n=>{console.log(J.value,"===>currentCoinKey.value"),console.log(n);const c=localStorage.getItem(n.address);console.log(m.value.tokensObj,"===>pools.value.tokensObj"),console.log(c,"===>coinLocak"),m.value.tokensObj&&m.value.tokensObj[n.address]&&m.value.tokensObj[n.address].isSelfBuilt&&!c?Ge.value=!0:(J.value==="fromCoin"?(t.value="",r.value&&n.address.toLowerCase()===(r==null?void 0:r.value.address.toLowerCase())&&(r.value=null),i.value=n):(i.value&&(l.value="",n.address.toLowerCase()===(i==null?void 0:i.value.address.toLowerCase())&&(i.value=null)),r.value=n),po())},Ge=g(!1),po=()=>{He.value={},ze.value={},Ge.value=!1},on=R(()=>O.isShowRouterModal),Ve=g([]),go=g(""),nn=g(!1),fo=An(),je=R(()=>fo),ke=g(!1),Le=g({}),ho=g(""),Co=n=>{console.log("0711###getSuiSwapFee###swapRouter###",n);const{splitPaths:c}=n;let a=new s(0);c.forEach((C,h)=>{const N=C.basePaths[0],Q=N.label==="Cetus"?new s(N.feeRate).div(Math.pow(10,6)):new s(N.feeRate).div(Math.pow(10,9)),I=new s(N.inputAmount).div(Math.pow(10,i.value.decimals)).mul(Q);if(a=a.add(I),console.log(a.toString(),"1431"),console.log(h,"@0711getSuiSwapFee#####","ele.basePaths[0]###",C.basePaths[0].currentPrice.toString()),C.basePaths[1]){const T=C.basePaths[1];console.log(h,"@0711getSuiSwapFee#####","ele.basePaths[1]###",C.basePaths[1].currentPrice.toString());const G=N.direction?N.currentPrice:new s(1).div(N.currentPrice),oe=T.direction?T.currentPrice:new s(1).div(C.basePaths[1].currentPrice),we=T.label==="Cetus"?new s(T.feeRate).div(Math.pow(10,6)):new s(T.feeRate).div(Math.pow(10,9)),eo=new s(T.outputAmount).div(Math.pow(10,r.value.decimals)).mul(we).div(G.mul(oe));console.log(h,"@0711getSuiSwapFee#####","price1###",G.toString()),console.log(h,"@0711getSuiSwapFee#####","price2###",oe.toString()),console.log(h,"@0711getSuiSwapFee#####","price1.mul(price2)###",G.mul(oe).toString()),console.log(h,"@0711getSuiSwapFee#####","new Decimal(1).div(price1.mul(price2))###",new s(1).div(G.mul(oe)).toString()),console.log(h,"@0711getSuiSwapFee#####","fee2###",eo.toString()),console.log(eo.toString(),144611),a=a.add(eo)}});const f=a.toNumber();console.log(f,"===>feeText"),ho.value=f>0&&f<1e-6?"<0.000001":Y(ie(f,i.value.decimals))},xe=(n,c)=>c.minus(n).div(c).mul(100),wo=async n=>{console.log("0711###getSuiPriceImpact####swapRouter###",n);const{splitPaths:c}=n;let a=new s(0);c.forEach((f,C)=>{if(f.basePaths.length===1){const h=f.basePaths[0],N=new s(h.outputAmount).div(Math.pow(10,h.toDecimal)),Q=new s(h.inputAmount).div(Math.pow(10,h.fromDecimal)),I=N.div(Q),T=h.direction?new s(h.currentPrice):new s(1).div(h.currentPrice);console.log("getSuiPriceImpact###",C,"####outputAmount###",N.toString()),console.log("getSuiPriceImpact###",C,"####inputAmount###",Q.toString()),console.log("getSuiPriceImpact###",C,"####rate###",I.toString()),console.log("getSuiPriceImpact###",C,"####cprice###",T.toString()),console.log("getSuiPriceImpact###",C,"####path.currentPrice###",h.currentPrice.toString()),console.log("getSuiPriceImpact###",C,"####calculateSingleImpact(rate, cprice)###",xe(I,T)),a=a.add(xe(I,T)),console.log("getSuiPriceImpact###",C,"####impactValue###",a.toString())}else{const h=f.basePaths[0].direction?new s(f.basePaths[0].currentPrice):new s(1).div(f.basePaths[0].currentPrice),N=f.basePaths[1].direction?new s(f.basePaths[1].currentPrice):new s(1).div(f.basePaths[1].currentPrice),Q=h.mul(N),I=new s(f.basePaths[1].outputAmount).div(Math.pow(10,f.basePaths[1].toDecimal)),T=new s(f.basePaths[0].inputAmount).div(Math.pow(10,f.basePaths[0].fromDecimal)),G=I.div(T);a=a.add(xe(G,Q)),console.log("getSuiPriceImpact###",C,"####cprice1###",h.toString()),console.log("getSuiPriceImpact###",C,"####ele.basePaths[0].currentPrice###",f.basePaths[0].currentPrice.toString()),console.log("getSuiPriceImpact###",C,"####cprice2###",N.toString()),console.log("getSuiPriceImpact###",C,"####ele.basePaths[1].currentPrice###",f.basePaths[1].currentPrice.toString()),console.log("getSuiPriceImpact###",C,"####cprice###",Q.toString()),console.log("getSuiPriceImpact###",C,"####rate###",G.toString()),console.log("getSuiPriceImpact###",C,"####impactValue###",a.toString())}}),console.log("0711###getSuiPriceImpact###impactValue.toNumber()####",a.toNumber()),Te.value=Number(ie(a.toNumber(),2))},bo=async n=>{if(i.value&&r.value&&(Number(t.value)>0||Number(l.value)>0)){console.log(new Date().getTime(),"开始计算时间戳"),console.log("执行吧"),(!t.value&&l.value||t.value&&!l.value)&&(y.value=!0),ye.value=!0,ke.value=!1,console.log(k.value,"==>poolInfo.value.");let c;k.value&&(c=i.value.address===k.value.coinA.address&&r.value.address===k.value.coinB.address?0:1);try{let a;if(p.value){const N=new s(t.value).mul(Math.pow(10,i.value.decimals)).toString();a=new Ee(N)}else{const N=new s(l.value).mul(Math.pow(10,r.value.decimals)).toString();a=new Ee(N)}console.log(a.toString(),"====>1498");const f=Number(ge.value)/100;console.log(je.value,"===>swapRouterContract.value");const C=k.value?{poolAddresses:vo.value,coinTypeA:k.value.coin_a_address,coinTypeB:k.value.coin_b_address,decimalsA:k.value.coinA.decimals,decimalsB:k.value.coinB.decimals,a2b:c==0,byAmountIn:p.value,amount:p.value?t.value:l.value}:"",h=await je.value.swapRouterContract.getSwapRouter(i,r,a,p.value,f,"",k.value?C:"");if(console.log(new Date().getTime(),"计算完成时间戳"),console.log(h,"===> swapRouter1454"),h&&!h.isExceed&&h.splitPaths&&h.splitPaths.length==0){ke.value=!0;return}h?(Le.value=h,Ve.value=h.paths,ne.value=h.isExceed,console.log(h.isExceed,ne.value,"===>swapRouter.isExceed"),Co(h),p.value?t.value&&(l.value=new s(h.outputAmount).div(new s(Math.pow(10,r.value.decimals))).toString()):l.value&&(t.value=new s(h.inputAmount).div(new s(Math.pow(10,i.value.decimals))).toString()),de.value=Y(le(new s(t.value).div(new s(l.value).toString()),i.value.decimals)),me.value=Y(le(new s(l.value).div(t.value).toString(),r.value.decimals)),wo(h),y.value=!1,ke.value=!1,ye.value=!1):(y.value=!1,ke.value=!0,ye.value=!1)}catch(a){console.log("pre swap error",a),y.value=!1,ye.value=!1}}else p.value?l.value="":t.value="",y.value=!1,ye.value=!1;console.log(y.value,"====>routerSwaping")},fe=g(!1),Ao=async n=>{console.log("3s执行一次");try{let c;if(p.value){const C=new s(t.value).mul(Math.pow(10,i.value.decimals)).toString();c=new Ee(C)}else{const C=new s(l.value).mul(Math.pow(10,r.value.decimals)).toString();c=new Ee(C)}const a=Number(ge.value)/100,f=await je.value.swapRouterContract.getSwapRouter(i,r,c,p.value,a,"");f&&(Le.value=f,Ve.value=f.paths,ne.value=f.isExceed,console.log(f.isExceed,ne.value,"===>swapRouter.isExceed"),go.value=f.amountIn,Co(f),de.value=Y(le(new s(t.value).div(new s(l.value).toString()),i.value.decimals)),me.value=Y(le(new s(l.value).div(t.value).toString(),r.value.decimals)),wo(f),p.value?l.value!==f.amountOut&&(fe.value=!0,l.value=f.amountOut):t.value!==f.amountIn&&(fe.value=!0,t.value=f.amountIn))}catch(c){console.log("pre swap error",c)}},an=async n=>{if(i.value&&r.value&&(t.value||l.value)){const c=i.value.address===k.value.coinA.address&&r.value.address===k.value.coinB.address?0:1;try{let a=await K.value.preSwap({pool:k.value,a2b:c==0,byAmountIn:p.value,amount:p.value?t.value:l.value});console.log(a,"preSwapRespreSwapRes"),ne.value=a==null?void 0:a.isExceed,lo.value=a==null?void 0:a.estimatedFeeAmount,p.value?(me.value=(Number(a.estimatedAmountOut)/a.estimatedAmountIn).toString(),de.value=(a.estimatedAmountIn/Number(a.estimatedAmountOut)).toString()):(me.value=(Number(a.estimatedAmountOut)/Number(a.estimatedAmountIn)).toString(),de.value=(Number(a.estimatedAmountIn)/Number(a.estimatedAmountOut)).toString()),p.value?l.value!==a.estimatedAmountOut&&(fe.value=!0,l.value=a.estimatedAmountOut):t.value!==a.estimatedAmountIn&&(fe.value=!0,t.value=a.estimatedAmountIn),console.log(de.value,me.value,"===>831"),console.log(fe.value,"==>isShowAccept.value"),Te.value=F.value=="Aptos"?await Ue(k.value):await Ue(ae.value||k.value),y.value=!1,L.value=!1}catch(a){console.log("pre swap error",a),y.value=!1,L.value=!1}}else y.value=!1,L.value=!1};let Pe=g(null);x(()=>j.value,n=>{n?(console.log("我开启了"),Pe.value=setInterval(()=>{F.value=="Aptos"?an(p.value):Ao(p.value)},3e3)):(console.log("我关闭了"),clearInterval(Pe.value),window.clearInterval(Pe.value))},{immediate:!0});const Ie=async n=>{F.value=="Aptos"?Do(n):(console.log("调用sui"),bo())},tn=R(()=>fo),sn=R(()=>tn.value.isInitRouter);x(()=>sn.value,n=>{n||(M.value=0,Ie(p.value?t.value:l.value))},{immediate:!0}),x(()=>[i.value,r.value],([n,c])=>{if(n&&c&&(M.value=0,Ie(p.value?t.value:l.value)),n||c){const a=`/swap?from=${n==null?void 0:n.address}&to=${c==null?void 0:c.address}`;e.push(a)}},{immediate:!0});function ln(n,c=500){let a=null;return function(...f){clearTimeout(a),a=setTimeout(()=>{n.call(this,...f)},c)}}const un=ln(So);function So(){console.log("====>调用了几次");const n=i.value;i.value=r.value,r.value=n,_.value=!0,p.value=!p.value,p.value?(t.value=l.value,l.value=""):(l.value=t.value,t.value=""),setTimeout(()=>{_.value=!1},300)}return{closeSwapConfirmModal:()=>{j.value=!1,fe.value=!1},updateAccept:()=>{fe.value=!1},clickExchange:So,debounceClickExchange:un,closeTokenWarning:po,isShowTokenWarning:Ge,getTokenSource:Ke,hasPool:ro,getPoolInfoSuccess:ao,halfBtnSelect:Lo,formCoinId:zo,toCoinId:Ho,formCoinMarket:Yo,toCoinMarket:Zo,fromCoinUrl:Qo,toCoinUrl:Xo,t:A,indicator:v,wallet:te,currentLpInfo:Wo,fixD:qe,decimalFormat:dn,impact:Te,oneFromAmount:de,oneToAmount:me,importIcon:ce,clickRefresh:Ze,refresh:B,change:_,isShowAddress:z,isShowSwapSetting:P,fromCoin:i,toCoin:r,slippage:ge,openCoinSelect:Uo,onCoinSelect:Mo,existingCoins:S,lastSelectCoin:Z,currentCoinKey:J,showCoinSelect:$,fromCoinAmount:t,toCoinAmount:l,maxBtnSelect:jo,fixedFromCoin:p,swapBtnText:To,toSwap:xo,loading:U,swaping:y,autoRefreshTime:E,countdown:M,marketTimer:Se,rateChange:D,isSwapConfirmMpdal:j,fromCoinBlance:se,toCoinBlance:ue,poolInfo:k,chainName:F,swapRouterLoading:ye,formatFee:Ko,calculating:L,currentRate:so,currentRateReverse:io,getCoinIcon:en,toAddLiquidiPoolInfo:ae,decimalUi:le,warningToCoin:He,warningFromCoin:ze,isShowRouterModal:on,toSwapLoading:nn,insufficientLiquidity:ne,routerPool:Ve,routerTotalAmounts:go,store:O,suiPreSwapdata:Le,suiSwapFee:ho,addCommom:Y,debounce:We,notFoundRouter:ke,getSuiAmountAccept:Ao,isShowAccept:fe,getSuiAmount:bo}}});const Ae=e=>(_e("data-v-b40c50b6"),e=e(),Be(),e),ls={class:"swap-container"},us={class:"title"},rs={class:"left"},cs={class:"right title-right"},ds=Ae(()=>o("svg",{class:"icon","aria-hidden":"true"},[o("use",{"xlink:href":"#icon-a-icon-setslippage"})],-1)),ms={class:"swap-card"},vs={class:"card-container"},ps={class:"card-item"},gs={class:"card-item"},fs=Ae(()=>o("use",{"xlink:href":"#icon-icon-swap1"},null,-1)),hs=[fs],Cs={key:1,class:"induction"},ws={key:0,class:"exchange-rate-btn"},bs={key:0},As={key:0},Ss={key:0},ys={key:1},ks={key:0},Is=Ae(()=>o("use",{"xlink:href":"#icon-a-icon-change2"},null,-1)),Ps=[Is],$s={class:"item"},Ns={class:"induction-text"},Rs={key:0,class:"icon","aria-hidden":"true"},Os=Ae(()=>o("use",{"xlink:href":"#icon-icon-warning1"},null,-1)),_s=[Os],Bs={class:"item"},Fs={class:"induction-text"},Ts={key:0,class:"induction-value"},Us={class:"item"},Ms={class:"induction-text"},js={key:0,class:"induction-value"},Ls={key:0,class:"icon","aria-hidden":"true"},Ds=Ae(()=>o("use",{"xlink:href":"#icon-icon-swap"},null,-1)),Es=[Ds],Ws={key:2,class:"token-info-container"},qs={class:"token-info-title"},Js=Ae(()=>o("span",{class:"coingecko"},"Price Reference",-1)),Qs=Ae(()=>o("svg",{class:"icon","aria-hidden":"true"},[o("use",{"xlink:href":"#icon-icon-information"})],-1));function Xs(e,v,A,b,O,W){var t,l;const m=rn,_=cn,B=aa,z=No,P=Ro,D=Fo,j=hn,J=Cn,S=wn,Z=Oo,$=Fa,p=bn,U=mt,y=ss,L=Oe("image");return d(),w("div",ls,[o("div",us,[o("div",rs,u(e.$t("menu.swap")),1),o("div",cs,[o("div",{class:"slippage-icon",onClick:v[0]||(v[0]=E=>e.isShowSwapSetting=!0)},[ds,o("span",null,u(e.slippage)+"%",1)]),he(m,{loading:e.refresh,"auto-refresh-time":e.autoRefreshTime,countdown:e.countdown,onClickRefresh:e.clickRefresh},null,8,["loading","auto-refresh-time","countdown","onClickRefresh"])])]),o("div",ms,[o("div",vs,[o("div",ps,[he(_,{modelValue:e.fromCoinAmount,"onUpdate:modelValue":v[1]||(v[1]=E=>e.fromCoinAmount=E),"input-value":e.fromCoinAmount,"coin-symbol":e.fromCoin?e.fromCoin.symbol:null,"coin-name":e.fromCoin?e.fromCoin.name:null,balance:e.fromCoinBlance,"coin-icon":e.fromCoin?e.fromCoin.logo_url:"",address:e.fromCoin?e.fromCoin.address:"","swap-direction":"From",onOnMax:v[2]||(v[2]=E=>e.maxBtnSelect("fromCoin")),onOnHalf:v[3]||(v[3]=E=>e.halfBtnSelect("fromCoin")),onOnInput:v[4]||(v[4]=E=>{e.fromCoinAmount=E,e.fixedFromCoin=!0}),onOnSelect:v[5]||(v[5]=E=>e.openCoinSelect("fromCoin"))},null,8,["modelValue","input-value","coin-symbol","coin-name","balance","coin-icon","address"])]),o("div",gs,[he(_,{modelValue:e.toCoinAmount,"onUpdate:modelValue":v[6]||(v[6]=E=>e.toCoinAmount=E),"input-value":e.toCoinAmount,havemax:!1,"coin-symbol":e.toCoin?e.toCoin.symbol:null,"coin-name":e.toCoin?e.toCoin.name:null,balance:e.toCoinBlance,"swap-direction":"To","coin-icon":e.toCoin?e.toCoin.logo_url:"",address:e.toCoin?e.toCoin.address:"",onOnInput:v[7]||(v[7]=E=>{e.toCoinAmount=E,e.fixedFromCoin=!1}),onOnSelect:v[8]||(v[8]=E=>e.openCoinSelect("toCoin"))},null,8,["modelValue","input-value","coin-symbol","coin-name","balance","coin-icon","address"])]),o("img",{class:pe(e.change?"gang animationex":"gang"),src:Sn,alt:""},null,2),o("div",{class:pe(["exchange",e.chainName=="Sui"?"sui-exchange":""]),onClick:v[9]||(v[9]=(...E)=>e.debounceClickExchange&&e.debounceClickExchange(...E))},[(d(),w("svg",{class:pe(e.change?"icon animationex":"icon"),"aria-hidden":"true"},hs,2))],2)]),e.chainName=="Sui"&&!e.notFoundRouter?(d(),H(B,{key:0,"swap-loading":e.swaping,"from-coin-amount":e.fromCoinAmount,"to-coin-amount":e.toCoinAmount,"from-coin":e.fromCoin,"to-coin":e.toCoin,"fixed-from-coin":e.fixedFromCoin,"router-pool":e.routerPool,impact:e.impact,"insufficient-liquidity":e.insufficientLiquidity,"one-to-amount":e.oneToAmount,"one-from-amount":e.oneFromAmount,"sui-pre-swapdata":e.suiPreSwapdata,"sui-swap-fee":e.suiSwapFee,"swap-router-loading":e.swapRouterLoading},null,8,["swap-loading","from-coin-amount","to-coin-amount","from-coin","to-coin","fixed-from-coin","router-pool","impact","insufficient-liquidity","one-to-amount","one-from-amount","sui-pre-swapdata","sui-swap-fee","swap-router-loading"])):e.poolInfo&&e.fromCoinAmount&&e.toCoinAmount&&e.fromCoinAmount!=="0"&&e.toCoinAmount!=="0"&&e.swapBtnText!==e.$t("button.poolNotFound")?(d(),w("div",Cs,[Number(e.fromCoinAmount)>0&&Number(e.toCoinAmount)>0?(d(),w("div",ws,[e.rateChange?Number(e.fromCoinAmount)&&Number(e.toCoinAmount)&&e.rateChange?(d(),w("span",ys,[Number(e.fromCoinAmount)&&Number(e.toCoinAmount)?(d(),w("span",ks,[V(o("img",null,null,512),[[L,e.toCoinUrl||e.getCoinIcon(e.toCoin)]]),ee(" 1 "+u(e.toCoin.symbol)+" ≈ ",1),V(o("img",null,null,512),[[L,e.fromCoinUrl||e.getCoinIcon(e.fromCoin)]]),o("span",null,u(("addCommom"in e?e.addCommom:X(Y))(("decimalUi"in e?e.decimalUi:X(le))(e.currentRateReverse,e.fromCoin.decimals),e.fromCoin.decimals)),1),ee("  "+u(e.fromCoin.symbol),1)])):(d(),H(z,{key:1,indicator:e.indicator},null,8,["indicator"]))])):q("",!0):(d(),w("span",bs,[V(o("img",null,null,512),[[L,e.fromCoinUrl||e.getCoinIcon(e.fromCoin)]]),ee(" 1 "+u(e.fromCoin.symbol)+" ≈ ",1),Number(e.fromCoinAmount)&&Number(e.toCoinAmount)?(d(),w("span",As,[V(o("img",null,null,512),[[L,e.toCoinUrl||e.getCoinIcon(e.toCoin)]]),e.calculating?q("",!0):(d(),w("span",Ss,u(("addCommom"in e?e.addCommom:X(Y))(("decimalUi"in e?e.decimalUi:X(le))(e.currentRate,e.toCoin.decimals))),1)),e.calculating?(d(),H(z,{key:1,indicator:e.indicator},null,8,["indicator"])):q("",!0),ee("  "+u(e.toCoin.symbol),1)])):(d(),H(z,{key:1,indicator:e.indicator},null,8,["indicator"]))])),(d(),w("svg",{class:"icon-change","aria-hidden":"true",onClick:v[10]||(v[10]=E=>e.rateChange=!e.rateChange)},Ps))])):q("",!0),Number(e.fromCoinAmount)>0&&Number(e.toCoinAmount)>0?(d(),w(oo,{key:1},[o("div",$s,[o("div",Ns,u(e.$t("common.priceImpact")),1),e.swaping?(d(),H(P,{key:1,paragraph:!1,active:""})):(d(),w("div",{key:0,class:pe(["induction-value",Number(e.impact)<1?"impact-s":Number(e.impact)<10&&Number(e.impact)>1?"impact-w":"impact-e"])},[ee(u(Number(e.impact)<.01?"<0.01":Number(e.impact)>100?"100":e.impact)+"% ",1),e.impact>=10?(d(),w("svg",Rs,_s)):q("",!0)],2))]),o("div",Bs,[o("div",Fs,u(e.fixedFromCoin?e.$t("common.minimumReceived"):e.$t("common.maximumSold")),1),e.swaping?(d(),H(P,{key:1,paragraph:!1,active:""})):(d(),w("div",Ts,u(e.fixedFromCoin?("addCommom"in e?e.addCommom:X(Y))(("fixD"in e?e.fixD:X(qe))(Number(e.toCoinAmount)-Number(e.toCoinAmount)*Number(e.slippage)/100,e.toCoin.decimals),e.toCoin.decimals):("addCommom"in e?e.addCommom:X(Y))(("fixD"in e?e.fixD:X(qe))(Number(e.fromCoinAmount)*Number(e.slippage)/100+Number(e.fromCoinAmount),e.fromCoin.decimals),e.fromCoin.decimals))+" "+u(e.fixedFromCoin?e.toCoin.symbol:e.fromCoin.symbol),1))]),o("div",Us,[o("div",Ms,u(e.$t("common.fee")),1),e.swaping?(d(),H(P,{key:1,paragraph:!1,active:""})):(d(),w("div",js,u(("addCommom"in e?e.addCommom:X(Y))(e.formatFee,e.fromCoin.decimals))+" "+u(e.fromCoin.symbol)+" ("+u(e.chainName=="Aptos"?e.poolInfo.fee*100:((t=e.toAddLiquidiPoolInfo)==null?void 0:t.fee)*100)+"%) ",1))])],64)):q("",!0)])):q("",!0)]),he(D,{disabled:e.wallet.connected?e.swaping||!e.fromCoin||!e.toCoin||!Number(e.fromCoinAmount)||!Number(e.toCoinAmount)||Number(e.fromCoinAmount)>Number(e.fromCoinBlance)||e.swapBtnText==e.$t("button.poolNotFound")||e.swapBtnText!==e.$t("button.swap")||((l=e.poolInfo)==null?void 0:l.is_pause)||e.swapRouterLoading:!1,class:"big-btn",loading:e.chainName=="Aptos"?e.swaping:!1,onClick:v[11]||(v[11]=E=>e.wallet.connected?e.isSwapConfirmMpdal=!0:e.wallet.setIsShowWalletModal(!0))},{default:re(()=>[e.wallet.connected?(d(),w("svg",Ls,Es)):q("",!0),o("span",null,u(e.wallet.connected?e.swapBtnText:e.$t("button.connectWallet")),1)]),_:1},8,["disabled","loading"]),he(j),e.showCoinSelect?(d(),H(J,{key:0,"existing-coins":e.existingCoins,"last-select-coin":e.lastSelectCoin,onOnSelect:e.onCoinSelect,onOnClose:v[12]||(v[12]=E=>e.showCoinSelect=!1)},null,8,["existing-coins","last-select-coin","onOnSelect"])):q("",!0),e.isShowSwapSetting?(d(),H(S,{key:1,onOnClose:v[13]||(v[13]=E=>e.isShowSwapSetting=!1)})):q("",!0),e.chainName&&(e.formCoinMarket||e.toCoinMarket)?(d(),w("div",Ws,[o("div",qs,[Js,he(Z,{placement:"top","arrow-point-at-center":""},{title:re(()=>[ee(" The following price is only an external reference from 3rd party data providers, which does not reflect actual data on Cetus. ")]),default:re(()=>[Qs]),_:1})]),e.fromCoin&&e.formCoinMarket?(d(),H($,{key:0,id:e.formCoinId,coin:e.fromCoin,market:e.formCoinMarket,refresh:e.refresh},null,8,["id","coin","market","refresh"])):q("",!0),e.toCoin&&e.toCoinMarket?(d(),H($,{key:1,id:e.toCoinId,coin:e.toCoin,market:e.toCoinMarket,refresh:e.refresh},null,8,["id","coin","market","refresh"])):q("",!0)])):q("",!0),e.chainName=="Sui"&&e.isShowTokenWarning?(d(),H(p,{key:3,"from-coin":e.warningFromCoin,"to-coin":e.warningToCoin,onClose:e.closeTokenWarning,onClickContinue:e.getTokenSource},null,8,["from-coin","to-coin","onClose","onClickContinue"])):q("",!0),e.isShowRouterModal?(d(),H(U,{key:4,"sui-pre-swapdata":e.suiPreSwapdata,"from-coin":e.fromCoin,"to-coin":e.toCoin,"from-coin-amount":e.fromCoinAmount,"to-coin-amount":e.toCoinAmount,onOnClose:v[14]||(v[14]=E=>e.store.setIsShowRouterModal(!1))},null,8,["sui-pre-swapdata","from-coin","to-coin","from-coin-amount","to-coin-amount"])):q("",!0),e.isSwapConfirmMpdal?(d(),H(y,{key:5,"sui-pre-swapdata":e.suiPreSwapdata,"from-coin":e.fromCoin,"to-coin":e.toCoin,"from-coin-amount":e.fromCoinAmount,"to-coin-amount":e.toCoinAmount,slippage:e.slippage,impact:e.impact,"fixed-from-coin":e.fixedFromCoin,fee:e.chainName=="Sui"?e.suiSwapFee:e.poolInfo.fee,"format-fee":e.chainName=="Sui"?e.suiSwapFee:e.formatFee,"is-show-accept":e.isShowAccept,"swap-loading":e.swapRouterLoading,"one-from-amount":e.oneFromAmount,"one-to-amount":e.oneToAmount,onOnClose:e.closeSwapConfirmModal,onToSwap:e.toSwap,onAccept:e.updateAccept},null,8,["sui-pre-swapdata","from-coin","to-coin","from-coin-amount","to-coin-amount","slippage","impact","fixed-from-coin","fee","format-fee","is-show-accept","swap-loading","one-from-amount","one-to-amount","onOnClose","onToSwap","onAccept"])):q("",!0)])}const Ci=Re(is,[["render",Xs],["__scopeId","data-v-b40c50b6"]]);export{Ci as default};
