import{a as lt,b as Kt,n as vt,d as _e,u as ht,e as We,c as Ie,i as Nt,s as ft,T as _t,p as Ct,f as je,g as Pt}from"./pool.68b91df5.js";import{a as ot,r as D,m as I,y as At,D as qe,e as it,o as k,f as O,c as Xe,x as ee,h as a,t as Lt,G as xt,H as gt,v as he,u as Se,F as st,J as kt,p as It,k as qt,i as ze,s as Mt,z as Je,l as $t,E as wt,C as Rt,q as Jt,b as Qt,w as Yt,j as Vt,I as eo,B as to}from"./entry.06373f20.js";/* empty css              */import{s as rt,m as oo,l as io,b as no,a as ro,_ as ao}from"./transform.3fd55c89.js";import{D as u}from"./decimal.0e8aa3f1.js";import{u as ut,a as lo}from"./sha256.97b1e8c2.js";import{_ as so}from"./apr-tips.bde3066d.js";import"./decimal.633e31ee.js";import{g as uo}from"./common-fun.eb6642a4.js";import{c as Bt,_ as Ot,b as Ft,a as Ut}from"./new-liquidity-title.c0a5487f.js";import{i as pt}from"./import-icon.de3e6c66.js";import{positionError as tt,tickList as et,direction as Me,minPrice as W,maxPrice as j,fromCoin as y,toCoin as _,currentPrice as at,currentPriceReverse as bt,currentPriceTab as V,defaultMinPrice as dt,defaultMaxPrice as mt,toggle as jt,priceConfigObj as xe,fromCoinAmount as T,toCoinAmount as A,fixedFromCoin as Te,resetTickList as Tt,resetData as co}from"./data.47fb864e.js";import{_ as mo}from"./coin-select.8caf708b.js";import{_ as vo}from"./viewDetail.bd80f137.js";import{_ as fo}from"./token-warning-modal.fccb03ad.js";import{b as go}from"./new-add-or-create.9f13df24.js";/* empty css              */import{u as po}from"./notifi.2313fd4c.js";import{_ as bo,a as ho}from"./icon-Add-Liquidity_2x.0acb06cb.js";import"./img-lock_2x.18d47711.js";import"./precision.a7a6c57b.js";/* empty css              */import"./tick.505fdad3.js";import"./token-warning.dec0de57.js";/* empty css              */import"./refresh-icon.87a2307b.js";/* empty css              */import"./swap-setting.fe695109.js";/* empty css              */import"./img-no-Positions_2x.7a5f008f.js";import"./status-block.6e12844a.js";import"./icon-arrow_2x.948aedb2.js";import"./icon-arrow_2x.4ffddb8e.js";import"./icon-selected_3x.09e9a6f0.js";import"./useWhale.8949bb19.js";import"./index.c5eb0457.js";function St(e,s,ge){const z=new u(10).pow(s-ge);return new u(1.0001).pow(e).mul(z)}const ko=ot({props:{poolInfo:{type:Object,default:()=>({chartLoading:!1,token_a:{decimal:6},token_b:{decimal:6},currentLiquity:"50000000"})},minPrice:{type:String,default:""},maxPrice:{type:String,default:""},direction:{type:Boolean,default:!0},tickList:{type:Array,default:()=>[]},currentTick:{type:Number,default:0},chartLoading:{type:Boolean,default:!1},currentPriceTab:{type:String,default:""},before7dContractPriceLowest:{type:String,default:""},before7dContractPriceHighest:{type:String,default:""},zoom:{type:Number,default:1}},setup(e,s){const ge=D(""),z=D(""),F=I(()=>{var i,g,r,L,U,Y;return console.log(e.poolInfo,"===>props.poolInfo"),(i=e.poolInfo)!=null&&i.current_sqrt_price&&((g=e.poolInfo)!=null&&g.coinA.decimals)&&((r=e.poolInfo)!=null&&r.coinB.decimals)?l.sqrtPriceX64ToPrice((L=e.poolInfo)==null?void 0:L.current_sqrt_price,(U=e.poolInfo)==null?void 0:U.coinA.decimals,(Y=e.poolInfo)==null?void 0:Y.coinB.decimals).toString():"0"}),ke=I(()=>{let i=0;return e.direction?i=(Number(e.minPrice)/Number(F.value)-1)*100:i=(Number(e.minPrice)/Number(1/Number(F.value))-1)*100,i=i>0&&i<.1?.1:i,i=i<0&&i>-.1?-.1:i,i}),E=I(()=>{let i=0;return e.direction?i=(Number(e.maxPrice)/Number(F.value)-1)*100:i=(Number(e.maxPrice)/Number(1/Number(F.value))-1)*100,i=i>0&&i<.1?.1:i,i=i<0&&i>-.1?-.1:i,i}),q=ut(),w=I(()=>q),J=I(()=>w.value.chainName?lt(w.value.chainName):{}),{TickMath:l,getNearestTickByTick:n}=J.value,Z=(i=[])=>{let g=6;const r=Math.abs(Number(i[0])-Number(i[i.length-1]));return r>=6?g=0:r>=1?g=1:r>=.1?g=2:r>=.01?g=3:r>=.001?g=4:r>=1e-4?g=5:r>=1e-5?g=6:r>=1e-6?g=7:r>=1e-7&&(g=8),g},ne=(i,g=1)=>{if(i&&i.token_a&&!e.chartLoading&&e.minPrice&&e.maxPrice){const r=Number(e.poolInfo.current_tick_index);console.log("0117###dataProcessing###currentTick###",r),console.log("0117###dataProcessing###props.poolInfo###",e.poolInfo),console.log("0117###dataProcessing###minPrice###",e.minPrice),console.log("0117###dataProcessing###maxPrice###",e.maxPrice),console.log("0117###dataProcessing###poolInfo###",e.poolInfo);let L=r+100*g,U=r-100*g,Y,re;if(e.maxPrice==="∞")re=J.value.TickUtil.getMaxIndex(Number(e.poolInfo.tickSpacing));else try{e.direction?re=l.priceToTickIndex(new u(e.maxPrice),e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals):re=l.priceToTickIndex(new u(1).div(e.minPrice),e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals)}catch{re=443636}if(e.minPrice==="0")Y=J.value.TickUtil.getMinIndex(Number(e.poolInfo.tickSpacing));else try{e.direction?Y=l.priceToTickIndex(new u(e.minPrice),e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals):Y=l.priceToTickIndex(new u(1).div(e.maxPrice),e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals)}catch{Y=-443636}let de=0;if(e.currentPriceTab!=="full range"){if(r>=Y&&r<=re){const P=r-Y,oe=re-r;de=Math.max(Math.abs(P),Math.abs(oe))}else r<Y?de=Math.abs(re-r):de=Math.abs(r-Y);L=r+de+100*g,U=r-de-100*g}else{const P=(Math.abs(r)>5e3,2e4);L=r+P*g,U=r-P*g}U<-443636&&(U=-443636),L>443636&&(L=443636);const m=new u(i.liquidity).div(Math.pow(10,8)).toString(),M=e.tickList;console.log("0117####drawChart####tick_info_array####",M);const R=[],C=[];let S={};for(let P=0;P<M.length;P++){if(S=M[P],S.index<=r&&S.index>=U){if(R.length<1&&P!==0){const oe=M[P-1];R.unshift({...oe,index:U})}R.unshift(S)}else if(S.index>r&&S.index<=L&&(C.push(S),R.length<1&&P!==0)){const oe=M[P-1];R.push({...oe,index:U})}if(S.index>L){const oe=M[P];if(C.push({...oe,index:L}),R.length<1&&P!==0){const Ke=M[P-1];R.push({...Ke,index:U})}break}}let X="0";for(let P=R.length-1;P>=0;P--)X=new u(X).plus(new u(R[P].liquidityNet.toString()).div(Math.pow(10,8))).toString(),R[P].liquityAmount=X;let h=m;for(let P=0;P<C.length;P++)h=new u(h).plus(new u(C[P].liquidityNet.toString()).div(Math.pow(10,8))).toString(),C[P].liquityAmount=h;let G=[];const B=M&&M.length>0?{index:r,liquityAmount:Number(m)}:{index:r,liquityAmount:0};(R.length>0||C.length>0)&&(G=[...R.reverse(),B,...C],e.direction||(G=G.reverse()));const Ne=[];M.forEach(P=>{Ne.push({...P,liquidityGross:P.liquidityGross.toString(),liquidityNet:P.liquidityNet.toString()})}),console.log("0117####drawChart####testTickInfoArray####",Ne),console.log("0117####drawChart####currentLiquity####",m),p(G,U,L,Y,re,r)}};let Q=D(!1);At(()=>{document.body.clientWidth<750?Q.value=!1:Q.value=!0,window.onresize=()=>{document.body.clientWidth<750?Q.value=!1:Q.value=!0,ne(e.poolInfo,e.zoom)}});const p=(i,g,r,L,U,Y)=>{console.log("0117####drawChart####chartData####",i),console.log("0117####drawChart####tickMin####",g),console.log("0117####drawChart####tickMax####",r),console.log("0117####drawChart####minPriceTick####",L),console.log("0117####drawChart####maxPriceTick####",U),console.log("0117####drawChart####currentTick####",Y),console.log("0117####drawChart####props.direction####",e.direction),console.log("0518###newd3###props.before7dContractPriceLowest###",e.before7dContractPriceLowest),console.log("0518###newd3###props.before7dContractPriceHighest###",e.before7dContractPriceHighest);let re,de;e.direction?(re=e.before7dContractPriceLowest?l.priceToTickIndex(new u(e.before7dContractPriceLowest),e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals):"",de=e.before7dContractPriceHighest?l.priceToTickIndex(new u(e.before7dContractPriceHighest),e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals):""):(re=e.before7dContractPriceLowest?l.priceToTickIndex(new u(1).div(e.before7dContractPriceLowest),e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals):"",de=e.before7dContractPriceHighest?l.priceToTickIndex(new u(1).div(e.before7dContractPriceHighest),e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals):"");const m={top:30,right:35,bottom:20,left:55};let M,R;Q.value?(M=506-m.left-m.right,R=205-m.top-m.bottom):(M=340-m.left-m.right,R=205-m.top-m.bottom);const C=r-g,S=parseInt(String(C/4));let X=[g+S/4,g+S,g+2*S,r-S,r-S/4];const h=g,G=r,B=M/(G-h);e.currentPriceTab==="full range"&&(X=[g,g+2*S,r]),console.log("0117####drawChart####xArr####",X),console.log("0117####drawChart####utickMin####",h),console.log("0117####drawChart####utickMax####",G),console.log("0117####drawChart####unit####",B);const Ne=X.map(c=>e.direction?St(c,e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals).toString():new u(1).div(St(c,e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals)).toString()),P=Z(Ne);rt("#chart").selectAll("*").remove();const oe=rt("#chart").attr("width",M+m.left+m.right).attr("height",R+m.top+m.bottom).append("g").attr("transform",`translate(${m.left},${m.right})`),Ke=oo(i,function(c){return Number(Math.abs(c.liquityAmount))})||0,t=io().range([0,R]).domain([Ke,0]);no().rangeRound([0,M]).padding(.1);const $=oe.append("g").attr("id","barsBox").selectAll("rect").data(i).enter().append("rect");w.value.theme=="default"?$.attr("x",function(c,d){return d===0?0:e.direction?Math.abs(c.index-h)*B:Math.abs(G-c.index)*B}).attr("y",function(c,d){return e.direction?d===i.length-1?0:t(c.liquityAmount):d===i.length-1?0:t(i[d+1].liquityAmount)}).attr("width",function(c,d){return d===0&&i.length===1&&c.liquityAmount>0?M:(e.direction,d!==i.length-1?Math.abs(i[d+1].index-c.index)*B:0)}).attr("height",function(c,d){return d===0&&i.length===1&&c.liquityAmount>0?R:e.direction?d===i.length-1?0:R-t(c.liquityAmount):d===i.length-1?0:R-t(i[d+1].liquityAmount)}).attr("fill","#279477").attr("class","bars").attr("stroke-width",1).attr("stroke","#279477"):$.attr("x",function(c,d){return d===0?0:e.direction?Math.abs(c.index-h)*B:Math.abs(G-c.index)*B}).attr("y",function(c,d){return e.direction?d===i.length-1?0:t(Math.abs(c.liquityAmount)):d===i.length-1?0:t(Math.abs(i[d+1].liquityAmount))}).attr("width",function(c,d){return d===0&&i.length===1&&c.liquityAmount>0?M:(e.direction,d!==i.length-1?Math.abs(i[d+1].index-c.index)*B:0)}).attr("height",function(c,d){if(d===0&&i.length===1&&c.liquityAmount>0)return R;if(e.direction)return d===i.length-1?0:Number(c.liquityAmount)?R-t(Math.abs(c.liquityAmount)):0;{if(d===i.length-1)return 0;const Be=R-t(Math.abs(i[d+1].liquityAmount));return Number(i[d+1].liquityAmount)?Be:0}}).attr("fill","#407497").attr("class","bars").attr("stroke-width",1).attr("stroke","#407497");const H=oe.append("g");H.append("line").attr("x1",0).attr("y1",155).attr("x2",M).attr("y2",155).attr("stroke-width",1).attr("stroke","#50535D");const Ce=H.append("g");let ae=0;if(e.direction){for(let c=0;c<X.length;c++){const d=_e(Ne[c],P)||"0";console.log("0423####price####",d),Ne.push(d);const Be=Math.abs(X[c]-h)*B;let pe=0;for(let be=0;be<d.length;be++)d[be]==="1"?pe+=4.02:d[be]==="."?pe+=2.64:d[be]==="7"?pe+=5.48:pe+=6;console.log(Be,"x=>>>"),Ce.append("text").text(d).attr("x",Be-pe/2).attr("y",168).attr("fill","rgba(255, 255, 255, 0.5").style("font-size","10")}ae=Math.abs(Y-h)*B}else{for(let c=X.length-1;c>=0;c--){const d=_e(Ne[c],P)||0;Ne.push(d);const Be=Math.abs(X[c]-G)*B;let pe=0;for(let be=0;be<d.length;be++)d[be]==="1"?pe+=4.02:d[be]==="."?pe+=2.64:d[be]==="7"?pe+=5.48:pe+=6;Ce.append("text").text(d).attr("x",Be-pe/2).attr("y",168).attr("fill","rgba(255, 255, 255, 0.5").style("font-size","10")}ae=Math.abs(Y-G)*B}(w.value.theme=="default"?oe.append("line").attr("x1",0).attr("y1",0).attr("x2",0).attr("y2",155).attr("stroke-width",2).attr("stroke","#68FFD8"):oe.append("line").attr("x1",0).attr("y1",0).attr("x2",0).attr("y2",155).attr("stroke-width",2).attr("stroke","#76C8FF")).attr("transform","translate("+ae+", 0)");let Ae,$e,Ze,He;e.direction?(console.log("0525###d3###select###minPriceTick###",L),console.log("0525###d3###select###maxPriceTick###",U),console.log("0525###d3###select###props.minPrice###",e.minPrice),console.log("0525###d3###select###props.maxPrice###",e.maxPrice),Ae=L<h?-100:parseInt(String(Math.abs(L-h)*B)),$e=U<h?-100:parseInt(String(Math.abs(U-h)*B)),Ze=re<h?-100:Math.abs(re-h)*B,He=de<h?-100:Math.abs(de-h)*B):($e=L<h?-100:Math.abs(G-L)*B,Ae=U<h?-100:Math.abs(G-U)*B,He=re<h?-100:Math.abs(G-re)*B,Ze=de<h?-100:Math.abs(G-de)*B),e.minPrice==="0"&&(Ae=0),e.maxPrice==="∞"&&($e=M),Q.value?ge.value=M-Ae+60+"px":ge.value=M-Ae+52+"px",z.value=$e+74+"px",re&&Ze<M&&oe.append("line").attr("x1",0).attr("y1",0).attr("x2",0).attr("y2",155).attr("stroke-width",1).attr("stroke-dasharray","5, 5").attr("stroke","rgba(255, 255, 255, 0.5)").attr("transform","translate("+Ze+", 0)"),de&&He<M&&oe.append("line").attr("x1",0).attr("y1",0).attr("x2",0).attr("y2",155).attr("stroke-width",1).attr("stroke-dasharray","5, 5").attr("stroke","rgba(255, 255, 255, 0.5)").attr("transform","translate("+He+", 0)");const me=oe.append("g").attr("id","left-handle"),Re=oe.append("g").attr("id","right-handle");w.value.theme=="default"?(me.append("line").attr("x1",0).attr("y1",0).attr("x2",0).attr("y2",155).attr("stroke-dasharray","5, 5").attr("stroke-width",2).attr("stroke","#68FFD8"),me.append("path").attr("d","M0 0 L12 0 L12 20 L0 20 Z").attr("fill","#333").attr("stroke","#333").attr("transform","translate(-1, 20) rotate(180)"),me.append("rect").attr("width",1).attr("height",7).attr("x",-9).attr("y",6).attr("fill","#68FFD8"),me.append("rect").attr("width",1).attr("height",10).attr("x",-7).attr("y",4.5).attr("fill","#68FFD8"),Re.append("line").attr("x1",0).attr("y1",0).attr("x2",0).attr("y2",155).attr("stroke-dasharray","5, 5").attr("stroke-width",2).attr("stroke","#68FFD8"),Re.append("path").attr("d","M0 0 L12 0 L12 20 L0 20 Z").attr("fill","#333").attr("stroke","#333").attr("transform","translate(1, 0)"),Re.append("rect").attr("width",1).attr("height",7).attr("x",7).attr("y",6).attr("fill","#68FFD8"),Re.append("rect").attr("width",1).attr("height",10).attr("x",5).attr("y",4.5).attr("fill","#68FFD8")):(me.append("line").attr("x1",0).attr("y1",0).attr("x2",0).attr("y2",155).attr("stroke-dasharray","5, 5").attr("stroke-width",2).attr("stroke","#76C8FF"),me.append("path").attr("d","M0 0 L12 0 L12 24 L0 24 Z").attr("fill","#333").attr("stroke","#333").attr("transform","translate(-1, 24) rotate(180)"),me.append("rect").attr("width",1).attr("height",7).attr("x",-9).attr("y",8).attr("fill","#76C8FF"),me.append("rect").attr("width",1).attr("height",10).attr("x",-7).attr("y",6.5).attr("fill","#76C8FF"),Re.append("line").attr("x1",0).attr("y1",0).attr("x2",0).attr("y2",155).attr("stroke-dasharray","5, 5").attr("stroke-width",2).attr("stroke","#76C8FF"),Re.append("path").attr("d","M0 0 L12 0 L12 24 L0 24 Z").attr("fill","#333").attr("stroke","#333").attr("transform","translate(1, 0)"),Re.append("rect").attr("width",1).attr("height",7).attr("x",7).attr("y",8).attr("fill","#76C8FF"),Re.append("rect").attr("width",1).attr("height",10).attr("x",5).attr("y",6.5).attr("fill","#76C8FF")),console.log("0525###d3###select###minPriceTickX###",Ae),console.log("0525###d3###select###maxPriceTickX###",$e),me.attr("transform","translate("+Ae+", 0)"),Re.attr("transform","translate("+$e+", 0)");const Qe=ro().extent([[0,0],[M,R]]).handleSize(30).on("end",nt);oe.append("g").attr("class","brush").call(Qe).call(Qe.move,[Ae,$e]);function nt(c){if(!c.sourceEvent||!c.selection)return;me.attr("transform","translate("+c.selection[0]+", 0)"),Re.attr("transform","translate("+c.selection[1]+", 0)"),Q.value?ge.value=M-c.selection[0]+60+"px":ge.value=M-c.selection[0]+52+"px",z.value=c.selection[1]+74+"px";let d,Be;console.log("0525###d3###select###e.selection[0]###",c.selection[0]),console.log("0525###d3###select###e.selection[0]###",c.selection[1]),console.log("0525###d3###select###props.direction###",e.direction),console.log("0525###d3###select###width###",M),console.log("0525###d3###select###unit###",B),console.log("0525###d3###select###utickMin###",h),console.log("0525###d3###select###utickMax###",G),console.log("0525###d3###select###props.poolInfo###",e.poolInfo);let pe=0,be=0;e.direction?(pe=n(parseInt(String(c.selection[0]/B+h)),Number(e.poolInfo.tickSpacing)),d=l.tickIndexToPrice(pe,e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals).toString(),be=n(parseInt(String(c.selection[1]/B+h)),Number(e.poolInfo.tickSpacing)),Be=l.tickIndexToPrice(be,e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals).toString(),console.log("0525###d3###select###minTick###",pe),console.log("0525###d3###select###maxTick###",be),console.log("0525###d3###select###minPrice###",d),console.log("0525###d3###select###maxPrice###",Be)):(be=n(G-c.selection[0]/B,Number(e.poolInfo.tickSpacing)),d=1/l.tickIndexToPrice(be,e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals).toString(),pe=n(G-c.selection[1]/B,Number(e.poolInfo.tickSpacing)),Be=1/l.tickIndexToPrice(pe,e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals).toString()),s.emit("onChangeMinPrice",String(_e(String(d),6))),s.emit("onChangeMaxPrice",String(_e(String(Be),6)))}w.value.theme=="default"?rt(".selection").attr("stroke","rgba(255, 255, 255, 0)").attr("fill","#15322C"):rt(".selection").attr("stroke","rgba(255, 255, 255, 0)").attr("fill","#152632")};D(""),qe(()=>[e.poolInfo,e.minPrice,e.maxPrice,e.currentPriceTab,e.zoom],([i,g,r,L,U])=>{console.log(i,g,r,r>g,"poolInfo && minPrice && maxPrice && (maxPrice > minPrice)"),i&&g&&r&&(i!=null&&i.liquidity)&&(L!=="Custom"||console.log("绘制"),ne(i,U))},{immediate:!0});const v=D(!1);return qe(()=>e.chartLoading,(i,g)=>{i!==g&&(v.value=i)},{immediate:!0,deep:!0}),console.log(e,"props===>"),{store:w,loading:v,rangeSizeLower:ke,rangeSizeUpper:E,rangeSizeLowerPosition:ge,rangeSizeUpperPosition:z,decimalFormat:Kt,numberformat:vt}}});const wo=e=>(It("data-v-12735a95"),e=e(),qt(),e),yo={class:"chart-box"},_o={class:"chart"},Co=wo(()=>a("svg",{id:"chart"},null,-1));function Po(e,s,ge,z,F,ke){const E=kt;return k(),O(st,null,[e.tickList&&e.tickList.length>0&&e.loading?(k(),Xe(E,{key:0})):ee("",!0),a("div",yo,[Lt(a("div",_o,[e.currentPriceTab!=="full range"?(k(),O("div",{key:0,class:"range-size range-size-lower",style:gt({right:e.rangeSizeLowerPosition})},he(("numberformat"in e?e.numberformat:Se(vt))(e.rangeSizeLower.toFixed(1),1))+"% ",5)):ee("",!0),e.currentPriceTab!=="full range"?(k(),O("div",{key:1,class:"range-size range-size-upper",style:gt({left:e.rangeSizeUpperPosition})},he(("numberformat"in e?e.numberformat:Se(vt))(e.rangeSizeUpper.toFixed(1),1))+"% ",5)):ee("",!0),Co],512),[[xt,!e.loading]])])],64)}const zt=it(ko,[["render",Po],["__scopeId","data-v-12735a95"]]),To=ot({props:{aprRewardsParameter:{type:Number,default:30},minPrice:{type:String,default:""},maxPrice:{type:String,default:""},fromCoin:{type:Object,default:()=>({})},toCoin:{type:Object,default:()=>({})},poolInfo:{type:Object,default:()=>({})},nameTab:{type:String,default:""}},setup(e){const s=[{label:"24H",value:24},{label:"7D",value:7},{label:"30D",value:30}],ge=ut(),z=I(()=>ge);I(()=>z.value.chainName);const F=ht(),ke=I(()=>F),E=I(()=>z.value.chainName?lt(z.value.chainName):{}),q=D(),w=async n=>{var Y,re,de;console.log("0607###detail###getAprMethod###poolInfo###",n),console.log("0607###detail###getAprMethod###props.fromCoin###",e.fromCoin),console.log("0607###detail###getAprMethod###props.toCoin###",e.toCoin),console.log("0607###detail###getAprMethod###props.nameTab###",e.nameTab);let Z;n.token_a.address.toLowerCase()===e.fromCoin.address.toLowerCase()&&n.token_b.address.toLowerCase()===e.toCoin.address.toLowerCase()?Z=!0:Z=!1,console.log("0607###detail###getAprMethod###directs###",Z),console.log("0607###detail###getAprMethod###props.minPrice###",e.minPrice),console.log("0607###detail###getAprMethod###props.maxPrice###",e.maxPrice);let ne,Q;Z?(ne=Number(e.minPrice),Q=Number(e.maxPrice)):e.maxPrice!=="∞"?(ne=1/Number(e.maxPrice),Q=1/Number(e.minPrice)):(ne=1/2**50,Q=2**50),console.log("0607###detail###getAprMethod###lowerUserPrice###",ne),console.log("0607###detail###getAprMethod###upperUserPrice###",Q);let p=[];p=z.value&&z.value.addressHistTokens&&z.value.addressHistTokens[n.poolAddress]&&z.value.addressHistTokens[n.poolAddress].data&&z.value.addressHistTokens[n.poolAddress].data.length>0&&Object.fromEntries(z.value.addressHistTokens[n.poolAddress].data.map(m=>[m.key,m.value]));let v,i;console.log(p,"===>addressHistTokensList"),e.aprRewardsParameter==7?(v=Number(p==null?void 0:p.before_7_d_contract_price_lowest),i=Number(p==null?void 0:p.before_7_d_contract_price_highest)):e.aprRewardsParameter==24?(v=Number(p==null?void 0:p.before_24_h_contract_price_lowest),i=Number(p==null?void 0:p.before_24_h_contract_price_highest)):(v=Number(p==null?void 0:p.before_30_d_contract_price_lowest),i=Number(p==null?void 0:p.before_30_d_contract_price_highest));const g=ke.value.tokensObj;console.log("getEstPositionAPRWithMulti###params###lowerUserPrice###",ne),console.log("getEstPositionAPRWithMulti###params###upperUserPrice###",Q),console.log("getEstPositionAPRWithMulti###params###lowerHistPrice###",v),console.log("getEstPositionAPRWithMulti###params###upperHistPrice###",i);const r=await E.value.getEstPositionAPRWithMulti(ne,Q,v,i);console.log("getEstPositionAPRWithMulti###resMulti###",r.toString());const L=z.value.newTopPoolsObj[n.poolAddress];let U;if(L){e.aprRewardsParameter==7?U=Number(L.apr_7day.replace("%","")):e.aprRewardsParameter==24?U=Number(L.apr_24h.replace("%","")):U=Number(L.apr_30day.replace("%",""));const m=Number(L.rewarder_apr[0].replace("%","")),M=Number(L.rewarder_apr[1].replace("%","")),R=Number(L.rewarder_apr[2].replace("%","")),C=new u(r.toString()).mul(U).toNumber(),S=new u(r.toString()).mul(m).toNumber(),X=new u(r.toString()).mul(M).toNumber(),h=new u(r.toString()).mul(R).toNumber(),G=C+(n.rewarder_display1?S:0)+(n.rewarder_display2?X:0)+(n.rewarder_display3?h:0),B=n.rewarder_infos[0]?(Y=g[n.rewarder_infos[0].coinAddress])==null?void 0:Y.symbol:"--",Ne=n.rewarder_infos[1]?(re=g[n.rewarder_infos[1].coinAddress])==null?void 0:re.symbol:"--",P=n.rewarder_infos[2]?(de=g[n.rewarder_infos[2].coinAddress])==null?void 0:de.symbol:"--",oe={aprFee:C==1/0||isNaN(C)?0:C,rewardAprList:[{rewarder_name:B,rewarder_apr:S==1/0||isNaN(S)?0:S,styleName:"one",rewarder_display:n.rewarder_display1},{rewarder_name:Ne,rewarder_apr:X==1/0||isNaN(X)?0:X,styleName:"two",rewarder_display:n.rewarder_display2},{rewarder_name:P,rewarder_apr:h==1/0||isNaN(h)?0:h,styleName:"three",rewarder_display:n.rewarder_display2}],aprPercentageTotal:G==1/0||isNaN(G)||G===0?0:G,aprPercentage:Nt(C/G,2),is_display_rewarder:n.is_display_rewarder};q.value=oe,console.log(q.value,"===>aprPercentageObj.value")}};qe(()=>[e.poolInfo,e.minPrice,e.maxPrice,z.value.addressHistTokens],([n,Z,ne,Q])=>{n&&!Ie(n)&&Q&&!Ie(Q)&&w(n)},{immediate:!0});const J=I(()=>uo(e.poolInfo,ke,z));qe(()=>[e.aprRewardsParameter],()=>{w(e.poolInfo)});const l=I(()=>{const n=q.value;return n&&n.is_display_rewarder?(n==null?void 0:n.aprPercentageTotal)>1e4?">10000":n.aprPercentageTotal<.01&&n.aprPercentageTotal>0?"<0.01":We(n.aprPercentageTotal,2):n&&!n.is_display_rewarder?(n==null?void 0:n.aprFee)>1e4?">10000":n.aprFee<.01&&n.aprFee>0?"<0.01":We(n.aprFee,2):"--"});return{poolMoreInfo:J,timeList:s,aprPercentageObj:q,totalApr:l}}}),So=""+globalThis.__publicAssetsURL("sui-image/farming.png");const yt=e=>(It("data-v-34b1930a"),e=e(),qt(),e),No={class:"est-apr"},Ao=yt(()=>a("div",{class:"title"},"Estimated APR",-1)),Lo={class:"apr-total"},Io={class:"apr-box"},qo={class:"apr-hover-content"},Mo={key:0,class:"isFarming"},$o=yt(()=>a("img",{src:So,alt:""},null,-1)),Ro=yt(()=>a("div",{class:"hover-text"},"Farming rewards available",-1)),Bo=[$o,Ro],Oo={class:"time-list"},Fo=["onClick"];function Uo(e,s,ge,z,F,ke){var q,w,J,l;const E=so;return k(),O("div",No,[Ao,a("div",Lo,[a("div",Io,[a("span",null,he(e.totalApr)+"%",1),a("div",qo,[ze(E,{"l-item":e.poolMoreInfo,"rewarder-info":(q=e.poolMoreInfo)==null?void 0:q.rewardes,class:"noHover apr-hover-con"},null,8,["l-item","rewarder-info"])])]),(w=e.poolInfo)!=null&&w.is_display_rewarder&&((J=e.poolInfo)!=null&&J.rewarderInfo)&&((l=e.poolInfo)==null?void 0:l.rewarderInfo.length)>0?(k(),O("div",Mo,Bo)):ee("",!0)]),a("div",Oo,[(k(!0),O(st,null,Mt(e.timeList,n=>(k(),O("div",{key:n.value,class:Je(["time-item",n.value==e.aprRewardsParameter?"time-item-active":""]),onClick:Z=>e.$emit("changeAprRewardsParameter",n.value)},he(n.label),11,Fo))),128))])])}const Ht=it(To,[["render",Uo],["__scopeId","data-v-34b1930a"]]),jo=ot({components:{NewLiquidityD3Chart:zt,NewLiquidityApr:Ht,NewLiquidityPrice:Bt},setup(){const{t:e,locale:s}=$t(),ge=D("liquidity"),z=ut(),F=I(()=>z),ke=I(()=>F.value.chainName),E=ht(),q=I(()=>E),w=I(()=>F.value.chainName?lt(F.value.chainName):{});At(()=>{tt.value=!1});const J=wt(),l=I(()=>{let t=null;for(let b=0;b<q.value.poolConfigList.length;b++){const $=q.value.poolConfigList[b];$.address==J.query.poolAddress&&(t=$)}return console.log(t,"===>basePoolInfo"),t}),n=I(()=>{let t=null;for(const b in q.value.poolsObj){const $=q.value.poolsObj[b];$.address==J.query.poolAddress&&(console.log($,"p===>"),t=$)}return t}),Z=D(),ne=D(!0),Q=async(t,b)=>{if(b){ne.value=!0;const $=t.token_a.decimals,H=t.token_b.decimals;console.log(t,"pool===>1111"),at.value=_t.sqrtPriceX64ToPrice(t==null?void 0:t.current_sqrt_price,$,H).toString(),bt.value=new u(1).div(_t.sqrtPriceX64ToPrice(t==null?void 0:t.current_sqrt_price,$,H)).toString(),y.value=t.needReverse?t.token_b:t.token_a,_.value=t.needReverse?t.token_a:t.token_b,Z.value=t.needReverse,t.token_a.address.toLowerCase()===y.value.address.toLowerCase()&&t.token_b.address.toLowerCase()===_.value.address.toLowerCase()?Me.value=!0:Me.value=!1,console.log(t,"187===>"),console.log(t,"###pool===>");let Ce={poolAddress:t.address,coinTypeA:t.coin_a_address,coinTypeB:t.coin_b_address};const ae=await w.value.getTicks(Ce);et.value=ae?w.value.getTickDataFromUrlData(ae):[],console.log(et.value,"===>chartLoadingtickList.value"),i(t)}ne.value=!1,console.log(ne.value,"==>chartLoading.value")},p=D([]),v=D(),i=t=>{const b=t.token_a.decimals,$=t.token_b.decimals;let H=q.value.poolPriceConfigObj&&q.value.poolPriceConfigObj[t.address]&&q.value.poolPriceConfigObj[t.address].recommend_ranges||{};const Ce=q.value.poolPriceConfigObj&&q.value.poolPriceConfigObj[t.address]&&q.value.poolPriceConfigObj[t.address].type||"";console.log(H,"===>priceConfigList");let ae,we;const Ae=t.current_tick_index;v.value=t.current_tick_index,console.log(Ae,t.tickSpacing,"==>pool.tickSpacing"),ae=Ae-Number(t.type=="unstable"?Number(t.tickSpacing)*2:Number(t.tickSpacing)*3),we=Ae+Number(t.type=="unstable"?Number(t.tickSpacing)*2:Number(t.tickSpacing)*3);const $e=w.value.TickMath.tickIndexToPrice(ae,b,$).toString(),Ze=w.value.TickMath.tickIndexToPrice(we,b,$).toString();H["full range"]={lower:w.value.TickUtil.getMinIndex(Number(n.value.tickSpacing)),upper:w.value.TickUtil.getMaxIndex(Number(n.value.tickSpacing))},H.custom={lower:ae,upper:we,minPrice:$e,maxPrice:Ze};const He=[];for(let me in H)H[me]&&(console.log(me,"j==>"),He.push({...H[me],key:me}));console.log(He,"priceList"),console.log(t,"###pool.type 504"),Ce?t.isSelfBuilt?V.value="custom":Ce=="stable"?V.value="suggested":V.value="passive":V.value="custom",p.value=He,xe.value=H,L({key:V.value,...H[V.value]})},g=D(""),r=D(""),L=t=>{console.log("priceTab====>",t),console.log("priceTab###poolInfo###",n.value),V.value=t.key.toLowerCase();const b=n.value.token_a.decimals,$=n.value.token_b.decimals,{lower:H,upper:Ce}=t,ae=w.value.TickMath.tickIndexToPrice(H,b,$).toString(),we=w.value.TickMath.tickIndexToPrice(Ce,b,$).toString();if(t.key=="full range"){g.value=H,r.value=Ce,U();return}console.log(Me.value,"===>direct.value"),Me.value?(dt.value=String(ae),W.value=String(ae),mt.value=String(we),j.value=String(we),g.value=H,r.value=Ce):(dt.value=String(1/Number(we)),W.value=String(1/Number(we)),mt.value=String(1/Number(ae)),j.value=String(1/Number(ae)),g.value=w.value.TickMath.priceToTickIndex(new u(1/Number(we)),b,$),r.value=w.value.TickMath.priceToTickIndex(new u(1/Number(ae)),b,$)),console.log(W.value,j.value,"===>111")},U=t=>{W.value="0",j.value="∞"};qe(()=>n.value,(t,b)=>{console.log(b,"===>oldVal"),console.log(t,"===>newVal"),(!b&&t&&!Ie(t)||b&&t&&b.address!==t.address)&&(console.log("池子信息"),Q(t,!b||t.address!==b.address))},{immediate:!0}),Rt(()=>{et.value=[]}),qe(()=>[l.value,n.value,q.value.recommendRangesObj],(t,b)=>{var $,H;console.log(t,"===>newValue369"),console.log(b,"===>oldValue369"),(!b||t[0]&&t[1]&&t[2]&&!Ie(t[0])&&!Ie(t[1]&&!Ie(t[2]))||(($=t[0])==null?void 0:$.address)!==((H=b[0])==null?void 0:H.address))&&(console.log("3731111111"),t[0]&&t[2]&&!Ie(t[0])&&!Ie(t[2])&&(console.log(t[0],t[2],"======>374"),E.setSinglePool(t[0],t[2],ke.value)))},{immediate:!0,deep:!0});const Y=t=>{if(ke.value=="Sui")switch(t){case"passive":return"/sui-image/icon_ conservative@2x.png";case"active":return"/sui-image/icon_active@2x.png";case"full range":return"/sui-image/icon_fullrange@2x.png";case"custom":return"/sui-image/icon_costom@2x.png";case"suggested":return"/sui-image/icon_stabel@2x.png"}else switch(t){case"passive":return"/image/icon_ conservative@2x.png";case"active":return"/image/icon_active@2x.png";case"full range":return"/image/icon_fullrange@2x.png";case"custom":return"/image/icon_costom@2x.png";case"suggested":return"/image/icon_stabel@2x.png"}},re=t=>{switch(t){case"suggested":return e("newAdd.suggested");case"active":return e("newAdd.active");case"passive":return e("newAdd.conservative");case"full range":return e("newAdd.fullRange");case"custom":return e("newAdd.custom")}},de=t=>{var $,H;const b=q.value.poolPriceConfigObj&&q.value.poolPriceConfigObj[($=n.value)==null?void 0:$.address]&&q.value.poolPriceConfigObj[(H=n.value)==null?void 0:H.address].type||"";if(console.log(b,t,"==>poolType"),b=="unstable")switch(t){case"active":return{top:"35%"};case"passive":return{top:"10%"};case"full range":return{top:"60%"};case"custom":return{top:"85%"}}else switch(t){case"suggested":return{top:"23%"};case"full range":return{top:"48%"};case"custom":return{top:"73%"}}},m=D(1),M=()=>{const t=m.value/2;m.value=t},R=()=>{const t=m.value*2;m.value=t};console.log(p.value,"==>priceTablList");const C=I(()=>{var t,b,$;return!n.value||Ie(F.value.addressHistTokens)||!F.value.addressHistTokens[(t=n.value)==null?void 0:t.poolAddress]?null:Object.fromEntries(($=F.value.addressHistTokens[(b=n.value)==null?void 0:b.poolAddress])==null?void 0:$.data.map(H=>[H.key,H.value]))}),S=D(30),X=D("30D"),h=I(()=>Me.value?C.value&&_e(S.value==7?C.value.before_7_d_contract_price_lowest:S.value==24?C.value.before_24_h_contract_price_lowest:C.value.before_30_d_contract_price_lowest,6)||0:C.value&&_e(new u(1).div(S.value==7?C.value.before_7_d_contract_price_highest:S.value==24?C.value.before_24_h_contract_price_highest:C.value.before_30_d_contract_price_highest).toString(),6)||0),G=I(()=>Me.value?C.value&&_e(S.value==7?C.value.before_7_d_contract_price_highest:S.value==24?C.value.before_24_h_contract_price_highest:C.value.before_30_d_contract_price_highest,6)||0:(C.value&&_e(1/Number(S.value==7?C.value.before_7_d_contract_price_lowest:S.value==24?C.value.before_24_h_contract_price_lowest:C.value.before_30_d_contract_price_lowest),6))==1/0?0:C.value&&_e(1/Number(S.value==7?C.value.before_7_d_contract_price_lowest:S.value==24?C.value.before_24_h_contract_price_lowest:C.value.before_30_d_contract_price_lowest),6)||0),B=I(()=>{const t=Number(W.value),b=Number(j.value);return W.value&&j.value&&W.value!=="0"&&j.value!=="∞"?ft(1/(1-Number((t/b)**.25)),2)+"x":1}),Ne=I(()=>{var t,b,$,H,Ce,ae;return((t=y.value)==null?void 0:t.isSelfBuilt)||((b=_.value)==null?void 0:b.isSelfBuilt)||((H=q.value.tokensObj[($=y.value)==null?void 0:$.address])==null?void 0:H.isSelfBuilt)||((ae=q.value.tokensObj[(Ce=_.value)==null?void 0:Ce.address])==null?void 0:ae.isSelfBuilt)}),P=t=>{console.log(t,"####0731 priceRangeChangeMin"),t!==W.value&&V.value=="full range"?(console.log(p.value,"===>priceTablList"),L({key:"custom",...p.value.custom})):V.value!=="full range"&&V.value!=="custom"?(V.value="custom",W.value=t):W.value=t},oe=t=>{t!==j.value&&V.value=="full range"?L({key:"custom",...p.value.custom}):V.value!=="full range"&&V.value!=="custom"?(V.value="custom",j.value=t):j.value=t};return console.log(W.value,j.value,"683==>"),qe(()=>[W.value,j.value],([t,b])=>{console.log(t,b,"minmax new-liquidity-left")},{deep:!0,immediate:!0}),{positionError:tt,getCoinIcon:t=>{var b;return(t==null?void 0:t.logoURI)||(t==null?void 0:t.logo_url)||((b=q.value.tokensObj[t==null?void 0:t.address])==null?void 0:b.logo_url)||(F.value.theme==="default"?pt("/image/coins/unknown.png"):pt("/image/coins/sui-unknown.png"))},chainName:ke,store:F,currentTab:ge,currentPrice:at,currentPriceReverse:bt,fromCoin:y,toCoin:_,direction:Me,needReverse:Z,addCommom:We,decimalUi:_e,priceTablList:p,currentPriceTab:V,sliderStyle:de,poolInfo:n,tickList:et,getPriceTabImage:Y,getPriceTabText:re,defaultMinPrice:dt,defaultMaxPrice:mt,minPrice:W,maxPrice:j,currentTick:v,chartLoading:ne,zoomOut:M,zoomIn:R,zoom:m,priceTab:L,before7dContractPriceLowest:h,before7dContractPriceHighest:G,aprRewardsTime:X,lever:B,aprRewardsParameter:S,isSelfBuilt:Ne,priceRangeChangeMin:P,priceRangeChangeMax:oe,toggle:jt}}});const zo={class:"new-liquidity-left"},Ho={class:"select-range"},Do=a("span",null,"Select Range",-1),Wo={class:"range-tab"},Eo=["src"],Xo=["src"],Zo=a("span",null,"Liquidity",-1),Go=["src"],Ko=["src"],xo=a("span",null,"Price",-1),Jo={class:"price-info"},Qo={class:"left"},Yo={class:"base-coin"},Vo={class:"base-coin-title"},ei=a("svg",{class:"icon icon-up","aria-hidden":"true"},[a("use",{"xlink:href":"#icon-exchange_up1"})],-1),ti=a("svg",{class:"icon icon-down","aria-hidden":"true"},[a("use",{"xlink:href":"#icon-exchange_down1"})],-1),oi=[ei,ti],ii={class:"base-coin-bottom"},ni={alt:""},ri={class:"leverage"},ai=a("div",{class:"leverage-title"},"Leverage",-1),li={class:"laverage-value"},si={class:"current-price"},ui=a("div",{class:"current-price-title"},"Current Price",-1),ci={key:0,class:"from-pre-to"},di={class:"right"},mi={class:"price-range"},vi={class:"left"},fi={class:"price-slider"},gi={class:"slider"},pi=a("div",{class:"slider-ratio-content"},null,-1),bi=[pi],hi={class:"price-tab-list"},ki=["onClick"],wi=["src"],yi={class:"right"},_i={class:"range-tab"},Ci=["src"],Pi=["src"],Ti=a("span",null,"Liquidity",-1),Si=["src"],Ni=["src"],Ai=a("span",null,"Price",-1),Li={class:"price-zoom"},Ii={class:"current-price"},qi=a("div",{class:"current-price-title"},"Current Price",-1),Mi={key:0,class:"from-pre-to"},$i={class:"price-zoom-right"},Ri={class:"leverage"},Bi={class:"left"},Oi={key:0,class:"leverage-title"},Fi={key:1,class:"laverage-value"},Ui={class:"right"},ji={key:0,class:"day-7-price-range"},zi=a("i",null,null,-1),Hi={class:"gray"},Di={class:"apr-and-price"},Wi={key:0,class:"position-tips"},Ei=["src"],Xi={class:"error"};function Zi(e,s,ge,z,F,ke){var n,Z,ne,Q,p,v,i,g;const E=zt,q=kt,w=Ht,J=Bt,l=Jt("image");return k(),O("div",zo,[a("div",Ho,[Do,a("div",Wo,[a("div",{class:Je(["liquidity",e.currentTab=="liquidity"?"liquidity-tab-active":""]),onClick:s[0]||(s[0]=r=>e.currentTab="liquidity")},[e.chainName=="Sui"?(k(),O("img",{key:0,src:e.currentTab=="liquidity"?"/sui-image/Liquidity-Sel.png":"/sui-image/Liquidity-Def.png",alt:""},null,8,Eo)):(k(),O("img",{key:1,src:e.currentTab=="liquidity"?"/image/green_chart.png":"/sui-image/Liquidity-Def.png",alt:""},null,8,Xo)),Zo],2),a("div",{class:Je(["price",e.currentTab=="price"?"price-tab-active":""]),onClick:s[1]||(s[1]=r=>e.currentTab="price")},[e.chainName=="Sui"?(k(),O("img",{key:0,src:e.currentTab=="price"?"/sui-image/Price-Sel.png":"/sui-image/Price-Def.png",alt:""},null,8,Go)):(k(),O("img",{key:1,src:e.currentTab=="price"?"/image/price-chart.png":"/sui-image/Price-Def.png",alt:""},null,8,Ko)),xo],2)])]),a("div",Jo,[a("div",Qo,[a("div",Yo,[a("div",Vo,[a("span",null,"Base coin"+he(!e.direction),1),a("div",{class:"change-price",onClick:s[2]||(s[2]=(...r)=>e.toggle&&e.toggle(...r))},oi)]),a("div",ii,[Lt(a("img",ni,null,512),[[l,e.getCoinIcon(e.fromCoin)]]),a("span",null,he((n=e.fromCoin)==null?void 0:n.symbol),1)])]),a("div",ri,[ai,a("div",li,he(e.lever),1)]),a("div",si,[ui,a("div",null,[a("span",null,he(e.poolInfo?e.direction?("addCommom"in e?e.addCommom:Se(We))(("decimalUi"in e?e.decimalUi:Se(_e))(e.currentPrice,6)):("addCommom"in e?e.addCommom:Se(We))(("decimalUi"in e?e.decimalUi:Se(_e))(e.currentPriceReverse,6)):"--"),1),e.fromCoin&&e.toCoin?(k(),O("span",ci,he((Z=e.toCoin)==null?void 0:Z.symbol)+" per "+he((ne=e.fromCoin)==null?void 0:ne.symbol),1)):ee("",!0)])])]),a("div",di,[e.currentTab=="liquidity"?(k(),O("div",{key:0,class:"zoom-in",onClick:s[3]||(s[3]=(...r)=>e.zoomIn&&e.zoomIn(...r))}," - ")):ee("",!0),e.currentTab=="liquidity"?(k(),O("div",{key:1,class:"zoom-out",onClick:s[4]||(s[4]=(...r)=>e.zoomOut&&e.zoomOut(...r))}," + ")):ee("",!0)])]),a("div",mi,[a("div",vi,[a("div",fi,[a("div",gi,[a("div",{class:"slider-ratio",style:gt(e.sliderStyle(e.currentPriceTab))},bi,4)])]),a("div",hi,[(k(!0),O(st,null,Mt(e.priceTablList,r=>(k(),O("div",{key:r.key,class:Je(["price-tab-item",e.currentPriceTab==r.key?"price-tab-item-active":""]),onClick:L=>e.priceTab(r)},[a("img",{src:e.getPriceTabImage(r.key),alt:""},null,8,wi),a("span",null,he(e.getPriceTabText(r.key)),1)],10,ki))),128))])]),a("div",yi,[a("div",_i,[a("div",{class:Je(["liquidity",e.currentTab=="liquidity"?"liquidity-tab-active":""]),onClick:s[5]||(s[5]=r=>e.currentTab="liquidity")},[e.chainName=="Sui"?(k(),O("img",{key:0,src:e.currentTab=="liquidity"?"/sui-image/Liquidity-Sel.png":"/sui-image/Liquidity-Def.png",alt:""},null,8,Ci)):(k(),O("img",{key:1,src:e.currentTab=="liquidity"?"/image/green_chart.png":"/sui-image/Price-Def.png",alt:""},null,8,Pi)),Ti],2),a("div",{class:Je(["price",e.currentTab=="price"?"price-tab-active":""]),onClick:s[6]||(s[6]=r=>e.currentTab="price")},[e.chainName=="sui"?(k(),O("img",{key:0,src:e.currentTab=="price"?"/sui-image/Price-Sel.png":"/sui-image/Price-Def.png",alt:""},null,8,Si)):(k(),O("img",{key:1,src:e.currentTab=="price"?"/image/price-chart.png":"/sui-image/Liquidity-Def.png",alt:""},null,8,Ni)),Ai],2)]),a("div",Li,[a("div",Ii,[qi,a("div",null,[a("span",null,he(e.poolInfo?e.direction&&!e.needReverse?("addCommom"in e?e.addCommom:Se(We))(("decimalUi"in e?e.decimalUi:Se(_e))(e.currentPrice,6)):("addCommom"in e?e.addCommom:Se(We))(("decimalUi"in e?e.decimalUi:Se(_e))(e.currentPriceReverse,6)):"--"),1),e.fromCoin&&e.toCoin?(k(),O("span",Mi,he(e.direction&&!e.needReverse?`${(Q=e.fromCoin)==null?void 0:Q.symbol} per ${(p=e.toCoin)==null?void 0:p.symbol}`:`${(v=e.toCoin)==null?void 0:v.symbol} per ${(i=e.fromCoin)==null?void 0:i.symbol}`),1)):ee("",!0)])]),a("div",$i,[e.currentTab=="liquidity"?(k(),O("div",{key:0,class:"zoom-in",onClick:s[7]||(s[7]=(...r)=>e.zoomIn&&e.zoomIn(...r))}," - ")):ee("",!0),e.currentTab=="liquidity"?(k(),O("div",{key:1,class:"zoom-out",onClick:s[8]||(s[8]=(...r)=>e.zoomOut&&e.zoomOut(...r))}," + ")):ee("",!0)])]),e.fromCoin&&e.toCoin&&e.poolInfo&&e.currentTab=="liquidity"?(k(),Xe(E,{key:0,"pool-info":e.poolInfo,"min-price":e.minPrice,"max-price":e.maxPrice,direction:e.direction,"current-price-tab":e.currentPriceTab,"tick-list":e.tickList,"current-tick":e.currentTick,"chart-loading":e.chartLoading,zoom:e.zoom,"before7d-contract-price-lowest":e.before7dContractPriceLowest,"before7d-contract-price-highest":e.before7dContractPriceHighest,onOnChangeMinPrice:e.priceRangeChangeMin,onOnChangeMaxPrice:e.priceRangeChangeMax},null,8,["pool-info","min-price","max-price","direction","current-price-tab","tick-list","current-tick","chart-loading","zoom","before7d-contract-price-lowest","before7d-contract-price-highest","onOnChangeMinPrice","onOnChangeMaxPrice"])):ee("",!0),((g=e.tickList)==null?void 0:g.length)<=0&&e.chartLoading?(k(),Xe(q,{key:1})):ee("",!0)])]),a("div",Ri,[a("div",Bi,[e.currentPriceTab!=="full range"?(k(),O("div",Oi,"Leverage")):ee("",!0),e.currentPriceTab!=="full range"?(k(),O("div",Fi,he(e.lever),1)):ee("",!0)]),a("div",Ui,[e.poolInfo&&(e.before7dContractPriceLowest||e.before7dContractPriceHighest)?(k(),O("div",ji,[zi,a("span",Hi,he(e.aprRewardsParameter==7?"7D":e.aprRewardsParameter==24?"24H":"30D")+" Price Range",1),a("span",null,he(("addCommom"in e?e.addCommom:Se(We))(("decimalUi"in e?e.decimalUi:Se(_e))(e.before7dContractPriceLowest,6)))+" - "+he(("addCommom"in e?e.addCommom:Se(We))(("decimalUi"in e?e.decimalUi:Se(_e))(e.before7dContractPriceHighest,6))),1)])):ee("",!0)])]),a("div",Di,[ze(w,{"apr-rewards-parameter":e.aprRewardsParameter,"name-tab":"deposit","from-coin":e.fromCoin,"to-coin":e.toCoin,"pool-info":e.poolInfo,"min-price":e.minPrice,"max-price":e.maxPrice,onChangeAprRewardsParameter:s[9]||(s[9]=r=>{e.aprRewardsParameter=r})},null,8,["apr-rewards-parameter","from-coin","to-coin","pool-info","min-price","max-price"]),ze(J,{min:e.minPrice,max:e.maxPrice,"from-coin":e.fromCoin,"to-coin":e.toCoin,direct:e.direction,"default-min-price":e.defaultMinPrice,"default-max-price":e.defaultMaxPrice,"pool-info":e.poolInfo,loading:e.chartLoading,"current-price-tab":e.currentPriceTab,onOnChangeMinPrice:e.priceRangeChangeMin,onOnChangeMaxPrice:e.priceRangeChangeMax},null,8,["min","max","from-coin","to-coin","direct","default-min-price","default-max-price","pool-info","loading","current-price-tab","onOnChangeMinPrice","onOnChangeMaxPrice"]),e.positionError&&e.poolInfo?(k(),O("div",Wi,[a("img",{src:("importIcon"in e?e.importIcon:Se(pt))("/image/icon-tips-error@2x.png"),alt:""},null,8,Ei),a("p",Xi,he(e.$t("tips.positionError")),1)])):ee("",!0)])])}const Dt=it(jo,[["render",Zi]]),Gi=ot({components:{NewLiquidityTitle:Ot,NewLiquidityAssetsCard:Ft,NewLiquidityDepositRatio:Ut},setup(){const{t:e,locale:s}=$t(),ge=ut(),z=I(()=>ge),F=I(()=>z.value.chainName),ke=ht(),E=I(()=>ke),q=lo(),w=I(()=>q),J=wt(),l=I(()=>{let o=null;for(const f in E.value.poolsObj){const N=E.value.poolsObj[f];N.address==J.query.poolAddress&&(console.log(N,"p===>"),o=N)}return o}),n=D(!1),Z=D(!1),ne=I(()=>z.value.theme),Q=async(o,f)=>{y.value=o.needReverse?o.token_b:o.token_a,_.value=o.needReverse?o.token_a:o.token_b};qe(()=>l.value,(o,f)=>{console.log(f,"===>oldVal"),console.log(o,"===>newVal"),(!f&&o&&!Ie(o)||f&&o&&f.address!==o.address)&&(console.log("池子信息"),Q(o,!f||o.address!==f.address))},{immediate:!0});const p=I(()=>w.value.assets&&y.value&&w.value.assets[y.value.address]?Ct(w.value.assets[y.value.address].balance,y.value.decimals):"0"),v=I(()=>w.value.assets&&_.value&&w.value.assets[_.value.address]?Ct(w.value.assets[_.value.address].balance,_.value.decimals):"0"),i=o=>{o==="fromCoin"?(Te.value=!0,F.value==="Aptos"?T.value=Number(p.value)>0?y.value.symbol=="APT"?new u(Number(p.value)).sub(new u(.1)).lt(new u(0))?"0":new u(Number(p.value)).sub(new u(.1)).toString():String(p.value):"":T.value=Number(p.value)>0?y.value.symbol=="SUI"?new u(Number(p.value)).sub(new u(.05)).lt(new u(0))?"0":new u(Number(p.value)).sub(new u(.05)).toString():String(p.value):""):(Te.value=!1,F.value==="Aptos"?A.value=Number(v.value)>0?_.value.symbol=="APT"?new u(Number(v.value)).sub(new u(.1)).lt(new u(0))?"0":new u(Number(v.value)).sub(new u(.1)).toString():String(v.value):"":A.value=Number(v.value)>0?_.value.symbol=="SUI"?new u(Number(v.value)).sub(new u(.05)).lt(new u(0))?"0":new u(Number(v.value)).sub(new u(.05)).toString():String(v.value):"")},g=o=>{o==="fromCoin"?(Te.value=!0,T.value=Number(p.value)>0?ft(new u(Number(p.value)).div(2).toString(),y.value.decimals).toString():""):(Te.value=!1,A.value=Number(v.value)>0?ft(new u(Number(v.value)).div(2).toString(),_.value.decimals).toString():"")},r=D(),L=D(),U=D(),Y=D(!1),re=o=>{var f,N,se,K;r.value=o,o==="fromCoin"?(L.value=((f=_.value)==null?void 0:f.address)||"",U.value=J.query.actions=="new-position"?(N=y.value)==null?void 0:N.address:l.value.needReverse?l.value.token_b.address:l.value.token_a.address):(L.value=((se=y.value)==null?void 0:se.address)||"",U.value=J.query.actions=="new-position"?(K=_.value)==null?void 0:K.address:l.value.needReverse?l.value.token_a.address:l.value.token_b.address),Y.value=!0,console.log(Y.value,"==>showCoinSelect.value ")},de=o=>{var se,K,ue,ve,fe,ie,te,Pe;const f=l.value.needReverse?l.value.token_b:l.value.token_a,N=l.value.needReverse?l.value.token_a:l.value.token_b;r.value==="fromCoin"?(((se=y.value)==null?void 0:se.address)===(f==null?void 0:f.address)||!((K=y.value)!=null&&K.address)?(_.value&&o.address.toLowerCase()===((ue=_)==null?void 0:ue.value.address.toLowerCase())&&(_.value=null),y.value=o):(y.value&&o.address.toLowerCase()===((ve=y)==null?void 0:ve.value.address.toLowerCase())&&(y.value=null),_.value=o),J.query.action||(J.query.fee="")):((fe=_.value)==null?void 0:fe.address)===(N==null?void 0:N.address)||!((ie=_.value)!=null&&ie.address)?(y.value&&o.address.toLowerCase()===((te=y)==null?void 0:te.value.address.toLowerCase())&&(y.value=null),_.value=o):(_.value&&o.address.toLowerCase()===((Pe=_)==null?void 0:Pe.value.address.toLowerCase())&&(_.value=null),y.value=o),Y.value=!1},m=I(()=>z.value.chainName?lt(z.value.chainName):{}),M=I(()=>z.value.slippage),R=D(),C=async()=>{var Oe,Ee,Ue,ce;if(X.value)return console.log("跳出"),!1;if(!W.value&&!j.value)return!1;if(!T.value&&!A.value&&!W.value&&!j.value)return;const o=l.value||{};if(Ie(o))return;const{TickUtil:f,TickMath:N,getNearestTickByTick:se}=m.value,K=o==null?void 0:o.token_a.decimals,ue=o==null?void 0:o.token_b.decimals;let ve,fe,ie,te,Pe,Le,De,Ge,ye=o==null?void 0:o.current_tick_index,x;if(o.token_a.address.toLowerCase()===y.value.address.toLowerCase()&&o.token_b.address.toLowerCase()===_.value.address.toLowerCase()?x=!0:x=!1,W.value==="0"&&j.value==="∞")ie=f.getMinIndex(Number(o.tickSpacing)),te=f.getMaxIndex(Number(o.tickSpacing)),Pe=N.tickIndexToSqrtPriceX64(ie),Le=N.tickIndexToSqrtPriceX64(te),console.log(ie,te,"#######updateAmounts 513");else if(V.value=="custom"){console.log(x,"===>directs1866"),x?(ve=Number(W.value),fe=Number(j.value)):(ve=new u(1).div(j.value).toString(),fe=new u(1).div(W.value).toString());try{De=ve==0?-443636:N.priceToTickIndex(new u(ve),K,ue)}catch{De=-443636}try{Ge=N.priceToTickIndex(new u(fe),K,ue)}catch{Ge=443636}ie=se(De,Number(o.tickSpacing)),te=se(Ge,Number(o.tickSpacing)),Pe=N.priceToSqrtPriceX64(new u(ve),K,ue);try{Le=N.priceToSqrtPriceX64(new u(fe),K,ue)}catch{console.log("0523###test###max###",fe),fe===1/0&&(console.log("0523###test###max###11111"),Le=N.tickIndexToSqrtPriceX64(f.getMaxIndex(Number(o.tickSpacing))))}console.log("0518###pre###tick_lower###",ie,te,ye),console.log("0518###pre###tick_upper###",te)}else ie=(Oe=xe.value[V.value])==null?void 0:Oe.lower,te=(Ee=xe.value[V.value])==null?void 0:Ee.upper,Pe=N.tickIndexToSqrtPriceX64(ie),Le=N.tickIndexToSqrtPriceX64(te);if(j.value!=="∞"&&ie>=te){n.value=!0,T.value="",Z.value=!0,A.value="";return}if(console.log(te,ye,ie,"1922"),j.value==="∞"||ye>=ie&&ye<=te){n.value=!1,Z.value=!1;let le;if(T.value||A.value){if(Te.value){const ct=new u(T.value).mul(Math.pow(10,y.value.decimals)).toString();le=new je(ct)}else{const ct=new u(A.value).mul(Math.pow(10,_.value.decimals)).toString();le=new je(ct)}console.log(x,"======>directs");const{liquidityAmount:Fe,tokenMaxA:Ye,tokenMaxB:Ve,tokenMaxAOrigin:Zt,tokenMaxBOrigin:Gt}=m.value.estLiquidityAndcoinAmountFromOneAmounts({tokenA:o.token_a,tokenB:o.token_b,lowerTick:ie,upperTick:te,coinAmount:le,iscoinA:x?Te.value:!Te.value,roundUp:!0,slippage:Number(M.value)/100,curSqrtPrice:new je(o.current_sqrt_price)});R.value={liquidityAmount:Fe,tokenMaxA:Ye,tokenMaxB:Ve,tokenMaxAOrigin:Zt,tokenMaxBOrigin:Gt},console.log(Ye,Ve,"preAdd"),x?Te.value?A.value=Number(Ve)>0?Ve:"":T.value=Number(Ye)>0?Ye:"":Te.value?A.value=Ye:T.value=Ve}}else if(ye>te){if(x?T.value="":A.value="",n.value=x,Z.value=!x,T.value||A.value){let le;if(x){const Fe=new u(A.value).mul(Math.pow(10,(Ue=_.value)==null?void 0:Ue.decimals)).toString();le=new je(Fe),R.value={liquidityAmount:m.value.estimateLiquidityForCoinB(Pe,Le,le),tokenMaxA:0,tokenMaxB:A.value}}else{const Fe=new u(T.value).mul(Math.pow(10,(ce=y.value)==null?void 0:ce.decimals)).toString();le=new je(Fe),R.value={liquidityAmount:m.value.estimateLiquidityForCoinB(Pe,Le,le),tokenMaxA:0,tokenMaxB:T.value}}}}else if(ye<ie){if(n.value=!x,Z.value=x,x?A.value="":T.value="",T.value||A.value){let le;if(x){const Fe=new u(T.value).mul(Math.pow(10,y.value.decimals)).toString();le=new je(Fe),R.value={liquidityAmount:m.value.estimateLiquidityForCoinA(Pe,Le,le),tokenMaxA:T.value,tokenMaxB:0}}else{const Fe=new u(A.value).mul(Math.pow(10,_.value.decimals)).toString();le=new je(Fe),R.value={liquidityAmount:m.value.estimateLiquidityForCoinA(Pe,Le,le),tokenMaxA:A.value,tokenMaxB:0}}}}else n.value=!0,T.value="",Z.value=!0,A.value=""};qe(T,(o,f)=>{console.log(T,"===>fromCoinAmount"),o==""&&Te.value&&(A.value=""),o&&Te.value&&!X.value&&C()}),qe(A,(o,f)=>{console.log(o,"===>>>>newValsda"),o==""&&!Te.value&&(T.value=""),o&&!Te.value&&!X.value&&C()});const S=D("--"),X=D(!1),h=I(()=>E.value.RATES),G=()=>{const o=h.value&&h.value[y.value.address]&&h.value[y.value.address].price,f=h.value&&h.value[_.value.address]&&h.value[_.value.address].price;if(o&&f){const N=new u(T.value>0?T.value:0).mul(o),se=new u(A.value>0?A.value:0).mul(f),K=N.add(se).toNumber();S.value=K>0&&K<.01?"<0.01":Nt(K,2)}else S.value="--"};qe(()=>[T.value,A.value,X.value],([o,f,N])=>{(o||f)&&!N?G():(!o||!f)&&!N&&(S.value="--")},{immediate:!0}),qe(()=>S,o=>{console.log(o,"71911111")},{immediate:!0}),qe([W,j],([o,f])=>{console.log(o,f,"==>minPrice,maxPrice"),Number(o)!==0&&Number(f)!==0&&!X.value?C():Number(o)!==0&&Number(f)!==0&&X.value&&P(),f!=="∞"&&Number(o)!==0&&Number(f)!==0&&Number(o)>=Number(f)?tt.value=!0:tt.value=!1,Number(o)==0&&Number(f)==0&&at.value&&(tt.value=!0,console.log("价格区间错误"))},{deep:!0,immediate:!0});const B=o=>{console.log(o,"e"),X.value=!0,S.value=o,o>0?P():(T.value="",A.value="")},Ne=D(),P=async()=>{var x,Oe,Ee,Ue;if(!W.value&&!j.value)return!1;if(!T.value&&!A.value&&!W.value&&!j.value)return;const o=l.value;if(Ie(o))return;const{TickUtil:f,TickMath:N,getNearestTickByTick:se}=m.value,K=o==null?void 0:o.token_a.decimals,ue=o==null?void 0:o.token_b.decimals;let ve,fe,ie,te,Pe,Le,De;if(o.token_a.address.toLowerCase()===y.value.address.toLowerCase()&&o.token_b.address.toLowerCase()===_.value.address.toLowerCase()?De=!0:De=!1,W.value==="0"&&j.value==="∞")ie=f.getMinIndex(Number(o.tickSpacing)),te=f.getMaxIndex(Number(o.tickSpacing));else if(V.value=="custom"){De?(ve=Number(W.value),fe=Number(j.value)):(ve=new u(1).div(j.value).toString(),fe=new u(1).div(W.value).toString());try{Pe=ve==0?-443636:N.priceToTickIndex(new u(ve),K,ue)}catch{Pe=-443636}try{Le=N.priceToTickIndex(new u(fe),K,ue)}catch{Le=443636}ie=se(Pe,Number(o.tickSpacing)),te=se(Le,Number(o.tickSpacing))}else ie=(x=xe.value[V.value])==null?void 0:x.lower,te=(Oe=xe.value[V.value])==null?void 0:Oe.upper;const Ge=h.value[(Ee=o.value)==null?void 0:Ee.token_a.address].price,ye=h.value[(Ue=o.value)==null?void 0:Ue.token_b.address].price;Me.value?new je(o.current_sqrt_price):new je(1/o.current_sqrt_price),console.log(Me.value,"===>direction.value"),console.log(o,"poolInfos===>"),console.log(ie,te,"####tick_lower tick_upper 889");try{const{amountA:ce,amountB:le,tokenAmountsInfo:Fe}=await m.value.estCoinAmountsFromTotalAmount({lowerTick:ie,upperTick:te,decimalsA:K,decimalsB:ue,curSqrtPrice:new je(o.current_sqrt_price),totalAmount:S.value,tokenPriceA:Ge,tokenPriceB:ye});console.log(ce,le,"###estCoinAmountsFromTotalAmount 844"),console.log(o.needReverse,Me.value,"===>849"),Ne.value=Fe,o.needReverse?Me.value?(T.value=ce,A.value=le):(T.value=le,A.value=ce):(T.value=ce,A.value=le)}catch(ce){console.log(ce,"e===>")}},oe=D(!1),{setTransactionTxid:Ke,setTransactionDesc:t,setIsShowWaiting:b,setIsShowSuccess:$,setPositiomNum:H,setIsShowRejected:Ce}=ge,ae=po(),we=I(()=>E.value.currentPositionInfo),Ae=D(!1),$e=async o=>{var Pe,Le,De,Ge;console.log(l.value,"===> poolInfo.value"),oe.value=!1,E.value.currentPositionInfo={},Ke(""),t(e("tips.increaseLiquiditySuccess",{from:n.value?"":`${T.value} ${(Pe=y.value)==null?void 0:Pe.symbol}`,and:!n.value&&!Z.value?"and":"",to:Z.value?"":`${A.value} ${(Le=_.value)==null?void 0:Le.symbol}`})),b(!0);const f=Me.value?Te.value:!Te.value;let N,se,K,ue,ve,fe;const ie=l.value.token_a.decimals,te=l.value.token_b.decimals;if(W.value==="0"&&j.value==="∞")K=m.value.TickUtil.getMinIndex(Number(l.value.tickSpacing)),ue=m.value.TickUtil.getMaxIndex(Number(l.value.tickSpacing));else if(V.value=="custom"){Me.value?(N=Number(W.value),se=Number(j.value)):(N=new u(1).div(j.value).toString(),se=new u(1).div(W.value).toString()),console.log("0519###toAdd###min###",N),console.log("0519###toAdd###max###",se),console.log("0519###toAdd###minPrice.value###",W.value),console.log("0519###toAdd###maxPrice.value###",j.value);try{ve=N==0?m.value.TickUtil.getMinIndex(Number(l.value.tickSpacing)):m.value.TickMath.priceToTickIndex(new u(N),ie,te)}catch{ve=m.value.TickUtil.getMinIndex(Number(l.value.tickSpacing))}try{fe=m.value.TickMath.priceToTickIndex(new u(se),ie,te)}catch{fe=m.value.TickUtil.getMaxIndex(Number(l.value.tickSpacing))}K=m.value.getNearestTickByTick(ve,Number(l.value.tickSpacing)),ue=m.value.getNearestTickByTick(fe,Number(l.value.tickSpacing))}else K=xe.value[V.value].lower,ue=xe.value[V.value].upper;console.log(K,ue,"####tick_lower tick_upper 889"),console.log(l.value,"==>poolInfo.value.curSqrtPrice");try{let ye;X.value?ye=await m.value.getCreateAddLiquidityPayload({pool:l.value,curSqrtPrice:new je(l.value.current_sqrt_price),tickLower:K,tickUpper:ue,slippage:Number(M.value)/100,tokenAmounts:Ne.value}):ye=await m.value.getAddLiquidityTransactionPayload({pool:{poolAddress:l.value.poolAddress,token_a:l.value.token_a,token_b:l.value.token_b},amount:Te.value?T.value:A.value,fix_amount_a:f,tick_lower:K,tick_upper:ue,index:0,slippage:Number(M.value)/100,roundUp:!0,collect_fee:!1,curSqrtPrice:new je(l.value.current_sqrt_price)}),console.log(ye,"payload===?");let x;if(F.value==="Aptos")x=await w.value.currentWallet.signAndSubmitTransaction(ye);else{const Oe=await w.value.currentWallet.signAndExecuteTransactionBlock(ye);x=m.value.handleTx(Oe)}if(console.log("0410###tx###",x),x&&x.hash){Ke(x.hash),b(!1),$(!0);let Oe;l.value.needReverse?l.value.token_a.address.toLowerCase()===y.value.address.toLowerCase()&&l.value.token_b.address.toLowerCase()===_.value.address.toLowerCase()?Oe=!1:Oe=!0:l.value.token_a.address.toLowerCase()===y.value.address.toLowerCase()&&l.value.token_b.address.toLowerCase()===_.value.address.toLowerCase()?Oe=!0:Oe=!1,console.log(Oe,"===>directs");const Ee={title:"Supplied",desc:e("tips.addLiquiditySuccessText",{from:n.value?"":`${T.value} ${(De=y.value)==null?void 0:De.symbol}`,and:!n.value&&!Z.value?"and":"",to:Z.value?"":`${A.value} ${(Ge=_.value)==null?void 0:Ge.symbol}`}),hash:x.hash,tit:"Position Created",icon:"icon-icon-Position-Created"};F.value!=="Aptos"&&(Ee.res=x.res),m.value.showTransitionPending(Ee);const Ue=await m.value.watchTransaction(Ee,!0);if(Ue.status){if($(!1),E.value.setCurrentPositionLoading(!0),Ae.value=!0,console.log(Ue.nftInfo,"===> watchInfo.nftInfo"),F.value==="Aptos"){if(await E.value.setCurrentPositionInfo(Ue.nftInfo[0].data.id.creator,Ue.nftInfo[0].data.id.collection,Ue.nftInfo[0].data.name,F.value),o)try{await ae.subscribePosition({pool_address:we.value.poolAddress,position_index:we.value.index},we.value.nftHash)}catch(ce){console.log(ce,"e")}}else{const ce=Ue.nftInfo,le=await Pt(2e3);if(await E.value.setCurrentPositionInfo(ce==null?void 0:ce.pool,"","",F.value,ce==null?void 0:ce.position),await Pt(1e3),console.log("0529###nftInfo###",ce),console.log("0529###currentPositionInfo.value.index###",we.value.index),o)try{await ae.subscribePosition({pool_address:we.value.poolAddress,position_index:we.value.index},we.value.nftHash)}catch(Fe){console.log(Fe)}}setTimeout(()=>{ke.updateCurrentPools(l.value.poolAddress,F.value),m.value.getAccount(w.value.address)},3e3),setTimeout(async()=>{Tt(m,l)},3e3)}H()}else b(!1),Ce(!0);T.value="",A.value=""}catch(ye){T.value="",A.value="",console.log("0330###Add liquidity Error###",ye),b(!1),Ce(!0)}},Ze=I(()=>!T.value&&!A.value?(console.log("addLiquidityBtnDisabled11111"),!0):Number(T.value)>Number(p.value)||Number(A.value)>Number(v.value)?(console.log("addLiquidityBtnDisabled22222"),!0):me.value!==e("button.addLiquidity")&&me.value!==e("newAdd.preview")?(console.log("addLiquidityBtnDisabled33333###",me.value),!0):l.value&&l.value&&l.value.is_pause?(console.log("addLiquidityBtnDisabled44444"),!0):Number(T.value)<=0&&Number(A.value)<=0||!n.value&&Number(T.value)==0||!Z.value&&Number(A.value)==0),He=I(()=>!y.value||!_.value),me=I(()=>l.value&&l.value.is_pause?"Pool Closed":!y.value||!_.value||He.value?e("modal.selectTokenModalTitle"):Number(T.value)>Number(p.value)?e("button.insufficientBalance",{name:y.value.symbol}):Number(A.value)>Number(v.value)?e("button.insufficientBalance",{name:_.value.symbol}):!Number(T.value)&&!Number(A.value)?e("button.enterAmount"):j.value!=="∞"&&Number(W.value)>=Number(j.value)?e("newAdd.invalidRange"):e("button.addLiquidity")),Re=D({}),Qe=D({}),nt=D(!1),c=(o,f)=>{console.log(r.value,"===>currentCoinKey.value"),console.log(o);const N=localStorage.getItem(o.address);console.log(E.value.tokensObj,"===>pools.value.tokensObj"),console.log(N,"===>coinLocak"),E.value.tokensObj&&E.value.tokensObj[o.address]&&E.value.tokensObj[o.address].isSelfBuilt&&!N&&(f=="fromCoin"&&(Re.value=o),f=="toCoin"&&(Qe.value=o),nt.value=!0)};qe(()=>[y.value,_.value],([o,f])=>{o&&!Ie(o)&&c(o,"fromCoin"),f&&!Ie(f)&&c(f,"toCoin")},{immediate:!0});const d=Qt(),Be=()=>{F.value!=="Aptos"?d.push("/pool/list"):d.push("/pools")},pe=o=>{X.value,$e(o)},be=o=>{const f=new RegExp("[^\\d-]*(\\d*(?:\\.\\d{0,2})?).*$");o.target.value=o.target.value.replace(f,"$1")},Et=()=>{J.query.action!=="create-pool"&&J.query.actions!=="new-position"&&(Tt(m,l),C(),ke.updateCurrentPools(l.value.poolAddress,F.value)),ke.setPoolConfigList(F.value,z.value.filterCoinsObj)},Xt=I(()=>{var N,se,K,ue,ve,fe;const o=(K=h.value[(se=(N=y)==null?void 0:N.value)==null?void 0:se.address])==null?void 0:K.price,f=(fe=h.value[(ve=(ue=_)==null?void 0:ue.value)==null?void 0:ve.address])==null?void 0:fe.price;return!!(o&&f)});return{decimalUi:_e,inputChange:be,poolInfo:l,fromCoinAmount:T,toCoinAmount:A,fromCoin:y,toCoin:_,theme:ne,showFromCoinLock:n,showToCoinLock:Z,fromCoinBlance:p,toCoinBlance:v,maxBtnSelect:i,halfBtnSelect:g,fixedFromCoin:Te,openCoinSelect:re,currentCoinKey:r,existingCoins:L,lastSelectCoin:U,showCoinSelect:Y,onCoinSelect:de,liquidityTotalAmount:S,toggle:jt,onInput:B,isInputTotalAmount:X,isViewDetail:Ae,addLiquidityBtnDisabled:Ze,addLiquidityBtnText:me,isShowTokenWarning:nt,chainName:F,closeTokenWarning:Be,warningFromCoin:Re,warningToCoin:Qe,isShowLiquidityModal:oe,currentPrice:at,currentPriceReverse:bt,currentPriceTab:V,minPrice:W,maxPrice:j,toAdd:$e,direction:Me,wallet:w,getAddLiquidityType:pe,clickRefresh:Et,isShowtotalAmount:Xt}}});const Ki={class:"new-liquidity-right"},xi={class:"deposit-title"},Ji={class:"card-container"},Qi={class:"card-item"},Yi={class:"card-item"},Vi={key:0,class:"total-amount"},en=a("span",null,"Total Amount",-1);function tn(e,s,ge,z,F,ke){const E=Ot,q=Ft,w=ao,J=eo,l=Ut,n=to,Z=mo,ne=vo,Q=fo,p=go;return k(),O("div",Ki,[a("div",xi,[ze(E,{"pool-info":e.poolInfo,onClickRefresh:e.clickRefresh},null,8,["pool-info","onClickRefresh"])]),a("div",Ji,[a("div",Qi,[ze(q,{modelValue:e.fromCoinAmount,"onUpdate:modelValue":s[0]||(s[0]=v=>e.fromCoinAmount=v),"input-value":e.fromCoinAmount,"coin-symbol":e.fromCoin?e.fromCoin.symbol:null,"coin-name":e.fromCoin?e.fromCoin.name:null,balance:e.fromCoinBlance,"coin-icon":e.fromCoin?e.fromCoin.logoURI:"",address:e.fromCoin?e.fromCoin.address:"","swap-direct":"From","import-page":"deposit","has-arrow":!1,onOnMax:s[1]||(s[1]=v=>e.maxBtnSelect("fromCoin")),onOnHalf:s[2]||(s[2]=v=>e.halfBtnSelect("fromCoin")),onOnInput:s[3]||(s[3]=v=>{e.fromCoinAmount=v,e.fixedFromCoin=!0,e.isInputTotalAmount=!1}),onOnSelect:s[4]||(s[4]=v=>e.openCoinSelect("fromCoin"))},null,8,["modelValue","input-value","coin-symbol","coin-name","balance","coin-icon","address"]),e.showFromCoinLock?(k(),Xe(w,{key:0,"from-coin":e.fromCoin,"to-coin":e.toCoin,"pool-info":e.poolInfo},null,8,["from-coin","to-coin","pool-info"])):ee("",!0)]),a("div",Yi,[ze(q,{modelValue:e.toCoinAmount,"onUpdate:modelValue":s[5]||(s[5]=v=>e.toCoinAmount=v),"input-value":e.toCoinAmount,"coin-symbol":e.toCoin?e.toCoin.symbol:null,"coin-name":e.toCoin?e.toCoin.name:null,balance:e.toCoinBlance,"swap-direct":"To","coin-icon":e.toCoin?e.toCoin.logoURI:"",address:e.toCoin?e.toCoin.address:"","import-page":"deposit","has-arrow":!1,onOnMax:s[6]||(s[6]=v=>e.maxBtnSelect("toCoin")),onOnHalf:s[7]||(s[7]=v=>e.halfBtnSelect("toCoin")),onOnInput:s[8]||(s[8]=v=>{e.toCoinAmount=v,e.fixedFromCoin=!1,e.isInputTotalAmount=!1}),onOnSelect:s[9]||(s[9]=v=>e.openCoinSelect("toCoin"))},null,8,["modelValue","input-value","coin-symbol","coin-name","balance","coin-icon","address"]),e.showToCoinLock?(k(),Xe(w,{key:0,"from-coin":e.fromCoin,"to-coin":e.toCoin,"pool-info":e.poolInfo},null,8,["from-coin","to-coin","pool-info"])):ee("",!0)]),e.fromCoin&&e.toCoin&&!e.showToCoinLock&&!e.showFromCoinLock&&e.theme=="default"?(k(),O("img",{key:0,class:"add",src:bo,alt:"",onClick:s[10]||(s[10]=(...v)=>e.toggle&&e.toggle(...v))})):ee("",!0),e.fromCoin&&e.toCoin&&!e.showToCoinLock&&!e.showFromCoinLock&&e.theme!=="default"?(k(),O("img",{key:1,class:"add",src:ho,alt:"",onClick:s[11]||(s[11]=(...v)=>e.toggle&&e.toggle(...v))})):ee("",!0)]),e.isShowtotalAmount?(k(),O("div",Vi,[en,a("span",null,[ze(J,{value:"$"+("addCommom"in e?e.addCommom:Se(We))(("decimalUi"in e?e.decimalUi:Se(_e))(e.liquidityTotalAmount,2)),placeholder:e.isInputTotalAmount?"":e.liquidityTotalAmount,onChange:e.inputChange,onInput:s[12]||(s[12]=v=>e.onInput(v.target.value))},null,8,["value","placeholder","onChange"])])])):ee("",!0),ze(l,{"from-coin":e.fromCoin,"to-coin":e.toCoin,"from-coin-amount":e.fromCoinAmount,"to-coin-amount":e.toCoinAmount,"fixed-from-coin":e.fixedFromCoin,"is-input-total-amount":e.isInputTotalAmount,"min-price":e.minPrice,"max-price":e.maxPrice,"current-price-tab":e.currentPriceTab,"current-price":e.currentPrice,"current-price-reverse":e.currentPriceReverse},null,8,["from-coin","to-coin","from-coin-amount","to-coin-amount","fixed-from-coin","is-input-total-amount","min-price","max-price","current-price-tab","current-price","current-price-reverse"]),ze(n,{class:"add-liquidity-btn",disabled:e.wallet.connected?e.addLiquidityBtnDisabled:!1,onClick:s[13]||(s[13]=v=>e.wallet.connected?e.isShowLiquidityModal=!0:e.wallet.setIsShowWalletModal(!0))},{default:Yt(()=>[Vt(he(e.wallet.connected?e.addLiquidityBtnText:e.$t("button.connectWallet")),1)]),_:1},8,["disabled"]),e.showCoinSelect?(k(),Xe(Z,{key:1,"existing-coins":e.existingCoins,"last-select-coin":e.lastSelectCoin,onOnSelect:e.onCoinSelect,onOnClose:s[14]||(s[14]=v=>e.showCoinSelect=!1)},null,8,["existing-coins","last-select-coin","onOnSelect"])):ee("",!0),e.isViewDetail?(k(),Xe(ne,{key:2,"pool-info":e.poolInfo,onOnClose:s[15]||(s[15]=v=>e.isViewDetail=!1)},null,8,["pool-info"])):ee("",!0),e.chainName=="Sui"&&e.isShowTokenWarning?(k(),Xe(Q,{key:3,"from-coin":e.warningFromCoin,"to-coin":e.warningToCoin,onClose:e.closeTokenWarning,onClickContinue:s[16]||(s[16]=v=>e.isShowTokenWarning=!1)},null,8,["from-coin","to-coin","onClose"])):ee("",!0),e.isShowLiquidityModal?(k(),Xe(p,{key:4,"pool-info":e.poolInfo,title:e.$t("button.addLiquidity"),"from-coin-amount":e.fromCoinAmount,"to-coin-amount":e.toCoinAmount,"from-coin":e.fromCoin,"to-coin":e.toCoin,"fixed-from-coin":e.fixedFromCoin,"current-price":e.currentPrice,"current-price-reverse":e.currentPriceReverse,"current-price-tab":e.currentPriceTab,"min-price":e.minPrice,"max-price":e.maxPrice,"show-from-coin-lock":e.showFromCoinLock,"show-to-coin-lock":e.showToCoinLock,"current-direct":e.direction,"is-increase":!1,onToAdd:e.getAddLiquidityType,onOnClose:s[17]||(s[17]=v=>e.isShowLiquidityModal=!1)},null,8,["pool-info","title","from-coin-amount","to-coin-amount","from-coin","to-coin","fixed-from-coin","current-price","current-price-reverse","current-price-tab","min-price","max-price","show-from-coin-lock","show-to-coin-lock","current-direct","onToAdd"])):ee("",!0)])}const Wt=it(Gi,[["render",tn]]),on=ot({components:{NewLiquidityLeft:Dt,NewLiquidityRight:Wt},setup(){Rt(()=>{co()});const e=wt();return{tickList:et,route:e}}});const nn={key:0,class:"loading-spin-liquidity loading-global"},rn={class:"privide-liquidity"};function an(e,s,ge,z,F,ke){var J,l;const E=kt,q=Dt,w=Wt;return k(),O(st,null,[!e.tickList&&((l=(J=e.route)==null?void 0:J.query)!=null&&l.poolAddress)?(k(),O("div",nn,[ze(E)])):ee("",!0),a("div",rn,[ze(q),ze(w)])],64)}const Wn=it(on,[["render",an],["__scopeId","data-v-9c3e932a"]]);export{Wn as default};
