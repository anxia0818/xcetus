import{a as st,b as Gt,n as ft,d as ye,u as kt,e as Ee,c as Le,i as At,s as gt,T as Ct,p as Pt,f as je,g as Tt}from"./pool.b50800f9.js";import{a as it,r as E,m as L,y as Lt,D as Ie,e as nt,o as h,f as O,c as Ze,x as te,h as a,t as It,G as Kt,H as pt,v as be,u as Te,F as ut,J as wt,p as qt,k as Mt,i as ze,s as $t,z as Qe,l as Rt,E as yt,C as Bt,q as Jt,b as Qt,w as Yt,j as Vt,I as eo,B as to}from"./entry.6094c312.js";/* empty css              */import{s as at,m as oo,l as io,b as no,a as ro,_ as ao}from"./transform.8f3db536.js";import{D as u}from"./decimal.0e8aa3f1.js";import{u as ct,a as lo}from"./sha256.229d99e6.js";import{_ as so}from"./apr-tips.f373669b.js";import"./decimal.633e31ee.js";import{g as uo}from"./common-fun.b375bcda.js";import{c as Ot,_ as Ft,b as Ut,a as jt}from"./new-liquidity-title.2aa546b1.js";import{i as bt}from"./import-icon.de3e6c66.js";import{positionError as ot,tickList as tt,direction as qe,minPrice as W,maxPrice as z,fromCoin as w,toCoin as y,currentPrice as lt,currentPriceReverse as ht,currentPriceTab as ee,defaultMinPrice as mt,defaultMaxPrice as vt,toggle as zt,isInputTotalAmount as De,priceConfigObj as Ke,fromCoinAmount as T,toCoinAmount as N,fixedFromCoin as Pe,resetTickList as St,resetData as co}from"./data.8a8aab18.js";import{_ as mo}from"./coin-select.00148443.js";import{_ as vo}from"./viewDetail.9d11fa2f.js";import{_ as fo}from"./token-warning-modal.bd9c12a5.js";import{b as go}from"./new-add-or-create.ae6ee5d9.js";/* empty css              */import{u as po}from"./notifi.c2dab014.js";import{_ as bo,a as ho}from"./icon-Add-Liquidity_2x.0acb06cb.js";import"./img-lock_2x.d0c9e00e.js";import"./precision.a7a6c57b.js";/* empty css              */import"./tick.505fdad3.js";import"./token-warning.6d8ce23c.js";/* empty css              */import"./refresh-icon.9792a6ad.js";/* empty css              */import"./swap-setting.c2c8aae0.js";/* empty css              */import"./img-no-Positions_2x.40afde5a.js";import"./status-block.a200a621.js";import"./icon-arrow_2x.948aedb2.js";import"./icon-arrow_2x.4ffddb8e.js";import"./icon-selected_3x.09e9a6f0.js";import"./useWhale.7bca6e08.js";import"./index.35ca5b5b.js";function Nt(e,s,fe){const H=new u(10).pow(s-fe);return new u(1.0001).pow(e).mul(H)}const ko=it({props:{poolInfo:{type:Object,default:()=>({chartLoading:!1,token_a:{decimal:6},token_b:{decimal:6},currentLiquity:"50000000"})},minPrice:{type:String,default:""},maxPrice:{type:String,default:""},direction:{type:Boolean,default:!0},tickList:{type:Array,default:()=>[]},currentTick:{type:Number,default:0},chartLoading:{type:Boolean,default:!1},currentPriceTab:{type:String,default:""},before7dContractPriceLowest:{type:String,default:""},before7dContractPriceHighest:{type:String,default:""},zoom:{type:Number,default:1}},setup(e,s){const fe=E(""),H=E(""),F=L(()=>{var i,g,r,A,U,V;return console.log(e.poolInfo,"===>props.poolInfo"),(i=e.poolInfo)!=null&&i.current_sqrt_price&&((g=e.poolInfo)!=null&&g.coinA.decimals)&&((r=e.poolInfo)!=null&&r.coinB.decimals)?l.sqrtPriceX64ToPrice((A=e.poolInfo)==null?void 0:A.current_sqrt_price,(U=e.poolInfo)==null?void 0:U.coinA.decimals,(V=e.poolInfo)==null?void 0:V.coinB.decimals).toString():"0"}),he=L(()=>{let i=0;return e.direction?i=(Number(e.minPrice)/Number(F.value)-1)*100:i=(Number(e.minPrice)/Number(1/Number(F.value))-1)*100,i=i>0&&i<.1?.1:i,i=i<0&&i>-.1?-.1:i,i}),X=L(()=>{let i=0;return e.direction?i=(Number(e.maxPrice)/Number(F.value)-1)*100:i=(Number(e.maxPrice)/Number(1/Number(F.value))-1)*100,i=i>0&&i<.1?.1:i,i=i<0&&i>-.1?-.1:i,i}),I=ct(),k=L(()=>I),Q=L(()=>k.value.chainName?st(k.value.chainName):{}),{TickMath:l,getNearestTickByTick:n}=Q.value,x=(i=[])=>{let g=6;const r=Math.abs(Number(i[0])-Number(i[i.length-1]));return r>=6?g=0:r>=1?g=1:r>=.1?g=2:r>=.01?g=3:r>=.001?g=4:r>=1e-4?g=5:r>=1e-5?g=6:r>=1e-6?g=7:r>=1e-7&&(g=8),g},re=(i,g=1)=>{if(i&&i.token_a&&!e.chartLoading&&e.minPrice&&e.maxPrice){const r=Number(e.poolInfo.current_tick_index);console.log("0117###dataProcessing###currentTick###",r),console.log("0117###dataProcessing###props.poolInfo###",e.poolInfo),console.log("0117###dataProcessing###minPrice###",e.minPrice),console.log("0117###dataProcessing###maxPrice###",e.maxPrice),console.log("0117###dataProcessing###poolInfo###",e.poolInfo);let A=r+100*g,U=r-100*g,V,ae;if(e.maxPrice==="∞")ae=Q.value.TickUtil.getMaxIndex(Number(e.poolInfo.tickSpacing));else try{e.direction?ae=l.priceToTickIndex(new u(e.maxPrice),e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals):ae=l.priceToTickIndex(new u(1).div(e.minPrice),e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals)}catch{ae=443636}if(e.minPrice==="0")V=Q.value.TickUtil.getMinIndex(Number(e.poolInfo.tickSpacing));else try{e.direction?V=l.priceToTickIndex(new u(e.minPrice),e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals):V=l.priceToTickIndex(new u(1).div(e.maxPrice),e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals)}catch{V=-443636}let de=0;if(e.currentPriceTab!=="full range"){if(r>=V&&r<=ae){const P=r-V,ie=ae-r;de=Math.max(Math.abs(P),Math.abs(ie))}else r<V?de=Math.abs(ae-r):de=Math.abs(r-V);A=r+de+100*g,U=r-de-100*g}else{const P=(Math.abs(r)>5e3,2e4);A=r+P*g,U=r-P*g}U<-443636&&(U=-443636),A>443636&&(A=443636);const m=new u(i.liquidity).div(Math.pow(10,8)).toString(),q=e.tickList;console.log("0117####drawChart####tick_info_array####",q);const R=[],_=[];let C={};for(let P=0;P<q.length;P++){if(C=q[P],C.index<=r&&C.index>=U){if(R.length<1&&P!==0){const ie=q[P-1];R.unshift({...ie,index:U})}R.unshift(C)}else if(C.index>r&&C.index<=A&&(_.push(C),R.length<1&&P!==0)){const ie=q[P-1];R.push({...ie,index:U})}if(C.index>A){const ie=q[P];if(_.push({...ie,index:A}),R.length<1&&P!==0){const Je=q[P-1];R.push({...Je,index:U})}break}}let D="0";for(let P=R.length-1;P>=0;P--)D=new u(D).plus(new u(R[P].liquidityNet.toString()).div(Math.pow(10,8))).toString(),R[P].liquityAmount=D;let M=m;for(let P=0;P<_.length;P++)M=new u(M).plus(new u(_[P].liquidityNet.toString()).div(Math.pow(10,8))).toString(),_[P].liquityAmount=M;let Z=[];const $=q&&q.length>0?{index:r,liquityAmount:Number(m)}:{index:r,liquityAmount:0};(R.length>0||_.length>0)&&(Z=[...R.reverse(),$,..._],e.direction||(Z=Z.reverse()));const Ne=[];q.forEach(P=>{Ne.push({...P,liquidityGross:P.liquidityGross.toString(),liquidityNet:P.liquidityNet.toString()})}),console.log("0117####drawChart####testTickInfoArray####",Ne),console.log("0117####drawChart####currentLiquity####",m),p(Z,U,A,V,ae,r)}};let Y=E(!1);Lt(()=>{document.body.clientWidth<750?Y.value=!1:Y.value=!0,window.onresize=()=>{document.body.clientWidth<750?Y.value=!1:Y.value=!0,re(e.poolInfo,e.zoom)}});const p=(i,g,r,A,U,V)=>{console.log("0117####drawChart####chartData####",i),console.log("0117####drawChart####tickMin####",g),console.log("0117####drawChart####tickMax####",r),console.log("0117####drawChart####minPriceTick####",A),console.log("0117####drawChart####maxPriceTick####",U),console.log("0117####drawChart####currentTick####",V),console.log("0117####drawChart####props.direction####",e.direction),console.log("0518###newd3###props.before7dContractPriceLowest###",e.before7dContractPriceLowest),console.log("0518###newd3###props.before7dContractPriceHighest###",e.before7dContractPriceHighest);let ae,de;e.direction?(ae=e.before7dContractPriceLowest?l.priceToTickIndex(new u(e.before7dContractPriceLowest),e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals):"",de=e.before7dContractPriceHighest?l.priceToTickIndex(new u(e.before7dContractPriceHighest),e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals):""):(ae=e.before7dContractPriceLowest?l.priceToTickIndex(new u(1).div(e.before7dContractPriceLowest),e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals):"",de=e.before7dContractPriceHighest?l.priceToTickIndex(new u(1).div(e.before7dContractPriceHighest),e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals):"");const m={top:30,right:35,bottom:20,left:55};let q,R;Y.value?(q=506-m.left-m.right,R=205-m.top-m.bottom):(q=340-m.left-m.right,R=205-m.top-m.bottom);const _=r-g,C=parseInt(String(_/4));let D=[g+C/4,g+C,g+2*C,r-C,r-C/4];const M=g,Z=r,$=q/(Z-M);e.currentPriceTab==="full range"&&(D=[g,g+2*C,r]),console.log("0117####drawChart####xArr####",D),console.log("0117####drawChart####utickMin####",M),console.log("0117####drawChart####utickMax####",Z),console.log("0117####drawChart####unit####",$);const Ne=D.map(c=>e.direction?Nt(c,e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals).toString():new u(1).div(Nt(c,e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals)).toString()),P=x(Ne);at("#chart").selectAll("*").remove();const ie=at("#chart").attr("width",q+m.left+m.right).attr("height",R+m.top+m.bottom).append("g").attr("transform",`translate(${m.left},${m.right})`),Je=oo(i,function(c){return Number(Math.abs(c.liquityAmount))})||0,t=io().range([0,R]).domain([Je,0]);no().rangeRound([0,q]).padding(.1);const B=ie.append("g").attr("id","barsBox").selectAll("rect").data(i).enter().append("rect");k.value.theme=="default"?B.attr("x",function(c,d){return d===0?0:e.direction?Math.abs(c.index-M)*$:Math.abs(Z-c.index)*$}).attr("y",function(c,d){return e.direction?d===i.length-1?0:t(c.liquityAmount):d===i.length-1?0:t(i[d+1].liquityAmount)}).attr("width",function(c,d){return d===0&&i.length===1&&c.liquityAmount>0?q:(e.direction,d!==i.length-1?Math.abs(i[d+1].index-c.index)*$:0)}).attr("height",function(c,d){return d===0&&i.length===1&&c.liquityAmount>0?R:e.direction?d===i.length-1?0:R-t(c.liquityAmount):d===i.length-1?0:R-t(i[d+1].liquityAmount)}).attr("fill","#279477").attr("class","bars").attr("stroke-width",1).attr("stroke","#279477"):B.attr("x",function(c,d){return d===0?0:e.direction?Math.abs(c.index-M)*$:Math.abs(Z-c.index)*$}).attr("y",function(c,d){return e.direction?d===i.length-1?0:t(Math.abs(c.liquityAmount)):d===i.length-1?0:t(Math.abs(i[d+1].liquityAmount))}).attr("width",function(c,d){return d===0&&i.length===1&&c.liquityAmount>0?q:(e.direction,d!==i.length-1?Math.abs(i[d+1].index-c.index)*$:0)}).attr("height",function(c,d){if(d===0&&i.length===1&&c.liquityAmount>0)return R;if(e.direction)return d===i.length-1?0:Number(c.liquityAmount)?R-t(Math.abs(c.liquityAmount)):0;{if(d===i.length-1)return 0;const Be=R-t(Math.abs(i[d+1].liquityAmount));return Number(i[d+1].liquityAmount)?Be:0}}).attr("fill","#407497").attr("class","bars").attr("stroke-width",1).attr("stroke","#407497");const j=ie.append("g");j.append("line").attr("x1",0).attr("y1",155).attr("x2",q).attr("y2",155).attr("stroke-width",1).attr("stroke","#50535D");const _e=j.append("g");let K=0;if(e.direction){for(let c=0;c<D.length;c++){const d=ye(Ne[c],P)||"0";console.log("0423####price####",d),Ne.push(d);const Be=Math.abs(D[c]-M)*$;let ge=0;for(let pe=0;pe<d.length;pe++)d[pe]==="1"?ge+=4.02:d[pe]==="."?ge+=2.64:d[pe]==="7"?ge+=5.48:ge+=6;console.log(Be,"x=>>>"),_e.append("text").text(d).attr("x",Be-ge/2).attr("y",168).attr("fill","rgba(255, 255, 255, 0.5").style("font-size","10")}K=Math.abs(V-M)*$}else{for(let c=D.length-1;c>=0;c--){const d=ye(Ne[c],P)||0;Ne.push(d);const Be=Math.abs(D[c]-Z)*$;let ge=0;for(let pe=0;pe<d.length;pe++)d[pe]==="1"?ge+=4.02:d[pe]==="."?ge+=2.64:d[pe]==="7"?ge+=5.48:ge+=6;_e.append("text").text(d).attr("x",Be-ge/2).attr("y",168).attr("fill","rgba(255, 255, 255, 0.5").style("font-size","10")}K=Math.abs(V-Z)*$}(k.value.theme=="default"?ie.append("line").attr("x1",0).attr("y1",0).attr("x2",0).attr("y2",155).attr("stroke-width",2).attr("stroke","#68FFD8"):ie.append("line").attr("x1",0).attr("y1",0).attr("x2",0).attr("y2",155).attr("stroke-width",2).attr("stroke","#76C8FF")).attr("transform","translate("+K+", 0)");let Se,He,xe,$e;e.direction?(console.log("0525###d3###select###minPriceTick###",A),console.log("0525###d3###select###maxPriceTick###",U),console.log("0525###d3###select###props.minPrice###",e.minPrice),console.log("0525###d3###select###props.maxPrice###",e.maxPrice),Se=A<M?-100:parseInt(String(Math.abs(A-M)*$)),He=U<M?-100:parseInt(String(Math.abs(U-M)*$)),xe=ae<M?-100:Math.abs(ae-M)*$,$e=de<M?-100:Math.abs(de-M)*$):(He=A<M?-100:Math.abs(Z-A)*$,Se=U<M?-100:Math.abs(Z-U)*$,$e=ae<M?-100:Math.abs(Z-ae)*$,xe=de<M?-100:Math.abs(Z-de)*$),e.minPrice==="0"&&(Se=0),e.maxPrice==="∞"&&(He=q),Y.value?fe.value=q-Se+60+"px":fe.value=q-Se+52+"px",H.value=He+74+"px",ae&&xe<q&&ie.append("line").attr("x1",0).attr("y1",0).attr("x2",0).attr("y2",155).attr("stroke-width",1).attr("stroke-dasharray","5, 5").attr("stroke","rgba(255, 255, 255, 0.5)").attr("transform","translate("+xe+", 0)"),de&&$e<q&&ie.append("line").attr("x1",0).attr("y1",0).attr("x2",0).attr("y2",155).attr("stroke-width",1).attr("stroke-dasharray","5, 5").attr("stroke","rgba(255, 255, 255, 0.5)").attr("transform","translate("+$e+", 0)");const ke=ie.append("g").attr("id","left-handle"),Re=ie.append("g").attr("id","right-handle");k.value.theme=="default"?(ke.append("line").attr("x1",0).attr("y1",0).attr("x2",0).attr("y2",155).attr("stroke-dasharray","5, 5").attr("stroke-width",2).attr("stroke","#68FFD8"),ke.append("path").attr("d","M0 0 L12 0 L12 20 L0 20 Z").attr("fill","#333").attr("stroke","#333").attr("transform","translate(-1, 20) rotate(180)"),ke.append("rect").attr("width",1).attr("height",7).attr("x",-9).attr("y",6).attr("fill","#68FFD8"),ke.append("rect").attr("width",1).attr("height",10).attr("x",-7).attr("y",4.5).attr("fill","#68FFD8"),Re.append("line").attr("x1",0).attr("y1",0).attr("x2",0).attr("y2",155).attr("stroke-dasharray","5, 5").attr("stroke-width",2).attr("stroke","#68FFD8"),Re.append("path").attr("d","M0 0 L12 0 L12 20 L0 20 Z").attr("fill","#333").attr("stroke","#333").attr("transform","translate(1, 0)"),Re.append("rect").attr("width",1).attr("height",7).attr("x",7).attr("y",6).attr("fill","#68FFD8"),Re.append("rect").attr("width",1).attr("height",10).attr("x",5).attr("y",4.5).attr("fill","#68FFD8")):(ke.append("line").attr("x1",0).attr("y1",0).attr("x2",0).attr("y2",155).attr("stroke-dasharray","5, 5").attr("stroke-width",2).attr("stroke","#76C8FF"),ke.append("path").attr("d","M0 0 L12 0 L12 24 L0 24 Z").attr("fill","#333").attr("stroke","#333").attr("transform","translate(-1, 24) rotate(180)"),ke.append("rect").attr("width",1).attr("height",7).attr("x",-9).attr("y",8).attr("fill","#76C8FF"),ke.append("rect").attr("width",1).attr("height",10).attr("x",-7).attr("y",6.5).attr("fill","#76C8FF"),Re.append("line").attr("x1",0).attr("y1",0).attr("x2",0).attr("y2",155).attr("stroke-dasharray","5, 5").attr("stroke-width",2).attr("stroke","#76C8FF"),Re.append("path").attr("d","M0 0 L12 0 L12 24 L0 24 Z").attr("fill","#333").attr("stroke","#333").attr("transform","translate(1, 0)"),Re.append("rect").attr("width",1).attr("height",7).attr("x",7).attr("y",8).attr("fill","#76C8FF"),Re.append("rect").attr("width",1).attr("height",10).attr("x",5).attr("y",6.5).attr("fill","#76C8FF")),console.log("0525###d3###select###minPriceTickX###",Se),console.log("0525###d3###select###maxPriceTickX###",He),ke.attr("transform","translate("+Se+", 0)"),Re.attr("transform","translate("+He+", 0)");const Ye=ro().extent([[0,0],[q,R]]).handleSize(30).on("end",rt);ie.append("g").attr("class","brush").call(Ye).call(Ye.move,[Se,He]);function rt(c){if(!c.sourceEvent||!c.selection)return;ke.attr("transform","translate("+c.selection[0]+", 0)"),Re.attr("transform","translate("+c.selection[1]+", 0)"),Y.value?fe.value=q-c.selection[0]+60+"px":fe.value=q-c.selection[0]+52+"px",H.value=c.selection[1]+74+"px";let d,Be;console.log("0525###d3###select###e.selection[0]###",c.selection[0]),console.log("0525###d3###select###e.selection[0]###",c.selection[1]),console.log("0525###d3###select###props.direction###",e.direction),console.log("0525###d3###select###width###",q),console.log("0525###d3###select###unit###",$),console.log("0525###d3###select###utickMin###",M),console.log("0525###d3###select###utickMax###",Z),console.log("0525###d3###select###props.poolInfo###",e.poolInfo);let ge=0,pe=0;e.direction?(ge=n(parseInt(String(c.selection[0]/$+M)),Number(e.poolInfo.tickSpacing)),d=l.tickIndexToPrice(ge,e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals).toString(),pe=n(parseInt(String(c.selection[1]/$+M)),Number(e.poolInfo.tickSpacing)),Be=l.tickIndexToPrice(pe,e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals).toString(),console.log("0525###d3###select###minTick###",ge),console.log("0525###d3###select###maxTick###",pe),console.log("0525###d3###select###minPrice###",d),console.log("0525###d3###select###maxPrice###",Be)):(pe=n(Z-c.selection[0]/$,Number(e.poolInfo.tickSpacing)),d=1/l.tickIndexToPrice(pe,e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals).toString(),ge=n(Z-c.selection[1]/$,Number(e.poolInfo.tickSpacing)),Be=1/l.tickIndexToPrice(ge,e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals).toString()),s.emit("onChangeMinPrice",String(ye(String(d),6))),s.emit("onChangeMaxPrice",String(ye(String(Be),6)))}k.value.theme=="default"?at(".selection").attr("stroke","rgba(255, 255, 255, 0)").attr("fill","#15322C"):at(".selection").attr("stroke","rgba(255, 255, 255, 0)").attr("fill","#152632")};E(""),Ie(()=>[e.poolInfo,e.minPrice,e.maxPrice,e.currentPriceTab,e.zoom],([i,g,r,A,U])=>{console.log(i,g,r,r>g,"poolInfo && minPrice && maxPrice && (maxPrice > minPrice)"),i&&g&&r&&(i!=null&&i.liquidity)&&(A!=="Custom"||console.log("绘制"),re(i,U))},{immediate:!0});const v=E(!1);return Ie(()=>e.chartLoading,(i,g)=>{i!==g&&(v.value=i)},{immediate:!0,deep:!0}),console.log(e,"props===>"),{store:k,loading:v,rangeSizeLower:he,rangeSizeUpper:X,rangeSizeLowerPosition:fe,rangeSizeUpperPosition:H,decimalFormat:Gt,numberformat:ft}}});const wo=e=>(qt("data-v-12735a95"),e=e(),Mt(),e),yo={class:"chart-box"},_o={class:"chart"},Co=wo(()=>a("svg",{id:"chart"},null,-1));function Po(e,s,fe,H,F,he){const X=wt;return h(),O(ut,null,[e.tickList&&e.tickList.length>0&&e.loading?(h(),Ze(X,{key:0})):te("",!0),a("div",yo,[It(a("div",_o,[e.currentPriceTab!=="full range"?(h(),O("div",{key:0,class:"range-size range-size-lower",style:pt({right:e.rangeSizeLowerPosition})},be(("numberformat"in e?e.numberformat:Te(ft))(e.rangeSizeLower.toFixed(1),1))+"% ",5)):te("",!0),e.currentPriceTab!=="full range"?(h(),O("div",{key:1,class:"range-size range-size-upper",style:pt({left:e.rangeSizeUpperPosition})},be(("numberformat"in e?e.numberformat:Te(ft))(e.rangeSizeUpper.toFixed(1),1))+"% ",5)):te("",!0),Co],512),[[Kt,!e.loading]])])],64)}const Ht=nt(ko,[["render",Po],["__scopeId","data-v-12735a95"]]),To=it({props:{aprRewardsParameter:{type:Number,default:30},minPrice:{type:String,default:""},maxPrice:{type:String,default:""},fromCoin:{type:Object,default:()=>({})},toCoin:{type:Object,default:()=>({})},poolInfo:{type:Object,default:()=>({})},nameTab:{type:String,default:""}},setup(e){const s=[{label:"24H",value:24},{label:"7D",value:7},{label:"30D",value:30}],fe=ct(),H=L(()=>fe);L(()=>H.value.chainName);const F=kt(),he=L(()=>F),X=L(()=>H.value.chainName?st(H.value.chainName):{}),I=E(),k=async n=>{var V,ae,de;console.log("0607###detail###getAprMethod###poolInfo###",n),console.log("0607###detail###getAprMethod###props.fromCoin###",e.fromCoin),console.log("0607###detail###getAprMethod###props.toCoin###",e.toCoin),console.log("0607###detail###getAprMethod###props.nameTab###",e.nameTab);let x;n.token_a.address.toLowerCase()===e.fromCoin.address.toLowerCase()&&n.token_b.address.toLowerCase()===e.toCoin.address.toLowerCase()?x=!0:x=!1,console.log("0607###detail###getAprMethod###directs###",x),console.log("0607###detail###getAprMethod###props.minPrice###",e.minPrice),console.log("0607###detail###getAprMethod###props.maxPrice###",e.maxPrice);let re,Y;x?(re=Number(e.minPrice),Y=Number(e.maxPrice)):e.maxPrice!=="∞"?(re=1/Number(e.maxPrice),Y=1/Number(e.minPrice)):(re=1/2**50,Y=2**50),console.log("0607###detail###getAprMethod###lowerUserPrice###",re),console.log("0607###detail###getAprMethod###upperUserPrice###",Y);let p=[];p=H.value&&H.value.addressHistTokens&&H.value.addressHistTokens[n.poolAddress]&&H.value.addressHistTokens[n.poolAddress].data&&H.value.addressHistTokens[n.poolAddress].data.length>0&&Object.fromEntries(H.value.addressHistTokens[n.poolAddress].data.map(m=>[m.key,m.value]));let v,i;console.log(p,"===>addressHistTokensList"),e.aprRewardsParameter==7?(v=Number(p==null?void 0:p.before_7_d_contract_price_lowest),i=Number(p==null?void 0:p.before_7_d_contract_price_highest)):e.aprRewardsParameter==24?(v=Number(p==null?void 0:p.before_24_h_contract_price_lowest),i=Number(p==null?void 0:p.before_24_h_contract_price_highest)):(v=Number(p==null?void 0:p.before_30_d_contract_price_lowest),i=Number(p==null?void 0:p.before_30_d_contract_price_highest));const g=he.value.tokensObj;console.log("getEstPositionAPRWithMulti###params###lowerUserPrice###",re),console.log("getEstPositionAPRWithMulti###params###upperUserPrice###",Y),console.log("getEstPositionAPRWithMulti###params###lowerHistPrice###",v),console.log("getEstPositionAPRWithMulti###params###upperHistPrice###",i);const r=await X.value.getEstPositionAPRWithMulti(re,Y,v,i);console.log("getEstPositionAPRWithMulti###resMulti###",r.toString());const A=H.value.newTopPoolsObj[n.poolAddress];console.log(n,"#####stats");let U;if(A){e.aprRewardsParameter==7?U=Number(A.apr_7day.replace("%","")):e.aprRewardsParameter==24?U=Number(A.apr_24h.replace("%","")):U=Number(A.apr_30day.replace("%",""));const m=Number(A.rewarder_apr[0].replace("%","")),q=Number(A.rewarder_apr[1].replace("%","")),R=Number(A.rewarder_apr[2].replace("%","")),_=new u(r.toString()).mul(U).toNumber();console.log(r.toString(),"===>resMulti.toString()");const C=new u(r.toString()).mul(m).toNumber(),D=new u(r.toString()).mul(q).toNumber(),M=new u(r.toString()).mul(R).toNumber();console.log(C,D,M,"posRewarder2_apr##");const Z=_+(n.rewarder_display1?C:0)+(n.rewarder_display2?D:0)+(n.rewarder_display3?M:0);console.log(Z,"###aprPercentageTotal");const $=n.rewarder_infos[0]?(V=g[n.rewarder_infos[0].coinAddress])==null?void 0:V.symbol:"--",Ne=n.rewarder_infos[1]?(ae=g[n.rewarder_infos[1].coinAddress])==null?void 0:ae.symbol:"--",P=n.rewarder_infos[2]?(de=g[n.rewarder_infos[2].coinAddress])==null?void 0:de.symbol:"--",ie={aprFee:_==1/0||isNaN(_)?0:_,rewardAprList:[{rewarder_name:$,rewarder_apr:C==1/0||isNaN(C)?0:C,styleName:"one",rewarder_display:n.rewarder_display1},{rewarder_name:Ne,rewarder_apr:D==1/0||isNaN(D)?0:D,styleName:"two",rewarder_display:n.rewarder_display2},{rewarder_name:P,rewarder_apr:M==1/0||isNaN(M)?0:M,styleName:"three",rewarder_display:n.rewarder_display2}],aprPercentageTotal:Z==1/0||isNaN(Z)||Z===0?0:Z,aprPercentage:At(_/Z,2),is_display_rewarder:n.is_display_rewarder};I.value=ie,console.log(I.value,"===>aprPercentageObj.value")}};Ie(()=>[e.poolInfo,e.minPrice,e.maxPrice,H.value.addressHistTokens],([n,x,re,Y])=>{n&&!Le(n)&&Y&&!Le(Y)&&k(n)},{immediate:!0});const Q=L(()=>uo(e.poolInfo,he,H));Ie(()=>[e.aprRewardsParameter],()=>{k(e.poolInfo)});const l=L(()=>{const n=I.value;return n&&n.is_display_rewarder?(n==null?void 0:n.aprPercentageTotal)>1e4?">10000":n.aprPercentageTotal<.01&&n.aprPercentageTotal>0?"<0.01":Ee(n.aprPercentageTotal,2):n&&!n.is_display_rewarder?(n==null?void 0:n.aprFee)>1e4?">10000":n.aprFee<.01&&n.aprFee>0?"<0.01":Ee(n.aprFee,2):"--"});return{poolMoreInfo:Q,timeList:s,aprPercentageObj:I,totalApr:l}}}),So=""+globalThis.__publicAssetsURL("sui-image/farming.png");const _t=e=>(qt("data-v-4e388208"),e=e(),Mt(),e),No={class:"est-apr"},Ao=_t(()=>a("div",{class:"title"},"Estimated APR",-1)),Lo={class:"apr-total"},Io={class:"apr-box"},qo={class:"apr-hover-content"},Mo={key:0,class:"isFarming"},$o=_t(()=>a("img",{src:So,alt:""},null,-1)),Ro=_t(()=>a("div",{class:"hover-text"},"Farming rewards available",-1)),Bo=[$o,Ro],Oo={class:"time-list"},Fo=["onClick"];function Uo(e,s,fe,H,F,he){var I,k,Q,l;const X=so;return h(),O("div",No,[Ao,a("div",Lo,[a("div",Io,[a("span",null,be(e.totalApr)+"%",1),a("div",qo,[ze(X,{"l-item":e.poolMoreInfo,"rewarder-info":(I=e.poolMoreInfo)==null?void 0:I.rewardes,class:"noHover apr-hover-con"},null,8,["l-item","rewarder-info"])])]),(k=e.poolInfo)!=null&&k.is_display_rewarder&&((Q=e.poolInfo)!=null&&Q.rewarderInfo)&&((l=e.poolInfo)==null?void 0:l.rewarderInfo.length)>0?(h(),O("div",Mo,Bo)):te("",!0)]),a("div",Oo,[(h(!0),O(ut,null,$t(e.timeList,n=>(h(),O("div",{key:n.value,class:Qe(["time-item",n.value==e.aprRewardsParameter?"time-item-active":""]),onClick:x=>e.$emit("changeAprRewardsParameter",n.value)},be(n.label),11,Fo))),128))])])}const Dt=nt(To,[["render",Uo],["__scopeId","data-v-4e388208"]]),jo=it({components:{NewLiquidityD3Chart:Ht,NewLiquidityApr:Dt,NewLiquidityPrice:Ot},setup(){const{t:e,locale:s}=Rt(),fe=E("liquidity"),H=ct(),F=L(()=>H),he=L(()=>F.value.chainName),X=kt(),I=L(()=>X),k=L(()=>F.value.chainName?st(F.value.chainName):{});Lt(()=>{ot.value=!1});const Q=yt(),l=L(()=>{let t=null;for(let b=0;b<I.value.poolConfigList.length;b++){const B=I.value.poolConfigList[b];B.address==Q.query.poolAddress&&(t=B)}return console.log(t,"===>basePoolInfo"),t}),n=L(()=>{let t=null;for(const b in I.value.poolsObj){const B=I.value.poolsObj[b];B.address==Q.query.poolAddress&&(console.log(B,"p===>"),t=B)}return t}),x=E(),re=E(!0),Y=async(t,b)=>{if(b){re.value=!0;const B=t.token_a.decimals,j=t.token_b.decimals;console.log(t,"pool===>1111"),lt.value=Ct.sqrtPriceX64ToPrice(t==null?void 0:t.current_sqrt_price,B,j).toString(),ht.value=new u(1).div(Ct.sqrtPriceX64ToPrice(t==null?void 0:t.current_sqrt_price,B,j)).toString(),w.value=t.needReverse?t.token_b:t.token_a,y.value=t.needReverse?t.token_a:t.token_b,x.value=t.needReverse,t.token_a.address.toLowerCase()===w.value.address.toLowerCase()&&t.token_b.address.toLowerCase()===y.value.address.toLowerCase()?qe.value=!0:qe.value=!1,console.log(t,"187===>"),console.log(t,"###pool===>");let _e={poolAddress:t.address,coinTypeA:t.coin_a_address,coinTypeB:t.coin_b_address};const K=await k.value.getTicks(_e);tt.value=K?k.value.getTickDataFromUrlData(K):[],console.log(tt.value,"===>chartLoadingtickList.value"),i(t)}re.value=!1,console.log(re.value,"==>chartLoading.value")},p=E([]),v=E(),i=t=>{const b=t.token_a.decimals,B=t.token_b.decimals;let j=I.value.poolPriceConfigObj&&I.value.poolPriceConfigObj[t.address]&&I.value.poolPriceConfigObj[t.address].recommend_ranges||{};const _e=I.value.poolPriceConfigObj&&I.value.poolPriceConfigObj[t.address]&&I.value.poolPriceConfigObj[t.address].type||"";console.log(j,"===>priceConfigList");let K,Me;const Se=t.current_tick_index;v.value=t.current_tick_index,console.log(Se,t.tickSpacing,"==>pool.tickSpacing"),K=Se-Number(t.type=="unstable"?Number(t.tickSpacing)*2:Number(t.tickSpacing)*3),Me=Se+Number(t.type=="unstable"?Number(t.tickSpacing)*2:Number(t.tickSpacing)*3);const He=k.value.TickMath.tickIndexToPrice(K,b,B).toString(),xe=k.value.TickMath.tickIndexToPrice(Me,b,B).toString();j["full range"]={lower:k.value.TickUtil.getMinIndex(Number(n.value.tickSpacing)),upper:k.value.TickUtil.getMaxIndex(Number(n.value.tickSpacing))},j.custom={lower:K,upper:Me,minPrice:He,maxPrice:xe};const $e=[];for(let ke in j)j[ke]&&(console.log(ke,"j==>"),$e.push({...j[ke],key:ke}));console.log($e,"priceList"),console.log(t,"###pool.type 504"),_e?t.isSelfBuilt?ee.value="custom":_e=="stable"?ee.value="suggested":ee.value="passive":ee.value="custom",p.value=$e,Ke.value=j,A({key:ee.value,...j[ee.value]})},g=E(""),r=E(""),A=t=>{console.log("priceTab====>",t),console.log("priceTab###poolInfo###",n.value),ee.value=t.key.toLowerCase();const b=n.value.token_a.decimals,B=n.value.token_b.decimals,{lower:j,upper:_e}=t;De.value=!1;const K=k.value.TickMath.tickIndexToPrice(j,b,B).toString(),Me=k.value.TickMath.tickIndexToPrice(_e,b,B).toString();if(t.key=="full range"){g.value=j,r.value=_e,U();return}console.log(qe.value,"===>direct.value"),qe.value?(mt.value=String(K),W.value=String(K),vt.value=String(Me),z.value=String(Me),g.value=j,r.value=_e):(mt.value=String(1/Number(Me)),W.value=String(1/Number(Me)),vt.value=String(1/Number(K)),z.value=String(1/Number(K)),g.value=k.value.TickMath.priceToTickIndex(new u(1/Number(Me)),b,B),r.value=k.value.TickMath.priceToTickIndex(new u(1/Number(K)),b,B)),console.log(W.value,z.value,"===>111")},U=t=>{W.value="0",z.value="∞"};Ie(()=>n.value,(t,b)=>{console.log(b,"===>oldVal"),console.log(t,"===>newVal"),(!b&&t&&!Le(t)||b&&t&&b.address!==t.address)&&(console.log("池子信息"),Y(t,!b||t.address!==b.address))},{immediate:!0}),Bt(()=>{tt.value=[]}),Ie(()=>[l.value,n.value,I.value.recommendRangesObj],(t,b)=>{var B,j;console.log(t,"===>newValue369"),console.log(b,"===>oldValue369"),(!b||t[0]&&t[1]&&t[2]&&!Le(t[0])&&!Le(t[1]&&!Le(t[2]))||((B=t[0])==null?void 0:B.address)!==((j=b[0])==null?void 0:j.address))&&(console.log("3731111111"),t[0]&&t[2]&&!Le(t[0])&&!Le(t[2])&&(console.log(t[0],t[2],"======>374"),X.setSinglePool(t[0],t[2],he.value)))},{immediate:!0,deep:!0});const V=t=>{if(he.value=="Sui")switch(t){case"passive":return"/sui-image/icon_ conservative@2x.png";case"active":return"/sui-image/icon_active@2x.png";case"full range":return"/sui-image/icon_fullrange@2x.png";case"custom":return"/sui-image/icon_costom@2x.png";case"suggested":return"/sui-image/icon_stabel@2x.png"}else switch(t){case"passive":return"/image/icon_ conservative@2x.png";case"active":return"/image/icon_active@2x.png";case"full range":return"/image/icon_fullrange@2x.png";case"custom":return"/image/icon_costom@2x.png";case"suggested":return"/image/icon_stabel@2x.png"}},ae=t=>{switch(t){case"suggested":return e("newAdd.suggested");case"active":return e("newAdd.active");case"passive":return e("newAdd.conservative");case"full range":return e("newAdd.fullRange");case"custom":return e("newAdd.custom")}},de=t=>{var B,j;const b=I.value.poolPriceConfigObj&&I.value.poolPriceConfigObj[(B=n.value)==null?void 0:B.address]&&I.value.poolPriceConfigObj[(j=n.value)==null?void 0:j.address].type||"";if(console.log(b,t,"==>poolType"),b=="unstable")switch(t){case"active":return{top:"35%"};case"passive":return{top:"10%"};case"full range":return{top:"60%"};case"custom":return{top:"85%"}}else switch(t){case"suggested":return{top:"23%"};case"full range":return{top:"48%"};case"custom":return{top:"73%"}}},m=E(1),q=()=>{const t=m.value/2;m.value=t},R=()=>{const t=m.value*2;m.value=t};console.log(p.value,"==>priceTablList");const _=L(()=>{var t,b,B;return!n.value||Le(F.value.addressHistTokens)||!F.value.addressHistTokens[(t=n.value)==null?void 0:t.poolAddress]?null:Object.fromEntries((B=F.value.addressHistTokens[(b=n.value)==null?void 0:b.poolAddress])==null?void 0:B.data.map(j=>[j.key,j.value]))}),C=E(30),D=E("30D"),M=L(()=>qe.value?_.value&&ye(C.value==7?_.value.before_7_d_contract_price_lowest:C.value==24?_.value.before_24_h_contract_price_lowest:_.value.before_30_d_contract_price_lowest,6)||0:_.value&&ye(new u(1).div(C.value==7?_.value.before_7_d_contract_price_highest:C.value==24?_.value.before_24_h_contract_price_highest:_.value.before_30_d_contract_price_highest).toString(),6)||0),Z=L(()=>qe.value?_.value&&ye(C.value==7?_.value.before_7_d_contract_price_highest:C.value==24?_.value.before_24_h_contract_price_highest:_.value.before_30_d_contract_price_highest,6)||0:(_.value&&ye(1/Number(C.value==7?_.value.before_7_d_contract_price_lowest:C.value==24?_.value.before_24_h_contract_price_lowest:_.value.before_30_d_contract_price_lowest),6))==1/0?0:_.value&&ye(1/Number(C.value==7?_.value.before_7_d_contract_price_lowest:C.value==24?_.value.before_24_h_contract_price_lowest:_.value.before_30_d_contract_price_lowest),6)||0),$=L(()=>{const t=Number(W.value),b=Number(z.value);return W.value&&z.value&&W.value!=="0"&&z.value!=="∞"?gt(1/(1-Number((t/b)**.25)),2)+"x":1}),Ne=L(()=>{var t,b,B,j,_e,K;return((t=w.value)==null?void 0:t.isSelfBuilt)||((b=y.value)==null?void 0:b.isSelfBuilt)||((j=I.value.tokensObj[(B=w.value)==null?void 0:B.address])==null?void 0:j.isSelfBuilt)||((K=I.value.tokensObj[(_e=y.value)==null?void 0:_e.address])==null?void 0:K.isSelfBuilt)}),P=t=>{console.log(t,"####0731 priceRangeChangeMin"),t!==W.value&&ee.value=="full range"?(console.log(p.value,"===>priceTablList"),A({key:"custom",...p.value.custom})):ee.value!=="full range"&&ee.value!=="custom"?(ee.value="custom",W.value=t):W.value=t},ie=t=>{t!==z.value&&ee.value=="full range"?A({key:"custom",...p.value.custom}):ee.value!=="full range"&&ee.value!=="custom"?(ee.value="custom",z.value=t):z.value=t};return console.log(W.value,z.value,"683==>"),Ie(()=>[W.value,z.value],([t,b])=>{console.log(t,b,"minmax new-liquidity-left")},{deep:!0,immediate:!0}),{positionError:ot,getCoinIcon:t=>{var b;return(t==null?void 0:t.logoURI)||(t==null?void 0:t.logo_url)||((b=I.value.tokensObj[t==null?void 0:t.address])==null?void 0:b.logo_url)||(F.value.theme==="default"?bt("/image/coins/unknown.png"):bt("/image/coins/sui-unknown.png"))},chainName:he,store:F,currentTab:fe,currentPrice:lt,currentPriceReverse:ht,fromCoin:w,toCoin:y,direction:qe,needReverse:x,addCommom:Ee,decimalUi:ye,priceTablList:p,currentPriceTab:ee,sliderStyle:de,poolInfo:n,tickList:tt,getPriceTabImage:V,getPriceTabText:ae,defaultMinPrice:mt,defaultMaxPrice:vt,minPrice:W,maxPrice:z,currentTick:v,chartLoading:re,zoomOut:q,zoomIn:R,zoom:m,priceTab:A,before7dContractPriceLowest:M,before7dContractPriceHighest:Z,aprRewardsTime:D,lever:$,aprRewardsParameter:C,isSelfBuilt:Ne,priceRangeChangeMin:P,priceRangeChangeMax:ie,toggle:zt}}});const zo={class:"new-liquidity-left"},Ho={class:"select-range"},Do=a("span",null,"Select Range",-1),Wo={class:"range-tab"},Eo=["src"],Xo=["src"],Zo=a("span",null,"Liquidity",-1),xo=["src"],Go=["src"],Ko=a("span",null,"Price",-1),Jo={class:"price-info"},Qo={class:"left"},Yo={class:"base-coin"},Vo={class:"base-coin-title"},ei=a("svg",{class:"icon icon-up","aria-hidden":"true"},[a("use",{"xlink:href":"#icon-exchange_up1"})],-1),ti=a("svg",{class:"icon icon-down","aria-hidden":"true"},[a("use",{"xlink:href":"#icon-exchange_down1"})],-1),oi=[ei,ti],ii={class:"base-coin-bottom"},ni={alt:""},ri={class:"leverage"},ai=a("div",{class:"leverage-title"},"Leverage",-1),li={class:"laverage-value"},si={class:"current-price"},ui=a("div",{class:"current-price-title"},"Current Price",-1),ci={key:0,class:"from-pre-to"},di={class:"right"},mi={class:"price-range"},vi={class:"left"},fi={class:"price-slider"},gi={class:"slider"},pi=a("div",{class:"slider-ratio-content"},null,-1),bi=[pi],hi={class:"price-tab-list"},ki=["onClick"],wi=["src"],yi={class:"right"},_i={class:"range-tab"},Ci=["src"],Pi=["src"],Ti=a("span",null,"Liquidity",-1),Si=["src"],Ni=["src"],Ai=a("span",null,"Price",-1),Li={class:"price-zoom"},Ii={class:"current-price"},qi=a("div",{class:"current-price-title"},"Current Price",-1),Mi={key:0,class:"from-pre-to"},$i={class:"price-zoom-right"},Ri={class:"leverage"},Bi={class:"left"},Oi={key:0,class:"leverage-title"},Fi={key:1,class:"laverage-value"},Ui={class:"right"},ji={key:0,class:"day-7-price-range"},zi=a("i",null,null,-1),Hi={class:"gray"},Di={class:"apr-and-price"},Wi={key:0,class:"position-tips"},Ei=["src"],Xi={class:"error"};function Zi(e,s,fe,H,F,he){var n,x,re,Y,p,v,i,g;const X=Ht,I=wt,k=Dt,Q=Ot,l=Jt("image");return h(),O("div",zo,[a("div",Ho,[Do,a("div",Wo,[a("div",{class:Qe(["liquidity",e.currentTab=="liquidity"?"liquidity-tab-active":""]),onClick:s[0]||(s[0]=r=>e.currentTab="liquidity")},[e.chainName=="Sui"?(h(),O("img",{key:0,src:e.currentTab=="liquidity"?"/sui-image/Liquidity-Sel.png":"/sui-image/Liquidity-Def.png",alt:""},null,8,Eo)):(h(),O("img",{key:1,src:e.currentTab=="liquidity"?"/image/green_chart.png":"/sui-image/Liquidity-Def.png",alt:""},null,8,Xo)),Zo],2),a("div",{class:Qe(["price",e.currentTab=="price"?"price-tab-active":""]),onClick:s[1]||(s[1]=r=>e.currentTab="price")},[e.chainName=="Sui"?(h(),O("img",{key:0,src:e.currentTab=="price"?"/sui-image/Price-Sel.png":"/sui-image/Price-Def.png",alt:""},null,8,xo)):(h(),O("img",{key:1,src:e.currentTab=="price"?"/image/price-chart.png":"/sui-image/Price-Def.png",alt:""},null,8,Go)),Ko],2)])]),a("div",Jo,[a("div",Qo,[a("div",Yo,[a("div",Vo,[a("span",null,"Base coin"+be(!e.direction),1),a("div",{class:"change-price",onClick:s[2]||(s[2]=(...r)=>e.toggle&&e.toggle(...r))},oi)]),a("div",ii,[It(a("img",ni,null,512),[[l,e.getCoinIcon(e.fromCoin)]]),a("span",null,be((n=e.fromCoin)==null?void 0:n.symbol),1)])]),a("div",ri,[ai,a("div",li,be(e.lever),1)]),a("div",si,[ui,a("div",null,[a("span",null,be(e.poolInfo?e.direction?("addCommom"in e?e.addCommom:Te(Ee))(("decimalUi"in e?e.decimalUi:Te(ye))(e.currentPrice,6)):("addCommom"in e?e.addCommom:Te(Ee))(("decimalUi"in e?e.decimalUi:Te(ye))(e.currentPriceReverse,6)):"--"),1),e.fromCoin&&e.toCoin?(h(),O("span",ci,be((x=e.toCoin)==null?void 0:x.symbol)+" per "+be((re=e.fromCoin)==null?void 0:re.symbol),1)):te("",!0)])])]),a("div",di,[e.currentTab=="liquidity"?(h(),O("div",{key:0,class:"zoom-in",onClick:s[3]||(s[3]=(...r)=>e.zoomIn&&e.zoomIn(...r))}," - ")):te("",!0),e.currentTab=="liquidity"?(h(),O("div",{key:1,class:"zoom-out",onClick:s[4]||(s[4]=(...r)=>e.zoomOut&&e.zoomOut(...r))}," + ")):te("",!0)])]),a("div",mi,[a("div",vi,[a("div",fi,[a("div",gi,[a("div",{class:"slider-ratio",style:pt(e.sliderStyle(e.currentPriceTab))},bi,4)])]),a("div",hi,[(h(!0),O(ut,null,$t(e.priceTablList,r=>(h(),O("div",{key:r.key,class:Qe(["price-tab-item",e.currentPriceTab==r.key?"price-tab-item-active":""]),onClick:A=>e.priceTab(r)},[a("img",{src:e.getPriceTabImage(r.key),alt:""},null,8,wi),a("span",null,be(e.getPriceTabText(r.key)),1)],10,ki))),128))])]),a("div",yi,[a("div",_i,[a("div",{class:Qe(["liquidity",e.currentTab=="liquidity"?"liquidity-tab-active":""]),onClick:s[5]||(s[5]=r=>e.currentTab="liquidity")},[e.chainName=="Sui"?(h(),O("img",{key:0,src:e.currentTab=="liquidity"?"/sui-image/Liquidity-Sel.png":"/sui-image/Liquidity-Def.png",alt:""},null,8,Ci)):(h(),O("img",{key:1,src:e.currentTab=="liquidity"?"/image/green_chart.png":"/sui-image/Price-Def.png",alt:""},null,8,Pi)),Ti],2),a("div",{class:Qe(["price",e.currentTab=="price"?"price-tab-active":""]),onClick:s[6]||(s[6]=r=>e.currentTab="price")},[e.chainName=="sui"?(h(),O("img",{key:0,src:e.currentTab=="price"?"/sui-image/Price-Sel.png":"/sui-image/Price-Def.png",alt:""},null,8,Si)):(h(),O("img",{key:1,src:e.currentTab=="price"?"/image/price-chart.png":"/sui-image/Liquidity-Def.png",alt:""},null,8,Ni)),Ai],2)]),a("div",Li,[a("div",Ii,[qi,a("div",null,[a("span",null,be(e.poolInfo?e.direction&&!e.needReverse?("addCommom"in e?e.addCommom:Te(Ee))(("decimalUi"in e?e.decimalUi:Te(ye))(e.currentPrice,6)):("addCommom"in e?e.addCommom:Te(Ee))(("decimalUi"in e?e.decimalUi:Te(ye))(e.currentPriceReverse,6)):"--"),1),e.fromCoin&&e.toCoin?(h(),O("span",Mi,be(e.direction&&!e.needReverse?`${(Y=e.fromCoin)==null?void 0:Y.symbol} per ${(p=e.toCoin)==null?void 0:p.symbol}`:`${(v=e.toCoin)==null?void 0:v.symbol} per ${(i=e.fromCoin)==null?void 0:i.symbol}`),1)):te("",!0)])]),a("div",$i,[e.currentTab=="liquidity"?(h(),O("div",{key:0,class:"zoom-in",onClick:s[7]||(s[7]=(...r)=>e.zoomIn&&e.zoomIn(...r))}," - ")):te("",!0),e.currentTab=="liquidity"?(h(),O("div",{key:1,class:"zoom-out",onClick:s[8]||(s[8]=(...r)=>e.zoomOut&&e.zoomOut(...r))}," + ")):te("",!0)])]),e.fromCoin&&e.toCoin&&e.poolInfo&&e.currentTab=="liquidity"?(h(),Ze(X,{key:0,"pool-info":e.poolInfo,"min-price":e.minPrice,"max-price":e.maxPrice,direction:e.direction,"current-price-tab":e.currentPriceTab,"tick-list":e.tickList,"current-tick":e.currentTick,"chart-loading":e.chartLoading,zoom:e.zoom,"before7d-contract-price-lowest":e.before7dContractPriceLowest,"before7d-contract-price-highest":e.before7dContractPriceHighest,onOnChangeMinPrice:e.priceRangeChangeMin,onOnChangeMaxPrice:e.priceRangeChangeMax},null,8,["pool-info","min-price","max-price","direction","current-price-tab","tick-list","current-tick","chart-loading","zoom","before7d-contract-price-lowest","before7d-contract-price-highest","onOnChangeMinPrice","onOnChangeMaxPrice"])):te("",!0),((g=e.tickList)==null?void 0:g.length)<=0&&e.chartLoading?(h(),Ze(I,{key:1})):te("",!0)])]),a("div",Ri,[a("div",Bi,[e.currentPriceTab!=="full range"?(h(),O("div",Oi,"Leverage")):te("",!0),e.currentPriceTab!=="full range"?(h(),O("div",Fi,be(e.lever),1)):te("",!0)]),a("div",Ui,[e.poolInfo&&(e.before7dContractPriceLowest||e.before7dContractPriceHighest)?(h(),O("div",ji,[zi,a("span",Hi,be(e.aprRewardsParameter==7?"7D":e.aprRewardsParameter==24?"24H":"30D")+" Price Range",1),a("span",null,be(("addCommom"in e?e.addCommom:Te(Ee))(("decimalUi"in e?e.decimalUi:Te(ye))(e.before7dContractPriceLowest,6)))+" - "+be(("addCommom"in e?e.addCommom:Te(Ee))(("decimalUi"in e?e.decimalUi:Te(ye))(e.before7dContractPriceHighest,6))),1)])):te("",!0)])]),a("div",Di,[ze(k,{"apr-rewards-parameter":e.aprRewardsParameter,"name-tab":"deposit","from-coin":e.fromCoin,"to-coin":e.toCoin,"pool-info":e.poolInfo,"min-price":e.minPrice,"max-price":e.maxPrice,onChangeAprRewardsParameter:s[9]||(s[9]=r=>{e.aprRewardsParameter=r})},null,8,["apr-rewards-parameter","from-coin","to-coin","pool-info","min-price","max-price"]),ze(Q,{min:e.minPrice,max:e.maxPrice,"from-coin":e.fromCoin,"to-coin":e.toCoin,direct:e.direction,"default-min-price":e.defaultMinPrice,"default-max-price":e.defaultMaxPrice,"pool-info":e.poolInfo,loading:e.chartLoading,"current-price-tab":e.currentPriceTab,onOnChangeMinPrice:e.priceRangeChangeMin,onOnChangeMaxPrice:e.priceRangeChangeMax},null,8,["min","max","from-coin","to-coin","direct","default-min-price","default-max-price","pool-info","loading","current-price-tab","onOnChangeMinPrice","onOnChangeMaxPrice"]),e.positionError&&e.poolInfo?(h(),O("div",Wi,[a("img",{src:("importIcon"in e?e.importIcon:Te(bt))("/image/icon-tips-error@2x.png"),alt:""},null,8,Ei),a("p",Xi,be(e.$t("tips.positionError")),1)])):te("",!0)])])}const Wt=nt(jo,[["render",Zi]]),xi=it({components:{NewLiquidityTitle:Ft,NewLiquidityAssetsCard:Ut,NewLiquidityDepositRatio:jt},setup(){const{t:e,locale:s}=Rt(),fe=ct(),H=L(()=>fe),F=L(()=>H.value.chainName),he=kt(),X=L(()=>he),I=lo(),k=L(()=>I),Q=yt(),l=L(()=>{let o=null;for(const f in X.value.poolsObj){const S=X.value.poolsObj[f];S.address==Q.query.poolAddress&&(console.log(S,"p===>"),o=S)}return o}),n=E(!1),x=E(!1),re=L(()=>H.value.theme),Y=async(o,f)=>{w.value=o.needReverse?o.token_b:o.token_a,y.value=o.needReverse?o.token_a:o.token_b};Ie(()=>l.value,(o,f)=>{console.log(f,"===>oldVal"),console.log(o,"===>newVal"),(!f&&o&&!Le(o)||f&&o&&f.address!==o.address)&&(console.log("池子信息"),Y(o,!f||o.address!==f.address))},{immediate:!0});const p=L(()=>k.value.assets&&w.value&&k.value.assets[w.value.address]?Pt(k.value.assets[w.value.address].balance,w.value.decimals):"0"),v=L(()=>k.value.assets&&y.value&&k.value.assets[y.value.address]?Pt(k.value.assets[y.value.address].balance,y.value.decimals):"0"),i=o=>{o==="fromCoin"?(Pe.value=!0,F.value==="Aptos"?T.value=Number(p.value)>0?w.value.symbol=="APT"?new u(Number(p.value)).sub(new u(.1)).lt(new u(0))?"0":new u(Number(p.value)).sub(new u(.1)).toString():String(p.value):"":T.value=Number(p.value)>0?w.value.symbol=="SUI"?new u(Number(p.value)).sub(new u(.05)).lt(new u(0))?"0":new u(Number(p.value)).sub(new u(.05)).toString():String(p.value):""):(Pe.value=!1,F.value==="Aptos"?N.value=Number(v.value)>0?y.value.symbol=="APT"?new u(Number(v.value)).sub(new u(.1)).lt(new u(0))?"0":new u(Number(v.value)).sub(new u(.1)).toString():String(v.value):"":N.value=Number(v.value)>0?y.value.symbol=="SUI"?new u(Number(v.value)).sub(new u(.05)).lt(new u(0))?"0":new u(Number(v.value)).sub(new u(.05)).toString():String(v.value):"")},g=o=>{o==="fromCoin"?(Pe.value=!0,T.value=Number(p.value)>0?gt(new u(Number(p.value)).div(2).toString(),w.value.decimals).toString():""):(Pe.value=!1,N.value=Number(v.value)>0?gt(new u(Number(v.value)).div(2).toString(),y.value.decimals).toString():"")},r=E(),A=E(),U=E(),V=E(!1),ae=o=>{var f,S,se,G;r.value=o,o==="fromCoin"?(A.value=((f=y.value)==null?void 0:f.address)||"",U.value=Q.query.actions=="new-position"?(S=w.value)==null?void 0:S.address:l.value.needReverse?l.value.token_b.address:l.value.token_a.address):(A.value=((se=w.value)==null?void 0:se.address)||"",U.value=Q.query.actions=="new-position"?(G=y.value)==null?void 0:G.address:l.value.needReverse?l.value.token_a.address:l.value.token_b.address),V.value=!0,console.log(V.value,"==>showCoinSelect.value ")},de=o=>{var se,G,ue,me,ve,ne,oe,Ce;const f=l.value.needReverse?l.value.token_b:l.value.token_a,S=l.value.needReverse?l.value.token_a:l.value.token_b;r.value==="fromCoin"?(((se=w.value)==null?void 0:se.address)===(f==null?void 0:f.address)||!((G=w.value)!=null&&G.address)?(y.value&&o.address.toLowerCase()===((ue=y)==null?void 0:ue.value.address.toLowerCase())&&(y.value=null),w.value=o):(w.value&&o.address.toLowerCase()===((me=w)==null?void 0:me.value.address.toLowerCase())&&(w.value=null),y.value=o),Q.query.action||(Q.query.fee="")):((ve=y.value)==null?void 0:ve.address)===(S==null?void 0:S.address)||!((ne=y.value)!=null&&ne.address)?(w.value&&o.address.toLowerCase()===((oe=w)==null?void 0:oe.value.address.toLowerCase())&&(w.value=null),y.value=o):(y.value&&o.address.toLowerCase()===((Ce=y)==null?void 0:Ce.value.address.toLowerCase())&&(y.value=null),w.value=o),V.value=!1},m=L(()=>H.value.chainName?st(H.value.chainName):{}),q=L(()=>H.value.slippage),R=E(),_=async()=>{var Oe,Xe,Ue,ce;if(De.value)return console.log("跳出"),!1;if(!W.value&&!z.value)return!1;if(!T.value&&!N.value&&!W.value&&!z.value)return;const o=l.value||{};if(Le(o))return;const{TickUtil:f,TickMath:S,getNearestTickByTick:se}=m.value,G=o==null?void 0:o.token_a.decimals,ue=o==null?void 0:o.token_b.decimals;let me,ve,ne,oe,Ce,Ae,We,Ge,we=o==null?void 0:o.current_tick_index,J;if(o.token_a.address.toLowerCase()===w.value.address.toLowerCase()&&o.token_b.address.toLowerCase()===y.value.address.toLowerCase()?J=!0:J=!1,W.value==="0"&&z.value==="∞")ne=f.getMinIndex(Number(o.tickSpacing)),oe=f.getMaxIndex(Number(o.tickSpacing)),Ce=S.tickIndexToSqrtPriceX64(ne),Ae=S.tickIndexToSqrtPriceX64(oe),console.log(ne,oe,"#######updateAmounts 513");else if(ee.value=="custom"){console.log(J,"===>directs1866"),J?(me=Number(W.value),ve=Number(z.value)):(me=new u(1).div(z.value).toString(),ve=new u(1).div(W.value).toString());try{We=me==0?-443636:S.priceToTickIndex(new u(me),G,ue)}catch{We=-443636}try{Ge=S.priceToTickIndex(new u(ve),G,ue)}catch{Ge=443636}ne=se(We,Number(o.tickSpacing)),oe=se(Ge,Number(o.tickSpacing)),Ce=S.priceToSqrtPriceX64(new u(me),G,ue);try{Ae=S.priceToSqrtPriceX64(new u(ve),G,ue)}catch{console.log("0523###test###max###",ve),ve===1/0&&(console.log("0523###test###max###11111"),Ae=S.tickIndexToSqrtPriceX64(f.getMaxIndex(Number(o.tickSpacing))))}console.log("0518###pre###tick_lower###",ne,oe,we),console.log("0518###pre###tick_upper###",oe)}else ne=(Oe=Ke.value[ee.value])==null?void 0:Oe.lower,oe=(Xe=Ke.value[ee.value])==null?void 0:Xe.upper,Ce=S.tickIndexToSqrtPriceX64(ne),Ae=S.tickIndexToSqrtPriceX64(oe);if(z.value!=="∞"&&ne>=oe){n.value=!0,T.value="",x.value=!0,N.value="";return}if(console.log(oe,we,ne,"1922"),z.value==="∞"||we>=ne&&we<=oe){n.value=!1,x.value=!1;let le;if(T.value||N.value){if(Pe.value){const dt=new u(T.value).mul(Math.pow(10,w.value.decimals)).toString();le=new je(dt)}else{const dt=new u(N.value).mul(Math.pow(10,y.value.decimals)).toString();le=new je(dt)}console.log(J,"======>directs");const{liquidityAmount:Fe,tokenMaxA:Ve,tokenMaxB:et,tokenMaxAOrigin:Zt,tokenMaxBOrigin:xt}=m.value.estLiquidityAndcoinAmountFromOneAmounts({tokenA:o.token_a,tokenB:o.token_b,lowerTick:ne,upperTick:oe,coinAmount:le,iscoinA:J?Pe.value:!Pe.value,roundUp:!0,slippage:Number(q.value)/100,curSqrtPrice:new je(o.current_sqrt_price)});R.value={liquidityAmount:Fe,tokenMaxA:Ve,tokenMaxB:et,tokenMaxAOrigin:Zt,tokenMaxBOrigin:xt},console.log(Ve,et,"preAdd"),J?Pe.value?N.value=Number(et)>0?et:"":T.value=Number(Ve)>0?Ve:"":Pe.value?N.value=Ve:T.value=et}}else if(we>oe){if(J?T.value="":N.value="",n.value=J,x.value=!J,T.value||N.value){let le;if(J){const Fe=new u(N.value).mul(Math.pow(10,(Ue=y.value)==null?void 0:Ue.decimals)).toString();le=new je(Fe),R.value={liquidityAmount:m.value.estimateLiquidityForCoinB(Ce,Ae,le),tokenMaxA:0,tokenMaxB:N.value}}else{const Fe=new u(T.value).mul(Math.pow(10,(ce=w.value)==null?void 0:ce.decimals)).toString();le=new je(Fe),R.value={liquidityAmount:m.value.estimateLiquidityForCoinB(Ce,Ae,le),tokenMaxA:0,tokenMaxB:T.value}}}}else if(we<ne){if(n.value=!J,x.value=J,J?N.value="":T.value="",T.value||N.value){let le;if(J){const Fe=new u(T.value).mul(Math.pow(10,w.value.decimals)).toString();le=new je(Fe),R.value={liquidityAmount:m.value.estimateLiquidityForCoinA(Ce,Ae,le),tokenMaxA:T.value,tokenMaxB:0}}else{const Fe=new u(N.value).mul(Math.pow(10,y.value.decimals)).toString();le=new je(Fe),R.value={liquidityAmount:m.value.estimateLiquidityForCoinA(Ce,Ae,le),tokenMaxA:N.value,tokenMaxB:0}}}}else n.value=!0,T.value="",x.value=!0,N.value=""};Ie(T,(o,f)=>{console.log(T,"===>fromCoinAmount"),o==""&&Pe.value&&(N.value=""),o&&Pe.value&&!De.value&&_()}),Ie(N,(o,f)=>{console.log(o,"===>>>>newValsda"),o==""&&!Pe.value&&(T.value=""),o&&!Pe.value&&!De.value&&_()});const C=E("--"),D=L(()=>X.value.RATES),M=()=>{const o=D.value&&D.value[w.value.address]&&D.value[w.value.address].price,f=D.value&&D.value[y.value.address]&&D.value[y.value.address].price;if(o&&f){const S=new u(T.value>0?T.value:0).mul(o),se=new u(N.value>0?N.value:0).mul(f),G=S.add(se).toNumber();C.value=G>0&&G<.01?"<0.01":At(G,2)}else C.value="--"};Ie(()=>[T.value,N.value,De.value],([o,f,S])=>{(o||f)&&!S?M():(!o||!f)&&!S&&(C.value="--")},{immediate:!0}),Ie(()=>C,o=>{console.log(o,"71911111")},{immediate:!0}),Ie([W,z],([o,f])=>{console.log(o,f,"==>minPrice,maxPrice"),De.value?De.value&&Ne():_(),f!=="∞"&&Number(o)!==0&&Number(f)!==0&&Number(o)>=Number(f)?ot.value=!0:ot.value=!1,Number(o)==0&&Number(f)==0&&lt.value&&(ot.value=!0,console.log("价格区间错误"))},{deep:!0,immediate:!0});const Z=o=>{console.log(o,"e"),De.value=!0,C.value=o,o>0?Ne():(T.value="",N.value="")},$=E(),Ne=async()=>{var J,Oe,Xe,Ue;if(!W.value&&!z.value)return!1;if(!T.value&&!N.value&&!W.value&&!z.value)return;const o=l.value;if(Le(o))return;const{TickUtil:f,TickMath:S,getNearestTickByTick:se}=m.value,G=o==null?void 0:o.token_a.decimals,ue=o==null?void 0:o.token_b.decimals;let me,ve,ne,oe,Ce,Ae,We;if(o.token_a.address.toLowerCase()===w.value.address.toLowerCase()&&o.token_b.address.toLowerCase()===y.value.address.toLowerCase()?We=!0:We=!1,W.value==="0"&&z.value==="∞")ne=f.getMinIndex(Number(o.tickSpacing)),oe=f.getMaxIndex(Number(o.tickSpacing));else if(ee.value=="custom"){We?(me=Number(W.value),ve=Number(z.value)):(me=new u(1).div(z.value).toString(),ve=new u(1).div(W.value).toString());try{Ce=me==0?-443636:S.priceToTickIndex(new u(me),G,ue)}catch{Ce=-443636}try{Ae=S.priceToTickIndex(new u(ve),G,ue)}catch{Ae=443636}ne=se(Ce,Number(o.tickSpacing)),oe=se(Ae,Number(o.tickSpacing))}else ne=(J=Ke.value[ee.value])==null?void 0:J.lower,oe=(Oe=Ke.value[ee.value])==null?void 0:Oe.upper;const Ge=D.value[(Xe=o.value)==null?void 0:Xe.token_a.address].price,we=D.value[(Ue=o.value)==null?void 0:Ue.token_b.address].price;qe.value?new je(o.current_sqrt_price):new je(1/o.current_sqrt_price),console.log(qe.value,"===>direction.value"),console.log(o,"poolInfos===>"),console.log(ne,oe,"####tick_lower tick_upper 889");try{const{amountA:ce,amountB:le,tokenAmountsInfo:Fe}=await m.value.estCoinAmountsFromTotalAmount({lowerTick:ne,upperTick:oe,decimalsA:G,decimalsB:ue,curSqrtPrice:new je(o.current_sqrt_price),totalAmount:C.value,tokenPriceA:Ge,tokenPriceB:we});console.log(ce,le,"###estCoinAmountsFromTotalAmount 844"),console.log(o.needReverse,qe.value,"===>849"),$.value=Fe,o.needReverse?qe.value?(T.value=ce,N.value=le):(T.value=le,N.value=ce):(T.value=ce,N.value=le)}catch(ce){console.log(ce,"e===>")}},P=E(!1),{setTransactionTxid:ie,setTransactionDesc:Je,setIsShowWaiting:t,setIsShowSuccess:b,setPositiomNum:B,setIsShowRejected:j}=fe,_e=po(),K=L(()=>X.value.currentPositionInfo),Me=E(!1),Se=async o=>{var Ce,Ae,We,Ge;console.log(l.value,"===> poolInfo.value"),P.value=!1,X.value.currentPositionInfo={},ie(""),Je(e("tips.increaseLiquiditySuccess",{from:n.value?"":`${T.value} ${(Ce=w.value)==null?void 0:Ce.symbol}`,and:!n.value&&!x.value?"and":"",to:x.value?"":`${N.value} ${(Ae=y.value)==null?void 0:Ae.symbol}`})),t(!0);const f=qe.value?Pe.value:!Pe.value;let S,se,G,ue,me,ve;const ne=l.value.token_a.decimals,oe=l.value.token_b.decimals;if(W.value==="0"&&z.value==="∞")G=m.value.TickUtil.getMinIndex(Number(l.value.tickSpacing)),ue=m.value.TickUtil.getMaxIndex(Number(l.value.tickSpacing));else if(ee.value=="custom"){qe.value?(S=Number(W.value),se=Number(z.value)):(S=new u(1).div(z.value).toString(),se=new u(1).div(W.value).toString()),console.log("0519###toAdd###min###",S),console.log("0519###toAdd###max###",se),console.log("0519###toAdd###minPrice.value###",W.value),console.log("0519###toAdd###maxPrice.value###",z.value);try{me=S==0?m.value.TickUtil.getMinIndex(Number(l.value.tickSpacing)):m.value.TickMath.priceToTickIndex(new u(S),ne,oe)}catch{me=m.value.TickUtil.getMinIndex(Number(l.value.tickSpacing))}try{ve=m.value.TickMath.priceToTickIndex(new u(se),ne,oe)}catch{ve=m.value.TickUtil.getMaxIndex(Number(l.value.tickSpacing))}G=m.value.getNearestTickByTick(me,Number(l.value.tickSpacing)),ue=m.value.getNearestTickByTick(ve,Number(l.value.tickSpacing))}else G=Ke.value[ee.value].lower,ue=Ke.value[ee.value].upper;console.log(G,ue,"####tick_lower tick_upper 889"),console.log(l.value,"==>poolInfo.value.curSqrtPrice");try{let we;De.value?we=await m.value.getCreateAddLiquidityPayload({pool:l.value,curSqrtPrice:new je(l.value.current_sqrt_price),tickLower:G,tickUpper:ue,slippage:Number(q.value)/100,tokenAmounts:$.value}):we=await m.value.getAddLiquidityTransactionPayload({pool:{poolAddress:l.value.poolAddress,token_a:l.value.token_a,token_b:l.value.token_b},amount:Pe.value?T.value:N.value,fix_amount_a:f,tick_lower:G,tick_upper:ue,index:0,slippage:Number(q.value)/100,roundUp:!0,collect_fee:!1,curSqrtPrice:new je(l.value.current_sqrt_price)}),console.log(we,"payload===?");let J;if(F.value==="Aptos")J=await k.value.currentWallet.signAndSubmitTransaction(we);else{const Oe=await k.value.currentWallet.signAndExecuteTransactionBlock(we);J=m.value.handleTx(Oe)}if(console.log("0410###tx###",J),J&&J.hash){ie(J.hash),t(!1),b(!0);let Oe;l.value.needReverse?l.value.token_a.address.toLowerCase()===w.value.address.toLowerCase()&&l.value.token_b.address.toLowerCase()===y.value.address.toLowerCase()?Oe=!1:Oe=!0:l.value.token_a.address.toLowerCase()===w.value.address.toLowerCase()&&l.value.token_b.address.toLowerCase()===y.value.address.toLowerCase()?Oe=!0:Oe=!1,console.log(Oe,"===>directs");const Xe={title:"Supplied",desc:e("tips.addLiquiditySuccessText",{from:n.value?"":`${T.value} ${(We=w.value)==null?void 0:We.symbol}`,and:!n.value&&!x.value?"and":"",to:x.value?"":`${N.value} ${(Ge=y.value)==null?void 0:Ge.symbol}`}),hash:J.hash,tit:"Position Created",icon:"icon-icon-Position-Created"};F.value!=="Aptos"&&(Xe.res=J.res),m.value.showTransitionPending(Xe);const Ue=await m.value.watchTransaction(Xe,!0);if(Ue.status){if(b(!1),X.value.setCurrentPositionLoading(!0),Me.value=!0,console.log(Ue.nftInfo,"===> watchInfo.nftInfo"),F.value==="Aptos"){if(await X.value.setCurrentPositionInfo(Ue.nftInfo[0].data.id.creator,Ue.nftInfo[0].data.id.collection,Ue.nftInfo[0].data.name,F.value),o)try{await _e.subscribePosition({pool_address:K.value.poolAddress,position_index:K.value.index},K.value.nftHash)}catch(ce){console.log(ce,"e")}}else{const ce=Ue.nftInfo,le=await Tt(2e3);if(await X.value.setCurrentPositionInfo(ce==null?void 0:ce.pool,"","",F.value,ce==null?void 0:ce.position),await Tt(1e3),console.log("0529###nftInfo###",ce),console.log("0529###currentPositionInfo.value.index###",K.value.index),o)try{await _e.subscribePosition({pool_address:K.value.poolAddress,position_index:K.value.index},K.value.nftHash)}catch(Fe){console.log(Fe)}}setTimeout(()=>{he.updateCurrentPools(l.value.poolAddress,F.value),m.value.getAccount(k.value.address)},3e3),setTimeout(async()=>{St(m,l)},3e3)}B()}else t(!1),j(!0);T.value="",N.value=""}catch(we){T.value="",N.value="",console.log("0330###Add liquidity Error###",we),t(!1),j(!0)}},He=L(()=>!T.value&&!N.value?(console.log("addLiquidityBtnDisabled11111"),!0):Number(T.value)>Number(p.value)||Number(N.value)>Number(v.value)?(console.log("addLiquidityBtnDisabled22222"),!0):$e.value!==e("button.addLiquidity")&&$e.value!==e("newAdd.preview")?(console.log("addLiquidityBtnDisabled33333###",$e.value),!0):l.value&&l.value&&l.value.is_pause?(console.log("addLiquidityBtnDisabled44444"),!0):Number(T.value)<=0&&Number(N.value)<=0||!n.value&&Number(T.value)==0||!x.value&&Number(N.value)==0),xe=L(()=>!w.value||!y.value),$e=L(()=>l.value&&l.value.is_pause?"Pool Closed":!w.value||!y.value||xe.value?e("modal.selectTokenModalTitle"):Number(T.value)>Number(p.value)?e("button.insufficientBalance",{name:w.value.symbol}):Number(N.value)>Number(v.value)?e("button.insufficientBalance",{name:y.value.symbol}):!Number(T.value)&&!Number(N.value)?e("button.enterAmount"):z.value!=="∞"&&Number(W.value)>=Number(z.value)?e("newAdd.invalidRange"):e("button.addLiquidity")),ke=E({}),Re=E({}),Ye=E(!1),rt=(o,f)=>{console.log(r.value,"===>currentCoinKey.value"),console.log(o);const S=localStorage.getItem(o.address);console.log(X.value.tokensObj,"===>pools.value.tokensObj"),console.log(S,"===>coinLocak"),X.value.tokensObj&&X.value.tokensObj[o.address]&&X.value.tokensObj[o.address].isSelfBuilt&&!S&&(f=="fromCoin"&&(ke.value=o),f=="toCoin"&&(Re.value=o),Ye.value=!0)};Ie(()=>[w.value,y.value],([o,f])=>{o&&!Le(o)&&rt(o,"fromCoin"),f&&!Le(f)&&rt(f,"toCoin")},{immediate:!0});const c=Qt(),d=()=>{F.value!=="Aptos"?c.push("/pool/list"):c.push("/pools")},Be=o=>{De.value,Se(o)},ge=o=>{const f=new RegExp("[^\\d-]*(\\d*(?:\\.\\d{0,2})?).*$");o.target.value=o.target.value.replace(f,"$1")},pe=()=>{Q.query.action!=="create-pool"&&Q.query.actions!=="new-position"&&(St(m,l),_(),he.updateCurrentPools(l.value.poolAddress,F.value)),he.setPoolConfigList(F.value,H.value.filterCoinsObj)},Xt=L(()=>{var S,se,G,ue,me,ve;const o=(G=D.value[(se=(S=w)==null?void 0:S.value)==null?void 0:se.address])==null?void 0:G.price,f=(ve=D.value[(me=(ue=y)==null?void 0:ue.value)==null?void 0:me.address])==null?void 0:ve.price;return!!(o&&f)});return{decimalUi:ye,inputChange:ge,poolInfo:l,fromCoinAmount:T,toCoinAmount:N,fromCoin:w,toCoin:y,theme:re,showFromCoinLock:n,showToCoinLock:x,fromCoinBlance:p,toCoinBlance:v,maxBtnSelect:i,halfBtnSelect:g,fixedFromCoin:Pe,openCoinSelect:ae,currentCoinKey:r,existingCoins:A,lastSelectCoin:U,showCoinSelect:V,onCoinSelect:de,liquidityTotalAmount:C,toggle:zt,onInput:Z,isInputTotalAmount:De,isViewDetail:Me,addLiquidityBtnDisabled:He,addLiquidityBtnText:$e,isShowTokenWarning:Ye,chainName:F,closeTokenWarning:d,warningFromCoin:ke,warningToCoin:Re,isShowLiquidityModal:P,currentPrice:lt,currentPriceReverse:ht,currentPriceTab:ee,minPrice:W,maxPrice:z,toAdd:Se,direction:qe,wallet:k,getAddLiquidityType:Be,clickRefresh:pe,isShowtotalAmount:Xt}}});const Gi={class:"new-liquidity-right"},Ki={class:"deposit-title"},Ji={class:"card-container"},Qi={class:"card-item"},Yi={class:"card-item"},Vi={key:0,class:"total-amount"},en=a("span",null,"Total Amount",-1);function tn(e,s,fe,H,F,he){const X=Ft,I=Ut,k=ao,Q=eo,l=jt,n=to,x=mo,re=vo,Y=fo,p=go;return h(),O("div",Gi,[a("div",Ki,[ze(X,{"pool-info":e.poolInfo,onClickRefresh:e.clickRefresh},null,8,["pool-info","onClickRefresh"])]),a("div",Ji,[a("div",Qi,[ze(I,{modelValue:e.fromCoinAmount,"onUpdate:modelValue":s[0]||(s[0]=v=>e.fromCoinAmount=v),"input-value":e.fromCoinAmount,"coin-symbol":e.fromCoin?e.fromCoin.symbol:null,"coin-name":e.fromCoin?e.fromCoin.name:null,balance:e.fromCoinBlance,"coin-icon":e.fromCoin?e.fromCoin.logoURI:"",address:e.fromCoin?e.fromCoin.address:"","swap-direct":"From","import-page":"deposit","has-arrow":!1,onOnMax:s[1]||(s[1]=v=>e.maxBtnSelect("fromCoin")),onOnHalf:s[2]||(s[2]=v=>e.halfBtnSelect("fromCoin")),onOnInput:s[3]||(s[3]=v=>{e.fromCoinAmount=v,e.fixedFromCoin=!0,e.isInputTotalAmount=!1}),onOnSelect:s[4]||(s[4]=v=>e.openCoinSelect("fromCoin"))},null,8,["modelValue","input-value","coin-symbol","coin-name","balance","coin-icon","address"]),e.showFromCoinLock?(h(),Ze(k,{key:0,"from-coin":e.fromCoin,"to-coin":e.toCoin,"pool-info":e.poolInfo},null,8,["from-coin","to-coin","pool-info"])):te("",!0)]),a("div",Yi,[ze(I,{modelValue:e.toCoinAmount,"onUpdate:modelValue":s[5]||(s[5]=v=>e.toCoinAmount=v),"input-value":e.toCoinAmount,"coin-symbol":e.toCoin?e.toCoin.symbol:null,"coin-name":e.toCoin?e.toCoin.name:null,balance:e.toCoinBlance,"swap-direct":"To","coin-icon":e.toCoin?e.toCoin.logoURI:"",address:e.toCoin?e.toCoin.address:"","import-page":"deposit","has-arrow":!1,onOnMax:s[6]||(s[6]=v=>e.maxBtnSelect("toCoin")),onOnHalf:s[7]||(s[7]=v=>e.halfBtnSelect("toCoin")),onOnInput:s[8]||(s[8]=v=>{e.toCoinAmount=v,e.fixedFromCoin=!1,e.isInputTotalAmount=!1}),onOnSelect:s[9]||(s[9]=v=>e.openCoinSelect("toCoin"))},null,8,["modelValue","input-value","coin-symbol","coin-name","balance","coin-icon","address"]),e.showToCoinLock?(h(),Ze(k,{key:0,"from-coin":e.fromCoin,"to-coin":e.toCoin,"pool-info":e.poolInfo},null,8,["from-coin","to-coin","pool-info"])):te("",!0)]),e.fromCoin&&e.toCoin&&!e.showToCoinLock&&!e.showFromCoinLock&&e.theme=="default"?(h(),O("img",{key:0,class:"add",src:bo,alt:"",onClick:s[10]||(s[10]=(...v)=>e.toggle&&e.toggle(...v))})):te("",!0),e.fromCoin&&e.toCoin&&!e.showToCoinLock&&!e.showFromCoinLock&&e.theme!=="default"?(h(),O("img",{key:1,class:"add",src:ho,alt:"",onClick:s[11]||(s[11]=(...v)=>e.toggle&&e.toggle(...v))})):te("",!0)]),e.isShowtotalAmount?(h(),O("div",Vi,[en,a("span",null,[ze(Q,{value:"$"+("addCommom"in e?e.addCommom:Te(Ee))(("decimalUi"in e?e.decimalUi:Te(ye))(e.liquidityTotalAmount,2)),placeholder:e.isInputTotalAmount?"":e.liquidityTotalAmount,onChange:e.inputChange,onInput:s[12]||(s[12]=v=>e.onInput(v.target.value))},null,8,["value","placeholder","onChange"])])])):te("",!0),ze(l,{"from-coin":e.fromCoin,"to-coin":e.toCoin,"from-coin-amount":e.fromCoinAmount,"to-coin-amount":e.toCoinAmount,"fixed-from-coin":e.fixedFromCoin,"is-input-total-amount":e.isInputTotalAmount,"min-price":e.minPrice,"max-price":e.maxPrice,"current-price-tab":e.currentPriceTab,"current-price":e.currentPrice,"current-price-reverse":e.currentPriceReverse},null,8,["from-coin","to-coin","from-coin-amount","to-coin-amount","fixed-from-coin","is-input-total-amount","min-price","max-price","current-price-tab","current-price","current-price-reverse"]),ze(n,{class:"add-liquidity-btn",disabled:e.wallet.connected?e.addLiquidityBtnDisabled:!1,onClick:s[13]||(s[13]=v=>e.wallet.connected?e.isShowLiquidityModal=!0:e.wallet.setIsShowWalletModal(!0))},{default:Yt(()=>[Vt(be(e.wallet.connected?e.addLiquidityBtnText:e.$t("button.connectWallet")),1)]),_:1},8,["disabled"]),e.showCoinSelect?(h(),Ze(x,{key:1,"existing-coins":e.existingCoins,"last-select-coin":e.lastSelectCoin,onOnSelect:e.onCoinSelect,onOnClose:s[14]||(s[14]=v=>e.showCoinSelect=!1)},null,8,["existing-coins","last-select-coin","onOnSelect"])):te("",!0),e.isViewDetail?(h(),Ze(re,{key:2,"pool-info":e.poolInfo,onOnClose:s[15]||(s[15]=v=>e.isViewDetail=!1)},null,8,["pool-info"])):te("",!0),e.chainName=="Sui"&&e.isShowTokenWarning?(h(),Ze(Y,{key:3,"from-coin":e.warningFromCoin,"to-coin":e.warningToCoin,onClose:e.closeTokenWarning,onClickContinue:s[16]||(s[16]=v=>e.isShowTokenWarning=!1)},null,8,["from-coin","to-coin","onClose"])):te("",!0),e.isShowLiquidityModal?(h(),Ze(p,{key:4,"pool-info":e.poolInfo,title:e.$t("button.addLiquidity"),"from-coin-amount":e.fromCoinAmount,"to-coin-amount":e.toCoinAmount,"from-coin":e.fromCoin,"to-coin":e.toCoin,"fixed-from-coin":e.fixedFromCoin,"current-price":e.currentPrice,"current-price-reverse":e.currentPriceReverse,"current-price-tab":e.currentPriceTab,"min-price":e.minPrice,"max-price":e.maxPrice,"show-from-coin-lock":e.showFromCoinLock,"show-to-coin-lock":e.showToCoinLock,"current-direct":e.direction,"is-increase":!1,onToAdd:e.getAddLiquidityType,onOnClose:s[17]||(s[17]=v=>e.isShowLiquidityModal=!1)},null,8,["pool-info","title","from-coin-amount","to-coin-amount","from-coin","to-coin","fixed-from-coin","current-price","current-price-reverse","current-price-tab","min-price","max-price","show-from-coin-lock","show-to-coin-lock","current-direct","onToAdd"])):te("",!0)])}const Et=nt(xi,[["render",tn]]),on=it({components:{NewLiquidityLeft:Wt,NewLiquidityRight:Et},setup(){Bt(()=>{co()});const e=yt();return{tickList:tt,route:e}}});const nn={key:0,class:"loading-spin-liquidity loading-global"},rn={class:"privide-liquidity"};function an(e,s,fe,H,F,he){var Q,l;const X=wt,I=Wt,k=Et;return h(),O(ut,null,[!e.tickList&&((l=(Q=e.route)==null?void 0:Q.query)!=null&&l.poolAddress)?(h(),O("div",nn,[ze(X)])):te("",!0),a("div",rn,[ze(I),ze(k)])],64)}const Wn=nt(on,[["render",an],["__scopeId","data-v-9c3e932a"]]);export{Wn as default};
