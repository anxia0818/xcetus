import{m as Io,e as So,s as X,a as R,o as Vo,u as vo,d as uo,q as Fo,c as x,k as Ao}from"./pool.f843b109.js";import{a as Y,l as d,r as V,e as Z,o as n,f as t,h as s,i as k,v,u as $,c as F,w as B,S as Jo,B as $o,j as A,p as ao,k as io,s as Po,t as to,x as M,b as jo,A as ho,F as J,E as no,P as us,q as ko,z as bo,N as zo,M as No,H as Qo,Q as ms}from"./entry.2f05772d.js";/* empty css              */import{a as lo,u as Lo}from"./sha256.07ddf552.js";import{u as mo}from"./farms.48cb87dd.js";import{R as Do}from"./farms-range.d440242c.js";import{_ as Go}from"./apr-tips.ad6305e9.js";import{i as Oo}from"./import-icon.de3e6c66.js";/* empty css              *//* empty css              */import{D as Ho}from"./decimal.0bdeb344.js";import{_ as Ko}from"./img-connect-wallet_2x.74ce0126.js";import{_ as Xo}from"./img-no-Positions_2x.f16c2ab5.js";import{_ as ps}from"./upgrade-loading.0b4954ca.js";import{p as _s}from"./precision.a7a6c57b.js";import"./icon_rewards_2x.50e6b002.js";/* empty css              */import"./icon-Amount-for-Sale_2x.b2e65df2.js";const fs=Y({setup(){const o=lo(),l=d(()=>o),m=mo(),u=d(()=>m),p=d(()=>(console.log(u.value.farmsRewardObj,"##farmsRewardObj"),Object.values(u.value.farmsRewardObj))),a=d(()=>{const G=p.value.reduce(function(E,L){const U=L&&L.amountUsd?L.amountUsd:0;return Number(U)>.01?Vo(Number(E)).plus(X(Number(U),2)).toString():Vo(Number(E)).plus(Number(U)).toString()},0);return console.log(u.value.farmsRewardObj,p.value,G,"resultresult67"),G}),i=d(()=>u.value.farmsPositionList),r=d(()=>u.value.farmsAllPositionLoading),b=d(()=>u.value.farmsPoolListLoading),w=Lo(),f=Io("Sui"),_=So("Sui"),{setIsShowSuccess:I,setIsShowRejected:j,setIsShowWaiting:e,setTransactionDesc:O,setTransactionTxid:D}=w,y=V(!1);return{farmsPoolListLoading:b,wallet:l,farms:u,totalRwadrdUsd:a,sFixD:X,claimAllPoolReward:async G=>{y.value=!0,console.log(i.value,"farmsRewardObj###");const E=[];i.value.forEach(L=>{console.log(G,L,"#position"),L.positionSource=="farming"&&E.push({pool_id:L.pool_id,position_nft_id:L.id})}),console.log(JSON.stringify(E),"##params"),D(""),O("Claim Rewards"),e(!0);try{const L=await f.batchHarvest(E),U=await l.value.currentWallet.signAndExecuteTransactionBlock(L);console.log("0221###sui swap res###",U);let N=_.handleTx(U);if(N&&N.hash){D(N.hash),e(!1),I(!0);let h={res:N.res,title:"Claim",hash:N.hash};_.showTransitionPending(h),await _.watchTransaction(h)&&setTimeout(()=>{m.getFarmsPoolList()},4e3)}else e(!1),j(!0);y.value=!1}catch(L){console.log("Claim all error",L),e(!1),j(!0),y.value=!1}},loading:y,addCommom:R,farmsAllPositionLoading:r}}});const Yo=o=>(ao("data-v-3e0a1ace"),o=o(),io(),o),hs={class:"farms-banner-bg"},vs={class:"farms-banner"},gs={class:"farms-banner-center"},bs=Yo(()=>s("div",{class:"title"},"Farms",-1)),$s=Yo(()=>s("div",{class:"desc"},"Stake your positions to earn higher yield.",-1)),ws={class:"claim-rewards"},ys={class:"claim-title"},ks={key:0,class:"loading-spin"},Is={key:1},Ss={key:2},Ps={class:"claim-content"};function Ls(o,l,m,u,p,a){const i=Jo,r=$o;return n(),t("div",hs,[s("div",vs,[s("div",gs,[bs,$s,s("div",ws,[s("div",ys,[o.farmsAllPositionLoading||o.farmsPoolListLoading?(n(),t("span",ks,[k(i)])):o.wallet.address?(n(),t("span",Is,v(Number(o.totalRwadrdUsd)>0&&Number(o.totalRwadrdUsd)<.01?"<$0.01":`$${("addCommom"in o?o.addCommom:$(R))(("sFixD"in o?o.sFixD:$(X))(o.totalRwadrdUsd||0,2))}`),1)):(n(),t("span",Ss,"--"))]),s("div",Ps,[o.wallet.address?(n(),F(r,{key:0,class:"claim-btn",loading:o.loading,disabled:Number(o.totalRwadrdUsd)==0||o.farmsAllPositionLoading,onClick:o.claimAllPoolReward},{default:B(()=>[A(" Claim All Rewards ")]),_:1},8,["loading","disabled","onClick"])):(n(),F(r,{key:1,class:"claim-btn",onClick:l[0]||(l[0]=b=>o.wallet.setIsShowWalletModal(!0))},{default:B(()=>[A("Connect")]),_:1}))])])])])])}const Zo=Z(fs,[["render",Ls],["__scopeId","data-v-3e0a1ace"]]),Cs=Y({props:{poolInfo:{type:Object,default:()=>({})}},setup(){const o=V(!0);return{sFixD:X,direct:o}}});const js=o=>(ao("data-v-14f67ada"),o=o(),io(),o),Os={class:"valid-range"},Us=js(()=>s("div",{class:"title"},"Valid Range",-1));function Ts(o,l,m,u,p,a){const i=Do;return n(),t("div",Os,[Us,k(i,{"pool-info":o.poolInfo},null,8,["pool-info"])])}const Rs=Z(Cs,[["render",Ts],["__scopeId","data-v-14f67ada"]]),As=Y({props:{poolInfo:{type:Object,default:()=>({})}},setup(){return{}}});const Fs={class:"pool"},Ns={class:"pool-info"},Ds={class:"token-logo"},Bs={alt:""},Es={alt:""},Ms={class:"token-symbol"},qs={class:"symbol"},Ws={class:"fee-rate"};function Vs(o,l,m,u,p,a){var b,w,f,_;const i=Rs,r=Po("image");return n(),t("div",Fs,[s("div",Ns,[s("div",Ds,[to(s("img",Bs,null,512),[[r,(b=o.poolInfo.coinA)==null?void 0:b.logo_url]]),to(s("img",Es,null,512),[[r,(w=o.poolInfo.coinB)==null?void 0:w.logo_url]])]),s("div",Ms,[s("div",qs,v((f=o.poolInfo.coinA)==null?void 0:f.symbol)+" - "+v((_=o.poolInfo.coinB)==null?void 0:_.symbol),1),s("div",Ws,v(o.poolInfo.fee),1)])]),k(i,{"pool-info":o.poolInfo},null,8,["pool-info"])])}const xo=Z(As,[["render",Vs],["__scopeId","data-v-c027f63c"]]),Hs=Y({props:{currentTab:{type:String,default:""},rewardInfo:{type:Object,default:()=>({})}},setup(){const o=vo(),l=d(()=>o);return{sFixD:X,addCommom:R,getCoinIcon:u=>{var p;return((p=l.value.tokensObj[u])==null?void 0:p.logo_url)||Oo("/image/coins/sui-unknown.png")}}}});const Js={key:0,class:"rewards-day"},zs={class:"rewards-day-box"},Qs={alt:""};function Gs(o,l,m,u,p,a){const i=Po("image");return o.rewardInfo.allocate_point>0||o.currentTab=="Ended"?(n(),t("div",Js,[s("div",null,[s("div",zs,[to(s("img",Qs,null,512),[[i,o.getCoinIcon(o.rewardInfo.reward_coin)]]),s("span",null,v(("addCommom"in o?o.addCommom:$(R))(("sFixD"in o?o.sFixD:$(X))(o.rewardInfo.emission_per_day,4))),1)])])])):M("",!0)}const os=Z(Hs,[["render",Gs],["__scopeId","data-v-416b96fb"]]),Ks=Y({props:{positionInfo:{type:Object,default:()=>({})}},setup(o){console.log(o.positionInfo,"props.positionInfo");const l=vo(),m=d(()=>l);return{addCommom:R,decimalUi:uo,fixD:Fo,getCoinIcon:p=>{var a;return((a=m.value.tokensObj[p])==null?void 0:a.logo_url)||Oo("/image/coins/sui-unknown.png")}}}});const Xs={class:"hover-rewarder"},Ys={class:"rewarder-info"},Zs={class:"left-rewarder"},xs={alt:""},oe={class:"right-rewarder"},se={class:"amount"},ee={key:0,class:"amount-usd"},ne={key:1,class:"amount-usd"},te={class:"rewarder-info"},ae={class:"left-rewarder"},ie={alt:""},le={class:"right-rewarder"},re={class:"amount"},de={key:0,class:"amount-usd"},ce={key:1,class:"amount-usd"};function ue(o,l,m,u,p,a){const i=Po("image");return n(),t("div",Xs,[s("div",Ys,[s("div",Zs,[to(s("img",xs,null,512),[[i,o.getCoinIcon(o.positionInfo.needReverse?o.positionInfo.coinB.address:o.positionInfo.coinA.address)]]),s("span",null,v(o.positionInfo.needReverse?o.positionInfo.coinB.symbol:o.positionInfo.coinA.symbol),1)]),s("div",oe,[s("div",se,v(o.positionInfo.needReverse?("addCommom"in o?o.addCommom:$(R))(("decimalUi"in o?o.decimalUi:$(uo))(o.positionInfo.amountB,o.positionInfo.coinB.decimals)):("addCommom"in o?o.addCommom:$(R))(("decimalUi"in o?o.decimalUi:$(uo))(o.positionInfo.amountA,o.positionInfo.coinA.decimals))),1),o.positionInfo.needReverse?(n(),t("div",ne,v(o.positionInfo.amountBUsd==0?"$0":o.positionInfo.amountBUsd>.01?"$"+("fixD"in o?o.fixD:$(Fo))(o.positionInfo.amountBUsd,2):"<$0.01"),1)):(n(),t("div",ee,v(o.positionInfo.amountAUsd==0?"$0":o.positionInfo.amountAUsd>.01?"$"+("fixD"in o?o.fixD:$(Fo))(o.positionInfo.amountAUsd,2):"<$0.01"),1))])]),s("div",te,[s("div",ae,[to(s("img",ie,null,512),[[i,o.getCoinIcon(o.positionInfo.needReverse?o.positionInfo.coinA.address:o.positionInfo.coinB.address)]]),s("span",null,v(o.positionInfo.needReverse?o.positionInfo.coinA.symbol:o.positionInfo.coinB.symbol),1)]),s("div",le,[s("div",re,v(o.positionInfo.needReverse?("addCommom"in o?o.addCommom:$(R))(("decimalUi"in o?o.decimalUi:$(uo))(o.positionInfo.amountA,o.positionInfo.coinA.decimals)):("addCommom"in o?o.addCommom:$(R))(("decimalUi"in o?o.decimalUi:$(uo))(o.positionInfo.amountB,o.positionInfo.coinB.decimals))),1),o.positionInfo.needReverse?(n(),t("div",ce,v(o.positionInfo.amountAUsd==0?"$0":o.positionInfo.amountAUsd>.01?"$"+("addCommom"in o?o.addCommom:$(R))(("decimalUi"in o?o.decimalUi:$(uo))(o.positionInfo.amountAUsd,2)):"<$0.01"),1)):(n(),t("div",de,v(o.positionInfo.amountBUsd==0?"$0":o.positionInfo.amountBUsd>.01?"$"+("addCommom"in o?o.addCommom:$(R))(("decimalUi"in o?o.decimalUi:$(uo))(o.positionInfo.amountBUsd,2)):"<$0.01"),1))])])])}const ss=Z(Ks,[["render",ue],["__scopeId","data-v-0ca1f131"]]),me=Y({components:{FarmsPositionAmountTips:ss},props:{positionInfo:{type:Object,default:()=>({})},currentTab:{type:String,default:""}},setup(o){const l=lo(),m=d(()=>l);console.log(o.positionInfo,"positionInfo#");const u=mo(),p=d(()=>u),a=So("Sui"),i=Io("Sui"),r=V(!1),b=Lo();d(()=>b);const w=jo(),{setIsShowSuccess:f,setIsShowRejected:_,setIsShowWaiting:I,setTransactionDesc:j,setTransactionTxid:e}=b,O=async()=>{console.log(o.positionInfo,"props.positionInfo"),r.value=!0,e(""),j(`Stake ${o.positionInfo.name}`),I(!0);const h={clmm_pool_id:o.positionInfo.clmmPool,clmm_position_id:o.positionInfo.pos_object_id,coinTypeA:o.positionInfo.coin_type_a,coinTypeB:o.positionInfo.coin_type_b},C=o.positionInfo.farmsPoolId;try{const z=await i.farmsDeposit(h,C),H=await m.value.currentWallet.signAndExecuteTransactionBlock(z);console.log("0221###sui swap res###",H);let q=a.handleTx(H);if(q&&q.hash){e(q.hash),I(!1),f(!0);let so={res:q.res,title:"Staked",hash:q.hash};a.showTransitionPending(so),await a.watchTransaction(so)&&setTimeout(()=>{u.getPositionByPool(m.value.address,o.positionInfo.clmm_pool_id,o.positionInfo.farmsPoolId),r.value=!1},2e3)}else I(!1),_(!0)}catch(z){console.log("farmsDeposit error",z),I(!1),_(!0),r.value=!1}},D=async()=>{console.log(o.positionInfo,"props.positionInfo"),r.value=!0,e(""),j(`Unstake ${o.positionInfo.name}`),I(!0);const h=o.positionInfo.farmsPoolId,C=o.positionInfo.id;try{const z=await i.farmsWithdraw(h,C),H=await m.value.currentWallet.signAndExecuteTransactionBlock(z);console.log("0221###sui swap res###",H);let q=a.handleTx(H);if(console.log(q,"unStaketx##"),q&&q.hash){e(q.hash),I(!1),f(!0);let so={res:q.res,title:"Unstaked",hash:q.hash};a.showTransitionPending(so),await a.watchTransaction(so)&&setTimeout(()=>{console.log(o.positionInfo,"##props.positionInfo"),u.getPositionByPool(m.value.address,o.positionInfo.clmm_pool_id,o.positionInfo.farmsPoolId),r.value=!1},2e3)}else I(!1),_(!0)}catch(z){console.log("farmsDeposit error",z),I(!1),_(!0),r.value=!1}},y=async()=>{console.log(o.positionInfo,"props.positionInfo"),r.value=!0,e(""),j("Claim rewards"),I(!0);const h={pool_id:o.positionInfo.farmsPoolId,position_nft_id:o.positionInfo.id};try{const C=await i.harvestFarms(h),z=await m.value.currentWallet.signAndExecuteTransactionBlock(C);console.log("0221###sui swap res###",z);let H=a.handleTx(z);if(H&&H.hash){e(H.hash),I(!1),f(!0);let q={title:"Claim",res:H.res,hash:H.hash};a.showTransitionPending(q),await a.watchTransaction(q)&&setTimeout(()=>{u.getPositionByPool(m.value.address,o.positionInfo.clmm_pool_id,o.positionInfo.farmsPoolId)},2e3)}else I(!1),_(!0);r.value=!1}catch(C){console.log("farmsDeposit error",C),I(!1),_(!0),r.value=!1}},ro=d(()=>p.value.farmsRewardObj),G=vo(),E=d(()=>G),L=d(()=>p.value.farmsLoadingObj);return{sFixD:X,stake:O,loading:r,unStake:D,router:w,claim:y,farmsRewardObj:ro,getCoinIcon:h=>{var C;return((C=E.value.tokensObj[h])==null?void 0:C.logo_url)||Oo("/image/coins/sui-unknown.png")},toPositionDetails:h=>{console.log("toPositionDetails:",h),h.positionSource=="clmm"?w.push(`/new-position-detail?collect=${h.collectionName}&&token=${h.tokenName}&&address=${h.pool}&pos=${h.pos_object_id}`):w.push(`/new-position-detail?position_nft_id=${h.id}&positionSource=farming`)},farmsLoadingObj:L,addCommom:R}}}),es=""+globalThis.__publicAssetsURL("sui-image/position-active.png");const Uo=o=>(ao("data-v-eef90e37"),o=o(),io(),o),pe={class:"farms-position-item"},_e=Uo(()=>s("thead",null,[s("tr",null,[s("th",null,"Position"),s("th",null,"Liquidity"),s("th",null,"Earnings"),s("th")])],-1)),fe={class:"position-info"},he={key:0,class:"status-bg"},ve=Uo(()=>s("img",{src:es,alt:""},null,-1)),ge=[ve],be={class:"status-text"},$e={class:"name-range"},we=Uo(()=>s("span",null,"Details",-1)),ye=Uo(()=>s("svg",{class:"arrow-icon","aria-hidden":"true"},[s("use",{"xlink:href":"#icon-icon_arrow"})],-1)),ke=[we,ye],Ie={class:"liquidity"},Se={class:"rewards-day-box"},Pe={alt:""},Le={key:1,class:"rewards-day"},Ce={class:"action-btn"};function je(o,l,m,u,p,a){const i=Do,r=ss,b=$o,w=us,f=Po("image");return n(),t("div",pe,[s("table",null,[_e,s("tbody",null,[s("tr",null,[s("td",null,[s("div",fe,[s("div",{class:ho(["position-status",o.positionInfo.positionStatus!=="Active"?"position-status-inactive":""])},[o.positionInfo.positionStatus=="Active"?(n(),t("div",he,ge)):M("",!0),s("div",be,v(o.positionInfo.positionStatus),1)],2),s("div",$e,[s("span",null,v(o.positionInfo.name),1),k(i,{"pool-info":o.positionInfo},null,8,["pool-info"])]),s("div",{class:"details",onClick:l[0]||(l[0]=_=>o.toPositionDetails(o.positionInfo))},ke)])]),s("td",null,[s("div",Ie,[s("span",null,[A(v(o.positionInfo.positionUSD>0&&o.positionInfo.positionUSD<.01?"<$0.01":`~$${("addCommom"in o?o.addCommom:$(R))(("sFixD"in o?o.sFixD:$(X))(o.positionInfo.positionUSD,2))}`)+" ",1),k(r,{"position-info":o.positionInfo},null,8,["position-info"])])])]),s("td",null,[o.positionInfo.rewards&&o.positionInfo.rewards.length>0?(n(!0),t(J,{key:0},no(o.positionInfo.rewards,_=>(n(),t("div",{key:_.rewarder_type,class:"rewards-day"},[s("div",null,[s("div",Se,[to(s("img",Pe,null,512),[[f,o.getCoinIcon(_.rewarder_type)]]),s("span",null,v(_.rewarderAmount),1)])])]))),128)):(n(),t("div",Le,"0"))]),s("td",null,[s("div",Ce,[o.positionInfo.positionSource=="clmm"?(n(),t(J,{key:0},[o.positionInfo&&o.positionInfo.positionStatus!=="Active"?(n(),F(w,{key:0},{title:B(()=>[A("Farming rewards are only available for active positions.")]),default:B(()=>[k(b,{class:"unstake-btn",loading:o.loading,disabled:o.positionInfo.positionStatus!=="Active",onClick:o.stake},{default:B(()=>[A("Stake")]),_:1},8,["loading","disabled","onClick"])]),_:1})):(n(),F(b,{key:1,class:"unstake-btn",loading:o.loading,disabled:o.positionInfo.positionStatus!=="Active",onClick:o.stake},{default:B(()=>[A("Stake")]),_:1},8,["loading","disabled","onClick"]))],64)):(n(),F(b,{key:1,class:"unstake-btn",onClick:o.unStake},{default:B(()=>[A("Unstake")]),_:1},8,["onClick"])),o.positionInfo.positionSource=="clmm"?(n(),F(b,{key:2,class:"claim-btn",disabled:!0},{default:B(()=>[A("↑ Claim")]),_:1})):(n(),F(b,{key:3,class:"claim-btn",disabled:o.positionInfo.positionRewardAmount==0,onClick:o.claim},{default:B(()=>[A("↑ Claim")]),_:1},8,["disabled","onClick"]))])])])])])])}const ns=Z(me,[["render",je],["__scopeId","data-v-eef90e37"]]),Oe=Y({props:{noDataImg:{type:String,default:""},desc:{type:String,default:""},type:{type:String,default:""},addLiquidityUrl:{type:String,default:""}},setup(){return{walletStore:lo()}}});const Ue={class:"no-data"},Te=["src"],Re={key:0,class:"desc"};function Ae(o,l,m,u,p,a){const i=$o;return n(),t("div",Ue,[s("img",{src:o.noDataImg,alt:""},null,8,Te),o.desc?(n(),t("div",Re,v(o.desc),1)):M("",!0),o.type=="addLiquidity"?(n(),F(i,{key:1,class:"add-liquidity-btn",onClick:l[0]||(l[0]=r=>o.addLiquidityUrl?o.$router.push(o.addLiquidityUrl):"")},{default:B(()=>[A("Add Liquidity")]),_:1})):M("",!0),o.type=="connectWallet"?(n(),F(i,{key:2,class:"add-liquidity-btn",onClick:l[1]||(l[1]=r=>o.walletStore.setIsShowWalletModal(!0))},{default:B(()=>[A("Connect Wallet")]),_:1})):M("",!0)])}const ts=Z(Oe,[["render",Ae],["__scopeId","data-v-130f9462"]]),Fe=Y({components:{FarmsPositionItem:ns},props:{currentTab:{type:String,default:""},sortValue:{type:String,default:"APR"}},setup(o){const l=V({}),m=lo(),u=d(()=>m),p=mo(),a=d(()=>p),i=d(()=>a.value.farmsPoolList),r=d(()=>a.value.farmsPoolList),b=Lo(),w=d(()=>b),f=d(()=>w.value.addressLpTokens),_=V([]),I=W=>{console.log(r.value,"###list.value");let Q,K;o.currentTab=="My Farms"&&(Q=u.value.address?a.value.myFarmsPoolList:[]),o.currentTab=="Ended"&&(Q=a.value.farmsPoolList.filter(g=>(console.log(g.status,"##ele.status "),g.status=="Ended"))),o.currentTab=="Live"&&(Q=a.value.farmsPoolList.filter(g=>g.status=="Live")),W=="APR"?K=Q.sort((g,c)=>c.stable_farming.apr-g.stable_farming.apr):K=Q.sort((g,c)=>c.stable_farming.tvl-g.stable_farming.tvl),_.value=K.map(g=>{var eo,fo,go;console.log(g,"pool###");let c;g.rewarder&&g.rewarder.rewarder_coin&&g.rewarder.rewarder_coin.length>0&&(c=(fo=(eo=g.rewarder)==null?void 0:eo.rewarder_coin)==null?void 0:fo.map((co,Co)=>({...co,amountDay:new Ho(co.amount_second).mul(new Ho(60*60*24)).toNumber(),rewarder_display:g.rewarder[`rewarder_display${Co+1}`],rewarderApr:co.apr.replace("%","")})));let S;g.stable_farming&&g.stable_farming.stable_rewarder.map(co=>{co.amount_second>0&&(S=!0)});const P=g.apr_24h.replace("%",""),T=g.rewarder&&g.rewarder.apr.replace("%","")||0;return console.log(P,T,"rewardApr####"),{...g,needReverse:g.is_forward===!1,coinA:g.coin_a,coinB:g.coin_b,liquidity:g.tvl_in_usd,vol:g.vol_in_usd_24h,clmmApr:Number(P)+Number(T),stableFarmingApr:g.stable_farming&&g.stable_farming.apr*100,rewarder:{...g.rewarder,rewardList:c},apr:g.apr_24h.replace("%",""),is_display_rewarder:(go=g==null?void 0:g.rewarder)==null?void 0:go.is_display_rewarder,aprTotal:Number(P)+Number(T),isStableFarming:S}})};ko(()=>[r.value,o.sortValue,o.currentTab],([W,Q])=>{console.log(Q,"sortValue326"),W&&W.length>0&&Q&&I(Q)},{immediate:!0});const j=W=>{l.value[W.clmm_pool_id]?l.value[W.clmm_pool_id]=!1:(l.value[W.clmm_pool_id]=!0,console.log("执行了吗"),p.getPositionByPool(u.value.address,W.clmm_pool_id,W.id))},e=d(()=>a.value.farmsPositionObj),O=d(()=>(console.log(a.value.farmsLoadingObj,"##farms.value.farmsLoadingObj"),a.value.farmsLoadingObj)),D=d(()=>a.value.farmsUserUsd),y=d(()=>(console.log(a.value.farmsRewardObj,"##farmsRewardObj"),a.value.farmsRewardObj)),ro=d(()=>a.value.farmsPositionList),G=d(()=>a.value.farmsAllPositionLoading),E=jo(),L=Io("Sui"),U=So("Sui"),{setIsShowSuccess:N,setIsShowRejected:h,setIsShowWaiting:C,setTransactionDesc:z,setTransactionTxid:H}=b,q=async W=>{console.log(ro.value,"farmsRewardObj###");const Q=[];ro.value.forEach(K=>{console.log(W,K,"#position"),W==K.clmm_pool_id&&Q.push({pool_id:K.pool_id,position_nft_id:K.id})}),console.log(JSON.stringify(Q),"##params"),H(""),z("Claim rewards"),C(!0);try{const K=await L.batchHarvest(Q),g=await u.value.currentWallet.signAndExecuteTransactionBlock(K);console.log("0221###sui swap res###",g);let c=U.handleTx(g);if(c&&c.hash){H(c.hash),C(!1),N(!0);let S={res:c.res,title:"Claim",hash:c.hash};U.showTransitionPending(S),await U.watchTransaction(S)&&setTimeout(()=>{p.getFarmsPoolList()},4e3)}else C(!1),h(!0)}catch(K){console.log("Claim all error",K),C(!1),h(!0)}},so=vo(),_o=d(()=>so),yo=d(()=>(console.log(_o.value.poolsObj,"##pools.value.poolsObj"),_o.value.poolsObj));d(()=>_o.value.tokensObj);const To=V({}),Ro=d(()=>a.value.farmsPoolObj);return console.log(f.value,"addressLpTokens:"),{wallet:u,walletStore:m,farmsPoolList:i,openMore:j,openMoreObj:l,checkNullObj:x,router:E,farmsPositionObj:e,farmsLoadingObj:O,farmsUserUsd:D,sFixD:X,farmsRewardObj:y,claimPoolReward:q,farmsAllPositionLoading:G,addCommom:R,addressLpTokens:f,poolsObj:yo,rewardInfoObj:To,pageList:_,farmsPoolObj:Ro}}});const po=o=>(ao("data-v-6a8e3ec1"),o=o(),io(),o),Ne={class:"farms-table"},De=po(()=>s("thead",null,[s("tr",null,[s("th",null,"Pools"),s("th",null,"Staked TVL"),s("th",null,"APR"),s("th",null,"Rewards / day"),s("th",null,"My Staked"),s("th",null,"Earned"),s("th",null,"Actions")]),s("tr",{style:{height:"4px"}})],-1)),Be={key:0},Ee=["onClick"],Me={class:"staked-tvl"},qe={class:"apr"},We={key:0,class:"apr-hover-box"},Ve={class:"farms-reward-box"},He={key:0,class:"my-staked"},Je={key:0,class:"my-staked-loading"},ze={key:0,class:"position-usd"},Qe={key:1,class:"position-usd"},Ge={key:2,class:"position-usd"},Ke={key:3,class:"position-num"},Xe={key:1,class:"my-staked"},Ye=po(()=>s("div",{class:"position-usd"},"--",-1)),Ze=[Ye],xe={class:"earned"},on={key:0,class:"my-staked-loading"},sn={key:0,class:"ratio-bg"},en=po(()=>s("div",{class:"ratio"},null,-1)),nn=[en],tn={key:1},an={key:2},ln={key:3},rn={key:2},dn={class:"actions"},cn={class:"actions-btn"},un=["onClick"],mn=po(()=>s("use",{"xlink:href":"#icon-icon_arrow"},null,-1)),pn=[mn],_n={colspan:"7",style:{padding:"0 16px 16px"}},fn={key:0,class:"farm-position-list"},hn={key:0,class:"farm-position-loading"},vn={key:1,class:"farm-position-list"},gn=po(()=>s("tr",{style:{height:"8px"}},null,-1)),bn={key:1},$n={colspan:"7"},wn={key:0,class:"no-data"},yn=po(()=>s("img",{src:Ko,alt:""},null,-1)),kn={key:1,class:"no-data"},In=po(()=>s("img",{src:Xo,alt:""},null,-1)),Sn=po(()=>s("span",null,"No farms found",-1)),Pn=[In,Sn];function Ln(o,l,m,u,p,a){const i=xo,r=Go,b=os,w=No,f=$o,_=Jo,I=ns,j=ts;return n(),t("div",Ne,[s("table",null,[De,o.pageList&&o.pageList.length>0?(n(),t("tbody",Be,[(n(!0),t(J,null,no(o.pageList,e=>(n(),t(J,{key:e.id},[s("tr",{onClick:O=>o.openMore(e)},[s("td",null,[k(i,{"pool-info":e},null,8,["pool-info"])]),s("td",null,[s("div",Me," $"+v(("addCommom"in o?o.addCommom:$(R))(e.stable_farming.tvl,2)),1)]),s("td",null,[s("div",qe,[e.isStableFarming?(n(),t("div",We,[k(r,{"l-item":e,"rewarder-info":e.rewarder.rewardList,class:"noHover apr-hover-con"},null,8,["l-item","rewarder-info"])])):M("",!0),s("span",null,v((e==null?void 0:e.total_apr)>0&&e.total_apr<1e-4?"<0.01%":`${("addCommom"in o?o.addCommom:$(R))(e.total_apr*100,2)}%`),1)])]),s("td",null,[s("div",Ve,[(n(!0),t(J,null,no(e.rewarders,O=>(n(),F(b,{key:O.reward_coin,"reward-info":O,"current-tab":o.currentTab},null,8,["reward-info","current-tab"]))),128))])]),s("td",null,[o.wallet.address?(n(),t("div",He,[o.farmsLoadingObj[e.clmm_pool_id]||o.farmsAllPositionLoading?(n(),t("div",Je,[k(w,{class:"upgrade-title-skeleton",loading:!0,active:"",paragraph:!1})])):(n(),t(J,{key:1},[o.farmsUserUsd&&o.farmsUserUsd[e.clmm_pool_id]&&o.farmsUserUsd[e.clmm_pool_id].amount>0&&o.farmsUserUsd[e.clmm_pool_id].amount>.01?(n(),t("div",ze,v(Number(o.farmsUserUsd[e.clmm_pool_id].amount)>0&&Number(o.farmsUserUsd[e.clmm_pool_id].amount)<.01?"<$0.01":"$"+("addCommom"in o?o.addCommom:$(R))(o.farmsUserUsd[e.clmm_pool_id].amount,2)),1)):o.farmsUserUsd&&o.farmsUserUsd[e.clmm_pool_id]&&o.farmsUserUsd[e.clmm_pool_id].amount>0&&o.farmsUserUsd[e.clmm_pool_id].amount<.01?(n(),t("div",Qe," <$0.01 ")):(n(),t("div",Ge,"0")),o.farmsUserUsd&&o.farmsUserUsd[e.clmm_pool_id]&&o.farmsUserUsd[e.clmm_pool_id].positionNum?(n(),t("div",Ke,v(o.farmsUserUsd[e.clmm_pool_id].positionNum)+" "+v(o.farmsUserUsd[e.clmm_pool_id].positionNum>1?"Positions":"Position"),1)):M("",!0)],64))])):(n(),t("div",Xe,Ze))]),s("td",null,[s("div",xe,[o.farmsLoadingObj[e.clmm_pool_id]||o.farmsAllPositionLoading?(n(),t("div",on,[k(w,{class:"upgrade-title-skeleton",loading:!0,active:"",paragraph:!1})])):o.wallet.address&&o.farmsRewardObj&&o.farmsRewardObj[e.clmm_pool_id]&&o.farmsRewardObj[e.clmm_pool_id].amountUsd?(n(),t(J,{key:1},[o.wallet.address&&o.farmsRewardObj&&o.farmsRewardObj[e.clmm_pool_id]&&o.farmsRewardObj[e.clmm_pool_id].amountUsd>0?(n(),t("div",sn,nn)):M("",!0),Number(o.farmsRewardObj[e.clmm_pool_id].amountUsd)>.01?(n(),t("span",tn,"$"+v(("addCommom"in o?o.addCommom:$(R))(("sFixD"in o?o.sFixD:$(X))(o.farmsRewardObj[e.clmm_pool_id].amountUsd||0,2))),1)):Number(o.farmsRewardObj[e.clmm_pool_id].amountUsd)>0&&Number(o.farmsRewardObj[e.clmm_pool_id].amountUsd)<.01?(n(),t("span",an,"<$0.01")):(n(),t("span",ln,"0"))],64)):(n(),t("span",rn,"0"))])]),s("td",null,[s("div",dn,[s("div",cn,[k(f,{class:"claim-btn",disabled:!o.wallet.address||!o.farmsRewardObj[e.clmm_pool_id]||!o.farmsRewardObj[e.clmm_pool_id].amountUsd||o.farmsRewardObj[e.clmm_pool_id].amountUsd<=0||o.farmsLoadingObj[e.clmm_pool_id],onClick:bo(O=>o.claimPoolReward(e.clmm_pool_id),["stop"])},{default:B(()=>[A("Claim")]),_:2},1032,["disabled","onClick"]),k(f,{class:"add-liquidity-btn",onClick:bo(O=>o.router.push(`/liquidity/deposit?poolAddress=${e.clmm_pool_id}`),["stop"])},{default:B(()=>[A("+ Add liquidity")]),_:2},1032,["onClick"])]),s("div",{class:"more",onClick:bo(O=>o.openMore(e),["stop"])},[(n(),t("svg",{class:ho(["arrow-icon",o.openMoreObj[e.clmm_pool_id]?"open-more":""]),"aria-hidden":"true"},pn,2))],8,un)])])],8,Ee),to(s("tr",null,[s("td",_n,[o.wallet.address?(n(),t("div",fn,[!("checkNullObj"in o?o.checkNullObj:$(x))(o.farmsLoadingObj)&&o.farmsLoadingObj[e.clmm_pool_id]||o.farmsAllPositionLoading?(n(),t("div",hn,[k(_)])):o.farmsPositionObj[e.clmm_pool_id]&&o.farmsPositionObj[e.clmm_pool_id].length>0?(n(!0),t(J,{key:1},no(o.farmsPositionObj[e.clmm_pool_id],O=>(n(),F(I,{key:O.clmm_position_id,"current-tab":o.currentTab,"position-info":{...O,clmm_pool_id:e.clmm_pool_id}},null,8,["current-tab","position-info"]))),128)):(n(),F(j,{key:2,"no-data-img":"/sui-image/img-no-Positions@2x.png",desc:"No Position Found",type:"addLiquidity","add-liquidity-url":`/liquidity/deposit?poolAddress=${e.clmm_pool_id}`},null,8,["add-liquidity-url"]))])):(n(),t("div",vn,[k(j,{"no-data-img":"/sui-image/img-connect-wallet@2x.png",type:"connectWallet"})]))])],512),[[zo,!("checkNullObj"in o?o.checkNullObj:$(x))(o.openMoreObj)&&o.openMoreObj[e==null?void 0:e.clmm_pool_id]]]),gn],64))),128))])):(n(),t("tbody",bn,[s("tr",null,[s("td",$n,[!o.wallet.connected&&o.currentTab=="My Farms"?(n(),t("div",wn,[yn,k(f,{class:"connect-wallet",onClick:l[0]||(l[0]=e=>o.wallet.setIsShowWalletModal(!0))},{default:B(()=>[A(v(o.$t("button.connectWallet")),1)]),_:1})])):o.pageList.length==0?(n(),t("div",kn,Pn)):M("",!0)])])]))])])}const as=Z(Fe,[["render",Ln],["__scopeId","data-v-6a8e3ec1"]]),Cn=Y({props:{currentTab:{type:String,default:""}},setup(){const o=V(!1),l=lo(),m=d(()=>l),u=mo(),p=d(()=>u),a=d(()=>p.value.farmsPoolList);return{isShowMore:o,wallet:m,walletStore:l,farmsPoolList:a}}});const is=o=>(ao("data-v-f521ea67"),o=o(),io(),o),jn={class:"farms-table"},On=is(()=>s("thead",null,[s("tr",null,[s("th",null,"Pools"),s("th",null,"Staked TVL"),s("th",null,"APR"),s("th",null,"Rewards / day"),s("th",null,"My Staked"),s("th",null,"Earned"),s("th",null,"Actions")]),s("tr",{style:{height:"4px",background:"unset"}})],-1)),Un={class:"pool"},Tn={class:"staked-tvl"},Rn={class:"apr"},An={class:"my-staked"},Fn={class:"actions"},Nn={class:"actions"},Dn={class:"actions"},Bn=is(()=>s("tr",{style:{height:"8px",background:"unset !important"}},null,-1));function En(o,l,m,u,p,a){const i=No;return n(),t("div",jn,[s("table",null,[On,s("tbody",null,[(n(),t(J,null,no(4,(r,b)=>(n(),t(J,{key:b},[s("tr",null,[s("td",null,[s("div",Un,[k(i,{class:"upgrade-title-skeleton",loading:!0,active:"",paragraph:!1}),k(i,{class:"upgrade-title-skeleton",loading:!0,active:"",paragraph:!1})])]),s("td",null,[s("div",Tn,[k(i,{class:"upgrade-title-skeleton",loading:!0,active:"",paragraph:!1})])]),s("td",null,[s("div",Rn,[s("span",null,[k(i,{class:"upgrade-title-skeleton",loading:!0,active:"",paragraph:!1})])])]),s("td",null,[s("div",An,[k(i,{class:"upgrade-title-skeleton",loading:!0,active:"",paragraph:!1})])]),s("td",null,[s("div",Fn,[k(i,{class:"upgrade-title-skeleton",loading:!0,active:"",paragraph:!1})])]),s("td",null,[s("div",Nn,[k(i,{class:"upgrade-title-skeleton",loading:!0,active:"",paragraph:!1})])]),s("td",null,[s("div",Dn,[k(i,{class:"upgrade-title-skeleton",loading:!0,active:"",paragraph:!1})])])]),Bn],64))),64))])])])}const Mn=Z(Cn,[["render",En],["__scopeId","data-v-f521ea67"]]),qn=Y({props:{positionStatus:{type:String,default:"Active"},positionInfo:{type:Object,default:()=>({})}},setup(){return{}}});const Wn=o=>(ao("data-v-882c76c0"),o=o(),io(),o),Vn={class:"position-info"},Hn={key:0,class:"status-bg"},Jn=Wn(()=>s("img",{src:es,alt:""},null,-1)),zn=[Jn],Qn={class:"status-text"},Gn={class:"name-range"};function Kn(o,l,m,u,p,a){const i=Do;return n(),t("div",Vn,[s("div",{class:ho(["position-status",o.positionStatus!=="Active"?"position-status-inactive":""])},[o.positionStatus=="Active"?(n(),t("div",Hn,zn)):M("",!0),s("div",Qn,v(o.positionStatus),1)],2),s("div",Gn,[s("span",null,v(o.positionInfo.name),1),o.positionStatus=="Active"?(n(),F(i,{key:0,"pool-info":o.positionInfo},null,8,["pool-info"])):M("",!0)])])}const Xn=Z(qn,[["render",Kn],["__scopeId","data-v-882c76c0"]]),Yn=Y({props:{positionInfo:{type:Object,default:()=>({})},currentTab:{type:String,default:""}},setup(o){const l=vo(),m=d(()=>l),u=jo(),p=E=>{var L;return((L=m.value.tokensObj[E])==null?void 0:L.logo_url)||Oo("/image/coins/sui-unknown.png")},a=So("Sui"),i=Io("Sui"),r=V(!1),b=Lo(),w=lo(),f=mo(),_=d(()=>w),{setIsShowSuccess:I,setIsShowRejected:j,setIsShowWaiting:e,setTransactionDesc:O,setTransactionTxid:D}=b;return{getCoinIcon:p,router:u,claim:async()=>{console.log(o.positionInfo,"props.positionInfo"),r.value=!0,D(""),O("Claim rewards"),e(!0);const E={pool_id:o.positionInfo.farmsPoolId,position_nft_id:o.positionInfo.id};try{const L=await i.harvestFarms(E),U=await _.value.currentWallet.signAndExecuteTransactionBlock(L);console.log("0221###sui swap res###",U);let N=a.handleTx(U);if(N&&N.hash){D(N.hash),e(!1),I(!0);let h={title:"Claim",res:N.res,hash:N.hash};a.showTransitionPending(h),await a.watchTransaction(h)&&setTimeout(()=>{f.getPositionByPool(_.value.address,o.positionInfo.clmm_pool_id,o.positionInfo.farmsPoolId)},2e3)}else e(!1),j(!0);r.value=!1}catch(L){console.log("farmsDeposit error",L),e(!1),j(!0),r.value=!1}},unStake:async()=>{console.log(o.positionInfo,"props.positionInfo"),r.value=!0,D(""),O(`Unstake ${o.positionInfo.name}`),e(!0);const E=o.positionInfo.farmsPoolId,L=o.positionInfo.id;try{const U=await i.farmsWithdraw(E,L),N=await _.value.currentWallet.signAndExecuteTransactionBlock(U);console.log("0221###sui swap res###",N);let h=a.handleTx(N);if(h&&h.hash){D(h.hash),e(!1),I(!0);let C={res:h.res,title:"Unstaked",hash:h.hash};a.showTransitionPending(C),await a.watchTransaction(C)&&setTimeout(()=>{console.log(o.positionInfo,"##props.positionInfo"),f.getPositionByPool(_.value.address,o.positionInfo.clmm_pool_id,o.positionInfo.farmsPoolId),r.value=!1},2e3)}else e(!1),j(!0)}catch(U){console.log("farmsDeposit error",U),e(!1),j(!0),r.value=!1}},loading:r,stake:async()=>{console.log(o.positionInfo,"props.positionInfo"),r.value=!0,D(""),O(`Stake ${o.positionInfo.name}`),e(!0);const E={clmm_pool_id:o.positionInfo.clmmPool,clmm_position_id:o.positionInfo.pos_object_id,coinTypeA:o.positionInfo.coin_type_a,coinTypeB:o.positionInfo.coin_type_b},L=o.positionInfo.farmsPoolId;try{const U=await i.farmsDeposit(E,L),N=await _.value.currentWallet.signAndExecuteTransactionBlock(U);console.log("0221###sui swap res###",N);let h=a.handleTx(N);if(h&&h.hash){D(h.hash),e(!1),I(!0);let C={res:h.res,title:"Staked",hash:h.hash};a.showTransitionPending(C),await a.watchTransaction(C)&&setTimeout(()=>{f.getPositionByPool(_.value.address,o.positionInfo.clmm_pool_id,o.positionInfo.farmsPoolId),r.value=!1},2e3)}else e(!1),j(!0)}catch(U){console.log("farmsDeposit error",U),e(!1),j(!0),r.value=!1}},sFixD:X,addCommom:R}}});const ls=o=>(ao("data-v-1e39a1fb"),o=o(),io(),o),Zn={class:"farms-position"},xn={class:"farms-position-box"},ot={class:"position-info-block"},st={class:"block-item"},et=ls(()=>s("div",{class:"leabl"},"Liquidity",-1)),nt={class:"text"},tt={class:"earnings"},at={class:"block-item"},it=ls(()=>s("div",{class:"leabl"},"Earnings",-1)),lt={class:"text"},rt={key:0},dt={alt:""},ct={key:1,class:"rewards-day"},ut={class:"unstake-btn-box"};function mt(o,l,m,u,p,a){const i=Xn,r=$o,b=Po("image");return n(),t("div",Zn,[s("div",xn,[k(i,{"position-info":o.positionInfo},null,8,["position-info"])]),s("div",ot,[s("div",st,[et,s("div",nt,v(o.positionInfo.positionUSD>0&&o.positionInfo.positionUSD<.01?"<$0.01":`~$${("addCommom"in o?o.addCommom:$(R))(("sFixD"in o?o.sFixD:$(X))(o.positionInfo.positionUSD,2))}`),1)])]),s("div",tt,[s("div",at,[it,s("div",lt,[o.positionInfo.rewards&&o.positionInfo.rewards.length>0?(n(!0),t(J,{key:0},no(o.positionInfo.rewards,w=>(n(),t("div",{key:w.rewarder_type,class:"rewards-day"},[w.rewarderAmount>0?(n(),t("div",rt,[to(s("img",dt,null,512),[[b,o.getCoinIcon(w.rewarder_type)]]),s("span",null,v(w.rewarderAmount),1)])):M("",!0)]))),128)):(n(),t("div",ct,"--"))])]),o.positionInfo.positionSource=="clmm"?(n(),F(r,{key:0,class:"add-liquidity-btn claim-btn",onClick:l[0]||(l[0]=w=>o.router.push(`/new-position-detail?collect=${o.positionInfo.collectionName}&&token=${o.positionInfo.tokenName}&&address=${o.positionInfo.pool}&pos=${o.positionInfo.pos_object_id}`))},{default:B(()=>[A("+ Add liquidity")]),_:1})):(n(),F(r,{key:1,class:"claim-btn",disabled:o.positionInfo.positionRewardAmount==0||o.currentTab=="Ended",onClick:o.claim},{default:B(()=>[A("↑ Claim")]),_:1},8,["disabled","onClick"]))]),s("div",ut,[s("div",null,[o.positionInfo.positionSource=="clmm"?(n(),F(r,{key:0,class:"unstake-btn",loading:o.loading,disabled:o.positionInfo.positionStatus!=="Active",onClick:o.stake},{default:B(()=>[A("Stake")]),_:1},8,["loading","disabled","onClick"])):(n(),F(r,{key:1,class:"unstake-btn",onClick:o.unStake},{default:B(()=>[A("Unstake")]),_:1},8,["onClick"]))])])])}const rs=Z(Yn,[["render",mt],["__scopeId","data-v-1e39a1fb"]]),pt=Y({components:{FarmsH5Position:rs},props:{currentTab:{type:String,default:""},sortValue:{type:String,default:"APR"}},setup(o){const l=V(!1),m=lo(),u=d(()=>m),p=mo(),a=d(()=>p),i=d(()=>(console.log(a.value.farmsPoolList,"##farms.value.farmsPoolList"),o.currentTab=="My Farms"?u.value.address?a.value.myFarmsPoolList:[]:o.currentTab=="Ended"?a.value.farmsPoolList.filter(c=>c.status=="Ended"):a.value.farmsPoolList.filter(c=>c.status=="Live"))),r=V([]),b=Lo(),w=d(()=>b),f=d(()=>w.value.addressLpTokens),_=c=>{const S=i.value.map(P=>{const{stable_farming:T}=f.value[P.clmm_pool_id];return{...P,apr:T.apr,tvl:T.tvl}});c=="APR"?r.value=S.sort((P,T)=>T.apr-P.apr):r.value=S.sort((P,T)=>T.tvl-P.tvl),console.log(r.value,"##farmsPoolList.value")};ko(()=>[i.value,o.sortValue,f.value],([c,S,P])=>{console.log(S,"sortValue326"),c&&c.length>0&&S&&P&&!x(P)&&_(S)},{immediate:!0});const I=d(()=>a.value.farmsUserUsd),j=d(()=>(console.log(a.value.farmsRewardObj,"##farmsRewardObj"),a.value.farmsRewardObj)),e=d(()=>a.value.farmsPositionObj),O=d(()=>a.value.farmsPoolListLoading),D=d(()=>a.value.farmsPositionList),y=d(()=>(console.log(a.value.farmsLoadingObj,"##farms.value.farmsLoadingObj"),a.value.farmsLoadingObj)),ro=d(()=>a.value.farmsAllPositionLoading),G=V({}),E=c=>{G.value[c.clmm_pool_id]?G.value[c.clmm_pool_id]=!1:(G.value[c.clmm_pool_id]=!0,console.log("执行了吗"),p.getPositionByPool(u.value.address,c.clmm_pool_id,c.id))},L=Io("Sui"),U=So("Sui"),{setIsShowSuccess:N,setIsShowRejected:h,setIsShowWaiting:C,setTransactionDesc:z,setTransactionTxid:H}=b,q=async c=>{console.log(D.value,"farmsRewardObj###");const S=[];D.value.forEach(P=>{console.log(c,P,"#position"),c==P.clmm_pool_id&&S.push({pool_id:P.pool_id,position_nft_id:P.id})}),console.log(JSON.stringify(S),"##params"),H(""),z("Claim rewards"),C(!0);try{const P=await L.batchHarvest(S),T=await u.value.currentWallet.signAndExecuteTransactionBlock(P);console.log("0221###sui swap res###",T);let eo=U.handleTx(T);if(eo&&eo.hash){H(eo.hash),C(!1),N(!0);let fo={res:eo.res,title:"Claim",hash:eo.hash};U.showTransitionPending(fo),await U.watchTransaction(fo)&&setTimeout(()=>{p.getFarmsPoolList()},4e3)}else C(!1),h(!0)}catch(P){console.log("Claim all error",P),C(!1),h(!0)}},so=jo(),_o=vo(),yo=d(()=>_o),To=d(()=>(console.log(yo.value.poolsObj,"##pools.value.poolsObj"),yo.value.poolsObj)),Ro=d(()=>yo.value.tokensObj),W=V({}),Q=(c,S)=>c&&S?_s.plus(Ao(c),Ao(S)):c||0,K=c=>{let S=0;return c&&c.forEach(P=>{S+=Ao(String(P))}),String(uo(String(S),2))},g=(c,S,P)=>{console.log(c,"poolsObj##473"),Object.keys(c).forEach(T=>{var go,co,Co;const eo=(go=S[T])==null?void 0:go.apr_7day,fo=Q((co=S[T])==null?void 0:co.apr_7day,K((Co=S[T])==null?void 0:Co.rewarder_apr));W.value[T]={...c[T],apr:String(eo).replace("%",""),aprTotal:fo},W.value[T].rewards=[],c[T].rewarderInfo.forEach((cs,Bo)=>{var qo,Wo;const Eo=(qo=P[cs.coinAddress])==null?void 0:qo.symbol,Mo=(Wo=S[T])==null?void 0:Wo.rewarder_apr[Bo];console.log(Eo,Mo,"getRewardInfo:"),console.log(c[T],"## poolsObj[key]"),W.value[T].rewards.push({symbol:Eo,rewarderApr:Mo,rewarder_display:c[T][`rewarder_display${Bo+1}`]})})}),console.log(W.value,"##rewardInfoObj")};return ko(()=>[To.value,f.value,Ro.value],([c,S,P])=>{c&&!x(c)&&S&&!x(S)&&P&&!x(P)&&g(c,S,P)},{immediate:!0}),{isShowMore:l,wallet:u,farmsPoolList:r,farmsUserUsd:I,sFixD:X,farmsRewardObj:j,farmsPositionObj:e,openMore:E,checkNullObj:x,openMoreObj:G,farmsPoolListLoading:O,claimPoolReward:q,router:so,addCommom:R,farmsLoadingObj:y,farmsAllPositionLoading:ro,addressLpTokens:f,rewardInfoObj:W}}});const oo=o=>(ao("data-v-87ff3267"),o=o(),io(),o),_t={key:0,class:"farms-pool-list"},ft={class:"farms-block"},ht={class:"item-block"},vt=oo(()=>s("div",{class:"leabl"},"Staked TVL",-1)),gt={class:"text"},bt={class:"item-block apr"},$t=oo(()=>s("div",{class:"leabl"},"APR",-1)),wt={class:"text"},yt={class:"apr-hover-box"},kt={class:"item-block"},It=oo(()=>s("div",{class:"leabl"},"Rewards / day",-1)),St={class:"text"},Pt={class:"item-block my-staked"},Lt=oo(()=>s("div",{class:"leabl"},"My Staked",-1)),Ct={key:0,class:"text"},jt={class:"position-usd"},Ot={key:0,class:"position-num"},Ut={key:1,class:"text"},Tt=oo(()=>s("div",{class:"position-usd"},"--",-1)),Rt=[Tt],At={class:"item-block"},Ft=oo(()=>s("div",{class:"leabl"},"Earned",-1)),Nt={class:"text earned-box"},Dt={class:"earned"},Bt={key:0,class:"my-staked-loading"},Et=oo(()=>s("div",{class:"ratio-bg"},[s("div",{class:"ratio"})],-1)),Mt={key:0},qt={key:1},Wt={key:2},Vt={key:2},Ht={class:"add-liquidity-box"},Jt=["onClick"],zt=oo(()=>s("use",{"xlink:href":"#icon-icon_arrow"},null,-1)),Qt=[zt],Gt={key:1,class:"upgrade-loading"},Kt={key:2,class:"no-data"},Xt=oo(()=>s("img",{src:Ko,alt:""},null,-1)),Yt={key:3,class:"no-data"},Zt=oo(()=>s("img",{src:Xo,alt:""},null,-1)),xt=oo(()=>s("span",null,"No Data",-1)),oa=[Zt,xt];function sa(o,l,m,u,p,a){const i=xo,r=Go,b=os,w=No,f=$o,_=rs,I=ts,j=ps;return n(),t(J,null,[o.farmsPoolListLoading?o.farmsPoolListLoading?(n(),t("div",Gt,[k(j,{type:"poolsCard",loading:!0})])):M("",!0):(n(),t("div",_t,[(n(!0),t(J,null,no(o.farmsPoolList,e=>{var O,D;return n(),t("div",{key:e.id,class:"farms-item"},[k(i,{"pool-info":e},null,8,["pool-info"]),s("div",ft,[s("div",ht,[vt,s("div",gt,"$"+v(("addCommom"in o?o.addCommom:$(R))(e.tvl,2)),1)]),s("div",bt,[$t,s("div",wt,[A(v(e.total_apr>0&&e.total_apr<1e-4?"<0.01%":("addCommom"in o?o.addCommom:$(R))(e.total_apr*100,2))+"% ",1),s("div",yt,[!("checkNullObj"in o?o.checkNullObj:$(x))(o.rewardInfoObj)&&o.rewardInfoObj[e.clmm_pool_id]?(n(),F(r,{key:0,"l-item":o.rewardInfoObj[e.clmm_pool_id],"rewarder-info":o.rewardInfoObj[e.clmm_pool_id].rewards,class:"noHover apr-hover-con"},null,8,["l-item","rewarder-info"])):M("",!0)])])]),s("div",kt,[It,s("div",St,[(n(!0),t(J,null,no(e.rewarders,y=>(n(),F(b,{key:y.reward_coin,"reward-info":y,"current-tab":o.currentTab},null,8,["reward-info","current-tab"]))),128))])]),s("div",Pt,[Lt,o.wallet.address?(n(),t("div",Ct,[s("div",jt,v(Number((O=o.farmsUserUsd[e.clmm_pool_id])==null?void 0:O.amount)>0&&Number((D=o.farmsUserUsd[e.clmm_pool_id])==null?void 0:D.amount)<.01?"<$0.01":"$"+("addCommom"in o?o.addCommom:$(R))(o.farmsUserUsd&&o.farmsUserUsd[e.clmm_pool_id]&&o.farmsUserUsd[e.clmm_pool_id].amount||0,2)),1),o.farmsUserUsd&&o.farmsUserUsd[e.clmm_pool_id]&&o.farmsUserUsd[e.clmm_pool_id].positionNum?(n(),t("div",Ot,v(o.farmsUserUsd[e.clmm_pool_id].positionNum)+" "+v(o.farmsUserUsd[e.clmm_pool_id].positionNum>1?"Positions":"Position"),1)):M("",!0)])):(n(),t("div",Ut,Rt))]),s("div",At,[Ft,s("div",Nt,[s("div",Dt,[o.farmsLoadingObj[e.clmm_pool_id]||o.farmsAllPositionLoading?(n(),t("div",Bt,[k(w,{class:"upgrade-title-skeleton",loading:!0,active:"",paragraph:!1})])):o.wallet.address&&o.farmsRewardObj&&o.farmsRewardObj[e.clmm_pool_id]&&o.farmsRewardObj[e.clmm_pool_id].amountUsd?(n(),t(J,{key:1},[Et,o.farmsRewardObj[e.clmm_pool_id].amountUsd>.01?(n(),t("span",Mt,"$"+v(("addCommom"in o?o.addCommom:$(R))(("sFixD"in o?o.sFixD:$(X))(o.farmsRewardObj[e.clmm_pool_id].amountUsd||0,2))),1)):o.farmsRewardObj[e.clmm_pool_id].amountUsd>0&&o.farmsRewardObj[e.clmm_pool_id].amountUsd<.01?(n(),t("span",qt,"<$0.01")):(n(),t("span",Wt,"0"))],64)):(n(),t("span",Vt,"--"))]),k(f,{class:"claim-btn",disabled:!o.wallet.address||!o.farmsRewardObj[e.clmm_pool_id]||o.farmsRewardObj[e.clmm_pool_id].amountUsd<=0,onClick:bo(y=>o.claimPoolReward(e.clmm_pool_id),["stop"])},{default:B(()=>[A("Claim")]),_:2},1032,["disabled","onClick"])])])]),s("div",Ht,[k(f,{class:"add-liquidity-btn",onClick:bo(y=>o.router.push(`/liquidity/deposit?poolAddress=${e.clmm_pool_id}`),["stop"])},{default:B(()=>[A("+ Add liquidity")]),_:2},1032,["onClick"])]),s("div",{class:"more-btn",onClick:y=>o.openMore(e)},[(n(),t("svg",{class:ho(["arrow-icon",!("checkNullObj"in o?o.checkNullObj:$(x))(o.openMoreObj)&&o.openMoreObj[e==null?void 0:e.clmm_pool_id]?"open-more":""]),"aria-hidden":"true"},Qt,2))],8,Jt),(n(!0),t(J,null,no(o.farmsPositionObj[e.clmm_pool_id],y=>to((n(),F(_,{key:y.clmm_pool_id,"current-tab":o.currentTab,"position-info":{...y,clmm_pool_id:e.clmm_pool_id}},null,8,["current-tab","position-info"])),[[zo,!("checkNullObj"in o?o.checkNullObj:$(x))(o.openMoreObj)&&o.openMoreObj[e==null?void 0:e.clmm_pool_id]]])),128)),o.farmsPositionObj&&o.farmsPositionObj[e.clmm_pool_id]&&o.farmsPositionObj[e.clmm_pool_id].length==0?(n(),F(I,{key:0,"no-data-img":"/sui-image/img-no-Positions@2x.png",desc:"No Position Found",type:"addLiquidity","add-liquidity-url":`/liquidity/deposit?poolAddress=${e.clmm_pool_id}`},null,8,["add-liquidity-url"])):M("",!0),o.wallet.address?M("",!0):(n(),F(I,{key:1,"no-data-img":"/sui-image/img-connect-wallet@2x.png",type:"connectWallet"},null,8,["no-data-img"]))])}),128))])),!o.wallet.connected&&o.currentTab=="My Farms"?(n(),t("div",Kt,[Xt,k(f,{class:"connect-wallet",onClick:l[0]||(l[0]=e=>o.wallet.setIsShowWalletModal(!0))},{default:B(()=>[A(v(o.$t("button.connectWallet")),1)]),_:1})])):o.farmsPoolList.length==0?(n(),t("div",Yt,oa)):M("",!0)],64)}const ds=Z(pt,[["render",sa],["__scopeId","data-v-87ff3267"]]),ea=Y({setup(o,l){const m=V("Live"),u=V("APR"),p=V(!1),a=V(!1),i=mo(),r=d(()=>i),b=lo(),w=d(()=>b),f=d(()=>m.value=="My Farms"?w.value.address?r.value.myFarmsPoolList:[]:m.value=="Ended"?r.value.farmsPoolList.filter(y=>y.status=="Ended"):r.value.farmsPoolList.filter(y=>y.status=="Live")),I=d(()=>r.value.farmsPoolList.filter(y=>y.status=="Ended")).value.length>0?["Live","Ended","My Farms"]:["Live","My Farms"],j=y=>f.value.length,e=()=>{p.value=!0,i.getFarmsPoolList(),setTimeout(()=>{p.value=!1},1e3)},O=y=>{m.value=y,l.emit("changeTab",y)},D=y=>{u.value=y,l.emit("changeSortValue",y)};return Qo(()=>{document.addEventListener("click",()=>{a.value=!1})}),{isOpenList:a,tabList:I,currentTab:m,sortValue:u,clickRefresh:e,isRefresh:p,farmsPoolList:f,getListNum:j,changeTab:O,changeSortValue:D}}});const wo=o=>(ao("data-v-8c79e3fc"),o=o(),io(),o),na={class:"farms-tab"},ta={class:"tab-left"},aa=["onClick"],ia={key:0},la={class:"tab-right"},ra={class:"sort-select"},da=wo(()=>s("div",null,"Sort by",-1)),ca={class:"showSort"},ua=wo(()=>s("svg",{class:"sort-icon","aria-hidden":"true"},[s("use",{"xlink:href":"#icon-icon_on-pool"})],-1)),ma=wo(()=>s("use",{"xlink:href":"#icon-icon_arrow"},null,-1)),pa=[ma],_a={key:0,class:"sort-list"},fa=wo(()=>s("svg",{class:"sort-icon","aria-hidden":"true"},[s("use",{"xlink:href":"#icon-icon_on-pool"})],-1)),ha=wo(()=>s("svg",{class:"sort-icon","aria-hidden":"true"},[s("use",{"xlink:href":"#icon-icon_on-pool"})],-1)),va={class:"refresh"},ga=wo(()=>s("use",{"xlink:href":"#icon-icon-refresh2"},null,-1)),ba=[ga];function $a(o,l,m,u,p,a){return n(),t("div",na,[s("div",ta,[(n(!0),t(J,null,no(o.tabList,i=>(n(),t("div",{key:i,class:ho(["tab-item",o.currentTab==i?"tab-item-active":""]),onClick:r=>o.changeTab(i)},[s("span",null,v(i=="Ended"?"Finished":i),1),o.currentTab==i&&o.getListNum(i)?(n(),t("p",ia,v(o.getListNum(i)),1)):M("",!0)],10,aa))),128))]),s("div",la,[s("div",ra,[s("div",{class:"sort-select-box",onClick:l[0]||(l[0]=bo(i=>o.isOpenList=!o.isOpenList,["stop"]))},[da,s("div",ca,[s("span",null,v(o.sortValue),1),ua,(n(),t("svg",{class:ho(["arrow-icon",o.isOpenList?"arrow-icon-active":""]),"aria-hidden":"true"},pa,2))])]),o.isOpenList?(n(),t("div",_a,[s("div",{class:"sort-item",onClick:l[1]||(l[1]=i=>o.changeSortValue("APR"))},[A("APR "),fa]),s("div",{class:"sort-item",onClick:l[2]||(l[2]=i=>o.changeSortValue("TVL"))},[A("TVL "),ha])])):M("",!0)]),s("div",va,[(n(),t("svg",{"aria-hidden":"true",class:ho(["refresh-icon",o.isRefresh?"refreshing":""]),onClick:l[3]||(l[3]=(...i)=>o.clickRefresh&&o.clickRefresh(...i))},ba,2))])])])}const wa=Z(ea,[["render",$a],["__scopeId","data-v-8c79e3fc"]]),ya=Y({components:{FarmsBanner:Zo,FarmsTabs:wa,FarmsTable:as,FarmsH5List:ds},setup(){const o=mo(),l=d(()=>o),m=d(()=>l.value.farmsPoolListLoading),u=V("APR"),p=d(()=>l.value.farmsPoolList),a=lo(),i=d(()=>a),r=vo(),b=d(()=>r);ko(()=>[i.value.address,p.value,b.value.tokensObj,b.value.RATES],([f,_,I,j])=>{f&&_.length>0&&!x(I)&&!x(j)&&o.getPositionByAllPool(f)},{immediate:!0}),Qo(()=>{o.getFarmsPoolList()}),ko(()=>i.value.address,f=>{f||o.logOut()},{immediate:!0});const w=V("Live");return{farmsPoolListLoading:m,currentTab:w,sortValue:u}}});const ka={class:"farm-container"},Ia={class:"farm-container-center"};function Sa(o,l,m,u,p,a){const i=Zo,r=ms("FarmsTabs"),b=as,w=Mn,f=ds;return n(),t("div",ka,[k(i),s("div",Ia,[k(r,{onChangeTab:l[0]||(l[0]=_=>{o.currentTab=_}),onChangeSortValue:l[1]||(l[1]=_=>{o.sortValue=_})}),o.farmsPoolListLoading?(n(),F(w,{key:1,"current-tab":o.currentTab},null,8,["current-tab"])):(n(),F(b,{key:0,"current-tab":o.currentTab,"sort-value":o.sortValue},null,8,["current-tab","sort-value"])),k(f,{"current-tab":o.currentTab,"sort-value":o.sortValue},null,8,["current-tab","sort-value"])])])}const Ha=Z(ya,[["render",Sa],["__scopeId","data-v-12d06cb2"]]);export{Ha as default};
