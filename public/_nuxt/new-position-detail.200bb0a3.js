import{_ as No}from"./new-position-title.59f95d0e.js";import{_ as ao}from"./token-warning.2bb41a6f.js";import{_ as Ro}from"./status-block.97bfce8d.js";import{b as oo,i as Go,n as zo,d as pe,u as no,a as Q,g as fo,c as he,s as Ue,k as Pe,p as Co,e as Oe,B as Oo,D as qo,T as Io,C as Yo}from"./pool.6b9e2b41.js";import{s as xe,m as Jo,l as Qo,b as Zo,a as Ko}from"./transform.c672907f.js";import{D as g}from"./decimal.0e8aa3f1.js";import{u as Je,a as so}from"./sha256.6c6b97fc.js";import{a as Qe,r as L,l as _,J as Bo,q as Ae,e as Ze,o as S,f as M,t as qe,P as Lo,h as i,p as yo,k as Ao,m as lo,s as Mo,i as de,u as J,v as D,j as _e,x as fe,y as _o,a4 as Vo,b as uo,D as Xe,a8 as So,Q as $o,w as Ye,F as po,G as ho,B as ro,C as go,c as je,E as xo,H as en,A as on,a1 as nn,T as tn,S as an}from"./entry.cd7fe5ff.js";import{i as eo}from"./import-icon.de3e6c66.js";import{_ as co}from"./assets-card.db60abba.js";import{_ as sn}from"./coin-lock.797df914.js";import{a as ln}from"./new-add-or-create.75071c24.js";import{_ as un,a as rn}from"./icon-Add-Liquidity_2x.0acb06cb.js";/* empty css              *//* empty css              */import{u as Uo}from"./notifi.e8a434a7.js";/* empty css              *//* empty css              */import"./back.c2e3fdf0.js";import"./swap-setting.1f38ff1e.js";/* empty css              *//* empty css              */import"./img-lock_2x.a28135f4.js";import"./img-lock_2x.1c5ffc79.js";import"./useWhale.bc03e919.js";import"./index.436f0943.js";const bo=Math.PI,ko=2*bo,ze=1e-6,dn=ko-ze;function jo(e){this._+=e[0];for(let n=1,t=e.length;n<t;++n)this._+=arguments[n]+e[n]}function cn(e){let n=Math.floor(e);if(!(n>=0))throw new Error(`invalid digits: ${e}`);if(n>15)return jo;const t=10**n;return function(a){this._+=a[0];for(let q=1,$=a.length;q<$;++q)this._+=Math.round(arguments[q]*t)/t+a[q]}}class vn{constructor(n){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=n==null?jo:cn(n)}moveTo(n,t){this._append`M${this._x0=this._x1=+n},${this._y0=this._y1=+t}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(n,t){this._append`L${this._x1=+n},${this._y1=+t}`}quadraticCurveTo(n,t,a,q){this._append`Q${+n},${+t},${this._x1=+a},${this._y1=+q}`}bezierCurveTo(n,t,a,q,$,R){this._append`C${+n},${+t},${+a},${+q},${this._x1=+$},${this._y1=+R}`}arcTo(n,t,a,q,$){if(n=+n,t=+t,a=+a,q=+q,$=+$,$<0)throw new Error(`negative radius: ${$}`);let R=this._x1,v=this._y1,o=a-n,r=q-t,m=R-n,d=v-t,k=m*m+d*d;if(this._x1===null)this._append`M${this._x1=n},${this._y1=t}`;else if(k>ze)if(!(Math.abs(d*o-r*m)>ze)||!$)this._append`L${this._x1=n},${this._y1=t}`;else{let z=a-R,oe=q-v,ne=o*o+r*r,ce=z*z+oe*oe,f=Math.sqrt(ne),c=Math.sqrt(k),h=$*Math.tan((bo-Math.acos((ne+k-ce)/(2*f*c)))/2),s=h/c,A=h/f;Math.abs(s-1)>ze&&this._append`L${n+s*m},${t+s*d}`,this._append`A${$},${$},0,0,${+(d*z>m*oe)},${this._x1=n+A*o},${this._y1=t+A*r}`}}arc(n,t,a,q,$,R){if(n=+n,t=+t,a=+a,R=!!R,a<0)throw new Error(`negative radius: ${a}`);let v=a*Math.cos(q),o=a*Math.sin(q),r=n+v,m=t+o,d=1^R,k=R?q-$:$-q;this._x1===null?this._append`M${r},${m}`:(Math.abs(this._x1-r)>ze||Math.abs(this._y1-m)>ze)&&this._append`L${r},${m}`,a&&(k<0&&(k=k%ko+ko),k>dn?this._append`A${a},${a},0,1,${d},${n-v},${t-o}A${a},${a},0,1,${d},${this._x1=r},${this._y1=m}`:k>ze&&this._append`A${a},${a},0,${+(k>=bo)},${d},${this._x1=n+a*Math.cos($)},${this._y1=t+a*Math.sin($)}`)}rect(n,t,a,q){this._append`M${this._x0=this._x1=+n},${this._y0=this._y1=+t}h${a=+a}v${+q}h${-a}Z`}toString(){return this._}}function Ke(e){return function(){return e}}function mn(e){let n=3;return e.digits=function(t){if(!arguments.length)return n;if(t==null)n=null;else{const a=Math.floor(t);if(!(a>=0))throw new RangeError(`invalid digits: ${t}`);n=a}return e},()=>new vn(n)}function fn(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function Do(e){this._context=e}Do.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,n){switch(e=+e,n=+n,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,n):this._context.moveTo(e,n);break;case 1:this._point=2;default:this._context.lineTo(e,n);break}}};function pn(e){return new Do(e)}function hn(e){return e[0]}function gn(e){return e[1]}function bn(e,n){var t=Ke(!0),a=null,q=pn,$=null,R=mn(v);e=typeof e=="function"?e:e===void 0?hn:Ke(e),n=typeof n=="function"?n:n===void 0?gn:Ke(n);function v(o){var r,m=(o=fn(o)).length,d,k=!1,z;for(a==null&&($=q(z=R())),r=0;r<=m;++r)!(r<m&&t(d=o[r],r,o))===k&&((k=!k)?$.lineStart():$.lineEnd()),k&&$.point(+e(d,r,o),+n(d,r,o));if(z)return $=null,z+""||null}return v.x=function(o){return arguments.length?(e=typeof o=="function"?o:Ke(+o),v):e},v.y=function(o){return arguments.length?(n=typeof o=="function"?o:Ke(+o),v):n},v.defined=function(o){return arguments.length?(t=typeof o=="function"?o:Ke(!!o),v):t},v.curve=function(o){return arguments.length?(q=o,a!=null&&($=q(a)),v):q},v.context=function(o){return arguments.length?(o==null?a=$=null:$=q(a=o),v):a},v}function To(){}function Eo(e){this._context=e}Eo.prototype={areaStart:To,areaEnd:To,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,n){e=+e,n=+n,this._point?this._context.lineTo(e,n):(this._point=1,this._context.moveTo(e,n))}};function kn(e){return new Eo(e)}function Po(e,n,t){const a=new g(10).pow(n-t);return new g(1.0001).pow(e).mul(a)}const wn=Qe({props:{poolInfo:{type:Object,default:()=>({chartLoading:!1,token_a:{decimal:6},token_b:{decimal:6},currentLiquity:"50000000"})},minPrice:{type:String,default:""},maxPrice:{type:String,default:""},direction:{type:Boolean,default:!0},tickList:{type:Array,default:()=>[]},currentTick:{type:Number,default:0},chartLoading:{type:Boolean,default:!1},currentPriceTab:{type:String,default:""},before7dContractPriceLowest:{type:String,default:""},before7dContractPriceHighest:{type:String,default:""}},setup(e,n){const t=L(1),a=L(""),q=L(""),$=_(()=>{var s,A,T;return d.sqrtPriceX64ToPrice((s=e.poolInfo)==null?void 0:s.current_sqrt_price,(A=e.poolInfo)==null?void 0:A.coinA.decimals,(T=e.poolInfo)==null?void 0:T.coinB.decimals).toString()}),R=_(()=>{let s=0;return e.direction?s=(Number(e.minPrice)/Number($.value)-1)*100:s=(Number(e.minPrice)/Number(1/Number($.value))-1)*100,s=s>0&&s<.1?.1:s,s=s<0&&s>-.1?-.1:s,s}),v=_(()=>{let s=0;return e.direction?s=(Number(e.maxPrice)/Number($.value)-1)*100:s=(Number(e.maxPrice)/Number(1/Number($.value))-1)*100,s=s>0&&s<.1?.1:s,s=s<0&&s>-.1?-.1:s,s}),o=Je(),r=_(()=>o),m=_(()=>r.value.chainName?oo(r.value.chainName):{}),{TickMath:d,getNearestTickByTick:k}=m.value,z=()=>{const s=t.value/2;t.value=s,ce(e.poolInfo,s)},oe=()=>{const s=t.value*2;t.value=s,ce(e.poolInfo,s)},ne=(s=[])=>{let A=6;const T=Math.abs(Number(s[0])-Number(s[s.length-1]));return T>=6?A=0:T>=1?A=1:T>=.1?A=2:T>=.01?A=3:T>=.001?A=4:T>=1e-4?A=5:T>=1e-5?A=6:T>=1e-6?A=7:T>=1e-7&&(A=8),A},ce=(s,A=1)=>{if(s&&s.token_a&&!e.chartLoading&&e.minPrice&&e.maxPrice){console.log(e.poolInfo,"==>props.poolInfo");const T=Number(e.poolInfo.current_tick_index);console.log("0117###dataProcessing###currentTick###",T),console.log("0117###dataProcessing###props.poolInfo###",e.poolInfo),console.log("0117###dataProcessing###minPrice###",e.minPrice),console.log("0117###dataProcessing###maxPrice###",e.maxPrice),console.log("0117###dataProcessing###poolInfo###",e.poolInfo);let y=T+100*A,l=T-100*A,V,G;if(e.maxPrice==="∞")G=m.value.TickUtil.getMaxIndex(Number(e.poolInfo.tickSpacing));else try{e.direction?G=d.priceToTickIndex(new g(e.maxPrice),e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals):G=d.priceToTickIndex(new g(1).div(e.minPrice),e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals)}catch{G=443636}if(e.minPrice==="0")V=m.value.TickUtil.getMinIndex(Number(e.poolInfo.tickSpacing));else try{e.direction?V=d.priceToTickIndex(new g(e.minPrice),e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals):V=d.priceToTickIndex(new g(1).div(e.maxPrice),e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals)}catch{V=-443636}let ue=0;if(e.currentPriceTab!=="full range"){if(T>=V&&T<=G){const U=T-V,me=G-T;ue=Math.max(Math.abs(U),Math.abs(me))}else T<V?ue=Math.abs(G-T):ue=Math.abs(T-V);y=T+ue+100*A,l=T-ue-100*A,console.log(A,T,"===>zooms")}else{const U=(Math.abs(T)>5e3,2e4);y=T+U*A,l=T-U*A}l<-443636&&(l=-443636),y>443636&&(y=443636),console.log(l,y,"===>201");const x=new g(s.liquidity).div(Math.pow(10,8)).toString();console.log(x,"==>currentLiquity");const B=e.tickList;console.log("0117####drawChart####tick_info_array####",B);const W=[],Y=[];let ee={};for(let U=0;U<B.length;U++){if(ee=B[U],ee.index<=T&&ee.index>=l){if(W.length<1&&U!==0){const me=B[U-1];W.unshift({...me,index:l})}W.unshift(ee)}else if(ee.index>T&&ee.index<=y&&(Y.push(ee),W.length<1&&U!==0)){const me=B[U-1];W.push({...me,index:l})}if(ee.index>y){const me=B[U];if(Y.push({...me,index:y}),W.length<1&&U!==0){const we=B[U-1];W.push({...we,index:l})}break}}console.log(T,l,y,"===>currentTick");let le="0";for(let U=W.length-1;U>=0;U--)le=new g(le).plus(new g(W[U].liquidityNet.toString()).div(Math.pow(10,8))).toString(),W[U].liquityAmount=le;let K=x;for(let U=0;U<Y.length;U++)K=new g(K).plus(new g(Y[U].liquidityNet.toString()).div(Math.pow(10,8))).toString(),Y[U].liquityAmount=K;console.log(W.length,Y.length,"leftArray");let ie=[];const Z=B&&B.length>0?{index:T,liquityAmount:Number(x)}:{index:T,liquityAmount:0};(W.length>0||Y.length>0)&&(console.log([Z,...Y],"279===>"),ie=[...W.reverse(),Z,...Y],e.direction||(ie=ie.reverse()));const ge=[];B.forEach(U=>{ge.push({...U,liquidityGross:U.liquidityGross.toString(),liquidityNet:U.liquidityNet.toString()})}),console.log("0117####drawChart####testTickInfoArray####",ge),console.log("0117####drawChart####currentLiquity####",x),console.log(ie,"===>chartData"),c(ie,l,y,V,G,T)}};let f=L(!1);Bo(()=>{document.body.clientWidth<750?f.value=!1:f.value=!0,window.onresize=()=>{document.body.clientWidth<750?f.value=!1:f.value=!0,ce(e.poolInfo,t.value)}});const c=(s,A,T,y,l,V)=>{console.log("0117####drawChart####chartData####",s),console.log("0117####drawChart####tickMin####",A),console.log("0117####drawChart####tickMax####",T),console.log("0117####drawChart####minPriceTick####",y),console.log("0117####drawChart####maxPriceTick####",l),console.log("0117####drawChart####currentTick####",V),console.log("0117####drawChart####props.direction####",e.direction),console.log("0518###newd3###props.before7dContractPriceLowest###",e.before7dContractPriceLowest),console.log("0518###newd3###props.before7dContractPriceHighest###",e.before7dContractPriceHighest);let G,ue;e.direction?(G=e.before7dContractPriceLowest?d.priceToTickIndex(new g(e.before7dContractPriceLowest),e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals):"",ue=e.before7dContractPriceHighest?d.priceToTickIndex(new g(e.before7dContractPriceHighest),e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals):""):(G=e.before7dContractPriceLowest?d.priceToTickIndex(new g(1).div(e.before7dContractPriceLowest),e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals):"",ue=e.before7dContractPriceHighest?d.priceToTickIndex(new g(1).div(e.before7dContractPriceHighest),e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals):"");const x={top:30,right:35,bottom:20,left:55};let B,W;f.value,B=340-x.left-x.right,W=205-x.top-x.bottom;const Y=T-A,ee=parseInt(String(Y/4));let le=[A+ee/4,A+ee,A+2*ee,T-ee,T-ee/4];const K=A,ie=T,Z=B/(ie-K);e.currentPriceTab==="full range"&&(le=[A,A+2*ee,T]),console.log("0117####drawChart####xArr####",le),console.log("0117####drawChart####utickMin####",K),console.log("0117####drawChart####utickMax####",ie),console.log("0117####drawChart####unit####",Z);const ge=le.map(P=>e.direction?Po(P,e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals).toString():new g(1).div(Po(P,e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals)).toString());ne(ge),xe("#chart").selectAll("*").remove();const U=xe("#chart").attr("width",B+x.left+x.right).attr("height",W+x.top+x.bottom).append("g").attr("transform",`translate(${x.left},${x.right})`),me=Jo(s,function(P){return Number(Math.abs(P.liquityAmount))})||0,we=Qo().range([0,W]).domain([me,0]);Zo().rangeRound([0,B]).padding(.1);const u=U.append("g").attr("id","barsBox").selectAll("rect").data(s).enter().append("rect");r.value.theme=="default"?u.attr("x",function(P,O){return O===0?0:e.direction?Math.abs(P.index-K)*Z:Math.abs(ie-P.index)*Z}).attr("y",function(P,O){return e.direction?O===s.length-1?0:we(P.liquityAmount):O===s.length-1?0:we(s[O+1].liquityAmount)}).attr("width",function(P,O){return O===0&&s.length===1&&P.liquityAmount>0?B:(e.direction,O!==s.length-1?Math.abs(s[O+1].index-P.index)*Z:0)}).attr("height",function(P,O){return O===0&&s.length===1&&P.liquityAmount>0?W:e.direction?O===s.length-1?0:W-we(P.liquityAmount):O===s.length-1?0:W-we(s[O+1].liquityAmount)}).attr("fill","#279477").attr("class","bars").attr("stroke-width",1).attr("stroke","#279477"):u.attr("x",function(P,O){return O===0?0:e.direction?Math.abs(P.index-K)*Z:Math.abs(ie-P.index)*Z}).attr("y",function(P,O){return e.direction?O===s.length-1?0:we(Math.abs(P.liquityAmount)):O===s.length-1?0:we(Math.abs(s[O+1].liquityAmount))}).attr("width",function(P,O){return O===0&&s.length===1&&P.liquityAmount>0?B:(e.direction,O!==s.length-1?Math.abs(s[O+1].index-P.index)*Z:0)}).attr("height",function(P,O){if(O===0&&s.length===1&&P.liquityAmount>0)return W;if(e.direction)return O===s.length-1?0:Number(P.liquityAmount)?W-we(Math.abs(P.liquityAmount)):0;{if(O===s.length-1)return 0;const se=W-we(Math.abs(s[O+1].liquityAmount));return Number(s[O+1].liquityAmount)?se:0}}).attr("fill","#407497").attr("class","bars").attr("stroke-width",1).attr("stroke","#407497");const p=U.append("g");p.append("line").attr("x1",0).attr("y1",155).attr("x2",B).attr("y2",155).attr("stroke-width",1).attr("stroke","#50535D"),p.append("g");let C=0;e.direction?C=Math.abs(V-K)*Z:C=Math.abs(V-ie)*Z,console.log(r.value.theme=="default","leftHandle#"),(r.value.theme=="default"?U.append("line").attr("x1",0).attr("y1",0).attr("x2",0).attr("y2",155).attr("stroke-width",2).attr("stroke","#68FFD8"):U.append("line").attr("x1",0).attr("y1",0).attr("x2",0).attr("y2",155).attr("stroke-width",2).attr("stroke","#76C8FF")).attr("transform","translate("+C+", 0)"),xe("#triangle").attr("width",8).attr("height",4);let j=[[0,0],[4,4],[8,0]],E=bn().x(function(P){return P[0]}).y(function(P){return P[1]}).curve(kn);const N=C-4;U.append("path").attr("d",E(j)).style("fill",r.value.theme=="default"?"#68FFD8":"#76C8FF").attr("transform","translate("+N+", 0)");let F,H,ae,re;e.direction?(console.log("0525###d3###select###minPriceTick###",y),console.log("0525###d3###select###maxPriceTick###",l),console.log("0525###d3###select###props.minPrice###",e.minPrice),console.log("0525###d3###select###props.maxPrice###",e.maxPrice),F=y<K?-100:parseInt(String(Math.abs(y-K)*Z)),H=l<K?-100:parseInt(String(Math.abs(l-K)*Z)),ae=G<K?-100:Math.abs(G-K)*Z,re=ue<K?-100:Math.abs(ue-K)*Z):(H=y<K?-100:Math.abs(ie-y)*Z,F=l<K?-100:Math.abs(ie-l)*Z,re=G<K?-100:Math.abs(ie-G)*Z,ae=ue<K?-100:Math.abs(ie-ue)*Z),e.minPrice==="0"&&(F=0),e.maxPrice==="∞"&&(H=B),f.value?a.value=B-F+60+"px":a.value=B-F+52+"px",q.value=H+74+"px",console.log(F,H,"##minPriceTickX"),G&&ae<B&&U.append("line").attr("x1",0).attr("y1",0).attr("x2",0).attr("y2",155).attr("stroke-width",1).attr("stroke-dasharray","5, 5").attr("stroke","rgba(255, 255, 255, 0.5)").attr("transform","translate("+ae+", 0)"),ue&&re<B&&U.append("line").attr("x1",0).attr("y1",0).attr("x2",0).attr("y2",155).attr("stroke-width",1).attr("stroke-dasharray","5, 5").attr("stroke","rgba(255, 255, 255, 0.5)").attr("transform","translate("+re+", 0)");const be=Ko().extent([[0,0],[B,W]]).handleSize(30).on("end",ye);U.append("g").attr("class","brush").call(be).call(be.move,[F,H]);function ye(P){if(!P.sourceEvent||!P.selection)return;f.value?a.value=B-P.selection[0]+60+"px":a.value=B-P.selection[0]+52+"px",q.value=P.selection[1]+74+"px";let O,se;console.log("0525###d3###select###e.selection[0]###",P.selection[0]),console.log("0525###d3###select###e.selection[0]###",P.selection[1]),console.log("0525###d3###select###props.direction###",e.direction),console.log("0525###d3###select###width###",B),console.log("0525###d3###select###unit###",Z),console.log("0525###d3###select###utickMin###",K),console.log("0525###d3###select###utickMax###",ie),console.log("0525###d3###select###props.poolInfo###",e.poolInfo);let ke=0,b=0;e.direction?(ke=k(parseInt(String(P.selection[0]/Z+K)),Number(e.poolInfo.tickSpacing)),O=d.tickIndexToPrice(ke,e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals).toString(),b=k(parseInt(String(P.selection[1]/Z+K)),Number(e.poolInfo.tickSpacing)),se=d.tickIndexToPrice(b,e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals).toString(),console.log("0525###d3###select###minTick###",ke),console.log("0525###d3###select###maxTick###",b),console.log("0525###d3###select###minPrice###",O),console.log("0525###d3###select###maxPrice###",se)):(b=k(ie-P.selection[0]/Z,Number(e.poolInfo.tickSpacing)),O=1/d.tickIndexToPrice(b,e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals).toString(),ke=k(ie-P.selection[1]/Z,Number(e.poolInfo.tickSpacing)),se=1/d.tickIndexToPrice(ke,e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals).toString()),n.emit("onChangeMinPrice",String(pe(String(O),6))),n.emit("onChangeMaxPrice",String(pe(String(se),6)))}r.value.theme=="default"?xe(".selection").attr("stroke","rgba(255, 255, 255, 0)").attr("fill","#15322C"):xe(".selection").attr("stroke","rgba(255, 255, 255, 0)").attr("fill","rgba(255,255,255,0.7)")};L(""),Ae(()=>[e.poolInfo,e.minPrice,e.maxPrice,e.currentPriceTab,e.tickList],([s,A,T,y])=>{console.log(s,A,T,T>A,"poolInfo && minPrice && maxPrice && (maxPrice > minPrice)"),s&&A&&T&&ce(s,t.value)},{immediate:!0});const h=L(!0);return Ae(()=>e.chartLoading,(s,A)=>{s!==A&&(h.value=s)},{immediate:!0,deep:!0}),{store:r,loading:h,zoomOut:z,zoomIn:oe,rangeSizeLower:R,rangeSizeUpper:v,rangeSizeLowerPosition:a,rangeSizeUpperPosition:q,decimalFormat:Go,numberformat:zo}}});const yn=e=>(yo("data-v-59ae7c8b"),e=e(),Ao(),e),An={class:"chart-box"},_n={class:"chart"},Cn=yn(()=>i("svg",{id:"chart"},null,-1)),In=[Cn];function Sn(e,n,t,a,q,$){return S(),M("div",An,[qe(i("div",_n,In,512),[[Lo,!e.loading]])])}const Fo=Ze(wn,[["render",Sn],["__scopeId","data-v-59ae7c8b"]]),$n=Qe({components:{StatusBlock:Ro,NewPositionChart:Fo,TokenWarning:ao},setup(e){const n=L(),t=L(),a=_(()=>{var h,s;return(s=(h=m.value)==null?void 0:h.poolInfo)==null?void 0:s.needReverse}),q=Je(),$=_(()=>q),R=_(()=>$.value.theme),v=_(()=>$.value.chainName),o=no(),r=_(()=>o),m=L({}),d=lo();Ae(()=>[r.value.currentPositionInfo,v.value],([h,s])=>{var A;s=="Aptos"&&h?(m.value=h,n.value=m.value.token_a,t.value=m.value.token_b):s=="Sui"&&h&&(h==null?void 0:h.nftHash)==((A=d==null?void 0:d.query)==null?void 0:A.pos)&&(console.log(h,"==>newVal"),m.value=h,n.value=m.value.token_a,t.value=m.value.token_b,console.log(n.value,t.value,"###fromCoin.value"))},{immediate:!0});const k=h=>{var s;return(h==null?void 0:h.logoURI)||(h==null?void 0:h.logo_url)||((s=r.value.tokensObj[h==null?void 0:h.address])==null?void 0:s.logo_url)||(R.value==="default"?eo("/image/coins/unknown.png"):eo("/image/coins/sui-unknown.png"))},z=_(()=>v.value?oo(v.value):{}),oe=L([]),ne=async h=>{console.log(h,"===>positionInfo.value.poolInfo");const s=await z.value.getTicks(h),A=s?z.value.getTickDataFromUrlData(s):[];console.log(A,"list===>"),oe.value=A};Ae(()=>[m.value,r.value.poolsObj],([h,s])=>{console.log(h,!he(h),"177111"),h&&!he(h)&&h.poolInfo&&s&&!he(s)&&(console.log(h,s,"==>poolConfigObj"),ne(s[h.poolAddress]))},{immediate:!0});const ce=L(!0);console.log(m.value,"188---------->");const f=(h,s)=>h!=="0"&&s!=="∞"?Ue(1/(1-Number((h/s)**.25)),2)+"x":"1x",c=_(()=>m.value.minPrice&&m.value.maxPrice?f(m.value.minPrice,m.value.maxPrice):"--");return{needReverse:a,getCoinIcon:k,theme:R,indexStore:q,direct:ce,addCommom:Q,decimalUi:pe,tickList:oe,positionInfo:m,fromCoin:n,toCoin:t,getExplorerUrl:fo,lever:c}}}),Tn=""+globalThis.__publicAssetsURL("image/aptos-price.png"),Pn=""+globalThis.__publicAssetsURL("sui-image/sui-price.png"),Nn=""+globalThis.__publicAssetsURL("image/icon-arrow@2x.png"),Rn=""+globalThis.__publicAssetsURL("sui-image/icon-arrow@2x.png");const Fe=e=>(yo("data-v-f9690e82"),e=e(),Ao(),e),On={class:"new-position-info"},qn={class:"pool-info"},Bn={class:"left"},Ln={class:"coin-a"},Mn={alt:""},Un={class:"coin-b"},jn={alt:""},Dn={class:"position-name"},En=["href"],Fn=Fe(()=>i("use",{"xlink:href":"#icon-icon-copy1"},null,-1)),Wn=[Fn],Hn={key:0,class:"pool-fee"},Xn=Fe(()=>i("span",null,"Fee tier",-1)),Gn={class:"right"},zn={class:"h5-pool-info"},Yn={class:"coin-info"},Jn={class:"coin-a"},Qn={alt:""},Zn={class:"coin-b"},Kn={alt:""},Vn={class:"position-name"},xn=["href"],et=Fe(()=>i("use",{"xlink:href":"#icon-icon-copy1"},null,-1)),ot=[et],nt={key:0,class:"pool-fee"},tt={class:"price-info"},it={class:"price-and-chart"},at={class:"left"},st={class:"current-price"},lt=Fe(()=>i("span",null,"Current Price",-1)),ut={class:"coin-rate"},rt=Fe(()=>i("div",null,[i("svg",{class:"icon icon-up","aria-hidden":"true"},[i("use",{"xlink:href":"#icon-exchange_up1"})])],-1)),dt=Fe(()=>i("div",null,[i("svg",{class:"icon icon-down","aria-hidden":"true"},[i("use",{"xlink:href":"#icon-exchange_down1"})])],-1)),ct=[rt,dt],vt={key:0},mt={key:1},ft={key:0,class:"position-range"},pt=Fe(()=>i("div",{class:"position-range-title"}," Position Range ",-1)),ht={key:0},gt={key:1},bt={key:2,src:Tn,alt:""},kt={key:3,src:Pn,alt:""},wt={key:4},yt={key:5},At={key:1,class:"position-range position-range-warp"},_t={key:0,class:"position-range-title"},Ct={key:1,class:"position-range-title"},It={key:2},St={key:3},$t={class:"price-img"},Tt={key:0,src:Nn,alt:""},Pt={key:1,src:Rn,alt:""},Nt={key:4},Rt={key:5},Ot={class:"lever"},qt=Fe(()=>i("div",{class:"lever-title"},"Leverage",-1)),Bt={class:"lever-text"},Lt={class:"right"},Mt=Fe(()=>i("div",{class:"chat-mask"},null,-1));function Ut(e,n,t,a,q,$){var m,d,k,z,oe,ne,ce,f,c,h,s,A,T,y,l,V,G,ue,x,B,W,Y,ee,le,K,ie,Z,ge,U,me;const R=ao,v=Ro,o=Fo,r=Mo("image");return S(),M("div",On,[i("div",qn,[i("div",Bn,[i("div",Ln,[qe(i("img",Mn,null,512),[[r,e.needReverse?e.getCoinIcon(e.positionInfo.token_b):e.getCoinIcon(e.positionInfo.token_a)]]),de(R,{address:e.needReverse?(z=(k=e.positionInfo)==null?void 0:k.token_b)==null?void 0:z.address:(d=(m=e.positionInfo)==null?void 0:m.token_a)==null?void 0:d.address,"style-params":{width:"12px",height:"12px",left:"18px",bottom:"4px"}},null,8,["address"])]),i("div",Un,[qe(i("img",jn,null,512),[[r,e.needReverse?e.getCoinIcon(e.positionInfo.token_a):e.getCoinIcon(e.positionInfo.token_b)]]),de(R,{address:e.needReverse?(f=(ce=e.positionInfo)==null?void 0:ce.token_a)==null?void 0:f.address:(ne=(oe=e.positionInfo)==null?void 0:oe.token_b)==null?void 0:ne.address,"style-params":{width:"12px",height:"12px",left:"18px",bottom:"4px"}},null,8,["address"])]),i("div",Dn,[i("a",{href:("getExplorerUrl"in e?e.getExplorerUrl:J(fo))("nftAddress",e.positionInfo.nftHash),target:"_blank"},D((h=(c=e.positionInfo)==null?void 0:c.name)==null?void 0:h.split("|")[1]),9,En)]),(S(),M("svg",{class:"copy-icon","aria-hidden":"true",onClick:n[0]||(n[0]=we=>e.indexStore.copy(e.positionInfo.nftHash))},Wn)),e.positionInfo.fee?(S(),M("div",Hn,[Xn,_e(" "+D(e.positionInfo.fee*100)+"% ",1)])):fe("",!0)]),i("div",Gn,[de(v,{"current-status":(s=e.positionInfo)==null?void 0:s.currentStatus},null,8,["current-status"])])]),i("div",zn,[i("div",null,[i("div",Yn,[i("div",Jn,[qe(i("img",Qn,null,512),[[r,e.needReverse?e.getCoinIcon(e.positionInfo.token_b):e.getCoinIcon(e.positionInfo.token_a)]]),de(R,{address:e.needReverse?(l=(y=e.positionInfo)==null?void 0:y.token_b)==null?void 0:l.address:(T=(A=e.positionInfo)==null?void 0:A.token_a)==null?void 0:T.address,"style-params":{width:"12px",height:"12px",left:"18px",bottom:"4px"}},null,8,["address"])]),i("div",Zn,[qe(i("img",Kn,null,512),[[r,e.needReverse?e.getCoinIcon(e.positionInfo.token_a):e.getCoinIcon(e.positionInfo.token_b)]]),de(R,{address:e.needReverse?(x=(ue=e.positionInfo)==null?void 0:ue.token_a)==null?void 0:x.address:(G=(V=e.positionInfo)==null?void 0:V.token_b)==null?void 0:G.address,"style-params":{width:"12px",height:"12px",left:"18px",bottom:"4px"}},null,8,["address"])])]),i("div",Vn,[i("div",null,[i("a",{href:("getExplorerUrl"in e?e.getExplorerUrl:J(fo))("nftAddress",e.positionInfo.nftHash),target:"_blank"},D((W=(B=e.positionInfo)==null?void 0:B.name)==null?void 0:W.split("|")[1]),9,xn),(S(),M("svg",{class:"copy-icon","aria-hidden":"true",onClick:n[1]||(n[1]=we=>e.indexStore.copy(e.positionInfo.nftHash))},ot))]),e.positionInfo.fee?(S(),M("div",nt,D(e.positionInfo.fee*100)+"%",1)):fe("",!0)])]),de(v,{"current-status":(Y=e.positionInfo)==null?void 0:Y.currentStatus},null,8,["current-status"])]),i("div",tt,[i("div",it,[i("div",at,[i("div",st,[i("div",null,[lt,i("div",ut,[i("div",{onClick:n[2]||(n[2]=we=>e.direct=!e.direct)},ct)])]),(e.needReverse?!e.direct:e.direct)?(S(),M("div",vt,[_e(D(("addCommom"in e?e.addCommom:J(Q))(("decimalUi"in e?e.decimalUi:J(pe))(e.positionInfo.currentPrice,6)))+"   ",1),i("span",null,D((ee=e.toCoin)==null?void 0:ee.symbol)+" per "+D((le=e.fromCoin)==null?void 0:le.symbol),1)])):(S(),M("div",mt,[_e(D(("addCommom"in e?e.addCommom:J(Q))(("decimalUi"in e?e.decimalUi:J(pe))(1/e.positionInfo.currentPrice,6)))+"   ",1),i("span",null,D((K=e.fromCoin)==null?void 0:K.symbol)+" per "+D((ie=e.toCoin)==null?void 0:ie.symbol),1)]))]),e.positionInfo.minPrice&&e.positionInfo.minPrice.length<9&&e.positionInfo.maxPrice&&e.positionInfo.maxPrice.length?(S(),M("div",ft,[pt,i("div",null,[(e.needReverse?!e.direct:e.direct)?(S(),M("div",ht,[_e(D(("addCommom"in e?e.addCommom:J(Q))(("decimalUi"in e?e.decimalUi:J(pe))(e.positionInfo.minPrice,6)))+" ",1),i("span",null,D(e.positionInfo&&e.positionInfo.token_b&&e.positionInfo.token_b.symbol),1)])):(S(),M("div",gt,[_e(D(((Z=e.positionInfo)==null?void 0:Z.minPrice)!=="0"?("addCommom"in e?e.addCommom:J(Q))(("decimalUi"in e?e.decimalUi:J(pe))(1/e.positionInfo.minPrice,6)):0)+" ",1),i("span",null,D(e.positionInfo&&e.positionInfo.token_a&&e.positionInfo.token_a.symbol),1)])),e.theme=="default"?(S(),M("img",bt)):(S(),M("img",kt)),(e.needReverse?!e.direct:e.direct)?(S(),M("div",wt,[_e(D(((ge=e.positionInfo)==null?void 0:ge.maxPrice)!=="∞"?("addCommom"in e?e.addCommom:J(Q))(("decimalUi"in e?e.decimalUi:J(pe))(e.positionInfo.maxPrice,6)):"∞")+" ",1),i("span",null,D(e.positionInfo&&e.positionInfo.token_b&&e.positionInfo.token_b.symbol),1)])):(S(),M("div",yt,[_e(D(((U=e.positionInfo)==null?void 0:U.maxPrice)!=="∞"?("addCommom"in e?e.addCommom:J(Q))(("decimalUi"in e?e.decimalUi:J(pe))(1/e.positionInfo.maxPrice,6)):"∞")+" ",1),i("span",null,D(e.positionInfo&&e.positionInfo.token_a&&e.positionInfo.token_a.symbol),1)]))])])):(S(),M("div",At,[(e.needReverse?!e.direct:e.direct)?(S(),M("span",_t," Position Range ")):(S(),M("span",Ct," Position Range ")),(e.needReverse?!e.direct:e.direct)?(S(),M("div",It,[_e(D(("addCommom"in e?e.addCommom:J(Q))(("decimalUi"in e?e.decimalUi:J(pe))(e.positionInfo.minPrice,6)))+" ",1),i("span",null,D(e.positionInfo&&e.positionInfo.token_b&&e.positionInfo.token_b.symbol),1)])):(S(),M("div",St,[_e(D(e.positionInfo.maxPrice!=="∞"?("addCommom"in e?e.addCommom:J(Q))(("decimalUi"in e?e.decimalUi:J(pe))(1/e.positionInfo.maxPrice,6)):"∞")+" ",1),i("span",null,D(e.positionInfo&&e.positionInfo.token_a&&e.positionInfo.token_a.symbol),1)])),i("div",$t,[e.theme=="default"?(S(),M("img",Tt)):(S(),M("img",Pt))]),(e.needReverse?!e.direct:e.direct)?(S(),M("div",Nt,[_e(D(e.positionInfo.maxPrice!=="∞"?("addCommom"in e?e.addCommom:J(Q))(("decimalUi"in e?e.decimalUi:J(pe))(e.positionInfo.maxPrice,6)):"∞")+" ",1),i("span",null,D(e.positionInfo&&e.positionInfo.token_b&&e.positionInfo.token_b.symbol),1)])):(S(),M("div",Rt,[_e(D(((me=e.positionInfo)==null?void 0:me.minPrice)!=="0"?("addCommom"in e?e.addCommom:J(Q))(("decimalUi"in e?e.decimalUi:J(pe))(1/e.positionInfo.minPrice,6)):0)+" ",1),i("span",null,D(e.positionInfo&&e.positionInfo.token_a&&e.positionInfo.token_a.symbol),1),_e("   ")]))])),i("div",Ot,[qt,i("div",Bt,D(e.lever),1)])]),i("div",Lt,[de(o,{"pool-info":e.positionInfo.poolInfo,"tick-list":e.tickList,"min-price":e.needReverse&&e.positionInfo.maxPrice!=="∞"?1/e.positionInfo.maxPrice:e.positionInfo.minPrice,"max-price":e.needReverse&&e.positionInfo.minPrice!=0?1/e.positionInfo.minPrice:e.positionInfo.maxPrice,direction:!e.needReverse,"current-price-tab":"custom","chart-loading":!1},null,8,["pool-info","tick-list","min-price","max-price","direction"]),Mt])])])])}const Wo=Ze($n,[["render",Ut],["__scopeId","data-v-f9690e82"]]),jt=Qe({components:{TokenWarning:ao},setup(e,n){const{t}=_o(),{$notify:a}=Vo(),q=Je(),$=_(()=>q),R=no(),v=_(()=>R),o=L({}),r=L({}),m=L({}),d=_(()=>$.value.chainName),k=_(()=>d.value?oo(d.value):{}),z=lo(),oe=L(!1),ne=async(u=null)=>{const p=u||o.value;console.log(p,"===>posInfo");const C=v.value.addressLpTokens[p.poolAddress];if(C){const w=await k.value.getTickDataByIndex(C.ticks_handle,Number(p.tick_lower_index)),j=await k.value.getTickDataByIndex(C.ticks_handle,Number(p.tick_upper_index));let E={};d.value==="Aptos"?E=await k.value.getPosRewardersAmount({poolAddress:T.currentRoute.value.query.address,positionName:T.currentRoute.value.query.token,tickLowerData:w,tickUpperData:j}):E=await k.value.fetchPosRewardersAmount({poolAddress:p.poolAddress,positionId:p.pos_object_id,coinTypeA:p.coin_type_a,coinTypeB:p.coin_type_b,rewarderInfo:p.poolInfo.rewarder_infos});const N=[];let F=new g(0);E.forEach((H,ae)=>{var P,O;const re=(P=v.value.tokensObj[H.coin_address])==null?void 0:P.decimals,be=H.amount_owed.toString();let ye=new g(be).div(Math.pow(10,re)).toString();if(d.value=="Aptos"&&Number(ye)>999999999&&(ye="0"),p.poolInfo[`rewarder_display${ae+1}`]||Number(ye)>0){const se=v.value.tokensObj[H.coin_address],ke=((O=v.value.RATES[H.coin_address])==null?void 0:O.price)||0,b=new g(ye).mul(ke).toString();F=new g(F).plus(b),N.push({...H,...se,amount:Number(ye)>0?Pe(ye,re):0,amountUSD:Number(b)>0?Pe(b,2):0,amountUSDText:b})}}),y.value=N,console.log(N,"====>result722")}};Ae(()=>[v.value.currentPositionInfo,d.value],([u,p])=>{var C;p=="Aptos"&&u?(o.value=u,r.value=u==null?void 0:u.token_a,m.value=u==null?void 0:u.token_b):p=="Sui"&&u&&(u==null?void 0:u.nftHash)==((C=z==null?void 0:z.query)==null?void 0:C.pos)&&(console.log(u,"==>newVal"),o.value=u,r.value=u==null?void 0:u.token_a,m.value=u==null?void 0:u.token_b,oe.value=!1)},{immediate:!0}),Ae(()=>[o.value,v.value.addressLpTokens],([u,p])=>{!he(u)&&!he(p)&&ne(u)},{immediate:!0});const ce=_(()=>{var u,p,C,w,j,E,N,F;if(o.value&&!he(o.value)&&v.value.RATES){const H=o.value.amountA*((p=v.value.RATES[(u=o.value)==null?void 0:u.token_a.address])==null?void 0:p.price),ae=o.value.amountB*((w=v.value.RATES[(C=o.value)==null?void 0:C.token_b.address])==null?void 0:w.price);if((E=v.value.RATES[(j=o.value)==null?void 0:j.token_a.address])!=null&&E.price&&((F=v.value.RATES[(N=o.value)==null?void 0:N.token_b.address])!=null&&F.price)){const re=Number(H+ae);return re>0&&re<.01?"<0.01":Q(Ue(H+ae,2),2)}else return" --"}else return" --"}),f=_(()=>{var u,p,C,w;return console.log((p=(u=o.value)==null?void 0:u.poolInfo)==null?void 0:p.needReverse,"===>positionInfo.value?.poolInfo?.needReverse"),(w=(C=o.value)==null?void 0:C.poolInfo)==null?void 0:w.needReverse}),c=_(()=>v.value.RATES),h=_(()=>{var u,p;if(c.value&&r.value&&m.value&&!he(c.value)&&!he(r.value)&&!he(m.value)){const C=[],w=Number(o.value.feeOwedA)||0,j=Number(o.value.feeOwedB)||0;console.log(w,j,"===292"),console.log(c.value,r.value.address,"===293"),console.log(c.value[r.value.address],"===>RATES.value[fromCoin.value.address]"),console.log(c.value[m.value.address],"===>RATES.value[toCoin.value.address]");const E=new g(w).mul(((u=c.value[r.value.address])==null?void 0:u.price)||0),N=new g(j).mul(((p=c.value[m.value.address])==null?void 0:p.price)||0);return console.log(E.toString(),N.toString(),"====>292"),C.push({amount:w,amountUSD:E.toString()},{amount:j,amountUSD:N.toString()}),C}return[]}),s=_(()=>{var p,C;let u=new g(0);return(p=h.value)==null||p.forEach(w=>{u=u.add(new g(w.amountUSD))}),d.value=="Sui"&&((C=y.value)==null||C.forEach(w=>{u=u.add(new g(w.amountUSDText))})),console.log(h.value,y.value,"===>pendingRewarderArr.value"),u.toNumber()}),A=_(()=>{var p;let u=new g(0);return(p=y.value)==null||p.forEach(C=>{u=u.add(new g(C.amountUSDText))}),u.toNumber()}),T=uo(),y=L([]),{setIsShowSuccess:l,setIsShowRejected:V,setIsShowWaiting:G,setTransactionDesc:ue,setTransactionTxid:x}=q,B=so(),W=_(()=>B),Y=async()=>{oe.value=!0;let u={coinTypeA:o.value.poolInfo.coinTypeA,coinTypeB:o.value.poolInfo.coinTypeB,coinTypeC:"",coinTypeD:"",coinTypeE:"",pool_address:o.value.poolAddress,pos_index:o.value.index,rewarder_nums:y.value.length,collect_fee:!0};u.coinTypeC=y.value[0]?y.value[0].coin_address:"",u.coinTypeD=y.value[1]?y.value[1].coin_address:"",u.coinTypeE=y.value[2]?y.value[2].coin_address:"",G(!0),ue();try{let p;if(d.value==="Aptos"){const C=await k.value.getCollectRewarderTransactionPayload(u);p=await W.value.currentWallet.signAndSubmitTransaction(C)}else{u.pos_index=o.value.pos_object_id;const C=await k.value.getCollectRewarderTransactionPayload(u),w=await W.value.currentWallet.signAndExecuteTransactionBlock(C);p=k.value.handleTx(w)}if(p&&p.hash){x(p.hash),G(!1),l(!0);const C={title:"Claim",desc:"",hash:p.hash,tit:"Rewards Claimed",icon:"icon-icon-Removed"};d.value!=="Aptos"&&(C.res=p.res),k.value.showTransitionPending(C);const w=await k.value.watchTransaction(C);console.log("0310###toClaimRewards###transitionStatus###",w),w&&n.emit("getDetails")}else console.log("0310###toClaimRewards###else###"),G(!1),V(!0),oe.value=!1}catch(p){G(!1),V(!0),oe.value=!1,console.log(p,"error===>")}},ee=L(!1),le=async()=>{console.log("0310###toClaimRewards##start###",o.value),ee.value=!0;const u=y.value;let p={coinTypeA:o.value.poolInfo.coinTypeA,coinTypeB:o.value.poolInfo.coinTypeB,coinTypeC:"",coinTypeD:"",coinTypeE:"",pool_address:o.value.poolAddress,pos_index:o.value.index,rewarder_nums:u.length};p.coinTypeC=u[0]?u[0].coin_address:"",p.coinTypeD=u[1]?u[1].coin_address:"",p.coinTypeE=u[2]?u[2].coin_address:"",console.log(p,"===>collectRewarderParams");try{let C;if(d.value==="Aptos"){const w=await k.value.getCollectRewarderTransactionPayload(p);C=await W.value.currentWallet.signAndSubmitTransaction(w)}else{p.pos_index=o.value.pos_object_id;const w=await k.value.getCollectRewarderTransactionPayload(p),j=await W.value.currentWallet.signAndExecuteTransactionBlock(w);C=k.value.handleTx(j)}if(console.log("0310###toClaimRewards##tx###",C),C&&C.hash){x(C.hash),G(!1),l(!0);const w=u[0].amount+u[0].symbol,j=p.coinTypeD?" and "+u[1].amount+u[1].symbol:"",E=p.coinTypeE?" and "+u[2].amount+u[2].symbol:"",N={title:"Claim",desc:"",hash:C.hash,tit:"Rewards Claimed",icon:"icon-icon-Removed",tokenInfo:{tokena:u[0].address,numa:`+ ${Number(u[0].amount)}`,logoa:v.value.tokensObj&&u[0]&&u[0].address&&v.value.tokensObj[u[0].address]&&v.value.tokensObj[u[0].address].logoURI,tokenb:u[1]&&u[1].address,numb:p.coinTypeD?`+ ${Number(u[1].amount)}`:"",logob:p.coinTypeD?v.value.tokensObj&&u[1]&&u[1].address&&v.value.tokensObj[u[1].address]&&v.value.tokensObj[u[1].address].logoURI:"",tokenc:u[2]&&u[2].address,numc:p.coinTypeE?`+ ${Number(u[2].amount)}`:"",logoc:p.coinTypeE?v.value.tokensObj&&u[2]&&u[2].address&&v.value.tokensObj[u[2].address]&&v.value.tokensObj[u[2].address].logoURI:""},text:w+j+E};d.value!=="Aptos"&&(N.res=C.res),k.value.showTransitionPending(N);const F=await k.value.watchTransaction(N);console.log("0310###toClaimRewards###transitionStatus###",F),F&&setTimeout(()=>{n.emit("getDetails"),k.value.getAccount(W.value.address)},3e3)}else console.log("0310###toClaimRewards###else###"),G(!1),V(!0);ee.value=!1}catch(C){console.log("0310###collectRewarderParams Error###",C),ee.value=!1,G(!1),V(!0)}},K=_(()=>v.value.positionDetailCurrentTab),ie=_(()=>{var C,w,j,E,N,F;const u=pe(f.value?(w=o.value)==null?void 0:w.amountB:(C=o.value)==null?void 0:C.amountA,f.value?(F=(N=o.value)==null?void 0:N.token_b)==null?void 0:F.decimals:(E=(j=o.value)==null?void 0:j.token_a)==null?void 0:E.decimals),p=f.value?v.value.positionActionAmount.toCoinAmount||0:v.value.positionActionAmount.fromCoinAmount||0;if(K.value=="increase")return p?new g(u).add(new g(p)).toString():"";if(p){const H=new g(u).minus(new g(p)).toString();return H<0?"0":String(H)}else return""}),Z=_(()=>{var C,w,j,E,N,F;const u=pe(f.value?(w=o.value)==null?void 0:w.amountA:(C=o.value)==null?void 0:C.amountB,f.value?(F=(N=o.value)==null?void 0:N.token_a)==null?void 0:F.decimals:(E=(j=o.value)==null?void 0:j.token_b)==null?void 0:E.decimals),p=f.value?v.value.positionActionAmount.fromCoinAmount||0:v.value.positionActionAmount.toCoinAmount||0;if(console.log(u,p,"===>427"),K.value=="increase")return p?new g(u).add(new g(p)).toString():"";if(p){const H=new g(u).minus(new g(p)).toString();return H<0?"0":String(H)}else return""}),ge=_(()=>f.value?v.value.positionActionAmount.toCoinAmount:v.value.positionActionAmount.fromCoinAmount),U=_(()=>f.value?v.value.positionActionAmount.fromCoinAmount:v.value.positionActionAmount.toCoinAmount),me=u=>{var p;return(u==null?void 0:u.logoURI)||(u==null?void 0:u.logo_url)||((p=v.value.tokensObj[u==null?void 0:u.address])==null?void 0:p.logo_url)||($.value.theme==="default"?eo("/image/coins/unknown.png"):eo("/image/coins/sui-unknown.png"))},we=_(()=>{var E,N,F,H,ae,re,be,ye,P,O,se,ke;const{fromCoinAmount:u,toCoinAmount:p}=v.value.positionActionAmount,C=v.value.positionDetailCurrentTab,w=pe(f.value?(N=o.value)==null?void 0:N.amountB:(E=o.value)==null?void 0:E.amountA,f.value?(re=(ae=o.value)==null?void 0:ae.token_b)==null?void 0:re.decimals:(H=(F=o.value)==null?void 0:F.token_a)==null?void 0:H.decimals),j=pe(f.value?(ye=o.value)==null?void 0:ye.amountA:(be=o.value)==null?void 0:be.amountB,f.value?(ke=(se=o.value)==null?void 0:se.token_a)==null?void 0:ke.decimals:(O=(P=o.value)==null?void 0:P.token_b)==null?void 0:O.decimals);return console.log(w,j,u,p,"621===>"),d.value=="Sui"||C=="remove"&&d.value=="Aptos"&&u==w&&p==j});return{amountUSD:ce,needReverse:f,decimalUi:pe,pendingFees:h,positionInfo:o,pendingRewarderArr:y,pendingYieldAmount:s,toClaim:async()=>{oe.value=!0;const u=Q(o.value.feeOwedA,o.value.token_a.decimals)==0?"":`${Pe(o.value.feeOwedA,o.value.token_a.decimals)} ${o.value.token_a.symbol}`,p=Q(o.value.feeOwedB,o.value.token_b.decimals)==0?"":`${Pe(o.value.feeOwedB,o.value.token_b.decimals)} ${o.value.token_b.symbol}`;ue(t("newAdd.claimWaitingText",{from:f.value?p:u,and:Q(o.value.feeOwedA,o.value.token_a.decimals)==0||Q(o.value.feeOwedB,o.value.token_b.decimals)==0?"":"and",to:f.value?u:p})),G(!0);let C;const w={pool:o.value.poolInfo,position:o.value};try{const j=await k.value.getCollectFeeTransactionPayload(w);if(d.value==="Aptos")C=await W.value.currentWallet.signAndSubmitTransaction(j);else{const E=await W.value.currentWallet.signAndExecuteTransactionBlock(j);C=k.value.handleTx(E)}if(C){x(C.hash),G(!1),l(!0);const E={title:"Claim",desc:"",hash:C.hash,tit:"Fees Claimed",icon:"icon-icon-Removed",tokenInfo:{tokena:`${o.value.token_a.address}`,numa:Q(o.value.feeOwedA,o.value.token_a.decimals)==0?"":`${Pe(o.value.feeOwedA,o.value.token_a.decimals)}`,logoa:Q(o.value.feeOwedA,o.value.token_a.decimals)==0?"":v.value.tokensObj&&o.value&&o.value.token_a.address&&v.value.tokensObj[o.value.token_a.address]&&v.value.tokensObj[o.value.token_a.address].logoURI,tokenb:`${o.value.token_b.address}`,numb:Q(o.value.feeOwedB,o.value.token_b.decimals)==0?"":`${Pe(o.value.feeOwedB,o.value.token_b.decimals)}`,logob:Q(o.value.feeOwedB,o.value.token_b.decimals)==0?"":v.value.tokensObj&&o.value&&o.value.token_b.address&&v.value.tokensObj[o.value.token_b.address]&&v.value.tokensObj[o.value.token_b.address].logoURI},text:`Claim ${Q(o.value.feeOwedA,o.value.token_a.decimals)==0?"":`${Pe(o.value.feeOwedA,o.value.token_a.decimals)} ${o.value.token_a.symbol}`}  
              ${Q(o.value.feeOwedA,o.value.token_a.decimals)==0||Q(o.value.feeOwedB,o.value.token_b.decimals)==0?"":"and"} ${Q(o.value.feeOwedB,o.value.token_b.decimals)==0?"":`${Pe(o.value.feeOwedB,o.value.token_b.decimals)} ${o.value.token_b.symbol}`}

            `};d.value!=="Aptos"&&(E.res=C.res),k.value.showTransitionPending(E);const N=await k.value.watchTransaction(E);console.log("0310##toClaim###transitionStatus####",N),N&&setTimeout(()=>{n.emit("getDetails")},1e3)}else G(!1),V(!0),a.error({icon:Xe("svg",{class:{icon:!0},"aria-hidden":!0},[Xe("use",{"xlink:href":"#icon-a-icon-Shutdown"})]),duration:4.5,message:Xe("div",{class:"notification-title"},[Xe("span",{innerHTML:So.global.t("newAdd.claimFailed")},null)]),description:t("newAdd.somethingWrong"),class:"ant-notification-copy ant-notification-error"});oe.value=!1,console.log("claim####test###",C)}catch(j){console.log("claim###error####",j),oe.value=!1,G(!1),V(!0),a.error({icon:Xe("svg",{class:{icon:!0},"aria-hidden":!0},[Xe("use",{"xlink:href":"#icon-a-icon-Shutdown"})]),message:Xe("div",{class:"notification-title"},[Xe("span",{innerHTML:So.global.t("newAdd.claimFailed")},null)]),duration:4.5,description:t("newAdd.somethingWrong"),class:"ant-notification-copy ant-notification-error"})}},claimAll:Y,fromCoin:r,toCoin:m,showNum:Pe,claimLoading:oe,addCommom:Q,afterBase:ie,afterQuote:Z,fromCoinAmount:ge,toCoinAmount:U,checkNullObj:he,getCoinIcon:me,chainName:d,isShowAfterAmount:we,pendingRewarderAmount:A,toClaimRewards:le,rewarderLoading:ee}}});const Dt={class:"liquidity-card"},Et={class:"liquidity-title"},Ft={class:"liquidity-usd"},Wt=i("span",null,"Liquidity",-1),Ht={class:"liquidity-ratio"},Xt={class:"coin-ratio"},Gt={class:"coin-a-ratio"},zt={class:"coin-b-ratio"},Yt={class:"ratio-progress"},Jt={class:"base-quote-num"},Qt={class:"base-coin-num"},Zt=i("span",null,"Base",-1),Kt={alt:""},Vt={key:0,class:"after"},xt={class:"quote-coin-num"},ei=i("span",null,"Quote",-1),oi={alt:""},ni={key:0,class:"after"},ti={class:"pending-yield"},ii={class:"left"},ai={class:"pending-yield-title"},si={key:0,class:"after"},li={class:"right"},ui={class:"fees-rewards"},ri={class:"fees-rewards-item"},di=i("span",null,"Fees",-1),ci={key:0,class:"after"},vi=i("span",null,"Fees",-1),mi={key:0,class:"after"},fi=i("span",null,"Bonus",-1),pi={alt:""},hi={key:0,class:"after"},gi={key:0,class:"pending-yield"},bi={class:"left"},ki=i("div",{class:"pending-yield-title"},"Pending rewards",-1),wi={key:0,class:"after"},yi={class:"right"},Ai={key:1,class:"fees-rewards"},_i={class:"fees-rewards-item"},Ci=i("span",null,"Bonus",-1),Ii={alt:""},Si={key:0,class:"after"};function $i(e,n,t,a,q,$){var r,m,d,k,z,oe,ne,ce,f,c,h,s,A,T,y,l,V,G,ue,x,B,W,Y,ee,le,K,ie,Z,ge,U,me,we,Ee,u,p,C,w,j,E,N,F,H,ae,re,be,ye,P,O,se,ke,b,X,I,te,ve,Se,Ne,Ce,Te,Be,Le,We,Re,Me;const R=ao,v=ro,o=Mo("image");return S(),M("div",Dt,[i("div",Et,[i("div",Ft,[Wt,i("div",null,"$"+D(e.amountUSD),1)]),i("div",Ht,[i("div",Xt,[i("div",Gt,[i("span",null,D(e.needReverse?(m=e.toCoin)==null?void 0:m.symbol:(r=e.fromCoin)==null?void 0:r.symbol),1),_e(" "+D(e.needReverse?(k=e.positionInfo)==null?void 0:k.toPercent:(d=e.positionInfo)==null?void 0:d.fromPercent)+"% ",1)]),i("div",zt,[i("span",null,D(e.needReverse?(oe=e.fromCoin)==null?void 0:oe.symbol:(z=e.toCoin)==null?void 0:z.symbol),1),_e(" "+D(e.needReverse?(ce=e.positionInfo)==null?void 0:ce.fromPercent:(ne=e.positionInfo)==null?void 0:ne.toPercent)+"% ",1)])]),i("div",Yt,[i("div",{class:"from-percent",style:$o({width:e.needReverse?((c=e.positionInfo)==null?void 0:c.toPercent)+"%":((f=e.positionInfo)==null?void 0:f.fromPercent)+"%"})},null,4),i("div",{class:"to-percent",style:$o({width:e.needReverse?((s=e.positionInfo)==null?void 0:s.fromPercent)+"%":((h=e.positionInfo)==null?void 0:h.toPercent)+"%"})},null,4)])])]),i("div",Jt,[i("div",Qt,[Zt,i("div",null,[qe(i("img",Kt,null,512),[[o,(e.needReverse?(T=e.toCoin)==null?void 0:T.logo_url:(A=e.fromCoin)==null?void 0:A.logo_url)||e.getCoinIcon(e.needReverse?(l=e.positionInfo)==null?void 0:l.token_b:(y=e.positionInfo)==null?void 0:y.token_a)]]),de(R,{address:e.needReverse?(x=(ue=e.positionInfo)==null?void 0:ue.token_b)==null?void 0:x.address:(G=(V=e.positionInfo)==null?void 0:V.token_a)==null?void 0:G.address,"style-params":{width:"10px",height:"10px",left:"15px",bottom:"8px"}},null,8,["address"]),i("span",null,D(("addCommom"in e?e.addCommom:J(Q))(("decimalUi"in e?e.decimalUi:J(pe))(e.needReverse?(W=e.positionInfo)==null?void 0:W.amountB:(B=e.positionInfo)==null?void 0:B.amountA,e.needReverse?(K=(le=e.positionInfo)==null?void 0:le.token_b)==null?void 0:K.decimals:(ee=(Y=e.positionInfo)==null?void 0:Y.token_a)==null?void 0:ee.decimals))),1)]),e.afterBase&&!("checkNullObj"in e?e.checkNullObj:J(he))(e.positionInfo)?(S(),M("div",Vt,D(("addCommom"in e?e.addCommom:J(Q))(e.afterBase))+" after ",1)):fe("",!0)]),i("div",xt,[ei,i("div",null,[qe(i("img",oi,null,512),[[o,(e.needReverse?(Z=e.fromCoin)==null?void 0:Z.logo_url:(ie=e.toCoin)==null?void 0:ie.logo_url)||e.getCoinIcon(e.needReverse?(U=e.positionInfo)==null?void 0:U.token_a:(ge=e.positionInfo)==null?void 0:ge.token_b)]]),de(R,{address:e.needReverse?(u=(Ee=e.positionInfo)==null?void 0:Ee.token_a)==null?void 0:u.address:(we=(me=e.positionInfo)==null?void 0:me.token_b)==null?void 0:we.address,"style-params":{width:"10px",height:"10px",left:"15px",bottom:"8px"}},null,8,["address"]),i("span",null,D(("addCommom"in e?e.addCommom:J(Q))(("decimalUi"in e?e.decimalUi:J(pe))(e.needReverse?(C=e.positionInfo)==null?void 0:C.amountA:(p=e.positionInfo)==null?void 0:p.amountB,e.needReverse?(N=(E=e.positionInfo)==null?void 0:E.token_a)==null?void 0:N.decimals:(j=(w=e.positionInfo)==null?void 0:w.token_b)==null?void 0:j.decimals))),1)]),e.afterQuote&&!("checkNullObj"in e?e.checkNullObj:J(he))(e.positionInfo)?(S(),M("div",ni,D(("addCommom"in e?e.addCommom:J(Q))(e.afterQuote))+" after ",1)):fe("",!0)])]),i("div",ti,[i("div",ii,[i("div",ai,D(e.chainName=="Sui"?"Pending Yield":"Pending fees"),1),i("div",null,[_e(" $"+D(e.pendingYieldAmount>0&&e.pendingYieldAmount<.01?"<0.01":("addCommom"in e?e.addCommom:J(Q))(e.pendingYieldAmount,2))+" ",1),e.pendingYieldAmount>0?(S(),M("span",si,"$0 after")):fe("",!0)])]),i("div",li,[de(v,{class:"claim-all",loading:e.claimLoading,disabled:e.claimLoading||e.pendingYieldAmount==0,onClick:n[0]||(n[0]=Ie=>e.chainName=="Sui"?e.claimAll():e.toClaim())},{default:Ye(()=>[_e("Claim")]),_:1},8,["loading","disabled"])])]),i("div",ui,[i("div",ri,[i("div",null,[di,i("div",null,[qe(i("img",null,null,512),[[o,(e.needReverse?(H=e.toCoin)==null?void 0:H.logo_url:(F=e.fromCoin)==null?void 0:F.logo_url)||e.getCoinIcon(e.needReverse?(re=e.positionInfo)==null?void 0:re.token_b:(ae=e.positionInfo)==null?void 0:ae.token_a)]]),de(R,{address:e.needReverse?(O=(P=e.positionInfo)==null?void 0:P.token_b)==null?void 0:O.address:(ye=(be=e.positionInfo)==null?void 0:be.token_a)==null?void 0:ye.address,"style-params":{width:"10px",height:"10px",left:"15px",bottom:"8px"}},null,8,["address"]),i("span",null,D(e.needReverse?("showNum"in e?e.showNum:J(Pe))(e.positionInfo.feeOwedB,(X=(b=e.positionInfo)==null?void 0:b.token_b)==null?void 0:X.decimals):("showNum"in e?e.showNum:J(Pe))(e.positionInfo.feeOwedA,(ke=(se=e.positionInfo)==null?void 0:se.token_a)==null?void 0:ke.decimals)),1)]),(e.fromCoinAmount||e.toCoinAmount)&&!("checkNullObj"in e?e.checkNullObj:J(he))(e.positionInfo)&&e.isShowAfterAmount?(S(),M("div",ci," 0 after ")):fe("",!0)]),i("div",null,[vi,i("div",null,[qe(i("img",null,null,512),[[o,(e.needReverse?(te=e.fromCoin)==null?void 0:te.logo_url:(I=e.toCoin)==null?void 0:I.logo_url)||e.getCoinIcon(e.needReverse?(Se=e.positionInfo)==null?void 0:Se.token_a:(ve=e.positionInfo)==null?void 0:ve.token_b)]]),de(R,{address:e.needReverse?(Be=(Te=e.positionInfo)==null?void 0:Te.token_a)==null?void 0:Be.address:(Ce=(Ne=e.positionInfo)==null?void 0:Ne.token_b)==null?void 0:Ce.address,"style-params":{width:"10px",height:"10px",left:"15px",bottom:"8px"}},null,8,["address"]),i("span",null,D(e.needReverse?("showNum"in e?e.showNum:J(Pe))(e.positionInfo.feeOwedA,(Me=(Re=e.positionInfo)==null?void 0:Re.token_a)==null?void 0:Me.decimals):("showNum"in e?e.showNum:J(Pe))(e.positionInfo.feeOwedB,(We=(Le=e.positionInfo)==null?void 0:Le.token_b)==null?void 0:We.decimals)),1)]),(e.fromCoinAmount||e.toCoinAmount)&&!("checkNullObj"in e?e.checkNullObj:J(he))(e.positionInfo)&&e.isShowAfterAmount?(S(),M("div",mi," 0 after ")):fe("",!0)]),e.chainName=="Sui"?(S(!0),M(po,{key:0},ho(e.pendingRewarderArr,Ie=>(S(),M("div",{key:Ie},[fi,i("div",null,[qe(i("img",pi,null,512),[[o,Ie.logo_url]]),de(R,{address:Ie.address,"style-params":{width:"10px",height:"10px",left:"15px",bottom:"8px"}},null,8,["address"]),i("span",null,D(Ie.amount),1)]),(e.fromCoinAmount||e.toCoinAmount)&&!("checkNullObj"in e?e.checkNullObj:J(he))(e.positionInfo)&&e.isShowAfterAmount?(S(),M("div",hi," 0 after ")):fe("",!0)]))),128)):fe("",!0)])]),e.chainName=="Aptos"&&e.pendingRewarderAmount>0?(S(),M("div",gi,[i("div",bi,[ki,i("div",null,[_e(" $"+D(e.pendingRewarderAmount>0&&e.pendingRewarderAmount<.01?"<0.01":("addCommom"in e?e.addCommom:J(Q))(e.pendingRewarderAmount,2))+" ",1),e.pendingRewarderAmount>0?(S(),M("span",wi,"$0 after")):fe("",!0)])]),i("div",yi,[de(v,{class:"claim-all",loading:e.rewarderLoading,disabled:e.rewarderLoading||e.pendingRewarderAmount==0,onClick:e.toClaimRewards},{default:Ye(()=>[_e("Claim")]),_:1},8,["loading","disabled","onClick"])])])):fe("",!0),e.chainName=="Aptos"&&e.pendingRewarderAmount>0?(S(),M("div",Ai,[i("div",_i,[(S(!0),M(po,null,ho(e.pendingRewarderArr,Ie=>(S(),M("div",{key:Ie},[Ci,i("div",null,[qe(i("img",Ii,null,512),[[o,Ie.logo_url]]),de(R,{address:Ie.address,"style-params":{width:"10px",height:"10px",left:"15px",bottom:"8px"}},null,8,["address"]),i("span",null,D(Ie.amount),1)]),(e.fromCoinAmount||e.toCoinAmount)&&!("checkNullObj"in e?e.checkNullObj:J(he))(e.positionInfo)&&e.isShowAfterAmount?(S(),M("div",Si," 0 after ")):fe("",!0)]))),128))])])):fe("",!0)])}const Ho=Ze(jt,[["render",$i]]),Ti=Qe({components:{AssetsCard:co},setup(e,n){const t=L(""),a=L(""),q=Je(),$=_(()=>q),R=_(()=>$.value.theme),v=no(),o=_(()=>v),r=L(!1),m=L(!1),d=L(!0),k=_(()=>$.value.chainName),z=_(()=>k.value?oo(k.value):{}),oe=so(),ne=_(()=>oe),ce=_(()=>$.value.slippage),f=L(),c=L(),h=_(()=>ne.value.assets&&f.value&&ne.value.assets[f.value.address]?Co(ne.value.assets[f.value.address].balance,f.value.decimals):0),s=_(()=>ne.value.assets&&c.value&&ne.value.assets[c.value.address]?Co(ne.value.assets[c.value.address].balance,c.value.decimals):0),A=w=>{w==="fromCoin"?(d.value=!0,k.value==="Aptos"?t.value=h.value>0?f.value.symbol=="APT"?new g(Number(h.value)).sub(new g(.1)).lt(new g(0))?"0":new g(Number(h.value)).sub(new g(.1)).toString():String(h.value):"":t.value=h.value>0?f.value.symbol=="SUI"?new g(Number(h.value)).sub(new g(.05)).lt(new g(0))?"0":new g(Number(h.value)).sub(new g(.05)).toString():String(h.value):""):(d.value=!1,k.value==="Aptos"?a.value=s.value>0?c.value.symbol=="APT"?new g(Number(s.value)).sub(new g(.1)).lt(new g(0))?"0":new g(Number(s.value)).sub(new g(.1)).toString():String(s.value):"":a.value=s.value>0?c.value.symbol=="SUI"?new g(Number(s.value)).sub(new g(.05)).lt(new g(0))?"0":new g(Number(s.value)).sub(new g(.05)).toString():String(s.value):"")},T=w=>{w==="fromCoin"?(d.value=!0,t.value=Ue(new g(Number(h.value)).div(2).toString(),f.value.decimals).toString()):(d.value=!1,a.value=Ue(new g(Number(s.value)).div(2).toString(),c.value.decimals).toString())},y=L({}),l=L(!0),V=L({}),G=L(),ue=L(),x=()=>{var O;if(!y.value||!t.value&&!a.value)return;const{TickMath:w,TickUtil:j}=z.value;console.log(t.value,a.value,"====>369"),console.log(y.value,"===>positionInfo.value339");let E=y.value.minPrice,N=y.value.maxPrice.indexOf("+")>0?"∞":y.value.maxPrice;console.log(y.value,"positionInfo.value====>");let F=Number(y.value.tick_lower_index),H=Number(y.value.tick_upper_index);const ae=Number(y.value.current_tick_index);let re,be,ye=Number(E).toString(),P=y.value.maxPrice.indexOf("+")>0||y.value.maxPrice==="∞"?"∞":Number(N);if(ye=="0"&&P=="∞"?(F=Number(y.value.tick_lower_index),H=Number(y.value.tick_upper_index)):(re=w.priceToSqrtPriceX64(new g(E),f.value.decimals,c.value.decimals),be=w.priceToSqrtPriceX64(new g(N),f.value.decimals,c.value.decimals)),G.value=F,ue.value=H,console.log(F,H,"tick_lowertick_lower"),N!=="∞"&&F>=H){r.value=!0,t.value="",m.value=!0,a.value="";return}if(N=="∞"||ae>=F&&ae<=H){console.log("0413###increase###11111"),r.value=!1,m.value=!1;let se;if(t.value||a.value){if(d.value){const ve=new g(t.value).mul(Math.pow(10,f.value.decimals)).toString();se=new Oe(ve)}else{const ve=new g(a.value).mul(Math.pow(10,c.value.decimals)).toString();se=new Oe(ve)}const{liquidityAmount:ke,tokenMaxA:b,tokenMaxB:X,tokenMaxAOrigin:I,tokenMaxBOrigin:te}=z.value.estLiquidityAndcoinAmountFromOneAmounts({tokenA:f.value,tokenB:c.value,lowerTick:F,upperTick:H,coinAmount:se,iscoinA:l.value?d.value:!d.value,roundUp:!0,slippage:Number(ce.value)/100,curSqrtPrice:new Oe(y.value.current_sqrt_price)});V.value={liquidityAmount:ke,tokenMaxA:b,tokenMaxB:X,tokenMaxAOrigin:I,tokenMaxBOrigin:te},l.value?d.value?a.value=Number(X)>0?X:"":t.value=Number(b)>0?b:"":d.value?a.value=b:t.value=X}}else if(ae>H){if(console.log("0413###increase###22222"),t.value="",r.value=!0,m.value=!1,t.value||a.value){let se;const ke=new g(a.value).mul(Math.pow(10,(O=c.value)==null?void 0:O.decimals)).toString();se=new Oe(ke),V.value={liquidityAmount:Oo(re,be,se),tokenMaxA:0,tokenMaxB:a.value}}}else if(ae<F){if(console.log("0413###increase###33333"),r.value=!1,m.value=!0,a.value="",t.value||a.value){let se;const ke=new g(t.value).mul(Math.pow(10,f.value.decimals)).toString();se=new Oe(ke),V.value={liquidityAmount:qo(re,be,se),tokenMaxA:t.value,tokenMaxB:0}}}else console.log("0413###increase###4444"),r.value=!0,t.value="",m.value=!0,a.value="";v.setPositionActionAmount({fromCoinAmount:t,toCoinAmount:a}),console.log(V.value.liquidityAmount,"====>liquidityInput.value.liquidityAmount")};Ae(()=>o.value.currentPositionInfo,w=>{if(w&&!he(w)){y.value=w,console.log(w,"newVal===>"),f.value=y.value.token_a,c.value=y.value.token_b;let j=Number(y.value.tick_lower_index),E=Number(y.value.tick_upper_index);const N=Number(y.value.current_tick_index);(w.maxPrice.indexOf("+")>0||w.maxPrice==="∞"?"∞":w.maxPrice)=="∞"||N>=j&&N<=E?(r.value=!1,m.value=!1):N>E?(t.value="",r.value=!0,m.value=!1):N<j?(r.value=!1,m.value=!0,a.value=""):(r.value=!0,t.value="",m.value=!0,a.value=""),x()}},{immediate:!0}),Ae(t,(w,j)=>{w&&x(),w==""&&(a.value="")}),Ae(a,(w,j)=>{w&&x(),w==""&&(t.value="")});const B=_(()=>{var w,j,E,N;return console.log((j=(w=y.value)==null?void 0:w.poolInfo)==null?void 0:j.needReverse,"===>positionInfo.value?.poolInfo?.needReverse"),(N=(E=y.value)==null?void 0:E.poolInfo)==null?void 0:N.needReverse}),W=_(()=>o.value.RATES),Y=_(()=>{var H,ae,re,be;const w=((ae=W.value[(H=f.value)==null?void 0:H.address])==null?void 0:ae.price)||0,j=((be=W.value[(re=c.value)==null?void 0:re.address])==null?void 0:be.price)||0,E=new g(w).mul(new g(t.value||0)),N=new g(j).mul(new g(a.value||0)),F=E.add(N);return console.log(w,j,E.toString(),N.toString(),"====>amount"),F.toNumber()?F.toNumber()>0&&F.toNumber()>.01?Q(F.toString(),2):"<0.01":"--"}),ee=L(!1),{t:le,locale:K}=_o(),ie=_(()=>{const w=Number(t.value)>Number(h.value),j=Number(a.value)>Number(s.value);return!t.value&&!a.value?le("button.enterAmount"):w?le("button.insufficientBalance",{name:f.value.symbol}):j?le("button.insufficientBalance",{name:c.value.symbol}):le("newAdd.addMore")}),Z=_(()=>{const w=Number(t.value)>Number(h.value),j=Number(a.value)>Number(s.value);return!!(!t.value&&!a.value||w||j)}),{setIsShowSuccess:ge,setIsShowRejected:U,setIsShowWaiting:me,setTransactionDesc:we,setTransactionTxid:Ee,setPositiomNum:u}=q,p=L(!1);return{theme:R,showFromCoinLock:r,showToCoinLock:m,toCoinAmount:a,fromCoinAmount:t,fromCoinBlance:h,toCoinBlance:s,fromCoin:f,toCoin:c,maxBtnSelect:A,halfBtnSelect:T,fixedFromCoin:d,needReverse:B,totalAmount:Y,wallet:ne,addLiquidityBtnText:ie,isShowLiquidityModal:ee,indexStore:q,positionInfo:y,actionLoading:p,toAdd:async()=>{var H,ae,re,be,ye,P,O,se,ke,b;ee.value=!1,p.value=!0,Ee("");const w=r.value?"":`${t.value} ${(H=f.value)==null?void 0:H.symbol}`,j=m.value?"":`${a.value} ${(ae=c.value)==null?void 0:ae.symbol}`;we(le("tips.increaseLiquiditySuccess",{from:B.value?j:w,and:!r.value&&!m.value?"and":"",to:B.value?w:j})),me(!0);const E=d.value;console.log(E,"===>fix_amount_a"),console.log(G.value,"tickLower.value===>"),console.log(ue.value,"tickUpper.value,===>"),console.log("0222###increase###positionInfo###",y);const N=y.value.poolInfo.rewarder_infos;let F={};F.coinTypeC=N[0]?N[0].coinAddress:"",F.coinTypeD=N[1]?N[1].coinAddress:"",F.coinTypeE=N[2]?N[2].coinAddress:"";try{const X=await z.value.getAddLiquidityTransactionPayload({pool:{poolAddress:y.value.poolAddress,token_a:y.value.token_a,token_b:y.value.token_b},amount:E?V.value.tokenMaxA:V.value.tokenMaxB,fix_amount_a:E,tick_lower:G.value,tick_upper:ue.value,index:k.value==="Aptos"?y.value.index:y.value.pos_object_id,slippage:Number(ce.value)/100,roundUp:!0,collect_fee:!0,...F,curSqrtPrice:new Oe(y==null?void 0:y.value.poolInfo.current_sqrt_price)});console.log(X,"===>payloadAdd11111");let I;if(k.value==="Aptos")I=await ne.value.currentWallet.signAndSubmitTransaction(X);else{const te=await ne.value.currentWallet.signAndExecuteTransactionBlock(X);I=z.value.handleTx(te)}if(console.log("toAdd###tx###",I),I&&I.hash){Ee(I.hash),me(!1),ge(!0),console.log(y,"===>positionInfo");const te={title:"Supplied",desc:le("tips.addLiquiditySuccessText",{from:r.value?"":`${t.value} ${(re=f.value)==null?void 0:re.symbol}`,and:!r.value&&!m.value?"and":"",to:m.value?"":`${a.value} ${(be=c.value)==null?void 0:be.symbol}`}),hash:I.hash,tit:"Liquidity Increased",icon:"icon-icon-Increased",tokenInfo:{tokena:B.value?`${(P=c.value)==null?void 0:P.address}`:`${(ye=f.value)==null?void 0:ye.address}`,numa:B.value?`- ${a.value}`:`- ${t.value}`,logoa:B.value?o.value.tokensObj&&c.value&&c.value.address&&o.value.tokensObj[c.value.address]&&o.value.tokensObj[c.value.address].logoURI:o.value.tokensObj&&f.value&&f.value.address&&o.value.tokensObj[f.value.address]&&o.value.tokensObj[f.value.address].logoURI,tokenb:B.value?`${(se=f.value)==null?void 0:se.address}`:`${(O=c.value)==null?void 0:O.address}`,numb:B.value?`- ${t.value}`:`- ${a.value}`,logob:B.value?o.value.tokensObj&&f.value&&f.value.address&&o.value.tokensObj[f.value.address]&&o.value.tokensObj[f.value.address].logoURI:o.value.tokensObj&&c.value&&c.value.address&&o.value.tokensObj[c.value.address]&&o.value.tokensObj[c.value.address].logoURI},text:`Deopsit ${r.value?"":`${t.value} ${(ke=f.value)==null?void 0:ke.symbol}`} ${!r.value&&!m.value?"and":""} ${m.value?"":`${a.value} ${(b=c.value)==null?void 0:b.symbol}`}`};k.value!=="Aptos"&&(te.res=I.res),z.value.showTransitionPending(te),await z.value.watchTransaction(te)&&setTimeout(()=>{n.emit("getDetails"),z.value.getAccount(ne.value.address)},1e3),u()}else me(!1),U(!0);t.value="",a.value="",p.value=!1}catch(X){t.value="",a.value="",console.log("addError###",X),p.value=!1,me(!1),U(!0)}},addLiquidityBtnDisabled:Z,poolStore:v}}});const Pi={class:"new-position-asset"},Ni={class:"add-or-remove"},Ri={class:"liquidity-action-tab"},Oi=i("div",{class:"increase tab-active"}," Increase ",-1),qi={class:"card-item"},Bi={class:"card-item"},Li={key:0,class:"add",src:un},Mi={key:1,class:"add",src:rn},Ui={class:"total-amount"},ji=i("span",null,"Total Amount",-1);function Di(e,n,t,a,q,$){var m;const R=co,v=sn,o=ro,r=ln;return S(),M("div",Pi,[i("div",Ni,[i("div",Ri,[Oi,i("div",{class:"remove",onClick:n[0]||(n[0]=d=>e.poolStore.setPositionDetailCurrentTab("remove"))}," Remove ")]),i("div",{class:go(e.needReverse?"card-container reverse":"card-container")},[i("div",qi,[de(R,{modelValue:e.fromCoinAmount,"onUpdate:modelValue":n[1]||(n[1]=d=>e.fromCoinAmount=d),"input-value":e.fromCoinAmount,"coin-symbol":e.fromCoin?e.fromCoin.symbol:null,"coin-name":e.fromCoin?e.fromCoin.name:null,balance:e.fromCoinBlance,"coin-icon":e.fromCoin?e.fromCoin.logoURI:"",address:e.fromCoin?e.fromCoin.address:"","swap-direct":"From","import-page":"deposit","has-arrow":!1,onOnMax:n[2]||(n[2]=d=>e.maxBtnSelect("fromCoin")),onOnHalf:n[3]||(n[3]=d=>e.halfBtnSelect("fromCoin")),onOnInput:n[4]||(n[4]=d=>{e.fromCoinAmount=d}),onOnFocus:n[5]||(n[5]=()=>{e.fixedFromCoin=!0})},null,8,["modelValue","input-value","coin-symbol","coin-name","balance","coin-icon","address"]),e.showFromCoinLock?(S(),je(v,{key:0,"from-coin":e.fromCoin,"to-coin":e.toCoin},null,8,["from-coin","to-coin"])):fe("",!0)]),i("div",Bi,[de(R,{modelValue:e.toCoinAmount,"onUpdate:modelValue":n[6]||(n[6]=d=>e.toCoinAmount=d),"input-value":e.toCoinAmount,"coin-symbol":e.toCoin?e.toCoin.symbol:null,"coin-name":e.toCoin?e.toCoin.name:null,balance:e.toCoinBlance,"swap-direct":"To","coin-icon":e.toCoin?e.toCoin.logoURI:"",address:e.toCoin?e.toCoin.address:"","import-page":"deposit","has-arrow":!1,onOnMax:n[7]||(n[7]=d=>e.maxBtnSelect("toCoin")),onOnHalf:n[8]||(n[8]=d=>e.halfBtnSelect("toCoin")),onOnInput:n[9]||(n[9]=d=>{e.toCoinAmount=d}),onOnFocus:n[10]||(n[10]=()=>{e.fixedFromCoin=!1})},null,8,["modelValue","input-value","coin-symbol","coin-name","balance","coin-icon","address"]),e.showToCoinLock?(S(),je(v,{key:0,"from-coin":e.fromCoin,"to-coin":e.toCoin},null,8,["from-coin","to-coin"])):fe("",!0)]),e.fromCoin&&e.toCoin&&!e.showToCoinLock&&!e.showFromCoinLock&&e.theme=="default"?(S(),M("img",Li)):fe("",!0),e.fromCoin&&e.toCoin&&!e.showToCoinLock&&!e.showFromCoinLock&&e.theme!=="default"?(S(),M("img",Mi)):fe("",!0)],2),i("div",Ui,[ji,i("span",null,"$"+D(e.totalAmount),1)])]),e.wallet.connected?(S(),je(o,{key:0,class:"big-btn liquidity-btn",disabled:e.addLiquidityBtnDisabled,loading:e.actionLoading,onClick:n[11]||(n[11]=d=>e.isShowLiquidityModal=!0)},{default:Ye(()=>[i("span",null,D(e.addLiquidityBtnText),1)]),_:1},8,["disabled","loading"])):(S(),je(o,{key:1,class:"big-btn",onClick:n[12]||(n[12]=d=>e.wallet.connected?e.isShowLiquidityModal=!0:e.wallet.setIsShowWalletModal(!0))},{default:Ye(()=>[i("span",null,D(e.$t("button.connectWallet")),1)]),_:1})),e.isShowLiquidityModal?(S(),je(r,{key:2,title:e.$t("button.increase"),"is-increase":!0,"from-coin":e.needReverse?e.toCoin:e.fromCoin,"to-coin":e.needReverse?e.fromCoin:e.toCoin,"from-coin-amount":e.needReverse?e.toCoinAmount:e.fromCoinAmount,"to-coin-amount":e.needReverse?e.fromCoinAmount:e.toCoinAmount,"min-price":e.positionInfo.minPrice,"max-price":e.positionInfo.maxPrice,"current-price":e.positionInfo.currentPrice,"current-price-reverse":1/e.positionInfo.currentPrice,"pool-info":(m=e.positionInfo)==null?void 0:m.poolInfo,"show-from-coin-lock":e.showFromCoinLock,"show-to-coin-lock":e.showToCoinLock,"position-total-amount":e.positionInfo.totalAmountUSD,"fixed-from-coin":!0,"tick-lower":e.positionInfo.tick_lower_index,"tick-upper":e.positionInfo.tick_upper_index,"current-price-tab":"custom",onToAdd:e.toAdd,onOnClose:n[13]||(n[13]=d=>e.isShowLiquidityModal=!1)},null,8,["title","from-coin","to-coin","from-coin-amount","to-coin-amount","min-price","max-price","current-price","current-price-reverse","pool-info","show-from-coin-lock","show-to-coin-lock","position-total-amount","tick-lower","tick-upper","onToAdd"])):fe("",!0)])}const wo=Ze(Ti,[["render",Di]]),Ei=Qe({components:{AssetsCard:co},setup(e,n){const t=L(""),a=L(""),q=Je(),$=_(()=>q),R=_(()=>$.value.theme),v=no(),o=_(()=>v),r=L(!1),m=L(!1),d=L(!0),k=_(()=>$.value.chainName),z=_(()=>k.value?oo(k.value):{}),oe=so(),ne=_(()=>oe),ce=_(()=>$.value.slippage),f=L(),c=L(),h=_(()=>{var b,X;return(X=(b=l.value)==null?void 0:b.poolInfo)==null?void 0:X.needReverse}),s=_(()=>{var b;return console.log(l==null?void 0:l.value,"==>positionInfo?.value"),console.log(!h.value,"===>!needReverse.value"),pe(l==null?void 0:l.value.amountA,(b=l==null?void 0:l.value.token_a)==null?void 0:b.decimals)}),A=_(()=>{var b;return pe(l==null?void 0:l.value.amountB,(b=l==null?void 0:l.value.token_b)==null?void 0:b.decimals)}),T=b=>{b==="fromCoin"?d.value=!0:d.value=!1,Y.value=100,le({value:1})},y=b=>{b==="fromCoin"?(d.value=!0,t.value=Ue(new g(Number(s.value)).div(2).toString(),f.value.decimals).toString()):(d.value=!1,a.value=Ue(new g(Number(A.value)).div(2).toString(),c.value.decimals).toString()),B.value=!1},l=L({}),V=L(!0),G=L({}),ue=L(),x=L(),B=L(!0),W=()=>{var We;if(B.value||!l.value||!t.value&&!a.value||(console.log(t.value>s.value,Number(a.value)>Number(A.value),"==>toCoinAmount.value"),Number(t.value)>Number(s.value)||Number(a.value)>Number(A.value)))return;if(t.value==s.value&&a.value==A.value){Y.value=100,le({value:1}),B.value=!0;return}const{TickMath:b,TickUtil:X}=z.value;console.log(t.value,a.value,"====>369"),console.log(l.value,"===>positionInfo.value339");let I=l.value.minPrice,te=l.value.maxPrice.indexOf("+")>0?"∞":l.value.maxPrice;console.log(l.value,"positionInfo.value====>");let ve=Number(l.value.tick_lower_index),Se=Number(l.value.tick_upper_index);const Ne=Number(l.value.current_tick_index);let Ce,Te,Be=Number(I).toString(),Le=l.value.maxPrice.indexOf("+")>0||l.value.maxPrice==="∞"?"∞":Number(te);if(Be=="0"&&Le=="∞"?(ve=Number(l.value.tick_lower_index),Se=Number(l.value.tick_upper_index)):(Ce=b.priceToSqrtPriceX64(new g(I),f.value.decimals,c.value.decimals),Te=b.priceToSqrtPriceX64(new g(te),f.value.decimals,c.value.decimals)),ue.value=ve,x.value=Se,console.log(ve,Se,"tick_lowertick_lower"),te!=="∞"&&ve>=Se){r.value=!0,t.value="",m.value=!0,a.value="";return}if(te=="∞"||Ne>=ve&&Ne<=Se){console.log("0413###increase###11111"),console.log(t.value,"==>341"),console.log(a.value,"==>341"),r.value=!1,m.value=!1;let Re;if(t.value||a.value){if(d.value){const Ge=new g(t.value).mul(Math.pow(10,f.value.decimals)).toString();Re=new Oe(Ge)}else{const Ge=new g(a.value).mul(Math.pow(10,c.value.decimals)).toString();Re=new Oe(Ge)}const{liquidityAmount:Me,tokenMaxA:Ie,tokenMaxB:He,tokenMaxAOrigin:to,tokenMaxBOrigin:$e}=z.value.estLiquidityAndcoinAmountFromOneAmounts({tokenA:f.value,tokenB:c.value,lowerTick:ve,upperTick:Se,coinAmount:Re,iscoinA:V.value?d.value:!d.value,roundUp:k.value!="Sui",slippage:Number(ce.value)/100,curSqrtPrice:new Oe(l.value.current_sqrt_price)});G.value={liquidityAmount:Me,tokenMaxA:Ie,tokenMaxB:He,tokenMaxAOrigin:to,tokenMaxBOrigin:$e},console.log(He,Ie,"362===>"),V.value?d.value?a.value=Number(He)>0?He:"":t.value=Number(Ie)>0?Ie:"":d.value?a.value=Ie:t.value=He}}else if(Ne>Se){if(console.log("0413###increase###22222"),t.value="",r.value=!0,m.value=!1,t.value||a.value){let Re;const Me=new g(a.value).mul(Math.pow(10,(We=c.value)==null?void 0:We.decimals)).toString();Re=new Oe(Me),G.value={liquidityAmount:Oo(Ce,Te,Re),tokenMaxA:0,tokenMaxB:a.value}}}else if(Ne<ve){if(console.log("0413###increase###33333"),r.value=!1,m.value=!0,a.value="",t.value||a.value){let Re;const Me=new g(t.value).mul(Math.pow(10,f.value.decimals)).toString();Re=new Oe(Me),G.value={liquidityAmount:qo(Ce,Te,Re),tokenMaxA:t.value,tokenMaxB:0}}}else console.log("0413###increase###4444"),r.value=!0,m.value=!0;B.value=!1,Y.value=new g(G.value.liquidityAmount.toString()).div(l.value.liquidity).mul(100).toNumber().toFixed(2),ee.value=G.value.liquidityAmount,console.log(Y.value,"===>sliderVal.value"),console.log(G.value.liquidityAmount,"====>liquidityInput.value.liquidityAmount"),v.setPositionActionAmount({fromCoinAmount:t,toCoinAmount:a}),console.log(Y.value,"===>sliderVal.value")},Y=L(50),ee=L("0"),le=b=>{if(!B.value)return;B.value=!0;const X=l.value.token_a.decimals,I=l.value.token_b.decimals,te=l.value.tick_lower_index,ve=l.value.tick_upper_index,Se=Io.tickIndexToSqrtPriceX64(te),Ne=Io.tickIndexToSqrtPriceX64(ve);let Ce="";b.value!==1?Ce=new g(l.value.liquidity).mul(b.value).toString():Ce=l.value.liquidity,Ce=Ue(Ce,0)||"0",ee.value=Ce;const Te=Yo.getCoinAmountFromLiquidity(new Oe(Ce),new Oe(l.value.current_sqrt_price),Se,Ne,k.value!="Sui");console.log(Te.coinA.toString(),Te.coinB.toString(),X,I,"===>amountInfo");const Be=new g(Te.coinA.toString()).div(Math.pow(10,X)).toString(),Le=new g(Te.coinB.toString()).div(Math.pow(10,I)).toString();console.log(Be,Le,"amountA121212"),t.value=Number(Be)>0?Be:"",a.value=Number(Le)>0?Le:"",v.setPositionActionAmount({fromCoinAmount:t,toCoinAmount:a})};Ae(()=>o.value.currentPositionInfo,b=>{if(b&&!he(b)){l.value=b,console.log(b,"newVal===>"),f.value=l.value.token_a,c.value=l.value.token_b,le({value:Y.value/100});let X=Number(l.value.tick_lower_index),I=Number(l.value.tick_upper_index);const te=Number(l.value.current_tick_index);(b.maxPrice.indexOf("+")>0||b.maxPrice==="∞"?"∞":b.maxPrice)=="∞"||te>=X&&te<=I?(r.value=!1,m.value=!1):te>I?(t.value="",r.value=!0,m.value=!1):te<X?(r.value=!1,m.value=!0,a.value=""):(r.value=!0,t.value="",m.value=!0,a.value=""),W()}},{immediate:!0}),Ae(t,(b,X)=>{b&&W(),b==""&&(a.value="",Y.value=0)}),Ae(a,(b,X)=>{b&&W(),b==""&&(t.value="",Y.value=0)});const K=_(()=>o.value.RATES),ie=_(()=>{var Se,Ne,Ce,Te;const b=((Ne=K.value[(Se=f.value)==null?void 0:Se.address])==null?void 0:Ne.price)||0,X=((Te=K.value[(Ce=c.value)==null?void 0:Ce.address])==null?void 0:Te.price)||0,I=new g(b).mul(new g(t.value||0)),te=new g(X).mul(new g(a.value||0)),ve=I.add(te);return console.log(b,X,I.toString(),te.toString(),"====>amount"),Q(ve.toString(),2)}),Z=L(!1),{t:ge,locale:U}=_o(),me=_(()=>{const b=Number(t.value)>Number(s.value),X=Number(a.value)>Number(A.value);return!t.value&&!a.value?ge("button.enterAmount"):b||X?"Invalid Amount":ge("button.remove")}),we=_(()=>{const b=Number(t.value)>Number(s.value),X=Number(a.value)>Number(A.value);return!!(!t.value&&!a.value||b||X)}),{setIsShowSuccess:Ee,setIsShowRejected:u,setIsShowWaiting:p,setTransactionDesc:C,setTransactionTxid:w,setPositiomNum:j,setTransactionDescText:E}=q,N=L(!1);Ae(Y,xo((b,X)=>{b!==X&&(Number(b)>100?Y.value=100:b&&l.value?(console.log("687===>"),Y.value=b,le({value:Y.value/100})):(t.value="",a.value=""))},300)),Ae(ce,b=>{b&&l.value&&le({value:Y.value/100})});const F=[{name:"25%",value:25},{name:"50%",value:50},{name:"75%",value:75},{name:"MAX",value:100}],H=Uo(),ae=_(()=>H),re=_(()=>ae.value.status),be=L(!1),ye=b=>{const X=b.sources;X.forEach(I=>{const{pool_address:te,position_index:ve}=JSON.parse(I.blockchainAddress);console.log(te,ve,"===>pool_address, position_index"),console.log(l.value.poolAddress,l.value.index,"===>positionInfo.value.index"),te==l.value.poolAddress&&Number(ve)==Number(l.value.index)&&(be.value=!0)}),console.log(X,"===>sources")},P=async()=>{await H.getSources();let b;ae.value.allSources.forEach(X=>{const{pool_address:I,position_index:te}=JSON.parse(X.blockchainAddress);I==l.value.poolAddress&&te==l.value.index&&(b=X.id)}),console.log(b,"sourceID649==>"),H.deleteSource(b)};Ae(()=>[ae.value.sourceGroups,l.value],([b,X])=>{b&&b.sources&&b.sources.length>0&&X&&!he(X)&&ye(b)},{immediate:!0,deep:!0});const O=uo(),se=lo();return{theme:R,showFromCoinLock:r,showToCoinLock:m,toCoinAmount:a,fromCoinAmount:t,fromCoinBlance:s,toCoinBlance:A,fromCoin:f,toCoin:c,maxBtnSelect:T,halfBtnSelect:y,fixedFromCoin:d,needReverse:h,totalAmount:ie,wallet:ne,addLiquidityBtnText:me,isShowLiquidityModal:Z,indexStore:q,positionInfo:l,actionLoading:N,addLiquidityBtnDisabled:we,sliderVal:Y,ratioArr:F,setPercent:le,poolStore:v,isSlider:B,toRemove:async()=>{var ve,Se,Ne,Ce,Te,Be,Le,We,Re,Me,Ie,He,to;N.value=!0,w("");const b=Q(t.value,f.value.decimals)==0?"":`${pe(t.value,f.value.decimals)} ${f.value.symbol}`,X=Q(a.value,c.value.decimals)==0?"":`${pe(a.value,c.value.decimals)} ${c.value.symbol}`;C(ge("tips.removeLiquidiyText",{from:h.value?X:b,and:Q(t.value,f.value.decimals)==0||Q(a.value,c.value.decimals)==0?"":"and",to:h.value?b:X})),p(!0),console.log(l.value,"==>positionInfo.value");const I=l.value.poolInfo.rewarder_infos,te=I&&I.length>0&&k.value=="Sui"||I&&I.length>0&&Y.value==100?ge("modal.removeLiquidityText1"):ge("modal.removeLiquidityText2");E(te);try{let $e={};$e={pool:{...l.value.poolInfo,coinA:l.value.token_a,coinB:l.value.token_b},coinTypeA:l.value.poolInfo.coinTypeA,coinTypeB:l.value.poolInfo.coinTypeB,position:l.value,delta_liquidity:Y.value==100?new Oe(l.value.liquidity):new Oe(Ue(ee.value,0)),slippage:Number(ce.value),rewards_num:I.length},console.log(I,"===>pendingRewarderArr"),$e.coinTypeC=I[0]?I[0].coinAddress:"",$e.coinTypeD=I[1]?I[1].coinAddress:"",$e.coinTypeE=I[2]?I[2].coinAddress:"",console.log($e,"===>params");const Ge=await z.value.getRemoveLiquidityTransactionPayload($e);console.log(Ge,"===>payload");let De;if(k.value==="Aptos")De=await ne.value.currentWallet.signAndSubmitTransaction(Ge);else{const Ve=await ne.value.currentWallet.signAndExecuteTransactionBlock(Ge);De=z.value.handleTx(Ve),console.log("0331###remove###tx####",De)}if(De&&De.hash){w(De.hash),p(!1),Ee(!0);const Ve={title:ge("common.removeLiquidity"),desc:"",hash:De.hash,descTransactions:`Remove ${t.value} ${(ve=f.value)==null?void 0:ve.symbol} and ${a.value} ${(Se=c.value)==null?void 0:Se.symbol} 
             from the pool`,sender:ne.value.address,chainName:k.value,tit:"Liquidity Removed",icon:"icon-icon-Removed",tokenInfo:{tokena:h.value?`${(Ce=c.value)==null?void 0:Ce.address}`:`${(Ne=f.value)==null?void 0:Ne.address}`,numa:h.value?`+ ${a.value}`:`+ ${t.value}`,logoa:h.value?o.value.tokensObj&&c.value&&c.value.address&&o.value.tokensObj[c.value.address]&&o.value.tokensObj[c.value.address].logoURI:o.value.tokensObj&&f.value&&f.value.address&&o.value.tokensObj[f.value.address]&&o.value.tokensObj[f.value.address].logoURI,tokenb:h.value?`${(Te=f.value)==null?void 0:Te.address}`:`${(Be=c.value)==null?void 0:Be.address}`,numb:h.value?`+ ${t.value}`:`+ ${a.value}`,logob:h.value?o.value.tokensObj&&f.value&&f.value.address&&o.value.tokensObj[f.value.address]&&o.value.tokensObj[f.value.address].logoURI:o.value.tokensObj&&c.value&&c.value.address&&o.value.tokensObj[c.value.address]&&o.value.tokensObj[c.value.address].logoURI},text:`Withdraw ${t.value} ${(Le=f.value)==null?void 0:Le.symbol} and ${a.value} ${(We=c.value)==null?void 0:We.symbol}`};k.value!=="Aptos"&&(Ve.res=De.res),z.value.showTransitionPending(Ve);const io=await z.value.watchTransaction(Ve);if(I.value&&I.value.length>0&&(Number((Re=I[0])==null?void 0:Re.amount)!==0||$e.coinTypeD&&Number((Me=I[1])==null?void 0:Me.amount)!==0||$e.coinTypeE&&Number((Ie=I[2])==null?void 0:Ie.amount)!==0)){const vo={title:ge("common.removeLiquidity"),desc:"",hash:De.hash,tit:"Rewards Claimed",icon:"icon-icon-Removed",tokenInfo:{tokena:I[0].symbol,numa:`+ ${Number(I[0].amount)}`,logoa:o.value.tokensObj&&I[0]&&I[0].address&&o.value.tokensObj[I[0].address]&&o.value.tokensObj[I[0].address].logoURI,tokenb:$e.coinTypeD?I[1].symbol:"",numb:$e.coinTypeD?`+ ${Number(I[1].amount)}`:"",logob:$e.coinTypeD?o.value.tokensObj&&I[1]&&I[1].address&&o.value.tokensObj[I[1].address]&&o.value.tokensObj[I[1].address].logoURI:"",tokenc:$e.coinTypeE?I[2].symbol:"",numc:$e.coinTypeE?`+ ${Number(I[2].amount)}`:"",logoc:$e.coinTypeE?o.value.tokensObj&&I[2]&&I[2].address&&o.value.tokensObj[I[2].address]&&o.value.tokensObj[I[2].address].logoURI:""},text:`Withdraw ${t.value} ${(He=f.value)==null?void 0:He.symbol} and ${a.value} ${(to=c.value)==null?void 0:to.symbol}`},mo=await z.value.setTransations(vo);console.log("9999transitionStatusFees",io,mo)}if(Pe(l.value.feeOwedA,l.value.token_a.decimals)!==0||Pe(l.value.feeOwedB,l.value.token_b.decimals)!==0){const vo={title:"Claim",desc:"",hash:De.hash,chainName:k.value,tit:"Fees Claimed",icon:"icon-icon-Removed",tokenInfo:{tokena:`${l.value.token_a.symbol}`,numa:Q(l.value.feeOwedA,l.value.token_a.decimals)==0?"":`+ ${Pe(l.value.feeOwedA,l.value.token_a.decimals)}`,logoa:Q(l.value.feeOwedA,l.value.token_a.decimals)==0?"":o.value.tokensObj&&l.value&&l.value.token_a.address&&o.value.tokensObj[l.value.token_a.address]&&o.value.tokensObj[l.value.token_a.address].logoURI,tokenb:`${l.value.token_b.symbol}`,numb:Q(l.value.feeOwedB,l.value.token_b.decimals)==0?"":`+ ${Pe(l.value.feeOwedB,l.value.token_b.decimals)}`,logob:Q(l.value.feeOwedB,l.value.token_b.decimals)==0?"":o.value.tokensObj&&l.value&&l.value.token_b.address&&o.value.tokensObj[l.value.token_b.address]&&o.value.tokensObj[l.value.token_b.address].logoURI}},mo=await z.value.setTransations(vo);console.log("9999transitionStatusFees",io,mo)}io&&Number(Y.value)==100&&re.value=="authenticated"&&be.value&&(await H.subscribePosition({pool_address:l.value.poolAddress,position_index:l.value.index},l.value.nftHash,!1),P()),io&&(t.value="",a.value="",setTimeout(()=>{n.emit("getDetails")},3e3),setTimeout(()=>{n.emit("getDetails")},6e3),console.log(Y.value,se.name,k.value,"998===>"),Number(Y.value)==100&&se.name=="new-position-detail"&&(k.value==="Aptos"?O.push("/position"):O.push("/pool/position")),Y.value=0)}else p(!1),u(!0);N.value=!1}catch($e){console.log("Remove error",$e),N.value=!1,p(!1),u(!0)}},sFixD:Ue}}});const Fi={class:"new-position-asset"},Wi={class:"add-or-remove"},Hi={class:"liquidity-action-tab"},Xi=i("div",{class:"remove tab-active"},"Remove",-1),Gi={class:"card-item"},zi={key:0,class:"assets-card-mask"},Yi={class:"card-item"},Ji={key:0,class:"assets-card-mask"},Qi={class:"remove-ratio"},Zi=i("div",{class:"remove-ratio-title"},"Amount",-1),Ki={class:"remove-ratio-select"},Vi={key:0,class:"ratio"},xi={key:1,class:"ratio"},ea={class:"ratio-list"},oa=["onClick"];function na(e,n,t,a,q,$){const R=co,v=en,o=ro;return S(),M("div",Fi,[i("div",Wi,[i("div",Hi,[i("div",{class:"increase",onClick:n[0]||(n[0]=r=>e.poolStore.setPositionDetailCurrentTab("increase"))}," Increase "),Xi]),i("div",{class:go(e.needReverse?"card-container reverse":"card-container")},[i("div",Gi,[de(R,{modelValue:e.fromCoinAmount,"onUpdate:modelValue":n[1]||(n[1]=r=>e.fromCoinAmount=r),"input-value":e.fromCoinAmount,"coin-symbol":e.fromCoin?e.fromCoin.symbol:null,"coin-name":e.fromCoin?e.fromCoin.name:null,balance:e.fromCoinBlance,"coin-icon":e.fromCoin?e.fromCoin.logoURI:"",address:e.fromCoin?e.fromCoin.address:"","swap-direct":"From","import-page":"deposit","has-arrow":!1,havehalf:!1,"amount-leabl":"Available",onOnMax:n[2]||(n[2]=r=>e.maxBtnSelect("fromCoin")),onOnHalf:n[3]||(n[3]=r=>e.halfBtnSelect("fromCoin")),onOnInput:n[4]||(n[4]=r=>{e.fromCoinAmount=r,e.fixedFromCoin=!0,e.isSlider=!1})},null,8,["modelValue","input-value","coin-symbol","coin-name","balance","coin-icon","address"]),e.fromCoinBlance==0?(S(),M("div",zi)):fe("",!0)]),i("div",Yi,[de(R,{modelValue:e.toCoinAmount,"onUpdate:modelValue":n[5]||(n[5]=r=>e.toCoinAmount=r),"input-value":e.toCoinAmount,"coin-symbol":e.toCoin?e.toCoin.symbol:null,"coin-name":e.toCoin?e.toCoin.name:null,balance:e.toCoinBlance,"swap-direct":"To","coin-icon":e.toCoin?e.toCoin.logoURI:"",address:e.toCoin?e.toCoin.address:"","import-page":"deposit","has-arrow":!1,havehalf:!1,"amount-leabl":"Available",onOnMax:n[6]||(n[6]=r=>e.maxBtnSelect("toCoin")),onOnHalf:n[7]||(n[7]=r=>e.halfBtnSelect("toCoin")),onOnInput:n[8]||(n[8]=r=>{e.toCoinAmount=r,e.fixedFromCoin=!1,e.isSlider=!1})},null,8,["modelValue","input-value","coin-symbol","coin-name","balance","coin-icon","address"]),e.toCoinBlance==0?(S(),M("div",Ji)):fe("",!0)])],2),i("div",Qi,[Zi,i("div",Ki,[Number(e.fromCoinBlance)>=Number(e.fromCoinAmount)&&Number(e.toCoinBlance)>=Number(e.toCoinAmount)?(S(),M("div",Vi,D(e.sliderVal>0&&Number(("sFixD"in e?e.sFixD:J(Ue))(e.sliderVal,2))<.01?"<0.01":("sFixD"in e?e.sFixD:J(Ue))(e.sliderVal,2))+"% ",1)):(S(),M("div",xi," -- ")),i("div",ea,[(S(!0),M(po,null,ho(e.ratioArr,(r,m)=>(S(),M("div",{key:m,class:go(["ratio-item",e.sliderVal==r.value?"ratio-item-active":""]),onClick:()=>{e.isSlider=!0,e.sliderVal=r.value}},D(r.name),11,oa))),128))])]),de(v,{value:e.sliderVal,"onUpdate:value":n[9]||(n[9]=r=>e.sliderVal=r)},null,8,["value"])])]),e.wallet.connected?(S(),je(o,{key:0,class:"big-btn liquidity-btn",loading:e.actionLoading,disabled:e.addLiquidityBtnDisabled,onClick:e.toRemove},{default:Ye(()=>[i("span",null,D(e.addLiquidityBtnText),1)]),_:1},8,["loading","disabled","onClick"])):(S(),je(o,{key:1,class:"big-btn",onClick:n[10]||(n[10]=r=>e.wallet.connected?e.isShowLiquidityModal=!0:e.wallet.setIsShowWalletModal(!0))},{default:Ye(()=>[i("span",null,D(e.$t("button.connectWallet")),1)]),_:1}))])}const ta=Ze(Ei,[["render",na]]),ia=Qe({props:{positionInfo:{type:Object,default:()=>({})}},setup(e){const n=Uo(),t=_(()=>n),a=_(()=>t.value.status),q=Je();Ae(()=>[t.value.targetGroups],m=>{console.log("0327###watch###newTargetGoups###",m)},{immediate:!0});const $=L(!1);Ae(()=>a.value,m=>{m=="authenticated",$.value=!1},{immediate:!0});const R=L(!1),v=async()=>{R.value=!R.value,console.log(R.value,"===>checked.value");const m={pool_address:e.positionInfo.poolAddress,position_index:e.positionInfo.index},d=e.positionInfo.nftHash;console.log("0529###changeSwitch###positionInfo####",e.positionInfo);try{await n.subscribePosition(m,d,R.value)}catch{R.value=!R.value}},o=m=>{const d=m.sources;R.value=d.some(k=>JSON.parse(k.blockchainAddress).pool_address==e.positionInfo.poolAddress&&Number(JSON.parse(k.blockchainAddress).position_index)==Number(e.positionInfo.index))},r=uo();return console.log(r.currentRoute.value.query.token,"===>rouyter"),Ae(()=>[t.value.sourceGroups,e.positionInfo],([m,d])=>{var k,z,oe;console.log(m,"==>newSourceGroups169"),console.log(d,"===>positionInfo170"),R.value=!1,m&&m.length>0&&m[0]&&d&&!he(d)&&((oe=(z=(k=r==null?void 0:r.currentRoute)==null?void 0:k.value)==null?void 0:z.query)==null?void 0:oe.token)==(d==null?void 0:d.name)&&(console.log("触发"),console.log(m,"==>newSourceGroups"),console.log(d,"===>positionInfo"),o(m[0]))},{immediate:!0,deep:!0}),{importIcon:eo,isShowSetUp:$,changeSwitch:v,checked:R,notifiStatus:a,store:q}}});const aa=e=>(yo("data-v-8f838b7e"),e=e(),Ao(),e),sa={class:"range-alerts"},la={class:"range-alerts-top"},ua={class:"title"},ra=aa(()=>i("div",{class:"title-all"},[i("span",{class:"Range"},"Range Alerts")],-1)),da={key:1,class:"h5-switch-box"},ca={class:"range-alerts-bottom"},va={key:0,class:"pc-switch-box"};function ma(e,n,t,a,q,$){const R=ro,v=nn;return S(),M("div",sa,[i("div",la,[i("div",ua,[ra,e.isShowSetUp||e.notifiStatus!=="authenticated"?(S(),je(R,{key:0,class:"range-alerts-button",onClick:n[0]||(n[0]=on(o=>e.store.setIsShowNotifi(!0),["stop"]))},{default:Ye(()=>[_e(" Set up ")]),_:1})):fe("",!0),!e.isShowSetUp&&e.notifiStatus=="authenticated"?(S(),M("div",da,[de(v,{class:"range-alerts-switch",checked:e.checked,disabled:e.notifiStatus!=="authenticated",onChange:e.changeSwitch},null,8,["checked","disabled","onChange"])])):fe("",!0)])]),i("div",ca,[_e(" Receive alerts via Telegram, SMS, or email when this position goes out of range. "),!e.isShowSetUp&&e.notifiStatus=="authenticated"?(S(),M("div",va,[de(v,{class:"range-alerts-switch",checked:e.checked,disabled:e.notifiStatus!=="authenticated",onChange:e.changeSwitch},null,8,["checked","disabled","onChange"])])):fe("",!0)])])}const Xo=Ze(ia,[["render",ma],["__scopeId","data-v-8f838b7e"]]),fa=Qe({components:{NewPositionTitle:No,NewPositionInfo:Wo,NewPositionLiquidity:Ho,NewPositionAssetAdd:wo,NewPositionAssetRemove:wo,NewPositionNotifi:Xo},setup(){const e=L(),n=L(),t=L(),a=Je(),q=_(()=>a),$=_(()=>q.value.chainName),R=no(),v=_(()=>R),o=uo();Bo(()=>{e.value={},R.setPositionActionAmount({fromCoinAmount:"",toCoinAmount:""}),v.value.setCurrentPositionLoading(!0)});const r=async()=>{v.value.setCurrentPositionLoading(!0);const c=o.currentRoute.value.query.token||"",h=o.currentRoute.value.query.collect||"",s=o.currentRoute.value.query.address||"",A=o.currentRoute.value.query.pos||"",T=o.currentRoute.value.query.id||"";$.value==="Aptos"?c&&h&&s&&v.value.setCurrentPositionInfo(s,h,c,$.value):(console.log("0414###position-detail###id#####",T),console.log("0414###position-detail###name#####",c),console.log("0414###position-detail###pool_address#####",s),console.log("0414###position-detail###pos#####",A),c&&s&&A?v.value.setCurrentPositionInfo(s,h,c,$.value,A):T&&v.value.setCurrentPositionInfo("","","",$.value,T))};Ae(()=>v.value.poolConfigObj,c=>{c&&!he(c)&&r()},{immediate:!0});const m=_(()=>v.value.currentPositionLoading),d=_(()=>{var h,s,A;const c=((A=(s=(h=o==null?void 0:o.currentRoute)==null?void 0:h.value)==null?void 0:s.query)==null?void 0:A.address)||"";return c&&v.value.addressLpTokens&&!he(v.value.addressLpTokens)&&v.value.addressLpTokens[c]?v.value.addressLpTokens[c]:null});Ae(()=>d.value,(c,h)=>{c&&!he(c)&&(e.value=c),c&&!he(c)&&c.current_sqrt_price!==(h==null?void 0:h.current_sqrt_price)&&r()},{immediate:!0});const k=lo();Ae(()=>[v.value.currentPositionInfo,$.value],([c,h])=>{var s;h=="Aptos"&&c?(e.value=c,n.value=e.value.token_a,t.value=e.value.token_b):h=="Sui"&&c&&(c==null?void 0:c.nftHash)==((s=k==null?void 0:k.query)==null?void 0:s.pos)&&(console.log(c,"==>newVal"),e.value=c,n.value=e.value.token_a,t.value=e.value.token_b)},{immediate:!0});const z=_(()=>v.value.positionDetailCurrentTab),oe=so(),ne=_(()=>oe),ce=_(()=>q.value.theme);return tn(()=>{ne.value.connected||(ce.value==="default"?o.push("/position"):o.push("/pool/position"))}),console.log(JSON.stringify(e.value),"===>positionInfo.value135"),{positionInfo:e,fromCoin:n,toCoin:t,getDetails:r,currentPositionLoading:m,positionDetailCurrentTab:z,clickRefresh:()=>{r()},chainName:$}}});const pa={class:"new-position-detail"},ha={class:"new-position-content"},ga={class:"left"},ba={class:"right"},ka={class:"loading-global"};function wa(e,n,t,a,q,$){const R=No,v=Wo,o=Ho,r=wo,m=ta,d=Xo,k=an;return S(),M("div",pa,[de(R,{onClickRefresh:e.clickRefresh},null,8,["onClickRefresh"]),i("div",ha,[i("div",ga,[de(v),de(o,{class:"pc-module",onGetDetails:e.getDetails},null,8,["onGetDetails"])]),i("div",ba,[e.positionDetailCurrentTab=="increase"?(S(),je(r,{key:0,onGetDetails:e.getDetails},null,8,["onGetDetails"])):(S(),je(m,{key:1,onGetDetails:e.getDetails},null,8,["onGetDetails"])),de(o,{class:"h5-module",onGetDetails:e.getDetails},null,8,["onGetDetails"]),e.positionInfo&&e.positionInfo.minPrice!=="0"&&e.positionInfo.maxPrice!=="∞"&&e.chainName=="Sui"?(S(),je(d,{key:2,"position-info":e.positionInfo},null,8,["position-info"])):fe("",!0)])]),qe(i("div",ka,[de(k)],512),[[Lo,e.currentPositionLoading]])])}const Ya=Ze(fa,[["render",wa],["__scopeId","data-v-f85efb72"]]);export{Ya as default};
