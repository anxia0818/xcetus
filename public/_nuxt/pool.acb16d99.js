var S_=Object.defineProperty;var P_=(t,e,n)=>e in t?S_(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var Ft=(t,e,n)=>(P_(t,typeof e!="symbol"?e+"":e,n),n);import{aa as Kh,ab as B_,l as qs,a4 as Br,C as Se,a7 as oi,R as Gh,a6 as E_}from"./entry.59a2cdcc.js";import{b as C_,r as Wh,e as Zu,c as qt,d as I_,a as Al,u as Xh,n as Ln,f as Jn,T as vt,i as O_,S as R_,I as U_,s as Yu,t as $_,g as q_}from"./sha256.fbf47686.js";import{D as it}from"./decimal.0bdeb344.js";var Xi={},M_={get exports(){return Xi},set exports(t){Xi=t}};(function(t){(function(e){var n=function(w){var S,B=new Float64Array(16);if(w)for(S=0;S<w.length;S++)B[S]=w[S];return B},i=function(){throw new Error("no PRNG")},s=new Uint8Array(16),o=new Uint8Array(32);o[0]=9;var r=n(),a=n([1]),c=n([56129,1]),u=n([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),l=n([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),d=n([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),f=n([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),_=n([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function T(w,S,B,p){w[S]=B>>24&255,w[S+1]=B>>16&255,w[S+2]=B>>8&255,w[S+3]=B&255,w[S+4]=p>>24&255,w[S+5]=p>>16&255,w[S+6]=p>>8&255,w[S+7]=p&255}function v(w,S,B,p,C){var Q,Z=0;for(Q=0;Q<C;Q++)Z|=w[S+Q]^B[p+Q];return(1&Z-1>>>8)-1}function k(w,S,B,p){return v(w,S,B,p,16)}function U(w,S,B,p){return v(w,S,B,p,32)}function R(w,S,B,p){for(var C=p[0]&255|(p[1]&255)<<8|(p[2]&255)<<16|(p[3]&255)<<24,Q=B[0]&255|(B[1]&255)<<8|(B[2]&255)<<16|(B[3]&255)<<24,Z=B[4]&255|(B[5]&255)<<8|(B[6]&255)<<16|(B[7]&255)<<24,lt=B[8]&255|(B[9]&255)<<8|(B[10]&255)<<16|(B[11]&255)<<24,kt=B[12]&255|(B[13]&255)<<8|(B[14]&255)<<16|(B[15]&255)<<24,Rt=p[4]&255|(p[5]&255)<<8|(p[6]&255)<<16|(p[7]&255)<<24,St=S[0]&255|(S[1]&255)<<8|(S[2]&255)<<16|(S[3]&255)<<24,Xe=S[4]&255|(S[5]&255)<<8|(S[6]&255)<<16|(S[7]&255)<<24,jt=S[8]&255|(S[9]&255)<<8|(S[10]&255)<<16|(S[11]&255)<<24,de=S[12]&255|(S[13]&255)<<8|(S[14]&255)<<16|(S[15]&255)<<24,pe=p[8]&255|(p[9]&255)<<8|(p[10]&255)<<16|(p[11]&255)<<24,ke=B[16]&255|(B[17]&255)<<8|(B[18]&255)<<16|(B[19]&255)<<24,xe=B[20]&255|(B[21]&255)<<8|(B[22]&255)<<16|(B[23]&255)<<24,ge=B[24]&255|(B[25]&255)<<8|(B[26]&255)<<16|(B[27]&255)<<24,be=B[28]&255|(B[29]&255)<<8|(B[30]&255)<<16|(B[31]&255)<<24,_e=p[12]&255|(p[13]&255)<<8|(p[14]&255)<<16|(p[15]&255)<<24,Ht=C,Xt=Q,Lt=Z,Gt=lt,Wt=kt,$t=Rt,st=St,ot=Xe,bt=jt,ft=de,gt=pe,At=ke,ue=xe,Ue=ge,Me=be,$e=_e,H,He=0;He<20;He+=2)H=Ht+ue|0,Wt^=H<<7|H>>>32-7,H=Wt+Ht|0,bt^=H<<9|H>>>32-9,H=bt+Wt|0,ue^=H<<13|H>>>32-13,H=ue+bt|0,Ht^=H<<18|H>>>32-18,H=$t+Xt|0,ft^=H<<7|H>>>32-7,H=ft+$t|0,Ue^=H<<9|H>>>32-9,H=Ue+ft|0,Xt^=H<<13|H>>>32-13,H=Xt+Ue|0,$t^=H<<18|H>>>32-18,H=gt+st|0,Me^=H<<7|H>>>32-7,H=Me+gt|0,Lt^=H<<9|H>>>32-9,H=Lt+Me|0,st^=H<<13|H>>>32-13,H=st+Lt|0,gt^=H<<18|H>>>32-18,H=$e+At|0,Gt^=H<<7|H>>>32-7,H=Gt+$e|0,ot^=H<<9|H>>>32-9,H=ot+Gt|0,At^=H<<13|H>>>32-13,H=At+ot|0,$e^=H<<18|H>>>32-18,H=Ht+Gt|0,Xt^=H<<7|H>>>32-7,H=Xt+Ht|0,Lt^=H<<9|H>>>32-9,H=Lt+Xt|0,Gt^=H<<13|H>>>32-13,H=Gt+Lt|0,Ht^=H<<18|H>>>32-18,H=$t+Wt|0,st^=H<<7|H>>>32-7,H=st+$t|0,ot^=H<<9|H>>>32-9,H=ot+st|0,Wt^=H<<13|H>>>32-13,H=Wt+ot|0,$t^=H<<18|H>>>32-18,H=gt+ft|0,At^=H<<7|H>>>32-7,H=At+gt|0,bt^=H<<9|H>>>32-9,H=bt+At|0,ft^=H<<13|H>>>32-13,H=ft+bt|0,gt^=H<<18|H>>>32-18,H=$e+Me|0,ue^=H<<7|H>>>32-7,H=ue+$e|0,Ue^=H<<9|H>>>32-9,H=Ue+ue|0,Me^=H<<13|H>>>32-13,H=Me+Ue|0,$e^=H<<18|H>>>32-18;Ht=Ht+C|0,Xt=Xt+Q|0,Lt=Lt+Z|0,Gt=Gt+lt|0,Wt=Wt+kt|0,$t=$t+Rt|0,st=st+St|0,ot=ot+Xe|0,bt=bt+jt|0,ft=ft+de|0,gt=gt+pe|0,At=At+ke|0,ue=ue+xe|0,Ue=Ue+ge|0,Me=Me+be|0,$e=$e+_e|0,w[0]=Ht>>>0&255,w[1]=Ht>>>8&255,w[2]=Ht>>>16&255,w[3]=Ht>>>24&255,w[4]=Xt>>>0&255,w[5]=Xt>>>8&255,w[6]=Xt>>>16&255,w[7]=Xt>>>24&255,w[8]=Lt>>>0&255,w[9]=Lt>>>8&255,w[10]=Lt>>>16&255,w[11]=Lt>>>24&255,w[12]=Gt>>>0&255,w[13]=Gt>>>8&255,w[14]=Gt>>>16&255,w[15]=Gt>>>24&255,w[16]=Wt>>>0&255,w[17]=Wt>>>8&255,w[18]=Wt>>>16&255,w[19]=Wt>>>24&255,w[20]=$t>>>0&255,w[21]=$t>>>8&255,w[22]=$t>>>16&255,w[23]=$t>>>24&255,w[24]=st>>>0&255,w[25]=st>>>8&255,w[26]=st>>>16&255,w[27]=st>>>24&255,w[28]=ot>>>0&255,w[29]=ot>>>8&255,w[30]=ot>>>16&255,w[31]=ot>>>24&255,w[32]=bt>>>0&255,w[33]=bt>>>8&255,w[34]=bt>>>16&255,w[35]=bt>>>24&255,w[36]=ft>>>0&255,w[37]=ft>>>8&255,w[38]=ft>>>16&255,w[39]=ft>>>24&255,w[40]=gt>>>0&255,w[41]=gt>>>8&255,w[42]=gt>>>16&255,w[43]=gt>>>24&255,w[44]=At>>>0&255,w[45]=At>>>8&255,w[46]=At>>>16&255,w[47]=At>>>24&255,w[48]=ue>>>0&255,w[49]=ue>>>8&255,w[50]=ue>>>16&255,w[51]=ue>>>24&255,w[52]=Ue>>>0&255,w[53]=Ue>>>8&255,w[54]=Ue>>>16&255,w[55]=Ue>>>24&255,w[56]=Me>>>0&255,w[57]=Me>>>8&255,w[58]=Me>>>16&255,w[59]=Me>>>24&255,w[60]=$e>>>0&255,w[61]=$e>>>8&255,w[62]=$e>>>16&255,w[63]=$e>>>24&255}function A(w,S,B,p){for(var C=p[0]&255|(p[1]&255)<<8|(p[2]&255)<<16|(p[3]&255)<<24,Q=B[0]&255|(B[1]&255)<<8|(B[2]&255)<<16|(B[3]&255)<<24,Z=B[4]&255|(B[5]&255)<<8|(B[6]&255)<<16|(B[7]&255)<<24,lt=B[8]&255|(B[9]&255)<<8|(B[10]&255)<<16|(B[11]&255)<<24,kt=B[12]&255|(B[13]&255)<<8|(B[14]&255)<<16|(B[15]&255)<<24,Rt=p[4]&255|(p[5]&255)<<8|(p[6]&255)<<16|(p[7]&255)<<24,St=S[0]&255|(S[1]&255)<<8|(S[2]&255)<<16|(S[3]&255)<<24,Xe=S[4]&255|(S[5]&255)<<8|(S[6]&255)<<16|(S[7]&255)<<24,jt=S[8]&255|(S[9]&255)<<8|(S[10]&255)<<16|(S[11]&255)<<24,de=S[12]&255|(S[13]&255)<<8|(S[14]&255)<<16|(S[15]&255)<<24,pe=p[8]&255|(p[9]&255)<<8|(p[10]&255)<<16|(p[11]&255)<<24,ke=B[16]&255|(B[17]&255)<<8|(B[18]&255)<<16|(B[19]&255)<<24,xe=B[20]&255|(B[21]&255)<<8|(B[22]&255)<<16|(B[23]&255)<<24,ge=B[24]&255|(B[25]&255)<<8|(B[26]&255)<<16|(B[27]&255)<<24,be=B[28]&255|(B[29]&255)<<8|(B[30]&255)<<16|(B[31]&255)<<24,_e=p[12]&255|(p[13]&255)<<8|(p[14]&255)<<16|(p[15]&255)<<24,Ht=C,Xt=Q,Lt=Z,Gt=lt,Wt=kt,$t=Rt,st=St,ot=Xe,bt=jt,ft=de,gt=pe,At=ke,ue=xe,Ue=ge,Me=be,$e=_e,H,He=0;He<20;He+=2)H=Ht+ue|0,Wt^=H<<7|H>>>32-7,H=Wt+Ht|0,bt^=H<<9|H>>>32-9,H=bt+Wt|0,ue^=H<<13|H>>>32-13,H=ue+bt|0,Ht^=H<<18|H>>>32-18,H=$t+Xt|0,ft^=H<<7|H>>>32-7,H=ft+$t|0,Ue^=H<<9|H>>>32-9,H=Ue+ft|0,Xt^=H<<13|H>>>32-13,H=Xt+Ue|0,$t^=H<<18|H>>>32-18,H=gt+st|0,Me^=H<<7|H>>>32-7,H=Me+gt|0,Lt^=H<<9|H>>>32-9,H=Lt+Me|0,st^=H<<13|H>>>32-13,H=st+Lt|0,gt^=H<<18|H>>>32-18,H=$e+At|0,Gt^=H<<7|H>>>32-7,H=Gt+$e|0,ot^=H<<9|H>>>32-9,H=ot+Gt|0,At^=H<<13|H>>>32-13,H=At+ot|0,$e^=H<<18|H>>>32-18,H=Ht+Gt|0,Xt^=H<<7|H>>>32-7,H=Xt+Ht|0,Lt^=H<<9|H>>>32-9,H=Lt+Xt|0,Gt^=H<<13|H>>>32-13,H=Gt+Lt|0,Ht^=H<<18|H>>>32-18,H=$t+Wt|0,st^=H<<7|H>>>32-7,H=st+$t|0,ot^=H<<9|H>>>32-9,H=ot+st|0,Wt^=H<<13|H>>>32-13,H=Wt+ot|0,$t^=H<<18|H>>>32-18,H=gt+ft|0,At^=H<<7|H>>>32-7,H=At+gt|0,bt^=H<<9|H>>>32-9,H=bt+At|0,ft^=H<<13|H>>>32-13,H=ft+bt|0,gt^=H<<18|H>>>32-18,H=$e+Me|0,ue^=H<<7|H>>>32-7,H=ue+$e|0,Ue^=H<<9|H>>>32-9,H=Ue+ue|0,Me^=H<<13|H>>>32-13,H=Me+Ue|0,$e^=H<<18|H>>>32-18;w[0]=Ht>>>0&255,w[1]=Ht>>>8&255,w[2]=Ht>>>16&255,w[3]=Ht>>>24&255,w[4]=$t>>>0&255,w[5]=$t>>>8&255,w[6]=$t>>>16&255,w[7]=$t>>>24&255,w[8]=gt>>>0&255,w[9]=gt>>>8&255,w[10]=gt>>>16&255,w[11]=gt>>>24&255,w[12]=$e>>>0&255,w[13]=$e>>>8&255,w[14]=$e>>>16&255,w[15]=$e>>>24&255,w[16]=st>>>0&255,w[17]=st>>>8&255,w[18]=st>>>16&255,w[19]=st>>>24&255,w[20]=ot>>>0&255,w[21]=ot>>>8&255,w[22]=ot>>>16&255,w[23]=ot>>>24&255,w[24]=bt>>>0&255,w[25]=bt>>>8&255,w[26]=bt>>>16&255,w[27]=bt>>>24&255,w[28]=ft>>>0&255,w[29]=ft>>>8&255,w[30]=ft>>>16&255,w[31]=ft>>>24&255}function P(w,S,B,p){R(w,S,B,p)}function M(w,S,B,p){A(w,S,B,p)}var K=new Uint8Array([101,120,112,97,110,100,32,51,50,45,98,121,116,101,32,107]);function Y(w,S,B,p,C,Q,Z){var lt=new Uint8Array(16),kt=new Uint8Array(64),Rt,St;for(St=0;St<16;St++)lt[St]=0;for(St=0;St<8;St++)lt[St]=Q[St];for(;C>=64;){for(P(kt,lt,Z,K),St=0;St<64;St++)w[S+St]=B[p+St]^kt[St];for(Rt=1,St=8;St<16;St++)Rt=Rt+(lt[St]&255)|0,lt[St]=Rt&255,Rt>>>=8;C-=64,S+=64,p+=64}if(C>0)for(P(kt,lt,Z,K),St=0;St<C;St++)w[S+St]=B[p+St]^kt[St];return 0}function X(w,S,B,p,C){var Q=new Uint8Array(16),Z=new Uint8Array(64),lt,kt;for(kt=0;kt<16;kt++)Q[kt]=0;for(kt=0;kt<8;kt++)Q[kt]=p[kt];for(;B>=64;){for(P(Z,Q,C,K),kt=0;kt<64;kt++)w[S+kt]=Z[kt];for(lt=1,kt=8;kt<16;kt++)lt=lt+(Q[kt]&255)|0,Q[kt]=lt&255,lt>>>=8;B-=64,S+=64}if(B>0)for(P(Z,Q,C,K),kt=0;kt<B;kt++)w[S+kt]=Z[kt];return 0}function et(w,S,B,p,C){var Q=new Uint8Array(32);M(Q,p,C,K);for(var Z=new Uint8Array(8),lt=0;lt<8;lt++)Z[lt]=p[lt+16];return X(w,S,B,Z,Q)}function z(w,S,B,p,C,Q,Z){var lt=new Uint8Array(32);M(lt,Q,Z,K);for(var kt=new Uint8Array(8),Rt=0;Rt<8;Rt++)kt[Rt]=Q[Rt+16];return Y(w,S,B,p,C,kt,lt)}var O=function(w){this.buffer=new Uint8Array(16),this.r=new Uint16Array(10),this.h=new Uint16Array(10),this.pad=new Uint16Array(8),this.leftover=0,this.fin=0;var S,B,p,C,Q,Z,lt,kt;S=w[0]&255|(w[1]&255)<<8,this.r[0]=S&8191,B=w[2]&255|(w[3]&255)<<8,this.r[1]=(S>>>13|B<<3)&8191,p=w[4]&255|(w[5]&255)<<8,this.r[2]=(B>>>10|p<<6)&7939,C=w[6]&255|(w[7]&255)<<8,this.r[3]=(p>>>7|C<<9)&8191,Q=w[8]&255|(w[9]&255)<<8,this.r[4]=(C>>>4|Q<<12)&255,this.r[5]=Q>>>1&8190,Z=w[10]&255|(w[11]&255)<<8,this.r[6]=(Q>>>14|Z<<2)&8191,lt=w[12]&255|(w[13]&255)<<8,this.r[7]=(Z>>>11|lt<<5)&8065,kt=w[14]&255|(w[15]&255)<<8,this.r[8]=(lt>>>8|kt<<8)&8191,this.r[9]=kt>>>5&127,this.pad[0]=w[16]&255|(w[17]&255)<<8,this.pad[1]=w[18]&255|(w[19]&255)<<8,this.pad[2]=w[20]&255|(w[21]&255)<<8,this.pad[3]=w[22]&255|(w[23]&255)<<8,this.pad[4]=w[24]&255|(w[25]&255)<<8,this.pad[5]=w[26]&255|(w[27]&255)<<8,this.pad[6]=w[28]&255|(w[29]&255)<<8,this.pad[7]=w[30]&255|(w[31]&255)<<8};O.prototype.blocks=function(w,S,B){for(var p=this.fin?0:2048,C,Q,Z,lt,kt,Rt,St,Xe,jt,de,pe,ke,xe,ge,be,_e,Ht,Xt,Lt,Gt=this.h[0],Wt=this.h[1],$t=this.h[2],st=this.h[3],ot=this.h[4],bt=this.h[5],ft=this.h[6],gt=this.h[7],At=this.h[8],ue=this.h[9],Ue=this.r[0],Me=this.r[1],$e=this.r[2],H=this.r[3],He=this.r[4],nn=this.r[5],sn=this.r[6],Le=this.r[7],Qe=this.r[8],tn=this.r[9];B>=16;)C=w[S+0]&255|(w[S+1]&255)<<8,Gt+=C&8191,Q=w[S+2]&255|(w[S+3]&255)<<8,Wt+=(C>>>13|Q<<3)&8191,Z=w[S+4]&255|(w[S+5]&255)<<8,$t+=(Q>>>10|Z<<6)&8191,lt=w[S+6]&255|(w[S+7]&255)<<8,st+=(Z>>>7|lt<<9)&8191,kt=w[S+8]&255|(w[S+9]&255)<<8,ot+=(lt>>>4|kt<<12)&8191,bt+=kt>>>1&8191,Rt=w[S+10]&255|(w[S+11]&255)<<8,ft+=(kt>>>14|Rt<<2)&8191,St=w[S+12]&255|(w[S+13]&255)<<8,gt+=(Rt>>>11|St<<5)&8191,Xe=w[S+14]&255|(w[S+15]&255)<<8,At+=(St>>>8|Xe<<8)&8191,ue+=Xe>>>5|p,jt=0,de=jt,de+=Gt*Ue,de+=Wt*(5*tn),de+=$t*(5*Qe),de+=st*(5*Le),de+=ot*(5*sn),jt=de>>>13,de&=8191,de+=bt*(5*nn),de+=ft*(5*He),de+=gt*(5*H),de+=At*(5*$e),de+=ue*(5*Me),jt+=de>>>13,de&=8191,pe=jt,pe+=Gt*Me,pe+=Wt*Ue,pe+=$t*(5*tn),pe+=st*(5*Qe),pe+=ot*(5*Le),jt=pe>>>13,pe&=8191,pe+=bt*(5*sn),pe+=ft*(5*nn),pe+=gt*(5*He),pe+=At*(5*H),pe+=ue*(5*$e),jt+=pe>>>13,pe&=8191,ke=jt,ke+=Gt*$e,ke+=Wt*Me,ke+=$t*Ue,ke+=st*(5*tn),ke+=ot*(5*Qe),jt=ke>>>13,ke&=8191,ke+=bt*(5*Le),ke+=ft*(5*sn),ke+=gt*(5*nn),ke+=At*(5*He),ke+=ue*(5*H),jt+=ke>>>13,ke&=8191,xe=jt,xe+=Gt*H,xe+=Wt*$e,xe+=$t*Me,xe+=st*Ue,xe+=ot*(5*tn),jt=xe>>>13,xe&=8191,xe+=bt*(5*Qe),xe+=ft*(5*Le),xe+=gt*(5*sn),xe+=At*(5*nn),xe+=ue*(5*He),jt+=xe>>>13,xe&=8191,ge=jt,ge+=Gt*He,ge+=Wt*H,ge+=$t*$e,ge+=st*Me,ge+=ot*Ue,jt=ge>>>13,ge&=8191,ge+=bt*(5*tn),ge+=ft*(5*Qe),ge+=gt*(5*Le),ge+=At*(5*sn),ge+=ue*(5*nn),jt+=ge>>>13,ge&=8191,be=jt,be+=Gt*nn,be+=Wt*He,be+=$t*H,be+=st*$e,be+=ot*Me,jt=be>>>13,be&=8191,be+=bt*Ue,be+=ft*(5*tn),be+=gt*(5*Qe),be+=At*(5*Le),be+=ue*(5*sn),jt+=be>>>13,be&=8191,_e=jt,_e+=Gt*sn,_e+=Wt*nn,_e+=$t*He,_e+=st*H,_e+=ot*$e,jt=_e>>>13,_e&=8191,_e+=bt*Me,_e+=ft*Ue,_e+=gt*(5*tn),_e+=At*(5*Qe),_e+=ue*(5*Le),jt+=_e>>>13,_e&=8191,Ht=jt,Ht+=Gt*Le,Ht+=Wt*sn,Ht+=$t*nn,Ht+=st*He,Ht+=ot*H,jt=Ht>>>13,Ht&=8191,Ht+=bt*$e,Ht+=ft*Me,Ht+=gt*Ue,Ht+=At*(5*tn),Ht+=ue*(5*Qe),jt+=Ht>>>13,Ht&=8191,Xt=jt,Xt+=Gt*Qe,Xt+=Wt*Le,Xt+=$t*sn,Xt+=st*nn,Xt+=ot*He,jt=Xt>>>13,Xt&=8191,Xt+=bt*H,Xt+=ft*$e,Xt+=gt*Me,Xt+=At*Ue,Xt+=ue*(5*tn),jt+=Xt>>>13,Xt&=8191,Lt=jt,Lt+=Gt*tn,Lt+=Wt*Qe,Lt+=$t*Le,Lt+=st*sn,Lt+=ot*nn,jt=Lt>>>13,Lt&=8191,Lt+=bt*He,Lt+=ft*H,Lt+=gt*$e,Lt+=At*Me,Lt+=ue*Ue,jt+=Lt>>>13,Lt&=8191,jt=(jt<<2)+jt|0,jt=jt+de|0,de=jt&8191,jt=jt>>>13,pe+=jt,Gt=de,Wt=pe,$t=ke,st=xe,ot=ge,bt=be,ft=_e,gt=Ht,At=Xt,ue=Lt,S+=16,B-=16;this.h[0]=Gt,this.h[1]=Wt,this.h[2]=$t,this.h[3]=st,this.h[4]=ot,this.h[5]=bt,this.h[6]=ft,this.h[7]=gt,this.h[8]=At,this.h[9]=ue},O.prototype.finish=function(w,S){var B=new Uint16Array(10),p,C,Q,Z;if(this.leftover){for(Z=this.leftover,this.buffer[Z++]=1;Z<16;Z++)this.buffer[Z]=0;this.fin=1,this.blocks(this.buffer,0,16)}for(p=this.h[1]>>>13,this.h[1]&=8191,Z=2;Z<10;Z++)this.h[Z]+=p,p=this.h[Z]>>>13,this.h[Z]&=8191;for(this.h[0]+=p*5,p=this.h[0]>>>13,this.h[0]&=8191,this.h[1]+=p,p=this.h[1]>>>13,this.h[1]&=8191,this.h[2]+=p,B[0]=this.h[0]+5,p=B[0]>>>13,B[0]&=8191,Z=1;Z<10;Z++)B[Z]=this.h[Z]+p,p=B[Z]>>>13,B[Z]&=8191;for(B[9]-=8192,C=(p^1)-1,Z=0;Z<10;Z++)B[Z]&=C;for(C=~C,Z=0;Z<10;Z++)this.h[Z]=this.h[Z]&C|B[Z];for(this.h[0]=(this.h[0]|this.h[1]<<13)&65535,this.h[1]=(this.h[1]>>>3|this.h[2]<<10)&65535,this.h[2]=(this.h[2]>>>6|this.h[3]<<7)&65535,this.h[3]=(this.h[3]>>>9|this.h[4]<<4)&65535,this.h[4]=(this.h[4]>>>12|this.h[5]<<1|this.h[6]<<14)&65535,this.h[5]=(this.h[6]>>>2|this.h[7]<<11)&65535,this.h[6]=(this.h[7]>>>5|this.h[8]<<8)&65535,this.h[7]=(this.h[8]>>>8|this.h[9]<<5)&65535,Q=this.h[0]+this.pad[0],this.h[0]=Q&65535,Z=1;Z<8;Z++)Q=(this.h[Z]+this.pad[Z]|0)+(Q>>>16)|0,this.h[Z]=Q&65535;w[S+0]=this.h[0]>>>0&255,w[S+1]=this.h[0]>>>8&255,w[S+2]=this.h[1]>>>0&255,w[S+3]=this.h[1]>>>8&255,w[S+4]=this.h[2]>>>0&255,w[S+5]=this.h[2]>>>8&255,w[S+6]=this.h[3]>>>0&255,w[S+7]=this.h[3]>>>8&255,w[S+8]=this.h[4]>>>0&255,w[S+9]=this.h[4]>>>8&255,w[S+10]=this.h[5]>>>0&255,w[S+11]=this.h[5]>>>8&255,w[S+12]=this.h[6]>>>0&255,w[S+13]=this.h[6]>>>8&255,w[S+14]=this.h[7]>>>0&255,w[S+15]=this.h[7]>>>8&255},O.prototype.update=function(w,S,B){var p,C;if(this.leftover){for(C=16-this.leftover,C>B&&(C=B),p=0;p<C;p++)this.buffer[this.leftover+p]=w[S+p];if(B-=C,S+=C,this.leftover+=C,this.leftover<16)return;this.blocks(this.buffer,0,16),this.leftover=0}if(B>=16&&(C=B-B%16,this.blocks(w,S,C),S+=C,B-=C),B){for(p=0;p<B;p++)this.buffer[this.leftover+p]=w[S+p];this.leftover+=B}};function $(w,S,B,p,C,Q){var Z=new O(Q);return Z.update(B,p,C),Z.finish(w,S),0}function b(w,S,B,p,C,Q){var Z=new Uint8Array(16);return $(Z,0,B,p,C,Q),k(w,S,Z,0)}function h(w,S,B,p,C){var Q;if(B<32)return-1;for(z(w,0,S,0,B,p,C),$(w,16,w,32,B-32,w),Q=0;Q<16;Q++)w[Q]=0;return 0}function m(w,S,B,p,C){var Q,Z=new Uint8Array(32);if(B<32||(et(Z,0,32,p,C),b(S,16,S,32,B-32,Z)!==0))return-1;for(z(w,0,S,0,B,p,C),Q=0;Q<32;Q++)w[Q]=0;return 0}function x(w,S){var B;for(B=0;B<16;B++)w[B]=S[B]|0}function I(w){var S,B,p=1;for(S=0;S<16;S++)B=w[S]+p+65535,p=Math.floor(B/65536),w[S]=B-p*65536;w[0]+=p-1+37*(p-1)}function N(w,S,B){for(var p,C=~(B-1),Q=0;Q<16;Q++)p=C&(w[Q]^S[Q]),w[Q]^=p,S[Q]^=p}function j(w,S){var B,p,C,Q=n(),Z=n();for(B=0;B<16;B++)Z[B]=S[B];for(I(Z),I(Z),I(Z),p=0;p<2;p++){for(Q[0]=Z[0]-65517,B=1;B<15;B++)Q[B]=Z[B]-65535-(Q[B-1]>>16&1),Q[B-1]&=65535;Q[15]=Z[15]-32767-(Q[14]>>16&1),C=Q[15]>>16&1,Q[14]&=65535,N(Z,Q,1-C)}for(B=0;B<16;B++)w[2*B]=Z[B]&255,w[2*B+1]=Z[B]>>8}function G(w,S){var B=new Uint8Array(32),p=new Uint8Array(32);return j(B,w),j(p,S),U(B,0,p,0)}function E(w){var S=new Uint8Array(32);return j(S,w),S[0]&1}function g(w,S){var B;for(B=0;B<16;B++)w[B]=S[2*B]+(S[2*B+1]<<8);w[15]&=32767}function q(w,S,B){for(var p=0;p<16;p++)w[p]=S[p]+B[p]}function xt(w,S,B){for(var p=0;p<16;p++)w[p]=S[p]-B[p]}function at(w,S,B){var p,C,Q=0,Z=0,lt=0,kt=0,Rt=0,St=0,Xe=0,jt=0,de=0,pe=0,ke=0,xe=0,ge=0,be=0,_e=0,Ht=0,Xt=0,Lt=0,Gt=0,Wt=0,$t=0,st=0,ot=0,bt=0,ft=0,gt=0,At=0,ue=0,Ue=0,Me=0,$e=0,H=B[0],He=B[1],nn=B[2],sn=B[3],Le=B[4],Qe=B[5],tn=B[6],kn=B[7],un=B[8],wn=B[9],bn=B[10],vn=B[11],En=B[12],Gn=B[13],Wn=B[14],Xn=B[15];p=S[0],Q+=p*H,Z+=p*He,lt+=p*nn,kt+=p*sn,Rt+=p*Le,St+=p*Qe,Xe+=p*tn,jt+=p*kn,de+=p*un,pe+=p*wn,ke+=p*bn,xe+=p*vn,ge+=p*En,be+=p*Gn,_e+=p*Wn,Ht+=p*Xn,p=S[1],Z+=p*H,lt+=p*He,kt+=p*nn,Rt+=p*sn,St+=p*Le,Xe+=p*Qe,jt+=p*tn,de+=p*kn,pe+=p*un,ke+=p*wn,xe+=p*bn,ge+=p*vn,be+=p*En,_e+=p*Gn,Ht+=p*Wn,Xt+=p*Xn,p=S[2],lt+=p*H,kt+=p*He,Rt+=p*nn,St+=p*sn,Xe+=p*Le,jt+=p*Qe,de+=p*tn,pe+=p*kn,ke+=p*un,xe+=p*wn,ge+=p*bn,be+=p*vn,_e+=p*En,Ht+=p*Gn,Xt+=p*Wn,Lt+=p*Xn,p=S[3],kt+=p*H,Rt+=p*He,St+=p*nn,Xe+=p*sn,jt+=p*Le,de+=p*Qe,pe+=p*tn,ke+=p*kn,xe+=p*un,ge+=p*wn,be+=p*bn,_e+=p*vn,Ht+=p*En,Xt+=p*Gn,Lt+=p*Wn,Gt+=p*Xn,p=S[4],Rt+=p*H,St+=p*He,Xe+=p*nn,jt+=p*sn,de+=p*Le,pe+=p*Qe,ke+=p*tn,xe+=p*kn,ge+=p*un,be+=p*wn,_e+=p*bn,Ht+=p*vn,Xt+=p*En,Lt+=p*Gn,Gt+=p*Wn,Wt+=p*Xn,p=S[5],St+=p*H,Xe+=p*He,jt+=p*nn,de+=p*sn,pe+=p*Le,ke+=p*Qe,xe+=p*tn,ge+=p*kn,be+=p*un,_e+=p*wn,Ht+=p*bn,Xt+=p*vn,Lt+=p*En,Gt+=p*Gn,Wt+=p*Wn,$t+=p*Xn,p=S[6],Xe+=p*H,jt+=p*He,de+=p*nn,pe+=p*sn,ke+=p*Le,xe+=p*Qe,ge+=p*tn,be+=p*kn,_e+=p*un,Ht+=p*wn,Xt+=p*bn,Lt+=p*vn,Gt+=p*En,Wt+=p*Gn,$t+=p*Wn,st+=p*Xn,p=S[7],jt+=p*H,de+=p*He,pe+=p*nn,ke+=p*sn,xe+=p*Le,ge+=p*Qe,be+=p*tn,_e+=p*kn,Ht+=p*un,Xt+=p*wn,Lt+=p*bn,Gt+=p*vn,Wt+=p*En,$t+=p*Gn,st+=p*Wn,ot+=p*Xn,p=S[8],de+=p*H,pe+=p*He,ke+=p*nn,xe+=p*sn,ge+=p*Le,be+=p*Qe,_e+=p*tn,Ht+=p*kn,Xt+=p*un,Lt+=p*wn,Gt+=p*bn,Wt+=p*vn,$t+=p*En,st+=p*Gn,ot+=p*Wn,bt+=p*Xn,p=S[9],pe+=p*H,ke+=p*He,xe+=p*nn,ge+=p*sn,be+=p*Le,_e+=p*Qe,Ht+=p*tn,Xt+=p*kn,Lt+=p*un,Gt+=p*wn,Wt+=p*bn,$t+=p*vn,st+=p*En,ot+=p*Gn,bt+=p*Wn,ft+=p*Xn,p=S[10],ke+=p*H,xe+=p*He,ge+=p*nn,be+=p*sn,_e+=p*Le,Ht+=p*Qe,Xt+=p*tn,Lt+=p*kn,Gt+=p*un,Wt+=p*wn,$t+=p*bn,st+=p*vn,ot+=p*En,bt+=p*Gn,ft+=p*Wn,gt+=p*Xn,p=S[11],xe+=p*H,ge+=p*He,be+=p*nn,_e+=p*sn,Ht+=p*Le,Xt+=p*Qe,Lt+=p*tn,Gt+=p*kn,Wt+=p*un,$t+=p*wn,st+=p*bn,ot+=p*vn,bt+=p*En,ft+=p*Gn,gt+=p*Wn,At+=p*Xn,p=S[12],ge+=p*H,be+=p*He,_e+=p*nn,Ht+=p*sn,Xt+=p*Le,Lt+=p*Qe,Gt+=p*tn,Wt+=p*kn,$t+=p*un,st+=p*wn,ot+=p*bn,bt+=p*vn,ft+=p*En,gt+=p*Gn,At+=p*Wn,ue+=p*Xn,p=S[13],be+=p*H,_e+=p*He,Ht+=p*nn,Xt+=p*sn,Lt+=p*Le,Gt+=p*Qe,Wt+=p*tn,$t+=p*kn,st+=p*un,ot+=p*wn,bt+=p*bn,ft+=p*vn,gt+=p*En,At+=p*Gn,ue+=p*Wn,Ue+=p*Xn,p=S[14],_e+=p*H,Ht+=p*He,Xt+=p*nn,Lt+=p*sn,Gt+=p*Le,Wt+=p*Qe,$t+=p*tn,st+=p*kn,ot+=p*un,bt+=p*wn,ft+=p*bn,gt+=p*vn,At+=p*En,ue+=p*Gn,Ue+=p*Wn,Me+=p*Xn,p=S[15],Ht+=p*H,Xt+=p*He,Lt+=p*nn,Gt+=p*sn,Wt+=p*Le,$t+=p*Qe,st+=p*tn,ot+=p*kn,bt+=p*un,ft+=p*wn,gt+=p*bn,At+=p*vn,ue+=p*En,Ue+=p*Gn,Me+=p*Wn,$e+=p*Xn,Q+=38*Xt,Z+=38*Lt,lt+=38*Gt,kt+=38*Wt,Rt+=38*$t,St+=38*st,Xe+=38*ot,jt+=38*bt,de+=38*ft,pe+=38*gt,ke+=38*At,xe+=38*ue,ge+=38*Ue,be+=38*Me,_e+=38*$e,C=1,p=Q+C+65535,C=Math.floor(p/65536),Q=p-C*65536,p=Z+C+65535,C=Math.floor(p/65536),Z=p-C*65536,p=lt+C+65535,C=Math.floor(p/65536),lt=p-C*65536,p=kt+C+65535,C=Math.floor(p/65536),kt=p-C*65536,p=Rt+C+65535,C=Math.floor(p/65536),Rt=p-C*65536,p=St+C+65535,C=Math.floor(p/65536),St=p-C*65536,p=Xe+C+65535,C=Math.floor(p/65536),Xe=p-C*65536,p=jt+C+65535,C=Math.floor(p/65536),jt=p-C*65536,p=de+C+65535,C=Math.floor(p/65536),de=p-C*65536,p=pe+C+65535,C=Math.floor(p/65536),pe=p-C*65536,p=ke+C+65535,C=Math.floor(p/65536),ke=p-C*65536,p=xe+C+65535,C=Math.floor(p/65536),xe=p-C*65536,p=ge+C+65535,C=Math.floor(p/65536),ge=p-C*65536,p=be+C+65535,C=Math.floor(p/65536),be=p-C*65536,p=_e+C+65535,C=Math.floor(p/65536),_e=p-C*65536,p=Ht+C+65535,C=Math.floor(p/65536),Ht=p-C*65536,Q+=C-1+37*(C-1),C=1,p=Q+C+65535,C=Math.floor(p/65536),Q=p-C*65536,p=Z+C+65535,C=Math.floor(p/65536),Z=p-C*65536,p=lt+C+65535,C=Math.floor(p/65536),lt=p-C*65536,p=kt+C+65535,C=Math.floor(p/65536),kt=p-C*65536,p=Rt+C+65535,C=Math.floor(p/65536),Rt=p-C*65536,p=St+C+65535,C=Math.floor(p/65536),St=p-C*65536,p=Xe+C+65535,C=Math.floor(p/65536),Xe=p-C*65536,p=jt+C+65535,C=Math.floor(p/65536),jt=p-C*65536,p=de+C+65535,C=Math.floor(p/65536),de=p-C*65536,p=pe+C+65535,C=Math.floor(p/65536),pe=p-C*65536,p=ke+C+65535,C=Math.floor(p/65536),ke=p-C*65536,p=xe+C+65535,C=Math.floor(p/65536),xe=p-C*65536,p=ge+C+65535,C=Math.floor(p/65536),ge=p-C*65536,p=be+C+65535,C=Math.floor(p/65536),be=p-C*65536,p=_e+C+65535,C=Math.floor(p/65536),_e=p-C*65536,p=Ht+C+65535,C=Math.floor(p/65536),Ht=p-C*65536,Q+=C-1+37*(C-1),w[0]=Q,w[1]=Z,w[2]=lt,w[3]=kt,w[4]=Rt,w[5]=St,w[6]=Xe,w[7]=jt,w[8]=de,w[9]=pe,w[10]=ke,w[11]=xe,w[12]=ge,w[13]=be,w[14]=_e,w[15]=Ht}function mt(w,S){at(w,S,S)}function se(w,S){var B=n(),p;for(p=0;p<16;p++)B[p]=S[p];for(p=253;p>=0;p--)mt(B,B),p!==2&&p!==4&&at(B,B,S);for(p=0;p<16;p++)w[p]=B[p]}function te(w,S){var B=n(),p;for(p=0;p<16;p++)B[p]=S[p];for(p=250;p>=0;p--)mt(B,B),p!==1&&at(B,B,S);for(p=0;p<16;p++)w[p]=B[p]}function Oe(w,S,B){var p=new Uint8Array(32),C=new Float64Array(80),Q,Z,lt=n(),kt=n(),Rt=n(),St=n(),Xe=n(),jt=n();for(Z=0;Z<31;Z++)p[Z]=S[Z];for(p[31]=S[31]&127|64,p[0]&=248,g(C,B),Z=0;Z<16;Z++)kt[Z]=C[Z],St[Z]=lt[Z]=Rt[Z]=0;for(lt[0]=St[0]=1,Z=254;Z>=0;--Z)Q=p[Z>>>3]>>>(Z&7)&1,N(lt,kt,Q),N(Rt,St,Q),q(Xe,lt,Rt),xt(lt,lt,Rt),q(Rt,kt,St),xt(kt,kt,St),mt(St,Xe),mt(jt,lt),at(lt,Rt,lt),at(Rt,kt,Xe),q(Xe,lt,Rt),xt(lt,lt,Rt),mt(kt,lt),xt(Rt,St,jt),at(lt,Rt,c),q(lt,lt,St),at(Rt,Rt,lt),at(lt,St,jt),at(St,kt,C),mt(kt,Xe),N(lt,kt,Q),N(Rt,St,Q);for(Z=0;Z<16;Z++)C[Z+16]=lt[Z],C[Z+32]=Rt[Z],C[Z+48]=kt[Z],C[Z+64]=St[Z];var de=C.subarray(32),pe=C.subarray(16);return se(de,de),at(pe,pe,de),j(w,pe),0}function fe(w,S){return Oe(w,S,o)}function ee(w,S){return i(S,32),fe(w,S)}function ve(w,S,B){var p=new Uint8Array(32);return Oe(p,B,S),M(w,s,p,K)}var Tn=h,nt=m;function dt(w,S,B,p,C,Q){var Z=new Uint8Array(32);return ve(Z,C,Q),Tn(w,S,B,p,Z)}function It(w,S,B,p,C,Q){var Z=new Uint8Array(32);return ve(Z,C,Q),nt(w,S,B,p,Z)}var Tt=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591];function Ut(w,S,B,p){for(var C=new Int32Array(16),Q=new Int32Array(16),Z,lt,kt,Rt,St,Xe,jt,de,pe,ke,xe,ge,be,_e,Ht,Xt,Lt,Gt,Wt,$t,st,ot,bt,ft,gt,At,ue=w[0],Ue=w[1],Me=w[2],$e=w[3],H=w[4],He=w[5],nn=w[6],sn=w[7],Le=S[0],Qe=S[1],tn=S[2],kn=S[3],un=S[4],wn=S[5],bn=S[6],vn=S[7],En=0;p>=128;){for(Wt=0;Wt<16;Wt++)$t=8*Wt+En,C[Wt]=B[$t+0]<<24|B[$t+1]<<16|B[$t+2]<<8|B[$t+3],Q[Wt]=B[$t+4]<<24|B[$t+5]<<16|B[$t+6]<<8|B[$t+7];for(Wt=0;Wt<80;Wt++)if(Z=ue,lt=Ue,kt=Me,Rt=$e,St=H,Xe=He,jt=nn,de=sn,pe=Le,ke=Qe,xe=tn,ge=kn,be=un,_e=wn,Ht=bn,Xt=vn,st=sn,ot=vn,bt=ot&65535,ft=ot>>>16,gt=st&65535,At=st>>>16,st=(H>>>14|un<<32-14)^(H>>>18|un<<32-18)^(un>>>41-32|H<<32-(41-32)),ot=(un>>>14|H<<32-14)^(un>>>18|H<<32-18)^(H>>>41-32|un<<32-(41-32)),bt+=ot&65535,ft+=ot>>>16,gt+=st&65535,At+=st>>>16,st=H&He^~H&nn,ot=un&wn^~un&bn,bt+=ot&65535,ft+=ot>>>16,gt+=st&65535,At+=st>>>16,st=Tt[Wt*2],ot=Tt[Wt*2+1],bt+=ot&65535,ft+=ot>>>16,gt+=st&65535,At+=st>>>16,st=C[Wt%16],ot=Q[Wt%16],bt+=ot&65535,ft+=ot>>>16,gt+=st&65535,At+=st>>>16,ft+=bt>>>16,gt+=ft>>>16,At+=gt>>>16,Lt=gt&65535|At<<16,Gt=bt&65535|ft<<16,st=Lt,ot=Gt,bt=ot&65535,ft=ot>>>16,gt=st&65535,At=st>>>16,st=(ue>>>28|Le<<32-28)^(Le>>>34-32|ue<<32-(34-32))^(Le>>>39-32|ue<<32-(39-32)),ot=(Le>>>28|ue<<32-28)^(ue>>>34-32|Le<<32-(34-32))^(ue>>>39-32|Le<<32-(39-32)),bt+=ot&65535,ft+=ot>>>16,gt+=st&65535,At+=st>>>16,st=ue&Ue^ue&Me^Ue&Me,ot=Le&Qe^Le&tn^Qe&tn,bt+=ot&65535,ft+=ot>>>16,gt+=st&65535,At+=st>>>16,ft+=bt>>>16,gt+=ft>>>16,At+=gt>>>16,de=gt&65535|At<<16,Xt=bt&65535|ft<<16,st=Rt,ot=ge,bt=ot&65535,ft=ot>>>16,gt=st&65535,At=st>>>16,st=Lt,ot=Gt,bt+=ot&65535,ft+=ot>>>16,gt+=st&65535,At+=st>>>16,ft+=bt>>>16,gt+=ft>>>16,At+=gt>>>16,Rt=gt&65535|At<<16,ge=bt&65535|ft<<16,Ue=Z,Me=lt,$e=kt,H=Rt,He=St,nn=Xe,sn=jt,ue=de,Qe=pe,tn=ke,kn=xe,un=ge,wn=be,bn=_e,vn=Ht,Le=Xt,Wt%16===15)for($t=0;$t<16;$t++)st=C[$t],ot=Q[$t],bt=ot&65535,ft=ot>>>16,gt=st&65535,At=st>>>16,st=C[($t+9)%16],ot=Q[($t+9)%16],bt+=ot&65535,ft+=ot>>>16,gt+=st&65535,At+=st>>>16,Lt=C[($t+1)%16],Gt=Q[($t+1)%16],st=(Lt>>>1|Gt<<32-1)^(Lt>>>8|Gt<<32-8)^Lt>>>7,ot=(Gt>>>1|Lt<<32-1)^(Gt>>>8|Lt<<32-8)^(Gt>>>7|Lt<<32-7),bt+=ot&65535,ft+=ot>>>16,gt+=st&65535,At+=st>>>16,Lt=C[($t+14)%16],Gt=Q[($t+14)%16],st=(Lt>>>19|Gt<<32-19)^(Gt>>>61-32|Lt<<32-(61-32))^Lt>>>6,ot=(Gt>>>19|Lt<<32-19)^(Lt>>>61-32|Gt<<32-(61-32))^(Gt>>>6|Lt<<32-6),bt+=ot&65535,ft+=ot>>>16,gt+=st&65535,At+=st>>>16,ft+=bt>>>16,gt+=ft>>>16,At+=gt>>>16,C[$t]=gt&65535|At<<16,Q[$t]=bt&65535|ft<<16;st=ue,ot=Le,bt=ot&65535,ft=ot>>>16,gt=st&65535,At=st>>>16,st=w[0],ot=S[0],bt+=ot&65535,ft+=ot>>>16,gt+=st&65535,At+=st>>>16,ft+=bt>>>16,gt+=ft>>>16,At+=gt>>>16,w[0]=ue=gt&65535|At<<16,S[0]=Le=bt&65535|ft<<16,st=Ue,ot=Qe,bt=ot&65535,ft=ot>>>16,gt=st&65535,At=st>>>16,st=w[1],ot=S[1],bt+=ot&65535,ft+=ot>>>16,gt+=st&65535,At+=st>>>16,ft+=bt>>>16,gt+=ft>>>16,At+=gt>>>16,w[1]=Ue=gt&65535|At<<16,S[1]=Qe=bt&65535|ft<<16,st=Me,ot=tn,bt=ot&65535,ft=ot>>>16,gt=st&65535,At=st>>>16,st=w[2],ot=S[2],bt+=ot&65535,ft+=ot>>>16,gt+=st&65535,At+=st>>>16,ft+=bt>>>16,gt+=ft>>>16,At+=gt>>>16,w[2]=Me=gt&65535|At<<16,S[2]=tn=bt&65535|ft<<16,st=$e,ot=kn,bt=ot&65535,ft=ot>>>16,gt=st&65535,At=st>>>16,st=w[3],ot=S[3],bt+=ot&65535,ft+=ot>>>16,gt+=st&65535,At+=st>>>16,ft+=bt>>>16,gt+=ft>>>16,At+=gt>>>16,w[3]=$e=gt&65535|At<<16,S[3]=kn=bt&65535|ft<<16,st=H,ot=un,bt=ot&65535,ft=ot>>>16,gt=st&65535,At=st>>>16,st=w[4],ot=S[4],bt+=ot&65535,ft+=ot>>>16,gt+=st&65535,At+=st>>>16,ft+=bt>>>16,gt+=ft>>>16,At+=gt>>>16,w[4]=H=gt&65535|At<<16,S[4]=un=bt&65535|ft<<16,st=He,ot=wn,bt=ot&65535,ft=ot>>>16,gt=st&65535,At=st>>>16,st=w[5],ot=S[5],bt+=ot&65535,ft+=ot>>>16,gt+=st&65535,At+=st>>>16,ft+=bt>>>16,gt+=ft>>>16,At+=gt>>>16,w[5]=He=gt&65535|At<<16,S[5]=wn=bt&65535|ft<<16,st=nn,ot=bn,bt=ot&65535,ft=ot>>>16,gt=st&65535,At=st>>>16,st=w[6],ot=S[6],bt+=ot&65535,ft+=ot>>>16,gt+=st&65535,At+=st>>>16,ft+=bt>>>16,gt+=ft>>>16,At+=gt>>>16,w[6]=nn=gt&65535|At<<16,S[6]=bn=bt&65535|ft<<16,st=sn,ot=vn,bt=ot&65535,ft=ot>>>16,gt=st&65535,At=st>>>16,st=w[7],ot=S[7],bt+=ot&65535,ft+=ot>>>16,gt+=st&65535,At+=st>>>16,ft+=bt>>>16,gt+=ft>>>16,At+=gt>>>16,w[7]=sn=gt&65535|At<<16,S[7]=vn=bt&65535|ft<<16,En+=128,p-=128}return p}function Yt(w,S,B){var p=new Int32Array(8),C=new Int32Array(8),Q=new Uint8Array(256),Z,lt=B;for(p[0]=1779033703,p[1]=3144134277,p[2]=1013904242,p[3]=2773480762,p[4]=1359893119,p[5]=2600822924,p[6]=528734635,p[7]=1541459225,C[0]=4089235720,C[1]=2227873595,C[2]=4271175723,C[3]=1595750129,C[4]=2917565137,C[5]=725511199,C[6]=4215389547,C[7]=327033209,Ut(p,C,S,B),B%=128,Z=0;Z<B;Z++)Q[Z]=S[lt-B+Z];for(Q[B]=128,B=256-128*(B<112?1:0),Q[B-9]=0,T(Q,B-8,lt/536870912|0,lt<<3),Ut(p,C,Q,B),Z=0;Z<8;Z++)T(w,8*Z,p[Z],C[Z]);return 0}function zt(w,S){var B=n(),p=n(),C=n(),Q=n(),Z=n(),lt=n(),kt=n(),Rt=n(),St=n();xt(B,w[1],w[0]),xt(St,S[1],S[0]),at(B,B,St),q(p,w[0],w[1]),q(St,S[0],S[1]),at(p,p,St),at(C,w[3],S[3]),at(C,C,l),at(Q,w[2],S[2]),q(Q,Q,Q),xt(Z,p,B),xt(lt,Q,C),q(kt,Q,C),q(Rt,p,B),at(w[0],Z,lt),at(w[1],Rt,kt),at(w[2],kt,lt),at(w[3],Z,Rt)}function Vt(w,S,B){var p;for(p=0;p<4;p++)N(w[p],S[p],B)}function We(w,S){var B=n(),p=n(),C=n();se(C,S[2]),at(B,S[0],C),at(p,S[1],C),j(w,p),w[31]^=E(B)<<7}function re(w,S,B){var p,C;for(x(w[0],r),x(w[1],a),x(w[2],a),x(w[3],r),C=255;C>=0;--C)p=B[C/8|0]>>(C&7)&1,Vt(w,S,p),zt(S,w),zt(w,w),Vt(w,S,p)}function Jt(w,S){var B=[n(),n(),n(),n()];x(B[0],d),x(B[1],f),x(B[2],a),at(B[3],d,f),re(w,B,S)}function je(w,S,B){var p=new Uint8Array(64),C=[n(),n(),n(),n()],Q;for(B||i(S,32),Yt(p,S,32),p[0]&=248,p[31]&=127,p[31]|=64,Jt(C,p),We(w,C),Q=0;Q<32;Q++)S[Q+32]=w[Q];return 0}var Ae=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]);function L(w,S){var B,p,C,Q;for(p=63;p>=32;--p){for(B=0,C=p-32,Q=p-12;C<Q;++C)S[C]+=B-16*S[p]*Ae[C-(p-32)],B=Math.floor((S[C]+128)/256),S[C]-=B*256;S[C]+=B,S[p]=0}for(B=0,C=0;C<32;C++)S[C]+=B-(S[31]>>4)*Ae[C],B=S[C]>>8,S[C]&=255;for(C=0;C<32;C++)S[C]-=B*Ae[C];for(p=0;p<32;p++)S[p+1]+=S[p]>>8,w[p]=S[p]&255}function V(w){var S=new Float64Array(64),B;for(B=0;B<64;B++)S[B]=w[B];for(B=0;B<64;B++)w[B]=0;L(w,S)}function W(w,S,B,p){var C=new Uint8Array(64),Q=new Uint8Array(64),Z=new Uint8Array(64),lt,kt,Rt=new Float64Array(64),St=[n(),n(),n(),n()];Yt(C,p,32),C[0]&=248,C[31]&=127,C[31]|=64;var Xe=B+64;for(lt=0;lt<B;lt++)w[64+lt]=S[lt];for(lt=0;lt<32;lt++)w[32+lt]=C[32+lt];for(Yt(Z,w.subarray(32),B+32),V(Z),Jt(St,Z),We(w,St),lt=32;lt<64;lt++)w[lt]=p[lt];for(Yt(Q,w,B+64),V(Q),lt=0;lt<64;lt++)Rt[lt]=0;for(lt=0;lt<32;lt++)Rt[lt]=Z[lt];for(lt=0;lt<32;lt++)for(kt=0;kt<32;kt++)Rt[lt+kt]+=Q[lt]*C[kt];return L(w.subarray(32),Rt),Xe}function tt(w,S){var B=n(),p=n(),C=n(),Q=n(),Z=n(),lt=n(),kt=n();return x(w[2],a),g(w[1],S),mt(C,w[1]),at(Q,C,u),xt(C,C,w[2]),q(Q,w[2],Q),mt(Z,Q),mt(lt,Z),at(kt,lt,Z),at(B,kt,C),at(B,B,Q),te(B,B),at(B,B,C),at(B,B,Q),at(B,B,Q),at(w[0],B,Q),mt(p,w[0]),at(p,p,Q),G(p,C)&&at(w[0],w[0],_),mt(p,w[0]),at(p,p,Q),G(p,C)?-1:(E(w[0])===S[31]>>7&&xt(w[0],r,w[0]),at(w[3],w[0],w[1]),0)}function ct(w,S,B,p){var C,Q=new Uint8Array(32),Z=new Uint8Array(64),lt=[n(),n(),n(),n()],kt=[n(),n(),n(),n()];if(B<64||tt(kt,p))return-1;for(C=0;C<B;C++)w[C]=S[C];for(C=0;C<32;C++)w[C+32]=p[C];if(Yt(Z,w,B),V(Z),re(lt,kt,Z),Jt(kt,S.subarray(32)),zt(lt,kt),We(Q,lt),B-=64,U(S,0,Q,0)){for(C=0;C<B;C++)w[C]=0;return-1}for(C=0;C<B;C++)w[C]=S[C+64];return B}var ut=32,yt=24,wt=32,pt=16,Pt=32,_t=32,Ct=32,Dt=32,ce=32,Qt=yt,ne=wt,le=pt,we=64,ae=32,Ye=64,ze=32,Je=64;e.lowlevel={crypto_core_hsalsa20:M,crypto_stream_xor:z,crypto_stream:et,crypto_stream_salsa20_xor:Y,crypto_stream_salsa20:X,crypto_onetimeauth:$,crypto_onetimeauth_verify:b,crypto_verify_16:k,crypto_verify_32:U,crypto_secretbox:h,crypto_secretbox_open:m,crypto_scalarmult:Oe,crypto_scalarmult_base:fe,crypto_box_beforenm:ve,crypto_box_afternm:Tn,crypto_box:dt,crypto_box_open:It,crypto_box_keypair:ee,crypto_hash:Yt,crypto_sign:W,crypto_sign_keypair:je,crypto_sign_open:ct,crypto_secretbox_KEYBYTES:ut,crypto_secretbox_NONCEBYTES:yt,crypto_secretbox_ZEROBYTES:wt,crypto_secretbox_BOXZEROBYTES:pt,crypto_scalarmult_BYTES:Pt,crypto_scalarmult_SCALARBYTES:_t,crypto_box_PUBLICKEYBYTES:Ct,crypto_box_SECRETKEYBYTES:Dt,crypto_box_BEFORENMBYTES:ce,crypto_box_NONCEBYTES:Qt,crypto_box_ZEROBYTES:ne,crypto_box_BOXZEROBYTES:le,crypto_sign_BYTES:we,crypto_sign_PUBLICKEYBYTES:ae,crypto_sign_SECRETKEYBYTES:Ye,crypto_sign_SEEDBYTES:ze,crypto_hash_BYTES:Je,gf:n,D:u,L:Ae,pack25519:j,unpack25519:g,M:at,A:q,S:mt,Z:xt,pow2523:te,add:zt,set25519:x,modL:L,scalarmult:re,scalarbase:Jt};function An(w,S){if(w.length!==ut)throw new Error("bad key size");if(S.length!==yt)throw new Error("bad nonce size")}function De(w,S){if(w.length!==Ct)throw new Error("bad public key size");if(S.length!==Dt)throw new Error("bad secret key size")}function Re(){for(var w=0;w<arguments.length;w++)if(!(arguments[w]instanceof Uint8Array))throw new TypeError("unexpected type, use Uint8Array")}function pn(w){for(var S=0;S<w.length;S++)w[S]=0}e.randomBytes=function(w){var S=new Uint8Array(w);return i(S,w),S},e.secretbox=function(w,S,B){Re(w,S,B),An(B,S);for(var p=new Uint8Array(wt+w.length),C=new Uint8Array(p.length),Q=0;Q<w.length;Q++)p[Q+wt]=w[Q];return h(C,p,p.length,S,B),C.subarray(pt)},e.secretbox.open=function(w,S,B){Re(w,S,B),An(B,S);for(var p=new Uint8Array(pt+w.length),C=new Uint8Array(p.length),Q=0;Q<w.length;Q++)p[Q+pt]=w[Q];return p.length<32||m(C,p,p.length,S,B)!==0?null:C.subarray(wt)},e.secretbox.keyLength=ut,e.secretbox.nonceLength=yt,e.secretbox.overheadLength=pt,e.scalarMult=function(w,S){if(Re(w,S),w.length!==_t)throw new Error("bad n size");if(S.length!==Pt)throw new Error("bad p size");var B=new Uint8Array(Pt);return Oe(B,w,S),B},e.scalarMult.base=function(w){if(Re(w),w.length!==_t)throw new Error("bad n size");var S=new Uint8Array(Pt);return fe(S,w),S},e.scalarMult.scalarLength=_t,e.scalarMult.groupElementLength=Pt,e.box=function(w,S,B,p){var C=e.box.before(B,p);return e.secretbox(w,S,C)},e.box.before=function(w,S){Re(w,S),De(w,S);var B=new Uint8Array(ce);return ve(B,w,S),B},e.box.after=e.secretbox,e.box.open=function(w,S,B,p){var C=e.box.before(B,p);return e.secretbox.open(w,S,C)},e.box.open.after=e.secretbox.open,e.box.keyPair=function(){var w=new Uint8Array(Ct),S=new Uint8Array(Dt);return ee(w,S),{publicKey:w,secretKey:S}},e.box.keyPair.fromSecretKey=function(w){if(Re(w),w.length!==Dt)throw new Error("bad secret key size");var S=new Uint8Array(Ct);return fe(S,w),{publicKey:S,secretKey:new Uint8Array(w)}},e.box.publicKeyLength=Ct,e.box.secretKeyLength=Dt,e.box.sharedKeyLength=ce,e.box.nonceLength=Qt,e.box.overheadLength=e.secretbox.overheadLength,e.sign=function(w,S){if(Re(w,S),S.length!==Ye)throw new Error("bad secret key size");var B=new Uint8Array(we+w.length);return W(B,w,w.length,S),B},e.sign.open=function(w,S){if(Re(w,S),S.length!==ae)throw new Error("bad public key size");var B=new Uint8Array(w.length),p=ct(B,w,w.length,S);if(p<0)return null;for(var C=new Uint8Array(p),Q=0;Q<C.length;Q++)C[Q]=B[Q];return C},e.sign.detached=function(w,S){for(var B=e.sign(w,S),p=new Uint8Array(we),C=0;C<p.length;C++)p[C]=B[C];return p},e.sign.detached.verify=function(w,S,B){if(Re(w,S,B),S.length!==we)throw new Error("bad signature size");if(B.length!==ae)throw new Error("bad public key size");var p=new Uint8Array(we+w.length),C=new Uint8Array(we+w.length),Q;for(Q=0;Q<we;Q++)p[Q]=S[Q];for(Q=0;Q<w.length;Q++)p[Q+we]=w[Q];return ct(C,p,p.length,B)>=0},e.sign.keyPair=function(){var w=new Uint8Array(ae),S=new Uint8Array(Ye);return je(w,S),{publicKey:w,secretKey:S}},e.sign.keyPair.fromSecretKey=function(w){if(Re(w),w.length!==Ye)throw new Error("bad secret key size");for(var S=new Uint8Array(ae),B=0;B<S.length;B++)S[B]=w[32+B];return{publicKey:S,secretKey:new Uint8Array(w)}},e.sign.keyPair.fromSeed=function(w){if(Re(w),w.length!==ze)throw new Error("bad seed size");for(var S=new Uint8Array(ae),B=new Uint8Array(Ye),p=0;p<32;p++)B[p]=w[p];return je(S,B,!0),{publicKey:S,secretKey:B}},e.sign.publicKeyLength=ae,e.sign.secretKeyLength=Ye,e.sign.seedLength=ze,e.sign.signatureLength=we,e.hash=function(w){Re(w);var S=new Uint8Array(Je);return Yt(S,w,w.length),S},e.hash.hashLength=Je,e.verify=function(w,S){return Re(w,S),w.length===0||S.length===0||w.length!==S.length?!1:v(w,0,S,0,w.length)===0},e.setPRNG=function(w){i=w},function(){var w=typeof self<"u"?self.crypto||self.msCrypto:null;if(w&&w.getRandomValues){var S=65536;e.setPRNG(function(B,p){var C,Q=new Uint8Array(p);for(C=0;C<p;C+=S)w.getRandomValues(Q.subarray(C,C+Math.min(p-C,S)));for(C=0;C<p;C++)B[C]=Q[C];pn(Q)})}else typeof C_<"u"&&(w=Wh,w&&w.randomBytes&&e.setPRNG(function(B,p){var C,Q=w.randomBytes(p);for(C=0;C<p;C++)B[C]=Q[C];pn(Q)}))}()})(t.exports?t.exports:self.nacl=self.nacl||{})})(M_);var li={},Rn={};Object.defineProperty(Rn,"__esModule",{value:!0});Rn.output=Rn.exists=Rn.hash=Rn.bytes=Rn.bool=Rn.number=void 0;function ja(t){if(!Number.isSafeInteger(t)||t<0)throw new Error(`Wrong positive integer: ${t}`)}Rn.number=ja;function Vh(t){if(typeof t!="boolean")throw new Error(`Expected boolean, not ${t}`)}Rn.bool=Vh;function kl(t,...e){if(!(t instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(e.length>0&&!e.includes(t.length))throw new TypeError(`Expected Uint8Array of length ${e}, not of length=${t.length}`)}Rn.bytes=kl;function Jh(t){if(typeof t!="function"||typeof t.create!="function")throw new Error("Hash should be wrapped by utils.wrapConstructor");ja(t.outputLen),ja(t.blockLen)}Rn.hash=Jh;function Zh(t,e=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(e&&t.finished)throw new Error("Hash#digest() has already been called")}Rn.exists=Zh;function Yh(t,e){kl(t);const n=e.outputLen;if(t.length<n)throw new Error(`digestInto() expects output buffer of length at least ${n}`)}Rn.output=Yh;const D_={number:ja,bool:Vh,bytes:kl,hash:Jh,exists:Zh,output:Yh};Rn.default=D_;var No={},Qh={},Qs={},dc={};Object.defineProperty(dc,"__esModule",{value:!0});dc.crypto=void 0;dc.crypto={node:void 0,web:typeof self=="object"&&"crypto"in self?self.crypto:void 0};(function(t){/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */Object.defineProperty(t,"__esModule",{value:!0}),t.randomBytes=t.wrapConstructorWithOpts=t.wrapConstructor=t.checkOpts=t.Hash=t.concatBytes=t.toBytes=t.utf8ToBytes=t.asyncLoop=t.nextTick=t.hexToBytes=t.bytesToHex=t.isLE=t.rotr=t.createView=t.u32=t.u8=void 0;const e=dc,n=P=>new Uint8Array(P.buffer,P.byteOffset,P.byteLength);t.u8=n;const i=P=>new Uint32Array(P.buffer,P.byteOffset,Math.floor(P.byteLength/4));t.u32=i;const s=P=>new DataView(P.buffer,P.byteOffset,P.byteLength);t.createView=s;const o=(P,M)=>P<<32-M|P>>>M;if(t.rotr=o,t.isLE=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68,!t.isLE)throw new Error("Non little-endian hardware is not supported");const r=Array.from({length:256},(P,M)=>M.toString(16).padStart(2,"0"));function a(P){if(!(P instanceof Uint8Array))throw new Error("Uint8Array expected");let M="";for(let K=0;K<P.length;K++)M+=r[P[K]];return M}t.bytesToHex=a;function c(P){if(typeof P!="string")throw new TypeError("hexToBytes: expected string, got "+typeof P);if(P.length%2)throw new Error("hexToBytes: received invalid unpadded hex");const M=new Uint8Array(P.length/2);for(let K=0;K<M.length;K++){const Y=K*2,X=P.slice(Y,Y+2),et=Number.parseInt(X,16);if(Number.isNaN(et)||et<0)throw new Error("Invalid byte sequence");M[K]=et}return M}t.hexToBytes=c;const u=async()=>{};t.nextTick=u;async function l(P,M,K){let Y=Date.now();for(let X=0;X<P;X++){K(X);const et=Date.now()-Y;et>=0&&et<M||(await(0,t.nextTick)(),Y+=et)}}t.asyncLoop=l;function d(P){if(typeof P!="string")throw new TypeError(`utf8ToBytes expected string, got ${typeof P}`);return new TextEncoder().encode(P)}t.utf8ToBytes=d;function f(P){if(typeof P=="string"&&(P=d(P)),!(P instanceof Uint8Array))throw new TypeError(`Expected input type is Uint8Array (got ${typeof P})`);return P}t.toBytes=f;function _(...P){if(!P.every(Y=>Y instanceof Uint8Array))throw new Error("Uint8Array list expected");if(P.length===1)return P[0];const M=P.reduce((Y,X)=>Y+X.length,0),K=new Uint8Array(M);for(let Y=0,X=0;Y<P.length;Y++){const et=P[Y];K.set(et,X),X+=et.length}return K}t.concatBytes=_;class T{clone(){return this._cloneInto()}}t.Hash=T;const v=P=>Object.prototype.toString.call(P)==="[object Object]"&&P.constructor===Object;function k(P,M){if(M!==void 0&&(typeof M!="object"||!v(M)))throw new TypeError("Options should be object or undefined");return Object.assign(P,M)}t.checkOpts=k;function U(P){const M=Y=>P().update(f(Y)).digest(),K=P();return M.outputLen=K.outputLen,M.blockLen=K.blockLen,M.create=()=>P(),M}t.wrapConstructor=U;function R(P){const M=(Y,X)=>P(X).update(f(Y)).digest(),K=P({});return M.outputLen=K.outputLen,M.blockLen=K.blockLen,M.create=Y=>P(Y),M}t.wrapConstructorWithOpts=R;function A(P=32){if(e.crypto.web)return e.crypto.web.getRandomValues(new Uint8Array(P));if(e.crypto.node)return new Uint8Array(e.crypto.node.randomBytes(P).buffer);throw new Error("The environment doesn't have randomBytes function")}t.randomBytes=A})(Qs);(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.hmac=void 0;const e=Rn,n=Qs;class i extends n.Hash{constructor(r,a){super(),this.finished=!1,this.destroyed=!1,e.default.hash(r);const c=(0,n.toBytes)(a);if(this.iHash=r.create(),typeof this.iHash.update!="function")throw new TypeError("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const u=this.blockLen,l=new Uint8Array(u);l.set(c.length>u?r.create().update(c).digest():c);for(let d=0;d<l.length;d++)l[d]^=54;this.iHash.update(l),this.oHash=r.create();for(let d=0;d<l.length;d++)l[d]^=106;this.oHash.update(l),l.fill(0)}update(r){return e.default.exists(this),this.iHash.update(r),this}digestInto(r){e.default.exists(this),e.default.bytes(r,this.outputLen),this.finished=!0,this.iHash.digestInto(r),this.oHash.update(r),this.oHash.digestInto(r),this.destroy()}digest(){const r=new Uint8Array(this.oHash.outputLen);return this.digestInto(r),r}_cloneInto(r){r||(r=Object.create(Object.getPrototypeOf(this),{}));const{oHash:a,iHash:c,finished:u,destroyed:l,blockLen:d,outputLen:f}=this;return r=r,r.finished=u,r.destroyed=l,r.blockLen=d,r.outputLen=f,r.oHash=a._cloneInto(r.oHash),r.iHash=c._cloneInto(r.iHash),r}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}}const s=(o,r,a)=>new i(o,r).update(a).digest();t.hmac=s,t.hmac.create=(o,r)=>new i(o,r)})(Qh);Object.defineProperty(No,"__esModule",{value:!0});No.pbkdf2Async=No.pbkdf2=void 0;const da=Rn,L_=Qh,Ro=Qs;function tf(t,e,n,i){da.default.hash(t);const s=(0,Ro.checkOpts)({dkLen:32,asyncTick:10},i),{c:o,dkLen:r,asyncTick:a}=s;if(da.default.number(o),da.default.number(r),da.default.number(a),o<1)throw new Error("PBKDF2: iterations (c) should be >= 1");const c=(0,Ro.toBytes)(e),u=(0,Ro.toBytes)(n),l=new Uint8Array(r),d=L_.hmac.create(t,c),f=d._cloneInto().update(u);return{c:o,dkLen:r,asyncTick:a,DK:l,PRF:d,PRFSalt:f}}function ef(t,e,n,i,s){return t.destroy(),e.destroy(),i&&i.destroy(),s.fill(0),n}function N_(t,e,n,i){const{c:s,dkLen:o,DK:r,PRF:a,PRFSalt:c}=tf(t,e,n,i);let u;const l=new Uint8Array(4),d=(0,Ro.createView)(l),f=new Uint8Array(a.outputLen);for(let _=1,T=0;T<o;_++,T+=a.outputLen){const v=r.subarray(T,T+a.outputLen);d.setInt32(0,_,!1),(u=c._cloneInto(u)).update(l).digestInto(f),v.set(f.subarray(0,v.length));for(let k=1;k<s;k++){a._cloneInto(u).update(f).digestInto(f);for(let U=0;U<v.length;U++)v[U]^=f[U]}}return ef(a,c,r,u,f)}No.pbkdf2=N_;async function F_(t,e,n,i){const{c:s,dkLen:o,asyncTick:r,DK:a,PRF:c,PRFSalt:u}=tf(t,e,n,i);let l;const d=new Uint8Array(4),f=(0,Ro.createView)(d),_=new Uint8Array(c.outputLen);for(let T=1,v=0;v<o;T++,v+=c.outputLen){const k=a.subarray(v,v+c.outputLen);f.setInt32(0,T,!1),(l=u._cloneInto(l)).update(d).digestInto(_),k.set(_.subarray(0,k.length)),await(0,Ro.asyncLoop)(s-1,r,U=>{c._cloneInto(l).update(_).digestInto(_);for(let R=0;R<k.length;R++)k[R]^=_[R]})}return ef(c,u,a,l,_)}No.pbkdf2Async=F_;var Fo={},jr={};Object.defineProperty(jr,"__esModule",{value:!0});jr.SHA2=void 0;const bu=Rn,_r=Qs;function j_(t,e,n,i){if(typeof t.setBigUint64=="function")return t.setBigUint64(e,n,i);const s=BigInt(32),o=BigInt(4294967295),r=Number(n>>s&o),a=Number(n&o),c=i?4:0,u=i?0:4;t.setUint32(e+c,r,i),t.setUint32(e+u,a,i)}let z_=class extends _r.Hash{constructor(e,n,i,s){super(),this.blockLen=e,this.outputLen=n,this.padOffset=i,this.isLE=s,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(e),this.view=(0,_r.createView)(this.buffer)}update(e){bu.default.exists(this);const{view:n,buffer:i,blockLen:s}=this;e=(0,_r.toBytes)(e);const o=e.length;for(let r=0;r<o;){const a=Math.min(s-this.pos,o-r);if(a===s){const c=(0,_r.createView)(e);for(;s<=o-r;r+=s)this.process(c,r);continue}i.set(e.subarray(r,r+a),this.pos),this.pos+=a,r+=a,this.pos===s&&(this.process(n,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){bu.default.exists(this),bu.default.output(e,this),this.finished=!0;const{buffer:n,view:i,blockLen:s,isLE:o}=this;let{pos:r}=this;n[r++]=128,this.buffer.subarray(r).fill(0),this.padOffset>s-r&&(this.process(i,0),r=0);for(let d=r;d<s;d++)n[d]=0;j_(i,s-8,BigInt(this.length*8),o),this.process(i,0);const a=(0,_r.createView)(e),c=this.outputLen;if(c%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const u=c/4,l=this.get();if(u>l.length)throw new Error("_sha2: outputLen bigger than state");for(let d=0;d<u;d++)a.setUint32(4*d,l[d],o)}digest(){const{buffer:e,outputLen:n}=this;this.digestInto(e);const i=e.slice(0,n);return this.destroy(),i}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());const{blockLen:n,buffer:i,length:s,finished:o,destroyed:r,pos:a}=this;return e.length=s,e.pos=a,e.finished=o,e.destroyed=r,s%n&&e.buffer.set(i),e}};jr.SHA2=z_;Object.defineProperty(Fo,"__esModule",{value:!0});Fo.sha224=Fo.sha256=void 0;const H_=jr,mi=Qs,K_=(t,e,n)=>t&e^~t&n,G_=(t,e,n)=>t&e^t&n^e&n,W_=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),ss=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),os=new Uint32Array(64);let nf=class extends H_.SHA2{constructor(){super(64,32,8,!1),this.A=ss[0]|0,this.B=ss[1]|0,this.C=ss[2]|0,this.D=ss[3]|0,this.E=ss[4]|0,this.F=ss[5]|0,this.G=ss[6]|0,this.H=ss[7]|0}get(){const{A:e,B:n,C:i,D:s,E:o,F:r,G:a,H:c}=this;return[e,n,i,s,o,r,a,c]}set(e,n,i,s,o,r,a,c){this.A=e|0,this.B=n|0,this.C=i|0,this.D=s|0,this.E=o|0,this.F=r|0,this.G=a|0,this.H=c|0}process(e,n){for(let d=0;d<16;d++,n+=4)os[d]=e.getUint32(n,!1);for(let d=16;d<64;d++){const f=os[d-15],_=os[d-2],T=(0,mi.rotr)(f,7)^(0,mi.rotr)(f,18)^f>>>3,v=(0,mi.rotr)(_,17)^(0,mi.rotr)(_,19)^_>>>10;os[d]=v+os[d-7]+T+os[d-16]|0}let{A:i,B:s,C:o,D:r,E:a,F:c,G:u,H:l}=this;for(let d=0;d<64;d++){const f=(0,mi.rotr)(a,6)^(0,mi.rotr)(a,11)^(0,mi.rotr)(a,25),_=l+f+K_(a,c,u)+W_[d]+os[d]|0,v=((0,mi.rotr)(i,2)^(0,mi.rotr)(i,13)^(0,mi.rotr)(i,22))+G_(i,s,o)|0;l=u,u=c,c=a,a=r+_|0,r=o,o=s,s=i,i=_+v|0}i=i+this.A|0,s=s+this.B|0,o=o+this.C|0,r=r+this.D|0,a=a+this.E|0,c=c+this.F|0,u=u+this.G|0,l=l+this.H|0,this.set(i,s,o,r,a,c,u,l)}roundClean(){os.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}},X_=class extends nf{constructor(){super(),this.A=-1056596264,this.B=914150663,this.C=812702999,this.D=-150054599,this.E=-4191439,this.F=1750603025,this.G=1694076839,this.H=-1090891868,this.outputLen=28}};Fo.sha256=(0,mi.wrapConstructor)(()=>new nf);Fo.sha224=(0,mi.wrapConstructor)(()=>new X_);var ki={},sf={};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.add=t.toBig=t.split=t.fromBig=void 0;const e=BigInt(2**32-1),n=BigInt(32);function i(z,O=!1){return O?{h:Number(z&e),l:Number(z>>n&e)}:{h:Number(z>>n&e)|0,l:Number(z&e)|0}}t.fromBig=i;function s(z,O=!1){let $=new Uint32Array(z.length),b=new Uint32Array(z.length);for(let h=0;h<z.length;h++){const{h:m,l:x}=i(z[h],O);[$[h],b[h]]=[m,x]}return[$,b]}t.split=s;const o=(z,O)=>BigInt(z>>>0)<<n|BigInt(O>>>0);t.toBig=o;const r=(z,O,$)=>z>>>$,a=(z,O,$)=>z<<32-$|O>>>$,c=(z,O,$)=>z>>>$|O<<32-$,u=(z,O,$)=>z<<32-$|O>>>$,l=(z,O,$)=>z<<64-$|O>>>$-32,d=(z,O,$)=>z>>>$-32|O<<64-$,f=(z,O)=>O,_=(z,O)=>z,T=(z,O,$)=>z<<$|O>>>32-$,v=(z,O,$)=>O<<$|z>>>32-$,k=(z,O,$)=>O<<$-32|z>>>64-$,U=(z,O,$)=>z<<$-32|O>>>64-$;function R(z,O,$,b){const h=(O>>>0)+(b>>>0);return{h:z+$+(h/2**32|0)|0,l:h|0}}t.add=R;const A=(z,O,$)=>(z>>>0)+(O>>>0)+($>>>0),P=(z,O,$,b)=>O+$+b+(z/2**32|0)|0,M=(z,O,$,b)=>(z>>>0)+(O>>>0)+($>>>0)+(b>>>0),K=(z,O,$,b,h)=>O+$+b+h+(z/2**32|0)|0,Y=(z,O,$,b,h)=>(z>>>0)+(O>>>0)+($>>>0)+(b>>>0)+(h>>>0),X=(z,O,$,b,h,m)=>O+$+b+h+m+(z/2**32|0)|0,et={fromBig:i,split:s,toBig:t.toBig,shrSH:r,shrSL:a,rotrSH:c,rotrSL:u,rotrBH:l,rotrBL:d,rotr32H:f,rotr32L:_,rotlSH:T,rotlSL:v,rotlBH:k,rotlBL:U,add:R,add3L:A,add3H:P,add4L:M,add4H:K,add5H:X,add5L:Y};t.default=et})(sf);Object.defineProperty(ki,"__esModule",{value:!0});ki.sha384=ki.sha512_256=ki.sha512_224=ki.sha512=ki.SHA512=void 0;const V_=jr,Ne=sf,hc=Qs,[J_,Z_]=Ne.default.split(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(t=>BigInt(t))),rs=new Uint32Array(80),as=new Uint32Array(80);let zr=class extends V_.SHA2{constructor(){super(128,64,16,!1),this.Ah=1779033703,this.Al=-205731576,this.Bh=-1150833019,this.Bl=-2067093701,this.Ch=1013904242,this.Cl=-23791573,this.Dh=-1521486534,this.Dl=1595750129,this.Eh=1359893119,this.El=-1377402159,this.Fh=-1694144372,this.Fl=725511199,this.Gh=528734635,this.Gl=-79577749,this.Hh=1541459225,this.Hl=327033209}get(){const{Ah:e,Al:n,Bh:i,Bl:s,Ch:o,Cl:r,Dh:a,Dl:c,Eh:u,El:l,Fh:d,Fl:f,Gh:_,Gl:T,Hh:v,Hl:k}=this;return[e,n,i,s,o,r,a,c,u,l,d,f,_,T,v,k]}set(e,n,i,s,o,r,a,c,u,l,d,f,_,T,v,k){this.Ah=e|0,this.Al=n|0,this.Bh=i|0,this.Bl=s|0,this.Ch=o|0,this.Cl=r|0,this.Dh=a|0,this.Dl=c|0,this.Eh=u|0,this.El=l|0,this.Fh=d|0,this.Fl=f|0,this.Gh=_|0,this.Gl=T|0,this.Hh=v|0,this.Hl=k|0}process(e,n){for(let A=0;A<16;A++,n+=4)rs[A]=e.getUint32(n),as[A]=e.getUint32(n+=4);for(let A=16;A<80;A++){const P=rs[A-15]|0,M=as[A-15]|0,K=Ne.default.rotrSH(P,M,1)^Ne.default.rotrSH(P,M,8)^Ne.default.shrSH(P,M,7),Y=Ne.default.rotrSL(P,M,1)^Ne.default.rotrSL(P,M,8)^Ne.default.shrSL(P,M,7),X=rs[A-2]|0,et=as[A-2]|0,z=Ne.default.rotrSH(X,et,19)^Ne.default.rotrBH(X,et,61)^Ne.default.shrSH(X,et,6),O=Ne.default.rotrSL(X,et,19)^Ne.default.rotrBL(X,et,61)^Ne.default.shrSL(X,et,6),$=Ne.default.add4L(Y,O,as[A-7],as[A-16]),b=Ne.default.add4H($,K,z,rs[A-7],rs[A-16]);rs[A]=b|0,as[A]=$|0}let{Ah:i,Al:s,Bh:o,Bl:r,Ch:a,Cl:c,Dh:u,Dl:l,Eh:d,El:f,Fh:_,Fl:T,Gh:v,Gl:k,Hh:U,Hl:R}=this;for(let A=0;A<80;A++){const P=Ne.default.rotrSH(d,f,14)^Ne.default.rotrSH(d,f,18)^Ne.default.rotrBH(d,f,41),M=Ne.default.rotrSL(d,f,14)^Ne.default.rotrSL(d,f,18)^Ne.default.rotrBL(d,f,41),K=d&_^~d&v,Y=f&T^~f&k,X=Ne.default.add5L(R,M,Y,Z_[A],as[A]),et=Ne.default.add5H(X,U,P,K,J_[A],rs[A]),z=X|0,O=Ne.default.rotrSH(i,s,28)^Ne.default.rotrBH(i,s,34)^Ne.default.rotrBH(i,s,39),$=Ne.default.rotrSL(i,s,28)^Ne.default.rotrBL(i,s,34)^Ne.default.rotrBL(i,s,39),b=i&o^i&a^o&a,h=s&r^s&c^r&c;U=v|0,R=k|0,v=_|0,k=T|0,_=d|0,T=f|0,{h:d,l:f}=Ne.default.add(u|0,l|0,et|0,z|0),u=a|0,l=c|0,a=o|0,c=r|0,o=i|0,r=s|0;const m=Ne.default.add3L(z,$,h);i=Ne.default.add3H(m,et,O,b),s=m|0}({h:i,l:s}=Ne.default.add(this.Ah|0,this.Al|0,i|0,s|0)),{h:o,l:r}=Ne.default.add(this.Bh|0,this.Bl|0,o|0,r|0),{h:a,l:c}=Ne.default.add(this.Ch|0,this.Cl|0,a|0,c|0),{h:u,l}=Ne.default.add(this.Dh|0,this.Dl|0,u|0,l|0),{h:d,l:f}=Ne.default.add(this.Eh|0,this.El|0,d|0,f|0),{h:_,l:T}=Ne.default.add(this.Fh|0,this.Fl|0,_|0,T|0),{h:v,l:k}=Ne.default.add(this.Gh|0,this.Gl|0,v|0,k|0),{h:U,l:R}=Ne.default.add(this.Hh|0,this.Hl|0,U|0,R|0),this.set(i,s,o,r,a,c,u,l,d,f,_,T,v,k,U,R)}roundClean(){rs.fill(0),as.fill(0)}destroy(){this.buffer.fill(0),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}};ki.SHA512=zr;let Y_=class extends zr{constructor(){super(),this.Ah=-1942145080,this.Al=424955298,this.Bh=1944164710,this.Bl=-1982016298,this.Ch=502970286,this.Cl=855612546,this.Dh=1738396948,this.Dl=1479516111,this.Eh=258812777,this.El=2077511080,this.Fh=2011393907,this.Fl=79989058,this.Gh=1067287976,this.Gl=1780299464,this.Hh=286451373,this.Hl=-1848208735,this.outputLen=28}},Q_=class extends zr{constructor(){super(),this.Ah=573645204,this.Al=-64227540,this.Bh=-1621794909,this.Bl=-934517566,this.Ch=596883563,this.Cl=1867755857,this.Dh=-1774684391,this.Dl=1497426621,this.Eh=-1775747358,this.El=-1467023389,this.Fh=-1101128155,this.Fl=1401305490,this.Gh=721525244,this.Gl=746961066,this.Hh=246885852,this.Hl=-2117784414,this.outputLen=32}},tm=class extends zr{constructor(){super(),this.Ah=-876896931,this.Al=-1056596264,this.Bh=1654270250,this.Bl=914150663,this.Ch=-1856437926,this.Cl=812702999,this.Dh=355462360,this.Dl=-150054599,this.Eh=1731405415,this.El=-4191439,this.Fh=-1900787065,this.Fl=1750603025,this.Gh=-619958771,this.Gl=1694076839,this.Hh=1203062813,this.Hl=-1090891868,this.outputLen=48}};ki.sha512=(0,hc.wrapConstructor)(()=>new zr);ki.sha512_224=(0,hc.wrapConstructor)(()=>new Y_);ki.sha512_256=(0,hc.wrapConstructor)(()=>new Q_);ki.sha384=(0,hc.wrapConstructor)(()=>new tm);var Sl={};(function(t){/*! scure-base - MIT License (c) 2022 Paul Miller (paulmillr.com) */Object.defineProperty(t,"__esModule",{value:!0}),t.bytes=t.stringToBytes=t.str=t.bytesToString=t.hex=t.utf8=t.bech32m=t.bech32=t.base58check=t.base58xmr=t.base58xrp=t.base58flickr=t.base58=t.base64urlnopad=t.base64url=t.base64=t.base32crockford=t.base32hex=t.base32=t.base16=t.utils=t.assertNumber=void 0;function e(O){if(!Number.isSafeInteger(O))throw new Error(`Wrong integer: ${O}`)}t.assertNumber=e;function n(...O){const $=(m,x)=>I=>m(x(I)),b=Array.from(O).reverse().reduce((m,x)=>m?$(m,x.encode):x.encode,void 0),h=O.reduce((m,x)=>m?$(m,x.decode):x.decode,void 0);return{encode:b,decode:h}}function i(O){return{encode:$=>{if(!Array.isArray($)||$.length&&typeof $[0]!="number")throw new Error("alphabet.encode input should be an array of numbers");return $.map(b=>{if(b<0||b>=O.length)throw new Error(`Digit index outside alphabet: ${b} (alphabet: ${O.length})`);return O[b]})},decode:$=>{if(!Array.isArray($)||$.length&&typeof $[0]!="string")throw new Error("alphabet.decode input should be array of strings");return $.map(b=>{if(typeof b!="string")throw new Error(`alphabet.decode: not string element=${b}`);const h=O.indexOf(b);if(h===-1)throw new Error(`Unknown letter: "${b}". Allowed: ${O}`);return h})}}}function s(O=""){if(typeof O!="string")throw new Error("join separator should be string");return{encode:$=>{if(!Array.isArray($)||$.length&&typeof $[0]!="string")throw new Error("join.encode input should be array of strings");for(let b of $)if(typeof b!="string")throw new Error(`join.encode: non-string input=${b}`);return $.join(O)},decode:$=>{if(typeof $!="string")throw new Error("join.decode input should be string");return $.split(O)}}}function o(O,$="="){if(typeof $!="string")throw new Error("padding chr should be string");return{encode(b){if(!Array.isArray(b)||b.length&&typeof b[0]!="string")throw new Error("padding.encode input should be array of strings");for(let h of b)if(typeof h!="string")throw new Error(`padding.encode: non-string input=${h}`);for(;b.length*O%8;)b.push($);return b},decode(b){if(!Array.isArray(b)||b.length&&typeof b[0]!="string")throw new Error("padding.encode input should be array of strings");for(let m of b)if(typeof m!="string")throw new Error(`padding.decode: non-string input=${m}`);let h=b.length;if(h*O%8)throw new Error("Invalid padding: string should have whole number of bytes");for(;h>0&&b[h-1]===$;h--)if(!((h-1)*O%8))throw new Error("Invalid padding: string has too much padding");return b.slice(0,h)}}}function r(O){if(typeof O!="function")throw new Error("normalize fn should be function");return{encode:$=>$,decode:$=>O($)}}function a(O,$,b){if($<2)throw new Error(`convertRadix: wrong from=${$}, base cannot be less than 2`);if(b<2)throw new Error(`convertRadix: wrong to=${b}, base cannot be less than 2`);if(!Array.isArray(O))throw new Error("convertRadix: data should be array");if(!O.length)return[];let h=0;const m=[],x=Array.from(O);for(x.forEach(I=>{if(I<0||I>=$)throw new Error(`Wrong integer: ${I}`)});;){let I=0,N=!0;for(let j=h;j<x.length;j++){const G=x[j],E=$*I+G;if(!Number.isSafeInteger(E)||$*I/$!==I||E-G!==$*I)throw new Error("convertRadix: carry overflow");I=E%b;const g=Math.floor(E/b);if(x[j]=g,!Number.isSafeInteger(g)||g*b+I!==E)throw new Error("convertRadix: carry overflow");if(N)g?N=!1:h=j;else continue}if(m.push(I),N)break}for(let I=0;I<O.length-1&&O[I]===0;I++)m.push(0);return m.reverse()}const c=(O,$)=>$?c($,O%$):O,u=(O,$)=>O+($-c(O,$));function l(O,$,b,h){if(!Array.isArray(O))throw new Error("convertRadix2: data should be array");if($<=0||$>32)throw new Error(`convertRadix2: wrong from=${$}`);if(b<=0||b>32)throw new Error(`convertRadix2: wrong to=${b}`);if(u($,b)>32)throw new Error(`convertRadix2: carry overflow from=${$} to=${b} carryBits=${u($,b)}`);let m=0,x=0;const I=2**b-1,N=[];for(const j of O){if(j>=2**$)throw new Error(`convertRadix2: invalid data word=${j} from=${$}`);if(m=m<<$|j,x+$>32)throw new Error(`convertRadix2: carry overflow pos=${x} from=${$}`);for(x+=$;x>=b;x-=b)N.push((m>>x-b&I)>>>0);m&=2**x-1}if(m=m<<b-x&I,!h&&x>=$)throw new Error("Excess padding");if(!h&&m)throw new Error(`Non-zero padding: ${m}`);return h&&x>0&&N.push(m>>>0),N}function d(O){return{encode:$=>{if(!($ instanceof Uint8Array))throw new Error("radix.encode input should be Uint8Array");return a(Array.from($),2**8,O)},decode:$=>{if(!Array.isArray($)||$.length&&typeof $[0]!="number")throw new Error("radix.decode input should be array of strings");return Uint8Array.from(a($,O,2**8))}}}function f(O,$=!1){if(O<=0||O>32)throw new Error("radix2: bits should be in (0..32]");if(u(8,O)>32||u(O,8)>32)throw new Error("radix2: carry overflow");return{encode:b=>{if(!(b instanceof Uint8Array))throw new Error("radix2.encode input should be Uint8Array");return l(Array.from(b),8,O,!$)},decode:b=>{if(!Array.isArray(b)||b.length&&typeof b[0]!="number")throw new Error("radix2.decode input should be array of strings");return Uint8Array.from(l(b,O,8,$))}}}function _(O){if(typeof O!="function")throw new Error("unsafeWrapper fn should be function");return function(...$){try{return O.apply(null,$)}catch{}}}function T(O,$){if(typeof $!="function")throw new Error("checksum fn should be function");return{encode(b){if(!(b instanceof Uint8Array))throw new Error("checksum.encode: input should be Uint8Array");const h=$(b).slice(0,O),m=new Uint8Array(b.length+O);return m.set(b),m.set(h,b.length),m},decode(b){if(!(b instanceof Uint8Array))throw new Error("checksum.decode: input should be Uint8Array");const h=b.slice(0,-O),m=$(h).slice(0,O),x=b.slice(-O);for(let I=0;I<O;I++)if(m[I]!==x[I])throw new Error("Invalid checksum");return h}}}t.utils={alphabet:i,chain:n,checksum:T,radix:d,radix2:f,join:s,padding:o},t.base16=n(f(4),i("0123456789ABCDEF"),s("")),t.base32=n(f(5),i("ABCDEFGHIJKLMNOPQRSTUVWXYZ234567"),o(5),s("")),t.base32hex=n(f(5),i("0123456789ABCDEFGHIJKLMNOPQRSTUV"),o(5),s("")),t.base32crockford=n(f(5),i("0123456789ABCDEFGHJKMNPQRSTVWXYZ"),s(""),r(O=>O.toUpperCase().replace(/O/g,"0").replace(/[IL]/g,"1"))),t.base64=n(f(6),i("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"),o(6),s("")),t.base64url=n(f(6),i("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_"),o(6),s("")),t.base64urlnopad=n(f(6),i("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_"),s(""));const v=O=>n(d(58),i(O),s(""));t.base58=v("123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"),t.base58flickr=v("123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"),t.base58xrp=v("rpshnaf39wBUDNEGHJKLM4PQRST7VWXYZ2bcdeCg65jkm8oFqi1tuvAxyz");const k=[0,2,3,5,6,7,9,10,11];t.base58xmr={encode(O){let $="";for(let b=0;b<O.length;b+=8){const h=O.subarray(b,b+8);$+=t.base58.encode(h).padStart(k[h.length],"1")}return $},decode(O){let $=[];for(let b=0;b<O.length;b+=11){const h=O.slice(b,b+11),m=k.indexOf(h.length),x=t.base58.decode(h);for(let I=0;I<x.length-m;I++)if(x[I]!==0)throw new Error("base58xmr: wrong padding");$=$.concat(Array.from(x.slice(x.length-m)))}return Uint8Array.from($)}};const U=O=>n(T(4,$=>O(O($))),t.base58);t.base58check=U;const R=n(i("qpzry9x8gf2tvdw0s3jn54khce6mua7l"),s("")),A=[996825010,642813549,513874426,1027748829,705979059];function P(O){const $=O>>25;let b=(O&33554431)<<5;for(let h=0;h<A.length;h++)($>>h&1)===1&&(b^=A[h]);return b}function M(O,$,b=1){const h=O.length;let m=1;for(let x=0;x<h;x++){const I=O.charCodeAt(x);if(I<33||I>126)throw new Error(`Invalid prefix (${O})`);m=P(m)^I>>5}m=P(m);for(let x=0;x<h;x++)m=P(m)^O.charCodeAt(x)&31;for(let x of $)m=P(m)^x;for(let x=0;x<6;x++)m=P(m);return m^=b,R.encode(l([m%2**30],30,5,!1))}function K(O){const $=O==="bech32"?1:734539939,b=f(5),h=b.decode,m=b.encode,x=_(h);function I(E,g,q=90){if(typeof E!="string")throw new Error(`bech32.encode prefix should be string, not ${typeof E}`);if(!Array.isArray(g)||g.length&&typeof g[0]!="number")throw new Error(`bech32.encode words should be array of numbers, not ${typeof g}`);const xt=E.length+7+g.length;if(q!==!1&&xt>q)throw new TypeError(`Length ${xt} exceeds limit ${q}`);const at=E.toLowerCase(),mt=M(at,g,$);return`${at}1${R.encode(g)}${mt}`}function N(E,g=90){if(typeof E!="string")throw new Error(`bech32.decode input should be string, not ${typeof E}`);if(E.length<8||g!==!1&&E.length>g)throw new TypeError(`Wrong string length: ${E.length} (${E}). Expected (8..${g})`);const q=E.toLowerCase();if(E!==q&&E!==E.toUpperCase())throw new Error("String must be lowercase or uppercase");E=q;const xt=E.lastIndexOf("1");if(xt===0||xt===-1)throw new Error('Letter "1" must be present between prefix and data only');const at=E.slice(0,xt),mt=E.slice(xt+1);if(mt.length<6)throw new Error("Data must be at least 6 characters long");const se=R.decode(mt).slice(0,-6),te=M(at,se,$);if(!mt.endsWith(te))throw new Error(`Invalid checksum in ${E}: expected "${te}"`);return{prefix:at,words:se}}const j=_(N);function G(E){const{prefix:g,words:q}=N(E,!1);return{prefix:g,words:q,bytes:h(q)}}return{encode:I,decode:N,decodeToBytes:G,decodeUnsafe:j,fromWords:h,fromWordsUnsafe:x,toWords:m}}t.bech32=K("bech32"),t.bech32m=K("bech32m"),t.utf8={encode:O=>new TextDecoder().decode(O),decode:O=>new TextEncoder().encode(O)},t.hex=n(f(4),i("0123456789abcdef"),s(""),r(O=>{if(typeof O!="string"||O.length%2)throw new TypeError(`hex.decode: expected string, got ${typeof O} with length ${O.length}`);return O.toLowerCase()}));const Y={utf8:t.utf8,hex:t.hex,base16:t.base16,base32:t.base32,base64:t.base64,base64url:t.base64url,base58:t.base58,base58xmr:t.base58xmr},X="Invalid encoding type. Available types: utf8, hex, base16, base32, base64, base64url, base58, base58xmr",et=(O,$)=>{if(typeof O!="string"||!Y.hasOwnProperty(O))throw new TypeError(X);if(!($ instanceof Uint8Array))throw new TypeError("bytesToString() expects Uint8Array");return Y[O].encode($)};t.bytesToString=et,t.str=t.bytesToString;const z=(O,$)=>{if(!Y.hasOwnProperty(O))throw new TypeError(X);if(typeof $!="string")throw new TypeError("stringToBytes() expects string");return Y[O].decode($)};t.stringToBytes=z,t.bytes=t.stringToBytes})(Sl);Object.defineProperty(li,"__esModule",{value:!0});var of=li.mnemonicToSeedSync=li.mnemonicToSeed=li.validateMnemonic=li.entropyToMnemonic=li.mnemonicToEntropy=li.generateMnemonic=void 0;/*! scure-bip39 - MIT License (c) 2022 Patricio Palladino, Paul Miller (paulmillr.com) */const rf=Rn,af=No,em=Fo,cf=ki,nm=Qs,ha=Sl,im=t=>t[0]==="あいこくしん";function uf(t){if(typeof t!="string")throw new TypeError(`Invalid mnemonic type: ${typeof t}`);return t.normalize("NFKD")}function Pl(t){const e=uf(t),n=e.split(" ");if(![12,15,18,21,24].includes(n.length))throw new Error("Invalid mnemonic");return{nfkd:e,words:n}}function lf(t){rf.default.bytes(t,16,20,24,28,32)}function sm(t,e=128){if(rf.default.number(e),e%32!==0||e>256)throw new TypeError("Invalid entropy");return ff((0,nm.randomBytes)(e/8),t)}li.generateMnemonic=sm;const om=t=>{const e=8-t.length/4;return new Uint8Array([(0,em.sha256)(t)[0]>>e<<e])};function df(t){if(!Array.isArray(t)||t.length!==2**11||typeof t[0]!="string")throw new Error("Worlist: expected array of 2048 strings");return t.forEach(e=>{if(typeof e!="string")throw new Error(`Wordlist: non-string element: ${e}`)}),ha.utils.chain(ha.utils.checksum(1,om),ha.utils.radix2(11,!0),ha.utils.alphabet(t))}function hf(t,e){const{words:n}=Pl(t),i=df(e).decode(n);return lf(i),i}li.mnemonicToEntropy=hf;function ff(t,e){return lf(t),df(e).encode(t).join(im(e)?"　":" ")}li.entropyToMnemonic=ff;function rm(t,e){try{hf(t,e)}catch{return!1}return!0}li.validateMnemonic=rm;const pf=t=>uf(`mnemonic${t}`);function am(t,e=""){return(0,af.pbkdf2Async)(cf.sha512,Pl(t).nfkd,pf(e),{c:2048,dkLen:64})}li.mnemonicToSeed=am;function cm(t,e=""){return(0,af.pbkdf2)(cf.sha512,Pl(t).nfkd,pf(e),{c:2048,dkLen:64})}of=li.mnemonicToSeedSync=cm;/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */const um=t=>new Uint32Array(t.buffer,t.byteOffset,Math.floor(t.byteLength/4)),vu=t=>new DataView(t.buffer,t.byteOffset,t.byteLength),Li=(t,e)=>t<<32-e|t>>>e,lm=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;if(!lm)throw new Error("Non little-endian hardware is not supported");const dm=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function gf(t){if(!(t instanceof Uint8Array))throw new Error("Uint8Array expected");let e="";for(let n=0;n<t.length;n++)e+=dm[t[n]];return e}function _f(t){if(typeof t!="string")throw new TypeError("hexToBytes: expected string, got "+typeof t);if(t.length%2)throw new Error("hexToBytes: received invalid unpadded hex");const e=new Uint8Array(t.length/2);for(let n=0;n<e.length;n++){const i=n*2,s=t.slice(i,i+2),o=Number.parseInt(s,16);if(Number.isNaN(o)||o<0)throw new Error("Invalid byte sequence");e[n]=o}return e}function hm(t){if(typeof t!="string")throw new TypeError(`utf8ToBytes expected string, got ${typeof t}`);return new TextEncoder().encode(t)}function Hr(t){if(typeof t=="string"&&(t=hm(t)),!(t instanceof Uint8Array))throw new TypeError(`Expected input type is Uint8Array (got ${typeof t})`);return t}let Bl=class{clone(){return this._cloneInto()}};function Kr(t){const e=i=>t().update(Hr(i)).digest(),n=t();return e.outputLen=n.outputLen,e.blockLen=n.blockLen,e.create=()=>t(),e}function fm(t){const e=(i,s)=>t(s).update(Hr(i)).digest(),n=t({});return e.outputLen=n.outputLen,e.blockLen=n.blockLen,e.create=i=>t(i),e}function Qu(t){if(!Number.isSafeInteger(t)||t<0)throw new Error(`Wrong positive integer: ${t}`)}function pm(t){if(typeof t!="boolean")throw new Error(`Expected boolean, not ${t}`)}function mf(t,...e){if(!(t instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(e.length>0&&!e.includes(t.length))throw new TypeError(`Expected Uint8Array of length ${e}, not of length=${t.length}`)}function gm(t){if(typeof t!="function"||typeof t.create!="function")throw new Error("Hash should be wrapped by utils.wrapConstructor");Qu(t.outputLen),Qu(t.blockLen)}function _m(t,e=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(e&&t.finished)throw new Error("Hash#digest() has already been called")}function mm(t,e){mf(t);const n=e.outputLen;if(t.length<n)throw new Error(`digestInto() expects output buffer of length at least ${n}`)}const di={number:Qu,bool:pm,bytes:mf,hash:gm,exists:_m,output:mm};function ym(t,e,n,i){if(typeof t.setBigUint64=="function")return t.setBigUint64(e,n,i);const s=BigInt(32),o=BigInt(4294967295),r=Number(n>>s&o),a=Number(n&o),c=i?4:0,u=i?0:4;t.setUint32(e+c,r,i),t.setUint32(e+u,a,i)}let yf=class extends Bl{constructor(e,n,i,s){super(),this.blockLen=e,this.outputLen=n,this.padOffset=i,this.isLE=s,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(e),this.view=vu(this.buffer)}update(e){di.exists(this);const{view:n,buffer:i,blockLen:s}=this;e=Hr(e);const o=e.length;for(let r=0;r<o;){const a=Math.min(s-this.pos,o-r);if(a===s){const c=vu(e);for(;s<=o-r;r+=s)this.process(c,r);continue}i.set(e.subarray(r,r+a),this.pos),this.pos+=a,r+=a,this.pos===s&&(this.process(n,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){di.exists(this),di.output(e,this),this.finished=!0;const{buffer:n,view:i,blockLen:s,isLE:o}=this;let{pos:r}=this;n[r++]=128,this.buffer.subarray(r).fill(0),this.padOffset>s-r&&(this.process(i,0),r=0);for(let c=r;c<s;c++)n[c]=0;ym(i,s-8,BigInt(this.length*8),o),this.process(i,0);const a=vu(e);this.get().forEach((c,u)=>a.setUint32(4*u,c,o))}digest(){const{buffer:e,outputLen:n}=this;this.digestInto(e);const i=e.slice(0,n);return this.destroy(),i}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());const{blockLen:n,buffer:i,length:s,finished:o,destroyed:r,pos:a}=this;return e.length=s,e.pos=a,e.finished=o,e.destroyed=r,s%n&&e.buffer.set(i),e}};const wm=(t,e,n)=>t&e^~t&n,bm=(t,e,n)=>t&e^t&n^e&n,vm=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),cs=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),us=new Uint32Array(64);let xm=class extends yf{constructor(){super(64,32,8,!1),this.A=cs[0]|0,this.B=cs[1]|0,this.C=cs[2]|0,this.D=cs[3]|0,this.E=cs[4]|0,this.F=cs[5]|0,this.G=cs[6]|0,this.H=cs[7]|0}get(){const{A:e,B:n,C:i,D:s,E:o,F:r,G:a,H:c}=this;return[e,n,i,s,o,r,a,c]}set(e,n,i,s,o,r,a,c){this.A=e|0,this.B=n|0,this.C=i|0,this.D=s|0,this.E=o|0,this.F=r|0,this.G=a|0,this.H=c|0}process(e,n){for(let d=0;d<16;d++,n+=4)us[d]=e.getUint32(n,!1);for(let d=16;d<64;d++){const f=us[d-15],_=us[d-2],T=Li(f,7)^Li(f,18)^f>>>3,v=Li(_,17)^Li(_,19)^_>>>10;us[d]=v+us[d-7]+T+us[d-16]|0}let{A:i,B:s,C:o,D:r,E:a,F:c,G:u,H:l}=this;for(let d=0;d<64;d++){const f=Li(a,6)^Li(a,11)^Li(a,25),_=l+f+wm(a,c,u)+vm[d]+us[d]|0,v=(Li(i,2)^Li(i,13)^Li(i,22))+bm(i,s,o)|0;l=u,u=c,c=a,a=r+_|0,r=o,o=s,s=i,i=_+v|0}i=i+this.A|0,s=s+this.B|0,o=o+this.C|0,r=r+this.D|0,a=a+this.E|0,c=c+this.F|0,u=u+this.G|0,l=l+this.H|0,this.set(i,s,o,r,a,c,u,l)}roundClean(){us.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}};const Tm=Kr(()=>new xm),fa=BigInt(2**32-1),tl=BigInt(32);function wf(t,e=!1){return e?{h:Number(t&fa),l:Number(t>>tl&fa)}:{h:Number(t>>tl&fa)|0,l:Number(t&fa)|0}}function Am(t,e=!1){let n=new Uint32Array(t.length),i=new Uint32Array(t.length);for(let s=0;s<t.length;s++){const{h:o,l:r}=wf(t[s],e);[n[s],i[s]]=[o,r]}return[n,i]}const km=(t,e)=>BigInt(t>>>0)<<tl|BigInt(e>>>0),Sm=(t,e,n)=>t>>>n,Pm=(t,e,n)=>t<<32-n|e>>>n,Bm=(t,e,n)=>t>>>n|e<<32-n,Em=(t,e,n)=>t<<32-n|e>>>n,Cm=(t,e,n)=>t<<64-n|e>>>n-32,Im=(t,e,n)=>t>>>n-32|e<<64-n,Om=(t,e)=>e,Rm=(t,e)=>t,Um=(t,e,n)=>t<<n|e>>>32-n,$m=(t,e,n)=>e<<n|t>>>32-n,qm=(t,e,n)=>e<<n-32|t>>>64-n,Mm=(t,e,n)=>t<<n-32|e>>>64-n;function Dm(t,e,n,i){const s=(e>>>0)+(i>>>0);return{h:t+n+(s/2**32|0)|0,l:s|0}}const Lm=(t,e,n)=>(t>>>0)+(e>>>0)+(n>>>0),Nm=(t,e,n,i)=>e+n+i+(t/2**32|0)|0,Fm=(t,e,n,i)=>(t>>>0)+(e>>>0)+(n>>>0)+(i>>>0),jm=(t,e,n,i,s)=>e+n+i+s+(t/2**32|0)|0,zm=(t,e,n,i,s)=>(t>>>0)+(e>>>0)+(n>>>0)+(i>>>0)+(s>>>0),Hm=(t,e,n,i,s,o)=>e+n+i+s+o+(t/2**32|0)|0,Pe={fromBig:wf,split:Am,toBig:km,shrSH:Sm,shrSL:Pm,rotrSH:Bm,rotrSL:Em,rotrBH:Cm,rotrBL:Im,rotr32H:Om,rotr32L:Rm,rotlSH:Um,rotlSL:$m,rotlBH:qm,rotlBL:Mm,add:Dm,add3L:Lm,add3H:Nm,add4L:Fm,add4H:jm,add5H:Hm,add5L:zm},[bf,vf,xf]=[[],[],[]],Km=BigInt(0),mr=BigInt(1),Gm=BigInt(2),Wm=BigInt(7),Xm=BigInt(256),Vm=BigInt(113);for(let t=0,e=mr,n=1,i=0;t<24;t++){[n,i]=[i,(2*n+3*i)%5],bf.push(2*(5*i+n)),vf.push((t+1)*(t+2)/2%64);let s=Km;for(let o=0;o<7;o++)e=(e<<mr^(e>>Wm)*Vm)%Xm,e&Gm&&(s^=mr<<(mr<<BigInt(o))-mr);xf.push(s)}const[Jm,Zm]=Pe.split(xf,!0),Ad=(t,e,n)=>n>32?Pe.rotlBH(t,e,n):Pe.rotlSH(t,e,n),kd=(t,e,n)=>n>32?Pe.rotlBL(t,e,n):Pe.rotlSL(t,e,n);function Ym(t,e=24){const n=new Uint32Array(10);for(let i=24-e;i<24;i++){for(let r=0;r<10;r++)n[r]=t[r]^t[r+10]^t[r+20]^t[r+30]^t[r+40];for(let r=0;r<10;r+=2){const a=(r+8)%10,c=(r+2)%10,u=n[c],l=n[c+1],d=Ad(u,l,1)^n[a],f=kd(u,l,1)^n[a+1];for(let _=0;_<50;_+=10)t[r+_]^=d,t[r+_+1]^=f}let s=t[2],o=t[3];for(let r=0;r<24;r++){const a=vf[r],c=Ad(s,o,a),u=kd(s,o,a),l=bf[r];s=t[l],o=t[l+1],t[l]=c,t[l+1]=u}for(let r=0;r<50;r+=10){for(let a=0;a<10;a++)n[a]=t[r+a];for(let a=0;a<10;a++)t[r+a]^=~n[(a+2)%10]&n[(a+4)%10]}t[0]^=Jm[i],t[1]^=Zm[i]}n.fill(0)}let Tf=class Af extends Bl{constructor(e,n,i,s=!1,o=24){if(super(),this.blockLen=e,this.suffix=n,this.outputLen=i,this.enableXOF=s,this.rounds=o,this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,di.number(i),0>=this.blockLen||this.blockLen>=200)throw new Error("Sha3 supports only keccak-f1600 function");this.state=new Uint8Array(200),this.state32=um(this.state)}keccak(){Ym(this.state32,this.rounds),this.posOut=0,this.pos=0}update(e){di.exists(this);const{blockLen:n,state:i}=this;e=Hr(e);const s=e.length;for(let o=0;o<s;){const r=Math.min(n-this.pos,s-o);for(let a=0;a<r;a++)i[this.pos++]^=e[o++];this.pos===n&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;const{state:e,suffix:n,pos:i,blockLen:s}=this;e[i]^=n,n&128&&i===s-1&&this.keccak(),e[s-1]^=128,this.keccak()}writeInto(e){di.exists(this,!1),di.bytes(e),this.finish();const n=this.state,{blockLen:i}=this;for(let s=0,o=e.length;s<o;){this.posOut>=i&&this.keccak();const r=Math.min(i-this.posOut,o-s);e.set(n.subarray(this.posOut,this.posOut+r),s),this.posOut+=r,s+=r}return e}xofInto(e){if(!this.enableXOF)throw new Error("XOF is not possible for this instance");return this.writeInto(e)}xof(e){return di.number(e),this.xofInto(new Uint8Array(e))}digestInto(e){if(di.output(e,this),this.finished)throw new Error("digest() was already called");return this.writeInto(e),this.destroy(),e}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,this.state.fill(0)}_cloneInto(e){const{blockLen:n,suffix:i,outputLen:s,rounds:o,enableXOF:r}=this;return e||(e=new Af(n,i,s,r,o)),e.state32.set(this.state32),e.pos=this.pos,e.posOut=this.posOut,e.finished=this.finished,e.rounds=o,e.suffix=i,e.outputLen=s,e.enableXOF=r,e.destroyed=this.destroyed,e}};const Is=(t,e,n)=>Kr(()=>new Tf(e,t,n));Is(6,144,224/8);const jo=Is(6,136,256/8);Is(6,104,384/8);Is(6,72,512/8);Is(1,144,224/8);Is(1,136,256/8);Is(1,104,384/8);Is(1,72,512/8);const kf=(t,e,n)=>fm((i={})=>new Tf(e,t,i.dkLen===void 0?n:i.dkLen,!0));kf(31,168,128/8);kf(31,136,256/8);let Sf=class extends Bl{constructor(e,n){super(),this.finished=!1,this.destroyed=!1,di.hash(e);const i=Hr(n);if(this.iHash=e.create(),typeof this.iHash.update!="function")throw new TypeError("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const s=this.blockLen,o=new Uint8Array(s);o.set(i.length>s?e.create().update(i).digest():i);for(let r=0;r<o.length;r++)o[r]^=54;this.iHash.update(o),this.oHash=e.create();for(let r=0;r<o.length;r++)o[r]^=106;this.oHash.update(o),o.fill(0)}update(e){return di.exists(this),this.iHash.update(e),this}digestInto(e){di.exists(this),di.bytes(e,this.outputLen),this.finished=!0,this.iHash.digestInto(e),this.oHash.update(e),this.oHash.digestInto(e),this.destroy()}digest(){const e=new Uint8Array(this.oHash.outputLen);return this.digestInto(e),e}_cloneInto(e){e||(e=Object.create(Object.getPrototypeOf(this),{}));const{oHash:n,iHash:i,finished:s,destroyed:o,blockLen:r,outputLen:a}=this;return e=e,e.finished=s,e.destroyed=o,e.blockLen=r,e.outputLen=a,e.oHash=n._cloneInto(e.oHash),e.iHash=i._cloneInto(e.iHash),e}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}};const El=(t,e,n)=>new Sf(t,e).update(n).digest();El.create=(t,e)=>new Sf(t,e);const[Qm,ty]=Pe.split(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(t=>BigInt(t))),ls=new Uint32Array(80),ds=new Uint32Array(80);let Cl=class extends yf{constructor(){super(128,64,16,!1),this.Ah=1779033703,this.Al=-205731576,this.Bh=-1150833019,this.Bl=-2067093701,this.Ch=1013904242,this.Cl=-23791573,this.Dh=-1521486534,this.Dl=1595750129,this.Eh=1359893119,this.El=-1377402159,this.Fh=-1694144372,this.Fl=725511199,this.Gh=528734635,this.Gl=-79577749,this.Hh=1541459225,this.Hl=327033209}get(){const{Ah:e,Al:n,Bh:i,Bl:s,Ch:o,Cl:r,Dh:a,Dl:c,Eh:u,El:l,Fh:d,Fl:f,Gh:_,Gl:T,Hh:v,Hl:k}=this;return[e,n,i,s,o,r,a,c,u,l,d,f,_,T,v,k]}set(e,n,i,s,o,r,a,c,u,l,d,f,_,T,v,k){this.Ah=e|0,this.Al=n|0,this.Bh=i|0,this.Bl=s|0,this.Ch=o|0,this.Cl=r|0,this.Dh=a|0,this.Dl=c|0,this.Eh=u|0,this.El=l|0,this.Fh=d|0,this.Fl=f|0,this.Gh=_|0,this.Gl=T|0,this.Hh=v|0,this.Hl=k|0}process(e,n){for(let A=0;A<16;A++,n+=4)ls[A]=e.getUint32(n),ds[A]=e.getUint32(n+=4);for(let A=16;A<80;A++){const P=ls[A-15]|0,M=ds[A-15]|0,K=Pe.rotrSH(P,M,1)^Pe.rotrSH(P,M,8)^Pe.shrSH(P,M,7),Y=Pe.rotrSL(P,M,1)^Pe.rotrSL(P,M,8)^Pe.shrSL(P,M,7),X=ls[A-2]|0,et=ds[A-2]|0,z=Pe.rotrSH(X,et,19)^Pe.rotrBH(X,et,61)^Pe.shrSH(X,et,6),O=Pe.rotrSL(X,et,19)^Pe.rotrBL(X,et,61)^Pe.shrSL(X,et,6),$=Pe.add4L(Y,O,ds[A-7],ds[A-16]),b=Pe.add4H($,K,z,ls[A-7],ls[A-16]);ls[A]=b|0,ds[A]=$|0}let{Ah:i,Al:s,Bh:o,Bl:r,Ch:a,Cl:c,Dh:u,Dl:l,Eh:d,El:f,Fh:_,Fl:T,Gh:v,Gl:k,Hh:U,Hl:R}=this;for(let A=0;A<80;A++){const P=Pe.rotrSH(d,f,14)^Pe.rotrSH(d,f,18)^Pe.rotrBH(d,f,41),M=Pe.rotrSL(d,f,14)^Pe.rotrSL(d,f,18)^Pe.rotrBL(d,f,41),K=d&_^~d&v,Y=f&T^~f&k,X=Pe.add5L(R,M,Y,ty[A],ds[A]),et=Pe.add5H(X,U,P,K,Qm[A],ls[A]),z=X|0,O=Pe.rotrSH(i,s,28)^Pe.rotrBH(i,s,34)^Pe.rotrBH(i,s,39),$=Pe.rotrSL(i,s,28)^Pe.rotrBL(i,s,34)^Pe.rotrBL(i,s,39),b=i&o^i&a^o&a,h=s&r^s&c^r&c;U=v|0,R=k|0,v=_|0,k=T|0,_=d|0,T=f|0,{h:d,l:f}=Pe.add(u|0,l|0,et|0,z|0),u=a|0,l=c|0,a=o|0,c=r|0,o=i|0,r=s|0;const m=Pe.add3L(z,$,h);i=Pe.add3H(m,et,O,b),s=m|0}({h:i,l:s}=Pe.add(this.Ah|0,this.Al|0,i|0,s|0)),{h:o,l:r}=Pe.add(this.Bh|0,this.Bl|0,o|0,r|0),{h:a,l:c}=Pe.add(this.Ch|0,this.Cl|0,a|0,c|0),{h:u,l}=Pe.add(this.Dh|0,this.Dl|0,u|0,l|0),{h:d,l:f}=Pe.add(this.Eh|0,this.El|0,d|0,f|0),{h:_,l:T}=Pe.add(this.Fh|0,this.Fl|0,_|0,T|0),{h:v,l:k}=Pe.add(this.Gh|0,this.Gl|0,v|0,k|0),{h:U,l:R}=Pe.add(this.Hh|0,this.Hl|0,U|0,R|0),this.set(i,s,o,r,a,c,u,l,d,f,_,T,v,k,U,R)}roundClean(){ls.fill(0),ds.fill(0)}destroy(){this.buffer.fill(0),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}},ey=class extends Cl{constructor(){super(),this.Ah=573645204,this.Al=-64227540,this.Bh=-1621794909,this.Bl=-934517566,this.Ch=596883563,this.Cl=1867755857,this.Dh=-1774684391,this.Dl=1497426621,this.Eh=-1775747358,this.El=-1467023389,this.Fh=-1101128155,this.Fl=1401305490,this.Gh=721525244,this.Gl=746961066,this.Hh=246885852,this.Hl=-2117784414,this.outputLen=32}},ny=class extends Cl{constructor(){super(),this.Ah=-876896931,this.Al=-1056596264,this.Bh=1654270250,this.Bl=914150663,this.Ch=-1856437926,this.Cl=812702999,this.Dh=355462360,this.Dl=-150054599,this.Eh=1731405415,this.El=-4191439,this.Fh=-1900787065,this.Fl=1750603025,this.Gh=-619958771,this.Gl=1694076839,this.Hh=1203062813,this.Hl=-1090891868,this.outputLen=48}};const Pf=Kr(()=>new Cl);Kr(()=>new ey);Kr(()=>new ny);var el={},iy={get exports(){return el},set exports(t){el=t}},za={},sy={get exports(){return za},set exports(t){za=t}},Bf=function(e,n){return function(){for(var s=new Array(arguments.length),o=0;o<s.length;o++)s[o]=arguments[o];return e.apply(n,s)}},oy=Bf,Il=Object.prototype.toString,Ol=function(t){return function(e){var n=Il.call(e);return t[n]||(t[n]=n.slice(8,-1).toLowerCase())}}(Object.create(null));function to(t){return t=t.toLowerCase(),function(n){return Ol(n)===t}}function Rl(t){return Array.isArray(t)}function Ha(t){return typeof t>"u"}function ry(t){return t!==null&&!Ha(t)&&t.constructor!==null&&!Ha(t.constructor)&&typeof t.constructor.isBuffer=="function"&&t.constructor.isBuffer(t)}var Ef=to("ArrayBuffer");function ay(t){var e;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?e=ArrayBuffer.isView(t):e=t&&t.buffer&&Ef(t.buffer),e}function cy(t){return typeof t=="string"}function uy(t){return typeof t=="number"}function Cf(t){return t!==null&&typeof t=="object"}function Pa(t){if(Ol(t)!=="object")return!1;var e=Object.getPrototypeOf(t);return e===null||e===Object.prototype}var ly=to("Date"),dy=to("File"),hy=to("Blob"),fy=to("FileList");function Ul(t){return Il.call(t)==="[object Function]"}function py(t){return Cf(t)&&Ul(t.pipe)}function gy(t){var e="[object FormData]";return t&&(typeof FormData=="function"&&t instanceof FormData||Il.call(t)===e||Ul(t.toString)&&t.toString()===e)}var _y=to("URLSearchParams");function my(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")}function yy(){return typeof navigator<"u"&&(navigator.product==="ReactNative"||navigator.product==="NativeScript"||navigator.product==="NS")?!1:typeof window<"u"&&typeof document<"u"}function $l(t,e){if(!(t===null||typeof t>"u"))if(typeof t!="object"&&(t=[t]),Rl(t))for(var n=0,i=t.length;n<i;n++)e.call(null,t[n],n,t);else for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&e.call(null,t[s],s,t)}function nl(){var t={};function e(s,o){Pa(t[o])&&Pa(s)?t[o]=nl(t[o],s):Pa(s)?t[o]=nl({},s):Rl(s)?t[o]=s.slice():t[o]=s}for(var n=0,i=arguments.length;n<i;n++)$l(arguments[n],e);return t}function wy(t,e,n){return $l(e,function(s,o){n&&typeof s=="function"?t[o]=oy(s,n):t[o]=s}),t}function by(t){return t.charCodeAt(0)===65279&&(t=t.slice(1)),t}function vy(t,e,n,i){t.prototype=Object.create(e.prototype,i),t.prototype.constructor=t,n&&Object.assign(t.prototype,n)}function xy(t,e,n){var i,s,o,r={};e=e||{};do{for(i=Object.getOwnPropertyNames(t),s=i.length;s-- >0;)o=i[s],r[o]||(e[o]=t[o],r[o]=!0);t=Object.getPrototypeOf(t)}while(t&&(!n||n(t,e))&&t!==Object.prototype);return e}function Ty(t,e,n){t=String(t),(n===void 0||n>t.length)&&(n=t.length),n-=e.length;var i=t.indexOf(e,n);return i!==-1&&i===n}function Ay(t){if(!t)return null;var e=t.length;if(Ha(e))return null;for(var n=new Array(e);e-- >0;)n[e]=t[e];return n}var ky=function(t){return function(e){return t&&e instanceof t}}(typeof Uint8Array<"u"&&Object.getPrototypeOf(Uint8Array)),Kn={isArray:Rl,isArrayBuffer:Ef,isBuffer:ry,isFormData:gy,isArrayBufferView:ay,isString:cy,isNumber:uy,isObject:Cf,isPlainObject:Pa,isUndefined:Ha,isDate:ly,isFile:dy,isBlob:hy,isFunction:Ul,isStream:py,isURLSearchParams:_y,isStandardBrowserEnv:yy,forEach:$l,merge:nl,extend:wy,trim:my,stripBOM:by,inherits:vy,toFlatObject:xy,kindOf:Ol,kindOfTest:to,endsWith:Ty,toArray:Ay,isTypedArray:ky,isFileList:fy},go=Kn;function Sd(t){return encodeURIComponent(t).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}var If=function(e,n,i){if(!n)return e;var s;if(i)s=i(n);else if(go.isURLSearchParams(n))s=n.toString();else{var o=[];go.forEach(n,function(c,u){c===null||typeof c>"u"||(go.isArray(c)?u=u+"[]":c=[c],go.forEach(c,function(d){go.isDate(d)?d=d.toISOString():go.isObject(d)&&(d=JSON.stringify(d)),o.push(Sd(u)+"="+Sd(d))}))}),s=o.join("&")}if(s){var r=e.indexOf("#");r!==-1&&(e=e.slice(0,r)),e+=(e.indexOf("?")===-1?"?":"&")+s}return e},Sy=Kn;function fc(){this.handlers=[]}fc.prototype.use=function(e,n,i){return this.handlers.push({fulfilled:e,rejected:n,synchronous:i?i.synchronous:!1,runWhen:i?i.runWhen:null}),this.handlers.length-1};fc.prototype.eject=function(e){this.handlers[e]&&(this.handlers[e]=null)};fc.prototype.forEach=function(e){Sy.forEach(this.handlers,function(i){i!==null&&e(i)})};var Py=fc,By=Kn,Ey=function(e,n){By.forEach(e,function(s,o){o!==n&&o.toUpperCase()===n.toUpperCase()&&(e[n]=s,delete e[o])})},Of=Kn;function zo(t,e,n,i,s){Error.call(this),this.message=t,this.name="AxiosError",e&&(this.code=e),n&&(this.config=n),i&&(this.request=i),s&&(this.response=s)}Of.inherits(zo,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:this.config,code:this.code,status:this.response&&this.response.status?this.response.status:null}}});var Rf=zo.prototype,Uf={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED"].forEach(function(t){Uf[t]={value:t}});Object.defineProperties(zo,Uf);Object.defineProperty(Rf,"isAxiosError",{value:!0});zo.from=function(t,e,n,i,s,o){var r=Object.create(Rf);return Of.toFlatObject(t,r,function(c){return c!==Error.prototype}),zo.call(r,t.message,e,n,i,s),r.name=t.name,o&&Object.assign(r,o),r};var ir=zo,$f={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},Ei=Kn;function Cy(t,e){e=e||new FormData;var n=[];function i(o){return o===null?"":Ei.isDate(o)?o.toISOString():Ei.isArrayBuffer(o)||Ei.isTypedArray(o)?typeof Blob=="function"?new Blob([o]):Buffer.from(o):o}function s(o,r){if(Ei.isPlainObject(o)||Ei.isArray(o)){if(n.indexOf(o)!==-1)throw Error("Circular reference detected in "+r);n.push(o),Ei.forEach(o,function(c,u){if(!Ei.isUndefined(c)){var l=r?r+"."+u:u,d;if(c&&!r&&typeof c=="object"){if(Ei.endsWith(u,"{}"))c=JSON.stringify(c);else if(Ei.endsWith(u,"[]")&&(d=Ei.toArray(c))){d.forEach(function(f){!Ei.isUndefined(f)&&e.append(l,i(f))});return}}s(c,l)}}),n.pop()}else e.append(r,i(o))}return s(t),e}var qf=Cy,xu,Pd;function Iy(){if(Pd)return xu;Pd=1;var t=ir;return xu=function(n,i,s){var o=s.config.validateStatus;!s.status||!o||o(s.status)?n(s):i(new t("Request failed with status code "+s.status,[t.ERR_BAD_REQUEST,t.ERR_BAD_RESPONSE][Math.floor(s.status/100)-4],s.config,s.request,s))},xu}var Tu,Bd;function Oy(){if(Bd)return Tu;Bd=1;var t=Kn;return Tu=t.isStandardBrowserEnv()?function(){return{write:function(i,s,o,r,a,c){var u=[];u.push(i+"="+encodeURIComponent(s)),t.isNumber(o)&&u.push("expires="+new Date(o).toGMTString()),t.isString(r)&&u.push("path="+r),t.isString(a)&&u.push("domain="+a),c===!0&&u.push("secure"),document.cookie=u.join("; ")},read:function(i){var s=document.cookie.match(new RegExp("(^|;\\s*)("+i+")=([^;]*)"));return s?decodeURIComponent(s[3]):null},remove:function(i){this.write(i,"",Date.now()-864e5)}}}():function(){return{write:function(){},read:function(){return null},remove:function(){}}}(),Tu}var Ry=function(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)},Uy=function(e,n){return n?e.replace(/\/+$/,"")+"/"+n.replace(/^\/+/,""):e},$y=Ry,qy=Uy,Mf=function(e,n){return e&&!$y(n)?qy(e,n):n},Au,Ed;function My(){if(Ed)return Au;Ed=1;var t=Kn,e=["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"];return Au=function(i){var s={},o,r,a;return i&&t.forEach(i.split(`
`),function(u){if(a=u.indexOf(":"),o=t.trim(u.substr(0,a)).toLowerCase(),r=t.trim(u.substr(a+1)),o){if(s[o]&&e.indexOf(o)>=0)return;o==="set-cookie"?s[o]=(s[o]?s[o]:[]).concat([r]):s[o]=s[o]?s[o]+", "+r:r}}),s},Au}var ku,Cd;function Dy(){if(Cd)return ku;Cd=1;var t=Kn;return ku=t.isStandardBrowserEnv()?function(){var n=/(msie|trident)/i.test(navigator.userAgent),i=document.createElement("a"),s;function o(r){var a=r;return n&&(i.setAttribute("href",a),a=i.href),i.setAttribute("href",a),{href:i.href,protocol:i.protocol?i.protocol.replace(/:$/,""):"",host:i.host,search:i.search?i.search.replace(/^\?/,""):"",hash:i.hash?i.hash.replace(/^#/,""):"",hostname:i.hostname,port:i.port,pathname:i.pathname.charAt(0)==="/"?i.pathname:"/"+i.pathname}}return s=o(window.location.href),function(a){var c=t.isString(a)?o(a):a;return c.protocol===s.protocol&&c.host===s.host}}():function(){return function(){return!0}}(),ku}var Su,Id;function pc(){if(Id)return Su;Id=1;var t=ir,e=Kn;function n(i){t.call(this,i??"canceled",t.ERR_CANCELED),this.name="CanceledError"}return e.inherits(n,t,{__CANCEL__:!0}),Su=n,Su}var Pu,Od;function Ly(){return Od||(Od=1,Pu=function(e){var n=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return n&&n[1]||""}),Pu}var Bu,Rd;function Ud(){if(Rd)return Bu;Rd=1;var t=Kn,e=Iy(),n=Oy(),i=If,s=Mf,o=My(),r=Dy(),a=$f,c=ir,u=pc(),l=Ly();return Bu=function(f){return new Promise(function(T,v){var k=f.data,U=f.headers,R=f.responseType,A;function P(){f.cancelToken&&f.cancelToken.unsubscribe(A),f.signal&&f.signal.removeEventListener("abort",A)}t.isFormData(k)&&t.isStandardBrowserEnv()&&delete U["Content-Type"];var M=new XMLHttpRequest;if(f.auth){var K=f.auth.username||"",Y=f.auth.password?unescape(encodeURIComponent(f.auth.password)):"";U.Authorization="Basic "+btoa(K+":"+Y)}var X=s(f.baseURL,f.url);M.open(f.method.toUpperCase(),i(X,f.params,f.paramsSerializer),!0),M.timeout=f.timeout;function et(){if(M){var $="getAllResponseHeaders"in M?o(M.getAllResponseHeaders()):null,b=!R||R==="text"||R==="json"?M.responseText:M.response,h={data:b,status:M.status,statusText:M.statusText,headers:$,config:f,request:M};e(function(x){T(x),P()},function(x){v(x),P()},h),M=null}}if("onloadend"in M?M.onloadend=et:M.onreadystatechange=function(){!M||M.readyState!==4||M.status===0&&!(M.responseURL&&M.responseURL.indexOf("file:")===0)||setTimeout(et)},M.onabort=function(){M&&(v(new c("Request aborted",c.ECONNABORTED,f,M)),M=null)},M.onerror=function(){v(new c("Network Error",c.ERR_NETWORK,f,M,M)),M=null},M.ontimeout=function(){var b=f.timeout?"timeout of "+f.timeout+"ms exceeded":"timeout exceeded",h=f.transitional||a;f.timeoutErrorMessage&&(b=f.timeoutErrorMessage),v(new c(b,h.clarifyTimeoutError?c.ETIMEDOUT:c.ECONNABORTED,f,M)),M=null},t.isStandardBrowserEnv()){var z=(f.withCredentials||r(X))&&f.xsrfCookieName?n.read(f.xsrfCookieName):void 0;z&&(U[f.xsrfHeaderName]=z)}"setRequestHeader"in M&&t.forEach(U,function(b,h){typeof k>"u"&&h.toLowerCase()==="content-type"?delete U[h]:M.setRequestHeader(h,b)}),t.isUndefined(f.withCredentials)||(M.withCredentials=!!f.withCredentials),R&&R!=="json"&&(M.responseType=f.responseType),typeof f.onDownloadProgress=="function"&&M.addEventListener("progress",f.onDownloadProgress),typeof f.onUploadProgress=="function"&&M.upload&&M.upload.addEventListener("progress",f.onUploadProgress),(f.cancelToken||f.signal)&&(A=function($){M&&(v(!$||$&&$.type?new u:$),M.abort(),M=null)},f.cancelToken&&f.cancelToken.subscribe(A),f.signal&&(f.signal.aborted?A():f.signal.addEventListener("abort",A))),k||(k=null);var O=l(X);if(O&&["http","https","file"].indexOf(O)===-1){v(new c("Unsupported protocol "+O+":",c.ERR_BAD_REQUEST,f));return}M.send(k)})},Bu}var Eu,$d;function Ny(){return $d||($d=1,Eu=null),Eu}var Cn=Kn,qd=Ey,Md=ir,Fy=$f,jy=qf,zy={"Content-Type":"application/x-www-form-urlencoded"};function Dd(t,e){!Cn.isUndefined(t)&&Cn.isUndefined(t["Content-Type"])&&(t["Content-Type"]=e)}function Hy(){var t;return(typeof XMLHttpRequest<"u"||typeof process<"u"&&Object.prototype.toString.call(process)==="[object process]")&&(t=Ud()),t}function Ky(t,e,n){if(Cn.isString(t))try{return(e||JSON.parse)(t),Cn.trim(t)}catch(i){if(i.name!=="SyntaxError")throw i}return(n||JSON.stringify)(t)}var gc={transitional:Fy,adapter:Hy(),transformRequest:[function(e,n){if(qd(n,"Accept"),qd(n,"Content-Type"),Cn.isFormData(e)||Cn.isArrayBuffer(e)||Cn.isBuffer(e)||Cn.isStream(e)||Cn.isFile(e)||Cn.isBlob(e))return e;if(Cn.isArrayBufferView(e))return e.buffer;if(Cn.isURLSearchParams(e))return Dd(n,"application/x-www-form-urlencoded;charset=utf-8"),e.toString();var i=Cn.isObject(e),s=n&&n["Content-Type"],o;if((o=Cn.isFileList(e))||i&&s==="multipart/form-data"){var r=this.env&&this.env.FormData;return jy(o?{"files[]":e}:e,r&&new r)}else if(i||s==="application/json")return Dd(n,"application/json"),Ky(e);return e}],transformResponse:[function(e){var n=this.transitional||gc.transitional,i=n&&n.silentJSONParsing,s=n&&n.forcedJSONParsing,o=!i&&this.responseType==="json";if(o||s&&Cn.isString(e)&&e.length)try{return JSON.parse(e)}catch(r){if(o)throw r.name==="SyntaxError"?Md.from(r,Md.ERR_BAD_RESPONSE,this,null,this.response):r}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:Ny()},validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*"}}};Cn.forEach(["delete","get","head"],function(e){gc.headers[e]={}});Cn.forEach(["post","put","patch"],function(e){gc.headers[e]=Cn.merge(zy)});var ql=gc,Gy=Kn,Wy=ql,Xy=function(e,n,i){var s=this||Wy;return Gy.forEach(i,function(r){e=r.call(s,e,n)}),e},Cu,Ld;function Df(){return Ld||(Ld=1,Cu=function(e){return!!(e&&e.__CANCEL__)}),Cu}var Nd=Kn,Iu=Xy,Vy=Df(),Jy=ql,Zy=pc();function Ou(t){if(t.cancelToken&&t.cancelToken.throwIfRequested(),t.signal&&t.signal.aborted)throw new Zy}var Yy=function(e){Ou(e),e.headers=e.headers||{},e.data=Iu.call(e,e.data,e.headers,e.transformRequest),e.headers=Nd.merge(e.headers.common||{},e.headers[e.method]||{},e.headers),Nd.forEach(["delete","get","head","post","put","patch","common"],function(s){delete e.headers[s]});var n=e.adapter||Jy.adapter;return n(e).then(function(s){return Ou(e),s.data=Iu.call(e,s.data,s.headers,e.transformResponse),s},function(s){return Vy(s)||(Ou(e),s&&s.response&&(s.response.data=Iu.call(e,s.response.data,s.response.headers,e.transformResponse))),Promise.reject(s)})},ci=Kn,Lf=function(e,n){n=n||{};var i={};function s(l,d){return ci.isPlainObject(l)&&ci.isPlainObject(d)?ci.merge(l,d):ci.isPlainObject(d)?ci.merge({},d):ci.isArray(d)?d.slice():d}function o(l){if(ci.isUndefined(n[l])){if(!ci.isUndefined(e[l]))return s(void 0,e[l])}else return s(e[l],n[l])}function r(l){if(!ci.isUndefined(n[l]))return s(void 0,n[l])}function a(l){if(ci.isUndefined(n[l])){if(!ci.isUndefined(e[l]))return s(void 0,e[l])}else return s(void 0,n[l])}function c(l){if(l in n)return s(e[l],n[l]);if(l in e)return s(void 0,e[l])}var u={url:r,method:r,data:r,baseURL:a,transformRequest:a,transformResponse:a,paramsSerializer:a,timeout:a,timeoutMessage:a,withCredentials:a,adapter:a,responseType:a,xsrfCookieName:a,xsrfHeaderName:a,onUploadProgress:a,onDownloadProgress:a,decompress:a,maxContentLength:a,maxBodyLength:a,beforeRedirect:a,transport:a,httpAgent:a,httpsAgent:a,cancelToken:a,socketPath:a,responseEncoding:a,validateStatus:c};return ci.forEach(Object.keys(e).concat(Object.keys(n)),function(d){var f=u[d]||o,_=f(d);ci.isUndefined(_)&&f!==c||(i[d]=_)}),i},Ru,Fd;function Nf(){return Fd||(Fd=1,Ru={version:"0.27.2"}),Ru}var Qy=Nf().version,Ts=ir,Ml={};["object","boolean","number","function","string","symbol"].forEach(function(t,e){Ml[t]=function(i){return typeof i===t||"a"+(e<1?"n ":" ")+t}});var jd={};Ml.transitional=function(e,n,i){function s(o,r){return"[Axios v"+Qy+"] Transitional option '"+o+"'"+r+(i?". "+i:"")}return function(o,r,a){if(e===!1)throw new Ts(s(r," has been removed"+(n?" in "+n:"")),Ts.ERR_DEPRECATED);return n&&!jd[r]&&(jd[r]=!0,console.warn(s(r," has been deprecated since v"+n+" and will be removed in the near future"))),e?e(o,r,a):!0}};function tw(t,e,n){if(typeof t!="object")throw new Ts("options must be an object",Ts.ERR_BAD_OPTION_VALUE);for(var i=Object.keys(t),s=i.length;s-- >0;){var o=i[s],r=e[o];if(r){var a=t[o],c=a===void 0||r(a,o,t);if(c!==!0)throw new Ts("option "+o+" must be "+c,Ts.ERR_BAD_OPTION_VALUE);continue}if(n!==!0)throw new Ts("Unknown option "+o,Ts.ERR_BAD_OPTION)}}var ew={assertOptions:tw,validators:Ml},Ff=Kn,nw=If,zd=Py,Hd=Yy,_c=Lf,iw=Mf,jf=ew,_o=jf.validators;function Ho(t){this.defaults=t,this.interceptors={request:new zd,response:new zd}}Ho.prototype.request=function(e,n){typeof e=="string"?(n=n||{},n.url=e):n=e||{},n=_c(this.defaults,n),n.method?n.method=n.method.toLowerCase():this.defaults.method?n.method=this.defaults.method.toLowerCase():n.method="get";var i=n.transitional;i!==void 0&&jf.assertOptions(i,{silentJSONParsing:_o.transitional(_o.boolean),forcedJSONParsing:_o.transitional(_o.boolean),clarifyTimeoutError:_o.transitional(_o.boolean)},!1);var s=[],o=!0;this.interceptors.request.forEach(function(_){typeof _.runWhen=="function"&&_.runWhen(n)===!1||(o=o&&_.synchronous,s.unshift(_.fulfilled,_.rejected))});var r=[];this.interceptors.response.forEach(function(_){r.push(_.fulfilled,_.rejected)});var a;if(!o){var c=[Hd,void 0];for(Array.prototype.unshift.apply(c,s),c=c.concat(r),a=Promise.resolve(n);c.length;)a=a.then(c.shift(),c.shift());return a}for(var u=n;s.length;){var l=s.shift(),d=s.shift();try{u=l(u)}catch(f){d(f);break}}try{a=Hd(u)}catch(f){return Promise.reject(f)}for(;r.length;)a=a.then(r.shift(),r.shift());return a};Ho.prototype.getUri=function(e){e=_c(this.defaults,e);var n=iw(e.baseURL,e.url);return nw(n,e.params,e.paramsSerializer)};Ff.forEach(["delete","get","head","options"],function(e){Ho.prototype[e]=function(n,i){return this.request(_c(i||{},{method:e,url:n,data:(i||{}).data}))}});Ff.forEach(["post","put","patch"],function(e){function n(i){return function(o,r,a){return this.request(_c(a||{},{method:e,headers:i?{"Content-Type":"multipart/form-data"}:{},url:o,data:r}))}}Ho.prototype[e]=n(),Ho.prototype[e+"Form"]=n(!0)});var sw=Ho,Uu,Kd;function ow(){if(Kd)return Uu;Kd=1;var t=pc();function e(n){if(typeof n!="function")throw new TypeError("executor must be a function.");var i;this.promise=new Promise(function(r){i=r});var s=this;this.promise.then(function(o){if(s._listeners){var r,a=s._listeners.length;for(r=0;r<a;r++)s._listeners[r](o);s._listeners=null}}),this.promise.then=function(o){var r,a=new Promise(function(c){s.subscribe(c),r=c}).then(o);return a.cancel=function(){s.unsubscribe(r)},a},n(function(r){s.reason||(s.reason=new t(r),i(s.reason))})}return e.prototype.throwIfRequested=function(){if(this.reason)throw this.reason},e.prototype.subscribe=function(i){if(this.reason){i(this.reason);return}this._listeners?this._listeners.push(i):this._listeners=[i]},e.prototype.unsubscribe=function(i){if(this._listeners){var s=this._listeners.indexOf(i);s!==-1&&this._listeners.splice(s,1)}},e.source=function(){var i,s=new e(function(r){i=r});return{token:s,cancel:i}},Uu=e,Uu}var $u,Gd;function rw(){return Gd||(Gd=1,$u=function(e){return function(i){return e.apply(null,i)}}),$u}var qu,Wd;function aw(){if(Wd)return qu;Wd=1;var t=Kn;return qu=function(n){return t.isObject(n)&&n.isAxiosError===!0},qu}var Xd=Kn,cw=Bf,Ba=sw,uw=Lf,lw=ql;function zf(t){var e=new Ba(t),n=cw(Ba.prototype.request,e);return Xd.extend(n,Ba.prototype,e),Xd.extend(n,e),n.create=function(s){return zf(uw(t,s))},n}var ai=zf(lw);ai.Axios=Ba;ai.CanceledError=pc();ai.CancelToken=ow();ai.isCancel=Df();ai.VERSION=Nf().version;ai.toFormData=qf;ai.AxiosError=ir;ai.Cancel=ai.CanceledError;ai.all=function(e){return Promise.all(e)};ai.spread=rw();ai.isAxiosError=aw();sy.exports=ai;za.default=ai;(function(t){t.exports=za})(iy);const Ws=Kh(el);async function dw(t){var e;const{params:n,method:i,url:s,headers:o,body:r,overrides:a}=t,c={headers:o,method:i,url:s,params:n,data:r,withCredentials:(e=a==null?void 0:a.WITH_CREDENTIALS)!=null?e:!0};try{const u=await Ws(c);return{status:u.status,statusText:u.statusText,data:u.data,headers:u.headers,config:u.config}}catch(u){const l=u;if(l.response)return l.response;throw u}}var il={},hw={get exports(){return il},set exports(t){il=t}};(function(t){var e=Object.prototype.hasOwnProperty,n="~";function i(){}Object.create&&(i.prototype=Object.create(null),new i().__proto__||(n=!1));function s(c,u,l){this.fn=c,this.context=u,this.once=l||!1}function o(c,u,l,d,f){if(typeof l!="function")throw new TypeError("The listener must be a function");var _=new s(l,d||c,f),T=n?n+u:u;return c._events[T]?c._events[T].fn?c._events[T]=[c._events[T],_]:c._events[T].push(_):(c._events[T]=_,c._eventsCount++),c}function r(c,u){--c._eventsCount===0?c._events=new i:delete c._events[u]}function a(){this._events=new i,this._eventsCount=0}a.prototype.eventNames=function(){var u=[],l,d;if(this._eventsCount===0)return u;for(d in l=this._events)e.call(l,d)&&u.push(n?d.slice(1):d);return Object.getOwnPropertySymbols?u.concat(Object.getOwnPropertySymbols(l)):u},a.prototype.listeners=function(u){var l=n?n+u:u,d=this._events[l];if(!d)return[];if(d.fn)return[d.fn];for(var f=0,_=d.length,T=new Array(_);f<_;f++)T[f]=d[f].fn;return T},a.prototype.listenerCount=function(u){var l=n?n+u:u,d=this._events[l];return d?d.fn?1:d.length:0},a.prototype.emit=function(u,l,d,f,_,T){var v=n?n+u:u;if(!this._events[v])return!1;var k=this._events[v],U=arguments.length,R,A;if(k.fn){switch(k.once&&this.removeListener(u,k.fn,void 0,!0),U){case 1:return k.fn.call(k.context),!0;case 2:return k.fn.call(k.context,l),!0;case 3:return k.fn.call(k.context,l,d),!0;case 4:return k.fn.call(k.context,l,d,f),!0;case 5:return k.fn.call(k.context,l,d,f,_),!0;case 6:return k.fn.call(k.context,l,d,f,_,T),!0}for(A=1,R=new Array(U-1);A<U;A++)R[A-1]=arguments[A];k.fn.apply(k.context,R)}else{var P=k.length,M;for(A=0;A<P;A++)switch(k[A].once&&this.removeListener(u,k[A].fn,void 0,!0),U){case 1:k[A].fn.call(k[A].context);break;case 2:k[A].fn.call(k[A].context,l);break;case 3:k[A].fn.call(k[A].context,l,d);break;case 4:k[A].fn.call(k[A].context,l,d,f);break;default:if(!R)for(M=1,R=new Array(U-1);M<U;M++)R[M-1]=arguments[M];k[A].fn.apply(k[A].context,R)}}return!0},a.prototype.on=function(u,l,d){return o(this,u,l,d,!1)},a.prototype.once=function(u,l,d){return o(this,u,l,d,!0)},a.prototype.removeListener=function(u,l,d,f){var _=n?n+u:u;if(!this._events[_])return this;if(!l)return r(this,_),this;var T=this._events[_];if(T.fn)T.fn===l&&(!f||T.once)&&(!d||T.context===d)&&r(this,_);else{for(var v=0,k=[],U=T.length;v<U;v++)(T[v].fn!==l||f&&!T[v].once||d&&T[v].context!==d)&&k.push(T[v]);k.length?this._events[_]=k.length===1?k[0]:k:r(this,_)}return this},a.prototype.removeAllListeners=function(u){var l;return u?(l=n?n+u:u,this._events[l]&&r(this,l)):(this._events=new i,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=n,a.EventEmitter=a,t.exports=a})(hw);var Hf=Object.defineProperty,fw=Object.getOwnPropertyDescriptor,mc=(t,e)=>{for(var n in e)Hf(t,n,{get:e[n],enumerable:!0})},an=(t,e,n,i)=>{for(var s=i>1?void 0:i?fw(e,n):e,o=t.length-1,r;o>=0;o--)(r=t[o])&&(s=(i?r(e,n,s):r(s))||s);return i&&s&&Hf(e,n,s),s},pw=/^m(\/[0-9]+')+$/,Kf=t=>t.replace("'",""),gw="ed25519 seed",_w=2147483648,Gf=t=>{const n=El.create(Pf,gw).update(_f(t)).digest(),i=n.slice(0,32),s=n.slice(32);return{key:i,chainCode:s}},Wf=({key:t,chainCode:e},n)=>{const i=new ArrayBuffer(4);new DataView(i).setUint32(0,n);const s=new Uint8Array(i),o=new Uint8Array([0]),r=new Uint8Array([...o,...t,...s]),a=El.create(Pf,e).update(r).digest(),c=a.slice(0,32),u=a.slice(32);return{key:c,chainCode:u}},mw=(t,e=!0)=>{const i=Xi.sign.keyPair.fromSeed(t).secretKey.subarray(32),s=new Uint8Array([0]);return e?new Uint8Array([...s,...i]):i},Xf=t=>pw.test(t)?!t.split("/").slice(1).map(Kf).some(Number.isNaN):!1,Vf=(t,e,n=_w)=>{if(!Xf(t))throw new Error("Invalid derivation path");const{key:i,chainCode:s}=Gf(e);return t.split("/").slice(1).map(Kf).map(r=>parseInt(r,10)).reduce((r,a)=>Wf(r,a+n),{key:i,chainCode:s})},yw="1.20.0";async function vr(t){return new Promise(e=>{setTimeout(e,t)})}var Vd="/v1";function ww(t){let e=`${t}`;return e.endsWith("/")&&(e=e.substring(0,e.length-1)),e.endsWith(Vd)||(e=`${e}${Vd}`),e}var Jf=2e5,Zf=20,Yf=20,Ka="0x1::aptos_coin::AptosCoin";function yc(t){let e,n,i;return typeof t=="object"?(e=t.hashFunction,n=t.ttlMs,i=t.tags):e=t,(s,o,r)=>{if(r.value!=null)r.value=Jd(r.value,e,n,i);else if(r.get!=null)r.get=Jd(r.get,e,n,i);else throw new Error("Only put a Memoize() decorator on a method or get accessor.")}}function Qf(t,e){return yc({ttlMs:t,hashFunction:e})}var Ea=new Map;function bw(t){const e=new Set;for(const n of t){const i=Ea.get(n);if(i)for(const s of i)e.has(s)||(s.clear(),e.add(s))}return e.size}function Jd(t,e,n=0,i){const s=Symbol("__memoized_map__");return function(...o){let r;const a=this;a.hasOwnProperty(s)||Object.defineProperty(a,s,{configurable:!1,enumerable:!1,writable:!1,value:new Map});const c=a[s];if(Array.isArray(i))for(const u of i)Ea.has(u)?Ea.get(u).push(c):Ea.set(u,[c]);if(e||o.length>0||n>0){let u;e===!0?u=o.map(f=>f.toString()).join("!"):e?u=e.apply(a,o):u=o[0];const l=`${u}__timestamp`;let d=!1;if(n>0)if(!c.has(l))d=!0;else{const f=c.get(l);d=Date.now()-f>n}c.has(u)&&!d?r=c.get(u):(r=t.apply(a,o),c.set(u,r),n>0&&c.set(l,Date.now()))}else{const u=a;c.has(u)?r=c.get(u):(r=t.apply(a,o),c.set(u,r))}return r}}var Dl=class extends Error{constructor(t,e,n){super(n),this.name="AptosApiError",this.url=e.url,this.status=e.status,this.statusText=e.statusText,this.data=e.data,this.request=t}},vw={400:"Bad Request",401:"Unauthorized",403:"Forbidden",404:"Not Found",429:"Too Many Requests",500:"Internal Server Error",502:"Bad Gateway",503:"Service Unavailable"};async function xw(t,e,n,i,s,o){const r={...o==null?void 0:o.HEADERS,"x-aptos-client":`aptos-ts-sdk/${yw}`,"content-type":i??"application/json"};return o!=null&&o.TOKEN&&(r.Authorization=`Bearer ${o==null?void 0:o.TOKEN}`),await dw({url:t,method:e,body:n,params:s,headers:r,overrides:o})}async function Ll(t){const{url:e,endpoint:n,method:i,body:s,contentType:o,params:r,overrides:a}=t,c=`${e}/${n??""}`,u=await xw(c,i,s,o,r,a),l={status:u.status,statusText:u.statusText,data:u.data,headers:u.headers,config:u.config,url:c};if(l.status>=200&&l.status<300)return l;const d=vw[l.status];throw new Dl(t,l,d??"Generic Error")}async function Qn(t){return await Ll({...t,method:"GET"})}async function Ms(t){return await Ll({...t,method:"POST"})}async function Zd(t){const e=[];let n;const i=t.params;for(;;){i.start=n;const s=await Qn({url:t.url,endpoint:t.endpoint,params:i,originMethod:t.originMethod,overrides:t.overrides});if(n=s.headers["x-aptos-cursor"],delete s.headers,e.push(...s.data),n==null)break}return e}var Ga={mainnet:"https://indexer.mainnet.aptoslabs.com/v1/graphql",testnet:"https://indexer-testnet.staging.gcp.aptosdev.com/v1/graphql",devnet:"https://indexer-devnet.staging.gcp.aptosdev.com/v1/graphql"},t0={mainnet:"https://fullnode.mainnet.aptoslabs.com/v1",testnet:"https://fullnode.testnet.aptoslabs.com/v1",devnet:"https://fullnode.devnet.aptoslabs.com/v1",local:"http://localhost:8080/v1"},sl={"https://fullnode.mainnet.aptoslabs.com/v1":"mainnet","https://fullnode.testnet.aptoslabs.com/v1":"testnet","https://fullnode.devnet.aptoslabs.com/v1":"devnet","http://localhost:8080/v1":"local"},e0=(t=>(t.MAINNET="mainnet",t.TESTNET="testnet",t.DEVNET="devnet",t.LOCAL="local",t))(e0||{}),Ot=class{static fromBuffer(e){return Ot.fromUint8Array(e)}static fromUint8Array(e){return new Ot(gf(e))}static ensure(e){return typeof e=="string"?new Ot(e):e}constructor(e){e.startsWith("0x")?this.hexString=e:this.hexString=`0x${e}`}hex(){return this.hexString}noPrefix(){return this.hexString.slice(2)}toString(){return this.hex()}toShortString(){return`0x${this.hexString.replace(/^0x0*/,"")}`}toUint8Array(){return Uint8Array.from(_f(this.noPrefix()))}},oe={};mc(oe,{AccountAddress:()=>en,AccountAuthenticator:()=>Ss,AccountAuthenticatorEd25519:()=>zl,AccountAuthenticatorMultiEd25519:()=>Hl,ArgumentABI:()=>Jr,AuthenticationKey:()=>Vs,ChainId:()=>Pc,ChangeSet:()=>Nw,Ed25519PublicKey:()=>xi,Ed25519Signature:()=>zi,EntryFunction:()=>Fs,EntryFunctionABI:()=>Ko,FeePayerRawTransaction:()=>Ac,Identifier:()=>jn,Module:()=>o0,ModuleId:()=>Xs,MultiAgentRawTransaction:()=>Tc,MultiEd25519PublicKey:()=>Gr,MultiEd25519Signature:()=>wc,MultiSig:()=>Xl,MultiSigTransactionPayload:()=>Wl,RawTransaction:()=>ro,RawTransactionWithData:()=>Vl,RotationProofChallenge:()=>jw,Script:()=>xc,ScriptABI:()=>Mc,SignedTransaction:()=>Wr,StructTag:()=>Cs,Transaction:()=>r0,TransactionArgument:()=>Mi,TransactionArgumentAddress:()=>Uc,TransactionArgumentBool:()=>qc,TransactionArgumentU128:()=>Oc,TransactionArgumentU16:()=>Ec,TransactionArgumentU256:()=>Rc,TransactionArgumentU32:()=>Cc,TransactionArgumentU64:()=>Ic,TransactionArgumentU8:()=>Bc,TransactionArgumentU8Vector:()=>$c,TransactionAuthenticator:()=>sr,TransactionAuthenticatorEd25519:()=>bc,TransactionAuthenticatorFeePayer:()=>jl,TransactionAuthenticatorMultiAgent:()=>Fl,TransactionAuthenticatorMultiEd25519:()=>vc,TransactionPayload:()=>Xr,TransactionPayloadEntryFunction:()=>Sc,TransactionPayloadMultisig:()=>Jl,TransactionPayloadScript:()=>kc,TransactionScriptABI:()=>Dc,TypeArgumentABI:()=>Vr,TypeTag:()=>zn,TypeTagAddress:()=>Bs,TypeTagBool:()=>no,TypeTagParser:()=>oo,TypeTagParserError:()=>s0,TypeTagSigner:()=>Kl,TypeTagStruct:()=>Es,TypeTagU128:()=>so,TypeTagU16:()=>or,TypeTagU256:()=>ar,TypeTagU32:()=>rr,TypeTagU64:()=>io,TypeTagU8:()=>es,TypeTagVector:()=>cr,UserTransaction:()=>Zl,WriteSet:()=>Fw,objectStructTag:()=>qw,optionStructTag:()=>$w,stringStructTag:()=>Gl});var n0={};mc(n0,{Deserializer:()=>Nl,Serializer:()=>fn,bcsSerializeBool:()=>Ow,bcsSerializeBytes:()=>vs,bcsSerializeFixedBytes:()=>Uw,bcsSerializeStr:()=>Rw,bcsSerializeU128:()=>Cw,bcsSerializeU16:()=>Bw,bcsSerializeU256:()=>Iw,bcsSerializeU32:()=>Ew,bcsSerializeU8:()=>ol,bcsSerializeUint64:()=>Pw,bcsToBytes:()=>Ui,deserializeVector:()=>ni,serializeVector:()=>Fn,serializeVectorWithFunc:()=>Sw});var Tw=2**8-1,Aw=2**16-1,Rr=2**32-1,Uo=BigInt(2**64)-BigInt(1),i0=BigInt(2**128)-BigInt(1),kw=BigInt(2**256)-BigInt(1),fn=class{constructor(){this.buffer=new ArrayBuffer(64),this.offset=0}ensureBufferWillHandleSize(e){for(;this.buffer.byteLength<this.offset+e;){const n=new ArrayBuffer(this.buffer.byteLength*2);new Uint8Array(n).set(new Uint8Array(this.buffer)),this.buffer=n}}serialize(e){this.ensureBufferWillHandleSize(e.length),new Uint8Array(this.buffer,this.offset).set(e),this.offset+=e.length}serializeWithFunction(e,n,i){this.ensureBufferWillHandleSize(n);const s=new DataView(this.buffer,this.offset);e.apply(s,[0,i,!0]),this.offset+=n}serializeStr(e){const n=new TextEncoder;this.serializeBytes(n.encode(e))}serializeBytes(e){this.serializeU32AsUleb128(e.length),this.serialize(e)}serializeFixedBytes(e){this.serialize(e)}serializeBool(e){if(typeof e!="boolean")throw new Error("Value needs to be a boolean");const n=e?1:0;this.serialize(new Uint8Array([n]))}serializeU8(e){this.serialize(new Uint8Array([e]))}serializeU16(e){this.serializeWithFunction(DataView.prototype.setUint16,2,e)}serializeU32(e){this.serializeWithFunction(DataView.prototype.setUint32,4,e)}serializeU64(e){const n=BigInt(e.toString())&BigInt(Rr),i=BigInt(e.toString())>>BigInt(32);this.serializeU32(Number(n)),this.serializeU32(Number(i))}serializeU128(e){const n=BigInt(e.toString())&Uo,i=BigInt(e.toString())>>BigInt(64);this.serializeU64(n),this.serializeU64(i)}serializeU256(e){const n=BigInt(e.toString())&i0,i=BigInt(e.toString())>>BigInt(128);this.serializeU128(n),this.serializeU128(i)}serializeU32AsUleb128(e){let n=e;const i=[];for(;n>>>7;)i.push(n&127|128),n>>>=7;i.push(n),this.serialize(new Uint8Array(i))}getBytes(){return new Uint8Array(this.buffer).slice(0,this.offset)}};an([eo(0,Tw)],fn.prototype,"serializeU8",1);an([eo(0,Aw)],fn.prototype,"serializeU16",1);an([eo(0,Rr)],fn.prototype,"serializeU32",1);an([eo(BigInt(0),Uo)],fn.prototype,"serializeU64",1);an([eo(BigInt(0),i0)],fn.prototype,"serializeU128",1);an([eo(BigInt(0),kw)],fn.prototype,"serializeU256",1);an([eo(0,Rr)],fn.prototype,"serializeU32AsUleb128",1);function eo(t,e,n){return(i,s,o)=>{const r=o.value;return o.value=function(c){const u=BigInt(c.toString());if(u>BigInt(e.toString())||u<BigInt(t.toString()))throw new Error(n||"Value is out of range");r.apply(this,[c])},o}}var Nl=class{constructor(e){this.buffer=new ArrayBuffer(e.length),new Uint8Array(this.buffer).set(e,0),this.offset=0}read(e){if(this.offset+e>this.buffer.byteLength)throw new Error("Reached to the end of buffer");const n=this.buffer.slice(this.offset,this.offset+e);return this.offset+=e,n}deserializeStr(){const e=this.deserializeBytes();return new TextDecoder().decode(e)}deserializeBytes(){const e=this.deserializeUleb128AsU32();return new Uint8Array(this.read(e))}deserializeFixedBytes(e){return new Uint8Array(this.read(e))}deserializeBool(){const e=new Uint8Array(this.read(1))[0];if(e!==1&&e!==0)throw new Error("Invalid boolean value");return e===1}deserializeU8(){return new DataView(this.read(1)).getUint8(0)}deserializeU16(){return new DataView(this.read(2)).getUint16(0,!0)}deserializeU32(){return new DataView(this.read(4)).getUint32(0,!0)}deserializeU64(){const e=this.deserializeU32(),n=this.deserializeU32();return BigInt(BigInt(n)<<BigInt(32)|BigInt(e))}deserializeU128(){const e=this.deserializeU64(),n=this.deserializeU64();return BigInt(n<<BigInt(64)|e)}deserializeU256(){const e=this.deserializeU128(),n=this.deserializeU128();return BigInt(n<<BigInt(128)|e)}deserializeUleb128AsU32(){let e=BigInt(0),n=0;for(;e<Rr;){const i=this.deserializeU8();if(e|=BigInt(i&127)<<BigInt(n),!(i&128))break;n+=7}if(e>Rr)throw new Error("Overflow while parsing uleb128-encoded uint32 value");return Number(e)}};function Fn(t,e){e.serializeU32AsUleb128(t.length),t.forEach(n=>{n.serialize(e)})}function Sw(t,e){const n=new fn;n.serializeU32AsUleb128(t.length);const i=n[e];return t.forEach(s=>{i.call(n,s)}),n.getBytes()}function ni(t,e){const n=t.deserializeUleb128AsU32(),i=[];for(let s=0;s<n;s+=1)i.push(e.deserialize(t));return i}function Ui(t){const e=new fn;return t.serialize(e),e.getBytes()}function Pw(t){const e=new fn;return e.serializeU64(t),e.getBytes()}function ol(t){const e=new fn;return e.serializeU8(t),e.getBytes()}function Bw(t){const e=new fn;return e.serializeU16(t),e.getBytes()}function Ew(t){const e=new fn;return e.serializeU32(t),e.getBytes()}function Cw(t){const e=new fn;return e.serializeU128(t),e.getBytes()}function Iw(t){const e=new fn;return e.serializeU256(t),e.getBytes()}function Ow(t){const e=new fn;return e.serializeBool(t),e.getBytes()}function Rw(t){const e=new fn;return e.serializeStr(t),e.getBytes()}function vs(t){const e=new fn;return e.serializeBytes(t),e.getBytes()}function Uw(t){const e=new fn;return e.serializeFixedBytes(t),e.getBytes()}var yi=class{constructor(e){if(e.length!==yi.LENGTH)throw new Error("Expected address of length 32");this.address=e}static fromHex(e){let n=Ot.ensure(e);n.noPrefix().length%2!==0&&(n=new Ot(`0${n.noPrefix()}`));const i=n.toUint8Array();if(i.length>yi.LENGTH)throw new Error("Hex string is too long. Address's length is 32 bytes.");if(i.length===yi.LENGTH)return new yi(i);const s=new Uint8Array(yi.LENGTH);return s.set(i,yi.LENGTH-i.length),new yi(s)}static isValid(e){if(e==="")return!1;let n=Ot.ensure(e);return n.noPrefix().length%2!==0&&(n=new Ot(`0${n.noPrefix()}`)),n.toUint8Array().length<=yi.LENGTH}toHexString(){return Ot.fromUint8Array(this.address).hex()}serialize(e){e.serializeFixedBytes(this.address)}static deserialize(e){return new yi(e.deserializeFixedBytes(yi.LENGTH))}static standardizeAddress(e){const n=e.toLowerCase();return`0x${(n.startsWith("0x")?n.slice(2):n).padStart(64,"0")}`}},en=yi;en.LENGTH=32;en.CORE_CODE_ADDRESS=yi.fromHex("0x1");var Ca=class{constructor(e){if(e.length!==Ca.LENGTH)throw new Error(`Ed25519PublicKey length should be ${Ca.LENGTH}`);this.value=e}toBytes(){return this.value}serialize(e){e.serializeBytes(this.value)}static deserialize(e){const n=e.deserializeBytes();return new Ca(n)}},xi=Ca;xi.LENGTH=32;var Ia=class{constructor(e){if(this.value=e,e.length!==Ia.LENGTH)throw new Error(`Ed25519Signature length should be ${Ia.LENGTH}`)}serialize(e){e.serializeBytes(this.value)}static deserialize(e){const n=e.deserializeBytes();return new Ia(n)}},zi=Ia;zi.LENGTH=64;var rl=32,Gr=class{constructor(e,n){if(this.public_keys=e,this.threshold=n,n>rl)throw new Error(`"threshold" cannot be larger than ${rl}`)}toBytes(){const e=new Uint8Array(this.public_keys.length*xi.LENGTH+1);return this.public_keys.forEach((n,i)=>{e.set(n.value,i*xi.LENGTH)}),e[this.public_keys.length*xi.LENGTH]=this.threshold,e}serialize(e){e.serializeBytes(this.toBytes())}static deserialize(e){const n=e.deserializeBytes(),i=n[n.length-1],s=[];for(let o=0;o<n.length-1;o+=xi.LENGTH){const r=o;s.push(new xi(n.subarray(r,r+xi.LENGTH)))}return new Gr(s,i)}},xr=class{constructor(e,n){if(this.signatures=e,this.bitmap=n,n.length!==xr.BITMAP_LEN)throw new Error(`"bitmap" length should be ${xr.BITMAP_LEN}`)}toBytes(){const e=new Uint8Array(this.signatures.length*zi.LENGTH+xr.BITMAP_LEN);return this.signatures.forEach((n,i)=>{e.set(n.value,i*zi.LENGTH)}),e.set(this.bitmap,this.signatures.length*zi.LENGTH),e}static createBitmap(e){const i=new Uint8Array([0,0,0,0]),s=new Set;return e.forEach(o=>{if(o>=rl)throw new Error(`Invalid bit value ${o}.`);if(s.has(o))throw new Error("Duplicated bits detected.");s.add(o);const r=Math.floor(o/8);let a=i[r];a|=128>>o%8,i[r]=a}),i}serialize(e){e.serializeBytes(this.toBytes())}static deserialize(e){const n=e.deserializeBytes(),i=n.subarray(n.length-4),s=[];for(let o=0;o<n.length-i.length;o+=zi.LENGTH){const r=o;s.push(new zi(n.subarray(r,r+zi.LENGTH)))}return new xr(s,i)}},wc=xr;wc.BITMAP_LEN=4;var sr=class{static deserialize(e){const n=e.deserializeUleb128AsU32();switch(n){case 0:return bc.load(e);case 1:return vc.load(e);case 2:return Fl.load(e);case 3:return jl.load(e);default:throw new Error(`Unknown variant index for TransactionAuthenticator: ${n}`)}}},bc=class extends sr{constructor(e,n){super(),this.public_key=e,this.signature=n}serialize(e){e.serializeU32AsUleb128(0),this.public_key.serialize(e),this.signature.serialize(e)}static load(e){const n=xi.deserialize(e),i=zi.deserialize(e);return new bc(n,i)}},vc=class extends sr{constructor(e,n){super(),this.public_key=e,this.signature=n}serialize(e){e.serializeU32AsUleb128(1),this.public_key.serialize(e),this.signature.serialize(e)}static load(e){const n=Gr.deserialize(e),i=wc.deserialize(e);return new vc(n,i)}},Fl=class extends sr{constructor(e,n,i){super(),this.sender=e,this.secondary_signer_addresses=n,this.secondary_signers=i}serialize(e){e.serializeU32AsUleb128(2),this.sender.serialize(e),Fn(this.secondary_signer_addresses,e),Fn(this.secondary_signers,e)}static load(e){const n=Ss.deserialize(e),i=ni(e,en),s=ni(e,Ss);return new Fl(n,i,s)}},jl=class extends sr{constructor(t,e,n,i){super(),this.sender=t,this.secondary_signer_addresses=e,this.secondary_signers=n,this.fee_payer=i}serialize(t){t.serializeU32AsUleb128(3),this.sender.serialize(t),Fn(this.secondary_signer_addresses,t),Fn(this.secondary_signers,t),this.fee_payer.address.serialize(t),this.fee_payer.authenticator.serialize(t)}static load(t){const e=Ss.deserialize(t),n=ni(t,en),i=ni(t,Ss),s=en.deserialize(t),o=Ss.deserialize(t),r={address:s,authenticator:o};return new jl(e,n,i,r)}},Ss=class{static deserialize(e){const n=e.deserializeUleb128AsU32();switch(n){case 0:return zl.load(e);case 1:return Hl.load(e);default:throw new Error(`Unknown variant index for AccountAuthenticator: ${n}`)}}},zl=class extends Ss{constructor(e,n){super(),this.public_key=e,this.signature=n}serialize(e){e.serializeU32AsUleb128(0),this.public_key.serialize(e),this.signature.serialize(e)}static load(e){const n=xi.deserialize(e),i=zi.deserialize(e);return new zl(n,i)}},Hl=class extends Ss{constructor(e,n){super(),this.public_key=e,this.signature=n}serialize(e){e.serializeU32AsUleb128(1),this.public_key.serialize(e),this.signature.serialize(e)}static load(e){const n=Gr.deserialize(e),i=wc.deserialize(e);return new Hl(n,i)}},jn=class{constructor(e){this.value=e}serialize(e){e.serializeStr(this.value)}static deserialize(e){const n=e.deserializeStr();return new jn(n)}},zn=class{static deserialize(e){const n=e.deserializeUleb128AsU32();switch(n){case 0:return no.load(e);case 1:return es.load(e);case 2:return io.load(e);case 3:return so.load(e);case 4:return Bs.load(e);case 5:return Kl.load(e);case 6:return cr.load(e);case 7:return Es.load(e);case 8:return or.load(e);case 9:return rr.load(e);case 10:return ar.load(e);default:throw new Error(`Unknown variant index for TypeTag: ${n}`)}}},no=class extends zn{serialize(e){e.serializeU32AsUleb128(0)}static load(e){return new no}},es=class extends zn{serialize(e){e.serializeU32AsUleb128(1)}static load(e){return new es}},or=class extends zn{serialize(e){e.serializeU32AsUleb128(8)}static load(e){return new or}},rr=class extends zn{serialize(e){e.serializeU32AsUleb128(9)}static load(e){return new rr}},io=class extends zn{serialize(e){e.serializeU32AsUleb128(2)}static load(e){return new io}},so=class extends zn{serialize(e){e.serializeU32AsUleb128(3)}static load(e){return new so}},ar=class extends zn{serialize(e){e.serializeU32AsUleb128(10)}static load(e){return new ar}},Bs=class extends zn{serialize(e){e.serializeU32AsUleb128(4)}static load(e){return new Bs}},Kl=class extends zn{serialize(e){e.serializeU32AsUleb128(5)}static load(e){return new Kl}},cr=class extends zn{constructor(e){super(),this.value=e}serialize(e){e.serializeU32AsUleb128(6),this.value.serialize(e)}static load(e){const n=zn.deserialize(e);return new cr(n)}},Es=class extends zn{constructor(e){super(),this.value=e}serialize(e){e.serializeU32AsUleb128(7),this.value.serialize(e)}static load(e){const n=Cs.deserialize(e);return new Es(n)}isStringTypeTag(){return this.value.module_name.value==="string"&&this.value.name.value==="String"&&this.value.address.toHexString()===en.CORE_CODE_ADDRESS.toHexString()}},Cs=class{constructor(e,n,i,s){this.address=e,this.module_name=n,this.name=i,this.type_args=s}static fromString(e){const n=new oo(e).parseTypeTag();return new Cs(n.value.address,n.value.module_name,n.value.name,n.value.type_args)}serialize(e){this.address.serialize(e),this.module_name.serialize(e),this.name.serialize(e),Fn(this.type_args,e)}static deserialize(e){const n=en.deserialize(e),i=jn.deserialize(e),s=jn.deserialize(e),o=ni(e,zn);return new Cs(n,i,s,o)}},Gl=new Cs(en.fromHex("0x1"),new jn("string"),new jn("String"),[]);function $w(t){return new Cs(en.fromHex("0x1"),new jn("option"),new jn("Option"),[t])}function qw(t){return new Cs(en.fromHex("0x1"),new jn("object"),new jn("Object"),[t])}function xs(t){throw new s0(t)}function Yd(t){return!!t.match(/\s/)}function Qd(t){return!!t.match(/[_A-Za-z0-9]/g)}function Mw(t){return!!t.match(/T\d+/g)}function Dw(t,e){const n=t[e];if(n===":"){if(t.slice(e,e+2)==="::")return[["COLON","::"],2];xs("Unrecognized token.")}else{if(n==="<")return[["LT","<"],1];if(n===">")return[["GT",">"],1];if(n===",")return[["COMMA",","],1];if(Yd(n)){let i="";for(let s=e;s<t.length;s+=1){const o=t[s];if(Yd(o))i=`${i}${o}`;else break}return[["SPACE",i],i.length]}else if(Qd(n)){let i="";for(let s=e;s<t.length;s+=1){const o=t[s];if(Qd(o))i=`${i}${o}`;else break}return Mw(i)?[["GENERIC",i],i.length]:[["IDENT",i],i.length]}}throw new Error("Unrecognized token.")}function Lw(t){let e=0;const n=[];for(;e<t.length;){const[i,s]=Dw(t,e);i[0]!=="SPACE"&&n.push(i),e+=s}return n}var oo=class{constructor(e,n){this.typeTags=[],this.tokens=Lw(e),this.typeTags=n||[]}consume(e){const n=this.tokens.shift();(!n||n[1]!==e)&&xs("Invalid type tag.")}consumeWholeGeneric(){for(this.consume("<");this.tokens[0][1]!==">";)this.tokens[0][1]==="<"&&this.consumeWholeGeneric(),this.tokens.shift();this.consume(">")}parseCommaList(e,n){const i=[];for(this.tokens.length<=0&&xs("Invalid type tag.");this.tokens[0][1]!==e&&(i.push(this.parseTypeTag()),!(this.tokens.length>0&&this.tokens[0][1]===e||(this.consume(","),this.tokens.length>0&&this.tokens[0][1]===e&&n)));)this.tokens.length<=0&&xs("Invalid type tag.");return i}parseTypeTag(){this.tokens.length===0&&xs("Invalid type tag.");const[e,n]=this.tokens.shift();if(n==="u8")return new es;if(n==="u16")return new or;if(n==="u32")return new rr;if(n==="u64")return new io;if(n==="u128")return new so;if(n==="u256")return new ar;if(n==="bool")return new no;if(n==="address")return new Bs;if(n==="vector"){this.consume("<");const i=this.parseTypeTag();return this.consume(">"),new cr(i)}if(n==="string")return new Es(Gl);if(e==="IDENT"&&(n.startsWith("0x")||n.startsWith("0X"))){const i=en.fromHex(n);this.consume("::");const[s,o]=this.tokens.shift();s!=="IDENT"&&xs("Invalid type tag."),this.consume("::");const[r,a]=this.tokens.shift();if(r!=="IDENT"&&xs("Invalid type tag."),en.CORE_CODE_ADDRESS.toHexString()===i.toHexString()&&o==="object"&&a==="Object")return this.consumeWholeGeneric(),new Bs;let c=[];this.tokens.length>0&&this.tokens[0][1]==="<"&&(this.consume("<"),c=this.parseCommaList(">",!0),this.consume(">"));const u=new Cs(i,new jn(o),new jn(a),c);return new Es(u)}if(e==="GENERIC"){this.typeTags.length===0&&xs("Can't convert generic type since no typeTags were specified.");const i=parseInt(n.substring(1),10);return new oo(this.typeTags[i]).parseTypeTag()}throw new Error("Invalid type tag.")}},s0=class extends Error{constructor(t){super(t),this.name="TypeTagParserError"}},ro=class{constructor(e,n,i,s,o,r,a){this.sender=e,this.sequence_number=n,this.payload=i,this.max_gas_amount=s,this.gas_unit_price=o,this.expiration_timestamp_secs=r,this.chain_id=a}serialize(e){this.sender.serialize(e),e.serializeU64(this.sequence_number),this.payload.serialize(e),e.serializeU64(this.max_gas_amount),e.serializeU64(this.gas_unit_price),e.serializeU64(this.expiration_timestamp_secs),this.chain_id.serialize(e)}static deserialize(e){const n=en.deserialize(e),i=e.deserializeU64(),s=Xr.deserialize(e),o=e.deserializeU64(),r=e.deserializeU64(),a=e.deserializeU64(),c=Pc.deserialize(e);return new ro(n,i,s,o,r,a,c)}},xc=class{constructor(e,n,i){this.code=e,this.ty_args=n,this.args=i}serialize(e){e.serializeBytes(this.code),Fn(this.ty_args,e),Fn(this.args,e)}static deserialize(e){const n=e.deserializeBytes(),i=ni(e,zn),s=ni(e,Mi);return new xc(n,i,s)}},Fs=class{constructor(e,n,i,s){this.module_name=e,this.function_name=n,this.ty_args=i,this.args=s}static natural(e,n,i,s){return new Fs(Xs.fromStr(e),new jn(n),i,s)}static natual(e,n,i,s){return Fs.natural(e,n,i,s)}serialize(e){this.module_name.serialize(e),this.function_name.serialize(e),Fn(this.ty_args,e),e.serializeU32AsUleb128(this.args.length),this.args.forEach(n=>{e.serializeBytes(n)})}static deserialize(e){const n=Xs.deserialize(e),i=jn.deserialize(e),s=ni(e,zn),o=e.deserializeUleb128AsU32(),r=[];for(let c=0;c<o;c+=1)r.push(e.deserializeBytes());const a=r;return new Fs(n,i,s,a)}},Wl=class{constructor(e){this.transaction_payload=e}serialize(e){e.serializeU32AsUleb128(0),this.transaction_payload.serialize(e)}static deserialize(e){return e.deserializeUleb128AsU32(),new Wl(Fs.deserialize(e))}},Xl=class{constructor(e,n){this.multisig_address=e,this.transaction_payload=n}serialize(e){this.multisig_address.serialize(e),this.transaction_payload===void 0?e.serializeBool(!1):(e.serializeBool(!0),this.transaction_payload.serialize(e))}static deserialize(e){const n=en.deserialize(e),i=e.deserializeBool();let s;return i&&(s=Wl.deserialize(e)),new Xl(n,s)}},o0=class{constructor(e){this.code=e}serialize(e){e.serializeBytes(this.code)}static deserialize(e){const n=e.deserializeBytes();return new o0(n)}},Xs=class{constructor(e,n){this.address=e,this.name=n}static fromStr(e){const n=e.split("::");if(n.length!==2)throw new Error("Invalid module id.");return new Xs(en.fromHex(new Ot(n[0])),new jn(n[1]))}serialize(e){this.address.serialize(e),this.name.serialize(e)}static deserialize(e){const n=en.deserialize(e),i=jn.deserialize(e);return new Xs(n,i)}},Nw=class{serialize(e){throw new Error("Not implemented.")}static deserialize(e){throw new Error("Not implemented.")}},Fw=class{serialize(e){throw new Error("Not implmented.")}static deserialize(e){throw new Error("Not implmented.")}},Wr=class{constructor(e,n){this.raw_txn=e,this.authenticator=n}serialize(e){this.raw_txn.serialize(e),this.authenticator.serialize(e)}static deserialize(e){const n=ro.deserialize(e),i=sr.deserialize(e);return new Wr(n,i)}},Vl=class{static deserialize(e){const n=e.deserializeUleb128AsU32();switch(n){case 0:return Tc.load(e);case 1:return Ac.load(e);default:throw new Error(`Unknown variant index for RawTransactionWithData: ${n}`)}}},Tc=class extends Vl{constructor(e,n){super(),this.raw_txn=e,this.secondary_signer_addresses=n}serialize(e){e.serializeU32AsUleb128(0),this.raw_txn.serialize(e),Fn(this.secondary_signer_addresses,e)}static load(e){const n=ro.deserialize(e),i=ni(e,en);return new Tc(n,i)}},Ac=class extends Vl{constructor(t,e,n){super(),this.raw_txn=t,this.secondary_signer_addresses=e,this.fee_payer_address=n}serialize(t){t.serializeU32AsUleb128(1),this.raw_txn.serialize(t),Fn(this.secondary_signer_addresses,t),this.fee_payer_address.serialize(t)}static load(t){const e=ro.deserialize(t),n=ni(t,en),i=en.deserialize(t);return new Ac(e,n,i)}},Xr=class{static deserialize(e){const n=e.deserializeUleb128AsU32();switch(n){case 0:return kc.load(e);case 2:return Sc.load(e);case 3:return Jl.load(e);default:throw new Error(`Unknown variant index for TransactionPayload: ${n}`)}}},kc=class extends Xr{constructor(e){super(),this.value=e}serialize(e){e.serializeU32AsUleb128(0),this.value.serialize(e)}static load(e){const n=xc.deserialize(e);return new kc(n)}},Sc=class extends Xr{constructor(e){super(),this.value=e}serialize(e){e.serializeU32AsUleb128(2),this.value.serialize(e)}static load(e){const n=Fs.deserialize(e);return new Sc(n)}},Jl=class extends Xr{constructor(e){super(),this.value=e}serialize(e){e.serializeU32AsUleb128(3),this.value.serialize(e)}static load(e){const n=Xl.deserialize(e);return new Jl(n)}},Pc=class{constructor(e){this.value=e}serialize(e){e.serializeU8(this.value)}static deserialize(e){const n=e.deserializeU8();return new Pc(n)}},Mi=class{static deserialize(e){const n=e.deserializeUleb128AsU32();switch(n){case 0:return Bc.load(e);case 1:return Ic.load(e);case 2:return Oc.load(e);case 3:return Uc.load(e);case 4:return $c.load(e);case 5:return qc.load(e);case 6:return Ec.load(e);case 7:return Cc.load(e);case 8:return Rc.load(e);default:throw new Error(`Unknown variant index for TransactionArgument: ${n}`)}}},Bc=class extends Mi{constructor(e){super(),this.value=e}serialize(e){e.serializeU32AsUleb128(0),e.serializeU8(this.value)}static load(e){const n=e.deserializeU8();return new Bc(n)}},Ec=class extends Mi{constructor(e){super(),this.value=e}serialize(e){e.serializeU32AsUleb128(6),e.serializeU16(this.value)}static load(e){const n=e.deserializeU16();return new Ec(n)}},Cc=class extends Mi{constructor(e){super(),this.value=e}serialize(e){e.serializeU32AsUleb128(7),e.serializeU32(this.value)}static load(e){const n=e.deserializeU32();return new Cc(n)}},Ic=class extends Mi{constructor(e){super(),this.value=e}serialize(e){e.serializeU32AsUleb128(1),e.serializeU64(this.value)}static load(e){const n=e.deserializeU64();return new Ic(n)}},Oc=class extends Mi{constructor(e){super(),this.value=e}serialize(e){e.serializeU32AsUleb128(2),e.serializeU128(this.value)}static load(e){const n=e.deserializeU128();return new Oc(n)}},Rc=class extends Mi{constructor(e){super(),this.value=e}serialize(e){e.serializeU32AsUleb128(8),e.serializeU256(this.value)}static load(e){const n=e.deserializeU256();return new Rc(n)}},Uc=class extends Mi{constructor(e){super(),this.value=e}serialize(e){e.serializeU32AsUleb128(3),this.value.serialize(e)}static load(e){const n=en.deserialize(e);return new Uc(n)}},$c=class extends Mi{constructor(e){super(),this.value=e}serialize(e){e.serializeU32AsUleb128(4),e.serializeBytes(this.value)}static load(e){const n=e.deserializeBytes();return new $c(n)}},qc=class extends Mi{constructor(e){super(),this.value=e}serialize(e){e.serializeU32AsUleb128(5),e.serializeBool(this.value)}static load(e){const n=e.deserializeBool();return new qc(n)}},r0=class{getHashSalt(){const e=jo.create();return e.update("APTOS::Transaction"),e.digest()}static deserialize(e){const n=e.deserializeUleb128AsU32();switch(n){case 0:return Zl.load(e);default:throw new Error(`Unknown variant index for Transaction: ${n}`)}}},Zl=class extends r0{constructor(e){super(),this.value=e}hash(){const e=jo.create();return e.update(this.getHashSalt()),e.update(Ui(this)),e.digest()}serialize(e){e.serializeU32AsUleb128(0),this.value.serialize(e)}static load(e){return new Zl(Wr.deserialize(e))}},Vr=class{constructor(e){this.name=e}serialize(e){e.serializeStr(this.name)}static deserialize(e){const n=e.deserializeStr();return new Vr(n)}},Jr=class{constructor(e,n){this.name=e,this.type_tag=n}serialize(e){e.serializeStr(this.name),this.type_tag.serialize(e)}static deserialize(e){const n=e.deserializeStr(),i=zn.deserialize(e);return new Jr(n,i)}},Mc=class{static deserialize(e){const n=e.deserializeUleb128AsU32();switch(n){case 0:return Dc.load(e);case 1:return Ko.load(e);default:throw new Error(`Unknown variant index for TransactionPayload: ${n}`)}}},Dc=class extends Mc{constructor(e,n,i,s,o){super(),this.name=e,this.doc=n,this.code=i,this.ty_args=s,this.args=o}serialize(e){e.serializeU32AsUleb128(0),e.serializeStr(this.name),e.serializeStr(this.doc),e.serializeBytes(this.code),Fn(this.ty_args,e),Fn(this.args,e)}static load(e){const n=e.deserializeStr(),i=e.deserializeStr(),s=e.deserializeBytes(),o=ni(e,Vr),r=ni(e,Jr);return new Dc(n,i,s,o,r)}},Ko=class extends Mc{constructor(e,n,i,s,o){super(),this.name=e,this.module_name=n,this.doc=i,this.ty_args=s,this.args=o}serialize(e){e.serializeU32AsUleb128(1),e.serializeStr(this.name),this.module_name.serialize(e),e.serializeStr(this.doc),Fn(this.ty_args,e),Fn(this.args,e)}static load(e){const n=e.deserializeStr(),i=Xs.deserialize(e),s=e.deserializeStr(),o=ni(e,Vr),r=ni(e,Jr);return new Ko(n,i,s,o,r)}},vo=class{constructor(e){if(e.length!==vo.LENGTH)throw new Error("Expected a byte array of length 32");this.bytes=e}static fromMultiEd25519PublicKey(e){const n=e.toBytes(),i=new Uint8Array(n.length+1);i.set(n),i.set([vo.MULTI_ED25519_SCHEME],n.length);const s=jo.create();return s.update(i),new vo(s.digest())}static fromEd25519PublicKey(e){const n=e.value,i=new Uint8Array(n.length+1);i.set(n),i.set([vo.ED25519_SCHEME],n.length);const s=jo.create();return s.update(i),new vo(s.digest())}derivedAddress(){return Ot.fromUint8Array(this.bytes)}},Vs=vo;Vs.LENGTH=32;Vs.MULTI_ED25519_SCHEME=1;Vs.ED25519_SCHEME=0;Vs.DERIVE_RESOURCE_ACCOUNT_SCHEME=255;var jw=class{constructor(e,n,i,s,o,r,a){this.accountAddress=e,this.moduleName=n,this.structName=i,this.sequenceNumber=s,this.originator=o,this.currentAuthKey=r,this.newPublicKey=a}serialize(e){this.accountAddress.serialize(e),e.serializeStr(this.moduleName),e.serializeStr(this.structName),e.serializeU64(this.sequenceNumber),this.originator.serialize(e),this.currentAuthKey.serialize(e),e.serializeBytes(this.newPublicKey)}},Oa=class{static fromAptosAccountObject(e){return new Oa(Ot.ensure(e.privateKeyHex).toUint8Array(),e.address)}static isValidPath(e){return/^m\/44'\/637'\/[0-9]+'\/[0-9]+'\/[0-9]+'+$/.test(e)}static fromDerivePath(e,n){if(!Oa.isValidPath(e))throw new Error("Invalid derivation path");const i=n.trim().split(/\s+/).map(o=>o.toLowerCase()).join(" "),{key:s}=Vf(e,gf(of(i)));return new Oa(s)}constructor(e,n){e?this.signingKey=Xi.sign.keyPair.fromSeed(e.slice(0,32)):this.signingKey=Xi.sign.keyPair(),this.accountAddress=Ot.ensure(n||this.authKey().hex())}address(){return this.accountAddress}authKey(){const e=new xi(this.signingKey.publicKey);return Vs.fromEd25519PublicKey(e).derivedAddress()}static getResourceAccountAddress(e,n){const i=Ui(en.fromHex(e)),s=new Uint8Array([...i,...n,Vs.DERIVE_RESOURCE_ACCOUNT_SCHEME]),o=jo.create();return o.update(s),Ot.fromUint8Array(o.digest())}static getCollectionID(e,n){const i=new TextEncoder().encode(`${e}::${n}`),s=Tm.create();return s.update(i),Ot.fromUint8Array(s.digest())}pubKey(){return Ot.fromUint8Array(this.signingKey.publicKey)}signBuffer(e){const n=Xi.sign.detached(e,this.signingKey.secretKey);return Ot.fromUint8Array(n)}signHexString(e){const n=Ot.ensure(e).toUint8Array();return this.signBuffer(n)}verifySignature(e,n){const i=Ot.ensure(e).toUint8Array(),s=Ot.ensure(n).toUint8Array();return Xi.sign.detached.verify(i,s,this.signingKey.publicKey)}toPrivateKeyObject(){return{address:this.address().hex(),publicKeyHex:this.pubKey().hex(),privateKeyHex:Ot.fromUint8Array(this.signingKey.secretKey.slice(0,32)).hex()}}},Ur=Oa;an([yc()],Ur.prototype,"authKey",1);function Ii(t){return t instanceof Ur?t.address():Ot.ensure(t)}var Zr=`
    fragment CurrentTokenOwnershipFields on current_token_ownerships_v2 {
  token_standard
  token_properties_mutated_v1
  token_data_id
  table_type_v1
  storage_id
  property_version_v1
  owner_address
  last_transaction_version
  last_transaction_timestamp
  is_soulbound_v2
  is_fungible_v2
  amount
  current_token_data {
    collection_id
    description
    is_fungible_v2
    largest_property_version_v1
    last_transaction_timestamp
    last_transaction_version
    maximum
    supply
    token_data_id
    token_name
    token_properties
    token_standard
    token_uri
    current_collection {
      collection_id
      collection_name
      creator_address
      current_supply
      description
      last_transaction_timestamp
      last_transaction_version
      max_supply
      mutable_description
      mutable_uri
      table_handle_v1
      token_standard
      total_minted_v2
      uri
    }
  }
}
    `,zw=`
    fragment TokenDataFields on current_token_datas {
  creator_address
  collection_name
  description
  metadata_uri
  name
  token_data_id_hash
  collection_data_id_hash
}
    `,Hw=`
    fragment CollectionDataFields on current_collection_datas {
  metadata_uri
  supply
  description
  collection_name
  collection_data_id_hash
  table_handle
  creator_address
}
    `,a0=`
    fragment TokenActivitiesFields on token_activities_v2 {
  after_value
  before_value
  entry_function_id_str
  event_account_address
  event_index
  from_address
  is_fungible_v2
  property_version_v1
  to_address
  token_amount
  token_data_id
  token_standard
  transaction_timestamp
  transaction_version
  type
}
    `,Kw=`
    query getAccountCoinsDataCount($address: String) {
  current_fungible_asset_balances_aggregate(
    where: {owner_address: {_eq: $address}}
  ) {
    aggregate {
      count
    }
  }
}
    `,Gw=`
    query getAccountCoinsData($where_condition: current_fungible_asset_balances_bool_exp!, $offset: Int, $limit: Int, $order_by: [current_fungible_asset_balances_order_by!]) {
  current_fungible_asset_balances(
    where: $where_condition
    offset: $offset
    limit: $limit
    order_by: $order_by
  ) {
    amount
    asset_type
    is_frozen
    is_primary
    last_transaction_timestamp
    last_transaction_version
    owner_address
    storage_id
    token_standard
    metadata {
      token_standard
      symbol
      supply_aggregator_table_key_v1
      supply_aggregator_table_handle_v1
      project_uri
      name
      last_transaction_version
      last_transaction_timestamp
      icon_uri
      decimals
      creator_address
      asset_type
    }
  }
}
    `,Ww=`
    query getAccountCurrentTokens($address: String!, $offset: Int, $limit: Int) {
  current_token_ownerships(
    where: {owner_address: {_eq: $address}, amount: {_gt: 0}}
    order_by: [{last_transaction_version: desc}, {creator_address: asc}, {collection_name: asc}, {name: asc}]
    offset: $offset
    limit: $limit
  ) {
    amount
    current_token_data {
      ...TokenDataFields
    }
    current_collection_data {
      ...CollectionDataFields
    }
    last_transaction_version
    property_version
  }
}
    ${zw}
${Hw}`,Xw=`
    query getAccountTokensCount($where_condition: current_token_ownerships_v2_bool_exp, $offset: Int, $limit: Int) {
  current_token_ownerships_v2_aggregate(
    where: $where_condition
    offset: $offset
    limit: $limit
  ) {
    aggregate {
      count
    }
  }
}
    `,Vw=`
    query getAccountTransactionsCount($address: String) {
  account_transactions_aggregate(where: {account_address: {_eq: $address}}) {
    aggregate {
      count
    }
  }
}
    `,Jw=`
    query getAccountTransactionsData($where_condition: account_transactions_bool_exp!, $offset: Int, $limit: Int, $order_by: [account_transactions_order_by!]) {
  account_transactions(
    where: $where_condition
    order_by: $order_by
    limit: $limit
    offset: $offset
  ) {
    token_activities_v2 {
      ...TokenActivitiesFields
    }
    transaction_version
    account_address
  }
}
    ${a0}`,Zw=`
    query getCollectionData($where_condition: current_collections_v2_bool_exp!, $offset: Int, $limit: Int, $order_by: [current_collections_v2_order_by!]) {
  current_collections_v2(
    where: $where_condition
    offset: $offset
    limit: $limit
    order_by: $order_by
  ) {
    collection_id
    collection_name
    creator_address
    current_supply
    description
    last_transaction_timestamp
    last_transaction_version
    max_supply
    mutable_description
    mutable_uri
    table_handle_v1
    token_standard
    total_minted_v2
    uri
  }
}
    `,Yw=`
    query getCollectionsWithOwnedTokens($where_condition: current_collection_ownership_v2_view_bool_exp!, $offset: Int, $limit: Int, $order_by: [current_collection_ownership_v2_view_order_by!]) {
  current_collection_ownership_v2_view(
    where: $where_condition
    offset: $offset
    limit: $limit
    order_by: $order_by
  ) {
    current_collection {
      collection_id
      collection_name
      creator_address
      current_supply
      description
      last_transaction_timestamp
      last_transaction_version
      mutable_description
      max_supply
      mutable_uri
      table_handle_v1
      token_standard
      total_minted_v2
      uri
    }
    collection_id
    collection_name
    collection_uri
    creator_address
    distinct_tokens
    last_transaction_version
    owner_address
    single_token_uri
  }
}
    `,Qw=`
    query getCurrentObjects($where_condition: current_objects_bool_exp, $offset: Int, $limit: Int, $order_by: [current_objects_order_by!]) {
  current_objects(
    where: $where_condition
    offset: $offset
    limit: $limit
    order_by: $order_by
  ) {
    allow_ungated_transfer
    state_key_hash
    owner_address
    object_address
    last_transaction_version
    last_guid_creation_num
    is_deleted
  }
}
    `,tb=`
    query getDelegatedStakingActivities($delegatorAddress: String, $poolAddress: String) {
  delegated_staking_activities(
    where: {delegator_address: {_eq: $delegatorAddress}, pool_address: {_eq: $poolAddress}}
  ) {
    amount
    delegator_address
    event_index
    event_type
    pool_address
    transaction_version
  }
}
    `,eb=`
    query getIndexerLedgerInfo {
  ledger_infos {
    chain_id
  }
}
    `,nb=`
    query getNumberOfDelegators($poolAddress: String) {
  num_active_delegator_per_pool(
    where: {pool_address: {_eq: $poolAddress}, num_active_delegator: {_gt: "0"}}
    distinct_on: pool_address
  ) {
    num_active_delegator
    pool_address
  }
}
    `,ib=`
    query getOwnedTokens($where_condition: current_token_ownerships_v2_bool_exp!, $offset: Int, $limit: Int, $order_by: [current_token_ownerships_v2_order_by!]) {
  current_token_ownerships_v2(
    where: $where_condition
    offset: $offset
    limit: $limit
    order_by: $order_by
  ) {
    ...CurrentTokenOwnershipFields
  }
}
    ${Zr}`,sb=`
    query getOwnedTokensByTokenData($where_condition: current_token_ownerships_v2_bool_exp!, $offset: Int, $limit: Int, $order_by: [current_token_ownerships_v2_order_by!]) {
  current_token_ownerships_v2(
    where: $where_condition
    offset: $offset
    limit: $limit
    order_by: $order_by
  ) {
    ...CurrentTokenOwnershipFields
  }
}
    ${Zr}`,ob=`
    query getTokenActivities($where_condition: token_activities_v2_bool_exp!, $offset: Int, $limit: Int, $order_by: [token_activities_v2_order_by!]) {
  token_activities_v2(
    where: $where_condition
    order_by: $order_by
    offset: $offset
    limit: $limit
  ) {
    ...TokenActivitiesFields
  }
}
    ${a0}`,rb=`
    query getTokenActivitiesCount($token_id: String) {
  token_activities_v2_aggregate(where: {token_data_id: {_eq: $token_id}}) {
    aggregate {
      count
    }
  }
}
    `,ab=`
    query getTokenCurrentOwnerData($where_condition: current_token_ownerships_v2_bool_exp!, $offset: Int, $limit: Int, $order_by: [current_token_ownerships_v2_order_by!]) {
  current_token_ownerships_v2(
    where: $where_condition
    offset: $offset
    limit: $limit
    order_by: $order_by
  ) {
    ...CurrentTokenOwnershipFields
  }
}
    ${Zr}`,cb=`
    query getTokenData($where_condition: current_token_datas_v2_bool_exp, $offset: Int, $limit: Int, $order_by: [current_token_datas_v2_order_by!]) {
  current_token_datas_v2(
    where: $where_condition
    offset: $offset
    limit: $limit
    order_by: $order_by
  ) {
    collection_id
    description
    is_fungible_v2
    largest_property_version_v1
    last_transaction_timestamp
    last_transaction_version
    maximum
    supply
    token_data_id
    token_name
    token_properties
    token_standard
    token_uri
    current_collection {
      collection_id
      collection_name
      creator_address
      current_supply
      description
      last_transaction_timestamp
      last_transaction_version
      max_supply
      mutable_description
      mutable_uri
      table_handle_v1
      token_standard
      total_minted_v2
      uri
    }
  }
}
    `,ub=`
    query getTokenOwnedFromCollection($where_condition: current_token_ownerships_v2_bool_exp!, $offset: Int, $limit: Int, $order_by: [current_token_ownerships_v2_order_by!]) {
  current_token_ownerships_v2(
    where: $where_condition
    offset: $offset
    limit: $limit
    order_by: $order_by
  ) {
    ...CurrentTokenOwnershipFields
  }
}
    ${Zr}`,lb=`
    query getTokenOwnersData($where_condition: current_token_ownerships_v2_bool_exp!, $offset: Int, $limit: Int, $order_by: [current_token_ownerships_v2_order_by!]) {
  current_token_ownerships_v2(
    where: $where_condition
    offset: $offset
    limit: $limit
    order_by: $order_by
  ) {
    ...CurrentTokenOwnershipFields
  }
}
    ${Zr}`,db=`
    query getTopUserTransactions($limit: Int) {
  user_transactions(limit: $limit, order_by: {version: desc}) {
    version
  }
}
    `,hb=`
    query getUserTransactions($where_condition: user_transactions_bool_exp!, $offset: Int, $limit: Int, $order_by: [user_transactions_order_by!]) {
  user_transactions(
    order_by: $order_by
    where: $where_condition
    limit: $limit
    offset: $offset
  ) {
    version
  }
}
    `;function Lc(t,e,n){if(!(e!=null&&e.includes(typeof t)))throw new Error(n||`Invalid arg: ${t} type should be ${e instanceof Array?e.join(" or "):e}`)}function Yl(t){if(Lc(t,["boolean","string"]),typeof t=="boolean")return t;if(t==="true")return!0;if(t==="false")return!1;throw new Error("Invalid boolean string.")}function js(t){if(Lc(t,["number","string"]),typeof t=="number")return t;const e=Number.parseInt(t,10);if(Number.isNaN(e))throw new Error("Invalid number string.");return e}function zs(t){return Lc(t,["number","bigint","string"]),BigInt(t)}function Nc(t,e,n){Ql(t,e,n)}function Ql(t,e,n,i){if(e instanceof no)n.serializeBool(Yl(t));else if(e instanceof es)n.serializeU8(js(t));else if(e instanceof or)n.serializeU16(js(t));else if(e instanceof rr)n.serializeU32(js(t));else if(e instanceof io)n.serializeU64(zs(t));else if(e instanceof so)n.serializeU128(zs(t));else if(e instanceof ar)n.serializeU256(zs(t));else if(e instanceof Bs)c0(t,n);else if(e instanceof cr)fb(t,e,n);else if(e instanceof Es)pb(t,e,n);else throw new Error("Unsupported arg type.")}function c0(t,e){let n;if(typeof t=="string"||t instanceof Ot)n=en.fromHex(t);else if(t instanceof en)n=t;else throw new Error("Invalid account address.");n.serialize(e)}function fb(t,e,n,i){if(e.value instanceof es){if(t instanceof Uint8Array){n.serializeBytes(t);return}if(t instanceof Ot){n.serializeBytes(t.toUint8Array());return}if(typeof t=="string"){n.serializeStr(t);return}}if(!Array.isArray(t))throw new Error("Invalid vector args.");n.serializeU32AsUleb128(t.length),t.forEach(s=>Ql(s,e.value,n))}function pb(t,e,n,i){const{address:s,module_name:o,name:r,type_args:a}=e.value,c=`${Ot.fromUint8Array(s.address).toShortString()}::${o.value}::${r.value}`;if(c==="0x1::string::String")Lc(t,["string"]),n.serializeStr(t);else if(c==="0x1::object::Object")c0(t,n);else if(c==="0x1::option::Option"){if(a.length!==1)throw new Error(`Option has the wrong number of type arguments ${a.length}`);gb(t,a[0],n)}else throw new Error("Unsupported struct type in function argument")}function gb(t,e,n,i){t==null?n.serializeU32AsUleb128(0):(n.serializeU32AsUleb128(1),Ql(t,e,n))}function u0(t,e){if(e instanceof no)return new qc(Yl(t));if(e instanceof es)return new Bc(js(t));if(e instanceof or)return new Ec(js(t));if(e instanceof rr)return new Cc(js(t));if(e instanceof io)return new Ic(zs(t));if(e instanceof so)return new Oc(zs(t));if(e instanceof ar)return new Rc(zs(t));if(e instanceof Bs){let n;if(typeof t=="string"||t instanceof Ot)n=en.fromHex(t);else if(t instanceof en)n=t;else throw new Error("Invalid account address.");return new Uc(n)}if(e instanceof cr&&e.value instanceof es){if(!(t instanceof Uint8Array))throw new Error(`${t} should be an instance of Uint8Array`);return new $c(t)}throw new Error("Unknown type for TransactionArgument.")}var _b="APTOS::RawTransaction",th="APTOS::RawTransactionWithData",Oi=class{constructor(e,n){this.rawTxnBuilder=n,this.signingFunction=e}build(e,n,i){if(!this.rawTxnBuilder)throw new Error("this.rawTxnBuilder doesn't exist.");return this.rawTxnBuilder.build(e,n,i)}static getSigningMessage(e){const n=jo.create();if(e instanceof ro)n.update(_b);else if(e instanceof Tc)n.update(th);else if(e instanceof Ac)n.update(th);else throw new Error("Unknown transaction type.");const i=n.digest(),s=Ui(e),o=new Uint8Array(i.length+s.length);return o.set(i),o.set(s,i.length),o}},Ra=class extends Oi{constructor(e,n,i){super(e,i),this.publicKey=n}rawToSigned(e){const n=Oi.getSigningMessage(e),i=this.signingFunction(n),s=new bc(new xi(this.publicKey),i);return new Wr(e,s)}sign(e){return Ui(this.rawToSigned(e))}},l0=class extends Oi{constructor(e,n){super(e),this.publicKey=n}rawToSigned(e){const n=Oi.getSigningMessage(e),i=this.signingFunction(n),s=new vc(this.publicKey,i);return new Wr(e,s)}sign(e){return Ui(this.rawToSigned(e))}},Wa=class{constructor(e,n){this.abiMap=new Map,e.forEach(i=>{const s=new Nl(i),o=Mc.deserialize(s);let r;if(o instanceof Ko){const a=o,{address:c,name:u}=a.module_name;r=`${Ot.fromUint8Array(c.address).toShortString()}::${u.value}::${a.name}`}else r=o.name;if(this.abiMap.has(r))throw new Error("Found conflicting ABI interfaces");this.abiMap.set(r,o)}),this.builderConfig={maxGasAmount:BigInt(Jf),expSecFromNow:Zf,...n}}static toBCSArgs(e,n){if(e.length!==n.length)throw new Error("Wrong number of args provided.");return n.map((i,s)=>{const o=new fn;return Nc(i,e[s].type_tag,o),o.getBytes()})}static toTransactionArguments(e,n){if(e.length!==n.length)throw new Error("Wrong number of args provided.");return n.map((i,s)=>u0(i,e[s].type_tag))}setSequenceNumber(e){this.builderConfig.sequenceNumber=BigInt(e)}buildTransactionPayload(e,n,i){const s=n.map(a=>new oo(a).parseTypeTag());let o;if(!this.abiMap.has(e))throw new Error(`Cannot find function: ${e}`);const r=this.abiMap.get(e);if(r instanceof Ko){const a=r,c=Wa.toBCSArgs(a.args,i);o=new Sc(new Fs(a.module_name,new jn(a.name),s,c))}else if(r instanceof Dc){const a=r,c=Wa.toTransactionArguments(a.args,i);o=new kc(new xc(a.code,s,c))}else throw new Error("Unknown ABI format.");return o}build(e,n,i){const{sender:s,sequenceNumber:o,gasUnitPrice:r,maxGasAmount:a,expSecFromNow:c,chainId:u}=this.builderConfig;if(!r)throw new Error("No gasUnitPrice provided.");const l=s instanceof en?s:en.fromHex(s),d=BigInt(Math.floor(Date.now()/1e3)+Number(c)),f=this.buildTransactionPayload(e,n,i);if(f)return new ro(l,BigInt(o),f,BigInt(a),BigInt(r),d,new Pc(Number(u)));throw new Error("Invalid ABI.")}},hn=class{constructor(e,n){this.aptosClient=e,this.builderConfig=n}async fetchABI(e){const i=(await this.aptosClient.getAccountModules(e)).map(o=>o.abi).flatMap(o=>o.exposed_functions.filter(r=>r.is_entry).map(r=>({fullName:`${o.address}::${o.name}::${r.name}`,...r}))),s=new Map;return i.forEach(o=>{s.set(o.fullName,o)}),s}async build(e,n,i){if(e=(P=>P.replace(/^0[xX]0*/g,"0x"))(e),e.split("::").length!==3)throw new Error("'func' needs to be a fully qualified function name in format <address>::<module>::<function>, e.g. 0x1::coin::transfer");const[r,a]=e.split("::"),c=await this.fetchABI(r);if(!c.has(e))throw new Error(`${e} doesn't exist.`);const u=c.get(e),d=u.params.filter(P=>P!=="signer"&&P!=="&signer").map((P,M)=>new Jr(`var${M}`,new oo(P,n).parseTypeTag())),f=new Ko(u.name,Xs.fromStr(`${r}::${a}`),"",u.generic_type_params.map((P,M)=>new Vr(`${M}`)),d),{sender:_,...T}=this.builderConfig,v=_ instanceof en?Ot.fromUint8Array(_.address):_,[{sequence_number:k},U,{gas_estimate:R}]=await Promise.all([T!=null&&T.sequenceNumber?Promise.resolve({sequence_number:T==null?void 0:T.sequenceNumber}):this.aptosClient.getAccount(v),T!=null&&T.chainId?Promise.resolve(T==null?void 0:T.chainId):this.aptosClient.getChainId(),T!=null&&T.gasUnitPrice?Promise.resolve({gas_estimate:T==null?void 0:T.gasUnitPrice}):this.aptosClient.estimateGasPrice()]);return new Wa([Ui(f)],{sender:_,sequenceNumber:k,chainId:U,gasUnitPrice:BigInt(R),...T}).build(e,n,i)}};an([Qf(10*60*1e3)],hn.prototype,"fetchABI",1);var xo=class{constructor(e,n,i=!1){if(!e)throw new Error("Node URL cannot be empty.");i?this.nodeUrl=e:this.nodeUrl=ww(e),this.config=n==null?{}:{...n}}async getAccount(e){const{data:n}=await Qn({url:this.nodeUrl,endpoint:`accounts/${Ot.ensure(e).hex()}`,originMethod:"getAccount",overrides:{...this.config}});return n}async getAccountTransactions(e,n){const{data:i}=await Qn({url:this.nodeUrl,endpoint:`accounts/${Ot.ensure(e).hex()}/transactions`,originMethod:"getAccountTransactions",params:{start:n==null?void 0:n.start,limit:n==null?void 0:n.limit},overrides:{...this.config}});return i}async getAccountModules(e,n){return await Zd({url:this.nodeUrl,endpoint:`accounts/${e}/modules`,params:{ledger_version:n==null?void 0:n.ledgerVersion,limit:1e3},originMethod:"getAccountModules",overrides:{...this.config}})}async getAccountModule(e,n,i){const{data:s}=await Qn({url:this.nodeUrl,endpoint:`accounts/${Ot.ensure(e).hex()}/module/${n}`,originMethod:"getAccountModule",params:{ledger_version:i==null?void 0:i.ledgerVersion},overrides:{...this.config}});return s}async getAccountResources(e,n){return await Zd({url:this.nodeUrl,endpoint:`accounts/${e}/resources`,params:{ledger_version:n==null?void 0:n.ledgerVersion,limit:9999},originMethod:"getAccountResources",overrides:{...this.config}})}async getAccountResource(e,n,i){const{data:s}=await Qn({url:this.nodeUrl,endpoint:`accounts/${Ot.ensure(e).hex()}/resource/${n}`,originMethod:"getAccountResource",params:{ledger_version:i==null?void 0:i.ledgerVersion},overrides:{...this.config}});return s}static generateBCSTransaction(e,n){return new Ra(s=>{const o=e.signBuffer(s);return new oe.Ed25519Signature(o.toUint8Array())},e.pubKey().toUint8Array()).sign(n)}static generateBCSSimulation(e,n){return new Ra(s=>{const o=new Uint8Array(64);return new oe.Ed25519Signature(o)},e.pubKey().toUint8Array()).sign(n)}async generateTransaction(e,n,i){const s={sender:e};if(i!=null&&i.sequence_number&&(s.sequenceNumber=i.sequence_number),i!=null&&i.gas_unit_price&&(s.gasUnitPrice=i.gas_unit_price),i!=null&&i.max_gas_amount&&(s.maxGasAmount=i.max_gas_amount),i!=null&&i.expiration_timestamp_secs){const r=Number.parseInt(i.expiration_timestamp_secs,10);s.expSecFromNow=r-Math.floor(Date.now()/1e3)}return new hn(this,s).build(n.function,n.type_arguments,n.arguments)}async generateFeePayerTransaction(e,n,i,s=[],o){const r=await this.generateTransaction(e,n,o),a=s.map(u=>en.fromHex(u));return new oe.FeePayerRawTransaction(r,a,en.fromHex(i))}async submitFeePayerTransaction(e,n,i,s=[]){const o=new oe.TransactionAuthenticatorFeePayer(n,e.secondary_signer_addresses,s,{address:e.fee_payer_address,authenticator:i}),r=Ui(new oe.SignedTransaction(e.raw_txn,o));return await this.submitSignedBCSTransaction(r)}async signMultiTransaction(e,n){const i=new oe.Ed25519Signature(e.signBuffer(Oi.getSigningMessage(n)).toUint8Array()),s=new oe.AccountAuthenticatorEd25519(new oe.Ed25519PublicKey(e.signingKey.publicKey),i);return Promise.resolve(s)}async signTransaction(e,n){return Promise.resolve(xo.generateBCSTransaction(e,n))}async getEventsByCreationNumber(e,n,i){const{data:s}=await Qn({url:this.nodeUrl,endpoint:`accounts/${Ot.ensure(e).hex()}/events/${n}`,originMethod:"getEventsByCreationNumber",params:{start:i==null?void 0:i.start,limit:i==null?void 0:i.limit},overrides:{...this.config}});return s}async getEventsByEventHandle(e,n,i,s){const{data:o}=await Qn({url:this.nodeUrl,endpoint:`accounts/${Ot.ensure(e).hex()}/events/${n}/${i}`,originMethod:"getEventsByEventHandle",params:{start:s==null?void 0:s.start,limit:s==null?void 0:s.limit},overrides:{...this.config}});return o}async submitTransaction(e){return this.submitSignedBCSTransaction(e)}async simulateTransaction(e,n,i){let s;return e instanceof Ur?s=xo.generateBCSSimulation(e,n):e instanceof Gr?s=new l0(()=>{const{threshold:r}=e,a=[],c=[];for(let l=0;l<r;l+=1)a.push(l),c.push(new oe.Ed25519Signature(new Uint8Array(64)));const u=oe.MultiEd25519Signature.createBitmap(a);return new oe.MultiEd25519Signature(c,u)},e).sign(n):s=new Ra(()=>{const r=new Uint8Array(64);return new oe.Ed25519Signature(r)},e.toBytes()).sign(n),this.submitBCSSimulation(s,i)}async submitSignedBCSTransaction(e){const{data:n}=await Ms({url:this.nodeUrl,body:e,endpoint:"transactions",originMethod:"submitSignedBCSTransaction",contentType:"application/x.aptos.signed_transaction+bcs",overrides:{...this.config}});return n}async submitBCSSimulation(e,n){var i,s,o;const r={estimate_gas_unit_price:(i=n==null?void 0:n.estimateGasUnitPrice)!=null?i:!1,estimate_max_gas_amount:(s=n==null?void 0:n.estimateMaxGasAmount)!=null?s:!1,estimate_prioritized_gas_unit_price:(o=n==null?void 0:n.estimatePrioritizedGasUnitPrice)!=null?o:!1},{data:a}=await Ms({url:this.nodeUrl,body:e,endpoint:"transactions/simulate",params:r,originMethod:"submitBCSSimulation",contentType:"application/x.aptos.signed_transaction+bcs",overrides:{...this.config}});return a}async getTransactions(e){var n;const{data:i}=await Qn({url:this.nodeUrl,endpoint:"transactions",originMethod:"getTransactions",params:{start:(n=e==null?void 0:e.start)==null?void 0:n.toString(),limit:e==null?void 0:e.limit},overrides:{...this.config}});return i}async getTransactionByHash(e){const{data:n}=await Qn({url:this.nodeUrl,endpoint:`transactions/by_hash/${e}`,originMethod:"getTransactionByHash",overrides:{...this.config}});return n}async getTransactionByVersion(e){const{data:n}=await Qn({url:this.nodeUrl,endpoint:`transactions/by_version/${e}`,originMethod:"getTransactionByVersion",overrides:{...this.config}});return n}async transactionPending(e){try{return(await this.getTransactionByHash(e)).type==="pending_transaction"}catch(n){if((n==null?void 0:n.status)===404)return!0;throw n}}async waitForTransactionWithResult(e,n){var i,s;const o=(i=n==null?void 0:n.timeoutSecs)!=null?i:Yf,r=(s=n==null?void 0:n.checkSuccess)!=null?s:!1;let a=!0,c=0,u;for(;a&&!(c>=o);){try{if(u=await this.getTransactionByHash(e),a=u.type==="pending_transaction",!a)break}catch(l){const d=l instanceof si,f=d&&l.status!==404&&l.status>=400&&l.status<500;if(!d||f)throw l}await vr(1e3),c+=1}if(u===void 0)throw new Error(`Waiting for transaction ${e} failed`);if(a)throw new d0(`Waiting for transaction ${e} timed out after ${o} seconds`,u);if(!r)return u;if(!(u!=null&&u.success))throw new h0(`Transaction ${e} failed with an error: ${u.vm_status}`,u);return u}async waitForTransaction(e,n){await this.waitForTransactionWithResult(e,n)}async getLedgerInfo(){const{data:e}=await Qn({url:this.nodeUrl,originMethod:"getLedgerInfo",overrides:{...this.config}});return e}async getChainId(){return(await this.getLedgerInfo()).chain_id}async getTableItem(e,n,i){var s;return(await Ms({url:this.nodeUrl,body:n,endpoint:`tables/${e}/item`,originMethod:"getTableItem",params:{ledger_version:(s=i==null?void 0:i.ledgerVersion)==null?void 0:s.toString()},overrides:{...this.config}})).data}async generateRawTransaction(e,n,i){const[{sequence_number:s},o,{gas_estimate:r}]=await Promise.all([i!=null&&i.providedSequenceNumber?Promise.resolve({sequence_number:i.providedSequenceNumber}):this.getAccount(e),this.getChainId(),i!=null&&i.gasUnitPrice?Promise.resolve({gas_estimate:i.gasUnitPrice}):this.estimateGasPrice()]),{maxGasAmount:a,gasUnitPrice:c,expireTimestamp:u}={maxGasAmount:BigInt(Jf),gasUnitPrice:BigInt(r),expireTimestamp:BigInt(Math.floor(Date.now()/1e3)+Zf),...i};return new oe.RawTransaction(oe.AccountAddress.fromHex(e),BigInt(s),n,a,c,u,new oe.ChainId(o))}async generateSignSubmitTransaction(e,n,i){const s=await this.generateRawTransaction(e.address(),n,i),o=xo.generateBCSTransaction(e,s);return(await this.submitSignedBCSTransaction(o)).hash}async signAndSubmitTransaction(e,n){const i=xo.generateBCSTransaction(e,n);return(await this.submitSignedBCSTransaction(i)).hash}async publishPackage(e,n,i,s){const o=new fn;Fn(i,o);const r=new oe.TransactionPayloadEntryFunction(oe.EntryFunction.natural("0x1::code","publish_package_txn",[],[vs(n),o.getBytes()]));return this.generateSignSubmitTransaction(e,r,s)}async createResourceAccountAndPublishPackage(e,n,i,s,o){const r=new fn;Fn(s,r);const a=new oe.TransactionPayloadEntryFunction(oe.EntryFunction.natural("0x1::resource_account","create_resource_account_and_publish_package",[],[vs(n),vs(i),r.getBytes()]));return this.generateSignSubmitTransaction(e,a,o)}async generateSignSubmitWaitForTransaction(e,n,i){const s=await this.generateSignSubmitTransaction(e,n,i);return this.waitForTransactionWithResult(s,i)}async estimateGasPrice(){const{data:e}=await Qn({url:this.nodeUrl,endpoint:"estimate_gas_price",originMethod:"estimateGasPrice",overrides:{...this.config}});return e}async estimateMaxGasAmount(e){const n=`0x1::coin::CoinStore<${Ka}>`,[{gas_estimate:i},s]=await Promise.all([this.estimateGasPrice(),this.getAccountResources(e)]),o=s.find(a=>a.type===n);return BigInt(o.data.coin.value)/BigInt(i)}async rotateAuthKeyEd25519(e,n,i){const{sequence_number:s,authentication_key:o}=await this.getAccount(e.address()),r=new Ur(n),a=new oe.RotationProofChallenge(oe.AccountAddress.CORE_CODE_ADDRESS,"account","RotationProofChallenge",BigInt(s),oe.AccountAddress.fromHex(e.address()),new oe.AccountAddress(new Ot(o).toUint8Array()),r.pubKey().toUint8Array()),c=Ot.fromUint8Array(Ui(a)),u=e.signHexString(c),l=r.signHexString(c),d=new oe.TransactionPayloadEntryFunction(oe.EntryFunction.natural("0x1::account","rotate_authentication_key",[],[ol(0),vs(e.pubKey().toUint8Array()),ol(0),vs(r.pubKey().toUint8Array()),vs(u.toUint8Array()),vs(l.toUint8Array())])),f=await this.generateRawTransaction(e.address(),d,i),_=xo.generateBCSTransaction(e,f);return this.submitSignedBCSTransaction(_)}async lookupOriginalAddress(e){const n=await this.getAccountResource("0x1","0x1::account::OriginatingAddress"),{address_map:{handle:i}}=n.data,s=await this.getTableItem(i,{key_type:"address",value_type:"address",key:Ot.ensure(e).hex()});return new Ot(s)}async getBlockByHeight(e,n){const{data:i}=await Qn({url:this.nodeUrl,endpoint:`blocks/by_height/${e}`,originMethod:"getBlockByHeight",params:{with_transactions:n},overrides:{...this.config}});return i}async getBlockByVersion(e,n){const{data:i}=await Qn({url:this.nodeUrl,endpoint:`blocks/by_version/${e}`,originMethod:"getBlockByVersion",params:{with_transactions:n},overrides:{...this.config}});return i}async view(e,n){const{data:i}=await Ms({url:this.nodeUrl,body:e,endpoint:"view",originMethod:"getTableItem",params:{ledger_version:n},overrides:{...this.config}});return i}clearCache(e){bw(e)}},Ce=xo;an([Pn],Ce.prototype,"getAccount",1);an([Pn],Ce.prototype,"getAccountTransactions",1);an([Pn,Qf(10*60*1e3)],Ce.prototype,"getAccountModules",1);an([Pn],Ce.prototype,"getAccountModule",1);an([Pn],Ce.prototype,"getAccountResources",1);an([Pn],Ce.prototype,"getAccountResource",1);an([Pn],Ce.prototype,"getEventsByCreationNumber",1);an([Pn],Ce.prototype,"getEventsByEventHandle",1);an([Pn],Ce.prototype,"submitSignedBCSTransaction",1);an([Pn],Ce.prototype,"submitBCSSimulation",1);an([Pn],Ce.prototype,"getTransactions",1);an([Pn],Ce.prototype,"getTransactionByHash",1);an([Pn],Ce.prototype,"getTransactionByVersion",1);an([Pn],Ce.prototype,"getLedgerInfo",1);an([yc()],Ce.prototype,"getChainId",1);an([Pn],Ce.prototype,"getTableItem",1);an([Pn,yc({ttlMs:5*60*1e3,tags:["gas_estimates"]})],Ce.prototype,"estimateGasPrice",1);an([Pn],Ce.prototype,"estimateMaxGasAmount",1);an([Pn],Ce.prototype,"getBlockByHeight",1);an([Pn],Ce.prototype,"getBlockByVersion",1);an([Pn],Ce.prototype,"view",1);var d0=class extends Error{constructor(e,n){super(e),this.lastSubmittedTransaction=n}},h0=class extends Error{constructor(e,n){super(e),this.transaction=n}},si=class extends Error{constructor(e,n,i,s){super(n),this.status=e,this.message=n,this.errorCode=i,this.vmErrorCode=s}};function Pn(t,e,n){const i=n.value;return n.value=async function(...o){var r,a;try{return await i.apply(this,[...o])}catch(c){throw c instanceof Dl?new si(c.status,JSON.stringify({message:c.message,...c.data}),(r=c.data)==null?void 0:r.error_code,(a=c.data)==null?void 0:a.vm_error_code):c}},n}var mn=class{constructor(e,n){this.endpoint=e,this.config=n}static validateAddress(e){if(e.length<66)throw new Error(`${e} is less than 66 chars long.`)}async queryIndexer(e){const n=await Ms({url:this.endpoint,body:e,overrides:{WITH_CREDENTIALS:!1,...this.config}});if(n.data.errors)throw new si(n.data.errors[0].extensions.code,JSON.stringify({message:n.data.errors[0].message,error_code:n.data.errors[0].extensions.code}));return n.data.data}async getIndexerLedgerInfo(){const e={query:eb};return this.queryIndexer(e)}async getAccountNFTs(e,n){const i=Ot.ensure(e).hex();mn.validateAddress(i);const s={query:Ww,variables:{address:i,offset:n==null?void 0:n.offset,limit:n==null?void 0:n.limit}};return this.queryIndexer(s)}async getTokenActivities(e,n){var i,s;const o=Ot.ensure(e).hex();mn.validateAddress(o);const r={token_data_id:{_eq:o}};n!=null&&n.tokenStandard&&(r.token_standard={_eq:n==null?void 0:n.tokenStandard});const a={query:ob,variables:{where_condition:r,offset:(i=n==null?void 0:n.options)==null?void 0:i.offset,limit:(s=n==null?void 0:n.options)==null?void 0:s.limit,order_by:n==null?void 0:n.orderBy}};return this.queryIndexer(a)}async getTokenActivitiesCount(e){const n={query:rb,variables:{token_id:e}};return this.queryIndexer(n)}async getAccountTokensCount(e,n){var i,s;const o={owner_address:{_eq:e},amount:{_gt:"0"}};n!=null&&n.tokenStandard&&(o.token_standard={_eq:n==null?void 0:n.tokenStandard});const r=Ot.ensure(e).hex();mn.validateAddress(r);const a={query:Xw,variables:{where_condition:o,offset:(i=n==null?void 0:n.options)==null?void 0:i.offset,limit:(s=n==null?void 0:n.options)==null?void 0:s.limit}};return this.queryIndexer(a)}async getTokenData(e,n){var i,s;const o=Ot.ensure(e).hex();mn.validateAddress(o);const r={token_data_id:{_eq:o}};n!=null&&n.tokenStandard&&(r.token_standard={_eq:n==null?void 0:n.tokenStandard});const a={query:cb,variables:{where_condition:r,offset:(i=n==null?void 0:n.options)==null?void 0:i.offset,limit:(s=n==null?void 0:n.options)==null?void 0:s.limit,order_by:n==null?void 0:n.orderBy}};return this.queryIndexer(a)}async getTokenOwnersData(e,n,i){var s,o;const r=Ot.ensure(e).hex();mn.validateAddress(r);const a={token_data_id:{_eq:r},amount:{_gt:"0"}};n&&(a.property_version_v1={_eq:n}),i!=null&&i.tokenStandard&&(a.token_standard={_eq:i==null?void 0:i.tokenStandard});const c={query:lb,variables:{where_condition:a,offset:(s=i==null?void 0:i.options)==null?void 0:s.offset,limit:(o=i==null?void 0:i.options)==null?void 0:o.limit,order_by:i==null?void 0:i.orderBy}};return this.queryIndexer(c)}async getTokenCurrentOwnerData(e,n,i){var s,o;const r=Ot.ensure(e).hex();mn.validateAddress(r);const a={token_data_id:{_eq:r},amount:{_gt:"0"}};n&&(a.property_version_v1={_eq:n}),i!=null&&i.tokenStandard&&(a.token_standard={_eq:i==null?void 0:i.tokenStandard});const c={query:ab,variables:{where_condition:a,offset:(s=i==null?void 0:i.options)==null?void 0:s.offset,limit:(o=i==null?void 0:i.options)==null?void 0:o.limit,order_by:i==null?void 0:i.orderBy}};return this.queryIndexer(c)}async getOwnedTokens(e,n){var i,s;const o=Ot.ensure(e).hex();mn.validateAddress(o);const r={owner_address:{_eq:o},amount:{_gt:0}};n!=null&&n.tokenStandard&&(r.token_standard={_eq:n==null?void 0:n.tokenStandard});const a={query:ib,variables:{where_condition:r,offset:(i=n==null?void 0:n.options)==null?void 0:i.offset,limit:(s=n==null?void 0:n.options)==null?void 0:s.limit,order_by:n==null?void 0:n.orderBy}};return this.queryIndexer(a)}async getOwnedTokensByTokenData(e,n){var i,s;const o=Ot.ensure(e).hex();mn.validateAddress(o);const r={token_data_id:{_eq:o},amount:{_gt:0}};n!=null&&n.tokenStandard&&(r.token_standard={_eq:n==null?void 0:n.tokenStandard});const a={query:sb,variables:{where_condition:r,offset:(i=n==null?void 0:n.options)==null?void 0:i.offset,limit:(s=n==null?void 0:n.options)==null?void 0:s.limit,order_by:n==null?void 0:n.orderBy}};return this.queryIndexer(a)}async getTokenOwnedFromCollectionAddress(e,n,i){var s,o;const r=Ot.ensure(e).hex();mn.validateAddress(r);const a=Ot.ensure(n).hex();mn.validateAddress(a);const c={owner_address:{_eq:r},current_token_data:{collection_id:{_eq:a}},amount:{_gt:0}};i!=null&&i.tokenStandard&&(c.token_standard={_eq:i==null?void 0:i.tokenStandard});const u={query:ub,variables:{where_condition:c,offset:(s=i==null?void 0:i.options)==null?void 0:s.offset,limit:(o=i==null?void 0:i.options)==null?void 0:o.limit,order_by:i==null?void 0:i.orderBy}};return this.queryIndexer(u)}async getTokenOwnedFromCollectionNameAndCreatorAddress(e,n,i,s){const o=await this.getCollectionAddress(i,n,s);return await this.getTokenOwnedFromCollectionAddress(e,o,s)}async getCollectionData(e,n,i){var s,o;const r=Ot.ensure(e).hex();mn.validateAddress(r);const a={collection_name:{_eq:n},creator_address:{_eq:r}};i!=null&&i.tokenStandard&&(a.token_standard={_eq:i==null?void 0:i.tokenStandard});const c={query:Zw,variables:{where_condition:a,offset:(s=i==null?void 0:i.options)==null?void 0:s.offset,limit:(o=i==null?void 0:i.options)==null?void 0:o.limit,order_by:i==null?void 0:i.orderBy}};return this.queryIndexer(c)}async getCollectionAddress(e,n,i){return(await this.getCollectionData(e,n,i)).current_collections_v2[0].collection_id}async getCollectionsWithOwnedTokens(e,n){var i,s;const o=Ot.ensure(e).hex();mn.validateAddress(o);const r={owner_address:{_eq:o}};n!=null&&n.tokenStandard&&(r.current_collection={token_standard:{_eq:n==null?void 0:n.tokenStandard}});const a={query:Yw,variables:{where_condition:r,offset:(i=n==null?void 0:n.options)==null?void 0:i.offset,limit:(s=n==null?void 0:n.options)==null?void 0:s.limit,order_by:n==null?void 0:n.orderBy}};return this.queryIndexer(a)}async getAccountTransactionsCount(e){const n=Ot.ensure(e).hex();mn.validateAddress(n);const i={query:Vw,variables:{address:n}};return this.queryIndexer(i)}async getAccountTransactionsData(e,n){var i,s;const o=Ot.ensure(e).hex();mn.validateAddress(o);const a={query:Jw,variables:{where_condition:{account_address:{_eq:o}},offset:(i=n==null?void 0:n.options)==null?void 0:i.offset,limit:(s=n==null?void 0:n.options)==null?void 0:s.limit,order_by:n==null?void 0:n.orderBy}};return this.queryIndexer(a)}async getTopUserTransactions(e){const n={query:db,variables:{limit:e}};return this.queryIndexer(n)}async getUserTransactions(e){var n,i;const s={version:{_lte:e==null?void 0:e.startVersion}},o={query:hb,variables:{where_condition:s,offset:(n=e==null?void 0:e.options)==null?void 0:n.offset,limit:(i=e==null?void 0:e.options)==null?void 0:i.limit,order_by:e==null?void 0:e.orderBy}};return this.queryIndexer(o)}async getDelegatedStakingActivities(e,n){const i=Ot.ensure(e).hex(),s=Ot.ensure(n).hex();mn.validateAddress(i),mn.validateAddress(s);const o={query:tb,variables:{delegatorAddress:i,poolAddress:s}};return this.queryIndexer(o)}async getNumberOfDelegators(e){const n=Ot.ensure(e).hex();mn.validateAddress(n);const i={query:nb,variables:{poolAddress:n}};return this.queryIndexer(i)}async getAccountCoinsData(e,n){var i,s;const o=Ot.ensure(e).hex();mn.validateAddress(o);const a={query:Gw,variables:{where_condition:{owner_address:{_eq:o}},offset:(i=n==null?void 0:n.options)==null?void 0:i.offset,limit:(s=n==null?void 0:n.options)==null?void 0:s.limit,order_by:n==null?void 0:n.orderBy}};return this.queryIndexer(a)}async getAccountCoinsDataCount(e){const n=Ot.ensure(e).hex();mn.validateAddress(n);const i={query:Kw,variables:{address:n}};return this.queryIndexer(i)}async getAccountOwnedObjects(e,n){var i,s;const o=Ot.ensure(e).hex();mn.validateAddress(o);const a={query:Qw,variables:{where_condition:{owner_address:{_eq:o}},offset:(i=n==null?void 0:n.options)==null?void 0:i.offset,limit:(s=n==null?void 0:n.options)==null?void 0:s.limit,order_by:n==null?void 0:n.orderBy}};return this.queryIndexer(a)}},$r=class{constructor(e,n,i=!1){let s=null,o=null;if(typeof e=="object"&&mb(e)?(s=e.fullnodeUrl,o=e.indexerUrl,this.network="CUSTOM"):(s=t0[e],o=Ga[e],this.network=e),this.network==="CUSTOM"&&!s)throw new Error("fullnode url is not provided");o&&(this.indexerClient=new mn(o,n)),this.aptosClient=new Ce(s,n,i)}};function f0(t,e,n){Object.getOwnPropertyNames(e.prototype).forEach(i=>{const s=Object.getOwnPropertyDescriptor(e.prototype,i);s&&(s.value=function(...o){return this[n][i](...o)},Object.defineProperty(t.prototype,i,s))}),Object.getOwnPropertyNames(e).forEach(i=>{const s=Object.getOwnPropertyDescriptor(e,i);s&&(s.value=function(...o){return this[n][i](...o)},!t.hasOwnProperty.call(t,i)&&Object.defineProperty(t,i,s))})}f0($r,Ce,"aptosClient");f0($r,mn,"indexerClient");function mb(t){return t.fullnodeUrl!==void 0&&typeof t.fullnodeUrl=="string"}var td=class{constructor(e,n){this.type=e,this.value=n}},Fc=class{constructor(){this.data={}}setProperty(e,n){this.data[e]=n}};function jc(t){let e;return t==="string"||t==="String"?e=new Es(Gl):e=new oo(t).parseTypeTag(),e}function Xa(t,e){if(t.length!==e.length)throw new Error("Length of property values and types not match");const n=new Array;return e.forEach((i,s)=>{try{const o=jc(i),r=new fn;Nc(t[s],o,r),n.push(r.getBytes())}catch{n.push(new TextEncoder().encode(t[s]))}}),n}function al(t,e){if(!t||!e)throw new Error("value or type can not be empty");try{const n=jc(e),i=new fn;return Nc(t,n,i),i.getBytes()}catch{return new TextEncoder().encode(t)}}function ed(t){const e=t.map.data,n=new Fc;return e.forEach(i=>{const{key:s}=i,o=i.value.value,r=i.value.type,a=jc(r),c=p0(a,o),u=new td(r,c);n.setProperty(s,u)}),n}function p0(t,e){const n=new Nl(new Ot(e).toUint8Array());let i="";return t instanceof es?i=n.deserializeU8().toString():t instanceof io?i=n.deserializeU64().toString():t instanceof so?i=n.deserializeU128().toString():t instanceof no?i=n.deserializeBool()?"true":"false":t instanceof Bs?i=Ot.fromUint8Array(n.deserializeFixedBytes(32)).hex():t instanceof Es&&t.isStringTypeTag()?i=n.deserializeStr():i=e,i}var g0={};mc(g0,{PropertyMap:()=>Fc,PropertyValue:()=>td,Token:()=>m0,TokenData:()=>_0});var _0=class{constructor(e,n,i,s,o,r,a,c){this.collection=e,this.description=n,this.name=i,this.maximum=s,this.supply=o,this.uri=r,this.default_properties=ed(a),this.mutability_config=c}},m0=class{constructor(e,n,i){this.id=e,this.amount=n,this.token_properties=ed(i)}},yb=class{constructor(e){this.aptosClient=e}async createCollection(e,n,i,s,o=Uo,r){const c=await new hn(this.aptosClient,{sender:e.address(),...r}).build("0x3::token::create_collection_script",[],[n,i,s,o,[!1,!1,!1]]),u=Ce.generateBCSTransaction(e,c);return(await this.aptosClient.submitSignedBCSTransaction(u)).hash}async createToken(e,n,i,s,o,r,a=Uo,c=e.address(),u=0,l=0,d=[],f=[],_=[],T){const k=await new hn(this.aptosClient,{sender:e.address(),...T}).build("0x3::token::create_token_script",[],[n,i,s,o,a,r,c,u,l,[!1,!1,!1,!1,!1],d,Xa(f,_),_]),U=Ce.generateBCSTransaction(e,k);return(await this.aptosClient.submitSignedBCSTransaction(U)).hash}async createTokenWithMutabilityConfig(e,n,i,s,o,r,a=Uo,c=e.address(),u=0,l=0,d=[],f=[],_=[],T=[!1,!1,!1,!1,!1],v){const U=await new hn(this.aptosClient,{sender:e.address(),...v}).build("0x3::token::create_token_script",[],[n,i,s,o,a,r,c,u,l,T,d,f,_]),R=Ce.generateBCSTransaction(e,U);return(await this.aptosClient.submitSignedBCSTransaction(R)).hash}async offerToken(e,n,i,s,o,r,a=0,c){const l=await new hn(this.aptosClient,{sender:e.address(),...c}).build("0x3::token_transfers::offer_script",[],[n,i,s,o,a,r]),d=Ce.generateBCSTransaction(e,l);return(await this.aptosClient.submitSignedBCSTransaction(d)).hash}async claimToken(e,n,i,s,o,r=0,a){const u=await new hn(this.aptosClient,{sender:e.address(),...a}).build("0x3::token_transfers::claim_script",[],[n,i,s,o,r]),l=Ce.generateBCSTransaction(e,u);return(await this.aptosClient.submitSignedBCSTransaction(l)).hash}async cancelTokenOffer(e,n,i,s,o,r=0,a){const u=await new hn(this.aptosClient,{sender:e.address(),...a}).build("0x3::token_transfers::cancel_offer_script",[],[n,i,s,o,r]),l=Ce.generateBCSTransaction(e,u);return(await this.aptosClient.submitSignedBCSTransaction(l)).hash}async directTransferToken(e,n,i,s,o,r,a=0,c){const l=await new hn(this.aptosClient,{sender:e.address(),...c}).build("0x3::token::direct_transfer_script",[],[i,s,o,a,r]),d=new oe.MultiAgentRawTransaction(l,[oe.AccountAddress.fromHex(n.address())]),f=new oe.Ed25519Signature(e.signBuffer(Oi.getSigningMessage(d)).toUint8Array()),_=new oe.AccountAuthenticatorEd25519(new oe.Ed25519PublicKey(e.signingKey.publicKey),f),T=new oe.Ed25519Signature(n.signBuffer(Oi.getSigningMessage(d)).toUint8Array()),v=new oe.AccountAuthenticatorEd25519(new oe.Ed25519PublicKey(n.signingKey.publicKey),T),k=new oe.TransactionAuthenticatorMultiAgent(_,[oe.AccountAddress.fromHex(n.address())],[v]),U=Ui(new oe.SignedTransaction(l,k));return(await this.aptosClient.submitSignedBCSTransaction(U)).hash}async directTransferTokenWithFeePayer(e,n,i,s,o,r,a,c=0,u){const d=await new hn(this.aptosClient,{sender:e.address(),...u}).build("0x3::token::direct_transfer_script",[],[i,s,o,c,r]),f=new oe.FeePayerRawTransaction(d,[oe.AccountAddress.fromHex(n.address())],oe.AccountAddress.fromHex(a.address())),_=new oe.Ed25519Signature(e.signBuffer(Oi.getSigningMessage(f)).toUint8Array()),T=new oe.AccountAuthenticatorEd25519(new oe.Ed25519PublicKey(e.signingKey.publicKey),_),v=new oe.Ed25519Signature(n.signBuffer(Oi.getSigningMessage(f)).toUint8Array()),k=new oe.AccountAuthenticatorEd25519(new oe.Ed25519PublicKey(n.signingKey.publicKey),v),U=new oe.Ed25519Signature(a.signBuffer(Oi.getSigningMessage(f)).toUint8Array()),R=new oe.AccountAuthenticatorEd25519(new oe.Ed25519PublicKey(a.signingKey.publicKey),U),A=new oe.TransactionAuthenticatorFeePayer(T,[oe.AccountAddress.fromHex(n.address())],[k],{address:oe.AccountAddress.fromHex(a.address()),authenticator:R}),P=Ui(new oe.SignedTransaction(d,A));return(await this.aptosClient.submitSignedBCSTransaction(P)).hash}async optInTokenTransfer(e,n,i){const o=await new hn(this.aptosClient,{sender:e.address(),...i}).build("0x3::token::opt_in_direct_transfer",[],[n]),r=Ce.generateBCSTransaction(e,o);return(await this.aptosClient.submitSignedBCSTransaction(r)).hash}async transferWithOptIn(e,n,i,s,o,r,a,c){const l=await new hn(this.aptosClient,{sender:e.address(),...c}).build("0x3::token::transfer_with_opt_in",[],[n,i,s,o,r,a]),d=Ce.generateBCSTransaction(e,l);return(await this.aptosClient.submitSignedBCSTransaction(d)).hash}async burnByCreator(e,n,i,s,o,r,a){const u=await new hn(this.aptosClient,{sender:e.address(),...a}).build("0x3::token::burn_by_creator",[],[n,i,s,o,r]),l=Ce.generateBCSTransaction(e,u);return(await this.aptosClient.submitSignedBCSTransaction(l)).hash}async burnByOwner(e,n,i,s,o,r,a){const u=await new hn(this.aptosClient,{sender:e.address(),...a}).build("0x3::token::burn",[],[n,i,s,o,r]),l=Ce.generateBCSTransaction(e,u);return(await this.aptosClient.submitSignedBCSTransaction(l)).hash}async mutateTokenProperties(e,n,i,s,o,r,a,c,u,l,d){const _=await new hn(this.aptosClient,{sender:e.address(),...d}).build("0x3::token::mutate_token_properties",[],[n,i,s,o,r,a,c,u,l]),T=Ce.generateBCSTransaction(e,_);return(await this.aptosClient.submitSignedBCSTransaction(T)).hash}async getCollectionData(e,n){const s=(await this.aptosClient.getAccountResources(e)).find(c=>c.type==="0x3::token::Collections"),{handle:o}=s.data.collection_data,r={key_type:"0x1::string::String",value_type:"0x3::token::CollectionData",key:n};return await this.aptosClient.getTableItem(o,r)}async getTokenData(e,n,i){const s=e instanceof Ot?e.hex():e,o=await this.aptosClient.getAccountResource(s,"0x3::token::Collections"),{handle:r}=o.data.token_data,c={key_type:"0x3::token::TokenDataId",value_type:"0x3::token::TokenData",key:{creator:s,collection:n,name:i}},u=await this.aptosClient.getTableItem(r,c);return new _0(u.collection,u.description,u.name,u.maximum,u.supply,u.uri,u.default_properties,u.mutability_config)}async getToken(e,n,i,s="0"){const o={creator:e instanceof Ot?e.hex():e,collection:n,name:i};return this.getTokenForAccount(e,{token_data_id:o,property_version:s})}async getTokenForAccount(e,n){const i=await this.aptosClient.getAccountResource(e instanceof Ot?e.hex():e,"0x3::token::TokenStore"),{handle:s}=i.data.tokens,o={key_type:"0x3::token::TokenId",value_type:"0x3::token::Token",key:n};try{const r=await this.aptosClient.getTableItem(s,o);return new m0(r.id,r.amount,r.token_properties)}catch(r){return(r==null?void 0:r.status)===404?{id:n,amount:"0",token_properties:new Fc}:r}}},Va=class{constructor(t){this.assetType="0x1::fungible_asset::Metadata",this.provider=t}async transfer(t,e,n,i,s){const o=await this.generateTransfer(t,e,n,i,s);return await this.provider.signAndSubmitTransaction(t,o)}async getPrimaryBalance(t,e){const n={function:"0x1::primary_fungible_store::balance",type_arguments:[this.assetType],arguments:[Ot.ensure(t).hex(),Ot.ensure(e).hex()]},i=await this.provider.view(n);return BigInt(i[0])}async generateTransfer(t,e,n,i,s){return await new hn(this.provider,{sender:t.address(),...s}).build("0x1::primary_fungible_store::transfer",[this.assetType],[Ot.ensure(e).hex(),Ot.ensure(n).hex(),i])}},mo={BOOLEAN:"bool",U8:"u8",U16:"u16",U32:"u32",U64:"u64",U128:"u128",U256:"u256",ADDRESS:"address",VECTOR:"vector<u8>",STRING:"string"},wb=class{constructor(t){this.tokenType="0x4::token::Token",this.provider=t}async submitTransaction(t,e,n,i,s){const r=await new hn(this.provider,{sender:t.address(),...s}).build(`0x4::aptos_token::${e}`,n,i),a=Ce.generateBCSTransaction(t,r);return(await this.provider.submitSignedBCSTransaction(a)).hash}async createCollection(t,e,n,i,s=Uo,o,r){var a,c,u,l,d,f,_,T,v,k,U;return this.submitTransaction(t,"create_collection",[],[e,s,n,i,(a=o==null?void 0:o.mutableDescription)!=null?a:!0,(c=o==null?void 0:o.mutableRoyalty)!=null?c:!0,(u=o==null?void 0:o.mutableURI)!=null?u:!0,(l=o==null?void 0:o.mutableTokenDescription)!=null?l:!0,(d=o==null?void 0:o.mutableTokenName)!=null?d:!0,(f=o==null?void 0:o.mutableTokenProperties)!=null?f:!0,(_=o==null?void 0:o.mutableTokenURI)!=null?_:!0,(T=o==null?void 0:o.tokensBurnableByCreator)!=null?T:!0,(v=o==null?void 0:o.tokensFreezableByCreator)!=null?v:!0,(k=o==null?void 0:o.royaltyNumerator)!=null?k:0,(U=o==null?void 0:o.royaltyDenominator)!=null?U:1],r)}async mint(t,e,n,i,s,o=[],r=[],a=[],c){return this.submitTransaction(t,"mint",[],[e,n,i,s,o,r,Xa(a,r)],c)}async mintSoulBound(t,e,n,i,s,o,r=[],a=[],c=[],u){return this.submitTransaction(t,"mint_soul_bound",[],[e,n,i,s,r,a,Xa(c,a),o.address().hex()],u)}async burnToken(t,e,n,i){return this.submitTransaction(t,"burn",[n||this.tokenType],[Ot.ensure(e).hex()],i)}async freezeTokenTransafer(t,e,n,i){return this.submitTransaction(t,"freeze_transfer",[n||this.tokenType],[Ot.ensure(e).hex()],i)}async unfreezeTokenTransafer(t,e,n,i){return this.submitTransaction(t,"unfreeze_transfer",[n||this.tokenType],[Ot.ensure(e).hex()],i)}async setTokenDescription(t,e,n,i,s){return this.submitTransaction(t,"set_description",[i||this.tokenType],[Ot.ensure(e).hex(),n],s)}async setTokenName(t,e,n,i,s){return this.submitTransaction(t,"set_name",[i||this.tokenType],[Ot.ensure(e).hex(),n],s)}async setTokenURI(t,e,n,i,s){return this.submitTransaction(t,"set_uri",[i||this.tokenType],[Ot.ensure(e).hex(),n],s)}async addTokenProperty(t,e,n,i,s,o,r){return this.submitTransaction(t,"add_property",[o||this.tokenType],[Ot.ensure(e).hex(),n,mo[i],al(s,mo[i])],r)}async removeTokenProperty(t,e,n,i,s){return this.submitTransaction(t,"remove_property",[i||this.tokenType],[Ot.ensure(e).hex(),n],s)}async updateTokenProperty(t,e,n,i,s,o,r){return this.submitTransaction(t,"update_property",[o||this.tokenType],[Ot.ensure(e).hex(),n,mo[i],al(s,mo[i])],r)}async addTypedProperty(t,e,n,i,s,o,r){return this.submitTransaction(t,"add_typed_property",[o||this.tokenType,mo[i]],[Ot.ensure(e).hex(),n,s],r)}async updateTypedProperty(t,e,n,i,s,o,r){return this.submitTransaction(t,"update_typed_property",[o||this.tokenType,mo[i]],[Ot.ensure(e).hex(),n,s],r)}async transferTokenOwnership(t,e,n,i,s){const r=await new hn(this.provider,{sender:t.address(),...s}).build("0x1::object::transfer",[i||this.tokenType],[Ot.ensure(e).hex(),Ot.ensure(n).hex()]),a=Ce.generateBCSTransaction(t,r);return(await this.provider.submitSignedBCSTransaction(a)).hash}async transfer(t,e){let n=e;if(n==null&&(n=(await this.provider.getTokenData(Ot.ensure(t.tokenAddress).hex())).current_token_datas_v2[0].is_fungible_v2),n){const o=t;return await new Va(this.provider).transfer(o.owner,o.tokenAddress,o.recipient,o.amount,o.extraArgs)}const i=t;return await this.transferTokenOwnership(i.owner,i.tokenAddress,i.recipient,i.tokenType,i.extraArgs)}async burnObject(t,e,n,i){const o=await new hn(this.provider,{sender:t.address(),...i}).build("0x1::object::burn",[n||"0x1::object::ObjectCore"],[Ot.ensure(e).hex()]),r=Ce.generateBCSTransaction(t,o);return(await this.provider.submitSignedBCSTransaction(r)).hash}},cl="0x1::aptos_account::transfer_coins",y0="0x1::coin::transfer",bb=class{constructor(t){this.aptosClient=t}async transfer(t,e,n,i){var s,o,r;const a=((s=i==null?void 0:i.coinType)!=null?s:"").toString().includes("::");if(i!=null&&i.coinType&&!a&&en.isValid(i.coinType)){console.warn("to transfer a fungible asset, use `FungibleAssetClient()` class for better support");const v=new $r({fullnodeUrl:this.aptosClient.nodeUrl,indexerUrl:(o=Ga[sl[this.aptosClient.nodeUrl]])!=null?o:this.aptosClient.nodeUrl});return await new Va(v).transfer(t,i==null?void 0:i.coinType,Ii(e),n)}const c=(r=i==null?void 0:i.coinType)!=null?r:Ka;let u;(i==null?void 0:i.createReceiverIfMissing)===void 0?u=cl:u=i!=null&&i.createReceiverIfMissing?cl:y0;const l=Ii(e),f=await new hn(this.aptosClient,{sender:t.address(),...i}).build(u,[c],[l,n]),_=Ce.generateBCSTransaction(t,f);return(await this.aptosClient.submitSignedBCSTransaction(_)).hash}async checkBalance(t,e){var n,i,s;const o=((n=e==null?void 0:e.coinType)!=null?n:"").toString().includes("::");if(e!=null&&e.coinType&&!o&&en.isValid(e.coinType)){console.warn("to check balance of a fungible asset, use `FungibleAssetClient()` class for better support");const l=new $r({fullnodeUrl:this.aptosClient.nodeUrl,indexerUrl:(i=Ga[sl[this.aptosClient.nodeUrl]])!=null?i:this.aptosClient.nodeUrl});return await new Va(l).getPrimaryBalance(Ii(t),e==null?void 0:e.coinType)}const a=`0x1::coin::CoinStore<${(s=e==null?void 0:e.coinType)!=null?s:Ka}>`,c=Ii(t),u=await this.aptosClient.getAccountResource(c,a);return BigInt(u.data.coin.value)}},vb=class extends Ce{constructor(t,e,n){if(super(t,n),!e)throw new Error("Faucet URL cannot be empty.");this.faucetUrl=e,this.config=n}async fundAccount(t,e,n=Yf){const{data:i}=await Ms({url:this.faucetUrl,endpoint:"mint",body:null,params:{address:Ot.ensure(t).noPrefix(),amount:e},overrides:{...this.config},originMethod:"fundAccount"}),s=[];for(let o=0;o<i.length;o+=1){const r=i[o];s.push(this.waitForTransaction(r,{timeoutSecs:n}))}return await Promise.all(s),i}},ul={testnet:"0x5f8fd2347449685cf41d4db97926ec3a096eaf381332be4f1318ad4d16a8497c",mainnet:"0x867ed1f6bf916171b1de3ee92849b8978b7d1b9e0a8cc982a3d19d535dfd9c0c"},Ji=/^[a-z\d][a-z\d-]{1,61}[a-z\d]$/,w0=new RegExp("^(?:(?<subdomain>[^.]+)\\.(?!apt$))?(?<domain>[^.]+)(?:\\.apt)?$"),xb=class{constructor(t,e){var n;if(this.provider=t,!ul[this.provider.network]&&!e)throw new Error("Error: For custom providers, you must pass in a contract address");this.contractAddress=(n=ul[this.provider.network])!=null?n:e}async getPrimaryNameByAddress(t){const n=(await this.provider.getAccountResource(this.contractAddress,`${this.contractAddress}::domains::ReverseLookupRegistryV1`)).data,{handle:i}=n.registry,s={key_type:"address",value_type:`${this.contractAddress}::domains::NameRecordKeyV1`,key:t};try{const o=await this.provider.getTableItem(i,s);return o.subdomain_name.vec[0]?`${o.subdomain_name.vec[0]}.${o.domain_name}`:o.domain_name}catch(o){if(o.status===404)return null;throw new Error(o)}}async getAddressByName(t){var e,n;const{domain:i,subdomain:s}=(n=(e=t.match(w0))==null?void 0:e.groups)!=null?n:{};if(!i)return null;const o=s?await this.getRegistrationForSubdomainName(i,s):await this.getRegistrationForDomainName(i);return o===null?null:o.target}async mintAptosName(t,e,n=1,i){if(e.match(Ji)===null)throw new si(400,`Name ${e} is not valid`);const s=await this.getRegistrationForDomainName(e);if(s&&Math.ceil(Date.now()/1e3)<s.expirationTimestampSeconds)throw new si(400,`Name ${e} is not available`);const r=await new hn(this.provider.aptosClient,{sender:t.address(),...i}).build(`${this.contractAddress}::domains::register_domain`,[],[e,n]),a=Ce.generateBCSTransaction(t,r);return(await this.provider.submitSignedBCSTransaction(a)).hash}async mintAptosSubdomain(t,e,n,i,s){if(n.match(Ji)===null)throw new si(400,`Domain name ${n} is not valid`);if(e.match(Ji)===null)throw new si(400,`Subdomain name ${e} is not valid`);const o=await this.getRegistrationForSubdomainName(n,e);if(o&&Math.ceil(Date.now()/1e3)<o.expirationTimestampSeconds)throw new si(400,`Name ${e}.${n} is not available`);const r=await this.getRegistrationForDomainName(n);if(r===null)throw new si(400,`Domain name ${n} does not exist`);const a=Math.ceil(Date.now()/1e3);if(r.expirationTimestampSeconds<a)throw new si(400,`Domain name ${n} expired`);const c=i||r.expirationTimestampSeconds;if(c<a)throw new si(400,`Expiration for ${e}.${n} is before now`);const l=await new hn(this.provider.aptosClient,{sender:t.address(),...s}).build(`${this.contractAddress}::domains::register_subdomain`,[],[e,n,c]),d=Ce.generateBCSTransaction(t,l);return(await this.provider.submitSignedBCSTransaction(d)).hash}async setSubdomainAddress(t,e,n,i,s){const o=en.standardizeAddress(i);if(n.match(Ji)===null)throw new si(400,`Name ${n} is not valid`);if(e.match(Ji)===null)throw new si(400,`Name ${e} is not valid`);const a=await new hn(this.provider.aptosClient,{sender:t.address(),...s}).build(`${this.contractAddress}::domains::set_subdomain_address`,[],[e,n,o]),c=Ce.generateBCSTransaction(t,a);return(await this.provider.submitSignedBCSTransaction(c)).hash}async initReverseLookupRegistry(t,e){const i=await new hn(this.provider.aptosClient,{sender:t.address(),...e}).build(`${this.contractAddress}::domains::init_reverse_lookup_registry_v1`,[],[]),s=Ce.generateBCSTransaction(t,i);return(await this.provider.submitSignedBCSTransaction(s)).hash}async getRegistrationForDomainName(t){if(t.match(Ji)===null)return null;const n=(await this.provider.getAccountResource(this.contractAddress,`${this.contractAddress}::domains::NameRegistryV1`)).data,{handle:i}=n.registry,s={key_type:`${this.contractAddress}::domains::NameRecordKeyV1`,value_type:`${this.contractAddress}::domains::NameRecordV1`,key:{subdomain_name:{vec:[]},domain_name:t}};try{const o=await this.provider.getTableItem(i,s);return{target:o.target_address.vec.length===1?o.target_address.vec[0]:null,expirationTimestampSeconds:o.expiration_time_sec}}catch(o){if(o.status===404)return null;throw new Error(o)}}async getRegistrationForSubdomainName(t,e){if(t.match(Ji)===null||e.match(Ji)===null)return null;const i=(await this.provider.getAccountResource(this.contractAddress,`${this.contractAddress}::domains::NameRegistryV1`)).data,{handle:s}=i.registry,o={key_type:`${this.contractAddress}::domains::NameRecordKeyV1`,value_type:`${this.contractAddress}::domains::NameRecordV1`,key:{subdomain_name:{vec:[e]},domain_name:t}};try{const r=await this.provider.getTableItem(s,o);return{target:r.target_address.vec.length===1?r.target_address.vec[0]:null,expirationTimestampSeconds:r.expiration_time_sec}}catch(r){if(r.status===404)return null;throw new Error(r)}}},pa=()=>Math.floor(Date.now()/1e3),b0=class{constructor(t,e,n,i,s){this.lastUncommintedNumber=null,this.currentNumber=null,this.lock=!1,this.provider=t,this.account=e,this.maxWaitTime=n,this.maximumInFlight=i,this.sleepTime=s}async nextSequenceNumber(){for(;this.lock;)await vr(this.sleepTime);this.lock=!0;let t=BigInt(0);try{if((this.lastUncommintedNumber===null||this.currentNumber===null)&&await this.initialize(),this.currentNumber-this.lastUncommintedNumber>=this.maximumInFlight){await this.update();const e=pa();for(;this.currentNumber-this.lastUncommintedNumber>=this.maximumInFlight;)await vr(this.sleepTime),pa()-e>this.maxWaitTime?(console.warn(`Waited over 30 seconds for a transaction to commit, resyncing ${this.account.address()}`),await this.initialize()):await this.update()}t=this.currentNumber,this.currentNumber+=BigInt(1)}catch(e){console.error("error in getting next sequence number for this account",e)}finally{this.lock=!1}return t}async initialize(){const{sequence_number:t}=await this.provider.getAccount(this.account.address());this.currentNumber=BigInt(t),this.lastUncommintedNumber=BigInt(t)}async update(){const{sequence_number:t}=await this.provider.getAccount(this.account.address());return this.lastUncommintedNumber=BigInt(t),this.lastUncommintedNumber}async synchronize(){if(this.lastUncommintedNumber!==this.currentNumber){for(;this.lock;)await vr(this.sleepTime);this.lock=!0;try{await this.update();const t=pa();for(;this.lastUncommintedNumber!==this.currentNumber;)pa()-t>this.maxWaitTime?(console.warn(`Waited over 30 seconds for a transaction to commit, resyncing ${this.account.address()}`),await this.initialize()):(await vr(this.sleepTime),await this.update())}catch(t){console.error("error in synchronizing this account sequence number with the one on chain",t)}finally{this.lock=!1}}}},Mu=class{constructor(){this.queue=[],this.resolveMap=new Map,this.counter=0,this.cancelled=!1}enqueue(t){if(this.resolveMap.size>0){const e=this.resolveMap.get(0);if(e){this.resolveMap.delete(0),e(t);return}}this.queue.push(t)}async dequeue(){return this.queue.length>0?Promise.resolve(this.queue.shift()):new Promise(e=>{this.counter+=1,this.resolveMap.set(this.counter,e)})}isEmpty(){return this.queue.length===0}cancel(){this.cancelled=!0,this.resolveMap.forEach(async t=>{t(await Promise.reject(new ll("Task cancelled")))}),this.resolveMap.clear(),this.queue.length=0}isCancelled(){return this.cancelled}},ll=class extends Error{constructor(t){super(t)}},eh="fulfilled",v0=(t=>(t.TransactionSent="transactionSent",t.TransactionSendFailed="transactionsendFailed",t.TransactionExecuted="transactionExecuted",t.TransactionExecutionFailed="transactionexecutionFailed",t))(v0||{}),Tb=class extends il{constructor(t,e,n=30,i=100,s=10){super(),this.taskQueue=new Mu,this.transactionsQueue=new Mu,this.outstandingTransactions=new Mu,this.sentTransactions=[],this.executedTransactions=[],this.provider=t,this.account=e,this.started=!1,this.accountSequnceNumber=new b0(t,e,n,i,s)}async submitNextTransaction(){try{for(;;){if(this.transactionsQueue.isEmpty())return;const t=await this.accountSequnceNumber.nextSequenceNumber();if(t===null)return;const e=await this.generateNextTransaction(this.account,t);if(!e)return;const n=this.provider.submitSignedBCSTransaction(e);await this.outstandingTransactions.enqueue([n,t])}}catch(t){if(t instanceof ll)return;console.log(t)}}async processTransactions(){try{for(;;){const t=[],e=[];let[n,i]=await this.outstandingTransactions.dequeue();for(t.push(n),e.push(i);!this.outstandingTransactions.isEmpty();)[n,i]=await this.outstandingTransactions.dequeue(),t.push(n),e.push(i);const s=await Promise.allSettled(t);for(let o=0;o<s.length&&o<e.length;o+=1){const r=s[o];i=e[o],r.status===eh?(this.sentTransactions.push([r.value.hash,i,null]),this.emit("transactionSent",[this.sentTransactions.length,r.value.hash]),await this.checkTransaction(r,i)):(this.sentTransactions.push([r.status,i,r.reason]),this.emit("transactionsendFailed",[this.sentTransactions.length,r.reason]))}}}catch(t){if(t instanceof ll)return;console.log(t)}}async checkTransaction(t,e){const n=[];n.push(this.provider.waitForTransactionWithResult(t.value.hash,{checkSuccess:!0}));const i=await Promise.allSettled(n);for(let s=0;s<i.length;s+=1){const o=i[s];o.status===eh?(this.executedTransactions.push([o.value.hash,e,null]),this.emit("transactionExecuted",[this.executedTransactions.length,o.value.hash])):(this.executedTransactions.push([o.status,e,o.reason]),this.emit("transactionexecutionFailed",[this.executedTransactions.length,o.reason]))}}async push(t){await this.transactionsQueue.enqueue(t)}async generateNextTransaction(t,e){if(this.transactionsQueue.isEmpty())return;const n=await this.transactionsQueue.dequeue(),i=await this.provider.generateRawTransaction(t.address(),n,{providedSequenceNumber:e});return Ce.generateBCSTransaction(t,i)}async run(){try{for(;!this.taskQueue.isCancelled();)await(await this.taskQueue.dequeue())()}catch(t){throw new Error(t)}}start(){if(this.started)throw new Error("worker has already started");this.started=!0,this.taskQueue.enqueue(()=>this.submitNextTransaction()),this.taskQueue.enqueue(()=>this.processTransactions()),this.run()}stop(){if(this.taskQueue.isCancelled())throw new Error("worker has already stopped");this.started=!1,this.taskQueue.cancel()}},x0={};mc(x0,{AptosErrorCode:()=>T0,MoveFunctionVisibility:()=>A0,RoleType:()=>k0});var T0=(t=>(t.ACCOUNT_NOT_FOUND="account_not_found",t.RESOURCE_NOT_FOUND="resource_not_found",t.MODULE_NOT_FOUND="module_not_found",t.STRUCT_FIELD_NOT_FOUND="struct_field_not_found",t.VERSION_NOT_FOUND="version_not_found",t.TRANSACTION_NOT_FOUND="transaction_not_found",t.TABLE_ITEM_NOT_FOUND="table_item_not_found",t.BLOCK_NOT_FOUND="block_not_found",t.STATE_VALUE_NOT_FOUND="state_value_not_found",t.VERSION_PRUNED="version_pruned",t.BLOCK_PRUNED="block_pruned",t.INVALID_INPUT="invalid_input",t.INVALID_TRANSACTION_UPDATE="invalid_transaction_update",t.SEQUENCE_NUMBER_TOO_OLD="sequence_number_too_old",t.VM_ERROR="vm_error",t.HEALTH_CHECK_FAILED="health_check_failed",t.MEMPOOL_IS_FULL="mempool_is_full",t.INTERNAL_ERROR="internal_error",t.WEB_FRAMEWORK_ERROR="web_framework_error",t.BCS_NOT_SUPPORTED="bcs_not_supported",t.API_DISABLED="api_disabled",t))(T0||{}),A0=(t=>(t.PRIVATE="private",t.PUBLIC="public",t.FRIEND="friend",t))(A0||{}),k0=(t=>(t.VALIDATOR="validator",t.FULL_NODE="full_node",t))(k0||{}),S0=(t=>(t.AccountAddress="account_address",t.TransactionVersion="transaction_version",t))(S0||{}),P0=(t=>(t.AccountAddress="account_address",t.MinBlockHeight="min_block_height",t.NumDistinctVersions="num_distinct_versions",t))(P0||{}),B0=(t=>(t.AccountAddress="account_address",t.TransactionVersion="transaction_version",t))(B0||{}),E0=(t=>(t.Address="address",t.TransactionVersion="transaction_version",t))(E0||{}),C0=(t=>(t.BlockHeight="block_height",t.Epoch="epoch",t.FailedProposerIndices="failed_proposer_indices",t.Id="id",t.PreviousBlockVotesBitvec="previous_block_votes_bitvec",t.Proposer="proposer",t.Round="round",t.Timestamp="timestamp",t.Version="version",t))(C0||{}),I0=(t=>(t.ActivityType="activity_type",t.Amount="amount",t.BlockHeight="block_height",t.CoinType="coin_type",t.EntryFunctionIdStr="entry_function_id_str",t.EventAccountAddress="event_account_address",t.EventCreationNumber="event_creation_number",t.EventIndex="event_index",t.EventSequenceNumber="event_sequence_number",t.IsGasFee="is_gas_fee",t.IsTransactionSuccess="is_transaction_success",t.OwnerAddress="owner_address",t.TransactionTimestamp="transaction_timestamp",t.TransactionVersion="transaction_version",t))(I0||{}),O0=(t=>(t.Amount="amount",t.CoinType="coin_type",t.CoinTypeHash="coin_type_hash",t.OwnerAddress="owner_address",t.TransactionTimestamp="transaction_timestamp",t.TransactionVersion="transaction_version",t))(O0||{}),R0=(t=>(t.CoinType="coin_type",t.CoinTypeHash="coin_type_hash",t.CreatorAddress="creator_address",t.Decimals="decimals",t.Name="name",t.SupplyAggregatorTableHandle="supply_aggregator_table_handle",t.SupplyAggregatorTableKey="supply_aggregator_table_key",t.Symbol="symbol",t.TransactionCreatedTimestamp="transaction_created_timestamp",t.TransactionVersionCreated="transaction_version_created",t))(R0||{}),U0=(t=>(t.CoinType="coin_type",t.CoinTypeHash="coin_type_hash",t.Supply="supply",t.TransactionEpoch="transaction_epoch",t.TransactionTimestamp="transaction_timestamp",t.TransactionVersion="transaction_version",t))(U0||{}),$0=(t=>(t.CollectionDataIdHash="collection_data_id_hash",t.CollectionName="collection_name",t.CreatorAddress="creator_address",t.Description="description",t.DescriptionMutable="description_mutable",t.Maximum="maximum",t.MaximumMutable="maximum_mutable",t.MetadataUri="metadata_uri",t.Supply="supply",t.TableHandle="table_handle",t.TransactionTimestamp="transaction_timestamp",t.TransactionVersion="transaction_version",t.UriMutable="uri_mutable",t))($0||{}),q0=(t=>(t.Domain="domain",t.ExpirationTimestamp="expiration_timestamp",t.IsDeleted="is_deleted",t.LastTransactionVersion="last_transaction_version",t.RegisteredAddress="registered_address",t.Subdomain="subdomain",t.TokenName="token_name",t))(q0||{}),M0=(t=>(t.Domain="domain",t.ExpirationTimestamp="expiration_timestamp",t.IsPrimary="is_primary",t.LastTransactionVersion="last_transaction_version",t.RegisteredAddress="registered_address",t.Subdomain="subdomain",t.TokenName="token_name",t))(M0||{}),D0=(t=>(t.Amount="amount",t.CoinType="coin_type",t.CoinTypeHash="coin_type_hash",t.LastTransactionTimestamp="last_transaction_timestamp",t.LastTransactionVersion="last_transaction_version",t.OwnerAddress="owner_address",t))(D0||{}),L0=(t=>(t.CollectionDataIdHash="collection_data_id_hash",t.CollectionName="collection_name",t.CreatorAddress="creator_address",t.Description="description",t.DescriptionMutable="description_mutable",t.LastTransactionTimestamp="last_transaction_timestamp",t.LastTransactionVersion="last_transaction_version",t.Maximum="maximum",t.MaximumMutable="maximum_mutable",t.MetadataUri="metadata_uri",t.Supply="supply",t.TableHandle="table_handle",t.UriMutable="uri_mutable",t))(L0||{}),N0=(t=>(t.CollectionId="collection_id",t.CollectionName="collection_name",t.CollectionUri="collection_uri",t.CreatorAddress="creator_address",t.DistinctTokens="distinct_tokens",t.LastTransactionVersion="last_transaction_version",t.OwnerAddress="owner_address",t.SingleTokenUri="single_token_uri",t))(N0||{}),F0=(t=>(t.CollectionId="collection_id",t.CollectionName="collection_name",t.CreatorAddress="creator_address",t.CurrentSupply="current_supply",t.Description="description",t.LastTransactionTimestamp="last_transaction_timestamp",t.LastTransactionVersion="last_transaction_version",t.MaxSupply="max_supply",t.MutableDescription="mutable_description",t.MutableUri="mutable_uri",t.TableHandleV1="table_handle_v1",t.TokenStandard="token_standard",t.TotalMintedV2="total_minted_v2",t.Uri="uri",t))(F0||{}),j0=(t=>(t.ActiveTableHandle="active_table_handle",t.InactiveTableHandle="inactive_table_handle",t.LastTransactionVersion="last_transaction_version",t.OperatorCommissionPercentage="operator_commission_percentage",t.StakingPoolAddress="staking_pool_address",t.TotalCoins="total_coins",t.TotalShares="total_shares",t))(j0||{}),z0=(t=>(t.DelegationPoolAddress="delegation_pool_address",t.DelegatorAddress="delegator_address",t.LastTransactionTimestamp="last_transaction_timestamp",t.LastTransactionVersion="last_transaction_version",t.PendingVoter="pending_voter",t.TableHandle="table_handle",t.Voter="voter",t))(z0||{}),H0=(t=>(t.DelegatorAddress="delegator_address",t.LastTransactionVersion="last_transaction_version",t.ParentTableHandle="parent_table_handle",t.PoolAddress="pool_address",t.PoolType="pool_type",t.Shares="shares",t.TableHandle="table_handle",t))(H0||{}),K0=(t=>(t.Amount="amount",t.AssetType="asset_type",t.IsFrozen="is_frozen",t.IsPrimary="is_primary",t.LastTransactionTimestamp="last_transaction_timestamp",t.LastTransactionVersion="last_transaction_version",t.OwnerAddress="owner_address",t.StorageId="storage_id",t.TokenStandard="token_standard",t))(K0||{}),G0=(t=>(t.AllowUngatedTransfer="allow_ungated_transfer",t.IsDeleted="is_deleted",t.LastGuidCreationNum="last_guid_creation_num",t.LastTransactionVersion="last_transaction_version",t.ObjectAddress="object_address",t.OwnerAddress="owner_address",t.StateKeyHash="state_key_hash",t))(G0||{}),W0=(t=>(t.LastTransactionVersion="last_transaction_version",t.OperatorAddress="operator_address",t.StakingPoolAddress="staking_pool_address",t.VoterAddress="voter_address",t))(W0||{}),X0=(t=>(t.DecodedKey="decoded_key",t.DecodedValue="decoded_value",t.IsDeleted="is_deleted",t.Key="key",t.KeyHash="key_hash",t.LastTransactionVersion="last_transaction_version",t.TableHandle="table_handle",t))(X0||{}),V0=(t=>(t.CollectionDataIdHash="collection_data_id_hash",t.CollectionName="collection_name",t.CreatorAddress="creator_address",t.DefaultProperties="default_properties",t.Description="description",t.DescriptionMutable="description_mutable",t.LargestPropertyVersion="largest_property_version",t.LastTransactionTimestamp="last_transaction_timestamp",t.LastTransactionVersion="last_transaction_version",t.Maximum="maximum",t.MaximumMutable="maximum_mutable",t.MetadataUri="metadata_uri",t.Name="name",t.PayeeAddress="payee_address",t.PropertiesMutable="properties_mutable",t.RoyaltyMutable="royalty_mutable",t.RoyaltyPointsDenominator="royalty_points_denominator",t.RoyaltyPointsNumerator="royalty_points_numerator",t.Supply="supply",t.TokenDataIdHash="token_data_id_hash",t.UriMutable="uri_mutable",t))(V0||{}),J0=(t=>(t.CollectionId="collection_id",t.Description="description",t.IsFungibleV2="is_fungible_v2",t.LargestPropertyVersionV1="largest_property_version_v1",t.LastTransactionTimestamp="last_transaction_timestamp",t.LastTransactionVersion="last_transaction_version",t.Maximum="maximum",t.Supply="supply",t.TokenDataId="token_data_id",t.TokenName="token_name",t.TokenProperties="token_properties",t.TokenStandard="token_standard",t.TokenUri="token_uri",t))(J0||{}),Z0=(t=>(t.Amount="amount",t.CollectionDataIdHash="collection_data_id_hash",t.CollectionName="collection_name",t.CreatorAddress="creator_address",t.LastTransactionTimestamp="last_transaction_timestamp",t.LastTransactionVersion="last_transaction_version",t.Name="name",t.OwnerAddress="owner_address",t.PropertyVersion="property_version",t.TableType="table_type",t.TokenDataIdHash="token_data_id_hash",t.TokenProperties="token_properties",t))(Z0||{}),Y0=(t=>(t.Amount="amount",t.IsFungibleV2="is_fungible_v2",t.IsSoulboundV2="is_soulbound_v2",t.LastTransactionTimestamp="last_transaction_timestamp",t.LastTransactionVersion="last_transaction_version",t.OwnerAddress="owner_address",t.PropertyVersionV1="property_version_v1",t.StorageId="storage_id",t.TableTypeV1="table_type_v1",t.TokenDataId="token_data_id",t.TokenPropertiesMutatedV1="token_properties_mutated_v1",t.TokenStandard="token_standard",t))(Y0||{}),Q0=(t=>(t.Amount="amount",t.CollectionDataIdHash="collection_data_id_hash",t.CollectionId="collection_id",t.CollectionName="collection_name",t.CreatorAddress="creator_address",t.FromAddress="from_address",t.LastTransactionTimestamp="last_transaction_timestamp",t.LastTransactionVersion="last_transaction_version",t.Name="name",t.PropertyVersion="property_version",t.TableHandle="table_handle",t.ToAddress="to_address",t.TokenDataId="token_data_id",t.TokenDataIdHash="token_data_id_hash",t))(Q0||{}),tp=(t=>(t.Asc="ASC",t.Desc="DESC",t))(tp||{}),ep=(t=>(t.Amount="amount",t.DelegatorAddress="delegator_address",t.EventIndex="event_index",t.EventType="event_type",t.PoolAddress="pool_address",t.TransactionVersion="transaction_version",t))(ep||{}),np=(t=>(t.FirstTransactionVersion="first_transaction_version",t.StakingPoolAddress="staking_pool_address",t))(np||{}),ip=(t=>(t.DelegatorAddress="delegator_address",t.PoolAddress="pool_address",t))(ip||{}),sp=(t=>(t.AccountAddress="account_address",t.CreationNumber="creation_number",t.Data="data",t.EventIndex="event_index",t.SequenceNumber="sequence_number",t.TransactionBlockHeight="transaction_block_height",t.TransactionVersion="transaction_version",t.Type="type",t))(sp||{}),op=(t=>(t.Amount="amount",t.AssetType="asset_type",t.BlockHeight="block_height",t.EntryFunctionIdStr="entry_function_id_str",t.EventIndex="event_index",t.GasFeePayerAddress="gas_fee_payer_address",t.IsFrozen="is_frozen",t.IsGasFee="is_gas_fee",t.IsTransactionSuccess="is_transaction_success",t.OwnerAddress="owner_address",t.StorageId="storage_id",t.TokenStandard="token_standard",t.TransactionTimestamp="transaction_timestamp",t.TransactionVersion="transaction_version",t.Type="type",t))(op||{}),rp=(t=>(t.AssetType="asset_type",t.CreatorAddress="creator_address",t.Decimals="decimals",t.IconUri="icon_uri",t.LastTransactionTimestamp="last_transaction_timestamp",t.LastTransactionVersion="last_transaction_version",t.Name="name",t.ProjectUri="project_uri",t.SupplyAggregatorTableHandleV1="supply_aggregator_table_handle_v1",t.SupplyAggregatorTableKeyV1="supply_aggregator_table_key_v1",t.Symbol="symbol",t.TokenStandard="token_standard",t))(rp||{}),ap=(t=>(t.Db="db",t.IsIndexerUp="is_indexer_up",t))(ap||{}),cp=(t=>(t.ChainId="chain_id",t))(cp||{}),up=(t=>(t.Address="address",t.TransactionVersion="transaction_version",t))(up||{}),lp=(t=>(t.BuyItNowPrice="buy_it_now_price",t.CoinType="coin_type",t.CollectionId="collection_id",t.ContractAddress="contract_address",t.CurrentBidPrice="current_bid_price",t.CurrentBidder="current_bidder",t.EntryFunctionIdStr="entry_function_id_str",t.ExpirationTime="expiration_time",t.FeeScheduleId="fee_schedule_id",t.IsDeleted="is_deleted",t.LastTransactionTimestamp="last_transaction_timestamp",t.LastTransactionVersion="last_transaction_version",t.ListingId="listing_id",t.Marketplace="marketplace",t.Seller="seller",t.StartingBidPrice="starting_bid_price",t.TokenAmount="token_amount",t.TokenDataId="token_data_id",t.TokenStandard="token_standard",t))(lp||{}),dp=(t=>(t.Buyer="buyer",t.CoinType="coin_type",t.CollectionId="collection_id",t.CollectionOfferId="collection_offer_id",t.ContractAddress="contract_address",t.EntryFunctionIdStr="entry_function_id_str",t.ExpirationTime="expiration_time",t.FeeScheduleId="fee_schedule_id",t.IsDeleted="is_deleted",t.ItemPrice="item_price",t.LastTransactionTimestamp="last_transaction_timestamp",t.LastTransactionVersion="last_transaction_version",t.Marketplace="marketplace",t.RemainingTokenAmount="remaining_token_amount",t.TokenStandard="token_standard",t))(dp||{}),hp=(t=>(t.CoinType="coin_type",t.CollectionId="collection_id",t.ContractAddress="contract_address",t.EntryFunctionIdStr="entry_function_id_str",t.FeeScheduleId="fee_schedule_id",t.IsDeleted="is_deleted",t.LastTransactionTimestamp="last_transaction_timestamp",t.LastTransactionVersion="last_transaction_version",t.ListingId="listing_id",t.Marketplace="marketplace",t.Price="price",t.Seller="seller",t.TokenAmount="token_amount",t.TokenDataId="token_data_id",t.TokenStandard="token_standard",t))(hp||{}),fp=(t=>(t.Buyer="buyer",t.CoinType="coin_type",t.CollectionId="collection_id",t.ContractAddress="contract_address",t.EntryFunctionIdStr="entry_function_id_str",t.ExpirationTime="expiration_time",t.FeeScheduleId="fee_schedule_id",t.IsDeleted="is_deleted",t.LastTransactionTimestamp="last_transaction_timestamp",t.LastTransactionVersion="last_transaction_version",t.Marketplace="marketplace",t.OfferId="offer_id",t.Price="price",t.TokenAmount="token_amount",t.TokenDataId="token_data_id",t.TokenStandard="token_standard",t))(fp||{}),pp=(t=>(t.Buyer="buyer",t.CoinType="coin_type",t.CollectionId="collection_id",t.CollectionName="collection_name",t.ContractAddress="contract_address",t.CreatorAddress="creator_address",t.EntryFunctionIdStr="entry_function_id_str",t.EventIndex="event_index",t.EventType="event_type",t.FeeScheduleId="fee_schedule_id",t.Marketplace="marketplace",t.OfferOrListingId="offer_or_listing_id",t.Price="price",t.PropertyVersion="property_version",t.Seller="seller",t.TokenAmount="token_amount",t.TokenDataId="token_data_id",t.TokenName="token_name",t.TokenStandard="token_standard",t.TransactionTimestamp="transaction_timestamp",t.TransactionVersion="transaction_version",t))(pp||{}),gp=(t=>(t.AssetUri="asset_uri",t.CdnAnimationUri="cdn_animation_uri",t.CdnImageUri="cdn_image_uri",t.CdnJsonUri="cdn_json_uri",t.RawAnimationUri="raw_animation_uri",t.RawImageUri="raw_image_uri",t))(gp||{}),_p=(t=>(t.NumActiveDelegator="num_active_delegator",t.PoolAddress="pool_address",t))(_p||{}),mp=(t=>(t.Asc="asc",t.AscNullsFirst="asc_nulls_first",t.AscNullsLast="asc_nulls_last",t.Desc="desc",t.DescNullsFirst="desc_nulls_first",t.DescNullsLast="desc_nulls_last",t))(mp||{}),yp=(t=>(t.LastSuccessVersion="last_success_version",t.LastUpdated="last_updated",t.Processor="processor",t))(yp||{}),wp=(t=>(t.NumVotes="num_votes",t.ProposalId="proposal_id",t.ShouldPass="should_pass",t.StakingPoolAddress="staking_pool_address",t.TransactionTimestamp="transaction_timestamp",t.TransactionVersion="transaction_version",t.VoterAddress="voter_address",t))(wp||{}),bp=(t=>(t.DecodedKey="decoded_key",t.DecodedValue="decoded_value",t.Key="key",t.TableHandle="table_handle",t.TransactionVersion="transaction_version",t.WriteSetChangeIndex="write_set_change_index",t))(bp||{}),vp=(t=>(t.Handle="handle",t.KeyType="key_type",t.ValueType="value_type",t))(vp||{}),xp=(t=>(t.CoinAmount="coin_amount",t.CoinType="coin_type",t.CollectionDataIdHash="collection_data_id_hash",t.CollectionName="collection_name",t.CreatorAddress="creator_address",t.EventAccountAddress="event_account_address",t.EventCreationNumber="event_creation_number",t.EventIndex="event_index",t.EventSequenceNumber="event_sequence_number",t.FromAddress="from_address",t.Name="name",t.PropertyVersion="property_version",t.ToAddress="to_address",t.TokenAmount="token_amount",t.TokenDataIdHash="token_data_id_hash",t.TransactionTimestamp="transaction_timestamp",t.TransactionVersion="transaction_version",t.TransferType="transfer_type",t))(xp||{}),Tp=(t=>(t.AfterValue="after_value",t.BeforeValue="before_value",t.EntryFunctionIdStr="entry_function_id_str",t.EventAccountAddress="event_account_address",t.EventIndex="event_index",t.FromAddress="from_address",t.IsFungibleV2="is_fungible_v2",t.PropertyVersionV1="property_version_v1",t.ToAddress="to_address",t.TokenAmount="token_amount",t.TokenDataId="token_data_id",t.TokenStandard="token_standard",t.TransactionTimestamp="transaction_timestamp",t.TransactionVersion="transaction_version",t.Type="type",t))(Tp||{}),Ap=(t=>(t.CollectionDataIdHash="collection_data_id_hash",t.CollectionName="collection_name",t.CreatorAddress="creator_address",t.DefaultProperties="default_properties",t.Description="description",t.DescriptionMutable="description_mutable",t.LargestPropertyVersion="largest_property_version",t.Maximum="maximum",t.MaximumMutable="maximum_mutable",t.MetadataUri="metadata_uri",t.Name="name",t.PayeeAddress="payee_address",t.PropertiesMutable="properties_mutable",t.RoyaltyMutable="royalty_mutable",t.RoyaltyPointsDenominator="royalty_points_denominator",t.RoyaltyPointsNumerator="royalty_points_numerator",t.Supply="supply",t.TokenDataIdHash="token_data_id_hash",t.TransactionTimestamp="transaction_timestamp",t.TransactionVersion="transaction_version",t.UriMutable="uri_mutable",t))(Ap||{}),kp=(t=>(t.Amount="amount",t.CollectionDataIdHash="collection_data_id_hash",t.CollectionName="collection_name",t.CreatorAddress="creator_address",t.Name="name",t.OwnerAddress="owner_address",t.PropertyVersion="property_version",t.TableHandle="table_handle",t.TableType="table_type",t.TokenDataIdHash="token_data_id_hash",t.TransactionTimestamp="transaction_timestamp",t.TransactionVersion="transaction_version",t))(kp||{}),Sp=(t=>(t.CollectionDataIdHash="collection_data_id_hash",t.CollectionName="collection_name",t.CreatorAddress="creator_address",t.Name="name",t.PropertyVersion="property_version",t.TokenDataIdHash="token_data_id_hash",t.TokenProperties="token_properties",t.TransactionTimestamp="transaction_timestamp",t.TransactionVersion="transaction_version",t))(Sp||{}),Pp=(t=>(t.BlockHeight="block_height",t.EntryFunctionIdStr="entry_function_id_str",t.Epoch="epoch",t.ExpirationTimestampSecs="expiration_timestamp_secs",t.GasUnitPrice="gas_unit_price",t.MaxGasAmount="max_gas_amount",t.ParentSignatureType="parent_signature_type",t.Sender="sender",t.SequenceNumber="sequence_number",t.Timestamp="timestamp",t.Version="version",t))(Pp||{});const QS=Object.freeze(Object.defineProperty({__proto__:null,APTOS_COIN:Ka,AccountSequenceNumber:b0,Account_Transactions_Select_Column:S0,Address_Events_Summary_Select_Column:P0,Address_Version_From_Events_Select_Column:B0,Address_Version_From_Move_Resources_Select_Column:E0,AnsClient:xb,ApiError:si,AptosAccount:Ur,AptosApiError:Dl,AptosClient:Ce,AptosToken:wb,BCS:n0,Block_Metadata_Transactions_Select_Column:C0,CKDPriv:Wf,COIN_TRANSFER:y0,CoinClient:bb,Coin_Activities_Select_Column:I0,Coin_Balances_Select_Column:O0,Coin_Infos_Select_Column:R0,Coin_Supply_Select_Column:U0,Collection_Datas_Select_Column:$0,Current_Ans_Lookup_Select_Column:q0,Current_Aptos_Names_Select_Column:M0,Current_Coin_Balances_Select_Column:D0,Current_Collection_Datas_Select_Column:L0,Current_Collection_Ownership_V2_View_Select_Column:N0,Current_Collections_V2_Select_Column:F0,Current_Delegated_Staking_Pool_Balances_Select_Column:j0,Current_Delegated_Voter_Select_Column:z0,Current_Delegator_Balances_Select_Column:H0,Current_Fungible_Asset_Balances_Select_Column:K0,Current_Objects_Select_Column:G0,Current_Staking_Pool_Voter_Select_Column:W0,Current_Table_Items_Select_Column:X0,Current_Token_Datas_Select_Column:V0,Current_Token_Datas_V2_Select_Column:J0,Current_Token_Ownerships_Select_Column:Z0,Current_Token_Ownerships_V2_Select_Column:Y0,Current_Token_Pending_Claims_Select_Column:Q0,Cursor_Ordering:tp,Delegated_Staking_Activities_Select_Column:ep,Delegated_Staking_Pools_Select_Column:np,Delegator_Distinct_Pool_Select_Column:ip,Events_Select_Column:sp,FailedTransactionError:h0,FaucetClient:vb,FungibleAssetClient:Va,Fungible_Asset_Activities_Select_Column:op,Fungible_Asset_Metadata_Select_Column:rp,HexString:Ot,IndexerClient:mn,Indexer_Status_Select_Column:ap,Ledger_Infos_Select_Column:cp,Move_Resources_Select_Column:up,Network:e0,NetworkToIndexerAPI:Ga,NetworkToNodeAPI:t0,Nft_Marketplace_V2_Current_Nft_Marketplace_Auctions_Select_Column:lp,Nft_Marketplace_V2_Current_Nft_Marketplace_Collection_Offers_Select_Column:dp,Nft_Marketplace_V2_Current_Nft_Marketplace_Listings_Select_Column:hp,Nft_Marketplace_V2_Current_Nft_Marketplace_Token_Offers_Select_Column:fp,Nft_Marketplace_V2_Nft_Marketplace_Activities_Select_Column:pp,Nft_Metadata_Crawler_Parsed_Asset_Uris_Select_Column:gp,NodeAPIToNetwork:sl,Num_Active_Delegator_Per_Pool_Select_Column:_p,Order_By:mp,Processor_Status_Select_Column:yp,PropertyMap:Fc,PropertyValue:td,Proposal_Votes_Select_Column:wp,Provider:$r,TRANSFER_COINS:cl,Table_Items_Select_Column:bp,Table_Metadatas_Select_Column:vp,TokenClient:yb,TokenTypes:g0,Token_Activities_Select_Column:xp,Token_Activities_V2_Select_Column:Tp,Token_Datas_Select_Column:Ap,Token_Ownerships_Select_Column:kp,Tokens_Select_Column:Sp,TransactionBuilder:Oi,TransactionBuilderABI:Wa,TransactionBuilderEd25519:Ra,TransactionBuilderMultiEd25519:l0,TransactionBuilderRemoteABI:hn,TransactionWorker:Tb,TransactionWorkerEvents:v0,TxnBuilderTypes:oe,TypeTagParser:oo,Types:x0,User_Transactions_Select_Column:Pp,WaitForTransactionError:d0,ansContractsMap:ul,aptosRequest:Ll,argToTransactionArgument:u0,derivePath:Vf,deserializePropertyMap:ed,deserializeValueBasedOnTypeTag:p0,ensureBigInt:zs,ensureBoolean:Yl,ensureNumber:js,get:Qn,getAddressFromAccountOrAddress:Ii,getMasterKeyFromSeed:Gf,getPropertyType:jc,getPropertyValueRaw:Xa,getPublicKey:mw,getSinglePropertyValueRaw:al,isValidPath:Xf,nameComponentPattern:Ji,namePattern:w0,post:Ms,serializeArg:Nc},Symbol.toStringTag,{value:"Module"}));var hi={},Un={};Object.defineProperty(Un,"__esModule",{value:!0});Un.output=Un.exists=Un.hash=Un.bytes=Un.bool=Un.number=void 0;function Ja(t){if(!Number.isSafeInteger(t)||t<0)throw new Error(`Wrong positive integer: ${t}`)}Un.number=Ja;function Bp(t){if(typeof t!="boolean")throw new Error(`Expected boolean, not ${t}`)}Un.bool=Bp;function nd(t,...e){if(!(t instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(e.length>0&&!e.includes(t.length))throw new TypeError(`Expected Uint8Array of length ${e}, not of length=${t.length}`)}Un.bytes=nd;function Ep(t){if(typeof t!="function"||typeof t.create!="function")throw new Error("Hash should be wrapped by utils.wrapConstructor");Ja(t.outputLen),Ja(t.blockLen)}Un.hash=Ep;function Cp(t,e=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(e&&t.finished)throw new Error("Hash#digest() has already been called")}Un.exists=Cp;function Ip(t,e){nd(t);const n=e.outputLen;if(t.length<n)throw new Error(`digestInto() expects output buffer of length at least ${n}`)}Un.output=Ip;const Ab={number:Ja,bool:Bp,bytes:nd,hash:Ep,exists:Cp,output:Ip};Un.default=Ab;var Go={},Op={},ao={},zc={};Object.defineProperty(zc,"__esModule",{value:!0});zc.crypto=void 0;zc.crypto={node:void 0,web:typeof self=="object"&&"crypto"in self?self.crypto:void 0};(function(t){/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */Object.defineProperty(t,"__esModule",{value:!0}),t.randomBytes=t.wrapConstructorWithOpts=t.wrapConstructor=t.checkOpts=t.Hash=t.concatBytes=t.toBytes=t.utf8ToBytes=t.asyncLoop=t.nextTick=t.hexToBytes=t.bytesToHex=t.isLE=t.rotr=t.createView=t.u32=t.u8=void 0;const e=zc,n=P=>new Uint8Array(P.buffer,P.byteOffset,P.byteLength);t.u8=n;const i=P=>new Uint32Array(P.buffer,P.byteOffset,Math.floor(P.byteLength/4));t.u32=i;const s=P=>new DataView(P.buffer,P.byteOffset,P.byteLength);t.createView=s;const o=(P,M)=>P<<32-M|P>>>M;if(t.rotr=o,t.isLE=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68,!t.isLE)throw new Error("Non little-endian hardware is not supported");const r=Array.from({length:256},(P,M)=>M.toString(16).padStart(2,"0"));function a(P){if(!(P instanceof Uint8Array))throw new Error("Uint8Array expected");let M="";for(let K=0;K<P.length;K++)M+=r[P[K]];return M}t.bytesToHex=a;function c(P){if(typeof P!="string")throw new TypeError("hexToBytes: expected string, got "+typeof P);if(P.length%2)throw new Error("hexToBytes: received invalid unpadded hex");const M=new Uint8Array(P.length/2);for(let K=0;K<M.length;K++){const Y=K*2,X=P.slice(Y,Y+2),et=Number.parseInt(X,16);if(Number.isNaN(et)||et<0)throw new Error("Invalid byte sequence");M[K]=et}return M}t.hexToBytes=c;const u=async()=>{};t.nextTick=u;async function l(P,M,K){let Y=Date.now();for(let X=0;X<P;X++){K(X);const et=Date.now()-Y;et>=0&&et<M||(await(0,t.nextTick)(),Y+=et)}}t.asyncLoop=l;function d(P){if(typeof P!="string")throw new TypeError(`utf8ToBytes expected string, got ${typeof P}`);return new TextEncoder().encode(P)}t.utf8ToBytes=d;function f(P){if(typeof P=="string"&&(P=d(P)),!(P instanceof Uint8Array))throw new TypeError(`Expected input type is Uint8Array (got ${typeof P})`);return P}t.toBytes=f;function _(...P){if(!P.every(Y=>Y instanceof Uint8Array))throw new Error("Uint8Array list expected");if(P.length===1)return P[0];const M=P.reduce((Y,X)=>Y+X.length,0),K=new Uint8Array(M);for(let Y=0,X=0;Y<P.length;Y++){const et=P[Y];K.set(et,X),X+=et.length}return K}t.concatBytes=_;class T{clone(){return this._cloneInto()}}t.Hash=T;const v=P=>Object.prototype.toString.call(P)==="[object Object]"&&P.constructor===Object;function k(P,M){if(M!==void 0&&(typeof M!="object"||!v(M)))throw new TypeError("Options should be object or undefined");return Object.assign(P,M)}t.checkOpts=k;function U(P){const M=Y=>P().update(f(Y)).digest(),K=P();return M.outputLen=K.outputLen,M.blockLen=K.blockLen,M.create=()=>P(),M}t.wrapConstructor=U;function R(P){const M=(Y,X)=>P(X).update(f(Y)).digest(),K=P({});return M.outputLen=K.outputLen,M.blockLen=K.blockLen,M.create=Y=>P(Y),M}t.wrapConstructorWithOpts=R;function A(P=32){if(e.crypto.web)return e.crypto.web.getRandomValues(new Uint8Array(P));if(e.crypto.node)return new Uint8Array(e.crypto.node.randomBytes(P).buffer);throw new Error("The environment doesn't have randomBytes function")}t.randomBytes=A})(ao);(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.hmac=void 0;const e=Un,n=ao;class i extends n.Hash{constructor(r,a){super(),this.finished=!1,this.destroyed=!1,e.default.hash(r);const c=(0,n.toBytes)(a);if(this.iHash=r.create(),typeof this.iHash.update!="function")throw new TypeError("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const u=this.blockLen,l=new Uint8Array(u);l.set(c.length>u?r.create().update(c).digest():c);for(let d=0;d<l.length;d++)l[d]^=54;this.iHash.update(l),this.oHash=r.create();for(let d=0;d<l.length;d++)l[d]^=106;this.oHash.update(l),l.fill(0)}update(r){return e.default.exists(this),this.iHash.update(r),this}digestInto(r){e.default.exists(this),e.default.bytes(r,this.outputLen),this.finished=!0,this.iHash.digestInto(r),this.oHash.update(r),this.oHash.digestInto(r),this.destroy()}digest(){const r=new Uint8Array(this.oHash.outputLen);return this.digestInto(r),r}_cloneInto(r){r||(r=Object.create(Object.getPrototypeOf(this),{}));const{oHash:a,iHash:c,finished:u,destroyed:l,blockLen:d,outputLen:f}=this;return r=r,r.finished=u,r.destroyed=l,r.blockLen=d,r.outputLen=f,r.oHash=a._cloneInto(r.oHash),r.iHash=c._cloneInto(r.iHash),r}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}}const s=(o,r,a)=>new i(o,r).update(a).digest();t.hmac=s,t.hmac.create=(o,r)=>new i(o,r)})(Op);Object.defineProperty(Go,"__esModule",{value:!0});Go.pbkdf2Async=Go.pbkdf2=void 0;const ga=Un,kb=Op,$o=ao;function Rp(t,e,n,i){ga.default.hash(t);const s=(0,$o.checkOpts)({dkLen:32,asyncTick:10},i),{c:o,dkLen:r,asyncTick:a}=s;if(ga.default.number(o),ga.default.number(r),ga.default.number(a),o<1)throw new Error("PBKDF2: iterations (c) should be >= 1");const c=(0,$o.toBytes)(e),u=(0,$o.toBytes)(n),l=new Uint8Array(r),d=kb.hmac.create(t,c),f=d._cloneInto().update(u);return{c:o,dkLen:r,asyncTick:a,DK:l,PRF:d,PRFSalt:f}}function Up(t,e,n,i,s){return t.destroy(),e.destroy(),i&&i.destroy(),s.fill(0),n}function Sb(t,e,n,i){const{c:s,dkLen:o,DK:r,PRF:a,PRFSalt:c}=Rp(t,e,n,i);let u;const l=new Uint8Array(4),d=(0,$o.createView)(l),f=new Uint8Array(a.outputLen);for(let _=1,T=0;T<o;_++,T+=a.outputLen){const v=r.subarray(T,T+a.outputLen);d.setInt32(0,_,!1),(u=c._cloneInto(u)).update(l).digestInto(f),v.set(f.subarray(0,v.length));for(let k=1;k<s;k++){a._cloneInto(u).update(f).digestInto(f);for(let U=0;U<v.length;U++)v[U]^=f[U]}}return Up(a,c,r,u,f)}Go.pbkdf2=Sb;async function Pb(t,e,n,i){const{c:s,dkLen:o,asyncTick:r,DK:a,PRF:c,PRFSalt:u}=Rp(t,e,n,i);let l;const d=new Uint8Array(4),f=(0,$o.createView)(d),_=new Uint8Array(c.outputLen);for(let T=1,v=0;v<o;T++,v+=c.outputLen){const k=a.subarray(v,v+c.outputLen);f.setInt32(0,T,!1),(l=u._cloneInto(l)).update(d).digestInto(_),k.set(_.subarray(0,k.length)),await(0,$o.asyncLoop)(s-1,r,U=>{c._cloneInto(l).update(_).digestInto(_);for(let R=0;R<k.length;R++)k[R]^=_[R]})}return Up(c,u,a,l,_)}Go.pbkdf2Async=Pb;var Wo={},Yr={};Object.defineProperty(Yr,"__esModule",{value:!0});Yr.SHA2=void 0;const Du=Un,yr=ao;function Bb(t,e,n,i){if(typeof t.setBigUint64=="function")return t.setBigUint64(e,n,i);const s=BigInt(32),o=BigInt(4294967295),r=Number(n>>s&o),a=Number(n&o),c=i?4:0,u=i?0:4;t.setUint32(e+c,r,i),t.setUint32(e+u,a,i)}let Eb=class extends yr.Hash{constructor(e,n,i,s){super(),this.blockLen=e,this.outputLen=n,this.padOffset=i,this.isLE=s,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(e),this.view=(0,yr.createView)(this.buffer)}update(e){Du.default.exists(this);const{view:n,buffer:i,blockLen:s}=this;e=(0,yr.toBytes)(e);const o=e.length;for(let r=0;r<o;){const a=Math.min(s-this.pos,o-r);if(a===s){const c=(0,yr.createView)(e);for(;s<=o-r;r+=s)this.process(c,r);continue}i.set(e.subarray(r,r+a),this.pos),this.pos+=a,r+=a,this.pos===s&&(this.process(n,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){Du.default.exists(this),Du.default.output(e,this),this.finished=!0;const{buffer:n,view:i,blockLen:s,isLE:o}=this;let{pos:r}=this;n[r++]=128,this.buffer.subarray(r).fill(0),this.padOffset>s-r&&(this.process(i,0),r=0);for(let d=r;d<s;d++)n[d]=0;Bb(i,s-8,BigInt(this.length*8),o),this.process(i,0);const a=(0,yr.createView)(e),c=this.outputLen;if(c%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const u=c/4,l=this.get();if(u>l.length)throw new Error("_sha2: outputLen bigger than state");for(let d=0;d<u;d++)a.setUint32(4*d,l[d],o)}digest(){const{buffer:e,outputLen:n}=this;this.digestInto(e);const i=e.slice(0,n);return this.destroy(),i}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());const{blockLen:n,buffer:i,length:s,finished:o,destroyed:r,pos:a}=this;return e.length=s,e.pos=a,e.finished=o,e.destroyed=r,s%n&&e.buffer.set(i),e}};Yr.SHA2=Eb;Object.defineProperty(Wo,"__esModule",{value:!0});Wo.sha224=Wo.sha256=void 0;const Cb=Yr,wi=ao,Ib=(t,e,n)=>t&e^~t&n,Ob=(t,e,n)=>t&e^t&n^e&n,Rb=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),hs=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),fs=new Uint32Array(64);class $p extends Cb.SHA2{constructor(){super(64,32,8,!1),this.A=hs[0]|0,this.B=hs[1]|0,this.C=hs[2]|0,this.D=hs[3]|0,this.E=hs[4]|0,this.F=hs[5]|0,this.G=hs[6]|0,this.H=hs[7]|0}get(){const{A:e,B:n,C:i,D:s,E:o,F:r,G:a,H:c}=this;return[e,n,i,s,o,r,a,c]}set(e,n,i,s,o,r,a,c){this.A=e|0,this.B=n|0,this.C=i|0,this.D=s|0,this.E=o|0,this.F=r|0,this.G=a|0,this.H=c|0}process(e,n){for(let d=0;d<16;d++,n+=4)fs[d]=e.getUint32(n,!1);for(let d=16;d<64;d++){const f=fs[d-15],_=fs[d-2],T=(0,wi.rotr)(f,7)^(0,wi.rotr)(f,18)^f>>>3,v=(0,wi.rotr)(_,17)^(0,wi.rotr)(_,19)^_>>>10;fs[d]=v+fs[d-7]+T+fs[d-16]|0}let{A:i,B:s,C:o,D:r,E:a,F:c,G:u,H:l}=this;for(let d=0;d<64;d++){const f=(0,wi.rotr)(a,6)^(0,wi.rotr)(a,11)^(0,wi.rotr)(a,25),_=l+f+Ib(a,c,u)+Rb[d]+fs[d]|0,v=((0,wi.rotr)(i,2)^(0,wi.rotr)(i,13)^(0,wi.rotr)(i,22))+Ob(i,s,o)|0;l=u,u=c,c=a,a=r+_|0,r=o,o=s,s=i,i=_+v|0}i=i+this.A|0,s=s+this.B|0,o=o+this.C|0,r=r+this.D|0,a=a+this.E|0,c=c+this.F|0,u=u+this.G|0,l=l+this.H|0,this.set(i,s,o,r,a,c,u,l)}roundClean(){fs.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}}class Ub extends $p{constructor(){super(),this.A=-1056596264,this.B=914150663,this.C=812702999,this.D=-150054599,this.E=-4191439,this.F=1750603025,this.G=1694076839,this.H=-1090891868,this.outputLen=28}}Wo.sha256=(0,wi.wrapConstructor)(()=>new $p);Wo.sha224=(0,wi.wrapConstructor)(()=>new Ub);var Si={},qp={};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.add=t.toBig=t.split=t.fromBig=void 0;const e=BigInt(2**32-1),n=BigInt(32);function i(z,O=!1){return O?{h:Number(z&e),l:Number(z>>n&e)}:{h:Number(z>>n&e)|0,l:Number(z&e)|0}}t.fromBig=i;function s(z,O=!1){let $=new Uint32Array(z.length),b=new Uint32Array(z.length);for(let h=0;h<z.length;h++){const{h:m,l:x}=i(z[h],O);[$[h],b[h]]=[m,x]}return[$,b]}t.split=s;const o=(z,O)=>BigInt(z>>>0)<<n|BigInt(O>>>0);t.toBig=o;const r=(z,O,$)=>z>>>$,a=(z,O,$)=>z<<32-$|O>>>$,c=(z,O,$)=>z>>>$|O<<32-$,u=(z,O,$)=>z<<32-$|O>>>$,l=(z,O,$)=>z<<64-$|O>>>$-32,d=(z,O,$)=>z>>>$-32|O<<64-$,f=(z,O)=>O,_=(z,O)=>z,T=(z,O,$)=>z<<$|O>>>32-$,v=(z,O,$)=>O<<$|z>>>32-$,k=(z,O,$)=>O<<$-32|z>>>64-$,U=(z,O,$)=>z<<$-32|O>>>64-$;function R(z,O,$,b){const h=(O>>>0)+(b>>>0);return{h:z+$+(h/2**32|0)|0,l:h|0}}t.add=R;const A=(z,O,$)=>(z>>>0)+(O>>>0)+($>>>0),P=(z,O,$,b)=>O+$+b+(z/2**32|0)|0,M=(z,O,$,b)=>(z>>>0)+(O>>>0)+($>>>0)+(b>>>0),K=(z,O,$,b,h)=>O+$+b+h+(z/2**32|0)|0,Y=(z,O,$,b,h)=>(z>>>0)+(O>>>0)+($>>>0)+(b>>>0)+(h>>>0),X=(z,O,$,b,h,m)=>O+$+b+h+m+(z/2**32|0)|0,et={fromBig:i,split:s,toBig:t.toBig,shrSH:r,shrSL:a,rotrSH:c,rotrSL:u,rotrBH:l,rotrBL:d,rotr32H:f,rotr32L:_,rotlSH:T,rotlSL:v,rotlBH:k,rotlBL:U,add:R,add3L:A,add3H:P,add4L:M,add4H:K,add5H:X,add5L:Y};t.default=et})(qp);Object.defineProperty(Si,"__esModule",{value:!0});Si.sha384=Si.sha512_256=Si.sha512_224=Si.sha512=Si.SHA512=void 0;const $b=Yr,Fe=qp,Hc=ao,[qb,Mb]=Fe.default.split(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(t=>BigInt(t))),ps=new Uint32Array(80),gs=new Uint32Array(80);let Qr=class extends $b.SHA2{constructor(){super(128,64,16,!1),this.Ah=1779033703,this.Al=-205731576,this.Bh=-1150833019,this.Bl=-2067093701,this.Ch=1013904242,this.Cl=-23791573,this.Dh=-1521486534,this.Dl=1595750129,this.Eh=1359893119,this.El=-1377402159,this.Fh=-1694144372,this.Fl=725511199,this.Gh=528734635,this.Gl=-79577749,this.Hh=1541459225,this.Hl=327033209}get(){const{Ah:e,Al:n,Bh:i,Bl:s,Ch:o,Cl:r,Dh:a,Dl:c,Eh:u,El:l,Fh:d,Fl:f,Gh:_,Gl:T,Hh:v,Hl:k}=this;return[e,n,i,s,o,r,a,c,u,l,d,f,_,T,v,k]}set(e,n,i,s,o,r,a,c,u,l,d,f,_,T,v,k){this.Ah=e|0,this.Al=n|0,this.Bh=i|0,this.Bl=s|0,this.Ch=o|0,this.Cl=r|0,this.Dh=a|0,this.Dl=c|0,this.Eh=u|0,this.El=l|0,this.Fh=d|0,this.Fl=f|0,this.Gh=_|0,this.Gl=T|0,this.Hh=v|0,this.Hl=k|0}process(e,n){for(let A=0;A<16;A++,n+=4)ps[A]=e.getUint32(n),gs[A]=e.getUint32(n+=4);for(let A=16;A<80;A++){const P=ps[A-15]|0,M=gs[A-15]|0,K=Fe.default.rotrSH(P,M,1)^Fe.default.rotrSH(P,M,8)^Fe.default.shrSH(P,M,7),Y=Fe.default.rotrSL(P,M,1)^Fe.default.rotrSL(P,M,8)^Fe.default.shrSL(P,M,7),X=ps[A-2]|0,et=gs[A-2]|0,z=Fe.default.rotrSH(X,et,19)^Fe.default.rotrBH(X,et,61)^Fe.default.shrSH(X,et,6),O=Fe.default.rotrSL(X,et,19)^Fe.default.rotrBL(X,et,61)^Fe.default.shrSL(X,et,6),$=Fe.default.add4L(Y,O,gs[A-7],gs[A-16]),b=Fe.default.add4H($,K,z,ps[A-7],ps[A-16]);ps[A]=b|0,gs[A]=$|0}let{Ah:i,Al:s,Bh:o,Bl:r,Ch:a,Cl:c,Dh:u,Dl:l,Eh:d,El:f,Fh:_,Fl:T,Gh:v,Gl:k,Hh:U,Hl:R}=this;for(let A=0;A<80;A++){const P=Fe.default.rotrSH(d,f,14)^Fe.default.rotrSH(d,f,18)^Fe.default.rotrBH(d,f,41),M=Fe.default.rotrSL(d,f,14)^Fe.default.rotrSL(d,f,18)^Fe.default.rotrBL(d,f,41),K=d&_^~d&v,Y=f&T^~f&k,X=Fe.default.add5L(R,M,Y,Mb[A],gs[A]),et=Fe.default.add5H(X,U,P,K,qb[A],ps[A]),z=X|0,O=Fe.default.rotrSH(i,s,28)^Fe.default.rotrBH(i,s,34)^Fe.default.rotrBH(i,s,39),$=Fe.default.rotrSL(i,s,28)^Fe.default.rotrBL(i,s,34)^Fe.default.rotrBL(i,s,39),b=i&o^i&a^o&a,h=s&r^s&c^r&c;U=v|0,R=k|0,v=_|0,k=T|0,_=d|0,T=f|0,{h:d,l:f}=Fe.default.add(u|0,l|0,et|0,z|0),u=a|0,l=c|0,a=o|0,c=r|0,o=i|0,r=s|0;const m=Fe.default.add3L(z,$,h);i=Fe.default.add3H(m,et,O,b),s=m|0}({h:i,l:s}=Fe.default.add(this.Ah|0,this.Al|0,i|0,s|0)),{h:o,l:r}=Fe.default.add(this.Bh|0,this.Bl|0,o|0,r|0),{h:a,l:c}=Fe.default.add(this.Ch|0,this.Cl|0,a|0,c|0),{h:u,l}=Fe.default.add(this.Dh|0,this.Dl|0,u|0,l|0),{h:d,l:f}=Fe.default.add(this.Eh|0,this.El|0,d|0,f|0),{h:_,l:T}=Fe.default.add(this.Fh|0,this.Fl|0,_|0,T|0),{h:v,l:k}=Fe.default.add(this.Gh|0,this.Gl|0,v|0,k|0),{h:U,l:R}=Fe.default.add(this.Hh|0,this.Hl|0,U|0,R|0),this.set(i,s,o,r,a,c,u,l,d,f,_,T,v,k,U,R)}roundClean(){ps.fill(0),gs.fill(0)}destroy(){this.buffer.fill(0),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}};Si.SHA512=Qr;class Db extends Qr{constructor(){super(),this.Ah=-1942145080,this.Al=424955298,this.Bh=1944164710,this.Bl=-1982016298,this.Ch=502970286,this.Cl=855612546,this.Dh=1738396948,this.Dl=1479516111,this.Eh=258812777,this.El=2077511080,this.Fh=2011393907,this.Fl=79989058,this.Gh=1067287976,this.Gl=1780299464,this.Hh=286451373,this.Hl=-1848208735,this.outputLen=28}}let Lb=class extends Qr{constructor(){super(),this.Ah=573645204,this.Al=-64227540,this.Bh=-1621794909,this.Bl=-934517566,this.Ch=596883563,this.Cl=1867755857,this.Dh=-1774684391,this.Dl=1497426621,this.Eh=-1775747358,this.El=-1467023389,this.Fh=-1101128155,this.Fl=1401305490,this.Gh=721525244,this.Gl=746961066,this.Hh=246885852,this.Hl=-2117784414,this.outputLen=32}},Nb=class extends Qr{constructor(){super(),this.Ah=-876896931,this.Al=-1056596264,this.Bh=1654270250,this.Bl=914150663,this.Ch=-1856437926,this.Cl=812702999,this.Dh=355462360,this.Dl=-150054599,this.Eh=1731405415,this.El=-4191439,this.Fh=-1900787065,this.Fl=1750603025,this.Gh=-619958771,this.Gl=1694076839,this.Hh=1203062813,this.Hl=-1090891868,this.outputLen=48}};Si.sha512=(0,Hc.wrapConstructor)(()=>new Qr);Si.sha512_224=(0,Hc.wrapConstructor)(()=>new Db);Si.sha512_256=(0,Hc.wrapConstructor)(()=>new Lb);Si.sha384=(0,Hc.wrapConstructor)(()=>new Nb);Object.defineProperty(hi,"__esModule",{value:!0});var Mp=hi.mnemonicToSeedSync=hi.mnemonicToSeed=hi.validateMnemonic=hi.entropyToMnemonic=hi.mnemonicToEntropy=hi.generateMnemonic=void 0;/*! scure-bip39 - MIT License (c) 2022 Patricio Palladino, Paul Miller (paulmillr.com) */const Dp=Un,Lp=Go,Fb=Wo,Np=Si,jb=ao,_a=Sl,zb=t=>t[0]==="あいこくしん";function Fp(t){if(typeof t!="string")throw new TypeError(`Invalid mnemonic type: ${typeof t}`);return t.normalize("NFKD")}function id(t){const e=Fp(t),n=e.split(" ");if(![12,15,18,21,24].includes(n.length))throw new Error("Invalid mnemonic");return{nfkd:e,words:n}}function jp(t){Dp.default.bytes(t,16,20,24,28,32)}function Hb(t,e=128){if(Dp.default.number(e),e%32!==0||e>256)throw new TypeError("Invalid entropy");return Kp((0,jb.randomBytes)(e/8),t)}hi.generateMnemonic=Hb;const Kb=t=>{const e=8-t.length/4;return new Uint8Array([(0,Fb.sha256)(t)[0]>>e<<e])};function zp(t){if(!Array.isArray(t)||t.length!==2**11||typeof t[0]!="string")throw new Error("Worlist: expected array of 2048 strings");return t.forEach(e=>{if(typeof e!="string")throw new Error(`Wordlist: non-string element: ${e}`)}),_a.utils.chain(_a.utils.checksum(1,Kb),_a.utils.radix2(11,!0),_a.utils.alphabet(t))}function Hp(t,e){const{words:n}=id(t),i=zp(e).decode(n);return jp(i),i}hi.mnemonicToEntropy=Hp;function Kp(t,e){return jp(t),zp(e).encode(t).join(zb(e)?"　":" ")}hi.entropyToMnemonic=Kp;function Gb(t,e){try{Hp(t,e)}catch{return!1}return!0}hi.validateMnemonic=Gb;const Gp=t=>Fp(`mnemonic${t}`);function Wb(t,e=""){return(0,Lp.pbkdf2Async)(Np.sha512,id(t).nfkd,Gp(e),{c:2048,dkLen:64})}hi.mnemonicToSeed=Wb;function Xb(t,e=""){return(0,Lp.pbkdf2)(Np.sha512,id(t).nfkd,Gp(e),{c:2048,dkLen:64})}Mp=hi.mnemonicToSeedSync=Xb;/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */const Vb=t=>new Uint32Array(t.buffer,t.byteOffset,Math.floor(t.byteLength/4)),Lu=t=>new DataView(t.buffer,t.byteOffset,t.byteLength),Jb=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;if(!Jb)throw new Error("Non little-endian hardware is not supported");const Zb=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function Wp(t){if(!(t instanceof Uint8Array))throw new Error("Uint8Array expected");let e="";for(let n=0;n<t.length;n++)e+=Zb[t[n]];return e}function Xp(t){if(typeof t!="string")throw new TypeError("hexToBytes: expected string, got "+typeof t);if(t.length%2)throw new Error("hexToBytes: received invalid unpadded hex");const e=new Uint8Array(t.length/2);for(let n=0;n<e.length;n++){const i=n*2,s=t.slice(i,i+2),o=Number.parseInt(s,16);if(Number.isNaN(o)||o<0)throw new Error("Invalid byte sequence");e[n]=o}return e}function Yb(t){if(typeof t!="string")throw new TypeError(`utf8ToBytes expected string, got ${typeof t}`);return new TextEncoder().encode(t)}function ta(t){if(typeof t=="string"&&(t=Yb(t)),!(t instanceof Uint8Array))throw new TypeError(`Expected input type is Uint8Array (got ${typeof t})`);return t}class sd{clone(){return this._cloneInto()}}function Kc(t){const e=i=>t().update(ta(i)).digest(),n=t();return e.outputLen=n.outputLen,e.blockLen=n.blockLen,e.create=()=>t(),e}function Qb(t){const e=(i,s)=>t(s).update(ta(i)).digest(),n=t({});return e.outputLen=n.outputLen,e.blockLen=n.blockLen,e.create=i=>t(i),e}function dl(t){if(!Number.isSafeInteger(t)||t<0)throw new Error(`Wrong positive integer: ${t}`)}function t1(t){if(typeof t!="boolean")throw new Error(`Expected boolean, not ${t}`)}function Vp(t,...e){if(!(t instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(e.length>0&&!e.includes(t.length))throw new TypeError(`Expected Uint8Array of length ${e}, not of length=${t.length}`)}function e1(t){if(typeof t!="function"||typeof t.create!="function")throw new Error("Hash should be wrapped by utils.wrapConstructor");dl(t.outputLen),dl(t.blockLen)}function n1(t,e=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(e&&t.finished)throw new Error("Hash#digest() has already been called")}function i1(t,e){Vp(t);const n=e.outputLen;if(t.length<n)throw new Error(`digestInto() expects output buffer of length at least ${n}`)}const fi={number:dl,bool:t1,bytes:Vp,hash:e1,exists:n1,output:i1},ma=BigInt(2**32-1),hl=BigInt(32);function Jp(t,e=!1){return e?{h:Number(t&ma),l:Number(t>>hl&ma)}:{h:Number(t>>hl&ma)|0,l:Number(t&ma)|0}}function s1(t,e=!1){let n=new Uint32Array(t.length),i=new Uint32Array(t.length);for(let s=0;s<t.length;s++){const{h:o,l:r}=Jp(t[s],e);[n[s],i[s]]=[o,r]}return[n,i]}const o1=(t,e)=>BigInt(t>>>0)<<hl|BigInt(e>>>0),r1=(t,e,n)=>t>>>n,a1=(t,e,n)=>t<<32-n|e>>>n,c1=(t,e,n)=>t>>>n|e<<32-n,u1=(t,e,n)=>t<<32-n|e>>>n,l1=(t,e,n)=>t<<64-n|e>>>n-32,d1=(t,e,n)=>t>>>n-32|e<<64-n,h1=(t,e)=>e,f1=(t,e)=>t,p1=(t,e,n)=>t<<n|e>>>32-n,g1=(t,e,n)=>e<<n|t>>>32-n,_1=(t,e,n)=>e<<n-32|t>>>64-n,m1=(t,e,n)=>t<<n-32|e>>>64-n;function y1(t,e,n,i){const s=(e>>>0)+(i>>>0);return{h:t+n+(s/2**32|0)|0,l:s|0}}const w1=(t,e,n)=>(t>>>0)+(e>>>0)+(n>>>0),b1=(t,e,n,i)=>e+n+i+(t/2**32|0)|0,v1=(t,e,n,i)=>(t>>>0)+(e>>>0)+(n>>>0)+(i>>>0),x1=(t,e,n,i,s)=>e+n+i+s+(t/2**32|0)|0,T1=(t,e,n,i,s)=>(t>>>0)+(e>>>0)+(n>>>0)+(i>>>0)+(s>>>0),A1=(t,e,n,i,s,o)=>e+n+i+s+o+(t/2**32|0)|0,Be={fromBig:Jp,split:s1,toBig:o1,shrSH:r1,shrSL:a1,rotrSH:c1,rotrSL:u1,rotrBH:l1,rotrBL:d1,rotr32H:h1,rotr32L:f1,rotlSH:p1,rotlSL:g1,rotlBH:_1,rotlBL:m1,add:y1,add3L:w1,add3H:b1,add4L:v1,add4H:x1,add5H:A1,add5L:T1},[Zp,Yp,Qp]=[[],[],[]],k1=BigInt(0),wr=BigInt(1),S1=BigInt(2),P1=BigInt(7),B1=BigInt(256),E1=BigInt(113);for(let t=0,e=wr,n=1,i=0;t<24;t++){[n,i]=[i,(2*n+3*i)%5],Zp.push(2*(5*i+n)),Yp.push((t+1)*(t+2)/2%64);let s=k1;for(let o=0;o<7;o++)e=(e<<wr^(e>>P1)*E1)%B1,e&S1&&(s^=wr<<(wr<<BigInt(o))-wr);Qp.push(s)}const[C1,I1]=Be.split(Qp,!0),nh=(t,e,n)=>n>32?Be.rotlBH(t,e,n):Be.rotlSH(t,e,n),ih=(t,e,n)=>n>32?Be.rotlBL(t,e,n):Be.rotlSL(t,e,n);function O1(t,e=24){const n=new Uint32Array(10);for(let i=24-e;i<24;i++){for(let r=0;r<10;r++)n[r]=t[r]^t[r+10]^t[r+20]^t[r+30]^t[r+40];for(let r=0;r<10;r+=2){const a=(r+8)%10,c=(r+2)%10,u=n[c],l=n[c+1],d=nh(u,l,1)^n[a],f=ih(u,l,1)^n[a+1];for(let _=0;_<50;_+=10)t[r+_]^=d,t[r+_+1]^=f}let s=t[2],o=t[3];for(let r=0;r<24;r++){const a=Yp[r],c=nh(s,o,a),u=ih(s,o,a),l=Zp[r];s=t[l],o=t[l+1],t[l]=c,t[l+1]=u}for(let r=0;r<50;r+=10){for(let a=0;a<10;a++)n[a]=t[r+a];for(let a=0;a<10;a++)t[r+a]^=~n[(a+2)%10]&n[(a+4)%10]}t[0]^=C1[i],t[1]^=I1[i]}n.fill(0)}class Gc extends sd{constructor(e,n,i,s=!1,o=24){if(super(),this.blockLen=e,this.suffix=n,this.outputLen=i,this.enableXOF=s,this.rounds=o,this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,fi.number(i),0>=this.blockLen||this.blockLen>=200)throw new Error("Sha3 supports only keccak-f1600 function");this.state=new Uint8Array(200),this.state32=Vb(this.state)}keccak(){O1(this.state32,this.rounds),this.posOut=0,this.pos=0}update(e){fi.exists(this);const{blockLen:n,state:i}=this;e=ta(e);const s=e.length;for(let o=0;o<s;){const r=Math.min(n-this.pos,s-o);for(let a=0;a<r;a++)i[this.pos++]^=e[o++];this.pos===n&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;const{state:e,suffix:n,pos:i,blockLen:s}=this;e[i]^=n,n&128&&i===s-1&&this.keccak(),e[s-1]^=128,this.keccak()}writeInto(e){fi.exists(this,!1),fi.bytes(e),this.finish();const n=this.state,{blockLen:i}=this;for(let s=0,o=e.length;s<o;){this.posOut>=i&&this.keccak();const r=Math.min(i-this.posOut,o-s);e.set(n.subarray(this.posOut,this.posOut+r),s),this.posOut+=r,s+=r}return e}xofInto(e){if(!this.enableXOF)throw new Error("XOF is not possible for this instance");return this.writeInto(e)}xof(e){return fi.number(e),this.xofInto(new Uint8Array(e))}digestInto(e){if(fi.output(e,this),this.finished)throw new Error("digest() was already called");return this.writeInto(e),this.destroy(),e}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,this.state.fill(0)}_cloneInto(e){const{blockLen:n,suffix:i,outputLen:s,rounds:o,enableXOF:r}=this;return e||(e=new Gc(n,i,s,r,o)),e.state32.set(this.state32),e.pos=this.pos,e.posOut=this.posOut,e.finished=this.finished,e.rounds=o,e.suffix=i,e.outputLen=s,e.enableXOF=r,e.destroyed=this.destroyed,e}}const Os=(t,e,n)=>Kc(()=>new Gc(e,t,n));Os(6,144,224/8);const Xo=Os(6,136,256/8);Os(6,104,384/8);Os(6,72,512/8);Os(1,144,224/8);Os(1,136,256/8);Os(1,104,384/8);Os(1,72,512/8);const tg=(t,e,n)=>Qb((i={})=>new Gc(e,t,i.dkLen===void 0?n:i.dkLen,!0));tg(31,168,128/8);tg(31,136,256/8);class eg extends sd{constructor(e,n){super(),this.finished=!1,this.destroyed=!1,fi.hash(e);const i=ta(n);if(this.iHash=e.create(),typeof this.iHash.update!="function")throw new TypeError("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const s=this.blockLen,o=new Uint8Array(s);o.set(i.length>s?e.create().update(i).digest():i);for(let r=0;r<o.length;r++)o[r]^=54;this.iHash.update(o),this.oHash=e.create();for(let r=0;r<o.length;r++)o[r]^=106;this.oHash.update(o),o.fill(0)}update(e){return fi.exists(this),this.iHash.update(e),this}digestInto(e){fi.exists(this),fi.bytes(e,this.outputLen),this.finished=!0,this.iHash.digestInto(e),this.oHash.update(e),this.oHash.digestInto(e),this.destroy()}digest(){const e=new Uint8Array(this.oHash.outputLen);return this.digestInto(e),e}_cloneInto(e){e||(e=Object.create(Object.getPrototypeOf(this),{}));const{oHash:n,iHash:i,finished:s,destroyed:o,blockLen:r,outputLen:a}=this;return e=e,e.finished=s,e.destroyed=o,e.blockLen=r,e.outputLen=a,e.oHash=n._cloneInto(e.oHash),e.iHash=i._cloneInto(e.iHash),e}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}}const od=(t,e,n)=>new eg(t,e).update(n).digest();od.create=(t,e)=>new eg(t,e);function R1(t,e,n,i){if(typeof t.setBigUint64=="function")return t.setBigUint64(e,n,i);const s=BigInt(32),o=BigInt(4294967295),r=Number(n>>s&o),a=Number(n&o),c=i?4:0,u=i?0:4;t.setUint32(e+c,r,i),t.setUint32(e+u,a,i)}class U1 extends sd{constructor(e,n,i,s){super(),this.blockLen=e,this.outputLen=n,this.padOffset=i,this.isLE=s,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(e),this.view=Lu(this.buffer)}update(e){fi.exists(this);const{view:n,buffer:i,blockLen:s}=this;e=ta(e);const o=e.length;for(let r=0;r<o;){const a=Math.min(s-this.pos,o-r);if(a===s){const c=Lu(e);for(;s<=o-r;r+=s)this.process(c,r);continue}i.set(e.subarray(r,r+a),this.pos),this.pos+=a,r+=a,this.pos===s&&(this.process(n,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){fi.exists(this),fi.output(e,this),this.finished=!0;const{buffer:n,view:i,blockLen:s,isLE:o}=this;let{pos:r}=this;n[r++]=128,this.buffer.subarray(r).fill(0),this.padOffset>s-r&&(this.process(i,0),r=0);for(let c=r;c<s;c++)n[c]=0;R1(i,s-8,BigInt(this.length*8),o),this.process(i,0);const a=Lu(e);this.get().forEach((c,u)=>a.setUint32(4*u,c,o))}digest(){const{buffer:e,outputLen:n}=this;this.digestInto(e);const i=e.slice(0,n);return this.destroy(),i}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());const{blockLen:n,buffer:i,length:s,finished:o,destroyed:r,pos:a}=this;return e.length=s,e.pos=a,e.finished=o,e.destroyed=r,s%n&&e.buffer.set(i),e}}const[$1,q1]=Be.split(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(t=>BigInt(t))),_s=new Uint32Array(80),ms=new Uint32Array(80);class rd extends U1{constructor(){super(128,64,16,!1),this.Ah=1779033703,this.Al=-205731576,this.Bh=-1150833019,this.Bl=-2067093701,this.Ch=1013904242,this.Cl=-23791573,this.Dh=-1521486534,this.Dl=1595750129,this.Eh=1359893119,this.El=-1377402159,this.Fh=-1694144372,this.Fl=725511199,this.Gh=528734635,this.Gl=-79577749,this.Hh=1541459225,this.Hl=327033209}get(){const{Ah:e,Al:n,Bh:i,Bl:s,Ch:o,Cl:r,Dh:a,Dl:c,Eh:u,El:l,Fh:d,Fl:f,Gh:_,Gl:T,Hh:v,Hl:k}=this;return[e,n,i,s,o,r,a,c,u,l,d,f,_,T,v,k]}set(e,n,i,s,o,r,a,c,u,l,d,f,_,T,v,k){this.Ah=e|0,this.Al=n|0,this.Bh=i|0,this.Bl=s|0,this.Ch=o|0,this.Cl=r|0,this.Dh=a|0,this.Dl=c|0,this.Eh=u|0,this.El=l|0,this.Fh=d|0,this.Fl=f|0,this.Gh=_|0,this.Gl=T|0,this.Hh=v|0,this.Hl=k|0}process(e,n){for(let A=0;A<16;A++,n+=4)_s[A]=e.getUint32(n),ms[A]=e.getUint32(n+=4);for(let A=16;A<80;A++){const P=_s[A-15]|0,M=ms[A-15]|0,K=Be.rotrSH(P,M,1)^Be.rotrSH(P,M,8)^Be.shrSH(P,M,7),Y=Be.rotrSL(P,M,1)^Be.rotrSL(P,M,8)^Be.shrSL(P,M,7),X=_s[A-2]|0,et=ms[A-2]|0,z=Be.rotrSH(X,et,19)^Be.rotrBH(X,et,61)^Be.shrSH(X,et,6),O=Be.rotrSL(X,et,19)^Be.rotrBL(X,et,61)^Be.shrSL(X,et,6),$=Be.add4L(Y,O,ms[A-7],ms[A-16]),b=Be.add4H($,K,z,_s[A-7],_s[A-16]);_s[A]=b|0,ms[A]=$|0}let{Ah:i,Al:s,Bh:o,Bl:r,Ch:a,Cl:c,Dh:u,Dl:l,Eh:d,El:f,Fh:_,Fl:T,Gh:v,Gl:k,Hh:U,Hl:R}=this;for(let A=0;A<80;A++){const P=Be.rotrSH(d,f,14)^Be.rotrSH(d,f,18)^Be.rotrBH(d,f,41),M=Be.rotrSL(d,f,14)^Be.rotrSL(d,f,18)^Be.rotrBL(d,f,41),K=d&_^~d&v,Y=f&T^~f&k,X=Be.add5L(R,M,Y,q1[A],ms[A]),et=Be.add5H(X,U,P,K,$1[A],_s[A]),z=X|0,O=Be.rotrSH(i,s,28)^Be.rotrBH(i,s,34)^Be.rotrBH(i,s,39),$=Be.rotrSL(i,s,28)^Be.rotrBL(i,s,34)^Be.rotrBL(i,s,39),b=i&o^i&a^o&a,h=s&r^s&c^r&c;U=v|0,R=k|0,v=_|0,k=T|0,_=d|0,T=f|0,{h:d,l:f}=Be.add(u|0,l|0,et|0,z|0),u=a|0,l=c|0,a=o|0,c=r|0,o=i|0,r=s|0;const m=Be.add3L(z,$,h);i=Be.add3H(m,et,O,b),s=m|0}({h:i,l:s}=Be.add(this.Ah|0,this.Al|0,i|0,s|0)),{h:o,l:r}=Be.add(this.Bh|0,this.Bl|0,o|0,r|0),{h:a,l:c}=Be.add(this.Ch|0,this.Cl|0,a|0,c|0),{h:u,l}=Be.add(this.Dh|0,this.Dl|0,u|0,l|0),{h:d,l:f}=Be.add(this.Eh|0,this.El|0,d|0,f|0),{h:_,l:T}=Be.add(this.Fh|0,this.Fl|0,_|0,T|0),{h:v,l:k}=Be.add(this.Gh|0,this.Gl|0,v|0,k|0),{h:U,l:R}=Be.add(this.Hh|0,this.Hl|0,U|0,R|0),this.set(i,s,o,r,a,c,u,l,d,f,_,T,v,k,U,R)}roundClean(){_s.fill(0),ms.fill(0)}destroy(){this.buffer.fill(0),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}}class M1 extends rd{constructor(){super(),this.Ah=573645204,this.Al=-64227540,this.Bh=-1621794909,this.Bl=-934517566,this.Ch=596883563,this.Cl=1867755857,this.Dh=-1774684391,this.Dl=1497426621,this.Eh=-1775747358,this.El=-1467023389,this.Fh=-1101128155,this.Fl=1401305490,this.Gh=721525244,this.Gl=746961066,this.Hh=246885852,this.Hl=-2117784414,this.outputLen=32}}class D1 extends rd{constructor(){super(),this.Ah=-876896931,this.Al=-1056596264,this.Bh=1654270250,this.Bl=914150663,this.Ch=-1856437926,this.Cl=812702999,this.Dh=355462360,this.Dl=-150054599,this.Eh=1731405415,this.El=-4191439,this.Fh=-1900787065,this.Fl=1750603025,this.Gh=-619958771,this.Gl=1694076839,this.Hh=1203062813,this.Hl=-1090891868,this.outputLen=48}}const ng=Kc(()=>new rd);Kc(()=>new M1);Kc(()=>new D1);var ig=typeof self=="object"?self.FormData:window.FormData,sg=Object.defineProperty,L1=Object.getOwnPropertyDescriptor,Wc=(t,e)=>{for(var n in e)sg(t,n,{get:e[n],enumerable:!0})},cn=(t,e,n,i)=>{for(var s=i>1?void 0:i?L1(e,n):e,o=t.length-1,r;o>=0;o--)(r=t[o])&&(s=(i?r(e,n,s):r(s))||s);return i&&s&&sg(e,n,s),s},N1=/^m(\/[0-9]+')+$/,og=t=>t.replace("'",""),F1="ed25519 seed",j1=2147483648,z1=t=>{const n=od.create(ng,F1).update(Xp(t)).digest(),i=n.slice(0,32),s=n.slice(32);return{key:i,chainCode:s}},H1=({key:t,chainCode:e},n)=>{const i=new ArrayBuffer(4);new DataView(i).setUint32(0,n);const s=new Uint8Array(i),o=new Uint8Array([0]),r=new Uint8Array([...o,...t,...s]),a=od.create(ng,e).update(r).digest(),c=a.slice(0,32),u=a.slice(32);return{key:c,chainCode:u}},K1=t=>N1.test(t)?!t.split("/").slice(1).map(og).some(Number.isNaN):!1,G1=(t,e,n=j1)=>{if(!K1(t))throw new Error("Invalid derivation path");const{key:i,chainCode:s}=z1(e);return t.split("/").slice(1).map(og).map(r=>parseInt(r,10)).reduce((r,a)=>H1(r,a+n),{key:i,chainCode:s})},Ie=class{static fromBuffer(t){return Ie.fromUint8Array(t)}static fromUint8Array(t){return new Ie(Wp(t))}static ensure(t){return typeof t=="string"?new Ie(t):t}constructor(t){t.startsWith("0x")?this.hexString=t:this.hexString=`0x${t}`}hex(){return this.hexString}noPrefix(){return this.hexString.slice(2)}toString(){return this.hex()}toShortString(){return`0x${this.hexString.replace(/^0x0*/,"")}`}toUint8Array(){return Uint8Array.from(Xp(this.noPrefix()))}};async function W1(t){return new Promise(e=>{setTimeout(e,t)})}var sh="/v1";function X1(t){let e=`${t}`;return e.endsWith("/")&&(e=e.substring(0,e.length-1)),e.endsWith(sh)||(e=`${e}${sh}`),e}var rg=2e5,ag=20,V1=20,J1="0x1::aptos_coin::AptosCoin";function Xc(t){let e,n,i;return typeof t=="object"?(e=t.hashFunction,n=t.ttlMs,i=t.tags):e=t,(s,o,r)=>{if(r.value!=null)r.value=oh(r.value,e,n,i);else if(r.get!=null)r.get=oh(r.get,e,n,i);else throw new Error("Only put a Memoize() decorator on a method or get accessor.")}}function Z1(t,e){return Xc({ttlMs:t,hashFunction:e})}var Ua=new Map;function Y1(t){const e=new Set;for(const n of t){const i=Ua.get(n);if(i)for(const s of i)e.has(s)||(s.clear(),e.add(s))}return e.size}function oh(t,e,n=0,i){const s=Symbol("__memoized_map__");return function(...o){let r;const a=this;a.hasOwnProperty(s)||Object.defineProperty(a,s,{configurable:!1,enumerable:!1,writable:!1,value:new Map});const c=a[s];if(Array.isArray(i))for(const u of i)Ua.has(u)?Ua.get(u).push(c):Ua.set(u,[c]);if(e||o.length>0||n>0){let u;e===!0?u=o.map(f=>f.toString()).join("!"):e?u=e.apply(a,o):u=o[0];const l=`${u}__timestamp`;let d=!1;if(n>0)if(!c.has(l))d=!0;else{const f=c.get(l);d=Date.now()-f>n}c.has(u)&&!d?r=c.get(u):(r=t.apply(a,o),c.set(u,r),n>0&&c.set(l,Date.now()))}else{const u=a;c.has(u)?r=c.get(u):(r=t.apply(a,o),c.set(u,r))}return r}}async function rh(t,e,n,i){var s;const o=[];let r;for(;;){const a=await t(Ie.ensure(e).hex(),(s=i==null?void 0:i.ledgerVersion)==null?void 0:s.toString(),r,n);if(r=a.__headers["x-aptos-cursor"],delete a.__headers,o.push(...a),r==null)break}return o}var Q1={mainnet:"https://indexer.mainnet.aptoslabs.com/v1/graphql",testnet:"https://indexer-testnet.staging.gcp.aptosdev.com/v1/graphql",devnet:"https://indexer-devnet.staging.gcp.aptosdev.com/v1/graphql"},tv={mainnet:"https://fullnode.mainnet.aptoslabs.com/v1",testnet:"https://fullnode.testnet.aptoslabs.com/v1",devnet:"https://fullnode.devnet.aptoslabs.com/v1"},F={};Wc(F,{AccountAddress:()=>yn,AccountAuthenticator:()=>Mr,AccountAuthenticatorEd25519:()=>ud,AccountAuthenticatorMultiEd25519:()=>ld,ArgumentABI:()=>ca,AuthenticationKey:()=>Zs,ChainId:()=>tu,ChangeSet:()=>hv,Ed25519PublicKey:()=>Ti,Ed25519Signature:()=>Hi,EntryFunction:()=>Hs,EntryFunctionABI:()=>Qo,Identifier:()=>ei,Module:()=>ug,ModuleId:()=>Js,MultiAgentRawTransaction:()=>Yc,MultiEd25519PublicKey:()=>ea,MultiEd25519Signature:()=>Vc,MultiSig:()=>fd,MultiSigTransactionPayload:()=>hd,RawTransaction:()=>fr,RawTransactionWithData:()=>lg,RotationProofChallenge:()=>pv,Script:()=>ia,ScriptABI:()=>au,SignedTransaction:()=>sa,StructTag:()=>Vo,Transaction:()=>dg,TransactionArgument:()=>Di,TransactionArgumentAddress:()=>Zo,TransactionArgumentBool:()=>ru,TransactionArgumentU128:()=>su,TransactionArgumentU16:()=>nu,TransactionArgumentU256:()=>ou,TransactionArgumentU32:()=>iu,TransactionArgumentU64:()=>Jo,TransactionArgumentU8:()=>eu,TransactionArgumentU8Vector:()=>Yo,TransactionAuthenticator:()=>na,TransactionAuthenticatorEd25519:()=>Jc,TransactionAuthenticatorMultiAgent:()=>cd,TransactionAuthenticatorMultiEd25519:()=>Zc,TransactionPayload:()=>oa,TransactionPayloadEntryFunction:()=>Qc,TransactionPayloadMultisig:()=>pd,TransactionPayloadScript:()=>ra,TransactionScriptABI:()=>cu,TypeArgumentABI:()=>aa,TypeTag:()=>Hn,TypeTagAddress:()=>fo,TypeTagBool:()=>uo,TypeTagSigner:()=>dd,TypeTagStruct:()=>po,TypeTagU128:()=>ho,TypeTagU16:()=>ur,TypeTagU256:()=>dr,TypeTagU32:()=>lr,TypeTagU64:()=>lo,TypeTagU8:()=>ns,TypeTagVector:()=>hr,UserTransaction:()=>gd,WriteSet:()=>fv});var rt={};Wc(rt,{Deserializer:()=>ad,Serializer:()=>xn,bcsSerializeBool:()=>uv,bcsSerializeBytes:()=>To,bcsSerializeFixedBytes:()=>dv,bcsSerializeStr:()=>lv,bcsSerializeU128:()=>cv,bcsSerializeU16:()=>rv,bcsSerializeU32:()=>av,bcsSerializeU8:()=>fl,bcsSerializeUint64:()=>ov,bcsToBytes:()=>is,deserializeVector:()=>Bi,serializeVector:()=>pi,serializeVectorWithFunc:()=>sv});var ev=2**8-1,nv=2**16-1,qr=2**32-1,Er=BigInt(2**64)-BigInt(1),cg=BigInt(2**128)-BigInt(1),iv=BigInt(2**256)-BigInt(1),xn=class{constructor(){this.buffer=new ArrayBuffer(64),this.offset=0}ensureBufferWillHandleSize(t){for(;this.buffer.byteLength<this.offset+t;){const e=new ArrayBuffer(this.buffer.byteLength*2);new Uint8Array(e).set(new Uint8Array(this.buffer)),this.buffer=e}}serialize(t){this.ensureBufferWillHandleSize(t.length),new Uint8Array(this.buffer,this.offset).set(t),this.offset+=t.length}serializeWithFunction(t,e,n){this.ensureBufferWillHandleSize(e);const i=new DataView(this.buffer,this.offset);t.apply(i,[0,n,!0]),this.offset+=e}serializeStr(t){const e=new TextEncoder;this.serializeBytes(e.encode(t))}serializeBytes(t){this.serializeU32AsUleb128(t.length),this.serialize(t)}serializeFixedBytes(t){this.serialize(t)}serializeBool(t){if(typeof t!="boolean")throw new Error("Value needs to be a boolean");const e=t?1:0;this.serialize(new Uint8Array([e]))}serializeU8(t){this.serialize(new Uint8Array([t]))}serializeU16(t){this.serializeWithFunction(DataView.prototype.setUint16,2,t)}serializeU32(t){this.serializeWithFunction(DataView.prototype.setUint32,4,t)}serializeU64(t){const e=BigInt(t.toString())&BigInt(qr),n=BigInt(t.toString())>>BigInt(32);this.serializeU32(Number(e)),this.serializeU32(Number(n))}serializeU128(t){const e=BigInt(t.toString())&Er,n=BigInt(t.toString())>>BigInt(64);this.serializeU64(e),this.serializeU64(n)}serializeU256(t){const e=BigInt(t.toString())&cg,n=BigInt(t.toString())>>BigInt(128);this.serializeU128(e),this.serializeU128(n)}serializeU32AsUleb128(t){let e=t;const n=[];for(;e>>>7;)n.push(e&127|128),e>>>=7;n.push(e),this.serialize(new Uint8Array(n))}getBytes(){return new Uint8Array(this.buffer).slice(0,this.offset)}};cn([co(0,ev)],xn.prototype,"serializeU8",1);cn([co(0,nv)],xn.prototype,"serializeU16",1);cn([co(0,qr)],xn.prototype,"serializeU32",1);cn([co(BigInt(0),Er)],xn.prototype,"serializeU64",1);cn([co(BigInt(0),cg)],xn.prototype,"serializeU128",1);cn([co(BigInt(0),iv)],xn.prototype,"serializeU256",1);cn([co(0,qr)],xn.prototype,"serializeU32AsUleb128",1);function co(t,e,n){return(i,s,o)=>{const r=o.value;return o.value=function(c){const u=BigInt(c.toString());if(u>BigInt(e.toString())||u<BigInt(t.toString()))throw new Error(n||"Value is out of range");r.apply(this,[c])},o}}var ad=class{constructor(t){this.buffer=new ArrayBuffer(t.length),new Uint8Array(this.buffer).set(t,0),this.offset=0}read(t){if(this.offset+t>this.buffer.byteLength)throw new Error("Reached to the end of buffer");const e=this.buffer.slice(this.offset,this.offset+t);return this.offset+=t,e}deserializeStr(){const t=this.deserializeBytes();return new TextDecoder().decode(t)}deserializeBytes(){const t=this.deserializeUleb128AsU32();return new Uint8Array(this.read(t))}deserializeFixedBytes(t){return new Uint8Array(this.read(t))}deserializeBool(){const t=new Uint8Array(this.read(1))[0];if(t!==1&&t!==0)throw new Error("Invalid boolean value");return t===1}deserializeU8(){return new DataView(this.read(1)).getUint8(0)}deserializeU16(){return new DataView(this.read(2)).getUint16(0,!0)}deserializeU32(){return new DataView(this.read(4)).getUint32(0,!0)}deserializeU64(){const t=this.deserializeU32(),e=this.deserializeU32();return BigInt(BigInt(e)<<BigInt(32)|BigInt(t))}deserializeU128(){const t=this.deserializeU64(),e=this.deserializeU64();return BigInt(e<<BigInt(64)|t)}deserializeU256(){const t=this.deserializeU128(),e=this.deserializeU128();return BigInt(e<<BigInt(128)|t)}deserializeUleb128AsU32(){let t=BigInt(0),e=0;for(;t<qr;){const n=this.deserializeU8();if(t|=BigInt(n&127)<<BigInt(e),!(n&128))break;e+=7}if(t>qr)throw new Error("Overflow while parsing uleb128-encoded uint32 value");return Number(t)}};function pi(t,e){e.serializeU32AsUleb128(t.length),t.forEach(n=>{n.serialize(e)})}function sv(t,e){const n=new xn;n.serializeU32AsUleb128(t.length);const i=n[e];return t.forEach(s=>{i.call(n,s)}),n.getBytes()}function Bi(t,e){const n=t.deserializeUleb128AsU32(),i=[];for(let s=0;s<n;s+=1)i.push(e.deserialize(t));return i}function is(t){const e=new xn;return t.serialize(e),e.getBytes()}function ov(t){const e=new xn;return e.serializeU64(t),e.getBytes()}function fl(t){const e=new xn;return e.serializeU8(t),e.getBytes()}function rv(t){const e=new xn;return e.serializeU16(t),e.getBytes()}function av(t){const e=new xn;return e.serializeU32(t),e.getBytes()}function cv(t){const e=new xn;return e.serializeU128(t),e.getBytes()}function uv(t){const e=new xn;return e.serializeBool(t),e.getBytes()}function lv(t){const e=new xn;return e.serializeStr(t),e.getBytes()}function To(t){const e=new xn;return e.serializeBytes(t),e.getBytes()}function dv(t){const e=new xn;return e.serializeFixedBytes(t),e.getBytes()}var bi=class{constructor(t){if(t.length!==bi.LENGTH)throw new Error("Expected address of length 32");this.address=t}static fromHex(t){let e=Ie.ensure(t);e.noPrefix().length%2!==0&&(e=new Ie(`0${e.noPrefix()}`));const n=e.toUint8Array();if(n.length>bi.LENGTH)throw new Error("Hex string is too long. Address's length is 32 bytes.");if(n.length===bi.LENGTH)return new bi(n);const i=new Uint8Array(bi.LENGTH);return i.set(n,bi.LENGTH-n.length),new bi(i)}static isValid(t){if(t==="")return!1;let e=Ie.ensure(t);return e.noPrefix().length%2!==0&&(e=new Ie(`0${e.noPrefix()}`)),e.toUint8Array().length<=bi.LENGTH}toHexString(){return Ie.fromUint8Array(this.address).hex()}serialize(t){t.serializeFixedBytes(this.address)}static deserialize(t){return new bi(t.deserializeFixedBytes(bi.LENGTH))}},yn=bi;yn.LENGTH=32;yn.CORE_CODE_ADDRESS=bi.fromHex("0x1");var $a=class{constructor(t){if(t.length!==$a.LENGTH)throw new Error(`Ed25519PublicKey length should be ${$a.LENGTH}`);this.value=t}toBytes(){return this.value}serialize(t){t.serializeBytes(this.value)}static deserialize(t){const e=t.deserializeBytes();return new $a(e)}},Ti=$a;Ti.LENGTH=32;var qa=class{constructor(t){if(this.value=t,t.length!==qa.LENGTH)throw new Error(`Ed25519Signature length should be ${qa.LENGTH}`)}serialize(t){t.serializeBytes(this.value)}static deserialize(t){const e=t.deserializeBytes();return new qa(e)}},Hi=qa;Hi.LENGTH=64;var pl=32,ea=class{constructor(t,e){if(this.public_keys=t,this.threshold=e,e>pl)throw new Error(`"threshold" cannot be larger than ${pl}`)}toBytes(){const t=new Uint8Array(this.public_keys.length*Ti.LENGTH+1);return this.public_keys.forEach((e,n)=>{t.set(e.value,n*Ti.LENGTH)}),t[this.public_keys.length*Ti.LENGTH]=this.threshold,t}serialize(t){t.serializeBytes(this.toBytes())}static deserialize(t){const e=t.deserializeBytes(),n=e[e.length-1],i=[];for(let s=0;s<e.length-1;s+=Ti.LENGTH){const o=s;i.push(new Ti(e.subarray(o,o+Ti.LENGTH)))}return new ea(i,n)}},Tr=class{constructor(t,e){if(this.signatures=t,this.bitmap=e,e.length!==Tr.BITMAP_LEN)throw new Error(`"bitmap" length should be ${Tr.BITMAP_LEN}`)}toBytes(){const t=new Uint8Array(this.signatures.length*Hi.LENGTH+Tr.BITMAP_LEN);return this.signatures.forEach((e,n)=>{t.set(e.value,n*Hi.LENGTH)}),t.set(this.bitmap,this.signatures.length*Hi.LENGTH),t}static createBitmap(t){const n=new Uint8Array([0,0,0,0]),i=new Set;return t.forEach(s=>{if(s>=pl)throw new Error(`Invalid bit value ${s}.`);if(i.has(s))throw new Error("Duplicated bits detected.");i.add(s);const o=Math.floor(s/8);let r=n[o];r|=128>>s%8,n[o]=r}),n}serialize(t){t.serializeBytes(this.toBytes())}static deserialize(t){const e=t.deserializeBytes(),n=e.subarray(e.length-4),i=[];for(let s=0;s<e.length-n.length;s+=Hi.LENGTH){const o=s;i.push(new Hi(e.subarray(o,o+Hi.LENGTH)))}return new Tr(i,n)}},Vc=Tr;Vc.BITMAP_LEN=4;var na=class{static deserialize(t){const e=t.deserializeUleb128AsU32();switch(e){case 0:return Jc.load(t);case 1:return Zc.load(t);case 2:return cd.load(t);default:throw new Error(`Unknown variant index for TransactionAuthenticator: ${e}`)}}},Jc=class extends na{constructor(t,e){super(),this.public_key=t,this.signature=e}serialize(t){t.serializeU32AsUleb128(0),this.public_key.serialize(t),this.signature.serialize(t)}static load(t){const e=Ti.deserialize(t),n=Hi.deserialize(t);return new Jc(e,n)}},Zc=class extends na{constructor(t,e){super(),this.public_key=t,this.signature=e}serialize(t){t.serializeU32AsUleb128(1),this.public_key.serialize(t),this.signature.serialize(t)}static load(t){const e=ea.deserialize(t),n=Vc.deserialize(t);return new Zc(e,n)}},cd=class extends na{constructor(t,e,n){super(),this.sender=t,this.secondary_signer_addresses=e,this.secondary_signers=n}serialize(t){t.serializeU32AsUleb128(2),this.sender.serialize(t),pi(this.secondary_signer_addresses,t),pi(this.secondary_signers,t)}static load(t){const e=Mr.deserialize(t),n=Bi(t,yn),i=Bi(t,Mr);return new cd(e,n,i)}},Mr=class{static deserialize(t){const e=t.deserializeUleb128AsU32();switch(e){case 0:return ud.load(t);case 1:return ld.load(t);default:throw new Error(`Unknown variant index for AccountAuthenticator: ${e}`)}}},ud=class extends Mr{constructor(t,e){super(),this.public_key=t,this.signature=e}serialize(t){t.serializeU32AsUleb128(0),this.public_key.serialize(t),this.signature.serialize(t)}static load(t){const e=Ti.deserialize(t),n=Hi.deserialize(t);return new ud(e,n)}},ld=class extends Mr{constructor(t,e){super(),this.public_key=t,this.signature=e}serialize(t){t.serializeU32AsUleb128(1),this.public_key.serialize(t),this.signature.serialize(t)}static load(t){const e=ea.deserialize(t),n=Vc.deserialize(t);return new ld(e,n)}},ei=class{constructor(t){this.value=t}serialize(t){t.serializeStr(this.value)}static deserialize(t){const e=t.deserializeStr();return new ei(e)}},Hn=class{static deserialize(t){const e=t.deserializeUleb128AsU32();switch(e){case 0:return uo.load(t);case 1:return ns.load(t);case 2:return lo.load(t);case 3:return ho.load(t);case 4:return fo.load(t);case 5:return dd.load(t);case 6:return hr.load(t);case 7:return po.load(t);case 8:return ur.load(t);case 9:return lr.load(t);case 10:return dr.load(t);default:throw new Error(`Unknown variant index for TypeTag: ${e}`)}}},uo=class extends Hn{serialize(t){t.serializeU32AsUleb128(0)}static load(t){return new uo}},ns=class extends Hn{serialize(t){t.serializeU32AsUleb128(1)}static load(t){return new ns}},ur=class extends Hn{serialize(t){t.serializeU32AsUleb128(1)}static load(t){return new ur}},lr=class extends Hn{serialize(t){t.serializeU32AsUleb128(1)}static load(t){return new lr}},lo=class extends Hn{serialize(t){t.serializeU32AsUleb128(2)}static load(t){return new lo}},ho=class extends Hn{serialize(t){t.serializeU32AsUleb128(3)}static load(t){return new ho}},dr=class extends Hn{serialize(t){t.serializeU32AsUleb128(1)}static load(t){return new dr}},fo=class extends Hn{serialize(t){t.serializeU32AsUleb128(4)}static load(t){return new fo}},dd=class extends Hn{serialize(t){t.serializeU32AsUleb128(5)}static load(t){return new dd}},hr=class extends Hn{constructor(t){super(),this.value=t}serialize(t){t.serializeU32AsUleb128(6),this.value.serialize(t)}static load(t){const e=Hn.deserialize(t);return new hr(e)}},po=class extends Hn{constructor(t){super(),this.value=t}serialize(t){t.serializeU32AsUleb128(7),this.value.serialize(t)}static load(t){const e=Vo.deserialize(t);return new po(e)}isStringTypeTag(){return this.value.module_name.value==="string"&&this.value.name.value==="String"&&this.value.address.toHexString()===yn.fromHex("0x1").toHexString()}},Vo=class{constructor(t,e,n,i){this.address=t,this.module_name=e,this.name=n,this.type_args=i}static fromString(t){if(t.includes("<"))throw new Error("Not implemented");const e=t.split("::");if(e.length!==3)throw new Error("Invalid struct tag string literal.");return new Vo(yn.fromHex(e[0]),new ei(e[1]),new ei(e[2]),[])}serialize(t){this.address.serialize(t),this.module_name.serialize(t),this.name.serialize(t),pi(this.type_args,t)}static deserialize(t){const e=yn.deserialize(t),n=ei.deserialize(t),i=ei.deserialize(t),s=Bi(t,Hn);return new Vo(e,n,i,s)}},fr=class{constructor(t,e,n,i,s,o,r){this.sender=t,this.sequence_number=e,this.payload=n,this.max_gas_amount=i,this.gas_unit_price=s,this.expiration_timestamp_secs=o,this.chain_id=r}serialize(t){this.sender.serialize(t),t.serializeU64(this.sequence_number),this.payload.serialize(t),t.serializeU64(this.max_gas_amount),t.serializeU64(this.gas_unit_price),t.serializeU64(this.expiration_timestamp_secs),this.chain_id.serialize(t)}static deserialize(t){const e=yn.deserialize(t),n=t.deserializeU64(),i=oa.deserialize(t),s=t.deserializeU64(),o=t.deserializeU64(),r=t.deserializeU64(),a=tu.deserialize(t);return new fr(e,n,i,s,o,r,a)}},ia=class{constructor(t,e,n){this.code=t,this.ty_args=e,this.args=n}serialize(t){t.serializeBytes(this.code),pi(this.ty_args,t),pi(this.args,t)}static deserialize(t){const e=t.deserializeBytes(),n=Bi(t,Hn),i=Bi(t,Di);return new ia(e,n,i)}},Hs=class{constructor(t,e,n,i){this.module_name=t,this.function_name=e,this.ty_args=n,this.args=i}static natural(t,e,n,i){return new Hs(Js.fromStr(t),new ei(e),n,i)}static natual(t,e,n,i){return Hs.natural(t,e,n,i)}serialize(t){this.module_name.serialize(t),this.function_name.serialize(t),pi(this.ty_args,t),t.serializeU32AsUleb128(this.args.length),this.args.forEach(e=>{t.serializeBytes(e)})}static deserialize(t){const e=Js.deserialize(t),n=ei.deserialize(t),i=Bi(t,Hn),s=t.deserializeUleb128AsU32(),o=[];for(let a=0;a<s;a+=1)o.push(t.deserializeBytes());const r=o;return new Hs(e,n,i,r)}},hd=class{constructor(t){this.transaction_payload=t}serialize(t){t.serializeU32AsUleb128(0),this.transaction_payload.serialize(t)}static deserialize(t){return new hd(Hs.deserialize(t))}},fd=class{constructor(t,e){this.multisig_address=t,this.transaction_payload=e}serialize(t){this.multisig_address.serialize(t),this.transaction_payload===void 0?t.serializeBool(!1):(t.serializeBool(!0),this.transaction_payload.serialize(t))}static deserialize(t){const e=yn.deserialize(t),n=t.deserializeBool();let i;return n&&(i=hd.deserialize(t)),new fd(e,i)}},ug=class{constructor(t){this.code=t}serialize(t){t.serializeBytes(this.code)}static deserialize(t){const e=t.deserializeBytes();return new ug(e)}},Js=class{constructor(t,e){this.address=t,this.name=e}static fromStr(t){const e=t.split("::");if(e.length!==2)throw new Error("Invalid module id.");return new Js(yn.fromHex(new Ie(e[0])),new ei(e[1]))}serialize(t){this.address.serialize(t),this.name.serialize(t)}static deserialize(t){const e=yn.deserialize(t),n=ei.deserialize(t);return new Js(e,n)}},hv=class{serialize(t){throw new Error("Not implemented.")}static deserialize(t){throw new Error("Not implemented.")}},fv=class{serialize(t){throw new Error("Not implmented.")}static deserialize(t){throw new Error("Not implmented.")}},sa=class{constructor(t,e){this.raw_txn=t,this.authenticator=e}serialize(t){this.raw_txn.serialize(t),this.authenticator.serialize(t)}static deserialize(t){const e=fr.deserialize(t),n=na.deserialize(t);return new sa(e,n)}},lg=class{static deserialize(t){const e=t.deserializeUleb128AsU32();switch(e){case 0:return Yc.load(t);default:throw new Error(`Unknown variant index for RawTransactionWithData: ${e}`)}}},Yc=class extends lg{constructor(t,e){super(),this.raw_txn=t,this.secondary_signer_addresses=e}serialize(t){t.serializeU32AsUleb128(0),this.raw_txn.serialize(t),pi(this.secondary_signer_addresses,t)}static load(t){const e=fr.deserialize(t),n=Bi(t,yn);return new Yc(e,n)}},oa=class{static deserialize(t){const e=t.deserializeUleb128AsU32();switch(e){case 0:return ra.load(t);case 2:return Qc.load(t);case 3:return pd.load(t);default:throw new Error(`Unknown variant index for TransactionPayload: ${e}`)}}},ra=class extends oa{constructor(t){super(),this.value=t}serialize(t){t.serializeU32AsUleb128(0),this.value.serialize(t)}static load(t){const e=ia.deserialize(t);return new ra(e)}},Qc=class extends oa{constructor(t){super(),this.value=t}serialize(t){t.serializeU32AsUleb128(2),this.value.serialize(t)}static load(t){const e=Hs.deserialize(t);return new Qc(e)}},pd=class extends oa{constructor(t){super(),this.value=t}serialize(t){t.serializeU32AsUleb128(3),this.value.serialize(t)}static load(t){const e=fd.deserialize(t);return new pd(e)}},tu=class{constructor(t){this.value=t}serialize(t){t.serializeU8(this.value)}static deserialize(t){const e=t.deserializeU8();return new tu(e)}},Di=class{static deserialize(t){const e=t.deserializeUleb128AsU32();switch(e){case 0:return eu.load(t);case 1:return Jo.load(t);case 2:return su.load(t);case 3:return Zo.load(t);case 4:return Yo.load(t);case 5:return ru.load(t);case 6:return nu.load(t);case 7:return iu.load(t);case 8:return ou.load(t);default:throw new Error(`Unknown variant index for TransactionArgument: ${e}`)}}},eu=class extends Di{constructor(t){super(),this.value=t}serialize(t){t.serializeU32AsUleb128(0),t.serializeU8(this.value)}static load(t){const e=t.deserializeU8();return new eu(e)}},nu=class extends Di{constructor(t){super(),this.value=t}serialize(t){t.serializeU32AsUleb128(6),t.serializeU16(this.value)}static load(t){const e=t.deserializeU16();return new nu(e)}},iu=class extends Di{constructor(t){super(),this.value=t}serialize(t){t.serializeU32AsUleb128(7),t.serializeU32(this.value)}static load(t){const e=t.deserializeU32();return new iu(e)}},Jo=class extends Di{constructor(t){super(),this.value=t}serialize(t){t.serializeU32AsUleb128(1),t.serializeU64(this.value)}static load(t){const e=t.deserializeU64();return new Jo(e)}},su=class extends Di{constructor(t){super(),this.value=t}serialize(t){t.serializeU32AsUleb128(2),t.serializeU128(this.value)}static load(t){const e=t.deserializeU128();return new su(e)}},ou=class extends Di{constructor(t){super(),this.value=t}serialize(t){t.serializeU32AsUleb128(8),t.serializeU256(this.value)}static load(t){const e=t.deserializeU256();return new ou(e)}},Zo=class extends Di{constructor(t){super(),this.value=t}serialize(t){t.serializeU32AsUleb128(3),this.value.serialize(t)}static load(t){const e=yn.deserialize(t);return new Zo(e)}},Yo=class extends Di{constructor(t){super(),this.value=t}serialize(t){t.serializeU32AsUleb128(4),t.serializeBytes(this.value)}static load(t){const e=t.deserializeBytes();return new Yo(e)}},ru=class extends Di{constructor(t){super(),this.value=t}serialize(t){t.serializeU32AsUleb128(5),t.serializeBool(this.value)}static load(t){const e=t.deserializeBool();return new ru(e)}},dg=class{getHashSalt(){const t=Xo.create();return t.update("APTOS::Transaction"),t.digest()}static deserialize(t){const e=t.deserializeUleb128AsU32();switch(e){case 0:return gd.load(t);default:throw new Error(`Unknown variant index for Transaction: ${e}`)}}},gd=class extends dg{constructor(t){super(),this.value=t}hash(){const t=Xo.create();return t.update(this.getHashSalt()),t.update(is(this)),t.digest()}serialize(t){t.serializeU32AsUleb128(0),this.value.serialize(t)}static load(t){return new gd(sa.deserialize(t))}},aa=class{constructor(t){this.name=t}serialize(t){t.serializeStr(this.name)}static deserialize(t){const e=t.deserializeStr();return new aa(e)}},ca=class{constructor(t,e){this.name=t,this.type_tag=e}serialize(t){t.serializeStr(this.name),this.type_tag.serialize(t)}static deserialize(t){const e=t.deserializeStr(),n=Hn.deserialize(t);return new ca(e,n)}},au=class{static deserialize(t){const e=t.deserializeUleb128AsU32();switch(e){case 0:return cu.load(t);case 1:return Qo.load(t);default:throw new Error(`Unknown variant index for TransactionPayload: ${e}`)}}},cu=class extends au{constructor(t,e,n,i,s){super(),this.name=t,this.doc=e,this.code=n,this.ty_args=i,this.args=s}serialize(t){t.serializeU32AsUleb128(0),t.serializeStr(this.name),t.serializeStr(this.doc),t.serializeBytes(this.code),pi(this.ty_args,t),pi(this.args,t)}static load(t){const e=t.deserializeStr(),n=t.deserializeStr(),i=t.deserializeBytes(),s=Bi(t,aa),o=Bi(t,ca);return new cu(e,n,i,s,o)}},Qo=class extends au{constructor(t,e,n,i,s){super(),this.name=t,this.module_name=e,this.doc=n,this.ty_args=i,this.args=s}serialize(t){t.serializeU32AsUleb128(1),t.serializeStr(this.name),this.module_name.serialize(t),t.serializeStr(this.doc),pi(this.ty_args,t),pi(this.args,t)}static load(t){const e=t.deserializeStr(),n=Js.deserialize(t),i=t.deserializeStr(),s=Bi(t,aa),o=Bi(t,ca);return new Qo(e,n,i,s,o)}},Ao=class{constructor(t){if(t.length!==Ao.LENGTH)throw new Error("Expected a byte array of length 32");this.bytes=t}static fromMultiEd25519PublicKey(t){const e=t.toBytes(),n=new Uint8Array(e.length+1);n.set(e),n.set([Ao.MULTI_ED25519_SCHEME],e.length);const i=Xo.create();return i.update(n),new Ao(i.digest())}static fromEd25519PublicKey(t){const e=t.value,n=new Uint8Array(e.length+1);n.set(e),n.set([Ao.ED25519_SCHEME],e.length);const i=Xo.create();return i.update(n),new Ao(i.digest())}derivedAddress(){return Ie.fromUint8Array(this.bytes)}},Zs=Ao;Zs.LENGTH=32;Zs.MULTI_ED25519_SCHEME=1;Zs.ED25519_SCHEME=0;Zs.DERIVE_RESOURCE_ACCOUNT_SCHEME=255;var pv=class{constructor(t,e,n,i,s,o,r){this.accountAddress=t,this.moduleName=e,this.structName=n,this.sequenceNumber=i,this.originator=s,this.currentAuthKey=o,this.newPublicKey=r}serialize(t){this.accountAddress.serialize(t),t.serializeStr(this.moduleName),t.serializeStr(this.structName),t.serializeU64(this.sequenceNumber),this.originator.serialize(t),this.currentAuthKey.serialize(t),t.serializeBytes(this.newPublicKey)}},Ma=class{static fromAptosAccountObject(t){return new Ma(Ie.ensure(t.privateKeyHex).toUint8Array(),t.address)}static fromDerivePath(t,e){if(!Ma.isValidPath(t))throw new Error("Invalid derivation path");const n=e.trim().split(/\s+/).map(s=>s.toLowerCase()).join(" "),{key:i}=G1(t,Wp(Mp(n)));return new Ma(i)}constructor(t,e){t?this.signingKey=Xi.sign.keyPair.fromSeed(t.slice(0,32)):this.signingKey=Xi.sign.keyPair(),this.accountAddress=Ie.ensure(e||this.authKey().hex())}address(){return this.accountAddress}authKey(){const t=new Ti(this.signingKey.publicKey);return Zs.fromEd25519PublicKey(t).derivedAddress()}static getResourceAccountAddress(t,e){const n=is(yn.fromHex(t)),i=new Uint8Array([...n,...e,Zs.DERIVE_RESOURCE_ACCOUNT_SCHEME]),s=Xo.create();return s.update(i),Ie.fromUint8Array(s.digest())}pubKey(){return Ie.fromUint8Array(this.signingKey.publicKey)}signBuffer(t){const e=Xi.sign(t,this.signingKey.secretKey);return Ie.fromUint8Array(e.slice(0,64))}signHexString(t){const e=Ie.ensure(t).toUint8Array();return this.signBuffer(e)}toPrivateKeyObject(){return{address:this.address().hex(),publicKeyHex:this.pubKey().hex(),privateKeyHex:Ie.fromUint8Array(this.signingKey.secretKey.slice(0,32)).hex()}}},Dr=Ma;Dr.isValidPath=t=>!!/^m\/44'\/637'\/[0-9]+'\/[0-9]+'\/[0-9]+'+$/.test(t);cn([Xc()],Dr.prototype,"authKey",1);function tr(t){return t instanceof Dr?t.address():Ie.ensure(t)}var gv=`
    fragment TokenDataFields on current_token_datas {
  creator_address
  collection_name
  description
  metadata_uri
  name
  token_data_id_hash
  collection_data_id_hash
}
    `,_v=`
    fragment CollectionDataFields on current_collection_datas {
  metadata_uri
  supply
  description
  collection_name
  collection_data_id_hash
  table_handle
  creator_address
}
    `,mv=`
    query getAccountCurrentTokens($address: String!, $offset: Int, $limit: Int) {
  current_token_ownerships(
    where: {owner_address: {_eq: $address}, amount: {_gt: 0}}
    order_by: [{last_transaction_version: desc}, {creator_address: asc}, {collection_name: asc}, {name: asc}]
    offset: $offset
    limit: $limit
  ) {
    amount
    current_token_data {
      ...TokenDataFields
    }
    current_collection_data {
      ...CollectionDataFields
    }
    last_transaction_version
    property_version
  }
}
    ${gv}
${_v}`,yv=`
    query getTokenActivities($idHash: String!) {
  token_activities(where: {token_data_id_hash: {_eq: $idHash}}) {
    creator_address
    collection_name
    name
    token_data_id_hash
    collection_data_id_hash
    from_address
    to_address
    transaction_version
    transaction_timestamp
    property_version
    transfer_type
    event_sequence_number
    token_amount
  }
}
    `,hg=class{constructor(t){this.endpoint=t}async queryIndexer(t){const{data:e}=await Ws.post(this.endpoint,t);if(e.errors)throw new Error(`Indexer data error ${e.errors}`);return e.data}async getAccountNFTs(t,e){const n={query:mv,variables:{address:t,offset:e==null?void 0:e.offset,limit:e==null?void 0:e.limit}};return this.queryIndexer(n)}async getTokenActivities(t){const e={query:yv,variables:{idHash:t}};return this.queryIndexer(e)}},wv={};Wc(wv,{$AccountData:()=>$v,$AccountSignature:()=>qv,$AccountSignature_Ed25519Signature:()=>Mv,$AccountSignature_MultiEd25519Signature:()=>Dv,$Address:()=>Lv,$AptosError:()=>Nv,$AptosErrorCode:()=>Fv,$Block:()=>jv,$BlockMetadataTransaction:()=>zv,$DecodedTableData:()=>Hv,$DeleteModule:()=>Gv,$DeleteResource:()=>Wv,$DeleteTableItem:()=>Xv,$DeletedTableData:()=>Kv,$DirectWriteSet:()=>Vv,$Ed25519Signature:()=>Jv,$EncodeSubmissionRequest:()=>Zv,$EntryFunctionId:()=>Yv,$EntryFunctionPayload:()=>Qv,$Event:()=>tx,$EventGuid:()=>ex,$GasEstimation:()=>nx,$GenesisPayload:()=>ix,$GenesisPayload_WriteSetPayload:()=>sx,$GenesisTransaction:()=>ox,$HashValue:()=>rx,$HealthCheckSuccess:()=>ax,$HexEncodedBytes:()=>cx,$IdentifierWrapper:()=>ux,$IndexResponse:()=>lx,$ModuleBundlePayload:()=>dx,$MoveAbility:()=>hx,$MoveFunction:()=>fx,$MoveFunctionGenericTypeParam:()=>px,$MoveFunctionVisibility:()=>gx,$MoveModule:()=>_x,$MoveModuleBytecode:()=>mx,$MoveModuleId:()=>yx,$MoveResource:()=>wx,$MoveScriptBytecode:()=>bx,$MoveStruct:()=>vx,$MoveStructField:()=>xx,$MoveStructGenericTypeParam:()=>Tx,$MoveStructTag:()=>Ax,$MoveStructValue:()=>kx,$MoveType:()=>Sx,$MoveValue:()=>Px,$MultiAgentSignature:()=>Bx,$MultiEd25519Signature:()=>Ex,$MultisigPayload:()=>Cx,$MultisigTransactionPayload:()=>Ix,$PendingTransaction:()=>Ox,$RawTableItemRequest:()=>Rx,$RoleType:()=>Ux,$ScriptPayload:()=>$x,$ScriptWriteSet:()=>qx,$StateCheckpointTransaction:()=>Mx,$StateKeyWrapper:()=>Dx,$SubmitTransactionRequest:()=>Lx,$TableItemRequest:()=>Nx,$Transaction:()=>Fx,$TransactionPayload:()=>Wx,$TransactionPayload_EntryFunctionPayload:()=>Xx,$TransactionPayload_ModuleBundlePayload:()=>Vx,$TransactionPayload_MultisigPayload:()=>Jx,$TransactionPayload_ScriptPayload:()=>Zx,$TransactionSignature:()=>tT,$TransactionSignature_Ed25519Signature:()=>eT,$TransactionSignature_MultiAgentSignature:()=>nT,$TransactionSignature_MultiEd25519Signature:()=>iT,$Transaction_BlockMetadataTransaction:()=>jx,$Transaction_GenesisTransaction:()=>zx,$Transaction_PendingTransaction:()=>Hx,$Transaction_StateCheckpointTransaction:()=>Kx,$Transaction_UserTransaction:()=>Gx,$TransactionsBatchSingleSubmissionFailure:()=>Yx,$TransactionsBatchSubmissionResult:()=>Qx,$U128:()=>sT,$U256:()=>oT,$U64:()=>rT,$UserTransaction:()=>aT,$VersionedEvent:()=>cT,$ViewRequest:()=>uT,$WriteModule:()=>lT,$WriteResource:()=>dT,$WriteSet:()=>hT,$WriteSetChange:()=>gT,$WriteSetChange_DeleteModule:()=>_T,$WriteSetChange_DeleteResource:()=>mT,$WriteSetChange_DeleteTableItem:()=>yT,$WriteSetChange_WriteModule:()=>wT,$WriteSetChange_WriteResource:()=>bT,$WriteSetChange_WriteTableItem:()=>vT,$WriteSetPayload:()=>xT,$WriteSet_DirectWriteSet:()=>fT,$WriteSet_ScriptWriteSet:()=>pT,$WriteTableItem:()=>TT,AccountsService:()=>wg,ApiError:()=>Lr,AptosErrorCode:()=>Pg,AptosGeneratedClient:()=>Sg,BaseHttpRequest:()=>fg,BlocksService:()=>bg,CancelError:()=>pg,CancelablePromise:()=>gg,EventsService:()=>vg,GeneralService:()=>xg,MoveFunctionVisibility:()=>Bg,OpenAPI:()=>Uv,RoleType:()=>Eg,TablesService:()=>Tg,TransactionsService:()=>Ag,ViewService:()=>kg});var fg=class{constructor(t){this.config=t}},Lr=class extends Error{constructor(t,e,n){super(n),this.name="ApiError",this.url=e.url,this.status=e.status,this.statusText=e.statusText,this.body=e.body,this.request=t}},pg=class extends Error{constructor(t){super(t),this.name="CancelError"}get isCancelled(){return!0}},gg=class{constructor(t){this._isResolved=!1,this._isRejected=!1,this._isCancelled=!1,this._cancelHandlers=[],this._promise=new Promise((e,n)=>{this._resolve=e,this._reject=n;const i=r=>{var a;this._isResolved||this._isRejected||this._isCancelled||(this._isResolved=!0,(a=this._resolve)==null||a.call(this,r))},s=r=>{var a;this._isResolved||this._isRejected||this._isCancelled||(this._isRejected=!0,(a=this._reject)==null||a.call(this,r))},o=r=>{this._isResolved||this._isRejected||this._isCancelled||this._cancelHandlers.push(r)};return Object.defineProperty(o,"isResolved",{get:()=>this._isResolved}),Object.defineProperty(o,"isRejected",{get:()=>this._isRejected}),Object.defineProperty(o,"isCancelled",{get:()=>this._isCancelled}),t(i,s,o)})}then(t,e){return this._promise.then(t,e)}catch(t){return this._promise.catch(t)}finally(t){return this._promise.finally(t)}cancel(){var t;if(!(this._isResolved||this._isRejected||this._isCancelled)){if(this._isCancelled=!0,this._cancelHandlers.length)try{for(const e of this._cancelHandlers)e()}catch(e){console.warn("Cancellation threw an error",e);return}this._cancelHandlers.length=0,(t=this._reject)==null||t.call(this,new pg("Request aborted"))}}get isCancelled(){return this._isCancelled}},_g=class{constructor(t=new Map){this.jar=t}setCookie(t,e){var n;const i=t.origin.toLowerCase();this.jar.has(i)||this.jar.set(i,[]);const s=_g.parse(e);this.jar.set(i,[...((n=this.jar.get(i))==null?void 0:n.filter(o=>o.name!==s.name))||[],s])}getCookies(t){var e;const n=t.origin.toLowerCase();return this.jar.get(n)?((e=this.jar.get(n))==null?void 0:e.filter(i=>!i.expires||i.expires>new Date))||[]:[]}static parse(t){if(typeof t!="string")throw new Error("argument str must be a string");const e=t.split(";").map(i=>i.trim());let n;if(e.length>0){const[i,s]=e[0].split("=");if(!i||!s)throw new Error("Invalid cookie");n={name:i,value:s}}else throw new Error("Invalid cookie");return e.slice(1).forEach(i=>{const[s,o]=i.split("=");if(!s.trim())throw new Error("Invalid cookie");const r=s.toLowerCase(),a=(o==null?void 0:o.charAt(0))==="'"||(o==null?void 0:o.charAt(0))==='"'?o==null?void 0:o.slice(1,-1):o;if(r==="expires"&&(n.expires=new Date(a)),r==="path"&&(n.path=a),r==="samesite"){if(a!=="Lax"&&a!=="None"&&a!=="Strict")throw new Error("Invalid cookie SameSite value");n.sameSite=a}r==="secure"&&(n.secure=!0)}),n}},mg=new _g;Ws.interceptors.response.use(t=>(Array.isArray(t.headers["set-cookie"])&&t.headers["set-cookie"].forEach(e=>{mg.setCookie(new URL(t.config.url),e)}),t));Ws.interceptors.request.use(function(t){const e=mg.getCookies(new URL(t.url));return(e==null?void 0:e.length)>0&&t.headers&&(t.headers.cookie=e.map(n=>`${n.name}=${n.value}`).join("; ")),t});var _d=t=>t!=null,uu=t=>typeof t=="string",Nu=t=>uu(t)&&t!=="",yg=t=>typeof t=="object"&&typeof t.type=="string"&&typeof t.stream=="function"&&typeof t.arrayBuffer=="function"&&typeof t.constructor=="function"&&typeof t.constructor.name=="string"&&/^(Blob|File)$/.test(t.constructor.name)&&/^(Blob|File)$/.test(t[Symbol.toStringTag]),bv=t=>t instanceof ig,vv=t=>t>=200&&t<300,xv=t=>btoa(t),Tv=t=>{const e=[],n=(s,o)=>{e.push(`${encodeURIComponent(s)}=${encodeURIComponent(String(o))}`)},i=(s,o)=>{_d(o)&&(Array.isArray(o)?o.forEach(r=>{i(s,r)}):typeof o=="object"?Object.entries(o).forEach(([r,a])=>{i(`${s}[${r}]`,a)}):n(s,o))};return Object.entries(t).forEach(([s,o])=>{i(s,o)}),e.length>0?`?${e.join("&")}`:""},Av=(t,e)=>{const n=t.ENCODE_PATH||encodeURI,i=e.url.replace("{api-version}",t.VERSION).replace(/{(.*?)}/g,(o,r)=>{var a;return(a=e.path)!=null&&a.hasOwnProperty(r)?n(String(e.path[r])):o}),s=`${t.BASE}${i}`;return e.query?`${s}${Tv(e.query)}`:s},kv=t=>{if(t.formData){const e=new ig,n=(i,s)=>{uu(s)||yg(s)?e.append(i,s):e.append(i,JSON.stringify(s))};return Object.entries(t.formData).filter(([i,s])=>_d(s)).forEach(([i,s])=>{Array.isArray(s)?s.forEach(o=>n(i,o)):n(i,s)}),e}},ya=async(t,e)=>typeof e=="function"?e(t):e,Sv=async(t,e,n)=>{const i=await ya(e,t.TOKEN),s=await ya(e,t.USERNAME),o=await ya(e,t.PASSWORD),r=await ya(e,t.HEADERS),a=typeof(n==null?void 0:n.getHeaders)=="function"&&(n==null?void 0:n.getHeaders())||{},c=Object.entries({Accept:"application/json",...r,...e.headers,...a}).filter(([u,l])=>_d(l)).reduce((u,[l,d])=>({...u,[l]:String(d)}),{});if(Nu(i)&&(c.Authorization=`Bearer ${i}`),Nu(s)&&Nu(o)){const u=xv(`${s}:${o}`);c.Authorization=`Basic ${u}`}return e.body&&(e.mediaType?c["Content-Type"]=e.mediaType:yg(e.body)?c["Content-Type"]=e.body.type||"application/octet-stream":uu(e.body)?c["Content-Type"]="text/plain":bv(e.body)||(c["Content-Type"]="application/json")),c},Pv=t=>{if(t.body)return t.body},Bv=async(t,e,n,i,s,o,r)=>{const a=Ws.CancelToken.source(),c={url:n,headers:o,data:i??s,method:e.method,withCredentials:t.WITH_CREDENTIALS,cancelToken:a.token};Object.keys(t.HEADERS||{}).filter(l=>l.toLowerCase()==="accept").map(l=>t.HEADERS[l]).includes("application/x-bcs")&&(c.responseType="arraybuffer"),r(()=>a.cancel("The user aborted a request."));try{return await Ws.request(c)}catch(l){const d=l;if(d.response)return d.response;throw l}},Ev=(t,e)=>{if(e){const n=t.headers[e];if(uu(n))return n}},Cv=t=>{if(t.status!==204)return t.data},Iv=(t,e)=>{const i={400:"Bad Request",401:"Unauthorized",403:"Forbidden",404:"Not Found",429:"Too Many Requests",500:"Internal Server Error",502:"Bad Gateway",503:"Service Unavailable",...t.errors}[e.status];if(i)throw new Lr(t,e,i);if(!e.ok)throw new Lr(t,e,"Generic Error")},Ov=(t,e)=>new gg(async(n,i,s)=>{try{const o=Av(t,e),r=kv(e),a=Pv(e),c=await Sv(t,e,r);if(!s.isCancelled){const u=await Bv(t,e,o,a,r,c,s),l=Cv(u),d=Ev(u,e.responseHeader),f={url:o,ok:vv(u.status),status:u.status,statusText:u.statusText,body:d??l};Iv(e,f);const _=f.body;try{_.__headers=u.headers}catch{}n(_)}}catch(o){i(o)}}),Rv=class extends fg{constructor(t){super(t)}request(t){return Ov(this.config,t)}},wg=class{constructor(t){this.httpRequest=t}getAccount(t,e){return this.httpRequest.request({method:"GET",url:"/accounts/{address}",path:{address:t},query:{ledger_version:e}})}getAccountResources(t,e,n,i){return this.httpRequest.request({method:"GET",url:"/accounts/{address}/resources",path:{address:t},query:{ledger_version:e,start:n,limit:i}})}getAccountModules(t,e,n,i){return this.httpRequest.request({method:"GET",url:"/accounts/{address}/modules",path:{address:t},query:{ledger_version:e,start:n,limit:i}})}getAccountResource(t,e,n){return this.httpRequest.request({method:"GET",url:"/accounts/{address}/resource/{resource_type}",path:{address:t,resource_type:e},query:{ledger_version:n}})}getAccountModule(t,e,n){return this.httpRequest.request({method:"GET",url:"/accounts/{address}/module/{module_name}",path:{address:t,module_name:e},query:{ledger_version:n}})}},bg=class{constructor(t){this.httpRequest=t}getBlockByHeight(t,e){return this.httpRequest.request({method:"GET",url:"/blocks/by_height/{block_height}",path:{block_height:t},query:{with_transactions:e}})}getBlockByVersion(t,e){return this.httpRequest.request({method:"GET",url:"/blocks/by_version/{version}",path:{version:t},query:{with_transactions:e}})}},vg=class{constructor(t){this.httpRequest=t}getEventsByCreationNumber(t,e,n,i){return this.httpRequest.request({method:"GET",url:"/accounts/{address}/events/{creation_number}",path:{address:t,creation_number:e},query:{start:n,limit:i}})}getEventsByEventHandle(t,e,n,i,s){return this.httpRequest.request({method:"GET",url:"/accounts/{address}/events/{event_handle}/{field_name}",path:{address:t,event_handle:e,field_name:n},query:{start:i,limit:s}})}},xg=class{constructor(t){this.httpRequest=t}spec(){return this.httpRequest.request({method:"GET",url:"/spec"})}healthy(t){return this.httpRequest.request({method:"GET",url:"/-/healthy",query:{duration_secs:t}})}getLedgerInfo(){return this.httpRequest.request({method:"GET",url:"/"})}},Tg=class{constructor(t){this.httpRequest=t}getTableItem(t,e,n){return this.httpRequest.request({method:"POST",url:"/tables/{table_handle}/item",path:{table_handle:t},query:{ledger_version:n},body:e,mediaType:"application/json"})}getRawTableItem(t,e,n){return this.httpRequest.request({method:"POST",url:"/tables/{table_handle}/raw_item",path:{table_handle:t},query:{ledger_version:n},body:e,mediaType:"application/json"})}},Ag=class{constructor(t){this.httpRequest=t}getTransactions(t,e){return this.httpRequest.request({method:"GET",url:"/transactions",query:{start:t,limit:e}})}submitTransaction(t){return this.httpRequest.request({method:"POST",url:"/transactions",body:t,mediaType:"application/json"})}getTransactionByHash(t){return this.httpRequest.request({method:"GET",url:"/transactions/by_hash/{txn_hash}",path:{txn_hash:t}})}getTransactionByVersion(t){return this.httpRequest.request({method:"GET",url:"/transactions/by_version/{txn_version}",path:{txn_version:t}})}getAccountTransactions(t,e,n){return this.httpRequest.request({method:"GET",url:"/accounts/{address}/transactions",path:{address:t},query:{start:e,limit:n}})}submitBatchTransactions(t){return this.httpRequest.request({method:"POST",url:"/transactions/batch",body:t,mediaType:"application/json"})}simulateTransaction(t,e,n,i){return this.httpRequest.request({method:"POST",url:"/transactions/simulate",query:{estimate_max_gas_amount:e,estimate_gas_unit_price:n,estimate_prioritized_gas_unit_price:i},body:t,mediaType:"application/json"})}encodeSubmission(t){return this.httpRequest.request({method:"POST",url:"/transactions/encode_submission",body:t,mediaType:"application/json"})}estimateGasPrice(){return this.httpRequest.request({method:"GET",url:"/estimate_gas_price"})}},kg=class{constructor(t){this.httpRequest=t}view(t,e){return this.httpRequest.request({method:"POST",url:"/view",query:{ledger_version:e},body:t,mediaType:"application/json"})}},Sg=class{constructor(t,e=Rv){var n,i,s,o;this.request=new e({BASE:(n=t==null?void 0:t.BASE)!=null?n:"/v1",VERSION:(i=t==null?void 0:t.VERSION)!=null?i:"1.2.0",WITH_CREDENTIALS:(s=t==null?void 0:t.WITH_CREDENTIALS)!=null?s:!1,CREDENTIALS:(o=t==null?void 0:t.CREDENTIALS)!=null?o:"include",TOKEN:t==null?void 0:t.TOKEN,USERNAME:t==null?void 0:t.USERNAME,PASSWORD:t==null?void 0:t.PASSWORD,HEADERS:t==null?void 0:t.HEADERS,ENCODE_PATH:t==null?void 0:t.ENCODE_PATH}),this.accounts=new wg(this.request),this.blocks=new bg(this.request),this.events=new vg(this.request),this.general=new xg(this.request),this.tables=new Tg(this.request),this.transactions=new Ag(this.request),this.view=new kg(this.request)}},Uv={BASE:"/v1",VERSION:"1.2.0",WITH_CREDENTIALS:!1,CREDENTIALS:"include",TOKEN:void 0,USERNAME:void 0,PASSWORD:void 0,HEADERS:void 0,ENCODE_PATH:void 0},Pg=(t=>(t.ACCOUNT_NOT_FOUND="account_not_found",t.RESOURCE_NOT_FOUND="resource_not_found",t.MODULE_NOT_FOUND="module_not_found",t.STRUCT_FIELD_NOT_FOUND="struct_field_not_found",t.VERSION_NOT_FOUND="version_not_found",t.TRANSACTION_NOT_FOUND="transaction_not_found",t.TABLE_ITEM_NOT_FOUND="table_item_not_found",t.BLOCK_NOT_FOUND="block_not_found",t.VERSION_PRUNED="version_pruned",t.BLOCK_PRUNED="block_pruned",t.INVALID_INPUT="invalid_input",t.INVALID_TRANSACTION_UPDATE="invalid_transaction_update",t.SEQUENCE_NUMBER_TOO_OLD="sequence_number_too_old",t.VM_ERROR="vm_error",t.HEALTH_CHECK_FAILED="health_check_failed",t.MEMPOOL_IS_FULL="mempool_is_full",t.INTERNAL_ERROR="internal_error",t.WEB_FRAMEWORK_ERROR="web_framework_error",t.BCS_NOT_SUPPORTED="bcs_not_supported",t.API_DISABLED="api_disabled",t))(Pg||{}),Bg=(t=>(t.PRIVATE="private",t.PUBLIC="public",t.FRIEND="friend",t))(Bg||{}),Eg=(t=>(t.VALIDATOR="validator",t.FULL_NODE="full_node",t))(Eg||{}),$v={description:`Account data

    A simplified version of the onchain Account resource`,properties:{sequence_number:{type:"U64",isRequired:!0},authentication_key:{type:"HexEncodedBytes",isRequired:!0}}},qv={type:"one-of",description:`Account signature scheme

    The account signature scheme allows you to have two types of accounts:

    1. A single Ed25519 key account, one private key
    2. A k-of-n multi-Ed25519 key account, multiple private keys, such that k-of-n must sign a transaction.`,contains:[{type:"AccountSignature_Ed25519Signature"},{type:"AccountSignature_MultiEd25519Signature"}]},Mv={type:"all-of",contains:[{properties:{type:{type:"string",isRequired:!0}}},{type:"Ed25519Signature"}]},Dv={type:"all-of",contains:[{properties:{type:{type:"string",isRequired:!0}}},{type:"MultiEd25519Signature"}]},Lv={type:"string",description:`A hex encoded 32 byte Aptos account address.

    This is represented in a string as a 64 character hex string, sometimes
    shortened by stripping leading 0s, and adding a 0x.

    For example, address 0x0000000000000000000000000000000000000000000000000000000000000001 is represented as 0x1.
    `,format:"hex"},Nv={description:`This is the generic struct we use for all API errors, it contains a string
    message and an Aptos API specific error code.`,properties:{message:{type:"string",description:"A message describing the error",isRequired:!0},error_code:{type:"AptosErrorCode",isRequired:!0},vm_error_code:{type:"number",description:"A code providing VM error details when submitting transactions to the VM",format:"uint64"}}},Fv={type:"Enum"},jv={description:`A Block with or without transactions

    This contains the information about a transactions along with
    associated transactions if requested`,properties:{block_height:{type:"U64",isRequired:!0},block_hash:{type:"HashValue",isRequired:!0},block_timestamp:{type:"U64",isRequired:!0},first_version:{type:"U64",isRequired:!0},last_version:{type:"U64",isRequired:!0},transactions:{type:"array",contains:{type:"Transaction"}}}},zv={description:`A block metadata transaction

    This signifies the beginning of a block, and contains information
    about the specific block`,properties:{version:{type:"U64",isRequired:!0},hash:{type:"HashValue",isRequired:!0},state_change_hash:{type:"HashValue",isRequired:!0},event_root_hash:{type:"HashValue",isRequired:!0},state_checkpoint_hash:{type:"HashValue"},gas_used:{type:"U64",isRequired:!0},success:{type:"boolean",description:"Whether the transaction was successful",isRequired:!0},vm_status:{type:"string",description:"The VM status of the transaction, can tell useful information in a failure",isRequired:!0},accumulator_root_hash:{type:"HashValue",isRequired:!0},changes:{type:"array",contains:{type:"WriteSetChange"},isRequired:!0},id:{type:"HashValue",isRequired:!0},epoch:{type:"U64",isRequired:!0},round:{type:"U64",isRequired:!0},events:{type:"array",contains:{type:"Event"},isRequired:!0},previous_block_votes_bitvec:{type:"array",contains:{type:"number",format:"uint8"},isRequired:!0},proposer:{type:"Address",isRequired:!0},failed_proposer_indices:{type:"array",contains:{type:"number",format:"uint32"},isRequired:!0},timestamp:{type:"U64",isRequired:!0}}},Hv={description:"Decoded table data",properties:{key:{description:"Key of table in JSON",properties:{},isRequired:!0},key_type:{type:"string",description:"Type of key",isRequired:!0},value:{description:"Value of table in JSON",properties:{},isRequired:!0},value_type:{type:"string",description:"Type of value",isRequired:!0}}},Kv={description:"Deleted table data",properties:{key:{description:"Deleted key",properties:{},isRequired:!0},key_type:{type:"string",description:"Deleted key type",isRequired:!0}}},Gv={description:"Delete a module",properties:{address:{type:"Address",isRequired:!0},state_key_hash:{type:"string",description:"State key hash",isRequired:!0},module:{type:"MoveModuleId",isRequired:!0}}},Wv={description:"Delete a resource",properties:{address:{type:"Address",isRequired:!0},state_key_hash:{type:"string",description:"State key hash",isRequired:!0},resource:{type:"MoveStructTag",isRequired:!0}}},Xv={description:"Delete a table item",properties:{state_key_hash:{type:"string",isRequired:!0},handle:{type:"HexEncodedBytes",isRequired:!0},key:{type:"HexEncodedBytes",isRequired:!0},data:{type:"DeletedTableData"}}},Vv={properties:{changes:{type:"array",contains:{type:"WriteSetChange"},isRequired:!0},events:{type:"array",contains:{type:"Event"},isRequired:!0}}},Jv={description:"A single Ed25519 signature",properties:{public_key:{type:"HexEncodedBytes",isRequired:!0},signature:{type:"HexEncodedBytes",isRequired:!0}}},Zv={description:"Request to encode a submission",properties:{sender:{type:"Address",isRequired:!0},sequence_number:{type:"U64",isRequired:!0},max_gas_amount:{type:"U64",isRequired:!0},gas_unit_price:{type:"U64",isRequired:!0},expiration_timestamp_secs:{type:"U64",isRequired:!0},payload:{type:"TransactionPayload",isRequired:!0},secondary_signers:{type:"array",contains:{type:"Address"}}}},Yv={type:"string",description:"Entry function id is string representation of a entry function defined on-chain.\n\n    Format: `{address}::{module name}::{function name}`\n\n    Both `module name` and `function name` are case-sensitive.\n    "},Qv={description:"Payload which runs a single entry function",properties:{function:{type:"EntryFunctionId",isRequired:!0},type_arguments:{type:"array",contains:{type:"MoveType"},isRequired:!0},arguments:{type:"array",contains:{properties:{}},isRequired:!0}}},tx={description:"An event from a transaction",properties:{guid:{type:"EventGuid",isRequired:!0},sequence_number:{type:"U64",isRequired:!0},type:{type:"MoveType",isRequired:!0},data:{description:"The JSON representation of the event",properties:{},isRequired:!0}}},ex={properties:{creation_number:{type:"U64",isRequired:!0},account_address:{type:"Address",isRequired:!0}}},nx={description:"Struct holding the outputs of the estimate gas API",properties:{deprioritized_gas_estimate:{type:"number",description:"The deprioritized estimate for the gas unit price",format:"uint64"},gas_estimate:{type:"number",description:"The current estimate for the gas unit price",isRequired:!0,format:"uint64"},prioritized_gas_estimate:{type:"number",description:"The prioritized estimate for the gas unit price",format:"uint64"}}},ix={type:"one-of",description:"The writeset payload of the Genesis transaction",contains:[{type:"GenesisPayload_WriteSetPayload"}]},sx={type:"all-of",contains:[{properties:{type:{type:"string",isRequired:!0}}},{type:"WriteSetPayload"}]},ox={description:`The genesis transaction

    This only occurs at the genesis transaction (version 0)`,properties:{version:{type:"U64",isRequired:!0},hash:{type:"HashValue",isRequired:!0},state_change_hash:{type:"HashValue",isRequired:!0},event_root_hash:{type:"HashValue",isRequired:!0},state_checkpoint_hash:{type:"HashValue"},gas_used:{type:"U64",isRequired:!0},success:{type:"boolean",description:"Whether the transaction was successful",isRequired:!0},vm_status:{type:"string",description:"The VM status of the transaction, can tell useful information in a failure",isRequired:!0},accumulator_root_hash:{type:"HashValue",isRequired:!0},changes:{type:"array",contains:{type:"WriteSetChange"},isRequired:!0},payload:{type:"GenesisPayload",isRequired:!0},events:{type:"array",contains:{type:"Event"},isRequired:!0}}},rx={type:"string"},ax={description:"Representation of a successful healthcheck",properties:{message:{type:"string",isRequired:!0}}},cx={type:"string",description:"All bytes (Vec<u8>) data is represented as hex-encoded string prefixed with `0x` and fulfilled with\n    two hex digits per byte.\n\n    Unlike the `Address` type, HexEncodedBytes will not trim any zeros.\n    ",format:"hex"},ux={type:"string"},lx={description:`The struct holding all data returned to the client by the
    index endpoint (i.e., GET "/").  Only for responding in JSON`,properties:{chain_id:{type:"number",description:"Chain ID of the current chain",isRequired:!0,format:"uint8"},epoch:{type:"U64",isRequired:!0},ledger_version:{type:"U64",isRequired:!0},oldest_ledger_version:{type:"U64",isRequired:!0},ledger_timestamp:{type:"U64",isRequired:!0},node_role:{type:"RoleType",isRequired:!0},oldest_block_height:{type:"U64",isRequired:!0},block_height:{type:"U64",isRequired:!0},git_hash:{type:"string",description:`Git hash of the build of the API endpoint.  Can be used to determine the exact
            software version used by the API endpoint.`}}},dx={properties:{modules:{type:"array",contains:{type:"MoveModuleBytecode"},isRequired:!0}}},hx={type:"string"},fx={description:"Move function",properties:{name:{type:"IdentifierWrapper",isRequired:!0},visibility:{type:"MoveFunctionVisibility",isRequired:!0},is_entry:{type:"boolean",description:"Whether the function can be called as an entry function directly in a transaction",isRequired:!0},generic_type_params:{type:"array",contains:{type:"MoveFunctionGenericTypeParam"},isRequired:!0},params:{type:"array",contains:{type:"MoveType"},isRequired:!0},return:{type:"array",contains:{type:"MoveType"},isRequired:!0}}},px={description:"Move function generic type param",properties:{constraints:{type:"array",contains:{type:"MoveAbility"},isRequired:!0}}},gx={type:"Enum"},_x={description:"A Move module",properties:{address:{type:"Address",isRequired:!0},name:{type:"IdentifierWrapper",isRequired:!0},friends:{type:"array",contains:{type:"MoveModuleId"},isRequired:!0},exposed_functions:{type:"array",contains:{type:"MoveFunction"},isRequired:!0},structs:{type:"array",contains:{type:"MoveStruct"},isRequired:!0}}},mx={description:"Move module bytecode along with it's ABI",properties:{bytecode:{type:"HexEncodedBytes",isRequired:!0},abi:{type:"MoveModule"}}},yx={type:"string",description:`Move module id is a string representation of Move module.

    Format: \`{address}::{module name}\`

    \`address\` should be hex-encoded 32 byte account address that is prefixed with \`0x\`.

    Module name is case-sensitive.
    `},wx={description:"A parsed Move resource",properties:{type:{type:"MoveStructTag",isRequired:!0},data:{type:"MoveStructValue",isRequired:!0}}},bx={description:"Move script bytecode",properties:{bytecode:{type:"HexEncodedBytes",isRequired:!0},abi:{type:"MoveFunction"}}},vx={description:"A move struct",properties:{name:{type:"IdentifierWrapper",isRequired:!0},is_native:{type:"boolean",description:"Whether the struct is a native struct of Move",isRequired:!0},abilities:{type:"array",contains:{type:"MoveAbility"},isRequired:!0},generic_type_params:{type:"array",contains:{type:"MoveStructGenericTypeParam"},isRequired:!0},fields:{type:"array",contains:{type:"MoveStructField"},isRequired:!0}}},xx={description:"Move struct field",properties:{name:{type:"IdentifierWrapper",isRequired:!0},type:{type:"MoveType",isRequired:!0}}},Tx={description:"Move generic type param",properties:{constraints:{type:"array",contains:{type:"MoveAbility"},isRequired:!0}}},Ax={type:"string",description:"String representation of a MoveStructTag (on-chain Move struct type). This exists so you\n    can specify MoveStructTags as path / query parameters, e.g. for get_events_by_event_handle.\n\n    It is a combination of:\n    1. `move_module_address`, `module_name` and `struct_name`, all joined by `::`\n    2. `struct generic type parameters` joined by `, `\n\n    Examples:\n     * `0x1::coin::CoinStore<0x1::aptos_coin::AptosCoin>`\n     * `0x1::account::Account`\n\n    Note:\n    1. Empty chars should be ignored when comparing 2 struct tag ids.\n    2. When used in an URL path, should be encoded by url-encoding (AKA percent-encoding).\n\n    See [doc](https://aptos.dev/concepts/accounts) for more details.\n    ",pattern:"^0x[0-9a-zA-Z:_<>]+$"},kx={description:'This is a JSON representation of some data within an account resource. More specifically,\n    it is a map of strings to arbitrary JSON values / objects, where the keys are top level\n    fields within the given resource.\n\n    To clarify, you might query for 0x1::account::Account and see the example data.\n\n    Move `bool` type value is serialized into `boolean`.\n\n    Move `u8`, `u16` and `u32` type value is serialized into `integer`.\n\n    Move `u64`, `u128` and `u256` type value is serialized into `string`.\n\n    Move `address` type value (32 byte Aptos account address) is serialized into a HexEncodedBytes string.\n    For example:\n    - `0x1`\n    - `0x1668f6be25668c1a17cd8caf6b8d2f25`\n\n    Move `vector` type value is serialized into `array`, except `vector<u8>` which is serialized into a\n    HexEncodedBytes string with `0x` prefix.\n    For example:\n    - `vector<u64>{255, 255}` => `["255", "255"]`\n    - `vector<u8>{255, 255}` => `0xffff`\n\n    Move `struct` type value is serialized into `object` that looks like this (except some Move stdlib types, see the following section):\n    ```json\n    {\n        field1_name: field1_value,\n        field2_name: field2_value,\n        ......\n    }\n    ```\n\n    For example:\n    `{ "created": "0xa550c18", "role_id": "0" }`\n\n     **Special serialization for Move stdlib types**:\n    - [0x1::string::String](https://github.com/aptos-labs/aptos-core/blob/main/language/move-stdlib/docs/ascii.md)\n    is serialized into `string`. For example, struct value `0x1::string::String{bytes: b"Hello World!"}`\n    is serialized as `"Hello World!"` in JSON.\n    ',properties:{}},Sx={type:"string",description:`String representation of an on-chain Move type tag that is exposed in transaction payload.
    Values:
    - bool
    - u8
    - u16
    - u32
    - u64
    - u128
    - u256
    - address
    - signer
    - vector: \`vector<{non-reference MoveTypeId}>\`
    - struct: \`{address}::{module_name}::{struct_name}::<{generic types}>\`

    Vector type value examples:
    - \`vector<u8>\`
    - \`vector<vector<u64>>\`
    - \`vector<0x1::coin::CoinStore<0x1::aptos_coin::AptosCoin>>\`

    Struct type value examples:
    - \`0x1::coin::CoinStore<0x1::aptos_coin::AptosCoin>
    - \`0x1::account::Account\`

    Note:
    1. Empty chars should be ignored when comparing 2 struct tag ids.
    2. When used in an URL path, should be encoded by url-encoding (AKA percent-encoding).
    `,pattern:"^(bool|u8|u64|u128|address|signer|vector<.+>|0x[0-9a-zA-Z:_<, >]+)$"},Px={type:"any-of",description:"An enum of the possible Move value types",contains:[{type:"number",format:"uint8"},{type:"number",format:"uint16"},{type:"number",format:"uint32"},{type:"U64"},{type:"U128"},{type:"U256"},{type:"boolean"},{type:"Address"},{type:"array",contains:{type:"MoveValue"}},{type:"HexEncodedBytes"},{type:"MoveStructValue"},{type:"string"}]},Bx={description:`Multi agent signature for multi agent transactions

    This allows you to have transactions across multiple accounts`,properties:{sender:{type:"AccountSignature",isRequired:!0},secondary_signer_addresses:{type:"array",contains:{type:"Address"},isRequired:!0},secondary_signers:{type:"array",contains:{type:"AccountSignature"},isRequired:!0}}},Ex={description:`A Ed25519 multi-sig signature

    This allows k-of-n signing for a transaction`,properties:{public_keys:{type:"array",contains:{type:"HexEncodedBytes"},isRequired:!0},signatures:{type:"array",contains:{type:"HexEncodedBytes"},isRequired:!0},threshold:{type:"number",description:"The number of signatures required for a successful transaction",isRequired:!0,format:"uint8"},bitmap:{type:"HexEncodedBytes",isRequired:!0}}},Cx={description:`A multisig transaction that allows an owner of a multisig account to execute a pre-approved
    transaction as the multisig account.`,properties:{multisig_address:{type:"Address",isRequired:!0},transaction_payload:{type:"MultisigTransactionPayload"}}},Ix={type:"any-of",contains:[{type:"EntryFunctionPayload"}]},Ox={description:"A transaction waiting in mempool",properties:{hash:{type:"HashValue",isRequired:!0},sender:{type:"Address",isRequired:!0},sequence_number:{type:"U64",isRequired:!0},max_gas_amount:{type:"U64",isRequired:!0},gas_unit_price:{type:"U64",isRequired:!0},expiration_timestamp_secs:{type:"U64",isRequired:!0},payload:{type:"TransactionPayload",isRequired:!0},signature:{type:"TransactionSignature"}}},Rx={description:"Table Item request for the GetTableItemRaw API",properties:{key:{type:"HexEncodedBytes",isRequired:!0}}},Ux={type:"Enum"},$x={description:"Payload which runs a script that can run multiple functions",properties:{code:{type:"MoveScriptBytecode",isRequired:!0},type_arguments:{type:"array",contains:{type:"MoveType"},isRequired:!0},arguments:{type:"array",contains:{properties:{}},isRequired:!0}}},qx={properties:{execute_as:{type:"Address",isRequired:!0},script:{type:"ScriptPayload",isRequired:!0}}},Mx={description:"A state checkpoint transaction",properties:{version:{type:"U64",isRequired:!0},hash:{type:"HashValue",isRequired:!0},state_change_hash:{type:"HashValue",isRequired:!0},event_root_hash:{type:"HashValue",isRequired:!0},state_checkpoint_hash:{type:"HashValue"},gas_used:{type:"U64",isRequired:!0},success:{type:"boolean",description:"Whether the transaction was successful",isRequired:!0},vm_status:{type:"string",description:"The VM status of the transaction, can tell useful information in a failure",isRequired:!0},accumulator_root_hash:{type:"HashValue",isRequired:!0},changes:{type:"array",contains:{type:"WriteSetChange"},isRequired:!0},timestamp:{type:"U64",isRequired:!0}}},Dx={type:"string",description:`Representation of a StateKey as a hex string. This is used for cursor based pagination.
    `},Lx={description:`A request to submit a transaction

    This requires a transaction and a signature of it`,properties:{sender:{type:"Address",isRequired:!0},sequence_number:{type:"U64",isRequired:!0},max_gas_amount:{type:"U64",isRequired:!0},gas_unit_price:{type:"U64",isRequired:!0},expiration_timestamp_secs:{type:"U64",isRequired:!0},payload:{type:"TransactionPayload",isRequired:!0},signature:{type:"TransactionSignature",isRequired:!0}}},Nx={description:"Table Item request for the GetTableItem API",properties:{key_type:{type:"MoveType",isRequired:!0},value_type:{type:"MoveType",isRequired:!0},key:{description:"The value of the table item's key",properties:{},isRequired:!0}}},Fx={type:"one-of",description:"Enum of the different types of transactions in Aptos",contains:[{type:"Transaction_PendingTransaction"},{type:"Transaction_UserTransaction"},{type:"Transaction_GenesisTransaction"},{type:"Transaction_BlockMetadataTransaction"},{type:"Transaction_StateCheckpointTransaction"}]},jx={type:"all-of",contains:[{properties:{type:{type:"string",isRequired:!0}}},{type:"BlockMetadataTransaction"}]},zx={type:"all-of",contains:[{properties:{type:{type:"string",isRequired:!0}}},{type:"GenesisTransaction"}]},Hx={type:"all-of",contains:[{properties:{type:{type:"string",isRequired:!0}}},{type:"PendingTransaction"}]},Kx={type:"all-of",contains:[{properties:{type:{type:"string",isRequired:!0}}},{type:"StateCheckpointTransaction"}]},Gx={type:"all-of",contains:[{properties:{type:{type:"string",isRequired:!0}}},{type:"UserTransaction"}]},Wx={type:"one-of",description:"An enum of the possible transaction payloads",contains:[{type:"TransactionPayload_EntryFunctionPayload"},{type:"TransactionPayload_ScriptPayload"},{type:"TransactionPayload_ModuleBundlePayload"},{type:"TransactionPayload_MultisigPayload"}]},Xx={type:"all-of",contains:[{properties:{type:{type:"string",isRequired:!0}}},{type:"EntryFunctionPayload"}]},Vx={type:"all-of",contains:[{properties:{type:{type:"string",isRequired:!0}}},{type:"ModuleBundlePayload"}]},Jx={type:"all-of",contains:[{properties:{type:{type:"string",isRequired:!0}}},{type:"MultisigPayload"}]},Zx={type:"all-of",contains:[{properties:{type:{type:"string",isRequired:!0}}},{type:"ScriptPayload"}]},Yx={description:"Information telling which batch submission transactions failed",properties:{error:{type:"AptosError",isRequired:!0},transaction_index:{type:"number",description:"The index of which transaction failed, same as submission order",isRequired:!0,format:"uint64"}}},Qx={description:`Batch transaction submission result

    Tells which transactions failed`,properties:{transaction_failures:{type:"array",contains:{type:"TransactionsBatchSingleSubmissionFailure"},isRequired:!0}}},tT={type:"one-of",description:"An enum representing the different transaction signatures available",contains:[{type:"TransactionSignature_Ed25519Signature"},{type:"TransactionSignature_MultiEd25519Signature"},{type:"TransactionSignature_MultiAgentSignature"}]},eT={type:"all-of",contains:[{properties:{type:{type:"string",isRequired:!0}}},{type:"Ed25519Signature"}]},nT={type:"all-of",contains:[{properties:{type:{type:"string",isRequired:!0}}},{type:"MultiAgentSignature"}]},iT={type:"all-of",contains:[{properties:{type:{type:"string",isRequired:!0}}},{type:"MultiEd25519Signature"}]},sT={type:"string",description:`A string containing a 128-bit unsigned integer.

    We represent u128 values as a string to ensure compatibility with languages such
    as JavaScript that do not parse u128s in JSON natively.
    `,format:"uint128"},oT={type:"string",description:`A string containing a 256-bit unsigned integer.

    We represent u256 values as a string to ensure compatibility with languages such
    as JavaScript that do not parse u256s in JSON natively.
    `,format:"uint256"},rT={type:"string",description:`A string containing a 64-bit unsigned integer.

    We represent u64 values as a string to ensure compatibility with languages such
    as JavaScript that do not parse u64s in JSON natively.
    `,format:"uint64"},aT={description:"A transaction submitted by a user to change the state of the blockchain",properties:{version:{type:"U64",isRequired:!0},hash:{type:"HashValue",isRequired:!0},state_change_hash:{type:"HashValue",isRequired:!0},event_root_hash:{type:"HashValue",isRequired:!0},state_checkpoint_hash:{type:"HashValue"},gas_used:{type:"U64",isRequired:!0},success:{type:"boolean",description:"Whether the transaction was successful",isRequired:!0},vm_status:{type:"string",description:"The VM status of the transaction, can tell useful information in a failure",isRequired:!0},accumulator_root_hash:{type:"HashValue",isRequired:!0},changes:{type:"array",contains:{type:"WriteSetChange"},isRequired:!0},sender:{type:"Address",isRequired:!0},sequence_number:{type:"U64",isRequired:!0},max_gas_amount:{type:"U64",isRequired:!0},gas_unit_price:{type:"U64",isRequired:!0},expiration_timestamp_secs:{type:"U64",isRequired:!0},payload:{type:"TransactionPayload",isRequired:!0},signature:{type:"TransactionSignature"},events:{type:"array",contains:{type:"Event"},isRequired:!0},timestamp:{type:"U64",isRequired:!0}}},cT={description:"An event from a transaction with a version",properties:{version:{type:"U64",isRequired:!0},guid:{type:"EventGuid",isRequired:!0},sequence_number:{type:"U64",isRequired:!0},type:{type:"MoveType",isRequired:!0},data:{description:"The JSON representation of the event",properties:{},isRequired:!0}}},uT={description:"View request for the Move View Function API",properties:{function:{type:"EntryFunctionId",isRequired:!0},type_arguments:{type:"array",contains:{type:"MoveType"},isRequired:!0},arguments:{type:"array",contains:{properties:{}},isRequired:!0}}},lT={description:"Write a new module or update an existing one",properties:{address:{type:"Address",isRequired:!0},state_key_hash:{type:"string",description:"State key hash",isRequired:!0},data:{type:"MoveModuleBytecode",isRequired:!0}}},dT={description:"Write a resource or update an existing one",properties:{address:{type:"Address",isRequired:!0},state_key_hash:{type:"string",description:"State key hash",isRequired:!0},data:{type:"MoveResource",isRequired:!0}}},hT={type:"one-of",description:"The associated writeset with a payload",contains:[{type:"WriteSet_ScriptWriteSet"},{type:"WriteSet_DirectWriteSet"}]},fT={type:"all-of",contains:[{properties:{type:{type:"string",isRequired:!0}}},{type:"DirectWriteSet"}]},pT={type:"all-of",contains:[{properties:{type:{type:"string",isRequired:!0}}},{type:"ScriptWriteSet"}]},gT={type:"one-of",description:"A final state change of a transaction on a resource or module",contains:[{type:"WriteSetChange_DeleteModule"},{type:"WriteSetChange_DeleteResource"},{type:"WriteSetChange_DeleteTableItem"},{type:"WriteSetChange_WriteModule"},{type:"WriteSetChange_WriteResource"},{type:"WriteSetChange_WriteTableItem"}]},_T={type:"all-of",contains:[{properties:{type:{type:"string",isRequired:!0}}},{type:"DeleteModule"}]},mT={type:"all-of",contains:[{properties:{type:{type:"string",isRequired:!0}}},{type:"DeleteResource"}]},yT={type:"all-of",contains:[{properties:{type:{type:"string",isRequired:!0}}},{type:"DeleteTableItem"}]},wT={type:"all-of",contains:[{properties:{type:{type:"string",isRequired:!0}}},{type:"WriteModule"}]},bT={type:"all-of",contains:[{properties:{type:{type:"string",isRequired:!0}}},{type:"WriteResource"}]},vT={type:"all-of",contains:[{properties:{type:{type:"string",isRequired:!0}}},{type:"WriteTableItem"}]},xT={description:"A writeset payload, used only for genesis",properties:{write_set:{type:"WriteSet",isRequired:!0}}},TT={description:"Change set to write a table item",properties:{state_key_hash:{type:"string",isRequired:!0},handle:{type:"HexEncodedBytes",isRequired:!0},key:{type:"HexEncodedBytes",isRequired:!0},value:{type:"HexEncodedBytes",isRequired:!0},data:{type:"DecodedTableData"}}},AT=new Vo(yn.fromHex("0x1"),new ei("string"),new ei("String"),[]);function lu(t,e,n){if(!(e!=null&&e.includes(typeof t)))throw new Error(n||`Invalid arg: ${t} type should be ${e instanceof Array?e.join(" or "):e}`)}function Rs(t){throw new Error(t)}function ah(t){return!!t.match(/\s/)}function ch(t){return!!t.match(/[_A-Za-z0-9]/g)}function kT(t,e){const n=t[e];if(n===":"){if(t.slice(e,e+2)==="::")return[["COLON","::"],2];Rs("Unrecognized token.")}else{if(n==="<")return[["LT","<"],1];if(n===">")return[["GT",">"],1];if(n===",")return[["COMMA",","],1];if(ah(n)){let i="";for(let s=e;s<t.length;s+=1){const o=t[s];if(ah(o))i=`${i}${o}`;else break}return[["SPACE",i],i.length]}else if(ch(n)){let i="";for(let s=e;s<t.length;s+=1){const o=t[s];if(ch(o))i=`${i}${o}`;else break}return[["IDENT",i],i.length]}}throw new Error("Unrecognized token.")}function ST(t){let e=0;const n=[];for(;e<t.length;){const[i,s]=kT(t,e);i[0]!=="SPACE"&&n.push(i),e+=s}return n}var du=class{constructor(t){this.tokens=ST(t)}consume(t){const e=this.tokens.shift();(!e||e[1]!==t)&&Rs("Invalid type tag.")}parseCommaList(t,e){const n=[];for(this.tokens.length<=0&&Rs("Invalid type tag.");this.tokens[0][1]!==t&&(n.push(this.parseTypeTag()),!(this.tokens.length>0&&this.tokens[0][1]===t||(this.consume(","),this.tokens.length>0&&this.tokens[0][1]===t&&e)));)this.tokens.length<=0&&Rs("Invalid type tag.");return n}parseTypeTag(){this.tokens.length===0&&Rs("Invalid type tag.");const[t,e]=this.tokens.shift();if(e==="u8")return new ns;if(e==="u16")return new ur;if(e==="u32")return new lr;if(e==="u64")return new lo;if(e==="u128")return new ho;if(e==="u256")return new dr;if(e==="bool")return new uo;if(e==="address")return new fo;if(e==="vector"){this.consume("<");const n=this.parseTypeTag();return this.consume(">"),new hr(n)}if(t==="IDENT"&&(e.startsWith("0x")||e.startsWith("0X"))){const n=e;this.consume("::");const[i,s]=this.tokens.shift();i!=="IDENT"&&Rs("Invalid type tag."),this.consume("::");const[o,r]=this.tokens.shift();o!=="IDENT"&&Rs("Invalid type tag.");let a=[];this.tokens.length>0&&this.tokens[0][1]==="<"&&(this.consume("<"),a=this.parseCommaList(">",!0),this.consume(">"));const c=new Vo(yn.fromHex(n),new ei(s),new ei(r),a);return new po(c)}throw new Error("Invalid type tag.")}};function Cg(t){if(lu(t,["boolean","string"]),typeof t=="boolean")return t;if(t==="true")return!0;if(t==="false")return!1;throw new Error("Invalid boolean string.")}function qo(t){if(lu(t,["number","string"]),typeof t=="number")return t;const e=Number.parseInt(t,10);if(Number.isNaN(e))throw new Error("Invalid number string.");return e}function Mo(t){return lu(t,["number","bigint","string"]),BigInt(t)}function md(t,e,n){if(e instanceof uo){n.serializeBool(Cg(t));return}if(e instanceof ns){n.serializeU8(qo(t));return}if(e instanceof ur){n.serializeU16(qo(t));return}if(e instanceof lr){n.serializeU32(qo(t));return}if(e instanceof lo){n.serializeU64(Mo(t));return}if(e instanceof ho){n.serializeU128(Mo(t));return}if(e instanceof dr){n.serializeU256(Mo(t));return}if(e instanceof fo){let i;if(typeof t=="string"||t instanceof Ie)i=yn.fromHex(t);else if(t instanceof yn)i=t;else throw new Error("Invalid account address.");i.serialize(n);return}if(e instanceof hr){if(e.value instanceof ns){if(t instanceof Uint8Array){n.serializeBytes(t);return}if(typeof t=="string"){n.serializeStr(t);return}}if(!Array.isArray(t))throw new Error("Invalid vector args.");n.serializeU32AsUleb128(t.length),t.forEach(i=>md(i,e.value,n));return}if(e instanceof po){const{address:i,module_name:s,name:o}=e.value;if(`${Ie.fromUint8Array(i.address).toShortString()}::${s.value}::${o.value}`!="0x1::string::String")throw new Error("The only supported struct arg is of type 0x1::string::String");lu(t,["string"]),n.serializeStr(t);return}throw new Error("Unsupported arg type.")}function PT(t,e){if(e instanceof uo)return new ru(Cg(t));if(e instanceof ns)return new eu(qo(t));if(e instanceof ur)return new nu(qo(t));if(e instanceof lr)return new iu(qo(t));if(e instanceof lo)return new Jo(Mo(t));if(e instanceof ho)return new su(Mo(t));if(e instanceof dr)return new ou(Mo(t));if(e instanceof fo){let n;if(typeof t=="string"||t instanceof Ie)n=yn.fromHex(t);else if(t instanceof yn)n=t;else throw new Error("Invalid account address.");return new Zo(n)}if(e instanceof hr&&e.value instanceof ns){if(!(t instanceof Uint8Array))throw new Error(`${t} should be an instance of Uint8Array`);return new Yo(t)}throw new Error("Unknown type for TransactionArgument.")}var BT="APTOS::RawTransaction",ET="APTOS::RawTransactionWithData",er=class{constructor(t,e){this.rawTxnBuilder=e,this.signingFunction=t}build(t,e,n){if(!this.rawTxnBuilder)throw new Error("this.rawTxnBuilder doesn't exist.");return this.rawTxnBuilder.build(t,e,n)}static getSigningMessage(t){const e=Xo.create();if(t instanceof fr)e.update(BT);else if(t instanceof Yc)e.update(ET);else throw new Error("Unknown transaction type.");const n=e.digest(),i=is(t),s=new Uint8Array(n.length+i.length);return s.set(n),s.set(i,n.length),s}},Da=class extends er{constructor(t,e,n){super(t,n),this.publicKey=e}rawToSigned(t){const e=er.getSigningMessage(t),n=this.signingFunction(e),i=new Jc(new Ti(this.publicKey),n);return new sa(t,i)}sign(t){return is(this.rawToSigned(t))}},CT=class extends er{constructor(t,e){super(t),this.publicKey=e}rawToSigned(t){const e=er.getSigningMessage(t),n=this.signingFunction(e),i=new Zc(this.publicKey,n);return new sa(t,i)}sign(t){return is(this.rawToSigned(t))}},Za=class{constructor(t,e){this.abiMap=new Map,t.forEach(n=>{const i=new ad(n),s=au.deserialize(i);let o;if(s instanceof Qo){const r=s,{address:a,name:c}=r.module_name;o=`${Ie.fromUint8Array(a.address).toShortString()}::${c.value}::${r.name}`}else o=s.name;if(this.abiMap.has(o))throw new Error("Found conflicting ABI interfaces");this.abiMap.set(o,s)}),this.builderConfig={maxGasAmount:BigInt(rg),expSecFromNow:ag,...e}}static toBCSArgs(t,e){if(t.length!==e.length)throw new Error("Wrong number of args provided.");return e.map((n,i)=>{const s=new xn;return md(n,t[i].type_tag,s),s.getBytes()})}static toTransactionArguments(t,e){if(t.length!==e.length)throw new Error("Wrong number of args provided.");return e.map((n,i)=>PT(n,t[i].type_tag))}setSequenceNumber(t){this.builderConfig.sequenceNumber=BigInt(t)}buildTransactionPayload(t,e,n){const i=e.map(r=>new du(r).parseTypeTag());let s;if(!this.abiMap.has(t))throw new Error(`Cannot find function: ${t}`);const o=this.abiMap.get(t);if(o instanceof Qo){const r=o,a=Za.toBCSArgs(r.args,n);s=new Qc(new Hs(r.module_name,new ei(r.name),i,a))}else if(o instanceof cu){const r=o,a=Za.toTransactionArguments(r.args,n);s=new ra(new ia(r.code,i,a))}else throw new Error("Unknown ABI format.");return s}build(t,e,n){const{sender:i,sequenceNumber:s,gasUnitPrice:o,maxGasAmount:r,expSecFromNow:a,chainId:c}=this.builderConfig;if(!o)throw new Error("No gasUnitPrice provided.");const u=i instanceof yn?i:yn.fromHex(i),l=BigInt(Math.floor(Date.now()/1e3)+Number(a)),d=this.buildTransactionPayload(t,e,n);if(d)return new fr(u,BigInt(s),d,BigInt(r),BigInt(o),l,new tu(Number(c)));throw new Error("Invalid ABI.")}},Ig=class{constructor(t,e){this.aptosClient=t,this.builderConfig=e}async fetchABI(t){const n=(await this.aptosClient.getAccountModules(t)).map(s=>s.abi).flatMap(s=>s.exposed_functions.filter(o=>o.is_entry).map(o=>({fullName:`${s.address}::${s.name}::${o.name}`,...o}))),i=new Map;return n.forEach(s=>{i.set(s.fullName,s)}),i}async build(t,e,n){if(t=(A=>A.replace(/^0[xX]0*/g,"0x"))(t),t.split("::").length!==3)throw new Error("'func' needs to be a fully qualified function name in format <address>::<module>::<function>, e.g. 0x1::coins::transfer");const[o,r]=t.split("::"),a=await this.fetchABI(o);if(!a.has(t))throw new Error(`${t} doesn't exist.`);const c=a.get(t),l=c.params.filter(A=>A!=="signer"&&A!=="&signer").map((A,P)=>new ca(`var${P}`,new du(A).parseTypeTag())),d=new Qo(c.name,Js.fromStr(`${o}::${r}`),"",c.generic_type_params.map((A,P)=>new aa(`${P}`)),l),{sender:f,..._}=this.builderConfig,T=f instanceof yn?Ie.fromUint8Array(f.address):f,[{sequence_number:v},k,{gas_estimate:U}]=await Promise.all([_!=null&&_.sequenceNumber?Promise.resolve({sequence_number:_==null?void 0:_.sequenceNumber}):this.aptosClient.getAccount(T),_!=null&&_.chainId?Promise.resolve(_==null?void 0:_.chainId):this.aptosClient.getChainId(),_!=null&&_.gasUnitPrice?Promise.resolve({gas_estimate:_==null?void 0:_.gasUnitPrice}):this.aptosClient.estimateGasPrice()]);return new Za([is(d)],{sender:f,sequenceNumber:v,chainId:k,gasUnitPrice:BigInt(U),..._}).build(t,e,n)}};cn([Z1(10*60*1e3)],Ig.prototype,"fetchABI",1);var Ar=class{constructor(t,e,n=!1){if(!t)throw new Error("Node URL cannot be empty.");const i=e==null?{}:{...e};n?this.nodeUrl=t:this.nodeUrl=X1(t),i.BASE=this.nodeUrl,(e==null?void 0:e.WITH_CREDENTIALS)===!1?i.WITH_CREDENTIALS=!1:i.WITH_CREDENTIALS=!0,this.client=new Sg(i)}async getAccount(t){return this.client.accounts.getAccount(Ie.ensure(t).hex())}async getAccountTransactions(t,e){var n;return this.client.transactions.getAccountTransactions(Ie.ensure(t).hex(),(n=e==null?void 0:e.start)==null?void 0:n.toString(),e==null?void 0:e.limit)}async getAccountModules(t,e){const n=this.client.accounts.getAccountModules.bind({httpRequest:this.client.request});return await rh(n,t,1e3,e)}async getAccountModule(t,e,n){var i;return this.client.accounts.getAccountModule(Ie.ensure(t).hex(),e,(i=n==null?void 0:n.ledgerVersion)==null?void 0:i.toString())}async getAccountResources(t,e){const n=this.client.accounts.getAccountResources.bind({httpRequest:this.client.request});return await rh(n,t,9999,e)}async getAccountResource(t,e,n){var i;return this.client.accounts.getAccountResource(Ie.ensure(t).hex(),e,(i=n==null?void 0:n.ledgerVersion)==null?void 0:i.toString())}static generateBCSTransaction(t,e){return new Da(i=>{const s=t.signBuffer(i);return new F.Ed25519Signature(s.toUint8Array())},t.pubKey().toUint8Array()).sign(e)}static generateBCSSimulation(t,e){return new Da(i=>{const s=new Uint8Array(64);return new F.Ed25519Signature(s)},t.pubKey().toUint8Array()).sign(e)}async generateTransaction(t,e,n){const i={sender:t};if(n!=null&&n.sequence_number&&(i.sequenceNumber=n.sequence_number),n!=null&&n.gas_unit_price&&(i.gasUnitPrice=n.gas_unit_price),n!=null&&n.max_gas_amount&&(i.maxGasAmount=n.max_gas_amount),n!=null&&n.expiration_timestamp_secs){const o=Number.parseInt(n.expiration_timestamp_secs,10);i.expSecFromNow=o-Math.floor(Date.now()/1e3)}return new Ig(this,i).build(e.function,e.type_arguments,e.arguments)}async signTransaction(t,e){return Promise.resolve(Ar.generateBCSTransaction(t,e))}async getEventsByCreationNumber(t,e,n){var i;return this.client.events.getEventsByCreationNumber(Ie.ensure(t).hex(),e.toString(),(i=n==null?void 0:n.start)==null?void 0:i.toString(),n==null?void 0:n.limit)}async getEventsByEventHandle(t,e,n,i){var s;return this.client.events.getEventsByEventHandle(Ie.ensure(t).hex(),e,n,(s=i==null?void 0:i.start)==null?void 0:s.toString(),i==null?void 0:i.limit)}async submitTransaction(t){return this.submitSignedBCSTransaction(t)}async simulateTransaction(t,e,n){let i;return t instanceof Dr?i=Ar.generateBCSSimulation(t,e):t instanceof ea?i=new CT(()=>{const{threshold:o}=t,r=[],a=[];for(let u=0;u<o;u+=1)r.push(u),a.push(new F.Ed25519Signature(new Uint8Array(64)));const c=F.MultiEd25519Signature.createBitmap(r);return new F.MultiEd25519Signature(a,c)},t).sign(e):i=new Da(()=>{const o=new Uint8Array(64);return new F.Ed25519Signature(o)},t.toBytes()).sign(e),this.submitBCSSimulation(i,n)}async submitSignedBCSTransaction(t){return this.client.request.request({url:"/transactions",method:"POST",body:t,mediaType:"application/x.aptos.signed_transaction+bcs"})}async submitBCSSimulation(t,e){var n,i,s;const o={estimate_gas_unit_price:(n=e==null?void 0:e.estimateGasUnitPrice)!=null?n:!1,estimate_max_gas_amount:(i=e==null?void 0:e.estimateMaxGasAmount)!=null?i:!1,estimate_prioritized_gas_unit_price:(s=e==null?void 0:e.estimatePrioritizedGasUnitPrice)!=null?s:!1};return this.client.request.request({url:"/transactions/simulate",query:o,method:"POST",body:t,mediaType:"application/x.aptos.signed_transaction+bcs"})}async getTransactions(t){var e;return this.client.transactions.getTransactions((e=t==null?void 0:t.start)==null?void 0:e.toString(),t==null?void 0:t.limit)}async getTransactionByHash(t){return this.client.transactions.getTransactionByHash(t)}async getTransactionByVersion(t){return this.client.transactions.getTransactionByVersion(t.toString())}async transactionPending(t){try{return(await this.client.transactions.getTransactionByHash(t)).type==="pending_transaction"}catch(e){if((e==null?void 0:e.status)===404)return!0;throw e}}async waitForTransactionWithResult(t,e){var n,i;const s=(n=e==null?void 0:e.timeoutSecs)!=null?n:V1,o=(i=e==null?void 0:e.checkSuccess)!=null?i:!1;let r=!0,a=0,c;for(;r&&!(a>=s);){try{if(c=await this.client.transactions.getTransactionByHash(t),r=c.type==="pending_transaction",!r)break}catch(u){const l=u instanceof Lr,d=l&&u.status!==404&&u.status>=400&&u.status<500;if(!l||d)throw u}await W1(1e3),a+=1}if(c===void 0)throw new Error(`Waiting for transaction ${t} failed`);if(r)throw new OT(`Waiting for transaction ${t} timed out after ${s} seconds`,c);if(!o)return c;if(!(c!=null&&c.success))throw new RT(`Transaction ${t} committed to the blockchain but execution failed`,c);return c}async waitForTransaction(t,e){await this.waitForTransactionWithResult(t,e)}async getLedgerInfo(){return this.client.general.getLedgerInfo()}async getChainId(){return(await this.getLedgerInfo()).chain_id}async getTableItem(t,e,n){var i;return await this.client.tables.getTableItem(t,e,(i=n==null?void 0:n.ledgerVersion)==null?void 0:i.toString())}async generateRawTransaction(t,e,n){const[{sequence_number:i},s,{gas_estimate:o}]=await Promise.all([this.getAccount(t),this.getChainId(),n!=null&&n.gasUnitPrice?Promise.resolve({gas_estimate:n.gasUnitPrice}):this.estimateGasPrice()]),{maxGasAmount:r,gasUnitPrice:a,expireTimestamp:c}={maxGasAmount:BigInt(rg),gasUnitPrice:BigInt(o),expireTimestamp:BigInt(Math.floor(Date.now()/1e3)+ag),...n};return new F.RawTransaction(F.AccountAddress.fromHex(t),BigInt(i),e,r,a,c,new F.ChainId(s))}async generateSignSubmitTransaction(t,e,n){const i=await this.generateRawTransaction(t.address(),e,n),s=Ar.generateBCSTransaction(t,i);return(await this.submitSignedBCSTransaction(s)).hash}async publishPackage(t,e,n,i){const s=new xn;pi(n,s);const o=new F.TransactionPayloadEntryFunction(F.EntryFunction.natural("0x1::code","publish_package_txn",[],[To(e),s.getBytes()]));return this.generateSignSubmitTransaction(t,o,i)}async generateSignSubmitWaitForTransaction(t,e,n){const i=await this.generateSignSubmitTransaction(t,e,n);return this.waitForTransactionWithResult(i,n)}async estimateGasPrice(){return this.client.transactions.estimateGasPrice()}async estimateMaxGasAmount(t){const e=`0x1::coin::CoinStore<${J1}>`,[{gas_estimate:n},i]=await Promise.all([this.estimateGasPrice(),this.getAccountResources(t)]),s=i.find(r=>r.type===e);return BigInt(s.data.coin.value)/BigInt(n)}async rotateAuthKeyEd25519(t,e,n){const{sequence_number:i,authentication_key:s}=await this.getAccount(t.address()),o=new Dr(e),r=new F.RotationProofChallenge(F.AccountAddress.CORE_CODE_ADDRESS,"account","RotationProofChallenge",BigInt(i),F.AccountAddress.fromHex(t.address()),new F.AccountAddress(new Ie(s).toUint8Array()),o.pubKey().toUint8Array()),a=Ie.fromUint8Array(is(r)),c=t.signHexString(a),u=o.signHexString(a),l=new F.TransactionPayloadEntryFunction(F.EntryFunction.natural("0x1::account","rotate_authentication_key",[],[fl(0),To(t.pubKey().toUint8Array()),fl(0),To(o.pubKey().toUint8Array()),To(c.toUint8Array()),To(u.toUint8Array())])),d=await this.generateRawTransaction(t.address(),l,n),f=Ar.generateBCSTransaction(t,d);return this.submitSignedBCSTransaction(f)}async lookupOriginalAddress(t){const e=await this.getAccountResource("0x1","0x1::account::OriginatingAddress"),{address_map:{handle:n}}=e.data,i=await this.getTableItem(n,{key_type:"address",value_type:"address",key:Ie.ensure(t).hex()});return new Ie(i)}async getBlockByHeight(t,e){return this.client.blocks.getBlockByHeight(t,e)}async getBlockByVersion(t,e){return this.client.blocks.getBlockByVersion(t,e)}async view(t,e){return this.client.view.view(t,e)}clearCache(t){Y1(t)}},rn=Ar;cn([Bn],rn.prototype,"getAccount",1);cn([Bn],rn.prototype,"getAccountTransactions",1);cn([Bn],rn.prototype,"getAccountModules",1);cn([Bn],rn.prototype,"getAccountModule",1);cn([Bn],rn.prototype,"getAccountResources",1);cn([Bn],rn.prototype,"getAccountResource",1);cn([Bn],rn.prototype,"getEventsByCreationNumber",1);cn([Bn],rn.prototype,"getEventsByEventHandle",1);cn([Bn],rn.prototype,"submitSignedBCSTransaction",1);cn([Bn],rn.prototype,"submitBCSSimulation",1);cn([Bn],rn.prototype,"getTransactions",1);cn([Bn],rn.prototype,"getTransactionByHash",1);cn([Bn],rn.prototype,"getTransactionByVersion",1);cn([Bn],rn.prototype,"getLedgerInfo",1);cn([Xc()],rn.prototype,"getChainId",1);cn([Bn],rn.prototype,"getTableItem",1);cn([Bn,Xc({ttlMs:5*60*1e3,tags:["gas_estimates"]})],rn.prototype,"estimateGasPrice",1);cn([Bn],rn.prototype,"estimateMaxGasAmount",1);cn([Bn],rn.prototype,"getBlockByHeight",1);cn([Bn],rn.prototype,"getBlockByVersion",1);cn([Bn],rn.prototype,"view",1);var IT=class extends Error{constructor(t,e,n,i){super(e),this.status=t,this.message=e,this.errorCode=n,this.vmErrorCode=i}},OT=class extends Error{constructor(t,e){super(t),this.lastSubmittedTransaction=e}},RT=class extends Error{constructor(t,e){super(t),this.transaction=e}};function Bn(t,e,n){const i=n.value;return n.value=async function(...o){var r,a;try{return await i.apply(this,[...o])}catch(c){throw c instanceof Lr?new IT(c.status,JSON.stringify({message:c.message,...c.body}),(r=c.body)==null?void 0:r.error_code,(a=c.body)==null?void 0:a.vm_error_code):c}},n}var Og=class{constructor(t,e,n=!1){let i=null,s=null;if(typeof t=="object"&&UT(t)?(i=t.fullnodeUrl,s=t.indexerUrl):(i=tv[t],s=Q1[t]),!i||!s)throw new Error("network is not provided");this.aptosClient=new rn(i,e,n),this.indexerClient=new hg(s)}};function Rg(t,e,n){Object.getOwnPropertyNames(e.prototype).forEach(i=>{const s=Object.getOwnPropertyDescriptor(e.prototype,i);s&&(s.value=function(...o){return this[n][i](...o)},Object.defineProperty(t.prototype,i,s))})}Rg(Og,rn,"aptosClient");Rg(Og,hg,"indexerClient");function UT(t){return t.fullnodeUrl!==void 0&&typeof t.fullnodeUrl=="string"&&t.indexerUrl!==void 0&&typeof t.indexerUrl=="string"}var $T="a11ceb0b0500000006010004020408030c0a05161d073339086c400000010100020700010307000104030100010504020007060c0508000800030503010801000405080008000304060c0801050306737472696e6705746f6b656e06537472696e6707546f6b656e4964136372656174655f746f6b656e5f69645f726177087472616e73666572000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000030000010c0b010b020b030b0411000c070b000b070b050b06110102",qT=["01186372656174655F636F6C6C656374696F6E5F736372697074000000000000000000000000000000000000000000000000000000000000000305746F6B656E3020637265617465206120656D70747920746F6B656E20636F6C6C656374696F6E207769746820706172616D65746572730005046E616D6507000000000000000000000000000000000000000000000000000000000000000106737472696E6706537472696E67000B6465736372697074696F6E07000000000000000000000000000000000000000000000000000000000000000106737472696E6706537472696E67000375726907000000000000000000000000000000000000000000000000000000000000000106737472696E6706537472696E6700076D6178696D756D020E6D75746174655F73657474696E670600","01136372656174655F746F6B656E5F736372697074000000000000000000000000000000000000000000000000000000000000000305746F6B656E1D2063726561746520746F6B656E20776974682072617720696E70757473000D0A636F6C6C656374696F6E07000000000000000000000000000000000000000000000000000000000000000106737472696E6706537472696E6700046E616D6507000000000000000000000000000000000000000000000000000000000000000106737472696E6706537472696E67000B6465736372697074696F6E07000000000000000000000000000000000000000000000000000000000000000106737472696E6706537472696E67000762616C616E636502076D6178696D756D020375726907000000000000000000000000000000000000000000000000000000000000000106737472696E6706537472696E670015726F79616C74795F70617965655F61646472657373041A726F79616C74795F706F696E74735F64656E6F6D696E61746F720218726F79616C74795F706F696E74735F6E756D657261746F72020E6D75746174655F73657474696E6706000D70726F70657274795F6B6579730607000000000000000000000000000000000000000000000000000000000000000106737472696E6706537472696E67000F70726F70657274795F76616C7565730606010E70726F70657274795F74797065730607000000000000000000000000000000000000000000000000000000000000000106737472696E6706537472696E6700","01166469726563745f7472616e736665725f736372697074000000000000000000000000000000000000000000000000000000000000000305746f6b656e0000051063726561746f72735f61646472657373040a636f6c6c656374696f6e07000000000000000000000000000000000000000000000000000000000000000106737472696e6706537472696e6700046e616d6507000000000000000000000000000000000000000000000000000000000000000106737472696e6706537472696e67001070726f70657274795f76657273696f6e0206616d6f756e7402","010C6F666665725F73637269707400000000000000000000000000000000000000000000000000000000000000030F746F6B656E5F7472616E7366657273000006087265636569766572040763726561746F72040A636F6C6C656374696F6E07000000000000000000000000000000000000000000000000000000000000000106737472696E6706537472696E6700046E616D6507000000000000000000000000000000000000000000000000000000000000000106737472696E6706537472696E67001070726F70657274795F76657273696F6E0206616D6F756E7402","010C636C61696D5F73637269707400000000000000000000000000000000000000000000000000000000000000030F746F6B656E5F7472616E73666572730000050673656E646572040763726561746F72040A636F6C6C656374696F6E07000000000000000000000000000000000000000000000000000000000000000106737472696E6706537472696E6700046E616D6507000000000000000000000000000000000000000000000000000000000000000106737472696E6706537472696E67001070726F70657274795F76657273696F6E02","011363616E63656C5F6F666665725F73637269707400000000000000000000000000000000000000000000000000000000000000030F746F6B656E5F7472616E7366657273000005087265636569766572040763726561746F72040A636F6C6C656374696F6E07000000000000000000000000000000000000000000000000000000000000000106737472696E6706537472696E6700046E616D6507000000000000000000000000000000000000000000000000000000000000000106737472696E6706537472696E67001070726F70657274795F76657273696F6E02","01176d75746174655f746f6b656e5f70726f70657274696573000000000000000000000000000000000000000000000000000000000000000305746f6b656eba02206d75746174652074686520746f6b656e2070726f706572747920616e64207361766520746865206e65772070726f706572747920696e20546f6b656e53746f72650a2069662074686520746f6b656e2070726f70657274795f76657273696f6e20697320302c2077652077696c6c206372656174652061206e65772070726f70657274795f76657273696f6e2070657220746f6b656e20746f2067656e65726174652061206e657720746f6b656e5f69642070657220746f6b656e0a2069662074686520746f6b656e2070726f70657274795f76657273696f6e206973206e6f7420302c2077652077696c6c206a75737420757064617465207468652070726f70657274794d617020616e642075736520746865206578697374696e6720746f6b656e5f6964202870726f70657274795f76657273696f6e2900090b746f6b656e5f6f776e6572040763726561746f72040f636f6c6c656374696f6e5f6e616d6507000000000000000000000000000000000000000000000000000000000000000106737472696e6706537472696e67000a746f6b656e5f6e616d6507000000000000000000000000000000000000000000000000000000000000000106737472696e6706537472696e670016746f6b656e5f70726f70657274795f76657273696f6e0206616d6f756e7402046b6579730607000000000000000000000000000000000000000000000000000000000000000106737472696e6706537472696e67000676616c7565730606010574797065730607000000000000000000000000000000000000000000000000000000000000000106737472696e6706537472696e6700","01166f70745f696e5f6469726563745f7472616e73666572000000000000000000000000000000000000000000000000000000000000000305746f6b656e000001066f70745f696e00","01046275726e000000000000000000000000000000000000000000000000000000000000000305746f6b656e20204275726e206120746f6b656e2062792074686520746f6b656e206f776e657200051063726561746f72735f61646472657373040a636f6c6c656374696f6e07000000000000000000000000000000000000000000000000000000000000000106737472696e6706537472696e6700046e616d6507000000000000000000000000000000000000000000000000000000000000000106737472696e6706537472696e67001070726f70657274795f76657273696f6e0206616d6f756e7402","010f6275726e5f62795f63726561746f72000000000000000000000000000000000000000000000000000000000000000305746f6b656e6a204275726e206120746f6b656e2062792063726561746f72207768656e2074686520746f6b656e2773204255524e41424c455f42595f43524541544f5220697320747275650a2054686520746f6b656e206973206f776e65642061742061646472657373206f776e65720005056f776e6572040a636f6c6c656374696f6e07000000000000000000000000000000000000000000000000000000000000000106737472696e6706537472696e6700046e616d6507000000000000000000000000000000000000000000000000000000000000000106737472696e6706537472696e67001070726f70657274795f76657273696f6e0206616d6f756e7402"],Ug=class{constructor(t,e){this.type=t,this.value=e}},yd=class{constructor(){this.data={}}setProperty(t,e){this.data[t]=e}};function $g(t){let e;return t==="string"||t==="String"?e=new po(AT):e=new du(t).parseTypeTag(),e}function MT(t,e){if(t.length!==e.length)throw new Error("Length of property values and types not match");const n=new Array;return e.forEach((i,s)=>{try{const o=$g(i),r=new xn;md(t[s],o,r),n.push(r.getBytes())}catch{n.push(new TextEncoder().encode(t[s]))}}),n}function qg(t){const e=t.map.data,n=new yd;return e.forEach(i=>{const{key:s}=i,o=i.value.value,r=i.value.type,a=$g(r),c=DT(a,o),u=new Ug(r,c);n.setProperty(s,u)}),n}function DT(t,e){const n=new ad(new Ie(e).toUint8Array());let i="";return t instanceof ns?i=n.deserializeU8().toString():t instanceof lo?i=n.deserializeU64().toString():t instanceof ho?i=n.deserializeU128().toString():t instanceof uo?i=n.deserializeBool()?"true":"false":t instanceof fo?i=Ie.fromUint8Array(n.deserializeFixedBytes(32)).hex():t instanceof po&&t.isStringTypeTag()?i=n.deserializeStr():i=e,i}var LT={};Wc(LT,{PropertyMap:()=>yd,PropertyValue:()=>Ug,Token:()=>Dg,TokenData:()=>Mg});var Mg=class{constructor(t,e,n,i,s,o,r,a){this.collection=t,this.description=e,this.name=n,this.maximum=i,this.supply=s,this.uri=o,this.default_properties=qg(r),this.mutability_config=a}},Dg=class{constructor(t,e,n){this.id=t,this.amount=e,this.token_properties=qg(n)}},NT=class{constructor(t){this.aptosClient=t,this.transactionBuilder=new Za(qT.map(e=>new Ie(e).toUint8Array()))}async createCollection(t,e,n,i,s=Er,o){const r=this.transactionBuilder.buildTransactionPayload("0x3::token::create_collection_script",[],[e,n,i,s,[!1,!1,!1]]);return this.aptosClient.generateSignSubmitTransaction(t,r,o)}async createToken(t,e,n,i,s,o,r=Er,a=t.address(),c=0,u=0,l=[],d=[],f=[],_){const T=this.transactionBuilder.buildTransactionPayload("0x3::token::create_token_script",[],[e,n,i,s,r,o,a,c,u,[!1,!1,!1,!1,!1],l,MT(d,f),f]);return this.aptosClient.generateSignSubmitTransaction(t,T,_)}async createTokenWithMutabilityConfig(t,e,n,i,s,o,r=Er,a=t.address(),c=0,u=0,l=[],d=[],f=[],_=[!1,!1,!1,!1,!1],T){const v=this.transactionBuilder.buildTransactionPayload("0x3::token::create_token_script",[],[e,n,i,s,r,o,a,c,u,_,l,d,f]);return this.aptosClient.generateSignSubmitTransaction(t,v,T)}async offerToken(t,e,n,i,s,o,r=0,a){const c=this.transactionBuilder.buildTransactionPayload("0x3::token_transfers::offer_script",[],[e,n,i,s,r,o]);return this.aptosClient.generateSignSubmitTransaction(t,c,a)}async claimToken(t,e,n,i,s,o=0,r){const a=this.transactionBuilder.buildTransactionPayload("0x3::token_transfers::claim_script",[],[e,n,i,s,o]);return this.aptosClient.generateSignSubmitTransaction(t,a,r)}async cancelTokenOffer(t,e,n,i,s,o=0,r){const a=this.transactionBuilder.buildTransactionPayload("0x3::token_transfers::cancel_offer_script",[],[e,n,i,s,o]);return this.aptosClient.generateSignSubmitTransaction(t,a,r)}async directTransferToken(t,e,n,i,s,o,r=0,a){const c=this.transactionBuilder.buildTransactionPayload("0x3::token::direct_transfer_script",[],[n,i,s,r,o]),u=await this.aptosClient.generateRawTransaction(t.address(),c,a),l=new F.MultiAgentRawTransaction(u,[F.AccountAddress.fromHex(e.address())]),d=new F.Ed25519Signature(t.signBuffer(er.getSigningMessage(l)).toUint8Array()),f=new F.AccountAuthenticatorEd25519(new F.Ed25519PublicKey(t.signingKey.publicKey),d),_=new F.Ed25519Signature(e.signBuffer(er.getSigningMessage(l)).toUint8Array()),T=new F.AccountAuthenticatorEd25519(new F.Ed25519PublicKey(e.signingKey.publicKey),_),v=new F.TransactionAuthenticatorMultiAgent(f,[F.AccountAddress.fromHex(e.address())],[T]),k=is(new F.SignedTransaction(u,v));return(await this.aptosClient.submitSignedBCSTransaction(k)).hash}async optInTokenTransfer(t,e,n){const i=this.transactionBuilder.buildTransactionPayload("0x3::token::opt_in_direct_transfer",[],[e]);return this.aptosClient.generateSignSubmitTransaction(t,i,n)}async transferWithOptIn(t,e,n,i,s,o,r,a){const c=new ra(new ia(new Ie($T).toUint8Array(),[],[new Zo(F.AccountAddress.fromHex(e)),new Yo(new TextEncoder().encode(n)),new Yo(new TextEncoder().encode(i)),new Jo(BigInt(s)),new Zo(F.AccountAddress.fromHex(o)),new Jo(BigInt(r))]));return this.aptosClient.generateSignSubmitTransaction(t,c,a)}async burnByCreator(t,e,n,i,s,o,r){const a=this.transactionBuilder.buildTransactionPayload("0x3::token::burn_by_creator",[],[e,n,i,s,o]);return this.aptosClient.generateSignSubmitTransaction(t,a,r)}async burnByOwner(t,e,n,i,s,o,r){const a=this.transactionBuilder.buildTransactionPayload("0x3::token::burn",[],[e,n,i,s,o]);return this.aptosClient.generateSignSubmitTransaction(t,a,r)}async mutateTokenProperties(t,e,n,i,s,o,r,a,c,u,l){const d=this.transactionBuilder.buildTransactionPayload("0x3::token::mutate_token_properties",[],[e,n,i,s,o,r,a,c,u]);return this.aptosClient.generateSignSubmitTransaction(t,d,l)}async getCollectionData(t,e){const i=(await this.aptosClient.getAccountResources(t)).find(a=>a.type==="0x3::token::Collections"),{handle:s}=i.data.collection_data,o={key_type:"0x1::string::String",value_type:"0x3::token::CollectionData",key:e};return await this.aptosClient.getTableItem(s,o)}async getTokenData(t,e,n){const i=t instanceof Ie?t.hex():t,s=await this.aptosClient.getAccountResource(i,"0x3::token::Collections"),{handle:o}=s.data.token_data,a={key_type:"0x3::token::TokenDataId",value_type:"0x3::token::TokenData",key:{creator:i,collection:e,name:n}},c=await this.aptosClient.getTableItem(o,a);return new Mg(c.collection,c.description,c.name,c.maximum,c.supply,c.uri,c.default_properties,c.mutability_config)}async getToken(t,e,n,i="0"){const s={creator:t instanceof Ie?t.hex():t,collection:e,name:n};return this.getTokenForAccount(t,{token_data_id:s,property_version:i})}async getTokenForAccount(t,e){const n=await this.aptosClient.getAccountResource(t instanceof Ie?t.hex():t,"0x3::token::TokenStore"),{handle:i}=n.data.tokens,s={key_type:"0x3::token::TokenId",value_type:"0x3::token::Token",key:e};try{const o=await this.aptosClient.getTableItem(i,s);return new Dg(o.id,o.amount,o.token_properties)}catch(o){return(o==null?void 0:o.status)===404?{id:e,amount:"0",token_properties:new yd}:o}}},y={},FT={get exports(){return y},set exports(t){y=t}};(function(t){(function(e,n){function i(b,h){if(!b)throw new Error(h||"Assertion failed")}function s(b,h){b.super_=h;var m=function(){};m.prototype=h.prototype,b.prototype=new m,b.prototype.constructor=b}function o(b,h,m){if(o.isBN(b))return b;this.negative=0,this.words=null,this.length=0,this.red=null,b!==null&&((h==="le"||h==="be")&&(m=h,h=10),this._init(b||0,h||10,m||"be"))}typeof e=="object"?e.exports=o:n.BN=o,o.BN=o,o.wordSize=26;var r;try{typeof window<"u"&&typeof window.Buffer<"u"?r=window.Buffer:r=Wh.Buffer}catch{}o.isBN=function(h){return h instanceof o?!0:h!==null&&typeof h=="object"&&h.constructor.wordSize===o.wordSize&&Array.isArray(h.words)},o.max=function(h,m){return h.cmp(m)>0?h:m},o.min=function(h,m){return h.cmp(m)<0?h:m},o.prototype._init=function(h,m,x){if(typeof h=="number")return this._initNumber(h,m,x);if(typeof h=="object")return this._initArray(h,m,x);m==="hex"&&(m=16),i(m===(m|0)&&m>=2&&m<=36),h=h.toString().replace(/\s+/g,"");var I=0;h[0]==="-"&&(I++,this.negative=1),I<h.length&&(m===16?this._parseHex(h,I,x):(this._parseBase(h,m,I),x==="le"&&this._initArray(this.toArray(),m,x)))},o.prototype._initNumber=function(h,m,x){h<0&&(this.negative=1,h=-h),h<67108864?(this.words=[h&67108863],this.length=1):h<4503599627370496?(this.words=[h&67108863,h/67108864&67108863],this.length=2):(i(h<9007199254740992),this.words=[h&67108863,h/67108864&67108863,1],this.length=3),x==="le"&&this._initArray(this.toArray(),m,x)},o.prototype._initArray=function(h,m,x){if(i(typeof h.length=="number"),h.length<=0)return this.words=[0],this.length=1,this;this.length=Math.ceil(h.length/3),this.words=new Array(this.length);for(var I=0;I<this.length;I++)this.words[I]=0;var N,j,G=0;if(x==="be")for(I=h.length-1,N=0;I>=0;I-=3)j=h[I]|h[I-1]<<8|h[I-2]<<16,this.words[N]|=j<<G&67108863,this.words[N+1]=j>>>26-G&67108863,G+=24,G>=26&&(G-=26,N++);else if(x==="le")for(I=0,N=0;I<h.length;I+=3)j=h[I]|h[I+1]<<8|h[I+2]<<16,this.words[N]|=j<<G&67108863,this.words[N+1]=j>>>26-G&67108863,G+=24,G>=26&&(G-=26,N++);return this._strip()};function a(b,h){var m=b.charCodeAt(h);if(m>=48&&m<=57)return m-48;if(m>=65&&m<=70)return m-55;if(m>=97&&m<=102)return m-87;i(!1,"Invalid character in "+b)}function c(b,h,m){var x=a(b,m);return m-1>=h&&(x|=a(b,m-1)<<4),x}o.prototype._parseHex=function(h,m,x){this.length=Math.ceil((h.length-m)/6),this.words=new Array(this.length);for(var I=0;I<this.length;I++)this.words[I]=0;var N=0,j=0,G;if(x==="be")for(I=h.length-1;I>=m;I-=2)G=c(h,m,I)<<N,this.words[j]|=G&67108863,N>=18?(N-=18,j+=1,this.words[j]|=G>>>26):N+=8;else{var E=h.length-m;for(I=E%2===0?m+1:m;I<h.length;I+=2)G=c(h,m,I)<<N,this.words[j]|=G&67108863,N>=18?(N-=18,j+=1,this.words[j]|=G>>>26):N+=8}this._strip()};function u(b,h,m,x){for(var I=0,N=0,j=Math.min(b.length,m),G=h;G<j;G++){var E=b.charCodeAt(G)-48;I*=x,E>=49?N=E-49+10:E>=17?N=E-17+10:N=E,i(E>=0&&N<x,"Invalid character"),I+=N}return I}o.prototype._parseBase=function(h,m,x){this.words=[0],this.length=1;for(var I=0,N=1;N<=67108863;N*=m)I++;I--,N=N/m|0;for(var j=h.length-x,G=j%I,E=Math.min(j,j-G)+x,g=0,q=x;q<E;q+=I)g=u(h,q,q+I,m),this.imuln(N),this.words[0]+g<67108864?this.words[0]+=g:this._iaddn(g);if(G!==0){var xt=1;for(g=u(h,q,h.length,m),q=0;q<G;q++)xt*=m;this.imuln(xt),this.words[0]+g<67108864?this.words[0]+=g:this._iaddn(g)}this._strip()},o.prototype.copy=function(h){h.words=new Array(this.length);for(var m=0;m<this.length;m++)h.words[m]=this.words[m];h.length=this.length,h.negative=this.negative,h.red=this.red};function l(b,h){b.words=h.words,b.length=h.length,b.negative=h.negative,b.red=h.red}if(o.prototype._move=function(h){l(h,this)},o.prototype.clone=function(){var h=new o(null);return this.copy(h),h},o.prototype._expand=function(h){for(;this.length<h;)this.words[this.length++]=0;return this},o.prototype._strip=function(){for(;this.length>1&&this.words[this.length-1]===0;)this.length--;return this._normSign()},o.prototype._normSign=function(){return this.length===1&&this.words[0]===0&&(this.negative=0),this},typeof Symbol<"u"&&typeof Symbol.for=="function")try{o.prototype[Symbol.for("nodejs.util.inspect.custom")]=d}catch{o.prototype.inspect=d}else o.prototype.inspect=d;function d(){return(this.red?"<BN-R: ":"<BN: ")+this.toString(16)+">"}var f=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"],_=[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],T=[0,0,33554432,43046721,16777216,48828125,60466176,40353607,16777216,43046721,1e7,19487171,35831808,62748517,7529536,11390625,16777216,24137569,34012224,47045881,64e6,4084101,5153632,6436343,7962624,9765625,11881376,14348907,17210368,20511149,243e5,28629151,33554432,39135393,45435424,52521875,60466176];o.prototype.toString=function(h,m){h=h||10,m=m|0||1;var x;if(h===16||h==="hex"){x="";for(var I=0,N=0,j=0;j<this.length;j++){var G=this.words[j],E=((G<<I|N)&16777215).toString(16);N=G>>>24-I&16777215,I+=2,I>=26&&(I-=26,j--),N!==0||j!==this.length-1?x=f[6-E.length]+E+x:x=E+x}for(N!==0&&(x=N.toString(16)+x);x.length%m!==0;)x="0"+x;return this.negative!==0&&(x="-"+x),x}if(h===(h|0)&&h>=2&&h<=36){var g=_[h],q=T[h];x="";var xt=this.clone();for(xt.negative=0;!xt.isZero();){var at=xt.modrn(q).toString(h);xt=xt.idivn(q),xt.isZero()?x=at+x:x=f[g-at.length]+at+x}for(this.isZero()&&(x="0"+x);x.length%m!==0;)x="0"+x;return this.negative!==0&&(x="-"+x),x}i(!1,"Base should be between 2 and 36")},o.prototype.toNumber=function(){var h=this.words[0];return this.length===2?h+=this.words[1]*67108864:this.length===3&&this.words[2]===1?h+=4503599627370496+this.words[1]*67108864:this.length>2&&i(!1,"Number can only safely store up to 53 bits"),this.negative!==0?-h:h},o.prototype.toJSON=function(){return this.toString(16,2)},r&&(o.prototype.toBuffer=function(h,m){return this.toArrayLike(r,h,m)}),o.prototype.toArray=function(h,m){return this.toArrayLike(Array,h,m)};var v=function(h,m){return h.allocUnsafe?h.allocUnsafe(m):new h(m)};o.prototype.toArrayLike=function(h,m,x){this._strip();var I=this.byteLength(),N=x||Math.max(1,I);i(I<=N,"byte array longer than desired length"),i(N>0,"Requested array length <= 0");var j=v(h,N),G=m==="le"?"LE":"BE";return this["_toArrayLike"+G](j,I),j},o.prototype._toArrayLikeLE=function(h,m){for(var x=0,I=0,N=0,j=0;N<this.length;N++){var G=this.words[N]<<j|I;h[x++]=G&255,x<h.length&&(h[x++]=G>>8&255),x<h.length&&(h[x++]=G>>16&255),j===6?(x<h.length&&(h[x++]=G>>24&255),I=0,j=0):(I=G>>>24,j+=2)}if(x<h.length)for(h[x++]=I;x<h.length;)h[x++]=0},o.prototype._toArrayLikeBE=function(h,m){for(var x=h.length-1,I=0,N=0,j=0;N<this.length;N++){var G=this.words[N]<<j|I;h[x--]=G&255,x>=0&&(h[x--]=G>>8&255),x>=0&&(h[x--]=G>>16&255),j===6?(x>=0&&(h[x--]=G>>24&255),I=0,j=0):(I=G>>>24,j+=2)}if(x>=0)for(h[x--]=I;x>=0;)h[x--]=0},Math.clz32?o.prototype._countBits=function(h){return 32-Math.clz32(h)}:o.prototype._countBits=function(h){var m=h,x=0;return m>=4096&&(x+=13,m>>>=13),m>=64&&(x+=7,m>>>=7),m>=8&&(x+=4,m>>>=4),m>=2&&(x+=2,m>>>=2),x+m},o.prototype._zeroBits=function(h){if(h===0)return 26;var m=h,x=0;return m&8191||(x+=13,m>>>=13),m&127||(x+=7,m>>>=7),m&15||(x+=4,m>>>=4),m&3||(x+=2,m>>>=2),m&1||x++,x},o.prototype.bitLength=function(){var h=this.words[this.length-1],m=this._countBits(h);return(this.length-1)*26+m};function k(b){for(var h=new Array(b.bitLength()),m=0;m<h.length;m++){var x=m/26|0,I=m%26;h[m]=b.words[x]>>>I&1}return h}o.prototype.zeroBits=function(){if(this.isZero())return 0;for(var h=0,m=0;m<this.length;m++){var x=this._zeroBits(this.words[m]);if(h+=x,x!==26)break}return h},o.prototype.byteLength=function(){return Math.ceil(this.bitLength()/8)},o.prototype.toTwos=function(h){return this.negative!==0?this.abs().inotn(h).iaddn(1):this.clone()},o.prototype.fromTwos=function(h){return this.testn(h-1)?this.notn(h).iaddn(1).ineg():this.clone()},o.prototype.isNeg=function(){return this.negative!==0},o.prototype.neg=function(){return this.clone().ineg()},o.prototype.ineg=function(){return this.isZero()||(this.negative^=1),this},o.prototype.iuor=function(h){for(;this.length<h.length;)this.words[this.length++]=0;for(var m=0;m<h.length;m++)this.words[m]=this.words[m]|h.words[m];return this._strip()},o.prototype.ior=function(h){return i((this.negative|h.negative)===0),this.iuor(h)},o.prototype.or=function(h){return this.length>h.length?this.clone().ior(h):h.clone().ior(this)},o.prototype.uor=function(h){return this.length>h.length?this.clone().iuor(h):h.clone().iuor(this)},o.prototype.iuand=function(h){var m;this.length>h.length?m=h:m=this;for(var x=0;x<m.length;x++)this.words[x]=this.words[x]&h.words[x];return this.length=m.length,this._strip()},o.prototype.iand=function(h){return i((this.negative|h.negative)===0),this.iuand(h)},o.prototype.and=function(h){return this.length>h.length?this.clone().iand(h):h.clone().iand(this)},o.prototype.uand=function(h){return this.length>h.length?this.clone().iuand(h):h.clone().iuand(this)},o.prototype.iuxor=function(h){var m,x;this.length>h.length?(m=this,x=h):(m=h,x=this);for(var I=0;I<x.length;I++)this.words[I]=m.words[I]^x.words[I];if(this!==m)for(;I<m.length;I++)this.words[I]=m.words[I];return this.length=m.length,this._strip()},o.prototype.ixor=function(h){return i((this.negative|h.negative)===0),this.iuxor(h)},o.prototype.xor=function(h){return this.length>h.length?this.clone().ixor(h):h.clone().ixor(this)},o.prototype.uxor=function(h){return this.length>h.length?this.clone().iuxor(h):h.clone().iuxor(this)},o.prototype.inotn=function(h){i(typeof h=="number"&&h>=0);var m=Math.ceil(h/26)|0,x=h%26;this._expand(m),x>0&&m--;for(var I=0;I<m;I++)this.words[I]=~this.words[I]&67108863;return x>0&&(this.words[I]=~this.words[I]&67108863>>26-x),this._strip()},o.prototype.notn=function(h){return this.clone().inotn(h)},o.prototype.setn=function(h,m){i(typeof h=="number"&&h>=0);var x=h/26|0,I=h%26;return this._expand(x+1),m?this.words[x]=this.words[x]|1<<I:this.words[x]=this.words[x]&~(1<<I),this._strip()},o.prototype.iadd=function(h){var m;if(this.negative!==0&&h.negative===0)return this.negative=0,m=this.isub(h),this.negative^=1,this._normSign();if(this.negative===0&&h.negative!==0)return h.negative=0,m=this.isub(h),h.negative=1,m._normSign();var x,I;this.length>h.length?(x=this,I=h):(x=h,I=this);for(var N=0,j=0;j<I.length;j++)m=(x.words[j]|0)+(I.words[j]|0)+N,this.words[j]=m&67108863,N=m>>>26;for(;N!==0&&j<x.length;j++)m=(x.words[j]|0)+N,this.words[j]=m&67108863,N=m>>>26;if(this.length=x.length,N!==0)this.words[this.length]=N,this.length++;else if(x!==this)for(;j<x.length;j++)this.words[j]=x.words[j];return this},o.prototype.add=function(h){var m;return h.negative!==0&&this.negative===0?(h.negative=0,m=this.sub(h),h.negative^=1,m):h.negative===0&&this.negative!==0?(this.negative=0,m=h.sub(this),this.negative=1,m):this.length>h.length?this.clone().iadd(h):h.clone().iadd(this)},o.prototype.isub=function(h){if(h.negative!==0){h.negative=0;var m=this.iadd(h);return h.negative=1,m._normSign()}else if(this.negative!==0)return this.negative=0,this.iadd(h),this.negative=1,this._normSign();var x=this.cmp(h);if(x===0)return this.negative=0,this.length=1,this.words[0]=0,this;var I,N;x>0?(I=this,N=h):(I=h,N=this);for(var j=0,G=0;G<N.length;G++)m=(I.words[G]|0)-(N.words[G]|0)+j,j=m>>26,this.words[G]=m&67108863;for(;j!==0&&G<I.length;G++)m=(I.words[G]|0)+j,j=m>>26,this.words[G]=m&67108863;if(j===0&&G<I.length&&I!==this)for(;G<I.length;G++)this.words[G]=I.words[G];return this.length=Math.max(this.length,G),I!==this&&(this.negative=1),this._strip()},o.prototype.sub=function(h){return this.clone().isub(h)};function U(b,h,m){m.negative=h.negative^b.negative;var x=b.length+h.length|0;m.length=x,x=x-1|0;var I=b.words[0]|0,N=h.words[0]|0,j=I*N,G=j&67108863,E=j/67108864|0;m.words[0]=G;for(var g=1;g<x;g++){for(var q=E>>>26,xt=E&67108863,at=Math.min(g,h.length-1),mt=Math.max(0,g-b.length+1);mt<=at;mt++){var se=g-mt|0;I=b.words[se]|0,N=h.words[mt]|0,j=I*N+xt,q+=j/67108864|0,xt=j&67108863}m.words[g]=xt|0,E=q|0}return E!==0?m.words[g]=E|0:m.length--,m._strip()}var R=function(h,m,x){var I=h.words,N=m.words,j=x.words,G=0,E,g,q,xt=I[0]|0,at=xt&8191,mt=xt>>>13,se=I[1]|0,te=se&8191,Oe=se>>>13,fe=I[2]|0,ee=fe&8191,ve=fe>>>13,Tn=I[3]|0,nt=Tn&8191,dt=Tn>>>13,It=I[4]|0,Tt=It&8191,Ut=It>>>13,Yt=I[5]|0,zt=Yt&8191,Vt=Yt>>>13,We=I[6]|0,re=We&8191,Jt=We>>>13,je=I[7]|0,Ae=je&8191,L=je>>>13,V=I[8]|0,W=V&8191,tt=V>>>13,ct=I[9]|0,ut=ct&8191,yt=ct>>>13,wt=N[0]|0,pt=wt&8191,Pt=wt>>>13,_t=N[1]|0,Ct=_t&8191,Dt=_t>>>13,ce=N[2]|0,Qt=ce&8191,ne=ce>>>13,le=N[3]|0,we=le&8191,ae=le>>>13,Ye=N[4]|0,ze=Ye&8191,Je=Ye>>>13,An=N[5]|0,De=An&8191,Re=An>>>13,pn=N[6]|0,w=pn&8191,S=pn>>>13,B=N[7]|0,p=B&8191,C=B>>>13,Q=N[8]|0,Z=Q&8191,lt=Q>>>13,kt=N[9]|0,Rt=kt&8191,St=kt>>>13;x.negative=h.negative^m.negative,x.length=19,E=Math.imul(at,pt),g=Math.imul(at,Pt),g=g+Math.imul(mt,pt)|0,q=Math.imul(mt,Pt);var Xe=(G+E|0)+((g&8191)<<13)|0;G=(q+(g>>>13)|0)+(Xe>>>26)|0,Xe&=67108863,E=Math.imul(te,pt),g=Math.imul(te,Pt),g=g+Math.imul(Oe,pt)|0,q=Math.imul(Oe,Pt),E=E+Math.imul(at,Ct)|0,g=g+Math.imul(at,Dt)|0,g=g+Math.imul(mt,Ct)|0,q=q+Math.imul(mt,Dt)|0;var jt=(G+E|0)+((g&8191)<<13)|0;G=(q+(g>>>13)|0)+(jt>>>26)|0,jt&=67108863,E=Math.imul(ee,pt),g=Math.imul(ee,Pt),g=g+Math.imul(ve,pt)|0,q=Math.imul(ve,Pt),E=E+Math.imul(te,Ct)|0,g=g+Math.imul(te,Dt)|0,g=g+Math.imul(Oe,Ct)|0,q=q+Math.imul(Oe,Dt)|0,E=E+Math.imul(at,Qt)|0,g=g+Math.imul(at,ne)|0,g=g+Math.imul(mt,Qt)|0,q=q+Math.imul(mt,ne)|0;var de=(G+E|0)+((g&8191)<<13)|0;G=(q+(g>>>13)|0)+(de>>>26)|0,de&=67108863,E=Math.imul(nt,pt),g=Math.imul(nt,Pt),g=g+Math.imul(dt,pt)|0,q=Math.imul(dt,Pt),E=E+Math.imul(ee,Ct)|0,g=g+Math.imul(ee,Dt)|0,g=g+Math.imul(ve,Ct)|0,q=q+Math.imul(ve,Dt)|0,E=E+Math.imul(te,Qt)|0,g=g+Math.imul(te,ne)|0,g=g+Math.imul(Oe,Qt)|0,q=q+Math.imul(Oe,ne)|0,E=E+Math.imul(at,we)|0,g=g+Math.imul(at,ae)|0,g=g+Math.imul(mt,we)|0,q=q+Math.imul(mt,ae)|0;var pe=(G+E|0)+((g&8191)<<13)|0;G=(q+(g>>>13)|0)+(pe>>>26)|0,pe&=67108863,E=Math.imul(Tt,pt),g=Math.imul(Tt,Pt),g=g+Math.imul(Ut,pt)|0,q=Math.imul(Ut,Pt),E=E+Math.imul(nt,Ct)|0,g=g+Math.imul(nt,Dt)|0,g=g+Math.imul(dt,Ct)|0,q=q+Math.imul(dt,Dt)|0,E=E+Math.imul(ee,Qt)|0,g=g+Math.imul(ee,ne)|0,g=g+Math.imul(ve,Qt)|0,q=q+Math.imul(ve,ne)|0,E=E+Math.imul(te,we)|0,g=g+Math.imul(te,ae)|0,g=g+Math.imul(Oe,we)|0,q=q+Math.imul(Oe,ae)|0,E=E+Math.imul(at,ze)|0,g=g+Math.imul(at,Je)|0,g=g+Math.imul(mt,ze)|0,q=q+Math.imul(mt,Je)|0;var ke=(G+E|0)+((g&8191)<<13)|0;G=(q+(g>>>13)|0)+(ke>>>26)|0,ke&=67108863,E=Math.imul(zt,pt),g=Math.imul(zt,Pt),g=g+Math.imul(Vt,pt)|0,q=Math.imul(Vt,Pt),E=E+Math.imul(Tt,Ct)|0,g=g+Math.imul(Tt,Dt)|0,g=g+Math.imul(Ut,Ct)|0,q=q+Math.imul(Ut,Dt)|0,E=E+Math.imul(nt,Qt)|0,g=g+Math.imul(nt,ne)|0,g=g+Math.imul(dt,Qt)|0,q=q+Math.imul(dt,ne)|0,E=E+Math.imul(ee,we)|0,g=g+Math.imul(ee,ae)|0,g=g+Math.imul(ve,we)|0,q=q+Math.imul(ve,ae)|0,E=E+Math.imul(te,ze)|0,g=g+Math.imul(te,Je)|0,g=g+Math.imul(Oe,ze)|0,q=q+Math.imul(Oe,Je)|0,E=E+Math.imul(at,De)|0,g=g+Math.imul(at,Re)|0,g=g+Math.imul(mt,De)|0,q=q+Math.imul(mt,Re)|0;var xe=(G+E|0)+((g&8191)<<13)|0;G=(q+(g>>>13)|0)+(xe>>>26)|0,xe&=67108863,E=Math.imul(re,pt),g=Math.imul(re,Pt),g=g+Math.imul(Jt,pt)|0,q=Math.imul(Jt,Pt),E=E+Math.imul(zt,Ct)|0,g=g+Math.imul(zt,Dt)|0,g=g+Math.imul(Vt,Ct)|0,q=q+Math.imul(Vt,Dt)|0,E=E+Math.imul(Tt,Qt)|0,g=g+Math.imul(Tt,ne)|0,g=g+Math.imul(Ut,Qt)|0,q=q+Math.imul(Ut,ne)|0,E=E+Math.imul(nt,we)|0,g=g+Math.imul(nt,ae)|0,g=g+Math.imul(dt,we)|0,q=q+Math.imul(dt,ae)|0,E=E+Math.imul(ee,ze)|0,g=g+Math.imul(ee,Je)|0,g=g+Math.imul(ve,ze)|0,q=q+Math.imul(ve,Je)|0,E=E+Math.imul(te,De)|0,g=g+Math.imul(te,Re)|0,g=g+Math.imul(Oe,De)|0,q=q+Math.imul(Oe,Re)|0,E=E+Math.imul(at,w)|0,g=g+Math.imul(at,S)|0,g=g+Math.imul(mt,w)|0,q=q+Math.imul(mt,S)|0;var ge=(G+E|0)+((g&8191)<<13)|0;G=(q+(g>>>13)|0)+(ge>>>26)|0,ge&=67108863,E=Math.imul(Ae,pt),g=Math.imul(Ae,Pt),g=g+Math.imul(L,pt)|0,q=Math.imul(L,Pt),E=E+Math.imul(re,Ct)|0,g=g+Math.imul(re,Dt)|0,g=g+Math.imul(Jt,Ct)|0,q=q+Math.imul(Jt,Dt)|0,E=E+Math.imul(zt,Qt)|0,g=g+Math.imul(zt,ne)|0,g=g+Math.imul(Vt,Qt)|0,q=q+Math.imul(Vt,ne)|0,E=E+Math.imul(Tt,we)|0,g=g+Math.imul(Tt,ae)|0,g=g+Math.imul(Ut,we)|0,q=q+Math.imul(Ut,ae)|0,E=E+Math.imul(nt,ze)|0,g=g+Math.imul(nt,Je)|0,g=g+Math.imul(dt,ze)|0,q=q+Math.imul(dt,Je)|0,E=E+Math.imul(ee,De)|0,g=g+Math.imul(ee,Re)|0,g=g+Math.imul(ve,De)|0,q=q+Math.imul(ve,Re)|0,E=E+Math.imul(te,w)|0,g=g+Math.imul(te,S)|0,g=g+Math.imul(Oe,w)|0,q=q+Math.imul(Oe,S)|0,E=E+Math.imul(at,p)|0,g=g+Math.imul(at,C)|0,g=g+Math.imul(mt,p)|0,q=q+Math.imul(mt,C)|0;var be=(G+E|0)+((g&8191)<<13)|0;G=(q+(g>>>13)|0)+(be>>>26)|0,be&=67108863,E=Math.imul(W,pt),g=Math.imul(W,Pt),g=g+Math.imul(tt,pt)|0,q=Math.imul(tt,Pt),E=E+Math.imul(Ae,Ct)|0,g=g+Math.imul(Ae,Dt)|0,g=g+Math.imul(L,Ct)|0,q=q+Math.imul(L,Dt)|0,E=E+Math.imul(re,Qt)|0,g=g+Math.imul(re,ne)|0,g=g+Math.imul(Jt,Qt)|0,q=q+Math.imul(Jt,ne)|0,E=E+Math.imul(zt,we)|0,g=g+Math.imul(zt,ae)|0,g=g+Math.imul(Vt,we)|0,q=q+Math.imul(Vt,ae)|0,E=E+Math.imul(Tt,ze)|0,g=g+Math.imul(Tt,Je)|0,g=g+Math.imul(Ut,ze)|0,q=q+Math.imul(Ut,Je)|0,E=E+Math.imul(nt,De)|0,g=g+Math.imul(nt,Re)|0,g=g+Math.imul(dt,De)|0,q=q+Math.imul(dt,Re)|0,E=E+Math.imul(ee,w)|0,g=g+Math.imul(ee,S)|0,g=g+Math.imul(ve,w)|0,q=q+Math.imul(ve,S)|0,E=E+Math.imul(te,p)|0,g=g+Math.imul(te,C)|0,g=g+Math.imul(Oe,p)|0,q=q+Math.imul(Oe,C)|0,E=E+Math.imul(at,Z)|0,g=g+Math.imul(at,lt)|0,g=g+Math.imul(mt,Z)|0,q=q+Math.imul(mt,lt)|0;var _e=(G+E|0)+((g&8191)<<13)|0;G=(q+(g>>>13)|0)+(_e>>>26)|0,_e&=67108863,E=Math.imul(ut,pt),g=Math.imul(ut,Pt),g=g+Math.imul(yt,pt)|0,q=Math.imul(yt,Pt),E=E+Math.imul(W,Ct)|0,g=g+Math.imul(W,Dt)|0,g=g+Math.imul(tt,Ct)|0,q=q+Math.imul(tt,Dt)|0,E=E+Math.imul(Ae,Qt)|0,g=g+Math.imul(Ae,ne)|0,g=g+Math.imul(L,Qt)|0,q=q+Math.imul(L,ne)|0,E=E+Math.imul(re,we)|0,g=g+Math.imul(re,ae)|0,g=g+Math.imul(Jt,we)|0,q=q+Math.imul(Jt,ae)|0,E=E+Math.imul(zt,ze)|0,g=g+Math.imul(zt,Je)|0,g=g+Math.imul(Vt,ze)|0,q=q+Math.imul(Vt,Je)|0,E=E+Math.imul(Tt,De)|0,g=g+Math.imul(Tt,Re)|0,g=g+Math.imul(Ut,De)|0,q=q+Math.imul(Ut,Re)|0,E=E+Math.imul(nt,w)|0,g=g+Math.imul(nt,S)|0,g=g+Math.imul(dt,w)|0,q=q+Math.imul(dt,S)|0,E=E+Math.imul(ee,p)|0,g=g+Math.imul(ee,C)|0,g=g+Math.imul(ve,p)|0,q=q+Math.imul(ve,C)|0,E=E+Math.imul(te,Z)|0,g=g+Math.imul(te,lt)|0,g=g+Math.imul(Oe,Z)|0,q=q+Math.imul(Oe,lt)|0,E=E+Math.imul(at,Rt)|0,g=g+Math.imul(at,St)|0,g=g+Math.imul(mt,Rt)|0,q=q+Math.imul(mt,St)|0;var Ht=(G+E|0)+((g&8191)<<13)|0;G=(q+(g>>>13)|0)+(Ht>>>26)|0,Ht&=67108863,E=Math.imul(ut,Ct),g=Math.imul(ut,Dt),g=g+Math.imul(yt,Ct)|0,q=Math.imul(yt,Dt),E=E+Math.imul(W,Qt)|0,g=g+Math.imul(W,ne)|0,g=g+Math.imul(tt,Qt)|0,q=q+Math.imul(tt,ne)|0,E=E+Math.imul(Ae,we)|0,g=g+Math.imul(Ae,ae)|0,g=g+Math.imul(L,we)|0,q=q+Math.imul(L,ae)|0,E=E+Math.imul(re,ze)|0,g=g+Math.imul(re,Je)|0,g=g+Math.imul(Jt,ze)|0,q=q+Math.imul(Jt,Je)|0,E=E+Math.imul(zt,De)|0,g=g+Math.imul(zt,Re)|0,g=g+Math.imul(Vt,De)|0,q=q+Math.imul(Vt,Re)|0,E=E+Math.imul(Tt,w)|0,g=g+Math.imul(Tt,S)|0,g=g+Math.imul(Ut,w)|0,q=q+Math.imul(Ut,S)|0,E=E+Math.imul(nt,p)|0,g=g+Math.imul(nt,C)|0,g=g+Math.imul(dt,p)|0,q=q+Math.imul(dt,C)|0,E=E+Math.imul(ee,Z)|0,g=g+Math.imul(ee,lt)|0,g=g+Math.imul(ve,Z)|0,q=q+Math.imul(ve,lt)|0,E=E+Math.imul(te,Rt)|0,g=g+Math.imul(te,St)|0,g=g+Math.imul(Oe,Rt)|0,q=q+Math.imul(Oe,St)|0;var Xt=(G+E|0)+((g&8191)<<13)|0;G=(q+(g>>>13)|0)+(Xt>>>26)|0,Xt&=67108863,E=Math.imul(ut,Qt),g=Math.imul(ut,ne),g=g+Math.imul(yt,Qt)|0,q=Math.imul(yt,ne),E=E+Math.imul(W,we)|0,g=g+Math.imul(W,ae)|0,g=g+Math.imul(tt,we)|0,q=q+Math.imul(tt,ae)|0,E=E+Math.imul(Ae,ze)|0,g=g+Math.imul(Ae,Je)|0,g=g+Math.imul(L,ze)|0,q=q+Math.imul(L,Je)|0,E=E+Math.imul(re,De)|0,g=g+Math.imul(re,Re)|0,g=g+Math.imul(Jt,De)|0,q=q+Math.imul(Jt,Re)|0,E=E+Math.imul(zt,w)|0,g=g+Math.imul(zt,S)|0,g=g+Math.imul(Vt,w)|0,q=q+Math.imul(Vt,S)|0,E=E+Math.imul(Tt,p)|0,g=g+Math.imul(Tt,C)|0,g=g+Math.imul(Ut,p)|0,q=q+Math.imul(Ut,C)|0,E=E+Math.imul(nt,Z)|0,g=g+Math.imul(nt,lt)|0,g=g+Math.imul(dt,Z)|0,q=q+Math.imul(dt,lt)|0,E=E+Math.imul(ee,Rt)|0,g=g+Math.imul(ee,St)|0,g=g+Math.imul(ve,Rt)|0,q=q+Math.imul(ve,St)|0;var Lt=(G+E|0)+((g&8191)<<13)|0;G=(q+(g>>>13)|0)+(Lt>>>26)|0,Lt&=67108863,E=Math.imul(ut,we),g=Math.imul(ut,ae),g=g+Math.imul(yt,we)|0,q=Math.imul(yt,ae),E=E+Math.imul(W,ze)|0,g=g+Math.imul(W,Je)|0,g=g+Math.imul(tt,ze)|0,q=q+Math.imul(tt,Je)|0,E=E+Math.imul(Ae,De)|0,g=g+Math.imul(Ae,Re)|0,g=g+Math.imul(L,De)|0,q=q+Math.imul(L,Re)|0,E=E+Math.imul(re,w)|0,g=g+Math.imul(re,S)|0,g=g+Math.imul(Jt,w)|0,q=q+Math.imul(Jt,S)|0,E=E+Math.imul(zt,p)|0,g=g+Math.imul(zt,C)|0,g=g+Math.imul(Vt,p)|0,q=q+Math.imul(Vt,C)|0,E=E+Math.imul(Tt,Z)|0,g=g+Math.imul(Tt,lt)|0,g=g+Math.imul(Ut,Z)|0,q=q+Math.imul(Ut,lt)|0,E=E+Math.imul(nt,Rt)|0,g=g+Math.imul(nt,St)|0,g=g+Math.imul(dt,Rt)|0,q=q+Math.imul(dt,St)|0;var Gt=(G+E|0)+((g&8191)<<13)|0;G=(q+(g>>>13)|0)+(Gt>>>26)|0,Gt&=67108863,E=Math.imul(ut,ze),g=Math.imul(ut,Je),g=g+Math.imul(yt,ze)|0,q=Math.imul(yt,Je),E=E+Math.imul(W,De)|0,g=g+Math.imul(W,Re)|0,g=g+Math.imul(tt,De)|0,q=q+Math.imul(tt,Re)|0,E=E+Math.imul(Ae,w)|0,g=g+Math.imul(Ae,S)|0,g=g+Math.imul(L,w)|0,q=q+Math.imul(L,S)|0,E=E+Math.imul(re,p)|0,g=g+Math.imul(re,C)|0,g=g+Math.imul(Jt,p)|0,q=q+Math.imul(Jt,C)|0,E=E+Math.imul(zt,Z)|0,g=g+Math.imul(zt,lt)|0,g=g+Math.imul(Vt,Z)|0,q=q+Math.imul(Vt,lt)|0,E=E+Math.imul(Tt,Rt)|0,g=g+Math.imul(Tt,St)|0,g=g+Math.imul(Ut,Rt)|0,q=q+Math.imul(Ut,St)|0;var Wt=(G+E|0)+((g&8191)<<13)|0;G=(q+(g>>>13)|0)+(Wt>>>26)|0,Wt&=67108863,E=Math.imul(ut,De),g=Math.imul(ut,Re),g=g+Math.imul(yt,De)|0,q=Math.imul(yt,Re),E=E+Math.imul(W,w)|0,g=g+Math.imul(W,S)|0,g=g+Math.imul(tt,w)|0,q=q+Math.imul(tt,S)|0,E=E+Math.imul(Ae,p)|0,g=g+Math.imul(Ae,C)|0,g=g+Math.imul(L,p)|0,q=q+Math.imul(L,C)|0,E=E+Math.imul(re,Z)|0,g=g+Math.imul(re,lt)|0,g=g+Math.imul(Jt,Z)|0,q=q+Math.imul(Jt,lt)|0,E=E+Math.imul(zt,Rt)|0,g=g+Math.imul(zt,St)|0,g=g+Math.imul(Vt,Rt)|0,q=q+Math.imul(Vt,St)|0;var $t=(G+E|0)+((g&8191)<<13)|0;G=(q+(g>>>13)|0)+($t>>>26)|0,$t&=67108863,E=Math.imul(ut,w),g=Math.imul(ut,S),g=g+Math.imul(yt,w)|0,q=Math.imul(yt,S),E=E+Math.imul(W,p)|0,g=g+Math.imul(W,C)|0,g=g+Math.imul(tt,p)|0,q=q+Math.imul(tt,C)|0,E=E+Math.imul(Ae,Z)|0,g=g+Math.imul(Ae,lt)|0,g=g+Math.imul(L,Z)|0,q=q+Math.imul(L,lt)|0,E=E+Math.imul(re,Rt)|0,g=g+Math.imul(re,St)|0,g=g+Math.imul(Jt,Rt)|0,q=q+Math.imul(Jt,St)|0;var st=(G+E|0)+((g&8191)<<13)|0;G=(q+(g>>>13)|0)+(st>>>26)|0,st&=67108863,E=Math.imul(ut,p),g=Math.imul(ut,C),g=g+Math.imul(yt,p)|0,q=Math.imul(yt,C),E=E+Math.imul(W,Z)|0,g=g+Math.imul(W,lt)|0,g=g+Math.imul(tt,Z)|0,q=q+Math.imul(tt,lt)|0,E=E+Math.imul(Ae,Rt)|0,g=g+Math.imul(Ae,St)|0,g=g+Math.imul(L,Rt)|0,q=q+Math.imul(L,St)|0;var ot=(G+E|0)+((g&8191)<<13)|0;G=(q+(g>>>13)|0)+(ot>>>26)|0,ot&=67108863,E=Math.imul(ut,Z),g=Math.imul(ut,lt),g=g+Math.imul(yt,Z)|0,q=Math.imul(yt,lt),E=E+Math.imul(W,Rt)|0,g=g+Math.imul(W,St)|0,g=g+Math.imul(tt,Rt)|0,q=q+Math.imul(tt,St)|0;var bt=(G+E|0)+((g&8191)<<13)|0;G=(q+(g>>>13)|0)+(bt>>>26)|0,bt&=67108863,E=Math.imul(ut,Rt),g=Math.imul(ut,St),g=g+Math.imul(yt,Rt)|0,q=Math.imul(yt,St);var ft=(G+E|0)+((g&8191)<<13)|0;return G=(q+(g>>>13)|0)+(ft>>>26)|0,ft&=67108863,j[0]=Xe,j[1]=jt,j[2]=de,j[3]=pe,j[4]=ke,j[5]=xe,j[6]=ge,j[7]=be,j[8]=_e,j[9]=Ht,j[10]=Xt,j[11]=Lt,j[12]=Gt,j[13]=Wt,j[14]=$t,j[15]=st,j[16]=ot,j[17]=bt,j[18]=ft,G!==0&&(j[19]=G,x.length++),x};Math.imul||(R=U);function A(b,h,m){m.negative=h.negative^b.negative,m.length=b.length+h.length;for(var x=0,I=0,N=0;N<m.length-1;N++){var j=I;I=0;for(var G=x&67108863,E=Math.min(N,h.length-1),g=Math.max(0,N-b.length+1);g<=E;g++){var q=N-g,xt=b.words[q]|0,at=h.words[g]|0,mt=xt*at,se=mt&67108863;j=j+(mt/67108864|0)|0,se=se+G|0,G=se&67108863,j=j+(se>>>26)|0,I+=j>>>26,j&=67108863}m.words[N]=G,x=j,j=I}return x!==0?m.words[N]=x:m.length--,m._strip()}function P(b,h,m){return A(b,h,m)}o.prototype.mulTo=function(h,m){var x,I=this.length+h.length;return this.length===10&&h.length===10?x=R(this,h,m):I<63?x=U(this,h,m):I<1024?x=A(this,h,m):x=P(this,h,m),x},o.prototype.mul=function(h){var m=new o(null);return m.words=new Array(this.length+h.length),this.mulTo(h,m)},o.prototype.mulf=function(h){var m=new o(null);return m.words=new Array(this.length+h.length),P(this,h,m)},o.prototype.imul=function(h){return this.clone().mulTo(h,this)},o.prototype.imuln=function(h){var m=h<0;m&&(h=-h),i(typeof h=="number"),i(h<67108864);for(var x=0,I=0;I<this.length;I++){var N=(this.words[I]|0)*h,j=(N&67108863)+(x&67108863);x>>=26,x+=N/67108864|0,x+=j>>>26,this.words[I]=j&67108863}return x!==0&&(this.words[I]=x,this.length++),m?this.ineg():this},o.prototype.muln=function(h){return this.clone().imuln(h)},o.prototype.sqr=function(){return this.mul(this)},o.prototype.isqr=function(){return this.imul(this.clone())},o.prototype.pow=function(h){var m=k(h);if(m.length===0)return new o(1);for(var x=this,I=0;I<m.length&&m[I]===0;I++,x=x.sqr());if(++I<m.length)for(var N=x.sqr();I<m.length;I++,N=N.sqr())m[I]!==0&&(x=x.mul(N));return x},o.prototype.iushln=function(h){i(typeof h=="number"&&h>=0);var m=h%26,x=(h-m)/26,I=67108863>>>26-m<<26-m,N;if(m!==0){var j=0;for(N=0;N<this.length;N++){var G=this.words[N]&I,E=(this.words[N]|0)-G<<m;this.words[N]=E|j,j=G>>>26-m}j&&(this.words[N]=j,this.length++)}if(x!==0){for(N=this.length-1;N>=0;N--)this.words[N+x]=this.words[N];for(N=0;N<x;N++)this.words[N]=0;this.length+=x}return this._strip()},o.prototype.ishln=function(h){return i(this.negative===0),this.iushln(h)},o.prototype.iushrn=function(h,m,x){i(typeof h=="number"&&h>=0);var I;m?I=(m-m%26)/26:I=0;var N=h%26,j=Math.min((h-N)/26,this.length),G=67108863^67108863>>>N<<N,E=x;if(I-=j,I=Math.max(0,I),E){for(var g=0;g<j;g++)E.words[g]=this.words[g];E.length=j}if(j!==0)if(this.length>j)for(this.length-=j,g=0;g<this.length;g++)this.words[g]=this.words[g+j];else this.words[0]=0,this.length=1;var q=0;for(g=this.length-1;g>=0&&(q!==0||g>=I);g--){var xt=this.words[g]|0;this.words[g]=q<<26-N|xt>>>N,q=xt&G}return E&&q!==0&&(E.words[E.length++]=q),this.length===0&&(this.words[0]=0,this.length=1),this._strip()},o.prototype.ishrn=function(h,m,x){return i(this.negative===0),this.iushrn(h,m,x)},o.prototype.shln=function(h){return this.clone().ishln(h)},o.prototype.ushln=function(h){return this.clone().iushln(h)},o.prototype.shrn=function(h){return this.clone().ishrn(h)},o.prototype.ushrn=function(h){return this.clone().iushrn(h)},o.prototype.testn=function(h){i(typeof h=="number"&&h>=0);var m=h%26,x=(h-m)/26,I=1<<m;if(this.length<=x)return!1;var N=this.words[x];return!!(N&I)},o.prototype.imaskn=function(h){i(typeof h=="number"&&h>=0);var m=h%26,x=(h-m)/26;if(i(this.negative===0,"imaskn works only with positive numbers"),this.length<=x)return this;if(m!==0&&x++,this.length=Math.min(x,this.length),m!==0){var I=67108863^67108863>>>m<<m;this.words[this.length-1]&=I}return this._strip()},o.prototype.maskn=function(h){return this.clone().imaskn(h)},o.prototype.iaddn=function(h){return i(typeof h=="number"),i(h<67108864),h<0?this.isubn(-h):this.negative!==0?this.length===1&&(this.words[0]|0)<=h?(this.words[0]=h-(this.words[0]|0),this.negative=0,this):(this.negative=0,this.isubn(h),this.negative=1,this):this._iaddn(h)},o.prototype._iaddn=function(h){this.words[0]+=h;for(var m=0;m<this.length&&this.words[m]>=67108864;m++)this.words[m]-=67108864,m===this.length-1?this.words[m+1]=1:this.words[m+1]++;return this.length=Math.max(this.length,m+1),this},o.prototype.isubn=function(h){if(i(typeof h=="number"),i(h<67108864),h<0)return this.iaddn(-h);if(this.negative!==0)return this.negative=0,this.iaddn(h),this.negative=1,this;if(this.words[0]-=h,this.length===1&&this.words[0]<0)this.words[0]=-this.words[0],this.negative=1;else for(var m=0;m<this.length&&this.words[m]<0;m++)this.words[m]+=67108864,this.words[m+1]-=1;return this._strip()},o.prototype.addn=function(h){return this.clone().iaddn(h)},o.prototype.subn=function(h){return this.clone().isubn(h)},o.prototype.iabs=function(){return this.negative=0,this},o.prototype.abs=function(){return this.clone().iabs()},o.prototype._ishlnsubmul=function(h,m,x){var I=h.length+x,N;this._expand(I);var j,G=0;for(N=0;N<h.length;N++){j=(this.words[N+x]|0)+G;var E=(h.words[N]|0)*m;j-=E&67108863,G=(j>>26)-(E/67108864|0),this.words[N+x]=j&67108863}for(;N<this.length-x;N++)j=(this.words[N+x]|0)+G,G=j>>26,this.words[N+x]=j&67108863;if(G===0)return this._strip();for(i(G===-1),G=0,N=0;N<this.length;N++)j=-(this.words[N]|0)+G,G=j>>26,this.words[N]=j&67108863;return this.negative=1,this._strip()},o.prototype._wordDiv=function(h,m){var x=this.length-h.length,I=this.clone(),N=h,j=N.words[N.length-1]|0,G=this._countBits(j);x=26-G,x!==0&&(N=N.ushln(x),I.iushln(x),j=N.words[N.length-1]|0);var E=I.length-N.length,g;if(m!=="mod"){g=new o(null),g.length=E+1,g.words=new Array(g.length);for(var q=0;q<g.length;q++)g.words[q]=0}var xt=I.clone()._ishlnsubmul(N,1,E);xt.negative===0&&(I=xt,g&&(g.words[E]=1));for(var at=E-1;at>=0;at--){var mt=(I.words[N.length+at]|0)*67108864+(I.words[N.length+at-1]|0);for(mt=Math.min(mt/j|0,67108863),I._ishlnsubmul(N,mt,at);I.negative!==0;)mt--,I.negative=0,I._ishlnsubmul(N,1,at),I.isZero()||(I.negative^=1);g&&(g.words[at]=mt)}return g&&g._strip(),I._strip(),m!=="div"&&x!==0&&I.iushrn(x),{div:g||null,mod:I}},o.prototype.divmod=function(h,m,x){if(i(!h.isZero()),this.isZero())return{div:new o(0),mod:new o(0)};var I,N,j;return this.negative!==0&&h.negative===0?(j=this.neg().divmod(h,m),m!=="mod"&&(I=j.div.neg()),m!=="div"&&(N=j.mod.neg(),x&&N.negative!==0&&N.iadd(h)),{div:I,mod:N}):this.negative===0&&h.negative!==0?(j=this.divmod(h.neg(),m),m!=="mod"&&(I=j.div.neg()),{div:I,mod:j.mod}):this.negative&h.negative?(j=this.neg().divmod(h.neg(),m),m!=="div"&&(N=j.mod.neg(),x&&N.negative!==0&&N.isub(h)),{div:j.div,mod:N}):h.length>this.length||this.cmp(h)<0?{div:new o(0),mod:this}:h.length===1?m==="div"?{div:this.divn(h.words[0]),mod:null}:m==="mod"?{div:null,mod:new o(this.modrn(h.words[0]))}:{div:this.divn(h.words[0]),mod:new o(this.modrn(h.words[0]))}:this._wordDiv(h,m)},o.prototype.div=function(h){return this.divmod(h,"div",!1).div},o.prototype.mod=function(h){return this.divmod(h,"mod",!1).mod},o.prototype.umod=function(h){return this.divmod(h,"mod",!0).mod},o.prototype.divRound=function(h){var m=this.divmod(h);if(m.mod.isZero())return m.div;var x=m.div.negative!==0?m.mod.isub(h):m.mod,I=h.ushrn(1),N=h.andln(1),j=x.cmp(I);return j<0||N===1&&j===0?m.div:m.div.negative!==0?m.div.isubn(1):m.div.iaddn(1)},o.prototype.modrn=function(h){var m=h<0;m&&(h=-h),i(h<=67108863);for(var x=(1<<26)%h,I=0,N=this.length-1;N>=0;N--)I=(x*I+(this.words[N]|0))%h;return m?-I:I},o.prototype.modn=function(h){return this.modrn(h)},o.prototype.idivn=function(h){var m=h<0;m&&(h=-h),i(h<=67108863);for(var x=0,I=this.length-1;I>=0;I--){var N=(this.words[I]|0)+x*67108864;this.words[I]=N/h|0,x=N%h}return this._strip(),m?this.ineg():this},o.prototype.divn=function(h){return this.clone().idivn(h)},o.prototype.egcd=function(h){i(h.negative===0),i(!h.isZero());var m=this,x=h.clone();m.negative!==0?m=m.umod(h):m=m.clone();for(var I=new o(1),N=new o(0),j=new o(0),G=new o(1),E=0;m.isEven()&&x.isEven();)m.iushrn(1),x.iushrn(1),++E;for(var g=x.clone(),q=m.clone();!m.isZero();){for(var xt=0,at=1;!(m.words[0]&at)&&xt<26;++xt,at<<=1);if(xt>0)for(m.iushrn(xt);xt-- >0;)(I.isOdd()||N.isOdd())&&(I.iadd(g),N.isub(q)),I.iushrn(1),N.iushrn(1);for(var mt=0,se=1;!(x.words[0]&se)&&mt<26;++mt,se<<=1);if(mt>0)for(x.iushrn(mt);mt-- >0;)(j.isOdd()||G.isOdd())&&(j.iadd(g),G.isub(q)),j.iushrn(1),G.iushrn(1);m.cmp(x)>=0?(m.isub(x),I.isub(j),N.isub(G)):(x.isub(m),j.isub(I),G.isub(N))}return{a:j,b:G,gcd:x.iushln(E)}},o.prototype._invmp=function(h){i(h.negative===0),i(!h.isZero());var m=this,x=h.clone();m.negative!==0?m=m.umod(h):m=m.clone();for(var I=new o(1),N=new o(0),j=x.clone();m.cmpn(1)>0&&x.cmpn(1)>0;){for(var G=0,E=1;!(m.words[0]&E)&&G<26;++G,E<<=1);if(G>0)for(m.iushrn(G);G-- >0;)I.isOdd()&&I.iadd(j),I.iushrn(1);for(var g=0,q=1;!(x.words[0]&q)&&g<26;++g,q<<=1);if(g>0)for(x.iushrn(g);g-- >0;)N.isOdd()&&N.iadd(j),N.iushrn(1);m.cmp(x)>=0?(m.isub(x),I.isub(N)):(x.isub(m),N.isub(I))}var xt;return m.cmpn(1)===0?xt=I:xt=N,xt.cmpn(0)<0&&xt.iadd(h),xt},o.prototype.gcd=function(h){if(this.isZero())return h.abs();if(h.isZero())return this.abs();var m=this.clone(),x=h.clone();m.negative=0,x.negative=0;for(var I=0;m.isEven()&&x.isEven();I++)m.iushrn(1),x.iushrn(1);do{for(;m.isEven();)m.iushrn(1);for(;x.isEven();)x.iushrn(1);var N=m.cmp(x);if(N<0){var j=m;m=x,x=j}else if(N===0||x.cmpn(1)===0)break;m.isub(x)}while(!0);return x.iushln(I)},o.prototype.invm=function(h){return this.egcd(h).a.umod(h)},o.prototype.isEven=function(){return(this.words[0]&1)===0},o.prototype.isOdd=function(){return(this.words[0]&1)===1},o.prototype.andln=function(h){return this.words[0]&h},o.prototype.bincn=function(h){i(typeof h=="number");var m=h%26,x=(h-m)/26,I=1<<m;if(this.length<=x)return this._expand(x+1),this.words[x]|=I,this;for(var N=I,j=x;N!==0&&j<this.length;j++){var G=this.words[j]|0;G+=N,N=G>>>26,G&=67108863,this.words[j]=G}return N!==0&&(this.words[j]=N,this.length++),this},o.prototype.isZero=function(){return this.length===1&&this.words[0]===0},o.prototype.cmpn=function(h){var m=h<0;if(this.negative!==0&&!m)return-1;if(this.negative===0&&m)return 1;this._strip();var x;if(this.length>1)x=1;else{m&&(h=-h),i(h<=67108863,"Number is too big");var I=this.words[0]|0;x=I===h?0:I<h?-1:1}return this.negative!==0?-x|0:x},o.prototype.cmp=function(h){if(this.negative!==0&&h.negative===0)return-1;if(this.negative===0&&h.negative!==0)return 1;var m=this.ucmp(h);return this.negative!==0?-m|0:m},o.prototype.ucmp=function(h){if(this.length>h.length)return 1;if(this.length<h.length)return-1;for(var m=0,x=this.length-1;x>=0;x--){var I=this.words[x]|0,N=h.words[x]|0;if(I!==N){I<N?m=-1:I>N&&(m=1);break}}return m},o.prototype.gtn=function(h){return this.cmpn(h)===1},o.prototype.gt=function(h){return this.cmp(h)===1},o.prototype.gten=function(h){return this.cmpn(h)>=0},o.prototype.gte=function(h){return this.cmp(h)>=0},o.prototype.ltn=function(h){return this.cmpn(h)===-1},o.prototype.lt=function(h){return this.cmp(h)===-1},o.prototype.lten=function(h){return this.cmpn(h)<=0},o.prototype.lte=function(h){return this.cmp(h)<=0},o.prototype.eqn=function(h){return this.cmpn(h)===0},o.prototype.eq=function(h){return this.cmp(h)===0},o.red=function(h){return new O(h)},o.prototype.toRed=function(h){return i(!this.red,"Already a number in reduction context"),i(this.negative===0,"red works only with positives"),h.convertTo(this)._forceRed(h)},o.prototype.fromRed=function(){return i(this.red,"fromRed works only with numbers in reduction context"),this.red.convertFrom(this)},o.prototype._forceRed=function(h){return this.red=h,this},o.prototype.forceRed=function(h){return i(!this.red,"Already a number in reduction context"),this._forceRed(h)},o.prototype.redAdd=function(h){return i(this.red,"redAdd works only with red numbers"),this.red.add(this,h)},o.prototype.redIAdd=function(h){return i(this.red,"redIAdd works only with red numbers"),this.red.iadd(this,h)},o.prototype.redSub=function(h){return i(this.red,"redSub works only with red numbers"),this.red.sub(this,h)},o.prototype.redISub=function(h){return i(this.red,"redISub works only with red numbers"),this.red.isub(this,h)},o.prototype.redShl=function(h){return i(this.red,"redShl works only with red numbers"),this.red.shl(this,h)},o.prototype.redMul=function(h){return i(this.red,"redMul works only with red numbers"),this.red._verify2(this,h),this.red.mul(this,h)},o.prototype.redIMul=function(h){return i(this.red,"redMul works only with red numbers"),this.red._verify2(this,h),this.red.imul(this,h)},o.prototype.redSqr=function(){return i(this.red,"redSqr works only with red numbers"),this.red._verify1(this),this.red.sqr(this)},o.prototype.redISqr=function(){return i(this.red,"redISqr works only with red numbers"),this.red._verify1(this),this.red.isqr(this)},o.prototype.redSqrt=function(){return i(this.red,"redSqrt works only with red numbers"),this.red._verify1(this),this.red.sqrt(this)},o.prototype.redInvm=function(){return i(this.red,"redInvm works only with red numbers"),this.red._verify1(this),this.red.invm(this)},o.prototype.redNeg=function(){return i(this.red,"redNeg works only with red numbers"),this.red._verify1(this),this.red.neg(this)},o.prototype.redPow=function(h){return i(this.red&&!h.red,"redPow(normalNum)"),this.red._verify1(this),this.red.pow(this,h)};var M={k256:null,p224:null,p192:null,p25519:null};function K(b,h){this.name=b,this.p=new o(h,16),this.n=this.p.bitLength(),this.k=new o(1).iushln(this.n).isub(this.p),this.tmp=this._tmp()}K.prototype._tmp=function(){var h=new o(null);return h.words=new Array(Math.ceil(this.n/13)),h},K.prototype.ireduce=function(h){var m=h,x;do this.split(m,this.tmp),m=this.imulK(m),m=m.iadd(this.tmp),x=m.bitLength();while(x>this.n);var I=x<this.n?-1:m.ucmp(this.p);return I===0?(m.words[0]=0,m.length=1):I>0?m.isub(this.p):m.strip!==void 0?m.strip():m._strip(),m},K.prototype.split=function(h,m){h.iushrn(this.n,0,m)},K.prototype.imulK=function(h){return h.imul(this.k)};function Y(){K.call(this,"k256","ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f")}s(Y,K),Y.prototype.split=function(h,m){for(var x=4194303,I=Math.min(h.length,9),N=0;N<I;N++)m.words[N]=h.words[N];if(m.length=I,h.length<=9){h.words[0]=0,h.length=1;return}var j=h.words[9];for(m.words[m.length++]=j&x,N=10;N<h.length;N++){var G=h.words[N]|0;h.words[N-10]=(G&x)<<4|j>>>22,j=G}j>>>=22,h.words[N-10]=j,j===0&&h.length>10?h.length-=10:h.length-=9},Y.prototype.imulK=function(h){h.words[h.length]=0,h.words[h.length+1]=0,h.length+=2;for(var m=0,x=0;x<h.length;x++){var I=h.words[x]|0;m+=I*977,h.words[x]=m&67108863,m=I*64+(m/67108864|0)}return h.words[h.length-1]===0&&(h.length--,h.words[h.length-1]===0&&h.length--),h};function X(){K.call(this,"p224","ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001")}s(X,K);function et(){K.call(this,"p192","ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff")}s(et,K);function z(){K.call(this,"25519","7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed")}s(z,K),z.prototype.imulK=function(h){for(var m=0,x=0;x<h.length;x++){var I=(h.words[x]|0)*19+m,N=I&67108863;I>>>=26,h.words[x]=N,m=I}return m!==0&&(h.words[h.length++]=m),h},o._prime=function(h){if(M[h])return M[h];var m;if(h==="k256")m=new Y;else if(h==="p224")m=new X;else if(h==="p192")m=new et;else if(h==="p25519")m=new z;else throw new Error("Unknown prime "+h);return M[h]=m,m};function O(b){if(typeof b=="string"){var h=o._prime(b);this.m=h.p,this.prime=h}else i(b.gtn(1),"modulus must be greater than 1"),this.m=b,this.prime=null}O.prototype._verify1=function(h){i(h.negative===0,"red works only with positives"),i(h.red,"red works only with red numbers")},O.prototype._verify2=function(h,m){i((h.negative|m.negative)===0,"red works only with positives"),i(h.red&&h.red===m.red,"red works only with red numbers")},O.prototype.imod=function(h){return this.prime?this.prime.ireduce(h)._forceRed(this):(l(h,h.umod(this.m)._forceRed(this)),h)},O.prototype.neg=function(h){return h.isZero()?h.clone():this.m.sub(h)._forceRed(this)},O.prototype.add=function(h,m){this._verify2(h,m);var x=h.add(m);return x.cmp(this.m)>=0&&x.isub(this.m),x._forceRed(this)},O.prototype.iadd=function(h,m){this._verify2(h,m);var x=h.iadd(m);return x.cmp(this.m)>=0&&x.isub(this.m),x},O.prototype.sub=function(h,m){this._verify2(h,m);var x=h.sub(m);return x.cmpn(0)<0&&x.iadd(this.m),x._forceRed(this)},O.prototype.isub=function(h,m){this._verify2(h,m);var x=h.isub(m);return x.cmpn(0)<0&&x.iadd(this.m),x},O.prototype.shl=function(h,m){return this._verify1(h),this.imod(h.ushln(m))},O.prototype.imul=function(h,m){return this._verify2(h,m),this.imod(h.imul(m))},O.prototype.mul=function(h,m){return this._verify2(h,m),this.imod(h.mul(m))},O.prototype.isqr=function(h){return this.imul(h,h.clone())},O.prototype.sqr=function(h){return this.mul(h,h)},O.prototype.sqrt=function(h){if(h.isZero())return h.clone();var m=this.m.andln(3);if(i(m%2===1),m===3){var x=this.m.add(new o(1)).iushrn(2);return this.pow(h,x)}for(var I=this.m.subn(1),N=0;!I.isZero()&&I.andln(1)===0;)N++,I.iushrn(1);i(!I.isZero());var j=new o(1).toRed(this),G=j.redNeg(),E=this.m.subn(1).iushrn(1),g=this.m.bitLength();for(g=new o(2*g*g).toRed(this);this.pow(g,E).cmp(G)!==0;)g.redIAdd(G);for(var q=this.pow(g,I),xt=this.pow(h,I.addn(1).iushrn(1)),at=this.pow(h,I),mt=N;at.cmp(j)!==0;){for(var se=at,te=0;se.cmp(j)!==0;te++)se=se.redSqr();i(te<mt);var Oe=this.pow(q,new o(1).iushln(mt-te-1));xt=xt.redMul(Oe),q=Oe.redSqr(),at=at.redMul(q),mt=te}return xt},O.prototype.invm=function(h){var m=h._invmp(this.m);return m.negative!==0?(m.negative=0,this.imod(m).redNeg()):this.imod(m)},O.prototype.pow=function(h,m){if(m.isZero())return new o(1).toRed(this);if(m.cmpn(1)===0)return h.clone();var x=4,I=new Array(1<<x);I[0]=new o(1).toRed(this),I[1]=h;for(var N=2;N<I.length;N++)I[N]=this.mul(I[N-1],h);var j=I[0],G=0,E=0,g=m.bitLength()%26;for(g===0&&(g=26),N=m.length-1;N>=0;N--){for(var q=m.words[N],xt=g-1;xt>=0;xt--){var at=q>>xt&1;if(j!==I[0]&&(j=this.sqr(j)),at===0&&G===0){E=0;continue}G<<=1,G|=at,E++,!(E!==x&&(N!==0||xt!==0))&&(j=this.mul(j,I[G]),E=0,G=0)}g=26}return j},O.prototype.convertTo=function(h){var m=h.umod(this.m);return m===h?m.clone():m},O.prototype.convertFrom=function(h){var m=h.clone();return m.red=null,m},o.mont=function(h){return new $(h)};function $(b){O.call(this,b),this.shift=this.m.bitLength(),this.shift%26!==0&&(this.shift+=26-this.shift%26),this.r=new o(1).iushln(this.shift),this.r2=this.imod(this.r.sqr()),this.rinv=this.r._invmp(this.m),this.minv=this.rinv.mul(this.r).isubn(1).div(this.m),this.minv=this.minv.umod(this.r),this.minv=this.r.sub(this.minv)}s($,O),$.prototype.convertTo=function(h){return this.imod(h.ushln(this.shift))},$.prototype.convertFrom=function(h){var m=this.imod(h.mul(this.rinv));return m.red=null,m},$.prototype.imul=function(h,m){if(h.isZero()||m.isZero())return h.words[0]=0,h.length=1,h;var x=h.imul(m),I=x.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),N=x.isub(I).iushrn(this.shift),j=N;return N.cmp(this.m)>=0?j=N.isub(this.m):N.cmpn(0)<0&&(j=N.iadd(this.m)),j._forceRed(this)},$.prototype.mul=function(h,m){if(h.isZero()||m.isZero())return new o(0)._forceRed(this);var x=h.mul(m),I=x.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),N=x.isub(I).iushrn(this.shift),j=N;return N.cmp(this.m)>=0?j=N.isub(this.m):N.cmpn(0)<0&&(j=N.iadd(this.m)),j._forceRed(this)},$.prototype.invm=function(h){var m=this.imod(h._invmp(this.m).mul(this.r2));return m._forceRed(this)}})(t,B_)})(FT);var jT="Invariant failed";function zT(t,e){if(!t)throw new Error(jT)}const Lg="3.7.5",HT=Lg,KT=typeof atob=="function",GT=typeof btoa=="function",pr=typeof Buffer=="function",uh=typeof TextDecoder=="function"?new TextDecoder:void 0,lh=typeof TextEncoder=="function"?new TextEncoder:void 0,WT="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",kr=Array.prototype.slice.call(WT),wa=(t=>{let e={};return t.forEach((n,i)=>e[n]=i),e})(kr),XT=/^(?:[A-Za-z\d+\/]{4})*?(?:[A-Za-z\d+\/]{2}(?:==)?|[A-Za-z\d+\/]{3}=?)?$/,Dn=String.fromCharCode.bind(String),dh=typeof Uint8Array.from=="function"?Uint8Array.from.bind(Uint8Array):t=>new Uint8Array(Array.prototype.slice.call(t,0)),Ng=t=>t.replace(/=/g,"").replace(/[+\/]/g,e=>e=="+"?"-":"_"),Fg=t=>t.replace(/[^A-Za-z0-9\+\/]/g,""),jg=t=>{let e,n,i,s,o="";const r=t.length%3;for(let a=0;a<t.length;){if((n=t.charCodeAt(a++))>255||(i=t.charCodeAt(a++))>255||(s=t.charCodeAt(a++))>255)throw new TypeError("invalid character found");e=n<<16|i<<8|s,o+=kr[e>>18&63]+kr[e>>12&63]+kr[e>>6&63]+kr[e&63]}return r?o.slice(0,r-3)+"===".substring(r):o},wd=GT?t=>btoa(t):pr?t=>Buffer.from(t,"binary").toString("base64"):jg,gl=pr?t=>Buffer.from(t).toString("base64"):t=>{let n=[];for(let i=0,s=t.length;i<s;i+=4096)n.push(Dn.apply(null,t.subarray(i,i+4096)));return wd(n.join(""))},La=(t,e=!1)=>e?Ng(gl(t)):gl(t),VT=t=>{if(t.length<2){var e=t.charCodeAt(0);return e<128?t:e<2048?Dn(192|e>>>6)+Dn(128|e&63):Dn(224|e>>>12&15)+Dn(128|e>>>6&63)+Dn(128|e&63)}else{var e=65536+(t.charCodeAt(0)-55296)*1024+(t.charCodeAt(1)-56320);return Dn(240|e>>>18&7)+Dn(128|e>>>12&63)+Dn(128|e>>>6&63)+Dn(128|e&63)}},JT=/[\uD800-\uDBFF][\uDC00-\uDFFFF]|[^\x00-\x7F]/g,zg=t=>t.replace(JT,VT),hh=pr?t=>Buffer.from(t,"utf8").toString("base64"):lh?t=>gl(lh.encode(t)):t=>wd(zg(t)),Do=(t,e=!1)=>e?Ng(hh(t)):hh(t),fh=t=>Do(t,!0),ZT=/[\xC0-\xDF][\x80-\xBF]|[\xE0-\xEF][\x80-\xBF]{2}|[\xF0-\xF7][\x80-\xBF]{3}/g,YT=t=>{switch(t.length){case 4:var e=(7&t.charCodeAt(0))<<18|(63&t.charCodeAt(1))<<12|(63&t.charCodeAt(2))<<6|63&t.charCodeAt(3),n=e-65536;return Dn((n>>>10)+55296)+Dn((n&1023)+56320);case 3:return Dn((15&t.charCodeAt(0))<<12|(63&t.charCodeAt(1))<<6|63&t.charCodeAt(2));default:return Dn((31&t.charCodeAt(0))<<6|63&t.charCodeAt(1))}},Hg=t=>t.replace(ZT,YT),Kg=t=>{if(t=t.replace(/\s+/g,""),!XT.test(t))throw new TypeError("malformed base64.");t+="==".slice(2-(t.length&3));let e,n="",i,s;for(let o=0;o<t.length;)e=wa[t.charAt(o++)]<<18|wa[t.charAt(o++)]<<12|(i=wa[t.charAt(o++)])<<6|(s=wa[t.charAt(o++)]),n+=i===64?Dn(e>>16&255):s===64?Dn(e>>16&255,e>>8&255):Dn(e>>16&255,e>>8&255,e&255);return n},bd=KT?t=>atob(Fg(t)):pr?t=>Buffer.from(t,"base64").toString("binary"):Kg,Gg=pr?t=>dh(Buffer.from(t,"base64")):t=>dh(bd(t).split("").map(e=>e.charCodeAt(0))),Wg=t=>Gg(Xg(t)),QT=pr?t=>Buffer.from(t,"base64").toString("utf8"):uh?t=>uh.decode(Gg(t)):t=>Hg(bd(t)),Xg=t=>Fg(t.replace(/[-_]/g,e=>e=="-"?"+":"/")),_l=t=>QT(Xg(t)),tA=t=>{if(typeof t!="string")return!1;const e=t.replace(/\s+/g,"").replace(/={0,2}$/,"");return!/[^\s0-9a-zA-Z\+/]/.test(e)||!/[^\s0-9a-zA-Z\-_]/.test(e)},Vg=t=>({value:t,enumerable:!1,writable:!0,configurable:!0}),Jg=function(){const t=(e,n)=>Object.defineProperty(String.prototype,e,Vg(n));t("fromBase64",function(){return _l(this)}),t("toBase64",function(e){return Do(this,e)}),t("toBase64URI",function(){return Do(this,!0)}),t("toBase64URL",function(){return Do(this,!0)}),t("toUint8Array",function(){return Wg(this)})},Zg=function(){const t=(e,n)=>Object.defineProperty(Uint8Array.prototype,e,Vg(n));t("toBase64",function(e){return La(this,e)}),t("toBase64URI",function(){return La(this,!0)}),t("toBase64URL",function(){return La(this,!0)})},eA=()=>{Jg(),Zg()},Lo={version:Lg,VERSION:HT,atob:bd,atobPolyfill:Kg,btoa:wd,btoaPolyfill:jg,fromBase64:_l,toBase64:Do,encode:Do,encodeURI:fh,encodeURL:fh,utob:zg,btou:Hg,decode:_l,isValid:tA,fromUint8Array:La,toUint8Array:Wg,extendString:Jg,extendUint8Array:Zg,extendBuiltins:eA};function Fu(t,e){var n={label:0,sent:function(){if(o[0]&1)throw o[1];return o[1]},trys:[],ops:[]},i,s,o,r;return r={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(r[Symbol.iterator]=function(){return this}),r;function a(u){return function(l){return c([u,l])}}function c(u){if(i)throw new TypeError("Generator is already executing.");for(;r&&(r=0,u[0]&&(n=0)),n;)try{if(i=1,s&&(o=u[0]&2?s.return:u[0]?s.throw||((o=s.return)&&o.call(s),0):s.next)&&!(o=o.call(s,u[1])).done)return o;switch(s=0,o&&(u=[u[0]&2,o.value]),u[0]){case 0:case 1:o=u;break;case 4:return n.label++,{value:u[1],done:!1};case 5:n.label++,s=u[1],u=[0];continue;case 7:u=n.ops.pop(),n.trys.pop();continue;default:if(o=n.trys,!(o=o.length>0&&o[o.length-1])&&(u[0]===6||u[0]===2)){n=0;continue}if(u[0]===3&&(!o||u[1]>o[0]&&u[1]<o[3])){n.label=u[1];break}if(u[0]===6&&n.label<o[1]){n.label=o[1],o=u;break}if(o&&n.label<o[2]){n.label=o[2],n.ops.push(u);break}o[2]&&n.ops.pop(),n.trys.pop();continue}u=e.call(t,n)}catch(l){u=[6,l],s=0}finally{i=o=0}if(u[0]&5)throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}}var As;(function(t){t[t.EQUAL=0]="EQUAL",t[t.GREATER=1]="GREATER",t[t.LESS=-1]="LESS"})(As||(As={}));var nA=function(){function t(e){this.compare=e||t.defaultCompareFunction}return t.defaultCompareFunction=function(e,n){return e===n?As.EQUAL:e<n?As.LESS:As.GREATER},t.prototype.equal=function(e,n){return this.compare(e,n)===As.EQUAL},t.prototype.lessThan=function(e,n){return this.compare(e,n)===As.LESS},t.prototype.greaterThan=function(e,n){return this.compare(e,n)===As.GREATER},t.prototype.lessThanOrEqual=function(e,n){return this.lessThan(e,n)||this.equal(e,n)},t.prototype.greaterThanOrEqual=function(e,n){return this.greaterThan(e,n)||this.equal(e,n)},t.prototype.reverse=function(){var e=this.compare;this.compare=function(n,i){return e(i,n)}},t}(),ph=function(){function t(e){this.value=e,this.next=null}return t}(),gh=function(){function t(e){this.value=e,this.next=null,this.prev=null}return t}();/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */var ml=function(t,e){return ml=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var s in i)i.hasOwnProperty(s)&&(n[s]=i[s])},ml(t,e)};function gr(t,e){ml(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}function Nr(t,e){var n={label:0,sent:function(){if(o[0]&1)throw o[1];return o[1]},trys:[],ops:[]},i,s,o,r;return r={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(r[Symbol.iterator]=function(){return this}),r;function a(u){return function(l){return c([u,l])}}function c(u){if(i)throw new TypeError("Generator is already executing.");for(;n;)try{if(i=1,s&&(o=u[0]&2?s.return:u[0]?s.throw||((o=s.return)&&o.call(s),0):s.next)&&!(o=o.call(s,u[1])).done)return o;switch(s=0,o&&(u=[u[0]&2,o.value]),u[0]){case 0:case 1:o=u;break;case 4:return n.label++,{value:u[1],done:!1};case 5:n.label++,s=u[1],u=[0];continue;case 7:u=n.ops.pop(),n.trys.pop();continue;default:if(o=n.trys,!(o=o.length>0&&o[o.length-1])&&(u[0]===6||u[0]===2)){n=0;continue}if(u[0]===3&&(!o||u[1]>o[0]&&u[1]<o[3])){n.label=u[1];break}if(u[0]===6&&n.label<o[1]){n.label=o[1],o=u;break}if(o&&n.label<o[2]){n.label=o[2],n.ops.push(u);break}o[2]&&n.ops.pop(),n.trys.pop();continue}u=e.call(t,n)}catch(l){u=[6,l],s=0}finally{i=o=0}if(u[0]&5)throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}}function iA(t,e){var n=typeof Symbol=="function"&&t[Symbol.iterator];if(!n)return t;var i=n.call(t),s,o=[],r;try{for(;(e===void 0||e-- >0)&&!(s=i.next()).done;)o.push(s.value)}catch(a){r={error:a}}finally{try{s&&!s.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}return o}function $i(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(iA(arguments[e]));return t}var sA="obfuse error occur";function Ya(t,e){if(!t)throw new Error("[linked-list] "+(e||sA))}var oA=-1,Yg=function(){function t(){for(var e=this,n=[],i=0;i<arguments.length;i++)n[i]=arguments[i];this._head=null,this._tail=null,this._length=0,this.compare=new nA,n.length>0&&n.forEach(function(s){e.append(s)})}return Object.defineProperty(t.prototype,"head",{get:function(){return this._head?this._head.value:void 0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"tail",{get:function(){return this._tail?this._tail.value:void 0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"length",{get:function(){return this._length},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"loopLength",{get:function(){var e=!1,n=1;if(!this._head)return 0;for(var i=this._head,s=this._head;s.next&&s.next.next;)if(s=s.next.next,i=i.next,i===s){e=!0;break}if(e){for(s=s.next;i!==s;)n++,s=s.next;return n}else return 0},enumerable:!0,configurable:!0}),t.prototype.getNode=function(e){var n=this._length;Ya(n>0&&e>=0&&e<n,"[linked-list] index "+e+" out of scope of list, which length is "+n);for(var i=this._head,s=0;s<e;)i=i.next,s++;return i},t.prototype.get=function(e){var n=this.getNode(e);return n?n.value:null},t.prototype.find=function(e){var n=e.value,i=e.callback;if(!this._head)return null;for(var s=this._head;s;){if(i&&i(s.value)||n!==void 0&&this.compare.equal(s.value,n))return s;s=s.next}return null},t.prototype.indexOf=function(e){if(!this._head)return oA;for(var n=this._head,i=-1;n.next;){if(i++,this.compare.equal(n.value,e))return i;n=n.next}return n===this._tail&&this.compare.equal(n.value,e)&&(i+=1),i},t.prototype.first=function(e){Ya(e>=0,"[linked-list] param 'num' ("+e+") should not less than 0");for(var n=this.iterator(),i=[],s=Math.min(e,this.length),o=0;o<s;o++){var r=n.next();i.push(r.value)}return i},t.prototype.toArray=function(){return $i(this)},t.prototype.isEmpty=function(){return this._head===null},t.prototype.iterator=function(){var e;return Nr(this,function(n){switch(n.label){case 0:e=this._head,n.label=1;case 1:return e?[4,e.value]:[3,3];case 2:return n.sent(),e=e.next,[3,1];case 3:return[2]}})},t.prototype[Symbol.iterator]=function(){return this.iterator()},t}(),Fr=function(t){gr(e,t);function e(){for(var n=[],i=0;i<arguments.length;i++)n[i]=arguments[i];return t.apply(this,$i(n))||this}return e.prototype.append=function(n){var i=new ph(n);return this._tail?(this._tail.next=i,this._tail=i):this._head=this._tail=i,this._length++,!0},e.prototype.prepend=function(n){var i=new ph(n);return this._head?(i.next=this._head,this._head=i):this._head=this._tail=i,this._length++,!0},e.prototype.remove=function(n){var i=this._head;if(i){if(this.compare.equal(i.value,n))return i.next?(this._head=i.next,i.next=null):this._head=this._tail=null,this._length--,n;for(var s=i;;){if(this.compare.equal(i.value,n))return i.next?s.next=i.next:(this._tail=s,this._tail.next=null),i.next=null,this._length--,n;if(i.next)s=i,i=i.next;else return}}},e.prototype.removeHead=function(){var n=this._head;if(n)return this._head.next?(this._head=n.next,n.next=null):(this._head=null,this._tail=null),this._length--,n.value},e.prototype.removeTail=function(){var n=this._tail;if(n){if(!this._head.next)this._head=null,this._tail=null;else{for(var i=this._head;i.next!==n;)i=i.next;i.next=null,this._tail=i}return this._length--,n.value}},e.prototype.reverse=function(){if(this._head){var n=this._head,i=null,s;for(this._tail=this._head;n!==null;)s=n.next,n.next=i,i=n,n=s;this._head=i}},e.prototype.clone=function(){var n=this.toArray();return new(e.bind.apply(e,$i([void 0],n)))},e}(Yg),rA=function(t){gr(e,t);function e(){for(var n=[],i=0;i<arguments.length;i++)n[i]=arguments[i];var s=t.apply(this,$i(n))||this;return s.cyclization(),s}return e.prototype.iterator=function(){var n;return Nr(this,function(i){switch(i.label){case 0:n=this._head,i.label=1;case 1:return n?[4,n.value]:[3,3];case 2:return i.sent(),n=n.next,n===this._head&&(n=null),[3,1];case 3:return[2]}})},e.prototype.circleIterator=function(){var n;return Nr(this,function(i){switch(i.label){case 0:n=this._head,i.label=1;case 1:return n?[4,n.value]:[3,3];case 2:return i.sent(),n=n.next,[3,1];case 3:return[2]}})},e.prototype[Symbol.iterator]=function(){return this.iterator()},e.prototype.mapToNormalListFn=function(n){for(var i=[],s=1;s<arguments.length;s++)i[s-1]=arguments[s];this.breakCircle();var o=t.prototype[n].apply(this,i);return this.cyclization(),o},e.prototype.getNode=function(n){return this.mapToNormalListFn("getNode",n)},e.prototype.append=function(n){return this.mapToNormalListFn("append",n)},e.prototype.prepend=function(n){return this.mapToNormalListFn("prepend",n)},e.prototype.find=function(n){return this.mapToNormalListFn("find",n)},e.prototype.indexOf=function(n){return this.mapToNormalListFn("indexOf",n)},e.prototype.remove=function(n){return this.mapToNormalListFn("remove",n)},e.prototype.removeHead=function(){return this.mapToNormalListFn("removeHead")},e.prototype.removeTail=function(){return this.mapToNormalListFn("removeTail")},e.prototype.first=function(n){Ya(n>=0,"[linked-list] param 'num' ("+n+") should not less than 0");for(var i=this.circleIterator(),s=[],o=0;o<n;o++){var r=i.next();s.push(r.value)}return s},e.prototype.toArray=function(){return this.mapToNormalListFn("toArray")},e.prototype.reverse=function(){return this.mapToNormalListFn("reverse")},e}(Fr);(function(t){gr(e,t);function e(){for(var n=[],i=0;i<arguments.length;i++)n[i]=arguments[i];var s=t.apply(this,$i(n))||this;return s.cyclization(),s}return e.prototype.breakCircle=function(){this._tail&&this._tail.next===this._head&&(this._tail.next=null)},e.prototype.cyclization=function(){this._tail&&this._tail.next===null&&(this._tail.next=this._head)},e.prototype.clone=function(){var n=this.toArray();return new(e.bind.apply(e,$i([void 0],n)))},e})(rA);var aA=function(t){gr(e,t);function e(){for(var n=[],i=0;i<arguments.length;i++)n[i]=arguments[i];return t.apply(this,$i(n))||this}return e.prototype.append=function(n){var i=new gh(n);return this._tail?(this._tail.next=i,i.prev=this._tail,this._tail=i):this._head=this._tail=i,this._length++,!0},e.prototype.prepend=function(n){var i=new gh(n);return this._head?(i.next=this._head,this._head.prev=i,this._head=i):this._head=this._tail=i,this._length++,!0},e.prototype.remove=function(n){var i=this._head;if(i){if(this.compare.equal(i.value,n))return i.next?(this._head=i.next,this._head.prev=null,i.next=i.prev=null):this._head=this._tail=null,this._length--,n;for(;;){if(this.compare.equal(i.value,n))return i.next?(i.prev.next=i.next,i.next.prev=i.prev,i.next=i.prev=null):(i.prev.next=null,this._tail=i.prev,i.next=i.prev=null),this._length--,i.value;if(i.next)i=i.next;else return}}},e.prototype.removeHead=function(){var n=this._head;if(n)return this._head.next?(n.next.prev=null,this._head=n.next,n.next=null):(this._head=null,this._tail=null),this._length--,n.value},e.prototype.removeTail=function(){var n=this._tail;if(n)return this._head.next?(n.prev.next=null,this._tail=n.prev,n.next=n.prev=null):(this._head=null,this._tail=null),this._length--,n.value},e.prototype.reverse=function(){if(this._head){var n=this._head,i=null,s;for(this._tail=this._head;n!==null;)s=n.next,n.next=i,n.prev=s,i=n,n=s;this._head=i}},e.prototype.clone=function(){var n=this.toArray();return new(e.bind.apply(e,$i([void 0],n)))},e}(Yg),cA=function(t){gr(e,t);function e(){for(var n=[],i=0;i<arguments.length;i++)n[i]=arguments[i];var s=t.apply(this,$i(n))||this;return s.cyclization(),s}return e.prototype.iterator=function(){var n;return Nr(this,function(i){switch(i.label){case 0:n=this._head,i.label=1;case 1:return n?[4,n.value]:[3,3];case 2:return i.sent(),n=n.next,n===this._head&&(n=null),[3,1];case 3:return[2]}})},e.prototype.circleIterator=function(){var n;return Nr(this,function(i){switch(i.label){case 0:n=this._head,i.label=1;case 1:return n?[4,n.value]:[3,3];case 2:return i.sent(),n=n.next,[3,1];case 3:return[2]}})},e.prototype[Symbol.iterator]=function(){return this.iterator()},e.prototype.mapToNormalListFn=function(n){for(var i=[],s=1;s<arguments.length;s++)i[s-1]=arguments[s];this.breakCircle();var o=t.prototype[n].apply(this,i);return this.cyclization(),o},e.prototype.getNode=function(n){return this.mapToNormalListFn("getNode",n)},e.prototype.append=function(n){return this.mapToNormalListFn("append",n)},e.prototype.prepend=function(n){return this.mapToNormalListFn("prepend",n)},e.prototype.find=function(n){return this.mapToNormalListFn("find",n)},e.prototype.indexOf=function(n){return this.mapToNormalListFn("indexOf",n)},e.prototype.remove=function(n){return this.mapToNormalListFn("remove",n)},e.prototype.removeHead=function(){return this.mapToNormalListFn("removeHead")},e.prototype.removeTail=function(){return this.mapToNormalListFn("removeTail")},e.prototype.first=function(n){Ya(n>=0,"[linked-list] param 'num' ("+n+") should not less than 0");for(var i=this.circleIterator(),s=[],o=0;o<n;o++){var r=i.next();s.push(r.value)}return s},e.prototype.toArray=function(){return this.mapToNormalListFn("toArray")},e.prototype.reverse=function(){return this.mapToNormalListFn("reverse")},e}(aA);(function(t){gr(e,t);function e(){for(var n=[],i=0;i<arguments.length;i++)n[i]=arguments[i];var s=t.apply(this,$i(n))||this;return s.cyclization(),s}return e.prototype.breakCircle=function(){this._tail&&this._head&&this._tail.next===this._head&&(this._tail.next=null,this._head.prev=null)},e.prototype.cyclization=function(){this._head&&this._tail&&this._tail.next===null&&(this._tail.next=this._head,this._head.prev=this._tail)},e.prototype.clone=function(){var n=this.toArray();return new(e.bind.apply(e,$i([void 0],n)))},e})(cA);/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */function uA(t,e){var n=typeof Symbol=="function"&&t[Symbol.iterator];if(!n)return t;var i=n.call(t),s,o=[],r;try{for(;(e===void 0||e-- >0)&&!(s=i.next()).done;)o.push(s.value)}catch(a){r={error:a}}finally{try{s&&!s.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}return o}function lA(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(uA(arguments[e]));return t}var dA=function(){function t(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];this.queue=new(Fr.bind.apply(Fr,lA([void 0],e)))}return Object.defineProperty(t.prototype,"length",{get:function(){return this.queue.length},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"peek",{get:function(){return this.queue.head},enumerable:!0,configurable:!0}),t.prototype.isEmpty=function(){return this.queue.isEmpty()},t.prototype.enqueue=function(e){return this.queue.append(e)},t.prototype.dequeue=function(){var e=this.queue.removeHead();return typeof e<"u"?e:void 0},t.prototype.toArray=function(){return this.queue.toArray()},t}();/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */function hA(t,e){var n=typeof Symbol=="function"&&t[Symbol.iterator];if(!n)return t;var i=n.call(t),s,o=[],r;try{for(;(e===void 0||e-- >0)&&!(s=i.next()).done;)o.push(s.value)}catch(a){r={error:a}}finally{try{s&&!s.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}return o}function fA(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(hA(arguments[e]));return t}var ju=function(){function t(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];this.stack=new(Fr.bind.apply(Fr,fA([void 0],e)))}return Object.defineProperty(t.prototype,"length",{get:function(){return this.stack.length},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"peek",{get:function(){return this.stack.tail},enumerable:!0,configurable:!0}),t.prototype.isEmpty=function(){return this.stack.isEmpty()},t.prototype.push=function(e){return this.stack.append(e)},t.prototype.pop=function(){var e=this.stack.removeTail();return typeof e<"u"?e:void 0},t.prototype.popBottom=function(){var e=this.stack.removeHead();return typeof e<"u"?e:void 0},t.prototype.toArray=function(){return this.stack.toArray()},t}(),Qg=function(){function t(e,n,i){i===void 0&&(i=0),this.startVertex=e,this.endVertex=n,this.weight=i}return t.prototype.getKey=function(){var e=this.startVertex.getKey(),n=this.endVertex.getKey();return e+"_"+n},t.prototype.reverse=function(){var e=this.startVertex;return this.startVertex=this.endVertex,this.endVertex=e,this},t.prototype.clone=function(){return new t(this.startVertex,this.endVertex,this.weight)},t.prototype.toString=function(){return this.getKey()},t}();function yl(t,e,n){if(n===void 0&&(n="cc-graph"),!t)throw new Error((n?"["+n+"]":"")+" Invariant failed: "+e)}function pA(t,e){e===void 0&&(e=!0);var n=typeof t<"u"&&t!==null;return e?n&&t!=="undefined"&&t!=="null":n}var Qa=function(){function t(e){yl(pA(e),"Graph vertex must have a value"),this.value=e,this.edges=new Map}return t.prototype.addEdge=function(e){return this.edges.set(e.getKey(),e),this},t.prototype.deleteEdge=function(e){this.edges.delete(e.getKey())},t.prototype.getNeighbors=function(){var e=this,n=this.getEdges(),i=function(s){return s.startVertex===e?s.endVertex:s.startVertex};return n.map(i)},t.prototype.getEdges=function(){return Array.from(this.edges.values())},t.prototype.getDegree=function(){return this.getEdges().length},t.prototype.hasEdge=function(e){var n=this.getEdges().find(function(i){return i===e});return!!n},t.prototype.hasNeighbor=function(e){var n=this.getEdges().find(function(i){return i.startVertex===e||i.endVertex===e});return!!n},t.prototype.findEdge=function(e){var n=function(s){return s.startVertex===e||s.endVertex===e},i=this.getEdges().find(n);return i||null},t.prototype.getKey=function(){return this.value},t.prototype.deleteAllEdges=function(){var e=this;return this.getEdges().forEach(function(n){return e.deleteEdge(n)}),this},t.prototype.toString=function(e){return e?e(this.value):""+this.value},t}();function _h(t,e,n,i){if(t){e.push(t),i.set(t.getKey(),!0);var s=t.getNeighbors().filter(function(o){return!i.get(o.getKey())});n.push(s)}}function mh(t,e,n){var i=t.pop();i&&n.set(i.getKey(),!1),e.pop()}var t_=function(){function t(e){e===void 0&&(e=!1),this.vertices={},this.edges={},this.isDirected=e}return t.prototype.addVertex=function(e){return this.vertices[e.getKey()]=e,this},t.prototype.getVertexByKey=function(e){return this.vertices[e]},t.prototype.getNeighbors=function(e){return e.getNeighbors()},t.prototype.getAllVertices=function(){return Object.values(this.vertices)},t.prototype.getAllEdges=function(){return Object.values(this.edges)},t.prototype.addEdge=function(e,n){if(n===void 0&&(n=!1),this.edges[e.getKey()]){if(n)return this;yl(!1,"Edge has already been added before")}var i=this.getVertexByKey(e.startVertex.getKey()),s=this.getVertexByKey(e.endVertex.getKey());if(i||(this.addVertex(e.startVertex),i=this.getVertexByKey(e.startVertex.getKey())),s||(this.addVertex(e.endVertex),s=this.getVertexByKey(e.endVertex.getKey())),this.edges[e.getKey()]=e,this.isDirected)i.addEdge(e);else{i.addEdge(e);var o=e.clone();s.addEdge(o.reverse())}return this},t.prototype.deleteEdge=function(e,n){if(n===void 0&&(n=!1),!this.edges[e.getKey()]){if(n)return this;yl(!1,"Edge not found in graph")}delete this.edges[e.getKey()];var i=this.getVertexByKey(e.startVertex.getKey()),s=this.getVertexByKey(e.endVertex.getKey());return i.deleteEdge(e),s.deleteEdge(e),this},t.prototype.findEdge=function(e,n){var i=this.getVertexByKey(e.getKey());return i?i.findEdge(n):null},t.prototype.getWeight=function(){return this.getAllEdges().reduce(function(e,n){return e+n.weight},0)},t.prototype.reverse=function(){var e=this;return this.getAllEdges().forEach(function(n){e.deleteEdge(n),n.reverse(),e.addEdge(n)}),this},t.prototype.getVerticesIndices=function(){var e={};return this.getAllVertices().forEach(function(n,i){e[n.getKey()]=i}),e},t.prototype.getAdjacencyMatrix=function(){var e=this,n=this.getAllVertices(),i=this.getVerticesIndices(),s=Array(n.length).fill(null).map(function(){return Array(n.length).fill(1/0)});return n.forEach(function(o,r){o.getNeighbors().forEach(function(a){var c=i[a.getKey()],u=e.findEdge(o,a);u&&(s[r][c]=u.weight)})}),s},t.prototype.toString=function(){return Object.keys(this.vertices).toString()},t.prototype.bfs=function(e){var n,i,s;return Fu(this,function(o){switch(o.label){case 0:n=new Map,i=new dA,i.enqueue(e),o.label=1;case 1:return i.isEmpty()?[3,4]:(s=i.dequeue(),s&&!n.has(s.getKey())?[4,s]:[3,3]);case 2:o.sent(),n.set(s.getKey(),s),s.getNeighbors().forEach(function(r){return i.enqueue(r)}),o.label=3;case 3:return[3,1];case 4:return[2]}})},t.prototype.dfs=function(e){var n,i,s;return Fu(this,function(o){switch(o.label){case 0:n=new Map,i=new ju,i.push(e),o.label=1;case 1:return i.isEmpty()?[3,4]:(s=i.pop(),s&&!n.has(s.getKey())?[4,s]:[3,3]);case 2:o.sent(),n.set(s.getKey(),s),s.getNeighbors().forEach(function(r){return i.push(r)}),o.label=3;case 3:return[3,1];case 4:return[2]}})},t.prototype.findAllPath=function(e,n){var i,s,o,r,a,c,u;return Fu(this,function(l){switch(l.label){case 0:return i=[],e!==n?[3,2]:(i.push(e),[4,i]);case 1:return l.sent(),[2];case 2:s=new Map,o=new ju,r=new ju,_h(e,o,r,s),l.label=3;case 3:if(o.isEmpty())return[3,6];if(a=r.pop(),a&&a.length)c=a.shift(),r.push(a),c&&_h(c,o,r,s);else return r.push(a),mh(o,r,s),[3,3];return u=o.peek,u!==n?[3,5]:[4,o.toArray()];case 4:l.sent(),mh(o,r,s),l.label=5;case 5:return[3,3];case 6:return[2]}})},t}();it.config({precision:64,rounding:it.ROUND_DOWN,toExpNeg:-64,toExpPos:64});var ti=it,qn=class extends Error{constructor(e,n){super(e),this.message=e,this.errorCode=n}static isClmmpoolsErrorCode(e,n){return e instanceof qn&&e.errorCode===n}},Et=new y(0),Ks=new y(1),hu=new y(2);hu.pow(new y(128));var tc=hu.pow(new y(64)).sub(Ks),gA=hu.pow(new y(128)).sub(Ks),Te=class{static toX64_BN(e){return e.mul(new y(2).pow(new y(64)))}static toX64_Decimal(e){return e.mul(ti.pow(2,64))}static toX64(e){return new y(e.mul(ti.pow(2,64)).floor().toFixed())}static fromX64(e){return new ti(e.toString()).mul(ti.pow(2,-64))}static fromX64_Decimal(e){return e.mul(ti.pow(2,-64))}static fromX64_BN(e){return e.div(new y(2).pow(new y(64)))}static shiftRightRoundUp(e){let n=e.shrn(64);return e.mod(tc).gt(Et)&&(n=n.add(Ks)),n}static divRoundUp(e,n){return e.mod(n).eq(Et)?e.div(n):e.div(n).add(new y(1))}static subUnderflowU128(e,n){return e.lt(n)?e.sub(n).add(gA):e.sub(n)}static checkUnsignedSub(e,n){const i=e.sub(n);if(i.isNeg())throw new qn("Unsigned integer sub overflow","UnsignedIntegerOverflow");return i}static checkMul(e,n,i){const s=e.mul(n);if(this.isOverflow(s,i))throw new qn("Multiplication overflow","MultiplicationOverflow");return s}static checkMulDivFloor(e,n,i,s){if(i.eq(Et))throw new qn("Devide by zero","DivideByZero");const o=e.mul(n).div(i);if(this.isOverflow(o,s))throw new qn("Multiplication div overflow","MulDivOverflow");return o}static checkMulDivCeil(e,n,i,s){if(i.eq(Et))throw new qn("Devide by zero","DivideByZero");const o=e.mul(n).add(i.sub(Ks)).div(i);if(this.isOverflow(o,s))throw new qn("Multiplication div overflow","MulDivOverflow");return o}static checkMulDivRound(e,n,i,s){if(i.eq(Et))throw new qn("Devide by zero","DivideByZero");const o=e.mul(n.add(i.shrn(1))).div(i);if(this.isOverflow(o,s))throw new qn("Multiplication div overflow","MulDivOverflow");return o}static checkMulShiftRight(e,n,i,s){const o=e.mul(n).div(new y(2).pow(new y(i)));if(this.isOverflow(o,s))throw new qn("Multiplication shift right overflow","MulShiftRightOverflow");return o}static checkMulShiftRight64RoundUpIf(e,n,i,s){const o=e.mul(n),a=s&&o.and(tc).gt(Et)?o.shrn(64).add(Ks):o.shrn(64);if(this.isOverflow(a,i))throw new qn("Multiplication shift right overflow","MulShiftRightOverflow");return a}static checkMulShiftLeft(e,n,i,s){const o=e.mul(n).shln(i);if(this.isOverflow(o,s))throw new qn("Multiplication shift left overflow","MulShiftLeftOverflow");return o}static checkDivRoundUpIf(e,n,i){if(n.eq(Et))throw new qn("Devide by zero","DivideByZero");return i?this.divRoundUp(e,n):e.div(n)}static isOverflow(e,n){return e.gte(hu.pow(new y(n)))}};function e_(t){return{coinA:t.coinTypeA.toString(),coinB:t.coinTypeB.toString(),currentSqrtPrice:new y(t.current_sqrt_price),currentTickIndex:t.current_tick_index,feeGrowthGlobalA:new y(t.fee_growth_global_a),feeGrowthGlobalB:new y(t.fee_growth_global_b),feeProtocolCoinA:new y(t.fee_protocol_coin_a),feeProtocolCoinB:new y(t.fee_protocol_coin_b),feeRate:t.fee_rate,liquidity:new y(t.liquidity),tickIndexes:[],tickSpacing:Number(t.tickSpacing),ticks:[],collection_name:t.collectionName}}function _A(t){const e=new y(t);return e.lt(Et)?{bits:e.neg().xor(new y(2).pow(new y(64)).sub(new y(1))).add(new y(1)).toString()}:{bits:e.toString()}}var n_="0x1::coin::CoinInfo",i_="0x1::coin::CoinStore",yh="0x3::token::TokenStore",mA="0x3::token::WithdrawEvent",yA="PoolLiquidityCoin",Ds="clmm_router",s_="factory",o_="Pools",wA="pool",bA="Pool",vA="crowdsale",xA="CrowdsalePool",TA="fairlaunch",AA="FairlaunchPool",Ni="cetus_script",r_="cscoin",a_="liquidity",wl="scripts";function kA(t){return t.startsWith("0x")?`${t.slice(2)}`:t}function Ki(t){let e="";const n=kA(t),i=n.length/2;for(let s=0;s<i;s++)e+=String.fromCharCode(parseInt(n.substr(s*2,2),16));return SA(e)}function SA(t){let e,n,i,s,o,r;for(e="",i=t.length,n=0;n<i;)switch(s=t.charCodeAt(n++),s>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:e+=t.charAt(n-1);break;case 12:case 13:o=t.charCodeAt(n++),e+=String.fromCharCode((s&31)<<6|o&63);break;case 14:o=t.charCodeAt(n++),r=t.charCodeAt(n++),e+=String.fromCharCode((s&15)<<12|(o&63)<<6|(r&63)<<0);break}return e}var PA=/^0x1::coin::CoinStore<(.+)>$/;function Ee(t,...e){const n=Array.isArray(e[e.length-1])?e.pop():[];let s=[t,...e].filter(Boolean).join("::");return n&&n.length&&(s+=`<${n.join(", ")}>`),s}function wh(t){return Ee(Ie.fromUint8Array(t.value.address.address).hex(),t.value.module_name.value,t.value.name.value,[])}function BA(t){const e=t.value.type_args[0],n=t.value.type_args[1],i=wh(e),s=wh(n),o=Ee(Ie.fromUint8Array(t.value.address.address).hex(),t.value.module_name.value,t.value.name.value,[i,s]);return{coinA:i,coinB:s,lpAddress:o}}function vd(t){var e;let n=t.replace(/\s/g,"");const i=n.match(/(<.+>)$/),s=(e=i==null?void 0:i[0])==null?void 0:e.match(/(\w+::\w+::\w+)(?:<.*?>(?!>))?/g);if(s)return n=n.slice(0,n.indexOf("<")),{...vd(n),type_arguments:[...s]};const o=n.split("::");return{full_address:n,address:o[0],module:o[1],name:o[2],type_arguments:[]}}function bh(t){const e=t.match(PA);return e?e[1]:""}function EA(t){return`${i_}<${t}>`}function CA(t){return`${n_}<${t}>`}var fu=class{constructor(e,n=0){this.overdueTime=n,this.value=e}getCacheData(){return this.value===null?null:this.overdueTime===0?this.value:Date.parse(new Date().toString())>this.overdueTime?(this.value=null,null):this.value}},vh=443636,xh=-443636,pu="79226673515401279992447579055",gu="4295048016",So=new y(1e6),ec=class{static getDefaultSqrtPriceLimit(e){return new y(e?gu:pu)}static getDefaultOtherAmountThreshold(e){return e?Et:tc}},nc=class{constructor(e,n){this.toString=()=>`${this.numerator.toString()}/${this.denominator.toString()}`,this.numerator=e,this.denominator=n}static fromDecimal(e){return nc.fromFraction(e.toDecimalPlaces(1).mul(10).toNumber(),1e3)}static fromFraction(e,n){const i=typeof e=="number"?new y(e.toString()):e,s=typeof n=="number"?new y(n.toString()):n;return new nc(i,s)}},IA=14,OA="59543866431248",RA="184467440737095516",UA="15793534762490258745";function $A(t,e,n){const i=t.toTwos(n).shln(e);return i.imaskn(n+1),i.fromTwos(n)}function Ke(t,e,n){const i=t.toTwos(n).shrn(e);return i.imaskn(n-e+1),i.fromTwos(n-e)}function qA(t){let e;return t&1?e=new y("79232123823359799118286999567"):e=new y("79228162514264337593543950336"),t&2&&(e=Ke(e.mul(new y("79236085330515764027303304731")),96,256)),t&4&&(e=Ke(e.mul(new y("79244008939048815603706035061")),96,256)),t&8&&(e=Ke(e.mul(new y("79259858533276714757314932305")),96,256)),t&16&&(e=Ke(e.mul(new y("79291567232598584799939703904")),96,256)),t&32&&(e=Ke(e.mul(new y("79355022692464371645785046466")),96,256)),t&64&&(e=Ke(e.mul(new y("79482085999252804386437311141")),96,256)),t&128&&(e=Ke(e.mul(new y("79736823300114093921829183326")),96,256)),t&256&&(e=Ke(e.mul(new y("80248749790819932309965073892")),96,256)),t&512&&(e=Ke(e.mul(new y("81282483887344747381513967011")),96,256)),t&1024&&(e=Ke(e.mul(new y("83390072131320151908154831281")),96,256)),t&2048&&(e=Ke(e.mul(new y("87770609709833776024991924138")),96,256)),t&4096&&(e=Ke(e.mul(new y("97234110755111693312479820773")),96,256)),t&8192&&(e=Ke(e.mul(new y("119332217159966728226237229890")),96,256)),t&16384&&(e=Ke(e.mul(new y("179736315981702064433883588727")),96,256)),t&32768&&(e=Ke(e.mul(new y("407748233172238350107850275304")),96,256)),t&65536&&(e=Ke(e.mul(new y("2098478828474011932436660412517")),96,256)),t&131072&&(e=Ke(e.mul(new y("55581415166113811149459800483533")),96,256)),t&262144&&(e=Ke(e.mul(new y("38992368544603139932233054999993551")),96,256)),Ke(e,32,256)}function MA(t){const e=Math.abs(t);let n;return e&1?n=new y("18445821805675392311"):n=new y("18446744073709551616"),e&2&&(n=Ke(n.mul(new y("18444899583751176498")),64,256)),e&4&&(n=Ke(n.mul(new y("18443055278223354162")),64,256)),e&8&&(n=Ke(n.mul(new y("18439367220385604838")),64,256)),e&16&&(n=Ke(n.mul(new y("18431993317065449817")),64,256)),e&32&&(n=Ke(n.mul(new y("18417254355718160513")),64,256)),e&64&&(n=Ke(n.mul(new y("18387811781193591352")),64,256)),e&128&&(n=Ke(n.mul(new y("18329067761203520168")),64,256)),e&256&&(n=Ke(n.mul(new y("18212142134806087854")),64,256)),e&512&&(n=Ke(n.mul(new y("17980523815641551639")),64,256)),e&1024&&(n=Ke(n.mul(new y("17526086738831147013")),64,256)),e&2048&&(n=Ke(n.mul(new y("16651378430235024244")),64,256)),e&4096&&(n=Ke(n.mul(new y("15030750278693429944")),64,256)),e&8192&&(n=Ke(n.mul(new y("12247334978882834399")),64,256)),e&16384&&(n=Ke(n.mul(new y("8131365268884726200")),64,256)),e&32768&&(n=Ke(n.mul(new y("3584323654723342297")),64,256)),e&65536&&(n=Ke(n.mul(new y("696457651847595233")),64,256)),e&131072&&(n=Ke(n.mul(new y("26294789957452057")),64,256)),e&262144&&(n=Ke(n.mul(new y("37481735321082")),64,256)),n}var Ve=class{static priceToSqrtPriceX64(e,n,i){return Te.toX64(e.mul(ti.pow(10,i-n)).sqrt())}static sqrtPriceX64ToPrice(e,n,i){return Te.fromX64(e).pow(2).mul(ti.pow(10,n-i))}static tickIndexToSqrtPriceX64(e){return e>0?new y(qA(e)):new y(MA(e))}static sqrtPriceX64ToTickIndex(e){if(e.gt(new y(pu))||e.lt(new y(gu)))throw new Error("Provided sqrtPrice is not within the supported sqrtPrice range.");const n=e.bitLength()-1,i=new y(n-64),s=$A(i,32,128);let o=new y("8000000000000000","hex"),r=0,a=new y(0),c=n>=64?e.shrn(n-63):e.shln(63-n);for(;o.gt(new y(0))&&r<IA;){c=c.mul(c);const v=c.shrn(127);c=c.shrn(63+v.toNumber()),a=a.add(o.mul(v)),o=o.shrn(1),r+=1}const u=a.shrn(32),d=s.add(u).mul(new y(OA)),f=Ke(d.sub(new y(RA)),64,128).toNumber(),_=Ke(d.add(new y(UA)),64,128).toNumber();return f===_?f:Ve.tickIndexToSqrtPriceX64(_).lte(e)?_:f}static tickIndexToPrice(e,n,i){return Ve.sqrtPriceX64ToPrice(Ve.tickIndexToSqrtPriceX64(e),n,i)}static priceToTickIndex(e,n,i){return Ve.sqrtPriceX64ToTickIndex(Ve.priceToSqrtPriceX64(e,n,i))}static priceToInitializableTickIndex(e,n,i,s){return Ve.getInitializableTickIndex(Ve.priceToTickIndex(e,n,i),s)}static getInitializableTickIndex(e,n){return e-e%n}static getNextInitializableTickIndex(e,n){return Ve.getInitializableTickIndex(e,n)+n}static getPrevInitializableTickIndex(e,n){return Ve.getInitializableTickIndex(e,n)-n}};function c_(t){const e=[];for(const n of t){const i={index:Number(BigInt.asIntN(64,BigInt(n.index.bits)).toString()),sqrtPrice:new y(n.sqrt_price),liquidityNet:new y(BigInt.asIntN(64,BigInt(n.liquidity_net.bits)).toString()),liquidityGross:new y(n.liquidity_gross),feeGrowthOutsideA:new y(n.fee_growth_outside_a),feeGrowthOutsideB:new y(n.fee_growth_outside_b),rewardersGrowthOutside:[new y(n.rewarders_growth_outside[0]),new y(n.rewarders_growth_outside[1]),new y(n.rewarders_growth_outside[2])]};e.push(i)}return e}function Th(t){return t.isAxiosError,t}function me(t){return ti.isDecimal(t)?t:new ti(t===void 0?0:t)}function xd(t){return me(10).pow(me(t).abs())}function DA(t){return t!=null&&t!==""&&!isNaN(Number(t.toString()))}new y(365);new y(24);new y(3600);new y(.5);function LA(t,e,n,i,s,o){const r=new it(t.toString()).div(new it(10**n)),a=new it(e.toString()).div(new it(10**i));return r.mul(s).add(a.mul(o))}function NA(t,e,n,i,s,o,r,a,c,u,l,d,f,_,T,v,k,U,R,A,P,M,K,Y){const X=new it(d),et=new it(f),z=new it(v),O=new it(k),$=new it(U),b=new it(R),h=new it(A),m=new it(P),x=new it(M),I=new it(K),N=new it(Y),j=Ve.tickIndexToSqrtPriceX64(e),G=Ve.tickIndexToSqrtPriceX64(n),E=Te.toX64_Decimal(Te.fromX64(j)).round(),g=Te.toX64_Decimal(Te.fromX64(G)).round(),q=Te.toX64_Decimal(Te.fromX64(i)).round();let xt;const at=X.mul(new it(10**o)).mul(g.mul(E)).div(g.sub(E)).round(),mt=et.mul(new it(10**r)).div(g.sub(E)).round();t<e?xt=at:t>n?xt=mt:xt=it.min(at,mt);const se=xt.mul(q.sub(E)),Oe=xt.mul(g.sub(q)).div(q.mul(g)).div(new it(10**o)).mul(h).add(se.div(new it(10**r).mul(m))),fe=LA(_,T,o,r,h,m),ee=Oe.div(fe),ve=xt.eq(new it(0))?new it(0):new it(l/1e4).mul(z).mul(new it(xt.toString()).div(new it(s.toString()).add(new it(xt.toString())))).div(Oe),Tn=ee.eq(new it(0))?new it(0):ee.mul(new it(36500/7)).div(Oe),nt=O.div(new it(10**a)).mul(x).mul(Tn),dt=$.div(new it(10**c)).mul(I).mul(Tn),It=b.div(new it(10**u)).mul(N).mul(Tn);return{feeAPR:ve,posRewarder0APR:nt,posRewarder1APR:dt,posRewarder2APR:It}}function FA(t,e,n,i){const s=Math.max(t,n),r=Math.min(e,i)-s,a=e-t,c=i-n,u=new it(a.toString()),l=new it(c.toString()),d=new it(r.toString());let f=new it("0");return r<0?f=new it("0"):a===r?f=l.div(d):c===r?f=d.div(u):f=d.mul(d).div(l).div(u),f}function jA(t){const{clmmpool:e,position:n,tickLower:i,tickUpper:s}=t,{current_tick_index:o,fee_growth_global_a:r,fee_growth_global_b:a}=e;console.log({currentTickIndex:o,feeGrowthGlobalAX64:r,feeGrowthGlobalBX64:a});const{tick_lower_index:c,tick_upper_index:u,liquidity:l,fee_owed_a:d,fee_owed_b:f,fee_growth_inside_a:_,fee_growth_inside_b:T}=n,{feeGrowthOutsideA:v,feeGrowthOutsideB:k}=i,{feeGrowthOutsideA:U,feeGrowthOutsideB:R}=s;let A=null,P=null;o<Number(c)?(A=Te.subUnderflowU128(new y(r),new y(v)),P=Te.subUnderflowU128(new y(a),new y(k))):(A=v,P=k);let M=null,K=null;o<Number(u)?(M=U,K=R):(M=Te.subUnderflowU128(new y(r),new y(U)),K=Te.subUnderflowU128(new y(a),new y(R)));const Y=Te.subUnderflowU128(Te.subUnderflowU128(new y(r),new y(A)),new y(M)),X=Te.subUnderflowU128(Te.subUnderflowU128(new y(a),new y(P)),new y(K)),et=Te.subUnderflowU128(new y(Y),new y(_)).mul(new y(l)).shrn(64),z=Te.subUnderflowU128(new y(X),new y(T)).mul(new y(l)).shrn(64),O=new y(me(d).add(me(et.toString())).toString()),$=new y(me(f).add(me(z.toString())).toString());return{feeOwedA:O,feeOwedB:$}}var ys=1e9,zA=5*60*1e3,ba=24*60*60*1e3;function Ah(t){return Date.parse(new Date().toString())+t}var HA=class{constructor(e){this._cache={},this._sdk=e}get sdk(){return this._sdk}async getPoolImmutablesResource(e=!1){const n=this._sdk.sdkOptions.networkOptions.launchpad.cetusLaunchpad,i=`${n}_getMmutablesPools`,s=this.getCacheData(i);let o;if(!e&&s!=null)o=s;else{const r=Ee(n,s_,o_),a=await this._sdk.Resources.fetchAccountResource(n,r);o=JSON.parse(JSON.stringify(a==null?void 0:a.data)),this.updateCache(i,o,ba)}return o}async getLaunchpadPools(e=[],n=0,i=100,s=null,o=!1){const r=this._sdk.sdkOptions.networkOptions.launchpad.cetusLaunchpad,a=[],u=(await this.getPoolImmutablesResource(o)).data.data,l=e.length>0;for(let d=0;d<u.length;d+=1){const f=u[d],{pool_address:_,creater_address:T,pool_type:v}=f.value;if(s==="fixed_price"&&v!==0||s==="fair_launch"&&v===0||l&&!e.includes(_))continue;if(!l){const X=Number(d);if(X<n||X>=n+i)continue}const k=f.key,U=Ee(k.coin_raise.account_address,Ki(k.coin_raise.module_name),Ki(k.coin_raise.struct_name)),R=Ee(k.coin_sale.account_address,Ki(k.coin_sale.module_name),Ki(k.coin_sale.struct_name)),A=Ci.buildLaunchpadPoolType(v===0,r,R,U),P={coin_type_sale:R,coin_type_raise:U,pool_type:A,pool_address:_,creator:T,pool_mode:v===0?"fixed_price":"fair_launch"},M=await this.getLaunchpadPoolState(P.pool_address,P.pool_type,P.pool_mode),K={...P,...M};await this.calculateLaunchpadPoolField(K),a.push(K);const Y=`${_}_pool`;this.updateCache(Y,K,ba)}return a}async getLaunchpadPool(e,n=!0){const i=`${e}_pool`,s=this.getCacheData(i);let o;if(s!==null&&!n&&(o=s),o==null)return(await this.getLaunchpadPools([e]))[0];const r=await this.getLaunchpadPoolState(e,o.pool_type,o.pool_mode),a={...o,...r};return await this.calculateLaunchpadPoolField(a),this.updateCache(i,a,ba),a}async getSpecifyCoinDecimals(e){const n={};(await this._sdk.Token.getSpecifyTokenListByCache(e)).forEach(r=>{n[r.address]=r.decimals});const s=e.filter(r=>n[r]===void 0);return(await this._sdk.Resources.getSpecifyCoinInfos(s)).forEach(r=>{n[r.coinAddress]=Number(r.decimals)}),n}async calculateLaunchpadPoolField(e){const n=await this.getSpecifyCoinDecimals([e.coin_type_sale,e.coin_type_raise]),i=Number(n[e.coin_type_sale]),s=Number(n[e.coin_type_raise]);if(e.initialize_price=Ci.priceFixToReal(e.initialize_price,i,s),Ci.isFixedPricePool(e))e.raise_total=Ci.raiseTotalAmount(e,i,s);else{e.raise_total=Ci.raiseTotalAmount(e,i,s);const r=me(e.raise_coin_amount).div(me(10).pow(me(s))),a=me(e.sale_total).div(me(10).pow(me(i)));a.toNumber()>0?e.price=r.div(a).toNumber():e.price=0}return Ci.updatePoolStaus(e),!0}async getLaunchpadPoolState(e,n,i,s=!0){const o=`${e}_${n}_getLaunchpadPoolState`;if(!s){const u=this.getCacheData(o);if(u!==null)return u}const r=await this._sdk.Resources.fetchAccountResource(e,n),a=JSON.parse(JSON.stringify(r==null?void 0:r.data)),c=Ci.buildLaunchpadFixedPoolState(i,a);return this.updateCache(o,c,ba),c}async getOwnerLaunchpadCoins(e){const n=await this._sdk.Resources.getCoinStores(e),i=[];return n.forEach(s=>{const o=vd(s.coinAddress);o.module===r_&&i.push({coin_type_sale:o.type_arguments[0],coin_type_raise:o.type_arguments[1],coin_address:s.coinAddress,balance:Number(s.coin.value)})}),i}async getSimplePosition(e){const n=await this._sdk.Resources.fetchAccountResource(e,Ee(this._sdk.sdkOptions.networkOptions.launchpad.cetusLaunchpad,"clmmProxy","LockedPosition")),i=JSON.parse(JSON.stringify(n==null?void 0:n.data));return{position_name:i.token_id.token_data_id.name,collection:i.token_id.token_data_id.collection,creator:i.token_id.token_data_id.creator,unlock_time:i.unlock_time,is_redeem:i.is_redeem}}async hasPoolWhitelist(e){const{launchpad:n}=this._sdk.sdkOptions.networkOptions,i={handle:"",exist:!1};try{const s=await this._sdk.Resources.fetchAccountResource(e,Ee(n.cetusLaunchpad,"whitelist","Whitelist")),o=JSON.parse(JSON.stringify(s==null?void 0:s.data));return i.exist=Number(o.users.length)>0,i.handle=o.users.inner.handle,i}catch(s){console.log(s)}return i}async inPoolWhitelist(e,n){if(!n.exist)return!1;try{return await this._sdk.client.getTableItem(n.handle,{key_type:"address",value_type:"u8",key:e}),!0}catch(i){console.log(i)}return!1}buildLaunchpadCoinType(e,n){return Ee(this._sdk.sdkOptions.networkOptions.launchpad.crowdCoin,"cscoin","CS",[e,n])}creatPoolTransactionPayload(e,n=!1){const{launchpad:i}=this.sdk.sdkOptions.networkOptions,s="is_admin"in e,o=`${i.cetusLaunchpad}::${Ni}`,r=s?e.is_admin?"create_crowdsale_pool_authority":"create_crowdsale_pool":"create_fairlaunch_pool",a=Ci.priceRealToFix(e.initialize_price,e.sale_decimals,e.raise_decimals);console.log("fixPrice:",a);const c=Ve.priceToSqrtPriceX64(me(e.initialize_price),e.sale_decimals,e.raise_decimals).toString();return s?Ci.buildCreatCrowdsalePoolPayload(e,c,a,o,r,n):Ci.buildCreatFairlaunchPoolPayload(e,c,a,o,r,n)}updatePoolTransactionPayload(e,n=!1){const{launchpad:i}=this.sdk.sdkOptions.networkOptions,s=`${i.cetusLaunchpad}::${Ni}`,o="update_pool";if(n){const u=[new F.TypeTagStruct(F.StructTag.fromString(e.coin_type_sale)),new F.TypeTagStruct(F.StructTag.fromString(e.coin_type_raise))],l=[rt.bcsToBytes(F.AccountAddress.fromHex(e.pool_addr)),rt.bcsSerializeUint64(e.start_time),rt.bcsSerializeUint64(e.liquidity_rate*100),rt.bcsSerializeUint64(e.activity_duration),rt.bcsSerializeUint64(e.calmdown_duraction),rt.bcsSerializeUint64(e.settle_duration),rt.bcsSerializeUint64(e.locked_duration)];return new F.TransactionPayloadEntryFunction(F.EntryFunction.natural(s,o,u,l))}const r=Ee(s,o),a=[e.coin_type_sale,e.coin_type_raise],c=[e.pool_addr,e.start_time,e.liquidity_rate*100,e.activity_duration,e.calmdown_duraction,e.settle_duration,e.locked_duration];return{type:"entry_function_payload",function:r,type_arguments:a,arguments:c}}purchaseTransactionPayload(e,n=!1){const{launchpad:i}=this.sdk.sdkOptions.networkOptions,s=`${i.cetusLaunchpad}::${Ni}`,o="purchase";if(n){const u=[new F.TypeTagStruct(F.StructTag.fromString(e.coin_type_sale)),new F.TypeTagStruct(F.StructTag.fromString(e.coin_type_raise))],l=[rt.bcsToBytes(F.AccountAddress.fromHex(e.pool_addr)),rt.bcsSerializeUint64(e.raise_amount_in)];return new F.TransactionPayloadEntryFunction(F.EntryFunction.natural(s,o,u,l))}const r=Ee(s,o),a=[e.coin_type_sale,e.coin_type_raise],c=[e.pool_addr,e.raise_amount_in];return{type:"entry_function_payload",function:r,type_arguments:a,arguments:c}}revokeTransactionPayload(e,n=!1){const{launchpad:i}=this.sdk.sdkOptions.networkOptions,s=`${i.cetusLaunchpad}::${Ni}`,o="revoke";if(n){const u=[new F.TypeTagStruct(F.StructTag.fromString(e.coin_type_sale)),new F.TypeTagStruct(F.StructTag.fromString(e.coin_type_raise))],l=[rt.bcsToBytes(F.AccountAddress.fromHex(e.pool_addr)),rt.bcsSerializeUint64(e.cs_coin_amount)];return new F.TransactionPayloadEntryFunction(F.EntryFunction.natural(s,o,u,l))}const r=Ee(s,o),a=[e.coin_type_sale,e.coin_type_raise],c=[e.pool_addr,e.cs_coin_amount];return{type:"entry_function_payload",function:r,type_arguments:a,arguments:c}}settleTransactionPayload(e,n=!1){const{launchpad:i}=this.sdk.sdkOptions.networkOptions,s=`${i.cetusLaunchpad}::${Ni}`,o=e.pool_mode==="fixed_price",r=o?"crowd_sale_settle":"fair_launch_settle";if(n){const u=[new F.TypeTagStruct(F.StructTag.fromString(e.coin_type_sale)),new F.TypeTagStruct(F.StructTag.fromString(e.coin_type_raise))];return o?new F.TransactionPayloadEntryFunction(F.EntryFunction.natural(s,r,u,[])):new F.TransactionPayloadEntryFunction(F.EntryFunction.natural(s,r,u,[rt.bcsSerializeU128(BigInt(e.initialize_sqrt_price))]))}const a=Ee(s,r),c=[e.coin_type_sale,e.coin_type_raise];return{type:"entry_function_payload",function:a,type_arguments:c,arguments:o?[]:[e.initialize_sqrt_price]}}claimTransactionPayload(e,n=!1){const{launchpad:i}=this.sdk.sdkOptions.networkOptions,s=`${i.cetusLaunchpad}::${Ni}`,o="claim";if(n){const u=[new F.TypeTagStruct(F.StructTag.fromString(e.coin_type_sale)),new F.TypeTagStruct(F.StructTag.fromString(e.coin_type_raise))],l=[rt.bcsToBytes(F.AccountAddress.fromHex(e.pool_addr)),rt.bcsSerializeUint64(e.cs_coin_amount)];return new F.TransactionPayloadEntryFunction(F.EntryFunction.natural(s,o,u,l))}const r=Ee(s,o),a=[e.coin_type_sale,e.coin_type_raise],c=[e.pool_addr,e.cs_coin_amount];return{type:"entry_function_payload",function:r,type_arguments:a,arguments:c}}claimFeeTransactionPayload(e,n=!1){const{launchpad:i}=this.sdk.sdkOptions.networkOptions,s=`${i.cetusLaunchpad}::${Ni}`,o="claim_fee";if(n){const u=[new F.TypeTagStruct(F.StructTag.fromString(e.coin_type_sale)),new F.TypeTagStruct(F.StructTag.fromString(e.coin_type_raise))],l=[rt.bcsToBytes(F.AccountAddress.fromHex(e.pool_addr))];return new F.TransactionPayloadEntryFunction(F.EntryFunction.natural(s,o,u,l))}const r=Ee(s,o),a=[e.coin_type_sale,e.coin_type_raise],c=[e.pool_addr];return{type:"entry_function_payload",function:r,type_arguments:a,arguments:c}}withdrawTransactionPayload(e,n=!1){const{launchpad:i}=this.sdk.sdkOptions.networkOptions,s=`${i.cetusLaunchpad}::${Ni}`,o=e.is_withdraw_sale?"withdraw_sale":"withdraw_raise";if(n){const u=[new F.TypeTagStruct(F.StructTag.fromString(e.coin_type_sale)),new F.TypeTagStruct(F.StructTag.fromString(e.coin_type_raise))],l=[rt.bcsToBytes(F.AccountAddress.fromHex(e.pool_addr))];return new F.TransactionPayloadEntryFunction(F.EntryFunction.natural(s,o,u,l))}const r=Ee(s,o),a=[e.coin_type_sale,e.coin_type_raise],c=[e.pool_addr];return{type:"entry_function_payload",function:r,type_arguments:a,arguments:c}}redeemPositionTransactionPayload(e,n=!1){const{launchpad:i}=this.sdk.sdkOptions.networkOptions,s=`${i.cetusLaunchpad}::${Ni}`,o="redeem_position";if(n){const c=[new F.TypeTagStruct(F.StructTag.fromString(e.coin_type_sale)),new F.TypeTagStruct(F.StructTag.fromString(e.coin_type_raise))];return new F.TransactionPayloadEntryFunction(F.EntryFunction.natural(s,o,c,[]))}const r=Ee(s,o),a=[e.coin_type_sale,e.coin_type_raise];return{type:"entry_function_payload",function:r,type_arguments:a,arguments:[]}}userToWhitelistTransactionPayload(e,n=!1){const{launchpad:i}=this.sdk.sdkOptions.networkOptions,s=`${i.cetusLaunchpad}::${Ni}`,o=e.isAdd?"add_user_to_whitelist":"remove_user_from_whitelist";if(n){const u=[new F.TypeTagStruct(F.StructTag.fromString(e.coin_type_sale)),new F.TypeTagStruct(F.StructTag.fromString(e.coin_type_raise))],l=[rt.bcsToBytes(F.AccountAddress.fromHex(e.user_addr))];return new F.TransactionPayloadEntryFunction(F.EntryFunction.natural(s,o,u,l))}const r=Ee(s,o),a=[e.coin_type_sale,e.coin_type_raise],c=[e.user_addr];return{type:"entry_function_payload",function:r,type_arguments:a,arguments:c}}updateCache(e,n,i=zA){let s=this._cache[e];s?(s.overdueTime=Ah(i),s.value=n):s=new fu(n,Ah(i)),this._cache[e]=s}getCacheData(e){const n=this._cache[e];return n!==void 0&&n.getCacheData()?n.value:null}};function KA(t,e,n,i){const s=t.shln(64),o=n.sub(e);return i?Te.divRoundUp(s,o):s.div(o)}var Ci=class{static minSettlePurchaseAmount(e){return me(e.sale_total).mul(e.initialize_price).mul(e.least_raise_rate).toNumber()}static get_sale_liquidity_amount(e,n,i,s,o,r){const a=bl.getMinIndex(e),c=bl.getMaxIndex(e),u=this.priceRealToFix(s,o,r),l=new y(n*u*i),d=new y(Ve.priceToSqrtPriceX64(me(u),0,0).toString()),f=KA(l,Ve.tickIndexToSqrtPriceX64(a),d,!1);return i6(d,Ve.tickIndexToSqrtPriceX64(c),f,!0).toString()}static raiseTotalAmount(e,n,i){const s=me(n-i).abs().toNumber();return n>i?Number(me(e.sale_total).mul(e.initialize_price).div(me(10).pow(me(s))).toString()):Number(me(e.sale_total).mul(e.initialize_price).mul(me(10).pow(me(s))).toString())}static priceRealToFix(e,n,i){const s=me(n-i).toNumber();return Number(me(e).div(me(10).pow(me(s))).toString())}static priceFixToReal(e,n,i){const s=me(n-i).toNumber();return Number(me(e).mul(me(10).pow(me(s))).toString())}static buildLaunchpadPoolType(e,n,i,s){return e?Ee(Ee(n,vA,xA),[i,s]):Ee(Ee(n,TA,AA),[i,s])}static isFixedPricePool(e){return e.pool_mode==="fixed_price"}static getFairLaunchSettleSqrtPrice(e,n,i){if(e.pool_status!=="Settle")throw new Error("The pool is not in settle ");const s=Ve.priceToSqrtPriceX64(me(e.price),n,i).toString();return console.log("sqrtPrice: ",s.toString()),s.toString()}static async updatePoolStaus(e){const n=Ci.isFixedPricePool(e),i=Number(me(Date.now()/1e3).toFixed(0));if(e.end_activity_time=Number(e.start_activity_time)+Number(e.activity_duration),n)if(e.end_settle_time=Number(e.end_activity_time)+Number(e.settle_duration),e.is_settle)e.pool_status="Ended";else if(i<Number(e.start_activity_time))e.pool_status="Upcoming";else if(i>=e.start_activity_time&&i<e.end_activity_time)e.pool_status="Live";else if(i>=e.end_activity_time&&i<e.end_settle_time){const s=e.raise_coin_amount,o=me(e.raise_total).mul(me(e.least_raise_rate)).toNumber();s<o?e.pool_status="Failed":e.pool_status="Settle"}else e.pool_status="Failed";else if(e.end_calm_down_time=Number(e.end_activity_time)+Number(e.calmdown_duration),e.end_settle_time=Number(e.end_calm_down_time)+Number(e.settle_duration),e.is_settle)e.pool_status="Ended";else if(i<Number(e.start_activity_time))e.pool_status="Upcoming";else if(i>=e.start_activity_time&&i<e.end_activity_time)e.pool_status="Live";else if(i>=e.end_activity_time&&i<e.end_calm_down_time)e.pool_status="Calmdown";else if(i>=e.end_calm_down_time&&i<e.end_settle_time){const s=e.raise_coin_amount,o=me(e.raise_total).mul(me(e.least_raise_rate)).toNumber();s<o?e.pool_status="Failed":e.pool_status="Settle"}else e.pool_status="Failed";return!0}static buildLaunchpadFixedPoolState(e,n){return e==="fixed_price"?{sale_coin_amount:n.sale_coin.value,raise_coin_amount:n.raise_coin.value,activity_duration:n.activity_duration,clmm_pool_address:n.clmm_pool_address,cs_burn_cap:n.cs_burn_cap.dummy_field,cs_mint_cap:n.cs_mint_cap.dummy_field,fee_amount:n.fee_amount,fee_rate:n.fee_rate,initialize_price:Number(n.initialize_price)/ys,initialize_sqrt_price:BigInt(n.initialize_sqrt_price),is_settle:n.is_settle,least_raise_rate:Number(n.least_raise_rate)/100,liquidity_rate:Number(n.liquidity_rate)/100,locked_duration:n.locked_duration,sale_total:n.sale_total,raise_total:0,settle_duration:n.settle_duration,start_activity_time:n.start_time,unused_raise:n.unused_raise,unused_sale:n.unused_sale,has_whiteList:n.has_white_list,pool_status:"Upcoming",end_activity_time:0,end_settle_time:0}:{price:0,sale_coin_amount:0,raise_coin_amount:n.raise_coin.value,sale_total:n.sale_coin.value,raise_total:0,calmdown_duration:n.calmdown_duration,initialize_price:Number(n.price)/ys,activity_duration:n.activity_duration,clmm_pool_address:n.clmm_pool_address,cs_burn_cap:n.cs_burn_cap.dummy_field,cs_mint_cap:n.cs_mint_cap.dummy_field,fee_amount:n.fee_amount,fee_rate:n.fee_rate,is_settle:n.is_settle,least_raise_rate:Number(n.least_raise_amount)/100,liquidity_rate:Number(n.liquidity_rate)/100,locked_duration:n.locked_duration,settle_duration:n.settle_duration,start_activity_time:n.start_time,has_whiteList:n.has_white_list,pool_status:"Upcoming",end_activity_time:0,end_calm_down_time:0,end_settle_time:0}}static buildCreatCrowdsalePoolPayload(e,n,i,s,o,r=!1){if(r){const l=[new F.TypeTagStruct(F.StructTag.fromString(e.coin_type_sale)),new F.TypeTagStruct(F.StructTag.fromString(e.coin_type_raise))],d=e.is_admin?[rt.bcsSerializeU128(i*ys),rt.bcsSerializeU128(BigInt(n)),rt.bcsSerializeUint64(e.tick_spacing),rt.bcsSerializeUint64(e.sale_total),rt.bcsSerializeUint64(e.start_time),rt.bcsSerializeUint64(e.least_raise_rate*100),rt.bcsSerializeUint64(e.activity_duration),rt.bcsSerializeUint64(e.settle_duration),rt.bcsSerializeUint64(e.locked_duration),rt.bcsSerializeU8(0)]:[rt.bcsSerializeU128(i*ys),rt.bcsSerializeU128(BigInt(n)),rt.bcsSerializeUint64(e.tick_spacing),rt.bcsSerializeUint64(e.sale_total),rt.bcsSerializeUint64(e.start_time),rt.bcsSerializeUint64(e.least_raise_rate*100),rt.bcsSerializeUint64(e.liquidity_rate*100),rt.bcsSerializeUint64(e.activity_duration),rt.bcsSerializeUint64(e.settle_duration),rt.bcsSerializeUint64(e.locked_duration),rt.bcsSerializeU8(0)];return new F.TransactionPayloadEntryFunction(F.EntryFunction.natural(s,o,l,d))}const a=Ee(s,o),c=[e.coin_type_sale,e.coin_type_raise],u=e.is_admin?[i*ys,n,e.tick_spacing,e.sale_total,e.start_time,e.least_raise_rate*100,e.activity_duration,e.settle_duration,e.locked_duration,0]:[i*ys,n,e.tick_spacing,e.sale_total,e.start_time,e.least_raise_rate*100,e.liquidity_rate*100,e.activity_duration,e.settle_duration,e.locked_duration,0];return{type:"entry_function_payload",function:a,type_arguments:c,arguments:u}}static buildCreatFairlaunchPoolPayload(e,n,i,s,o,r=!1){if(r){const l=[new F.TypeTagStruct(F.StructTag.fromString(e.coin_type_sale)),new F.TypeTagStruct(F.StructTag.fromString(e.coin_type_raise))],d=[rt.bcsSerializeU128(i*ys),rt.bcsSerializeU128(BigInt(n)),rt.bcsSerializeUint64(e.tick_spacing),rt.bcsSerializeUint64(e.sale_total),rt.bcsSerializeUint64(e.start_time),rt.bcsSerializeUint64(e.least_raise_rate*100),rt.bcsSerializeUint64(e.liquidity_rate*100),rt.bcsSerializeUint64(e.activity_duration),rt.bcsSerializeUint64(e.calmdown_duraction),rt.bcsSerializeUint64(e.settle_duration),rt.bcsSerializeUint64(e.locked_duration)];return new F.TransactionPayloadEntryFunction(F.EntryFunction.natural(s,o,l,d))}const a=Ee(s,o),c=[e.coin_type_sale,e.coin_type_raise],u=[i*ys,n,e.tick_spacing,e.sale_total,e.start_time,e.liquidity_rate*100,rt.bcsSerializeUint64(e.least_raise_rate*100),e.activity_duration,e.calmdown_duraction,e.settle_duration,e.locked_duration];return{type:"entry_function_payload",function:a,type_arguments:c,arguments:u}}};function GA(t){let e;switch(t){case 5:e=5;break;case 10:e=10;break;case 20:e=20;break;case 25:e=25;break;case 50:e=50;break;case 100:e=100;break;default:e=1}const n=100/e+1,i=new Array(n);for(let s=0;s<n;s+=1)i[s]=s*e;return i}function Na(t,e){const n=GA(e),i=new Array(n.length);for(let s=0;s<n.length;s+=1)i[s]=t.muln(n[s]).divn(100);return i}function WA(t,e,n,i){for(let s=e;s<t;s+=1)n.amountInArray[s]=n.amountInArray[s].add(i.amountIn),n.amountOutArray[s]=n.amountOutArray[s].add(i.amountOut),n.feeAmountArray[s]=n.feeAmountArray[s].add(i.feeAmount);return n}function XA(t,e,n,i,s){let o=new y(i.liquidity),{currentSqrtPrice:r}=i,a={amountInArray:[],amountOutArray:[],feeAmountArray:[],nextSqrtPriceArray:[],isExceed:[]};n.forEach(()=>{a.amountInArray.push(Et),a.amountOutArray.push(Et),a.feeAmountArray.push(Et),a.nextSqrtPriceArray.push(Et)});let c,u;const l=ec.getDefaultSqrtPriceLimit(t),d=n.length;let f=n[1],_=1,T;t?T=s.sort((v,k)=>k.index-v.index):T=s.sort((v,k)=>v.index-k.index);for(const v of T){if(t){if(i.currentTickIndex<v.index)continue}else if(i.currentTickIndex>v.index)continue;if(v===null)continue;t&&l.gt(v.sqrtPrice)||!t&&l.lt(v.sqrtPrice)?c=l:c=v.sqrtPrice;let k={amountIn:Et,amountOut:Et,nextSqrtPrice:Et,feeAmount:Et};const U=r,R=o;let A=f,P=_;for(let M=_;M<d;M+=1){const K=d_(r,c,o,f,new y(i.feeRate),e);if(k=K,K.amountIn.eq(Et)||(f=e?f.sub(K.amountIn.add(K.feeAmount)):f.sub(K.amountOut)),f.eq(Et))a.amountInArray[M]=a.amountInArray[M].add(K.amountIn),a.amountOutArray[M]=a.amountOutArray[M].add(K.amountOut),a.feeAmountArray[M]=a.feeAmountArray[M].add(K.feeAmount),K.nextSqrtPrice.eq(v.sqrtPrice)?(u=t?v.liquidityNet.mul(new y(-1)):v.liquidityNet,o=u.gt(Et)?o.add(u):o.sub(u.abs()),r=v.sqrtPrice):r=K.nextSqrtPrice,a.amountInArray[M]=a.amountInArray[M].add(a.feeAmountArray[M]),a.nextSqrtPriceArray[M]=r,o=R,r=U,M!==d-1&&(f=A.add(n[M+1].sub(n[P]))),_+=1;else{a=WA(d,M,a,K),A=f,P=_;break}}if(_===d)break;k.nextSqrtPrice.eq(v.sqrtPrice)?(u=t?v.liquidityNet.mul(new y(-1)):v.liquidityNet,o=u.gt(Et)?o.add(u):o.sub(u.abs()),r=v.sqrtPrice):r=k.nextSqrtPrice}return e?n.forEach((v,k)=>{a.isExceed.push(a.amountInArray[k].lt(v))}):n.forEach((v,k)=>{a.isExceed.push(a.amountOutArray[k].lt(v))}),a}var VA=class{constructor(t,e,n,i,s,o){this.minSplitUnit=e,this.a2b=i,this.byAmountIn=s,this.clmmpool=n,this.ticks=o,this.amountArray=[],this.createSplitSwapParams=this.createSplitSwapParams.bind(this),this.createSplitSwapParams(t,e),this.splitSwapResult={amountInArray:[],amountOutArray:[],feeAmountArray:[],nextSqrtPriceArray:[],isExceed:[]},this.computeSwap=this.computeSwap.bind(this)}createSplitSwapParams(t,e){const n=Na(t,e);this.amountArray=n}computeSwap(){const t=e_(this.clmmpool);return this.splitSwapResult=XA(this.a2b,this.byAmountIn,this.amountArray,t,this.ticks),this.splitSwapResult}},bl=class{static getMinIndex(e){return xh+Math.abs(xh)%e}static getMaxIndex(e){return vh-vh%e}};function JA(t,e,n,i,s,o){const r=t.rewarder_infos,a=[];for(let c=0;c<r.length;c+=1){let u=o[c];e!==null&&(t.current_tick_index<i?u=o[c].sub(new y(e.rewardersGrowthOutside[c])):u=e.rewardersGrowthOutside[c]);let l=new y(0);n!==null&&(t.current_tick_index>=s?l=o[c].sub(new y(n.rewardersGrowthOutside[c])):l=n.rewardersGrowthOutside[c]);const d=Te.subUnderflowU128(Te.subUnderflowU128(new y(o[c]),new y(u)),new y(l));a.push(d)}return a}function ZA(t){if(t){const e={};return t.maxGasAmount&&(e.maxGasAmount=BigInt(t.maxGasAmount)),t.gasUnitPrice&&(e.gasUnitPrice=BigInt(t.gasUnitPrice)),t.expireTimestamp&&(e.expireTimestamp=BigInt(t.expireTimestamp)),e}}function YA(t,e){return new Da(i=>{const s=new Uint8Array(64);return new F.Ed25519Signature(s)},t.toUint8Array()).sign(e)}function QA(t){if(t){const e={};return t.maxGasAmount&&(e.max_gas_amount=t.maxGasAmount.toString()),t.gasUnitPrice&&(e.gas_unit_price=t.gasUnitPrice.toString()),t.expireTimestamp&&(e.expiration_timestamp_secs=t.expireTimestamp.toString()),e}}async function t6(t,e,n,i,s=!0){if(n instanceof F.TransactionPayload){const l=await t.generateRawTransaction(e.address,n,ZA(i)),d=YA(e.pubkey,l),f=await t.submitBCSSimulation(d);return s&&console.log(f[0]),f[0]}const o=n,r=await t.generateTransaction(e.address,o,QA(i)),a={type:"ed25519_signature",public_key:e.pubkey.hex(),signature:Ie.fromUint8Array(new Uint8Array(64)).hex()},c={sender:e.address.hex(),sequence_number:r.sequence_number.toString(),max_gas_amount:r.max_gas_amount.toString(),gas_unit_price:r.gas_unit_price.toString(),expiration_timestamp_secs:r.expiration_timestamp_secs.toString(),payload:o,signature:a},u=await t.client.transactions.simulateTransaction(c);return s&&console.log(u[0]),u[0]}async function va(t,e,n,i){return t6(t,e,n,i,!1)}function kh(t,e){const n=new rt.Serializer;n.serializeU32AsUleb128(t.length);const i=n[e];return t.forEach(s=>{n.serializeU32AsUleb128(s.length),s.forEach(o=>{i.call(n,o)})}),n.getBytes()}function e6(t){const e=new rt.Serializer;return e.serializeU32AsUleb128(t.length),t.forEach(n=>{e.serializeU32AsUleb128(n.length),n.forEach(i=>{i.serialize(e)})}),e.getBytes()}function n6(t){const e=new rt.Serializer;return e.serializeU32AsUleb128(t.length),t.forEach(n=>{n.serialize(e)}),e.getBytes()}function i6(t,e,n,i){const s=t.gt(e)?t.sub(e):e.sub(t),o=n.mul(s).shln(64),r=t.mul(e),a=o.div(r),c=o.mod(r);return i&&!c.eq(Et)?a.add(new y(1)):a}function u_(t,e,n,i){if(n.eq(Et))return t;const s=Te.checkMulShiftLeft(t,e,64,256),o=e.shln(64),r=Te.checkMul(t,n,256);if(!i&&o.lte(r))throw new qn("getNextSqrtPriceAUp - Unable to divide liquidityShl64 by product","DivideByZero");const a=i?Te.checkDivRoundUpIf(s,o.add(r),!0):Te.checkDivRoundUpIf(s,o.sub(r),!0);if(a.lt(new y(gu)))throw new qn("getNextSqrtPriceAUp - Next sqrt price less than min sqrt price","CoinAmountMinSubceeded ");if(a.gt(new y(pu)))throw new qn("getNextSqrtPriceAUp - Next sqrt price greater than max sqrt price","CoinAmountMaxExceeded");return a}function l_(t,e,n,i){const s=Te.checkDivRoundUpIf(n.shln(64),e,!i),o=i?t.add(s):t.sub(s);if(o.lt(new y(gu))||o.gt(new y(pu)))throw new qn("getNextSqrtPriceAUp - Next sqrt price out of bounds","SqrtPriceOutOfBounds");return o}function s6(t,e,n,i){return i?u_(t,e,n,!0):l_(t,e,n,!0)}function o6(t,e,n,i){return i?l_(t,e,n,!1):u_(t,e,n,!1)}function Sh(t,e,n,i){const s=t.gt(e)?t.sub(e):e.sub(t);if(n.lte(Et)||s.eq(Et))return Et;let o;if(i){const r=new y(n).mul(new y(s)).shln(64),a=e.mul(t),c=r.div(a);o=r.mod(a).eq(Et)?c:c.add(Ks)}else{const r=new y(n).mul(new y(s));o=r.and(tc).gt(Et)?r.shrn(64).add(Ks):r.shrn(64)}return o}function Ph(t,e,n,i){const s=t.gt(e)?t.sub(e):e.sub(t);if(n.lte(Et)||s.eq(Et))return Et;let o;if(i)o=n.mul(s).shrn(64);else{const r=n.mul(s).shln(64),a=e.mul(t);o=r.div(a)}return o}function d_(t,e,n,i,s,o){if(n===Et)return{amountIn:Et,amountOut:Et,nextSqrtPrice:e,feeAmount:Et};const r=t.gte(e);let a,c,u,l;if(o){const d=Te.checkMulDivFloor(i,Te.checkUnsignedSub(So,s),So,64),f=Sh(t,e,n,r);f.gt(d)?(a=d,l=Te.checkUnsignedSub(i,d),u=s6(t,n,d,r)):(a=f,l=Te.checkMulDivCeil(a,s,So.sub(s),64),u=e),c=Ph(t,u,n,r)}else{const d=Ph(t,e,n,r);d.gt(i)?(c=i,u=o6(t,n,i,r)):(c=d,u=e),a=Sh(t,u,n,r),l=Te.checkMulDivCeil(a,s,So.sub(s),64)}return{amountIn:a,amountOut:c,nextSqrtPrice:u,feeAmount:l}}function r6(t,e,n,i,s){let o=n,r=i.liquidity,{currentSqrtPrice:a}=i;const c={amountIn:Et,amountOut:Et,feeAmount:Et,refAmount:Et,nextSqrtPrice:Et,crossTickNum:0};let u,l;const d=ec.getDefaultSqrtPriceLimit(t);for(const f of s){if(t){if(i.currentTickIndex<f.index)continue}else if(i.currentTickIndex>f.index)continue;if(f===null)continue;t&&d.gt(f.sqrtPrice)||!t&&d.lt(f.sqrtPrice)?u=d:u=f.sqrtPrice;const _=d_(a,u,r,o,new y(i.feeRate),e);if(_.amountIn.eq(Et)||(o=e?o.sub(_.amountIn.add(_.feeAmount)):o.sub(_.amountOut)),c.amountIn=c.amountIn.add(_.amountIn),c.amountOut=c.amountOut.add(_.amountOut),c.feeAmount=c.feeAmount.add(_.feeAmount),_.nextSqrtPrice.eq(f.sqrtPrice)?(l=t?f.liquidityNet.mul(new y(-1)):f.liquidityNet,r=l.gt(Et)?r.add(l):r.sub(l.abs()),a=f.sqrtPrice):a=_.nextSqrtPrice,c.crossTickNum+=1,o.eq(Et))break}return c.amountIn=c.amountIn.add(c.feeAmount),c.nextSqrtPrice=a,c}function Po(t,e,n){const i=y.min(t,e),s=y.max(t,e),o=Te.fromX64_BN(n.mul(s).mul(i)),r=s.sub(i);return o.div(r)}function Bo(t,e,n){const i=y.min(t,e),o=y.max(t,e).sub(i);return n.shln(64).div(o)}var vi=class{constructor(){}static getFeeRate(e){return nc.fromFraction(e,1e6)}static updateFeeRate(e,n,i,s,o){const r=Te.checkMulDivCeil(n,new y(s),So,64),a=i===0?Et:Te.checkMulDivFloor(n,new y(i),So,64),c=n.mul(r).mul(a);if(o?e.feeProtocolCoinA=e.feeProtocolCoinA.add(r):e.feeProtocolCoinB=e.feeProtocolCoinB.add(r),c.eq(Et)||e.liquidity.eq(Et))return{refFee:a,clmm:e};const u=c.shln(64).div(e.liquidity);return o?e.feeGrowthGlobalA=e.feeGrowthGlobalA.add(u):e.feeGrowthGlobalB=e.feeGrowthGlobalB.add(u),{refFee:a,clmm:e}}static getProtocolFeeRate(e){return nc.fromFraction(e,1e4)}static getCoinAmountFromLiquidity(e,n,i,s,o){const r=new ti(e.toString()),a=new ti(n.toString()),c=new ti(i.toString()),u=new ti(s.toString());let l,d;return n.lt(i)?(l=Te.toX64_Decimal(r).mul(u.sub(c)).div(c.mul(u)),d=new ti(0)):n.lt(s)?(l=Te.toX64_Decimal(r).mul(u.sub(a)).div(a.mul(u)),d=Te.fromX64_Decimal(r.mul(a.sub(c)))):(l=new ti(0),d=Te.fromX64_Decimal(r.mul(u.sub(c)))),o?{coinA:new y(l.ceil().toString()),coinB:new y(d.ceil().toString())}:{coinA:new y(l.floor().toString()),coinB:new y(d.floor().toString())}}static estimateLiquidityFromcoinAmounts(e,n,i,s){if(n>i)throw new Error("lower tick cannot be greater than lower tick");const o=Ve.sqrtPriceX64ToTickIndex(e),r=Ve.tickIndexToSqrtPriceX64(n),a=Ve.tickIndexToSqrtPriceX64(i);if(o<n)return Po(r,a,s.coinA);if(o>=i)return Bo(a,r,s.coinB);const c=Po(e,a,s.coinA),u=Bo(e,r,s.coinB);return y.min(c,u)}static estLiquidityAndcoinAmountFromOneAmounts(e,n,i,s,o,r,a){const c=Ve.sqrtPriceX64ToTickIndex(a),u=Ve.tickIndexToSqrtPriceX64(e),l=Ve.tickIndexToSqrtPriceX64(n);let d;if(c<e){if(!s)throw new Error("lower tick cannot calculate liquidity by coinB");d=Po(u,l,i)}else if(c>n){if(s)throw new Error("upper tick cannot calculate liquidity by coinA");d=Bo(l,u,i)}else s?d=Po(a,l,i):d=Bo(a,u,i);const f=vi.getCoinAmountFromLiquidity(d,a,u,l,o),_=f.coinA.mul(new y(1+r)),T=f.coinB.mul(new y(1+r));return{tokenMaxA:_,tokenMaxB:T,liquidityAmount:d}}static estCoinAmountsFromTotalAmount(e,n,i,s,o,r){const{ratioA:a,ratioB:c}=vi.calculateDepositRatioFixTokenA(e,n,i);console.log({ratioA:a,ratioB:c});const u=me(s).mul(a).div(o),l=me(s).mul(c).div(r);return{amountA:u,amountB:l}}static calculateDepositRatioFixTokenA(e,n,i){const s=new y(1),{tokenMaxB:o}=vi.estLiquidityAndcoinAmountFromOneAmounts(e,n,s,!0,!0,0,i),r=Ve.sqrtPriceX64ToPrice(i,0,0),a=me(s.toString()).mul(r),c=a.add(o.toString()),u=a.div(c),l=me(o.toString()).div(c);return{ratioA:u,ratioB:l}}},a6=class{constructor(e){this._cache={},this._sdk=e}get sdk(){return this._sdk}async fetchAccountResource(e,n,i=0){let s=this._cache[e+n];if(s!=null&&s.getCacheData())return s.value;const o=await this.sdk.Resources.fetchAccountResource(e,n);return s=new fu(o,i),this._cache[e+n]=s,o}calculateRates(e){const{currentPool:n}=e,i=e_(n);let s;e.a2b?s=e.swapTicks.sort((f,_)=>_.index-f.index):s=e.swapTicks.sort((f,_)=>f.index-_.index);const o=r6(e.a2b,e.byAmountIn,e.amount,i,s);let r=!1;e.byAmountIn?r=o.amountIn.lt(e.amount):r=o.amountOut.lt(e.amount);const a=ec.getDefaultSqrtPriceLimit(e.a2b);e.a2b&&o.nextSqrtPrice.lt(a)&&(r=!0),!e.a2b&&o.nextSqrtPrice.gt(a)&&(r=!0);let c=0;o.crossTickNum>6&&o.crossTickNum<40&&(c=22e3*(o.crossTickNum-6)),o.crossTickNum>40&&(r=!0);const u=Ve.sqrtPriceX64ToPrice(i.currentSqrtPrice,e.decimalsA,e.decimalsB).toNumber(),l=Ve.sqrtPriceX64ToPrice(o.nextSqrtPrice,e.decimalsA,e.decimalsB).toNumber(),d=Math.abs(u-l)/u*100;return{estimatedAmountIn:o.amountIn,estimatedAmountOut:o.amountOut,estimatedEndSqrtPrice:o.nextSqrtPrice,estimatedFeeAmount:o.feeAmount,isExceed:r,extraComputeLimit:c,amount:e.amount,aToB:e.a2b,byAmountIn:e.byAmountIn,priceImpactPct:d}}transformSwapData(e){const{modules:n}=this._sdk.sdkOptions.networkOptions,i=e.filter(r=>r.type!=="write_resource"?!1:r.data.type===`${n.ClmmIntegrate}::calculator::CalculatedSwapResult`);return i.length===0?[]:i[0].data.data.data||[]}async preswap(e){const{modules:n,simulationAccount:i}=this.sdk.sdkOptions.networkOptions,s=new rn(this.sdk.sdkOptions.rpcUrl),o=`${n.ClmmIntegrate}::scripts`,r="calculate_swap_result",a=[new F.TypeTagStruct(F.StructTag.fromString(e.pool.coinTypeA)),new F.TypeTagStruct(F.StructTag.fromString(e.pool.coinTypeB))],c=[rt.bcsToBytes(F.AccountAddress.fromHex(e.pool.poolAddress)),rt.bcsSerializeBool(e.a2b),rt.bcsSerializeBool(e.by_amount_in),rt.bcsSerializeUint64(BigInt(e.amount))],u=new F.TransactionPayloadEntryFunction(F.EntryFunction.natural(o,r,a,c)),l=tr(i.address),d=await s.generateRawTransaction(l,u),f=tr(i.pubkey),_=new F.Ed25519PublicKey(f.toUint8Array()),T=await s.simulateTransaction(_,d),v=this.transformSwapData(T[0].changes),k=Ve.sqrtPriceX64ToPrice(new y(e.pool.current_sqrt_price),e.decimalsA,e.decimalsB).toNumber(),U=Ve.sqrtPriceX64ToPrice(new y(v.after_sqrt_price),e.decimalsA,e.decimalsB).toNumber(),R=Math.abs(k-U)/k*100;return{estimatedAmountIn:v.amount_in&&v.fee_amount?new y(v.amount_in).add(new y(v.fee_amount)).toString():"",estimatedAmountOut:v.amount_out,estimatedEndSqrtPrice:v.after_sqrt_price,estimatedFeeAmount:v.fee_amount,isExceed:v.is_exceed,amount:e.amount,aToB:e.a2b,byAmountIn:e.by_amount_in,priceImpactPct:R}}createSwapTransactionPayload(e,n=!1){const{modules:i}=this.sdk.sdkOptions.networkOptions,s=`${i.LiquidswapDeployer}::${Ds}`,o="swap",r=ec.getDefaultSqrtPriceLimit(e.a_to_b);if(n){const u=[new F.TypeTagStruct(F.StructTag.fromString(e.coinTypeA)),new F.TypeTagStruct(F.StructTag.fromString(e.coinTypeB))],l=[rt.bcsToBytes(F.AccountAddress.fromHex(e.pool_addr)),rt.bcsSerializeBool(e.a_to_b),rt.bcsSerializeBool(e.by_amount_in),rt.bcsSerializeUint64(BigInt(e.amount)),rt.bcsSerializeUint64(BigInt(e.amount_limit)),rt.bcsSerializeU128(BigInt(r.toString())),rt.bcsSerializeStr(e.partner)];return new F.TransactionPayloadEntryFunction(F.EntryFunction.natural(s,o,u,l))}const a=[e.pool_addr,e.a_to_b,e.by_amount_in,e.amount,e.amount_limit,r.toString(),e.partner],c=[e.coinTypeA,e.coinTypeB];return{type:"entry_function_payload",function:Ee(s,o),type_arguments:c,arguments:a}}},c6=class{constructor(e){this._sdk=e}get sdk(){return this._sdk}createAddLiquidityTransactionPayload(e,n=!1){const{modules:i}=this.sdk.sdkOptions.networkOptions,s=!("delta_liquidity"in e),o=`${i.LiquidswapDeployer}::${Ds}`,r=s?"add_liquidity_fix_token":"add_liquidity";if(n){const d=[new F.TypeTagStruct(F.StructTag.fromString(e.coinTypeA)),new F.TypeTagStruct(F.StructTag.fromString(e.coinTypeB))],f=s?[rt.bcsToBytes(F.AccountAddress.fromHex(e.pool)),rt.bcsSerializeUint64(Number(e.amount_a)),rt.bcsSerializeUint64(Number(e.amount_b)),rt.bcsSerializeBool(e.fix_amount_a),rt.bcsSerializeUint64(BigInt.asUintN(64,BigInt(e.tick_lower))),rt.bcsSerializeUint64(BigInt.asUintN(64,BigInt(e.tick_upper))),rt.bcsSerializeBool(e.is_open),rt.bcsSerializeUint64(e.index)]:[rt.bcsToBytes(F.AccountAddress.fromHex(e.pool)),rt.bcsSerializeU128(e.delta_liquidity.toNumber()),rt.bcsSerializeUint64(Number(e.max_amount_a)),rt.bcsSerializeUint64(Number(e.max_amount_b)),rt.bcsSerializeUint64(BigInt.asUintN(64,BigInt(e.tick_lower))),rt.bcsSerializeUint64(BigInt.asUintN(64,BigInt(e.tick_upper))),rt.bcsSerializeBool(e.is_open),rt.bcsSerializeUint64(e.index)];return new F.TransactionPayloadEntryFunction(F.EntryFunction.natural(o,r,d,f))}const a=BigInt.asUintN(64,BigInt(e.tick_lower)).toString(),c=BigInt.asUintN(64,BigInt(e.tick_upper)).toString(),u=s?[e.pool,e.amount_a,e.amount_b,e.fix_amount_a,a,c,e.is_open,e.index]:[e.pool,e.delta_liquidity.toString(),String(e.max_amount_a),String(e.max_amount_b),a,c,e.is_open,e.index],l=[e.coinTypeA,e.coinTypeB];return{type:"entry_function_payload",function:Ee(o,r),type_arguments:l,arguments:u}}removeLiquidityTransactionPayload(e,n=!1){zT(e.delta_liquidity.gtn(0));const{modules:i}=this.sdk.sdkOptions.networkOptions,s=`${i.LiquidswapDeployer}::${Ds}`,o=`${i.ClmmIntegrate}::${a_}`,r=["remove_liquidity","remove_all_liquidity","remove_all_liquidity_for_two","remove_all_liquidity_for_three"];let a,c,u=[];if(e.rewards_num===0){if(n){const l=[new F.TypeTagStruct(F.StructTag.fromString(e.coinTypeA)),new F.TypeTagStruct(F.StructTag.fromString(e.coinTypeB))],d=[rt.bcsToBytes(F.AccountAddress.fromHex(e.pool)),rt.bcsSerializeU128(e.delta_liquidity.toNumber()),rt.bcsSerializeUint64(e.min_amount_a),rt.bcsSerializeUint64(e.min_amount_b),rt.bcsSerializeUint64(e.pos_index),rt.bcsSerializeBool(e.is_close)];return new F.TransactionPayloadEntryFunction(F.EntryFunction.natural(s,r[0],l,d))}a=Ee(s,r[0]),c=[e.coinTypeA,e.coinTypeB],u=[e.pool,e.delta_liquidity.toNumber(),e.min_amount_a,e.min_amount_b,e.pos_index,e.is_close]}else if(e.rewards_num===1){if(n){const l=[new F.TypeTagStruct(F.StructTag.fromString(e.coinTypeA)),new F.TypeTagStruct(F.StructTag.fromString(e.coinTypeB)),new F.TypeTagStruct(F.StructTag.fromString(e.coinTypeC))],d=[rt.bcsToBytes(F.AccountAddress.fromHex(e.pool)),rt.bcsSerializeU128(e.delta_liquidity.toNumber()),rt.bcsSerializeUint64(e.min_amount_a),rt.bcsSerializeUint64(e.min_amount_b),rt.bcsSerializeUint64(e.pos_index),rt.bcsSerializeBool(e.is_close)];return new F.TransactionPayloadEntryFunction(F.EntryFunction.natural(o,r[1],l,d))}a=Ee(o,r[1]),c=[e.coinTypeA,e.coinTypeB,e.coinTypeC],u=[e.pool,e.delta_liquidity.toNumber(),e.min_amount_a,e.min_amount_b,e.pos_index,e.is_close]}else if(e.rewards_num===2){if(n){const l=[new F.TypeTagStruct(F.StructTag.fromString(e.coinTypeA)),new F.TypeTagStruct(F.StructTag.fromString(e.coinTypeB)),new F.TypeTagStruct(F.StructTag.fromString(e.coinTypeC)),new F.TypeTagStruct(F.StructTag.fromString(e.coinTypeD))],d=[rt.bcsToBytes(F.AccountAddress.fromHex(e.pool)),rt.bcsSerializeU128(e.delta_liquidity.toNumber()),rt.bcsSerializeUint64(e.min_amount_a),rt.bcsSerializeUint64(e.min_amount_b),rt.bcsSerializeUint64(e.pos_index),rt.bcsSerializeBool(e.is_close)];return new F.TransactionPayloadEntryFunction(F.EntryFunction.natural(o,r[2],l,d))}a=Ee(o,r[2]),c=[e.coinTypeA,e.coinTypeB,e.coinTypeC,e.coinTypeD],u=[e.pool,e.delta_liquidity.toNumber(),e.min_amount_a,e.min_amount_b,e.pos_index,e.is_close]}else{if(n){const l=[new F.TypeTagStruct(F.StructTag.fromString(e.coinTypeA)),new F.TypeTagStruct(F.StructTag.fromString(e.coinTypeB)),new F.TypeTagStruct(F.StructTag.fromString(e.coinTypeC)),new F.TypeTagStruct(F.StructTag.fromString(e.coinTypeD)),new F.TypeTagStruct(F.StructTag.fromString(e.coinTypeE))],d=[rt.bcsToBytes(F.AccountAddress.fromHex(e.pool)),rt.bcsSerializeU128(e.delta_liquidity.toNumber()),rt.bcsSerializeUint64(e.min_amount_a),rt.bcsSerializeUint64(e.min_amount_b),rt.bcsSerializeUint64(e.pos_index),rt.bcsSerializeBool(e.is_close)];return new F.TransactionPayloadEntryFunction(F.EntryFunction.natural(o,r[3],l,d))}a=Ee(o,r[3]),c=[e.coinTypeA,e.coinTypeB,e.coinTypeC,e.coinTypeD,e.coinTypeE],u=[e.pool,e.delta_liquidity.toNumber(),e.min_amount_a,e.min_amount_b,e.pos_index,e.is_close]}return{type:"entry_function_payload",function:a,type_arguments:c,arguments:u}}closePositionTransactionPayload(e,n=!1){const{modules:i}=this.sdk.sdkOptions.networkOptions,s=`${i.LiquidswapDeployer}::${Ds}`,o="close_position";if(n){const u=[new F.TypeTagStruct(F.StructTag.fromString(e.coinTypeA)),new F.TypeTagStruct(F.StructTag.fromString(e.coinTypeB))],l=[rt.bcsToBytes(F.AccountAddress.fromHex(e.pool_address)),rt.bcsSerializeUint64(e.pos_index)];return new F.TransactionPayloadEntryFunction(F.EntryFunction.natural(s,o,u,l))}const r=Ee(s,o),a=[e.coinTypeA,e.coinTypeB],c=[e.pool_address,e.pos_index];return{type:"entry_function_payload",function:r,type_arguments:a,arguments:c}}collectFeeTransactionPayload(e,n=!1){const{modules:i}=this.sdk.sdkOptions.networkOptions,s=`${i.LiquidswapDeployer}::${Ds}`,o="collect_fee";if(n){const u=[new F.TypeTagStruct(F.StructTag.fromString(e.coinTypeA)),new F.TypeTagStruct(F.StructTag.fromString(e.coinTypeB))],l=[rt.bcsToBytes(F.AccountAddress.fromHex(e.pool)),rt.bcsSerializeUint64(e.pos_index)];return new F.TransactionPayloadEntryFunction(F.EntryFunction.natural(s,o,u,l))}const r=Ee(s,o),a=[e.coinTypeA,e.coinTypeB],c=[e.pool,e.pos_index];return{type:"entry_function_payload",function:r,type_arguments:a,arguments:c}}};function u6(t){let e="";const i=new du(t).parseTypeTag().value.type_args;if(i.length>0){const s=i[0];s.value.name.value===yA||s.value.name.value===r_?e=BA(s).lpAddress:e=Ee(Ie.fromUint8Array(s.value.address.address).toShortString(),s.value.module_name.value,s.value.name.value,[])}return e}var l6=5*60*1e3,Fi=24*60*60*1e3;function Bh(t){return Date.parse(new Date().toString())+t}var d6=class{constructor(t){this._cache={},this._sdk=t}get sdk(){return this._sdk}async getPoolImmutablesResource(t=!1){const e=this._sdk.sdkOptions.networkOptions.modules.LiquidswapDeployer,n=`${e}_getMmutablesPools`,i=this.getCacheData(n);let s;if(!t&&i!=null)s=i;else{const r=Ee(e,s_,o_),a=await this.fetchAccountResource(e,r);s=JSON.parse(JSON.stringify(a==null?void 0:a.data.data)),this.updateCache(n,s,Fi)}return s.data}buildPoolImmutables(t,e,n){const i=n.key,s=Ee(i.coin_type_a.account_address,Ki(i.coin_type_a.module_name),Ki(i.coin_type_a.struct_name)),o=Ee(i.coin_type_b.account_address,Ki(i.coin_type_b.module_name),Ki(i.coin_type_b.struct_name)),r=Ee(Ee(e,wA,bA),[s,o]);return{coinTypeA:s,coinTypeB:o,poolType:r,poolAddress:t,tickSpacing:i.tick_spacing}}async getPoolImmutables(t=[],e=0,n=100,i=!0){const s=this._sdk.sdkOptions.networkOptions.modules.LiquidswapDeployer,o=[],r=await this.getPoolImmutablesResource(i),a=t.length>0;for(let c=0;c<r.length;c+=1){const u=r[c],l=u.value;if(!(a&&!t.includes(l))){if(!a){const d=Number(c);if(d<e||d>=e+n)continue}o.push(this.buildPoolImmutables(l,s,u))}}return o}async getPools(t=[],e=0,n=100){const i=[],s=(await this.sdk.getGlobalConfig()).is_pause,o=await this.getPoolImmutables(t,e,n,!1);for(let r=0;r<o.length;r+=1){const a=o[r],c=await this.getPoolState(a.poolAddress,a.poolType,s),u={...a,...c};i.push(u);const l=`${a.poolAddress}_pool`;this.updateCache(l,u,Fi)}return i}async getPool(t,e=!0){const n=`${t}_pool`,i=this.getCacheData(n);let s;if(i!==null&&!e&&(s=i),s==null)return(await this.getPools([t]))[0];const o=(await this.sdk.getGlobalConfig(!0)).is_pause,r=await this.getPoolState(t,s.poolType,o),a={...s,...r};return this.updateCache(n,a,Fi),a}async getPoolState(t,e,n,i=!0){const s=`${t}_${e}getPool`;if(!i){const l=this.getCacheData(s);if(l!==null)return l}const o=await this.fetchAccountResource(t,e),r=JSON.parse(JSON.stringify(o==null?void 0:o.data)),a=r.rewarder_infos,c=[];a.forEach(l=>{const d=Ee(l.coin_type.account_address,Ki(l.coin_type.module_name),Ki(l.coin_type.struct_name)),f=Te.fromX64(new y(l.emissions_per_second)),_=Math.floor(f.toNumber()*60*60*24);c.push({...l,coinAddress:d,emissionsEveryDay:_})});const u={coinAmountA:r.coin_a.value,coinAmountB:r.coin_b.value,current_sqrt_price:r.current_sqrt_price,current_tick_index:Number(BigInt.asIntN(64,BigInt(r.current_tick_index.bits)).toString()),fee_growth_global_a:r.fee_growth_global_a,fee_growth_global_b:r.fee_growth_global_b,fee_protocol_coin_a:r.fee_protocol_coin_a,fee_protocol_coin_b:r.fee_protocol_coin_b,fee_rate:r.fee_rate,liquidity:r.liquidity,index:r.index,positionIndex:r.position_index,tick_indexes_handle:r.tick_indexes.handle,ticks_handle:r.ticks.handle,positions_handle:r.positions.handle,collectionName:r.collection_name,uri:r.uri,is_pause:n||r.is_pause,rewarder_infos:c,rewarder_last_updated_time:r.rewarder_last_updated_time};return this.updateCache(s,u,Fi),u}async getTickDataByIndex(t,e){const n=await this._sdk.client.getTableItem(t,{key_type:`${this.sdk.sdkOptions.networkOptions.modules.IntegerMate}::i64::I64`,value_type:`${this.sdk.sdkOptions.networkOptions.modules.LiquidswapDeployer}::pool::Tick`,key:_A(e)}),i=JSON.parse(JSON.stringify(n));return{index:i.index,sqrtPrice:i.sqrt_price,liquidityGross:i.liquidity_gross,liquidityNet:i.liquidity_net,feeGrowthOutsideA:i.fee_growth_outside_a,feeGrowthOutsideB:i.fee_growth_outside_b,rewardersGrowthOutside:i.rewarders_growth_outside}}async getPoolLowerAndUpperTicks(t,e){const n=[],i=[],s=e.ticks_handle,o=await this.sdk.Resources.getPositionList(t,[e]);for(const r of o){const a=await this.sdk.Resources.getTickDataByIndex(s,r.tick_lower_index),c=await this.sdk.Resources.getTickDataByIndex(s,r.tick_upper_index);n.push(a),i.push(c)}return[n,i]}async getPositionInfoByIndex(t,e){const n=await this._sdk.client.getTableItem(t,{key_type:"u64",value_type:`${this.sdk.sdkOptions.networkOptions.modules.LiquidswapDeployer}::pool::Position`,key:e.toString()}),i=JSON.parse(JSON.stringify(n));return{name:"",pool:i.pool,liquidity:i.liquidity,tick_lower_index:BigInt.asIntN(64,BigInt(i.tick_lower_index.bits)).toString(),tick_upper_index:BigInt.asIntN(64,BigInt(i.tick_upper_index.bits)).toString(),fee_growth_inside_a:i.fee_growth_inside_a,fee_growth_inside_b:i.fee_growth_inside_b,fee_owed_a:i.fee_owed_a,fee_owed_b:i.fee_owed_b,reward_amount_owed_0:i.rewarder_infos[0].amount_owed,reward_amount_owed_1:i.rewarder_infos[1].amount_owed,reward_amount_owed_2:i.rewarder_infos[2].amount_owed,reward_growth_inside_0:i.rewarder_infos[0].growth_inside,reward_growth_inside_1:i.rewarder_infos[1].growth_inside,reward_growth_inside_2:i.rewarder_infos[2].growth_inside,index:e}}createPositionName(t,e){return`Cetus LP | Pool${t}-${e}`}async getPositionInfo(t,e,n=!0){if(DA(e)){const i=await this.getPositionInfoByIndex(t.positions_handle,Number(e));return i.name=this.createPositionName(t.index,i.index),i}return this.getPositionInfoByTokenName(t.poolAddress,t.positions_handle,t.collectionName,e,n)}async getPositionIndex(t,e,n,i=!1){const s=`${t}_${e}_${n}_getPositionIndex`;if(!i){const a=this.getCacheData(s);if(a!==null)return a}const o=await this._sdk.tokenClient.getTokenData(t,e,n),r=JSON.parse(JSON.stringify(o)).default_properties.data.index.value;return this.updateCache(s,r,Fi),r}async getPositionInfoByTokenName(t,e,n,i,s=!0){const o=`${t}_${n}_${i}_getPositionInfo`;if(!s){const c=this.getCacheData(o);if(c!==null)return c}const r=await this.getPositionIndex(t,n,i,!1),a=await this.getPositionInfoByIndex(e,r);return a.name=i,this.updateCache(o,a,Fi),a}async getGlobalConfig(t,e=!0){const n=`${t}_getGlobalConfig`;if(!e){const r=this.getCacheData(n);if(r!==null)return r}const i=await this.fetchAccountResource(t,Ee(t,"config","GlobalConfig")),s=JSON.parse(JSON.stringify(i)).data,o={protocol_fee_rate:s.protocol_fee_rate,is_pause:s.is_pause};return this.updateCache(n,o,Fi),o}async getSpecifyCoinInfos(t){const e=[];for(const n of t){const i=`${n}_getCoinInfos`,s=this.getCacheData(i);if(s!==null)e.push(s);else{const o=vd(n).address,r=await this._sdk.Resources.fetchAccountResource(o,CA(n));if(r!=null){const a={coinAddress:n,...r.data};e.push(a),this.updateCache(i,a,Fi)}}}return e}async getCoinInfos(t,e=!0){const n=`${t}_getCoinInfos`;if(!e){const o=this.getCacheData(n);if(o!==null)return o}const i=await this.fetchAccountResources(t),s=[];return i==null||i.forEach(o=>{if(o.type.startsWith(n_)){const r=u6(o.type);r.length>0&&s.push({coinAddress:r,...o.data})}}),this.updateCache(n,s,Fi),s}async getCoinStores(t,e=!0){const n=`${t}_getCoinStores`;if(!e){const o=this.getCacheData(n);if(o!==null)return o}const i=await this.fetchAccountResources(t),s=[];return i==null||i.forEach(o=>{if(o.type.startsWith(i_)){const r=bh(o.type);r.length>0&&s.push({coinAddress:r,...o.data})}}),this.updateCache(n,s,Fi),s}async getCoinStore(t,e){const n=await this.fetchAccountResource(t,EA(e));if(n){const i=bh(n.type);if(i.length>0)return{coinAddress:i,...n.data}}return null}async getPositionList(t,e){const n=[];if(e.length===0)return[];const i=await this.getFilterTokenEvent(t);for(let s=0;s<i.length;s++){const o=i[s];try{for(const r of e)if(o.creator===r.poolAddress){const a=await this.getPositionInfoByTokenName(o.creator,r.positions_handle,o.collection,o.name);a.pool.length>0&&n.push({...o,...a})}}catch(r){console.log(r)}}return n}async getCollectionList(t){return await this.getFilterTokenEvent(t)}async getFilterTokenEvent(t){const e=[],n=[];let i=[];try{i=await this._sdk.client.getEventsByEventHandle(t,yh,"deposit_events")}catch(o){console.log(o)}i.forEach(o=>{e.push({key:`${o.data.id.token_data_id.creator}_${o.data.id.token_data_id.name}`,creator:o.data.id.token_data_id.creator,name:o.data.id.token_data_id.name,collection:o.data.id.token_data_id.collection,count:0})});let s=[];try{s=await this._sdk.client.getEventsByEventHandle(t,yh,"withdraw_events")}catch(o){console.log(o)}return s.forEach(o=>{if(o.type===mA){for(const r of e)if(r.count===0&&r.key===`${o.data.id.token_data_id.creator}_${o.data.id.token_data_id.name}`){r.count-=1;break}}}),e.forEach(o=>{o.count===0&&n.push({...o})}),n}async fetchAccountResource(t,e){var n;try{return await this._sdk.client.getAccountResource(t,e)}catch(i){if(Th(i)&&((n=i.response)==null?void 0:n.status)===404)return null;throw i}}async fetchAccountResources(t){var e;try{return await this._sdk.client.getAccountResources(t)}catch(n){if(Th(n)&&((e=n.response)==null?void 0:e.status)===404)return null;throw n}}updateCache(t,e,n=l6){let i=this._cache[t];i?(i.overdueTime=Bh(n),i.value=e):i=new fu(e,Bh(n)),this._cache[t]=i}getCacheData(t){const e=this._cache[t];return e!==void 0&&e.getCacheData()?e.value:null}},h6=class{constructor(e){this._sdk=e}get sdk(){return this._sdk}creatPoolTransactionPayload(e,n=!1){const{modules:i}=this.sdk.sdkOptions.networkOptions,s=e.delta_liquidity.gt(Et),o=s?`${i.LiquidswapDeployer}::${a_}`:`${i.LiquidswapDeployer}::${Ds}`,r=s?"create_and_add_liquidity":"create_pool";if(n){const l=[new F.TypeTagStruct(F.StructTag.fromString(e.coinTypeA)),new F.TypeTagStruct(F.StructTag.fromString(e.coinTypeB))],d=s?[rt.bcsSerializeUint64(e.tick_spacing),rt.bcsSerializeU128(BigInt(e.initialize_sqrt_price.toString())),rt.bcsSerializeStr(e.uri),rt.bcsSerializeU128(BigInt(e.delta_liquidity.toString())),rt.bcsSerializeUint64(BigInt(e.max_amount_a.toString())),rt.bcsSerializeUint64(BigInt(e.max_amount_b.toString())),rt.bcsSerializeUint64(BigInt.asUintN(64,BigInt(e.tick_lower))),rt.bcsSerializeUint64(BigInt.asUintN(64,BigInt(e.tick_upper)))]:[rt.bcsSerializeUint64(e.tick_spacing),rt.bcsSerializeU128(BigInt(e.initialize_sqrt_price.toString())),rt.bcsSerializeStr(e.uri)];return new F.TransactionPayloadEntryFunction(F.EntryFunction.natural(o,r,l,d))}const a=Ee(o,r),c=[e.coinTypeA,e.coinTypeB],u=s?[e.tick_spacing.toString(),e.initialize_sqrt_price.toString(),e.uri.toString(),e.delta_liquidity.toString(),e.max_amount_a.toString(),e.max_amount_b.toString(),BigInt.asUintN(64,BigInt(e.tick_lower)).toString(),BigInt.asUintN(64,BigInt(e.tick_upper)).toString()]:[e.tick_spacing.toString(),e.initialize_sqrt_price.toString(),e.uri.toString()];return{type:"entry_function_payload",function:a,type_arguments:c,arguments:u}}},f6=class{constructor(e){this._sdk=e,this.growthGlobal=[Et,Et,Et]}get sdk(){return this._sdk}async listRewarderInfosFromClmmpool(e){const n=await this.sdk.Resources.getPool(e),i=[];for(const s of n.rewarder_infos)i.push(s);return i}async emissionsEveryDay(e){const n=await this.listRewarderInfosFromClmmpool(e);if(!n)return null;const i=[];for(const s of n){const o=Te.fromX64(new y(s.emissions_per_second));i.push({emissions:Math.floor(o.toNumber()*60*60*24),coin_address:s.coinAddress})}return i}async collectRewarderAmount(e,n){const i=await this.sdk.Resources.getPositionInfo(e,n);return i?{reward_amount_owed_0:i.reward_amount_owed_0,reward_amount_owed_1:i.reward_amount_owed_1,reward_amount_owed_2:i.reward_amount_owed_2}:null}async updatePoolRewarder(e,n){const i=await this.sdk.Resources.getPool(e),s=i.rewarder_last_updated_time;if(i.rewarder_last_updated_time=n,i.liquidity===0||n.eq(s))return i;const o=n.div(new y(1e3)).sub(new y(s)).add(new y(15)),r=i.rewarder_infos;for(let a=0;a<r.length;a+=1){const c=r[a],u=Te.checkMulDivFloor(o,new y(c.emissions_per_second),new y(i.liquidity),128);this.growthGlobal[a]=new y(c.growth_global).add(new y(u))}return i}async posRewardersAmount(e,n,i,s){const o=Date.parse(new Date().toString()),r=await this.updatePoolRewarder(e,new y(o)),a=await this.sdk.Resources.getPositionInfo(r,n),c=parseInt(a.tick_lower_index,10),u=parseInt(a.tick_upper_index,10),l=JA(r,i,s,c,u,this.growthGlobal),d=[],f=[];if(l.length>0){const _=Te.subUnderflowU128(l[0],new y(a.reward_growth_inside_0)),T=Te.checkMulShiftRight(new y(a.liquidity),_,64,256);d.push(l[0]),f.push({amount_owed:new y(a.reward_amount_owed_0).add(T),coin_address:r.rewarder_infos[0].coinAddress})}if(l.length>1){const _=Te.subUnderflowU128(l[1],new y(a.reward_growth_inside_1)),T=Te.checkMulShiftRight(new y(a.liquidity),_,64,256);d.push(l[1]),f.push({amount_owed:new y(a.reward_amount_owed_1).add(T),coin_address:r.rewarder_infos[1].coinAddress})}if(l.length>2){const _=Te.subUnderflowU128(l[2],new y(a.reward_growth_inside_2)),T=Te.checkMulShiftRight(new y(a.liquidity),_,64,256);d.push(l[2]),f.push({amount_owed:new y(a.reward_amount_owed_2).add(T),coin_address:r.rewarder_infos[2].coinAddress})}return f}async poolRewardersAmount(e,n,i,s){const o=Date.parse(new Date().toString()),r=await this.updatePoolRewarder(n,new y(o)),a=await this.sdk.Resources.getPositionList(e,[r]),c=[Et,Et,Et];for(let u=0;u<a.length;u+=1){const l=await this.posRewardersAmount(n,a[u],i[u],s[u]);for(let d=0;d<3;d+=1)c[d]=c[d].add(l[d].amount_owed)}return c}collectPosRewarderTransactionPayload(e,n=!1){const{modules:i}=this.sdk.sdkOptions.networkOptions,s=`${i.LiquidswapDeployer}::${Ds}`,o="collect_rewarder";if(n){const u=[new F.TypeTagStruct(F.StructTag.fromString(e.coinTypeA)),new F.TypeTagStruct(F.StructTag.fromString(e.coinTypeB)),new F.TypeTagStruct(F.StructTag.fromString(e.coinTypeC))],l=[rt.bcsToBytes(F.AccountAddress.fromHex(e.pool_address)),rt.bcsSerializeU8(e.index),rt.bcsSerializeUint64(e.pos_index)];return new F.TransactionPayloadEntryFunction(F.EntryFunction.natural(s,o,u,l))}const r=Ee(s,o),a=[e.coinTypeA,e.coinTypeB,e.coinTypeC],c=[e.pool_address,e.index,e.pos_index];return{type:"entry_function_payload",function:r,type_arguments:a,arguments:c}}collectPoolRewarderTransactionPayload(e,n=!1){if(e.rewarder_nums===1){const o={pool_address:e.pool_address,index:0,pos_index:e.pos_index,coinTypeA:e.coinTypeA,coinTypeB:e.coinTypeB,coinTypeC:e.coinTypeC};return this.collectPosRewarderTransactionPayload(o,n)}const{modules:i}=this.sdk.sdkOptions.networkOptions,s=`${i.ClmmIntegrate}::${wl}`;if(e.rewarder_nums===2){const o="collect_rewarder_for_two";if(n){const u=[new F.TypeTagStruct(F.StructTag.fromString(e.coinTypeA)),new F.TypeTagStruct(F.StructTag.fromString(e.coinTypeB)),new F.TypeTagStruct(F.StructTag.fromString(e.coinTypeC)),new F.TypeTagStruct(F.StructTag.fromString(e.coinTypeD))],l=[rt.bcsToBytes(F.AccountAddress.fromHex(e.pool_address)),rt.bcsSerializeUint64(e.pos_index)];return new F.TransactionPayloadEntryFunction(F.EntryFunction.natural(s,o,u,l))}const r=Ee(s,o),a=[e.coinTypeA,e.coinTypeB,e.coinTypeC,e.coinTypeD],c=[e.pool_address,e.pos_index];return{type:"entry_function_payload",function:r,type_arguments:a,arguments:c}}if(e.rewarder_nums===3){const o="collect_rewarder_for_three";if(n){const u=[new F.TypeTagStruct(F.StructTag.fromString(e.coinTypeA)),new F.TypeTagStruct(F.StructTag.fromString(e.coinTypeB)),new F.TypeTagStruct(F.StructTag.fromString(e.coinTypeC)),new F.TypeTagStruct(F.StructTag.fromString(e.coinTypeD)),new F.TypeTagStruct(F.StructTag.fromString(e.coinTypeE))],l=[rt.bcsToBytes(F.AccountAddress.fromHex(e.pool_address)),rt.bcsSerializeUint64(e.pos_index)];return new F.TransactionPayloadEntryFunction(F.EntryFunction.natural(s,o,u,l))}const r=Ee(s,o),a=[e.coinTypeA,e.coinTypeB,e.coinTypeC,e.coinTypeD,e.coinTypeE],c=[e.pool_address,e.pos_index];return{type:"entry_function_payload",function:r,type_arguments:a,arguments:c}}}},p6=5*60*1e3,xa=24*60*60*1e3;function Eh(t){return Date.parse(new Date().toString())+t}var g6=class{constructor(e){this._cache={},this._sdk=e}get sdk(){return this._sdk}async getOwnerTokenList(e,n,i=!1){const s="getAllRegisteredTokenList";if(!i){const d=this.getCacheData(s);if(d!==null)return d}const{modules:o}=this._sdk.sdkOptions.networkOptions,r=`${o.TokenDeployer}::coin_list`,a="fetch_full_list",c=new F.TransactionPayloadEntryFunction(F.EntryFunction.natural(r,a,[],[rt.bcsToBytes(F.AccountAddress.fromHex(n))])),u=await va(new rn(this.sdk.sdkOptions.rpcUrl),e,c),l=this.transformTokenData(u.changes);return this.updateCache(s,l,xa),l}async getTokenListByCoinType(e,n=0,i=20){const{fraphQLUrl:s}=this._sdk.sdkOptions;if(!s)throw Error("The fraphQLUrl is not configured in the SDK");const o={query:`query MyQuery {
  coin_infos(
  limit: ${i}, offset: ${n},  order_by: {name: desc}, where: {  coin_type: {_regex: "${e}"}}
  ) {
    coin_type
    symbol
    name
    decimals
    creator_address
    coin_type_hash
  }
}
`,variables:null,operationName:"MyQuery"},r=await Ws.post(s,o),a=[];return r.data.data.coin_infos.forEach(c=>{a.push({address:c.coin_type,symbol:c.symbol,official_symbol:c.symbol,decimals:c.decimals,name:c.name,coingecko_id:"",project_url:"",logo_url:""})}),a}async getSpecifyTokenListByCache(e){const n="getAllRegisteredTokenList",i=this.getCacheData(n),s=[];if(i!==null){const o=i;for(const r of e)for(const a of o)if(r===a.address){s.push(a);continue}}return s}async getAllRegisteredTokenList(e,n=!1){const i="getAllRegisteredTokenList";if(!n){const d=this.getCacheData(i);if(d!==null)return d}const{modules:s}=this._sdk.sdkOptions.networkOptions,o=`${s.TokenDeployer}::coin_list`,r="fetch_all_registered_coin_info",a=new rn(this.sdk.sdkOptions.rpcUrl),c=new F.TransactionPayloadEntryFunction(F.EntryFunction.natural(o,r,[],[])),u=await va(a,e,c),l=this.transformTokenData(u.changes);return this.updateCache(i,l,xa),l}transformTokenData(e){const n=[],{modules:i}=this._sdk.sdkOptions.networkOptions,s=e.filter(a=>a.type!=="write_resource"?!1:a.data.type===`${i.TokenDeployer}::coin_list::CoinList<${i.TokenDeployer}::coin_list::CoinInfo>`);if(s.length===0)return n;const r=s[0].data.data;return"full_list"in r&&r.full_list.value_list.forEach(a=>{const c={...a},u=a.extensions.data;for(const l of u){if(l.key==="labels")try{l.value=JSON.parse(decodeURIComponent(Lo.decode(l.value)))}catch{}c[l.key]=l.value}n.push(c)}),n}async getAllRegisteredPoolList(e,n=!1){const i="getAllRegisteredPoolList";if(!n){const d=this.getCacheData(i);if(d!==null)return d}const{modules:s}=this._sdk.sdkOptions.networkOptions,o=`${s.TokenDeployer}::lp_list`,r="fetch_all_registered_coin_info",a=new rn(this.sdk.sdkOptions.rpcUrl),c=new F.TransactionPayloadEntryFunction(F.EntryFunction.natural(o,r,[],[])),u=await va(a,e,c),l=this.transformPoolData(u.changes);return this.updateCache(i,l,xa),l}async getOwnerPoolList(e,n,i=!1){const s="getAllRegisteredPoolList";if(!i){const d=this.getCacheData(s);if(d!==null)return d}const{modules:o}=this._sdk.sdkOptions.networkOptions,r=`${o.TokenDeployer}::lp_list`,a="fetch_full_list",c=new F.TransactionPayloadEntryFunction(F.EntryFunction.natural(r,a,[],[rt.bcsToBytes(F.AccountAddress.fromHex(n))])),u=await va(new rn(this.sdk.sdkOptions.rpcUrl),e,c),l=this.transformPoolData(u.changes);return this.updateCache(s,l,xa),l}transformPoolData(e){const n=[],{modules:i}=this._sdk.sdkOptions.networkOptions,s=e.filter(a=>a.type!=="write_resource"?!1:a.data.type===`${i.TokenDeployer}::lp_list::PoolList<${i.TokenDeployer}::lp_list::PoolInfo>`);if(s.length===0)return n;const r=s[0].data.data;return"full_list"in r&&r.full_list.value_list.forEach(a=>{const c={...a},u=a.extensions.data;for(const l of u){if(l.key==="labels")try{l.value=JSON.parse(decodeURIComponent(Lo.decode(l.value)))}catch{}c[l.key]=l.value}n.push(c)}),n}async getOwnerWarpPoolList(e,n,i=!1){const s=await this.getOwnerTokenList(n,e,i),o=await this.getOwnerPoolList(n,e,i),r=[];for(const a of o){for(const c of s)c.address===a.coin_a_address&&(a.coinA=c),c.address===a.coin_b_address&&(a.coinB=c);r.push(a)}return r}async getWarpPoolList(e,n=!1){const i=await this.getAllRegisteredTokenList(e,n),s=await this.getAllRegisteredPoolList(e,n),o=[];for(const r of s){for(const a of i)a.address===r.coin_a_address&&(r.coinA=a),a.address===r.coin_b_address&&(r.coinB=a);o.push(r)}return o}updateCache(e,n,i=p6){let s=this._cache[e];s?(s.overdueTime=Eh(i),s.value=n):s=new fu(n,Eh(i)),this._cache[e]=s}getCacheData(e){const n=this._cache[e];return n!==void 0&&n.getCacheData()?n.value:null}},_6=3e4,gn={maxAmountOut:Et,isExceed:!1,path:[]};function Ch(t,e){return{pair:`${t}-${e}`,reversePair:`${e}-${t}`}}function m6(t,e,n,i){const s=t.length;if(!t.length)throw new Error("routerTable is empty");if(s!==e.length)throw new Error("routerTable length not equal to feeRateArray length");let o=i?Et:new y(2).pow(new y(64)),r=[];const a=100/(t[0].length-1);switch(s){case 1:{o=t[0][t[0].length-1],n[0][n[0].length-1]||r.push({feeRate:e[0],percent:100});break}case 2:{for(let c=0;c<t[0].length;c+=1){const u=t[0].length-c-1,l=t[0][c].add(t[1][u]);if(l.gt(o)&&i||l.lt(o)&&!i)if(!n[0][c]&&!n[1][u])r=[],o=l,c>0&&r.push({feeRate:e[0],percent:c*a}),u>0&&r.push({feeRate:e[1],percent:u*a});else continue}break}case 3:{for(let c=0;c<t[0].length;c+=1)for(let u=0;u<t[0].length-c;u+=1){const l=t[0].length-c-u-1,d=t[0][c].add(t[1][u]).add(t[2][l]);if(d.gt(o)&&i||d.lt(o)&&!i){if(n[0][c]||n[1][u]||n[2][l])continue;r=[],o=d,c>0&&r.push({feeRate:e[0],percent:a*c}),u>0&&r.push({feeRate:e[1],percent:u*a}),l>0&&r.push({feeRate:e[2],percent:l*a})}}break}case 4:{for(let c=0;c<t[0].length;c+=1)for(let u=0;u<t[0].length-c;u+=1)for(let l=0;l<t[0].length-c-u;l+=1){const d=t[0].length-c-u-l-1,f=t[0][c].add(t[1][u]).add(t[2][l]).add(t[3][d]);if(f.gt(o)&&i||f.lt(o)&&!i){if(n[0][c]||n[1][u]||n[2][l]||n[3][d])continue;r=[],o=f,c>0&&r.push({feeRate:e[0],percent:a*c}),u>0&&r.push({feeRate:e[1],percent:u*a}),l>0&&r.push({feeRate:e[2],percent:l*a}),d>0&&r.push({feeRate:e[3],percent:d*a})}}break}}return r.length===0||o.eq(Et)?{maxAmountOut:Et,path:[],isExceed:!0}:{maxAmountOut:o,path:r,isExceed:!1}}var y6=class{constructor(e){this.pathProviders=[],this.coinProviders={coins:[]},this.graph=new t_,this._coinSymbolMap=new Map,this._coinAddressMap=new Map,this.poolAddressMap=new Map,this.poolMap=new Map,this.ticksMap=new Map,this._sdk=e,this.leastRefreshTime=Date.now(),this.createTxParams={partitionQuantities:[],swapDirects:[],poolAddresses:[],percents:[],totalAmounts:[],partner:"",amountLimit:"0",amountOut:"0",coinTypes:[]},this.splitUnit=50,this.poolDirectionMap=new Map,this.isInited=!1,this.getPoolAddressMapAndDirection=this.getPoolAddressMapAndDirection.bind(this),this.setCoinList=this.setCoinList.bind(this),this.loadGraph=this.loadGraph.bind(this),this.addCoinProvider=this.addCoinProvider.bind(this),this.addPathProvider=this.addPathProvider.bind(this),this.splitSwap=this.splitSwap.bind(this),this.splitSwapForRouter=this.splitSwapForRouter.bind(this),this.splitSwapForRouters=this.splitSwapForRouters.bind(this),this.refreshPoolofSwapRouter=this.refreshPoolofSwapRouter.bind(this),this.getBestSplitResultInOnePair=this.getBestSplitResultInOnePair.bind(this),this.findBestSplitPriceWithOneSkip=this.findBestSplitPriceWithOneSkip.bind(this),this.findBestSplitPriceWithTwoSkip=this.findBestSplitPriceWithTwoSkip.bind(this),this.findBestSplitPriceWithThreeSkip=this.findBestSplitPriceWithThreeSkip.bind(this),this.findBestSplitPrice=this.findBestSplitPrice.bind(this),this.price=this.price.bind(this),this.routerSwap=this.routerSwap.bind(this)}get sdk(){return this._sdk}getPoolAddressMapAndDirection(e,n){const{pair:i,reversePair:s}=Ch(e,n);let o=this.poolAddressMap.get(i);if(o!=null)return{addressMap:o,direction:!0};if(o=this.poolAddressMap.get(s),o!=null)return{addressMap:o,direction:!1}}async setCoinList(){this.coinProviders.coins.forEach(e=>{this._coinSymbolMap.set(e.symbol,e),this._coinAddressMap.set(e.address,e)})}loadGraph(){return this.pathProviders.forEach(e=>{const{paths:n}=e;n.forEach(i=>{var s,o;const r=(s=this.graph.getVertexByKey(i.base))!=null?s:new Qa(i.base),a=(o=this.graph.getVertexByKey(i.quote))!=null?o:new Qa(i.quote);this.graph.addEdge(new Qg(r,a));const c=this._coinSymbolMap.get(i.base),u=this._coinSymbolMap.get(i.quote);if(c!=null&&u!=null){const l=Ch(i.base,i.quote).pair;this.poolAddressMap.set(l,i.addressMap)}})}),this}addPathProvider(e){return this.pathProviders.push(e),this}addCoinProvider(e){return this.coinProviders=e,this}tokenInfo(e){return this._coinAddressMap.has(e)?this._coinAddressMap.get(e):this._coinSymbolMap.get(e)}getCreateTxParams(){return this.createTxParams}isPoolDirectionSet(e){return this.poolDirectionMap.get(e)!=null}getPoolDirection(e){if(this.isPoolDirectionSet(e))return this.poolDirectionMap.get(e)}setPoolDirection(e,n){this.poolDirectionMap.set(e,n)}getBestSplitResultInOnePair(e,n,i,s,o,r){if(s.eq(Et))return{maxAmountOut:Et,path:[],isExceed:!1};console.log(s.toString());const a=[],c=[],u=[],l=this.getPoolAddressMapAndDirection(n,i),d=l==null?void 0:l.addressMap;if(d)for(const[f,_]of d.entries()){const T=this.poolMap.get(_),v=this.poolDirectionMap.get(_),k=o===v,U=this.ticksMap.get(_),A=new VA(s,e,T,k,r,U).computeSwap();r?a.push(A.amountOutArray):a.push(A.amountInArray),u.push(A.isExceed),c.push(f)}return m6(a.slice(0,4),c.slice(0,4),u.slice(0,4),r)}findBestSplitPriceWithOneSkip(e,n,i,s,o){const r={maxAmountOut:new y(0),path:[],poolAddresses:[],totalAmounts:[],percents:[],isExceed:!1},a=[],c=[],u=[],l=[];if(!o){let _=gn,T=gn;if(s){if(_=this.getBestSplitResultInOnePair(50,e[0][0],e[0][1],n,i[0][0],s),_.isExceed||(T=this.getBestSplitResultInOnePair(5,e[0][2],e[0][3],_.maxAmountOut,i[0][1],s),T.isExceed))return r.isExceed=!0,r;r.maxAmountOut=T.maxAmountOut}else{if(T=this.getBestSplitResultInOnePair(5,e[0][2],e[0][3],n,i[0][1],s),T.isExceed||(_=this.getBestSplitResultInOnePair(5,e[0][0],e[0][1],T.maxAmountOut,i[0][0],s),_.isExceed))return r.isExceed=!0,r;r.maxAmountOut=_.maxAmountOut}a.push(_.path),a.push([]),a.push(T.path);const v=[],k=[],U=[];_.path.forEach(Y=>{var X;s?v.push(n.muln(Y.percent).divn(100)):v.push(T.maxAmountOut.muln(Y.percent).divn(100)),U.push(Y.percent);const et=(X=this.getPoolAddressMapAndDirection(e[0][0],e[0][1]))==null?void 0:X.addressMap.get(Y.feeRate);k.push(et)});const R=[],A=[],P=[];T.path.forEach(Y=>{var X;s?R.push(_.maxAmountOut.muln(Y.percent).divn(100)):R.push(n.muln(Y.percent).divn(100)),P.push(Y.percent);const et=(X=this.getPoolAddressMapAndDirection(e[0][2],e[0][3]))==null?void 0:X.addressMap.get(Y.feeRate);A.push(et)});let M=Et;v.forEach(Y=>{M=M.add(Y)});const K=Et;return R.forEach(Y=>{K.add(Y)}),c.push(M.toString()),c.push(Et.toString()),u.push(U),u.push([]),u.push(P),l.push(k),l.push([]),l.push(A),r.totalAmounts=c,r.path=a,r.percents=u,r.poolAddresses=l,s?r.maxAmountOut=T.maxAmountOut:r.maxAmountOut=_.maxAmountOut,r.path.length||(r.isExceed=!0),r}let d=Et;s||(d=new y(2).pow(new y(64)));const f=Na(n,this.splitUnit);for(let _=0;_<f.length;_+=1){const T=this.getBestSplitResultInOnePair(50,e[0][0],e[0][1],f[_],i[0][0],s);if(T.isExceed)continue;let v=gn,k=gn;if(s){if(v=this.getBestSplitResultInOnePair(50,e[1][0],e[1][1],f[f.length-_-1],i[1][0],s),v.isExceed||(k=this.getBestSplitResultInOnePair(5,e[1][2],e[1][3],v.maxAmountOut,i[1][1],s),k.isExceed))continue}else if(k=this.getBestSplitResultInOnePair(50,e[1][2],e[1][3],f[f.length-_-1],i[1][1],s),k.isExceed||(v=this.getBestSplitResultInOnePair(5,e[1][0],e[1][1],k.maxAmountOut,i[1][0],s),v.isExceed))continue;const U=[],R=[],A=[];T.path.forEach(b=>{var h;U.push(n.muln(_*this.splitUnit).divn(100).muln(b.percent).divn(100)),A.push(b.percent);const m=(h=this.getPoolAddressMapAndDirection(e[0][0],e[0][1]))==null?void 0:h.addressMap.get(b.feeRate);R.push(m)});const P=[],M=[],K=[];v.path.forEach(b=>{var h;s?P.push(n.muln((f.length-_-1)*this.splitUnit).divn(100).muln(b.percent).divn(100)):P.push(k.maxAmountOut.muln(b.percent).divn(100)),K.push(b.percent);const m=(h=this.getPoolAddressMapAndDirection(e[1][0],e[1][1]))==null?void 0:h.addressMap.get(b.feeRate);M.push(m)});const Y=[],X=[],et=[];k.path.forEach(b=>{var h;s?Y.push(v.maxAmountOut.muln(b.percent).divn(100)):Y.push(n.muln((f.length-_-1)*this.splitUnit).divn(100).muln(b.percent).divn(100)),et.push(b.percent);const m=(h=this.getPoolAddressMapAndDirection(e[1][2],e[1][3]))==null?void 0:h.addressMap.get(b.feeRate);X.push(m)});const z=[],O=[],$=[];if(k.maxAmountOut.add(T.maxAmountOut).gt(d)||v.maxAmountOut.add(T.maxAmountOut).lt(d)){s?d=k.maxAmountOut.add(T.maxAmountOut):d=v.maxAmountOut.add(T.maxAmountOut);let b=Et;U.forEach(m=>{b=b.add(m)});const h=Et;P.forEach(m=>{h.add(m)}),z.push(v.path),z.push(T.path),z.push(k.path),O.push(h.toString()),O.push(b.toString()),u.push(K),u.push(A),u.push(et),$.push(M),$.push(R),$.push(X),r.maxAmountOut=d,r.path=z,r.totalAmounts=O,r.percents=u,r.poolAddresses=$,r.path.length||(r.isExceed=!0)}}return r}findBestSplitPriceWithTwoSkip(e,n,i,s,o){const r={maxAmountOut:Et,path:[],totalAmounts:[],percents:[],poolAddresses:[],isExceed:!1},a=Na(n,this.splitUnit);let c=Et;if(s||(c=new y(2).pow(new y(64))),!o){for(let u=0;u<a.length;u+=1){let l=gn,d=gn,f=gn,_=gn;if(s){if(l=this.getBestSplitResultInOnePair(5,e[0][0],e[0][1],a[u],i[1][0],s),l.isExceed||(d=this.getBestSplitResultInOnePair(5,e[0][2],e[0][3],l.maxAmountOut,i[1][1],s),d.isExceed)||(f=this.getBestSplitResultInOnePair(5,e[1][0],e[1][1],a[a.length-u-1],i[1][0],s),f.isExceed)||(_=this.getBestSplitResultInOnePair(5,e[1][2],e[1][3],f.maxAmountOut,i[1][1],s),_.isExceed))continue}else if(d=this.getBestSplitResultInOnePair(5,e[0][2],e[0][3],a[u],i[1][1],s),d.isExceed||(l=this.getBestSplitResultInOnePair(5,e[0][0],e[0][1],d.maxAmountOut,i[1][0],s),l.isExceed)||(_=this.getBestSplitResultInOnePair(5,e[1][2],e[1][3],a[a.length-u-1],i[1][1],s),_.isExceed)||(f=this.getBestSplitResultInOnePair(5,e[1][0],e[1][1],_.maxAmountOut,i[1][0],s),f.isExceed))continue;const T=[],v=[],k=[];l.path.forEach(h=>{var m;s?T.push(n.muln(u*this.splitUnit).divn(100).muln(h.percent).divn(100)):T.push(d.maxAmountOut.muln(h.percent).divn(100)),k.push(h.percent);const x=(m=this.getPoolAddressMapAndDirection(e[0][0],e[0][1]))==null?void 0:m.addressMap.get(h.feeRate);v.push(x)});const U=[],R=[],A=[];d.path.forEach(h=>{var m;s?U.push(l.maxAmountOut.muln(h.percent).divn(100)):U.push(n.muln(u*this.splitUnit).divn(100).muln(h.percent).divn(100)),A.push(h.percent);const x=(m=this.getPoolAddressMapAndDirection(e[0][2],e[0][3]))==null?void 0:m.addressMap.get(h.feeRate);R.push(x)});const P=[],M=[],K=[];f.path.forEach(h=>{var m;s?P.push(n.muln((a.length-u-1)*this.splitUnit).divn(100).muln(h.percent).divn(100)):P.push(_.maxAmountOut.muln(h.percent).divn(100)),K.push(h.percent);const x=(m=this.getPoolAddressMapAndDirection(e[1][0],e[1][1]))==null?void 0:m.addressMap.get(h.feeRate);M.push(x)});const Y=[],X=[],et=[];_.path.forEach(h=>{var m;s?Y.push(f.maxAmountOut.muln(h.percent).divn(100)):Y.push(n.muln((a.length-u-1)*this.splitUnit).divn(100).muln(h.percent).divn(100)),et.push(h.percent);const x=(m=this.getPoolAddressMapAndDirection(e[1][1],e[1][2]))==null?void 0:m.addressMap.get(h.feeRate);X.push(x)});const z=[],O=[],$=[],b=[];if(d.maxAmountOut.add(_.maxAmountOut).gt(c)&&s||!s&&l.maxAmountOut.add(f.maxAmountOut).lt(c)){s?c=d.maxAmountOut.add(_.maxAmountOut):c=l.maxAmountOut.add(f.maxAmountOut);let h=Et;T.forEach(x=>{h=h.add(x)});let m=Et;P.forEach(x=>{m=m.add(x)}),z.push(l.path),z.push(d.path),z.push([]),z.push(f.path),z.push(_.path),O.push(h.toString()),O.push(m.toString()),O.push(Et.toString()),b.push(k),b.push(K),b.push([]),b.push(A),b.push(et),$.push(v),$.push(M),$.push([]),$.push(R),$.push(X),r.maxAmountOut=c,r.percents=b,r.totalAmounts=O,r.path=z,r.poolAddresses=$}}return r.path.length||(r.isExceed=!0),r}for(let u=0;u<a.length;u+=1)for(let l=0;l<a.length-u-1;l+=1){const d=a.length-u-l-1,f=this.getBestSplitResultInOnePair(5,e[0][0],e[0][1],a[d],i[0][0],s);if(f.isExceed)continue;let _=gn,T=gn,v=gn,k=gn;if(s){if(_=this.getBestSplitResultInOnePair(5,e[1][0],e[1][1],a[l],i[1][0],s),_.isExceed||(T=this.getBestSplitResultInOnePair(5,e[1][2],e[1][3],_.maxAmountOut,i[1][1],s),T.isExceed)||(v=this.getBestSplitResultInOnePair(5,e[2][0],e[2][1],a[u],i[2][0],s),v.isExceed)||(k=this.getBestSplitResultInOnePair(5,e[2][2],e[2][3],v.maxAmountOut,i[2][1],s),k.isExceed))continue}else if(T=this.getBestSplitResultInOnePair(5,e[1][2],e[1][3],a[l],i[1][1],s),T.isExceed||(_=this.getBestSplitResultInOnePair(5,e[1][0],e[1][1],T.maxAmountOut,i[1][0],s),_.isExceed)||(k=this.getBestSplitResultInOnePair(5,e[2][2],e[2][3],a[u],i[2][1],s),k.isExceed)||(v=this.getBestSplitResultInOnePair(5,e[2][0],e[2][1],k.maxAmountOut,i[2][0],s),v.isExceed))continue;const U=[],R=[],A=[];_.path.forEach(E=>{var g;s?U.push(n.muln(l*this.splitUnit).divn(100).muln(E.percent).divn(100)):U.push(T.maxAmountOut.muln(E.percent).divn(100)),A.push(E.percent);const q=(g=this.getPoolAddressMapAndDirection(e[1][0],e[1][1]))==null?void 0:g.addressMap.get(E.feeRate);R.push(q)});const P=[],M=[],K=[];T.path.forEach(E=>{var g;s?P.push(_.maxAmountOut.muln(E.percent).divn(100)):P.push(n.muln(l*this.splitUnit).divn(100).muln(E.percent).divn(100)),K.push(E.percent);const q=(g=this.getPoolAddressMapAndDirection(e[1][2],e[1][3]))==null?void 0:g.addressMap.get(E.feeRate);M.push(q)});const Y=[],X=[],et=[];v.path.forEach(E=>{var g;s?Y.push(n.muln(u*this.splitUnit).divn(100).muln(E.percent).divn(100)):Y.push(k.maxAmountOut.muln(E.percent).divn(100)),et.push(E.percent);const q=(g=this.getPoolAddressMapAndDirection(e[2][0],e[2][1]))==null?void 0:g.addressMap.get(E.feeRate);X.push(q)});const z=[],O=[],$=[];k.path.forEach(E=>{var g;s?z.push(v.maxAmountOut.muln(E.percent).divn(100)):z.push(n.muln(u*this.splitUnit).divn(100).muln(E.percent).divn(100)),$.push(E.percent);const q=(g=this.getPoolAddressMapAndDirection(e[2][2],e[2][3]))==null?void 0:g.addressMap.get(E.feeRate);O.push(q)});const b=[],h=[],m=[];f.path.forEach(E=>{var g;b.push(n.muln(d*this.splitUnit).divn(100).muln(E.percent).divn(100)),m.push(E.percent);const q=(g=this.getPoolAddressMapAndDirection(e[0][0],e[0][1]))==null?void 0:g.addressMap.get(E.feeRate);h.push(q)});let x=Et;s?x=f.maxAmountOut.add(T.maxAmountOut).add(k.maxAmountOut):x=f.maxAmountOut.add(_.maxAmountOut).add(v.maxAmountOut);const I=[],N=[],j=[],G=[];if(x.gt(c)&&s||x.lt(c)&&!s){let E=Et;U.forEach(xt=>{E=E.add(xt)});let g=Et;Y.forEach(xt=>{g=g.add(xt)});let q=Et;b.forEach(xt=>{q=q.add(xt)}),c=x,I.push(_.path),I.push(v.path),I.push(f.path),I.push(T.path),I.push(k.path),N.push(E.toString()),N.push(g.toString()),N.push(q.toString()),j.push(A),j.push(et),j.push(m),j.push(K),j.push($),G.push(R),G.push(X),G.push(h),G.push(M),G.push(O),r.maxAmountOut=x,r.path=I,r.totalAmounts=N,r.poolAddresses=G,r.percents=j}}return r.path.length||(r.isExceed=!0),r}findBestSplitPriceWithThreeSkip(e,n,i,s,o){const r={maxAmountOut:new y(0),path:[],totalAmounts:[],percents:[],poolAddresses:[],isExceed:!1};let a=Et;s||(a=new y(2).pow(new y(64)));const c=Na(n,this.splitUnit);for(let u=0;u<c.length;u+=1)for(let l=0;l<c.length-u-1;l+=1)if(o)for(let d=0;d<c.length-u-l-1;d+=1){const f=c.length-u-l-d-1,_=this.getBestSplitResultInOnePair(5,e[0][0],e[0][1],c[d],i[0][0],s);let T=gn,v=gn,k=gn,U=gn,R=gn,A=gn;if(s){if(T=this.getBestSplitResultInOnePair(5,e[1][0],e[1][1],c[l],i[1][0],s),T.isExceed||(v=this.getBestSplitResultInOnePair(5,e[1][2],e[1][3],T.maxAmountOut,i[1][1],s),v.isExceed)||(k=this.getBestSplitResultInOnePair(5,e[2][0],e[2][1],c[u],i[2][0],s),k.isExceed)||(U=this.getBestSplitResultInOnePair(5,e[2][2],e[2][3],k.maxAmountOut,i[2][1],s),U.isExceed)||(R=this.getBestSplitResultInOnePair(5,e[3][0],e[3][1],c[f],i[3][0],s),R.isExceed)||(A=this.getBestSplitResultInOnePair(5,e[3][2],e[3][3],R.maxAmountOut,i[3][1],s),A.isExceed))continue}else if(v=this.getBestSplitResultInOnePair(5,e[1][2],e[1][3],c[l],i[1][1],s),v.isExceed||(T=this.getBestSplitResultInOnePair(5,e[1][0],e[1][1],v.maxAmountOut,i[1][0],s),T.isExceed)||(U=this.getBestSplitResultInOnePair(5,e[2][2],e[2][3],c[u],i[2][1],s),U.isExceed)||(k=this.getBestSplitResultInOnePair(5,e[2][0],e[2][1],U.maxAmountOut,i[2][0],s),k.isExceed)||(A=this.getBestSplitResultInOnePair(5,e[3][2],e[3][3],c[f],i[3][1],s),A.isExceed)||(R=this.getBestSplitResultInOnePair(5,e[3][0],e[3][1],A.maxAmountOut,i[3][0],s),R.isExceed))continue;const P=[],M=[],K=[];T.path.forEach(fe=>{var ee;s?P.push(n.muln(l*this.splitUnit).divn(100).muln(fe.percent).divn(100)):P.push(v.maxAmountOut.muln(fe.percent).divn(100)),K.push(fe.percent);const ve=(ee=this.getPoolAddressMapAndDirection(e[1][0],e[1][1]))==null?void 0:ee.addressMap.get(fe.feeRate);M.push(ve)});const Y=[],X=[],et=[];v.path.forEach(fe=>{var ee;s?Y.push(T.maxAmountOut.muln(fe.percent).divn(100)):Y.push(n.muln(l*this.splitUnit).divn(100).muln(fe.percent).divn(100)),et.push(fe.percent);const ve=(ee=this.getPoolAddressMapAndDirection(e[1][2],e[1][3]))==null?void 0:ee.addressMap.get(fe.feeRate);X.push(ve)});const z=[],O=[],$=[];k.path.forEach(fe=>{var ee;s?z.push(n.muln(u*this.splitUnit).divn(100).muln(fe.percent).divn(100)):z.push(U.maxAmountOut.muln(fe.percent).divn(100)),$.push(fe.percent);const ve=(ee=this.getPoolAddressMapAndDirection(e[2][0],e[2][1]))==null?void 0:ee.addressMap.get(fe.feeRate);O.push(ve)});const b=[],h=[],m=[];U.path.forEach(fe=>{var ee;s?b.push(k.maxAmountOut.muln(fe.percent).divn(100)):b.push(n.muln(u*this.splitUnit).divn(100).muln(fe.percent).divn(100)),m.push(fe.percent);const ve=(ee=this.getPoolAddressMapAndDirection(e[2][2],e[2][3]))==null?void 0:ee.addressMap.get(fe.feeRate);h.push(ve)});const x=[],I=[],N=[];R.path.forEach(fe=>{var ee;s?x.push(n.muln(f*this.splitUnit).divn(100).muln(fe.percent).divn(100)):x.push(A.maxAmountOut.muln(fe.percent).divn(100)),N.push(fe.percent);const ve=(ee=this.getPoolAddressMapAndDirection(e[3][0],e[3][1]))==null?void 0:ee.addressMap.get(fe.feeRate);I.push(ve)});const j=[],G=[],E=[];A.path.forEach(fe=>{var ee;s?j.push(R.maxAmountOut.muln(fe.percent).divn(100)):j.push(n.muln(f*this.splitUnit).divn(100).muln(fe.percent).divn(100)),E.push(fe.percent);const ve=(ee=this.getPoolAddressMapAndDirection(e[3][2],e[3][3]))==null?void 0:ee.addressMap.get(fe.feeRate);G.push(ve)});const g=[],q=[],xt=[];_.path.forEach(fe=>{var ee;g.push(n.muln(d*this.splitUnit).divn(100).muln(fe.percent).divn(100)),xt.push(fe.percent);const ve=(ee=this.getPoolAddressMapAndDirection(e[0][0],e[0][1]))==null?void 0:ee.addressMap.get(fe.feeRate);q.push(ve)});let at=Et;s?at=_.maxAmountOut.add(v.maxAmountOut).add(U.maxAmountOut).add(A.maxAmountOut):at=_.maxAmountOut.add(T.maxAmountOut).add(k.maxAmountOut).add(R.maxAmountOut);const mt=[],se=[],te=[],Oe=[];if(at.gt(a)&&s||!s&&at.lt(a)){let fe=Et;P.forEach(nt=>{fe=fe.add(nt)});let ee=Et;z.forEach(nt=>{ee=ee.add(nt)});let ve=Et;x.forEach(nt=>{ve=ve.add(nt)});let Tn=Et;g.forEach(nt=>{Tn=Tn.add(nt)}),a=at,mt.push(T.path),mt.push(k.path),mt.push(R.path),mt.push(_.path),mt.push(v.path),mt.push(U.path),mt.push(A.path),se.push(fe.toString()),se.push(ee.toString()),se.push(ve.toString()),se.push(Tn.toString()),te.push(K),te.push($),te.push(N),te.push(xt),te.push(et),te.push(m),te.push(E),Oe.push(M),Oe.push(O),Oe.push(I),Oe.push(q),Oe.push(X),Oe.push(h),Oe.push(G),r.maxAmountOut=at,r.path=mt,r.totalAmounts=se,r.percents=te,r.poolAddresses=Oe}}else{const d=c.length-u-l-1;let f=gn,_=gn,T=gn,v=gn,k=gn,U=gn;if(s){if(f=this.getBestSplitResultInOnePair(5,e[0][0],e[0][1],c[l],i[0][0],s),f.isExceed||(_=this.getBestSplitResultInOnePair(5,e[0][2],e[0][3],f.maxAmountOut,i[0][1],s),_.isExceed)||(T=this.getBestSplitResultInOnePair(5,e[1][0],e[1][1],c[u],i[1][0],s),T.isExceed)||(v=this.getBestSplitResultInOnePair(5,e[1][2],e[1][3],T.maxAmountOut,i[1][1],s),v.isExceed)||(k=this.getBestSplitResultInOnePair(5,e[2][0],e[2][1],c[d],i[2][0],s),k.isExceed)||(U=this.getBestSplitResultInOnePair(5,e[2][2],e[2][3],T.maxAmountOut,i[2][1],s),U.isExceed))continue}else if(_=this.getBestSplitResultInOnePair(5,e[0][2],e[0][3],c[l],i[0][1],s),_.isExceed||(f=this.getBestSplitResultInOnePair(5,e[0][0],e[0][1],_.maxAmountOut,i[0][0],s),f.isExceed)||(v=this.getBestSplitResultInOnePair(5,e[1][2],e[1][3],c[u],i[1][1],s),v.isExceed)||(T=this.getBestSplitResultInOnePair(5,e[1][0],e[1][1],v.maxAmountOut,i[1][0],s),T.isExceed)||(U=this.getBestSplitResultInOnePair(5,e[2][2],e[2][3],c[d],i[2][1],s),U.isExceed)||(k=this.getBestSplitResultInOnePair(5,e[2][0],e[2][1],v.maxAmountOut,i[2][0],s),k.isExceed))continue;const R=[],A=[],P=[];f.path.forEach(at=>{var mt;s?R.push(n.muln(l*this.splitUnit).divn(100).muln(at.percent).divn(100)):R.push(_.maxAmountOut.muln(at.percent).divn(100)),P.push(at.percent);const se=(mt=this.getPoolAddressMapAndDirection(e[0][0],e[0][1]))==null?void 0:mt.addressMap.get(at.feeRate);A.push(se)});const M=[],K=[],Y=[];_.path.forEach(at=>{var mt;s?M.push(f.maxAmountOut.muln(at.percent).divn(100)):M.push(n.muln(l*this.splitUnit).divn(100).muln(at.percent).divn(100)),Y.push(at.percent);const se=(mt=this.getPoolAddressMapAndDirection(e[0][2],e[0][3]))==null?void 0:mt.addressMap.get(at.feeRate);K.push(se)});const X=[],et=[],z=[];T.path.forEach(at=>{var mt;s?X.push(n.muln(u*this.splitUnit).divn(100).muln(at.percent).divn(100)):X.push(v.maxAmountOut.muln(at.percent).divn(100)),z.push(at.percent);const se=(mt=this.getPoolAddressMapAndDirection(e[1][0],e[1][1]))==null?void 0:mt.addressMap.get(at.feeRate);et.push(se)});const O=[],$=[],b=[];v.path.forEach(at=>{var mt;s?O.push(T.maxAmountOut.muln(at.percent).divn(100)):O.push(n.muln(u*this.splitUnit).divn(100).muln(at.percent).divn(100)),b.push(at.percent);const se=(mt=this.getPoolAddressMapAndDirection(e[1][2],e[1][3]))==null?void 0:mt.addressMap.get(at.feeRate);$.push(se)});const h=[],m=[],x=[];k.path.forEach(at=>{var mt;s?h.push(n.muln(d*this.splitUnit).divn(100).muln(at.percent).divn(100)):h.push(U.maxAmountOut.muln(at.percent).divn(100)),x.push(at.percent);const se=(mt=this.getPoolAddressMapAndDirection(e[2][0],e[2][1]))==null?void 0:mt.addressMap.get(at.feeRate);m.push(se)});const I=[],N=[],j=[];U.path.forEach(at=>{var mt;s?I.push(k.maxAmountOut.muln(at.percent).divn(100)):I.push(n.muln(d*this.splitUnit).divn(100).muln(at.percent).divn(100)),j.push(at.percent);const se=(mt=this.getPoolAddressMapAndDirection(e[2][2],e[2][3]))==null?void 0:mt.addressMap.get(at.feeRate);N.push(se)});const G=[],E=[],g=[],q=[];let xt=Et;if(s?xt=_.maxAmountOut.add(v.maxAmountOut).add(U.maxAmountOut):xt=f.maxAmountOut.add(T.maxAmountOut).add(k.maxAmountOut),xt.gt(a)&&s||xt.lt(a)&&!s){let at=Et;R.forEach(te=>{at=at.add(te)});let mt=Et;X.forEach(te=>{mt=mt.add(te)});let se=Et;h.forEach(te=>{se=se.add(te)}),a=xt,G.push(f.path),G.push(T.path),G.push(k.path),G.push([]),G.push(_.path),G.push(v.path),G.push(U.path),E.push(at.toString()),E.push(mt.toString()),E.push(se.toString()),E.push(Et.toString()),g.push(P),g.push(z),g.push(x),g.push([]),g.push(Y),g.push(b),g.push(j),q.push(A),q.push(et),q.push(m),q.push([]),q.push(K),q.push($),q.push(N),r.maxAmountOut=xt,r.path=G,r.percents=g,r.totalAmounts=E,r.poolAddresses=q}}return r.path.length||(r.isExceed=!0),r}findBestSplitPrice(e,n,i,s,o,r){var a,c,u,l;let d=e.length,f=!1;e[0].length===2&&(f=!0,d-=1);let _={maxAmountOut:Et,path:[],poolAddresses:[],totalAmounts:[],percents:[],isExceed:!1},T={maxAmountOut:Et,path:[],isExceed:!1};const v=[],k=[];let U=Et;const R=[];switch(console.log(d,"skipNumber"),d){case 0:T=this.getBestSplitResultInOnePair(50,e[0][0],e[0][1],n,i[0][0],s),_.maxAmountOut=T.maxAmountOut,_.path.push(T.path),T.path.forEach(X=>{var et;const z=(et=this.getPoolAddressMapAndDirection(e[0][0],e[0][1]))==null?void 0:et.addressMap.get(X.feeRate);v.push(z);const O=n.muln(X.percent).divn(100);k.push(O),R.push(X.percent)}),k.forEach(X=>{U=U.add(X)}),_.percents.push(R),_.totalAmounts.push(U.toString()),_.poolAddresses.push(v);break;case 1:_=this.findBestSplitPriceWithOneSkip(e,n,i,s,f);break;case 2:_=this.findBestSplitPriceWithTwoSkip(e,n,i,s,f);break;case 3:_=this.findBestSplitPriceWithThreeSkip(e,n,i,s,f);break}if(_.isExceed)return _;const A=[];for(let X=0;X<_.path.length;X+=1){const{length:et}=_.path[X];A.push(et)}const P=[];if(d!==0)if(f){for(let et=1;et<1+d;et+=1){const z=[];if(A[et-1]>0)for(let O=0;O<A[et-1];O+=1)z.push(i[et][0]);P.push(z)}const X=[];for(let et=0;et<A[d];et+=1)if(A[d]>0)for(let z=0;z<A[d];z+=1)X.push(i[0][0]);P.push(X);for(let et=1;et<1+d;et+=1){const z=[];if(A[et+d]>0)for(let O=0;O<A[et+d];O+=1)z.push(i[et][1]);P.push(z)}}else{for(let X=0;X<d;X+=1){const et=[];if(A[X]>0)for(let z=0;z<A[X];z+=1)et.push(i[X][0]);P.push(et)}P.push([]);for(let X=0;X<d;X+=1){const et=[];if(A[X+d+1]>0)for(let z=0;z<A[X+d+1];z+=1)et.push(i[X][1]);P.push(et)}}else P.push([i[0][0]]);for(let X=0;X<_.poolAddresses.length;X+=1)for(let et=0;et<_.poolAddresses[X].length;et+=1){const z=this.getPoolDirection(_.poolAddresses[X][et]);z&&(P[X][et]=P[X][et]&&z)}const M=[],K=(a=this._coinSymbolMap.get(e[0][0]))==null?void 0:a.address;M.push(K);for(let X=0;X<e.length;X+=1)if(e[X].length!==2){const et=(c=this._coinSymbolMap.get(e[X][1]))==null?void 0:c.address;M.push(et)}if(e[0].length===2){const X=(u=this._coinSymbolMap.get(e[0][1]))==null?void 0:u.address;M.push(X)}else{const X=(l=this._coinSymbolMap.get(e[0][e[0].length-1]))==null?void 0:l.address;M.push(X)}const Y=s?_.maxAmountOut.muln((1-o)*1e5).divn(1e5).toString():_.maxAmountOut.muln((1+o)*1e5).divn(1e5).toString();return this.createTxParams={partitionQuantities:A,swapDirects:P,poolAddresses:_.poolAddresses,totalAmounts:_.totalAmounts,percents:_.percents,amountLimit:Y,amountOut:n.toString(),partner:r,coinTypes:M},_}async price(e,n,i,s,o,r){var a,c;const u=this.tokenInfo(e),l=this.tokenInfo(n);if(u===void 0||l===void 0)return;const d=this.graph.getVertexByKey(u.symbol),f=this.graph.getVertexByKey(l.symbol),_=this.graph.findAllPath(d,f),T=Array.from(_),v=[],k=[],U=[];for(let R=0;R<T.length;R+=1){const A=T[R];if(A.length>3)continue;const P=[],M=[];for(let K=0;K<A.length-1;K+=1){const Y=A[K].value.toString(),X=A[K+1].value.toString(),et=(a=this.getPoolAddressMapAndDirection(Y,X))==null?void 0:a.addressMap,z=(c=this.getPoolAddressMapAndDirection(Y,X))==null?void 0:c.direction;et!==void 0&&z!==void 0&&(M.push(z),P.push(Y),P.push(X),et.forEach(O=>{v.push(O)}))}if(U.push(M),k.push(P),P.length===2&&k.length>1){const K=k[0].slice();k[0]=P,k[k.length-1]=K;const Y=U[0].slice();U[0]=M,U[k.length-1]=Y}}return await this.refreshPoolofSwapRouter(v),this.findBestSplitPrice(k,i,U,s,o,r)}async routerSwap(e,n,i,s,o,r){const a=await this.price(e,n,i,s,o,r),c=this.getCreateTxParams();if(a.isExceed)return{maxAmountOut:a.maxAmountOut,path:a.path,poolAddresses:a.poolAddresses,percents:a.percents,totalAmounts:a.totalAmounts,isExceed:a.isExceed,totalPercents:[],showRouters:[],gasFee:0};const u=this.splitSwapForRouters(c,s,!0),{simulationAccount:l}=this.sdk.sdkOptions.networkOptions,d=new rn(this.sdk.sdkOptions.rpcUrl),f=tr(l.address),_=await d.generateRawTransaction(f,u),T=tr(l.pubkey),v=new F.Ed25519PublicKey(T.toUint8Array()),k=await d.simulateTransaction(v,_),U=k[0].gas_used,R=k[0].gas_unit_price,A=parseInt(U,10)*parseInt(R,10),P=[];let M=Et;a.totalAmounts.forEach(Y=>{M=M.add(new y(Y))}),a.totalAmounts.forEach(Y=>{let X;M.isZero()?X=0:X=Number(Y)/Number(M.toString())*100,P.push(X)});const K=[];for(let Y=0;Y<a.totalAmounts.length;Y+=1){const X={amount:a.totalAmounts[Y],poolAddress:[]};Y===Math.floor(a.poolAddresses.length/2)?a.poolAddresses[Y].length>0&&(X.poolAddress.push(a.poolAddresses[Y]),K.unshift(X)):a.poolAddresses[Y].length>0&&(X.poolAddress.push(a.poolAddresses[Y],a.poolAddresses[Y+Math.floor(a.poolAddresses.length/2)+1]),K.push(X))}return{maxAmountOut:a.maxAmountOut,path:a.path,poolAddresses:a.poolAddresses,percents:a.percents,totalAmounts:a.totalAmounts,isExceed:a.isExceed,totalPercents:P,showRouters:K,gasFee:A}}splitSwap(e,n,i=!1){const{modules:s}=this.sdk.sdkOptions.networkOptions,o=`${s.ClmmIntegrate}::${wl}`,r=n?"exact_input_split_swap":"exact_output_split_swap",a=[];e.poolAddresses.forEach(f=>{const _=[];f.forEach(T=>{_.push(F.AccountAddress.fromHex(T))}),a.push(_)});const c=[rt.bcsSerializeUint64(e.partitionQuantities[0]),rt.serializeVectorWithFunc(e.swapDirects[0],"serializeBool"),n6(a[0]),rt.serializeVectorWithFunc(e.percents[0],"serializeU64"),rt.bcsSerializeUint64(parseInt(e.totalAmounts[0],10)),rt.bcsSerializeUint64(parseInt(e.amountLimit,10)),rt.bcsSerializeStr(e.partner)];if(i){const f=[];for(const _ of e.coinTypes){const T=new F.TypeTagStruct(F.StructTag.fromString(_));f.push(T)}return new F.TransactionPayloadEntryFunction(F.EntryFunction.natural(o,r,f,c))}const u=Ee(o,r),l=e.coinTypes,d=[e.partitionQuantities[0],e.swapDirects[0],e.poolAddresses[0],e.percents[0],e.totalAmounts[0],e.amountLimit,e.partner];return{type:"entry_function_payload",function:u,type_arguments:l,arguments:d}}splitSwapForRouter(e,n,i,s=!1){const{modules:o}=this.sdk.sdkOptions.networkOptions,r=`${o.ClmmIntegrate}::${wl}`,a=[];e.poolAddresses.forEach(f=>{const _=[];f.forEach(T=>{_.push(F.AccountAddress.fromHex(T))}),a.push(_)});const c=[rt.serializeVectorWithFunc(e.partitionQuantities,"serializeU64"),kh(e.swapDirects,"serializeBool"),e6(a),kh(e.percents,"serializeU64"),rt.serializeVectorWithFunc(e.totalAmounts,"serializeU64"),rt.bcsSerializeUint64(parseInt(e.amountLimit,10)),rt.bcsSerializeStr(e.partner)];if(s){const f=[];for(const _ of e.coinTypes){const T=new F.TypeTagStruct(F.StructTag.fromString(_));f.push(T)}return new F.TransactionPayloadEntryFunction(F.EntryFunction.natural(r,i,f,c))}const u=[e.partitionQuantities,e.swapDirects,e.poolAddresses,e.percents,e.totalAmounts,e.amountLimit,e.partner],l=Ee(r,i),d=e.coinTypes;return{type:"entry_function_payload",function:l,type_arguments:d,arguments:u}}splitSwapForRouters(e,n,i=!1){const{length:s}=e.partitionQuantities;let o;switch(s){case 3:n?o="exact_input_split_swap_for_router_three":o="exact_output_split_swap_for_router_three";break;case 5:n?o="exact_input_split_swap_for_router_four":o="exact_output_split_swap_for_router_four";break;case 7:n?o="exact_input_split_swap_for_router_five":o="exact_output_split_swap_for_router_five";break;default:return this.splitSwap(e,n,i)}return this.splitSwapForRouter(e,n,o,i)}findUnFetchPools(e){const n=[];for(const i of e)this.poolMap.get(i)==null&&n.push(i);return n}async refreshPoolofSwapRouter(e){var n,i,s;const o=Date.now();if(this.isInited){const a=this.findUnFetchPools(e);if(o-this.leastRefreshTime<_6&&a.length===0)return}else this.isInited=!0;const r=await this._sdk.Resources.getPools(e);for(let a=0;a<e.length;a+=1)if(this.poolMap.set(r[a].poolAddress,r[a]),this.getPoolDirection(r[a].poolAddress)==null){const c=(n=this._coinAddressMap.get(r[a].coinTypeA))==null?void 0:n.symbol,u=(i=this._coinAddressMap.get(r[a].coinTypeB))==null?void 0:i.symbol,l=(s=this.getPoolAddressMapAndDirection(c,u))==null?void 0:s.direction;this.poolDirectionMap.set(r[a].poolAddress,l);const d=await this._sdk.Fetcher.fetchTicks({pool:r[a].poolAddress,coinTypeA:r[a].coinTypeA,coinTypeB:r[a].coinTypeB}),f=c_(d);this.ticksMap.set(r[a].poolAddress,f)}this.leastRefreshTime=o}},w6=class{constructor(t){this._sdk=t}get sdk(){return this._sdk}transformTickData(t){const e=[],{modules:n}=this._sdk.sdkOptions.networkOptions,i=t.filter(r=>r.type!=="write_resource"?!1:r.data.type===`${n.FetcherDeployer}::fetcher::FetchTicksResult`);if(i.length===0)return{ticks:e,index:0,offset:0};const o=i[0].data.data;return{ticks:o.ticks||[],index:Number(o.index),offset:Number(o.offset)}}async getTicks(t){const{modules:e,simulationAccount:n}=this.sdk.sdkOptions.networkOptions,i=new rn(this.sdk.sdkOptions.rpcUrl),s=`${e.FetcherDeployer}::scripts`,o="fetch_ticks",r=[new F.TypeTagStruct(F.StructTag.fromString(t.coinTypeA)),new F.TypeTagStruct(F.StructTag.fromString(t.coinTypeB))],a=[rt.bcsToBytes(F.AccountAddress.fromHex(t.pool)),rt.bcsSerializeUint64(t.index),rt.bcsSerializeUint64(t.offset),rt.bcsSerializeUint64(t.limit)],c=new F.TransactionPayloadEntryFunction(F.EntryFunction.natural(s,o,r,a)),u=tr(n.address),l=await i.generateRawTransaction(u,c),d=tr(n.pubkey),f=new F.Ed25519PublicKey(d.toUint8Array()),_=await i.simulateTransaction(f,l);return this.transformTickData(_[0].changes)}async fetchTicks(t){let e=[],n=0,i=0;const s=512;for(;;){const o=await this.getTicks({pool:t.pool,coinTypeA:t.coinTypeA,coinTypeB:t.coinTypeB,index:n,offset:i,limit:s});if(e=[...e,...o.ticks],o.ticks.length<s)break;o.offset<999?(i=o.offset+1,n=o.index):(n=o.index+1,i=0)}return e}},b6=class{constructor(t){this.globalConfig={protocol_fee_rate:"",is_pause:!1},this._sdkOptions=t,this._client=new rn(t.rpcUrl),this._tokenClient=new NT(this._client),this._swap=new a6(this),this._position=new c6(this),this._resources=new d6(this),this._pool=new h6(this),this._rewarder=new f6(this),this._router=new y6(this),this._token=new g6(this),this._fetcher=new w6(this),this._launchpad=new HA(this),this.globalConfig.protocol_fee_rate=""}async getGlobalConfig(t=!1){return(this.globalConfig.protocol_fee_rate.length===0||t)&&(this.globalConfig=await this._resources.getGlobalConfig(this._sdkOptions.networkOptions.modules.LiquidswapDeployer)),this.globalConfig}get client(){return this._client}get tokenClient(){return this._tokenClient}get Swap(){return this._swap}get Position(){return this._position}get Pool(){return this._pool}get Resources(){return this._resources}get Rewarder(){return this._rewarder}get Token(){return this._token}get Router(){return this._router}get Fetcher(){return this._fetcher}get Launchpad(){return this._launchpad}get sdkOptions(){return this._sdkOptions}};function _n(t,e){const n=xd(e);return me(t).div(n).toString()}function In(t,e){const n=xd(e);return me(t).mul(n)}function v6(t){const e=t.split("x");let n=t;return e[1][0]==="0"&&(n=e[0]+"x"+e[1].slice(1)),n}const b3=(t,e)=>JSON.stringify(t)===JSON.stringify(e),Ih=t=>{switch(t){case"account":return"account";case"token":return"";case"nftAddress":return"token";case"tx":return"txn";case"poolAddress":return"account"}},x6=t=>{switch(t){case"account":return"address";case"token":return"object";case"tx":return"txblock";case"poolAddress":return"object";case"nftAddress":return"object";case"coin":return"object"}},h_=t=>{switch(t){case"account":return"address";case"token":return"object";case"tx":return"tx";case"poolAddress":return"object";case"nftAddress":return"object";case"coin":return"coin"}},Oh=t=>{switch(t){case"account":return"account";case"token":return"object";case"tx":return"txblock";case"poolAddress":return"object";case"nftAddress":return"object";case"coin":return"coin"}};function v3(){const e=(localStorage.getItem("theme")||"sui")=="sui"?"Sui":"Aptos";return localStorage.getItem(`${e}-currentExplorerName`)||Zu[e][0].name}function ic(t,e,n){const i=localStorage.getItem("theme")||"sui",s=i=="sui"?"Sui":"Aptos";console.log(t,"url###111");const o=t.indexOf("suivision")>-1?"SuiVision":t.indexOf("suiscan")>-1?"Suiscan":"";console.log(t,o,"url##");const r=qt[s].network;let a;return s=="Aptos"?e=="nftAddress"?a=`${t}/${Ih(e)}/${n}/0?network=${r}`:a=`${t}/${Ih(e)}/${n}?network=${r}`:o=="SuiVision"?a=`${t}/${Oh(e)}/${n}`:o=="Suiscan"?a=`${t}/${r}/${h_(e)}/${n}`:a=`${t}/${x6(e)}/${n}?network=${r}`,console.log("href, chain, chainName, url, urlName, network==>",e,Oh(e),a,i,s,t,o,r),a}function x3(t,e){const n="Sui",i=Zu[n][2].link,s=Zu[n][2].name,o=qt[n].network;let r;return s=="Suiscan"&&(r=`${i}/${o}/${h_(t)}/${e}`),r}function sc(t,e){const n=xd(me(e));return Number(me(t).mul(n))}function T3(t){const e=t.toString(),n=e.indexOf(".");if(n!==-1){for(let i=n+1;i<e.length;i++)if(e[i]!=="0")return i-n-1}return-1}function A3(t,e){let n=t,i=e;if(t.includes("sui::SUI")&&t.includes("sui::SUI")){if(t.slice(-10)===e.slice(-10))return!0}else return t[2]=="0"&&(n=t.slice(0,2)+t.slice(3)),e[2]=="0"&&(i=e.slice(0,2)+e.slice(3)),(n==null?void 0:n.toLowerCase())==(i==null?void 0:i.toLowerCase());return!1}const k3=t=>it.isDecimal(t)?t:new it(t===void 0?0:t),T6=(t,e,n=!0)=>{if(`${t}`=="0")return!parseFloat(e)||!n?0:"0.".padEnd(e+2,"0");if(!t)return"--";const i=parseFloat(t),s=t.toString(),o=i<0;let r=s;if(s.toLowerCase().includes("e")){const a=s.match(/(\d+?)(?:\.(\d*))?e([+-])(\d+)/),c=a[1],u=a[2],l=a[3],d=a[4];let f="",_=u?u.substr(d):"";if(_&&(_=`.${_}`),l!=="-"){for(let T=0;T<d;T+=1){const v=u[T]||"0";f+=v}r=c+f+_}else{let T="0";for(let v=0;v<d;v+=1)f=(c[c.length-v-1]||"0")+f;c.length>d&&(T=c.substr(0,c.length-d)),r=`${T}.${f}${u}`}}if(e&&n){let a=`${r.split(".")[0]}.`;const c=r.split(".")[1]||"";for(let u=0;u<e;u+=1)a+=c[u]||"0";r=a}if(r.length>14){const a=r.split(".");a[0].length>14?r=`${a[0].slice(0,14)}+`:(r=r.slice(0,13),r.indexOf(".")===12&&(r=r.slice(0,12)))}return`${o?"-":""}${r}`};function ln(t,e){if(e=e>-1?e:0,`${t}`=="0")return parseFloat(e)?"0.".padEnd(e+2,"0"):"0";if(!t)return"--";let n=!1;parseFloat(t)<0&&(n=!0);const i=`${Math.abs(parseFloat(t))}`;if(i==="NaN")return"--";let s=i;if(i.toLowerCase().includes("e")){if(i.toLowerCase().includes("+"))return T6(i,e);const r=i.toLowerCase().split("e");let a=r[0];const c=Math.abs(parseFloat(r[1]));let u="",l=a.length,d;for(r[0].split(".")[1]&&(a=r[0].split(".")[0]+r[0].split(".")[1],l=r[0].split(".")[0].length),d=0;d<c-l;d+=1)u+="0";s=`0.${u}${a}`}if(`${e}`!="0"&&!e||`${parseFloat(t)}`=="NaN")return(n?"-":"")+s;const o=s.split(".");if(e===0)s=parseInt(s,10);else if(e>0&&o[1])if(o[1].length>e)if(o[1].includes("999999999")){const r=parseFloat(s).toFixed(e+1);s=r.slice(0,r.length-1)}else s=`${o[0]}.${o[1].slice(0,e)}`;else s=parseFloat(s).toFixed(e);else s=parseFloat(s).toFixed(e);if(s.length>=14&&s.includes(".")){const r=s.split(".");r[0].length>14?s=`${r[0].slice(0,14)}+`:(s=s.slice(0,13),s.indexOf(".")===12&&(s=s.slice(0,12)))}return(n?"-":"")+s}function A6(t,e){const n=String(t);if(!n.includes("."))return n;const i=n.split("."),s=i[0],o=i[1].slice(0,e);return Ls(o)?`${s}.${Ls(o)}`:`${s}`}function Ls(t){return t.replace(/(\s|0|\.)+$/g,"")}function ks(t,e){if(typeof t=="number"&&isNaN(t)||!Number(t))return 0;if(!String(t).includes("."))return t;const n=String(t).split(".");if(n[1]&&n[1].length<=e&&Number(n[1]))return t;const i=Math.pow(10,-e);if(Number(t)<i)return n[1]&&Ls(n[1])?n[0]+"."+Ls(n[1]):n[0];const s=A6(t,e),o=String(s).split(".");return s==="--"?"--":o[1]&&Ls(String(o[1]))?o[0]+"."+Ls(String(o[1])):o[0]}const k6=(t,e=0)=>isNaN(t)||!t?t:(t=String(t),Number(t)==0?0:!isNaN(e)&&e?(e===0&&(t=t.split(".")[0]),t.replace(/(\d+)(\.\d+)?/,(n,i,s)=>i.replace(/(\d)(?=(?:\d{3})+$)/g,"$1,")+(s?s.slice(0,e+1):""))):t.replace(/^\d+/,n=>n.replace(/(\d)(?=(?:\d{3})+$)/g,"$1,")));function S6(t,e){const i=String(t).split(".");let s=!0;if(!i[1]||i[1]&&i[1].length<=e||i[0]!=="0")return!1;if(i&&i[1]&&i[0]==="0"&&i[1][i[1].length-1]==="1")for(let o=0;o<i[1].length-1;o++)i[1]!=="0"&&(s=!1);else s=!1;return s}function P6(t){const e=String(t);if(!e.includes("."))return t;const n=e.split("."),i=n[0],s=Ls(n[1]);return s&&`${i}.${s}`}const Gi=(t,e,n=2)=>{if(t=="∞"||typeof t=="string"&&t.indexOf("+")>-1)return t;if(isNaN(t)||Number(t)==0)return"0";const i=ks(t,e),s=Math.pow(10,-e);return Number(i)&&Math.abs(Number(i))<=s||S6(i,e)?Gi(t,e+n):P6(i)};function S3(t){if(t){const e=t.toString(),n=e.indexOf(".")>-1?/(\d)(?=(\d{3})+\.)/g:/(\d)(?=(?:\d{3})+$)/g;return e.replace(n,"$1,")}}function B6(t){return Object.keys(t).length===0}function ts(t){return t.toString().length===1?"0"+t:t}function Rh(t){const e=t.getFullYear(),n=t.getMonth()+1,i=t.getDate();return e+"-"+ts(n)+"-"+ts(i)}function E6(t){const e=t.getMonth()+1,n=t.getDate();return ts(e)+"/"+ts(n)}function Uh(t){const e=t.getHours(),n=t.getMinutes(),i=t.getSeconds();return ts(e)+":"+ts(n)+":"+ts(i)}function C6(t){const e=t.getHours(),n=t.getMinutes();return ts(e)+":"+ts(n)}const P3=(t,e)=>{if(t){const n=new Date(Number(t));if(!e)return Rh(n)+" "+Uh(n);switch(e){case"HMS":return Uh(n);case"YMD":return Rh(n);case"MD":return E6(n);case"HM":return C6(n)}}},B3=(t,e)=>isNaN(t)||!t?t:Number(t)<1e-6&&Number(t)!==0?"<0.000001":k6(ks(String(t),e),e);function E3(t){const e=t.replace("%","");return Number(e)}function C3(t,e=1){return!t||isNaN(Number(t))?t:Math.abs(String(t))<1e3?Gi(t,e):Gi(Number(t)/1e3,e)+"k"}const Eo=async t=>new Promise(e=>{setTimeout(()=>{e(1)},t)}),I3=t=>t>=1e9?(t/1e9).toFixed(1)+"b":t>=1e6?(t/1e6).toFixed(1)+"m":t>=1e3?(t/1e3).toFixed(1)+"k":t.toString();function O3(t){const e=Number(Gi(t,2));return e>=1e9?(e/1e9).toFixed(1).replace(/\B(?=(\d{3})+(?!\d))/g,",")+"b":e>=1e6?(e/1e6).toFixed(1).replace(/\B(?=(\d{3})+(?!\d))/g,",")+"m":e.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")}const R3=(t,e)=>t>=1e9?(t/1e9).toFixed(e)+"b":t>=1e6?(t/1e6).toFixed(e)+"m":t>=1e3?(t/1e3).toFixed(e)+"k":t.toString(),U3=t=>{const e=Math.floor(t/1e3),n=Math.floor(new Date().getTime()/1e3),i=60,s=60*i,o=24*s,r=30*o,a=365*o,c=n-e;if(c<i)return"recently";if(c<s){const u=Math.floor(c/i);return u==1?`${u} minute ago`:`${u} minutes ago`}else if(c<o){const u=Math.floor(c/s);return u==1?`${u} hour ago`:`${u} hours ago`}else if(c<r){const u=Math.floor(c/o);return u==1?`${u} day ago`:`${u} days ago`}else if(c<a){const u=Math.floor(c/r);return u==1?`${u} mouth ago`:`${u} mouths ago`}else{const u=Math.floor(c/a);return u==1?`${u} year ago`:`${u} years ago`}};var I6=I_();const O6=Kh(I6),R6=-443636;function $3(t,e){const n=U6(t),i=(n-R6)%e;return i>e/2?n-i+e:n-i}const f_=new it("1.0001");function U6(t){return t.log(f_).toDP(0,it.ROUND_HALF_UP).toNumber()}function q3(t){return f_.pow(t)}function Fa(t,e,n){const i=Math.abs(t)%e;return t>0?i>e/2||n&&e<=2?t+e-i:t-i:i>e/2?t-e+i:t+i}function $6(){const t=qt.Aptos.liquidswapDeployer,e={rpcUrl:localStorage.getItem("Aptos-currentRpclocal2")||qt.Aptos.rpcUrl,fraphQLUrl:qt.Aptos.fraphQLUrl,networkOptions:{nativeToken:"0x1::aptos_coin::AptosCoin",launchpad:{cetusLaunchpad:qt.Aptos.Launchpad,crowdCoin:qt.Aptos.LaunchpadCrowdCoin},simulationAccount:{pubkey:qt.Aptos.accountPublicKey,address:qt.Aptos.accountAddress},modules:{LiquidswapDeployer:t,ClmmIntegrate:qt.Aptos.clmmIntegrate,FetcherDeployer:qt.Aptos.fetcher,TokenDeployer:qt.Aptos.TokenDeployer,IntegerMate:qt.Aptos.IntegerMate}}},n=new b6(e),i=Al(),s=Xh(),o=qs(()=>s),r=qs(()=>o.value.currentExplorer),{$notify:a}=Br(),c=nt=>{const{$notify:dt}=Br();dt.success({key:nt.hash+"loading",icon:Se("img",{class:{"notify-icon":!0,"loading-animate":!0},src:o.value.theme=="default"?"/image/img-loading@2x.png":"/sui-image/img-loading.png"}),message:Se("div",{class:"notification-title"},[Se("span",{innerHTML:nt.title},null)]),description:Se("div",{class:"notification-title"},[Se("div",{class:"notification-text",innerHTML:oi.global.t("newAdd.confirmingTransaction")},null),Se("a",{href:ic(r.value,"tx",nt.hash),target:"_blank",innerHTML:oi.global.t("common.viewTransaction")},null)]),duration:0,class:"ant-notification-copy ant-notification-swap"})},u=nt=>{a.success({icon:Se("svg",{class:{icon:!0},"aria-hidden":!0},[Se("use",{"xlink:href":"#icon-icon-change1"})]),message:Se("div",{class:"notification-title"},[Se("span",{innerHTML:`${nt.title} `+oi.global.t("newAdd.success")},null)]),description:Se("div",{class:"notification-title"},[Se("div",{class:"notification-text",innerHTML:nt.desc},null),Se("a",{href:ic(r.value,"tx",nt.hash),target:"_blank",innerHTML:oi.global.t("common.viewTransaction")},null)]),duration:4.5,class:"ant-notification-copy ant-notification-swap"})},l=nt=>{a.error({icon:Se("svg",{class:{icon:!0},"aria-hidden":!0},[Se("use",{"xlink:href":"#icon-a-icon-Shutdown"})]),message:Se("div",{class:"notification-title"},[Se("span",{innerHTML:`${nt} `+oi.global.t("newAdd.failed")},null)]),description:oi.global.t("newAdd.somethingWrong"),duration:4.5,class:"ant-notification-copy ant-notification-error"})},d=async(nt,dt=!1)=>{const It=await n.client.waitForTransactionWithResult(nt.hash);if(console.log("watchTransaction###res###",It),It&&It.success){a.close(nt.hash+"loading"),console.log("watchTransaction#####success"),u(nt);const Tt={walletAddress:i.address,chainName:"Aptos",...nt,...It,date:new Date().getTime()+6048e5};return s.setTransactionList(Tt),dt?{status:!0,nftInfo:It.events.filter(zt=>zt.type.includes("CreateTokenDataEvent"))}:!0}else{if(It&&!It.success)return a.close(nt.hash+"loading"),console.log("watchTransaction#####error"),l(nt.title),!1;console.log("watchTransaction#####one more"),setTimeout(()=>d(nt,dt),3e3)}},f=async(nt,dt=!1)=>{const It=await n.client.waitForTransactionWithResult(nt.hash);if(console.log("watchTransaction###res###",It),It&&It.success){console.log("watchTransaction#####success");const Tt={walletAddress:i.address,chainName:"Aptos",...nt,...It,date:new Date().getTime()+6048e5};s.setTransactionList(Tt)}},_=async nt=>{try{const dt=await n.Resources.getCoinStores(nt),It=[];return dt.forEach(Tt=>{let Ut="";Tt.coinAddress.includes("0x0000000000000000000000000000000000000000000000000000000000000001")?Ut=Tt.coinAddress.replace(/0x0000000000000000000000000000000000000000000000000000000000000001/,"0x1"):Ut=Tt.coinAddress,It.push({...Tt,coinAddress:Ut})}),It}catch{return[]}},T=async nt=>{try{i.setLoading(!0);const dt=await _(nt),It={};dt.forEach(Tt=>{const Ut=Tt?Tt.coin.value:"0";It[Tt.coinAddress]={...Tt,balance:Ut}}),console.log("1212###assets####",It),i.setAssets(It),i.setLoading(!1)}catch(dt){console.log("getAccount##error###",dt),i.setLoading(!1),i.setAssets({})}},v=async()=>{const nt={pubkey:Ii(qt.Aptos.accountPublicKey),address:Ii(qt.Aptos.accountAddress)},dt=await n.Token.getAllRegisteredTokenList(nt);return console.log("0215####tokenList####",dt),dt},k=async(nt,dt,It)=>n.Resources.getPoolState(nt,dt,It),U=async nt=>{const dt={pubkey:Ii(qt.Aptos.accountPublicKey),address:Ii(qt.Aptos.accountAddress)};return await n.Token.getOwnerWarpPoolList(qt.Aptos.TokenDeployer,dt)},R=async nt=>await n.Resources.getPool(nt);return{setTransations:f,showTransitionPending:c,showTransitionSuccess:u,showTransitionError:l,watchTransaction:d,getAccount:T,getPoolState:k,getPools:async nt=>await n.Resources.getPools(nt),getPool:R,registerCoin:nt=>({function:"0x1::managed_coin::register",type_arguments:[nt],arguments:[],type:"entry_function_payload"}),estLiquidityAndcoinAmountFromOneAmounts:nt=>{console.log("estLiquidityAndcoinAmountFromOneAmounts###params####",nt);const{tokenA:dt,tokenB:It,lowerTick:Tt,upperTick:Ut,coinAmount:Yt,iscoinA:zt,roundUp:Vt,slippage:We,curSqrtPrice:re}=nt,Jt=vi.estLiquidityAndcoinAmountFromOneAmounts(Tt,Ut,Yt,zt,Vt,We,re),je=dt.decimals,Ae=It.decimals,{tokenMaxA:L,tokenMaxB:V,liquidityAmount:W}=Jt;return{tokenMaxAOrigin:L.toString(),tokenMaxBOrigin:V.toString(),tokenMaxA:_n(L.toString(),je),tokenMaxB:_n(V.toString(),Ae),liquidityAmount:W}},getCoinAmountFromLiquidity:nt=>{const{pool:dt,position:It,roundUp:Tt}=nt,Ut=Number(It.tick_lower_index),Yt=Number(It.tick_upper_index),zt=Ve.tickIndexToSqrtPriceX64(Ut),Vt=Ve.tickIndexToSqrtPriceX64(Yt),We=vi.getCoinAmountFromLiquidity(new y(It.liquidity),new y(dt.current_sqrt_price),zt,Vt,Tt),re=_n(We.coinA.toString(),dt.coinA.decimals),Jt=_n(We.coinB.toString(),dt.coinB.decimals);return{coinaAmount:re,coinbAmount:Jt}},getAddLiquidityTransactionPayload:async nt=>{const{pool:dt,amount:It,fix_amount_a:Tt,roundUp:Ut,tick_lower:Yt,tick_upper:zt,index:Vt,slippage:We}=nt;console.log(nt,"===>params411");const re=await R(dt.poolAddress),Jt=Tt?In(It,dt.token_a.decimals):In(It,dt.token_b.decimals),je=Ve.sqrtPriceX64ToTickIndex(new y(re.current_sqrt_price));let Ae,L;if(je>=Yt&&je<=zt){const W=vi.estLiquidityAndcoinAmountFromOneAmounts(Yt,zt,new y(Jt.toString()),Tt,Ut,We,new y(re.current_sqrt_price));Ae=Tt?Jt.toNumber():W.tokenMaxA.toNumber(),L=Tt?W.tokenMaxB.toNumber():Jt.toNumber()}else je>zt?(Ae=0,L=Jt.toNumber()):je<Yt&&(Ae=Jt.toNumber(),L=0);return n.Position.createAddLiquidityTransactionPayload({pool:dt.poolAddress,coinTypeA:dt.token_a.address,coinTypeB:dt.token_b.address,amount_a:Ae,amount_b:L,fix_amount_a:Tt,tick_lower:Yt,tick_upper:zt,is_open:!Vt,index:Vt})},getRemoveLiquidityTransactionPayload:async nt=>{const{pool:dt,coinTypeA:It,coinTypeB:Tt,coinTypeC:Ut,coinTypeD:Yt,coinTypeE:zt,position:Vt,delta_liquidity:We,rewards_num:re}=nt;console.log("getRemoveLiquidityTransactionPayload####delta_liquidity#####",We.toString());const Jt=await R(dt.poolAddress),je={...dt,...Jt},Ae=Number(Vt.tick_lower_index),L=Number(Vt.tick_upper_index),V=Ve.tickIndexToSqrtPriceX64(Ae),W=Ve.tickIndexToSqrtPriceX64(L),tt=vi.getCoinAmountFromLiquidity(We,new y(je.current_sqrt_price),V,W,!0),ct=me(tt.coinA.toString()).mul(me(1-nt.slippage/100)),ut=me(tt.coinB.toString()).mul(me(1-nt.slippage/100));return await n.Position.removeLiquidityTransactionPayload({pool:dt.poolAddress,coinTypeA:It,coinTypeB:Tt,coinTypeC:Ut,coinTypeD:Yt,coinTypeE:zt,delta_liquidity:We,min_amount_a:Number(ln(ct.toString(),0)),min_amount_b:Number(ln(ut.toString(),0)),pos_index:nt.position.index,is_close:!1,rewards_num:re})},getCollectFeeTransactionPayload:async nt=>{console.log("1130###getCollectFeeTransactionPayload###params",{pool:nt.pool.poolAddress,coinTypeA:nt.pool.token_a.address,coinTypeB:nt.pool.token_b.address,pos_index:nt.position.index});const dt=await n.Position.collectFeeTransactionPayload({pool:nt.pool.poolAddress,coinTypeA:nt.pool.token_a.address,coinTypeB:nt.pool.token_b.address,pos_index:nt.position.index});return console.log("1130###getCollectFeeTransactionPayload###result##",dt),dt},getPositionList:async(nt,dt)=>{if(qt.Aptos.network==="mainnet"){const It={operationName:"AccountTokensData",variables:{owner_address:nt,limit:1e5,offset:0},query:`query AccountTokensData($owner_address: String, $limit: Int, $offset: Int) {
  current_token_ownerships(
    where: {owner_address: {_eq: $owner_address}, amount: {_gt: "0"}}
    limit: $limit
    offset: $offset
  ) {
    token_data_id_hash
 creator_address
 name
    collection_name
  table_type
    property_version
    amount
    __typename
  }
}`},Tt=await $fetch("https://indexer.mainnet.aptoslabs.com/v1/graphql",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(It)});console.log("0116###pools####",dt);const Ut=Tt&&Tt.data&&Tt.data.current_token_ownerships||[];console.log("###list",Ut);const Yt=[];for(let zt=0;zt<Ut.length;zt++){const Vt=Ut[zt],We=dt[v6(Vt.creator_address)];if(console.log(We,"##pool"),We){const re=Vt.name.split("-")[1],Jt=We.positions_handle,je=await n.Resources.getPositionInfoByIndex(Jt,re);Yt.push({...je,tokenName:Vt.name})}}return console.log("0221###aptos###getPositionList###",Yt),Yt}else{const It=Object.values(dt);console.log(It,"###poolList");const Tt=await n.Resources.getPositionList(nt,It);return console.log("0221###aptos###getPositionList###list###",Tt),Tt}},getPositionInfo:async(nt,dt,It,Tt="")=>({...await n.Resources.getPositionInfo(nt,It),tokenName:It,collectionName:dt}),getSwapTransactionPayload:async nt=>{const{pool:dt,a2b:It,byAmountIn:Tt,amount:Ut,slippage:Yt}=nt,zt=dt.poolAddress||dt.address,Vt=dt.token_a.decimals,We=dt.token_b.decimals,re=await R(dt.address);let Jt;It&&Tt||!It&&!Tt?Jt=In(Ut,Vt):Jt=In(Ut,We);const je=await n.Swap.preswap({pool:re,decimalsA:Vt,decimalsB:We,a2b:It,by_amount_in:Tt,amount:Jt.toString()});console.log("1130###getSwapTransactionPayload###preSwapRes###",je),console.log("1130###getSwapTransactionPayload###preSwapRes.estimatedAmountOut###",je.estimatedAmountOut.toString()),console.log("1130###getSwapTransactionPayload###preSwapRes.estimatedAmountIn###",je.estimatedAmountIn.toString());const Ae=me(je.estimatedAmountOut.toString()),L=me(je.estimatedAmountIn.toString()),V=Tt?Ae.sub(Ae.mul(Yt)):L.add(L.mul(Yt));console.log("1130###amountLimit####",V.toString()),console.log("1130###swap##params###",{pool_addr:zt,coinTypeA:dt.token_a.address,coinTypeB:dt.token_b.address,a_to_b:je.aToB,by_amount_in:je.byAmountIn,amount:je.amount.toString(),amount_limit:ln(V.toString(),0)||""});const W=n.Swap.createSwapTransactionPayload({pool_addr:zt,coinTypeA:dt.token_a.address,coinTypeB:dt.token_b.address,a_to_b:je.aToB,by_amount_in:je.byAmountIn,amount:je.amount.toString(),amount_limit:ln(V.toString(),0)||"",partner:""});return console.log("1130###swap##result###",W),W},getCoin:nt=>({type:"entry_function_payload",function:"0x84dc9d921d277db5047dcb17addc2ecfbddfad087dd4ea825b2d17785755cb29::cetus_faucet",arguments:[],type_arguments:[]}),preSwap:async nt=>{const{pool:dt,a2b:It,byAmountIn:Tt,amount:Ut}=nt;console.log(nt,"===>params");const Yt=dt.coinA.decimals,zt=dt.coinB.decimals;let Vt=dt;dt.coinTypeA||(Vt={...dt,poolAddress:dt.address,coinTypeA:dt.coinA.address,coinTypeB:dt.coinB.address});let We;It&&Tt||!It&&!Tt?We=In(Ut,Yt):We=In(Ut,zt);const re=await n.Swap.preswap({pool:Vt,decimalsA:Yt,decimalsB:zt,a2b:It,by_amount_in:Tt,amount:We.toString()});return{...re,estimatedAmountIn:ks(_n(re.estimatedAmountIn.toString(),It?Yt:zt),It?Yt:zt),estimatedAmountOut:ks(_n(re.estimatedAmountOut.toString(),It?zt:Yt),It?zt:Yt),priceImpactPct:ln(re.priceImpactPct,2)}},getTicks:async nt=>{try{return{list:await n.Fetcher.fetchTicks({pool:nt.poolAddress,coinTypeA:nt.coinTypeA,coinTypeB:nt.coinTypeB}),address:nt.poolAddress}}catch(dt){console.log("getTicks Error###",dt)}},TickMath:Ve,TickUtil:bl,ClmmPoolUtil:vi,getNearestTickByTick:Fa,getTickDataFromUrlData:c_,getCollectFeesQuote:async nt=>{console.log(nt,"params====>");const{pool:dt,position:It,tickLowerData:Tt,tickUpperData:Ut}=nt,Yt=jA({clmmpool:dt,position:It,tickLower:Tt,tickUpper:Ut}),zt=_n(Yt.feeOwedA.toString(),dt.token_a.decimals),Vt=_n(Yt.feeOwedB.toString(),dt.token_b.decimals);return console.log("0118###useApots###result.feeOwedA.toString()###",Yt.feeOwedA.toString()),console.log("0118###useApots###result.feeOwedB.toString()###",Yt.feeOwedB.toString()),console.log("0118###useApots###feeOwedA###",zt),console.log("0118###useApots###feeOwedB###",Vt),{feeOwedA:Number(zt)>99999999999||Number(zt)<0?"0":zt,feeOwedB:Number(Vt)>99999999999||Number(Vt)<0?"0":Vt}},mintCoin:nt=>({function:`${qt.Aptos.faucetObjectId}::coin::mint`,type_arguments:[`${qt.Aptos.faucetObjectId}::coin::${nt.name}`],arguments:[nt.amount],type:"entry_function_payload"}),getNftHash:nt=>{const dt=`${nt.creator}::${nt.collection}::${nt.name}`;return O6(dt).toString()},getCollectRewarderTransactionPayload:nt=>n.Rewarder.collectPoolRewarderTransactionPayload(nt),getPosRewardersAmount:async nt=>{console.log(JSON.stringify(nt),"=====>params792");const{poolAddress:dt,positionName:It,tickLowerData:Tt,tickUpperData:Ut}=nt;return await n.Rewarder.posRewardersAmount(dt,It,Tt,Ut)},getTokenList:v,getTickDataByIndex:async(nt,dt)=>(console.log(nt,dt,"getTickDataByIndex"),await n.Resources.getTickDataByIndex(nt,dt)),initSwapRouter:async nt=>{n.Router.addPathProvider(nt),await n.Router.setCoinList({pubkey:Ii(qt.Aptos.accountPublicKey),address:Ii(qt.Aptos.accountAddress)}),await n.Router.loadGraph()},getSwapRouter:async(nt,dt)=>await n.Router.price(nt,dt),getEstPositionAPRWithDelta:async(nt,dt,It,Tt,Ut,Yt,zt,Vt,We,re,Jt,je,Ae,L,V,W,tt,ct,ut,yt,wt,pt,Pt,_t)=>await NA(nt,dt,It,Tt,Ut,Yt,zt,Vt,We,re,Jt,je,Ae,L,V,W,tt,ct,ut,yt,wt,pt,Pt,_t),getPriceImpactPct:(nt,dt,It)=>{const Tt=Ve.sqrtPriceX64ToPrice(new y(nt.current_sqrt_price),nt.coinA.decimals,nt.coinB.decimals).toNumber(),Ut=It?Tt:1/Tt,Yt=Math.abs(Ut-Number(dt))/Number(Ut)*100;return Number(ln(Yt,2))},getLpList:U,getEstPositionAPRWithMulti:async(nt,dt,It,Tt)=>await FA(nt,dt,It,Tt),getCreatPoolTransactionPayload:async nt=>{const{coinTypeA:dt,coinTypeB:It,tick_lower:Tt,tick_upper:Ut,tick_spacing:Yt,initialize_sqrt_price:zt,max_amount_a:Vt,max_amount_b:We,slippage:re,fix_amount_a:Jt,decimalsA:je,decimalsB:Ae,liquidityInput:L}=nt;console.log(nt,"params===>");const V=Jt?In(Vt,je):In(We,Ae);console.log(V,"===>coinAmount");const W=Ve.sqrtPriceX64ToTickIndex(new y(zt));let tt,ct;const ut=Ve.tickIndexToSqrtPriceX64(Tt),yt=Ve.tickIndexToSqrtPriceX64(Ut);console.log(ut,"===>minPriceX64"),console.log(yt,"===>maxPriceX64");let wt;return W>Tt&&W<Ut?(wt=vi.estLiquidityAndcoinAmountFromOneAmounts(Tt,Ut,new y(V.toString()),Jt,!0,re,new y(zt)),tt=Jt?V.toNumber():wt.tokenMaxA.toNumber(),ct=Jt?wt.tokenMaxB.toNumber():V.toNumber()):W>=Ut?(wt=Bo(ut,yt,new y(V.toString())),tt=new y(L.tokenMaxA*Math.pow(10,je)),ct=new y(L.tokenMaxB*Math.pow(10,Ae))):W<=Tt&&(wt=Po(ut,yt,new y(V.toString())),tt=new y(L.tokenMaxA*Math.pow(10,je)),ct=new y(L.tokenMaxB*Math.pow(10,Ae))),console.log(wt,"===>preAddResult"),await n.Pool.creatPoolTransactionPayload({coinTypeA:dt,coinTypeB:It,tick_spacing:Yt,initialize_sqrt_price:new y(zt),uri:"",delta_liquidity:W>Tt&&W<Ut?wt.liquidityAmount:wt,max_amount_a:tt,max_amount_b:ct,tick_lower:Tt,tick_upper:Ut},!0)},getTokenListByCoinType:async()=>await n.Token.getTokenListByCoinType("",0,99999),getPoolImmutables:async()=>await n.Resources.getPoolImmutables(),estimateLiquidityForCoinA:Po,estimateLiquidityForCoinB:Bo,getTokenBySymbol:async(nt,dt)=>{if(!dt)return null;let It=null;for(const Tt in nt){const Ut=nt[Tt];if(Ut.address.toUpperCase()===dt.toUpperCase()){It=Ut;break}}return It},estCoinAmountsFromTotalAmount:nt=>{const{lowerTick:dt,upperTick:It,decimalsA:Tt,decimalsB:Ut,curSqrtPrice:Yt,totalAmount:zt,tokenPriceA:Vt,tokenPriceB:We}=nt;console.log(JSON.stringify({...nt,curSqrtPrice:Yt.toString()}),"params===>");const re=vi.estCoinAmountsFromTotalAmount(dt,It,Yt,zt,Vt,We);console.log("coinAmounts: ",re);const Jt=sc(re.amountA.toFixed(Tt,it.ROUND_UP).toString(),Tt),je=sc(re.amountB.toFixed(Ut,it.ROUND_UP).toString(),Ut),Ae={coinA:new y(Jt),coinB:new y(je)};return{amountA:_n(Jt.toString(),Tt),amountB:_n(je.toString(),Ut),tokenAmountsInfo:Ae}},getCreateAddLiquidityPayload:async nt=>{const{curSqrtPrice:dt,tickLower:It,tickUpper:Tt,tokenAmounts:Ut,pool:Yt,slippage:zt}=nt;console.log(JSON.stringify(nt),"####getCreateAddLiquidityPayload 1593");const Vt=vi.estimateLiquidityFromcoinAmounts(dt,It,Tt,Ut),We=new it(Ut.coinA.toString()).mul(1+zt),re=new it(Ut.coinB.toString()).mul(1+zt),Jt={coinTypeA:Yt.coinTypeA,coinTypeB:Yt.coinTypeB,tick_lower:It,tick_upper:Tt,pool:Yt.address,delta_liquidity:Vt,max_amount_a:it.ceil(We).toString(),max_amount_b:it.ceil(re).toString(),is_open:!0,index:0};return console.log(JSON.stringify(Jt),"==>addLiquidityPayloadParams"),await n.Position.createAddLiquidityTransactionPayload(Jt)},calculateDepositRatioFixTokenA:(nt,dt,It)=>vi.calculateDepositRatioFixTokenA(nt,dt,It)}}let Ta;const q6=new Uint8Array(16);function M6(){if(!Ta&&(Ta=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!Ta))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return Ta(q6)}const $n=[];for(let t=0;t<256;++t)$n.push((t+256).toString(16).slice(1));function D6(t,e=0){return $n[t[e+0]]+$n[t[e+1]]+$n[t[e+2]]+$n[t[e+3]]+"-"+$n[t[e+4]]+$n[t[e+5]]+"-"+$n[t[e+6]]+$n[t[e+7]]+"-"+$n[t[e+8]]+$n[t[e+9]]+"-"+$n[t[e+10]]+$n[t[e+11]]+$n[t[e+12]]+$n[t[e+13]]+$n[t[e+14]]+$n[t[e+15]]}const L6=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),$h={randomUUID:L6};function qh(t,e,n){if($h.randomUUID&&!e&&!t)return $h.randomUUID();t=t||{};const i=t.random||(t.rng||M6)();if(i[6]=i[6]&15|64,i[8]=i[8]&63|128,e){n=n||0;for(let s=0;s<16;++s)e[n+s]=i[s];return e}return D6(i)}var N6=Object.defineProperty,F6=(t,e,n)=>e in t?N6(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,j6=(t,e,n)=>(F6(t,typeof e!="symbol"?e+"":e,n),n),gi=5*60*1e3,Kt=24*60*60*1e3;function on(t){return Date.parse(new Date().toString())+t}var Yn=class{constructor(t,e=0){Ft(this,"overdueTime");Ft(this,"value");this.overdueTime=e,this.value=t}isValid(){return this.value===null?!1:this.overdueTime===0?!0:!(Date.parse(new Date().toString())>this.overdueTime)}};it.config({precision:64,rounding:it.ROUND_DOWN,toExpNeg:-64,toExpPos:64});var Mn=it,Mt=class extends Error{constructor(e,n){super(e);Ft(this,"message");Ft(this,"errorCode");this.message=e,this.errorCode=n}static isClmmpoolsErrorCode(e,n){return e instanceof Mt&&e.errorCode===n}},Zt=new y(0),Vi=new y(1),_u=new y(2);_u.pow(new y(128));var nr=_u.pow(new y(64)).sub(Vi),z6=_u.pow(new y(128)).sub(Vi),qe=class{static toX64_BN(t){return t.mul(new y(2).pow(new y(64)))}static toX64_Decimal(t){return t.mul(Mn.pow(2,64))}static toX64(t){return new y(t.mul(Mn.pow(2,64)).floor().toFixed())}static fromX64(t){return new Mn(t.toString()).mul(Mn.pow(2,-64))}static fromX64_Decimal(t){return t.mul(Mn.pow(2,-64))}static fromX64_BN(t){return t.div(new y(2).pow(new y(64)))}static shiftRightRoundUp(t){let e=t.shrn(64);return t.mod(nr).gt(Zt)&&(e=e.add(Vi)),e}static divRoundUp(t,e){return t.mod(e).eq(Zt)?t.div(e):t.div(e).add(new y(1))}static subUnderflowU128(t,e){return t.lt(e)?t.sub(e).add(z6):t.sub(e)}static checkUnsignedSub(t,e){const n=t.sub(e);if(n.isNeg())throw new Mt("Unsigned integer sub overflow","UnsignedIntegerOverflow");return n}static checkMul(t,e,n){const i=t.mul(e);if(this.isOverflow(i,n))throw new Mt("Multiplication overflow","MultiplicationOverflow");return i}static checkMulDivFloor(t,e,n,i){if(n.eq(Zt))throw new Mt("Devide by zero","DivideByZero");const s=t.mul(e).div(n);if(this.isOverflow(s,i))throw new Mt("Multiplication div overflow","MulDivOverflow");return s}static checkMulDivCeil(t,e,n,i){if(n.eq(Zt))throw new Mt("Devide by zero","DivideByZero");const s=t.mul(e).add(n.sub(Vi)).div(n);if(this.isOverflow(s,i))throw new Mt("Multiplication div overflow","MulDivOverflow");return s}static checkMulDivRound(t,e,n,i){if(n.eq(Zt))throw new Mt("Devide by zero","DivideByZero");const s=t.mul(e.add(n.shrn(1))).div(n);if(this.isOverflow(s,i))throw new Mt("Multiplication div overflow","MulDivOverflow");return s}static checkMulShiftRight(t,e,n,i){const s=t.mul(e).div(new y(2).pow(new y(n)));if(this.isOverflow(s,i))throw new Mt("Multiplication shift right overflow","MulShiftRightOverflow");return s}static checkMulShiftRight64RoundUpIf(t,e,n,i){const s=t.mul(e),r=i&&s.and(nr).gt(Zt)?s.shrn(64).add(Vi):s.shrn(64);if(this.isOverflow(r,n))throw new Mt("Multiplication shift right overflow","MulShiftRightOverflow");return r}static checkMulShiftLeft(t,e,n,i){const s=t.mul(e).shln(n);if(this.isOverflow(s,i))throw new Mt("Multiplication shift left overflow","MulShiftLeftOverflow");return s}static checkDivRoundUpIf(t,e,n){if(e.eq(Zt))throw new Mt("Devide by zero","DivideByZero");return n?this.divRoundUp(t,e):t.div(e)}static isOverflow(t,e){return t.gte(_u.pow(new y(e)))}static sign(t){return t.testn(127)?1:0}static is_neg(t){return this.sign(t)===1}static abs_u128(t){return t.gt(Zt)?t:this.u128_neg(t.subn(1))}static u128_neg(t){return t.uxor(new y("ffffffffffffffffffffffffffffffff",16))}static neg(t){return this.is_neg(t)?t.abs():this.neg_from(t)}static abs(t){return this.sign(t)===0?t:this.u128_neg(t.sub(new y(1)))}static neg_from(t){return t.eq(Zt)?t:this.u128_neg(t).add(new y(1)).or(new y(1).shln(127))}};function H6(t){return{coinA:t.coinTypeA,coinB:t.coinTypeB,currentSqrtPrice:new y(t.current_sqrt_price),currentTickIndex:t.current_tick_index,feeGrowthGlobalA:new y(t.fee_growth_global_a),feeGrowthGlobalB:new y(t.fee_growth_global_b),feeProtocolCoinA:new y(t.fee_protocol_coin_a),feeProtocolCoinB:new y(t.fee_protocol_coin_b),feeRate:new y(t.fee_rate),liquidity:new y(t.liquidity),tickIndexes:[],tickSpacing:Number(t.tickSpacing),ticks:[],collection_name:""}}var vl=443636,xl=-443636,mu="79226673515401279992447579055",yu="4295048016",Co=new y(1e6),Bt="0x0000000000000000000000000000000000000000000000000000000000000006",K6="partner",Cr="pool_script",Ps="pool_script_v2",Ns="router",zu="router_with_partner",Pi="fetcher_script",G6="expect_swap",Mh="utils",Hu="custodian_v2",W6="clob_v2",X6="endpoints_v2",p_=(t=>(t.Deleted="Deleted",t.Exists="Exists",t.NotExists="NotExists",t))(p_||{});function J(t){if(t.config===void 0)throw new Mt(`package: ${t.package_id}  not config in sdk SdkOptions`,"InvalidConfig");return t.config}var V6=14,J6="59543866431248",Z6="184467440737095516",Y6="15793534762490258745",Q6=443636;function tk(t,e,n){const i=t.toTwos(n).shln(e);return i.imaskn(n+1),i.fromTwos(n)}function Ge(t,e,n){const i=t.toTwos(n).shrn(e);return i.imaskn(n-e+1),i.fromTwos(n-e)}function ek(t){let e;return t&1?e=new y("79232123823359799118286999567"):e=new y("79228162514264337593543950336"),t&2&&(e=Ge(e.mul(new y("79236085330515764027303304731")),96,256)),t&4&&(e=Ge(e.mul(new y("79244008939048815603706035061")),96,256)),t&8&&(e=Ge(e.mul(new y("79259858533276714757314932305")),96,256)),t&16&&(e=Ge(e.mul(new y("79291567232598584799939703904")),96,256)),t&32&&(e=Ge(e.mul(new y("79355022692464371645785046466")),96,256)),t&64&&(e=Ge(e.mul(new y("79482085999252804386437311141")),96,256)),t&128&&(e=Ge(e.mul(new y("79736823300114093921829183326")),96,256)),t&256&&(e=Ge(e.mul(new y("80248749790819932309965073892")),96,256)),t&512&&(e=Ge(e.mul(new y("81282483887344747381513967011")),96,256)),t&1024&&(e=Ge(e.mul(new y("83390072131320151908154831281")),96,256)),t&2048&&(e=Ge(e.mul(new y("87770609709833776024991924138")),96,256)),t&4096&&(e=Ge(e.mul(new y("97234110755111693312479820773")),96,256)),t&8192&&(e=Ge(e.mul(new y("119332217159966728226237229890")),96,256)),t&16384&&(e=Ge(e.mul(new y("179736315981702064433883588727")),96,256)),t&32768&&(e=Ge(e.mul(new y("407748233172238350107850275304")),96,256)),t&65536&&(e=Ge(e.mul(new y("2098478828474011932436660412517")),96,256)),t&131072&&(e=Ge(e.mul(new y("55581415166113811149459800483533")),96,256)),t&262144&&(e=Ge(e.mul(new y("38992368544603139932233054999993551")),96,256)),Ge(e,32,256)}function nk(t){const e=Math.abs(t);let n;return e&1?n=new y("18445821805675392311"):n=new y("18446744073709551616"),e&2&&(n=Ge(n.mul(new y("18444899583751176498")),64,256)),e&4&&(n=Ge(n.mul(new y("18443055278223354162")),64,256)),e&8&&(n=Ge(n.mul(new y("18439367220385604838")),64,256)),e&16&&(n=Ge(n.mul(new y("18431993317065449817")),64,256)),e&32&&(n=Ge(n.mul(new y("18417254355718160513")),64,256)),e&64&&(n=Ge(n.mul(new y("18387811781193591352")),64,256)),e&128&&(n=Ge(n.mul(new y("18329067761203520168")),64,256)),e&256&&(n=Ge(n.mul(new y("18212142134806087854")),64,256)),e&512&&(n=Ge(n.mul(new y("17980523815641551639")),64,256)),e&1024&&(n=Ge(n.mul(new y("17526086738831147013")),64,256)),e&2048&&(n=Ge(n.mul(new y("16651378430235024244")),64,256)),e&4096&&(n=Ge(n.mul(new y("15030750278693429944")),64,256)),e&8192&&(n=Ge(n.mul(new y("12247334978882834399")),64,256)),e&16384&&(n=Ge(n.mul(new y("8131365268884726200")),64,256)),e&32768&&(n=Ge(n.mul(new y("3584323654723342297")),64,256)),e&65536&&(n=Ge(n.mul(new y("696457651847595233")),64,256)),e&131072&&(n=Ge(n.mul(new y("26294789957452057")),64,256)),e&262144&&(n=Ge(n.mul(new y("37481735321082")),64,256)),n}var Nt=class{static priceToSqrtPriceX64(t,e,n){return qe.toX64(t.mul(Mn.pow(10,n-e)).sqrt())}static sqrtPriceX64ToPrice(t,e,n){return qe.fromX64(t).pow(2).mul(Mn.pow(10,e-n))}static tickIndexToSqrtPriceX64(t){return t>0?new y(ek(t)):new y(nk(t))}static sqrtPriceX64ToTickIndex(t){if(t.gt(new y(mu))||t.lt(new y(yu)))throw new Mt("Provided sqrtPrice is not within the supported sqrtPrice range.","InvalidSqrtPrice");const e=t.bitLength()-1,n=new y(e-64),i=tk(n,32,128);let s=new y("8000000000000000","hex"),o=0,r=new y(0),a=e>=64?t.shrn(e-63):t.shln(63-e);for(;s.gt(new y(0))&&o<V6;){a=a.mul(a);const T=a.shrn(127);a=a.shrn(63+T.toNumber()),r=r.add(s.mul(T)),s=s.shrn(1),o+=1}const c=r.shrn(32),l=i.add(c).mul(new y(J6)),d=Ge(l.sub(new y(Z6)),64,128).toNumber(),f=Ge(l.add(new y(Y6)),64,128).toNumber();return d===f?d:Nt.tickIndexToSqrtPriceX64(f).lte(t)?f:d}static tickIndexToPrice(t,e,n){return Nt.sqrtPriceX64ToPrice(Nt.tickIndexToSqrtPriceX64(t),e,n)}static priceToTickIndex(t,e,n){return Nt.sqrtPriceX64ToTickIndex(Nt.priceToSqrtPriceX64(t,e,n))}static priceToInitializableTickIndex(t,e,n,i){return Nt.getInitializableTickIndex(Nt.priceToTickIndex(t,e,n),i)}static getInitializableTickIndex(t,e){return t-t%e}static getNextInitializableTickIndex(t,e){return Nt.getInitializableTickIndex(t,e)+e}static getPrevInitializableTickIndex(t,e){return Nt.getInitializableTickIndex(t,e)-e}};function ik(t){const e=[];for(const n of t){const i={objectId:n.objectId,index:Number(Sn(BigInt(n.index)).toString()),sqrtPrice:n.sqrtPrice,liquidityNet:new y(BigInt.asIntN(128,BigInt(BigInt(n.liquidityNet.toString()))).toString()),liquidityGross:n.liquidityGross,feeGrowthOutsideA:n.feeGrowthOutsideA,feeGrowthOutsideB:n.feeGrowthOutsideB,rewardersGrowthOutside:[new y(n.rewardersGrowthOutside[0]),new y(n.rewardersGrowthOutside[1]),new y(n.rewardersGrowthOutside[2])]};e.push(i)}return e}function sk(t){return D(t).add(D(Q6))}new y(365);new y(24);new y(3600);new y(.5);function ok(t,e,n,i){const s=Math.max(t,n),r=Math.min(e,i)-s,a=e-t,c=i-n,u=new it(a.toString()),l=new it(c.toString()),d=new it(r.toString());let f=new it("0");return r<0?f=new it("0"):a===r?f=l.div(d):c===r?f=d.div(u):f=d.mul(d).div(l).div(u),f}var Wi=class{static getDefaultSqrtPriceLimit(t){return new y(t?yu:mu)}static getDefaultOtherAmountThreshold(t){return t?Zt:nr}};function g_(t,e,n,i){if(n.eq(Zt))return t;const s=qe.checkMulShiftLeft(t,e,64,256),o=e.shln(64),r=qe.checkMul(t,n,256);if(!i&&o.lte(r))throw new Mt("getNextSqrtPriceAUp - Unable to divide liquidityShl64 by product","DivideByZero");const a=i?qe.checkDivRoundUpIf(s,o.add(r),!0):qe.checkDivRoundUpIf(s,o.sub(r),!0);if(a.lt(new y(yu)))throw new Mt("getNextSqrtPriceAUp - Next sqrt price less than min sqrt price","CoinAmountMinSubceeded ");if(a.gt(new y(mu)))throw new Mt("getNextSqrtPriceAUp - Next sqrt price greater than max sqrt price","CoinAmountMaxExceeded");return a}function __(t,e,n,i){const s=qe.checkDivRoundUpIf(n.shln(64),e,!i),o=i?t.add(s):t.sub(s);if(o.lt(new y(yu))||o.gt(new y(mu)))throw new Mt("getNextSqrtPriceAUp - Next sqrt price out of bounds","SqrtPriceOutOfBounds");return o}function rk(t,e,n,i){return i?g_(t,e,n,!0):__(t,e,n,!0)}function ak(t,e,n,i){return i?__(t,e,n,!1):g_(t,e,n,!1)}function Dh(t,e,n,i){const s=t.gt(e)?t.sub(e):e.sub(t);if(n.lte(Zt)||s.eq(Zt))return Zt;let o;if(i){const r=new y(n).mul(new y(s)).shln(64),a=e.mul(t),c=r.div(a);o=r.mod(a).eq(Zt)?c:c.add(Vi)}else{const r=new y(n).mul(new y(s));o=r.and(nr).gt(Zt)?r.shrn(64).add(Vi):r.shrn(64)}return o}function Lh(t,e,n,i){const s=t.gt(e)?t.sub(e):e.sub(t);if(n.lte(Zt)||s.eq(Zt))return Zt;let o;if(i)o=n.mul(s).shrn(64);else{const r=n.mul(s).shln(64),a=e.mul(t);o=r.div(a)}return o}function ck(t,e,n,i,s,o){if(n===Zt)return{amountIn:Zt,amountOut:Zt,nextSqrtPrice:e,feeAmount:Zt};const r=t.gte(e);let a,c,u,l;if(o){const d=qe.checkMulDivFloor(i,qe.checkUnsignedSub(Co,s),Co,64),f=Dh(t,e,n,r);f.gt(d)?(a=d,l=qe.checkUnsignedSub(i,d),u=rk(t,n,d,r)):(a=f,l=qe.checkMulDivCeil(a,s,Co.sub(s),64),u=e),c=Lh(t,u,n,r)}else{const d=Lh(t,e,n,r);d.gt(i)?(c=i,u=ak(t,n,i,r)):(c=d,u=e),a=Dh(t,u,n,r),l=qe.checkMulDivCeil(a,s,Co.sub(s),64)}return{amountIn:a,amountOut:c,nextSqrtPrice:u,feeAmount:l}}function uk(t,e,n,i,s){let o=n,r=i.liquidity,{currentSqrtPrice:a}=i;const c={amountIn:Zt,amountOut:Zt,feeAmount:Zt,refAmount:Zt,nextSqrtPrice:Zt,crossTickNum:0};let u,l;const d=Wi.getDefaultSqrtPriceLimit(t);for(const f of s){if(t&&i.currentTickIndex<f.index||!t&&i.currentTickIndex>=f.index||f===null)continue;t&&d.gt(f.sqrtPrice)||!t&&d.lt(f.sqrtPrice)?u=d:u=f.sqrtPrice;const _=ck(a,u,r,o,i.feeRate,e);if(_.amountIn.eq(Zt)||(o=e?o.sub(_.amountIn.add(_.feeAmount)):o.sub(_.amountOut)),c.amountIn=c.amountIn.add(_.amountIn),c.amountOut=c.amountOut.add(_.amountOut),c.feeAmount=c.feeAmount.add(_.feeAmount),_.nextSqrtPrice.eq(f.sqrtPrice)?(l=f.liquidityNet.mul(new y(-1)),t?qe.is_neg(l)?r=r.add(new y(Nn(BigInt(l.toString()),128))):r=r.add(l):qe.is_neg(l)?r=r.sub(new y(Nn(BigInt(l.toString()),128))):r=r.sub(l),a=f.sqrtPrice):a=_.nextSqrtPrice,c.crossTickNum+=1,o.eq(Zt))break}return c.amountIn=c.amountIn.add(c.feeAmount),c.nextSqrtPrice=a,c}function Sr(t,e,n){const i=y.min(t,e),s=y.max(t,e),o=qe.fromX64_BN(n.mul(s).mul(i)),r=s.sub(i);return o.div(r)}function Pr(t,e,n){const i=y.min(t,e),o=y.max(t,e).sub(i);return n.shln(64).div(o)}var dn=class{static updateFeeRate(t,e,n,i,s){const o=qe.checkMulDivCeil(e,new y(i),Co,64),r=n===0?Zt:qe.checkMulDivFloor(e,new y(n),Co,64),a=e.mul(o).mul(r);if(s?t.feeProtocolCoinA=t.feeProtocolCoinA.add(o):t.feeProtocolCoinB=t.feeProtocolCoinB.add(o),a.eq(Zt)||t.liquidity.eq(Zt))return{refFee:r,clmm:t};const c=a.shln(64).div(t.liquidity);return s?t.feeGrowthGlobalA=t.feeGrowthGlobalA.add(c):t.feeGrowthGlobalB=t.feeGrowthGlobalB.add(c),{refFee:r,clmm:t}}static getCoinAmountFromLiquidity(t,e,n,i,s){const o=new Mn(t.toString()),r=new Mn(e.toString()),a=new Mn(n.toString()),c=new Mn(i.toString());let u,l;return e.lt(n)?(u=qe.toX64_Decimal(o).mul(c.sub(a)).div(a.mul(c)),l=new Mn(0)):e.lt(i)?(u=qe.toX64_Decimal(o).mul(c.sub(r)).div(r.mul(c)),l=qe.fromX64_Decimal(o.mul(r.sub(a)))):(u=new Mn(0),l=qe.fromX64_Decimal(o.mul(c.sub(a)))),s?{coinA:new y(u.ceil().toString()),coinB:new y(l.ceil().toString())}:{coinA:new y(u.floor().toString()),coinB:new y(l.floor().toString())}}static estLiquidityAndcoinAmountFromOneAmounts(t,e,n,i,s,o,r){const a=Nt.sqrtPriceX64ToTickIndex(r),c=Nt.tickIndexToSqrtPriceX64(t),u=Nt.tickIndexToSqrtPriceX64(e);let l;if(a<t){if(!i)throw new Mt("lower tick cannot calculate liquidity by coinB","NotSupportedThisCoin");l=Sr(c,u,n)}else if(a>e){if(i)throw new Mt("upper tick cannot calculate liquidity by coinA","NotSupportedThisCoin");l=Pr(u,c,n)}else i?l=Sr(r,u,n):l=Pr(r,c,n);const d=dn.getCoinAmountFromLiquidity(l,r,c,u,s),f=s?D(d.coinA.toString()).mul(1+o).toString():D(d.coinA.toString()).mul(1-o).toString(),_=s?D(d.coinB.toString()).mul(1+o).toString():D(d.coinB.toString()).mul(1-o).toString();return{coinAmountA:d.coinA,coinAmountB:d.coinB,tokenMaxA:s?new y(Mn.ceil(f).toString()):new y(Mn.floor(f).toString()),tokenMaxB:s?new y(Mn.ceil(_).toString()):new y(Mn.floor(_).toString()),liquidityAmount:l,fix_amount_a:i}}static estimateLiquidityFromcoinAmounts(t,e,n,i){if(e>n)throw new Mt("lower tick cannot be greater than lower tick","InvalidTwoTickIndex");const s=Nt.sqrtPriceX64ToTickIndex(t),o=Nt.tickIndexToSqrtPriceX64(e),r=Nt.tickIndexToSqrtPriceX64(n);if(s<e)return Sr(o,r,i.coinA);if(s>=n)return Pr(r,o,i.coinB);const a=Sr(t,r,i.coinA),c=Pr(t,o,i.coinB);return y.min(a,c)}static estCoinAmountsFromTotalAmount(t,e,n,i,s,o){const{ratioA:r,ratioB:a}=dn.calculateDepositRatioFixTokenA(t,e,n),c=D(i).mul(r).div(s),u=D(i).mul(a).div(o);return{amountA:c,amountB:u}}static calculateDepositRatioFixTokenA(t,e,n){const i=new y(1e8),{coinAmountB:s}=dn.estLiquidityAndcoinAmountFromOneAmounts(t,e,i,!0,!0,0,n),o=Nt.sqrtPriceX64ToPrice(n,0,0),r=D(i.toString()).mul(o),a=r.add(s.toString()),c=r.div(a),u=D(s.toString()).div(a);return{ratioA:c,ratioB:u}}};function m_(t){return t.startsWith("0x")?`${t.slice(2)}`:t}var lk=0,y_=1,dk=2;function Nh(t,e){return t===e?lk:t<e?y_:dk}function hk(t,e){let n=0;const i=t.length<=e.length?t.length:e.length,s=Nh(t.length,e.length);for(;n<i;){const o=Nh(t.charCodeAt(n),e.charCodeAt(n));if(n+=1,o!==0)return o}return s}function oc(t,e){return hk(t,e)===y_}function rc(t,...e){const n=Array.isArray(e[e.length-1])?e.pop():[];let s=[t,...e].filter(Boolean).join("::");return n&&n.length&&(s+=`<${n.join(", ")}>`),s}function ht(t){var e;try{let n=t.replace(/\s/g,"");const i=n.match(/(<.+>)$/),s=(e=i==null?void 0:i[0])==null?void 0:e.match(/(\w+::\w+::\w+)(?:<.*?>(?!>))?/g);if(s){n=n.slice(0,n.indexOf("<"));const u={...ht(n),type_arguments:s.map(l=>ht(l).source_address)};return u.type_arguments=u.type_arguments.map(l=>Ze.isSuiCoin(l)?l:ht(l).source_address),u.source_address=rc(u.full_address,u.type_arguments),u}const o=n.split("::"),a={full_address:n,address:n===ac||n===mk?"0x2":Ln(o[0]),module:o[1],name:o[2],type_arguments:[],source_address:""};return a.full_address=`${a.address}::${a.module}::${a.name}`,a.source_address=rc(a.full_address,a.type_arguments),a}catch{return{full_address:t,address:"",module:"",name:"",type_arguments:[],source_address:t}}}function ri(t){return ht(t).source_address}function fk(t){return t.toLowerCase().startsWith("0x")?Ln(t):t}var pk=(t,e=!0)=>{const n=t.split("::"),i=n.shift();let s=Ln(i);return e&&(s=m_(s)),`${s}::${n.join("::")}`};function Td(t){for(const e in t){const n=typeof t[e];if(n==="object")Td(t[e]);else if(n==="string"){const i=t[e];i&&!i.includes("::")&&(t[e]=fk(i))}}}var gk="0x2::coin::Coin",_k=/^0x2::coin::Coin<(.+)>$/,ac="0x2::sui::SUI",mk="0x0000000000000000000000000000000000000000000000000000000000000002::sui::SUI",Ze=class{static getCoinTypeArg(t){const e=t.type.match(_k);return e?e[1]:null}static isSUI(t){const e=Ze.getCoinTypeArg(t);return e?Ze.getCoinSymbol(e)==="SUI":!1}static getCoinSymbol(t){return t.substring(t.lastIndexOf(":")+1)}static getBalance(t){return BigInt(t.fields.balance)}static totalBalance(t,e){let n=BigInt(0);return t.forEach(i=>{e===i.coinAddress&&(n+=BigInt(i.balance))}),n}static getID(t){return t.fields.id.id}static getCoinTypeFromArg(t){return`${gk}<${t}>`}static getFaucetCoins(t){const{events:e}=t,n=[];return e==null||e.forEach(i=>{const{type:s}=i;if(ht(s).name==="InitEvent"){const o=i.parsedJson;n.push({transactionModule:i.transactionModule,suplyID:o.suplyID,decimals:o.decimals})}}),n}static getCoinAssets(t,e){const n=[];return e.forEach(i=>{ri(i.coinAddress)===ri(t)&&n.push(i)}),n}static isSuiCoin(t){return ht(t).full_address===ac}static selectCoinObjectIdGreaterThanOrEqual(t,e,n=[]){const i=Ze.selectCoinAssetGreaterThanOrEqual(t,e,n),s=i.selectedCoins.map(a=>a.coinObjectId),o=i.remainingCoins,r=i.selectedCoins.map(a=>a.balance.toString());return{objectArray:s,remainCoins:o,amountArray:r}}static selectCoinAssetGreaterThanOrEqual(t,e,n=[]){const i=Ze.sortByBalance(t.filter(c=>!n.includes(c.coinObjectId))),s=Ze.calculateTotalBalance(i);if(s<e)return{selectedCoins:[],remainingCoins:i};if(s===e)return{selectedCoins:i,remainingCoins:[]};let o=BigInt(0);const r=[],a=[...i];for(;o<s;){const c=e-o,u=a.findIndex(d=>d.balance>=c);if(u!==-1){r.push(a[u]),a.splice(u,1);break}const l=a.pop();l.balance>0&&(r.push(l),o+=l.balance)}return{selectedCoins:Ze.sortByBalance(r),remainingCoins:Ze.sortByBalance(a)}}static sortByBalance(t){return t.sort((e,n)=>e.balance<n.balance?-1:e.balance>n.balance?1:0)}static sortByBalanceDes(t){return t.sort((e,n)=>e.balance>n.balance?-1:e.balance<n.balance?0:1)}static calculateTotalBalance(t){return t.reduce((e,n)=>e+n.balance,BigInt(0))}};function yk(t,e,n){let i=new y(0),s=new y(0);t.current_tick_index<e.index?(i=qe.subUnderflowU128(new y(t.fee_growth_global_a),new y(e.feeGrowthOutsideA)),s=qe.subUnderflowU128(new y(t.fee_growth_global_b),new y(e.feeGrowthOutsideB))):(i=new y(e.feeGrowthOutsideA),s=new y(e.feeGrowthOutsideB));let o=new y(0),r=new y(0);t.current_tick_index<n.index?(o=new y(n.feeGrowthOutsideA),r=new y(n.feeGrowthOutsideB)):(o=qe.subUnderflowU128(new y(t.fee_growth_global_a),new y(n.feeGrowthOutsideA)),r=qe.subUnderflowU128(new y(t.fee_growth_global_b),new y(n.feeGrowthOutsideB)));const a=qe.subUnderflowU128(qe.subUnderflowU128(new y(t.fee_growth_global_a),i),o),c=qe.subUnderflowU128(qe.subUnderflowU128(new y(t.fee_growth_global_b),s),r);return{fee_growth_inside_a:a,fee_growth_inside_b:c}}function wk(t,e,n){const i=qe.subUnderflowU128(e,new y(t.fee_growth_inside_a)),s=new y(t.liquidity).mul(i).shrn(64),o=qe.subUnderflowU128(n,new y(t.fee_growth_inside_b)),r=new y(t.liquidity).mul(o).shrn(64),a=new y(t.fee_owed_a).add(s),c=new y(t.fee_owed_b).add(r);return{position_id:t.pos_object_id,feeOwedA:a,feeOwedB:c}}function bk(t){const{fee_growth_inside_a:e,fee_growth_inside_b:n}=yk(t.clmmpool,t.tickLower,t.tickUpper);return wk(t.position,e,n)}var Ir=class{constructor(t,e){Ft(this,"numerator");Ft(this,"denominator");this.toString=()=>`${this.numerator.toString()}/${this.denominator.toString()}`,this.numerator=t,this.denominator=e}static fromDecimal(t){return Ir.fromFraction(t.toDecimalPlaces(1).mul(10).toNumber(),1e3)}static fromFraction(t,e){const n=typeof t=="number"?new y(t.toString()):t,i=typeof e=="number"?new y(e.toString()):e;return new Ir(n,i)}};function Tl(t,{numerator:e,denominator:n},i){return i?t.mul(n.add(e)).div(n):t.mul(n).div(n.add(e))}function Ku(t,e,n){return{tokenMaxA:Tl(t.coinA,e,n),tokenMaxB:Tl(t.coinB,e,n)}}function D(t){return it.isDecimal(t)?t:new it(t===void 0?0:t)}function vk(t){return D(10).pow(D(t).abs())}function ua(t){return t.data}function w_(t){if(t.error&&"object_id"in t.error&&"version"in t.error&&"digest"in t.error){const{error:e}=t;return{objectId:e.object_id,version:e.version,digest:e.digest}}}function b_(t){if(t.error&&"object_id"in t.error&&!("version"in t.error)&&!("digest"in t.error))return t.error.object_id}function xk(t){if("reference"in t)return t.reference;const e=ua(t);return e?{objectId:e.objectId,version:e.version,digest:e.digest}:w_(t)}function Ri(t){var e;return"objectId"in t?t.objectId:((e=xk(t))==null?void 0:e.objectId)??b_(t)}function Tk(t){return t.data!==void 0}function Ak(t){return t.content!==void 0}function v_(t){const e="data"in t?ua(t):t;if(!(!e||!Ak(e)||e.content.dataType!=="moveObject"))return e.content}function qi(t){var e;return(e=v_(t))==null?void 0:e.type}function Ys(t){var n;const e=Tk(t)?t.data:t;return!(e!=null&&e.type)&&"data"in t?((n=e==null?void 0:e.content)==null?void 0:n.dataType)==="package"?"package":qi(t):e==null?void 0:e.type}function la(t){var e;return(e=ua(t))==null?void 0:e.previousTransaction}function cc(t){var e;return(e=ua(t))==null?void 0:e.owner}function kk(t){var n;const e=(n=ua(t))==null?void 0:n.display;return e||{data:null,error:null}}function he(t){var n;const e=(n=v_(t))==null?void 0:n.fields;if(e)return"fields"in e?e.fields:e}function Sk(t,e){const n=vk(D(e));return Number(D(t).mul(n))}function Nn(t,e=32){return BigInt.asUintN(e,BigInt(t)).toString()}function Sn(t,e=32){return Number(BigInt.asIntN(e,BigInt(t)))}function Pk(t,e,n){const i=ht(t).name,s=ht(e).name;return`${i}-${s}[${n}]`}function Gu(t){const e=qi(t),n=ht(e),i=he(t);if(i==null)throw new Mt(`Pool id ${Ri(t)} not exists.`,"InvalidPoolObject");const s=[];i.rewarder_manager.fields.rewarders.forEach(r=>{const{emissions_per_second:a}=r.fields,c=qe.fromX64(new y(a)),u=Math.floor(c.toNumber()*60*60*24);s.push({emissions_per_second:a,coinAddress:ht(r.fields.reward_coin.fields.name).source_address,growth_global:r.fields.growth_global,emissionsEveryDay:u})});const o={poolAddress:Ri(t),poolType:e,coinTypeA:n.type_arguments[0],coinTypeB:n.type_arguments[1],coinAmountA:i.coin_a,coinAmountB:i.coin_b,current_sqrt_price:i.current_sqrt_price,current_tick_index:Sn(BigInt(i.current_tick_index.fields.bits)),fee_growth_global_a:i.fee_growth_global_a,fee_growth_global_b:i.fee_growth_global_b,fee_protocol_coin_a:i.fee_protocol_coin_a,fee_protocol_coin_b:i.fee_protocol_coin_b,fee_rate:i.fee_rate,is_pause:i.is_pause,liquidity:i.liquidity,position_manager:{positions_handle:i.position_manager.fields.positions.fields.id.id,size:i.position_manager.fields.positions.fields.size},rewarder_infos:s,rewarder_last_updated_time:i.rewarder_manager.fields.last_updated_time,tickSpacing:i.tick_spacing,ticks_handle:i.tick_manager.fields.ticks.fields.id.id,uri:i.url,index:Number(i.index),name:""};return o.name=Pk(o.coinTypeA,o.coinTypeB,o.tickSpacing),o}function wu(t){const e=kk(t).data,n={creator:"",description:"",image_url:"",link:"",name:"",project_url:""};return e&&(n.creator=e.creator,n.description=e.description,n.image_url=e.image_url,n.link=e.link,n.name=e.name,n.project_url=e.project_url),n}function Gs(t){var r,a;if(t.error!=null||((a=(r=t.data)==null?void 0:r.content)==null?void 0:a.dataType)!=="moveObject")throw new Mt(`Position not exists. Get Position error:${t.error}`,"InvalidPositionObject");let e={creator:"",description:"",image_url:"",link:"",name:"",project_url:""},n={...e,pos_object_id:"",owner:"",type:"",coin_type_a:"",coin_type_b:"",liquidity:"",tick_lower_index:0,tick_upper_index:0,index:0,pool:"",reward_amount_owed_0:"0",reward_amount_owed_1:"0",reward_amount_owed_2:"0",reward_growth_inside_0:"0",reward_growth_inside_1:"0",reward_growth_inside_2:"0",fee_growth_inside_a:"0",fee_owed_a:"0",fee_growth_inside_b:"0",fee_owed_b:"0",position_status:"Exists"},i=he(t);if(i){const c=qi(t),u=cc(t);"nft"in i?(i=i.nft.fields,e.description=i.description,e.name=i.name,e.link=i.url):e=wu(t),n={...e,pos_object_id:i.id.id,owner:u.AddressOwner,type:c,coin_type_a:i.coin_type_a.fields.name,coin_type_b:i.coin_type_b.fields.name,liquidity:i.liquidity,tick_lower_index:Sn(BigInt(i.tick_lower_index.fields.bits)),tick_upper_index:Sn(BigInt(i.tick_upper_index.fields.bits)),index:i.index,pool:i.pool,reward_amount_owed_0:"0",reward_amount_owed_1:"0",reward_amount_owed_2:"0",reward_growth_inside_0:"0",reward_growth_inside_1:"0",reward_growth_inside_2:"0",fee_growth_inside_a:"0",fee_owed_a:"0",fee_growth_inside_b:"0",fee_owed_b:"0",position_status:"Exists"}}const s=w_(t);s&&(n.pos_object_id=s.objectId,n.position_status="Deleted");const o=b_(t);return o&&(n.pos_object_id=o,n.position_status="NotExists"),n}function x_(t){const e={reward_amount_owed_0:"0",reward_amount_owed_1:"0",reward_amount_owed_2:"0",reward_growth_inside_0:"0",reward_growth_inside_1:"0",reward_growth_inside_2:"0"};t="fields"in t?t.fields:t,t.rewards.forEach((o,r)=>{const{amount_owned:a,growth_inside:c}="fields"in o?o.fields:o;r===0?(e.reward_amount_owed_0=a,e.reward_growth_inside_0=c):r===1?(e.reward_amount_owed_1=a,e.reward_growth_inside_1=c):r===2&&(e.reward_amount_owed_2=a,e.reward_growth_inside_2=c)});const n="fields"in t.tick_lower_index?t.tick_lower_index.fields.bits:t.tick_lower_index.bits,i="fields"in t.tick_upper_index?t.tick_upper_index.fields.bits:t.tick_upper_index.bits;return{liquidity:t.liquidity,tick_lower_index:Sn(BigInt(n)),tick_upper_index:Sn(BigInt(i)),...e,fee_growth_inside_a:t.fee_growth_inside_a,fee_owed_a:t.fee_owned_a,fee_growth_inside_b:t.fee_growth_inside_b,fee_owed_b:t.fee_owned_b,pos_object_id:t.position_id}}function Wu(t){var s,o;if(t.error!=null||((o=(s=t.data)==null?void 0:s.content)==null?void 0:o.dataType)!=="moveObject")throw new Mt(`Tick not exists. Get tick data error:${t.error}`,"InvalidTickObject");const n=he(t).value.fields.value.fields;return{objectId:Ri(t),index:Sn(BigInt(n.index.fields.bits)),sqrtPrice:new y(n.sqrt_price),liquidityNet:new y(n.liquidity_net.fields.bits),liquidityGross:new y(n.liquidity_gross),feeGrowthOutsideA:new y(n.fee_growth_outside_a),feeGrowthOutsideB:new y(n.fee_growth_outside_b),rewardersGrowthOutside:n.rewards_growth_outside}}function Bk(t){if(!t||!t.index||!t.sqrt_price||!t.liquidity_net||!t.liquidity_gross||!t.fee_growth_outside_a||!t.fee_growth_outside_b)throw new Mt("Invalid tick fields.","InvalidTickFields");const e=Sn(BigInt(t.index.bits)),n=new y(t.sqrt_price),i=new y(t.liquidity_net.bits),s=new y(t.liquidity_gross),o=new y(t.fee_growth_outside_a),r=new y(t.fee_growth_outside_b),a=t.rewards_growth_outside||[];return{objectId:"",index:e,sqrtPrice:n,liquidityNet:i,liquidityGross:s,feeGrowthOutsideA:o,feeGrowthOutsideB:r,rewardersGrowthOutside:a}}var br=class{static getMinIndex(t){return xl+Math.abs(xl)%t}static getMaxIndex(t){return vl-vl%t}};function M3(t,e){const n=Math.abs(t)%e;return t>0?n>e/2?t+e-n:t-n:n>e/2?t-e+n:t+n}function Ek(t,e,n,i,s,o){const r=t.rewarder_infos,a=[];for(let c=0;c<r.length;c+=1){let u=o[c];e!==null&&(t.current_tick_index<i?u=o[c].sub(new y(e.rewardersGrowthOutside[c])):u=e.rewardersGrowthOutside[c]);let l=new y(0);n!==null&&(t.current_tick_index>=s?l=o[c].sub(new y(n.rewardersGrowthOutside[c])):l=n.rewardersGrowthOutside[c]);const d=qe.subUnderflowU128(qe.subUnderflowU128(new y(o[c]),new y(u)),new y(l));a.push(d)}return a}function uc(t){const e=Ze.isSuiCoin(t.coinTypeA),n=Ze.isSuiCoin(t.coinTypeB);return{isAdjustCoinA:e,isAdjustCoinB:n}}function Ck(t,e){return it.ceil(D(t).div(1+e)).toString()}var ie=class{static createCollectRewarderAndFeeParams(t,e,n,i,s,o){s===void 0&&(s=[...i]),o===void 0&&(o=[...i]);const r=ri(n.coinTypeA),a=ri(n.coinTypeB);if(n.collect_fee){const u=ie.buildCoinForAmount(e,s,BigInt(0),r,!1);s=u.remainCoins;const l=ie.buildCoinForAmount(e,o,BigInt(0),a,!1);o=l.remainCoins,e=t.Position.createCollectFeePaylod({pool_id:n.pool_id,pos_id:n.pos_id,coinTypeA:n.coinTypeA,coinTypeB:n.coinTypeB},e,u.targetCoin,l.targetCoin)}const c=[];return n.rewarder_coin_types.forEach(u=>{switch(ri(u)){case r:c.push(ie.buildCoinForAmount(e,s,BigInt(0),u,!1).targetCoin);break;case a:c.push(ie.buildCoinForAmount(e,o,BigInt(0),u,!1).targetCoin);break;default:c.push(ie.buildCoinForAmount(e,i,BigInt(0),u,!1).targetCoin);break}}),e=t.Rewarder.createCollectRewarderPaylod(n,e,c),e}static async adjustTransactionForGas(t,e,n,i){i.setSender(t.senderAddress);const s=Ze.selectCoinAssetGreaterThanOrEqual(e,n).selectedCoins;if(s.length===0)throw new Mt("Insufficient balance","InsufficientBalance");const o=Ze.calculateTotalBalance(e);if(o-n>1e9)return{fixAmount:n};const r=await t.fullClient.calculationTxGas(i);if(Ze.selectCoinAssetGreaterThanOrEqual(e,BigInt(r),s.map(c=>c.coinObjectId)).selectedCoins.length===0){const c=BigInt(r)+BigInt(500);if(o-n<c){if(n-=c,n<0)throw new Mt("gas Insufficient balance","InsufficientBalance");const u=new vt;return{fixAmount:n,newTx:u}}}return{fixAmount:n}}static async buildAddLiquidityFixTokenForGas(t,e,n,i){let s=await ie.buildAddLiquidityFixToken(t,e,n);const{isAdjustCoinA:o}=uc(n),r=o?n.amount_a:n.amount_b,a=await ie.adjustTransactionForGas(t,Ze.getCoinAssets(o?n.coinTypeA:n.coinTypeB,e),BigInt(r),s),{fixAmount:c}=a,{newTx:u}=a;if(u!==void 0){let l,d;if(o)n.amount_a=Number(c),l=ie.buildAddLiquidityFixTokenCoinInput(u,!n.fix_amount_a,c.toString(),n.slippage,n.coinTypeA,e,!1),d=ie.buildAddLiquidityFixTokenCoinInput(u,n.fix_amount_a,n.amount_b,n.slippage,n.coinTypeB,e,!1);else return n.amount_b=Number(c),l=ie.buildAddLiquidityFixTokenCoinInput(u,!n.fix_amount_a,n.amount_a,n.slippage,n.coinTypeA,e,!1),d=ie.buildAddLiquidityFixTokenCoinInput(u,n.fix_amount_a,c.toString(),n.slippage,n.coinTypeB,e,!1),n=ie.fixAddLiquidityFixTokenParams(n,i.slippage,i.curSqrtPrice),s=await ie.buildAddLiquidityFixTokenArgs(u,t,e,n,l,d),s}return s}static async buildAddLiquidityFixToken(t,e,n){if(t.senderAddress.length===0)throw Error("this config sdk senderAddress is empty");let i=new vt;const s=ie.buildAddLiquidityFixTokenCoinInput(i,!n.fix_amount_a,n.amount_a,n.slippage,n.coinTypeA,e,!1),o=ie.buildAddLiquidityFixTokenCoinInput(i,n.fix_amount_a,n.amount_b,n.slippage,n.coinTypeB,e,!1);return i=ie.buildAddLiquidityFixTokenArgs(i,t,e,n,s,o),i}static buildAddLiquidityFixTokenCoinInput(t,e,n,i,s,o,r=!0){return e?ie.buildCoinForAmountInterval(t,o,{amountSecond:BigInt(Ck(n,i)),amountFirst:BigInt(n)},s,r):ie.buildCoinForAmount(t,o,BigInt(n),s,r)}static fixAddLiquidityFixTokenParams(t,e,n){const i=t.fix_amount_a?t.amount_a:t.amount_b,s=dn.estLiquidityAndcoinAmountFromOneAmounts(Number(t.tick_lower),Number(t.tick_upper),new y(i),t.fix_amount_a,!0,e,n);return t.amount_a=t.fix_amount_a?t.amount_a:s.tokenMaxA.toNumber(),t.amount_b=t.fix_amount_a?s.tokenMaxB.toNumber():t.amount_b,t}static buildAddLiquidityFixTokenArgs(t,e,n,i,s,o){const r=[i.coinTypeA,i.coinTypeB],a=i.is_open?"open_position_with_liquidity_by_fix_coin":"add_liquidity_by_fix_coin",{clmm_pool:c,integrate:u}=e.sdkOptions;i.is_open||(t=ie.createCollectRewarderAndFeeParams(e,t,i,n,s.remainCoins,o.remainCoins));const l=J(c),d=i.is_open?[t.object(l.global_config_id),t.object(i.pool_id),t.pure(Nn(BigInt(i.tick_lower)).toString()),t.pure(Nn(BigInt(i.tick_upper)).toString()),s.targetCoin,o.targetCoin,t.pure(i.amount_a),t.pure(i.amount_b),t.pure(i.fix_amount_a),t.object(Bt)]:[t.object(l.global_config_id),t.object(i.pool_id),t.object(i.pos_id),s.targetCoin,o.targetCoin,t.pure(i.amount_a),t.pure(i.amount_b),t.pure(i.fix_amount_a),t.object(Bt)];return t.moveCall({target:`${u.published_at}::${Ps}::${a}`,typeArguments:r,arguments:d}),t}static async buildSwapTransactionForGas(t,e,n,i){let s=ie.buildSwapTransaction(t,e,n);s.setSender(t.senderAddress);const o=await ie.adjustTransactionForGas(t,Ze.getCoinAssets(e.a2b?e.coinTypeA:e.coinTypeB,n),BigInt(e.by_amount_in?e.amount:e.amount_limit),s),{fixAmount:r,newTx:a}=o;if(a!==void 0){a.setSender(t.senderAddress),e.by_amount_in?e.amount=r.toString():e.amount_limit=r.toString(),e=await ie.fixSwapParams(t,e,i);const c=ie.buildCoinForAmount(s,n,e.a2b?BigInt(e.by_amount_in?e.amount:e.amount_limit):BigInt(0),e.coinTypeA),u=ie.buildCoinForAmount(s,n,e.a2b?BigInt(0):BigInt(e.by_amount_in?e.amount:e.amount_limit),e.coinTypeB);s=ie.buildSwapTransactionArgs(a,e,t.sdkOptions,c,u)}return s}static buildSwapTransaction(t,e,n){let i=new vt;i.setSender(t.senderAddress);const s=ie.buildCoinForAmount(i,n,e.a2b?BigInt(e.by_amount_in?e.amount:e.amount_limit):BigInt(0),e.coinTypeA,!1),o=ie.buildCoinForAmount(i,n,e.a2b?BigInt(0):BigInt(e.by_amount_in?e.amount:e.amount_limit),e.coinTypeB,!1);return i=ie.buildSwapTransactionArgs(i,e,t.sdkOptions,s,o),i}static buildSwapTransactionArgs(t,e,n,i,s){const{clmm_pool:o,integrate:r}=n,a=Wi.getDefaultSqrtPriceLimit(e.a2b),c=[e.coinTypeA,e.coinTypeB],{global_config_id:u}=J(o);if(u===void 0)throw Error("clmm.config.global_config_id is undefined");const l=e.swap_partner!==void 0,d=l?e.a2b?"swap_a2b_with_partner":"swap_b2a_with_partner":e.a2b?"swap_a2b":"swap_b2a",f=l?[t.pure(u),t.pure(e.pool_id),t.pure(e.swap_partner),i.targetCoin,s.targetCoin,t.pure(e.by_amount_in),t.pure(e.amount),t.pure(e.amount_limit),t.pure(a.toString()),t.pure(Bt)]:[t.pure(u),t.pure(e.pool_id),i.targetCoin,s.targetCoin,t.pure(e.by_amount_in),t.pure(e.amount),t.pure(e.amount_limit),t.pure(a.toString()),t.pure(Bt)];return t.moveCall({target:`${r.published_at}::${Ps}::${d}`,typeArguments:c,arguments:f}),t}static async buildSwapTransactionWithoutTransferCoinsForGas(t,e,n,i){let{tx:s,coinABs:o}=ie.buildSwapTransactionWithoutTransferCoins(t,e,n);s.setSender(t.senderAddress);const r=await ie.adjustTransactionForGas(t,Ze.getCoinAssets(e.a2b?e.coinTypeA:e.coinTypeB,n),BigInt(e.by_amount_in?e.amount:e.amount_limit),s),{fixAmount:a,newTx:c}=r;if(c!==void 0){c.setSender(t.senderAddress),e.by_amount_in?e.amount=a.toString():e.amount_limit=a.toString(),e=await ie.fixSwapParams(t,e,i);const u=ie.buildCoinForAmount(s,n,e.a2b?BigInt(e.by_amount_in?e.amount:e.amount_limit):BigInt(0),e.coinTypeA,!1,!0),l=ie.buildCoinForAmount(s,n,e.a2b?BigInt(0):BigInt(e.by_amount_in?e.amount:e.amount_limit),e.coinTypeB,!1,!0),d=ie.buildSwapTransactionWithoutTransferCoinArgs(t,c,e,t.sdkOptions,u,l);s=d.tx,o=d.txRes}return{tx:s,coinABs:o}}static buildSwapTransactionWithoutTransferCoins(t,e,n){const i=new vt;i.setSender(t.senderAddress);const s=ie.buildCoinForAmount(i,n,e.a2b?BigInt(e.by_amount_in?e.amount:e.amount_limit):BigInt(0),e.coinTypeA,!1,!0),o=ie.buildCoinForAmount(i,n,e.a2b?BigInt(0):BigInt(e.by_amount_in?e.amount:e.amount_limit),e.coinTypeB,!1,!0),r=ie.buildSwapTransactionWithoutTransferCoinArgs(t,i,e,t.sdkOptions,s,o);return{tx:r.tx,coinABs:r.txRes}}static buildSwapTransactionWithoutTransferCoinArgs(t,e,n,i,s,o){const{clmm_pool:r,integrate:a}=i,c=Wi.getDefaultSqrtPriceLimit(n.a2b),{global_config_id:u}=J(r);if(u===void 0)throw Error("clmm.config.global_config_id is undefined");const l=n.swap_partner!==void 0,d=l?"swap_with_partner":"swap",f=l?zu:Ns,_=l?[e.pure(u),e.pure(n.pool_id),e.pure(n.swap_partner),s.targetCoin,o.targetCoin,e.pure(n.a2b),e.pure(n.by_amount_in),e.pure(n.amount),e.pure(c.toString()),e.pure(!1),e.pure(Bt)]:[e.pure(u),e.pure(n.pool_id),s.targetCoin,o.targetCoin,e.pure(n.a2b),e.pure(n.by_amount_in),e.pure(n.amount),e.pure(c.toString()),e.pure(!1),e.pure(Bt)],T=[n.coinTypeA,n.coinTypeB],v=e.moveCall({target:`${a.published_at}::${f}::${d}`,typeArguments:T,arguments:_});if(n.by_amount_in){const k=n.a2b?n.coinTypeB:n.coinTypeA,U=n.a2b?v[1]:v[0],R=Number(n.amount_limit);this.checkCoinThreshold(t,n.by_amount_in,e,U,R,k)}return{tx:e,txRes:v}}static async fixSwapParams(t,e,n){const{currentPool:i}=n;try{const s=await t.Swap.preswap({decimalsA:n.decimalsA,decimalsB:n.decimalsB,a2b:e.a2b,byAmountIn:e.by_amount_in,amount:e.amount,pool:i,currentSqrtPrice:i.current_sqrt_price,coinTypeA:i.coinTypeA,coinTypeB:i.coinTypeB}),o=n.byAmountIn?s.estimatedAmountOut:s.estimatedAmountIn,r=Tl(o,n.slippage,!n.byAmountIn);e.amount_limit=r.toString()}catch(s){console.log("fixSwapParams",s)}return e}static async syncBuildCoinInputForAmount(t,e,n,i,s=!0){if(t.senderAddress.length===0)throw Error("this config sdk senderAddress is empty");const o=await t.getOwnerCoinAssets(t.senderAddress,i);return ie.buildCoinForAmount(e,o,n,i,s).targetCoin}static buildCoinForAmount(t,e,n,i,s=!0,o=!1){const r=Ze.getCoinAssets(i,e);if(n===BigInt(0)&&r.length===0)return ie.buildZeroValueCoin(e,t,i,s);const a=Ze.calculateTotalBalance(r);if(a<n)throw new Mt(`The amount(${a}) is Insufficient balance for ${i} , expect ${n} `,"InsufficientBalance");return ie.buildCoin(t,e,r,n,i,s,o)}static buildCoin(t,e,n,i,s,o=!0,r=!1){if(Ze.isSuiCoin(s)){if(o){const R=t.splitCoins(t.gas,[t.pure(i.toString())]);return{targetCoin:t.makeMoveVec({objects:[R]}),remainCoins:e,tragetCoinAmount:i.toString(),isMintZeroCoin:!1,originalSplitedCoin:t.gas}}if(i===0n&&n.length>1){const R=Ze.selectCoinObjectIdGreaterThanOrEqual(n,i);return{targetCoin:t.object(R.objectArray[0]),remainCoins:R.remainCoins,tragetCoinAmount:R.amountArray[0],isMintZeroCoin:!1}}const k=Ze.selectCoinObjectIdGreaterThanOrEqual(n,i);return{targetCoin:t.splitCoins(t.gas,[t.pure(i.toString())]),remainCoins:k.remainCoins,tragetCoinAmount:i.toString(),isMintZeroCoin:!1,originalSplitedCoin:t.gas}}const a=Ze.selectCoinObjectIdGreaterThanOrEqual(n,i),c=a.amountArray.reduce((k,U)=>Number(k)+Number(U),0).toString(),u=a.objectArray;if(o)return{targetCoin:t.makeMoveVec({objects:u.map(k=>t.object(k))}),remainCoins:a.remainCoins,tragetCoinAmount:a.amountArray.reduce((k,U)=>Number(k)+Number(U),0).toString(),isMintZeroCoin:!1};const[l,...d]=u,f=t.object(l);let _=f,T=a.amountArray.reduce((k,U)=>Number(k)+Number(U),0).toString(),v;return d.length>0&&t.mergeCoins(f,d.map(k=>t.object(k))),r&&Number(c)>Number(i)&&(_=t.splitCoins(f,[t.pure(i.toString())]),T=i.toString(),v=f),{targetCoin:_,remainCoins:a.remainCoins,originalSplitedCoin:v,tragetCoinAmount:T,isMintZeroCoin:!1}}static buildZeroValueCoin(t,e,n,i=!0){const s=ie.callMintZeroValueCoin(e,n);let o;return i?o=e.makeMoveVec({objects:[s]}):o=s,{targetCoin:o,remainCoins:t,isMintZeroCoin:!0,tragetCoinAmount:"0"}}static buildCoinForAmountInterval(t,e,n,i,s=!0){const o=Ze.getCoinAssets(i,e);if(n.amountFirst===BigInt(0))return o.length>0?ie.buildCoin(t,[...e],[...o],n.amountFirst,i,s):ie.buildZeroValueCoin(e,t,i,s);const r=Ze.calculateTotalBalance(o);if(r>=n.amountFirst)return ie.buildCoin(t,[...e],[...o],n.amountFirst,i,s);if(r<n.amountSecond)throw new Mt(`The amount(${r}) is Insufficient balance for ${i} , expect ${n.amountSecond} `,"InsufficientBalance");return ie.buildCoin(t,[...e],[...o],n.amountSecond,i,s)}static async buildRouterSwapTransaction(t,e,n,i,s){let o=new vt;return e.paths.length>1&&(e.partner=""),o=await this.buildRouterBasePathTx(t,e,n,i,o,s),o}static async buildRouterBasePathTx(t,e,n,i,s,o){const r=e.paths.filter(A=>A&&A.poolAddress),a=Number(r.reduce((A,P)=>A.add(P.amountIn),Zt).toString()),c=Number(r.reduce((A,P)=>A.add(P.amountOut),Zt).toString()),u=Math.round(n?Number(c.toString())*(1-e.priceSlippagePoint):Number(a.toString())*(1+e.priceSlippagePoint)),l=e.paths[0].coinType[0],d=e.paths[0].coinType[e.paths[0].coinType.length-1],f=ie.buildCoinForAmount(s,i,BigInt(n?a:u),l,!1,!0),_=f.originalSplitedCoin!==void 0,T=ie.buildCoinForAmount(s,i,0n,d,!1),v=await this.buildRouterBasePathReturnCoins(t,e,n,f,T,s),k=[],{toCoin:U,fromCoin:R}=v;if(s=v.tx,T.isMintZeroCoin?k.push({coinType:d,coin:U}):T.originalSplitedCoin!==void 0?s.mergeCoins(T.originalSplitedCoin,[U]):s.mergeCoins(T.targetCoin,[U]),_){const A=f==null?void 0:f.originalSplitedCoin;s.mergeCoins(A,[R])}else k.push({coinType:l,coin:R});for(let A=0;A<k.length;A++)this.buildTransferCoin(t,s,k[A].coin,k[A].coinType,o);return s}static async buildRouterBasePathReturnCoins(t,e,n,i,s,o){const{clmm_pool:r,integrate:a}=t.sdkOptions,c=J(r).global_config_id,u=e.paths.filter(A=>A&&A.poolAddress),l=Number(u.reduce((A,P)=>A.add(P.amountIn),Zt).toString()),d=Number(u.reduce((A,P)=>A.add(P.amountOut),Zt).toString()),f=Math.round(n?Number(d.toString())*(1-e.priceSlippagePoint):Number(l.toString())*(1+e.priceSlippagePoint)),_=e.paths[0].coinType[0],T=e.paths[0].coinType[e.paths[0].coinType.length-1];let v=i.targetCoin,k;s.isMintZeroCoin||s.originalSplitedCoin!==void 0?k=s.targetCoin:k=ie.callMintZeroValueCoin(o,T);const U=e.partner==="",R=U?Ns:zu;for(const A of u)if(A.poolAddress.length===1){const P=A.a2b[0],M={amount:Number(A.amountIn.toString()),amountLimit:f,poolCoinA:A.a2b[0]?_:T,poolCoinB:A.a2b[0]?T:_},K=U?"swap":"swap_with_partner",Y=P?v:k,X=P?k:v,et=n?A.amountIn.toString():A.amountOut.toString(),z=Wi.getDefaultSqrtPriceLimit(P).toString(),O=U?[o.object(c),o.object(A.poolAddress[0]),Y,X,o.pure(P),o.pure(n),o.pure(et),o.pure(z),o.pure(!1),o.object(Bt)]:[o.object(c),o.object(A.poolAddress[0]),o.pure(e.partner),Y,X,o.pure(P),o.pure(n),o.pure(et),o.pure(z),o.pure(!1),o.object(Bt)],$=[M.poolCoinA,M.poolCoinB],b=o.moveCall({target:`${t.sdkOptions.integrate.published_at}::${R}::${K}`,typeArguments:$,arguments:O});v=P?b[0]:b[1],k=P?b[1]:b[0]}else{const P=n?A.amountIn:A.rawAmountLimit[0],M=n?0:A.amountOut;let K="";A.a2b[0]?A.a2b[1]?K="swap_ab_bc":K="swap_ab_cb":A.a2b[1]?K="swap_ba_bc":K="swap_ba_cb",U||(K=`${K}_with_partner`);const Y=Wi.getDefaultSqrtPriceLimit(A.a2b[0]),X=Wi.getDefaultSqrtPriceLimit(A.a2b[1]),et=U?[o.object(c),o.object(A.poolAddress[0]),o.object(A.poolAddress[1]),v,k,o.pure(n),o.pure(P.toString()),o.pure(M.toString()),o.pure(Y.toString()),o.pure(X.toString()),o.object(Bt)]:[o.object(c),o.object(A.poolAddress[0]),o.object(A.poolAddress[1]),o.pure(e.partner),v,k,o.pure(n),o.pure(P.toString()),o.pure(M.toString()),o.pure(Y.toString()),o.pure(X.toString()),o.object(Bt)],z=[A.coinType[0],A.coinType[1],A.coinType[2]],O=o.moveCall({target:`${a.published_at}::${R}::${K}`,typeArguments:z,arguments:et});v=O[0],k=O[1]}return this.checkCoinThreshold(t,n,o,k,f,T),{fromCoin:v,toCoin:k,tx:o}}static async buildAggregatorSwapReturnCoins(t,e,n,i,s,o,r,a){if(a==null){if(t.senderAddress.length===0)throw Error("recipient and this config sdk senderAddress all not set");a=t.senderAddress}e.splitPaths.length>1&&(s="");let c,u;const l=e.splitPaths.some(d=>d.basePaths.some(f=>f.label==="Deepbook"));if((!e.byAmountIn||e.splitPaths.length===1)&&!l){const d=[];for(const T of e.splitPaths){const v=[],k=[],U=[],R=[];for(let P=0;P<T.basePaths.length;P+=1){const M=T.basePaths[P];v.push(M.direction),k.push(M.poolAddress),U.push(new y(M.inputAmount.toString())),P===0?R.push(M.fromCoin,M.toCoin):R.push(M.toCoin)}const A={amountIn:new y(T.inputAmount.toString()),amountOut:new y(T.outputAmount.toString()),poolAddress:k,a2b:v,rawAmountLimit:U,isExceed:!1,coinType:R};d.push(A)}const f={paths:d,partner:s,priceSlippagePoint:o},_=await this.buildRouterBasePathReturnCoins(t,f,e.byAmountIn,n,i,r);c=_.fromCoin,u=_.toCoin,r=_.tx}else{const d=Math.round(e.outputAmount*(1-o));c=n.targetCoin,i.isMintZeroCoin||i.originalSplitedCoin!==void 0?u=i.targetCoin:u=ie.callMintZeroValueCoin(r,e.toCoin);let f=!1,_;if(l){const[T,v]=Fh.createAccountCap(a,t.sdkOptions,r);r=v,_=T,f=!0}for(let T=0;T<e.splitPaths.length;T+=1){const v=e.splitPaths[T];let k;for(let U=0;U<v.basePaths.length;U+=1){const R=v.basePaths[U];if(R.label==="Deepbook")if(U===0)if(v.basePaths.length===1){const A=this.buildDeepbookBasePathTx(t,R,r,_,c,u,!1);c=A.from,u=A.to}else{k=ie.callMintZeroValueCoin(r,R.toCoin);const A=this.buildDeepbookBasePathTx(t,R,r,_,c,k,!1);c=A.from,k=A.to}else{const A=this.buildDeepbookBasePathTx(t,R,r,_,k,u,!0);k=A.from,u=A.to}if(R.label==="Cetus")if(U===0)if(v.basePaths.length===1){const A=this.buildClmmBasePathTx(t,R,r,e.byAmountIn,c,u,!1,s);c=A.from,u=A.to}else{k=ie.callMintZeroValueCoin(r,R.toCoin);const A=this.buildClmmBasePathTx(t,R,r,e.byAmountIn,c,k,!1,s);c=A.from,k=A.to}else{const A=this.buildClmmBasePathTx(t,R,r,e.byAmountIn,k,u,!0,s);k=A.from,u=A.to,r.moveCall({target:`${t.sdkOptions.integrate.published_at}::${Mh}::send_coin`,typeArguments:[R.fromCoin],arguments:[k,r.pure(a)]})}}}this.checkCoinThreshold(t,e.byAmountIn,r,u,d,e.toCoin),f&&(r=Fh.deleteAccountCapByObject(_,t.sdkOptions,r))}return{fromCoin:c,toCoin:u,tx:r}}static async buildAggregatorSwapTransaction(t,e,n,i,s,o){let r=new vt;const a=e.byAmountIn?Math.round(e.outputAmount*(1-s)):Math.round(e.inputAmount*(1+s)),c=ie.buildCoinForAmount(r,n,e.byAmountIn?BigInt(e.inputAmount):BigInt(a),e.fromCoin,!1,!0),u=c.originalSplitedCoin!=null,l=ie.buildCoinForAmount(r,n,0n,e.toCoin,!1),d=await this.buildAggregatorSwapReturnCoins(t,e,c,l,i,s,r,o),{fromCoin:f,toCoin:_}=d;r=d.tx;const T=[];if(l.isMintZeroCoin?T.push({coinType:e.toCoin,coin:_}):l.originalSplitedCoin!=null?r.mergeCoins(l.originalSplitedCoin,[_]):r.mergeCoins(l.targetCoin,[_]),u){const v=c.originalSplitedCoin;r.mergeCoins(v,[f])}else T.push({coinType:e.fromCoin,coin:f});for(let v=0;v<T.length;v++)this.buildTransferCoin(t,r,T[v].coin,T[v].coinType,o);return r}static checkCoinThreshold(t,e,n,i,s,o){e&&n.moveCall({target:`${t.sdkOptions.integrate.published_at}::${Ns}::check_coin_threshold`,typeArguments:[o],arguments:[i,n.pure(s)]})}static buildDeepbookBasePathTx(t,e,n,i,s,o,r){const a=e.direction?s:o,c=e.direction?o:s,u=[n.object(e.poolAddress),i,n.pure(e.inputAmount),n.pure(0),n.pure(e.direction),a,c,n.pure(r),n.object(Bt)],l=e.direction?[e.fromCoin,e.toCoin]:[e.toCoin,e.fromCoin],d=n.moveCall({target:`${t.sdkOptions.deepbook_endpoint_v2.published_at}::endpoints_v2::swap`,typeArguments:l,arguments:u});return s=e.direction?d[0]:d[1],o=e.direction?d[1]:d[0],{from:s,to:o,tx:n}}static buildClmmBasePathTx(t,e,n,i,s,o,r,a){const{clmm_pool:c,integrate:u}=t.sdkOptions,l=J(c).global_config_id;let d=e.direction?s:o,f=e.direction?o:s;const _=a==="",T=_?Ns:zu,v=_?"swap":"swap_with_partner",k=i?e.inputAmount.toString():e.outputAmount.toString(),U=Wi.getDefaultSqrtPriceLimit(e.direction),R=_?[n.object(l),n.object(e.poolAddress),d,f,n.pure(e.direction),n.pure(i),n.pure(k),n.pure(U.toString()),n.pure(r),n.object(Bt)]:[n.object(l),n.object(e.poolAddress),n.pure(a),d,f,n.pure(e.direction),n.pure(i),n.pure(k),n.pure(U.toString()),n.pure(r),n.object(Bt)],A=e.direction?[e.fromCoin,e.toCoin]:[e.toCoin,e.fromCoin],P=n.moveCall({target:`${u.published_at}::${T}::${v}`,typeArguments:A,arguments:R});return d=P[0],f=P[1],s=e.direction?d:f,o=e.direction?f:d,{from:s,to:o,tx:n}}static buildCoinTypePair(t,e){const n=[];if(t.length===2){const i=[];i.push(t[0],t[1]),n.push(i)}else{const i=[];i.push(t[0],t[t.length-1]),n.push(i);for(let s=1;s<t.length-1;s+=1){if(e[s-1]===0)continue;const o=[];o.push(t[0],t[s],t[t.length-1]),n.push(o)}}return n}static buildTransferCoinToSender(t,e,n,i){e.moveCall({target:`${t.sdkOptions.integrate.published_at}::${Mh}::transfer_coin_to_sender`,typeArguments:[i],arguments:[n]})}static buildTransferCoin(t,e,n,i,s){s!=null?e.transferObjects([n],e.pure(s)):ie.buildTransferCoinToSender(t,e,n,i)}},ye=ie;j6(ye,"callMintZeroValueCoin",(t,e)=>t.moveCall({target:"0x2::coin::zero",typeArguments:[e]}));function Vn(t){return!(!t.startsWith("0x")||t.length!==66)}var yo=new y(1e9),Fh=class{static createAccountCap(t,e,n,i=!1){if(t.length===0)throw Error("this config sdk senderAddress is empty");const{deepbook:s}=e,[o]=n.moveCall({target:`${s.published_at}::${W6}::create_account`,typeArguments:[],arguments:[]});return i&&n.transferObjects([o],n.pure(t)),[o,n]}static deleteAccountCap(t,e,n){const{deepbook:i}=e,s=[n.pure(t)];return n.moveCall({target:`${i.published_at}::${Hu}::delete_account_cap`,typeArguments:[],arguments:s}),n}static deleteAccountCapByObject(t,e,n){const{deepbook:i}=e,s=[t];return n.moveCall({target:`${i.published_at}::${Hu}::delete_account_cap`,typeArguments:[],arguments:s}),n}static async getAccountCap(t){const e=await t.fullClient.getOwnedObjectsByPage(t.senderAddress,{options:{showType:!0,showContent:!0,showDisplay:!0,showOwner:!0},filter:{MoveModule:{package:t.sdkOptions.deepbook.package_id,module:Hu}}});return e.data.length===0?"":e.data[0].data.objectId}static async getPools(t){const e=t.sdkOptions.deepbook.package_id,n=[];try{(await t.fullClient.queryEventsByPage({MoveEventType:`${e}::clob_v2::PoolCreated`})).data.forEach(s=>{const o=s.parsedJson;o&&n.push({poolID:o.pool_id,tickSize:Number(o.tick_size),lotSize:Number(o.lot_size),takerFeeRate:Number(o.taker_fee_rate),makerRebateRate:Number(o.maker_rebate_rate),baseAsset:o.base_asset.name,quoteAsset:o.quote_asset.name})})}catch(i){console.log("getPoolImmutables",i)}return n}static async getPoolAsks(t,e,n,i){var f;const{simulationAccount:s}=t.sdkOptions,{deepbook_endpoint_v2:o}=t.sdkOptions,r=new vt,a=[],c=[n,i],u=[r.pure(e),r.pure("0"),r.pure("999999999999"),r.pure(Bt)];r.moveCall({target:`${o.published_at}::endpoints_v2::get_level2_book_status_ask_side`,arguments:u,typeArguments:c});const d=(f=(await t.fullClient.devInspectTransactionBlock({transactionBlock:r,sender:s.address})).events)==null?void 0:f.filter(_=>ht(_.type).name==="BookStatus");if(d.length===0)return a;for(let _=0;_<d[0].parsedJson.depths.length;_++){const T=d[0].parsedJson.price[_],v=d[0].parsedJson.depths[_],k={price:parseInt(T,10),quantity:parseInt(v,10)};a.push(k)}return a}static async getPoolBids(t,e,n,i){var f;const{simulationAccount:s}=t.sdkOptions,{deepbook_endpoint_v2:o}=t.sdkOptions,r=new vt,a=[],c=[n,i],u=[r.pure(e),r.pure("0"),r.pure("999999999999"),r.pure(Bt)];r.moveCall({target:`${o.published_at}::endpoints_v2::get_level2_book_status_bid_side`,arguments:u,typeArguments:c});const d=(f=(await t.fullClient.devInspectTransactionBlock({transactionBlock:r,sender:s.address})).events)==null?void 0:f.filter(_=>ht(_.type).name==="BookStatus");if(d.length===0)return a;for(let _=0;_<d[0].parsedJson.depths.length;_++){const T=d[0].parsedJson.price[_],v=d[0].parsedJson.depths[_],k={price:parseInt(T,10),quantity:parseInt(v,10)};a.push(k)}return a}static async preSwap(t,e,n,i){let s=!1,o=Zt,r=new y(i),a=Zt;const c=new y(i);if(n){let u=await this.getPoolBids(t,e.poolID,e.baseAsset,e.quoteAsset);u===null&&(s=!0),u=u.sort((l,d)=>d.price-l.price);for(let l=0;l<u.length;l+=1){const d=new y(u[l].quantity),f=new y(u[l].price),_=d.mul(new y(f)).mul(new y(e.takerFeeRate)).div(yo).div(yo);if(r.gt(d))r=r.sub(d),o=o.add(d.mul(f).div(yo).sub(_)),a=a.add(_);else{const T=r.mul(new y(u[l].price)).div(yo),v=T.mul(new y(e.takerFeeRate)).div(yo);o=o.add(T.sub(v)),r=r.sub(r),a=a.add(v)}if(r.eq(Zt))break}}else{const u=await this.getPoolAsks(t,e.poolID,e.baseAsset,e.quoteAsset);u===null&&(s=!0);for(let l=0;l<u.length;l+=1){const d=new y(u[l].price).mul(new y(u[l].quantity)).div(new y(1e9)),f=d.mul(new y(e.takerFeeRate)).div(yo),_=d.add(f);if(r.gt(d))o=o.add(new y(u[l].quantity)),r=r.sub(_),a=a.add(f);else{const T=new y(u[l].quantity).div(new y(e.lotSize)),v=_.div(T),k=r.div(v);o=o.add(k.muln(e.lotSize)),r=r.sub(k.mul(v)),a=a.add(k.div(T).mul(f))}if(r.eq(Zt))break}}return{poolAddress:e.poolID,estimatedAmountIn:c.sub(r).toNumber(),estimatedAmountOut:o.toNumber(),estimatedFeeAmount:a,isExceed:s,amount:Number(i),aToB:n,byAmountIn:!0}}static async simulateSwap(t,e,n,i,s,o){var M;const{deepbook_endpoint_v2:r}=t.sdkOptions;let a=new vt;const c=await this.getAccountCap(t);let u;if(c===""){const K=this.createAccountCap(t.senderAddress,t.sdkOptions,a),Y=K[0];a=K[1],u=Y}else u=a.pure(c);const l=await t.getOwnerCoinAssets(t.senderAddress),d=ye.buildCoinForAmount(a,l,BigInt(o),n,!1),f=d==null?void 0:d.targetCoin,_=ye.buildCoinForAmount(a,l,BigInt(o),i,!1),T=_==null?void 0:_.targetCoin,v=[n,i],k=[a.pure(e),u,a.pure(o),a.pure(0),a.pure(s),f,T,a.pure(Bt)];a.moveCall({target:`${r.published_at}::${X6}::swap`,arguments:k,typeArguments:v});const{simulationAccount:U}=t.sdkOptions,A=(M=(await t.fullClient.devInspectTransactionBlock({transactionBlock:a,sender:U.address})).events)==null?void 0:M.filter(K=>ht(K.type).name==="DeepbookSwapEvent");if(A.length===0)return null;const P=A[0].parsedJson;return{poolAddress:P.pool,estimatedAmountIn:P.amount_in,estimatedAmountOut:P.amount_out,aToB:P.atob}}},Ik=class{constructor(t){Ft(this,"_sdk");Ft(this,"_cache",{});this._sdk=t}get sdk(){return this._sdk}async getPositionList(t,e="all"){const n={data:[],hasNextPage:!0},i=await this._sdk.fullClient.getDynamicFieldsByPage(t,e);n.hasNextPage=i.hasNextPage,n.nextCursor=i.nextCursor;const s=i.data.map(r=>{var a,c;if(r.error!=null||((c=(a=r.data)==null?void 0:a.content)==null?void 0:c.dataType)!=="moveObject")throw new Mt(`when getPositionList get position objects error: ${r.error}, please check the rpc, contracts address config and position id.`,"InvalidConfig");return r.name.value}),o=await this._sdk.Position.getSipmlePositionList(s);return n.data=o,n}async getPoolImmutables(t=[],e=0,n=100,i=!1){const{package_id:s}=this._sdk.sdkOptions.clmm_pool,o=`${s}_getInitPoolEvent`,r=this.getCache(o,i),a=[],c=[];if(r!==void 0&&a.push(...r),a.length===0)try{(await this._sdk.fullClient.queryEventsByPage({MoveEventType:`${s}::factory::CreatePoolEvent`})).data.forEach(d=>{const f=d.parsedJson;f&&a.push({poolAddress:f.pool_id,tickSpacing:f.tick_spacing,coinTypeA:ht(f.coin_type_a).full_address,coinTypeB:ht(f.coin_type_b).full_address})}),this.updateCache(o,a,Kt)}catch(l){console.log("getPoolImmutables",l)}const u=t.length>0;for(let l=0;l<a.length;l+=1){const d=a[l];u&&!t.includes(d.poolAddress)||!u&&(l<e||l>=e+n)||c.push(d)}return c}async getPools(t=[],e=0,n=100){var r,a,c;const i=[];let s=[];t.length>0?s=[...t]:(await this.getPoolImmutables([],e,n,!1)).forEach(l=>s.push(l.poolAddress));const o=await this._sdk.fullClient.batchGetObjects(s,{showContent:!0,showType:!0});for(const u of o){if(u.error!=null||((a=(r=u.data)==null?void 0:r.content)==null?void 0:a.dataType)!=="moveObject")throw new Mt(`getPools error code: ${((c=u.error)==null?void 0:c.code)??"unknown error"}, please check config and object ids`,"InvalidPoolObject");const l=Gu(u);i.push(l);const d=`${l.poolAddress}_getPoolObject`;this.updateCache(d,l,Kt)}return i}async getPoolImmutablesWithPage(t="all",e=!1){const{package_id:n}=this._sdk.sdkOptions.clmm_pool,i=[],s={data:[],hasNextPage:!1},o=t==="all",r=`${n}_getPoolImmutables`;if(o){const a=this.getCache(r,e);a&&i.push(...a)}if(i.length===0)try{const a=`${n}::factory::CreatePoolEvent`,c=await this._sdk.fullClient.queryEventsByPage({MoveEventType:a},t);s.hasNextPage=c.hasNextPage,s.nextCursor=c.nextCursor,c.data.forEach(u=>{const l=u.parsedJson;if(l){const d={poolAddress:l.pool_id,tickSpacing:l.tick_spacing,coinTypeA:ht(l.coin_type_a).full_address,coinTypeB:ht(l.coin_type_b).full_address};i.push(d)}})}catch(a){console.log("getPoolImmutables",a)}return s.data=i,o&&this.updateCache(`${n}_getPoolImmutables`,i,Kt),s}async getPoolsWithPage(t=[]){var s,o,r;const e=[];let n=[];t.length>0?n=[...t]:(await this.getPoolImmutablesWithPage()).data.forEach(c=>n.push(c.poolAddress));const i=await this._sdk.fullClient.batchGetObjects(n,{showContent:!0,showType:!0});for(const a of i){if(a.error!=null||((o=(s=a.data)==null?void 0:s.content)==null?void 0:o.dataType)!=="moveObject")throw new Mt(`getPoolWithPages error code: ${((r=a.error)==null?void 0:r.code)??"unknown error"}, please check config and object ids`,"InvalidPoolObject");const c=Gu(a);e.push(c);const u=`${c.poolAddress}_getPoolObject`;this.updateCache(u,c,Kt)}return e}async getPool(t,e=!0){var r,a,c;const n=`${t}_getPoolObject`,i=this.getCache(n,e);if(i!==void 0)return i;const s=await this._sdk.fullClient.getObject({id:t,options:{showType:!0,showContent:!0}});if(s.error!=null||((a=(r=s.data)==null?void 0:r.content)==null?void 0:a.dataType)!=="moveObject")throw new Mt(`getPool error code: ${((c=s.error)==null?void 0:c.code)??"unknown error"}, please check config and object id`,"InvalidPoolObject");const o=Gu(s);return this.updateCache(n,o),o}async creatPoolsTransactionPayload(t){for(const n of t)if(oc(Jn(n.coinTypeA),Jn(n.coinTypeB))){const i=n.coinTypeB;n.coinTypeB=n.coinTypeA,n.coinTypeA=i}return await this.creatPool(t)}async creatPoolTransactionPayload(t){if(oc(Jn(t.coinTypeA),Jn(t.coinTypeB))){const e=t.coinTypeB;t.coinTypeB=t.coinTypeA,t.coinTypeA=e}return"fix_amount_a"in t?await this.creatPoolAndAddLiquidity(t):await this.creatPool([t])}async getClmmConfigs(t=!1){const{package_id:e}=this._sdk.sdkOptions.clmm_pool,n=`${e}_getInitEvent`,i=this.getCache(n,t);if(i!==void 0)return i;const s=await this._sdk.fullClient.getObject({id:e,options:{showPreviousTransaction:!0}}),o=la(s),r=(await this._sdk.fullClient.queryEventsByPage({Transaction:o})).data,a={pools_id:"",global_config_id:"",global_vault_id:"",admin_cap_id:""};return r.length>0&&(r.forEach(c=>{const u=c.parsedJson;if(c.type)switch(ht(c.type).full_address){case`${e}::config::InitConfigEvent`:a.global_config_id=u.global_config_id,a.admin_cap_id=u.admin_cap_id;break;case`${e}::factory::InitFactoryEvent`:a.pools_id=u.pools_id;break;case`${e}::rewarder::RewarderInitEvent`:a.global_vault_id=u.global_vault_id;break;case`${e}::partner::InitPartnerEvent`:a.partners_id=u.partners_id;break}}),this.updateCache(n,a,Kt)),a}async getSuiTransactionResponse(t,e=!1){const n=`${t}_getSuiTransactionResponse`,i=this.getCache(n,e);if(i!==void 0)return i;let s;try{s=await this._sdk.fullClient.getTransactionBlock({digest:t,options:{showEvents:!0,showEffects:!0,showBalanceChanges:!0,showInput:!0,showObjectChanges:!0}})}catch{s=await this._sdk.fullClient.getTransactionBlock({digest:t,options:{showEvents:!0,showEffects:!0}})}return this.updateCache(n,s,Kt),s}async creatPool(t){const e=new vt,{integrate:n,clmm_pool:i}=this.sdk.sdkOptions,s=J(i),o=s.global_config_id,r=s.pools_id;return t.forEach(a=>{const c=[e.object(o),e.object(r),e.pure(a.tick_spacing.toString()),e.pure(a.initialize_sqrt_price),e.pure(a.uri),e.object(Bt)];e.moveCall({target:`${n.published_at}::${Cr}::create_pool`,typeArguments:[a.coinTypeA,a.coinTypeB],arguments:c})}),e}async creatPoolAndAddLiquidity(t){if(!Vn(this._sdk.senderAddress))throw new Mt("this config sdk senderAddress is not set right","InvalidSendAddress");const e=new vt,{integrate:n,clmm_pool:i}=this.sdk.sdkOptions,s=J(i),o=s.global_config_id,r=s.pools_id,a=await this._sdk.getOwnerCoinAssets(this._sdk.senderAddress),c=ye.buildAddLiquidityFixTokenCoinInput(e,!t.fix_amount_a,t.amount_a,t.slippage,t.coinTypeA,a,!1),u=ye.buildAddLiquidityFixTokenCoinInput(e,t.fix_amount_a,t.amount_b,t.slippage,t.coinTypeB,a,!1),l=[e.pure(o),e.pure(r),e.pure(t.tick_spacing.toString()),e.pure(t.initialize_sqrt_price),e.pure(t.uri),c.targetCoin,u.targetCoin,e.pure(Nn(BigInt(t.tick_lower)).toString()),e.pure(Nn(BigInt(t.tick_upper)).toString()),e.pure(t.amount_a),e.pure(t.amount_b),e.pure(t.fix_amount_a),e.pure(Bt)];return e.moveCall({target:`${n.published_at}::${Ps}::create_pool_with_liquidity`,typeArguments:[t.coinTypeA,t.coinTypeB],arguments:l}),e}async fetchTicks(t){let e=[],n=[];for(;;){const s=await this.getTicks({pool_id:t.pool_id,coinTypeA:t.coinTypeA,coinTypeB:t.coinTypeB,start:n,limit:512});if(e=[...e,...s],s.length<512)break;n=[s[s.length-1].index]}return e}async getTicks(t){var c;const{integrate:e,simulationAccount:n}=this.sdk.sdkOptions,i=[],s=[t.coinTypeA,t.coinTypeB],o=new vt,r=[o.pure(t.pool_id),o.pure(t.start),o.pure(t.limit.toString())];if(o.moveCall({target:`${e.published_at}::${Pi}::fetch_ticks`,arguments:r,typeArguments:s}),!Vn(n.address))throw new Mt("this config simulationAccount is not set right","InvalidSimulateAccount");const a=await this.sdk.fullClient.devInspectTransactionBlock({transactionBlock:o,sender:n.address});if(a.error!=null)throw new Mt(`getTicks error code: ${a.error??"unknown error"}, please check config and tick object ids`,"InvalidTickObjectId");return(c=a.events)==null||c.forEach(u=>{ht(u.type).name==="FetchTicksResultEvent"&&u.parsedJson.ticks.forEach(l=>{i.push(Bk(l))})}),i}async fetchPositionRewardList(t){var r;const{integrate:e,simulationAccount:n}=this.sdk.sdkOptions,i=[];let s=[];const o=512;for(;;){const a=[t.coinTypeA,t.coinTypeB],c=new vt,u=[c.object(t.pool_id),c.pure(s,"u64"),c.pure(o.toString(),"u64")];if(c.moveCall({target:`${e.published_at}::${Pi}::fetch_positions`,arguments:u,typeArguments:a}),!Vn(n.address))throw new Mt("this config simulationAccount is not set right","InvalidSimulateAccount");const l=await this.sdk.fullClient.devInspectTransactionBlock({transactionBlock:c,sender:n.address});if(l.error!=null)throw new Mt(`fetch position reward error code: ${l.error??"unknown error"}, please check config and tick object ids`,"InvalidPositionRewardObject");const d=[];if((r=l==null?void 0:l.events)==null||r.forEach(f=>{ht(f.type).name==="FetchPositionsEvent"&&f.parsedJson.positions.forEach(_=>{const T=x_(_);d.push(T)})}),i.push(...d),d.length<o)break;s=[d[d.length-1].pos_object_id]}return i}async fetchTicksByRpc(t){let e=[],n=null;const i=512;for(;;){const s=[],o=await this.sdk.fullClient.getDynamicFields({parentId:t,cursor:n,limit:i});if(n=o.nextCursor,o.data.forEach(r=>{ht(r.objectType).module==="skip_list"&&s.push(r.objectId)}),e=[...e,...await this.getTicksByRpc(s)],n===null||o.data.length<i)break}return e}async getTicksByRpc(t){var i,s,o;const e=[],n=await this.sdk.fullClient.batchGetObjects(t,{showContent:!0,showType:!0});for(const r of n){if(r.error!=null||((s=(i=r.data)==null?void 0:i.content)==null?void 0:s.dataType)!=="moveObject")throw new Mt(`getTicksByRpc error code: ${((o=r.error)==null?void 0:o.code)??"unknown error"}, please check config and tick object ids`,"InvalidTickObjectId");const a=Wu(r);a!=null&&e.push(a)}return e}async getTickDataByIndex(t,e){var s,o;const n={type:"u64",value:Nn(BigInt(sk(e).toString())).toString()},i=await this.sdk.fullClient.getDynamicFieldObject({parentId:t,name:n});if(i.error!=null||((o=(s=i.data)==null?void 0:s.content)==null?void 0:o.dataType)!=="moveObject")throw new Mt(`get tick by index: ${e} error: ${i.error}`,"InvalidTickIndex");return Wu(i)}async getTickDataByObjectId(t){var n,i,s;const e=await this.sdk.fullClient.getObject({id:t,options:{showContent:!0}});if(e.error!=null||((i=(n=e.data)==null?void 0:n.content)==null?void 0:i.dataType)!=="moveObject")throw new Mt(`getTicksByRpc error code: ${((s=e.error)==null?void 0:s.code)??"unknown error"}, please check config and tick object ids`,"InvalidTickObjectId");return Wu(e)}async getPartnerRefFeeAmount(t){var a,c;const e=await this._sdk.fullClient.batchGetObjects([t],{showOwner:!0,showContent:!0,showDisplay:!0,showType:!0});if(e[0].error!=null||((c=(a=e[0].data)==null?void 0:a.content)==null?void 0:c.dataType)!=="moveObject")throw new Mt(`get partner by object id: ${t} error: ${e[0].error}`,"NotFoundPartnerObject");const n=e[0].data.content.fields.balances,i=await this._sdk.fullClient.getDynamicFieldsByPage(n.fields.id.id),s=[];i.data.forEach(u=>{var l,d;if(u.error!=null||((d=(l=u.data)==null?void 0:l.content)==null?void 0:d.dataType)!=="moveObject")throw new Mt(`when getPartnerRefFeeAmount get partner object error: ${u.error}, please check the rpc, contracts address config and position id.`,"InvalidConfig");s.push(u.objectId)});const o=[];return(await this._sdk.fullClient.batchGetObjects(s,{showOwner:!0,showContent:!0,showDisplay:!0,showType:!0})).forEach(u=>{var d,f;if(u.error!=null||((f=(d=u.data)==null?void 0:d.content)==null?void 0:f.dataType)!=="moveObject")throw new Mt(`get coin by object id: ${u.data.objectId} error: ${u.error}`,"InvalidParnterRefFeeFields");const l={coinAddress:u.data.content.fields.name,coinObjectId:u.data.objectId,balance:BigInt(u.data.content.fields.value)};o.push(l)}),o}async claimPartnerRefFeePayload(t,e,n){const i=new vt,{clmm_pool:s}=this.sdk.sdkOptions,{global_config_id:o}=J(s),r=[n],a=[i.object(o),i.object(t),i.object(e)];return i.moveCall({target:`${s.published_at}::${K6}::claim_ref_fee`,arguments:a,typeArguments:r}),i}updateCache(t,e,n=gi){let i=this._cache[t];i?(i.overdueTime=on(n),i.value=e):i=new Yn(e,on(n)),this._cache[t]=i}getCache(t,e=!1){const n=this._cache[t],i=n==null?void 0:n.isValid();if(!e&&i)return n.value;i||delete this._cache[t]}},Ok=class{constructor(t){Ft(this,"_sdk");Ft(this,"_cache",{});this._sdk=t}get sdk(){return this._sdk}buildPositionType(){return`${this._sdk.sdkOptions.clmm_pool.package_id}::position::Position`}async getPositionList(t,e=[]){const n=[],i=await this._sdk.fullClient.getOwnedObjectsByPage(t,{options:{showType:!0,showContent:!0,showDisplay:!0,showOwner:!0},filter:{Package:this._sdk.sdkOptions.clmm_pool.package_id}}),s=e.length>0;for(const o of i.data)if(ht(o.data.type).full_address===this.buildPositionType()){const a=Gs(o),c=`${a.pos_object_id}_getPositionList`;this.updateCache(c,a,Kt),s?e.includes(a.pool)&&n.push(a):n.push(a)}return n}async getPosition(t,e,n=!0){let i=await this.getSimplePosition(e);return n&&(i=await this.updatePositionRewarders(t,i)),i}async getPositionById(t,e=!0){const n=await this.getSimplePosition(t);if(e){const i=await this._sdk.Pool.getPool(n.pool,!1);return await this.updatePositionRewarders(i.position_manager.positions_handle,n)}return n}async getSimplePosition(t){const e=`${t}_getPositionList`;let n=this.getSimplePositionByCache(t);if(n===void 0){const i=await this.sdk.fullClient.getObject({id:t,options:{showContent:!0,showType:!0,showDisplay:!0,showOwner:!0}});n=Gs(i),this.updateCache(e,n,Kt)}return n}getSimplePositionByCache(t){const e=`${t}_getPositionList`;return this.getCache(e)}async getSipmlePositionList(t){const e=[],n=[];return t.forEach(i=>{const s=this.getSimplePositionByCache(i);s?e.push(s):n.push(i)}),n.length>0&&(await this._sdk.fullClient.batchGetObjects(n,{showOwner:!0,showContent:!0,showDisplay:!0,showType:!0})).forEach(s=>{const o=Gs(s);e.push(o);const r=`${o.pos_object_id}_getPositionList`;this.updateCache(r,o,Kt)}),e}async updatePositionRewarders(t,e){const n=await this.getPositionRewarders(t,e.pos_object_id);return{...e,...n}}async getPositionRewarders(t,e){try{const n=await this._sdk.fullClient.getDynamicFieldObject({parentId:t,name:{type:"0x2::object::ID",value:e}}),s=he(n.data).value.fields.value;return x_(s)}catch(n){console.log(n);return}}async fetchPosFeeAmount(t){var c;const{clmm_pool:e,integrate:n,simulationAccount:i}=this.sdk.sdkOptions,s=new vt;for(const u of t){const l=[u.coinTypeA,u.coinTypeB],d=[s.object(J(e).global_config_id),s.object(u.poolAddress),s.pure(u.positionId)];s.moveCall({target:`${n.published_at}::${Pi}::fetch_position_fees`,arguments:d,typeArguments:l})}if(!Vn(i.address))throw new Mt("this config simulationAccount is not set right","InvalidSimulateAccount");const o=await this.sdk.fullClient.devInspectTransactionBlock({transactionBlock:s,sender:i.address});if(o.error!=null)throw new Mt(`fetch position fee error code: ${o.error??"unknown error"}, please check config and postion and pool object ids`,"InvalidPoolObject");const r=(c=o.events)==null?void 0:c.filter(u=>ht(u.type).name==="FetchPositionFeesEvent");if(r.length===0)return[];const a=[];for(let u=0;u<r.length;u+=1){const{parsedJson:l}=r[u],d={feeOwedA:new y(l.fee_owned_a),feeOwedB:new y(l.fee_owned_b),position_id:l.position_id};a.push(d)}return a}async batchFetchPositionFees(t){const e=[];for(const i of t){const s=await this._sdk.Position.getPositionById(i,!1),o=await this._sdk.Pool.getPool(s.pool,!1);e.push({poolAddress:o.poolAddress,positionId:s.pos_object_id,coinTypeA:o.coinTypeA,coinTypeB:o.coinTypeB})}const n={};if(e.length>0){const i=await this.fetchPosFeeAmount(e);for(const s of i)n[s.position_id]=s;return n}return n}async createAddLiquidityFixTokenPayload(t,e){if(!Vn(this._sdk.senderAddress))throw new Mt("this config sdk senderAddress is not set right","InvalidSendAddress");const n=await this._sdk.getOwnerCoinAssets(this._sdk.senderAddress);if(e){const{isAdjustCoinA:i,isAdjustCoinB:s}=uc(t);if(t=t,t.fix_amount_a&&i||!t.fix_amount_a&&s)return await ye.buildAddLiquidityFixTokenForGas(this._sdk,n,t,e)}return ye.buildAddLiquidityFixToken(this._sdk,n,t)}async createAddLiquidityPayload(t){const{integrate:e,clmm_pool:n}=this._sdk.sdkOptions;if(!Vn(this._sdk.senderAddress))throw new Mt("this config sdk senderAddress is not set right","InvalidSendAddress");const i=Nn(BigInt(t.tick_lower)).toString(),s=Nn(BigInt(t.tick_upper)).toString(),o=[t.coinTypeA,t.coinTypeB];let r=new vt;const a=!O_(t.pos_id),c=BigInt(t.max_amount_a),u=BigInt(t.max_amount_b),l=await this._sdk.getOwnerCoinAssets(this._sdk.senderAddress),d=ye.buildCoinForAmount(r,l,c,t.coinTypeA,!1),f=ye.buildCoinForAmount(r,l,u,t.coinTypeB,!1);return a?r.moveCall({target:`${e.published_at}::${Ps}::open_position_with_liquidity`,typeArguments:o,arguments:[r.object(J(n).global_config_id),r.object(t.pool_id),r.pure(i),r.pure(s),d.targetCoin,f.targetCoin,r.pure(t.max_amount_a),r.pure(t.max_amount_b),r.pure(t.delta_liquidity),r.object(Bt)]}):(r=ye.createCollectRewarderAndFeeParams(this._sdk,r,t,l,d.remainCoins,f.remainCoins),r.moveCall({target:`${e.published_at}::${Ps}::add_liquidity`,typeArguments:o,arguments:[r.object(J(n).global_config_id),r.object(t.pool_id),r.object(t.pos_id),d.targetCoin,f.targetCoin,r.pure(t.max_amount_a),r.pure(t.max_amount_b),r.pure(t.delta_liquidity),r.object(Bt)]})),r}async removeLiquidityTransactionPayload(t){if(!Vn(this._sdk.senderAddress))throw new Mt("this config sdk senderAddress is not set right","InvalidSendAddress");const{clmm_pool:e,integrate:n}=this.sdk.sdkOptions,i="remove_liquidity";let s=new vt;const o=[t.coinTypeA,t.coinTypeB],r=await this._sdk.getOwnerCoinAssets(this._sdk.senderAddress);s=ye.createCollectRewarderAndFeeParams(this._sdk,s,t,r);const a=[s.object(J(e).global_config_id),s.object(t.pool_id),s.object(t.pos_id),s.pure(t.delta_liquidity),s.pure(t.min_amount_a),s.pure(t.min_amount_b),s.object(Bt)];return s.moveCall({target:`${n.published_at}::${Cr}::${i}`,typeArguments:o,arguments:a}),s}async closePositionTransactionPayload(t){if(!Vn(this._sdk.senderAddress))throw new Mt("this config sdk senderAddress is not set right","InvalidSendAddress");const{clmm_pool:e,integrate:n}=this.sdk.sdkOptions;let i=new vt;const s=[t.coinTypeA,t.coinTypeB],o=await this._sdk.getOwnerCoinAssets(this._sdk.senderAddress);return i=ye.createCollectRewarderAndFeeParams(this._sdk,i,t,o),i.moveCall({target:`${n.published_at}::${Cr}::close_position`,typeArguments:s,arguments:[i.object(J(e).global_config_id),i.object(t.pool_id),i.object(t.pos_id),i.pure(t.min_amount_a),i.pure(t.min_amount_b),i.object(Bt)]}),i}openPositionTransactionPayload(t){const{clmm_pool:e,integrate:n}=this.sdk.sdkOptions,i=new vt,s=[t.coinTypeA,t.coinTypeB],o=Nn(BigInt(t.tick_lower)).toString(),r=Nn(BigInt(t.tick_upper)).toString(),a=[i.pure(J(e).global_config_id),i.pure(t.pool_id),i.pure(o),i.pure(r)];return i.moveCall({target:`${n.published_at}::${Cr}::open_position`,typeArguments:s,arguments:a}),i}async collectFeeTransactionPayload(t){if(!Vn(this._sdk.senderAddress))throw new Mt("this config sdk senderAddress is not set right","InvalidSendAddress");const e=await this._sdk.getOwnerCoinAssets(this._sdk.senderAddress,null,!0),n=new vt,i=ye.buildCoinForAmount(n,e,BigInt(0),t.coinTypeA,!1),s=ye.buildCoinForAmount(n,e,BigInt(0),t.coinTypeB,!1);return this.createCollectFeePaylod(t,n,i.targetCoin,s.targetCoin),n}createCollectFeePaylod(t,e,n,i){const{clmm_pool:s,integrate:o}=this.sdk.sdkOptions,r=[t.coinTypeA,t.coinTypeB],a=[e.object(J(s).global_config_id),e.object(t.pool_id),e.object(t.pos_id),n,i];return e.moveCall({target:`${o.published_at}::${Ps}::collect_fee`,typeArguments:r,arguments:a}),e}async calculateFee(t){const e=await this.collectFeeTransactionPayload(t);if(!Vn(this._sdk.senderAddress))throw new Mt("this config sdk senderAddress is not set right","InvalidSendAddress");const n=await this._sdk.fullClient.devInspectTransactionBlock({transactionBlock:e,sender:this._sdk.senderAddress});for(const i of n.events)if(ht(i.type).name==="CollectFeeEvent"){const s=i.parsedJson;return{feeOwedA:s.amount_a,feeOwedB:s.amount_b}}return{feeOwedA:"0",feeOwedB:"0"}}updateCache(t,e,n=gi){let i=this._cache[t];i?(i.overdueTime=on(n),i.value=e):i=new Yn(e,on(n)),this._cache[t]=i}getCache(t,e=!1){const n=this._cache[t],i=n==null?void 0:n.isValid();if(!e&&i)return n.value;i||delete this._cache[t]}},Rk=class{constructor(t){Ft(this,"_sdk");Ft(this,"growthGlobal");this._sdk=t,this.growthGlobal=[Zt,Zt,Zt]}get sdk(){return this._sdk}async emissionsEveryDay(t){const n=(await this.sdk.Pool.getPool(t)).rewarder_infos;if(!n)return null;const i=[];for(const s of n){const o=qe.fromX64(new y(s.emissions_per_second));i.push({emissions:Math.floor(o.toNumber()*60*60*24),coin_address:s.coinAddress})}return i}async updatePoolRewarder(t,e){const n=await this.sdk.Pool.getPool(t),i=n.rewarder_last_updated_time;if(n.rewarder_last_updated_time=e.toString(),Number(n.liquidity)===0||e.eq(new y(i)))return n;const s=e.div(new y(1e3)).sub(new y(i)).add(new y(15)),o=n.rewarder_infos;for(let r=0;r<o.length;r+=1){const a=o[r],c=qe.checkMulDivFloor(s,new y(a.emissions_per_second),new y(n.liquidity),128);this.growthGlobal[r]=new y(a.growth_global).add(new y(c))}return n}async posRewardersAmount(t,e,n){const i=Date.parse(new Date().toString()),s=await this.updatePoolRewarder(t,new y(i)),o=await this.sdk.Position.getPositionRewarders(e,n);if(o===void 0)return[];const r=s.ticks_handle,a=await this.sdk.Pool.getTickDataByIndex(r,o.tick_lower_index),c=await this.sdk.Pool.getTickDataByIndex(r,o.tick_upper_index);return this.posRewardersAmountInternal(s,o,a,c)}async poolRewardersAmount(t,e){const n=Date.parse(new Date().toString()),i=await this.updatePoolRewarder(e,new y(n)),s=await this.sdk.Position.getPositionList(t,[e]),o=await this.getPoolLowerAndUpperTicks(i.ticks_handle,s),r=[Zt,Zt,Zt];for(let a=0;a<s.length;a+=1){const c=await this.posRewardersAmountInternal(i,s[a],o[0][a],o[1][a]);for(let u=0;u<3;u+=1)r[u]=r[u].add(c[u].amount_owed)}return r}posRewardersAmountInternal(t,e,n,i){const s=e.tick_lower_index,o=e.tick_upper_index,r=Ek(t,n,i,s,o,this.growthGlobal),a=[],c=[];if(r.length>0){let u=qe.subUnderflowU128(r[0],new y(e.reward_growth_inside_0));u.gt(new y("3402823669209384634633745948738404"))&&(u=Vi);const l=qe.checkMulShiftRight(new y(e.liquidity),u,64,128);a.push(r[0]),c.push({amount_owed:new y(e.reward_amount_owed_0).add(l),coin_address:t.rewarder_infos[0].coinAddress})}if(r.length>1){let u=qe.subUnderflowU128(r[1],new y(e.reward_growth_inside_1));u.gt(new y("3402823669209384634633745948738404"))&&(u=Vi);const l=qe.checkMulShiftRight(new y(e.liquidity),u,64,128);a.push(r[1]),c.push({amount_owed:new y(e.reward_amount_owed_1).add(l),coin_address:t.rewarder_infos[1].coinAddress})}if(r.length>2){let u=qe.subUnderflowU128(r[2],new y(e.reward_growth_inside_2));u.gt(new y("3402823669209384634633745948738404"))&&(u=Vi);const l=qe.checkMulShiftRight(new y(e.liquidity),u,64,128);a.push(r[2]),c.push({amount_owed:new y(e.reward_amount_owed_2).add(l),coin_address:t.rewarder_infos[2].coinAddress})}return c}async batchFetchPositionRewarders(t){const e=[];for(const i of t){const s=await this._sdk.Position.getPositionById(i,!1),o=await this._sdk.Pool.getPool(s.pool,!1);e.push({poolAddress:o.poolAddress,positionId:s.pos_object_id,coinTypeA:o.coinTypeA,coinTypeB:o.coinTypeB,rewarderInfo:o.rewarder_infos})}const n={};if(e.length>0){const i=await this.fetchPosRewardersAmount(e);for(const s of i)n[s.positionId]=s.rewarderAmountOwed;return n}return n}async fetchPositionRewarders(t,e){const n={poolAddress:t.poolAddress,positionId:e,coinTypeA:t.coinTypeA,coinTypeB:t.coinTypeB,rewarderInfo:t.rewarder_infos};return(await this.fetchPosRewardersAmount([n]))[0].rewarderAmountOwed}async batchFetchPositionFees(t){const e=[];for(const i of t){const s=await this._sdk.Position.getPositionById(i,!1),o=await this._sdk.Pool.getPool(s.pool,!1);e.push({poolAddress:o.poolAddress,positionId:s.pos_object_id,coinTypeA:o.coinTypeA,coinTypeB:o.coinTypeB})}const n={};if(e.length>0){const i=await this.fetchPosFeeAmount(e);for(const s of i)n[s.position_id]=s;return n}return n}async fetchPosFeeAmount(t){var c;const{clmm_pool:e,integrate:n,simulationAccount:i}=this.sdk.sdkOptions,s=new vt;for(const u of t){const l=[u.coinTypeA,u.coinTypeB],d=[s.object(J(e).global_config_id),s.object(u.poolAddress),s.pure(u.positionId)];s.moveCall({target:`${n.published_at}::${Pi}::fetch_position_fees`,arguments:d,typeArguments:l})}const r=(c=(await this.sdk.fullClient.devInspectTransactionBlock({transactionBlock:s,sender:i.address})).events)==null?void 0:c.filter(u=>ht(u.type).name==="FetchPositionFeesEvent");if(r.length===0)return[];const a=[];for(let u=0;u<r.length;u+=1){const{parsedJson:l}=r[u],d={feeOwedA:new y(l.fee_owned_a),feeOwedB:new y(l.fee_owned_b),position_id:l.position_id};a.push(d)}return a}async fetchPosRewardersAmount(t){var c;const{clmm_pool:e,integrate:n,simulationAccount:i}=this.sdk.sdkOptions,s=new vt;for(const u of t){const l=[u.coinTypeA,u.coinTypeB],d=[s.object(J(e).global_config_id),s.object(u.poolAddress),s.pure(u.positionId),s.object(Bt)];s.moveCall({target:`${n.published_at}::${Pi}::fetch_position_rewards`,arguments:d,typeArguments:l})}if(!Vn(i.address))throw new Mt(`this config simulationAccount: ${i.address} is not set right`,"InvalidSimulateAccount");const o=await this.sdk.fullClient.devInspectTransactionBlock({transactionBlock:s,sender:i.address});if(o.error!=null)throw new Mt(`fetch position rewards error code: ${o.error??"unknown error"}, please check config and params`,"InvalidConfig");const r=(c=o.events)==null?void 0:c.filter(u=>ht(u.type).name==="FetchPositionRewardsEvent");if(r.length===0)return[];if(r.length!==t.length)throw new Mt("valueData.length !== params.pools.length");const a=[];for(let u=0;u<r.length;u+=1){const l={poolAddress:t[u].poolAddress,positionId:t[u].positionId,rewarderAmountOwed:[]};for(let d=0;d<t[u].rewarderInfo.length;d+=1)l.rewarderAmountOwed.push({amount_owed:new y(r[u].parsedJson.data[d]),coin_address:t[u].rewarderInfo[d].coinAddress});a.push(l)}return a}async fetchPoolRewardersAmount(t,e){const n=await this.sdk.Pool.getPool(e),i=await this.sdk.Position.getPositionList(t,[e]),s=[];for(const a of i)s.push({poolAddress:n.poolAddress,positionId:a.pos_object_id,rewarderInfo:n.rewarder_infos,coinTypeA:n.coinTypeA,coinTypeB:n.coinTypeB});const o=await this.fetchPosRewardersAmount(s),r=[Zt,Zt,Zt];if(o!=null)for(const a of o)for(let c=0;c<a.rewarderAmountOwed.length;c+=1)r[c]=r[c].add(a.rewarderAmountOwed[c].amount_owed);return r}async getPoolLowerAndUpperTicks(t,e){const n=[],i=[];for(const s of e){const o=await this.sdk.Pool.getTickDataByIndex(t,s.tick_lower_index),r=await this.sdk.Pool.getTickDataByIndex(t,s.tick_upper_index);n.push(o),i.push(r)}return[n,i]}async collectRewarderTransactionPayload(t){if(!Vn(this._sdk.senderAddress))throw new Mt("this config sdk senderAddress is not set right","InvalidSendAddress");const e=await this._sdk.getOwnerCoinAssets(this._sdk.senderAddress,null);let n=new vt;return n=ye.createCollectRewarderAndFeeParams(this._sdk,n,t,e),n}createCollectRewarderPaylod(t,e,n){const{clmm_pool:i,integrate:s}=this.sdk.sdkOptions,o=J(i),r=[t.coinTypeA,t.coinTypeB];return t.rewarder_coin_types.forEach((a,c)=>{e&&e.moveCall({target:`${s.published_at}::${Ps}::collect_reward`,typeArguments:[...r,a],arguments:[e.object(o.global_config_id),e.object(t.pool_id),e.object(t.pos_id),e.object(o.global_vault_id),n[c],e.object(Bt)]})}),e}};function Aa(t,e){return{pair:`${t}-${e}`,reversePair:`${e}-${t}`}}var Uk=class{constructor(t){Ft(this,"graph");Ft(this,"pathProviders");Ft(this,"coinProviders");Ft(this,"_coinAddressMap");Ft(this,"poolAddressMap");Ft(this,"_sdk");this.pathProviders=[],this.coinProviders={coins:[]},this.graph=new t_(!1),this._coinAddressMap=new Map,this.poolAddressMap=new Map,this._sdk=t,this.getPoolAddressMapAndDirection=this.getPoolAddressMapAndDirection.bind(this),this.setCoinList=this.setCoinList.bind(this),this.loadGraph=this.loadGraph.bind(this),this.addCoinProvider=this.addCoinProvider.bind(this),this.addPathProvider=this.addPathProvider.bind(this),this.preRouterSwapA2B2C=this.preRouterSwapA2B2C.bind(this),this.price=this.price.bind(this),this.getPoolWithTVL=this.getPoolWithTVL.bind(this)}get sdk(){return this._sdk}getPoolAddressMapAndDirection(t,e){const{pair:n,reversePair:i}=Aa(t,e);let s=this.poolAddressMap.get(n);if(s!=null)return{addressMap:s,direction:!0};if(s=this.poolAddressMap.get(i),s!=null)return{addressMap:s,direction:!1}}setCoinList(){this.coinProviders.coins.forEach(t=>{this._coinAddressMap.set(t.address,t)})}loadGraph(t,e){this.addCoinProvider(t),this.addPathProvider(e),this.setCoinList(),this.pathProviders.forEach(n=>{const{paths:i}=n;i.forEach(s=>{const o=this.graph.getVertexByKey(s.base)??new Qa(s.base),r=this.graph.getVertexByKey(s.quote)??new Qa(s.quote);this.graph.addEdge(new Qg(o,r));const a=this._coinAddressMap.get(s.base),c=this._coinAddressMap.get(s.quote);if(a!=null&&c!=null){const u=Aa(s.base,s.quote).pair;this.poolAddressMap.set(u,s.addressMap)}})})}addPathProvider(t){for(let e=0;e<t.paths.length;e+=1){const{base:n,quote:i}=t.paths[e];n.localeCompare(i)<0&&(t.paths[e].base=i,t.paths[e].quote=n),n==="0x2::sui::SUI"&&(t.paths[e].base=i,t.paths[e].quote=n),i==="0x2::sui::SUI"&&(t.paths[e].base=n,t.paths[e].quote=i)}return this.pathProviders.push(t),this}addCoinProvider(t){return this.coinProviders=t,this}tokenInfo(t){return this._coinAddressMap.get(t)}getFeeRate(t,e,n){const i=Aa(t,e).pair,s=this.poolAddressMap.get(i);if(s!=null){for(const[a,c]of s.entries())if(c===n)return a*100}const o=Aa(t,e).reversePair,r=this.poolAddressMap.get(o);if(r!=null){for(const[a,c]of r.entries())if(c===n)return a*100}return 0}async price(t,e,n,i,s,o,r){const a=this.tokenInfo(t),c=this.tokenInfo(e);if(a===void 0||c===void 0)throw new Mt("From/To coin is undefined","InvalidCoin");const u=this.graph.getVertexByKey(a.address),l=this.graph.getVertexByKey(c.address),d=this.graph.findAllPath(u,l),f=Array.from(d);if(f.length===0)throw new Mt("No find valid path in coin graph","NotFoundPath");let _=[];for(let z=0;z<f.length;z+=1){const O=f[z];if(O.length>3)continue;const $=[],b=[],h=[],m=[];for(let x=0;x<O.length-1;x+=1){const I=O[x].value.toString(),N=O[x+1].value.toString(),j=this.getPoolAddressMapAndDirection(I,N),G=j==null?void 0:j.addressMap,E=j==null?void 0:j.direction;G!=null&&E!=null&&(b.push(E),$.push(I),$.push(N),G.forEach(g=>{x===0?h.push(g):m.push(g)}))}for(const x of h)if(m.length>0)for(const I of m){const N={stepNums:2,poolAB:x,poolBC:I,a2b:b[0],b2c:b[1],amount:n,byAmountIn:i,coinTypeA:$[0],coinTypeB:$[1],coinTypeC:$[3]};_.push(N)}else{const I={stepNums:1,poolAB:x,poolBC:void 0,a2b:b[0],b2c:void 0,amount:n,byAmountIn:i,coinTypeA:$[0],coinTypeB:$[1],coinTypeC:void 0};_.push(I)}}const T=_.filter(z=>z.stepNums===1),v=_.filter(z=>z.stepNums!==1);let k=[];try{k=await this.getPoolWithTVL()}catch{k=[]}if(k.length>0){const z=new Map(k.map(O=>[O.poolAddress,O]));v.sort((O,$)=>{let b=0,h=0;if(z.has(O.poolAB)&&z.has(O.poolBC)){const m=z.get(O.poolAB),x=z.get(O.poolBC);b=Math.min(m.tvl,x.tvl)}if(z.has($.poolAB)&&z.has($.poolBC)){const m=z.get($.poolAB),x=z.get($.poolBC);h=Math.min(m.tvl,x.tvl)}return h-b})}if(_=[...T,...v],_.length===0){if(r!=null){const z=await this.sdk.Swap.preSwapWithMultiPool(r),O={amountIn:new y(z.estimatedAmountIn),amountOut:new y(z.estimatedAmountOut),poolAddress:[z.poolAddress],a2b:[z.aToB],rawAmountLimit:i?[z.estimatedAmountOut]:[z.estimatedAmountIn],isExceed:z.isExceed,coinType:[t,e]},$={paths:[O],partner:o,priceSlippagePoint:s};return{amountIn:new y(z.estimatedAmountIn),amountOut:new y(z.estimatedAmountOut),paths:[O],a2b:z.aToB,b2c:void 0,byAmountIn:i,isExceed:z.isExceed,targetSqrtPrice:[z.estimatedEndSqrtPrice],currentSqrtPrice:[z.estimatedStartSqrtPrice],coinTypeA:t,coinTypeB:e,coinTypeC:void 0,createTxParams:$}}throw new Mt("No parameters available for service downgrade","NoDowngradeNeedParams")}const U=await this.preRouterSwapA2B2C(_.slice(0,16));if(U==null){if(r!=null){const O=await this.sdk.Swap.preSwapWithMultiPool(r),$={amountIn:new y(O.estimatedAmountIn),amountOut:new y(O.estimatedAmountOut),poolAddress:[O.poolAddress],a2b:[O.aToB],rawAmountLimit:i?[O.estimatedAmountOut]:[O.estimatedAmountIn],isExceed:O.isExceed,coinType:[t,e]},b={paths:[$],partner:o,priceSlippagePoint:s};return{amountIn:new y(O.estimatedAmountIn),amountOut:new y(O.estimatedAmountOut),paths:[$],a2b:O.aToB,b2c:void 0,byAmountIn:i,isExceed:O.isExceed,targetSqrtPrice:[O.estimatedEndSqrtPrice],currentSqrtPrice:[O.estimatedStartSqrtPrice],coinTypeA:t,coinTypeB:e,coinTypeC:void 0,createTxParams:b}}return{amountIn:Zt,amountOut:Zt,paths:[],a2b:!1,b2c:!1,byAmountIn:i,isExceed:!0,targetSqrtPrice:[],currentSqrtPrice:[],coinTypeA:"",coinTypeB:"",coinTypeC:void 0,createTxParams:void 0}}const R=U.index,A=_[R].poolBC!=null?[_[R].poolAB,_[R].poolBC]:[_[R].poolAB],P=i?[U.amountMedium,U.amountOut]:[U.amountIn,U.amountMedium],M=[];M.push(_[R].a2b),U.stepNum>1&&M.push(_[R].b2c);const K=[];K.push(_[R].coinTypeA),K.push(_[R].coinTypeB),U.stepNum>1&&K.push(_[R].coinTypeC);const Y={amountIn:U.amountIn,amountOut:U.amountOut,poolAddress:A,a2b:M,rawAmountLimit:P,isExceed:U.isExceed,coinType:K},X={paths:[Y],partner:o,priceSlippagePoint:s};return{amountIn:U.amountIn,amountOut:U.amountOut,paths:[Y],a2b:_[R].a2b,b2c:U.stepNum>1?_[R].b2c:void 0,byAmountIn:i,isExceed:U.isExceed,targetSqrtPrice:U.targetSqrtPrice,currentSqrtPrice:U.currentSqrtPrice,coinTypeA:_[R].coinTypeA,coinTypeB:_[R].coinTypeB,coinTypeC:U.stepNum>1?_[R].coinTypeC:void 0,createTxParams:X}}async preRouterSwapA2B2C(t){var d;if(t.length===0)return null;const{integrate:e,simulationAccount:n}=this.sdk.sdkOptions,i=new vt;for(const f of t)if(f.stepNums>1){const _=[i.object(f.poolAB),i.object(f.poolBC),i.pure(f.a2b),i.pure(f.b2c),i.pure(f.byAmountIn),i.pure(f.amount.toString())],T=[];f.a2b?T.push(f.coinTypeA,f.coinTypeB):T.push(f.coinTypeB,f.coinTypeA),f.b2c?T.push(f.coinTypeB,f.coinTypeC):T.push(f.coinTypeC,f.coinTypeB),i.moveCall({target:`${e.published_at}::${Ns}::calculate_router_swap_result`,typeArguments:T,arguments:_})}else{const _=[i.pure(f.poolAB),i.pure(f.a2b),i.pure(f.byAmountIn),i.pure(f.amount.toString())],T=f.a2b?[f.coinTypeA,f.coinTypeB]:[f.coinTypeB,f.coinTypeA];i.moveCall({target:`${e.published_at}::${G6}::get_expect_swap_result`,arguments:_,typeArguments:T})}if(!Vn(n.address))throw new Mt("this config simulationAccount is not set right","InvalidSimulateAccount");const o=(d=(await this.sdk.fullClient.devInspectTransactionBlock({transactionBlock:i,sender:n.address})).events)==null?void 0:d.filter(f=>ht(f.type).name==="CalculatedRouterSwapResultEvent"||ht(f.type).name==="ExpectSwapResultEvent");if(o.length===0)return null;let r=t[0].byAmountIn?Zt:nr,a=0;for(let f=0;f<o.length;f+=1)if(!o[f].parsedJson.data.is_exceed)if(t[0].byAmountIn){const _=new y(o[f].parsedJson.data.amount_out);_.gt(r)&&(a=f,r=_)}else{const _=t[f].stepNums>1?new y(o[f].parsedJson.data.amount_in):new y(o[f].parsedJson.data.amount_in).add(new y(o[f].parsedJson.data.fee_amount));_.lt(r)&&(a=f,r=_)}const c=[],u=[];return t[a].stepNums>1?(u.push(o[a].parsedJson.data.target_sqrt_price_ab,o[a].parsedJson.data.target_sqrt_price_cd),c.push(o[a].parsedJson.data.current_sqrt_price_ab,o[a].parsedJson.data.current_sqrt_price_cd)):(u.push(o[a].parsedJson.data.after_sqrt_price),c.push(o[a].parsedJson.current_sqrt_price)),{index:a,amountIn:t[0].byAmountIn?t[a].amount:r,amountMedium:o[a].parsedJson.data.amount_medium,amountOut:t[0].byAmountIn?r:t[a].amount,targetSqrtPrice:u,currentSqrtPrice:c,isExceed:o[a].parsedJson.data.is_exceed,stepNum:t[a].stepNums}}async getPoolWithTVL(){const t=[],{swapCountUrl:e}=this._sdk.sdkOptions;if(!e)return t;let n;try{n=await fetch(e)}catch{throw new Mt(`Failed to get pool list with liquidity from ${e}.`,"InvalidSwapCountUrl")}let i;try{i=await n.json()}catch{throw new Mt(`Failed tp [arse response from ${e}].`,"InvalidSwapCountUrl")}if(i.code!==200)throw new Mt(`Failed to get pool list from ${e}. Statu code is ${i.code}.`,"InvalidSwapCountUrl");const{pools:s}=i.data;for(const o of s)t.push({poolAddress:o.swap_account,tvl:Number(o.tvl_in_usd)});return t}},$k=class{constructor(t){Ft(this,"_sdk");Ft(this,"calculateSingleImpact",(t,e)=>e.minus(t).div(e).mul(100));this._sdk=t}get sdk(){return this._sdk}calculateSwapFee(t){let e=D(0);return t.forEach(n=>{const i=n.basePaths.length;if(i>0){const s=n.basePaths[0],o=s.label==="Cetus"?new it(s.feeRate).div(10**6):new it(s.feeRate).div(10**9),r=D(s.inputAmount).div(10**s.fromDecimal).mul(o);if(e=e.add(r),i>1){const a=n.basePaths[1],c=s.direction?s.currentPrice:new it(1).div(s.currentPrice),u=a.direction?a.currentPrice:new it(1).div(a.currentPrice),l=a.label==="Cetus"?new it(a.feeRate).div(10**6):new it(a.feeRate).div(10**9),f=D(a.outputAmount).div(10**a.toDecimal).mul(l).div(c.mul(u));e=e.add(f)}}}),e.toString()}calculateSwapPriceImpact(t){let e=D(0);return t.forEach(n=>{const i=n.basePaths.length;if(i===1){const s=n.basePaths[0],o=D(s.outputAmount).div(10**s.toDecimal),r=D(s.inputAmount).div(10**s.fromDecimal),a=o.div(r),c=s.direction?new it(s.currentPrice):new it(1).div(s.currentPrice);e=e.add(this.calculateSingleImpact(a,c))}if(i===2){const s=n.basePaths[0],o=n.basePaths[1],r=s.direction?new it(s.currentPrice):new it(1).div(s.currentPrice),a=o.direction?new it(o.currentPrice):new it(1).div(o.currentPrice),c=r.mul(a),u=new it(o.outputAmount).div(10**o.toDecimal),l=new it(s.inputAmount).div(10**s.fromDecimal),d=u.div(l);e=e.add(this.calculateSingleImpact(d,c))}}),e.toString()}async preSwapWithMultiPool(t){var u;const{integrate:e,simulationAccount:n}=this.sdk.sdkOptions,i=new vt,s=[t.coinTypeA,t.coinTypeB];for(let l=0;l<t.poolAddresses.length;l+=1){const d=[i.pure(t.poolAddresses[l]),i.pure(t.a2b),i.pure(t.byAmountIn),i.pure(t.amount)];i.moveCall({target:`${e.published_at}::${Pi}::calculate_swap_result`,arguments:d,typeArguments:s})}if(!Vn(n.address))throw new Mt("this config simulationAccount is not set right","InvalidSimulateAccount");const o=await this.sdk.fullClient.devInspectTransactionBlock({transactionBlock:i,sender:n.address});if(o.error!=null)throw new Mt(`pre swap with multi pools error code: ${o.error??"unknown error"}, please check config and params`,"InvalidConfig");const r=(u=o.events)==null?void 0:u.filter(l=>ht(l.type).name==="CalculatedSwapResultEvent");if(r.length===0)return null;if(r.length!==t.poolAddresses.length)throw new Mt("valueData.length !== params.pools.length","ParamsLengthNotEqual");let a=t.byAmountIn?Zt:nr,c=0;for(let l=0;l<r.length;l+=1)if(!r[l].parsedJson.data.is_exceed)if(t.byAmountIn){const d=new y(r[l].parsedJson.data.amount_out);d.gt(a)&&(c=l,a=d)}else{const d=new y(r[l].parsedJson.data.amount_out);d.lt(a)&&(c=l,a=d)}return this.transformSwapWithMultiPoolData({poolAddress:t.poolAddresses[c],a2b:t.a2b,byAmountIn:t.byAmountIn,amount:t.amount,coinTypeA:t.coinTypeA,coinTypeB:t.coinTypeB},r[c].parsedJson)}async preswap(t){var c;const{integrate:e,simulationAccount:n}=this.sdk.sdkOptions,i=new vt,s=[t.coinTypeA,t.coinTypeB],o=[i.pure(t.pool.poolAddress),i.pure(t.a2b),i.pure(t.byAmountIn),i.pure(t.amount)];if(i.moveCall({target:`${e.published_at}::${Pi}::calculate_swap_result`,arguments:o,typeArguments:s}),!Vn(n.address))throw new Mt("this config simulationAccount is not set right","InvalidSimulateAccount");const r=await this.sdk.fullClient.devInspectTransactionBlock({transactionBlock:i,sender:n.address});if(r.error!=null)throw new Mt(`preswap error code: ${r.error??"unknown error"}, please check config and params`,"InvalidConfig");const a=(c=r.events)==null?void 0:c.filter(u=>ht(u.type).name==="CalculatedSwapResultEvent");return a.length===0?null:this.transformSwapData(t,a[0].parsedJson.data)}transformSwapData(t,e){const n=e.amount_in&&e.fee_amount?new y(e.amount_in).add(new y(e.fee_amount)).toString():"";return{poolAddress:t.pool.poolAddress,currentSqrtPrice:t.currentSqrtPrice,estimatedAmountIn:n,estimatedAmountOut:e.amount_out,estimatedEndSqrtPrice:e.after_sqrt_price,estimatedFeeAmount:e.fee_amount,isExceed:e.is_exceed,amount:t.amount,aToB:t.a2b,byAmountIn:t.byAmountIn}}transformSwapWithMultiPoolData(t,e){const{data:n}=e,i=n.amount_in&&n.fee_amount?new y(n.amount_in).add(new y(n.fee_amount)).toString():"";return{poolAddress:t.poolAddress,estimatedAmountIn:i,estimatedAmountOut:n.amount_out,estimatedEndSqrtPrice:n.after_sqrt_price,estimatedStartSqrtPrice:e.current_sqrt_price,estimatedFeeAmount:n.fee_amount,isExceed:n.is_exceed,amount:t.amount,aToB:t.a2b,byAmountIn:t.byAmountIn}}calculateRates(t){const{currentPool:e}=t,n=H6(e);let i;t.a2b?i=t.swapTicks.sort((d,f)=>f.index-d.index):i=t.swapTicks.sort((d,f)=>d.index-f.index);const s=uk(t.a2b,t.byAmountIn,t.amount,n,i);let o=!1;t.byAmountIn?o=s.amountIn.lt(t.amount):o=s.amountOut.lt(t.amount);const r=Wi.getDefaultSqrtPriceLimit(t.a2b);t.a2b&&s.nextSqrtPrice.lt(r)&&(o=!0),!t.a2b&&s.nextSqrtPrice.gt(r)&&(o=!0);let a=0;s.crossTickNum>6&&s.crossTickNum<40&&(a=22e3*(s.crossTickNum-6)),s.crossTickNum>40&&(o=!0);const c=Nt.sqrtPriceX64ToPrice(n.currentSqrtPrice,t.decimalsA,t.decimalsB).toNumber(),u=Nt.sqrtPriceX64ToPrice(s.nextSqrtPrice,t.decimalsA,t.decimalsB).toNumber(),l=Math.abs(c-u)/c*100;return{estimatedAmountIn:s.amountIn,estimatedAmountOut:s.amountOut,estimatedEndSqrtPrice:s.nextSqrtPrice,estimatedFeeAmount:s.feeAmount,isExceed:o,extraComputeLimit:a,amount:t.amount,aToB:t.a2b,byAmountIn:t.byAmountIn,priceImpactPct:l}}async createSwapTransactionPayload(t,e){if(this._sdk.senderAddress.length===0)throw Error("this config sdk senderAddress is empty");const n=await this._sdk.getOwnerCoinAssets(this._sdk.senderAddress);if(e){const{isAdjustCoinA:i,isAdjustCoinB:s}=uc(t);if(t.a2b&&i||!t.a2b&&s)return await ye.buildSwapTransactionForGas(this._sdk,t,n,e)}return ye.buildSwapTransaction(this.sdk,t,n)}async createSwapTransactionWithoutTransferCoinsPayload(t,e){if(this._sdk.senderAddress.length===0)throw Error("this config sdk senderAddress is empty");const n=await this._sdk.getOwnerCoinAssets(this._sdk.senderAddress);if(e){const{isAdjustCoinA:i,isAdjustCoinB:s}=uc(t);if(t.a2b&&i||!t.a2b&&s)return await ye.buildSwapTransactionWithoutTransferCoinsForGas(this._sdk,t,n,e)}return ye.buildSwapTransactionWithoutTransferCoins(this.sdk,t,n)}},qk=class{constructor(t){Ft(this,"_sdk");Ft(this,"_cache",{});this._sdk=t}get sdk(){return this._sdk}async getAllRegisteredTokenList(t=!1){return await this.factchTokenList("",t)}async getOwnerTokenList(t="",e=!1){return await this.factchTokenList(t,e)}async getAllRegisteredPoolList(t=!1){return await this.factchPoolList("",t)}async getOwnerPoolList(t="",e=!1){return await this.factchPoolList(t,e)}async getWarpPoolList(t=!1){return await this.factchWarpPoolList("","",t)}async getOwnerWarpPoolList(t="",e="",n=!1){return await this.factchWarpPoolList(t,e,n)}async getTokenListByCoinTypes(t){const e={},n="getAllRegisteredTokenList",i=this.getCache(n);if(i!==void 0){const o=i;for(const r of t)for(const a of o)if(ri(r)===ri(a.address)){e[r]=a;continue}}const s=t.filter(o=>e[o]===void 0);for(const o of s){const r=`${o}_metadata`,a=this.getCache(r);if(a!==void 0)e[o]=a;else{const c=await this._sdk.fullClient.getCoinMetadata({coinType:o});if(c){const u={id:c.id,name:c.name,symbol:c.symbol,official_symbol:c.symbol,coingecko_id:"",decimals:c.decimals,project_url:"",logo_url:c.iconUrl,address:o};e[o]=u,this.updateCache(r,u,Kt)}}}return e}async factchTokenList(t="",e=!1){var d;const{simulationAccount:n,token:i}=this.sdk.sdkOptions,s="getAllRegisteredTokenList",o=this.getCache(s,e);if(o!==void 0)return o;const r=t.length>0,a=512;let c=0,u=[];if(i===void 0)throw Error("please config token ofsdkOptions");const l=J(i);for(;;){const f=new vt;f.moveCall({target:`${i.published_at}::coin_list::${r?"fetch_full_list_with_limit":"fetch_all_registered_coin_info_with_limit"}`,arguments:r?[f.pure(l.coin_registry_id),f.pure(t),f.pure(c),f.pure(a)]:[f.pure(l.coin_registry_id),f.pure(c),f.pure(a)]});const _=await this.sdk.fullClient.devInspectTransactionBlock({transactionBlock:f,sender:n.address}),T=[];if((d=_.events)==null||d.forEach(v=>{ht(v.type).full_address===`${i.published_at}::coin_list::FetchCoinListEvent`&&v.parsedJson.full_list.value_list.forEach(U=>{T.push(this.transformData(U,!1))})}),u=[...u,...T],T.length<a)break;c=u.length}return u}async factchPoolList(t="",e=!1){var d;const{simulationAccount:n,token:i}=this.sdk.sdkOptions,s="getAllRegisteredPoolList",o=this.getCache(s,e);if(o!==void 0)return o;let r=[];const a=512;let c=0;const u=t.length>0;if(i===void 0)throw Error("please config token ofsdkOptions");const l=J(i);for(;;){const f=new vt;if(f.moveCall({target:`${i.published_at}::lp_list::${u?"fetch_full_list_with_limit":"fetch_all_registered_coin_info_with_limit"}`,arguments:u?[f.pure(l.pool_registry_id),f.pure(t),f.pure(c),f.pure(a)]:[f.pure(l.pool_registry_id),f.pure(c),f.pure(a)]}),!Vn(n.address))throw new Mt("this config simulationAccount is not set right","InvalidSimulateAccount");const _=await this.sdk.fullClient.devInspectTransactionBlock({transactionBlock:f,sender:n.address}),T=[];if((d=_.events)==null||d.forEach(v=>{ht(v.type).full_address===`${i.published_at}::lp_list::FetchPoolListEvent`&&v.parsedJson.full_list.value_list.forEach(U=>{T.push(this.transformData(U,!0))})}),r=[...r,...T],T.length<a)break;c=r.length}return r}async factchWarpPoolList(t="",e="",n=!1){const i=await this.factchPoolList(t,n);if(i.length===0)return[];const s=await this.factchTokenList(e,n),o=[];for(const r of i){for(const a of s)a.address===r.coin_a_address&&(r.coinA=a),a.address===r.coin_b_address&&(r.coinB=a);o.push(r)}return o}async getTokenConfigEvent(t=!1){const e=this._sdk.sdkOptions.token.package_id,n=`${e}_getTokenConfigEvent`,i=this.getCache(n,t);if(i!==void 0)return i;const s=await this._sdk.fullClient.getObject({id:e,options:{showPreviousTransaction:!0}}),o=la(s),r=await this._sdk.fullClient.queryEventsByPage({Transaction:o}),a={coin_registry_id:"",pool_registry_id:"",coin_list_owner:"",pool_list_owner:""};return r.data.length>0&&r.data.forEach(c=>{const u=ht(c.type);if(c.transactionModule==="coin_list")switch(u.name){case"InitListEvent":a.coin_list_owner=c.parsedJson.list_id;break;case"InitRegistryEvent":a.coin_registry_id=c.parsedJson.registry_id;break}else if(c.transactionModule==="lp_list")switch(u.name){case"InitListEvent<address>":a.pool_list_owner=c.parsedJson.list_id;break;case"InitRegistryEvent<address>":a.pool_registry_id=c.parsedJson.registry_id;break}}),a.coin_registry_id.length>0&&this.updateCache(n,a,Kt),a}transformData(t,e){const n={...t};if(e)try{n.coin_a_address=ht(n.coin_a_address).full_address,n.coin_b_address=ht(n.coin_b_address).full_address}catch{}else n.address=ht(n.address).full_address;if(t.extensions){const i=t.extensions.contents;for(const s of i){const{key:o}=s;let{value:r}=s;if(o==="labels")try{r=JSON.parse(decodeURIComponent(Lo.decode(r)))}catch{}o==="pyth_id"&&(r=Ln(r)),n[o]=r}delete n.extensions}return n}updateCache(t,e,n=gi){let i=this._cache[t];i?(i.overdueTime=on(n),i.value=e):i=new Yn(e,on(n)),this._cache[t]=i}getCache(t,e=!1){const n=this._cache[t],i=n==null?void 0:n.isValid();if(!e&&i)return n.value;i||delete this._cache[t]}},Mk=class{constructor(t){Ft(this,"_sdk");this._sdk=t}get sdk(){return this._sdk}calculatePrice(t,e,n,i,s){const o=i?e:n,r=i?n:e;return s==="Cetus"?Nt.sqrtPriceX64ToPrice(t,o,r):new it(t.toString()).div(new it(10).pow(new it(r+9-o)))}parseJsonResult(t){return{isExceed:t.is_exceed,isTimeout:t.is_timeout,inputAmount:t.input_amount,outputAmount:t.output_amount,fromCoin:t.from_coin,toCoin:t.to_coin,byAmountIn:t.by_amount_in,splitPaths:t.split_paths.map(n=>({pathIndex:n.path_index,lastQuoteOutput:n.last_quote_output,percent:n.percent,basePaths:n.best_path.map(s=>({direction:s.direction,label:s.label,poolAddress:s.provider,fromCoin:s.from_coin,toCoin:s.to_coin,outputAmount:s.output_amount,inputAmount:s.input_amount,feeRate:s.fee_rate,currentSqrtPrice:new y(s.current_sqrt_price.toString()),afterSqrtPrice:s.label==="Cetus"?new y(s.after_sqrt_price.toString()):Zt,fromDecimal:s.from_decimal,toDecimal:s.to_decimal,currentPrice:this.calculatePrice(new y(s.current_sqrt_price.toString()),s.from_decimal,s.to_decimal,s.direction,s.label)})),inputAmount:n.input_amount,outputAmount:n.output_amount}))}}async fetchWithTimeout(t,e,n){const i=new AbortController,s=setTimeout(()=>i.abort(),n);try{const o=await fetch(t,{...e,signal:i.signal});return clearTimeout(s),o}catch{return null}}async fetchAndParseData(t,e){try{const i=await this.fetchWithTimeout(t,e,1500);return i.status===200?this.parseJsonResult(await i.json()):null}catch{return null}}async getBestRouter(t,e,n,i,s,o,r,a,c=!1,u=!1,l=[]){let d=null,f="v2",_={},T=this.sdk.sdkOptions.aggregatorUrl;if(l.length>0){const v=new URL(T);T=`${v.protocol}//${v.hostname}/router_with_lp_changes`,_={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({from:t,to:e,amount:n,by_amount_in:i,order_split:c,external_router:u,sender_address:"None",request_id:encodeURIComponent(qh()),lp_changes:l})}}else T=`
      ${T}?from=${encodeURIComponent(t)}&to=${encodeURIComponent(e)}&amount=${encodeURIComponent(n)}&by_amount_in=${encodeURIComponent(i)}&order_split=${encodeURIComponent(c)}&external_router=${encodeURIComponent(u)}&sender_address=''&request_id=${encodeURIComponent(qh())}
      `;if(d=await this.fetchAndParseData(T,_),d!=null&&d.isTimeout||d==null){const v=await this.sdk.Router.price(t,e,new y(n),i,s,o,a),k=[];for(const R of v.paths){const A=[];if(R.poolAddress.length>1){const M=this.sdk.Router.tokenInfo(R.coinType[0]).decimals,K=this.sdk.Router.tokenInfo(R.coinType[1]).decimals,Y=R.a2b[0]?Nt.sqrtPriceX64ToPrice(new y(v.currentSqrtPrice[0]),M,K):Nt.sqrtPriceX64ToPrice(new y(v.currentSqrtPrice[0]),K,M),X={direction:R.a2b[0],label:"Cetus",poolAddress:R.poolAddress[0],fromCoin:R.coinType[0],toCoin:R.coinType[1],feeRate:this.sdk.Router.getFeeRate(R.coinType[0],R.coinType[1],R.poolAddress[0]),outputAmount:v.byAmountIn?R.rawAmountLimit[0].toString():R.rawAmountLimit[1].toString(),inputAmount:R.amountIn.toString(),currentSqrtPrice:v.currentSqrtPrice[0],currentPrice:Y,fromDecimal:M,toDecimal:K},et=this.sdk.Router.tokenInfo(R.coinType[1]).decimals,z=this.sdk.Router.tokenInfo(R.coinType[2]).decimals,O=R.a2b[1]?Nt.sqrtPriceX64ToPrice(new y(v.currentSqrtPrice[1]),et,z):Nt.sqrtPriceX64ToPrice(new y(v.currentSqrtPrice[1]),z,et),$={direction:R.a2b[1],label:"Cetus",poolAddress:R.poolAddress[1],fromCoin:R.coinType[1],toCoin:R.coinType[2],feeRate:this.sdk.Router.getFeeRate(R.coinType[1],R.coinType[2],R.poolAddress[1]),outputAmount:R.amountOut.toString(),inputAmount:v.byAmountIn?R.rawAmountLimit[0].toString():R.rawAmountLimit[1].toString(),currentSqrtPrice:v.currentSqrtPrice[1],currentPrice:O,fromDecimal:et,toDecimal:z};A.push(X,$)}else{const M=this.sdk.Router.tokenInfo(R.coinType[0]).decimals,K=this.sdk.Router.tokenInfo(R.coinType[1]).decimals,Y=R.a2b[0]?Nt.sqrtPriceX64ToPrice(new y(v.currentSqrtPrice[0]),M,K):Nt.sqrtPriceX64ToPrice(new y(v.currentSqrtPrice[0]),K,M),X={direction:R.a2b[0],label:"Cetus",poolAddress:R.poolAddress[0],fromCoin:R.coinType[0],toCoin:R.coinType[1],feeRate:this.sdk.Router.getFeeRate(R.coinType[0],R.coinType[1],R.poolAddress[0]),outputAmount:R.amountOut.toString(),inputAmount:R.amountIn.toString(),currentSqrtPrice:v.currentSqrtPrice[0],currentPrice:Y,fromDecimal:M,toDecimal:K};A.push(X)}const P={percent:Number(R.amountIn)/Number(v.amountIn)*100,inputAmount:Number(R.amountIn.toString()),outputAmount:Number(R.amountOut.toString()),pathIndex:0,lastQuoteOutput:0,basePaths:A};k.push(P)}const U={isExceed:v.isExceed,isTimeout:!0,inputAmount:Number(v.amountIn.toString()),outputAmount:Number(v.amountOut.toString()),fromCoin:v.coinTypeA,toCoin:v.coinTypeC!=null?v.coinTypeC:v.coinTypeB,byAmountIn:v.byAmountIn,splitPaths:k};f="v1",d=U}return{result:d,version:f}}},Dk=class{constructor(t){Ft(this,"_sdk");Ft(this,"_cache",{});this._sdk=t}get sdk(){return this._sdk}setTokenListCache(t){const{coin_list_handle:e}=J(this.sdk.sdkOptions.cetus_config),n=`${e}_getCoinConfigs`,i=this.getCache(n),s=i?[...i,...t]:t;this.updateCache(n,s,Kt)}async getTokenListByCoinTypes(t){const e={},{coin_list_handle:n}=J(this.sdk.sdkOptions.cetus_config),i=`${n}_getCoinConfigs`,s=this.getCache(i);if(s!==void 0){const r=s;for(const a of t)for(const c of r)if(ri(a)===ri(c.address)){e[a]=c;continue}}const o=t.filter(r=>e[r]===void 0);for(const r of o){const a=`${r}_metadata`,c=this.getCache(a);if(c!==void 0)e[r]=c;else{const u=await this._sdk.fullClient.getCoinMetadata({coinType:r});if(u){const l={id:u.id,pyth_id:"",name:u.name,symbol:u.symbol,official_symbol:u.symbol,coingecko_id:"",decimals:u.decimals,project_url:"",logo_url:u.iconUrl,address:r};e[r]=l,this.updateCache(a,l,Kt)}else console.log(`not found ${r}`)}}return e}async getCoinConfigs(t=!1,e=!0){const{coin_list_handle:n}=J(this.sdk.sdkOptions.cetus_config),i=`${n}_getCoinConfigs`,s=this.getCache(i,t);if(s)return s;const r=(await this._sdk.fullClient.getDynamicFieldsByPage(n)).data.map(u=>u.objectId),a=await this._sdk.fullClient.batchGetObjects(r,{showContent:!0}),c=[];return a.forEach(u=>{var d,f;if(u.error!=null||((f=(d=u.data)==null?void 0:d.content)==null?void 0:f.dataType)!=="moveObject")throw new Mt(`when getCoinConfigs get objects error: ${u.error}, please check the rpc and contracts address config.`,"InvalidConfig");const l=this.buildCoinConfig(u,e);this.updateCache(`${n}_${l.address}_getCoinConfig`,l,Kt),c.push({...l})}),this.updateCache(i,c,Kt),c}async getCoinConfig(t,e=!1,n=!0){var c,u;const{coin_list_handle:i}=J(this.sdk.sdkOptions.cetus_config),s=`${i}_${t}_getCoinConfig`,o=this.getCache(s,e);if(o)return o;const r=await this._sdk.fullClient.getDynamicFieldObject({parentId:i,name:{type:"0x1::type_name::TypeName",value:{name:pk(t)}}});if(r.error!=null||((u=(c=r.data)==null?void 0:c.content)==null?void 0:u.dataType)!=="moveObject")throw new Mt(`when getCoinConfig get object error: ${r.error}, please check the rpc and contracts address config.`,"InvalidConfig");const a=this.buildCoinConfig(r,n);return this.updateCache(s,a,Kt),a}buildCoinConfig(t,e=!0){let n=he(t);n=n.value.fields;const i={...n};return i.id=Ri(t),i.address=ht(n.coin_type.fields.name).full_address,n.pyth_id&&(i.pyth_id=Ln(n.pyth_id)),this.transformExtensions(i,n.extension_fields.fields.contents,e),delete i.coin_type,i}async getClmmPoolConfigs(t=!1,e=!0){const{clmm_pools_handle:n}=J(this.sdk.sdkOptions.cetus_config),i=`${n}_getClmmPoolConfigs`,s=this.getCache(i,t);if(s)return s;const r=(await this._sdk.fullClient.getDynamicFieldsByPage(n)).data.map(u=>u.objectId),a=await this._sdk.fullClient.batchGetObjects(r,{showContent:!0}),c=[];return a.forEach(u=>{var d,f;if(u.error!=null||((f=(d=u.data)==null?void 0:d.content)==null?void 0:f.dataType)!=="moveObject")throw new Mt(`when getClmmPoolsConfigs get objects error: ${u.error}, please check the rpc and contracts address config.`,"InvalidConfig");const l=this.buildClmmPoolConfig(u,e);this.updateCache(`${l.pool_address}_getClmmPoolConfig`,l,Kt),c.push({...l})}),this.updateCache(i,c,Kt),c}async getClmmPoolConfig(t,e=!1,n=!0){const{clmm_pools_handle:i}=J(this.sdk.sdkOptions.cetus_config),s=`${t}_getClmmPoolConfig`,o=this.getCache(s,e);if(o)return o;const r=await this._sdk.fullClient.getDynamicFieldObject({parentId:i,name:{type:"address",value:t}}),a=this.buildClmmPoolConfig(r,n);return this.updateCache(s,a,Kt),a}buildClmmPoolConfig(t,e=!0){let n=he(t);n=n.value.fields;const i={...n};return i.id=Ri(t),i.pool_address=Ln(n.pool_address),this.transformExtensions(i,n.extension_fields.fields.contents,e),i}async getLaunchpadPoolConfigs(t=!1,e=!0){const{launchpad_pools_handle:n}=J(this.sdk.sdkOptions.cetus_config),i=`${n}_getLaunchpadPoolConfigs`,s=this.getCache(i,t);if(s)return s;const r=(await this._sdk.fullClient.getDynamicFieldsByPage(n)).data.map(u=>u.objectId),a=await this._sdk.fullClient.batchGetObjects(r,{showContent:!0}),c=[];return a.forEach(u=>{var d,f;if(u.error!=null||((f=(d=u.data)==null?void 0:d.content)==null?void 0:f.dataType)!=="moveObject")throw new Mt(`when getCoinConfigs get objects error: ${u.error}, please check the rpc and contracts address config.`,"InvalidConfig");const l=this.buildLaunchpadPoolConfig(u,e);this.updateCache(`${l.pool_address}_getLaunchpadPoolConfig`,l,Kt),c.push({...l})}),this.updateCache(i,c,Kt),c}async getLaunchpadPoolConfig(t,e=!1,n=!0){const{launchpad_pools_handle:i}=J(this.sdk.sdkOptions.cetus_config),s=`${t}_getLaunchpadPoolConfig`,o=this.getCache(s,e);if(o)return o;const r=await this._sdk.fullClient.getDynamicFieldObject({parentId:i,name:{type:"address",value:t}}),a=this.buildLaunchpadPoolConfig(r,n);return this.updateCache(s,a,Kt),a}buildLaunchpadPoolConfig(t,e=!0){let n=he(t);n=n.value.fields;const i={...n};i.id=Ri(t),i.pool_address=Ln(n.pool_address),this.transformExtensions(i,n.extension_fields.fields.contents,e);const s=[];n.social_media.fields.contents.forEach(o=>{s.push({name:o.fields.value.fields.name,link:o.fields.value.fields.link})}),i.social_media=s;try{i.regulation=decodeURIComponent(Lo.decode(i.regulation).replace(/%/g,"%25"))}catch{i.regulation=Lo.decode(i.regulation)}return i}transformExtensions(t,e,n=!0){const i=[];for(const s of e){const{key:o}=s.fields;let{value:r}=s.fields;if(o==="labels")try{r=JSON.parse(decodeURIComponent(Lo.decode(r)))}catch{}n&&(t[o]=r),i.push({key:o,value:r})}delete t.extension_fields,n||(t.extensions=i)}async getCetusConfig(t=!1){const e=this._sdk.sdkOptions.cetus_config.package_id,n=`${e}_getCetusConfig`,i=this.getCache(n,t);if(i!==void 0)return i;const s=await this._sdk.fullClient.getObject({id:e,options:{showPreviousTransaction:!0}}),o=la(s),r=await this._sdk.fullClient.queryEventsByPage({Transaction:o});let a={coin_list_id:"",launchpad_pools_id:"",clmm_pools_id:"",admin_cap_id:"",global_config_id:"",coin_list_handle:"",launchpad_pools_handle:"",clmm_pools_handle:""};if(r.data.length>0)for(const c of r.data)switch(ht(c.type).name){case"InitCoinListEvent":a.coin_list_id=c.parsedJson.coin_list_id;break;case"InitLaunchpadPoolsEvent":a.launchpad_pools_id=c.parsedJson.launchpad_pools_id;break;case"InitClmmPoolsEvent":a.clmm_pools_id=c.parsedJson.pools_id;break;case"InitConfigEvent":a.global_config_id=c.parsedJson.global_config_id,a.admin_cap_id=c.parsedJson.admin_cap_id;break}return a=await this.getCetusConfigHandle(a),a.clmm_pools_id.length>0&&this.updateCache(n,a,Kt),a}async getCetusConfigHandle(t){const e=[t.clmm_pools_id,t.coin_list_id,t.launchpad_pools_id];return(await this._sdk.fullClient.multiGetObjects({ids:e,options:{showContent:!0}})).forEach(i=>{var r,a;if(i.error!=null||((a=(r=i.data)==null?void 0:r.content)==null?void 0:a.dataType)!=="moveObject")throw new Mt(`when getCetusConfigHandle get objects error: ${i.error}, please check the rpc and contracts address config.`,"InvalidConfigHandle");const s=he(i),o=Ys(i);switch(ht(o).name){case"ClmmPools":t.clmm_pools_handle=s.pools.fields.id.id;break;case"CoinList":t.coin_list_handle=s.coins.fields.id.id;break;case"LaunchpadPools":t.launchpad_pools_handle=s.pools.fields.id.id;break}}),t}updateCache(t,e,n=gi){let i=this._cache[t];i?(i.overdueTime=on(n),i.value=e):i=new Yn(e,on(n)),this._cache[t]=i}getCache(t,e=!1){try{const n=this._cache[t];if(!n)return;if(e||!n.isValid()){delete this._cache[t];return}return n.value}catch(n){console.error(`Error accessing cache for key ${t}:`,n);return}}},Lk=class extends R_{async queryEventsByPage(t,e="all"){let n=[],i=!0;const s=e==="all";let o=s?null:e.cursor;do{const r=await this.queryEvents({query:t,cursor:o,limit:s?null:e.limit});r.data?(n=[...n,...r.data],i=r.hasNextPage,o=r.nextCursor):i=!1}while(s&&i);return{data:n,nextCursor:o,hasNextPage:i}}async getOwnedObjectsByPage(t,e,n="all"){let i=[],s=!0;const o=n==="all";let r=o?null:n.cursor;do{const a=await this.getOwnedObjects({owner:t,...e,cursor:r,limit:o?null:n.limit});a.data?(i=[...i,...a.data],s=a.hasNextPage,r=a.nextCursor):s=!1}while(o&&s);return{data:i,nextCursor:r,hasNextPage:s}}async getDynamicFieldsByPage(t,e="all"){let n=[],i=!0;const s=e==="all";let o=s?null:e.cursor;do{const r=await this.getDynamicFields({parentId:t,cursor:o,limit:s?null:e.limit});r.data?(n=[...n,...r.data],i=r.hasNextPage,o=r.nextCursor):i=!1}while(s&&i);return{data:n,nextCursor:o,hasNextPage:i}}async batchGetObjects(t,e,n=50){let i=[];try{for(let s=0;s<Math.ceil(t.length/n);s++){const o=await this.multiGetObjects({ids:t.slice(s*n,n*(s+1)),options:e});i=[...i,...o]}}catch(s){console.log(s)}return i}async calculationTxGas(t){const{sender:e}=t.blockData;if(e===void 0)throw Error("sdk sender is empty");const n=await this.devInspectTransactionBlock({transactionBlock:t,sender:e}),{gasUsed:i}=n.effects;return Number(i.computationCost)+Number(i.storageCost)-Number(i.storageRebate)}async sendTransaction(t,e){try{return await this.signAndExecuteTransactionBlock({transactionBlock:e,signer:t,options:{showEffects:!0,showEvents:!0}})}catch(n){console.log("error: ",n)}}async sendSimulationTransaction(t,e,n=!0){try{if(n)return await this.devInspectTransactionBlock({transactionBlock:t,sender:e});const s={ProgrammableTransaction:{inputs:t.blockData.inputs.map(c=>{const{type:u,value:l}=c;return u==="object"?U_.SharedObjectRef({objectId:l,initialSharedVersion:0,mutable:!0}):l}),transactions:t.blockData.transactions}},o=Yu.TransactionKind.serialize(s,{maxSize:131072}).toBytes(),r=$_(o);return await this.transport.request({method:"sui_devInspectTransactionBlock",params:[e,r,null,null]})}catch(i){console.log("devInspectTransactionBlock error",i)}}},Zi=class{constructor(t){Ft(this,"_cache",{});Ft(this,"_rpcModule");Ft(this,"_pool");Ft(this,"_position");Ft(this,"_swap");Ft(this,"_rewarder");Ft(this,"_router");Ft(this,"_router_v2");Ft(this,"_token");Ft(this,"_config");Ft(this,"_sdkOptions");Ft(this,"_senderAddress","");this._sdkOptions=t,this._rpcModule=new Lk({url:t.fullRpcUrl}),this._swap=new $k(this),this._pool=new Ik(this),this._position=new Ok(this),this._rewarder=new Rk(this),this._router=new Uk(this),this._router_v2=new Mk(this),this._token=new qk(this),this._config=new Dk(this),Td(this._sdkOptions)}get senderAddress(){return this._senderAddress}set senderAddress(t){this._senderAddress=t}get Swap(){return this._swap}get fullClient(){return this._rpcModule}get sdkOptions(){return this._sdkOptions}get Pool(){return this._pool}get Position(){return this._position}get Rewarder(){return this._rewarder}get Router(){return this._router}get RouterV2(){return this._router_v2}get CetusConfig(){return this._config}get Token(){return this._token}async getOwnerCoinAssets(t,e,n=!0){const i=[];let s=null;const o=`${this.sdkOptions.fullRpcUrl}_${t}_${e}_getOwnerCoinAssets`,r=this.getCache(o,n);if(r)return r;for(;;){const a=await(e?this.fullClient.getCoins({owner:t,coinType:e,cursor:s}):this.fullClient.getAllCoins({owner:t,cursor:s}));if(a.data.forEach(c=>{BigInt(c.balance)>0&&i.push({coinAddress:ht(c.coinType).source_address,coinObjectId:c.coinObjectId,balance:BigInt(c.balance)})}),s=a.nextCursor,!a.hasNextPage)break}return this.updateCache(o,i,30*1e3),i}async getOwnerCoinBalances(t,e){let n=[];return e?n=[await this.fullClient.getBalance({owner:t,coinType:e})]:n=[...await this.fullClient.getAllBalances({owner:t})],n}updateCache(t,e,n=Kt){let i=this._cache[t];i?(i.overdueTime=on(n),i.value=e):i=new Yn(e,on(n)),this._cache[t]=i}getCache(t,e=!1){const n=this._cache[t],i=n==null?void 0:n.isValid();if(!e&&i)return n.value;i||delete this._cache[t]}},Nk=Zi,Xu="router",Io=1e4,ws=class{static buildPoolImmutables(t){const{fields:e}=t.value.fields.value;return{clmm_pool_id:ht(e.clmm_pool_id).address,booster_type:ht(e.booster_type.fields.name).source_address,pool_id:ht(e.pool_id).address,coinTypeA:ht(e.coin_type_a.fields.name).source_address,coinTypeB:ht(e.coin_type_b.fields.name).source_address}}static buildPoolState(t){const e=he(t),n=[];return e.config.fields.contents.forEach(s=>{n.push({lock_day:Number(s.fields.key),multiplier:Number(D(s.fields.value).div(Io))})}),{basic_percent:Number(D(e.basic_percent).div(Io)),balances:{balances_handle:e.balances.fields.id.id,size:e.balances.fields.size},config:n,lock_positions:{lock_positions_handle:e.lock_positions.fields.id.id,size:e.lock_positions.fields.size},is_open:e.is_open,index:Number(e.index),pool_id:Ri(t)}}static buildLockNFT(t){const e=ht(Ri(t)).address;return{lock_clmm_position:Gs(t),locked_nft_id:e}}static buildLockPositionInfo(t){const e=he(t),{value:n}=e.value.fields;return{type:n.type,position_id:n.fields.position_id,start_time:Number(n.fields.start_time),lock_period:Number(n.fields.lock_period),end_time:Number(n.fields.end_time),growth_rewarder:n.fields.growth_rewarder,rewarder_owned:n.fields.rewarder_owned,is_settled:n.fields.is_settled}}static isLocked(t){return t.end_time>Date.parse(new Date().toString())/1e3}},Fk=class{constructor(t){Ft(this,"_sdk");Ft(this,"_cache",{});this._sdk=t}get sdk(){return this._sdk}async getPoolImmutables(t=!1){var o;const{booster:e}=this._sdk.sdkOptions,n=`${e.package_id}_getPoolImmutables`,i=this.getCache(n,t),s=[];if(i!==void 0)s.push(...i);else{const r=[];(o=(await this._sdk.ClmmSDK.fullClient.getDynamicFieldsByPage(J(e).booster_pool_handle)).data)==null||o.forEach(u=>{r.push(u.objectId)});const c=await this._sdk.ClmmSDK.fullClient.batchGetObjects(r,{showContent:!0});for(const u of c){const l=he(u);if(l){const d=ws.buildPoolImmutables(l);this.updateCache(`${d.pool_id}_getPoolImmutable`,d,Kt),s.push(d)}}}return this.updateCache(n,s,Kt),s}async getPoolImmutable(t){const{booster:e}=this._sdk.sdkOptions,n=`${t}_getPoolImmutable`,i=this.getCache(n);if(i!==void 0)return i;const s=await this._sdk.ClmmSDK.fullClient.getDynamicFieldObject({parentId:J(e).booster_pool_handle,name:{type:"0x2::object::ID",value:t}}),o=he(s),r=ws.buildPoolImmutables(o);return this.updateCache(n,r,Kt),r}async getPools(){const t=[],n=(await this.getPoolImmutables()).map(s=>s.pool_id),i=await this._sdk.ClmmSDK.fullClient.batchGetObjects(n,{showType:!0,showContent:!0});for(const s of i){const o=ws.buildPoolState(s);if(o){const r={...await this.getPoolImmutable(o.pool_id),...o};t.push(r);const a=`${r.pool_id}_getPoolObject`;this.updateCache(a,r,Kt)}}return t}async getPool(t,e=!0){const n=`${t}_getPoolObject`,i=this.getCache(n,e),s=await this.getPoolImmutable(t);if(i!==void 0)return{...s,...i};const o=await this._sdk.ClmmSDK.fullClient.getObject({id:t,options:{showContent:!0,showType:!0}}),r=ws.buildPoolState(o),a={...s,...r};return this.updateCache(n,a,Kt),a}async getPoolHandleId(t){const e=await this._sdk.ClmmSDK.fullClient.getObject({id:t,options:{showContent:!0}}),n=he(e);return n?n.list.fields.id.id:""}async getBoosterInitConfigs(){var i;const{package_id:t}=this.sdk.sdkOptions.booster,e=(i=await this._sdk.ClmmSDK.fullClient.queryEventsByPage({MoveEventType:`${t}::config::InitEvent`}))==null?void 0:i.data,n={booster_config_id:"",booster_pool_handle:""};return e.length>0&&e.forEach(s=>{const o=s.parsedJson;o&&(n.booster_config_id=o.config_id)}),n.booster_pool_handle=await this.getPoolHandleId(n.booster_config_id),n}async getOwnerBoosterPositions(t,e,n){const{booster:i}=this.sdk.sdkOptions,s=[],o=[],r=`${i.package_id}::lock_nft::LockNFT<${this._sdk.ClmmSDK.Position.buildPositionType()}>`,a=await this._sdk.ClmmSDK.fullClient.getOwnedObjectsByPage(t,{options:{showType:!0,showContent:!0,showOwner:!0},filter:{StructType:r}});for(const u of a.data)if(ht(qi(u)).source_address===r&&u.data){const d=ws.buildLockNFT(u);this.updateCache(`${d.locked_nft_id}_getBoosterPositionById`,d,Kt),d&&(e===void 0||e===d.lock_clmm_position.pool)&&s.push(d)}const c=await this.getLockPositionInfos(n,s.map(u=>u.locked_nft_id));for(const u of s)for(const l of c)if(u.lock_clmm_position.pos_object_id===l.position_id){o.push({...u,...l});break}return o}async getBoosterPosition(t,e){const n=`${e}_getBoosterPositionById`,i=this.getCache(n);let s;if(i!==void 0)s=i;else{const r=await this._sdk.ClmmSDK.fullClient.getObject({id:e,options:{showContent:!0,showOwner:!0}});s=ws.buildLockNFT(r),this.updateCache(n,s,Kt)}const o=await this.getLockPositionInfo(t,e);return{...s,...o}}async getLockPositionInfos(t,e=[]){var o;const n=await this._sdk.ClmmSDK.fullClient.getDynamicFieldsByPage(t),i=[],s=[];return(o=n.data)==null||o.forEach(r=>{e.length>0?e.includes(r.name.value)&&i.push(r.objectId):i.push(r.objectId)}),i.length>0&&(await this._sdk.ClmmSDK.fullClient.batchGetObjects(i,{showContent:!0})).forEach(a=>{const c=ws.buildLockPositionInfo(a);c&&s.push(c)}),s}async getLockPositionInfo(t,e){const n=await this._sdk.ClmmSDK.fullClient.getDynamicFieldObject({parentId:t,name:{type:"0x2::object::ID",value:e}});return ws.buildLockPositionInfo(n)}calculateXCetusRewarder(t,e,n){let i=e.basic_percent,s="0";t.forEach(a=>{a.coin_address===e.booster_type&&(console.log("find ",e.booster_type),s=a.amount_owed.toString())}),n.is_settled||e.config.forEach(a=>{a.lock_day===n.lock_period&&(i=a.multiplier)});const o=D(s).sub(n.growth_rewarder).mul(i);return D(n.rewarder_owned).add(o).toString()}lockPositionPayload(t){const{booster:e}=this.sdk.sdkOptions,{clmm_pool:n}=this.sdk.ClmmSDK.sdkOptions,i=new vt;return i.moveCall({target:`${e.published_at}::${Xu}::lock_position`,typeArguments:[t.booster_type,t.coinTypeA,t.coinTypeB],arguments:[i.pure(J(e).booster_config_id),i.pure(J(n).global_config_id),i.pure(t.booster_pool_id),i.pure(t.clmm_pool_id),i.pure(t.clmm_position_id),i.pure(t.lock_day),i.pure(Bt)]}),i}canceLockPositionPayload(t){const{booster:e}=this.sdk.sdkOptions,n=new vt;return n.moveCall({target:`${e.published_at}::${Xu}::cancel_lock`,typeArguments:[t.booster_type],arguments:[n.pure(J(e).booster_config_id),n.pure(t.booster_pool_id),n.pure(t.lock_nft_id),n.pure(Bt)]}),n}redeemPayload(t){const{booster:e,xcetus:n}=this.sdk.sdkOptions,{clmm_pool:i}=this.sdk.ClmmSDK.sdkOptions,s=new vt,o=J(n);return s.moveCall({target:`${e.published_at}::${Xu}::redeem`,typeArguments:[t.booster_type,t.coinTypeA,t.coinTypeB],arguments:[s.pure(J(e).booster_config_id),s.pure(J(i).global_config_id),s.pure(t.booster_pool_id),s.pure(t.lock_nft_id),s.pure(t.clmm_pool_id),s.pure(o.lock_manager_id),s.pure(o.xcetus_manager_id),s.pure(t.ve_nft_id),s.pure(Bt)]}),s}updateCache(t,e,n=gi){let i=this._cache[t];i?(i.overdueTime=on(n),i.value=e):i=new Yn(e,on(n)),this._cache[t]=i}getCache(t,e=!1){const n=this._cache[t];if(!e&&(n!=null&&n.isValid()))return n.value;delete this._cache[t]}},ii="router",T_=1e9,Zn=class{static priceRealToFix(t,e,n){const i=D(e-n).toNumber();return Number(D(t).div(D(10).pow(D(i))).toString())}static priceFixToReal(t,e,n){const i=D(e-n).toNumber();return Number(D(t).mul(D(10).pow(D(i))).toString())}static raiseTotalAmount(t,e,n){const i=D(e-n).abs().toNumber();return e>n?Number(D(t.total_supply).mul(t.current_price).div(D(10).pow(D(i))).toString()):Number(D(t.total_supply).mul(t.current_price).mul(D(10).pow(D(i))).toString())}static buildLaunchPadPool(t){const e=qi(t),n=ht(e),i=he(t),s={coin_type_sale:n.type_arguments[0],coin_type_raise:n.type_arguments[1],pool_address:Ln(Ri(t)),is_settle:i.is_settle,current_price:D(i.initialize_price).div(D(T_)).toString(),price:i.initialize_price,min_price:"0",max_price:"0",sale_coin_amount:i.sale_coin,raise_coin_amount:i.raise_coin,total_purchase_amount:i.reality_raise_total,total_supply:i.sale_total,min_purchase:i.min_purchase,max_purchase:i.max_purchase,complete_raise_limit:i.least_raise_amount,softcap:i.softcap,max_raise_amount:i.hardcap,sale_decimals:0,raise_decimals:0,liquidity_injection_ratio:Number(i.liquidity_rate)/1e4,is_cancel:i.is_cancel,duration_summary:{start_time:Number(i.duration_manager.fields.start_time),end_time:0,settle_end_time:0,purchase_duration:Number(i.duration_manager.fields.activity_duration),settle_duration:Number(i.duration_manager.fields.settle_duration),lock_up_duration:Number(i.duration_manager.fields.locked_duration)},white_summary:{white_handle:i.white_list.fields.users.fields.id.id,protection_hard_cap:i.white_list.fields.hard_cap_total,protection_limit_used:i.white_list.fields.purchase_total,size:Number(i.white_list.fields.users.fields.size)},unused_sale:i.unused_sale,harvest_raise:i.harvest_raise,tick_spacing:Number(i.tick_spacing),owner:i.recipient,purchase_summary:{purchase_handle:i.purchase_list.fields.id.id,size:Number(i.purchase_list.fields.size)},pool_status:"Failed"};return Zn.updatePoolStatus(s),s}static updatePoolStatus(t){const e=Number(D(Date.now()/1e3).toFixed(0)),{duration_summary:n}=t,i=n.start_time+n.purchase_duration,s=i+n.settle_duration;if(n.end_time=i,n.settle_end_time=s,t.is_settle)t.pool_status="Ended";else if(t.is_cancel)t.pool_status="Canceled";else if(e<n.start_time)t.pool_status="Upcoming";else if(e>n.start_time&&e<i)t.pool_status="Live";else if(e>i&&e<s){const o=t.raise_coin_amount;Number(o)<Number(t.complete_raise_limit)?t.pool_status="Failed":t.pool_status="Settle"}return t}static async calculatePoolPrice(t,e){const n=await t.ClmmSDK.CetusConfig.getTokenListByCoinTypes([e.coin_type_sale,e.coin_type_raise]),i=n[e.coin_type_sale].decimals,s=n[e.coin_type_raise].decimals;e.min_price=this.priceFixToReal(Number(D(e.softcap).div(D(e.total_supply))),i,s).toString(),e.max_price=this.priceFixToReal(Number(D(e.max_raise_amount).div(D(e.total_supply))),i,s).toString(),e.current_price=this.priceFixToReal(Number(e.current_price),i,s).toString(),e.sale_decimals=i,e.raise_decimals=s}static async getWithdrawRaise(t){return t.pool_status==="Ended"?t.harvest_raise:"0"}static async getWithdrawSale(t){return t.pool_status==="Ended"?t.unused_sale:t.sale_coin_amount}static async getHistoryWithdrawRaise(t,e){if(e.pool_status==="Ended"){if(D(e.harvest_raise).equals(D(0))){const i=await t.Launchpad.getSettleEvent(e.pool_address);i&&(e.harvest_raise=i.unused_raise)}const n=y.min(new y(e.total_purchase_amount),new y(e.max_raise_amount));return D(n.toString()).mul(1-e.liquidity_injection_ratio).toString()}return"0"}static async getHistoryWithdrawSale(t,e){if(e.pool_status==="Ended"){const n=await t.Launchpad.getSettleEvent(e.pool_address);return n&&(e.unused_sale=n.unused_sale),e.unused_sale}return"0"}static async getOverrecruitReverseAmount(t,e){const n=await t.Launchpad.getPurchaseMarks(t.ClmmSDK.senderAddress,[e.pool_address],!1);if(n.length>0){const i=n[0].purchased_raise_amount,s=(await t.Launchpad.getPurchaseAmount(e.white_summary.white_handle,t.ClmmSDK.senderAddress)).safe_purchased_amount,{protection_limit_used:o}=e.white_summary;return D(i).sub(s).div(D(e.total_purchase_amount).sub(o)).mul(D(e.total_purchase_amount).sub(e.max_raise_amount)).toString()}return"0"}static async getCanPurchaseAmount(t,e){const n=await Zn.getOverrecruitReverseAmount(t,e),i=await t.Launchpad.getPurchaseMarks(t.ClmmSDK.senderAddress,[e.pool_address],!1);if(i){const s=i[0].purchased_raise_amount;D(s).sub(n).div(e.current_price)}return"0"}},jk=class{constructor(t){Ft(this,"_sdk");Ft(this,"_cache",{});this._sdk=t}get sdk(){return this._sdk}async getPoolImmutables(t=[],e=0,n=100,i=!1){var l;const{package_id:s}=this._sdk.sdkOptions.launchpad;if(s===void 0)throw Error("sdk.sdkOptions.launchpad is undefined");const o=`${s}_getPoolImmutables`,r=this.getCache(o,i),a=[],c=[];if(r!==void 0&&a.push(...r),a.length===0)try{((l=await this._sdk.ClmmSDK.fullClient.queryEventsByPage({MoveEventType:`${s}::factory::CreatePoolEvent`}))==null?void 0:l.data).forEach(f=>{const _=f.parsedJson;_&&a.push({pool_address:_.pool_id,coin_type_sale:ht(_.sale_coin.name).full_address,coin_type_raise:ht(_.raise_coin.name).full_address})}),this.updateCache(o,a,Kt)}catch(d){console.log("getPoolImmutables",d)}const u=t.length>0;for(let d=0;d<a.length;d+=1){const f=a[d];if(!(u&&!t.includes(f.pool_address))){if(!u){const _=d;if(_<e||_>=e+n)continue}c.push(f)}}return c}async getPoolImmutablesWithPage(t="all",e=!1){const{package_id:n}=this._sdk.sdkOptions.launchpad,i=`${n}_getPoolImmutables`,s=[],o={data:[],hasNextPage:!1},r=t==="all";if(r){const a=this.getCache(i,e);a&&s.push(...a)}if(s.length===0)try{const a=await this._sdk.ClmmSDK.fullClient.queryEventsByPage({MoveEventType:`${n}::factory::CreatePoolEvent`},t);o.hasNextPage=a.hasNextPage,o.nextCursor=a.nextCursor,a.data.forEach(c=>{const u=c.parsedJson;u&&s.push({pool_address:u.pool_id,coin_type_sale:ht(u.sale_coin.name).full_address,coin_type_raise:ht(u.raise_coin.name).full_address})})}catch(a){console.log("getPoolImmutables",a)}return o.data=s,r&&this.updateCache(i,s,Kt),o}async getPools(t=[],e=0,n=100){const i=[];let s=[];t.length>0?s=[...t]:(await this.getPoolImmutables([],e,n,!1)).forEach(a=>{s.push(a.pool_address)});const o=await this._sdk.ClmmSDK.fullClient.batchGetObjects(s,{showType:!0,showContent:!0});for(const r of o){const a=Zn.buildLaunchPadPool(r);await Zn.calculatePoolPrice(this._sdk,a),i.push(a);const c=`${a.pool_address}_getPoolObject`;this.updateCache(c,a,Kt)}return i}async getPool(t,e=!0){const n=`${t}_getPoolObject`,i=this.getCache(n,e);if(i!==void 0){const r=i;return Zn.updatePoolStatus(r),r}const s=await this._sdk.ClmmSDK.fullClient.getObject({id:t,options:{showContent:!0,showType:!0}}),o=Zn.buildLaunchPadPool(s);return await Zn.calculatePoolPrice(this._sdk,o),this.updateCache(n,o),o}async getInitConfig(t=!1){var c;const e=this._sdk.sdkOptions.launchpad.package_id,n=`${e}_getInitEvent`,i=this.getCache(n,t);if(i!==void 0)return i;const s=await this._sdk.ClmmSDK.fullClient.getObject({id:e,options:{showPreviousTransaction:!0}}),o=la(s),r=(c=await this._sdk.ClmmSDK.fullClient.queryEventsByPage({Transaction:o}))==null?void 0:c.data,a={pools_id:"",admin_cap_id:"",config_cap_id:""};return r.length>0&&(r.forEach(u=>{const l=u.parsedJson;if(l)switch(ht(u.type).full_address){case`${e}::config::InitConfigEvent`:a.admin_cap_id=l.admin_cap_id,a.config_cap_id=l.config_cap_id;break;case`${e}::factory::InitFactoryEvent`:a.pools_id=l.pools_id;break}}),this.updateCache(n,a,Kt)),a}async getLockNFT(t,e=!1){const n=`${t}_getLockNFT`,i=this.getCache(n,e);if(i!==void 0)return i;const s=await this._sdk.ClmmSDK.fullClient.getObject({id:t,options:{showType:!0,showContent:!0,showDisplay:!0,showOwner:!0}});if(!s.error)return Gs(s)}async getLockNFTList(t){var s;const{package_id:e}=this._sdk.ClmmSDK.sdkOptions.clmm_pool,{sdkOptions:n}=this._sdk,i=[];try{const o=(s=await this._sdk.ClmmSDK.fullClient.queryEventsByPage({MoveEventType:`${n.launchpad.package_id}::lock::LockNFTEvent`}))==null?void 0:s.data;for(const r of o){const a=r.parsedJson;if(a){const c={locked_time:Number(a.locked_time),end_lock_time:Number(a.end_lock_time),nft_type:a.nft_type_name.name,lock_nft_id:a.lock_nft_id,recipient:a.recipient};if(t===c.recipient&&`${e}`===ht(c.nft_type).address){const u=await this.getLockNFT(c.lock_nft_id);if(u){const l=ht(u.coin_type_a).full_address,d=ht(u.coin_type_b).full_address;i.push({...u,coin_type_a:l,coin_type_b:d,...c})}}}}return i}catch(o){return console.log("getLockNFTList:",o),[]}}async creatPoolTransactionPayload(t){const{launchpad:e}=this.sdk.sdkOptions,n=J(e);if(this.assertLuanchpadConfig(),this._sdk.ClmmSDK.senderAddress.length===0)throw Error("this config sdk senderAddress is empty");const i=Zn.priceRealToFix(Number(t.initialize_price),t.sale_decimals,t.raise_decimals),s=new vt,o=D(t.total_supply).add(D(t.total_supply).mul(D(t.liquidity_rate))).toNumber(),r=await ye.syncBuildCoinInputForAmount(this._sdk.ClmmSDK,s,BigInt(o),t.coin_type_sale),a=[s.pure(n.admin_cap_id),s.pure(n.config_cap_id),s.pure(n.pools_id),s.pure(Jn(t.recipient)),s.pure((i*T_).toString()),r,s.pure(t.total_supply.toString()),s.pure(t.min_purchase.toString()),s.pure(t.max_purchase.toString()),s.pure(t.least_raise_amount.toString()),s.pure(t.hardcap.toString()),s.pure((t.liquidity_rate*1e3).toString()),s.pure(t.start_time.toString()),s.pure(t.activity_duration.toString()),s.pure(t.settle_duration.toString()),s.pure(t.locked_duration.toString()),s.pure(t.tick_spacing.toString()),s.pure(Bt)],c=[t.coin_type_sale,t.coin_type_raise];return s.moveCall({target:`${e.published_at}::${ii}::create_launch_pool`,typeArguments:c,arguments:a}),s}async creatPurchasePayload(t){const{launchpad:e}=this.sdk.sdkOptions;if(this._sdk.ClmmSDK.senderAddress.length===0)throw Error("this config sdk senderAddress is empty");const n=new vt,i=await ye.syncBuildCoinInputForAmount(this._sdk.ClmmSDK,n,BigInt(t.purchase_amount),t.coin_type_raise),s=(await this.getPurchaseMarks(this._sdk.ClmmSDK.senderAddress,[t.pool_address],!1))[0],o=[t.coin_type_sale,t.coin_type_raise];let r;return s?r=[n.pure(t.pool_address),n.pure(J(e).config_cap_id),n.pure(s.id),i,n.pure(t.purchase_amount.toString()),n.pure(Bt)]:r=[n.pure(t.pool_address),n.pure(J(e).config_cap_id),i,n.pure(t.purchase_amount.toString()),n.pure(Bt)],n.moveCall({target:`${e.published_at}::${ii}::${s===void 0?"create_and_purchase":"purchase"}`,typeArguments:o,arguments:r}),n}async creatClaimPayload(t){const{launchpad:e}=this.sdk.sdkOptions;if(this._sdk.ClmmSDK.senderAddress.length===0)throw Error("this config sdk senderAddress is empty");const n=(await this.getPurchaseMarks(this._sdk.ClmmSDK.senderAddress,[t.pool_address],!1))[0],i=new vt,s=[t.coin_type_sale,t.coin_type_raise],o=[i.pure(t.pool_address),i.pure(J(e).config_cap_id),i.pure(n==null?void 0:n.id),i.pure(Bt)];return i.moveCall({target:`${e.published_at}::${ii}::claim`,typeArguments:s,arguments:o}),i}async creatSettlePayload(t){const{launchpad:e}=this.sdk.sdkOptions,{clmm_pool:n}=this.sdk.ClmmSDK.sdkOptions;if(this._sdk.ClmmSDK.senderAddress.length===0)throw Error("this config sdk senderAddress is empty");this.assertLuanchpadConfig();const i=J(n),{clmm_args:s}=t,o=new vt;o.setSender(this.sdk.ClmmSDK.senderAddress);const r=[t.coin_type_sale,t.coin_type_raise];if(s){const a=s.opposite?Nt.priceToSqrtPriceX64(D(1).div(s.current_price),s.raise_decimals,s.sale_decimals).toString():Nt.priceToSqrtPriceX64(D(s.current_price),s.sale_decimals,s.raise_decimals).toString(),c=BigInt(a)<BigInt(s.clmm_sqrt_price),u=s.opposite?c?t.coin_type_raise:t.coin_type_sale:c?t.coin_type_sale:t.coin_type_raise,l=await this._sdk.ClmmSDK.getOwnerCoinAssets(this._sdk.ClmmSDK.senderAddress,u);let d=Ze.calculateTotalBalance(l);Ze.isSuiCoin(u)&&(d-=BigInt(2e8));const _=ye.buildCoinForAmount(o,l,d,u).targetCoin,T=s.opposite?c?"settle_with_reverse_clmm_only_with_a":"settle_with_reverse_clmm_only_with_b":c?"settle_only_with_a":"settle_only_with_b",v=[o.pure(t.pool_address),o.pure(J(e).config_cap_id),o.pure(s.clmm_pool_address),o.pure(i.global_config_id),o.pure(a),_,o.pure(Bt)];o.moveCall({target:`${e.published_at}::${ii}::${T}`,typeArguments:r,arguments:v})}else o.moveCall({target:`${e.published_at}::${ii}::settle`,typeArguments:r,arguments:[o.pure(t.pool_address),o.pure(J(e).config_cap_id),o.pure(Bt)]});return o}creatWithdrawPayload(t){const{launchpad:e}=this.sdk.sdkOptions,n=new vt,i=[t.coin_type_sale,t.coin_type_raise],s=[n.object(t.pool_address),n.object(J(e).config_cap_id),n.object(Bt)];return t.sale_amount>BigInt(0)&&n.moveCall({target:`${e.published_at}::${ii}::withdraw_sale`,typeArguments:i,arguments:s}),t.raise_amount>BigInt(0)&&n.moveCall({target:`${e.published_at}::${ii}::withdraw_raise`,typeArguments:i,arguments:s}),n}addUserToWhitelisPayload(t){const{launchpad:e}=this.sdk.sdkOptions;this.assertLuanchpadConfig();const n=new vt,i=[t.coin_type_sale,t.coin_type_raise];return t.user_addrs.forEach(s=>{const o=[n.object(J(e).admin_cap_id),n.object(J(e).config_cap_id),n.object(t.pool_address),n.object(s),n.pure(t.safe_limit_amount),n.object(Bt)];n.moveCall({target:`${e.published_at}::${ii}::add_user_to_whitelist`,typeArguments:i,arguments:o})}),n}updateWhitelistCapPayload(t){const{launchpad:e}=this.sdk.sdkOptions;this.assertLuanchpadConfig();const n=new vt,i=[t.coin_type_sale,t.coin_type_raise];return t.safe_limit_amount>0&&n.moveCall({target:`${e.published_at}::${ii}::update_whitelist_member_safe_limit_amount`,typeArguments:i,arguments:[n.object(J(e).admin_cap_id),n.object(J(e).config_cap_id),n.object(t.pool_address),n.pure(t.white_list_member),n.pure(t.safe_limit_amount),n.object(Bt)]}),t.hard_cap_total>0&&n.moveCall({target:`${e.published_at}::${ii}::update_whitelist_hard_cap_total`,typeArguments:i,arguments:[n.object(J(e).admin_cap_id),n.object(J(e).config_cap_id),n.object(t.pool_address),n.pure(t.hard_cap_total),n.object(Bt)]}),n}creatRemoveWhitelistPayload(t){const{launchpad:e}=this.sdk.sdkOptions;this.assertLuanchpadConfig();const n=new vt,i=[t.coin_type_sale,t.coin_type_raise];return t.user_addrs.forEach(s=>{const o=[n.object(J(e).admin_cap_id),n.object(J(e).config_cap_id),n.object(t.pool_address),n.object(s),n.object(Bt)];n.moveCall({target:`${e.published_at}::${ii}::remove_user_from_whitelist`,typeArguments:i,arguments:o})}),n}creatCancelPoolPayload(t){const{launchpad:e}=this.sdk.sdkOptions;this.assertLuanchpadConfig();const n=new vt,i=[t.coin_type_sale,t.coin_type_raise],s=[n.pure(J(e).admin_cap_id),n.pure(J(e).config_cap_id),n.pure(t.pool_address),n.pure(Bt)];return n.moveCall({target:`${e.published_at}::${ii}::cancel`,typeArguments:i,arguments:s}),n}updateRecipientPayload(t){const{launchpad:e}=this.sdk.sdkOptions;this.assertLuanchpadConfig();const n=new vt,i=[t.coin_type_sale,t.coin_type_raise],s=[n.pure(J(e).admin_cap_id),n.pure(J(e).config_cap_id),n.pure(t.pool_address),n.pure(t.new_recipient),n.pure(Bt)];return n.moveCall({target:`${e.published_at}::${ii}::update_recipient_address`,typeArguments:i,arguments:s}),n}updatePoolDuractionPayload(t){const{launchpad:e}=this.sdk.sdkOptions;this.assertLuanchpadConfig();const n=new vt,i=[t.coin_type_sale,t.coin_type_raise],s=[n.pure(J(e).admin_cap_id),n.pure(J(e).config_cap_id),n.pure(t.pool_address),n.pure(t.activity_duration),n.pure(t.settle_duration),n.pure(t.lock_duration),n.pure(Bt)];return n.moveCall({target:`${e.published_at}::${ii}::update_pool_duration`,typeArguments:i,arguments:s}),n}creatUnlockNftPayload(t){const{launchpad:e}=this.sdk.sdkOptions;if(J(e)===void 0)throw Error("getPackagerConfigs(launchpad)  is null");const n=new vt,i=[t.nft_type],s=[n.pure(t.lock_nft),n.pure(Bt)];return n.moveCall({target:`${e.published_at}::lock::unlock_nft`,typeArguments:i,arguments:s}),n}async isAdminCap(t){const{launchpad:e}=this._sdk.sdkOptions;if(J(e)===void 0)throw Error("launchpad config is empty");const n=`${t}_isAdminCap`,i=this.getCache(n);if(i)return i;const s=await this._sdk.ClmmSDK.fullClient.getObject({id:J(e).admin_cap_id,options:{showType:!0,showOwner:!0}});console.log(s);const o=Ys(s),r=cc(s);let a=!1;return r&&o&&ht(o).source_address===`${e.package_id}::config::AdminCap`&&(a=Jn(r.AddressOwner)===Jn(t)),this.updateCache(n,a,Kt),a}async isWhiteListUser(t,e){const n={type:"address",value:e};try{const i=await this._sdk.ClmmSDK.fullClient.getDynamicFieldObject({parentId:t,name:n});return!!(i&&i.data)}catch{return!1}}async getPurchaseAmount(t,e){var i;const n={type:"address",value:e};try{const s=await this._sdk.ClmmSDK.fullClient.getDynamicFieldObject({parentId:t,name:n}),o=he(s);if(console.log(o),o)return(i=o==null?void 0:o.value)==null?void 0:i.fields}catch{}return{safe_limit_amount:"0",safe_purchased_amount:"0"}}async getPurchaseMarks(t,e=[],n=!0){const{launchpad:i}=this._sdk.sdkOptions,s=`${e}_getPurchaseMark`,o=this.getCache(s,n);if(!n&&o!==void 0)return o;let r=null;const a=[];for(;;){const c=await this._sdk.ClmmSDK.fullClient.getOwnedObjects({owner:t,options:{showType:!0,showContent:!0,showDisplay:!0},cursor:r});for(const u of c.data){const{fields:l}=u.data.content;if(ht(qi(u)).source_address===`${i.package_id}::pool::PurchaseMark`){console.log("fields: ",l);const f={id:l.id.id,pool_id:ht(l.pool_id).address,purchased_raise_amount:l.purchase_total,obtain_sale_amount:l.obtain_sale_amount,used_raise_amount:l.used_raise_amount};e.length>0?e.includes(f.pool_id)&&a.push(f):a.push(f)}}if(c.hasNextPage)r=c.nextCursor;else break}return this.updateCache(s,a,Kt),a}async getSettleEvent(t){const{launchpad:e}=this._sdk.sdkOptions,n=`${t}_getPurchaseMark`,i=this.getCache(n);if(i!==void 0)return i;const s=await this._sdk.ClmmSDK.fullClient.queryEventsByPage({MoveEventType:`${e.package_id}::pool::SettleEvent`});for(const o of s.data){const r=o.parsedJson;if(t===Ln(r.pool_id)){const a={pool_id:r.pool_id,settle_price:r.settle_price,unused_sale:r.unused_sale,unused_raise:r.unused_raise,white_purchase_total:r.white_purchase_total};return this.updateCache(n,a,Kt),a}}}buildLaunchpadCoinType(t,e){return rc(this._sdk.sdkOptions.launchpad.package_id,"pool","PoolLiquidityCoin",[t,e])}assertLuanchpadConfig(){const{launchpad:t}=this.sdk.sdkOptions;if(J(t)===void 0)throw Error("sdk getPackagerConfigs(launchpad) is null")}updateCache(t,e,n=gi){let i=this._cache[t];i?(i.overdueTime=on(n),i.value=e):i=new Yn(e,on(n)),this._cache[t]=i}getCache(t,e=!1){const n=this._cache[t];if(!e&&(n!=null&&n.isValid()))return n.value;delete this._cache[t]}},bs=class{static buildPoolImmutables(t){const{fields:e}=t.value.fields.value;return{clmm_pool_id:ht(e.clmm_pool_id).address,bonus_type:ht(e.bonus_type.fields.name).source_address,pool_id:ht(e.pool_id).address,coinTypeA:ht(e.coin_type_a.fields.name).source_address,coinTypeB:ht(e.coin_type_b.fields.name).source_address}}static buildPoolState(t){const e=he(t),n=[];return e.config.fields.contents.forEach(s=>{n.push({rate:Number(D(s.fields.key).div(Io)),multiplier:Number(D(s.fields.value).div(Io))})}),{balance:e.balance,config:n,is_open:e.is_open,index:Number(e.index),start_time:Number(e.start_time),interval_day:Number(e.interval_day),minimum_percent_to_reward:Number(D(e.minimum_percent_to_reward).div(Io)),rewarders:{rewarder_handle:e.rewarders.fields.id.id,size:Number(e.rewarders.fields.size)},whale_nfts:{whale_nfts_handle:e.whale_nfts.fields.id.id,size:Number(e.whale_nfts.fields.size)},points:{point_handle:e.points.fields.id.id,size:Number(e.points.fields.size)}}}static buildMarkerPositions(t){const{contents:e}=t.value.fields.value.fields,n=[],i=t.id.id;return e.forEach(s=>{const{key:o,value:r}=s.fields,a={id:o,period_id:i,bonus_num:r.fields.bonus_num,point:r.fields.point,is_burn:r.fields.is_burn,point_after_multiplier:r.fields.point_after_multiplier,percent:Number(D(r.fields.percent).div(Io)),fee_share_rate:0,is_redeemed:r.fields.is_redeemed};n.push(a)}),n}static buildPoolBonusInfo(t){const{fields:e,type:n}=t.value.fields.value;return{type:n,time:Number(e.time),settle_time:Number(e.settle_time),settled_num:e.settled_num,is_settled:e.is_settled,basis_bonus:e.basis_bonus,total_bonus:e.total_bonus,is_vacant:e.is_vacant,redeemed_num:e.redeemed_num}}static getBonusPercent(t,e){let n=0;for(const i of t)e>=i.rate&&i.rate>n&&(n=i.multiplier);return n}},jh="router",zk=class{constructor(t){Ft(this,"_sdk");Ft(this,"_cache",{});this._sdk=t}get sdk(){return this._sdk}async getPoolImmutables(t=!1){var o;const{maker_bonus:e}=this._sdk.sdkOptions,n=`${e.package_id}_getPoolImmutables`,i=this.getCache(n,t),s=[];if(i!==void 0)s.push(...i);else{const r=[];(o=(await this._sdk.ClmmSDK.fullClient.getDynamicFieldsByPage(J(e).maker_pool_handle)).data)==null||o.forEach(u=>{r.push(u.objectId)});const c=await this._sdk.ClmmSDK.fullClient.batchGetObjects(r,{showContent:!0});for(const u of c){const l=he(u);l&&s.push(bs.buildPoolImmutables(l))}}return s}async getPoolImmutable(t){const{maker_bonus:e}=this._sdk.sdkOptions,n=`${e.package_id}_getPoolImmutables`,i=this.getCache(n);if(i!==void 0){const r=i.filter(a=>t===a.pool_id);if(r.length>0)return r[0]}const s=await this._sdk.ClmmSDK.fullClient.getDynamicFieldObject({parentId:J(e).maker_pool_handle,name:{type:"0x2::object::ID",value:t}}),o=he(s);return bs.buildPoolImmutables(o)}async getPools(){const t=[],e=await this.getPoolImmutables(),n=e.map(o=>o.pool_id),i=await this._sdk.ClmmSDK.fullClient.batchGetObjects(n,{showType:!0,showContent:!0});let s=0;for(const o of i){const r=bs.buildPoolState(o);if(r){const a={...e[s],...r};t.push(a);const c=`${a.pool_id}_getPoolObject`;this.updateCache(c,a,Kt)}s+=1}return t}async getPool(t,e=!0){const n=`${t}_getPoolObject`,i=this.getCache(n,e),s=await this.getPoolImmutable(t);if(i!==void 0)return i;const o=await this._sdk.ClmmSDK.fullClient.getObject({id:t,options:{showContent:!0,showType:!0}}),r=bs.buildPoolState(o),a={...s,...r};return this.updateCache(n,a,Kt),a}async getPoolHandleId(t){const e=await this._sdk.ClmmSDK.fullClient.getObject({id:t,options:{showContent:!0}}),n=he(e);return n?n.list.fields.id.id:""}async getMakerPoolPeriods(t,e=!1){const n=[],i=`${t.pool_id}_getMakerPoolPeriods`,s=this.getCache(i,e);return s!==void 0?s:((await this._sdk.ClmmSDK.fullClient.getDynamicFieldsByPage(t.whale_nfts.whale_nfts_handle)).data.forEach(r=>{const a={id:r.objectId,start_time:0,end_time:0,period:Number(r.name.value)};a.start_time=Number(D(t.start_time).add(D(t.interval_day).mul(24*3600).mul(a.period)).toFixed(0,it.ROUND_DOWN)),a.end_time=Number(D(a.start_time).add(D(t.interval_day).mul(24*3600)).toFixed(0,it.ROUND_DOWN)),n.push(a)}),this.updateCache(i,n,Kt),n)}async getMakerBonusInitConfigs(){var i;const{package_id:t}=this.sdk.sdkOptions.maker_bonus,e=(i=await this._sdk.ClmmSDK.fullClient.queryEventsByPage({MoveEventType:`${t}::config::InitEvent`}))==null?void 0:i.data,n={maker_config_id:"",maker_pool_handle:""};return e.length>0&&e.forEach(s=>{const o=s.parsedJson;o&&(n.maker_config_id=o.config_id)}),n.maker_pool_handle=await this.getPoolHandleId(n.maker_config_id),n}async getPoolMarkerPositionList(t,e,n=!1){const i={},s=[];n||e.forEach(o=>{const r=`${t}_${o.period}_getPoolMarkerPositionList`,a=this.getCache(r);a!==void 0?i[o.period]=a:(i[o.period]=[],s.push(o))});try{s.length>0&&(await this._sdk.ClmmSDK.fullClient.batchGetObjects(s.map(a=>a.id),{showContent:!0})).forEach(a=>{const c=he(a),u=bs.buildMarkerPositions(c);if(u.length>0){const{period_id:l}=u[0],d=e.filter(f=>f.id===l)[0];i[d.period]=u}});const o=[];for(const r in i)i[r].forEach(c=>{o.push(c)});if(o.length>0){const r=await this._sdk.ClmmSDK.Position.getSipmlePositionList(o.map(a=>a.id));for(const a of o)for(const c of r)if(a.id===c.pos_object_id){a.clmm_position=c;break}}}catch(o){console.log(o)}for(const o in i){const r=`${t}_${o}_getPoolMarkerPositionList`;this.updateCache(r,i[o],Kt)}return i}async updateXCetusRewarderAndFee(t,e,n){const i=await this.calculateTotalPointsAfterMultiper(t,n);for(const s of e)await this.calculateXCetusRewarder(t,s,n.period,i);return e}async calculateXCetusRewarder(t,e,n,i){const s=await this.getPoolBonusInfo(t.rewarders.rewarder_handle,n),{fee_share_rate:o}=this.calculateFeeShareRate(t,e,i),r=D(o).mul(s.total_bonus);return e.is_redeemed?e.bonus_num="0":e.bonus_num=r.toString(),e.bonus_num}calculateFeeShareRate(t,e,n){const i=bs.getBonusPercent(t.config,e.percent),s=D(e.point).mul(i),o=D(s).div(n);return e.point_after_multiplier=s.toString(),e.fee_share_rate=Number(o),{fee_share_rate:Number(o),points_after_multiper:s.toString()}}async calculateTotalPointsAfterMultiper(t,e){const n=await this.getPoolMarkerPositionList(t.whale_nfts.whale_nfts_handle,[e]);let i=D(0);const s=n[e.period];for(const o of s){const r=bs.getBonusPercent(t.config,o.percent),a=D(o.point).mul(r);i=i.add(a)}return i.toString()}async calculateAllXCetusRewarder(t){const e=this._sdk.ClmmSDK.senderAddress;let n=D(0);const i=[];for(const s of t){const o=await this._sdk.MakerModule.getMakerPoolPeriods(s),r=await this._sdk.MakerModule.getPoolMarkerPositionList(s.whale_nfts.whale_nfts_handle,o),a=[];for(const c of o){const u=r[c.period].filter(l=>{var d;return e.length===0?!1:((d=l.clmm_position)==null?void 0:d.owner)===e});u.length>0&&(await this._sdk.MakerModule.updateXCetusRewarderAndFee(s,u,c),u.forEach(l=>{var d;((d=l.clmm_position)==null?void 0:d.position_status)===p_.Exists&&D(l.bonus_num).greaterThan(0)&&(n=n.add(l.bonus_num),a.includes(l.clmm_position.pos_object_id)||a.push(l.clmm_position.pos_object_id))}))}i.push({bonus_type:s.bonus_type,pool_id:s.pool_id,nft_ids:a})}return{claimtotal:n,claimRecord:i}}async getPoolBonusInfo(t,e,n=!1){const i=`${t}_${e}_getPoolBonusInfo`,s=this.getCache(i,n);if(s!==void 0)return s;const o=await this.sdk.ClmmSDK.fullClient.getDynamicFieldObject({parentId:t,name:{type:"u64",value:e.toString()}}),r=he(o),a=bs.buildPoolBonusInfo(r);return this.updateCache(i,a,gi),a}claimPayload(t){const{maker_bonus:e,xcetus:n}=this.sdk.sdkOptions,i=new vt;return i.moveCall({target:`${e.published_at}::${jh}::claim`,typeArguments:[t.bonus_type],arguments:[i.pure(J(e).maker_config_id),i.pure(t.market_pool_id),i.pure(t.position_nft_id),i.pure(t.phase),i.pure(J(n).lock_manager_id),i.pure(J(n).xcetus_manager_id),i.pure(t.ve_nft_id)]}),i}claimAllPayload(t){const{maker_bonus:e,xcetus:n}=this.sdk.sdkOptions,i=new vt;return t.whale_nfts.forEach(s=>{s.nft_ids.forEach(o=>{i.moveCall({target:`${e.published_at}::${jh}::claim_all`,typeArguments:[s.bonus_type],arguments:[i.object(J(e).maker_config_id),i.object(s.pool_id),i.object(o),i.object(J(n).lock_manager_id),i.object(J(n).xcetus_manager_id),i.object(t.ve_nft_id)]})})}),i}updateCache(t,e,n=gi){let i=this._cache[t];i?(i.overdueTime=on(n),i.value=e):i=new Yn(e,on(n)),this._cache[t]=i}getCache(t,e=!1){const n=this._cache[t];if(!e&&(n!=null&&n.isValid()))return n.value;delete this._cache[t]}},wo="router",Vu="router",Or=24*3600,lc=1e3,Ai=1e11,Us=class{static buildVeNFTDividendInfo(t){const e={id:t.id.id,ve_nft_id:t.name,rewards:[]};return t.value.fields.value.fields.dividends.fields.contents.forEach(n=>{const i=[];n.fields.value.fields.contents.forEach(s=>{i.push({coin_type:ht(s.fields.key.fields.name).source_address,amount:s.fields.value})}),e.rewards.push({period:Number(n.fields.key),rewards:i})}),e}static buildDividendManager(t){const e={id:t.id.id,dividends:{id:t.dividends.fields.id.id,size:t.dividends.fields.size},venft_dividends:{id:t.venft_dividends.fields.id.id,size:t.venft_dividends.fields.size},bonus_types:[],start_time:Number(t.start_time),interval_day:Number(t.interval_day),balances:{id:t.balances.fields.id.id,size:t.balances.fields.size},is_open:t.is_open};return t.bonus_types.forEach(n=>{e.bonus_types.push(ht(n.fields.name).source_address)}),e}static buildLockUpManager(t){return{id:t.id.id,balance:t.balance,treasury_manager:t.treasury_manager,extra_treasury:t.extra_treasury,lock_infos:{lock_handle_id:t.lock_infos.fields.id.id,size:Number(t.lock_infos.fields.size)},type_name:ri(t.type_name.fields.name),min_lock_day:Number(t.min_lock_day),max_lock_day:Number(t.max_lock_day),package_version:Number(t.package_version),max_percent_numerator:Number(t.max_percent_numerator),min_percent_numerator:Number(t.min_percent_numerator)}}static buildLockCetus(t){const e=t.fields,n={id:e.id.id,type:ht(t.type).source_address,locked_start_time:Number(e.locked_start_time),locked_until_time:Number(e.locked_until_time),cetus_amount:e.balance,xcetus_amount:"0",lock_day:0};return n.lock_day=(n.locked_until_time-n.locked_start_time)/Or,n}static getAvailableXCetus(t,e){let n=D(0);return e.forEach(i=>{n=n.add(i.xcetus_amount)}),D(t.xcetus_balance).sub(n).toString()}static getWaitUnLockCetuss(t){return t.filter(e=>!Us.isLocked(e))}static getLockingCetuss(t){return t.filter(e=>Us.isLocked(e))}static isLocked(t){return t.locked_until_time>Date.parse(new Date().toString())/1e3}static buildDividendRewardTypeList(t){const e=new Set;return t.forEach(n=>{n.rewards.forEach(i=>{e.add(i.coin_type)})}),Array.from(e)}static getNextStartTime(t){const e=Date.now()/1e3,{start_time:n,interval_day:i}=t,s=Math.ceil((e-n)/(i*Or));return n+s*i*Or}},Hk=class{constructor(t){Ft(this,"_sdk");Ft(this,"_cache",{});this._sdk=t}get sdk(){return this._sdk}async getOwnerVeNFT(t,e=!0){const{xcetus:n}=this.sdk.sdkOptions,i=`${t}_getLockUpManagerEvent`,s=this.getCache(i,e);if(s!==void 0)return s;let o;const r=`${n.package_id}::xcetus::VeNFT`;return(await this._sdk.ClmmSDK.fullClient.getOwnedObjectsByPage(t,{options:{showType:!0,showContent:!0,showDisplay:!0},filter:{StructType:r}})).data.forEach(c=>{const u=ht(qi(c)).source_address;if(u===r&&c.data&&c.data.content){const{fields:l}=c.data.content;o={...wu(c),id:l.id.id,index:l.index,type:u,xcetus_balance:l.xcetus_balance},this.updateCache(i,o,Kt)}}),o}async getOwnerLockCetuss(t){const{xcetus:e}=this.sdk.sdkOptions,n=[],i=`${e.package_id}::lock_coin::LockedCoin<${this.buileCetusCoinType()}>`,s=await this._sdk.ClmmSDK.fullClient.getOwnedObjectsByPage(t,{options:{showType:!0,showContent:!0},filter:{StructType:i}});for(const o of s.data)if(ht(qi(o)).source_address===i&&o.data){const a=Us.buildLockCetus(o.data.content);a.xcetus_amount=await this.getXCetusAmount(a.id),n.push(a)}return n}async getLockCetus(t){var n;const e=await this._sdk.ClmmSDK.fullClient.getObject({id:t,options:{showType:!0,showContent:!0}});if((n=e.data)!=null&&n.content){const i=Us.buildLockCetus(e.data.content);return i.xcetus_amount=await this.getXCetusAmount(i.id),i}}async getOwnerCetusCoins(t){return await this._sdk.ClmmSDK.getOwnerCoinAssets(t,this.buileCetusCoinType())}mintVeNFTPayload(){const{xcetus:t}=this.sdk.sdkOptions,e=new vt;return e.moveCall({target:`${t.published_at}::${wo}::mint_venft`,typeArguments:[],arguments:[e.pure(J(t).xcetus_manager_id)]}),e}async convertPayload(t){const{xcetus:e}=this.sdk.sdkOptions,n=new vt,i=this.buileCetusCoinType(),s=await ye.syncBuildCoinInputForAmount(this._sdk.ClmmSDK,n,BigInt(t.amount),i);return t.venft_id===void 0?n.moveCall({target:`${e.published_at}::${wo}::mint_and_convert`,typeArguments:[],arguments:[n.object(J(e).lock_manager_id),n.object(J(e).xcetus_manager_id),s,n.pure(t.amount)]}):n.moveCall({target:`${e.published_at}::${wo}::convert`,typeArguments:[],arguments:[n.object(J(e).lock_manager_id),n.object(J(e).xcetus_manager_id),s,n.pure(t.amount),n.pure(t.venft_id)]}),n}redeemLockPayload(t){const{xcetus:e}=this.sdk.sdkOptions,n=new vt;return n.moveCall({target:`${e.published_at}::${wo}::redeem_lock`,typeArguments:[],arguments:[n.pure(J(e).lock_manager_id),n.pure(J(e).xcetus_manager_id),n.pure(t.venft_id),n.pure(t.amount),n.pure(t.lock_day),n.pure(Bt)]}),n}redeemPayload(t){const{xcetus:e}=this.sdk.sdkOptions,n=new vt;return n.moveCall({target:`${e.published_at}::${wo}::redeem`,typeArguments:[],arguments:[n.pure(J(e).lock_manager_id),n.pure(J(e).xcetus_manager_id),n.pure(t.venft_id),n.pure(t.lock_id),n.pure(Bt)]}),n}redeemDividendPayload(t,e){const{xcetus:n,xcetus_dividends:i}=this.sdk.sdkOptions,s=new vt;return e.forEach(o=>{s.moveCall({target:`${n.published_at}::${Vu}::redeem`,typeArguments:[o],arguments:[s.object(J(i).dividend_manager_id),s.object(t)]})}),s}redeemDividendV2Payload(t,e,n){const{xcetus_dividends:i}=this.sdk.sdkOptions;let s=new vt;return e.filter(r=>n.includes(r)).length>0&&(s=this.redeemDividendXTokenPayload(t,s)),e.forEach(r=>{n.includes(r)||s.moveCall({target:`${i.published_at}::${Vu}::redeem_v2`,typeArguments:[r],arguments:[s.object(J(i).dividend_manager_id),s.object(t),s.object(Bt)]})}),s}redeemDividendXTokenPayload(t,e){const{xcetus_dividends:n,xcetus:i}=this.sdk.sdkOptions,{xcetus_manager_id:s,lock_manager_id:o}=J(i),{dividend_manager_id:r}=J(n);return e=e===void 0?new vt:e,e.moveCall({target:`${n.published_at}::${Vu}::redeem_xtoken`,typeArguments:[],arguments:[e.object(o),e.object(s),e.object(r),e.object(t),e.object(Bt)]}),e}buileCetusCoinType(){return`${this.sdk.sdkOptions.cetus_faucet.package_id}::cetus::CETUS`}buileXTokenCoinType(t=this._sdk.sdkOptions.xcetus.package_id,e="xcetus",n="XCETUS"){return`${t}::${e}::${n}`}cancelRedeemPayload(t){const{xcetus:e}=this.sdk.sdkOptions,n=new vt;return n.moveCall({target:`${e.published_at}::${wo}::cancel_redeem_lock`,typeArguments:[],arguments:[n.pure(J(e).lock_manager_id),n.pure(J(e).xcetus_manager_id),n.pure(t.venft_id),n.pure(t.lock_id),n.pure(Bt)]}),n}async getInitConfigs(){var r,a;const{package_id:t}=this.sdk.sdkOptions.xcetus,e=`${t}_getInitFactoryEvent`,n=this.getCache(e);if(n!==void 0)return n;const i=(r=await this._sdk.ClmmSDK.fullClient.queryEventsByPage({MoveEventType:`${t}::xcetus::InitEvent`}))==null?void 0:r.data,s={xcetus_manager_id:"",lock_manager_id:"",lock_handle_id:""};i.length>0&&i.forEach(c=>{const u=c.parsedJson;u&&(s.xcetus_manager_id=u.xcetus_manager)});const o=(a=await this._sdk.ClmmSDK.fullClient.queryEventsByPage({MoveEventType:`${t}::locking::InitializeEvent`}))==null?void 0:a.data;return o.length>0&&o.forEach(c=>{const u=c.parsedJson;u&&(s.lock_manager_id=u.lock_manager)}),s.lock_manager_id.length>0&&(s.lock_handle_id=(await this.getLockUpManager(s.lock_manager_id)).lock_infos.lock_handle_id),this.updateCache(e,s,Kt),s}async getLockUpManager(t=J(this.sdk.sdkOptions.xcetus).lock_manager_id,e=!1){const n=`${t}_getLockUpManager`,i=this.getCache(n,e);if(i!==void 0)return i;const s=await this.sdk.ClmmSDK.fullClient.getObject({id:t,options:{showContent:!0}}),o=Us.buildLockUpManager(he(s));return this.updateCache(n,o,Kt),o}async getDividendConfigs(){var o;const{package_id:t}=this.sdk.sdkOptions.xcetus_dividends,e=`${t}_getDividendManagerEvent`,n=this.getCache(e);if(n!==void 0)return n;const i=(o=await this._sdk.ClmmSDK.fullClient.queryEventsByPage({MoveEventType:`${t}::dividend::InitEvent`}))==null?void 0:o.data,s={dividend_manager_id:"",dividend_admin_id:"",dividend_settle_id:""};return i.length>0&&i.forEach(r=>{const a=r.parsedJson;a&&(s.dividend_manager_id=a.manager_id,s.dividend_admin_id=a.admin_id,s.dividend_settle_id=a.settle_id,this.updateCache(e,s,Kt))}),s}async getDividendManager(t=!1){const{dividend_manager_id:e}=J(this._sdk.sdkOptions.xcetus_dividends),n=`${e}_getDividendManager`,i=this.getCache(n,t);if(i!==void 0)return i;const s=await this._sdk.ClmmSDK.fullClient.getObject({id:e,options:{showContent:!0}}),o=he(s),r=Us.buildDividendManager(o);return this.updateCache(n,r,Kt),r}async getXcetusManager(t=!0){const{xcetus_manager_id:e}=J(this._sdk.sdkOptions.xcetus),n=`${e}_getXcetusManager`,i=this.getCache(n,t);if(i)return i;const s=await this._sdk.ClmmSDK.fullClient.getObject({id:e,options:{showContent:!0}}),o=he(s),r={id:o.id.id,index:Number(o.index),has_venft:{handle:o.has_venft.fields.id.id,size:o.has_venft.fields.size},nfts:{handle:o.nfts.fields.id.id,size:o.nfts.fields.size},total_locked:o.total_locked,treasury:o.treasury.fields.total_supply.fields.value};return this.updateCache(n,r),r}async getVeNFTDividendInfo(t,e){try{const n=await this._sdk.ClmmSDK.fullClient.getDynamicFieldObject({parentId:t,name:{type:"0x2::object::ID",value:e}}),i=he(n);return Us.buildVeNFTDividendInfo(i)}catch{return}}async redeemNum(t,e){if(BigInt(t)===BigInt(0))return{amountOut:"0",percent:"0"};const n=await this.getLockUpManager(J(this._sdk.sdkOptions.xcetus).lock_manager_id),i=D(Ai).mul(D(n.max_lock_day).sub(D(e))).mul(D(n.max_percent_numerator).sub(D(n.min_percent_numerator))).div(D(n.max_lock_day).sub(D(n.min_lock_day))),s=D(Ai).mul(D(n.max_percent_numerator)).sub(i).div(D(lc)).div(Ai);return{amountOut:D(s).mul(D(t)).round().toString(),percent:s.toString()}}async reverseRedeemNum(t,e){if(BigInt(t)===BigInt(0))return{amountOut:"0",percent:"0"};const n=await this.getLockUpManager(J(this._sdk.sdkOptions.xcetus).lock_manager_id),i=D(Ai).mul(D(n.max_lock_day).sub(D(e))).mul(D(n.max_percent_numerator).sub(D(n.min_percent_numerator))).div(D(n.max_lock_day).sub(D(n.min_lock_day))),s=D(Ai).mul(D(n.max_percent_numerator)).sub(i).div(D(lc)).div(Ai);return{amountOut:D(t).div(s).toFixed(0,it.ROUND_UP),percent:s.toString()}}async getXCetusAmount(t){const{lock_handle_id:e}=J(this._sdk.sdkOptions.xcetus),n=`${t}_getXCetusAmount`,i=this.getCache(n);if(i!==void 0)return i;try{const s=await this.sdk.ClmmSDK.fullClient.getDynamicFieldObject({parentId:e,name:{type:"0x2::object::ID",value:t}}),o=he(s);if(o){const{xcetus_amount:r}=o.value.fields.value.fields;return this.updateCache(n,r,Kt),r}}catch{}return"0"}async getVeNftAmount(t,e){try{const n=await this.sdk.ClmmSDK.fullClient.getDynamicFieldObject({parentId:t,name:{type:"0x2::object::ID",value:e}}),i=he(n);if(i){const{lock_amount:s,xcetus_amount:o}=i.value.fields.value.fields;return{lock_amount:s,xcetus_amount:o}}}catch{}return{lock_amount:"0",xcetus_amount:"0"}}async getPhaseDividendInfo(t,e=!1){const i=(await this.getDividendManager()).dividends.id,s=`${i}_${t}_getPhaseDividendInfo`,o=this._sdk.getCache(s,e);if(o)return o;try{const r=await this._sdk.ClmmSDK.fullClient.getDynamicFieldObject({parentId:i,name:{type:"u64",value:t}}),a=he(r),c=a.value.fields.value.fields,u=c.redeemed_num.fields.contents.map(_=>({name:_.fields.key.fields.name,value:_.fields.value})),l=c.bonus_types.map(_=>_.fields.name),d=c.bonus.fields.contents.map(_=>({name:_.fields.key.fields.name,value:_.fields.value})),f={id:Ri(r),phase:a.name,settled_num:c.settled_num,register_time:c.register_time,redeemed_num:u,is_settled:c.is_settled,bonus_types:l,bonus:d,phase_end_time:""};return this.updateCache(s,f),f}catch{}}updateCache(t,e,n=gi){let i=this._cache[t];i?(i.overdueTime=on(n),i.value=e):i=new Yn(e,on(n)),this._cache[t]=i}getCache(t,e=!1){const n=this._cache[t];if(!e&&(n!=null&&n.isValid()))return n.value;delete this._cache[t]}},Kk="factory",_i="oversubscribe_pool",A_=1e6,ko=1e18,bo="router",Ju="router",ka="router",zh={curve:{strategy:3,both_side:{div_width:10,ratios:[.333333,.266666,.2,.133333,.066666]},one_side:{div_width:5,ratios:[.333333,.266666,.2,.133333,.066666]}},bidAsk:{strategy:4,both_side:{div_width:10,ratios:[.172413793,.137931034,.103448276,.068965517,.034482759,.068965517,.103448276,.137931034,.172413793]},one_side:{div_width:5,ratios:[.066666667,.13333333,.2,.266666667,.333333333]}}};function Gk(t){return"master_address"in t}var Wk="router",Xk="vaults",Vk=1e4,On=class{static buildIdoPoolImmutables(t){return{pool_address:Ln(t.pool_id),coin_type_sale:ht(t.sale_coin_type.name).full_address,coin_type_raise:ht(t.raise_coin_type.name).full_address,tick_spacing:Number(t.tick_spacing),total_supply:t.total_supply,min_purchase:t.min_purchase_amount,max_purchase:t.max_purchase_amount}}static buildIdoPool(t){const e=qi(t),n=ht(e),i=he(t);console.log("fields:",i);const s={pool_address:Ln(i.id.id),coin_type_sale:n.type_arguments[0],coin_type_raise:n.type_arguments[1],tick_spacing:Number(i.tick_spacing),total_supply:i.total_supply,min_purchase:i.min_purchase_amount,max_purchase:i.max_purchase_amount},o={start_time:Number(i.duration_manager.fields.start_time),lock_up_duration:Number(i.duration_manager.fields.lock_up_duration),purchase_duration:Number(i.duration_manager.fields.purchase_duration),end_time:0};o.end_time=o.start_time+o.purchase_duration;const r={complete_raise_limit:i.complete_raise_limit,liquidity_injection_ratio:D(i.liquidity_injection_ratio).div(A_).toNumber(),current_sqrt_price_min:i.current_sqrt_price_min,current_sqrt_price_max:i.current_sqrt_price_max,owner:i.owner,sale_coin_amount:i.sale_coin,raise_coin_amount:i.raise_coin,price:i.price,current_price:i.price,duration_summary:o,is_cancelled:i.is_cancelled,is_liquidity_injected:i.is_liquidity_injected,liquidity_used_raise_amount:i.liquidity_used_raise_amount,liquidity_used_sale_amount:i.liquidity_used_sale_amount,purchase_summary:{size:Number(i.purchase_manager.fields.purchases.fields.size),purchase_handle:i.purchase_manager.fields.purchases.fields.id.id},total_purchase_amount:i.total_purchase_amount,white_summary:{white_list_id:i.white_list.fields.id.id,protection_limit_used:i.white_list.fields.protection_limit_used,protection_hard_cap:i.white_list.fields.protection_hard_cap,white_handle:i.white_list.fields.addresses.fields.id.id,size:Number(i.white_list.fields.addresses.fields.size)},pool_status:"Upcoming",max_raise_amount:"",sale_decimals:0,raise_decimals:0,is_withdrawn:i.is_withdrawn};return On.updatePoolStatus(r),{...s,...r}}static is_init_period(t){return Number(D(Date.now()/1e3).toFixed(0))<t.start_time}static is_purchase_period(t){const e=Number(D(Date.now()/1e3).toFixed(0));return e>=t.start_time&&e<=t.start_time+t.purchase_duration}static is_claim_period(t){const e=Number(D(Date.now()/1e3).toFixed(0)),n=t.start_time+t.purchase_duration;return e>n}static is_can_inject_liquidity(t){return!t.is_cancelled&&t.liquidity_injection_ratio!==0&&On.is_claim_period(t.duration_summary)&&!t.is_liquidity_injected}static is_can_withdraw(t){return t.is_withdrawn?!1:On.is_sale_failed(t)?!0:(t.liquidity_injection_ratio===0||t.is_liquidity_injected)&&On.is_claim_period(t.duration_summary)}static is_sale_failed(t){return!!(t.is_cancelled||On.is_claim_period(t.duration_summary)&&D(t.total_purchase_amount).lessThan(t.complete_raise_limit))}static buildPurchaseInfo(t){return{...t.value.fields.value.fields,owner:t.name}}static calculateRedeemAmount(t,e){let n,i;if(On.is_sale_failed(t))n="0",i="0";else if(e.is_redeemed)n=e.obtained_sale_amount,i=e.used_raise_amount;else if(D(t.total_purchase_amount).lessThanOrEqualTo(t.max_raise_amount))n=D(e.purchased_raise_amount).mul(ko).div(t.price).toString(),i=e.purchased_raise_amount;else{const o=On.redeemForSaleOversubcribeV2(t,e);n=o.user_obtained_sale_amount,i=o.user_used_raise_amount_ceil}n=it.floor(n);const s=it.floor(D(e.purchased_raise_amount).sub(i).toString());return{obtained_sale_amount:n,refunded_raise_amount:s}}static calculateWithdrawAmount(t){let e,n;const i=D(t.total_supply).mul(t.liquidity_injection_ratio);if(On.is_sale_failed(t))e="0",n=D(i).add(t.total_supply);else{const{max_raise_amount:s}=t;D(t.total_purchase_amount).greaterThanOrEqualTo(s)?(e=D(s).sub(t.liquidity_used_raise_amount).toString(),n="0"):(e=D(t.total_purchase_amount).sub(t.liquidity_used_raise_amount),n=D(t.total_supply).add(i).sub(t.liquidity_used_sale_amount).sub(On.get_sold_amount(t)))}return{obtained_raise_amount:it.floor(e).toString(),refunded_sale_amount:it.ceil(n).toString()}}static get_sold_amount(t){return D(t.total_purchase_amount).greaterThanOrEqualTo(t.max_raise_amount)?t.total_supply:D(t.total_purchase_amount).mul(ko).div(t.price)}static redeemForSaleOversubcribe(t,e){const n=e.protection_raise_amount,i=D(e.purchased_raise_amount).sub(n),s=t.max_raise_amount,{protection_limit_used:o}=t.white_summary,r=D(s).sub(o),a=D(t.total_purchase_amount).sub(o),c=it.ceil(i.mul(r).div(a).add(n)),u=it.floor(i.mul(r).div(a).add(n));return{user_obtained_sale_amount:it.floor(D(t.total_supply).mul(u).div(s)),user_used_raise_amount_ceil:c}}static redeemForSaleOversubcribeV2(t,e){const n=e.protection_raise_amount,i=D(e.purchased_raise_amount).sub(n),s=t.max_raise_amount,{protection_limit_used:o}=t.white_summary,r=D(s).sub(o),a=D(t.total_purchase_amount).sub(o),c=D(n).mul(a).add(D(i).mul(r)).mul(ko).div(D(a).mul(t.price)),u=it.ceil(c.mul(t.price).div(ko));return{user_obtained_sale_amount:c,user_used_raise_amount_ceil:u}}static raiseTotalAmount(t){const e=D(t.sale_decimals-t.raise_decimals).abs().toNumber();return t.sale_decimals>t.raise_decimals?D(t.total_supply).mul(t.current_price).div(D(10).pow(D(e))).toString():D(t.total_supply).mul(t.current_price).mul(D(10).pow(D(e))).toString()}static updatePoolStatus(t){const e=Number(D(Date.now()/1e3).toFixed(0)),n=t.duration_summary,i=n.start_time+n.purchase_duration;t.is_cancelled?t.pool_status="Canceled":e<n.start_time?t.pool_status="Upcoming":e>n.start_time&&e<i?t.pool_status="Live":D(t.total_purchase_amount).lessThan(t.complete_raise_limit)?t.pool_status="Failed":t.pool_status="Ended"}static async calculatePoolUiPrice(t,e){const n=await t.ClmmSDK.CetusConfig.getTokenListByCoinTypes([e.coin_type_sale,e.coin_type_raise]),i=n[e.coin_type_sale].decimals,s=n[e.coin_type_raise].decimals;e.current_price=Zn.priceFixToReal(Number(D(e.price).div(D(ko)).toString()),i,s).toString(),e.sale_decimals=i,e.raise_decimals=s,e.max_raise_amount=this.raiseTotalAmount(e)}},D3=class{constructor(t){Ft(this,"_sdk");this._sdk=t}async getPools(t=[],e=!1){const n=[];if(t.length>0){if(t.filter(s=>{const o=`${s}_getPool`,r=this._sdk.getCache(o,e);return r?(n.push(r),!1):!0}).length>0){const s=await this._sdk.ClmmSDK.fullClient.batchGetObjects(t,{showType:!0,showContent:!0});for(const o of s){const r=await this.buildIdoWarpPool(o);r&&n.push(r)}}}else(await this._sdk.Ido.getPools()).forEach(s=>{n.push({...s,version:"2"})});return n.forEach(i=>{const s=`${i.pool_address}_getPool`;this._sdk.updateCache(s,i)}),n}async getPool(t,e=!0){const n=`${t}_getPool`,i=this._sdk.getCache(n,e);if(i)return i;const s=await this._sdk.ClmmSDK.fullClient.getObject({id:t,options:{showContent:!0,showType:!0}}),o=await this.buildIdoWarpPool(s);return this._sdk.updateCache(n,o),o}async getJoinPools(t,e){const n=[],i=e.filter(o=>o.version==="1"),s=e.filter(o=>o.version==="2");if(i.length>0){const o=await this._sdk.Launchpad.getPurchaseMarks(t,i.map(r=>r.pool_address),!1);i.forEach(r=>{for(const a of o)if(a.pool_id===r.pool_address){n.push(r);break}})}for(const o of s)await this._sdk.Ido.getPurchaseInfo(o.purchase_summary.purchase_handle,t,!1)&&n.push(o);return n}async getOwnerPools(t,e){return e.filter(n=>n.owner===Jn(t))}async creatPurchasePayload(t,e){return t.version==="1"?await this._sdk.Launchpad.creatPurchasePayload({pool_address:t.pool_address,purchase_amount:e,coin_type_sale:t.coin_type_sale,coin_type_raise:t.coin_type_raise}):await this._sdk.Ido.creatPurchasePayload({pool_address:t.pool_address,coin_type_sale:t.coin_type_sale,coin_type_raise:t.coin_type_raise,purchase_handle:t.purchase_summary.purchase_handle,raise_amount:e.toString()})}async creatRedeemPayload(t){return t.version==="1"?await this._sdk.Launchpad.creatClaimPayload({pool_address:t.pool_address,coin_type_sale:t.coin_type_sale,coin_type_raise:t.coin_type_raise}):await this._sdk.Ido.redeemPayload({pool_address:t.pool_address,coin_type_sale:t.coin_type_sale,coin_type_raise:t.coin_type_raise,purchase_handle:t.purchase_summary.purchase_handle})}async creatWithdrawPayload(t){if(t.version==="1"){const n=await Zn.getWithdrawSale(t),i=await Zn.getWithdrawRaise(t);return this._sdk.Launchpad.creatWithdrawPayload({pool_address:t.pool_address,coin_type_sale:t.coin_type_sale,coin_type_raise:t.coin_type_raise,sale_amount:BigInt(n),raise_amount:BigInt(i)})}return this._sdk.Ido.withdrawPayload({pool_address:t.pool_address,coin_type_sale:t.coin_type_sale,coin_type_raise:t.coin_type_raise})}unlockNftPayload(t,e){return t.version==="1"?this._sdk.Launchpad.creatUnlockNftPayload(e):this._sdk.Ido.unlockNftPayload({lock_nft_id:e.lock_nft,nft_type:e.nft_type})}async getLockNFTList(t){let e=[];return t.version==="1"&&(e=await this._sdk.Launchpad.getLockNFTList(t.owner)),e=await this._sdk.Ido.getLockNFTList(t.owner),e.filter(i=>{const s=ht(i.coin_type_a).full_address,o=ht(i.coin_type_b).full_address,r=ht(t.coin_type_sale).full_address,a=ht(t.coin_type_raise).full_address;return s===r&&o===a||s===a&&o===r})}async isWhiteListUser(t,e){return e.version==="1"?await this._sdk.Launchpad.isWhiteListUser(e.white_summary.white_handle,t):!!await this._sdk.Ido.getWhiteProtectionLimit(e.white_summary.white_handle,t)}async getPurchaseInfo(t,e){if(e.version==="1"){const i=await this._sdk.Launchpad.getPurchaseMarks(t,[e.pool_address]);return i.length>0?i[0]:void 0}return await this._sdk.Ido.getPurchaseInfo(e.purchase_summary.purchase_handle,t)}async getwhiteProtectionInfo(t,e,n=!1){if(e.version==="1")return await this._sdk.Launchpad.getPurchaseAmount(e.white_summary.white_handle,t);const i=await this._sdk.Ido.getPurchaseInfo(e.purchase_summary.purchase_handle,t,n);if(i)return{safe_limit_amount:i.protection_raise_limit,safe_purchased_amount:i.protection_raise_amount};const s=await this._sdk.Ido.getWhiteProtectionLimit(e.white_summary.white_handle,t,!1);return s?{safe_limit_amount:s,safe_purchased_amount:"0"}:{safe_limit_amount:"0",safe_purchased_amount:"0"}}async calculateWithdrawAmount(t){if(t.version==="1"){const e=await Zn.getHistoryWithdrawRaise(this._sdk,t),n=await Zn.getHistoryWithdrawSale(this._sdk,t);return{obtained_raise_amount:e,refunded_sale_amount:n}}return On.calculateWithdrawAmount(t)}async buildIdoWarpPool(t){const e=Ys(t);if(console.log(this._sdk.sdkOptions.ido.package_id,ht(e).address,"buildIdoWarpPool"),ht(e).address===this._sdk.sdkOptions.ido.package_id){const n=On.buildIdoPool(t);return await On.calculatePoolUiPrice(this._sdk,n),{...n,version:"2"}}if(ht(e).address===this._sdk.sdkOptions.launchpad.package_id){const n=Zn.buildLaunchPadPool(t);return await Zn.calculatePoolPrice(this._sdk,n),{...n,version:"1"}}}},$s=class{static buildVeNFTDividendInfo(t){const e={id:t.id.id,ve_nft_id:t.name,rewards:[]};return t.value.fields.value.fields.dividends.fields.contents.forEach(n=>{const i=[];n.fields.value.fields.contents.forEach(s=>{i.push({coin_type:ht(s.fields.key.fields.name).source_address,amount:s.fields.value})}),e.rewards.push({period:Number(n.fields.key),rewards:i})}),e}static buildDividendManager(t){const e={id:t.id.id,dividends:{id:t.dividends.fields.id.id,size:t.dividends.fields.size},venft_dividends:{id:t.venft_dividends.fields.id.id,size:t.venft_dividends.fields.size},bonus_types:[],start_time:Number(t.start_time),interval_day:Number(t.interval_day),balances:{id:t.balances.fields.id.id,size:t.balances.fields.size},is_open:t.is_open};return t.bonus_types.forEach(n=>{e.bonus_types.push(ht(n.fields.name).source_address)}),e}static buildLockUpManager(t){return{id:t.id.id,balance:t.balance,treasury_manager:t.treasury_manager,extra_treasury:t.extra_treasury,lock_infos:{lock_handle_id:t.lock_infos.fields.id.id,size:Number(t.lock_infos.fields.size)},type_name:ri(t.type_name.fields.name),min_lock_day:Number(t.min_lock_day),max_lock_day:Number(t.max_lock_day),package_version:Number(t.package_version),max_percent_numerator:Number(t.max_percent_numerator),min_percent_numerator:Number(t.min_percent_numerator)}}static buildLockToken(t){const e=t.fields,n={id:e.id.id,type:ht(t.type).source_address,locked_start_time:Number(e.locked_start_time),locked_until_time:Number(e.locked_until_time),token_amount:e.balance,xtoken_amount:"0",lock_day:0};return n.lock_day=(n.locked_until_time-n.locked_start_time)/Or,n}static getAvailableXToken(t,e){let n=D(0);return e.forEach(i=>{n=n.add(i.xtoken_amount)}),D(t.xtoken_balance).sub(n).toString()}static getWaitUnLockTokens(t){return t.filter(e=>!$s.isLocked(e))}static getLockingTokens(t){return t.filter(e=>$s.isLocked(e))}static buildDividendRewardTypeList(t){const e=new Set;return t.forEach(n=>{n.rewards.forEach(i=>{e.add(i.coin_type)})}),Array.from(e)}static isLocked(t){return t.locked_until_time>Date.parse(new Date().toString())/1e3}static getNextStartTime(t,e=Or){const n=Date.now()/1e3,{start_time:i,interval_day:s}=t,o=Math.ceil((n-i)/(s*e));return i+o*s*e}},Yi=class{static getDefaultStrategyConfig(t){let e;switch(t){case 4:e=zh.bidAsk;break;default:e=zh.curve;break}return e}static geTickIndexRange(t,e,n,i){let s,o;switch(t=Nt.getInitializableTickIndex(t,e),i){case"left":t>0?(o=D(t).sub(e).toNumber(),s=D(t).mul(D(1).add(n)).toDecimalPlaces(0).toNumber()):(o=D(t).sub(e).toNumber(),s=D(t).mul(D(1).sub(n)).toDecimalPlaces(0).toNumber());break;case"right":t>0?(o=D(t).mul(D(1).add(n)).toDecimalPlaces(0).toNumber(),s=D(t).add(e).toNumber()):(o=D(t).mul(D(1).sub(n)).toDecimalPlaces(0).toNumber(),s=D(t).add(e).toNumber());break;default:t>0?(s=D(t).mul(D(1).sub(n)).toDecimalPlaces(0).toNumber(),o=D(t).mul(D(1).add(n)).toDecimalPlaces(0).toNumber()):(s=D(t).mul(D(1).add(n)).toDecimalPlaces(0).toNumber(),o=D(t).mul(D(1).sub(n)).toDecimalPlaces(0).toNumber());break}if(s=Nt.getInitializableTickIndex(s,e),o=Nt.getInitializableTickIndex(o,e),s<xl)throw Error("Tick lower value is below the minimum allowed value.");if(o>vl)throw Error("Tick upper value is above the maximum allowed value.");return{tick_lower:s,tick_upper:o}}static getCreateLiquidityBins(t,e){let n=[];switch(e){case 4:n=Yi.getCreateBidAskLiquidityBins(t);break;default:n=Yi.getCreateCurveLiquidityBins(t);break}return n}static getCreateBidAskLiquidityBins(t){const e=D(Math.floor(D(t.tick_upper).sub(t.tick_lower).div(t.div_width).toNumber())).abs(),n=[],i=t.ratios;let s,o;for(let r=0;r<i.length;r++){let a,c;t.tick_upper<=t.curr_tick?(c=D(t.tick_upper).sub(e.mul(r)).toNumber(),a=D(c).sub(e).toNumber()):t.tick_lower>=t.curr_tick?(a=D(t.tick_lower).add(e.mul(r)).toNumber(),c=D(t.tick_lower).add(e.mul(r+1)).toNumber()):r===4?(a=D(t.tick_lower).add(e.mul(r)).toNumber(),c=D(a).add(e.mul(2)).toNumber()):r>4?(a=D(t.tick_lower).add(e.mul(r+1)).toNumber(),c=D(a).add(e).toNumber()):(a=D(t.tick_lower).add(e.mul(r)).toNumber(),c=D(a).add(e).toNumber()),s=Nt.getInitializableTickIndex(a,t.tick_spacing),o=Nt.getInitializableTickIndex(c,t.tick_spacing),n.push({tick_lower:s,tick_upper:o,ratio:i[r],liquidity:"0"})}return n}static getCreateCurveLiquidityBins(t){const e=D(Math.floor(D(t.tick_upper).sub(t.tick_lower).div(t.div_width).toNumber())).abs(),n=[],i=t.ratios;for(let s=0;s<i.length;s++){let o,r;t.tick_upper<=t.curr_tick?(r=t.tick_upper,o=D(t.tick_upper).sub(e.mul(s+1)).toNumber()):t.tick_lower>=t.curr_tick?(o=t.tick_lower,r=D(o).add(e.mul(s+1)).toNumber()):(o=D(t.curr_tick).sub(e.mul(s+1)).toNumber(),r=D(t.curr_tick).add(e.mul(s+1)).toNumber()),n.push({tick_lower:Nt.getInitializableTickIndex(o,t.tick_spacing),tick_upper:Nt.getInitializableTickIndex(r,t.tick_spacing),ratio:i[s],liquidity:"0"})}return n}static calculateAddLiquidityInputs(t){const e=new y(Nt.tickIndexToSqrtPriceX64(t.curr_tick)),n=Yi.calculateCoinRatios(t.curr_tick,t.liquidity_bins),i=t.liquidity_bins.map((s,o)=>{const r=n[o],a=D(t.coin_amount).mul(t.fix_amount_a?r.coinRatioA:r.coinRatioB).toFixed(0).toString();try{return{...dn.estLiquidityAndcoinAmountFromOneAmounts(s.tick_lower,s.tick_upper,new y(a),t.fix_amount_a,!0,t.slippage,e),...s}}catch{return{coinAmountA:new y(0),coinAmountB:new y(0),tokenMaxA:new y(0),tokenMaxB:new y(0),liquidityAmount:new y(0),fix_amount_a:!t.fix_amount_a,...s}}});return Yi.fixLiquidityInputs(e,t.slippage,i,!0)}static fixLiquidityInputs(t,e,n,i){const s=n.filter(r=>r.liquidityAmount.gt(Zt));if(s.length===0)return[];const o=s[0];return n.map(r=>{if(r.liquidityAmount.eq(Zt)){const a=D(o.liquidityAmount.toString()).mul(r.ratio).div(o.ratio).toFixed(0),c=Nt.tickIndexToSqrtPriceX64(r.tick_lower),u=Nt.tickIndexToSqrtPriceX64(r.tick_upper),l=dn.getCoinAmountFromLiquidity(new y(a.toString()),t,c,u,!1);return{coinAmountA:l.coinA,coinAmountB:l.coinB,liquidityAmount:new y(a.toString()),fix_amount_a:r.fix_amount_a,...Ku(l,Ir.fromDecimal(D(e).mul(100)),i)}}return r})}static calculateCoinRatios(t,e){const n=new y(Nt.tickIndexToSqrtPriceX64(t)),i=[];let s=D(0),o=D(0);const r=e.map(u=>{const l=D(Sk(100,6).toString()).mul(u.ratio).toFixed(0).toString(),d=Nt.tickIndexToSqrtPriceX64(u.tick_lower),f=Nt.tickIndexToSqrtPriceX64(u.tick_upper),_=dn.getCoinAmountFromLiquidity(new y(l),n,d,f,!0);return s=s.add(_.coinA.toString()),o=o.add(_.coinB.toString()),{..._,liquidity:l}}),a=[],c=[];return r.forEach((u,l)=>{const d={coinRatioA:s.eq(D(0))?0:D(u.coinA.toString()).div(s).toNumber(),coinRatioB:o.eq(D(0))?0:D(u.coinB.toString()).div(o).toNumber(),liquiditys:u.liquidity,tick_lower:e[l].tick_lower,tick_upper:e[l].tick_upper};i.push(d),a.push(s.eq(D(0))?0:D(u.coinA.toString()).div(s).toNumber()),c.push(o.eq(D(0))?0:D(u.coinB.toString()).div(o).toNumber())}),i}static calculateCloseMasterLiquidityInputs(t){const e=new y(Nt.tickIndexToSqrtPriceX64(t.curr_tick));return t.positions.map(i=>{const s=new y(i.liquidity),o=Nt.tickIndexToSqrtPriceX64(i.tick_lower_index),r=Nt.tickIndexToSqrtPriceX64(i.tick_upper_index),a=dn.getCoinAmountFromLiquidity(s,e,o,r,!1),c=Ir.fromDecimal(D(t.slippage).mul(100)),{tokenMaxA:u,tokenMaxB:l}=Ku(a,c,!1);return{coinAmountA:a.coinA,coinAmountB:a.coinB,tokenMaxA:u,tokenMaxB:l,liquidityAmount:s,fix_amount_a:!1}})}static calculateRemoveMasterLiquidityInputs(t){const e=new y(Nt.tickIndexToSqrtPriceX64(t.curr_tick)),{fix_token:n}=t;if(n){const s=t.positions.map((a,c)=>({tick_lower:a.tick_lower_index,tick_upper:a.tick_upper_index,ratio:t.ratios[c]})),o=Yi.calculateCoinRatios(t.curr_tick,s),r=t.positions.map((a,c)=>{const u=o[c],l=D(n.coin_amount).mul(n.fix_amount_a?u.coinRatioA:u.coinRatioB).toFixed(0).toString();try{const d=dn.estLiquidityAndcoinAmountFromOneAmounts(a.tick_lower_index,a.tick_upper_index,new y(l),n.fix_amount_a,!1,t.slippage,e);return{...d,tick_lower:a.tick_lower_index,tick_upper:a.tick_upper_index,liquidity:d.liquidityAmount.toString(),ratio:t.ratios[c]}}catch{return{coinAmountA:new y(0),coinAmountB:new y(0),tokenMaxA:new y(0),tokenMaxB:new y(0),liquidityAmount:new y(0),fix_amount_a:!n.fix_amount_a,tick_lower:a.tick_lower_index,tick_upper:a.tick_upper_index,liquidity:"0",ratio:t.ratios[c]}}});return Yi.fixLiquidityInputs(e,t.slippage,r,!1)}return t.positions.map((s,o)=>{const r=t.ratios[o];let a=D(t.liquidity).mul(r).toFixed(0);D(a).greaterThan(s.liquidity)&&(a=s.liquidity);const c=Nt.tickIndexToSqrtPriceX64(s.tick_lower_index),u=Nt.tickIndexToSqrtPriceX64(s.tick_upper_index),l=dn.getCoinAmountFromLiquidity(new y(a),e,c,u,!1),d=Ir.fromDecimal(D(t.slippage).mul(100)),{tokenMaxA:f,tokenMaxB:_}=Ku(l,d,!1);return{coinAmountA:l.coinA,coinAmountB:l.coinB,tokenMaxA:f,tokenMaxB:_,liquidityAmount:new y(a),fix_amount_a:!1}})}static buildMasterPosition(t){return{coin_type_a:ht(t.coin_type_a.fields.name).full_address,coin_type_b:ht(t.coin_type_b.fields.name).full_address,description:t.description,id:t.id.id,index:t.index,liquidity:t.liquidity,name:t.name,pool:t.pool,tick_lower_index:Sn(BigInt(t.tick_lower_index.fields.bits)),tick_upper_index:Sn(BigInt(t.tick_upper_index.fields.bits)),url:t.url}}static buildMasterNFT(t){const e=he(t);if(e){const n={id:e.id.id,pool_id:e.pool_id,index:Number(e.index),strategy:Number(e.strategy),tick_lower_index:Sn(BigInt(e.tick_lower_index)),tick_upper_index:Sn(BigInt(e.tick_upper_index)),positions:[],...wu(t)};return n.positions=e.positions.map(i=>Yi.buildMasterPosition(i.fields)),n}}},ji=class{static generateNextTickRange(t,e,n){const i=t-e/2,s=t+e/2;return{new_tick_lower:ji.getValidTickIndex(i,n),new_tick_upper:ji.getValidTickIndex(s,n)}}static calculateDepositRatio(t,e,n){const i=Nt.sqrtPriceX64ToTickIndex(n);if(i<t)return{ratioA:new it(1),ratioB:new it(0)};if(i>e)return{ratioA:new it(0),ratioB:new it(1)};const s=new y(1e8),{coinAmountB:o}=dn.estLiquidityAndcoinAmountFromOneAmounts(t,e,s,!0,!0,0,n),r=Nt.sqrtPriceX64ToPrice(n,0,0),a=D(s.toString()).mul(r),c=a.add(o.toString()),u=a.div(c),l=D(o.toString()).div(c);return{ratioA:u,ratioB:l}}static getValidTickIndex(t,e){if(t%e===0)return t;let n;if(t>0?n=t-t%e+e:t<0?n=t+Math.abs(t)%e-e:n=t,n%e!==0)throw new Error("Assertion failed: res % tickSpacing == 0");if(Math.abs(n)<Math.abs(t))throw new Error("Assertion failed: res.abs() >= tickIndex");return n}static get_lp_amount_by_liquidity(t,e){return t.total_supply==="0"?"0":D(t.total_supply).mul(e).div(t.liquidity).toFixed(0,it.ROUND_DOWN).toString()}static get_share_liquidity_by_amount(t,e){return t.total_supply==="0"?"0":D(e).mul(t.liquidity).div(t.total_supply).toFixed(0,it.ROUND_DOWN).toString()}static get_protocol_fee_amount(t,e){return D(e).mul(t.protocol_fee_rate).div(Vk).toFixed(0,it.ROUND_CEIL)}static buildFramsPositionNFT(t){const e=t.clmm_postion.fields;return{id:t.id.id,url:e.url,pool_id:t.pool_id,coinTypeA:ht(e.coin_type_a.fields.name).full_address,coinTypeB:ht(e.coin_type_b.fields.name).full_address,description:e.description,name:e.name,liquidity:e.liquidity,clmm_position_id:e.id.id,clmm_pool_id:e.pool,tick_lower_index:Sn(BigInt(e.tick_lower_index.fields.bits)),tick_upper_index:Sn(BigInt(e.tick_upper_index.fields.bits)),rewards:[]}}static buildPool(t){const e=he(t),n=Ys(t),{positions:i}=e;if(e&&i.length>0){const s=ji.buildFramsPositionNFT(i[0].fields);return{id:e.id.id,pool_id:e.pool,protocol_fee_rate:e.protocol_fee_rate,is_pause:e.is_pause,harvest_assets:{harvest_assets_handle:e.harvest_assets.fields.id.id,size:Number(e.harvest_assets.fields.size)},lp_token_type:ht(n).type_arguments[0],total_supply:e.lp_token_treasury.fields.total_supply.fields.value,liquidity:e.liquidity,max_quota:e.max_quota,status:e.status===1?"STATUS_RUNNING":"STATUS_REBALANCING",quota_based_type:e.quota_based_type.fields.name,position:s}}}},Oo=class{static calculatePositionShare(t,e,n,i,s,o,r){if(e<=s||t>=o)return"0";let a=0;t<s?a=s:a=t;let c=0;e<o?c=e:c=o;const u=Nt.tickIndexToSqrtPriceX64(a),l=Nt.tickIndexToSqrtPriceX64(c),{coinA:d,coinB:f}=dn.getCoinAmountFromLiquidity(new y(n),new y(r),u,l,!0);return D(d.toString()).mul(i).div(1e12).add(f.toString()).toString()}static buildFramsPool(t){const e=he(t);if(e)try{const n=[];return e.rewarders.forEach(s=>{n.push({reward_coin:ht(s.fields.name).full_address,last_reward_time:"",emission_per_second:"",total_allocate_point:"",allocate_point:""})}),{id:e.id.id,clmm_pool_id:e.clmm_pool_id,effective_tick_lower:Sn(BigInt(e.effective_tick_lower.fields.bits)),effective_tick_upper:Sn(BigInt(e.effective_tick_upper.fields.bits)),total_share:e.total_share,rewarders:n,positions:{positions_handle:e.positions.fields.id.id,size:e.positions.fields.size},sqrt_price:e.sqrt_price}}catch(n){console.log(n)}}static buildFramsPositionNFT(t){const e=he(t);if(e){const n=e.clmm_postion.fields;return{id:e.id.id,url:n.url,pool_id:e.pool_id,coinTypeA:ht(n.coin_type_a.fields.name).full_address,coinTypeB:ht(n.coin_type_b.fields.name).full_address,description:n.description,name:n.name,liquidity:n.liquidity,clmm_position_id:n.id.id,clmm_pool_id:n.pool,tick_lower_index:Sn(BigInt(n.tick_lower_index.fields.bits)),tick_upper_index:Sn(BigInt(n.tick_upper_index.fields.bits)),rewards:[]}}}},Jk=class{constructor(t){Ft(this,"_sdk");Ft(this,"_cache",{});this._sdk=t}get sdk(){return this._sdk}async getPoolImmutables(t="all",e=!1){const{package_id:n}=this._sdk.sdkOptions.ido,i=`${n}_getPoolImmutables`,s=this.getCache(i,e),o={data:[],hasNextPage:!1},r=[];if(s!==void 0&&r.push(...s),r.length===0)try{const a=await this._sdk.ClmmSDK.fullClient.queryEventsByPage({MoveEventType:`${n}::oversubscribe_pool::CreatePoolEvent`},t);a.data.forEach(c=>{const u=c.parsedJson;if(u){const l=On.buildIdoPoolImmutables(u);r.push(l)}}),o.hasNextPage=a.hasNextPage,o.nextCursor=a.nextCursor,this.updateCache(i,r,Kt)}catch(a){console.log("getPoolImmutables",a)}return o.data=r,o}async getPools(t=[],e=!1){const n=[];let i=[];t.length>0?i=[...t]:(await this.getPoolImmutables("all",e)).data.forEach(r=>{i.push(r.pool_address)});const s=await this._sdk.ClmmSDK.fullClient.batchGetObjects(i,{showType:!0,showContent:!0});for(const o of s){const r=On.buildIdoPool(o);await On.calculatePoolUiPrice(this._sdk,r),n.push(r);const a=`${r.pool_address}_getPoolObject`;this.updateCache(a,r,Kt)}return n}async getPool(t,e=!0){const n=`${t}_getPoolObject`,i=this.getCache(n,e);if(i!==void 0)return i;const s=await this._sdk.ClmmSDK.fullClient.getObject({id:t,options:{showContent:!0,showType:!0}}),o=On.buildIdoPool(s);return await On.calculatePoolUiPrice(this._sdk,o),this.updateCache(n,o),o}async getIdoConfigs(t=!1){var c;const{package_id:e}=this._sdk.sdkOptions.ido,n=`${e}_getInitEvent`,i=this.getCache(n,t);if(i!==void 0)return i;const s=await this._sdk.ClmmSDK.fullClient.getObject({id:e,options:{showPreviousTransaction:!0}}),o=la(s),r=(c=await this._sdk.ClmmSDK.fullClient.queryEventsByPage({Transaction:o}))==null?void 0:c.data,a={pools_id:"",admin_cap_id:"",package_version_id:""};return r.length>0&&(r.forEach(u=>{console.log("item: ",u);const l=u.parsedJson;if(l)switch(ht(u.type).full_address){case`${e}::config::InitConfigEvent`:a.admin_cap_id=l.admin_cap_id,a.package_version_id=l.package_version_id;break;case`${e}::factory::InitFactoryEvent`:a.pools_id=l.pools_id;break}}),this.updateCache(n,a,Kt)),a}async getPurchaseInfo(t,e,n=!0){const i=`${t}_${e}_getPurchaseInfo`,s=this.getCache(i,n);if(s)return s;try{const o=await this._sdk.ClmmSDK.fullClient.getDynamicFieldObject({parentId:t,name:{type:"address",value:e}}),r=On.buildPurchaseInfo(he(o));return this.updateCache(i,r,gi),r}catch{return}}async getLockNFT(t,e=!1){const n=`${t}_getLockNFT`,i=this.getCache(n,e);if(i!==void 0)return i;const s=await this._sdk.ClmmSDK.fullClient.getObject({id:t,options:{showType:!0,showContent:!0,showDisplay:!0,showOwner:!0}});if(!s.error)return Gs(s)}async getLockNFTList(t){var s;const{clmm_pool:e}=this._sdk.ClmmSDK.sdkOptions,{ido:n}=this._sdk.sdkOptions,i=[];try{const o=(s=await this._sdk.ClmmSDK.fullClient.getOwnedObjectsByPage(t,{filter:{StructType:`${n.package_id}::lock::LockedNFT<${e.package_id}::position::Position>`},options:{showContent:!0}}))==null?void 0:s.data;for(const r of o){const a=he(r);if(a){const c=a.nft.fields,u={locked_at:Number(a.locked_at),lock_duration:Number(a.lock_duration),lock_nft_id:a.id.id,type:a.nft.type,...c};u.end_lock_time=u.locked_at+u.lock_duration,u.coin_type_a=ht(c.coin_type_a.fields.name).full_address,u.coin_type_b=ht(c.coin_type_b.fields.name).full_address,u.id=c.id.id,u.tick_lower_index=Sn(BigInt(c.tick_lower_index.fields.bits)),u.tick_upper_index=Sn(BigInt(c.tick_upper_index.fields.bits)),i.push(u)}}return i}catch(o){return console.log("getLockNFTList:",o),[]}}async creatPool(t){const{ido:e}=this.sdk.sdkOptions;oc(Jn(t.coin_type_sale),Jn(t.coin_type_raise))&&(t.price_min=D(1).div(t.price_max).toNumber(),t.price_max=D(1).div(t.price_min).toNumber());const i=Zn.priceRealToFix(Number(t.price),t.sale_decimals,t.raise_decimals),s=Nt.priceToSqrtPriceX64(D(t.price_min),t.sale_decimals,t.raise_decimals).toString(),o=Nt.priceToSqrtPriceX64(D(t.price_max),t.sale_decimals,t.raise_decimals).toString(),r=new vt,a=D(t.total_supply).add(D(t.total_supply).mul(D(t.liquidity_injection_ratio))).toNumber(),c=await this._sdk.ClmmSDK.getOwnerCoinAssets(this._sdk.ClmmSDK.senderAddress,t.coin_type_sale),u=ye.buildCoinForAmount(r,c,BigInt(a),t.coin_type_sale,!1),l=[r.pure(J(e).admin_cap_id),r.pure(J(e).package_version_id),r.pure(J(e).pools_id),r.pure(Jn(t.owner)),r.pure(D(i).mul(ko).toString()),r.pure(t.total_supply),r.pure(t.complete_raise_limit),r.pure(t.min_purchase_amount),r.pure(t.max_purchase_amount),r.pure(t.start_time),r.pure(t.purchase_duration),r.pure(t.lock_up_duration),r.pure((t.liquidity_injection_ratio*A_).toString()),r.pure(s),r.pure(o),r.pure(t.tick_spacing.toString()),u.targetCoin,r.pure(t.protection_hard_cap.toString()),r.pure(Bt)],d=[t.coin_type_sale,t.coin_type_raise];return r.moveCall({target:`${e.published_at}::${Kk}::create_oversubscribe_pool`,typeArguments:d,arguments:l}),r}async creatPurchasePayload(t){const{ido:e}=this.sdk.sdkOptions,n=new vt,i=await this.getPurchaseInfo(t.purchase_handle,this._sdk.ClmmSDK.senderAddress,!1),s=await this._sdk.ClmmSDK.getOwnerCoinAssets(this._sdk.ClmmSDK.senderAddress,t.coin_type_raise),o=ye.buildCoinForAmount(n,s,BigInt(t.raise_amount),t.coin_type_raise,!1),r=[t.coin_type_sale,t.coin_type_raise];let a,c;return i?(c="purchase",a=[n.object(J(e).package_version_id),n.object(t.pool_address),n.object(i.purchase_certificate_id),n.pure(t.raise_amount.toString()),o.targetCoin,n.pure(Bt)]):(c="create_certificate_and_purchase",a=[n.object(J(e).package_version_id),n.object(t.pool_address),n.pure(t.raise_amount.toString()),o.targetCoin,n.pure(Bt)]),n.moveCall({target:`${e.published_at}::${_i}::${c}`,typeArguments:r,arguments:a}),n}async redeemPayload(t){const{ido:e}=this.sdk.sdkOptions,n=await this.getPurchaseInfo(t.purchase_handle,this._sdk.ClmmSDK.senderAddress,!1);if(n===void 0)throw Error("get purchase certificate fail");const i=new vt,s=[t.coin_type_sale,t.coin_type_raise],o=[i.pure(J(e).package_version_id),i.pure(t.pool_address),i.pure(n.purchase_certificate_id),i.pure(Bt)];return i.moveCall({target:`${e.published_at}::${_i}::redeem`,typeArguments:s,arguments:o}),i}injectLiquidityPayload(t){const{ido:e}=this.sdk.sdkOptions,{clmm_pool:n}=this.sdk.ClmmSDK.sdkOptions,i=new vt,s=[t.coin_type_sale,t.coin_type_raise],o=t.is_reverse?"inject_liquidity_with_reverse_clmm_pool":"inject_liquidity_with_forward_clmm_pool",r=[i.pure(J(e).package_version_id),i.pure(t.pool_address),i.pure(J(n).global_config_id),i.pure(t.clmm_pool_address),i.pure(Bt)];return i.moveCall({target:`${e.published_at}::${_i}::${o}`,typeArguments:s,arguments:r}),i}unPauseInjectLiquidity(t){const{ido:e}=this.sdk.sdkOptions,{integrate:n,clmm_pool:i}=this.sdk.ClmmSDK.sdkOptions,s=new vt;s.moveCall({target:`${n.published_at}::${Cr}::unpause_pool`,typeArguments:[t.coin_type_a,t.coin_type_b],arguments:[s.object(J(i).global_config_id),s.object(t.clmm_pool_address)]});const o=[t.coin_type_sale,t.coin_type_raise],r=t.is_reverse?"inject_liquidity_with_reverse_clmm_pool":"inject_liquidity_with_forward_clmm_pool",a=[s.object(J(e).package_version_id),s.object(t.pool_address),s.object(J(i).global_config_id),s.object(t.clmm_pool_address),s.object(Bt)];return s.moveCall({target:`${e.published_at}::${_i}::${r}`,typeArguments:o,arguments:a}),s}async findClmmPoolForLiquidity(t){let e=null,n=!1;const i=await this.sdk.ClmmSDK.Pool.getPoolImmutables();for(const s of i){if(s.coinTypeA===t.coin_type_sale&&s.coinTypeB===t.coin_type_raise&&Number(s.tickSpacing)===t.tick_spacing){e=await this._sdk.ClmmSDK.Pool.getPool(s.poolAddress);break}if(s.coinTypeA===t.coin_type_raise&&s.coinTypeB===t.coin_type_sale&&Number(s.tickSpacing)===t.tick_spacing){e=await this._sdk.ClmmSDK.Pool.getPool(s.poolAddress),n=!0;break}}return e&&(D(e.current_sqrt_price).lessThanOrEqualTo(t.current_sqrt_price_min)||D(e.current_sqrt_price).greaterThanOrEqualTo(t.current_sqrt_price_max))?(console.log("clmmPool: ",e.poolAddress),{is_reverse:n,clmmPool:null}):{is_reverse:n,clmmPool:e}}withdrawPayload(t){const{ido:e}=this.sdk.sdkOptions,n=new vt,i=[t.coin_type_sale,t.coin_type_raise],s=[n.object(J(e).package_version_id),n.object(t.pool_address),n.object(Bt)];return n.moveCall({target:`${e.published_at}::${_i}::withdraw`,typeArguments:i,arguments:s}),n}updateWhitelistCapPayload(t){const{ido:e}=this.sdk.sdkOptions,n=new vt,i=[t.coin_type_sale,t.coin_type_raise];return t.add_whites&&t.add_whites.addresses.length>0&&n.moveCall({target:`${e.published_at}::${_i}::add_white_listed_addresses`,typeArguments:i,arguments:[n.object(J(e).admin_cap_id),n.object(J(e).package_version_id),n.object(t.pool_address),n.makeMoveVec({type:"address",objects:t.add_whites.addresses.map(s=>n.object(Ln(s)))}),n.pure(t.add_whites.protection_limit),n.object(Bt)]}),t.remove_whites&&t.remove_whites.length>0&&n.moveCall({target:`${e.published_at}::${_i}::remove_white_listed_addresses`,typeArguments:i,arguments:[n.object(J(e).admin_cap_id),n.object(J(e).package_version_id),n.object(t.pool_address),n.makeMoveVec({type:"address",objects:t.remove_whites.map(s=>n.object(Ln(s)))}),n.object(Bt)]}),t.update_whites&&t.update_whites.forEach(s=>{n.moveCall({target:`${e.published_at}::${_i}::update_white_listed_address`,typeArguments:i,arguments:[n.object(J(e).admin_cap_id),n.object(J(e).package_version_id),n.object(t.pool_address),n.object(s.address),n.pure(s.protection_limit),n.object(Bt)]})}),n}creatCancelPoolPayload(t){const{ido:e}=this.sdk.sdkOptions,n=new vt,i=[t.coin_type_sale,t.coin_type_raise],s=[n.pure(J(e).admin_cap_id),n.pure(J(e).package_version_id),n.pure(t.pool_address),n.pure(Bt)];return n.moveCall({target:`${e.published_at}::${_i}::cancel`,typeArguments:i,arguments:s}),n}updatePoolOwnerPayload(t,e){const{ido:n}=this.sdk.sdkOptions;e=e===void 0?new vt:e;const i=[t.coin_type_sale,t.coin_type_raise],s=[e.object(J(n).admin_cap_id),e.object(J(n).package_version_id),e.object(t.pool_address),e.object(t.new_owner),e.object(Bt)];return e.moveCall({target:`${n.published_at}::${_i}::update_pool_owner`,typeArguments:i,arguments:s}),e}updatePoolDuractionPayload(t,e){const{ido:n}=this.sdk.sdkOptions;e=e===void 0?new vt:e;const i=[t.coin_type_sale,t.coin_type_raise],s=[e.object(J(n).admin_cap_id),e.object(J(n).package_version_id),e.object(t.pool_address),e.pure(t.start_time),e.pure(t.purchase_duration),e.pure(t.lock_duration),e.object(Bt)];return e.moveCall({target:`${n.published_at}::${_i}::update_pool_duration`,typeArguments:i,arguments:s}),e}updateProtectionHardCapPayload(t,e){const{ido:n}=this.sdk.sdkOptions;e=e===void 0?new vt:e;const i=[t.coin_type_sale,t.coin_type_raise],s=[e.object(J(n).admin_cap_id),e.object(J(n).package_version_id),e.object(t.pool_address),e.pure(t.protection_hard_cap),e.object(Bt)];return e.moveCall({target:`${n.published_at}::${_i}::update_protection_hard_cap`,typeArguments:i,arguments:s}),e}unlockNftPayload(t){const{ido:e}=this.sdk.sdkOptions,n=new vt,i=[t.nft_type],s=[n.pure(t.lock_nft_id),n.pure(Bt)];return n.moveCall({target:`${e.published_at}::lock::unlock_nft`,typeArguments:i,arguments:s}),n}async isAdminCap(t){const{ido:e}=this._sdk.sdkOptions,n=`${e.package_id}_${t}_isAdminCap`,i=this.getCache(n);if(i)return i;const s=await this._sdk.ClmmSDK.fullClient.getObject({id:J(e).admin_cap_id,options:{showType:!0,showOwner:!0}});console.log(s);const o=Ys(s),r=cc(s);let a=!1;return r&&o&&ht(o).source_address===`${e.package_id}::config::AdminCap`&&(a=Jn(r.AddressOwner)===Jn(t)),this.updateCache(n,a,Kt),a}async getWhiteProtectionLimit(t,e,n=!0){const i=`${t}_${e}_getWhiteProtectionLimit`,s=this._sdk.getCache(i,n);if(s)return s;try{const o=await this._sdk.ClmmSDK.fullClient.getDynamicFieldObject({parentId:t,name:{type:"address",value:e}});if(o&&o.data){const r=he(o);return this._sdk.updateCache(i,r.value),r.value}return}catch{return}}async getWhiteList(t,e){var i;const n={type:"address",value:e};try{const s=await this._sdk.ClmmSDK.fullClient.getDynamicFieldObject({parentId:t,name:n}),o=he(s);if(console.log(o),o)return(i=o==null?void 0:o.value)==null?void 0:i.fields}catch{}return{safe_limit_amount:"0",safe_purchased_amount:"0"}}async getAdminAddress(){const{ido:t}=this._sdk.sdkOptions,e=`${J(t).admin_cap_id}_getAdminAddress`,n=this.getCache(e);if(n)return n;const i=await this._sdk.ClmmSDK.fullClient.getObject({id:J(t).admin_cap_id,options:{showType:!0,showOwner:!0}});console.log(i);const s=Ys(i),o=cc(i);if(o&&s&&ht(s).source_address===`${t.package_id}::config::AdminCap`){const a=Jn(o.AddressOwner);return this.updateCache(e,a,Kt),a}return""}updateCache(t,e,n=Kt){let i=this._cache[t];i?(i.overdueTime=on(n),i.value=e):i=new Yn(e,on(n)),this._cache[t]=i}getCache(t,e=!1){const n=this._cache[t];if(!e&&(n!=null&&n.isValid()))return n.value;delete this._cache[t]}},Zk=class{constructor(t){Ft(this,"_sdk");Ft(this,"_cache",{});this._sdk=t}get sdk(){return this._sdk}async getOwnerVeNFT(t,e=!0){const{xtoken:n}=this.sdk.sdkOptions,i=`${t}_getLockUpManagerEvent`,s=this.getCache(i,e);if(s!==void 0)return s;let o;const r=`${n.package_id}::xtoken::VeNFT`;return(await this._sdk.ClmmSDK.fullClient.getOwnedObjectsByPage(t,{options:{showType:!0,showContent:!0,showDisplay:!0},filter:{StructType:r}})).data.forEach(c=>{const u=ht(qi(c)).source_address;if(u===r&&c.data&&c.data.content){const{fields:l}=c.data.content;o={...wu(c),id:l.id.id,index:l.index,type:u,xtoken_balance:l.xtoken_balance},this.updateCache(i,o,Kt)}}),o}async getOwnerLockTokens(t){const{xtoken:e}=this.sdk.sdkOptions,n=[],i=`${e.package_id}::lock_coin::LockedCoin<${this.buileTokenCoinType()}>`,s=await this._sdk.ClmmSDK.fullClient.getOwnedObjectsByPage(t,{options:{showType:!0,showContent:!0},filter:{StructType:i}});for(const o of s.data)if(ht(qi(o)).source_address===i&&o.data){const a=$s.buildLockToken(o.data.content),c=await this.getLockXToken(a.id);c&&(a.xtoken_amount=c.xtoken_amount),n.push(a)}return n}async getLockToken(t){var n;const e=await this._sdk.ClmmSDK.fullClient.getObject({id:t,options:{showType:!0,showContent:!0}});if((n=e.data)!=null&&n.content){const i=$s.buildLockToken(e.data.content),s=await this.getLockXToken(i.id);return s&&(i.xtoken_amount=s.xtoken_amount),i}}async getOwnerTokenCoins(t){return await this._sdk.ClmmSDK.getOwnerCoinAssets(t,this.buileTokenCoinType())}mintVeNFTPayload(){const{xtoken:t}=this.sdk.sdkOptions,e=new vt;return e.moveCall({target:`${t.published_at}::${bo}::mint_venft`,typeArguments:[],arguments:[e.pure(J(t).xtoken_manager_id)]}),e}async convertPayload(t){const{xtoken:e}=this.sdk.sdkOptions,n=new vt,i=this.buileTokenCoinType(),s=await ye.syncBuildCoinInputForAmount(this._sdk.ClmmSDK,n,BigInt(t.amount),i);return t.venft_id===void 0?n.moveCall({target:`${e.published_at}::${bo}::mint_and_convert`,typeArguments:[],arguments:[n.object(J(e).lock_manager_id),n.object(J(e).xtoken_manager_id),s,n.pure(t.amount)]}):n.moveCall({target:`${e.published_at}::${bo}::convert`,typeArguments:[],arguments:[n.object(J(e).lock_manager_id),n.object(J(e).xtoken_manager_id),s,n.pure(t.amount),n.pure(t.venft_id)]}),n}redeemLockPayload(t){const{xtoken:e}=this.sdk.sdkOptions,n=new vt;return n.moveCall({target:`${e.published_at}::${bo}::redeem_lock`,typeArguments:[],arguments:[n.pure(J(e).lock_manager_id),n.pure(J(e).xtoken_manager_id),n.pure(t.venft_id),n.pure(t.amount),n.pure(t.lock_day),n.pure(Bt)]}),n}redeemPayload(t){const{xtoken:e}=this.sdk.sdkOptions,n=new vt;return n.moveCall({target:`${e.published_at}::${bo}::redeem`,typeArguments:[],arguments:[n.pure(J(e).lock_manager_id),n.pure(J(e).xtoken_manager_id),n.pure(t.venft_id),n.pure(t.lock_id),n.pure(Bt)]}),n}redeemDividendPayload(t,e){const{xtoken_dividends:n}=this.sdk.sdkOptions,i=new vt;return e.forEach(s=>{i.moveCall({target:`${n.published_at}::${Ju}::redeem`,typeArguments:[s],arguments:[i.object(J(n).dividend_manager_id),i.object(t)]})}),i}redeemDividendV2Payload(t,e,n){const{xtoken_dividends:i}=this.sdk.sdkOptions;let s=new vt;return e.filter(r=>n.includes(r)).length>0&&(s=this.redeemDividendXTokenPayload(t,s)),e.forEach(r=>{n.includes(r)||s.moveCall({target:`${i.published_at}::${Ju}::redeem_v2`,typeArguments:[r],arguments:[s.object(J(i).dividend_manager_id),s.object(t),s.object(Bt)]})}),s}redeemDividendXTokenPayload(t,e){const{xtoken_dividends:n,xtoken:i}=this.sdk.sdkOptions,{xtoken_manager_id:s,lock_manager_id:o}=J(i),{dividend_manager_id:r}=J(n);return e=e===void 0?new vt:e,e.moveCall({target:`${n.published_at}::${Ju}::redeem_xtoken`,typeArguments:[],arguments:[e.object(o),e.object(s),e.object(r),e.object(t),e.object(Bt)]}),e}buileTokenCoinType(){return`${this.sdk.sdkOptions.token_faucet.package_id}::token::TOKEN`}buileXTokenCoinType(t=this._sdk.sdkOptions.xtoken.package_id,e="xtoken",n="XTOKEN"){return`${t}::${e}::${n}`}cancelRedeemPayload(t){const{xtoken:e}=this.sdk.sdkOptions,n=new vt;return n.moveCall({target:`${e.published_at}::${bo}::cancel_redeem_lock`,typeArguments:[],arguments:[n.pure(J(e).lock_manager_id),n.pure(J(e).xtoken_manager_id),n.pure(t.venft_id),n.pure(t.lock_id),n.pure(Bt)]}),n}async getInitConfigs(){var r,a;const{package_id:t}=this.sdk.sdkOptions.xtoken,e=`${t}_getInitFactoryEvent`,n=this.getCache(e);if(n!==void 0)return n;const i=(r=await this._sdk.ClmmSDK.fullClient.queryEventsByPage({MoveEventType:`${t}::xtoken::InitEvent`}))==null?void 0:r.data,s={xtoken_manager_id:"",lock_manager_id:"",lock_handle_id:""};i.length>0&&i.forEach(c=>{const u=c.parsedJson;u&&(s.xtoken_manager_id=u.xtoken_manager)});const o=(a=await this._sdk.ClmmSDK.fullClient.queryEventsByPage({MoveEventType:`${t}::locking::InitializeEvent`}))==null?void 0:a.data;return o.length>0&&o.forEach(c=>{const u=c.parsedJson;u&&(s.lock_manager_id=u.lock_manager)}),s.lock_handle_id=(await this.getLockUpManager(s.lock_manager_id)).lock_infos.lock_handle_id,this.updateCache(e,s,Kt),s}async getLockUpManager(t=J(this.sdk.sdkOptions.xtoken).lock_manager_id,e=!1){const n=`${t}_getLockUpManagerEvent`,i=this.getCache(n,e);if(i!==void 0)return i;const s=await this.sdk.ClmmSDK.fullClient.getObject({id:t,options:{showContent:!0}}),o=$s.buildLockUpManager(he(s));return this.updateCache(n,o,Kt),o}async getLockInfoHandle(t){const e=`${t}_getLockInfoHandle`,n=this.getCache(e);if(n!==void 0)return n;let i="";const s=await this.sdk.ClmmSDK.fullClient.getObject({id:t,options:{showContent:!0}}),o=he(s);return o&&(i=o.lock_infos.fields.id.id,this.updateCache(e,i,Kt)),i}async getDividendConfigs(){var o;const{package_id:t}=this.sdk.sdkOptions.xtoken_dividends,e=`${t}_getDividendManagerEvent`,n=this.getCache(e);if(n!==void 0)return n;const i=(o=await this._sdk.ClmmSDK.fullClient.queryEventsByPage({MoveEventType:`${t}::dividend::InitEvent`}))==null?void 0:o.data,s={dividend_manager_id:"",dividend_admin_id:"",dividend_settle_id:""};return i.length>0&&i.forEach(r=>{const a=r.parsedJson;a&&(s.dividend_manager_id=a.manager_id,s.dividend_admin_id=a.admin_id,s.dividend_settle_id=a.settle_id,this.updateCache(e,s,Kt))}),s}async getDividendManager(t=!1){const{dividend_manager_id:e}=J(this.sdk.sdkOptions.xtoken_dividends),n=`${e}_getDividendManager`,i=this.getCache(n,t);if(i!==void 0)return i;const s=await this._sdk.ClmmSDK.fullClient.getObject({id:e,options:{showContent:!0}}),o=he(s),r=$s.buildDividendManager(o);return this.updateCache(n,r,Kt),r}async getXcetusManager(t=!0){const{xtoken_manager_id:e}=J(this.sdk.sdkOptions.xtoken),n=`${e}_getXcetusManager`,i=this.getCache(n,t);if(i)return i;const s=await this._sdk.ClmmSDK.fullClient.getObject({id:e,options:{showContent:!0}}),o=he(s),r={id:o.id.id,index:Number(o.index),has_venft:{handle:o.has_venft.fields.id.id,size:o.has_venft.fields.size},nfts:{handle:o.nfts.fields.id.id,size:o.nfts.fields.size},total_locked:o.total_locked,treasury:o.treasury.fields.total_supply.fields.value};return this.updateCache(n,r),r}async getVeNFTDividendInfo(t,e){try{const n=await this._sdk.ClmmSDK.fullClient.getDynamicFieldObject({parentId:t,name:{type:"0x2::object::ID",value:e}}),i=he(n);return $s.buildVeNFTDividendInfo(i)}catch{return}}async redeemNum(t,e){if(BigInt(t)===BigInt(0))return{amountOut:"0",percent:"0"};const n=await this.getLockUpManager(),i=D(Ai).mul(D(n.max_lock_day).sub(D(e))).mul(D(n.max_percent_numerator).sub(D(n.min_percent_numerator))).div(D(n.max_lock_day).sub(D(n.min_lock_day))),s=D(Ai).mul(D(n.max_percent_numerator)).sub(i).div(D(lc)).div(Ai);return{amountOut:D(s).mul(D(t)).round().toString(),percent:s.toString()}}async reverseRedeemNum(t,e){if(BigInt(t)===BigInt(0))return{amountOut:"0",percent:"0"};const n=await this.getLockUpManager(),i=D(Ai).mul(D(n.max_lock_day).sub(D(e))).mul(D(n.max_percent_numerator).sub(D(n.min_percent_numerator))).div(D(n.max_lock_day).sub(D(n.min_lock_day))),s=D(Ai).mul(D(n.max_percent_numerator)).sub(i).div(D(lc)).div(Ai);return{amountOut:D(t).div(s).toFixed(0,it.ROUND_UP),percent:s.toString()}}async getLockXToken(t){const{lock_handle_id:e}=J(this._sdk.sdkOptions.xtoken),n=`${t}_getXTokenAmount`,i=this.getCache(n);if(i)return i;try{const s=await this.sdk.ClmmSDK.fullClient.getDynamicFieldObject({parentId:e,name:{type:"0x2::object::ID",value:t}}),o=he(s);if(o){const r=o.value.fields.value.fields;return this.updateCache(n,r,Kt),r}}catch{}}async getVeNftAmount(t,e){try{const n=await this.sdk.ClmmSDK.fullClient.getDynamicFieldObject({parentId:t,name:{type:"0x2::object::ID",value:e}}),i=he(n);if(i){const{lock_amount:s,xtoken_amount:o}=i.value.fields.value.fields;return{lock_amount:s,xtoken_amount:o}}}catch{}return{lock_amount:"0",xtoken_amount:"0"}}async getPhaseDividendInfo(t,e=!1){const i=(await this.getDividendManager()).dividends.id,s=`${i}_${t}_getPhaseDividendInfo`,o=this._sdk.getCache(s,e);if(o)return o;try{const r=await this._sdk.ClmmSDK.fullClient.getDynamicFieldObject({parentId:i,name:{type:"u64",value:t}}),a=he(r),c=a.value.fields.value.fields,u=c.redeemed_num.fields.contents.map(_=>({name:_.fields.key.fields.name,value:_.fields.value})),l=c.bonus_types.map(_=>_.fields.name),d=c.bonus.fields.contents.map(_=>({name:_.fields.key.fields.name,value:_.fields.value})),f={id:Ri(r),phase:a.name,settled_num:c.settled_num,register_time:c.register_time,redeemed_num:u,is_settled:c.is_settled,bonus_types:l,bonus:d,phase_end_time:""};return this.updateCache(s,f),f}catch{}}updateCache(t,e,n=gi){let i=this._cache[t];i?(i.overdueTime=on(n),i.value=e):i=new Yn(e,on(n)),this._cache[t]=i}getCache(t,e=!1){const n=this._cache[t];if(!e&&(n!=null&&n.isValid()))return n.value;delete this._cache[t]}},Yk=class{constructor(t){Ft(this,"_sdk");Ft(this,"_cache",{});this._sdk=t}get sdk(){return this._sdk}async addMasterLiquidity(t){var v,k;const{liquidity_stratefy:e}=this._sdk.sdkOptions,{clmm_pool:n}=this._sdk.ClmmSDK.sdkOptions,i=await this._sdk.ClmmSDK.getOwnerCoinAssets(this._sdk.ClmmSDK.senderAddress);let s=D(0),o=D(0);const r=[],a=[],c=[],u=[],l=[];t.liquidity_bins.forEach((U,R)=>{const A=t.amounts_a[R],P=t.amounts_b[R],M=t.bins_fix_amount_a[R];s=s.add(A),o=o.add(P),r.push(A),a.push(P),c.push(Nn(BigInt(U.tick_lower)).toString()),u.push(Nn(BigInt(U.tick_upper)).toString()),l.push(M)});const d=[t.coinTypeA,t.coinTypeB],f=new vt,_=(v=ye.buildAddLiquidityFixTokenCoinInput(f,!t.fix_amount_a,s.toString(),t.slippage,t.coinTypeA,i,!1))==null?void 0:v.targetCoin,T=(k=ye.buildAddLiquidityFixTokenCoinInput(f,t.fix_amount_a,o.toString(),t.slippage,t.coinTypeB,i,!1))==null?void 0:k.targetCoin;return Gk(t)?f.moveCall({target:`${e.published_at}::router::increase_liquidity`,typeArguments:d,arguments:[f.object(J(e).master_manger_id),f.object(t.master_address),f.object(J(n).global_config_id),f.object(t.pool_address),_,T,f.pure(r.map(U=>f.pure(U,"u64"))),f.pure(a.map(U=>f.pure(U,"u64"))),f.pure(l.map(U=>f.pure(U,"bool"))),f.object(Bt)]}):f.moveCall({target:`${e.published_at}::router::create_master_liquidity`,typeArguments:d,arguments:[f.object(J(e).master_manger_id),f.object(J(n).global_config_id),f.object(t.pool_address),_,T,f.pure(c.map(U=>f.pure(U,"u32"))),f.pure(u.map(U=>f.pure(U,"u32"))),f.pure(r.map(U=>f.pure(U,"u64"))),f.pure(a.map(U=>f.pure(U,"u64"))),f.pure(l.map(U=>f.pure(U,"bool"))),f.pure(t.strategy),f.pure(Nn(BigInt(t.tick_lower)).toString()),f.pure(Nn(BigInt(t.tick_upper)).toString()),f.object(Bt)]}),f}buildMasterNFTType(){return`${this._sdk.sdkOptions.liquidity_stratefy.package_id}::master_liquidity::MasterLiquidity`}async getMasterNFTList(t,e=[]){const n=[],i=await this._sdk.ClmmSDK.fullClient.getOwnedObjectsByPage(t,{options:{showType:!0,showContent:!0,showDisplay:!0,showOwner:!0},filter:{Package:this._sdk.sdkOptions.liquidity_stratefy.package_id}}),s=e.length>0;for(const o of i.data)if(ht(o.data.type).full_address===this.buildMasterNFTType()){const a=Yi.buildMasterNFT(o);if(a){const c=`${a.id}_masterNFT`;this.updateCache(c,a,Kt),s?e.includes(a.pool_id)&&n.push(a):n.push(a)}}return n}async getMasterNFT(t,e=!1){const n="$masterId}_masterNFT",i=this.getCache(n,e);if(i)return i;try{const s=await this._sdk.ClmmSDK.fullClient.getObject({id:t,options:{showType:!0,showContent:!0,showDisplay:!0,showOwner:!0}});if(ht(s.data.type).full_address===this.buildMasterNFTType()){const r=Yi.buildMasterNFT(s);return r&&this.updateCache(n,r,Kt),r}}catch(s){console.log(s)}}async fetchMasterPositionInfos(t){var a;const e={},{clmm_pool:n,integrate:i,simulationAccount:s}=this.sdk.ClmmSDK.sdkOptions,o=new vt;return t.forEach(c=>{c.position_ids.forEach(u=>{const l=[c.coinTypeA,c.coinTypeB],d=[o.object(J(n).global_config_id),o.object(c.pool_id),o.object(u)];o.moveCall({target:`${i.published_at}::${Pi}::fetch_position_fees`,arguments:d,typeArguments:l}),o.moveCall({target:`${i.published_at}::${Pi}::fetch_position_rewards`,arguments:[...d,o.object(Bt)],typeArguments:l})})}),(a=(await this.sdk.ClmmSDK.fullClient.devInspectTransactionBlock({transactionBlock:o,sender:s.address})).events)==null||a.forEach(c=>{const{parsedJson:u}=c,{position_id:l}=u;let d=e[l];switch(d===void 0&&(d={position_id:l,feeOwedA:"0",feeOwedB:"0",rewarders:[]},e[l]=d),ht(c.type).name){case"FetchPositionFeesEvent":d.feeOwedA=u.fee_owned_a,d.feeOwedB=u.fee_owned_b;break;case"FetchPositionRewardsEvent":d.rewarders=u.data;break}}),e}async getLiquidityStrategyConfigs(t=!1){const{package_id:e}=this._sdk.sdkOptions.liquidity_stratefy,n=`${e}_getLiquidityStrategyConfigst`,i=this.getCache(n,t);if(i!==void 0)return i;const s=(await this._sdk.ClmmSDK.fullClient.queryEventsByPage({MoveEventType:`${e}::master_liquidity::MasterLiquidityManagerCreatedEvent`})).data,o={master_manger_id:"",master_liquidity_handle:""};if(s.length>0){for(const r of s){const a=r.parsedJson;o.master_manger_id=a.id;const c=await this._sdk.ClmmSDK.fullClient.getObject({id:a.id,options:{showContent:!0}}),u=he(c);o.master_liquidity_handle=u.position_maps.fields.id.id;break}this.updateCache(n,o,Kt)}return o}removeMasterLiquidity(t){const{clmm_pool:e}=this.sdk.ClmmSDK.sdkOptions,{liquidity_stratefy:n}=this.sdk.sdkOptions,i=new vt,s=[t.coinTypeA,t.coinTypeB];this.collectReward({coinTypeA:t.coinTypeA,coinTypeB:t.coinTypeB,collect_fee:!1,rewarder_coin_types:t.rewarder_coin_types,master_address:t.master_address,pool_address:t.pool_address},i);const o=[i.object(J(n).master_manger_id),i.object(t.pool_address),i.object(t.master_address),i.object(J(e).global_config_id),i.pure(t.delta_liquidities.map(r=>i.pure(r,"u128"))),i.pure(t.min_amounts_a.map(r=>i.pure(r,"u64"))),i.pure(t.min_amounts_b.map(r=>i.pure(r,"u64"))),i.object(Bt)];return i.moveCall({target:`${n.published_at}::${ka}::remove_liquidity`,typeArguments:s,arguments:o}),i}closeMasterLiquidity(t){const{clmm_pool:e}=this.sdk.ClmmSDK.sdkOptions,{liquidity_stratefy:n}=this.sdk.sdkOptions,i=new vt,s=[t.coinTypeA,t.coinTypeB];return this.collectReward({coinTypeA:t.coinTypeA,coinTypeB:t.coinTypeB,collect_fee:!1,rewarder_coin_types:t.rewarder_coin_types,master_address:t.master_address,pool_address:t.pool_address},i),i.moveCall({target:`${n.published_at}::${ka}::close_master_liquidity`,typeArguments:s,arguments:[i.object(J(n).master_manger_id),i.object(t.master_address),i.object(J(e).global_config_id),i.object(t.pool_address),i.pure(t.min_amounts_a.map(o=>i.pure(o,"u64"))),i.pure(t.min_amounts_b.map(o=>i.pure(o,"u64"))),i.object(Bt)]}),i}collectFee(t,e){const{clmm_pool:n}=this.sdk.ClmmSDK.sdkOptions,{liquidity_stratefy:i}=this.sdk.sdkOptions;e=e===void 0?new vt:e;const s=[t.coinTypeA,t.coinTypeB],o=[e.object(J(i).master_manger_id),e.object(t.master_address),e.object(J(n).global_config_id),e.object(t.pool_address)];return e.moveCall({target:`${i.published_at}::${ka}::collect_fee`,typeArguments:s,arguments:o}),e}collectReward(t,e){const{clmm_pool:n}=this.sdk.ClmmSDK.sdkOptions,{liquidity_stratefy:i}=this.sdk.sdkOptions;return e=e===void 0?new vt:e,t.collect_fee&&this.collectFee({...t},e),t.rewarder_coin_types.forEach(s=>{const o=[t.coinTypeA,t.coinTypeB,s];if(e){const r=[e.object(J(i).master_manger_id),e.object(t.master_address),e.object(J(n).global_config_id),e.object(t.pool_address),e.object(J(n).global_vault_id),e.object(Bt)];e.moveCall({target:`${i.published_at}::${ka}::collect_reward`,typeArguments:o,arguments:r})}}),e}updateCache(t,e,n=gi){let i=this._cache[t];i?(i.overdueTime=on(n),i.value=e):i=new Yn(e,on(n)),this._cache[t]=i}getCache(t,e=!1){const n=this._cache[t],i=n==null?void 0:n.isValid();if(!e&&i)return n.value;i||delete this._cache[t]}},Qk=class{constructor(t){Ft(this,"_sdk");Ft(this,"_cache",{});this._sdk=t}get sdk(){return this._sdk}buildCoinInput(t,e,n,i,s){const{selectedCoins:o,remainingCoins:r}=Ze.selectCoinAssetGreaterThanOrEqual(e,BigInt(i)),a=Ze.calculateTotalBalance(o);if(a<BigInt(i))throw new Error(`The amount(${a}) is Insufficient balance for ${n} , expect ${i} `);const c=a-BigInt(i);let u;if(Ze.isSuiCoin(n))u=t.splitCoins(t.gas,[t.pure(i)]);else{const[l,...d]=o.map(f=>f.coinObjectId);u=t.object(l),d.length>0?s?t.mergeCoins(u,[...d.map(f=>t.object(f)),s]):t.mergeCoins(u,[...d.map(f=>t.object(f))]):s&&t.mergeCoins(u,[s])}return{selectedUnusedAmount:c,coinInput:u,remainingCoins:r}}async deposit(t){var d,f;console.log("1110 deposit 参数: ",{params:t});const{vaults:e,frams:n}=this._sdk.sdkOptions,{clmm_pool:i}=this._sdk.ClmmSDK.sdkOptions,s=await this._sdk.ClmmSDK.getOwnerCoinAssets(this._sdk.getVerifySenderAddress()),o=new vt;let r,a;if(t.swapParams){const _=await this.handleDepositSwap(t,o,s);r=_.primaryCoinAInputs,a=_.primaryCoinBInputs}else r=(d=ye.buildAddLiquidityFixTokenCoinInput(o,!t.fix_amount_a,t.amount_a,t.slippage,t.coinTypeA,s,!1))==null?void 0:d.targetCoin,a=(f=ye.buildAddLiquidityFixTokenCoinInput(o,t.fix_amount_a,t.amount_b,t.slippage,t.coinTypeB,s,!1))==null?void 0:f.targetCoin;const c=J(e),u=J(n),l=J(i);return o.moveCall({target:`${e.published_at}::${Wk}::deposit`,typeArguments:[t.coinTypeA,t.coinTypeB,t.lp_token_type],arguments:[o.object(c.vaults_manager_id),o.object(t.vault_id),o.object(u.rewarder_manager_id),o.object(u.global_config_id),o.object(t.farming_pool),o.object(l.global_config_id),o.object(t.clmm_pool),r,a,o.pure(t.amount_a),o.pure(t.amount_b),o.pure(t.fix_amount_a),o.object(Bt)]}),o}async handleDepositSwap(t,e,n){const{clmm_pool:i,integrate:s}=this._sdk.ClmmSDK.sdkOptions,{swap_amount:o,a2b:r,route_obj:a,staking_id:c}=t.swapParams,u=r?t.coinTypeA:t.coinTypeB,l=ye.buildCoinForAmount(e,n,BigInt(o),u,!1),d=BigInt(l.tragetCoinAmount)-BigInt(o);let f=[];if(c){const U=this.requestStakeCoin(c,e,l.targetCoin),R=ye.buildCoinForAmount(e,l.remainCoins,BigInt(0),u,!1).targetCoin;f=r?[R,U]:[U,R]}else if(a){const U=ye.buildCoinForAmount(e,n,0n,r?t.coinTypeB:t.coinTypeA,!1),R=await ye.buildAggregatorSwapReturnCoins(this._sdk.ClmmSDK,a,l,U,"",t.slippage,e);f=r?[R.fromCoin,R.toCoin]:[R.toCoin,R.fromCoin],console.log("swapCoinInputTo.isMintZeroCoin: ",U),!U.isMintZeroCoin&&U.originalSplitedCoin===void 0&&e.transferObjects([U.targetCoin],e.pure(this._sdk.getVerifySenderAddress()))}else{const U=ye.buildCoinForAmount(e,n,0n,r?t.coinTypeB:t.coinTypeA,!1),R=Wi.getDefaultSqrtPriceLimit(r).toString();f=e.moveCall({target:`${s.published_at}::${Ns}::swap`,typeArguments:[t.coinTypeA,t.coinTypeB],arguments:[e.object(J(i).global_config_id),e.object(t.clmm_pool),r?l.targetCoin:U.targetCoin,r?U.targetCoin:l.targetCoin,e.pure(r),e.pure(!0),e.pure(o),e.pure(R),e.pure(!1),e.object(Bt)]})}let _,T;const v=f[0],k=f[1];if(r){const U=BigInt(t.amount_a)-d;Ze.isSuiCoin(u)?(e.transferObjects([v],e.pure(this._sdk.getVerifySenderAddress())),_=e.splitCoins(e.gas,[e.pure(t.amount_a)])):U>0n?_=this.buildCoinInput(e,l.remainCoins,u,U,v).coinInput:_=v,T=k}else{_=v;const U=BigInt(t.amount_b)-d;Ze.isSuiCoin(u)?(e.transferObjects([k],e.pure(this._sdk.getVerifySenderAddress())),T=e.splitCoins(e.gas,[e.pure(t.amount_b)])):U>0n?T=this.buildCoinInput(e,l.remainCoins,u,U,k).coinInput:T=k}return{primaryCoinAInputs:_,primaryCoinBInputs:T}}async remove(t){console.log({params:t});const{vaults:e,frams:n}=this.sdk.sdkOptions,{clmm_pool:i,integrate:s}=this._sdk.ClmmSDK.sdkOptions,o=new vt,r=await this._sdk.ClmmSDK.getOwnerCoinAssets(this._sdk.getVerifySenderAddress(),t.lp_token_type),a=ye.buildCoinForAmount(o,r,BigInt(t.lp_token_amount),t.lp_token_type,!1).targetCoin,c=J(e),u=J(n),l=J(i),d=[t.coinTypeA,t.coinTypeB,t.lp_token_type],f=o.moveCall({target:`${e.published_at}::${Xk}::remove`,typeArguments:d,arguments:[o.object(c.vaults_manager_id),o.object(t.vault_id),o.object(u.rewarder_manager_id),o.object(u.global_config_id),o.object(t.farming_pool),o.object(l.global_config_id),o.object(t.clmm_pool),a,o.pure(t.lp_token_amount),o.pure(t.min_amount_a),o.pure(t.min_amount_b),o.object(Bt)]}),_=f[0],T=f[1];if(t.swapParams){const{a2b:v,swap_amount:k,route_obj:U}=t.swapParams;if(U){const R={targetCoin:v?_:T,remainCoins:[],isMintZeroCoin:!1,tragetCoinAmount:""},A={targetCoin:v?T:_,remainCoins:[],isMintZeroCoin:!1,tragetCoinAmount:""},P=await ye.buildAggregatorSwapReturnCoins(this._sdk.ClmmSDK,U,R,A,"",t.slippage,o),M=v?[P.fromCoin,P.toCoin]:[P.toCoin,P.fromCoin];v?o.mergeCoins(M[1],[T]):o.mergeCoins(M[0],[_]),o.transferObjects([...M],o.pure(this._sdk.getVerifySenderAddress()))}else{const R=Wi.getDefaultSqrtPriceLimit(v).toString(),A=o.moveCall({target:`${s.published_at}::${Ns}::swap`,typeArguments:[t.coinTypeA,t.coinTypeB],arguments:[o.object(J(i).global_config_id),o.object(t.clmm_pool),_,T,o.pure(v),o.pure(!0),o.pure(k),o.pure(R),o.pure(!0),o.object(Bt)]});o.transferObjects([A[0],A[1]],o.pure(this._sdk.getVerifySenderAddress()))}}else o.transferObjects([_,T],o.pure(this._sdk.getVerifySenderAddress()));return o}async getVaultList(t="all"){const{vaults:e}=this._sdk.sdkOptions,n=await this._sdk.ClmmSDK.fullClient.queryEventsByPage({MoveEventType:`${e.package_id}::vaults::CreateEvent`},t),i=n.data.map(r=>r.parsedJson.id),s=await this._sdk.ClmmSDK.fullClient.batchGetObjects(i,{showType:!0,showContent:!0,showDisplay:!0,showOwner:!0}),o=[];return s.forEach(r=>{const a=ji.buildPool(r);a&&(a.staking_id=this.findHaedalStakeId(a.position.coinTypeA,a.position.coinTypeB),this.savePoolToCache(a),o.push(a))}),n.data=o,n}findHaedalStakeId(t,e){var o;const{haedal:n}=this._sdk.sdkOptions,{support_stakings:i}=J(n);return i.length===0?void 0:((o=i.filter(r=>{const a=ht(r.from_coin_type).full_address,c=ht(r.to_coin_type).full_address,u=ht(t).full_address,l=ht(e).full_address;return u===a&&l===c||u===c&&l===a})[0])==null?void 0:o.staking_id)||void 0}savePoolToCache(t){const e=`${t.id}_mirrorPool`;this.updateCache(e,t,Kt)}readPoolFromCache(t,e=!1){const n=`${t}_mirrorPool`;return this.getCache(n,e)}async calculateMaxAvailable(t){var v;const{integrate:e,simulationAccount:n}=this.sdk.ClmmSDK.sdkOptions,i=new vt,s=Nt.tickIndexToSqrtPriceX64(t.lowerTick),o=Nt.tickIndexToSqrtPriceX64(t.upperTick),r=new y(t.curSqrtPrice),a=dn.getCoinAmountFromLiquidity(new y(t.input_amount),r,s,o,!1),c=[t.coinTypeA,t.coinTypeB];i.moveCall({target:`${e.published_at}::${Pi}::calculate_swap_result`,arguments:[i.object(t.clmm_pool),i.pure(!0),i.pure(!0),i.pure(a.coinA.toString())],typeArguments:c}),i.moveCall({target:`${e.published_at}::${Pi}::calculate_swap_result`,arguments:[i.object(t.clmm_pool),i.pure(!1),i.pure(!0),i.pure(a.coinB.toString())],typeArguments:c});const l=(v=(await this.sdk.ClmmSDK.fullClient.devInspectTransactionBlock({transactionBlock:i,sender:n.address})).events)==null?void 0:v.filter(k=>ht(k.type).name==="CalculatedSwapResultEvent");if(l.length===0)return null;const d=l[0].parsedJson.data,f=l[1].parsedJson.data,_=D(a.coinB.toString()).add(d.amount_out),T=D(a.coinA.toString()).add(f.amount_out);return{maxAmountB:_,maxAmountA:T}}async calculateRemoveSwapAmount(t,e){const n=ji.calculateDepositRatio(t.lowerTick,t.upperTick,new y(t.curSqrtPrice)),i=t.fix_amount_a?n.ratioA:n.ratioB;console.log({fixRatio:i});let s=D(t.receive_amount).mul(i),o,r;if(t.removeLiquidity){const v=Nt.tickIndexToSqrtPriceX64(t.lowerTick),k=Nt.tickIndexToSqrtPriceX64(t.upperTick),U=dn.getCoinAmountFromLiquidity(new y(t.removeLiquidity),new y(t.curSqrtPrice),v,k,!1);r=t.removeLiquidity,o=t.fix_amount_a?U.coinB.toString():U.coinA.toString(),s=t.fix_amount_a?D(U.coinA.toString()):D(U.coinB.toString())}else{const v=dn.estLiquidityAndcoinAmountFromOneAmounts(t.lowerTick,t.upperTick,new y(s.toFixed(0)),t.fix_amount_a,!1,.2,new y(t.curSqrtPrice));r=v.liquidityAmount.toString(),o=t.fix_amount_a?v.coinAmountB.toString():v.coinAmountA.toString()}console.log({fixAmount:s,otherSideAmount:o});const a=!t.fix_amount_a,c=await this.clmmPreSwap(t.clmm_pool,t.curSqrtPrice,a,D(o),t.coinTypeA,t.coinTypeB,!0,t.priceSplitPoint,t.use_route,[{pool_id:t.clmm_pool,tick_lower:t.lowerTick,tick_upper:t.upperTick,delta_liquidity:Number(r),is_increase:!1}]);console.log({data:c,range:e});const u=s.add(c.amount_out),l=D(t.receive_amount),d=l.sub(u);if(console.log(`实际得到: ${u.toString()} , 期望得到: ${t.receive_amount}, 剩余: ${d.toString()} `),(!t.removeLiquidity||t.removeLiquidity&&e)&&d.abs().greaterThan(l.mul(.01))){const v=u.lessThan(l);let k,U;e?v?(k=D(r),U=e.right):(k=e.left,U=D(r)):(k=D(v?r:0),U=D(v?t.maxLiquidity:r));const R=D(k).add(U).div(2).toFixed(0);if(console.log({left:k.toString(),right:U.toString(),midLiquidity:R.toString()}),!e||e&&e.count<15&&k<U)return await this.calculateRemoveSwapAmount({...t,removeLiquidity:R},{left:k,right:U,count:e?e.count+1:0})}const f=c.amount_in&&c.fee_amount?new y(c.amount_in).add(new y(c.fee_amount)).toString():c.amount_in,_=c.amount_out,{is_exceed:T}=c;return{swapInAmount:f,swapOutAmount:_,liquidity:r,is_exceed:T,routeObj:c.route_obj,request_id:t.request_id}}async calculateHaedalDepositFixSui(t){const e=t.inputSuiAmount.mul(t.remainRate),n=t.inputSuiAmount.sub(t.swapSuiAmount),i=t.exchangeRate?t.exchangeRate:await this.getExchangeRateForHaedal(t.staking_id,t.shouldRequestStake,Number(t.swapSuiAmount.toFixed(0))),s=t.swapSuiAmount.div(i).toFixed(0);console.log({swapAmount:t.swapSuiAmount.toString(),hasuiAmount:s.toString(),leftSuiAmount:t.leftSuiAmount.toString(),rightSuiAmount:t.rightSuiAmount.toString(),exchangeRate:i});const o=dn.estLiquidityAndcoinAmountFromOneAmounts(t.lowerTick,t.upperTick,new y(s.toString()),!t.fixCoinA,!0,0,new y(t.curSqrtPrice)),r=t.fixCoinA?o.coinAmountA.toString():o.coinAmountB.toString(),a=D(n).sub(r);return console.log({useSuiAmount:r.toString(),hasuiAmount:s.toString(),remainSui:n.toString(),remainSuiLimit:e.toString(),actRemainSui:a.toString(),rebalanceCount:t.rebalanceCount}),a.greaterThanOrEqualTo(0)&&a.lessThanOrEqualTo(e)||t.rebalanceCount>12||t.leftSuiAmount.greaterThanOrEqualTo(t.rightSuiAmount)?{swapInAmount:t.swapSuiAmount.toFixed(0),swapOutAmount:s,afterSqrtPrice:t.curSqrtPrice,fixAmountA:!t.fixCoinA,is_exceed:!0,request_id:"",staking_id:t.staking_id}:a.lessThan(0)?await this.calculateHaedalDepositFixSui({...t,rightSuiAmount:t.swapSuiAmount,swapSuiAmount:t.swapSuiAmount.add(t.leftSuiAmount).div(2),exchangeRate:i,rebalanceCount:t.rebalanceCount+1}):a.greaterThan(e)?await this.calculateHaedalDepositFixSui({...t,leftSuiAmount:t.swapSuiAmount,swapSuiAmount:t.swapSuiAmount.add(t.rightSuiAmount).div(2),exchangeRate:i,rebalanceCount:t.rebalanceCount+1}):null}async calculateDepositSwapAmount(t,e=!1){const n=Nt.sqrtPriceX64ToTickIndex(new y(t.curSqrtPrice)),{ratioA:i,ratioB:s}=ji.calculateDepositRatio(t.lowerTick,t.upperTick,new y(t.curSqrtPrice));console.log("1110 calculateDepositSwapAmount params: ",{...t,currentTick:n,adjustBestAmount:e});const o=D(t.input_amount).mul(t.fix_amount_a?i:s);let r=D(t.input_amount).sub(o);console.log("1110 ",{fixAmount:o.toString(),swapAmount:r.toString()});const a=t.fix_amount_a;if(r.toFixed(0)==="0")return null;if(t.staking_id){if(Ze.isSuiCoin(t.coinTypeA)&&t.fix_amount_a||Ze.isSuiCoin(t.coinTypeB)&&!t.fix_amount_a){const K=await this.calculateHaedalDepositFixSui({inputSuiAmount:D(t.input_amount),swapSuiAmount:r,lowerTick:t.lowerTick,upperTick:t.upperTick,curSqrtPrice:t.curSqrtPrice,remainRate:t.remainRate?t.remainRate:.01,fixCoinA:t.fix_amount_a,rebalanceCount:0,shouldRequestStake:t.shouldRequestStake,leftSuiAmount:a?new it(r.toFixed(0)):new it(0),rightSuiAmount:a?new it(t.input_amount):new it(r.toFixed(0)),staking_id:t.staking_id});return K?{...K,request_id:t.request_id}:null}throw Error("Only support fix sui")}const c=n<t.lowerTick||n>t.upperTick,u={clmm_pool:t.clmm_pool,curSqrtPrice:t.curSqrtPrice,a2b:a,amount_a:a?new it(t.input_amount):new it(0),amount_b:a?new it(0):new it(t.input_amount),amount_left:a?new it(r.toFixed(0)):new it(0),amount_right:a?new it(t.input_amount):new it(r.toFixed(0)),lowerTick:t.lowerTick,upperTick:t.upperTick,tick_spacing:2,coinTypeA:t.coinTypeA,coinTypeB:t.coinTypeB,useRoute:t.use_route,remainRate:t.remainRate?t.remainRate:.01,priceSplitPoint:t.priceSplitPoint},l=e&&n<=t.upperTick;let d=l?await this.calculateRebalance(u):await this.clmmPreSwap(t.clmm_pool,t.curSqrtPrice,a,r,t.coinTypeA,t.coinTypeB,!0,t.priceSplitPoint,t.use_route),f=d.after_sqrt_price;const _=Nt.sqrtPriceX64ToTickIndex(new y(f));console.log("1110 首次计算 结果: ",{...d,currentTick:_},null,2);const T=_<t.lowerTick||_>t.upperTick;if(c!==T&&!l&&_<=t.upperTick){console.log("1110 区间发生变化, 再次进行swap: ");const{ratioA:K,ratioB:Y}=ji.calculateDepositRatio(t.lowerTick,t.upperTick,new y(f));console.log("1110 ",{newAfterRatioA:K,newAfterRatioB:Y}),r=D(t.input_amount).sub(D(t.input_amount).mul(t.fix_amount_a?K:Y)),u.amount_left=a?new it(r.toFixed(0)):new it(0),u.amount_right=a?new it(t.input_amount):new it(r.toFixed(0)),d=await this.calculateRebalance(u),f=d.after_sqrt_price;const X=Nt.sqrtPriceX64ToTickIndex(new y(f));console.log("1110 再次计算变化后: ",{lowerTick:t.lowerTick,upperTick:t.upperTick,currentTick:X,afterSqrtPrice:f})}const{ratioA:v,ratioB:k}=ji.calculateDepositRatio(t.lowerTick,t.upperTick,new y(f));console.log("1110 1",{afterRatioA:v,afterRatioB:k,data:d});let U=k.div(v).sub(s.div(i)).greaterThan("0");const R=d.amount_in&&d.fee_amount?new y(d.amount_in).add(new y(d.fee_amount)).toString():d.amount_in,A=d.amount_out,{is_exceed:P}=d;if(_<t.lowerTick)U=!0;else if(_>t.upperTick)U=!1;else{const K=U===a?new y(D(t.input_amount).sub(R).toString()):new y(A),Y=dn.estLiquidityAndcoinAmountFromOneAmounts(t.lowerTick,t.upperTick,K,U,!0,0,new y(f)),X=Y.coinAmountA,et=Y.coinAmountB,z=D(t.fix_amount_a?X.toString():et.toString()).add(R);console.log("1110 实际消耗:",{preAmountTotal:z.toString(),fixAmountA:U}),z.greaterThanOrEqualTo(t.input_amount)&&(U=!U)}const M={swapInAmount:R,swapOutAmount:A,afterSqrtPrice:f,is_exceed:P,fixAmountA:U,routeObj:d.route_obj,request_id:t.request_id,use_Haedal_stake:!1};return console.log(M),M}async calculateHaedalDepositSwapAmount(t){const e=Nt.sqrtPriceX64ToTickIndex(new y(t.curSqrtPrice)),{ratioA:n,ratioB:i}=ji.calculateDepositRatio(t.lowerTick,t.upperTick,new y(t.curSqrtPrice));console.log("1110 calculateDepositSwapAmount params: ",{...t,currentTick:e});const s=D(t.input_amount).mul(t.fix_amount_a?n:i),o=D(t.input_amount).sub(s);console.log("1110 ",{fixAmount:s.toString(),swapAmount:o.toString()});const r=t.fix_amount_a;if(o.toFixed(0)==="0")return null;if(t.staking_id){if(Ze.isSuiCoin(t.coinTypeA)&&t.fix_amount_a||Ze.isSuiCoin(t.coinTypeB)&&!t.fix_amount_a){const a=await this.calculateHaedalDepositFixSui({inputSuiAmount:D(t.input_amount),swapSuiAmount:o,lowerTick:t.lowerTick,upperTick:t.upperTick,curSqrtPrice:t.curSqrtPrice,remainRate:t.remainRate?t.remainRate:.01,fixCoinA:t.fix_amount_a,rebalanceCount:0,shouldRequestStake:t.shouldRequestStake,leftSuiAmount:r?new it(o.toFixed(0)):new it(0),rightSuiAmount:r?new it(t.input_amount):new it(o.toFixed(0)),staking_id:t.staking_id});return a?{...a,request_id:t.request_id}:null}throw Error("Only support fix sui")}return null}async calculateRebalance(t){const{clmm_pool:e,a2b:n,curSqrtPrice:i,amount_a:s,amount_b:o,lowerTick:r,upperTick:a,amount_left:c,amount_right:u,coinTypeA:l,coinTypeB:d,useRoute:f,priceSplitPoint:_,remainRate:T}=t,v=async(k,U,R)=>{const A=k.plus(U).div(2),P=await this.clmmPreSwap(e,i,n,A,l,d,!0,_,f);if(P.amount_out==="0")return P;if(P.after_sqrt_price||(P.after_sqrt_price=t.curSqrtPrice),P.is_exceed)return U=A,v(k,U,R+1);const M=n?s.sub(P.amount_in):s.add(P.amount_out),K=n?o.add(P.amount_out):o.sub(P.amount_in),Y=Nt.sqrtPriceX64ToTickIndex(new y(P.after_sqrt_price)),X=dn.estLiquidityAndcoinAmountFromOneAmounts(r,a,new y(M.toString()),!0,!0,1,new y(P.after_sqrt_price)),et=new it(X.coinAmountA.toString()),z=new it(X.coinAmountB.toString());if(console.log("1110 swap递归计算 ",{preRes:P,left:k.toString(),right:U.toString(),mid:A.toString(),afterPoolTickIndex:Y,afterA:M.toString(),afterB:K.toString(),usedA:et.toString(),usedB:toString(),count:R}),et.toString()!==M.toString())throw new Error("usedA does not match afterA");if(K.lessThan(z))n?k=A:U=A;else{n?U=A:k=A;const O=K.sub(z),$=K.mul(T);if(console.log("1110 剩余未使用amount ",{remainingB:O.toString(),maxRemainingB:$.toString(),remainRate:T,count:R}),$.sub(O).greaterThanOrEqualTo(0))return console.log("break"),{...P,remainingB:O}}return k.greaterThan(U)||U.sub(k).lessThan(10)?P:v(k,U,R+1)};return c.greaterThanOrEqualTo(u)?v(new it(0),c,0):v(c,u,0)}async clmmPreSwap(t,e,n,i,s,o,r,a,c,u){var U;if(c)try{const R=await this._sdk.ClmmSDK.RouterV2.getBestRouter(n?s:o,n?o:s,Number(i.toFixed(0)),r,a,"",void 0,void 0,!0,!1,u);if(!R.result)throw new Error("route unavailable");const{result:A}=R;let P=e;return A.splitPaths.forEach(M=>{const K=M.basePaths.find(Y=>Y.poolAddress.toLowerCase()===t.toLowerCase());K&&(P=K.afterSqrtPrice.toString())}),{amount_in:A.inputAmount.toString(),amount_out:A.outputAmount.toString(),after_sqrt_price:P,is_exceed:A.isExceed,route_obj:A}}catch{throw new Error("route unavailable")}const{integrate:l,simulationAccount:d}=this.sdk.ClmmSDK.sdkOptions,f=new vt,_=[s,o],T=[f.pure(t),f.pure(n),f.pure(r),f.pure(i.toFixed(0))];f.moveCall({target:`${l.published_at}::${Pi}::calculate_swap_result`,arguments:T,typeArguments:_});const k=(U=(await this.sdk.ClmmSDK.fullClient.devInspectTransactionBlock({transactionBlock:f,sender:d.address})).events)==null?void 0:U.filter(R=>ht(R.type).name==="CalculatedSwapResultEvent");return k.length===0?null:k[0].parsedJson.data}async getVault(t,e=!1){const n=this.readPoolFromCache(t,e);if(n)return n;try{const i=await this._sdk.ClmmSDK.fullClient.getObject({id:t,options:{showType:!0,showContent:!0,showDisplay:!0,showOwner:!0}}),s=ji.buildPool(i);if(s)return s.staking_id=this.findHaedalStakeId(s.position.coinTypeA,s.position.coinTypeB),this.savePoolToCache(s),s}catch(i){console.log(i)}}async getVaultsConfigs(t=!1){const{package_id:e}=this._sdk.sdkOptions.vaults,n=`${e}_getMirrorPoolConfigs`,i=this.getCache(n,t);if(i!==void 0)return i;const s=(await this._sdk.ClmmSDK.fullClient.queryEventsByPage({MoveEventType:`${e}::vaults::InitEvent`})).data,o={admin_cap_id:"",vaults_manager_id:"",vaults_pool_handle:""};if(s.length>0){for(const r of s){const a=r.parsedJson;o.admin_cap_id=a.admin_cap_id,o.vaults_manager_id=a.manager_id;const c=await this._sdk.ClmmSDK.fullClient.getObject({id:o.vaults_manager_id,options:{showContent:!0}}),u=he(c);o.vaults_pool_handle=u.vault_to_pool_maps.fields.id.id;break}this.updateCache(n,o,Kt)}return o}async getExchangeRateForHaedal(t,e,n){const{haedal:i}=this._sdk.sdkOptions,{simulationAccount:s}=this._sdk.ClmmSDK.sdkOptions;try{const o=new vt;e?await this.requestStake(t,n||1e9,o):o.moveCall({target:`${i.published_at}::staking::get_exchange_rate`,typeArguments:[],arguments:[o.object(t)]});const r=await this._sdk.ClmmSDK.fullClient.devInspectTransactionBlock({transactionBlock:o,sender:e?this._sdk.ClmmSDK.senderAddress:s.address});if(console.log("getExchangeRateForHaedal res: ",r),e){const u=r.events.find(_=>_.type.includes("UserStaked")),{sui_amount:l,st_amount:d}=u.parsedJson,f=D(l).div(d).toString();return console.log({st_amount:d,sui_amount:l,rate:f}),f}const a=r.results[0].returnValues[0][0],c=Yu.de("u64",Uint8Array.from(a))/1e6;return console.log("rate ",Yu.de("u64",Uint8Array.from(a))),c.toString()}catch(o){console.log("getExchangeRateForHaedal",o)}return"0"}requestStakeCoin(t,e,n){const{haedal:i}=this._sdk.sdkOptions;return e.moveCall({target:`${i.published_at}::staking::request_stake_coin`,typeArguments:[],arguments:[e.object(Ln("0x5")),e.object(t),n,e.pure(Ln("0x0"))]})}async requestStake(t,e,n){const{haedal:i}=this._sdk.sdkOptions,s=await this._sdk.ClmmSDK.getOwnerCoinAssets(this._sdk.getVerifySenderAddress(),ac);n=n||new vt;let o;if(e>95e10){const[r,...a]=s;a.length>0&&n.mergeCoins(n.object(r.coinObjectId),a.map(c=>n.object(c.coinObjectId))),o=n.splitCoins(n.object(r.coinObjectId),[e])}else o=ye.buildCoinForAmount(n,s,BigInt(e),ac,!1,!0).targetCoin;return n.moveCall({target:`${i.published_at}::interface::request_stake`,typeArguments:[],arguments:[n.object(Ln("0x5")),n.object(t),o,n.pure(Ln("0x0"))]}),n}updateCache(t,e,n=gi){let i=this._cache[t];i?(i.overdueTime=on(n),i.value=e):i=new Yn(e,on(n)),this._cache[t]=i}getCache(t,e=!1){const n=this._cache[t],i=n==null?void 0:n.isValid();if(!e&&i)return n.value;i||delete this._cache[t]}},Sa=class{static buildOrderLimitEvent(t){const{events:e}=t,n=[];return e&&e.forEach(i=>{const s=ht(i.type).name;if(s==="OrderPlacedEvent"||s==="OrderCanceledEvent"||s==="FlashLoanEvent"){const o={digest:t.digest,type:s,timestampMs:t.timestampMs,parsedJson:i.parsedJson};n.push(o)}}),n}static buildLimitOrderInfo(t){const e=he(t),n=Ys(t);if(e&&n)try{const i=ht(n),s={pay_coin_type:i.type_arguments[0],target_coin_type:i.type_arguments[1],balance:e.balance,canceled_ts:e.canceled_ts==="18446744073709551615"?0:Number(e.canceled_ts),id:e.id.id,obtained_amount:e.obtained_amount,owner:e.owner,rate:e.rate,expire_ts:Number(e.expire_ts),total_pay_amount:e.total_pay_amount,status:"Running",created_ts:Number(e.created_ts)};if(s.canceled_ts===0)s.status="Running";else if(Number(s.obtained_amount)===0)s.status="Cancelled";else{const o=D(s.total_pay_amount).mul(1e20).div(s.rate).toFixed(0);s.obtained_amount===o?s.status="Completed":s.status="Cancelled"}return s}catch(i){console.log(i)}}static calculateFormatRate(t,e,n){const i=20+e-n;return D(t).mul(D(10).pow(i)).toString()}static calculateRate(t,e,n){const i=20+e-n;return Number(t)/10**i}},t2=class{constructor(t){Ft(this,"_sdk");Ft(this,"_cache",{});this._sdk=t}get sdk(){return this._sdk}async getLimitOrderTokenList(){const{limit_order:t}=this._sdk.sdkOptions,{token_list_handle:e}=J(t),{fullClient:n}=this._sdk.ClmmSDK,s=(await n.getDynamicFieldsByPage(e)).data.map(r=>r.objectId);return(await n.batchGetObjects(s,{showContent:!0})).map(r=>{const{fields:a}=r.data.content;return{coin_type:ht(a.name.fields.name).full_address,min_trade_amount:Number(a.value)}})}async getLimitOrderPoolList(){const{limit_order:t}=this._sdk.sdkOptions,{rate_orders_indexer_handle:e}=J(t),{fullClient:n}=this._sdk.ClmmSDK,s=(await n.getDynamicFieldsByPage(e)).data.map(r=>r.objectId);return(await n.batchGetObjects(s,{showContent:!0})).map(r=>{const{fields:a}=r.data.content.fields.value,c={pay_coin_type:ht(a.pay_coin.fields.name).full_address,target_coin_type:ht(a.target_coin.fields.name).full_address,indexer_id:a.indexer_id};return this._sdk.updateCache(`${c.pay_coin_type}_${c.target_coin_type}`,c.indexer_id),c})}async getPoolIndexerId(t,e){const n=this._sdk.getCache(`${t}_${e}`);try{if(n===void 0){const s=(await this.getLimitOrderPoolList()).filter(o=>o.pay_coin_type===t&&o.target_coin_type===e);if(s.length>0)return s[0].indexer_id}}catch{}return n}async getOwnerLimitOrderList(t,e){const{fullClient:n}=this._sdk.ClmmSDK,i={data:[],hasNextPage:!1};try{const s=await this.getUserIndexerHandle(t);if(!s)return i;const o=await n.getDynamicFieldsByPage(s,e);i.hasNextPage=o.hasNextPage,i.nextCursor=o.nextCursor;const r=o.data.map(u=>u.name.value),c=(await n.batchGetObjects(r,{showContent:!0})).map(u=>Sa.buildLimitOrderInfo(u)).filter(u=>u!==void 0);i.data=c}catch(s){console.error("Error in getOwnerLimitOrderList:",s)}return i}async getLimitOrderConfigs(){const{package_id:t}=this._sdk.sdkOptions.limit_order,e={rate_orders_indexer_id:"",rate_orders_indexer_handle:"",global_config_id:"",token_list_handle:"",user_orders_indexer_id:"",user_orders_indexer_handle:""},n=(await this._sdk.ClmmSDK.fullClient.queryEventsByPage({MoveEventType:`${t}::limit_order::InitEvent`})).data;if(n.length>0){const s=n[0].parsedJson;e.rate_orders_indexer_id=s.rate_orders_indexer_id,e.user_orders_indexer_id=s.user_orders_indexer_id;const o=await this._sdk.ClmmSDK.fullClient.getObject({id:e.rate_orders_indexer_id,options:{showContent:!0}});e.rate_orders_indexer_handle=he(o).list.fields.id.id;const r=await this._sdk.ClmmSDK.fullClient.getObject({id:e.user_orders_indexer_id,options:{showContent:!0}});e.user_orders_indexer_handle=he(r).indexer.fields.id.id}const i=(await this._sdk.ClmmSDK.fullClient.queryEventsByPage({MoveEventType:`${t}::config::InitFactoryEvent`})).data;if(i.length>0){const s=i[0].parsedJson;e.global_config_id=s.global_config_id;const o=await this._sdk.ClmmSDK.fullClient.getObject({id:e.global_config_id,options:{showContent:!0}}),r=he(o);e.token_list_handle=r.token_white_list.fields.id.id}return e}async getLimitOrder(t){const{fullClient:e}=this._sdk.ClmmSDK;try{const n=await e.getObject({id:t,options:{showContent:!0}});return Sa.buildLimitOrderInfo(n)}catch(n){console.error("Error in getLimitOrder:",n);return}}async getLimitOrderLogs(t){const{fullClient:e}=this._sdk.ClmmSDK;try{const n=await e.queryTransactionBlocks({filter:{ChangedObject:t},options:{showEvents:!0}}),i=[];return n.data.forEach(s=>{i.push(...Sa.buildOrderLimitEvent(s))}),i}catch(n){return console.error("Error in getLimitOrderLogs:",n),[]}}buildRateOrdersIndexerType(t){const{limit_order:e}=this._sdk.sdkOptions;return rc(`${e.package_id}::limit_order::RateOrdersIndexer`,[t.pay_coin_type,t.target_coin_type])}async placeLimitOrder(t){const{limit_order:e}=this._sdk.sdkOptions,{user_orders_indexer_id:n,global_config_id:i,rate_orders_indexer_id:s}=J(e),o=await this._sdk.ClmmSDK.getOwnerCoinAssets(this._sdk.ClmmSDK.senderAddress,t.pay_coin_type),r=new vt,a=await this.getPoolIndexerId(t.pay_coin_type,t.target_coin_type),c=ye.buildCoinForAmount(r,o,BigInt(t.pay_coin_amount),t.pay_coin_type,!1,!0);return r.moveCall({target:`${e.published_at}::limit_order::${a===void 0?"create_indexer_and_place_limit_order":"place_limit_order"}`,typeArguments:[t.pay_coin_type,t.target_coin_type],arguments:[r.object(i),a===void 0?r.object(s):r.object(a),r.object(n),c.targetCoin,r.pure(Sa.calculateFormatRate(t.rate,t.pay_decimal,t.target_decimal)),r.pure(t.expired_ts),r.object(Bt)]}),r}async cancelOrdersByOwner(t){const{limit_order:e}=this._sdk.sdkOptions,{global_config_id:n}=J(e),i=new vt,s=await this.getPoolIndexerId(t.pay_coin_type,t.target_coin_type);if(s===void 0)throw Error("not found indexerId");return t.order_ids.forEach(o=>{i.moveCall({target:`${e.published_at}::limit_order::cancel_order_by_owner`,typeArguments:[t.pay_coin_type,t.target_coin_type],arguments:[i.object(n),i.object(s),i.object(o),i.object(Bt)]})}),i}async getUserIndexerHandle(t){const{fullClient:e}=this._sdk.ClmmSDK,{limit_order:n}=this._sdk.sdkOptions;let i=this.getUserIndexerHandleByCache(t);if(i===void 0){const s=new vt;s.moveCall({target:`${n.published_at}::limit_order::get_orders_indexer_by_owner`,typeArguments:[],arguments:[s.pure(t),s.object(J(n).user_orders_indexer_id)]}),i=(await e.devInspectTransactionBlock({transactionBlock:s,sender:this._sdk.ClmmSDK.sdkOptions.simulationAccount.address})).events[0].parsedJson.orders_table_id,i&&this.saveUserIndexerHandleByCache(t,i)}return i}getUserIndexerHandleByCache(t){const e=`getUserIndexerHandleByCache_${t}`;return this.getCache(e)}saveUserIndexerHandleByCache(t,e){const n=`getUserIndexerHandleByCache_${t}`;return this.updateCache(n,e)}updateCache(t,e,n=Kt){let i=this._cache[t];i?(i.overdueTime=on(n),i.value=e):i=new Yn(e,on(n)),this._cache[t]=i}getCache(t,e=!1){const n=this._cache[t],i=n==null?void 0:n.isValid();if(!e&&i)return n.value;i||delete this._cache[t]}},e2=class{constructor(t){Ft(this,"_sdk");Ft(this,"_cache",{});this._sdk=t}get sdk(){return this._sdk}async getFramsPoolList(t="all"){const{package_id:e}=this._sdk.sdkOptions.frams,n={data:[],hasNextPage:!1};try{const i=await this._sdk.ClmmSDK.fullClient.queryEventsByPage({MoveEventType:`${e}::pool::CreatePoolEvent`},t),s=i.data.map(o=>o.parsedJson.pool_id);if(n.hasNextPage=i.hasNextPage,n.nextCursor=i.nextCursor,s.length>0){const o=await this._sdk.ClmmSDK.fullClient.batchGetObjects(s,{showType:!0,showContent:!0});for(const r of o){const a=Oo.buildFramsPool(r);a&&(a.rewarders=await this.getFramsRewarderConfig(a.clmm_pool_id,a.rewarders.map(c=>c.reward_coin)),n.data.push(a),this.updateCache(a.id,a))}}}catch(i){console.log("getFramsPoolList error ",i)}return n}async getFramsPool(t,e=!1){const n=this.getCache(t,e);if(n)return n;const i=await this._sdk.ClmmSDK.fullClient.getObject({id:t,options:{showType:!0,showContent:!0}}),s=Oo.buildFramsPool(i.data);return s&&(s.rewarders=await this.getFramsRewarderConfig(s.clmm_pool_id,s.rewarders.map(o=>o.reward_coin)),this.updateCache(s.id,s)),s}async getFramsRewarderConfig(t,e,n=!1){const{frams:i}=this._sdk.sdkOptions,s=[];for(const o of e){const r=`getFramsRewarderConfig_${o}_${t}`,a=this.getCache(r,n);if(a)s.push(a);else try{const c=await this._sdk.ClmmSDK.fullClient.getDynamicFieldObject({parentId:J(i).rewarder_manager_handle,name:{type:"0x1::type_name::TypeName",value:m_(o)}}),{fields:u}=c.data.content.fields.value.fields.value,l={reward_coin:o,last_reward_time:u.last_reward_time,emission_per_second:u.emission_per_second,total_allocate_point:u.total_allocate_point,allocate_point:""},d=u.pools.fields.id.id,f=await this._sdk.ClmmSDK.fullClient.getDynamicFieldObject({parentId:d,name:{type:"0x2::object::ID",value:t}}),{allocate_point:_}=f.data.content.fields.value.fields.value.fields;l.allocate_point=_,this.updateCache(r,l),s.push(l)}catch(c){console.log(c)}}return s}async getOwnedFramsPositionNFTList(t,e=[],n=!1,i=!0,s="all"){const{package_id:o}=this._sdk.sdkOptions.frams,r={data:[],hasNextPage:!1};let a={};const c=[],u=e.length>0,l=await this._sdk.ClmmSDK.fullClient.getOwnedObjectsByPage(t,{filter:{StructType:`${o}::pool::WrappedPositionNFT`},options:{showContent:!0}},s);r.hasNextPage=l.hasNextPage,r.nextCursor=l.nextCursor;for(const d of l.data){const f=Oo.buildFramsPositionNFT(d);if(f)if(u){if(e.includes(f.pool_id)){c.push(f);let _=a[f.pool_id];_?_.push(f):_=[f],a[f.pool_id]=_}}else c.push(f)}if(n&&c.length>0){const d=await this.calculateFarmingRewards(c.map(f=>({pool_id:f.pool_id,position_nft_id:f.id,clmm_pool_id:f.clmm_pool_id})),i);u?(a={},c.forEach(f=>{d[f.id]&&(f.rewards=d[f.id]);let T=a[f.pool_id];T?T.push(f):T=[f],a[f.pool_id]=T})):c.forEach(f=>{d[f.id]&&(f.rewards=d[f.id])})}return u?a:(r.data=c,r)}async getFramsPositionNFT(t,e=!0){const n=await this._sdk.ClmmSDK.fullClient.getObject({id:t,options:{showContent:!0,showType:!0}}),i=Oo.buildFramsPositionNFT(n);if(e&&i){const s=await this.calculateFarmingRewards([{pool_id:i.pool_id,position_nft_id:i.id}]);s[i.id]&&(i.rewards=s[i.id])}return i}async calculateFarmingRewards(t,e=!0){var a;const{frams:n}=this._sdk.sdkOptions,i=new vt,{rewarder_manager_id:s,global_config_id:o}=J(n);t.forEach(c=>{i.moveCall({target:`${n.published_at}::router::accumulated_position_rewards`,typeArguments:[],arguments:[i.object(o),i.object(s),i.object(c.pool_id),i.pure(c.position_nft_id,"address"),i.object(Bt)]})});const r={};try{const c=await this._sdk.ClmmSDK.fullClient.sendSimulationTransaction(i,this._sdk.ClmmSDK.senderAddress,e);console.log({simulateRes:c});const u=(a=c==null?void 0:c.events)==null?void 0:a.filter(l=>ht(l.type).name==="AccumulatedPositionRewardsEvent");if(u&&u.length>0)for(let l=0;l<u.length;l+=1){const{parsedJson:d}=u[l],f=[];d.rewards.contents.forEach(_=>{f.push({rewarder_type:ht(_.key.name).full_address,rewarder_amount:_.value})}),r[d.wrapped_position_id]=f}}catch(c){console.log(c)}return r}depositPayload(t,e){const{frams:n}=this.sdk.sdkOptions;e=e||new vt;const{global_config_id:i,rewarder_manager_id:s}=J(n);return e.moveCall({target:`${n.published_at}::router::deposit`,typeArguments:[],arguments:[e.object(i),e.object(s),e.object(t.pool_id),e.object(t.clmm_position_id),e.object(Bt)]}),e}async withdrawPayload(t,e){const{frams:n}=this.sdk.sdkOptions,{global_config_id:i,rewarder_manager_id:s}=J(n);return e=e||new vt,e=await this.harvestPayload({pool_id:t.pool_id,position_nft_id:t.position_nft_id},e),e.moveCall({target:`${n.published_at}::router::withdraw`,typeArguments:[],arguments:[e.object(i),e.object(s),e.object(t.pool_id),e.object(t.position_nft_id),e.object(Bt)]}),e}async batchHarvestPayload(t,e){e=e||new vt;for(const n of t)await this.harvestPayload(n,e);return e}async harvestPayload(t,e){const{frams:n}=this.sdk.sdkOptions;e=e||new vt;const i=await this.getFramsPool(t.pool_id,!1);if(i===void 0)throw Error(`not found ${t.pool_id}`);const{global_config_id:s,rewarder_manager_id:o}=J(n);if("collect_fee"in t&&(t.collect_fee||t.clmm_rewarder_types.length>0)){const a=await this._sdk.ClmmSDK.getOwnerCoinAssets(this._sdk.ClmmSDK.senderAddress);e=await this.buildCollectRewarderAndFeeParams({clmm_pool_id:t.clmm_pool_id,position_nft_id:t.position_nft_id,coinTypeA:t.coinTypeA,coinTypeB:t.coinTypeB,collectFee:t.collect_fee,clmm_rewarder_types:t.clmm_rewarder_types},e,a)}return i.rewarders.forEach(a=>{e&&e.moveCall({target:`${n.published_at}::router::harvest`,typeArguments:[a.reward_coin],arguments:[e.object(s),e.object(o),e.object(t.pool_id),e.object(t.position_nft_id),e.object(Bt)]})}),e}async claimFeeAndClmmReward(t){const e=new vt,n=await this._sdk.ClmmSDK.getOwnerCoinAssets(this._sdk.ClmmSDK.senderAddress);return await this.buildCollectRewarderAndFeeParams({clmm_pool_id:t.clmm_pool_id,position_nft_id:t.position_nft_id,coinTypeA:t.coinTypeA,coinTypeB:t.coinTypeB,collectFee:t.collect_fee,clmm_rewarder_types:t.clmm_rewarder_types},e,n),e}async openPositionAddLiquidityStakePaylod(t){const e=new vt,{clmm_pool:n,integrate:i}=this._sdk.ClmmSDK.sdkOptions,s=J(n),o=e.moveCall({target:`${n.published_at}::pool::open_position`,typeArguments:[t.coinTypeA,t.coinTypeB],arguments:[e.object(s.global_config_id),e.object(t.clmm_pool_id),e.pure(Nn(BigInt(t.tick_lower)).toString()),e.pure(Nn(BigInt(t.tick_upper)).toString())]}),r=await this._sdk.ClmmSDK.getOwnerCoinAssets(this._sdk.ClmmSDK.senderAddress),a=ye.buildCoinForAmount(e,r,BigInt(t.amount_a),t.coinTypeA,!1),c=ye.buildCoinForAmount(e,r,BigInt(t.amount_b),t.coinTypeB,!1);e.moveCall({target:`${i.published_at}::${Ps}::add_liquidity_by_fix_coin`,typeArguments:[t.coinTypeA,t.coinTypeB],arguments:[e.object(s.global_config_id),e.object(t.clmm_pool_id),o,a.targetCoin,c.targetCoin,e.pure(t.amount_a.toString()),e.pure(t.amount_b.toString()),e.pure(t.fix_amount_a),e.object(Bt)]});const{frams:u}=this.sdk.sdkOptions,{global_config_id:l,rewarder_manager_id:d}=J(u);return e.moveCall({target:`${u.published_at}::router::deposit`,typeArguments:[],arguments:[e.object(l),e.object(d),e.object(t.pool_id),o,e.object(Bt)]}),e}async addLiquidityPayload(t,e){const{frams:n}=this.sdk.sdkOptions,{clmm_pool:i}=this.sdk.ClmmSDK.sdkOptions;e=e||new vt;const s=J(n),o=J(i),r=await this._sdk.ClmmSDK.getOwnerCoinAssets(this._sdk.ClmmSDK.senderAddress),a=ye.buildCoinForAmount(e,r,BigInt(t.amount_limit_a),t.coinTypeA,!1),c=ye.buildCoinForAmount(e,r,BigInt(t.amount_limit_b),t.coinTypeB,!1);if(t.collect_rewarder&&(e=await this.harvestPayload({pool_id:t.pool_id,position_nft_id:t.position_nft_id,clmm_pool_id:t.clmm_pool_id},e)),t.collect_fee||t.clmm_rewarder_types.length>0){const u=await this._sdk.ClmmSDK.getOwnerCoinAssets(this._sdk.ClmmSDK.senderAddress);e=await this.buildCollectRewarderAndFeeParams({clmm_pool_id:t.clmm_pool_id,position_nft_id:t.position_nft_id,coinTypeA:t.coinTypeA,coinTypeB:t.coinTypeB,collectFee:t.collect_fee,clmm_rewarder_types:t.clmm_rewarder_types},e,u,a.remainCoins,c.remainCoins)}return e.moveCall({target:`${n.published_at}::router::add_liquidity`,typeArguments:[t.coinTypeA,t.coinTypeB],arguments:[e.object(s.global_config_id),e.object(o.global_config_id),e.object(s.rewarder_manager_id),e.object(t.pool_id),e.object(t.clmm_pool_id),e.object(t.position_nft_id),a.targetCoin,c.targetCoin,e.pure(t.amount_limit_a),e.pure(t.amount_limit_b),e.pure(t.delta_liquidity),e.object(Bt)]}),e}async addLiquidityFixCoinPayload(t,e){const{frams:n}=this.sdk.sdkOptions,{clmm_pool:i}=this.sdk.ClmmSDK.sdkOptions;e=e||new vt;const s=J(n),o=J(i),r=await this._sdk.ClmmSDK.getOwnerCoinAssets(this._sdk.ClmmSDK.senderAddress),a=ye.buildCoinForAmount(e,r,BigInt(t.amount_a),t.coinTypeA,!1),c=ye.buildCoinForAmount(e,r,BigInt(t.amount_b),t.coinTypeB,!1);if(t.collect_rewarder&&(e=await this.harvestPayload({pool_id:t.pool_id,position_nft_id:t.position_nft_id,clmm_pool_id:t.clmm_pool_id},e)),t.collect_fee||t.clmm_rewarder_types.length>0){const u=await this._sdk.ClmmSDK.getOwnerCoinAssets(this._sdk.ClmmSDK.senderAddress);e=await this.buildCollectRewarderAndFeeParams({clmm_pool_id:t.clmm_pool_id,position_nft_id:t.position_nft_id,coinTypeA:t.coinTypeA,coinTypeB:t.coinTypeB,collectFee:t.collect_fee,clmm_rewarder_types:t.clmm_rewarder_types},e,u,a.remainCoins,c.remainCoins)}return e.moveCall({target:`${n.published_at}::router::add_liquidity_fix_coin`,typeArguments:[t.coinTypeA,t.coinTypeB],arguments:[e.object(s.global_config_id),e.object(o.global_config_id),e.object(s.rewarder_manager_id),e.object(t.pool_id),e.object(t.clmm_pool_id),e.object(t.position_nft_id),a.targetCoin,c.targetCoin,e.pure(t.amount_a.toString()),e.pure(t.amount_b.toString()),e.pure(t.fix_amount_a),e.object(Bt)]}),e}async removeLiquidityPayload(t,e){const{frams:n}=this.sdk.sdkOptions,{clmm_pool:i}=this.sdk.ClmmSDK.sdkOptions;e=e||new vt;const s=J(n),o=J(i);if(t.collect_rewarder&&(!t.unstake||t.close_position)&&(e=await this.harvestPayload({pool_id:t.pool_id,position_nft_id:t.position_nft_id,clmm_pool_id:t.clmm_pool_id},e)),t.clmm_rewarder_types.length>0){const r=await this._sdk.ClmmSDK.getOwnerCoinAssets(this._sdk.ClmmSDK.senderAddress);e=await this.buildCollectRewarderAndFeeParams({clmm_pool_id:t.clmm_pool_id,position_nft_id:t.position_nft_id,coinTypeA:t.coinTypeA,coinTypeB:t.coinTypeB,collectFee:!1,clmm_rewarder_types:t.clmm_rewarder_types},e,r)}if(t.close_position){if(t.clmm_position_id===void 0)throw Error("close_position need clmm_position_id");e.moveCall({target:`${n.published_at}::router::close_position`,typeArguments:[t.coinTypeA,t.coinTypeB],arguments:[e.object(s.global_config_id),e.object(s.rewarder_manager_id),e.object(t.pool_id),e.object(o.global_config_id),e.object(t.clmm_pool_id),e.object(t.position_nft_id),e.pure(t.min_amount_a),e.pure(t.min_amount_b),e.object(Bt)]})}else e.moveCall({target:`${n.published_at}::router::remove_liquidity`,typeArguments:[t.coinTypeA,t.coinTypeB],arguments:[e.object(s.global_config_id),e.object(o.global_config_id),e.object(s.rewarder_manager_id),e.object(t.pool_id),e.object(t.clmm_pool_id),e.object(t.position_nft_id),e.pure(t.delta_liquidity),e.pure(t.min_amount_a),e.pure(t.min_amount_b),e.object(Bt)]}),t.unstake&&this.withdrawPayload({pool_id:t.pool_id,position_nft_id:t.position_nft_id});return e}async buildCollectRewarderAndFeeParams(t,e,n,i,s){i===void 0&&(i=[...n]),s===void 0&&(s=[...n]);const o=ri(t.coinTypeA),r=ri(t.coinTypeB);t.collectFee&&this.collectFeePayload({clmm_pool_id:t.clmm_pool_id,position_nft_id:t.position_nft_id,coinTypeA:t.coinTypeA,coinTypeB:t.coinTypeB},e);const a=[];return t.clmm_rewarder_types.forEach(c=>{switch(ri(c)){case o:a.push(ye.buildCoinForAmount(e,i,BigInt(0),c,!1).targetCoin);break;case r:a.push(ye.buildCoinForAmount(e,s,BigInt(0),c,!1).targetCoin);break;default:a.push(ye.buildCoinForAmount(e,n,BigInt(0),c,!1).targetCoin);break}}),this.collectClmmRewardPayload({clmm_pool_id:t.clmm_pool_id,position_nft_id:t.position_nft_id,clmm_rewarder_types:t.clmm_rewarder_types,coinTypeA:t.coinTypeA,coinTypeB:t.coinTypeB,reward_coins:a},e),e}collectFeePayload(t,e){const{frams:n}=this.sdk.sdkOptions,{clmm_pool:i}=this.sdk.ClmmSDK.sdkOptions;e=e||new vt;const s=J(n),o=J(i);return e.moveCall({target:`${n.published_at}::router::collect_fee`,typeArguments:[t.coinTypeA,t.coinTypeB],arguments:[e.object(s.global_config_id),e.object(o.global_config_id),e.object(t.clmm_pool_id),e.object(t.position_nft_id)]}),e}async collectClmmRewardPayload(t,e){var a;const{frams:n}=this.sdk.sdkOptions,{clmm_pool:i}=this.sdk.ClmmSDK.sdkOptions;e=e||new vt;let s=t.reward_coins;if(t.clmm_rewarder_types.length>0&&s===void 0){s=[];const c=await this._sdk.ClmmSDK.getOwnerCoinAssets(this._sdk.ClmmSDK.senderAddress);t.clmm_rewarder_types.forEach(u=>{s.push(ye.buildCoinForAmount(e,c,BigInt(0),u,!1).targetCoin)})}const o=J(n),r=J(i);return(a=t.clmm_rewarder_types)==null||a.forEach((c,u)=>{e&&e.moveCall({target:`${n.published_at}::router::collect_clmm_reward`,typeArguments:[c,t.coinTypeA,t.coinTypeB],arguments:[e.object(o.global_config_id),e.object(r.global_config_id),e.object(t.clmm_pool_id),e.object(t.position_nft_id),e.object(r.global_vault_id),s[u],e.object(Bt)]})}),e}async getFrarmsConfigs(){const{package_id:t}=this._sdk.sdkOptions.frams,e={global_config_id:"",rewarder_manager_id:"",rewarder_manager_handle:""},n=(await this._sdk.ClmmSDK.fullClient.queryEventsByPage({MoveEventType:`${t}::config::InitConfigEvent`})).data;if(n.length>0){const s=n[0].parsedJson;e.global_config_id=s.global_config_id,e.admin_cap_id=s.admin_cap_id}const i=(await this._sdk.ClmmSDK.fullClient.queryEventsByPage({MoveEventType:`${t}::rewarder::InitRewarderManagerEvent`})).data;if(i.length>0){const s=i[0].parsedJson;e.rewarder_manager_id=s.id;const o=await this._sdk.ClmmSDK.fullClient.getObject({id:e.rewarder_manager_id,options:{showContent:!0}});e.rewarder_manager_handle=o.data.content.fields.rewarders.fields.id.id}return e}updateCache(t,e,n=Kt){let i=this._cache[t];i?(i.overdueTime=on(n),i.value=e):i=new Yn(e,on(n)),this._cache[t]=i}getCache(t,e=!1){const n=this._cache[t];if(!e&&(n!=null&&n.isValid()))return n.value;delete this._cache[t]}},n2=class{constructor(t,e){Ft(this,"_cache",{});Ft(this,"_sdkOptions");Ft(this,"_launchpad");Ft(this,"_ido");Ft(this,"_xcetusModule");Ft(this,"_xtokenModule");Ft(this,"_boosterModule");Ft(this,"_makerModule");Ft(this,"_clmmSDK");Ft(this,"_liquidityStrategy");Ft(this,"_vaults");Ft(this,"_limitOrder");Ft(this,"_farmsModule");this._sdkOptions=t,this._clmmSDK=e,this._launchpad=new jk(this),this._ido=new Jk(this),this._xcetusModule=new Hk(this),this._xtokenModule=new Zk(this),this._boosterModule=new Fk(this),this._makerModule=new zk(this),this._vaults=new Qk(this),this._limitOrder=new t2(this),this._farmsModule=new e2(this),this._liquidityStrategy=new Yk(this),Td(this._sdkOptions)}get ClmmSDK(){return this._clmmSDK}get sdkOptions(){return this._sdkOptions}get Launchpad(){return this._launchpad}get Ido(){return this._ido}get XToken(){return this._xtokenModule}get XCetusModule(){return this._xcetusModule}get BoosterModule(){return this._boosterModule}get MakerModule(){return this._makerModule}get LiquidityStrategy(){return this._liquidityStrategy}get Vaults(){return this._vaults}get LimitOrder(){return this._limitOrder}get Farms(){return this._farmsModule}getVerifySenderAddress(){const{senderAddress:t}=this.ClmmSDK;if(t.length===0||!q_(t))throw Error("this clmm config sdk senderAddess is illegal");return t}updateCache(t,e,n=Kt){let i=this._cache[t];i?(i.overdueTime=on(n),i.value=e):i=new Yn(e,on(n)),this._cache[t]=i}getCache(t,e=!1){const n=this._cache[t];if(!e&&(n!=null&&n.isValid()))return n.value;delete this._cache[t]}},k_=n2;function i2(t){const e={fullRpcUrl:localStorage.getItem(`${t}-currentRpclocal2`)||qt[t||"Sui"].fullRpcUrl,simulationAccount:qt[t||"Sui"].simulationAccount,cetus_config:qt[t||"Sui"].cetus_config,clmm_pool:qt[t||"Sui"].clmm_pool,integrate:qt[t||"Sui"].integrate,deepbook:qt[t||"Sui"].deepbook,deepbook_endpoint_v2:qt[t||"Sui"].deepbook_endpoint_v2,aggregatorUrl:qt[t||"Sui"].aggregatorUrl,swapCountUrl:qt[t||"Sui"].swapCountUrl},n={launchpad:qt[t||"Sui"].launchpad,ido:qt[t||"Sui"].ido,xcetus:qt[t||"Sui"].xcetus,xcetus_dividends:qt[t||"Sui"].xcetus_dividends,cetus_faucet:qt[t||"Sui"].cetus_faucet,xtoken:qt[t||"Sui"].xtoken,xtoken_dividends:qt[t||"Sui"].xtoken_dividends,token_faucet:qt[t||"Sui"].token_faucet,booster:qt[t||"Sui"].booster,maker_bonus:qt[t||"Sui"].maker_bonus,liquidity_stratefy:qt[t||"Sui"].liquidity_stratefy,vaults:qt[t||"Sui"].vaults,frams:qt[t||"Sui"].frams};console.log("defaultNetworkOptions####",e);const i=new Zi(e),s=new k_(n,i),o=Al(),r=qs(()=>o),a=Xh(),c=qs(()=>a),u=o2();qs(()=>u),Gh(()=>{r.value.address&&(i.senderAddress=r.value.address)});const l=qs(()=>r.value.walletName),{$notify:d}=Br(),f=L=>{const{$notify:V}=Br();V.success({key:L.hash+"loading",icon:Se("img",{class:{"notify-icon":!0,"loading-animate":!0},src:c.value.theme=="default"?"/image/img-loading@2x.png":"/sui-image/img-loading.png"}),message:Se("div",{class:"notification-title"},[Se("span",{innerHTML:L.title},null)]),description:Se("div",{class:"notification-title"},[Se("div",{class:"notification-text",innerHTML:oi.global.t("newAdd.confirmingTransaction")},null),Se("a",{href:ic(c.value.currentExplorer,"tx",window.encodeURIComponent(L.hash)),target:"_blank",innerHTML:oi.global.t("common.viewTransaction")},null)]),duration:0,class:"ant-notification-copy ant-notification-swap"})},_=L=>{d.success({icon:Se("svg",{class:{icon:!0},"aria-hidden":!0},[Se("use",{"xlink:href":"#icon-icon-change1"})]),message:Se("div",{class:"notification-title"},[Se("span",{innerHTML:`${L.title} `+oi.global.t("newAdd.success")},null)]),description:Se("div",{class:"notification-title"},[Se("div",{class:"notification-text",innerHTML:L.desc},null),Se("a",{href:ic(c.value.currentExplorer,"tx",window.encodeURIComponent(L.hash)),target:"_blank",innerHTML:oi.global.t("common.viewTransaction")},null)]),duration:4.5,class:"ant-notification-copy ant-notification-swap"})},T=L=>{d.error({icon:Se("svg",{class:{icon:!0},"aria-hidden":!0},[Se("use",{"xlink:href":"#icon-a-icon-Shutdown"})]),message:Se("div",{class:"notification-title"},[Se("span",{innerHTML:`${L} `+oi.global.t("newAdd.failed")},null)]),description:oi.global.t("newAdd.somethingWrong"),duration:4.5,class:"ant-notification-copy ant-notification-error"})},v=async(L,V=!1)=>{var tt,ct,ut,yt,wt;const{$notify:W}=Br();try{let pt={};if(console.log("watchTransaction params: ",L),!L.res||!((tt=L==null?void 0:L.res)!=null&&tt.digest)||!((ct=L==null?void 0:L.res)!=null&&ct.effects)){const Pt=await Eo(2e3);pt=await i.Pool.getSuiTransactionResponse(L.hash),console.log("0503###watchTransaction###res###",pt)}else pt=L.res;if(console.log("0411###watchTransaction###res###",pt),console.log(L,"====>params"),((yt=(ut=pt==null?void 0:pt.effects)==null?void 0:ut.status)==null?void 0:yt.status)==="success"){W.close(L.hash+"loading"),_(L);const Pt={walletAddress:o.address,chainName:"Sui",...L,...pt,date:new Date().getTime()+6048e5};if(V)if(console.log("0222###watchTransaction###isGetNftInfo true###res####",pt),pt.events){const Ct=pt.events.filter(Dt=>Dt.type.includes("OpenPositionEvent"));return{status:!0,nftInfo:Ct[0]&&((wt=Ct[0])==null?void 0:wt.parsedJson),res:pt}}else return{status:!0,nftInfo:pt.effects.events,res:pt};return!0}else{if(pt&&pt.effects&&pt.effects.status&&pt.effects.status.status!=="success")return W.close(L.hash+"loading"),T(L.title),!1;setTimeout(()=>v(L),3e3)}}catch(pt){return console.log("watchTransaction###error###",pt),W.close(L.hash+"loading"),W.error({icon:Se("svg",{class:{icon:!0},"aria-hidden":!0},[Se("use",{"xlink:href":"#icon-a-icon-Shutdown"})]),message:Se("div",{class:"notification-title"},[Se("span",{innerHTML:`${L.title} Failed`},null)]),duration:4.5,description:"Something went wrong",class:"ant-notification-copy ant-notification-error"}),!0}},k=async L=>{var tt,ct,ut,yt,wt,pt;L.setSenderIfNotSet(r.value.address);const V=await L.build({client:i.fullClient}),W=await i.fullClient.dryRunTransactionBlock({transactionBlock:V});if(console.log("0503###simulate###simulateRes###",W),((ct=(tt=W==null?void 0:W.effects)==null?void 0:tt.status)==null?void 0:ct.status)==="failure"){console.log("0424###simulateRes###error###",(yt=(ut=W==null?void 0:W.effects)==null?void 0:ut.status)==null?void 0:yt.error);const Pt=(pt=(wt=W==null?void 0:W.effects)==null?void 0:wt.status)==null?void 0:pt.error,_t=/\("(.+?)"\)/g,Ct=Pt.match(_t),Dt=Ct&&Ct[0]&&Ct[0].match(/\w+/g)||"",ce=Ct&&Ct[1]&&Ct[1].match(/\w+/g)||"",Qt=Pt.substr(Pt.lastIndexOf("}, ")+3),ne=Qt&&Qt.split(")"),le=ne&&ne[0]||"";throw Dt&&Dt[0]==="factory"&&ce&&ce[0]=="create_pool_internal"&&le==="1"?(d.error({icon:Se("svg",{class:{icon:!0},"aria-hidden":!0},[Se("use",{"xlink:href":"#icon-a-icon-Shutdown"})]),message:Se("div",{class:"notification-title"},[Se("span",{innerHTML:"Transaction "+oi.global.t("newAdd.failed")},null)]),description:"Pool is existed",duration:4.5,class:"ant-notification-copy ant-notification-error"}),new Error("pool is existed")):(d.error({icon:Se("svg",{class:{icon:!0},"aria-hidden":!0},[Se("use",{"xlink:href":"#icon-a-icon-Shutdown"})]),message:Se("div",{class:"notification-title"},[Se("span",{innerHTML:"Transaction "+oi.global.t("newAdd.failed")},null)]),description:Pt,duration:4.5,class:"ant-notification-copy ant-notification-error"}),new Error(Pt))}else return W},U=L=>({transactionBlock:L,options:{showEffects:!0,showEvents:!0,showInput:!0,showRawInput:!0,showObjectChanges:!0,showBalanceChanges:!0}}),R=async(L,V=!1)=>{var tt,ct;await Eo(2e3);const W=await i.Pool.getSuiTransactionResponse(L.hash);if(((ct=(tt=W==null?void 0:W.effects)==null?void 0:tt.status)==null?void 0:ct.status)==="success"){d.close(L.hash+"loading"),_(L);const ut={walletAddress:o.address,chainName:"Sui",...L,...W,date:new Date().getTime()+6048e5};a.setTransactionList(ut)}},A=async L=>{try{o.setLoading(!0);const V=await i.getOwnerCoinAssets(L),W={};return V.forEach(tt=>{var ct,ut;if(tt&&tt.coinAddress){const yt=tt?tt.balance.toString():"0",wt={...tt,balance:yt};W[tt.coinAddress]={...tt,balance:(ct=W[tt.coinAddress])!=null&&ct.balance?D(yt).plus(W[tt.coinAddress].balance).toString():yt,objects:(ut=W[tt.coinAddress])!=null&&ut.objects?[...W[tt.coinAddress].objects,wt]:[wt]}}}),console.log("0411###assets###",W),o.setAssets(W),o.setLoading(!1),W}catch{o.setLoading(!1)}},P=async()=>{try{console.log("getTokenList sdk: ",i);const L=await i.CetusConfig.getCoinConfigs();console.log("0907###tokenList###",L);let V=[],W=[],tt=[];return L.forEach(ct=>{let ut=ct;if(ct.address.includes("::sui::SUI")){const yt=ht(ct.address).full_address;ut={...ut,address:yt}}ut.coin_priority?W.push(ut):tt.push({...ut,coin_priority:"0"})}),W=W.sort((ct,ut)=>Number(ct==null?void 0:ct.coin_priority)<Number(ut==null?void 0:ut.coin_priority)?1:-1),tt=tt.sort((ct,ut)=>ct.symbol.charCodeAt(0)-ut.symbol.charCodeAt(0)),V=[...W,...tt],console.log("0517###haveCoinPriority###",W),console.log("0517###notHaveCoinPriority###",tt),console.log("0517###tokenList###",V),V}catch(L){return console.log("0517###getTokenList###error###",L),[]}},M=async(L,V=!1)=>{var tt;const W=[];console.log("useSui getLpListFromContract");try{const ct=await i.Pool.getPools([]),ut=await P(),yt={};ut.forEach(_t=>{yt[_t.address]=_t});const wt=await i.CetusConfig.getClmmPoolConfigs(),pt={};wt.forEach(_t=>{pt[_t.address]=_t});let Pt={};try{const Ct=(t=="Aptos"?await fetch(`${qt.Aptos.api}/v2/sui/swap/count`).then(Dt=>Dt.json()):await fetch(`${qt.Sui.api}/v2/sui/swap/count`).then(Dt=>Dt.json())).data;Pt=Object.fromEntries(Ct.pools.map(Dt=>[Dt.swap_account,{...Dt,apr_7day:t=="Aptos"?Dt.apr_7day:Dt.apr_24h}]))}catch{}console.log("0426###getLpListFromContract###poolImmutables###",ct),console.log("0426###getLpListFromContract###tokenObj###",yt),console.log("0426###getLpListFromContract###lpObj###",pt),console.log("0426###getLpListFromContract###addressLpTokens###",Pt);for(let _t=0;_t<ct.length;_t++){const Ct=ct[_t];if(pt[Ct.poolAddress]||!pt[Ct.poolAddress]){let Dt=yt[Ct.coinTypeA],ce=yt[Ct.coinTypeB];Dt||(Dt=(await i.CetusConfig.getTokenListByCoinTypes([Ct.coinTypeA]))[Ct.coinTypeA]),ce||(ce=(await i.CetusConfig.getTokenListByCoinTypes([Ct.coinTypeB]))[Ct.coinTypeB]);let Qt=!1;ee(Dt.address,ce.address)&&(Qt=!0);const ne=Pt[Ct.poolAddress]?((tt=Pt[Ct.poolAddress])==null?void 0:tt.is_forward)===!1:Qt;let le={};pt[Ct.poolAddress]&&(le={...le,...pt[Ct.poolAddress]}),le={...le,address:Ct.poolAddress,coinA:Dt,coinB:ce,coin_a_address:Ct.coinTypeA,coin_b_address:Ct.coinTypeB,decimals:6,fee:Number(Ct.fee_rate)/1e6,tickSpacing:Ct.tickSpacing,symbol:`${Dt==null?void 0:Dt.symbol}-${ce==null?void 0:ce.symbol}`,name:`${Dt==null?void 0:Dt.symbol}-${ce==null?void 0:ce.symbol}`,needReverse:ne},(!L||!L[Ct.coinTypeA]&&!L[Ct.coinTypeB])&&W.push(le)}}return console.log("0426###getLpListFromContract###result###",W),W}catch(ct){console.log("getLpListFromContract###err##",ct)}},K=async L=>{var V,W;try{const tt=[],ct=await fetch(`${qt[t||"Sui"].api}/v2/sui/pools_info`).then(wt=>wt.json());if(!((V=ct==null?void 0:ct.data)!=null&&V.lp_list)){const wt=await M(L);if(wt)return wt}console.log(L,"===>newFilterCoinsObj");const ut=((W=ct==null?void 0:ct.data)==null?void 0:W.lp_list)||[];console.log("0426###getLpList###lpList###",ut),console.log("0426###getLpList###res###",ct);const yt=["0xabf2af71ab3ed7c6c3bb557b984a9158f500fc8cebce2572239d1f7690930be8","0x473ab0306ff8952d473b10bb4c3516c632edeb0725f6bb3cda6c474d0ffc883f","0xd40feebfcf7935d40c9e82c9cb437442fee6b70a4be84d94764d0d89bb28ab07"];return ut.forEach(wt=>{var Ct,Dt,ce,Qt;const pt=(wt==null?void 0:wt.is_forward)===!1,Pt=[],_t=yt.includes(wt.address);if(wt.is_display_rewarder){const ne=(ce=(Dt=(Ct=wt==null?void 0:wt.object)==null?void 0:Ct.rewarder_manager)==null?void 0:Dt.fields)==null?void 0:ce.rewarders;ne&&ne.forEach(le=>{var ae,Ye,ze,Je,An,De,Re,pn,w;const we=new it((ae=le==null?void 0:le.fields)==null?void 0:ae.emissions_per_second).mul(it.pow(2,-64));console.log("extractStructTagFromType###",ht((Je=(ze=(Ye=le==null?void 0:le.fields)==null?void 0:Ye.reward_coin)==null?void 0:ze.fields)==null?void 0:Je.name).source_address),Pt.push({coinAddress:ht((Re=(De=(An=le==null?void 0:le.fields)==null?void 0:An.reward_coin)==null?void 0:De.fields)==null?void 0:Re.name).source_address,emissionsEveryDay:Math.floor(we.toNumber()*60*60*24),emissions_per_second:(pn=le==null?void 0:le.fields)==null?void 0:pn.emissions_per_second,growth_global:(w=le==null?void 0:le.fields)==null?void 0:w.growth_global})}),console.log("0426###rewarders###item###",wt),console.log("0426###rewarders###",ne,"###rewarderInfo###",Pt)}(!L||!L[wt.coin_a.address]&&!L[wt.coin_b.address]&&!L[ht(wt.coin_a.address).full_address]&&!L[ht(wt.coin_b.address).full_address])&&tt.push({...wt,coinA:{...wt.coin_a,address:ht(wt.coin_a.address).full_address},coinB:{...wt.coin_b,address:ht(wt.coin_b.address).full_address},rewarderInfo:Pt,needReverse:pt,is_pause:(Qt=wt==null?void 0:wt.object)==null?void 0:Qt.is_pause,isStableFarming:_t})}),console.log("0426###getLpList###result###",tt),tt}catch(tt){console.log("0426###getLpList###err###",tt);const ct=await M(L);if(console.log(ct,"result===>"),ct)return ct}},Y=async(L=[])=>{console.log(L,"getPoolslist##");const W=await new Zi(e).Pool.getPools(L,0,1e3);if(console.log("0330###getPools###pools###",W),L.length===0){const tt={};return W.forEach(ct=>{tt[ct.poolAddress]={...ct,rate:D(ct.fee_rate).div(Math.pow(10,6)).toString()}}),tt}else return W},X=async(L=[])=>{console.log(L,"getPoolslist##");const W=await new Zi(e).Pool.getPools(L,0,1e3);console.log("0330###getPools###pools###",W);const tt={};return W.forEach(ct=>{tt[ct.poolAddress]={...ct,rate:D(ct.fee_rate).div(Math.pow(10,6)).toString()}}),tt},et=async L=>await new Zi(e).Pool.getPool(L),z=L=>{const V=new vt;return V.moveCall({target:`${qt[t||"Sui"].faucet.faucet_display}::${L.transactionModule}::faucet`,typeArguments:[],arguments:[V.pure(L.suplyID)]}),U(V)},O=L=>{var W,tt,ct,ut,yt;let V;return L!=null&&L.digest?V={hash:L==null?void 0:L.digest,status:(tt=(W=L==null?void 0:L.effects)==null?void 0:W.status)==null?void 0:tt.status,res:L}:L!=null&&L.effects&&(V={hash:(ct=L==null?void 0:L.effects)==null?void 0:ct.transactionDigest,status:(yt=(ut=L==null?void 0:L.effects)==null?void 0:ut.status)==null?void 0:yt.status,res:L}),V},$=async L=>{try{const{data:V}=await fetch(`${qt.Sui.api}/v2/sui/ticks?address=${L.poolAddress}&limit=512&orderBy=index`).then(W=>W.json());if(V&&V.list&&V.list.length>0)return{list:V.list.map(tt=>({objectId:tt.object_id,index:tt.index,sqrtPrice:new y(tt.sqrt_price),liquidityNet:new y(tt.liquidity_net),liquidityGross:new y(tt.liquidity_gross),feeGrowthOutsideA:new y(tt.fee_growth_outside_a),feeGrowthOutsideB:new y(tt.fee_growth_outside_b),rewardersGrowthOutside:tt.rewards_growth_outside})),address:V.address};{const W=await i.Pool.fetchTicks({pool_id:L.poolAddress,coinTypeA:L.coinTypeA,coinTypeB:L.coinTypeB});return console.log("0330###getTicks####sui####",W),{list:W,address:L.poolAddress}}}catch(V){console.log("0330###getTicks Error###",V);const W=await i.Pool.fetchTicks({pool_id:L.poolAddress,coinTypeA:L.coinTypeA,coinTypeB:L.coinTypeB});return console.log("0330###getTicks####sui####",W),{list:W,address:L.poolAddress}}},b=async(L,V,W,tt)=>await ok(L,V,W,tt),h=L=>{var Ct,Dt;const{pool:V,position:W,roundUp:tt}=L,ct=Number(W.tick_lower_index),ut=Number(W.tick_upper_index),yt=Nt.tickIndexToSqrtPriceX64(ct),wt=Nt.tickIndexToSqrtPriceX64(ut),pt=dn.getCoinAmountFromLiquidity(new y(W.liquidity),new y(V.current_sqrt_price),yt,wt,tt),Pt=_n(pt.coinA.toString(),(Ct=V==null?void 0:V.coinA)==null?void 0:Ct.decimals),_t=_n(pt.coinB.toString(),(Dt=V==null?void 0:V.coinB)==null?void 0:Dt.decimals);return{coinaAmount:Pt,coinbAmount:_t}},m=L=>{const{tokenA:V,tokenB:W,lowerTick:tt,upperTick:ct,coinAmount:ut,iscoinA:yt,roundUp:wt,slippage:pt,curSqrtPrice:Pt}=L;console.log(Pt.toString(),L,"==>params");const _t=dn.estLiquidityAndcoinAmountFromOneAmounts(tt,ct,ut,yt,wt,pt,Pt),Ct=V.decimals,Dt=W.decimals,{tokenMaxA:ce,tokenMaxB:Qt,liquidityAmount:ne,coinAmountA:le,coinAmountB:we}=_t;return console.log(ce.toString(),"===>tokenMaxA.toString()"),console.log(Qt.toString(),"===>tokenMaxB.toString()"),console.log(le.toString(),"===>coinAmountA.toString()"),console.log(we.toString(),"===>coinAmountB.toString()"),console.log(_t,"result===>"),console.log(_t.liquidityAmount.toString(),"liquidityAmount===>"),console.log(Ct,"===>coinaDecimals"),{tokenMaxAOrigin:ce.toString(),tokenMaxBOrigin:Qt.toString(),tokenMaxA:_n(le.toString(),Ct),tokenMaxB:_n(we.toString(),Dt),liquidityAmount:ne}},x=async L=>{var Je,An,De,Re;const{pool:V,amount:W,fix_amount_a:tt,roundUp:ct,tick_lower:ut,tick_upper:yt,index:wt,slippage:pt,coinTypeC:Pt,coinTypeD:_t,coinTypeE:Ct,curSqrtPrice:Dt,positionInfo:ce,farmPoolInfo:Qt}=L,ne=await et(V.poolAddress);console.log(L.curSqrtPrice.toString(),"###getAddLiquidityTransactionPayload 732 params"),console.log(ne,"###newPool");const le=tt?In(W,V.token_a.decimals):In(W,V.token_b.decimals),we=Nt.sqrtPriceX64ToTickIndex(new y(ne.current_sqrt_price));console.log(ne.current_sqrt_price.toString(),L.curSqrtPrice.toString(),"curSqrtPrice##610");let ae,Ye;if(we>=ut&&we<=yt){const pn=dn.estLiquidityAndcoinAmountFromOneAmounts(ut,yt,new y(le.toString()),tt,ct,pt,new y(ne.current_sqrt_price));console.log(pn,pn.tokenMaxA.toNumber(),pn.tokenMaxB.toNumber(),"===>preAddResult.coinAmountA.toNumber()"),ae=tt?le.toNumber():pn.tokenMaxA.toNumber(),Ye=tt?pn.tokenMaxB.toNumber():le.toNumber()}else we>yt?(ae=0,Ye=le.toNumber()):we<ut&&(ae=le.toNumber(),Ye=0);console.log(L,"===>params742"),console.log("0330###createAddLiquidityTransactionPayload###params###",{coinTypeA:V.token_a.address,coinTypeB:V.token_b.address,pool_id:V.poolAddress,tick_lower:ut<-443636?-443636:ut,tick_upper:yt>443636?443636:yt,fix_amount_a:tt,amount_a:ae,amount_b:Ye,is_open:!wt,pos_id:wt});let ze;if(((Je=ce==null?void 0:ce.value)==null?void 0:Je.positionSource)==="farming"){console.log("0103 getAddLiquidityTransactionPayload positionInfo: ",ce);const pn=[];Pt&&pn.push(Pt),_t&&pn.push(_t),Ct&&pn.push(Ct),ze=await s.Farms.addLiquidityFixCoinPayload({pool_id:(An=ce==null?void 0:ce.value)==null?void 0:An.pool_id,coinTypeA:V.token_a.address,coinTypeB:V.token_b.address,position_nft_id:(De=ce==null?void 0:ce.value)==null?void 0:De.id,clmm_pool_id:(Re=ce==null?void 0:ce.value)==null?void 0:Re.clmm_pool_id,amount_a:ae,amount_b:Ye,collect_fee:!0,collect_rewarder:!1,fix_amount_a:tt,clmm_rewarder_types:pn})}else if(!wt)console.log(Qt,"farmPoolInfo##"),Qt?ze=await s.Farms.openPositionAddLiquidityStakePaylod({pool_id:Qt.id,coinTypeA:V.token_a.address,coinTypeB:V.token_b.address,clmm_pool_id:Qt.clmm_pool_id,amount_a:ae.toString(),amount_b:Ye.toString(),fix_amount_a:tt,tick_lower:ut,tick_upper:yt}):ze=await i.Position.createAddLiquidityFixTokenPayload({coinTypeA:V.token_a.address,coinTypeB:V.token_b.address,pool_id:V.poolAddress,tick_lower:ut<-443636?-443636:ut,tick_upper:yt>443636?443636:yt,fix_amount_a:tt,amount_a:ae,amount_b:Ye,is_open:!wt,pos_id:"",collect_fee:!1,rewarder_coin_types:[],slippage:pt},{slippage:pt,curSqrtPrice:Dt});else{const pn=[];Pt&&pn.push(Pt),_t&&pn.push(_t),Ct&&pn.push(Ct),ze=await i.Position.createAddLiquidityFixTokenPayload({coinTypeA:V.token_a.address,coinTypeB:V.token_b.address,pool_id:V.poolAddress,tick_lower:ut<-443636?-443636:ut,tick_upper:yt>443636?443636:yt,fix_amount_a:tt,amount_a:ae,amount_b:Ye,is_open:!wt,pos_id:wt,collect_fee:L.collect_fee,rewarder_coin_types:[...pn],slippage:pt},{slippage:pt,curSqrtPrice:Dt})}return console.log("0330###sui##getAddLiquidityTransactionPayload###",ze),U(ze)},I=(L,V,W)=>{const tt=Nt.sqrtPriceX64ToPrice(new y(L.current_sqrt_price),L.coinA.decimals,L.coinB.decimals).toNumber(),ct=W?tt:1/tt,ut=D(ct).minus(D(V)).div(D(ct)).mul(100);return ut.gt(100)?100:(console.log(ut.toString(),"1143"),Number(ln(ut.abs().toString(),2)))},N=async L=>{const{pool:V,a2b:W,byAmountIn:tt,amount:ct}=L;console.log("0221###sui###preSwap###",L);const ut=V.coinA.decimals,yt=V.coinB.decimals,wt=V!=null&&V.current_sqrt_price?V:await et(V.address);let pt;W&&tt||!W&&!tt?pt=In(ct,ut):pt=In(ct,yt);const Pt=await i.Swap.preswap({pool:wt,current_sqrt_price:wt.current_sqrt_price,coinTypeA:wt.coinTypeA,coinTypeB:wt.coinTypeB,decimalsA:ut,decimalsB:yt,a2b:W,byAmountIn:tt,amount:pt.toString()});return console.log("0221###sui###preSwap###result###",Pt),{...Pt,estimatedAmountIn:ks(_n(Pt.estimatedAmountIn.toString(),W?ut:yt),W?ut:yt),estimatedAmountOut:ks(_n(Pt.estimatedAmountOut.toString(),W?yt:ut),W?yt:ut),priceImpactPct:ln(Pt.priceImpactPct,2)}},j=async L=>{console.log("0412###getSwapTransactionPayload###params###",L);const{pool:V,a2b:W,byAmountIn:tt,amount:ct,slippage:ut}=L,yt=V.poolAddress,wt=V.token_a.decimals,pt=V.token_b.decimals;let Pt;W&&tt||!W&&!tt?Pt=In(ct,wt):Pt=In(ct,pt);const _t=await i.Swap.preswap({pool:V,current_sqrt_price:V.current_sqrt_price,coinTypeA:V.coinTypeA,coinTypeB:V.coinTypeB,decimalsA:wt,decimalsB:pt,a2b:W,by_amount_in:tt,amount:Pt.toString()}),Ct=D(_t.estimatedAmountOut.toString()),Dt=D(_t.estimatedAmountIn.toString()),ce=tt?Ct.sub(Ct.mul(ut)):Dt.add(Dt.mul(ut));console.log("0221###sui###swap##params123456###",{pool_id:yt,a2b:_t.aToB,by_amount_in:_t.byAmountIn,amount:_t.amount.toString(),amount_limit:ln(ce.toString(),0)||"",coinTypeA:V.token_a.address,coinTypeB:V.token_b.address});const Qt=await i.Swap.createSwapTransactionPayload({pool_id:yt,a2b:_t.aToB,by_amount_in:_t.byAmountIn,amount:_t.amount.toString(),amount_limit:ln(ce.toString(),0)||"",coinTypeA:V.token_a.address,coinTypeB:V.token_b.address});return console.log("0221###sui###swap##tx###",Qt),U(Qt)},G=async(L,V)=>{const W=new Zi(e);console.log(V,"pools982");const tt=Object.values(V).map(ut=>ut.address);return console.log(tt,"#poolList"),await W.Position.getPositionList(L,tt)},E=async(L,V,W,tt="")=>{const ct=new Zi(e);return console.log(L.position_manager.positions_handle,tt,"===>pool.position_manager.positions_handle, pos"),{...await ct.Position.getPosition(L.position_manager.positions_handle,tt),tokenName:W,collectionName:V}},g=async L=>{const W=await new Zi(e).Position.getPositionById(L);return console.log("0503###getPositionById###result###",W),W},q=async(L,V)=>(console.log(L,V,"getTickDataByIndex"),await i.Pool.getTickDataByIndex(L,V)),xt=async L=>{const{pool:V,position:W,tickLowerData:tt,tickUpperData:ct}=L,ut=await et(V.poolAddress),yt=bk({clmmpool:ut,position:W,tickLower:tt,tickUpper:ct}),wt=_n(yt.feeOwedA.toString(),V.token_a.decimals),pt=_n(yt.feeOwedB.toString(),V.token_b.decimals);return{feeOwedA:Number(wt)>99999999999||Number(wt)<0?"0":wt,feeOwedB:Number(pt)>99999999999||Number(pt)<0?"0":pt}},at=async L=>{const{poolAddress:V,pos:W,positionHandle:tt}=L;return await i.Rewarder.posRewardersAmount(V,tt,W)},mt=L=>L.pos_object_id,se=async L=>{const{pool:V,coinTypeA:W,coinTypeB:tt,coinTypeC:ct,coinTypeD:ut,coinTypeE:yt,position:wt,delta_liquidity:pt,rewards_num:Pt,positionInfo:_t}=L;console.log("getRemoveLiquidityTransactionPayload params##",L);const Ct=await et(V.poolAddress),Dt={...V,...Ct},ce=Number(wt.tick_lower_index),Qt=Number(wt.tick_upper_index),ne=Nt.tickIndexToSqrtPriceX64(ce),le=Nt.tickIndexToSqrtPriceX64(Qt),we=dn.getCoinAmountFromLiquidity(pt,new y(Dt.current_sqrt_price),ne,le,!0),ae=D(we.coinA.toString()).mul(D(1-L.slippage)),Ye=D(we.coinB.toString()).mul(D(1-L.slippage)),Je=[W,tt,ct,ut,yt].filter(Re=>!!Re);let An;console.log("0331###remove###params###",{coin_types:Je,min_amount_a:ln(ae.toString(),0),min_amount_b:ln(Ye.toString(),0),pool_id:V.poolAddress,pos_id:L.position.pos_object_id}),console.log("0331###delta_liquidity.toString()###",pt.toString()),console.log("0331###position.liquidity###",wt.liquidity);const De=[];return ct&&De.push(ct),ut&&De.push(ut),yt&&De.push(yt),(_t==null?void 0:_t.positionSource)==="farming"?pt.toString()===wt.liquidity?(console.log({pool_id:_t==null?void 0:_t.pool_id,coinTypeA:W,coinTypeB:tt,position_nft_id:_t==null?void 0:_t.id,clmm_pool_id:_t==null?void 0:_t.clmm_pool_id,min_amount_a:ln(ae.toString(),0)||"",min_amount_b:ln(Ye.toString(),0)||"",collect_fee:!0,collect_rewarder:!0,clmm_rewarder_types:[...De],delta_liquidity:_t==null?void 0:_t.liquidity,unstake:!0,close_position:!0,clmm_position_id:L.position.clmm_position_id},"1191##"),An=await s.Farms.removeLiquidityPayload({pool_id:_t==null?void 0:_t.pool_id,coinTypeA:W,coinTypeB:tt,position_nft_id:_t==null?void 0:_t.id,clmm_pool_id:_t==null?void 0:_t.clmm_pool_id,min_amount_a:ln(ae.toString(),0)||"",min_amount_b:ln(Ye.toString(),0)||"",collect_fee:!0,collect_rewarder:!0,clmm_rewarder_types:[...De],delta_liquidity:_t==null?void 0:_t.liquidity,unstake:!0,close_position:!0,clmm_position_id:L.position.clmm_position_id}),console.log(An,"result#####1210")):An=await s.Farms.removeLiquidityPayload({pool_id:_t==null?void 0:_t.pool_id,coinTypeA:W,coinTypeB:tt,position_nft_id:_t==null?void 0:_t.id,clmm_pool_id:_t==null?void 0:_t.clmm_pool_id,min_amount_a:ln(ae.toString(),0)||"",min_amount_b:ln(Ye.toString(),0)||"",collect_rewarder:!1,clmm_rewarder_types:[...De],delta_liquidity:pt.toString(),unstake:!1,close_position:!1}):pt.toString()===wt.liquidity?An=await i.Position.closePositionTransactionPayload({coinTypeA:W,coinTypeB:tt,min_amount_a:ln(ae.toString(),0)||"",min_amount_b:ln(Ye.toString(),0)||"",rewarder_coin_types:[...De],pool_id:V.poolAddress,pos_id:L.position.pos_object_id,collect_fee:!0}):(console.log(De,"==>rewarder_coin_types"),An=await i.Position.removeLiquidityTransactionPayload({coinTypeA:W,coinTypeB:tt,delta_liquidity:pt.toString(),min_amount_a:ln(ae.toString(),0)||"",min_amount_b:ln(Ye.toString(),0)||"",pool_id:V.poolAddress,pos_id:L.position.pos_object_id,collect_fee:!0,rewarder_coin_types:[...De]})),console.log("0331###remove###result####",An),U(An)},te=async(L,V)=>{const W=[];L.coinTypeC&&W.push(L.coinTypeC),L.coinTypeD&&W.push(L.coinTypeD),L.coinTypeE&&W.push(L.coinTypeE),console.log("0423###getCollectRewarderTransactionPayload###params###",{pool_id:L.pool_address,pos_id:L.pos_index,rewarder_coin_types:[...W],coinTypeA:L.coinTypeA,coinTypeB:L.coinTypeB,collect_fee:!1}),console.log(V,"##getCollectRewarderTransactionPayload");let tt;if(V.positionSource=="farming"){const ct={coinTypeA:V.coinTypeA,coinTypeB:V.coinTypeB,clmm_pool_id:V.clmm_pool_id,position_nft_id:V.id,clmm_rewarder_types:W,collect_fee:!0};tt=await s.Farms.claimFeeAndClmmReward(ct)}else tt=await i.Rewarder.collectRewarderTransactionPayload({pool_id:L.pool_address,pos_id:L.pos_index,rewarder_coin_types:[...W],coinTypeA:L.coinTypeA,coinTypeB:L.coinTypeB,collect_fee:L.collect_fee});return U(tt)},Oe=async L=>{console.log("1130###getCollectFeeTransactionPayload###params",{pool:L.pool.poolAddress,coinTypeA:L.pool.token_a.address,coinTypeB:L.pool.token_b.address,pos_index:L.position.index});const V=await i.Position.collectFeeTransactionPayload({coinTypeA:L.pool.token_a.address,coinTypeB:L.pool.token_b.address,pool_id:L.pool.poolAddress,pos_id:L.position.pos_object_id});return console.log("1130###getCollectFeeTransactionPayload###result##",V),U(V)},fe=async()=>await i.Pool.getPoolImmutables(),ee=(L,V)=>!!oc(Jn(L),Jn(V)),ve=async L=>{const{coinTypeA:V,coinTypeB:W,decimalsA:tt,decimalsB:ct,amountA:ut,amountB:yt,minPrice:wt,maxPrice:pt,fix_amount_a:Pt,tick_spacing:_t,slippage:Ct,price:Dt}=L;console.log(L,"###getCreatPoolTransactionPayload 1201");const ce=Nt.priceToSqrtPriceX64(D(Dt),tt,ct);console.log("0407###getCreatPoolTransactionPayload###currentSqrtPrice###",ce);const Qt=Nt.priceToTickIndex(D(Dt),tt,ct);console.log("0407###getCreatPoolTransactionPayload###currentTickIndex###",Qt);let ne,le;if(wt==="0"&&pt==="∞")ne=br.getMinIndex(Number(_t)),le=br.getMaxIndex(Number(_t));else{const De=Number(wt)==0?-443636:Nt.priceToTickIndex(D(wt),tt,ct),Re=Nt.priceToTickIndex(D(pt),tt,ct);ne=Fa(De,Number(_t)),le=Fa(Re,Number(_t))}console.log("0407###getCreatPoolTransactionPayload###tick_lower###",ne),console.log("0407###getCreatPoolTransactionPayload###tick_upper###",le);const we=Pt?In(ut,tt):In(yt,ct);let ae,Ye;Nt.tickIndexToSqrtPriceX64(ne),Nt.tickIndexToSqrtPriceX64(le);let ze;Qt>=ne&&Qt<=le?(ze=dn.estLiquidityAndcoinAmountFromOneAmounts(ne,le,new y(we.toString()),Pt,!0,Ct,ce),ae=Pt?we.toString():ze.tokenMaxA.toString(),Ye=Pt?ze.tokenMaxB.toString():we.toString()):Qt>le?(ae="0",Ye=D(yt).mul(D(Math.pow(10,ct))).toString()):Qt<ne&&(ae=D(ut).mul(D(Math.pow(10,tt))).toString(),Ye="0"),ne<-443636&&(ne=br.getMinIndex(Number(_t))),le>443636&&(le=ne=br.getMaxIndex(Number(_t))),console.log("0407####create pool params###",JSON.stringify({tick_spacing:_t,initialize_sqrt_price:ce.toString(),uri:"",fix_amount_a:Pt,amount_a:ae,amount_b:Ye,tick_lower:ne,tick_upper:le,coinTypeA:V,coinTypeB:W}));const Je=await i.Pool.creatPoolTransactionPayload({tick_spacing:_t,initialize_sqrt_price:ce.toString(),uri:"",fix_amount_a:Pt,amount_a:ae,amount_b:Ye,slippage:Ct,tick_lower:ne,tick_upper:le,coinTypeA:V,coinTypeB:W});console.log("0412####result###",Je);const An=await k(Je);return console.log("0412####simulateRes###",An),U(Je)},Tn=L=>{const V=L.split("0x");return"0x"+(V[1][0]==="0"?V[1].substring(1):V[1])};return{setTransations:R,showTransitionPending:f,showTransitionSuccess:_,showTransitionError:T,watchTransaction:v,getAccount:A,getTokenList:P,getLpList:K,getPools:Y,getPool:et,mintCoin:z,handleTx:O,TickUtil:br,TickMath:Nt,getNearestTickByTick:Fa,getTicks:$,getEstPositionAPRWithMulti:b,getCoinAmountFromLiquidity:h,estLiquidityAndcoinAmountFromOneAmounts:m,getAddLiquidityTransactionPayload:x,getTickDataFromUrlData:ik,getPriceImpactPct:I,preSwap:N,getSwapTransactionPayload:j,getPositionList:G,getTickDataByIndex:q,getCollectFeesQuote:xt,getPosRewardersAmount:at,getNftHash:mt,getPositionInfo:E,getRemoveLiquidityTransactionPayload:se,getCollectRewarderTransactionPayload:te,getCollectFeeTransactionPayload:Oe,getPoolImmutables:fe,estimateLiquidityForCoinA:Sr,estimateLiquidityForCoinB:Pr,getCreatPoolTransactionPayload:ve,getTokenListByCoinType:async L=>{const V=localStorage.getItem("coinMatedataLocal"),W=V?JSON.parse(V):{};try{let tt=[];const ct=[];if(L&&typeof L=="string"){if(W[Tn(L)])return[W[Tn(L)]];tt=[Tn(L)]}else{const pt=[];if(L.forEach(Pt=>{W[Tn(Pt)]?ct.push(W[Tn(Pt)]):pt.push(Tn(Pt))}),pt.length===0)return ct;tt=[...pt]}const ut=await i.CetusConfig.getTokenListByCoinTypes(tt);console.log("0714###getTokenListByCoinType###result###",ut);const yt=[],wt={};return Object.values(ut).forEach(pt=>{const Pt={...pt,address:ht(pt.address).full_address};yt.push(Pt),wt[pt.address]=Pt}),console.log("0714###getTokenListByCoinType###formatResult###",yt),localStorage.setItem("coinMatedataLocal",JSON.stringify({...W,...wt})),[...yt,...ct]}catch{return[]}},getIsSortedSymbols:ee,getPositionById:g,d:D,getTokenBySymbol:async(L,V)=>{if(!V)return null;let W=null;console.log("getTokenBySymbol###tokensObj###",L);for(const tt in L){const ct=L[tt];if(ct.address.toUpperCase()===ht(V).full_address.toUpperCase()){W=ct;break}}if(!W){const tt=V.split("0x"),ct="0x"+(tt[1][0]==="0"?tt[1].substring(1):tt[1]),ut=await i.CetusConfig.getTokenListByCoinTypes([ct]);ut&&ut[ct]&&(W={...ut[ct],isSelfBuilt:!0,address:ht(V).full_address})}return W},preSwapWithMultiPool:async L=>{const{a2b:V,byAmountIn:W,amount:tt,decimalsA:ct,decimalsB:ut}=L;let yt;V&&W||!V&&!W?yt=In(tt,ct):yt=In(tt,ut);const wt=await i.Swap.preSwapWithMultiPool({poolAddresses:L.poolAddresses,coinTypeA:L.coinTypeA,coinTypeB:L.coinTypeB,a2b:V,byAmountIn:W,amount:yt});return{...wt,estimatedAmountIn:ks(_n(wt.estimatedAmountIn.toString(),V?ct:ut),V?ct:ut),estimatedAmountOut:ks(_n(wt.estimatedAmountOut.toString(),V?ut:ct),V?ut:ct)}},initSwapRouter:async(L,V)=>{console.log(L,"===>paths"),console.log(V,"===>coins"),i.Router.loadGraph(V,L),console.log(i,"sdk===>1826")},getSwapRouter:async(L,V,W,tt,ct,ut="",yt,wt)=>{const pt=L.value.decimals,Pt=V.value.decimals,_t=localStorage.getItem("swapOrderSplit"),Ct=localStorage.getItem("includeRoutes"),Dt=_t=="open"||!_t,ce=Ct=="open";let Qt;try{return Qt=await i.RouterV2.getBestRouter(L.value.address,V.value.address,W,tt,ct,ut,i.senderAddress,yt,Dt,ce,wt),{amountIn:_n(Qt.result.inputAmount.toString(),pt),amountOut:_n(Qt.result.outputAmount.toString(),Pt),...Qt.result}}catch(ne){console.log(ne)}},getSwapRouterPayload:async(L,V)=>{const W=new Zi(e);W.senderAddress=r.value.address,console.log(L,"===>createTxParams");const tt=await W.getOwnerCoinAssets((W==null?void 0:W.senderAddress)||r.value.address);console.log(tt,"===>allCoinAsset");const ct=await ye.buildAggregatorSwapTransaction(W,L,tt,"",V);return U(ct)},fetchPosRewardersAmount:async L=>{const V=await i.Rewarder.fetchPosRewardersAmount([L]),W=V&&V[0];return W&&W.rewarderAmountOwed},estCoinAmountsFromTotalAmount:L=>{const{lowerTick:V,upperTick:W,decimalsA:tt,decimalsB:ct,curSqrtPrice:ut,totalAmount:yt,tokenPriceA:wt,tokenPriceB:pt}=L;console.log(JSON.stringify({...L,curSqrtPrice:ut.toString()}),"params===>");const Pt=dn.estCoinAmountsFromTotalAmount(V,W,ut,yt,wt,pt);console.log("coinAmounts: ",Pt);const _t=sc(Pt.amountA.toFixed(tt,it.ROUND_UP).toString(),tt),Ct=sc(Pt.amountB.toFixed(ct,it.ROUND_UP).toString(),ct),Dt={coinA:new y(_t),coinB:new y(Ct)};return{amountA:_n(_t.toString(),tt),amountB:_n(Ct.toString(),ct),tokenAmountsInfo:Dt}},getCreateAddLiquidityPayload:async L=>{const{curSqrtPrice:V,tickLower:W,tickUpper:tt,tokenAmounts:ct,pool:ut,slippage:yt}=L;console.log(JSON.stringify(L),"####getCreateAddLiquidityPayload 1593");const wt=dn.estimateLiquidityFromcoinAmounts(V,W,tt,ct),pt=new it(ct.coinA.toString()).mul(1+yt),Pt=new it(ct.coinB.toString()).mul(1+yt),_t={coinTypeA:ut.coinTypeA,coinTypeB:ut.coinTypeB,pool_id:ut.address,tick_lower:W,tick_upper:tt,delta_liquidity:wt.toString(),max_amount_a:it.ceil(pt).toString(),max_amount_b:it.ceil(Pt).toString(),pos_id:"",rewarder_coin_types:[],collect_fee:!1};console.log(JSON.stringify(_t),"==>addLiquidityPayloadParams");const Ct=await i.Position.createAddLiquidityPayload(_t);return U(Ct)},calculateDepositRatioFixTokenA:(L,V,W)=>dn.calculateDepositRatioFixTokenA(L,V,W),signAndExecuteTransactionBlock:async(L,V)=>{var tt;console.log("0319 signAndExecuteTransactionBlock###wallet###",L),console.log("0319 signAndExecuteTransactionBlock###payload###",V),console.log("0319 signAndExecuteTransactionBlock###sdk.senderAddress###",i.senderAddress);let W;try{V.transactionBlock.setSender(i.senderAddress),console.log("0321 signAndExecuteTransactionBlock start build: ",new Date().getTime());const ut=await V.transactionBlock.build({client:i.fullClient});console.log("0321 signAndExecuteTransactionBlock buildTxb: ",ut),W=vt.from(ut),console.log("0321 signAndExecuteTransactionBlock start end: ",new Date().getTime())}catch(ct){console.log("0319 signAndExecuteTransactionBlock error: ",ct)}if(console.log("0319 signAndExecuteTransactionBlock wallet.getState(): ",L.getState()),console.log("0319 signAndExecuteTransactionBlock wallet?.name: ",L==null?void 0:L.name),console.log("0319 signAndExecuteTransactionBlock wallet: ",L),(L==null?void 0:L.name)==="MSafe Wallet"||l.value==="MSafe Wallet"){console.log("signAndExecuteTransactionBlock MSafe Wallet Start");const ct=(tt=L.getState())==null?void 0:tt.currentAccount;console.log("signAndExecuteTransactionBlock MSafe Wallet account: ",ct);const ut=V.transactionBlock;return ut.setSender(i.senderAddress),console.log("signAndExecuteTransactionBlock MSafe Wallet txb: ",ut),await L.signAndExecuteTransactionBlock({transactionBlock:ut,account:ct,chain:"sui:mainnet"})}else return await L.signAndExecuteTransactionBlock({transactionBlock:W||V.transactionBlock})},getAllPosition:async(L,V=[])=>{const W=await i.fullClient.getOwnedObjects({owner:L,options:{showType:!0,showContent:!0,showOwner:!0,showDisplay:!0},filter:{MatchAny:[{Package:i.sdkOptions.clmm_pool.package_id},{StructType:`${qt[t||"Sui"].frams.package_id}::pool::WrappedPositionNFT`}]}}),tt=()=>`${i.sdkOptions.clmm_pool.package_id}::position::Position`,ct=()=>`${qt[t||"Sui"].frams.package_id}::pool::WrappedPositionNFT`,ut=[],yt=[],wt=V.length>0;for(const pt of W.data){const Pt=ht(pt.data.type);if(Pt.full_address===tt()){const _t=Gs(pt);wt?V.includes(_t.pool)&&ut.push(_t):ut.push(_t)}if(Pt.full_address===ct()){const _t=Oo.buildFramsPositionNFT(pt);wt?V.includes(_t.clmm_pool_id)&&yt.push(_t):yt.push(_t)}}return console.log("farmsPosition：",yt),{clmmPosition:ut,farmsPosition:yt}},getFullClient:()=>i.fullClient,getPoolsObj:X}}function ui(t){let e={};return!t||t==="Aptos"?e=$6():e=i2(t),{...e}}const Qi="0x26b3bc67befc214058ca78ea9a2690298d731a2d4309485ec3d40198063c4abc",s2=[{base_symbol:`${Qi}::btc::BTC`,price:"175181.584616",quote_symbol:"USD"},{base_symbol:`${Qi}::eth::ETH`,price:"1471.343485",quote_symbol:"USD"},{base_symbol:`${Qi}::usdc::USDC`,price:"0.998772",quote_symbol:"USD"},{base_symbol:`${Qi}::usdt::USDT`,price:"0.949513",quote_symbol:"USD"},{base_symbol:`${Qi}::busd::BUSD`,price:"1",quote_symbol:"USD"},{base_symbol:"0x2::sui::SUI",price:"1",quote_symbol:"USD"}],L3=[{symbol:"USDT",name:"CetusUSDT",num:"200",amount:"200000000",transactionModule:"usdt",address:`${Qi}::usdt::USDT`,suplyID:"0x0a842204e4a64afe0da14749443754714343d1d9d246d71080bde331fc22de55",decimals:6},{symbol:"USDC",name:"CetusUSDC",num:"200",amount:"200000000",transactionModule:"usdc",address:`${Qi}::usdc::USDC`,suplyID:"0xdf6cb5a605e6f91120ac2fe925b897ca44a393b53ad33d52634263774adc9db3",decimals:6},{symbol:"ETH",name:"CetusETH",num:"0.1",amount:"100000000",transactionModule:"eth",address:`${Qi}::eth::ETH`,suplyID:"0x093839657619586c99aa4ab883df94919be0a03eff6ee8206c0d546b2853e158",decimals:8},{symbol:"BTC",name:"CetusBTC",num:"0.01",amount:"10000000",transactionModule:"btc",address:`${Qi}::btc::BTC`,suplyID:"0x9742b5d1812263e1d9fea29467c39cf860ad1aed0993867485aa1c04c720f670",decimals:8}];it.config({precision:64,rounding:it.ROUND_DOWN,toExpNeg:-64,toExpPos:64});function Hh(t){const e={launchpad:qt[t||"Sui"].launchpad,ido:qt[t||"Sui"].ido,xcetus:qt[t||"Sui"].xcetus,xcetus_dividends:qt[t||"Sui"].xcetus_dividends,cetus_faucet:qt[t||"Sui"].cetus_faucet,xtoken:qt[t||"Sui"].xtoken,xtoken_dividends:qt[t||"Sui"].xtoken_dividends,token_faucet:qt[t||"Sui"].token_faucet,booster:qt[t||"Sui"].booster,maker_bonus:qt[t||"Sui"].maker_bonus,liquidity_stratefy:qt[t||"Sui"].liquidity_stratefy,vaults:qt[t||"Sui"].vaults,frams:qt[t||"Sui"].frams},n={fullRpcUrl:localStorage.getItem(`${t}-currentRpclocal2`)||qt[t||"Sui"].fullRpcUrl,simulationAccount:qt[t||"Sui"].simulationAccount,cetus_config:qt[t||"Sui"].cetus_config,clmm_pool:qt[t||"Sui"].clmm_pool,integrate:qt[t||"Sui"].integrate,deepbook:qt[t||"Sui"].deepbook,deepbook_endpoint_v2:qt[t||"Sui"].deepbook_endpoint_v2,aggregatorUrl:qt[t||"Sui"].aggregatorUrl},i=new Nk(n),s=new k_(e,i),o=Al(),r=qs(()=>o);Gh(()=>{r.value.address&&(i.senderAddress=r.value.address)});const a=R=>({transactionBlock:R,options:{showEffects:!0,showEvents:!0,showInput:!0,showRawInput:!0,showObjectChanges:!0,showBalanceChanges:!0}}),c=async()=>{const R=await s.Farms.getFramsPoolList();return console.log(R.data,"##poolData.data"),R.data},u=async(R,A)=>{const P=await s.Farms.getOwnedFramsPositionNFTList(s.ClmmSDK.senderAddress,R,A);return P&&!B6(P)?P.data?P.data:Object.values(P)[0]:[]},l=async(R,A)=>{console.log(R,A,"farmsDeposit##");const P=await s.Farms.depositPayload({pool_id:A,clmm_position_id:R.clmm_position_id});return a(P)},d=async(R,A)=>{console.log(R,A,"####positionNftId");const P=await s.Farms.withdrawPayload({pool_id:R,position_nft_id:A});return a(P)},f=async R=>await s.Farms.calculateFarmingRewards(R,!1),_=async R=>{const A=await s.Farms.harvestPayload(R);return a(A)},T=async R=>{console.log(R,"##batchHarvest");const A=await s.Farms.batchHarvestPayload(R);return a(A)},v=(R,A,P)=>{const M=R.tick_lower_index,K=R.tick_upper_index,{liquidity:Y}=R,{price:X,effective_tick_lower:et,effective_tick_upper:z,total_wrapped_amount:O}=A;console.log(A,"farmPoolInfo##");const $=Oo.calculatePositionShare(M,K,Y,X,et,z,P);return new it($).div(new it(O)).mul(100).toString()};return console.log(i,"###clmmSdk"),{getFramsPoolList:c,getOwnedFramsPositionNFTList:u,farmsDeposit:l,farmsWithdraw:d,calculateFarmingRewards:f,harvestFarms:_,batchHarvest:T,calculatePositionShare:v,fetchPosFeeAmount:async R=>{const A=await i.Position.fetchPosFeeAmount(R);return console.log("fetchPosFeeAmount:",A),[{feeOwedA:new it(A[0].feeOwedA.toString()).div(Math.pow(10,R[0].decimalA)).toString(),feeOwedB:new it(A[0].feeOwedB.toString()).div(Math.pow(10,R[0].decimalB)).toString()}]},getFramsPositionNFT:async R=>await s.Farms.getFramsPositionNFT(R,!0)}}const o2=E_("pool",{state:()=>({tokens:[],tokensObj:{},pools:[],poolsObj:{},myPositions:[],addressLpTokens:{},addressTokens:{},currentPositionLoading:!1,myPositionsLoading:!0,poolsLoading:!0,RATES:{},currentPositionInfo:{},poolConfigList:[],feeOwedObj:{},rewarderObj:{},chinaTokens:[],chinaTokensObj:{},getPoolInfoSuccess:!1,recommendRangesObj:{},allTokenObj:{},isTokenLoading:!0,poolPriceConfigObj:{},defaultPoolInfo:{},poolConfigObj:{},openPool:[],routerPoolConfigObj:{},tokensWarningObj:{},currentChain:"",liquidityCurrentPoolInfo:{},positionDetailCurrentTab:"increase",positionActionAmount:{fromCoinAmount:"",toCoinAmount:""},currentPoolTab:"All",currentPoolMoreInfo:{},poolPositions:[],autoPoolNum:"--",tokenExternalPriceObj:{}}),actions:{async setLiquidityCurrentPoolInfo(t){this.liquidityCurrentPoolInfo=t},async setCurrentPoolMoreInfo(t){this.currentPoolMoreInfo=t},async setChainPoolConfigList(t){this.poolConfigList=t,this.pools=t},async setCurrentPoolTab(t){this.currentPoolTab=t},async setPoolConfigList(t,e){const i=await ui(t).getLpList(e),s=[],o=[],r=[];i.forEach(c=>{var l,d,f;const u={...c,token_a:{...c==null?void 0:c.coinA,logoURI:(l=c==null?void 0:c.coinA)==null?void 0:l.logo_url},token_b:{...c==null?void 0:c.coinB,logoURI:(d=c==null?void 0:c.coinB)==null?void 0:d.logo_url},isFarming:c.is_display_rewarder&&(c.rewarder_display1||c.rewarder_display2||c.rewarder_display3),chain:t==="Aptos"?"aptos":"sui",fee_rate:c.fee*1e4,routerSymbol:[c.coin_a_address,c.coin_b_address].sort(function(_,T){return T.localeCompare(_)}).join("-")};c.is_closed||s.push(u),t=="Sui"&&!((f=c.object)!=null&&f.is_pause)&&o.push(u),r.push(u)}),console.log("0509###setPoolConfigList###",o),this.poolConfigList=t=="Aptos"?s:o,this.poolConfigObj=t=="Aptos"?Object.fromEntries(s.map((c,u)=>[c.address,c])):Object.fromEntries(o.map((c,u)=>[c.address,c]));const a=r.filter(c=>!c.is_pause);this.openPool=a,this.routerPoolConfigObj=Object.fromEntries(a.map((c,u)=>[c.address,c]))},async getRecommendRanges(t){var n;let e=null;if(t&&t.includes("Sui")?e=await $fetch(`${qt[t].api}/v2/sui/liquidity/recommend_ranges`):e=await $fetch(`${qt.Aptos.api}/v2/liquidity/recommend_ranges`),(n=e==null?void 0:e.data)!=null&&n.list){const i=Object.fromEntries(e.data.list.map((s,o)=>[s.address,s]));this.recommendRangesObj=i,this.poolPriceConfigObj=i}else this.recommendRangesObj={},this.poolPriceConfigObj={}},async setPools(t,e){this.poolsLoading=!0,this.getPoolInfoSuccess=!1,this.poolsObj={},this.currentChain=e;const n=ui(e);if((e==null?void 0:e.toLowerCase())==="aptos"){if(t&&t.length>0){for(let i=0;i<t.length&&e===this.currentChain;i++){const s=t[i],o=await n.getPools([s.address]);this.defaultPoolInfo[o[0].poolAddress]=o[0],this.poolsObj[o[0].poolAddress]={...s,...o[0],fee:Number(o[0].fee_rate)/1e6},this.addressLpTokens=this.poolsObj,this.poolsLoading=!1,await Eo(500)}this.getPoolInfoSuccess=!0}}else if(t&&t.length>0){console.log(t,"###poolConfigList");const i=t.map(r=>r.address),s=e=="Aptos"?await n.getPools([]):await n.getPoolsObj(i);console.log(s,"##newPoolsObj");const o={};for(let r=0;r<t.length;r++){const a=t[r];console.log(a,"==>data");const c=s[a.address];c?o[a.address]={...a,...c,fee:Number(c==null?void 0:c.fee_rate)/1e6}:o[a.address]={...a}}console.log("0605###setPools###result###",o),this.poolsObj=o,this.addressLpTokens=o,this.poolsLoading=!1,this.getPoolInfoSuccess=!0}},async setSinglePool(t,e,n){const s=await ui(n).getPool(t.address);console.log(e,"recommendRangesInfo");const o={...t,...s,fee:s.fee_rate/1e6,type:(e==null?void 0:e.type)||""};console.log("0506###setSinglePool###result###",o),this.poolsObj[t.address]=o,console.log(this.poolsObj,"===>173"),this.addressLpTokens[t.address]=o},async updateCurrentPools(t,e){const n=ui(e),i=this.poolsObj[t];if(console.log(i,"===>currentPool"),i){let s={};e&&e.includes("Sui")?s=await n.getPool((i==null?void 0:i.poolAddress)||(i==null?void 0:i.address)):s=await n.getPoolState(i.poolAddress,i.poolType,!1),console.log("0411###debug###newInfo####",s);const o={...this.poolsObj},r={...o[t],...s};console.log("0411###debug###newCurrentInfo####",r),o[t]={...r},console.log("0411###debug###newPoolsObj####",o),this.poolsObj=o}},async setTokens(t){const e=[];console.log("0613###setTokens####111111###",t);const n=ui(t);console.log("0613###setTokens####22222###contract###",n);const i=await n.getTokenList();console.log("0613###setTokens####22222###res###",i),i.forEach(o=>{e.push({...o,logoURI:o.logo_url,chain:t.toLowerCase()})}),console.log(e,"result===>237"),this.tokens=e;const s=Object.fromEntries(e.map((o,r)=>[o.address,o]));s["0x2::sui::SUI"]&&!s["0x0000000000000000000000000000000000000000000000000000000000000002::sui::SUI"]&&(s["0x0000000000000000000000000000000000000000000000000000000000000002::sui::SUI"]=s["0x2::sui::SUI"]),this.tokensObj=s,this.tokensWarningObj={"0x0000000000000000000000000000000000000000000000000000000000000002::sui::SUI":{},...Object.fromEntries(e.map((o,r)=>[o.address,o]))},this.isTokenLoading=!1,console.log(this.tokensWarningObj,"===>this.tokensWarningObj ")},async setChinaTokens(t){const n=await ui(t).getTokenListByCoinType();console.log(n,"chinares===>");const i=[];n.forEach(s=>{i.push({...s,logoURI:t=="Aptos"?"https://archive.cetus.zone/assets/image/default1.png":"https://archive.cetus.zone/assets/image/default2.png",logo_url:t=="Aptos"?"https://archive.cetus.zone/assets/image/default1.png":"https://archive.cetus.zone/assets/image/default2.png"})}),this.chinaTokens=i,this.chinaTokensObj=Object.fromEntries(i.map((s,o)=>[s.address,s]))},setCurrentPositionLoading(t){this.currentPositionLoading=t},setMyPositionsLoading(t){this.myPositionsLoading=t},async setRates(t){let e={};if(t&&t.includes("Sui"))try{e=await $fetch(`${qt.Sui.api}/v2/sui/price`)}catch(s){console.log("sui pric api error ###",s),e={data:{prices:s2}}}else e=await $fetch(`${qt.Aptos.api}/v2/price`);const n=e.data.prices||[],i=[];n.forEach(s=>{s.base_symbol=="0x0000000000000000000000000000000000000000000000000000000000000002::sui::SUI"?i.push({...s},{...s,base_symbol:"0x2::sui::SUI"}):i.push(s)}),this.RATES=Object.fromEntries(i.map(s=>[s.base_symbol,s])),console.log(this.RATES,"===>this.RATES")},async getMyPositons(t,e,n){console.log("0507###getMyPositons###start###",e),this.setMyPositionsLoading(!0);const i=ui(n);let s=[],o=[];if(n=="Sui"){const{clmmPosition:l,farmsPosition:d}=await i.getAllPosition(t,e);s=l,o=d}else s=await i.getPositionList(t,e)||[];let r=[];n=="Sui"&&(r=o.map(l=>{const d=[];let f=new it(0);return l.rewards.forEach(_=>{var A;const T=_.rewarder_type=="0x0000000000000000000000000000000000000000000000000000000000000002::sui::SUI"?"0x2::sui::SUI":_.rewarder_type,v=this.tokensObj[T],k=((A=this.RATES[T])==null?void 0:A.price)||0,U=new it(_.rewarder_amount).div(new it(Math.pow(10,v.decimals))),R=U.mul(new it(k));f=f.add(R),U.toNumber()>0&&d.push({..._,amount:U,rewarderAmountUsd:R.toString(),address:T,symbol:v.symbol})}),{...l,rewards:d,farmingRewardTotalUsd:f.toNumber()}}),console.log("farmingPositionList:",r)),console.log("0507###getMyPositons###positionList###",s),s.length<1&&this.setMyPositionsLoading(!1);const a=r.concat(s);console.log(a,"##allPositionList");const c=[];a.forEach(l=>{var M,K,Y,X;const d=e[l.pool||l.clmm_pool_id];let f,_,T,v,k="",U,R,A,P;if(console.log("allPositionList item:",l),l.liquidity&&l.liquidity!=="0"&&d){const et={creator:l.creator,collection:l.collection,name:l.name};n==="Aptos"?P=i.getNftHash(et):P=i.getNftHash(l);const z=d.token_a.decimals,O=d.token_b.decimals;console.log(d,"poolInf=====>"),d!=null&&d.current_sqrt_price&&(T=i.TickMath.sqrtPriceX64ToPrice(d==null?void 0:d.current_sqrt_price,z,O).toString(),v=new it(1).div(i.TickMath.sqrtPriceX64ToPrice(d==null?void 0:d.current_sqrt_price,z,O)).toString()),l.tick_lower_index==i.TickUtil.getMinIndex(Number(d.tickSpacing))?f="0":f=i.TickMath.tickIndexToPrice(Number(l.tick_lower_index),z,O).toString(),l.tick_upper_index==i.TickUtil.getMaxIndex(Number(d.tickSpacing))?_="∞":(_=i.TickMath.tickIndexToPrice(Number(l.tick_upper_index),z,O).toString(),console.log("0523###maxPrice###2222###",_));const $=d.needReverse?((K=this.tokensObj[d.coinB.address])==null?void 0:K.labels)||[]:((M=this.tokensObj[d.coinA.address])==null?void 0:M.labels)||[],b=d.needReverse?((Y=this.tokensObj[d.coinA.address])==null?void 0:Y.labels)||[]:((X=this.tokensObj[d.coinB.address])==null?void 0:X.labels)||[],h=[...new Set($.concat(b))],m=i.getCoinAmountFromLiquidity({pool:d,position:l,roundUp:n!="Sui"}),x=m.coinaAmount,I=m.coinbAmount;console.log(T,"===>currentPrice");const N=Number(I)+Number(x)*Number(T);let j=(Number(x)*Number(T)/N*100).toFixed(0),G=(I/N*100).toFixed(0);f=="0"&&_=="∞"&&(j="50",G="50"),d.isPause?k="Closed":Number(T)>=Number(f)&&(_==="∞"||Number(T)<=Number(_))?k="Active":(Number(T)>Number(_)||Number(T)<Number(f))&&(k="Inactive"),console.log("0323###this.tokensObj####",this.tokensObj),console.log("0323###this.tokensObj[poolInfo.token_a.address]####",this.tokensObj[d.token_a.address]),console.log("0323###poolInfo.token_a.address####",d.token_a.address),console.log("0323###poolInfo.token_b.address####",d.token_b.address);let E={},g={};n==="Aptos"?(E={...d.token_a,...this.tokensObj[d.token_a.address],logoURI:this.tokensObj[d.token_a.address].logo_url},g={...d.token_b,...this.tokensObj[d.token_b.address],logoURI:this.tokensObj[d.token_b.address].logo_url}):(E=d==null?void 0:d.token_a,g=d==null?void 0:d.token_b),c.push({...d,...l,labels:h,totalAmount:N,token_a:E,token_b:g,tokenARates:U,tokenBRates:R,amountA:x,amountB:I,fromPercent:j,toPercent:G,amountUSD:A,tokenName:l.tokenName||l.name,currentStatus:k,positionLiquidity:l.liquidity,nftHash:P,currentPrice:T,currentPriceReverse:v,minPrice:Gi(f,12),maxPrice:Gi(_,12),positionSource:l.id?"farming":"clmm",farmingRewardTotalUsd:l.id?l.farmingRewardTotalUsd:0})}});const u=c.sort((l,d)=>d.amountUSD-l.amountUSD);this.myPositions=u,this.setMyPositionsLoading(!1),this.getPendingFees(u,n),this.getRewarderV2(u,n),console.log(u,"===>this.myPositions")},async setCurrentPositionInfo(t,e,n,i,s="",o=""){var _,T,v,k,U,R;const r=ui(i);let a;i=="Sui"&&(a=Hh(i));let c=null,u=null,l=null,d=null,f=null;if(t&&s||i==="Aptos"?(c=this.addressLpTokens&&this.addressLpTokens[t],u=await r.getPool(t),f=this.poolConfigObj[t],console.log(f,"===>poolConfig"),l={...c,...u,...f},console.log(l,"423"),d=await r.getPositionInfo(l,e,n,s)):i!=="Aptos"&&(console.log("0414###setCurrentPositionInfo###",s),d=o=="farming"?await a.getFramsPositionNFT(s):await r.getPositionById(s),console.log(d,"setCurrentPositionInfo:positionInfo"),u=o=="farming"?await r.getPool(d.clmm_pool_id):await r.getPool(d.pool),c=this.addressLpTokens&&this.addressLpTokens[d.pool||this.addressLpTokens.poolAddress],f=this.poolConfigObj[d.clmm_pool_id||d.pool],console.log(this.poolConfigObj[d.clmm_pool_id],"##this.poolConfigObj[poolAddress]"),l={...c,...u,...f},console.log("poolInfoNew:",c,u),console.log("0414###setCurrentPositionInfo###positionInfo###",d),console.log("0414###setCurrentPositionInfo###poolInfo###",l)),console.log("setCurrentPositionInfo:",l),d&&l){let A,P,M,K,Y="",X,et,z,O,$,b=0,h=0,m;const x={creator:d.pool,collection:d.collectionName,name:d.name};i==="Aptos"?m=r.getNftHash(x):m=r.getNftHash(d),console.log("0329###setCurrentPositionInfo###poolInfo###",l),console.log("0329###setCurrentPositionInfo###positionInfo###",d);let I=0,N=0;if(l!=null&&l.token_a&&(l!=null&&l.token_b))I=(_=l==null?void 0:l.token_a)==null?void 0:_.decimals,N=(T=l==null?void 0:l.token_b)==null?void 0:T.decimals;else{const j=(await r.getTokenListByCoinType(l==null?void 0:l.coinTypeA))[0],G=(await r.getTokenListByCoinType(l==null?void 0:l.coinTypeB))[0];I=j==null?void 0:j.decimals,N=G==null?void 0:G.decimals,l.coinA=j,l.coinB=G,l.token_a=j,l.token_b=G}if(console.log("开始计算fee"),l){try{let mt;if(o!=="farming"){const se=await r.getTickDataByIndex(l.ticks_handle,Number(d.tick_lower_index)),te=await r.getTickDataByIndex(l.ticks_handle,Number(d.tick_upper_index));mt=await r.getCollectFeesQuote({pool:l,position:d,tickLowerData:se,tickUpperData:te})}else{console.log(l,l.token_a,"setCurrentPositionInfo:poolInfo");const se=[{poolAddress:l.poolAddress,positionId:d.clmm_position_id,coinTypeA:l.coinTypeA,coinTypeB:l.coinTypeB,decimalA:l.token_a.decimals,decimalB:l.token_b.decimals}];console.log(se,"params###");const te=await a.fetchPosFeeAmount(se);console.log(te,"##farmingPositionFee"),mt=te[0]}console.log(mt,"setCurrentPositionInfo feeOwn:"),mt&&(b=Number(mt.feeOwedA),h=Number(mt.feeOwedB))}catch(mt){console.log("0314###getCollectFeesQuote###error####",mt)}console.log("0413####setCurrentPositionInfo###poolInfo###",l),M=r.TickMath.sqrtPriceX64ToPrice(l.current_sqrt_price,I,N).toString(),K=new it(1).div(r.TickMath.sqrtPriceX64ToPrice(l==null?void 0:l.current_sqrt_price,I,N)).toString(),d.tick_lower_index==r.TickUtil.getMinIndex(Number(l.tickSpacing))?A="0":A=r.TickMath.tickIndexToPrice(Number(d.tick_lower_index),I,N).toString(),d.tick_upper_index==r.TickUtil.getMaxIndex(Number(l.tickSpacing))?P="∞":P=r.TickMath.tickIndexToPrice(Number(d.tick_upper_index),I,N).toString(),X=d.tick_lower_index,et=d.tick_upper_index;const j=r.getCoinAmountFromLiquidity({pool:l,position:d,roundUp:i!="Sui"});let G,E,g;console.log(M,"===>currentPrice522"),M&&M>0&&(O=j==null?void 0:j.coinaAmount,$=j==null?void 0:j.coinbAmount,console.log(j,"===>amountInfo"),console.log(M,"===>currentPrice"),g=Number($)+Number(O)*Number(M),console.log(g,"===>totalAmount"),G=(Number(O)*Number(M)/g*100).toFixed(0),console.log(G,"===>fromPercent"),E=(Number($/Number(g))*100).toFixed(0),console.log(E,"==>toPercent"));let q;const xt=j.coinaAmount*((v=this.RATES[l==null?void 0:l.token_a.address])==null?void 0:v.price),at=j.coinbAmount*((k=this.RATES[l==null?void 0:l.token_b.address])==null?void 0:k.price);(U=this.RATES[l==null?void 0:l.token_a.address])!=null&&U.price&&((R=this.RATES[l==null?void 0:l.token_b.address])!=null&&R.price)&&(q=xt+at),console.log(q,"==>totalAmountUSD"),l.isPause?Y="Closed":Number(M)>=Number(A)&&(P==="∞"||Number(M)<=Number(P))?Y="Active":(Number(M)>Number(P)||Number(M)<Number(A))&&(Y="Inactive"),this.currentPositionInfo={...d,poolInfo:l,token_a:{...l.token_a,...this.tokensObj[l.token_a.address]},token_b:{...l.token_b,...this.tokensObj[l.token_b.address]},current_tick_index:l.current_tick_index,current_sqrt_price:l.current_sqrt_price,tickSpacing:l.tickSpacing,fee:l.fee,poolAddress:l.poolAddress,address:l.address,is_display_rewarder:l.is_display_rewarder,nftHash:m,feeOwedA:b,feeOwedB:h,currentStatus:Y,amountA:O,amountB:$,tokenARates:xt,tokenBRates:at,amountUSD:z,totalAmount:g,totalAmountUSD:q,currentPrice:M,currentPriceReverse:K,minPrice:Gi(A,12),minTick:X,maxTick:et,maxPrice:Gi(P,12),fromPercent:G||"--",toPercent:E||"--",tokenName:d.tokenName||d.name,positionSource:d.id?"farming":"clmm"},this.currentPositionLoading=!1,console.log("positionInfo.value",this.currentPositionInfo)}}},async getPendingFees(t,e){var o,r;const n=this.RATES,i=ui(e);let s;e=="Sui"&&(s=Hh("Sui")),console.log("0302###getPendingFees####result###",t);for(let a=0;a<t.length;a++){const c=t[a],u=await i.getPool(c.poolAddress),l={...u,token_a:(c==null?void 0:c.token_a)||this.tokensObj&&this.tokensObj[u.coinTypeA]||this.chinaTokensObj&&this.chinaTokensObj[u.coinTypeA],token_b:(c==null?void 0:c.token_b)||this.tokensObj&&this.tokensObj[u.coinTypeB]||this.chinaTokensObj&&this.chinaTokensObj[u.coinTypeB]};let d;if(t[a].positionSource=="farming"){console.log("result[i]:",t[a]);const A=[{poolAddress:c.poolAddress,positionId:c.clmm_position_id,coinTypeA:c.coinTypeA,coinTypeB:c.coinTypeB,decimalA:c.token_a.decimals,decimalB:c.token_b.decimals}],P=await s.fetchPosFeeAmount(A);console.log(P,"##farmingPositionFee"),d=P[0]}else if(u){const A=await i.getTickDataByIndex(u.ticks_handle,Number(c.tick_lower_index)),P=await i.getTickDataByIndex(u.ticks_handle,Number(c.tick_upper_index));console.log("0323####getPendingFees###pool###",u),console.log("0323####getPendingFees###positionItem.collection###",c.collection),console.log("0323####getPendingFees###positionItem.tokenName###",c.tokenName),console.log("0323####getPendingFees###positionItem###",c);const M=e==="Aptos"?"":c.pos_object_id,K=await i.getPositionInfo(u,c.collection,c.tokenName,M);console.log("0302###positionInfo",K),console.log("0302###resultPool###",l),console.log(u,"pool====>654"),d=await i.getCollectFeesQuote({pool:l,position:K,tickLowerData:A,tickUpperData:P})}console.log("0330###getPendingFees###feeOwn###",d);const f=[],_=Number(d.feeOwedA),T=Number(d.feeOwedB);let v,k,U;n&&n[l.token_a.address]&&n[l.token_b.address]?(k=_*((o=n[l.token_a.address])==null?void 0:o.price),U=T*((r=n[l.token_b.address])==null?void 0:r.price),v=k+U):v="--",f.push({amount:_,amountUSD:k,...l.token_a,logoURI:l.token_a.logo_url},{amount:T,amountUSD:U,...l.token_b,logoURI:l.token_b.logo_url});const R=this.poolConfigObj&&this.poolConfigObj[u.poolAddress];console.log(R,"poolConfigInfo===>710"),this.feeOwedObj[c.tokenName]={feesResult:R.needReverse?f.reverse():f,feeOwed:v},console.log(this.feeOwedObj,"===>this.feeOwedObj"),await Eo(1e3)}},async getRewarder(t,e){const n=ui(e),i=this;console.log(t,"===>results");for(let s=0;s<t.length;s++)if(t[s].rewarder_infos&&t[s].rewarder_infos.length>0){const o=t[s];console.log(s,"i===>"),console.log(o,"===>positionItem"),console.log(o.ticks_handle,"===>positionItem.ticks_handle"),console.log(o.tick_lower_index,"===>positionItem.tick_lower_index"),console.log(o.tick_upper_index,"===>positionItem.tick_upper_index");const r=await n.getTickDataByIndex(o.ticks_handle,Number(o.tick_lower_index)),a=await n.getTickDataByIndex(o.ticks_handle,Number(o.tick_upper_index));let c=[];e==="Aptos"?c=await n.getPosRewardersAmount({poolAddress:o.poolAddress,positionName:o.tokenName,tickLowerData:r,tickUpperData:a}):c=await n.getPosRewardersAmount({poolAddress:o.poolAddress,pos:o.pos_object_id,positionHandle:o.position_manager.positions_handle}),console.log(c,"rewarderInfo===>");const u=[];let l=0;c.forEach((d,f)=>{var k;const _=i.tokensObj[d.coin_address].decimals,T=d.amount_owed.toString(),v=ln(new it(T).div(Math.pow(10,_)).toString(),_);if(o[`rewarder_display${f+1}`]||Number(v)>0){const U=i.tokensObj[d.coin_address];console.log(d.amount_owed.toString(),"===>element.amount_owed.toString()");const R=(k=i.RATES[d.coin_address])==null?void 0:k.price;console.log(R,"price===>"),console.log(v,"==>amount");const A=Number(v)*R;l+=A,u.push({...d,...U,amount:v,amountUSD:A,amount_owed:d.amount_owed.toString()}),i.rewarderObj[o.tokenName]={pendingRewarderArr:u,pendingRewarderView:Number(ln(l,2)),pendingRewarder:l}}}),console.log(i.rewarderObj,"===>_this.rewarderObj"),await Eo(1e3)}},async getRewarderV2(t,e){const n=ui(e),i=this;console.log(t,"===>results");for(let s=0;s<t.length;s++){const o=t[s];if(t[s].rewarder_infos&&t[s].rewarder_infos.length>0){console.log(o,"===>positionItem");const r=await n.getTickDataByIndex(o.ticks_handle,Number(o.tick_lower_index)),a=await n.getTickDataByIndex(o.ticks_handle,Number(o.tick_upper_index));let c=[];e==="Aptos"?c=await n.getPosRewardersAmount({poolAddress:o.poolAddress,positionName:o.tokenName,tickLowerData:r,tickUpperData:a}):(console.log("###fetchPosRewardersAmount"),console.log({poolAddress:o.poolAddress,positionId:o.positionSource=="clmm"?o.pos_object_id:o.clmm_position_id,coinTypeA:o.coinTypeA,coinTypeB:o.coinTypeB,rewarderInfo:o.rewarder_infos},"955##"),c=await n.fetchPosRewardersAmount({poolAddress:o.poolAddress,positionId:o.positionSource=="clmm"?o.pos_object_id:o.clmm_position_id,coinTypeA:o.coinTypeA,coinTypeB:o.coinTypeB,rewarderInfo:o.rewarder_infos}),console.log(c,"###rewarderInfo"));const u=[];let l=0;c.forEach((d,f)=>{var k;const _=i.tokensObj[d.coin_address].decimals,T=d.amount_owed.toString(),v=ln(new it(T).div(Math.pow(10,_)).toString(),_);if(o[`rewarder_display${f+1}`]||Number(v)>0){const U=i.tokensObj[d.coin_address],R=((k=i.RATES[d.coin_address])==null?void 0:k.price)||0;console.log(R,"price===>"),console.log(v,"==>amount");const A=Number(v)*R;l+=A,u.push({...d,...U,amount:v,amountUSD:A,amount_owed:d.amount_owed.toString()}),i.rewarderObj[o.tokenName]={pendingRewarderArr:u,pendingRewarderView:Number(ln(l,2)),pendingRewarder:l}}}),await Eo(1e3)}console.log(i.rewarderObj,"===>_this.rewarderObj")}},setAllTokenObj(t){console.log(t,"===>allTokenObj"),this.allTokenObj=t},async trappingTokenObj(t,e,n){const i={};t.forEach(r=>{!e[r.coinA.address]&&!i[r.coinA.address]&&(i[r.coinA.address]=r),!e[r.coinB.address]&&!i[r.coinB.address]&&(i[r.coinB.address]=r)}),console.log("trappingTokenObj###lackTokensObj####",i);const s=ui(n),o=Object.keys(i);if(console.log("trappingTokenObj###params###",o),o.length>0){const r=await s.getTokenListByCoinType(o);console.log("trappingTokenObj###result###",r);const a={};r.forEach(c=>{a[c.address]={...c,isSelfBuilt:!0}}),this.tokensObj={...this.tokensObj,...a}}},setNewTokens(t){console.log("setNewTokens###走到这里了吗####newTokenObj###",t),this.tokensObj={...this.tokensObj,...t},console.log("setNewTokens###this.tokensObj####",this.tokensObj)},setPositionDetailCurrentTab(t){t!=this.positionDetailCurrentTab&&(this.positionActionAmount={},this.positionDetailCurrentTab=t)},setPositionActionAmount(t){this.positionActionAmount=t},async getMyPositonsByPool(t,e,n){console.log("0507###getMyPositons###start###",e),this.myPositionsLoading=!0;let i={};const s=ui(n);if(!e.current_sqrt_price){const f=await s.getPool(e.address)||{};i={...e,...f}}let o=[],r=[],a=[],c=[];if(n=="Sui"){const{clmmPosition:f,farmsPosition:_}=await s.getAllPosition(t,[e.address]);a=f,c=_,r=c.filter(T=>{if(T.clmm_pool_id==i.address)return T}),o=r.map(T=>{const v=[];let k=new it(0);return T.rewards.forEach(U=>{var Y;const R=U.rewarder_type=="0x0000000000000000000000000000000000000000000000000000000000000002::sui::SUI"?"0x2::sui::SUI":U.rewarder_type,A=this.tokensObj[R],P=((Y=this.RATES[R])==null?void 0:Y.price)||0,M=new it(U.rewarder_amount).div(new it(Math.pow(10,A.decimals))),K=M.mul(new it(P));k=k.add(K),M.toNumber()>0&&v.push({...U,amount:M,rewarderAmountUsd:K.toString(),address:R,symbol:A.symbol})}),{...T,rewards:v,farmingRewardTotalUsd:k.toNumber()}}),console.log("farmingPositionList:",o)}else a=await s.getPositionList(t,{[e.address]:i})||[];console.log(o,"###farmingPositionList"),console.log("0507###getMyPositons###positionList###",a),console.log("###poolInfo",i),a.length<1&&this.setMyPositionsLoading(!1);const u=o.concat(a);console.log("allPositionList:",u);const l=[];u.forEach(f=>{let _,T,v,k="",U,R,A,P;if(f.liquidity&&f.liquidity!=="0"&&i){const M={creator:f.creator,collection:f.collection,name:f.name};n==="Aptos"?P=s.getNftHash(M):P=s.getNftHash(f);const K=i.token_a.decimals,Y=i.token_b.decimals;console.log(i,"poolInf=====>"),v=s.TickMath.sqrtPriceX64ToPrice(i.current_sqrt_price,K,Y).toString(),f.tick_lower_index==s.TickUtil.getMinIndex(Number(i.tickSpacing))?_="0":_=s.TickMath.tickIndexToPrice(Number(f.tick_lower_index),K,Y).toString(),f.tick_upper_index==s.TickUtil.getMaxIndex(Number(i.tickSpacing))?T="∞":(T=s.TickMath.tickIndexToPrice(Number(f.tick_upper_index),K,Y).toString(),console.log("0523###maxPrice###2222###",T));const X=s.getCoinAmountFromLiquidity({pool:i,position:f,roundUp:n!="Sui"}),et=X.coinaAmount,z=X.coinbAmount;console.log(v,"===>currentPrice");const O=Number(z)+Number(et)*Number(v);let $=(Number(et)*Number(v)/O*100).toFixed(0),b=(z/O*100).toFixed(0);_=="0"&&T=="∞"&&($="50",b="50"),i.isPause?k="Closed":Number(v)>=Number(_)&&(T==="∞"||Number(v)<=Number(T))?k="Active":(Number(v)>Number(T)||Number(v)<Number(_))&&(k="Inactive"),console.log("0323###this.tokensObj####",this.tokensObj),console.log("0323###this.tokensObj[poolInfo.token_a.address]####",this.tokensObj[i.token_a.address]),console.log("0323###poolInfo.token_a.address####",i.token_a.address),console.log("0323###poolInfo.token_b.address####",i.token_b.address);let h={},m={};n==="Aptos"?(h={...i.token_a,...this.tokensObj[i.token_a.address],logoURI:this.tokensObj[i.token_a.address].logo_url},m={...i.token_b,...this.tokensObj[i.token_b.address],logoURI:this.tokensObj[i.token_b.address].logo_url}):(h=i==null?void 0:i.token_a,m=i==null?void 0:i.token_b),l.push({...i,...f,totalAmount:O,token_a:h,token_b:m,tokenARates:U,tokenBRates:R,amountA:et,amountB:z,fromPercent:$,toPercent:b,amountUSD:A,tokenName:f.tokenName||f.name,currentStatus:k,positionLiquidity:f.liquidity,nftHash:P,currentPrice:v,minPrice:Gi(_,12),maxPrice:Gi(T,12),positionSource:f.id?"farming":"clmm",farmingRewardTotalUsd:f.id?f.farmingRewardTotalUsd:0})}});const d=l.sort((f,_)=>_.liquidity-f.liquidity);console.log(d,"==>myPositionsByPool"),this.poolPositions=d,this.setMyPositionsLoading(!1),this.getPendingFees(d,n),this.getRewarderV2(d,n),console.log(d,"===>this.myPositions")},setAutoPoolNum(t){this.autoPoolNum=t},setTokenExternalPrice(t,e){this.tokenExternalPriceObj[t]=e},clearCurrentPositionInfo(){this.currentPositionInfo={}}}});export{L3 as $,P3 as A,v3 as B,dn as C,R3 as D,U3 as E,x3 as F,M3 as G,Zi as H,n2 as I,Pr as J,Sr as K,O3 as L,S3 as M,Ve as N,vi as O,Nk as P,ht as Q,D as R,b3 as S,Nt as T,br as U,ji as V,On as W,Us as X,D3 as Y,A3 as Z,pk as _,k6 as a,QS as a0,Ot as a1,y as b,B6 as c,Gi as d,ui as e,T3 as f,ic as g,I3 as h,$3 as i,ks as j,E3 as k,Eo as l,Hh as m,C3 as n,k3 as o,_n as p,ln as q,B3 as r,A6 as s,q3 as t,o2 as u,Bo as v,Po as w,$6 as x,me as y,In as z};
