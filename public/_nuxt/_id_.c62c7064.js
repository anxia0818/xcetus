import{_ as Re}from"./new-position-title.e110fe19.js";import{_ as ie}from"./token-warning.277eac99.js";import{_ as ye}from"./auto-pool-apy-tips.a149c5d6.js";import{u as Do,a as M,g as oe,c as Lo,d as le,s as mo,p as pe,b as _e,e as G,T as So,f as qe}from"./pool.c7b1f148.js";import{u as ae,a as me}from"./sha256.6f981748.js";import{u as Uo,a as be}from"./autoPool.363118e9.js";import{i as Go}from"./import-icon.de3e6c66.js";import{a as Fo,l as c,m as Vo,r as C,q as ho,e as Eo,s as ce,o as y,f as O,h as e,t as qo,i as E,v as d,j as se,x as ao,u as D,p as Zo,k as Jo,y as de,z as ge,A as he,C as ve,c as _o,w as Yo,B as ke,D as Be,b as Oe,F as Ne,E as Me,G as Le,H as fe}from"./entry.9b994bdf.js";import{afterCurrentPrice as Co}from"./data.b4bf784e.js";import"./decimal.633e31ee.js";import{D as a}from"./decimal.0e8aa3f1.js";import{_ as we}from"./assets-card.74d6b111.js";import{_ as Ce}from"./coin-lock.1dd34b49.js";import{_ as Ie,a as $e}from"./auto-pool-remove-modal.76a700ee.js";/* empty css              *//* empty css              */import{V as re}from"./index.5023773a.js";import"./back.111949c9.js";import"./swap-setting.52e2b56c.js";/* empty css              *//* empty css              *//* empty css              *//* empty css              */import"./img-lock_2x.a28135f4.js";import"./img-lock_2x.934b093b.js";const De=Fo({components:{AutoPoolApyTips:ye},setup(){const o=ae(),l=c(()=>o),Z=Do(),W=c(()=>Z),j=Uo(),I=c(()=>j),w=c(()=>l.value.theme),_=Vo(),r=C();ho(()=>[I.value.positionInfoObj,_.params.id],([i,u])=>{i&&!Lo(i)&&u&&(r.value=i[u],console.log(r.value,"##positionInfo.value"))},{immediate:!0,deep:!0});const $=c(()=>{var i;return(i=r.value)==null?void 0:i.needReverse}),t=i=>{var u;return(i==null?void 0:i.logoURI)||(i==null?void 0:i.logo_url)||((u=W.value.tokensObj[i==null?void 0:i.address])==null?void 0:u.logo_url)||(w.value==="default"?Go("/image/coins/unknown.png"):Go("/image/coins/sui-unknown.png"))},n=c(()=>{var i,u;return I.value.apyObj&&((u=I.value.apyObj[(i=r.value)==null?void 0:i.id])==null?void 0:u.tvl)||"--"}),k=c(()=>{var i,u;return I.value.apyObj&&((u=I.value.apyObj[(i=r.value)==null?void 0:i.id])==null?void 0:u.apr)||"--"});return{positionInfo:r,needReverse:$,getCoinIcon:t,tvl:n,apy:k,addCommom:M,getExplorerUrl:oe}}});const ko=o=>(Zo("data-v-c5a991ac"),o=o(),Jo(),o),Ue={class:"auto-pool-v2-info"},Fe={class:"pool-info"},Ve={class:"left"},Ee={class:"coin-a"},We={alt:""},je={class:"coin-b"},Xe={alt:""},He={class:"position-name"},ze={key:0,class:"pool-fee"},Ye=ko(()=>e("span",null,"Fee tier",-1)),Ge={class:"vault-address"},Ze=ko(()=>e("span",null,"Vault Address",-1)),Je=["href"],Ke=ko(()=>e("svg",{class:"icon","aria-hidden":"true"},[e("use",{"xlink:href":"#icon-icon-link"})],-1)),Qe=[Ke],xe={class:"pool-address"},on=ko(()=>e("span",null,"Pool Address",-1)),en=["href"],nn=ko(()=>e("svg",{class:"icon","aria-hidden":"true"},[e("use",{"xlink:href":"#icon-icon-link"})],-1)),tn=[nn],sn={class:"apy-and-tvl"},ln={class:"apy"},an=ko(()=>e("div",{class:"apy-title"},"APY",-1)),un={class:"apy-text"},rn={class:"tvl"},dn=ko(()=>e("div",{class:"tvl-title"},"TVL",-1)),vn={class:"tvl-text"},mn={class:"pool-info h5-pool-info"},cn={class:"left"},pn={class:"coin-a"},fn={alt:""},yn={class:"coin-b"},_n={alt:""},bn={class:"position-name"},gn={key:0,class:"pool-fee"},hn=ko(()=>e("span",null,"Fee tier",-1)),kn={class:"left"},wn={class:"vault-address"},Cn=ko(()=>e("span",null,"Vault Address",-1)),In=["href"],$n=ko(()=>e("svg",{class:"icon","aria-hidden":"true"},[e("use",{"xlink:href":"#icon-icon-link"})],-1)),An=[$n],Sn={class:"pool-address"},Pn=ko(()=>e("span",null,"Pool Address",-1)),Tn=["href"],Rn=ko(()=>e("svg",{class:"icon","aria-hidden":"true"},[e("use",{"xlink:href":"#icon-icon-link"})],-1)),qn=[Rn],Bn={class:"apy-and-tvl"},On={class:"apy"},Nn=ko(()=>e("div",{class:"apy-title"},"APY",-1)),Mn={class:"apy-text"},Ln={class:"tvl"},Dn=ko(()=>e("div",{class:"tvl-title"},"TVL",-1)),Un={class:"tvl-text"};function Fn(o,l,Z,W,j,I){var $,t,n,k,i,u,f,v,T,S,R,X,b,p,g,U,H,Q,q,h,x,co,no,to,z,so,po,L,uo,Wo,wo,jo,Oo,Io,$o,No,Mo,Xo,Ho,lo,fo,Qo,m,P,J,F,ro,oo;const w=ie,_=ye,r=ce("image");return y(),O("div",Ue,[e("div",Fe,[e("div",Ve,[e("div",Ee,[qo(e("img",We,null,512),[[r,o.needReverse?o.getCoinIcon((t=o.positionInfo)==null?void 0:t.token_b):o.getCoinIcon(($=o.positionInfo)==null?void 0:$.token_a)]]),E(w,{address:o.needReverse?(u=(i=o.positionInfo)==null?void 0:i.token_b)==null?void 0:u.address:(k=(n=o.positionInfo)==null?void 0:n.token_a)==null?void 0:k.address,"style-params":{width:"12px",height:"12px",left:"18px",bottom:"4px"}},null,8,["address"])]),e("div",je,[qo(e("img",Xe,null,512),[[r,o.needReverse?o.getCoinIcon((v=o.positionInfo)==null?void 0:v.token_a):o.getCoinIcon((f=o.positionInfo)==null?void 0:f.token_b)]]),E(w,{address:o.needReverse?(X=(R=o.positionInfo)==null?void 0:R.token_a)==null?void 0:X.address:(S=(T=o.positionInfo)==null?void 0:T.token_b)==null?void 0:S.address,"style-params":{width:"12px",height:"12px",left:"18px",bottom:"4px"}},null,8,["address"])]),e("div",He,d(o.needReverse?(p=(b=o.positionInfo)==null?void 0:b.token_b)==null?void 0:p.symbol:(U=(g=o.positionInfo)==null?void 0:g.token_a)==null?void 0:U.symbol)+" - "+d(o.needReverse?(Q=(H=o.positionInfo)==null?void 0:H.token_a)==null?void 0:Q.symbol:(h=(q=o.positionInfo)==null?void 0:q.token_b)==null?void 0:h.symbol),1),(x=o.positionInfo)!=null&&x.fee?(y(),O("div",ze,[Ye,se(" "+d(((co=o.positionInfo)==null?void 0:co.fee)*100)+"% ",1)])):ao("",!0),e("div",Ge,[Ze,e("a",{href:("getExplorerUrl"in o?o.getExplorerUrl:D(oe))("poolAddress",(no=o.positionInfo)==null?void 0:no.id),target:"_blank"},Qe,8,Je)]),e("div",xe,[on,e("a",{href:("getExplorerUrl"in o?o.getExplorerUrl:D(oe))("poolAddress",(to=o.positionInfo)==null?void 0:to.address),target:"_blank"},tn,8,en)])]),e("div",sn,[e("div",ln,[an,e("div",un,[se(d(o.apy)+" ",1),E(_)])]),e("div",rn,[dn,e("div",vn,"$"+d(("addCommom"in o?o.addCommom:D(M))(o.tvl,2)),1)])])]),e("div",mn,[e("div",cn,[e("div",pn,[qo(e("img",fn,null,512),[[r,o.needReverse?o.getCoinIcon((so=o.positionInfo)==null?void 0:so.token_b):o.getCoinIcon((z=o.positionInfo)==null?void 0:z.token_a)]]),E(w,{address:o.needReverse?(Wo=(uo=o.positionInfo)==null?void 0:uo.token_b)==null?void 0:Wo.address:(L=(po=o.positionInfo)==null?void 0:po.token_a)==null?void 0:L.address,"style-params":{width:"12px",height:"12px",left:"18px",bottom:"4px"}},null,8,["address"])]),e("div",yn,[qo(e("img",_n,null,512),[[r,o.needReverse?o.getCoinIcon((jo=o.positionInfo)==null?void 0:jo.token_a):o.getCoinIcon((wo=o.positionInfo)==null?void 0:wo.token_b)]]),E(w,{address:o.needReverse?(No=($o=o.positionInfo)==null?void 0:$o.token_a)==null?void 0:No.address:(Io=(Oo=o.positionInfo)==null?void 0:Oo.token_b)==null?void 0:Io.address,"style-params":{width:"12px",height:"12px",left:"18px",bottom:"4px"}},null,8,["address"])]),e("div",bn,d(o.needReverse?(Xo=(Mo=o.positionInfo)==null?void 0:Mo.token_b)==null?void 0:Xo.symbol:(lo=(Ho=o.positionInfo)==null?void 0:Ho.token_a)==null?void 0:lo.symbol)+" - "+d(o.needReverse?(Qo=(fo=o.positionInfo)==null?void 0:fo.token_a)==null?void 0:Qo.symbol:(P=(m=o.positionInfo)==null?void 0:m.token_b)==null?void 0:P.symbol),1),(J=o.positionInfo)!=null&&J.fee?(y(),O("div",gn,[hn,se(" "+d(((F=o.positionInfo)==null?void 0:F.fee)*100)+"% ",1)])):ao("",!0)]),e("div",kn,[e("div",wn,[Cn,e("a",{href:("getExplorerUrl"in o?o.getExplorerUrl:D(oe))("poolAddress",(ro=o.positionInfo)==null?void 0:ro.id),target:"_blank"},An,8,In)]),e("div",Sn,[Pn,e("a",{href:("getExplorerUrl"in o?o.getExplorerUrl:D(oe))("poolAddress",(oo=o.positionInfo)==null?void 0:oo.address),target:"_blank"},qn,8,Tn)])]),e("div",Bn,[e("div",On,[Nn,e("div",Mn,[se(d(o.apy)+" ",1),E(_)])]),e("div",Ln,[Dn,e("div",Un,"$"+d(("addCommom"in o?o.addCommom:D(M))(o.tvl,2)),1)])])])])}const Ae=Eo(De,[["render",Fn],["__scopeId","data-v-c5a991ac"]]),Vn=Fo({setup(){const o=C(!0),l=Do(),Z=c(()=>l),W=Uo(),j=c(()=>W),I=Vo(),w=C();ho(()=>[j.value.positionInfoObj,I.params.id],([t,n])=>{t&&!Lo(t)&&n&&(w.value=t[n],console.log(w.value,"##positionInfo.value"))},{immediate:!0,deep:!0});const _=c(()=>{var t;return(t=w.value)==null?void 0:t.needReverse}),r=t=>{var n;return(t==null?void 0:t.logoURI)||(t==null?void 0:t.logo_url)||((n=Z.value.tokensObj[t==null?void 0:t.address])==null?void 0:n.logo_url)||Go("/image/coins/sui-unknown.png")},$=c(()=>{var k;const t=(k=w==null?void 0:w.value)==null?void 0:k.price,n=Co.value;return t&&n?50+new a(n).sub(new a(t)).div(new a(t)).mul(100).toNumber():50});return{direct:o,positionInfo:w,needReverse:_,getCoinIcon:r,decimalUi:le,addCommom:M,sFixD:mo,moveRatio:$}}}),En=""+globalThis.__publicAssetsURL("sui-image/icon_currentprice@2x.png");const Bo=o=>(Zo("data-v-73e1fd26"),o=o(),Jo(),o),Wn={class:"v2-position-range"},jn={class:"position-range-top"},Xn=Bo(()=>e("div",null,"Position Range",-1)),Hn={class:"base-coin"},zn={key:0},Yn={alt:""},Gn={key:1},Zn={alt:""},Jn={key:2},Kn={key:3},Qn=Bo(()=>e("p",null,"Base coin",-1)),xn={class:"coin-rate"},ot=Bo(()=>e("div",null,[e("svg",{class:"icon icon-up","aria-hidden":"true"},[e("use",{"xlink:href":"#icon-exchange_up1"})])],-1)),et=Bo(()=>e("div",null,[e("svg",{class:"icon icon-down","aria-hidden":"true"},[e("use",{"xlink:href":"#icon-exchange_down1"})])],-1)),nt=[ot,et],tt={class:"position-range-bottom"},st={class:"current-price"},lt=Bo(()=>e("div",{class:"current-price-title"},"Current Price",-1)),it={key:0,class:"current-price-text"},at={key:1,class:"current-price-text"},ut={class:"price-range"},rt=Bo(()=>e("div",{class:"price-range-bg"},[e("div",{class:"price-range-border"})],-1)),dt={class:"min-price"},vt=Bo(()=>e("div",null,"Min Price",-1)),mt={class:"max-price"},ct=Bo(()=>e("div",null,"Max Price",-1));function pt(o,l,Z,W,j,I){var r,$,t,n,k,i,u,f,v,T,S,R,X,b,p,g,U,H,Q,q,h,x,co,no,to,z;const w=ie,_=ce("image");return y(),O("div",Wn,[e("div",jn,[Xn,e("div",Hn,[o.needReverse?(y(),O("div",Gn,[qo(e("img",Zn,null,512),[[_,o.direct?o.getCoinIcon((f=o.positionInfo)==null?void 0:f.token_b):o.getCoinIcon((u=o.positionInfo)==null?void 0:u.token_a)]]),E(w,{address:o.direct?(R=(S=o.positionInfo)==null?void 0:S.token_b)==null?void 0:R.address:(T=(v=o.positionInfo)==null?void 0:v.token_a)==null?void 0:T.address,"style-params":{width:"10px",height:"10px",right:"0",bottom:"0"}},null,8,["address"])])):(y(),O("div",zn,[qo(e("img",Yn,null,512),[[_,o.direct?o.getCoinIcon((r=o.positionInfo)==null?void 0:r.token_a):o.getCoinIcon(($=o.positionInfo)==null?void 0:$.token_b)]]),E(w,{address:o.direct?(n=(t=o.positionInfo)==null?void 0:t.token_a)==null?void 0:n.address:(i=(k=o.positionInfo)==null?void 0:k.token_b)==null?void 0:i.address,"style-params":{width:"10px",height:"10px",right:"0",bottom:"0"}},null,8,["address"])])),o.needReverse?(y(),O("span",Kn,d(o.direct?(H=(U=o.positionInfo)==null?void 0:U.token_b)==null?void 0:H.symbol:(q=(Q=o.positionInfo)==null?void 0:Q.token_a)==null?void 0:q.symbol),1)):(y(),O("span",Jn,d(o.direct?(b=(X=o.positionInfo)==null?void 0:X.token_a)==null?void 0:b.symbol:(g=(p=o.positionInfo)==null?void 0:p.token_b)==null?void 0:g.symbol),1)),Qn,e("div",xn,[e("div",{onClick:l[0]||(l[0]=so=>o.direct=!o.direct)},nt)])])]),e("div",tt,[e("div",st,[lt,(o.needReverse?!o.direct:o.direct)?(y(),O("div",it,d(("addCommom"in o?o.addCommom:D(M))(("decimalUi"in o?o.decimalUi:D(le))((h=o.positionInfo)==null?void 0:h.price,6))),1)):(y(),O("div",at,d(("addCommom"in o?o.addCommom:D(M))(("decimalUi"in o?o.decimalUi:D(le))(1/((x=o.positionInfo)==null?void 0:x.price),6))),1))]),e("div",ut,[rt,e("img",{style:de({left:`${o.moveRatio}%`}),src:En,alt:""},null,4),e("div",dt,[vt,e("div",null,d(((co=o.positionInfo)==null?void 0:co.minPrice)&&("sFixD"in o?o.sFixD:D(mo))((no=o.positionInfo)==null?void 0:no.minPrice,6)),1)]),e("div",mt,[ct,e("div",null,d(((to=o.positionInfo)==null?void 0:to.maxPrice)&&("sFixD"in o?o.sFixD:D(mo))((z=o.positionInfo)==null?void 0:z.maxPrice,6)),1)])])])])}const Se=Eo(Vn,[["render",pt],["__scopeId","data-v-73e1fd26"]]),ft=Fo({setup(){const o=Do(),l=c(()=>o),Z=Uo(),W=c(()=>Z),j=Vo(),I=C();return ho(()=>[W.value.positionInfoObj,j.params.id],([r,$])=>{console.log(r,"##positionInfoObj"),r&&!Lo(r)&&$&&(I.value=r[$],console.log(I.value,"##positionInfo.value"))},{immediate:!0,deep:!0}),{needReverse:c(()=>{var r;return(r=I.value)==null?void 0:r.needReverse}),positionInfo:I,getCoinIcon:r=>{var $;return console.log(r,"info##"),(r==null?void 0:r.logoURI)||(r==null?void 0:r.logo_url)||(($=l.value.tokensObj[r==null?void 0:r.address])==null?void 0:$.logo_url)||Go("/image/coins/sui-unknown.png")},addCommom:M}}});const yt=o=>(Zo("data-v-16c5df57"),o=o(),Jo(),o),_t={class:"pool-composition"},bt=yt(()=>e("div",{class:"pool-composition-top"},"Pool Composition",-1)),gt={class:"pool-composition-bottom"},ht={class:"token-ratio"},kt={class:"before-coin"},wt={alt:""},Ct={class:"after-coin"},It={alt:""},$t={class:"token-num"},At={class:"num-box"},St={class:"num-box"};function Pt(o,l,Z,W,j,I){var r,$,t,n,k,i,u,f,v,T,S,R,X,b,p,g,U,H,Q,q,h,x,co,no,to,z,so,po;const w=ie,_=ce("image");return y(),O("div",_t,[bt,e("div",gt,[e("div",ht,[e("div",kt,[e("div",null,[E(w,{address:o.needReverse?(n=(t=o.positionInfo)==null?void 0:t.token_b)==null?void 0:n.address:($=(r=o.positionInfo)==null?void 0:r.token_a)==null?void 0:$.address,"style-params":{width:"14px",height:"14px",right:"0",bottom:"0"}},null,8,["address"]),qo(e("img",wt,null,512),[[_,o.needReverse?o.getCoinIcon((i=o.positionInfo)==null?void 0:i.token_b):o.getCoinIcon((k=o.positionInfo)==null?void 0:k.token_a)]])]),e("span",null,d((u=o.positionInfo)==null?void 0:u.poolCoinARatio)+"%",1)]),e("div",Ct,[e("span",null,d((f=o.positionInfo)==null?void 0:f.poolCoinBRatio)+"%",1),e("div",null,[qo(e("img",It,null,512),[[_,o.needReverse?o.getCoinIcon((T=o.positionInfo)==null?void 0:T.token_a):o.getCoinIcon((v=o.positionInfo)==null?void 0:v.token_b)]]),E(w,{address:o.needReverse?(b=(X=o.positionInfo)==null?void 0:X.token_a)==null?void 0:b.address:(R=(S=o.positionInfo)==null?void 0:S.token_b)==null?void 0:R.address,"style-params":{width:"14px",height:"14px",right:"0",bottom:"0"}},null,8,["address"])])])]),e("div",$t,[e("div",{class:"token-a-bg",style:de({width:`${(p=o.positionInfo)==null?void 0:p.poolCoinARatio}%`})},null,4),e("div",{class:"token-b-bg",style:de({width:`${(g=o.positionInfo)==null?void 0:g.poolCoinBRatio}%`})},null,4),e("div",At,[e("div",null,d(("addCommom"in o?o.addCommom:D(M))((U=o.positionInfo)==null?void 0:U.poolCoinANum))+" "+d(o.needReverse?(h=(q=o.positionInfo)==null?void 0:q.token_b)==null?void 0:h.symbol:(Q=(H=o.positionInfo)==null?void 0:H.token_a)==null?void 0:Q.symbol),1),e("div",null,"$"+d(("addCommom"in o?o.addCommom:D(M))((x=o.positionInfo)==null?void 0:x.poolCoinBUSD)),1)]),e("div",St,[e("div",null,d(("addCommom"in o?o.addCommom:D(M))((co=o.positionInfo)==null?void 0:co.poolCoinBNum))+" "+d(o.needReverse?(so=(z=o.positionInfo)==null?void 0:z.token_a)==null?void 0:so.symbol:(to=(no=o.positionInfo)==null?void 0:no.token_b)==null?void 0:to.symbol),1),e("div",null,"$"+d(("addCommom"in o?o.addCommom:D(M))((po=o.positionInfo)==null?void 0:po.poolCoinBUSD)),1)])])])])}const Pe=Eo(ft,[["render",Pt],["__scopeId","data-v-16c5df57"]]),Tt=Fo({setup(){const o=Do(),l=c(()=>o),Z=Uo(),W=c(()=>Z),j=Vo(),I=C();ho(()=>[W.value.positionInfoObj,j.params.id],([t,n])=>{console.log(t,"##positionInfoObj"),t&&!Lo(t)&&n&&(I.value=t[n],console.log(I.value,"##positionInfo.value"))},{immediate:!0,deep:!0});const w=c(()=>{var t;return(t=I.value)==null?void 0:t.needReverse}),_=t=>{var n;return console.log(t,"info##"),(t==null?void 0:t.logoURI)||(t==null?void 0:t.logo_url)||((n=l.value.tokensObj[t==null?void 0:t.address])==null?void 0:n.logo_url)||Go("/image/coins/sui-unknown.png")},r=me(),$=c(()=>r);return{needReverse:w,positionInfo:I,getCoinIcon:_,addCommom:M,wallet:$}}});const ee=o=>(Zo("data-v-0b578037"),o=o(),Jo(),o),Rt={class:"my-liquidity"},qt={class:"my-liquidity-top"},Bt=ee(()=>e("div",null,"My Liquidity",-1)),Ot=ee(()=>e("p",null,"My share of pool",-1)),Nt={class:"my-liquidity-bottom"},Mt={class:"lp-token"},Lt=ee(()=>e("div",null,[e("span",null,"LP Token Balance ")],-1)),Dt={class:"lp-balance"},Ut={class:"token-num-content"},Ft={class:"token-num token-a-num"},Vt={class:"logo"},Et=["src"],Wt={class:"text"},jt={class:"lp-logo"},Xt=["src"],Ht=ee(()=>e("div",null,"Pooled Assets",-1)),zt={class:"token-num"},Yt={class:"logo"},Gt=["src"],Zt={class:"text"},Jt=ee(()=>e("div",{class:"token-num-content-bg"},null,-1));function Kt(o,l,Z,W,j,I){var _,r,$,t,n,k,i,u,f,v,T,S,R,X,b,p,g,U,H,Q,q,h,x,co,no,to,z,so;const w=ie;return y(),O("div",Rt,[e("div",qt,[Bt,e("div",null,[Ot,e("p",null,d(o.wallet.connected?(_=o.positionInfo)==null?void 0:_.myShare:"--")+"%",1)])]),e("div",Nt,[e("div",Mt,[Lt,e("div",null,[e("span",Dt,d(o.wallet.connected?("addCommom"in o?o.addCommom:D(M))((r=o.positionInfo)==null?void 0:r.myLiquidity):"--")+" LP",1),e("span",null,"$"+d(o.wallet.connected?("addCommom"in o?o.addCommom:D(M))(($=o.positionInfo)==null?void 0:$.myLiquidityUSD):"--"),1)])]),e("div",Ut,[e("div",Ft,[e("div",Vt,[e("img",{src:o.needReverse?o.getCoinIcon((n=o.positionInfo)==null?void 0:n.token_b):o.getCoinIcon((t=o.positionInfo)==null?void 0:t.token_a),alt:""},null,8,Et),E(w,{address:o.needReverse?(f=(u=o.positionInfo)==null?void 0:u.token_b)==null?void 0:f.address:(i=(k=o.positionInfo)==null?void 0:k.token_a)==null?void 0:i.address,"style-params":{width:"14px",height:"14px",left:"18px",bottom:"0"}},null,8,["address"])]),e("div",Wt,[e("div",null,d(o.wallet.connected?("addCommom"in o?o.addCommom:D(M))((v=o.positionInfo)==null?void 0:v.amountA):"--")+" "+d(o.needReverse?(X=(R=o.positionInfo)==null?void 0:R.token_b)==null?void 0:X.symbol:(S=(T=o.positionInfo)==null?void 0:T.token_a)==null?void 0:S.symbol),1),e("div",null,d(o.wallet.connected?("addCommom"in o?o.addCommom:D(M))((b=o.positionInfo)==null?void 0:b.myAmountAUSD):"--"),1)])]),e("div",jt,[e("img",{src:o.getCoinIcon((p=o.positionInfo)==null?void 0:p.lpInfo),alt:""},null,8,Xt),Ht]),e("div",zt,[e("div",Yt,[e("img",{src:o.needReverse?o.getCoinIcon((U=o.positionInfo)==null?void 0:U.token_a):o.getCoinIcon((g=o.positionInfo)==null?void 0:g.token_b),alt:""},null,8,Gt),E(w,{address:o.needReverse?(h=(q=o.positionInfo)==null?void 0:q.token_a)==null?void 0:h.address:(Q=(H=o.positionInfo)==null?void 0:H.token_b)==null?void 0:Q.address,"style-params":{width:"14px",height:"14px",right:"0",bottom:"0"}},null,8,["address"])]),e("div",Zt,[e("div",null,d(o.wallet.connected?("addCommom"in o?o.addCommom:D(M))((x=o.positionInfo)==null?void 0:x.amountB):"--")+" "+d(o.needReverse?(z=(to=o.positionInfo)==null?void 0:to.token_a)==null?void 0:z.symbol:(no=(co=o.positionInfo)==null?void 0:co.token_b)==null?void 0:no.symbol),1),e("div",null,d(o.wallet.connected?("addCommom"in o?o.addCommom:D(M))((so=o.positionInfo)==null?void 0:so.myAmountBUSD):"--"),1)])]),Jt])])])}const Te=Eo(Tt,[["render",Kt],["__scopeId","data-v-0b578037"]]),Qt=Fo({components:{AutoPoolAddModal:Ie},setup(){const o=me(),l=C(!1),Z=ae(),W=c(()=>Z),j=c(()=>W.value.chainName),I=c(()=>o),w=Uo(),_=c(()=>w),r=Do(),$=c(()=>r),t=C(),n=Vo();ho(()=>[_.value.positionInfoObj,n.params.id],([m,P])=>{m&&!Lo(m)&&P&&(t.value=m[P],console.log(t.value,"##positionInfo.value"))},{immediate:!0,deep:!0});const k=c(()=>{var m,P;return console.log((m=t.value)==null?void 0:m.needReverse,"##positionInfo.value?.needReverse"),(P=t.value)==null?void 0:P.needReverse}),i=C(),u=C(),f=C(),v=C(),T=C(!0),S=c(()=>I.value.assets&&i.value&&I.value.assets[i.value.address]?pe(I.value.assets[i.value.address].balance,i.value.decimals):0),R=c(()=>I.value.assets&&u.value&&I.value.assets[u.value.address]?pe(I.value.assets[u.value.address].balance,u.value.decimals):0),X=m=>{m==="fromCoin"?(T.value=!0,f.value=S.value>0?i.value.symbol=="SUI"?new a(Number(S.value)).sub(new a(.05)).lt(new a(0))?"0":new a(Number(S.value)).sub(new a(.05)).toString():String(S.value):""):(T.value=!1,v.value=R.value>0?u.value.symbol=="SUI"?new a(Number(R.value)).sub(new a(.05)).lt(new a(0))?"0":new a(Number(R.value)).sub(new a(.05)).toString():String(R.value):"")},b=m=>{m==="fromCoin"?(T.value=!0,f.value=S.value>0?mo(new a(Number(S.value)).div(2).toString(),i.value.decimals).toString():""):(T.value=!1,v.value=R.value>0?mo(new a(Number(R.value)).div(2).toString(),u.value.decimals).toString():"")},p=c(()=>j.value?_e(j.value):{}),g=c(()=>W.value.slippage),U=C("--"),H=C("--"),Q=m=>{const P=new a(t.value.autoPoolPositionInfo.liquidity),J=new a(m.toString());if(P.toNumber()>0&&J.toNumber()>0){const F=J.add(P);console.log("totalLiquidity:",J.div(F).mul(100).toString());const ro=J.div(F).mul(100).toNumber(),oo=qe(ro),yo=oo==-1?2:oo+2,bo=mo(J.div(F).mul(100).toNumber(),yo);console.log(t.value.decimals,"##positionInfo.value.decimal");const go=new a(1).div(new a(Math.pow(10,t.value.lpInfo.decimals))).toString();console.log(bo,go,"###288"),Number(bo)<Number(go)?U.value=`<${go}`:U.value=bo}else J.toNumber()>0&&P.toNumber()<=0?U.value="100":U.value="--"},q=m=>{const P=new a(m.toString());console.log(m.toString(),"##liquidityAmount.toString()");const J=P.mul(new a(g.value).div(100)),F=new a(Math.pow(10,t.value.lpInfo.decimals));console.log(P.minus(J).div(F).toString(),"##liquidity.minus(minimum).div(decimals).toString()"),H.value=mo(P.minus(J).div(F).toString(),t.value.lpInfo.decimals)},h=C(!1),x=C(!1),co=C(""),no=C(),to=async()=>{if(!t.value)return;const m=t.value.autoPoolPositionInfo.tick_lower_index,P=t.value.autoPoolPositionInfo.tick_upper_index,J=So.sqrtPriceX64ToTickIndex(new G(t.value.current_sqrt_price));J<m&&(k.value?h.value=!0:x.value=!0),J>P&&(k.value?x.value=!0:h.value=!0);let F;if(console.log(f.value||v.value,"#fromCoinAmount.value || toCoinAmount.value"),f.value||v.value){T.value?F=new a(f.value).mul(Math.pow(10,i.value.decimals)).toString():F=new a(v.value).mul(Math.pow(10,u.value.decimals)).toString();let ro,oo=T.value;if(console.log("执行##"),lo.value||fo.value){console.log(k.value?T.value:!T.value,"#needReverse.value?fixedFromCoin.value:!fixedFromCoin.value");const s=await Xo.calculateDepositSwapAmount({lowerTick:m,upperTick:P,curSqrtPrice:new G(t.value.current_sqrt_price),fix_amount_a:oo,input_amount:F,coinTypeA:t.value.autoPoolPositionInfo.coin_type_a,coinTypeB:t.value.autoPoolPositionInfo.coin_type_b,clmm_pool:t.value.address});if(console.log(s,"###swapResult"),s){ro=new G(s.afterSqrtPrice),F=new G(s.swapOutAmount),ro=t.value.current_sqrt_price,no.value={swap_amount:s.swapInAmount,a2b:oo},oo=!oo;const A=t.value.token_a.decimals,Y=t.value.token_b.decimals;Co.value=So.sqrtPriceX64ToPrice(s.afterSqrtPrice,A,Y).toString(),console.log(Co.value,"##afterCurrentPrice.value");const B=new a(s.swapInAmount).div(new a(Math.pow(10,A))).toString(),V=new a(s.swapOutAmount).div(new a(Math.pow(10,Y))).toString(),N=k.value?t.value.token_b.symbol:t.value.token_a.symbol,eo=k.value?t.value.token_a.symbol:t.value.token_b.symbol;co.value=`To deposit ${lo.value?f.value:v.value} ${lo.value?N:eo}, 
          ${B} ${lo.value?N:eo}  will be traded for ${V} ${lo.value?eo:N} added to the pool.`}else ro=t.value.current_sqrt_price,F=new G(F),Co.value=""}else ro=t.value.current_sqrt_price,F=new G(F),Co.value="";console.log(no,"##swapParams");const{liquidityAmount:yo,tokenMaxA:bo,tokenMaxB:go}=p.value.estLiquidityAndcoinAmountFromOneAmounts({tokenA:i.value,tokenB:u.value,lowerTick:m,upperTick:P,coinAmount:F,iscoinA:oo,roundUp:!0,slippage:Number(g.value)/100,curSqrtPrice:new G(ro)});console.log(t.value.current_sqrt_price,"##positionInfo.value.current_sqrt_price"),console.log(go.toString(),bo.toString(),t.value,"###323"),!lo.value&&!fo.value&&(T.value?v.value=Number(go)>0?go:"":f.value=Number(bo)>0?bo:""),Q(yo),q(yo)}};ho(()=>t.value,m=>{m&&!Lo(m)&&(i.value=m==null?void 0:m.token_a,u.value=m==null?void 0:m.token_b,h.value=!1,x.value=!1,to())},{immediate:!0});const z=c(()=>$.value.RATES),so=c(()=>{var m,P,J,F,ro,oo,yo,bo,go,s;if((P=z.value[(m=i.value)==null?void 0:m.address])!=null&&P.price&&((F=z.value[(J=u.value)==null?void 0:J.address])!=null&&F.price)){console.log((oo=z.value[(ro=i.value)==null?void 0:ro.address])==null?void 0:oo.price,"RATES.value[fromCoin.value?.address]?.price");const A=new a(f.value||0).mul(new a((bo=z.value[(yo=i.value)==null?void 0:yo.address])==null?void 0:bo.price)),Y=new a(v.value||0).mul(new a((s=z.value[(go=u.value)==null?void 0:go.address])==null?void 0:s.price));return le(A.add(Y).toString(),2)}else return"--"});ho(()=>f.value,(m,P)=>{m?to():(U.value="--",v.value="",H.value="--")},{immediate:!0}),ho(()=>v.value,(m,P)=>{m?to():(f.value="",U.value="--",H.value="--")},{immediate:!0});const{t:po,locale:L}=ge(),uo=c(()=>{const m=Number(f.value)>Number(S.value),P=Number(v.value)>Number(R.value);return!f.value&&!v.value?po("button.enterAmount"):m?po("button.insufficientBalance",{name:i.value.symbol}):P?po("button.insufficientBalance",{name:u.value.symbol}):"Add Liquidity"}),Wo=c(()=>{const m=Number(f.value)>Number(S.value),P=Number(v.value)>Number(R.value);return!!(!f.value&&!v.value||m||P||f.value<=0&&v.value<=0)}),wo=C(!0),{setIsShowSuccess:jo,setIsShowRejected:Oo,setIsShowWaiting:Io,setTransactionDesc:$o,setTransactionTxid:No,setPositiomNum:Mo}=Z,Xo=be("Sui"),Ho=async()=>{var bo,go;l.value=!1,wo.value=!0,No("");const m=`${M(f.value)} ${(bo=i.value)==null?void 0:bo.symbol}`,P=`${M(v.value)} ${(go=u.value)==null?void 0:go.symbol}`;$o(`Deposit ${f.value>0?m:""} ${v.value>0&&f.value>0?"and":""} ${v.value>0?P:""}`),Io(!0);const J=T.value,F=t.value.autoPoolPositionInfo.tick_lower_index,ro=t.value.autoPoolPositionInfo.tick_upper_index;let oo;T.value?oo=new a(f.value).mul(Math.pow(10,i.value.decimals)).toString():oo=new a(v.value).mul(Math.pow(10,u.value.decimals)).toString();const yo=t.value.rewarderInfo.map(s=>s.coinAddress);try{const s={lowerTick:F,upperTick:ro,coinAmount:oo,fix_amount_a:J,slippage:Number(g.value)/100,curSqrtPrice:new G(t.value.current_sqrt_price),id:t.value.id,clmm_pool:t.value.autoPoolPositionInfo.pool,lp_token_type:t.value.lp_token_type,coinTypeA:t.value.autoPoolPositionInfo.coin_type_a,coinTypeB:t.value.autoPoolPositionInfo.coin_type_b,rewarder_coin_types:yo,swapParams:no.value,isOnlyA:lo.value,isOnlyB:fo.value},A=await Xo.deposit(s);console.log(A,"===>payloadAdd11111");const Y=await I.value.currentWallet.signAndExecuteTransactionBlock(A);let B=p.value.handleTx(Y);if(console.log("toAdd###tx###",B),B&&B.hash){No(B.hash),Io(!1),jo(!0),console.log(t,"===>positionInfo");const V={title:"Supplied",desc:`Deposit ${f.value>0?m:""} ${v.value>0&&f.value>0?"and":""} ${v.value>0?P:""}`,hash:B.hash,tit:"Liquidity Increased",icon:"icon-icon-Increased",text:`Deposit ${f.value>0?m:""} ${v.value>0&&f.value>0?"and":""} ${v.value>0?P:""}`};j.value!=="Aptos"&&(V.res=B.res),p.value.showTransitionPending(V),await p.value.watchTransaction(V)&&setTimeout(()=>{w.updatePositionItem(t.value.id),p.value.getAccount(I.value.address)},1e3),Mo()}else Io(!1),Oo(!0);f.value="",v.value="",wo.value=!1}catch(s){f.value="",v.value="",console.log("addError###",s),wo.value=!1,Io(!1),Oo(!0)}},lo=C(!1),fo=C(!1);return{wallet:I,positionInfo:t,isShowAddModal:l,needReverse:k,fromCoin:i,toCoin:u,fromCoinAmount:f,toCoinAmount:v,fromCoinBlance:S,toCoinBlance:R,fixedFromCoin:T,maxBtnSelect:X,halfBtnSelect:b,totalAmountUSD:so,addCommom:M,shareOfPool:U,minimumReceivedLP:H,addLiquidityBtnText:uo,addLiquidityBtnDisabled:Wo,toAdd:Ho,showToCoinLock:x,showFromCoinLock:h,isOnlyA:lo,isOnlyB:fo,onlyToken:m=>{f.value="",v.value="",m=="only-a"?(lo.value=!lo.value,fo.value=!1):(fo.value=!fo.value,lo.value=!1)},onlyText:co}}});const Ko=o=>(Zo("data-v-ecae9d0d"),o=o(),Jo(),o),xt={class:"auto-pool-add"},os={class:"auto-pool-add-content"},es={class:"liquidity-action-tab"},ns=Ko(()=>e("div",{class:"increase tab-active"},"Add",-1)),ts={class:"only-token"},ss=Ko(()=>e("div",null,"Deposit Amounts",-1)),ls={key:0},is={key:0},as={key:0,class:"card-item"},us={key:1,class:"card-item"},rs=Ko(()=>e("span",null,"Pool Closed",-1)),ds={class:"add-info"},vs={key:0,class:"only-text"},ms={class:"total-amount"},cs=Ko(()=>e("span",null,"Total Amount",-1)),ps={class:"total-amount"},fs=Ko(()=>e("span",null,"Share of Pool",-1)),ys={class:"total-amount"},_s=Ko(()=>e("span",null,"Minimum Received LP",-1));function bs(o,l,Z,W,j,I){var t,n,k,i,u,f,v,T,S,R,X,b,p;const w=we,_=Ce,r=ke,$=Ie;return y(),O("div",xt,[e("div",os,[e("div",es,[ns,e("div",{class:"remove",onClick:l[0]||(l[0]=he(g=>o.$emit("changeCurrentTab"),["stop"]))},"Remove")]),e("div",ts,[ss,e("div",null,[e("div",{class:"only-a",onClick:l[1]||(l[1]=g=>o.onlyToken("only-a"))},[e("p",null,[o.isOnlyA?(y(),O("span",ls)):ao("",!0)]),e("span",null,d(o.needReverse?(i=(k=o.positionInfo)==null?void 0:k.token_b)==null?void 0:i.symbol:(n=(t=o.positionInfo)==null?void 0:t.token_a)==null?void 0:n.symbol)+" only",1)]),e("div",{class:"only-b",onClick:l[2]||(l[2]=g=>o.onlyToken("only-b"))},[e("p",null,[o.isOnlyB?(y(),O("span",is)):ao("",!0)]),e("span",null,d(o.needReverse?(T=(v=o.positionInfo)==null?void 0:v.token_a)==null?void 0:T.symbol:(f=(u=o.positionInfo)==null?void 0:u.token_b)==null?void 0:f.symbol)+" only",1)])])]),e("div",{class:ve(o.needReverse?"card-container reverse":"card-container")},[(o.needReverse?!o.isOnlyA:!o.isOnlyB)?(y(),O("div",as,[E(w,{modelValue:o.fromCoinAmount,"onUpdate:modelValue":l[3]||(l[3]=g=>o.fromCoinAmount=g),"input-value":o.fromCoinAmount,"coin-symbol":o.fromCoin?o.fromCoin.symbol:null,"coin-name":o.fromCoin?o.fromCoin.name:null,balance:o.fromCoinBlance,"coin-icon":o.fromCoin?o.fromCoin.logoURI:"",address:o.fromCoin?o.fromCoin.address:"","swap-direct":"From","import-page":"deposit","has-arrow":!1,onOnMax:l[4]||(l[4]=g=>o.maxBtnSelect("fromCoin")),onOnHalf:l[5]||(l[5]=g=>o.halfBtnSelect("fromCoin")),onOnInput:l[6]||(l[6]=g=>{o.fromCoinAmount=g}),onOnFocus:l[7]||(l[7]=()=>{o.fixedFromCoin=!0})},null,8,["modelValue","input-value","coin-symbol","coin-name","balance","coin-icon","address"]),o.showFromCoinLock?(y(),_o(_,{key:0})):ao("",!0)])):ao("",!0),(o.needReverse?!o.isOnlyB:!o.isOnlyA)?(y(),O("div",us,[E(w,{modelValue:o.toCoinAmount,"onUpdate:modelValue":l[8]||(l[8]=g=>o.toCoinAmount=g),"input-value":o.toCoinAmount,"coin-symbol":o.toCoin?o.toCoin.symbol:null,"coin-name":o.toCoin?o.toCoin.name:null,balance:o.toCoinBlance,"swap-direct":"To","coin-icon":o.toCoin?o.toCoin.logoURI:"",address:o.toCoin?o.toCoin.address:"","import-page":"deposit","has-arrow":!1,onOnMax:l[9]||(l[9]=g=>o.maxBtnSelect("toCoin")),onOnHalf:l[10]||(l[10]=g=>o.halfBtnSelect("toCoin")),onOnInput:l[11]||(l[11]=g=>{o.toCoinAmount=g}),onOnFocus:l[12]||(l[12]=()=>{o.fixedFromCoin=!1})},null,8,["modelValue","input-value","coin-symbol","coin-name","balance","coin-icon","address"]),o.showToCoinLock?(y(),_o(_,{key:0})):ao("",!0)])):ao("",!0)],2)]),(S=o.positionInfo)!=null&&S.is_pause?(y(),_o(r,{key:0,class:"big-btn liquidity-btn",disabled:!0},{default:Yo(()=>[rs]),_:1})):o.wallet.connected?(y(),_o(r,{key:1,class:"big-btn liquidity-btn",disabled:o.addLiquidityBtnDisabled,onClick:l[13]||(l[13]=g=>o.isShowAddModal=!0)},{default:Yo(()=>[e("span",null,d(o.addLiquidityBtnText),1)]),_:1},8,["disabled"])):(y(),_o(r,{key:2,class:"big-btn",onClick:l[14]||(l[14]=g=>o.wallet.setIsShowWalletModal(!0))},{default:Yo(()=>[e("span",null,d(o.$t("button.connectWallet")),1)]),_:1})),e("div",ds,[o.fromCoinAmount||o.toCoinAmount?(y(),O("div",vs,d(o.onlyText),1)):ao("",!0),e("div",ms,[cs,e("span",null,"$"+d(("addCommom"in o?o.addCommom:D(M))(o.totalAmountUSD)),1)]),e("div",ps,[fs,e("span",null,d(o.shareOfPool)+"%",1)]),e("div",ys,[_s,e("span",null,d(("addCommom"in o?o.addCommom:D(M))(o.minimumReceivedLP))+" "+d(o.needReverse?(R=o.toCoin)==null?void 0:R.symbol:(X=o.fromCoin)==null?void 0:X.symbol)+"-"+d(o.needReverse?(b=o.fromCoin)==null?void 0:b.symbol:(p=o.toCoin)==null?void 0:p.symbol),1)])]),o.isShowAddModal?(y(),_o($,{key:3,"pool-info":o.positionInfo,"from-coin":o.needReverse?o.positionInfo.token_b:o.positionInfo.token_a,"to-coin":o.needReverse?o.positionInfo.token_a:o.positionInfo.token_b,"from-coin-amount":o.needReverse?o.toCoinAmount:o.fromCoinAmount,"to-coin-amount":o.needReverse?o.fromCoinAmount:o.toCoinAmount,"total-amount":o.totalAmountUSD,"share-of-pool":o.shareOfPool,"minimum-received-l-p":o.minimumReceivedLP,"is-only-a":o.isOnlyA,"is-only-b":o.isOnlyB,onOnClose:l[15]||(l[15]=g=>o.isShowAddModal=!1),onToAdd:o.toAdd},null,8,["pool-info","from-coin","to-coin","from-coin-amount","to-coin-amount","total-amount","share-of-pool","minimum-received-l-p","is-only-a","is-only-b","onToAdd"])):ao("",!0)])}const gs=Eo(Qt,[["render",bs],["__scopeId","data-v-ecae9d0d"]]),hs=Fo({components:{AutoPoolRemoveModal:$e},setup(){const o=me(),l=c(()=>o),Z=ae(),W=c(()=>Z),j=c(()=>W.value.slippage),I=c(()=>W.value.chainName),w=[{name:"25%",value:25},{name:"50%",value:50},{name:"75%",value:75},{name:"MAX",value:100}],_=C(25),r=Vo(),$=Uo(),t=c(()=>$),n=c(()=>(console.log(t.value.positionInfoObj[r.params.id],"autoPool.value.positionInfoObj[route.params.id]###"),t.value.positionInfoObj[r.params.id])),k=c(()=>{var s;return(s=n.value)==null?void 0:s.needReverse}),i=C(),u=C(),f=C(!1),v=C(),T=c(()=>{var s;return(s=n.value)==null?void 0:s.myLiquidity}),S=C(!0),R=c(()=>I.value?_e(I.value):{}),X=be("Sui"),b=C(""),p=C(""),g=C("--"),U=C(!1),H=C(!1),Q=C(),q=C(!0),h=C(),x=Do(),co=c(()=>x),no=c(()=>co.value.RATES),to=async()=>{if(S.value||!n.value)return;const s=n.value.autoPoolPositionInfo.tick_lower_index,A=n.value.autoPoolPositionInfo.tick_upper_index,Y=So.sqrtPriceX64ToTickIndex(new G(n.value.current_sqrt_price));Y<s&&(k.value?U.value=!0:H.value=!0),Y>A&&(k.value?H.value=!0:U.value=!0);let B;if(console.log(b.value||p.value,"#fromCoinAmount.value || toCoinAmount.value"),b.value||p.value){q.value?B=new a(b.value).mul(Math.pow(10,i.value.decimals)).toString():B=new a(p.value).mul(Math.pow(10,u.value.decimals)).toString();let V,N=q.value;if(console.log("执行##"),L.value||uo.value){const K=await X.calculateRemoveSwapAmount({lowerTick:s,upperTick:A,curSqrtPrice:new G(n.value.current_sqrt_price),fix_amount_a:N,receiveAmount:B,coinTypeA:n.value.autoPoolPositionInfo.coin_type_a,coinTypeB:n.value.autoPoolPositionInfo.coin_type_b,clmm_pool:n.value.address});if(console.log(K,"###swapResult"),K){V=new G(K.afterSqrtPrice),B=new G(K.swapOutAmount),V=n.value.current_sqrt_price,Q.value={swap_amount:K.swapInAmount,liquidity:K.liquidity,a2b:!N},N=!N;const Ao=n.value.token_a.decimals,To=n.value.token_b.decimals,Ro=new a(K.swapInAmount).div(new a(Math.pow(10,Ao))).toString(),xo=new a(K.swapOutAmount).div(new a(Math.pow(10,To))).toString();Co.value=So.sqrtPriceX64ToPrice(K.afterSqrtPrice,Ao,To).toString();const te=k.value?n.value.token_b.symbol:n.value.token_a.symbol,ue=k.value?n.value.token_a.symbol:n.value.token_b.symbol;h.value=`To withdraw ${L.value?b.value:p.value} ${L.value?te:ue}, 
          ${xo} ${L.value?ue:te}  in the pool will be traded for ${Ro} ${L.value?te:ue}`}else V=n.value.current_sqrt_price,B=new G(B),Co.value=""}else V=n.value.current_sqrt_price,B=new G(B),Co.value="";console.log("执行了吗##");const{liquidityAmount:eo,tokenMaxA:io,tokenMaxB:vo}=R.value.estLiquidityAndcoinAmountFromOneAmounts({tokenA:i.value,tokenB:u.value,lowerTick:s,upperTick:A,coinAmount:B,iscoinA:N,roundUp:!1,slippage:Number(j.value)/100,curSqrtPrice:new G(V)});console.log(n.value.current_sqrt_price,"##positionInfo.value.current_sqrt_price"),console.log(vo.toString(),io.toString(),n.value,"###323"),!L.value&&!uo.value&&(q.value?p.value=Number(vo)>0?vo:"":b.value=Number(io)>0?io:"");const Po=re.get_lp_amount_by_liquidity({liquidity:n.value.liquidity,total_supply:n.value.total_supply},eo.toString());v.value=new a(Po).div(new a(Math.pow(10,n.value.lpInfo.decimals))).toString();const zo=new a(v.value).div(new a(T.value)).mul(100);g.value=Po,z.value=eo.toString(),_.value=zo.toNumber()}},z=C(),so=c(()=>{var s;return(s=n==null?void 0:n.value)==null?void 0:s.amountA}),po=c(()=>{var s;return(s=n==null?void 0:n.value)==null?void 0:s.amountB}),L=C(!1),uo=C(!1),Wo=c(()=>{var B,V,N,eo;const s=(V=no.value[(B=i==null?void 0:i.value)==null?void 0:B.address])==null?void 0:V.price,A=(eo=no.value[(N=u==null?void 0:u.value)==null?void 0:N.address])==null?void 0:eo.price;console.log(s,A,b.value,p.value,"####totalWithdraw");let Y;return s&&A&&(L.value||uo.value?Y=new a(L.value?b.value||0:p.value||0).mul(new a(L.value?s:A)).toString():(Y=new a(b.value||0).mul(new a(s)).add(new a(p.value||0).mul(new a(A))).toString(),console.log(Y,"result##"))),Y>0&&Y<.01?"<$0.01":`$${M(mo(Y,2))}`}),wo=async s=>{if(!S.value)return;S.value=!0,n.value.token_a.decimals,n.value.token_b.decimals;const A=n.value.tick_lower_index,Y=n.value.tick_upper_index;So.tickIndexToSqrtPriceX64(A),So.tickIndexToSqrtPriceX64(Y);let B="",V,N;console.log(s.value,"##item.value"),console.log(N,"##coinAmount");let eo=q.value;if(console.log("执行##"),L.value||uo.value){if(L.value){const vo=new a(yo.value).mul(Math.pow(10,i.value.decimals)).mul(s.value).toString();console.log(vo,"##amount"),N=mo(vo,0),b.value=new a(yo.value).mul(s.value).toString()}if(uo.value){const vo=new a(yo.value).mul(s.value).mul(Math.pow(10,u.value.decimals)).toString();N=mo(vo,0),p.value=new a(yo.value).mul(s.value).toString()}const io=await X.calculateRemoveSwapAmount({lowerTick:A,upperTick:Y,curSqrtPrice:new G(n.value.current_sqrt_price),fix_amount_a:eo,receiveAmount:N,coinTypeA:n.value.autoPoolPositionInfo.coin_type_a,coinTypeB:n.value.autoPoolPositionInfo.coin_type_b,clmm_pool:n.value.address});if(console.log(io,"###swapResult"),io){new G(io.afterSqrtPrice),N=new G(io.swapOutAmount),n.value.current_sqrt_price,Q.value={swap_amount:io.swapInAmount,liquidity:io.liquidity,a2b:!eo},eo=!eo;const vo=n.value.token_a.decimals,Po=n.value.token_b.decimals;Co.value=So.sqrtPriceX64ToPrice(io.afterSqrtPrice,vo,Po).toString();const zo=new a(io.swapInAmount).div(new a(Math.pow(10,vo))).toString(),K=new a(io.swapOutAmount).div(new a(Math.pow(10,Po))).toString(),Ao=k.value?n.value.token_b.symbol:n.value.token_a.symbol,To=k.value?n.value.token_a.symbol:n.value.token_b.symbol;h.value=`To withdraw ${L.value?b.value:p.value} ${L.value?Ao:To}, 
          ${K} ${L.value?To:Ao}  in the pool will be traded for ${zo} ${L.value?Ao:To}`,B=io.liquidity}else n.value.current_sqrt_price,N=new G(N),Co.value="";g.value=re.get_lp_amount_by_liquidity({liquidity:n.value.liquidity,total_supply:n.value.total_supply},B),v.value=new a(g.value).div(Math.pow(10,n.value.lpInfo.decimals)),z.value=B}else{const io=new a(so.value).mul(Math.pow(10,i.value.decimals)).mul(s.value).toString();N=mo(io,0),b.value=new a(so.value).mul(s.value).toString();const vo=new a(po.value).mul(s.value).mul(Math.pow(10,u.value.decimals)).toString();N=mo(vo,0),p.value=new a(po.value).mul(s.value).toString(),n.value.current_sqrt_price,N=new G(N),s.value!==1?V=new a(n.value.myLiquidity).mul(Math.pow(10,n.value.lpInfo.decimals)).mul(s.value).toString():V=new a(n.value.myLiquidity).mul(Math.pow(10,n.value.lpInfo.decimals)).toString(),v.value=new a(V).div(Math.pow(10,n.value.lpInfo.decimals)),B=re.get_share_liquidity_by_amount({liquidity:n.value.liquidity,total_supply:n.value.total_supply},V),g.value=mo(V,0),z.value=mo(B,0),Co.value=""}};ho(_,Be((s,A)=>{s!==A&&(Number(s)>100?_.value=100:s&&n.value?(console.log("687===>"),_.value=s,wo({value:_.value/100})):(b.value="--",p.value="--"))},300)),ho(()=>b.value,(s,A)=>{s?to():p.value=""},{immediate:!0}),ho(()=>p.value,(s,A)=>{s?to():b.value=""},{immediate:!0});const jo=Oe(),{setIsShowSuccess:Oo,setIsShowRejected:Io,setIsShowWaiting:$o,setTransactionDesc:No,setTransactionTxid:Mo,setPositiomNum:Xo,setTransactionDescText:Ho}=Z,lo=C(!1),{t:fo}=ge(),Qo=async()=>{var Po,zo;lo.value=!0,Mo("");const s=Number(b.value)>0?`${M(b.value,i.value.decimals)} ${i.value.symbol}`:"",A=Number(p.value)>0?`${M(p.value,u.value.decimals)} ${u.value.symbol}`:"";console.log(s,A,"###transactionDescTo"),No(fo("tips.removeLiquidiyText",{from:k.value?A:s,and:Number(b.value)>0&&Number(p.value)>0?"and":"",to:k.value?s:A})),$o(!0);const Y=fo("modal.removeLiquidityText2");Ho(Y);const B=n.value.autoPoolPositionInfo.tick_lower_index,V=n.value.autoPoolPositionInfo.tick_upper_index,N=So.tickIndexToSqrtPriceX64(B),eo=So.tickIndexToSqrtPriceX64(V),io=n.value.rewarderInfo.map(K=>K.coinAddress);console.log(z.value,g.value,"##liquidityVal.value");let vo;q.value?vo=new a(b.value).mul(Math.pow(10,i.value.decimals)).toString():vo=new a(p.value).mul(Math.pow(10,u.value.decimals)).toString();try{const K={lowerSqrtPrice:N,upperSqrtPrice:eo,lpTokenAmount:new G(g.value),liquidity:new G(z.value),curSqrtPrice:new G(n.value.object.current_sqrt_price),slippage:Number(j.value)/100,id:n.value.id,clmm_pool:n.value.autoPoolPositionInfo.pool,lp_token_type:n.value.lp_token_type,coinTypeA:n.value.autoPoolPositionInfo.coin_type_a,coinTypeB:n.value.autoPoolPositionInfo.coin_type_b,rewarder_coin_types:io,swapParams:Q.value,fix_amount_a:q.value,isOnlyA:L.value,isOnlyB:uo.value,lowerTick:B,upperTick:V,receiveAmount:vo},Ao=await X.remove(K);console.log(Ao,"移除流动性payload");const To=await l.value.currentWallet.signAndExecuteTransactionBlock(Ao);let Ro=R.value.handleTx(To);if(console.log("0331###remove###tx####",Ro),Ro&&Ro.hash){Mo(Ro.hash),$o(!1),Oo(!0);const xo={title:fo("common.removeLiquidity"),desc:"",hash:Ro.hash,descTransactions:`Remove ${s} ${Number(b.value)>0&&Number(p.value)>0?"and":""} ${A} from the pool`,sender:l.value.address,chainName:"Sui",tit:"Liquidity Removed",icon:"icon-icon-Removed",text:`Withdraw ${b.value} ${(Po=i.value)==null?void 0:Po.symbol} and ${p.value} ${(zo=u.value)==null?void 0:zo.symbol}`};xo.res=Ro.res,R.value.showTransitionPending(xo),await R.value.watchTransaction(xo)&&(b.value="",p.value="",v.value="",_.value=0,setTimeout(()=>{$.updatePositionItem(n.value.id),R.value.getAccount(l.value.address)},1e3),Number(_.value)==100&&r.name=="auto-pool-detail"&&jo.push("/pool/auto"))}else $o(!1),Io(!0);lo.value=!1}catch(K){console.log("Remove error",K),lo.value=!1,$o(!1),Io(!0)}};ho(()=>n.value,(s,A)=>{s&&!Lo(s)&&(i.value=s==null?void 0:s.token_a,u.value=s==null?void 0:s.token_b,console.log("触发###"),(!A||A&&A.address!==s.address)&&wo({value:_.value/100}))},{immediate:!0});const m=c(()=>{const s=Number(v.value)>Number(T.value);return!v.value||v.value<=0?fo("button.enterAmount"):s?"Invalid Amount":fo("button.remove")}),P=c(()=>!1),J=s=>(s==null?void 0:s.logoURI)||(s==null?void 0:s.logo_url)||Go("/image/coins/sui-unknown.png"),F=s=>{b.value="",p.value="",S.value=!0,s=="only-a"?(L.value=!L.value,uo.value=!1,q.value=!0):(uo.value=!uo.value,L.value=!1,q.value=!1)},ro=s=>{S.value=!0,_.value=100,s==="fromCoin"?q.value=!0:q.value=!1},oo=s=>{S.value=!0,_.value=50,s==="fromCoin"?q.value=!0:q.value=!1},yo=C(),bo=async()=>{const s=q.value,A=n.value.token_a.decimals,Y=n.value.token_b.decimals,B=new a(so.value).mul(new a(Math.pow(10,A))).toString(),V=new a(po.value).mul(new a(Math.pow(10,Y))).toString(),N=L.value?V:B;if(L.value||uo.value){console.log(N,"##receiveAmount");let eo=await R.value.preSwap({pool:{address:n.value.address,coinA:n.value.token_a,coinB:n.value.token_b},a2b:s,byAmountIn:q.value,amount:q.value?so.value:po.value});console.log(eo,"##preSwapRes"),yo.value=new a(eo.estimatedAmountOut).add(new a(L.value?po.value:so.value)).toString(),wo({value:_.value/100})}};return ho(()=>[L.value,uo.value,b.value,p.value],([s,A])=>{(s||A)&&bo()},{immediate:!0}),{removeLiquidityBtnText:m,removeLiquidityBtnDisabled:P,wallet:l,ratioArr:w,positionInfo:n,isShowRemoveModal:f,needReverse:k,fromCoin:i,toCoin:u,lpAmount:v,lpBalance:T,sliderVal:_,sFixD:mo,isSlider:S,fromCoinAmount:b,toCoinAmount:p,setPercent:wo,toRemove:Qo,addCommom:M,getCoinIcon:J,isOnlyA:L,isOnlyB:uo,onlyToken:F,fixedFromCoin:q,maxBtnSelect:ro,halfBtnSelect:oo,fromCoinBlance:so,toCoinBlance:po,showFromCoinLock:U,showToCoinLock:H,removeText:h,onlyTokenBalance:yo,totalWithdraw:Wo,formatter:s=>`${s}%`}}});const ne=o=>(Zo("data-v-47a0e784"),o=o(),Jo(),o),ks={class:"auto-pool-add"},ws={class:"auto-pool-add-content"},Cs={class:"liquidity-action-tab"},Is=ne(()=>e("div",{class:"remove tab-active"},"Remove",-1)),$s={class:"only-token"},As=ne(()=>e("div",null,"Deposit Amounts",-1)),Ss={key:0},Ps={key:0},Ts={key:0,class:"card-item"},Rs={key:1,class:"card-item"},qs={class:"remove-ratio"},Bs={class:"remove-ratio-select"},Os={key:0,class:"ratio"},Ns={key:1,class:"ratio"},Ms={class:"ratio-list"},Ls=["onClick"],Ds=ne(()=>e("span",null,"Pool Closed",-1)),Us={class:"remove-info"},Fs={key:0,class:"remove-text"},Vs={class:"total-amount"},Es=ne(()=>e("span",null,"Total Withdraw",-1)),Ws={class:"total-amount"},js=ne(()=>e("span",null,"LP Burn Amount",-1)),Xs={key:0},Hs={key:1};function zs(o,l,Z,W,j,I){var n,k,i,u,f,v,T,S,R,X,b,p,g,U,H,Q,q;const w=we,_=Ce,r=Le,$=ke,t=$e;return y(),O("div",ks,[e("div",ws,[e("div",Cs,[e("div",{class:"increase",onClick:l[0]||(l[0]=he(h=>o.$emit("changeCurrentTab"),["stop"]))},"Add"),Is]),e("div",$s,[As,e("div",null,[e("div",{class:"only-a",onClick:l[1]||(l[1]=h=>o.onlyToken("only-a"))},[e("p",null,[o.isOnlyA?(y(),O("span",Ss)):ao("",!0)]),e("span",null,d(o.needReverse?(u=(i=o.positionInfo)==null?void 0:i.token_b)==null?void 0:u.symbol:(k=(n=o.positionInfo)==null?void 0:n.token_a)==null?void 0:k.symbol)+" only",1)]),e("div",{class:"only-b",onClick:l[2]||(l[2]=h=>o.onlyToken("only-b"))},[e("p",null,[o.isOnlyB?(y(),O("span",Ps)):ao("",!0)]),e("span",null,d(o.needReverse?(S=(T=o.positionInfo)==null?void 0:T.token_a)==null?void 0:S.symbol:(v=(f=o.positionInfo)==null?void 0:f.token_b)==null?void 0:v.symbol)+" only",1)])])]),e("div",{class:ve(o.needReverse?"card-container reverse":"card-container")},[(o.needReverse?!o.isOnlyA:!o.isOnlyB)?(y(),O("div",Ts,[E(w,{modelValue:o.fromCoinAmount,"onUpdate:modelValue":l[3]||(l[3]=h=>o.fromCoinAmount=h),"input-value":o.fromCoinAmount,"coin-symbol":o.fromCoin?o.fromCoin.symbol:null,"coin-name":o.fromCoin?o.fromCoin.name:null,balance:o.isOnlyA?o.onlyTokenBalance:o.fromCoinBlance,"coin-icon":o.fromCoin?o.fromCoin.logoURI:"",address:o.fromCoin?o.fromCoin.address:"","swap-direct":"From","import-page":"deposit","has-arrow":!1,"amount-leabl":"Available",onOnMax:l[4]||(l[4]=h=>o.maxBtnSelect("fromCoin")),onOnHalf:l[5]||(l[5]=h=>o.halfBtnSelect("fromCoin")),onOnInput:l[6]||(l[6]=h=>{o.isSlider=!1,o.fromCoinAmount=h}),onOnFocus:l[7]||(l[7]=()=>{o.isSlider=!1,o.fixedFromCoin=!0})},null,8,["modelValue","input-value","coin-symbol","coin-name","balance","coin-icon","address"]),o.showFromCoinLock?(y(),_o(_,{key:0})):ao("",!0)])):ao("",!0),(o.needReverse?!o.isOnlyB:!o.isOnlyA)?(y(),O("div",Rs,[E(w,{modelValue:o.toCoinAmount,"onUpdate:modelValue":l[8]||(l[8]=h=>o.toCoinAmount=h),"input-value":o.toCoinAmount,"coin-symbol":o.toCoin?o.toCoin.symbol:null,"coin-name":o.toCoin?o.toCoin.name:null,balance:o.isOnlyB?o.onlyTokenBalance:o.toCoinBlance,"swap-direct":"To","coin-icon":o.toCoin?o.toCoin.logoURI:"",address:o.toCoin?o.toCoin.address:"","import-page":"deposit","has-arrow":!1,"amount-leabl":"Available",onOnMax:l[9]||(l[9]=h=>o.maxBtnSelect("toCoin")),onOnHalf:l[10]||(l[10]=h=>o.halfBtnSelect("toCoin")),onOnInput:l[11]||(l[11]=h=>{o.isSlider=!1,o.toCoinAmount=h}),onOnFocus:l[12]||(l[12]=()=>{o.isSlider=!1,o.fixedFromCoin=!1})},null,8,["modelValue","input-value","coin-symbol","coin-name","balance","coin-icon","address"]),o.showToCoinLock?(y(),_o(_,{key:0})):ao("",!0)])):ao("",!0)],2),e("div",qs,[e("div",Bs,[Number(o.lpBalance)>=Number(o.lpAmount)?(y(),O("div",Os,d(o.sliderVal>0&&Number(("sFixD"in o?o.sFixD:D(mo))(o.sliderVal,2))<.01?"<0.01":("sFixD"in o?o.sFixD:D(mo))(o.sliderVal,2))+"% ",1)):(y(),O("div",Ns,"--")),e("div",Ms,[(y(!0),O(Ne,null,Me(o.ratioArr,(h,x)=>(y(),O("div",{key:x,class:ve(["ratio-item",o.sliderVal==h.value?"ratio-item-active":""]),onClick:()=>{o.isSlider=!0,o.sliderVal=h.value}},d(h.name),11,Ls))),128))])]),E(r,{value:o.sliderVal,"onUpdate:value":l[13]||(l[13]=h=>o.sliderVal=h),"tip-formatter":o.formatter},null,8,["value","tip-formatter"])])]),(R=o.positionInfo)!=null&&R.is_pause?(y(),_o($,{key:0,class:"big-btn liquidity-btn",disabled:!0},{default:Yo(()=>[Ds]),_:1})):o.wallet.connected?(y(),_o($,{key:1,class:"big-btn liquidity-btn",disabled:o.removeLiquidityBtnDisabled,onClick:o.toRemove},{default:Yo(()=>[e("span",null,d(o.removeLiquidityBtnText),1)]),_:1},8,["disabled","onClick"])):(y(),_o($,{key:2,class:"big-btn",onClick:l[14]||(l[14]=h=>o.wallet.setIsShowWalletModal(!0))},{default:Yo(()=>[e("span",null,d(o.$t("button.connectWallet")),1)]),_:1})),e("div",Us,[o.isOnlyA||o.isOnlyB?(y(),O("div",Fs,d(o.removeText),1)):ao("",!0),e("div",Vs,[Es,e("span",null,d(o.totalWithdraw),1)]),e("div",Ws,[js,o.fromCoinAmount||o.toCoinAmount?(y(),O("span",Xs,d(("addCommom"in o?o.addCommom:D(M))(o.lpAmount))+" "+d(o.needReverse?(X=o.toCoin)==null?void 0:X.symbol:(b=o.fromCoin)==null?void 0:b.symbol)+"-"+d(o.needReverse?(p=o.fromCoin)==null?void 0:p.symbol:(g=o.toCoin)==null?void 0:g.symbol),1)):(y(),O("span",Hs,d(("addCommom"in o?o.addCommom:D(M))(o.lpAmount))+" "+d(o.needReverse?(U=o.toCoin)==null?void 0:U.symbol:(H=o.fromCoin)==null?void 0:H.symbol)+"-"+d(o.needReverse?(Q=o.fromCoin)==null?void 0:Q.symbol:(q=o.toCoin)==null?void 0:q.symbol),1))])]),o.isShowRemoveModal?(y(),_o(t,{key:3,"pool-info":o.positionInfo,"from-coin":o.positionInfo.token_a,"to-coin":o.positionInfo.token_b,onOnClose:l[15]||(l[15]=h=>o.isShowRemoveModal=!1)},null,8,["pool-info","from-coin","to-coin"])):ao("",!0)])}const Ys=Eo(hs,[["render",zs],["__scopeId","data-v-47a0e784"]]),Gs=Fo({components:{AutoPoolV2Info:Ae,AutoPoolV2PositionRange:Se,AutoPoolV2PoolComposition:Pe,AutoPoolV2PoolLiquidity:Te,AutoPoolV2PoolAdd:gs,AutoPoolV2PoolRemove:Ys},setup(){const o=Uo(),l=Do(),Z=ae(),W=c(()=>Z),j=()=>{o.getAutoPoolAPY(),o.getAutoPoolList(),l.setPoolConfigList(W.value.chainName,W.value.filterCoinsObj)},I=C(),w=Vo();return ho(()=>w.query.action,_=>{_&&(I.value=_)},{immediate:!0}),{clickRefresh:j,currentTab:I}}});const Zs={class:"auto-pool-detail-v2"},Js={class:"detail-top"},Ks={class:"detail-bottom pc-detail"},Qs={class:"detail-bottom-left"},xs={class:"detail-bottom-right"},ol={class:"h5-detail"};function el(o,l,Z,W,j,I){const w=Re,_=Ae,r=Se,$=Pe,t=Te,n=fe("AutoPoolV2PoolAdd"),k=fe("AutoPoolV2PoolRemove");return y(),O("div",Zs,[e("div",Js,[E(w,{onClickRefresh:o.clickRefresh},null,8,["onClickRefresh"]),E(_)]),e("div",Ks,[e("div",Qs,[E(r),E($),E(t)]),e("div",xs,[o.currentTab=="add"?(y(),_o(n,{key:0,onChangeCurrentTab:l[0]||(l[0]=i=>o.currentTab="remove")})):(y(),_o(k,{key:1,onChangeCurrentTab:l[1]||(l[1]=i=>o.currentTab="add")}))])]),e("div",ol,[o.currentTab=="add"?(y(),_o(n,{key:0,onChangeCurrentTab:l[2]||(l[2]=i=>o.currentTab="remove")})):(y(),_o(k,{key:1,onChangeCurrentTab:l[3]||(l[3]=i=>o.currentTab="add")})),E(r),E($),E(t)])])}const Sl=Eo(Gs,[["render",el],["__scopeId","data-v-b226cf01"]]);export{Sl as default};
