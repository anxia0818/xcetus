import{a as st,b as Xt,n as ft,d as Pe,u as kt,e as Xe,c as qe,i as Nt,s as gt,T as yt,p as _t,f as je,g as Ct}from"./pool.35fd4e00.js";import{a as tt,r as X,m as $,y as Zt,D as Me,e as ot,o as h,f as j,c as Ze,x as ie,h as r,t as pt,G as Gt,H as bt,v as ue,u as Ce,F as ut,J as wt,p as At,k as Lt,s as It,z as Je,l as qt,E as Mt,C as $t,q as xt,i as De,b as Kt,j as Pt,w as Jt,I as Qt,B as Yt}from"./entry.f6bb9ee2.js";/* empty css              */import{s as nt,m as Vt,l as eo,b as to,a as oo}from"./transform.c672907f.js";import{D as l}from"./decimal.0e8aa3f1.js";import{u as ct,a as io}from"./sha256.dba739f5.js";import"./decimal.633e31ee.js";import{c as Rt,_ as Bt,b as Ft,a as Ot}from"./new-liquidity-title.294f8168.js";import{i as at}from"./import-icon.de3e6c66.js";import{tickList as et,direction as $e,minPrice as Z,maxPrice as z,fromCoin as _,toCoin as C,positionError as rt,currentPrice as lt,currentPriceReverse as ht,currentPriceTab as J,defaultMinPrice as mt,defaultMaxPrice as vt,priceConfigObj as Ke,fromCoinAmount as y,toCoinAmount as S,fixedFromCoin as _e,toggle as no,resetTickList as Tt,resetData as ro}from"./data.6bd18c6f.js";import{_ as ao,a as lo,b as so}from"./icon-Add-Liquidity_2x.02e24302.js";import{_ as uo}from"./coin-select.0631d67f.js";import{_ as co}from"./viewDetail.a7ee882f.js";import{_ as mo}from"./token-warning-modal.1ac77e27.js";import{a as vo}from"./new-add-or-create.0087f2f7.js";/* empty css              */import{u as fo}from"./notifi.016fa3cf.js";/* empty css              */import"./tick.505fdad3.js";import"./token-warning.1111f41b.js";import"./refresh-icon.ff90eb0a.js";/* empty css              *//* empty css              */import"./swap-setting.5f3ca5d0.js";/* empty css              */import"./img-lock_2x.cafd1244.js";import"./img-no-Positions_2x.2694b4cc.js";import"./status-block.5fd235cb.js";import"./icon-arrow_2x.948aedb2.js";import"./icon-arrow_2x.4ffddb8e.js";import"./icon-selected_3x.09e9a6f0.js";import"./useWhale.234fbe6a.js";import"./index.5c9b9022.js";function St(e,a,se){const W=new l(10).pow(a-se);return new l(1.0001).pow(e).mul(W)}const go=tt({props:{poolInfo:{type:Object,default:()=>({chartLoading:!1,token_a:{decimal:6},token_b:{decimal:6},currentLiquity:"50000000"})},minPrice:{type:String,default:""},maxPrice:{type:String,default:""},direction:{type:Boolean,default:!0},tickList:{type:Array,default:()=>[]},currentTick:{type:Number,default:0},chartLoading:{type:Boolean,default:!1},currentPriceTab:{type:String,default:""},before7dContractPriceLowest:{type:String,default:""},before7dContractPriceHighest:{type:String,default:""},zoom:{type:Number,default:1}},setup(e,a){const se=X(""),W=X(""),O=$(()=>{var n,v,s,I,B,p;return console.log(e.poolInfo,"===>props.poolInfo"),(n=e.poolInfo)!=null&&n.current_sqrt_price&&((v=e.poolInfo)!=null&&v.coinA.decimals)&&((s=e.poolInfo)!=null&&s.coinB.decimals)?i.sqrtPriceX64ToPrice((I=e.poolInfo)==null?void 0:I.current_sqrt_price,(B=e.poolInfo)==null?void 0:B.coinA.decimals,(p=e.poolInfo)==null?void 0:p.coinB.decimals).toString():"0"}),be=$(()=>{let n=0;return e.direction?n=(Number(e.minPrice)/Number(O.value)-1)*100:n=(Number(e.minPrice)/Number(1/Number(O.value))-1)*100,n=n>0&&n<.1?.1:n,n=n<0&&n>-.1?-.1:n,n}),H=$(()=>{let n=0;return e.direction?n=(Number(e.maxPrice)/Number(O.value)-1)*100:n=(Number(e.maxPrice)/Number(1/Number(O.value))-1)*100,n=n>0&&n<.1?.1:n,n=n<0&&n>-.1?-.1:n,n}),E=ct(),N=$(()=>E),le=$(()=>N.value.chainName?st(N.value.chainName):{}),{TickMath:i,getNearestTickByTick:k}=le.value,G=(n=[])=>{let v=6;const s=Math.abs(Number(n[0])-Number(n[n.length-1]));return s>=6?v=0:s>=1?v=1:s>=.1?v=2:s>=.01?v=3:s>=.001?v=4:s>=1e-4?v=5:s>=1e-5?v=6:s>=1e-6?v=7:s>=1e-7&&(v=8),v},Q=(n,v=1)=>{if(n&&n.token_a&&!e.chartLoading&&e.minPrice&&e.maxPrice){const s=Number(e.poolInfo.current_tick_index);console.log("0117###dataProcessing###currentTick###",s),console.log("0117###dataProcessing###props.poolInfo###",e.poolInfo),console.log("0117###dataProcessing###minPrice###",e.minPrice),console.log("0117###dataProcessing###maxPrice###",e.maxPrice),console.log("0117###dataProcessing###poolInfo###",e.poolInfo);let I=s+100*v,B=s-100*v,p,V;if(e.maxPrice==="∞")V=le.value.TickUtil.getMaxIndex(Number(e.poolInfo.tickSpacing));else try{e.direction?V=i.priceToTickIndex(new l(e.maxPrice),e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals):V=i.priceToTickIndex(new l(1).div(e.minPrice),e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals)}catch{V=443636}if(e.minPrice==="0")p=le.value.TickUtil.getMinIndex(Number(e.poolInfo.tickSpacing));else try{e.direction?p=i.priceToTickIndex(new l(e.minPrice),e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals):p=i.priceToTickIndex(new l(1).div(e.maxPrice),e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals)}catch{p=-443636}let ne=0;if(e.currentPriceTab!=="full range"){if(s>=p&&s<=V){const w=s-p,re=V-s;ne=Math.max(Math.abs(w),Math.abs(re))}else s<p?ne=Math.abs(V-s):ne=Math.abs(s-p);I=s+ne+100*v,B=s-ne-100*v}else{const w=(Math.abs(s)>5e3,2e4);I=s+w*v,B=s-w*v}B<-443636&&(B=-443636),I>443636&&(I=443636);const m=new l(n.liquidity).div(Math.pow(10,8)).toString(),M=e.tickList;console.log("0117####drawChart####tick_info_array####",M);const A=[],P=[];let T={};for(let w=0;w<M.length;w++){if(T=M[w],T.index<=s&&T.index>=B){if(A.length<1&&w!==0){const re=M[w-1];A.unshift({...re,index:B})}A.unshift(T)}else if(T.index>s&&T.index<=I&&(P.push(T),A.length<1&&w!==0)){const re=M[w-1];A.push({...re,index:B})}if(T.index>I){const re=M[w];if(P.push({...re,index:I}),A.length<1&&w!==0){const xe=M[w-1];A.push({...xe,index:B})}break}}let x="0";for(let w=A.length-1;w>=0;w--)x=new l(x).plus(new l(A[w].liquidityNet.toString()).div(Math.pow(10,8))).toString(),A[w].liquityAmount=x;let b=m;for(let w=0;w<P.length;w++)b=new l(b).plus(new l(P[w].liquidityNet.toString()).div(Math.pow(10,8))).toString(),P[w].liquityAmount=b;let ee=[];const F=M&&M.length>0?{index:s,liquityAmount:Number(m)}:{index:s,liquityAmount:0};(A.length>0||P.length>0)&&(ee=[...A.reverse(),F,...P],e.direction||(ee=ee.reverse()));const Te=[];M.forEach(w=>{Te.push({...w,liquidityGross:w.liquidityGross.toString(),liquidityNet:w.liquidityNet.toString()})}),console.log("0117####drawChart####testTickInfoArray####",Te),console.log("0117####drawChart####currentLiquity####",m),U(ee,B,I,p,V,s)}};let L=X(!1);Zt(()=>{document.body.clientWidth<750?L.value=!1:L.value=!0,window.onresize=()=>{document.body.clientWidth<750?L.value=!1:L.value=!0,Q(e.poolInfo,e.zoom)}});const U=(n,v,s,I,B,p)=>{console.log("0117####drawChart####chartData####",n),console.log("0117####drawChart####tickMin####",v),console.log("0117####drawChart####tickMax####",s),console.log("0117####drawChart####minPriceTick####",I),console.log("0117####drawChart####maxPriceTick####",B),console.log("0117####drawChart####currentTick####",p),console.log("0117####drawChart####props.direction####",e.direction),console.log("0518###newd3###props.before7dContractPriceLowest###",e.before7dContractPriceLowest),console.log("0518###newd3###props.before7dContractPriceHighest###",e.before7dContractPriceHighest);let V,ne;e.direction?(V=e.before7dContractPriceLowest?i.priceToTickIndex(new l(e.before7dContractPriceLowest),e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals):"",ne=e.before7dContractPriceHighest?i.priceToTickIndex(new l(e.before7dContractPriceHighest),e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals):""):(V=e.before7dContractPriceLowest?i.priceToTickIndex(new l(1).div(e.before7dContractPriceLowest),e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals):"",ne=e.before7dContractPriceHighest?i.priceToTickIndex(new l(1).div(e.before7dContractPriceHighest),e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals):"");const m={top:30,right:35,bottom:20,left:55};let M,A;L.value?(M=480-m.left-m.right,A=208-m.top-m.bottom):(M=340-m.left-m.right,A=205-m.top-m.bottom);const P=s-v,T=parseInt(String(P/4));let x=[v+T/4,v+T,v+2*T,s-T,s-T/4];const b=v,ee=s,F=M/(ee-b);e.currentPriceTab==="full range"&&(x=[v,v+2*T,s]),console.log("0117####drawChart####xArr####",x),console.log("0117####drawChart####utickMin####",b),console.log("0117####drawChart####utickMax####",ee),console.log("0117####drawChart####unit####",F);const Te=x.map(u=>e.direction?St(u,e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals).toString():new l(1).div(St(u,e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals)).toString()),w=G(Te);nt("#chart").selectAll("*").remove();const re=nt("#chart").attr("width",M+m.left+m.right).attr("height",A+m.top+m.bottom).append("g").attr("transform",`translate(${m.left},${m.right})`),xe=Vt(n,function(u){return Number(Math.abs(u.liquityAmount))})||0,t=eo().range([0,A]).domain([xe,0]);to().rangeRound([0,M]).padding(.1);const R=re.append("g").attr("id","barsBox").selectAll("rect").data(n).enter().append("rect");N.value.theme=="default"?R.attr("x",function(u,c){return c===0?0:e.direction?Math.abs(u.index-b)*F:Math.abs(ee-u.index)*F}).attr("y",function(u,c){return e.direction?c===n.length-1?0:t(u.liquityAmount):c===n.length-1?0:t(n[c+1].liquityAmount)}).attr("width",function(u,c){return c===0&&n.length===1&&u.liquityAmount>0?M:(e.direction,c!==n.length-1?Math.abs(n[c+1].index-u.index)*F:0)}).attr("height",function(u,c){return c===0&&n.length===1&&u.liquityAmount>0?A:e.direction?c===n.length-1?0:A-t(u.liquityAmount):c===n.length-1?0:A-t(n[c+1].liquityAmount)}).attr("fill","#279477").attr("class","bars").attr("stroke-width",1).attr("stroke","#279477"):R.attr("x",function(u,c){return c===0?0:e.direction?Math.abs(u.index-b)*F:Math.abs(ee-u.index)*F}).attr("y",function(u,c){return e.direction?c===n.length-1?0:t(Math.abs(u.liquityAmount)):c===n.length-1?0:t(Math.abs(n[c+1].liquityAmount))}).attr("width",function(u,c){return c===0&&n.length===1&&u.liquityAmount>0?M:(e.direction,c!==n.length-1?Math.abs(n[c+1].index-u.index)*F:0)}).attr("height",function(u,c){if(c===0&&n.length===1&&u.liquityAmount>0)return A;if(e.direction)return c===n.length-1?0:Number(u.liquityAmount)?A-t(Math.abs(u.liquityAmount)):0;{if(c===n.length-1)return 0;const Ue=A-t(Math.abs(n[c+1].liquityAmount));return Number(n[c+1].liquityAmount)?Ue:0}}).attr("fill","#407497").attr("class","bars").attr("stroke-width",1).attr("stroke","#407497");const D=re.append("g");D.append("line").attr("x1",0).attr("y1",155).attr("x2",M).attr("y2",155).attr("stroke-width",1).attr("stroke","#50535D");const ce=D.append("g");let ae=0;if(e.direction){for(let u=0;u<x.length;u++){const c=Pe(Te[u],w)||"0";console.log("0423####price####",c),Te.push(c);const Ue=Math.abs(x[u]-b)*F;let me=0;for(let ve=0;ve<c.length;ve++)c[ve]==="1"?me+=4.02:c[ve]==="."?me+=2.64:c[ve]==="7"?me+=5.48:me+=6;console.log(Ue,"x=>>>"),ce.append("text").text(c).attr("x",Ue-me/2).attr("y",168).attr("fill","rgba(255, 255, 255, 0.5").style("font-size","10")}ae=Math.abs(p-b)*F}else{for(let u=x.length-1;u>=0;u--){const c=Pe(Te[u],w)||0;Te.push(c);const Ue=Math.abs(x[u]-ee)*F;let me=0;for(let ve=0;ve<c.length;ve++)c[ve]==="1"?me+=4.02:c[ve]==="."?me+=2.64:c[ve]==="7"?me+=5.48:me+=6;ce.append("text").text(c).attr("x",Ue-me/2).attr("y",168).attr("fill","rgba(255, 255, 255, 0.5").style("font-size","10")}ae=Math.abs(p-ee)*F}(N.value.theme=="default"?re.append("line").attr("x1",0).attr("y1",0).attr("x2",0).attr("y2",155).attr("stroke-width",2).attr("stroke","#68FFD8"):re.append("line").attr("x1",0).attr("y1",0).attr("x2",0).attr("y2",155).attr("stroke-width",2).attr("stroke","#76C8FF")).attr("transform","translate("+ae+", 0)");let Re,Be,We,ze;e.direction?(console.log("0525###d3###select###minPriceTick###",I),console.log("0525###d3###select###maxPriceTick###",B),console.log("0525###d3###select###props.minPrice###",e.minPrice),console.log("0525###d3###select###props.maxPrice###",e.maxPrice),Re=I<b?-100:parseInt(String(Math.abs(I-b)*F)),Be=B<b?-100:parseInt(String(Math.abs(B-b)*F)),We=V<b?-100:Math.abs(V-b)*F,ze=ne<b?-100:Math.abs(ne-b)*F):(Be=I<b?-100:Math.abs(ee-I)*F,Re=B<b?-100:Math.abs(ee-B)*F,ze=V<b?-100:Math.abs(ee-V)*F,We=ne<b?-100:Math.abs(ee-ne)*F),e.minPrice==="0"&&(Re=0),e.maxPrice==="∞"&&(Be=M),L.value?se.value=M-Re+60+"px":se.value=M-Re+52+"px",W.value=Be+74+"px",V&&We<M&&re.append("line").attr("x1",0).attr("y1",0).attr("x2",0).attr("y2",155).attr("stroke-width",1).attr("stroke-dasharray","5, 5").attr("stroke","rgba(255, 255, 255, 0.5)").attr("transform","translate("+We+", 0)"),ne&&ze<M&&re.append("line").attr("x1",0).attr("y1",0).attr("x2",0).attr("y2",155).attr("stroke-width",1).attr("stroke-dasharray","5, 5").attr("stroke","rgba(255, 255, 255, 0.5)").attr("transform","translate("+ze+", 0)");const Se=re.append("g").attr("id","left-handle"),Fe=re.append("g").attr("id","right-handle");N.value.theme=="default"?(Se.append("line").attr("x1",0).attr("y1",0).attr("x2",0).attr("y2",155).attr("stroke-dasharray","5, 5").attr("stroke-width",2).attr("stroke","#68FFD8"),Se.append("path").attr("d","M0 0 L12 0 L12 20 L0 20 Z").attr("fill","#333").attr("stroke","#333").attr("transform","translate(-1, 20) rotate(180)"),Se.append("rect").attr("width",1).attr("height",7).attr("x",-9).attr("y",6).attr("fill","#68FFD8"),Se.append("rect").attr("width",1).attr("height",10).attr("x",-7).attr("y",4.5).attr("fill","#68FFD8"),Fe.append("line").attr("x1",0).attr("y1",0).attr("x2",0).attr("y2",155).attr("stroke-dasharray","5, 5").attr("stroke-width",2).attr("stroke","#68FFD8"),Fe.append("path").attr("d","M0 0 L12 0 L12 20 L0 20 Z").attr("fill","#333").attr("stroke","#333").attr("transform","translate(1, 0)"),Fe.append("rect").attr("width",1).attr("height",7).attr("x",7).attr("y",6).attr("fill","#68FFD8"),Fe.append("rect").attr("width",1).attr("height",10).attr("x",5).attr("y",4.5).attr("fill","#68FFD8")):(Se.append("line").attr("x1",0).attr("y1",0).attr("x2",0).attr("y2",155).attr("stroke-dasharray","5, 5").attr("stroke-width",2).attr("stroke","#76C8FF"),Se.append("path").attr("d","M0 0 L12 0 L12 24 L0 24 Z").attr("fill","#333").attr("stroke","#333").attr("transform","translate(-1, 24) rotate(180)"),Se.append("rect").attr("width",1).attr("height",7).attr("x",-9).attr("y",8).attr("fill","#76C8FF"),Se.append("rect").attr("width",1).attr("height",10).attr("x",-7).attr("y",6.5).attr("fill","#76C8FF"),Fe.append("line").attr("x1",0).attr("y1",0).attr("x2",0).attr("y2",155).attr("stroke-dasharray","5, 5").attr("stroke-width",2).attr("stroke","#76C8FF"),Fe.append("path").attr("d","M0 0 L12 0 L12 24 L0 24 Z").attr("fill","#333").attr("stroke","#333").attr("transform","translate(1, 0)"),Fe.append("rect").attr("width",1).attr("height",7).attr("x",7).attr("y",8).attr("fill","#76C8FF"),Fe.append("rect").attr("width",1).attr("height",10).attr("x",5).attr("y",6.5).attr("fill","#76C8FF")),console.log("0525###d3###select###minPriceTickX###",Re),console.log("0525###d3###select###maxPriceTickX###",Be),Se.attr("transform","translate("+Re+", 0)"),Fe.attr("transform","translate("+Be+", 0)");const Qe=oo().extent([[0,0],[M,A]]).handleSize(30).on("end",it);re.append("g").attr("class","brush").call(Qe).call(Qe.move,[Re,Be]);function it(u){if(!u.sourceEvent||!u.selection)return;Se.attr("transform","translate("+u.selection[0]+", 0)"),Fe.attr("transform","translate("+u.selection[1]+", 0)"),L.value?se.value=M-u.selection[0]+60+"px":se.value=M-u.selection[0]+52+"px",W.value=u.selection[1]+74+"px";let c,Ue;console.log("0525###d3###select###e.selection[0]###",u.selection[0]),console.log("0525###d3###select###e.selection[0]###",u.selection[1]),console.log("0525###d3###select###props.direction###",e.direction),console.log("0525###d3###select###width###",M),console.log("0525###d3###select###unit###",F),console.log("0525###d3###select###utickMin###",b),console.log("0525###d3###select###utickMax###",ee),console.log("0525###d3###select###props.poolInfo###",e.poolInfo);let me=0,ve=0;e.direction?(me=k(parseInt(String(u.selection[0]/F+b)),Number(e.poolInfo.tickSpacing)),c=i.tickIndexToPrice(me,e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals).toString(),ve=k(parseInt(String(u.selection[1]/F+b)),Number(e.poolInfo.tickSpacing)),Ue=i.tickIndexToPrice(ve,e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals).toString(),console.log("0525###d3###select###minTick###",me),console.log("0525###d3###select###maxTick###",ve),console.log("0525###d3###select###minPrice###",c),console.log("0525###d3###select###maxPrice###",Ue)):(ve=k(ee-u.selection[0]/F,Number(e.poolInfo.tickSpacing)),c=1/i.tickIndexToPrice(ve,e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals).toString(),me=k(ee-u.selection[1]/F,Number(e.poolInfo.tickSpacing)),Ue=1/i.tickIndexToPrice(me,e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals).toString()),a.emit("onChangeMinPrice",String(Pe(String(c),6))),a.emit("onChangeMaxPrice",String(Pe(String(Ue),6)))}N.value.theme=="default"?nt(".selection").attr("stroke","rgba(255, 255, 255, 0)").attr("fill","#15322C"):nt(".selection").attr("stroke","rgba(255, 255, 255, 0)").attr("fill","#152632")};X(""),Me(()=>[e.poolInfo,e.minPrice,e.maxPrice,e.currentPriceTab,e.zoom],([n,v,s,I,B])=>{console.log(n,v,s,s>v,"poolInfo && minPrice && maxPrice && (maxPrice > minPrice)"),n&&v&&s&&(n!=null&&n.liquidity)&&(I!=="Custom"||console.log("绘制"),Q(n,B))},{immediate:!0});const d=X(!1);return Me(()=>e.chartLoading,(n,v)=>{n!==v&&(d.value=n)},{immediate:!0,deep:!0}),console.log(e,"props===>"),{store:N,loading:d,rangeSizeLower:be,rangeSizeUpper:H,rangeSizeLowerPosition:se,rangeSizeUpperPosition:W,decimalFormat:Xt,numberformat:ft}}});const po=e=>(At("data-v-16ab6352"),e=e(),Lt(),e),bo={class:"chart-box"},ho={class:"chart"},ko=po(()=>r("svg",{id:"chart"},null,-1));function wo(e,a,se,W,O,be){const H=wt;return h(),j(ut,null,[e.tickList&&e.tickList.length>0&&e.loading?(h(),Ze(H,{key:0})):ie("",!0),r("div",bo,[pt(r("div",ho,[e.currentPriceTab!=="full range"?(h(),j("div",{key:0,class:"range-size range-size-lower",style:bt({right:e.rangeSizeLowerPosition})},ue(("numberformat"in e?e.numberformat:Ce(ft))(e.rangeSizeLower.toFixed(1),1))+"% ",5)):ie("",!0),e.currentPriceTab!=="full range"?(h(),j("div",{key:1,class:"range-size range-size-upper",style:bt({left:e.rangeSizeUpperPosition})},ue(("numberformat"in e?e.numberformat:Ce(ft))(e.rangeSizeUpper.toFixed(1),1))+"% ",5)):ie("",!0),ko],512),[[Gt,!e.loading]])])],64)}const Ut=ot(go,[["render",wo],["__scopeId","data-v-16ab6352"]]),yo=tt({props:{aprRewardsParameter:{type:Number,default:30},minPrice:{type:String,default:""},maxPrice:{type:String,default:""},fromCoin:{type:Object,default:()=>({})},toCoin:{type:Object,default:()=>({})},poolInfo:{type:Object,default:()=>({})},nameTab:{type:String,default:""}},setup(e){const a=[{label:"24H",value:24},{label:"7D",value:7},{label:"30D",value:30}],se=ct(),W=$(()=>se);$(()=>W.value.chainName);const O=kt(),be=$(()=>O),H=$(()=>W.value.chainName?st(W.value.chainName):{}),E=X(),N=async i=>{var B,p,V;console.log("0607###detail###getAprMethod###poolInfo###",i),console.log("0607###detail###getAprMethod###props.fromCoin###",e.fromCoin),console.log("0607###detail###getAprMethod###props.toCoin###",e.toCoin),console.log("0607###detail###getAprMethod###props.nameTab###",e.nameTab);let k;i.token_a.address.toLowerCase()===e.fromCoin.address.toLowerCase()&&i.token_b.address.toLowerCase()===e.toCoin.address.toLowerCase()?k=!0:k=!1,console.log("0607###detail###getAprMethod###directs###",k),console.log("0607###detail###getAprMethod###props.minPrice###",e.minPrice),console.log("0607###detail###getAprMethod###props.maxPrice###",e.maxPrice);let G,Q;k?(G=Number(e.minPrice),Q=Number(e.maxPrice)):e.maxPrice!=="∞"?(G=1/Number(e.maxPrice),Q=1/Number(e.minPrice)):(G=1/2**50,Q=2**50),console.log("0607###detail###getAprMethod###lowerUserPrice###",G),console.log("0607###detail###getAprMethod###upperUserPrice###",Q);let L=[];L=W.value&&W.value.addressHistTokens&&W.value.addressHistTokens[i.poolAddress]&&W.value.addressHistTokens[i.poolAddress].data&&W.value.addressHistTokens[i.poolAddress].data.length>0&&Object.fromEntries(W.value.addressHistTokens[i.poolAddress].data.map(ne=>[ne.key,ne.value]));let U,d;console.log(L,"===>addressHistTokensList"),e.aprRewardsParameter==7?(U=Number(L==null?void 0:L.before_7_d_contract_price_lowest),d=Number(L==null?void 0:L.before_7_d_contract_price_highest)):e.aprRewardsParameter==24?(U=Number(L==null?void 0:L.before_24_h_contract_price_lowest),d=Number(L==null?void 0:L.before_24_h_contract_price_highest)):(U=Number(L==null?void 0:L.before_30_d_contract_price_lowest),d=Number(L==null?void 0:L.before_30_d_contract_price_highest));const n=be.value.tokensObj;console.log("getEstPositionAPRWithMulti###params###lowerUserPrice###",G),console.log("getEstPositionAPRWithMulti###params###upperUserPrice###",Q),console.log("getEstPositionAPRWithMulti###params###lowerHistPrice###",U),console.log("getEstPositionAPRWithMulti###params###upperHistPrice###",d);const v=await H.value.getEstPositionAPRWithMulti(G,Q,U,d);console.log("getEstPositionAPRWithMulti###resMulti###",v.toString());const s=W.value.newTopPoolsObj[i.poolAddress];let I;if(s){e.aprRewardsParameter==7?I=Number(s.apr_7day.replace("%","")):e.aprRewardsParameter==24?I=Number(s.apr_24h.replace("%","")):I=Number(s.apr_30day.replace("%",""));const ne=Number(s.rewarder_apr[0].replace("%","")),m=Number(s.rewarder_apr[1].replace("%","")),M=Number(s.rewarder_apr[2].replace("%","")),A=new l(v.toString()).mul(I).toNumber(),P=new l(v.toString()).mul(ne).toNumber(),T=new l(v.toString()).mul(m).toNumber(),x=new l(v.toString()).mul(M).toNumber(),b=A+(i.rewarder_display1?P:0)+(i.rewarder_display2?T:0)+(i.rewarder_display3?x:0),ee=i.rewarder_infos[0]?(B=n[i.rewarder_infos[0].coinAddress])==null?void 0:B.symbol:"--",F=i.rewarder_infos[1]?(p=n[i.rewarder_infos[1].coinAddress])==null?void 0:p.symbol:"--",Te=i.rewarder_infos[2]?(V=n[i.rewarder_infos[2].coinAddress])==null?void 0:V.symbol:"--",w={aprFee:A==1/0||isNaN(A)?0:A,rewardAprList:[{rewarder_name:ee,rewarder_apr:P==1/0||isNaN(P)?0:P,styleName:"one",rewarder_display:i.rewarder_display1},{rewarder_name:F,rewarder_apr:T==1/0||isNaN(T)?0:T,styleName:"two",rewarder_display:i.rewarder_display2},{rewarder_name:Te,rewarder_apr:x==1/0||isNaN(x)?0:x,styleName:"three",rewarder_display:i.rewarder_display2}],aprPercentageTotal:b==1/0||isNaN(b)||b===0?0:b,aprPercentage:Nt(A/b,2),is_display_rewarder:i.is_display_rewarder};E.value=w,console.log(E.value,"===>aprPercentageObj.value")}};Me(()=>[e.poolInfo,e.minPrice,e.maxPrice,W.value.addressHistTokens],([i,k,G,Q])=>{i&&!qe(i)&&Q&&!qe(Q)&&N(i)},{immediate:!0}),Me(()=>[e.aprRewardsParameter],()=>{N(e.poolInfo)});const le=$(()=>{const i=E.value;return i&&i.is_display_rewarder?(i==null?void 0:i.aprPercentageTotal)>1e4?">10000":i.aprPercentageTotal<.01&&i.aprPercentageTotal>0?"<0.01":Xe(i.aprPercentageTotal,2):i&&!i.is_display_rewarder?(i==null?void 0:i.aprFee)>1e4?">10000":i.aprFee<.01&&i.aprFee>0?"<0.01":Xe(i.aprFee,2):"--"});return{timeList:a,aprPercentageObj:E,totalApr:le}}}),_o=""+globalThis.__publicAssetsURL("sui-image/farming.png");const jt=e=>(At("data-v-240a1eb7"),e=e(),Lt(),e),Co={class:"est-apr"},Po=jt(()=>r("div",{class:"title"},"Estimated APR",-1)),To={class:"apr-total"},So=jt(()=>r("img",{src:_o,alt:""},null,-1)),No={class:"time-list"},Ao=["onClick"];function Lo(e,a,se,W,O,be){return h(),j("div",Co,[Po,r("div",To,[r("span",null,ue(e.totalApr)+"%",1),So]),r("div",No,[(h(!0),j(ut,null,It(e.timeList,H=>(h(),j("div",{key:H.value,class:Je(["time-item",H.value==e.aprRewardsParameter?"time-item-active":""]),onClick:E=>e.$emit("changeAprRewardsParameter",H.value)},ue(H.label),11,Ao))),128))])])}const zt=ot(yo,[["render",Lo],["__scopeId","data-v-240a1eb7"]]),Io=tt({components:{NewLiquidityD3Chart:Ut,NewLiquidityApr:zt,NewLiquidityPrice:Rt},setup(){const{t:e,locale:a}=qt(),se=X("liquidity"),W=ct(),O=$(()=>W),be=$(()=>O.value.chainName),H=kt(),E=$(()=>H),N=$(()=>O.value.chainName?st(O.value.chainName):{}),le=Mt(),i=$(()=>{let t=null;for(let g=0;g<E.value.poolConfigList.length;g++){const R=E.value.poolConfigList[g];R.address==le.query.poolAddress&&(t=R)}return console.log(t,"===>basePoolInfo"),t}),k=$(()=>{let t=null;for(const g in E.value.poolsObj){const R=E.value.poolsObj[g];R.address==le.query.poolAddress&&(console.log(R,"p===>"),t=R)}return t}),G=X(),Q=X(!0),L=async(t,g)=>{if(g){Q.value=!0;const R=t.token_a.decimals,D=t.token_b.decimals;console.log(t,"pool===>1111"),lt.value=yt.sqrtPriceX64ToPrice(t==null?void 0:t.current_sqrt_price,R,D).toString(),ht.value=new l(1).div(yt.sqrtPriceX64ToPrice(t==null?void 0:t.current_sqrt_price,R,D)).toString(),_.value=t.needReverse?t.token_b:t.token_a,C.value=t.needReverse?t.token_a:t.token_b,G.value=t.needReverse,t.token_a.address.toLowerCase()===_.value.address.toLowerCase()&&t.token_b.address.toLowerCase()===C.value.address.toLowerCase()?$e.value=!0:$e.value=!1,console.log(t,"187===>"),console.log(t,"###pool===>");let ce={poolAddress:t.address,coinTypeA:t.coin_a_address,coinTypeB:t.coin_b_address};const ae=await N.value.getTicks(ce);et.value=ae?N.value.getTickDataFromUrlData(ae):[],console.log(et.value,"===>chartLoadingtickList.value"),n(t)}Q.value=!1,console.log(Q.value,"==>chartLoading.value")},U=X([]),d=X(),n=t=>{const g=t.token_a.decimals,R=t.token_b.decimals;let D=E.value.poolPriceConfigObj&&E.value.poolPriceConfigObj[t.address]&&E.value.poolPriceConfigObj[t.address].recommend_ranges||{};console.log(D,"===>priceConfigList");let ce,ae;const de=t.current_tick_index;d.value=t.current_tick_index,console.log(de,t.tickSpacing,"==>pool.tickSpacing"),ce=de-Number(t.type=="unstable"?Number(t.tickSpacing)*2:Number(t.tickSpacing)*3),ae=de+Number(t.type=="unstable"?Number(t.tickSpacing)*2:Number(t.tickSpacing)*3);const Re=N.value.TickMath.tickIndexToPrice(ce,g,R).toString(),Be=N.value.TickMath.tickIndexToPrice(ae,g,R).toString();D["full range"]={lower:N.value.TickUtil.getMinIndex(Number(k.value.tickSpacing)),upper:N.value.TickUtil.getMaxIndex(Number(k.value.tickSpacing))},D.custom={lower:ce,upper:ae,minPrice:Re,maxPrice:Be};const We=[];for(let ze in D)D[ze]&&(console.log(ze,"j==>"),We.push({...D[ze],key:ze}));console.log(We,"priceList"),t.type?t.isSelfBuilt?J.value="custom":t.type=="stable"?J.value="suggested":J.value="passive":J.value="custom",U.value=We,Ke.value=D,I({key:J.value,...D[J.value]})},v=X(""),s=X(""),I=t=>{console.log("priceTab====>",t),console.log("priceTab###poolInfo###",k.value),J.value=t.key.toLowerCase();const g=k.value.token_a.decimals,R=k.value.token_b.decimals,{lower:D,upper:ce}=t,ae=N.value.TickMath.tickIndexToPrice(D,g,R).toString(),de=N.value.TickMath.tickIndexToPrice(ce,g,R).toString();if(t.key=="full range"){v.value=D,s.value=ce,B();return}console.log($e.value,"===>direct.value"),$e.value?(mt.value=String(ae),Z.value=String(ae),vt.value=String(de),z.value=String(de),v.value=D,s.value=ce):(mt.value=String(1/Number(de)),Z.value=String(1/Number(de)),vt.value=String(1/Number(ae)),z.value=String(1/Number(ae)),v.value=N.value.TickMath.priceToTickIndex(new l(1/Number(de)),g,R),s.value=N.value.TickMath.priceToTickIndex(new l(1/Number(ae)),g,R)),console.log(Z.value,z.value,"===>111")},B=t=>{Z.value="0",z.value="∞"};Me(()=>k.value,(t,g)=>{console.log(g,"===>oldVal"),console.log(t,"===>newVal"),(!g&&t&&!qe(t)||g&&t&&g.address!==t.address)&&(console.log("池子信息"),L(t,!g||t.address!==g.address))},{immediate:!0}),$t(()=>{et.value=[]}),Me(()=>[i.value,k.value,E.value.recommendRangesObj],(t,g)=>{var R,D;console.log(t,"===>newValue369"),console.log(g,"===>oldValue369"),(!g||t[0]&&t[1]&&t[2]&&!qe(t[0])&&!qe(t[1]&&!qe(t[2]))||((R=t[0])==null?void 0:R.address)!==((D=g[0])==null?void 0:D.address))&&(console.log("3731111111"),t[0]&&t[2]&&!qe(t[0])&&!qe(t[2])&&(console.log(t[0],t[2],"======>374"),H.setSinglePool(t[0],t[2],be.value)))},{immediate:!0,deep:!0});const p=t=>{if(be.value=="Sui")switch(t){case"passive":return"/sui-image/icon_ conservative@2x.png";case"active":return"/sui-image/icon_active@2x.png";case"full range":return"/sui-image/icon_fullrange@2x.png";case"custom":return"/sui-image/icon_costom@2x.png";case"suggested":return"/sui-image/icon_stabel@2x.png"}else switch(t){case"passive":return"/image/icon_ conservative@2x.png";case"active":return"/image/icon_active@2x.png";case"full range":return"/image/icon_fullrange@2x.png";case"custom":return"/image/icon_costom@2x.png";case"suggested":return"/image/icon_stabel@2x.png"}},V=t=>{switch(t){case"suggested":return e("newAdd.suggested");case"active":return e("newAdd.active");case"passive":return e("newAdd.conservative");case"full range":return e("newAdd.fullRange");case"custom":return e("newAdd.custom")}},ne=t=>{var R,D;const g=E.value.poolPriceConfigObj&&E.value.poolPriceConfigObj[(R=k.value)==null?void 0:R.address]&&E.value.poolPriceConfigObj[(D=k.value)==null?void 0:D.address].type||"";if(console.log(g,t,"==>poolType"),g=="unstable")switch(t){case"active":return{top:"35%"};case"passive":return{top:"10%"};case"full range":return{top:"60%"};case"custom":return{top:"85%"}}else switch(t){case"suggested":return{top:"23%"};case"full range":return{top:"48%"};case"custom":return{top:"73%"}}},m=X(1),M=()=>{const t=m.value/2;m.value=t},A=()=>{const t=m.value*2;m.value=t};console.log(U.value,"==>priceTablList");const P=$(()=>{var t,g,R;return!k.value||qe(O.value.addressHistTokens)||!O.value.addressHistTokens[(t=k.value)==null?void 0:t.poolAddress]?null:Object.fromEntries((R=O.value.addressHistTokens[(g=k.value)==null?void 0:g.poolAddress])==null?void 0:R.data.map(D=>[D.key,D.value]))}),T=X(30),x=X("30D"),b=$(()=>$e.value?P.value&&Pe(T.value==7?P.value.before_7_d_contract_price_lowest:T.value==24?P.value.before_24_h_contract_price_lowest:P.value.before_30_d_contract_price_lowest,6)||0:P.value&&Pe(new l(1).div(T.value==7?P.value.before_7_d_contract_price_highest:T.value==24?P.value.before_24_h_contract_price_highest:P.value.before_30_d_contract_price_highest).toString(),6)||0),ee=$(()=>$e.value?P.value&&Pe(T.value==7?P.value.before_7_d_contract_price_highest:T.value==24?P.value.before_24_h_contract_price_highest:P.value.before_30_d_contract_price_highest,6)||0:(P.value&&Pe(1/Number(T.value==7?P.value.before_7_d_contract_price_lowest:T.value==24?P.value.before_24_h_contract_price_lowest:P.value.before_30_d_contract_price_lowest),6))==1/0?0:P.value&&Pe(1/Number(T.value==7?P.value.before_7_d_contract_price_lowest:T.value==24?P.value.before_24_h_contract_price_lowest:P.value.before_30_d_contract_price_lowest),6)||0),F=$(()=>{const t=Number(Z.value),g=Number(z.value);return Z.value&&z.value&&Z.value!=="0"&&z.value!=="∞"?gt(1/(1-Number((t/g)**.25)),2)+"x":1}),Te=$(()=>{var t,g,R,D,ce,ae;return((t=_.value)==null?void 0:t.isSelfBuilt)||((g=C.value)==null?void 0:g.isSelfBuilt)||((D=E.value.tokensObj[(R=_.value)==null?void 0:R.address])==null?void 0:D.isSelfBuilt)||((ae=E.value.tokensObj[(ce=C.value)==null?void 0:ce.address])==null?void 0:ae.isSelfBuilt)}),w=t=>{console.log(t,"####0731 priceRangeChangeMin"),t!==Z.value&&J.value=="full range"?(console.log(U.value,"===>priceTablList"),I({key:"custom",...U.value.custom})):J.value!=="full range"&&J.value!=="custom"?(J.value="custom",Z.value=t):Z.value=t},re=t=>{t!==z.value&&J.value=="full range"?I({key:"custom",...U.value.custom}):J.value!=="full range"&&J.value!=="custom"?(J.value="custom",z.value=t):z.value=t};return console.log(Z.value,z.value,"683==>"),Me(()=>[Z.value,z.value],([t,g])=>{console.log(t,g,"minmax new-liquidity-left")},{deep:!0,immediate:!0}),{positionError:rt,getCoinIcon:t=>{var g;return(t==null?void 0:t.logoURI)||(t==null?void 0:t.logo_url)||((g=E.value.tokensObj[t==null?void 0:t.address])==null?void 0:g.logo_url)||(O.value.theme==="default"?at("/image/coins/unknown.png"):at("/image/coins/sui-unknown.png"))},chainName:be,store:O,currentTab:se,currentPrice:lt,currentPriceReverse:ht,fromCoin:_,toCoin:C,direction:$e,needReverse:G,addCommom:Xe,decimalUi:Pe,priceTablList:U,currentPriceTab:J,sliderStyle:ne,poolInfo:k,tickList:et,getPriceTabImage:p,getPriceTabText:V,defaultMinPrice:mt,defaultMaxPrice:vt,minPrice:Z,maxPrice:z,currentTick:d,chartLoading:Q,zoomOut:M,zoomIn:A,zoom:m,priceTab:I,before7dContractPriceLowest:b,before7dContractPriceHighest:ee,aprRewardsTime:x,lever:F,aprRewardsParameter:T,isSelfBuilt:Te,priceRangeChangeMin:w,priceRangeChangeMax:re}}});const qo={class:"new-liquidity-left"},Mo={class:"select-range"},$o=r("span",null,"Select Range",-1),Ro={class:"range-tab"},Bo=["src"],Fo=["src"],Oo=r("span",null,"Liquidity",-1),Uo=["src"],jo=["src"],zo=r("span",null,"Price",-1),Ho={class:"price-info"},Do={class:"left"},Wo={class:"base-coin"},Eo={class:"base-coin-title"},Xo=r("span",null,"Base coin",-1),Zo=r("svg",{class:"icon icon-up","aria-hidden":"true"},[r("use",{"xlink:href":"#icon-exchange_up1"})],-1),Go=r("svg",{class:"icon icon-down","aria-hidden":"true"},[r("use",{"xlink:href":"#icon-exchange_down1"})],-1),xo=[Zo,Go],Ko={key:0,class:"base-coin-bottom"},Jo={alt:""},Qo={key:1,class:"base-coin-bottom"},Yo={alt:""},Vo={class:"leverage"},ei=r("div",{class:"leverage-title"},"Leverage",-1),ti={class:"laverage-value"},oi={class:"current-price"},ii=r("div",{class:"current-price-title"},"Current Price",-1),ni={key:0,class:"from-pre-to"},ri={class:"right"},ai={class:"price-range"},li={class:"left"},si={class:"price-slider"},ui={class:"slider"},ci=r("div",{class:"slider-ratio-content"},null,-1),di=[ci],mi={class:"price-tab-list"},vi=["onClick"],fi=["src"],gi={class:"right"},pi={class:"range-tab"},bi=["src"],hi=["src"],ki=r("span",null,"Liquidity",-1),wi=["src"],yi=["src"],_i=r("span",null,"Price",-1),Ci={class:"price-zoom"},Pi={class:"current-price"},Ti=r("div",{class:"current-price-title"},"Current Price",-1),Si={key:0,class:"from-pre-to"},Ni={class:"price-zoom-right"},Ai={key:2,class:"position-tips"},Li=["src"],Ii={class:"error"},qi={class:"leverage"},Mi={class:"left"},$i=r("div",{class:"leverage-title"},"Leverage",-1),Ri={class:"laverage-value"},Bi={class:"right"},Fi={key:0,class:"day-7-price-range"},Oi=r("i",null,null,-1),Ui={class:"gray"},ji={class:"apr-and-price"},zi={key:0,class:"position-tips"},Hi=["src"],Di={class:"error"};function Wi(e,a,se,W,O,be){var k,G,Q,L,U,d,n,v,s,I,B;const H=Ut,E=wt,N=zt,le=Rt,i=xt("image");return h(),j("div",qo,[r("div",Mo,[$o,r("div",Ro,[r("div",{class:Je(["liquidity",e.currentTab=="liquidity"?"liquidity-tab-active":""]),onClick:a[0]||(a[0]=p=>e.currentTab="liquidity")},[e.chainName=="Sui"?(h(),j("img",{key:0,src:e.currentTab=="liquidity"?"/sui-image/Liquidity-Sel.png":"/sui-image/Liquidity-Def.png",alt:""},null,8,Bo)):(h(),j("img",{key:1,src:e.currentTab=="liquidity"?"/image/green_chart.png":"/sui-image/Liquidity-Def.png",alt:""},null,8,Fo)),Oo],2),r("div",{class:Je(["price",e.currentTab=="price"?"price-tab-active":""]),onClick:a[1]||(a[1]=p=>e.currentTab="price")},[e.chainName=="Sui"?(h(),j("img",{key:0,src:e.currentTab=="price"?"/sui-image/Price-Sel.png":"/sui-image/Price-Def.png",alt:""},null,8,Uo)):(h(),j("img",{key:1,src:e.currentTab=="price"?"/image/price-chart.png":"/sui-image/Price-Def.png",alt:""},null,8,jo)),zo],2)])]),r("div",Ho,[r("div",Do,[r("div",Wo,[r("div",Eo,[Xo,r("div",{class:"change-price",onClick:a[2]||(a[2]=p=>e.direction=!e.direction)},xo)]),e.direction?(h(),j("div",Qo,[pt(r("img",Yo,null,512),[[i,e.getCoinIcon(e.toCoin)]]),r("span",null,ue((G=e.toCoin)==null?void 0:G.symbol),1)])):(h(),j("div",Ko,[pt(r("img",Jo,null,512),[[i,e.getCoinIcon(e.fromCoin)]]),r("span",null,ue((k=e.fromCoin)==null?void 0:k.symbol),1)]))]),r("div",Vo,[ei,r("div",ti,ue(e.lever),1)]),r("div",oi,[ii,r("div",null,[r("span",null,ue(e.poolInfo?e.direction&&!e.needReverse?("addCommom"in e?e.addCommom:Ce(Xe))(("decimalUi"in e?e.decimalUi:Ce(Pe))(e.currentPrice,6)):("addCommom"in e?e.addCommom:Ce(Xe))(("decimalUi"in e?e.decimalUi:Ce(Pe))(e.currentPriceReverse,6)):"--"),1),e.fromCoin&&e.toCoin?(h(),j("span",ni,ue(e.direction&&!e.needReverse?`${(Q=e.fromCoin)==null?void 0:Q.symbol} per ${(L=e.toCoin)==null?void 0:L.symbol}`:`${(U=e.toCoin)==null?void 0:U.symbol} per ${(d=e.fromCoin)==null?void 0:d.symbol}`),1)):ie("",!0)])])]),r("div",ri,[e.currentTab=="liquidity"?(h(),j("div",{key:0,class:"zoom-in",onClick:a[3]||(a[3]=(...p)=>e.zoomIn&&e.zoomIn(...p))}," - ")):ie("",!0),e.currentTab=="liquidity"?(h(),j("div",{key:1,class:"zoom-out",onClick:a[4]||(a[4]=(...p)=>e.zoomOut&&e.zoomOut(...p))}," + ")):ie("",!0)])]),r("div",ai,[r("div",li,[r("div",si,[r("div",ui,[r("div",{class:"slider-ratio",style:bt(e.sliderStyle(e.currentPriceTab))},di,4)])]),r("div",mi,[(h(!0),j(ut,null,It(e.priceTablList,p=>(h(),j("div",{key:p.key,class:Je(["price-tab-item",e.currentPriceTab==p.key?"price-tab-item-active":""]),onClick:V=>e.priceTab(p)},[r("img",{src:e.getPriceTabImage(p.key),alt:""},null,8,fi),r("span",null,ue(e.getPriceTabText(p.key)),1)],10,vi))),128))])]),r("div",gi,[r("div",pi,[r("div",{class:Je(["liquidity",e.currentTab=="liquidity"?"liquidity-tab-active":""]),onClick:a[5]||(a[5]=p=>e.currentTab="liquidity")},[e.chainName=="Sui"?(h(),j("img",{key:0,src:e.currentTab=="liquidity"?"/sui-image/Liquidity-Sel.png":"/sui-image/Liquidity-Def.png",alt:""},null,8,bi)):(h(),j("img",{key:1,src:e.currentTab=="liquidity"?"/image/green_chart.png":"/sui-image/Price-Def.png",alt:""},null,8,hi)),ki],2),r("div",{class:Je(["price",e.currentTab=="price"?"price-tab-active":""]),onClick:a[6]||(a[6]=p=>e.currentTab="price")},[e.chainName=="sui"?(h(),j("img",{key:0,src:e.currentTab=="price"?"/sui-image/Price-Sel.png":"/sui-image/Price-Def.png",alt:""},null,8,wi)):(h(),j("img",{key:1,src:e.currentTab=="price"?"/image/price-chart.png":"/sui-image/Liquidity-Def.png",alt:""},null,8,yi)),_i],2)]),r("div",Ci,[r("div",Pi,[Ti,r("div",null,[r("span",null,ue(e.poolInfo?e.direction&&!e.needReverse?("addCommom"in e?e.addCommom:Ce(Xe))(("decimalUi"in e?e.decimalUi:Ce(Pe))(e.currentPrice,6)):("addCommom"in e?e.addCommom:Ce(Xe))(("decimalUi"in e?e.decimalUi:Ce(Pe))(e.currentPriceReverse,6)):"--"),1),e.fromCoin&&e.toCoin?(h(),j("span",Si,ue(e.direction&&!e.needReverse?`${(n=e.fromCoin)==null?void 0:n.symbol} per ${(v=e.toCoin)==null?void 0:v.symbol}`:`${(s=e.toCoin)==null?void 0:s.symbol} per ${(I=e.fromCoin)==null?void 0:I.symbol}`),1)):ie("",!0)])]),r("div",Ni,[e.currentTab=="liquidity"?(h(),j("div",{key:0,class:"zoom-in",onClick:a[7]||(a[7]=(...p)=>e.zoomIn&&e.zoomIn(...p))}," - ")):ie("",!0),e.currentTab=="liquidity"?(h(),j("div",{key:1,class:"zoom-out",onClick:a[8]||(a[8]=(...p)=>e.zoomOut&&e.zoomOut(...p))}," + ")):ie("",!0)])]),e.fromCoin&&e.toCoin&&e.poolInfo&&e.currentTab=="liquidity"?(h(),Ze(H,{key:0,"pool-info":e.poolInfo,"min-price":e.minPrice,"max-price":e.maxPrice,direction:e.direction,"current-price-tab":e.currentPriceTab,"tick-list":e.tickList,"current-tick":e.currentTick,"chart-loading":e.chartLoading,zoom:e.zoom,"before7d-contract-price-lowest":e.before7dContractPriceLowest,"before7d-contract-price-highest":e.before7dContractPriceHighest,onOnChangeMinPrice:e.priceRangeChangeMin,onOnChangeMaxPrice:e.priceRangeChangeMax},null,8,["pool-info","min-price","max-price","direction","current-price-tab","tick-list","current-tick","chart-loading","zoom","before7d-contract-price-lowest","before7d-contract-price-highest","onOnChangeMinPrice","onOnChangeMaxPrice"])):ie("",!0),((B=e.tickList)==null?void 0:B.length)<=0&&e.chartLoading?(h(),Ze(E,{key:1})):ie("",!0),e.positionError&&e.poolInfo?(h(),j("div",Ai,[r("img",{src:("importIcon"in e?e.importIcon:Ce(at))("/image/icon-tips-error@2x.png"),alt:""},null,8,Li),r("p",Ii,ue(e.$t("tips.positionError")),1)])):ie("",!0)])]),r("div",qi,[r("div",Mi,[$i,r("div",Ri,ue(e.lever),1)]),r("div",Bi,[e.poolInfo&&(e.before7dContractPriceLowest||e.before7dContractPriceHighest)?(h(),j("div",Fi,[Oi,r("span",Ui,ue(e.aprRewardsParameter==7?"7D":e.aprRewardsParameter==24?"24H":"30D")+" Price Range",1),r("span",null,ue(("addCommom"in e?e.addCommom:Ce(Xe))(("decimalUi"in e?e.decimalUi:Ce(Pe))(e.before7dContractPriceLowest,6)))+" - "+ue(("addCommom"in e?e.addCommom:Ce(Xe))(("decimalUi"in e?e.decimalUi:Ce(Pe))(e.before7dContractPriceHighest,6))),1)])):ie("",!0)])]),r("div",ji,[De(N,{"apr-rewards-parameter":e.aprRewardsParameter,"name-tab":"deposit","from-coin":e.fromCoin,"to-coin":e.toCoin,"pool-info":e.poolInfo,"min-price":e.minPrice,"max-price":e.maxPrice,onChangeAprRewardsParameter:a[9]||(a[9]=p=>{e.aprRewardsParameter=p})},null,8,["apr-rewards-parameter","from-coin","to-coin","pool-info","min-price","max-price"]),De(le,{min:e.minPrice,max:e.maxPrice,"from-coin":e.fromCoin,"to-coin":e.toCoin,direct:e.direction,"default-min-price":e.defaultMinPrice,"default-max-price":e.defaultMaxPrice,"pool-info":e.poolInfo,loading:e.chartLoading,"current-price-tab":e.currentPriceTab,onOnChangeMinPrice:e.priceRangeChangeMin,onOnChangeMaxPrice:e.priceRangeChangeMax},null,8,["min","max","from-coin","to-coin","direct","default-min-price","default-max-price","pool-info","loading","current-price-tab","onOnChangeMinPrice","onOnChangeMaxPrice"]),e.positionError&&e.poolInfo?(h(),j("div",zi,[r("img",{src:("importIcon"in e?e.importIcon:Ce(at))("/image/icon-tips-error@2x.png"),alt:""},null,8,Hi),r("p",Di,ue(e.$t("tips.positionError")),1)])):ie("",!0)])])}const Ht=ot(Io,[["render",Wi]]),Ei=tt({components:{NewLiquidityTitle:Bt,NewLiquidityAssetsCard:Ft,NewLiquidityDepositRatio:Ot},setup(){const{t:e,locale:a}=qt(),se=ct(),W=$(()=>se),O=$(()=>W.value.chainName),be=kt(),H=$(()=>be),E=io(),N=$(()=>E),le=Mt(),i=$(()=>{let o=null;for(const f in H.value.poolsObj){const q=H.value.poolsObj[f];q.address==le.query.poolAddress&&(console.log(q,"p===>"),o=q)}return o}),k=X(!1),G=X(!1),Q=$(()=>W.value.theme),L=async(o,f)=>{_.value=o.needReverse?o.token_b:o.token_a,C.value=o.needReverse?o.token_a:o.token_b};Me(()=>i.value,(o,f)=>{console.log(f,"===>oldVal"),console.log(o,"===>newVal"),(!f&&o&&!qe(o)||f&&o&&f.address!==o.address)&&(console.log("池子信息"),L(o,!f||o.address!==f.address))},{immediate:!0});const U=$(()=>N.value.assets&&_.value&&N.value.assets[_.value.address]?_t(N.value.assets[_.value.address].balance,_.value.decimals):"0"),d=$(()=>N.value.assets&&C.value&&N.value.assets[C.value.address]?_t(N.value.assets[C.value.address].balance,C.value.decimals):"0"),n=o=>{o==="fromCoin"?(_e.value=!0,O.value==="Aptos"?y.value=Number(U.value)>0?_.value.symbol=="APT"?new l(Number(U.value)).sub(new l(.1)).lt(new l(0))?"0":new l(Number(U.value)).sub(new l(.1)).toString():String(U.value):"":y.value=Number(U.value)>0?_.value.symbol=="SUI"?new l(Number(U.value)).sub(new l(.05)).lt(new l(0))?"0":new l(Number(U.value)).sub(new l(.05)).toString():String(U.value):""):(_e.value=!1,O.value==="Aptos"?S.value=Number(d.value)>0?C.value.symbol=="APT"?new l(Number(d.value)).sub(new l(.1)).lt(new l(0))?"0":new l(Number(d.value)).sub(new l(.1)).toString():String(d.value):"":S.value=Number(d.value)>0?C.value.symbol=="SUI"?new l(Number(d.value)).sub(new l(.05)).lt(new l(0))?"0":new l(Number(d.value)).sub(new l(.05)).toString():String(d.value):"")},v=o=>{o==="fromCoin"?(_e.value=!0,y.value=Number(U.value)>0?gt(new l(Number(U.value)).div(2).toString(),_.value.decimals).toString():""):(_e.value=!1,S.value=Number(d.value)>0?gt(new l(Number(d.value)).div(2).toString(),C.value.decimals).toString():"")},s=X(),I=X(),B=X(),p=X(!1),V=o=>{var f,q,fe,Y;s.value=o,o==="fromCoin"?(I.value=((f=C.value)==null?void 0:f.address)||"",B.value=le.query.actions=="new-position"?(q=_.value)==null?void 0:q.address:i.value.needReverse?i.value.token_b.address:i.value.token_a.address):(I.value=((fe=_.value)==null?void 0:fe.address)||"",B.value=le.query.actions=="new-position"?(Y=C.value)==null?void 0:Y.address:i.value.needReverse?i.value.token_a.address:i.value.token_b.address),p.value=!0,console.log(p.value,"==>showCoinSelect.value ")},ne=o=>{var fe,Y,ge,he,ke,oe,te,we;const f=i.value.needReverse?i.value.token_b:i.value.token_a,q=i.value.needReverse?i.value.token_a:i.value.token_b;s.value==="fromCoin"?(((fe=_.value)==null?void 0:fe.address)===(f==null?void 0:f.address)||!((Y=_.value)!=null&&Y.address)?(C.value&&o.address.toLowerCase()===((ge=C)==null?void 0:ge.value.address.toLowerCase())&&(C.value=null),_.value=o):(_.value&&o.address.toLowerCase()===((he=_)==null?void 0:he.value.address.toLowerCase())&&(_.value=null),C.value=o),le.query.action||(le.query.fee="")):((ke=C.value)==null?void 0:ke.address)===(q==null?void 0:q.address)||!((oe=C.value)!=null&&oe.address)?(_.value&&o.address.toLowerCase()===((te=_)==null?void 0:te.value.address.toLowerCase())&&(_.value=null),C.value=o):(C.value&&o.address.toLowerCase()===((we=C)==null?void 0:we.value.address.toLowerCase())&&(C.value=null),_.value=o),p.value=!1},m=$(()=>W.value.chainName?st(W.value.chainName):{}),M=$(()=>W.value.slippage),A=X(),P=async()=>{var Oe,Ae,Le,Ie;if(x.value)return console.log("跳出"),!1;if(!Z.value&&!z.value)return!1;if(!y.value&&!S.value&&!Z.value&&!z.value)return;const o=i.value||{};if(qe(o))return;const{TickUtil:f,TickMath:q,getNearestTickByTick:fe}=m.value,Y=o==null?void 0:o.token_a.decimals,ge=o==null?void 0:o.token_b.decimals;let he,ke,oe,te,we,Ne,Ee,Ge,pe=o==null?void 0:o.current_tick_index,K;if(o.token_a.address.toLowerCase()===_.value.address.toLowerCase()&&o.token_b.address.toLowerCase()===C.value.address.toLowerCase()?K=!0:K=!1,Z.value==="0"&&z.value==="∞")oe=f.getMinIndex(Number(o.tickSpacing)),te=f.getMaxIndex(Number(o.tickSpacing)),we=q.tickIndexToSqrtPriceX64(oe),Ne=q.tickIndexToSqrtPriceX64(te);else if(J.value=="custom"){console.log(K,"===>directs1866"),K?(he=Number(Z.value),ke=Number(z.value)):(he=new l(1).div(z.value).toString(),ke=new l(1).div(Z.value).toString());try{Ee=he==0?-443636:q.priceToTickIndex(new l(he),Y,ge)}catch{Ee=-443636}try{Ge=q.priceToTickIndex(new l(ke),Y,ge)}catch{Ge=443636}oe=fe(Ee,Number(o.tickSpacing)),te=fe(Ge,Number(o.tickSpacing)),we=q.priceToSqrtPriceX64(new l(he),Y,ge);try{Ne=q.priceToSqrtPriceX64(new l(ke),Y,ge)}catch{console.log("0523###test###max###",ke),ke===1/0&&(console.log("0523###test###max###11111"),Ne=q.tickIndexToSqrtPriceX64(f.getMaxIndex(Number(o.tickSpacing))))}console.log("0518###pre###tick_lower###",oe,te,pe),console.log("0518###pre###tick_upper###",te)}else oe=(Oe=Ke.value[J.value])==null?void 0:Oe.lower,te=(Ae=Ke.value[J.value])==null?void 0:Ae.upper,we=q.tickIndexToSqrtPriceX64(oe),Ne=q.tickIndexToSqrtPriceX64(te);if(z.value!=="∞"&&oe>=te){k.value=!0,y.value="",G.value=!0,S.value="";return}if(console.log(te,pe,oe,"1922"),z.value==="∞"||pe>=oe&&pe<=te){k.value=!1,G.value=!1;let ye;if(y.value||S.value){if(_e.value){const dt=new l(y.value).mul(Math.pow(10,_.value.decimals)).toString();ye=new je(dt)}else{const dt=new l(S.value).mul(Math.pow(10,C.value.decimals)).toString();ye=new je(dt)}console.log(K,"======>directs");const{liquidityAmount:He,tokenMaxA:Ye,tokenMaxB:Ve,tokenMaxAOrigin:Wt,tokenMaxBOrigin:Et}=m.value.estLiquidityAndcoinAmountFromOneAmounts({tokenA:o.token_a,tokenB:o.token_b,lowerTick:oe,upperTick:te,coinAmount:ye,iscoinA:K?_e.value:!_e.value,roundUp:!0,slippage:Number(M.value)/100,curSqrtPrice:new je(o.current_sqrt_price)});A.value={liquidityAmount:He,tokenMaxA:Ye,tokenMaxB:Ve,tokenMaxAOrigin:Wt,tokenMaxBOrigin:Et},console.log(Ye,Ve,"preAdd"),K?_e.value?S.value=Number(Ve)>0?Ve:"":y.value=Number(Ye)>0?Ye:"":_e.value?S.value=Ye:y.value=Ve}}else if(pe>te){if(K?y.value="":S.value="",k.value=K,G.value=!K,y.value||S.value){let ye;if(K){const He=new l(S.value).mul(Math.pow(10,(Le=C.value)==null?void 0:Le.decimals)).toString();ye=new je(He),A.value={liquidityAmount:m.value.estimateLiquidityForCoinB(we,Ne,ye),tokenMaxA:0,tokenMaxB:S.value}}else{const He=new l(y.value).mul(Math.pow(10,(Ie=_.value)==null?void 0:Ie.decimals)).toString();ye=new je(He),A.value={liquidityAmount:m.value.estimateLiquidityForCoinB(we,Ne,ye),tokenMaxA:0,tokenMaxB:y.value}}}}else if(pe<oe){if(k.value=!K,G.value=K,K?S.value="":y.value="",y.value||S.value){let ye;if(K){const He=new l(y.value).mul(Math.pow(10,_.value.decimals)).toString();ye=new je(He),A.value={liquidityAmount:m.value.estimateLiquidityForCoinA(we,Ne,ye),tokenMaxA:y.value,tokenMaxB:0}}else{const He=new l(S.value).mul(Math.pow(10,C.value.decimals)).toString();ye=new je(He),A.value={liquidityAmount:m.value.estimateLiquidityForCoinA(we,Ne,ye),tokenMaxA:S.value,tokenMaxB:0}}}}else k.value=!0,y.value="",G.value=!0,S.value=""};Me(y,(o,f)=>{console.log(y,"===>fromCoinAmount"),o==""&&_e.value&&(S.value=""),o&&_e.value&&!x.value&&P()}),Me(S,(o,f)=>{console.log(o,"===>>>>newValsda"),o==""&&!_e.value&&(y.value=""),o&&!_e.value&&!x.value&&P()});const T=X("--"),x=X(!1),b=$(()=>H.value.RATES),ee=()=>{const o=b.value&&b.value[_.value.address]&&b.value[_.value.address].price,f=b.value&&b.value[C.value.address]&&b.value[C.value.address].price;if(o&&f){const q=new l(y.value>0?y.value:0).mul(o),fe=new l(S.value>0?S.value:0).mul(f),Y=q.add(fe).toNumber();T.value=Y>0&&Y<.01?"<0.01":Nt(Y,2)}else T.value="--"};Me(()=>[y.value,S.value,x.value],([o,f,q])=>{(o||f)&&!q?ee():(!o||!f)&&!q&&(T.value="--")},{immediate:!0}),Me(()=>T,o=>{console.log(o,"71911111")},{immediate:!0}),Me([Z,z],([o,f])=>{console.log(o,f,"==>minPrice,maxPrice"),Number(o)!==0&&Number(f)!==0&&!x.value?P():Number(o)!==0&&Number(f)!==0&&x.value&&w(),f!=="∞"&&Number(o)!==0&&Number(f)!==0&&Number(o)>=Number(f)?rt.value=!0:rt.value=!1,Number(o)==0&&Number(f)==0&&lt.value&&(rt.value=!0,console.log("价格区间错误"))},{deep:!0,immediate:!0});const F=o=>{console.log(o,"e"),x.value=!0,T.value=o,o>0?w():(y.value="",S.value="")},Te=X(),w=async()=>{var K,Oe;if(!Z.value&&!z.value)return!1;if(!y.value&&!S.value&&!Z.value&&!z.value)return;const o=i.value;if(qe(o))return;const{TickUtil:f,TickMath:q,getNearestTickByTick:fe}=m.value,Y=o==null?void 0:o.token_a.decimals,ge=o==null?void 0:o.token_b.decimals;let he,ke,oe,te,we,Ne,Ee;if(o.token_a.address.toLowerCase()===_.value.address.toLowerCase()&&o.token_b.address.toLowerCase()===C.value.address.toLowerCase()?Ee=!0:Ee=!1,Z.value==="0"&&z.value==="∞")oe=f.getMinIndex(Number(o.tickSpacing)),te=f.getMaxIndex(Number(o.tickSpacing));else if(J.value=="custom"){Ee?(he=Number(Z.value),ke=Number(z.value)):(he=new l(1).div(z.value).toString(),ke=new l(1).div(Z.value).toString());try{we=he==0?-443636:q.priceToTickIndex(new l(he),Y,ge)}catch{we=-443636}try{Ne=q.priceToTickIndex(new l(ke),Y,ge)}catch{Ne=443636}oe=fe(we,Number(o.tickSpacing)),te=fe(Ne,Number(o.tickSpacing))}else oe=(K=Ke.value[J.value])==null?void 0:K.lower,te=(Oe=Ke.value[J.value])==null?void 0:Oe.upper;const Ge=b.value[o==null?void 0:o.token_a.address].price,pe=b.value[o==null?void 0:o.token_b.address].price;$e.value?new je(o.current_sqrt_price):new je(1/o.current_sqrt_price),console.log($e.value,"===>direction.value"),console.log(o,"poolInfos===>"),console.log(oe,te,"####tick_lower tick_upper 889");try{const{amountA:Ae,amountB:Le,tokenAmountsInfo:Ie}=await m.value.estCoinAmountsFromTotalAmount({lowerTick:oe,upperTick:te,decimalsA:Y,decimalsB:ge,curSqrtPrice:new je(o.current_sqrt_price),totalAmount:T.value,tokenPriceA:Ge,tokenPriceB:pe});console.log(Ae,Le,"###estCoinAmountsFromTotalAmount 844"),console.log(o.needReverse,$e.value,"===>849"),Te.value=Ie,o.needReverse?$e.value?(y.value=Ae,S.value=Le):(y.value=Le,S.value=Ae):(y.value=Ae,S.value=Le)}catch(Ae){console.log(Ae,"e===>")}},re=X(!1),{setTransactionTxid:xe,setTransactionDesc:t,setIsShowWaiting:g,setIsShowSuccess:R,setPositiomNum:D,setIsShowRejected:ce}=se,ae=fo(),de=$(()=>H.value.currentPositionInfo),Re=X(!1),Be=async o=>{var we,Ne,Ee,Ge;console.log(i.value,"===> poolInfo.value"),re.value=!1,H.value.currentPositionInfo={},xe(""),t(e("tips.increaseLiquiditySuccess",{from:k.value?"":`${y.value} ${(we=_.value)==null?void 0:we.symbol}`,and:!k.value&&!G.value?"and":"",to:G.value?"":`${S.value} ${(Ne=C.value)==null?void 0:Ne.symbol}`})),g(!0);const f=$e.value?_e.value:!_e.value;let q,fe,Y,ge,he,ke;const oe=i.value.token_a.decimals,te=i.value.token_b.decimals;if(Z.value==="0"&&z.value==="∞")Y=m.value.TickUtil.getMinIndex(Number(i.value.tickSpacing)),ge=m.value.TickUtil.getMaxIndex(Number(i.value.tickSpacing));else if(J.value=="custom"){$e.value?(q=Number(Z.value),fe=Number(z.value)):(q=new l(1).div(z.value).toString(),fe=new l(1).div(Z.value).toString()),console.log("0519###toAdd###min###",q),console.log("0519###toAdd###max###",fe),console.log("0519###toAdd###minPrice.value###",Z.value),console.log("0519###toAdd###maxPrice.value###",z.value);try{he=q==0?m.value.TickUtil.getMinIndex(Number(i.value.tickSpacing)):m.value.TickMath.priceToTickIndex(new l(q),oe,te)}catch{he=m.value.TickUtil.getMinIndex(Number(i.value.tickSpacing))}try{ke=m.value.TickMath.priceToTickIndex(new l(fe),oe,te)}catch{ke=m.value.TickUtil.getMaxIndex(Number(i.value.tickSpacing))}Y=m.value.getNearestTickByTick(he,Number(i.value.tickSpacing)),ge=m.value.getNearestTickByTick(ke,Number(i.value.tickSpacing))}else Y=Ke.value[J.value].lower,ge=Ke.value[J.value].upper;console.log(Y,ge,"####tick_lower tick_upper 889"),console.log(i.value,"==>poolInfo.value.curSqrtPrice");try{let pe;x.value?pe=await m.value.getCreateAddLiquidityPayload({pool:i.value,curSqrtPrice:new je(i.value.current_sqrt_price),tickLower:Y,tickUpper:ge,slippage:Number(M.value)/100,tokenAmounts:Te.value}):pe=await m.value.getAddLiquidityTransactionPayload({pool:{poolAddress:i.value.poolAddress,token_a:i.value.token_a,token_b:i.value.token_b},amount:_e.value?y.value:S.value,fix_amount_a:f,tick_lower:Y,tick_upper:ge,index:0,slippage:Number(M.value)/100,roundUp:!0,collect_fee:!1,curSqrtPrice:new je(i.value.current_sqrt_price)}),console.log(pe,"payload===?");let K;if(O.value==="Aptos")K=await N.value.currentWallet.signAndSubmitTransaction(pe);else{const Oe=await N.value.currentWallet.signAndExecuteTransactionBlock(pe);K=m.value.handleTx(Oe)}if(console.log("0410###tx###",K),K&&K.hash){xe(K.hash),g(!1),R(!0);let Oe;i.value.needReverse?i.value.token_a.address.toLowerCase()===_.value.address.toLowerCase()&&i.value.token_b.address.toLowerCase()===C.value.address.toLowerCase()?Oe=!1:Oe=!0:i.value.token_a.address.toLowerCase()===_.value.address.toLowerCase()&&i.value.token_b.address.toLowerCase()===C.value.address.toLowerCase()?Oe=!0:Oe=!1,console.log(Oe,"===>directs");const Ae={title:"Supplied",desc:e("tips.addLiquiditySuccessText",{from:k.value?"":`${y.value} ${(Ee=_.value)==null?void 0:Ee.symbol}`,and:!k.value&&!G.value?"and":"",to:G.value?"":`${S.value} ${(Ge=C.value)==null?void 0:Ge.symbol}`}),hash:K.hash,tit:"Position Created",icon:"icon-icon-Position-Created"};O.value!=="Aptos"&&(Ae.res=K.res),m.value.showTransitionPending(Ae);const Le=await m.value.watchTransaction(Ae,!0);if(Le.status){if(R(!1),H.value.setCurrentPositionLoading(!0),Re.value=!0,console.log(Le.nftInfo,"===> watchInfo.nftInfo"),O.value==="Aptos"){if(await H.value.setCurrentPositionInfo(Le.nftInfo[0].data.id.creator,Le.nftInfo[0].data.id.collection,Le.nftInfo[0].data.name,O.value),o)try{await ae.subscribePosition({pool_address:de.value.poolAddress,position_index:de.value.index},de.value.nftHash)}catch(Ie){console.log(Ie,"e")}}else{const Ie=Le.nftInfo,ye=await Ct(2e3);if(await H.value.setCurrentPositionInfo(Ie==null?void 0:Ie.pool,"","",O.value,Ie==null?void 0:Ie.position),await Ct(1e3),console.log("0529###nftInfo###",Ie),console.log("0529###currentPositionInfo.value.index###",de.value.index),o)try{await ae.subscribePosition({pool_address:de.value.poolAddress,position_index:de.value.index},de.value.nftHash)}catch(He){console.log(He)}}setTimeout(()=>{be.updateCurrentPools(i.value.poolAddress,O.value),m.value.getAccount(N.value.address)},3e3),setTimeout(async()=>{Tt(m,i)},3e3)}D()}else g(!1),ce(!0);y.value="",S.value=""}catch(pe){y.value="",S.value="",console.log("0330###Add liquidity Error###",pe),g(!1),ce(!0)}},We=$(()=>!y.value&&!S.value?(console.log("addLiquidityBtnDisabled11111"),!0):Number(y.value)>Number(U.value)||Number(S.value)>Number(d.value)?(console.log("addLiquidityBtnDisabled22222"),!0):Se.value!==e("button.addLiquidity")&&Se.value!==e("newAdd.preview")?(console.log("addLiquidityBtnDisabled33333###",Se.value),!0):i.value&&i.value&&i.value.is_pause?(console.log("addLiquidityBtnDisabled44444"),!0):Number(y.value)<=0&&Number(S.value)<=0||!k.value&&Number(y.value)==0||!G.value&&Number(S.value)==0),ze=$(()=>!_.value||!C.value),Se=$(()=>i.value&&i.value.is_pause?"Pool Closed":!_.value||!C.value||ze.value?e("modal.selectTokenModalTitle"):Number(y.value)>Number(U.value)?e("button.insufficientBalance",{name:_.value.symbol}):Number(S.value)>Number(d.value)?e("button.insufficientBalance",{name:C.value.symbol}):!Number(y.value)&&!Number(S.value)?e("button.enterAmount"):z.value!=="∞"&&Number(Z.value)>=Number(z.value)?e("newAdd.invalidRange"):e("button.addLiquidity")),Fe=X({}),Qe=X({}),it=(o,f)=>{console.log(s.value,"===>currentCoinKey.value"),console.log(o);const q=localStorage.getItem(o.address);console.log(H.value.tokensObj,"===>pools.value.tokensObj"),console.log(q,"===>coinLocak"),H.value.tokensObj&&H.value.tokensObj[o.address]&&H.value.tokensObj[o.address].isSelfBuilt&&!q&&(f=="fromCoin"&&(Fe.value=o),f=="toCoin"&&(Qe.value=o),c.value=!0)};Me(()=>[_.value,C.value],([o,f])=>{o&&!qe(o)&&it(o,"fromCoin"),f&&!qe(f)&&it(f,"toCoin")},{immediate:!0});const u=Kt(),c=X(!1);return{inputChange:o=>{const f=new RegExp("[^\\d-]*(\\d*(?:\\.\\d*)?).*$");o.target.value=o.target.value.replace(f,"$1")},poolInfo:i,fromCoinAmount:y,toCoinAmount:S,fromCoin:_,toCoin:C,theme:Q,showFromCoinLock:k,showToCoinLock:G,fromCoinBlance:U,toCoinBlance:d,maxBtnSelect:n,halfBtnSelect:v,fixedFromCoin:_e,openCoinSelect:V,currentCoinKey:s,existingCoins:I,lastSelectCoin:B,showCoinSelect:p,onCoinSelect:ne,liquidityTotalAmount:T,toggle:no,onInput:F,isInputTotalAmount:x,isViewDetail:Re,addLiquidityBtnDisabled:We,addLiquidityBtnText:Se,isShowTokenWarning:c,chainName:O,closeTokenWarning:()=>{O.value!=="Aptos"?u.push("/pool/list"):u.push("/pools")},warningFromCoin:Fe,warningToCoin:Qe,isShowLiquidityModal:re,currentPrice:lt,currentPriceReverse:ht,currentPriceTab:J,minPrice:Z,maxPrice:z,toAdd:Be,direction:$e,wallet:N,getAddLiquidityType:o=>{x.value,Be(o)},clickRefresh:()=>{le.query.action!=="create-pool"&&le.query.actions!=="new-position"&&(Tt(m,i),P(),be.updateCurrentPools(i.value.poolAddress,O.value)),be.setPoolConfigList(O.value,W.value.filterCoinsObj)}}}});const Xi={class:"new-liquidity-right"},Zi={class:"deposit-title"},Gi={class:"card-container"},xi={class:"card-item"},Ki={class:"card-item"},Ji={class:"total-amount"},Qi=r("span",null,"Total Amount",-1);function Yi(e,a,se,W,O,be){const H=Bt,E=Ft,N=so,le=Qt,i=Ot,k=Yt,G=uo,Q=co,L=mo,U=vo;return h(),j("div",Xi,[r("div",Zi,[De(H,{"pool-info":e.poolInfo,onClickRefresh:e.clickRefresh},null,8,["pool-info","onClickRefresh"])]),r("div",Gi,[r("div",xi,[De(E,{modelValue:e.fromCoinAmount,"onUpdate:modelValue":a[0]||(a[0]=d=>e.fromCoinAmount=d),"input-value":e.fromCoinAmount,"coin-symbol":e.fromCoin?e.fromCoin.symbol:null,"coin-name":e.fromCoin?e.fromCoin.name:null,balance:e.fromCoinBlance,"coin-icon":e.fromCoin?e.fromCoin.logoURI:"",address:e.fromCoin?e.fromCoin.address:"","swap-direct":"From","import-page":"deposit","has-arrow":!1,onOnMax:a[1]||(a[1]=d=>e.maxBtnSelect("fromCoin")),onOnHalf:a[2]||(a[2]=d=>e.halfBtnSelect("fromCoin")),onOnInput:a[3]||(a[3]=d=>{e.fromCoinAmount=d,e.fixedFromCoin=!0,e.isInputTotalAmount=!1}),onOnSelect:a[4]||(a[4]=d=>e.openCoinSelect("fromCoin"))},null,8,["modelValue","input-value","coin-symbol","coin-name","balance","coin-icon","address"]),e.showFromCoinLock?(h(),Ze(N,{key:0,"from-coin":e.fromCoin,"to-coin":e.toCoin,"pool-info":e.poolInfo},null,8,["from-coin","to-coin","pool-info"])):ie("",!0)]),r("div",Ki,[De(E,{modelValue:e.toCoinAmount,"onUpdate:modelValue":a[5]||(a[5]=d=>e.toCoinAmount=d),"input-value":e.toCoinAmount,"coin-symbol":e.toCoin?e.toCoin.symbol:null,"coin-name":e.toCoin?e.toCoin.name:null,balance:e.toCoinBlance,"swap-direct":"To","coin-icon":e.toCoin?e.toCoin.logoURI:"",address:e.toCoin?e.toCoin.address:"","import-page":"deposit","has-arrow":!1,onOnMax:a[6]||(a[6]=d=>e.maxBtnSelect("toCoin")),onOnHalf:a[7]||(a[7]=d=>e.halfBtnSelect("toCoin")),onOnInput:a[8]||(a[8]=d=>{e.toCoinAmount=d,e.fixedFromCoin=!1,e.isInputTotalAmount=!1}),onOnSelect:a[9]||(a[9]=d=>e.openCoinSelect("toCoin"))},null,8,["modelValue","input-value","coin-symbol","coin-name","balance","coin-icon","address"]),e.showToCoinLock?(h(),Ze(N,{key:0,"from-coin":e.fromCoin,"to-coin":e.toCoin,"pool-info":e.poolInfo},null,8,["from-coin","to-coin","pool-info"])):ie("",!0)]),e.fromCoin&&e.toCoin&&!e.showToCoinLock&&!e.showFromCoinLock&&e.theme=="default"?(h(),j("img",{key:0,class:"add",src:ao,alt:"",onClick:a[10]||(a[10]=(...d)=>e.toggle&&e.toggle(...d))})):ie("",!0),e.fromCoin&&e.toCoin&&!e.showToCoinLock&&!e.showFromCoinLock&&e.theme!=="default"?(h(),j("img",{key:1,class:"add",src:lo,alt:"",onClick:a[11]||(a[11]=(...d)=>e.toggle&&e.toggle(...d))})):ie("",!0)]),r("div",Ji,[Qi,r("span",null,[Pt("$ "),De(le,{value:e.liquidityTotalAmount,placeholder:e.isInputTotalAmount?"":e.liquidityTotalAmount,onChange:e.inputChange,onInput:a[12]||(a[12]=d=>e.onInput(d.target.value))},null,8,["value","placeholder","onChange"])])]),De(i,{"from-coin":e.fromCoin,"to-coin":e.toCoin,"from-coin-amount":e.fromCoinAmount,"to-coin-amount":e.toCoinAmount,"fixed-from-coin":e.fixedFromCoin,"is-input-total-amount":e.isInputTotalAmount,"min-price":e.minPrice,"max-price":e.maxPrice,"current-price-tab":e.currentPriceTab,"current-price":e.currentPrice,"current-price-reverse":e.currentPriceReverse},null,8,["from-coin","to-coin","from-coin-amount","to-coin-amount","fixed-from-coin","is-input-total-amount","min-price","max-price","current-price-tab","current-price","current-price-reverse"]),De(k,{class:"add-liquidity-btn",disabled:e.addLiquidityBtnDisabled,onClick:a[13]||(a[13]=d=>e.wallet.connected?e.isShowLiquidityModal=!0:e.wallet.setIsShowWalletModal(!0))},{default:Jt(()=>[Pt(ue(e.addLiquidityBtnText),1)]),_:1},8,["disabled"]),e.showCoinSelect?(h(),Ze(G,{key:0,"existing-coins":e.existingCoins,"last-select-coin":e.lastSelectCoin,onOnSelect:e.onCoinSelect,onOnClose:a[14]||(a[14]=d=>e.showCoinSelect=!1)},null,8,["existing-coins","last-select-coin","onOnSelect"])):ie("",!0),e.isViewDetail?(h(),Ze(Q,{key:1,"pool-info":e.poolInfo,onOnClose:a[15]||(a[15]=d=>e.isViewDetail=!1)},null,8,["pool-info"])):ie("",!0),e.chainName=="Sui"&&e.isShowTokenWarning?(h(),Ze(L,{key:2,"from-coin":e.warningFromCoin,"to-coin":e.warningToCoin,onClose:e.closeTokenWarning,onClickContinue:a[16]||(a[16]=d=>e.isShowTokenWarning=!1)},null,8,["from-coin","to-coin","onClose"])):ie("",!0),e.isShowLiquidityModal?(h(),Ze(U,{key:3,"pool-info":e.poolInfo,title:e.$t("button.addLiquidity"),"from-coin-amount":e.fromCoinAmount,"to-coin-amount":e.toCoinAmount,"from-coin":e.fromCoin,"to-coin":e.toCoin,"fixed-from-coin":e.fixedFromCoin,"current-price":e.currentPrice,"current-price-reverse":e.currentPriceReverse,"current-price-tab":e.currentPriceTab,"min-price":e.minPrice,"max-price":e.maxPrice,"show-from-coin-lock":e.showFromCoinLock,"show-to-coin-lock":e.showToCoinLock,"current-direct":e.direction,"is-increase":!1,onToAdd:e.getAddLiquidityType,onOnClose:a[17]||(a[17]=d=>e.isShowLiquidityModal=!1)},null,8,["pool-info","title","from-coin-amount","to-coin-amount","from-coin","to-coin","fixed-from-coin","current-price","current-price-reverse","current-price-tab","min-price","max-price","show-from-coin-lock","show-to-coin-lock","current-direct","onToAdd"])):ie("",!0)])}const Dt=ot(Ei,[["render",Yi]]),Vi=tt({components:{NewLiquidityLeft:Ht,NewLiquidityRight:Dt},setup(){return $t(()=>{ro()}),{tickList:et}}});const en={key:0,class:"loading-spin-liquidity loading-global"},tn={class:"privide-liquidity"};function on(e,a,se,W,O,be){const H=wt,E=Ht,N=Dt;return h(),j(ut,null,[e.tickList?ie("",!0):(h(),j("div",en,[De(H)])),r("div",tn,[De(E),De(N)])],64)}const Un=ot(Vi,[["render",on],["__scopeId","data-v-f338bf1f"]]);export{Un as default};
