import{_ as re}from"./upgrade-select-input.975ad6e1.js";import{_ as ue}from"./upgrade-loading.23aff5b3.js";import{_ as ie}from"./upgrade-position-item.d71d7052.js";import{a as ce,r as p,y as de,b as me,l as m,q as $,J as ve,N as pe,T as ge,Y as he,e as fe,o as l,f as n,h as v,F as j,G as V,x as A,i as I,A as z,v as w,C as K,j as Y,w as be,B as _e,c as ye,p as ke,k as Le}from"./entry.2a5af59a.js";import{u as Se,c as Ae,a as we}from"./sha256.29e8c055.js";import{u as Te}from"./notifi.a5ade32f.js";import{u as Pe,c as Oe}from"./pool.07740aa6.js";import{i as Z}from"./import-icon.de3e6c66.js";import{_ as H}from"./icon_on_2x.5e96733d.js";import{_ as Ue,a as $e}from"./img-no-Positions_2x.3d977650.js";import{_ as Re,a as Be}from"./img-connect-wallet_2x.d4bdcc99.js";import"./coin-select.059ed927.js";/* empty css              *//* empty css              *//* empty css              *//* empty css              */import"./icon-Amount-for-Sale_2x.b2e65df2.js";import"./status-block.64919dea.js";import"./decimal.0e8aa3f1.js";import"./icon-arrow_2x.948aedb2.js";import"./icon-arrow_2x.4ffddb8e.js";import"./useWhale.a5d0a24d.js";import"./index.4a3e929b.js";const Ce=ce({setup(){const o=p(!1),{t:u}=de(),J=p(["position"]),P=me(),W=p(""),R=Se(),g=m(()=>R),D=m(()=>g.value.chainName?Ae[g.value.chainName]:{});let i=p([]);const _=Pe(),a=m(()=>_),y=we(),h=m(()=>y),E=p(!1),O=p(u("tab.all")),G=p([u("tab.layerZero"),u("tab.wormhole"),u("tab.celer")]),B=p(!0),X=p("TVL"),q=()=>{o.value=!0,i.value=[],h.value.address&&_.getMyPositons(h.value.address,a.value.poolsObj,g.value.chainName),setTimeout(()=>{o.value=!1},1e3)},x=m(()=>{const s=Array.from(new Set(a.value.poolConfigList.flatMap(e=>!e.category||e.category==""?"All":e.category)));return console.log(s,"newArr"),s.length<=1?[]:s}),ee=s=>{a.value.setCurrentPoolTab(s)};$(()=>g.value.isRefresh,s=>{var e;s&&((e=P==null?void 0:P.currentRoute)==null?void 0:e.value.name.split("-")[1])=="position"&&q()}),ve(()=>{i.value=[],document.addEventListener("click",()=>{E.value=!1}),_.setMyPositionsLoading(!0)}),pe(()=>{document.addEventListener("click",()=>{E.value=!1})}),ge(()=>{h.value.connected||(i.value=[])});const F=()=>{o.value=!0;let s=[];a.value.myPositions.forEach(e=>{var b,T,C,N;let t,r;const c=e.amountA*((b=a.value.RATES[e.token_a.address])==null?void 0:b.price),d=e.amountB*((T=a.value.RATES[e.token_b.address])==null?void 0:T.price);(C=a.value.RATES[e.token_a.address])!=null&&C.price&&((N=a.value.RATES[e.token_b.address])!=null&&N.price)?(t=c+d,r=c+d):(t=" --",r=0),(a.value.currentPoolTab=="All"&&(e.category==""||!e.category)||a.value.currentPoolTab!=="All"&&e.category==a.value.currentPoolTab)&&s.push({...e,amountUSD:t,amountUSDOrigin:r,tokenARates:c,tokenBRates:d})}),O.value!="All"?B.value?(i.value=s.sort((e,t)=>Number(t.amountUSDOrigin)-Number(e.amountUSDOrigin)),o.value=!1):(i.value=s.sort((e,t)=>Number(e.amountUSDOrigin)-Number(t.amountUSDOrigin)),o.value=!1):B.value?(i.value=s.sort((e,t)=>t.amountUSDOrigin-e.amountUSDOrigin),o.value=!1):(i.value=s.sort((e,t)=>e.amountUSDOrigin-t.amountUSDOrigin),o.value=!1),console.log(i.value,"list.value========>")};$(()=>[a.value.myPositions,a.value.RATES],([s,e])=>{s&&e&&(console.log("0605==>updateLpList9099999"),F())},{immediate:!0}),$(()=>[h.value.address,a.value.poolConfigList,a.value.poolsObj,g.value.chainName],([s,e,t,r])=>{var c,d,b;s&&e&&e.length>0&&r&&(r!=null&&r.toLowerCase().includes((c=e[0])==null?void 0:c.chain))&&!Oe(t)&&(r==="Aptos"?e.length===Object.values(t).length:(b=(d=Object.values(t)[0])==null?void 0:d.chain)!=null&&b.includes("sui"))&&(console.log(t,e,"0605==>getMyPositons9099999"),_.getMyPositons(h.value.address,t,r))},{immediate:!0,deep:!0}),$(()=>[O.value,B.value,a.value.currentPoolTab],([s])=>{F()});const oe=s=>{const e=[];G.value.forEach((t,r)=>{t==s?e[r]=O.value:e[r]=t}),G.value=e,O.value=s},U=Te(),f=m(()=>U),M=m(()=>_),se=async s=>{await U.getSourceGroups();const e=f.value.sourceGroups&&f.value.sourceGroups.length>0&&f.value.sourceGroups[0]&&f.value.sourceGroups[0].sources||[];for(let t=0;t<e.length;t++){const{pool_address:r,position_index:c}=JSON.parse(e[t].blockchainAddress);let d=!1,b;for(let T=0;T<s.length;T++){const{poolAddress:C,index:N}=s[T];r==C&&Number(N)==Number(c)&&(d=!0),b={pool_address:r,position_index:c}}d||await U.subscribePosition(b,"",!1,!1)}},te=async()=>{await U.getSourceGroups();const s=f.value.sourceGroups&&f.value.sourceGroups.length>0&&f.value.sourceGroups[0]&&f.value.sourceGroups[0].sources||[];for(let e=0;e<s.length;e++){const{pool_address:t,position_index:r}=JSON.parse(s[e].blockchainAddress),{name:c}=s[e],d={pool_address:t,position_index:r};await U.subscribePosition(d,c,!1,!1)}},ae=m(()=>M.value.myPositionsLoading);$(()=>M.value.myPositions,(s,e)=>{D.value.hasNotifi&&(s&&s.length>0&&e&&e.length!==s.length?se(s):s&&s.length==0&&!ae.value&&te())},{immediate:!0});const le=s=>{var e;return(s==null?void 0:s.logoURI)||(s==null?void 0:s.logo_url)||((e=a.value.tokensObj[s==null?void 0:s.address])==null?void 0:e.logo_url)||(g.value.theme==="default"?Z("/image/coins/unknown.png"):Z("/image/coins/sui-unknown.png"))},k=p(null),L=m(()=>k.value&&k.value.firstToken?k.value.firstToken:null),S=m(()=>k.value&&k.value.lastToken?k.value.lastToken:null),ne=m(()=>{let s=[];s=i.value;const e=s.filter((t,r)=>L.value&&S.value?t.coinA.symbol==L.value.symbol&&t.coinB.symbol==S.value.symbol||t.coinA.symbol==S.value.symbol&&t.coinB.symbol==L.value.symbol:L.value?t.coinA.symbol.toLowerCase().includes(L.value.symbol.toLowerCase())||t.coinB.symbol.toLowerCase().includes(L.value.symbol.toLowerCase()):S.value?t.coinA.symbol.toLowerCase().includes(S.value.symbol.toLowerCase())||t.coinB.symbol.toLowerCase().includes(S.value.symbol.toLowerCase()):s);return a.value.myPositionsLoading||R.setPositiomAmount(e.length),e});return he(()=>{R.setPositiomAmount("--")}),{tabArr:x,changeTab:ee,showList:ne,childTokenSelectRef:k,firstToken:L,lastToken:S,getCoinIcon:le,changeSortLabel:oe,label:E,labelList:G,labelValue:O,select:B,selectValue:X,t:u,pools:a,store:g,wallet:h,list:i,clickRefresh:q,refresh:o,current:J,router:P,searchKey:W}}});const Q=o=>(ke("data-v-d82af439"),o=o(),Le(),o),Ne={class:"upgrade-position-list-container"},De={class:"content-top"},Ee={class:"content-top-left"},Ge={key:0,class:"tag-list"},je=["onClick"],Ve={class:"content-top-right"},Ie={class:"value"},Je=Q(()=>v("use",{"xlink:href":"#icon-icon_on"},null,-1)),We=[Je],qe={key:0,class:"select-item"},Fe=["onClick"],Me={class:"search-select-box"},ze=Q(()=>v("span",null,"TVL",-1)),Ke={key:0,src:H,alt:""},Ye={key:1,class:"fan-img",src:H,alt:""},Ze={key:0,class:"upgrade-loading"},He={key:1,class:"position-list"},Qe={key:2,class:"no-data"},Xe={key:0,src:Ue,alt:""},xe={key:1,src:$e,alt:""},eo={key:3,class:"no-data"},oo={key:0,src:Re,alt:""},so={key:1,src:Be,alt:""};function to(o,u,J,P,W,R){const g=re,D=ue,i=ie,_=_e;return l(),n("div",Ne,[v("div",De,[v("div",Ee,[o.tabArr.length>1?(l(),n("div",Ge,[(l(!0),n(j,null,V(o.tabArr,(a,y)=>(l(),n("div",{key:y,class:K(["tag-item",a==o.pools.currentPoolTab?`tag-active tab-num-${o.tabArr.length}`:`tab-num-${o.tabArr.length}`]),onClick:h=>o.changeTab(a)},w(a),11,je))),128))])):A("",!0),I(g,{ref:"childTokenSelectRef"},null,512)]),v("div",Ve,[o.store.theme=="default"?(l(),n("div",{key:0,class:"search-label",onClick:u[0]||(u[0]=z(a=>o.label=!o.label,["stop"]))},[v("span",null,w(o.$t("newAdd.label")),1),v("div",Ie,w(o.labelValue),1),(l(),n("svg",{"aria-hidden":"true",class:K(o.label?"show-icon icon":"icon")},We,2)),o.label?(l(),n("div",qe,[(l(!0),n(j,null,V(o.labelList,(a,y)=>(l(),n("div",{key:y,class:"select-menu-item",onClick:h=>o.changeSortLabel(a)},w(a),9,Fe))),128))])):A("",!0)])):A("",!0),v("div",Me,[v("div",{class:"search-select",onClick:u[1]||(u[1]=z(a=>o.select=!o.select,["stop"]))},[Y(w(o.$t("newAdd.sortBy"))+" ",1),v("div",null,[ze,o.select?(l(),n("img",Ke)):(l(),n("img",Ye))])])])])]),o.pools.myPositionsLoading&&o.wallet.connected?(l(),n("div",Ze,[I(D,{loading:o.pools.myPositionsLoading,type:"position"},null,8,["loading"])])):A("",!0),o.showList&&o.showList.length>0&&o.wallet.connected&&!o.pools.myPositionsLoading?(l(),n("div",He,[(l(!0),n(j,null,V(o.showList,(a,y)=>(l(),ye(i,{key:y,"p-item":a},null,8,["p-item"]))),128))])):A("",!0),o.showList&&o.showList.length<=0&&!o.pools.myPositionsLoading&&o.wallet.connected?(l(),n("div",Qe,[o.store.theme=="default"?(l(),n("img",Xe)):(l(),n("img",xe)),v("span",null,w(o.$t("common.noLiquidityPositions")),1)])):A("",!0),o.wallet.connected?A("",!0):(l(),n("div",eo,[o.store.theme=="default"?(l(),n("img",oo)):(l(),n("img",so)),I(_,{class:"connect-wallet",onClick:u[2]||(u[2]=a=>o.wallet.setIsShowWalletModal(!0))},{default:be(()=>[Y(w(o.$t("button.connectWallet")),1)]),_:1})]))])}const Oo=fe(Ce,[["render",to],["__scopeId","data-v-d82af439"]]);export{Oo as default};
