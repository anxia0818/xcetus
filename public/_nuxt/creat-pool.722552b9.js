import{u as We,a as oa,c as aa}from"./sha256.743615b9.js";import{a as Xe,m as A,e as Ke,o as S,f as F,r as I,E as Wo,l as ta,D as re,K as Xo,i as oe,h as a,c as Ue,x as D,j as be,w as la,v as Ko,I as Go,B as na,p as Jo,k as Qo,b as sa,C as ia,q as ua,H as ra,z as ke,t as ca}from"./entry.529755dd.js";import{_ as va,c as da}from"./new-add-or-create.30bf4f08.js";import{_ as ma}from"./lock.a30493d3.js";import{_ as pa,a as Yo,b as fa,c as ga}from"./new-liquidity-title.07782b03.js";/* empty css              */import{a as Zo,u as xo,p as Vo,s as Eo,c as zo,f as Oe,b as ka,d as ba}from"./pool.73654337.js";import{i as Ho}from"./import-icon.de3e6c66.js";import{_ as Ca,a as wa,b as ha}from"./icon-Add-Liquidity_2x.09e3193d.js";import{D as s}from"./decimal.0e8aa3f1.js";import{fromCoin as d,toCoin as m,fromCoinAmount as i,toCoinAmount as u,maxPrice as v,minPrice as p,createPoolInfo as r,fixedFromCoin as T,currentPriceReverse as He,currentPrice as ne,initPrice as Ce,direction as h,createPoolFromCoin as x,createPoolToCoin as ee,isFullRange as Ie,resetData as _a,defaultMinPrice as Ee,defaultMaxPrice as ze}from"./create-pool-data.0ca68b67.js";import{a as ya,s as Pa}from"./poolFee.fc11ddd4.js";import{_ as Sa}from"./icon-selected_3x.09e9a6f0.js";import"./token-warning.e27aec4d.js";import"./status-block.93b6bfa4.js";/* empty css              *//* empty css              */import"./notifi.23ae4b8b.js";import"./useWhale.6db30493.js";import"./index.9322a2fe.js";/* empty css              */import"./tick.505fdad3.js";/* empty css              */import"./refresh-icon.586493e0.js";/* empty css              */import"./swap-setting.2d0b9201.js";const Na=Xe({setup(){const e=We();return{storeIndex:A(()=>e)}}});const Ta={class:"create-pool-lock"},Aa={key:0,src:va,alt:""},Ia={key:1,src:ma,alt:""};function qa(e,t,Q,ce,Y,q){return S(),F("div",Ta,[e.storeIndex.theme=="default"?(S(),F("img",Aa)):(S(),F("img",Ia))])}const Ra=Ke(Na,[["render",qa],["__scopeId","data-v-fb497971"]]),La=Xe({components:{NewLiquidityTile:pa,NewLiquidityDepositRatio:Yo},setup(e,t){const Q=oa(),ce=We(),Y=A(()=>ce),q=A(()=>Y.value.chainName),H=A(()=>Q),R=I(!1),C=I(!1),E=I(!1);I(),I(),I(),I(!1);const w=Wo(),{t:U,locale:ve}=ta(),l=A(()=>q.value?Zo(q.value):{}),de=xo(),K=A(()=>de),De=A(()=>Y.value.theme),z=A(()=>H.value.assets&&d.value&&H.value.assets[d.value.address]?Vo(H.value.assets[d.value.address].balance,d.value.decimals):"0"),O=A(()=>H.value.assets&&m.value&&H.value.assets[m.value.address]?Vo(H.value.assets[m.value.address].balance,m.value.decimals):"0"),se=o=>{o==="fromCoin"?(T.value=!0,q.value==="Aptos"?i.value=Number(z.value)>0?d.value.symbol=="APT"?new s(Number(z.value)).sub(new s(.1)).lt(new s(0))?"0":new s(Number(z.value)).sub(new s(.1)).toString():String(z.value):"":i.value=Number(z.value)>0?d.value.symbol=="SUI"?new s(Number(z.value)).sub(new s(.05)).lt(new s(0))?"0":new s(Number(z.value)).sub(new s(.05)).toString():String(z.value):""):(T.value=!1,q.value==="Aptos"?u.value=Number(O.value)>0?m.value.symbol=="APT"?new s(Number(O.value)).sub(new s(.1)).lt(new s(0))?"0":new s(Number(O.value)).sub(new s(.1)).toString():String(O.value):"":u.value=Number(O.value)>0?m.value.symbol=="SUI"?new s(Number(O.value)).sub(new s(.05)).lt(new s(0))?"0":new s(Number(O.value)).sub(new s(.05)).toString():String(O.value):"")},he=o=>{o==="fromCoin"?(T.value=!0,i.value=Number(z.value)>0?Eo(new s(Number(z.value)).div(2).toString(),d.value.decimals).toString():""):(T.value=!1,u.value=Number(O.value)>0?Eo(new s(Number(O.value)).div(2).toString(),m.value.decimals).toString():"")};re(()=>[K.value.tokens,w.query],async([o])=>{if(o&&o.length>0){const k=o;if(w&&w.query&&w.query.fromCoin&&(console.log("0410###deposite###watch###route.query.tokena####",w.query.fromCoin),w.query.fromCoin)){const g=await l.value.getTokenBySymbol(k,w.query.fromCoin);d.value=g,x.value=g}if(w&&w.query&&w.query.toCoin&&w.query.toCoin){const g=await l.value.getTokenBySymbol(k,w.query.toCoin);m.value=g,ee.value=g}}},{immediate:!0});const _e=I("--"),ye=A(()=>Y.value.slippage),je=I(),me=async()=>{var ge,ie;if(!p.value&&!v.value)return!1;if(!i.value&&!u.value&&!p.value&&!v.value)return;const o=r.value;if(zo(o))return;const{TickUtil:k,TickMath:g,getNearestTickByTick:$}=l.value,f=o==null?void 0:o.token_a.decimals,c=o==null?void 0:o.token_b.decimals;let _,B,b,y,j,M,N=o.current_tick_index,V;if(o.token_a.address.toLowerCase()===d.value.address.toLowerCase()&&o.token_b.address.toLowerCase()===m.value.address.toLowerCase()?V=!0:V=!1,p.value==="0"&&v.value==="∞")b=k.getMinIndex(Number(o.tickSpacing)),y=k.getMaxIndex(Number(o.tickSpacing));else{console.log(V,"===>directs1866"),V?(_=Number(p.value),B=Number(v.value)):(_=new s(1).div(v.value).toString(),B=new s(1).div(p.value).toString()),console.log("0518###pre###directs###",V),console.log("0518###pre###minPrice###",p.value),console.log("0518###pre###maxPrice###",v.value),console.log("0518###pre###poolInfos###",o),console.log("0518###pre###decimalsA###",f),console.log("0518###pre###decimalsB###",c),console.log("0518###pre###currentTickIndex###",N),console.log(_,B,"min max1875"),console.log(p.value,v.value,"===>maxPrice.value");try{j=_==0?-443636:g.priceToTickIndex(new s(_),f,c)}catch{j=-443636}try{M=g.priceToTickIndex(new s(B),f,c)}catch{M=443636}b=$(j,Number(o.tickSpacing)),y=$(M,Number(o.tickSpacing))}if(v.value!=="∞"&&b>=y){R.value=!0,i.value="",C.value=!0,u.value="";return}if(console.log(y,N,b,"1922"),v.value==="∞"||N>=b&&N<=y){R.value=!1,C.value=!1;let Z;if(i.value||u.value){if(T.value){const we=new s(i.value).mul(Math.pow(10,d.value.decimals)).toString();Z=new Oe(we)}else{const we=new s(u.value).mul(Math.pow(10,m.value.decimals)).toString();Z=new Oe(we)}console.log(V,"======>directs");const{liquidityAmount:X,tokenMaxA:J,tokenMaxB:le,tokenMaxAOrigin:Me,tokenMaxBOrigin:Fe}=l.value.estLiquidityAndcoinAmountFromOneAmounts({tokenA:o.token_a,tokenB:o.token_b,lowerTick:b,upperTick:y,coinAmount:Z,iscoinA:V?T.value:!T.value,roundUp:!0,slippage:Number(ye.value)/100,curSqrtPrice:new Oe(o.current_sqrt_price)});je.value={liquidityAmount:X,tokenMaxA:J,tokenMaxB:le,tokenMaxAOrigin:Me,tokenMaxBOrigin:Fe},V?T.value?u.value=Number(le)>0?le:"":i.value=Number(J)>0?J:"":T.value?u.value=J:i.value=le}}else N>y?(ge=w==null?void 0:w.query)!=null&&ge.action&&(R.value=!0,C.value=!0):N<b?(ie=w==null?void 0:w.query)!=null&&ie.action&&(R.value=!0,C.value=!0):(R.value=!0,i.value="",C.value=!0,u.value="")};re(()=>Ce.value,o=>{o&&me()},{immediate:!0}),re(i,(o,k)=>{console.log(i,"===>fromCoinAmount"),o==""&&T.value&&(u.value=""),o&&T.value&&!E.value&&me()}),re(u,(o,k)=>{console.log(o,"===>>>>newValsda"),o==""&&!T.value&&(i.value=""),o&&!T.value&&!E.value&&me()}),re(()=>Ie.value,o=>{me()});const n=o=>{console.log(o,"e"),E.value=!0,_e.value=o,o>0?pe():(i.value="",u.value="")};re([p,v],([o,k])=>{console.log(o,k,"==>minPrice,maxPrice"),Number(o)!==0&&Number(k)!==0&&!E.value?me():Number(o)!==0&&Number(k)!==0&&E.value&&pe()},{immediate:!0});const L=A(()=>K.value.RATES),P=I(),pe=async()=>{var ie,Z;if(!p.value&&!v.value)return!1;if(!i.value&&!u.value&&!p.value&&!v.value)return;const o=r.value;if(zo(o))return;const{TickUtil:k,TickMath:g,getNearestTickByTick:$}=l.value,f=o==null?void 0:o.token_a.decimals,c=o==null?void 0:o.token_b.decimals;let _,B,b,y,j,M,N;if(o.token_a.address.toLowerCase()===d.value.address.toLowerCase()&&o.token_b.address.toLowerCase()===m.value.address.toLowerCase()?N=!0:N=!1,p.value==="0"&&v.value==="∞")b=k.getMinIndex(Number(o.tickSpacing)),y=k.getMaxIndex(Number(o.tickSpacing));else{N?(_=Number(p.value),B=Number(v.value)):(_=new s(1).div(v.value).toString(),B=new s(1).div(p.value).toString());try{j=_==0?-443636:g.priceToTickIndex(new s(_),f,c)}catch{j=-443636}try{M=g.priceToTickIndex(new s(B),f,c)}catch{M=443636}b=$(j,Number(o.tickSpacing)),y=$(M,Number(o.tickSpacing))}console.log(o.token_a,"poolInfos===>");const V=L.value[(ie=o.value)==null?void 0:ie.token_a.address].price,ge=L.value[(Z=o.value)==null?void 0:Z.token_b.address].price;console.log(b,y,"####tick_lower tick_upper 889");try{const{amountA:X,amountB:J,tokenAmountsInfo:le}=await l.value.estCoinAmountsFromTotalAmount({lowerTick:b,upperTick:y,decimalsA:f,decimalsB:c,curSqrtPrice:new Oe(o.current_sqrt_price),totalAmount:_e.value,tokenPriceA:V,tokenPriceB:ge});console.log(X,J,"###estCoinAmountsFromTotalAmount 844"),P.value=le,o.needReverse?h.value?(i.value=X,u.value=J):(i.value=J,u.value=X):(i.value=X,u.value=J)}catch(X){console.log(X,"e===>")}},W=A(()=>{var g,$,f,c,_,B,b,y;const o=(f=L.value[($=(g=d)==null?void 0:g.value)==null?void 0:$.address])==null?void 0:f.price,k=(B=L.value[(_=(c=m)==null?void 0:c.value)==null?void 0:_.address])==null?void 0:B.price;return console.log(L.value,(y=(b=d)==null?void 0:b.value)==null?void 0:y.address,"===>fromCoin?.value?.address"),!!(o&&k)}),G=()=>{t.emit("toggle")},te=I(!1);A(()=>{if(K.value.poolConfigList&&d.value&&m.value){const o=K.value.poolConfigList.filter(g=>{var $,f,c,_;return g.token_a.address.toUpperCase()===(($=d.value.address)==null?void 0:$.toUpperCase())&&g.token_b.address.toUpperCase()===((f=m.value.address)==null?void 0:f.toUpperCase())||g.token_b.address.toUpperCase()===((c=d.value.address)==null?void 0:c.toUpperCase())&&g.token_a.address.toUpperCase()===((_=m.value.address)==null?void 0:_.toUpperCase())});console.log(o,"===>info");const k=[];return o.forEach(g=>{k.push(Number(g.fee))}),console.log(k,"===>>result"),k}else return[]}),A(()=>{var o;return(o=Y.value)==null?void 0:o.filterCreatePoolCoin});const Pe=A(()=>{var o;return!d.value||!m.value?U("modal.selectTokenModalTitle"):!((o=w.query)!=null&&o.fee)&&aa[q.value].hasCreatePool?"Select fee tier":!Number(i.value)&&!Number(u.value)?U("button.enterAmount"):Number(i.value)>Number(z.value)?U("button.insufficientBalance",{name:d.value.symbol}):Number(u.value)>Number(O.value)?U("button.insufficientBalance",{name:m.value.symbol}):v.value!=="∞"&&Number(p.value)>=Number(v.value)?U("newAdd.invalidRange"):U("newAdd.preview")}),qe=A(()=>{var o;return!i.value&&!u.value?(console.log("addLiquidityBtnDisabled11111"),!0):Number(i.value)>Number(z.value)||Number(u.value)>Number(O.value)?(console.log("addLiquidityBtnDisabled22222"),!0):Pe.value!==U("newAdd.preview")?!0:!r.value&&!((o=r.value)!=null&&o.currentPrice)?(console.log("addLiquidityBtnDisabled55555"),!0):!!(Number(i.value)<=0&&Number(u.value)<=0||R.value||C.value)}),{setTransactionTxid:Se,setTransactionDesc:Re,setIsShowWaiting:fe,setIsShowSuccess:Ne,setIsShowRejected:Te,setPositiomNum:Le}=ce,$e=()=>{q.value=="Sui"&&Be()},Be=async()=>{var V,ge,ie,Z,X,J,le,Me,Fe,we,Ge,Je,Qe,Ye,Ze,xe,eo,oo,ao,to,lo,no,so,io,uo,ro,co,vo,mo,po,fo,go,ko,bo,Co,wo,ho,_o,yo,Po,So,No,To,Ao,Io,qo,Ro,Lo,$o,Bo,Mo,Fo,Uo,Oo,Do,jo;te.value=!1,console.log("创建sui池子");let o=!1;l.value.getIsSortedSymbols(x.value.address,ee.value.address)&&(o=!0),Se("");const k=R.value?"":`${i.value} ${(V=d.value)==null?void 0:V.symbol}`,g=C.value?"":`${u.value} ${(ge=m.value)==null?void 0:ge.symbol}`;console.log("0424###createPoolFromCoin###",x.value),console.log("0424###createPoolToCoin###",ee.value),console.log("0424###needReverse###",o),console.log("0424###createPoolInfo?.value?.needReverse###",(Z=(ie=r)==null?void 0:ie.value)==null?void 0:Z.needReverse),Re(U("tips.increaseLiquiditySuccess",{from:!o&&!((J=(X=r)==null?void 0:X.value)!=null&&J.needReverse)||o&&((Me=(le=r)==null?void 0:le.value)!=null&&Me.needReverse)?k:g,and:!R.value&&!C.value?"and":"",to:!o&&!((we=(Fe=r)==null?void 0:Fe.value)!=null&&we.needReverse)||o&&((Je=(Ge=r)==null?void 0:Ge.value)!=null&&Je.needReverse)?g:k})),fe(!0);let $="",f="",c="",_="",B="",b="",y=0,j=0,M=!1,N;if(o||(Ye=(Qe=r)==null?void 0:Qe.value)!=null&&Ye.needReverse){const ue=o&&!((xe=(Ze=r)==null?void 0:Ze.value)!=null&&xe.needReverse);$=ue?(no=(lo=(to=r)==null?void 0:to.value)==null?void 0:lo.token_b)==null?void 0:no.address:(ao=(oo=(eo=r)==null?void 0:eo.value)==null?void 0:oo.token_a)==null?void 0:ao.address,f=ue?(vo=(co=(ro=r)==null?void 0:ro.value)==null?void 0:co.token_a)==null?void 0:vo.address:(uo=(io=(so=r)==null?void 0:so.value)==null?void 0:io.token_b)==null?void 0:uo.address,c=ue?(bo=(ko=(go=r)==null?void 0:go.value)==null?void 0:ko.token_b)==null?void 0:bo.decimals:(fo=(po=(mo=r)==null?void 0:mo.value)==null?void 0:po.token_a)==null?void 0:fo.decimals,_=ue?(Po=(yo=(_o=r)==null?void 0:_o.value)==null?void 0:yo.token_a)==null?void 0:Po.decimals:(ho=(wo=(Co=r)==null?void 0:Co.value)==null?void 0:wo.token_b)==null?void 0:ho.decimals,(No=(So=r)==null?void 0:So.value)!=null&&No.needReverse?(B=h.value?i.value:u.value,b=h.value?u.value:i.value,y=h.value?Number(p.value):1/Number(v.value),j=h.value?Number(v.value):1/Number(p.value),M=h.value?T.value:!T.value,N=h.value?ne.value:1/Number(ne.value)):(B=h.value?u.value:i.value,b=h.value?i.value:u.value,y=h.value?1/Number(v.value):Number(p.value),j=h.value?1/Number(p.value):Number(v.value),M=h.value?!T.value:T.value,N=h.value?1/Number(ne.value):ne.value)}else $=(Io=(Ao=(To=r)==null?void 0:To.value)==null?void 0:Ao.token_a)==null?void 0:Io.address,f=(Lo=(Ro=(qo=r)==null?void 0:qo.value)==null?void 0:Ro.token_b)==null?void 0:Lo.address,c=(Mo=(Bo=($o=r)==null?void 0:$o.value)==null?void 0:Bo.token_a)==null?void 0:Mo.decimals,_=(Oo=(Uo=(Fo=r)==null?void 0:Fo.value)==null?void 0:Uo.token_b)==null?void 0:Oo.decimals,B=h.value?i.value:u.value,b=h.value?u.value:i.value,y=h.value?Number(p.value):1/Number(v.value),j=h.value?Number(v.value):1/Number(p.value),M=h.value?T.value:!T.value,N=h.value?ne.value:1/Number(ne.value);try{console.log("0501###toCreatePool###params###",{coinTypeA:$,coinTypeB:f,decimalsA:c,decimalsB:_,amountA:B,amountB:b,minPrice:y,maxPrice:j,fix_amount_a:M,tick_spacing:Number(r.value.tickSpacing),slippage:Number(ye.value)/100,price:N});const ue=await l.value.getCreatPoolTransactionPayload({coinTypeA:$,coinTypeB:f,decimalsA:c,decimalsB:_,amountA:B,amountB:b,minPrice:p.value=="0"&&v.value=="∞"?"0":y,maxPrice:p.value=="0"&&v.value=="∞"?"∞":j,fix_amount_a:M,tick_spacing:Number(r.value.tickSpacing),slippage:Number(ye.value)/100,price:N}),ea=await H.value.currentWallet.signAndExecuteTransactionBlock(ue),Ae=l.value.handleTx(ea);if(Ae&&Ae.hash){Se(Ae.hash),fe(!1),Ne(!0);const Ve={title:"Created pool",desc:"Pool created successfully ",hash:Ae.hash,tit:"Pool Created",icon:"icon-icon-Position-Created",tokenInfo:{tokena:`${(Do=d.value)==null?void 0:Do.address}`,numa:R.value?"":`- ${i.value}`,logoa:K.value.tokensObj&&d.value&&d.value.address&&K.value.tokensObj[d.value.address]&&K.value.tokensObj[d.value.address].logoURI,tokenb:`${(jo=m.value)==null?void 0:jo.address}`,numb:C.value?"":`- ${u.value}`,logob:K.value.tokensObj&&m.value&&m.value.address&&K.value.tokensObj[m.value.address]&&K.value.tokensObj[m.value.address].logoURI},text:"Pool created successfully"};q.value!=="Aptos"&&(Ve.res=Ae.res),l.value.showTransitionPending(Ve),(await l.value.watchTransaction(Ve,!0)).status&&(Ne(!1),setTimeout(()=>{de.setPoolConfigList(q.value,Y.value.filterCoinsObj),l.value.getAccount(H.value.address)},1e3)),Le()}else fe(!1),Te(!0);i.value="",u.value=""}catch(ue){console.log("0407###createPool###error##",ue),te.value=!1,de.setPoolConfigList(q.value,Y.value.filterCoinsObj),i.value="",u.value="",fe(!1),Te(!0)}};return{fromCoinAmount:i,toCoinAmount:u,fromCoin:d,toCoin:m,maxBtnSelect:se,halfBtnSelect:he,showFromCoinLock:R,showToCoinLock:C,fromCoinBlance:z,toCoinBlance:O,fixedFromCoin:T,isInputTotalAmount:E,toggle:G,theme:De,liquidityTotalAmount:_e,createPoolInfo:r,minPrice:p,maxPrice:v,currentPriceReverse:He,currentPrice:ne,onInput:n,initPrice:Ce,isShowtotalAmount:W,direction:h,isShowLiquidityModal:te,createPoolBtnText:Pe,createPoolBtnDisabled:qe,toCreatePool:$e}}});const $a=e=>(Jo("data-v-fc86cfa0"),e=e(),Qo(),e),Ba={class:"create-pool-right"},Ma={class:"card-container"},Fa={class:"card-item"},Ua={class:"card-item"},Oa={key:0,class:"total-amount"},Da=$a(()=>a("span",null,"Total Amount",-1));function ja(e,t,Q,ce,Y,q){const H=Xo("NewLiquidityTile"),R=fa,C=ha,E=Go,w=Yo,U=da,ve=na;return S(),F("div",Ba,[oe(H),a("div",Ma,[a("div",Fa,[oe(R,{modelValue:e.fromCoinAmount,"onUpdate:modelValue":t[0]||(t[0]=l=>e.fromCoinAmount=l),"input-value":e.fromCoinAmount,"coin-symbol":e.fromCoin?e.fromCoin.symbol:null,"coin-name":e.fromCoin?e.fromCoin.name:null,balance:e.fromCoinBlance,"coin-icon":e.fromCoin?e.fromCoin.logoURI:"",address:e.fromCoin?e.fromCoin.address:"","swap-direct":"From","import-page":"deposit","has-arrow":!1,onOnMax:t[1]||(t[1]=l=>e.maxBtnSelect("fromCoin")),onOnHalf:t[2]||(t[2]=l=>e.halfBtnSelect("fromCoin")),onOnInput:t[3]||(t[3]=l=>{e.fromCoinAmount=l,e.fixedFromCoin=!0,e.isInputTotalAmount=!1})},null,8,["modelValue","input-value","coin-symbol","coin-name","balance","coin-icon","address"]),e.showFromCoinLock?(S(),Ue(C,{key:0,"from-coin":e.fromCoin,"to-coin":e.toCoin},null,8,["from-coin","to-coin"])):D("",!0)]),a("div",Ua,[oe(R,{modelValue:e.toCoinAmount,"onUpdate:modelValue":t[4]||(t[4]=l=>e.toCoinAmount=l),"input-value":e.toCoinAmount,"coin-symbol":e.toCoin?e.toCoin.symbol:null,"coin-name":e.toCoin?e.toCoin.name:null,balance:e.toCoinBlance,"swap-direct":"To","coin-icon":e.toCoin?e.toCoin.logoURI:"",address:e.toCoin?e.toCoin.address:"","import-page":"deposit","has-arrow":!1,onOnMax:t[5]||(t[5]=l=>e.maxBtnSelect("toCoin")),onOnHalf:t[6]||(t[6]=l=>e.halfBtnSelect("toCoin")),onOnInput:t[7]||(t[7]=l=>{e.toCoinAmount=l,e.fixedFromCoin=!1,e.isInputTotalAmount=!1})},null,8,["modelValue","input-value","coin-symbol","coin-name","balance","coin-icon","address"]),e.showToCoinLock?(S(),Ue(C,{key:0,"from-coin":e.fromCoin,"to-coin":e.toCoin},null,8,["from-coin","to-coin"])):D("",!0)]),e.fromCoin&&e.toCoin&&!e.showToCoinLock&&!e.showFromCoinLock&&e.theme=="default"?(S(),F("img",{key:0,class:"add",src:Ca,alt:"",onClick:t[8]||(t[8]=(...l)=>e.toggle&&e.toggle(...l))})):D("",!0),e.fromCoin&&e.toCoin&&!e.showToCoinLock&&!e.showFromCoinLock&&e.theme!=="default"?(S(),F("img",{key:1,class:"add",src:wa,alt:"",onClick:t[9]||(t[9]=(...l)=>e.toggle&&e.toggle(...l))})):D("",!0)]),e.isShowtotalAmount?(S(),F("div",Oa,[Da,a("span",null,[be("$ "),oe(E,{value:e.liquidityTotalAmount,placeholder:e.isInputTotalAmount?"":e.liquidityTotalAmount,onInput:t[10]||(t[10]=l=>e.onInput(l.target.value))},null,8,["value","placeholder"])])])):D("",!0),e.initPrice?(S(),Ue(w,{key:1,"from-coin":e.fromCoin,"to-coin":e.toCoin,"from-coin-amount":e.fromCoinAmount,"to-coin-amount":e.toCoinAmount,"fixed-from-coin":e.fixedFromCoin,"is-input-total-amount":e.isInputTotalAmount,"create-pool-info":e.createPoolInfo,"min-price":e.minPrice,"max-price":e.maxPrice,"current-price-tab":"custom","current-price":e.currentPrice,"current-price-reverse":e.currentPriceReverse},null,8,["from-coin","to-coin","from-coin-amount","to-coin-amount","fixed-from-coin","is-input-total-amount","create-pool-info","min-price","max-price","current-price","current-price-reverse"])):D("",!0),e.isShowLiquidityModal?(S(),Ue(U,{key:2,"pool-info":e.createPoolInfo,title:e.$t("newAdd.preview"),"from-coin-amount":e.fromCoinAmount,"to-coin-amount":e.toCoinAmount,"from-coin":e.fromCoin,"to-coin":e.toCoin,"fixed-from-coin":e.fixedFromCoin,"current-price":e.currentPrice,"current-price-reverse":e.currentPriceReverse,"current-price-tab":"custom","min-price":e.minPrice,"max-price":e.maxPrice,"show-from-coin-lock":e.showFromCoinLock,"show-to-coin-lock":e.showToCoinLock,"current-direct":e.direction,"is-increase":!1,onCreatePool:e.toCreatePool,onOnClose:t[11]||(t[11]=l=>e.isShowLiquidityModal=!1)},null,8,["pool-info","title","from-coin-amount","to-coin-amount","from-coin","to-coin","fixed-from-coin","current-price","current-price-reverse","min-price","max-price","show-from-coin-lock","show-to-coin-lock","current-direct","onCreatePool"])):D("",!0),oe(ve,{class:"add-liquidity-btn",disabled:e.createPoolBtnDisabled,onClick:t[12]||(t[12]=l=>e.isShowLiquidityModal=!0)},{default:la(()=>[be(Ko(e.createPoolBtnText),1)]),_:1},8,["disabled"])])}const Va=Ke(La,[["render",ja],["__scopeId","data-v-fc86cfa0"]]),Ea=Xe({components:{CreatePoolRight:Va},setup(){const e=I(!0),t=I(!0),Q=I(!0),ce=I(!0),Y=I(!1),q=I("1"),H=I(!0),R=I(""),C=Wo(),E=sa(),w=We(),U=A(()=>w),ve=xo(),l=A(()=>ve),de=I("");re(()=>[E,l.value.tokensObj],([n,L])=>{var P;((P=E==null?void 0:E.currentRoute)==null?void 0:P.value.name)=="liquidity-creat-pool"&&L&&(d.value=l.value.tokensObj[C.query.fromCoin],m.value=l.value.tokensObj[C.query.toCoin],console.log("z"),de.value=C.query.fee!=="null"&&C.query.fee?C.query.fee:"")},{immediate:!0,deep:!0}),re(()=>[d.value,m.value,Ce.value,de.value,p.value,v.value,i.value,u.value],([n,L,P,pe,W,G,te])=>{!n||!L?(q.value="1",e.value=!0,t.value=!0,Q.value=!0):pe?P?!W||!G?(q.value="4",e.value=!1,t.value=!1,Q.value=!0):te||(q.value="5",e.value=!1,t.value=!1,Q.value=!1):(q.value="3",e.value=!1,t.value=!0,Q.value=!0):(q.value="2",e.value=!0,t.value=!0,Q.value=!0)},{immediate:!0});const K=n=>{Ce.value=n},De=n=>{var L;return(n==null?void 0:n.logoURI)||(n==null?void 0:n.logo_url)||((L=l.value.tokensObj[n==null?void 0:n.address])==null?void 0:L.logo_url)||(U.value.theme==="default"?Ho("/image/coins/unknown.png"):Ho("/image/coins/sui-unknown.png"))},z=n=>{switch(n){case"1":return{top:"10%"};case"2":return{top:"29%"};case"3":return{top:"48%"};case"4":return{top:"67%"};case"5":return{top:"87%"}}},O=A(()=>U.value.chainName),se=A(()=>O.value?Zo(O.value):{}),he=n=>{var Pe,qe,Se,Re,fe,Ne,Te,Le,$e,Be,o,k,g,$;n?(Ce.value=n,ne.value=n,He.value=new s(1).div(new s(n)).toString()):(Ce.value="",ne.value="",He.value="");let L,P;const pe=l.value.poolConfigList;for(let f=0;f<pe.length;f++){const c=pe[f];if(c.token_a.address.toUpperCase()===((Se=(qe=(Pe=x)==null?void 0:Pe.value)==null?void 0:qe.address)==null?void 0:Se.toUpperCase())&&c.token_b.address.toUpperCase()===((Ne=(fe=(Re=ee)==null?void 0:Re.value)==null?void 0:fe.address)==null?void 0:Ne.toUpperCase())){L=c.needReverse,P=c;break}else if(c.token_b.address.toUpperCase()===(($e=(Le=(Te=x)==null?void 0:Te.value)==null?void 0:Le.address)==null?void 0:$e.toUpperCase())&&c.token_a.address.toUpperCase()===((k=(o=(Be=ee)==null?void 0:Be.value)==null?void 0:o.address)==null?void 0:k.toUpperCase())){L=c.needReverse,P=c;break}}let W=!1;se.value.getIsSortedSymbols((g=x.value)==null?void 0:g.address,($=ee.value)==null?void 0:$.address)&&(W=!0);let G;W&&!h.value?G=!0:W&&h.value||!W&&h.value?G=!1:G=!0;const te=O.value=="Aptos"?ya:Pa;if(d.value&&m.value&&n){const f=P?P==null?void 0:P.token_a.decimals:W?ee.value.decimals:x.value.decimals,c=P?P==null?void 0:P.token_b.decimals:W?x.value.decimals:ee.value.decimals,_=n&&se.value.TickMath.priceToSqrtPriceX64(G?new s(1/n):new s(n),f,c);console.log(_,"===>current_sqrt_price");const B=n&&se.value.TickMath.priceToSqrtPriceX64(new s(1).div(n),d.value.decimals,m.value.decimals);console.log(!G,"===>!newDirect"),console.log(f,c,"decimalsA,decimalsB===>");const b=se.value.TickMath.priceToTickIndex(G?new s(1).div(n):new s(n),f,c);console.log(b,"==>currentTickIndex");const y=b-te[C.query.fee]*5,j=b+te[C.query.fee]*5,M=se.value.TickMath.tickIndexToPrice(y,f,c).toString(),N=se.value.TickMath.tickIndexToPrice(j,f,c).toString();Ie.value?(p.value="0",v.value="∞"):G?(p.value=String(1/N),v.value=String(1/M),Ee.value=String(1/N),ze.value=String(1/M)):(p.value=M,v.value=N,Ee.value=M,ze.value=N),console.log("0518###c####createPoolFromCoin.value####",x.value),console.log("0518###c####createPoolToCoin.value####",ee.value),console.log("0518###c####createPoolNeedReverse####",W);const V={token_a:P?P.token_a:W?ee.value:x.value,token_b:P?P.token_b:W?x.value:ee.value,isCreate:!0,tickSpacing:te[C.query.fee],currentPrice:n,current_sqrt_price:_,tick_lower:y,tick_upper:j,current_tick_index:b,currentPriceReverse:ka(String(1/n),6),reverse_current_sqrt_price:B,needReverse:L,fee:C.query.fee};r.value=V,console.log("0518###c####poolInfos####",V)}else r.value=null,p.value="",v.value=""},_e=()=>{Ie.value=!Ie.value,he(r.value.currentPrice)},ye=n=>{console.log(n,"####0731 priceRangeChangeMin"),p.value=n},je=n=>{v.value=n},me=()=>{var n,L;if(console.log(r.value,"==>createPoolInfo.value"),h.value=!h.value,r.value){he(ba(new s(1).div(r.value.currentPrice).toString(),(L=(n=m)==null?void 0:n.value)==null?void 0:L.decimals));const P=d.value;d.value=m.value,m.value=P,T.value?i.value=u.value:u.value=i.value}};return ia(()=>{_a()}),{amountLock:Q,currentStep:q,sliderStyle:z,coinAmount:Y,pricerange:R,fromCoin:d,toCoin:m,fee:de,direct:H,getCoinIcon:De,isSelectFullRange:ce,onInput:K,store:U,initPrice:Ce,inputPriceLock:e,specifyPriceLock:t,changeCurrentPrice:he,minPrice:p,maxPrice:v,defaultMinPrice:Ee,defaultMaxPrice:ze,clickFullRange:_e,createPoolInfo:r,isFullRange:Ie,priceRangeChangeMin:ye,priceRangeChangeMax:je,fromCoinAmount:i,toggle:me}}});const ae=e=>(Jo("data-v-ffaa8b79"),e=e(),Qo(),e),za={class:"creat-pool-container"},Ha={class:"creat-pool-left"},Wa={class:"progress"},Xa=ae(()=>a("div",{class:"slider-ratio-content"},null,-1)),Ka=[Xa],Ga={class:"progress-text"},Ja={key:0},Qa={key:0},Ya={key:0},Za={key:0},xa={key:0},et={class:"creat-pool-center"},ot={class:"title"},at=ae(()=>a("div",{class:"left"},"Set Initial Price",-1)),tt={class:"right"},lt={key:0,class:"token-box"},nt=ae(()=>a("div",null,[a("svg",{class:"icon icon-up","aria-hidden":"true"},[a("use",{"xlink:href":"#icon-exchange_up1"})])],-1)),st=ae(()=>a("div",null,[a("svg",{class:"icon icon-down","aria-hidden":"true"},[a("use",{"xlink:href":"#icon-exchange_down1"})])],-1)),it=[nt,st],ut={class:"content top-content"},rt=ae(()=>a("div",{class:"top"},[a("span",null,"💡"),a("span",null,"Please set an initial price for this new pool to start.")],-1)),ct={class:"bottom"},vt={class:"input-div"},dt={key:0,class:"lock"},mt={class:"title"},pt=ae(()=>a("div",{class:"left"},"Set Initial Price",-1)),ft={class:"right"},gt={key:0,src:Sa},kt=ae(()=>a("span",null,"Full Range",-1)),bt={class:"content bottom-content"},Ct=ae(()=>a("span",null,"💡",-1)),wt=ae(()=>a("span",null,"Please specify a price range that you want to provide your liquidity within.",-1)),ht=[Ct,wt],_t={class:"bottom"},yt={class:"set-price-box"},Pt={key:0,class:"lock"},St=ae(()=>a("div",{class:"create-pool-warning"}," To create a new pool, the initial price you set must be within your price range. ",-1)),Nt={class:"creat-pool-right"},Tt={key:0,class:"lock"};function At(e,t,Q,ce,Y,q){var U,ve;const H=Go,R=Ra,C=ga,E=Xo("CreatePoolRight"),w=ua("image");return S(),F("div",za,[a("div",Ha,[a("div",Wa,[a("div",{class:"slider-ratio",style:ra(e.sliderStyle(e.currentStep))},Ka,4)]),a("div",Ga,[a("div",{class:ke(["row",!e.fromCoin||!e.toCoin?"color-text":""])},[e.fromCoin&&e.toCoin?(S(),F("span",Ja,"✓")):D("",!0),be(" Select Pool ")],2),a("div",{class:ke(["row",e.fee?"":"color-text"])},[e.fee?(S(),F("span",Qa,"✓")):D("",!0),be(" Select Fee Tier ")],2),a("div",{class:ke(["row",e.initPrice?"":"color-text"])},[e.initPrice?(S(),F("span",Ya,"✓")):D("",!0),be(" Set Initial Price ")],2),a("div",{class:ke(["row",!e.minPrice||!e.maxPrice?"color-text":""])},[e.minPrice&&e.maxPrice?(S(),F("span",Za,"✓")):D("",!0),be(" Select Price Range ")],2),a("div",{class:ke(["row",e.fromCoinAmount?"":"color-text"])},[e.fromCoinAmount?(S(),F("span",xa,"✓")):D("",!0),be(" Confirm Liquidity ")],2)])]),a("div",et,[a("div",ot,[at,a("div",tt,[e.fromCoin&&e.toCoin&&e.initPrice?(S(),F("div",lt,[ca(a("img",null,null,512),[[w,(U=e.fromCoin)==null?void 0:U.logo_url]]),a("span",null,Ko((ve=e.fromCoin)==null?void 0:ve.symbol),1),a("div",{class:"icon-change",onClick:t[0]||(t[0]=(...l)=>e.toggle&&e.toggle(...l))},it)])):D("",!0)])]),a("div",ut,[rt,a("div",ct,[a("div",vt,[oe(H,{type:"text",placeholder:"0.0",value:e.initPrice,onInput:t[1]||(t[1]=l=>e.changeCurrentPrice(l.target.value))},null,8,["value"])]),e.inputPriceLock?(S(),F("div",dt,[oe(R)])):D("",!0)])]),a("div",mt,[pt,a("div",ft,[a("div",{class:ke(["radio",e.isFullRange?"active-radio":""]),onClick:t[2]||(t[2]=(...l)=>e.clickFullRange&&e.clickFullRange(...l))},[e.isFullRange?(S(),F("img",gt)):D("",!0)],2),kt])]),a("div",bt,[a("div",{class:ke(["top",e.specifyPriceLock?"":"no-border"])},ht,2),a("div",_t,[a("div",yt,[oe(C,{min:e.minPrice,max:e.maxPrice,"from-coin":e.fromCoin,"to-coin":e.toCoin,direct:e.direct,"default-min-price":e.defaultMinPrice,"default-max-price":e.defaultMaxPrice,"pool-info":e.createPoolInfo,loading:!1,"current-price-tab":"custom",onOnChangeMinPrice:e.priceRangeChangeMin,onOnChangeMaxPrice:e.priceRangeChangeMax},null,8,["min","max","from-coin","to-coin","direct","default-min-price","default-max-price","pool-info","onOnChangeMinPrice","onOnChangeMaxPrice"])]),e.specifyPriceLock?(S(),F("div",Pt,[oe(R)])):D("",!0),St])])]),a("div",Nt,[e.amountLock?(S(),F("div",Tt,[oe(R)])):D("",!0),oe(E,{"create-pool-info":e.createPoolInfo,onToggle:e.toggle},null,8,["create-pool-info","onToggle"])])])}const al=Ke(Ea,[["render",At],["__scopeId","data-v-ffaa8b79"]]);export{al as default};
