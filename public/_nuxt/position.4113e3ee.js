import{_ as ce}from"./upgrade-select-input.2ebfca9b.js";import{_ as de}from"./upgrade-loading.279a2fab.js";import{_ as me}from"./upgrade-position-item.bc852a6b.js";import{a as pe,r as g,y as ve,b as ge,l as m,q as R,H as be,K as he,R as fe,X as _e,e as ye,o as l,f as r,h as p,F as I,E as F,x as w,i as W,z as H,v as T,A as X,j as Z,w as ke,B as Se,c as Le,p as Ae,k as we}from"./entry.59a2cdcc.js";import{u as Te,a as Pe,c as $e}from"./sha256.fbf47686.js";import{u as Oe}from"./notifi.e156ed62.js";import{u as Re,c as Ue}from"./pool.acb16d99.js";import{i as Q}from"./import-icon.de3e6c66.js";import{_ as Y}from"./icon_on_2x.5e96733d.js";import{_ as Be}from"./img-no-Positions_2x.fb84f178.js";import{_ as Ce}from"./img-no-Positions_2x.b6d04572.js";import{_ as Ne}from"./img-connect-wallet_2x.9c5c70a7.js";import{_ as Ee}from"./img-connect-wallet_2x.5ca5a575.js";import"./coin-select.bdb54d2e.js";/* empty css              *//* empty css              *//* empty css              *//* empty css              */import"./icon-Amount-for-Sale_2x.b2e65df2.js";import"./status-block.bce15e4e.js";import"./decimal.0bdeb344.js";import"./farms.f563d6f2.js";import"./farms.c4139862.js";import"./icon-arrow_2x.948aedb2.js";import"./icon-arrow_2x.4ffddb8e.js";import"./icon_rewards_2x.c22d4d5c.js";import"./useWhale.70f4fa69.js";const De=pe({setup(){const o=g(!1),{t:i}=ve(),q=g(["position"]),P=ge(),z=g(""),U=Te(),v=m(()=>U),G=m(()=>v.value.chainName?$e[v.value.chainName]:{});let c=g([]);const _=Re(),a=m(()=>_),y=Pe(),h=m(()=>y),j=g(!1),$=g(i("tab.all")),V=g([i("tab.layerZero"),i("tab.wormhole"),i("tab.celer")]),B=g(!0),ee=g("TVL"),J=()=>{o.value=!0,c.value=[],h.value.address&&_.getMyPositons(h.value.address,a.value.poolsObj,v.value.chainName),setTimeout(()=>{o.value=!1},1e3)},oe=m(()=>{const s=Array.from(new Set(a.value.poolConfigList.flatMap(e=>!(e!=null&&e.category)||(e==null?void 0:e.category)==""?"All":e==null?void 0:e.category)));return console.log(s,"newArr"),s.length<=1?[]:s}),se=s=>{a.value.setCurrentPoolTab(s)};R(()=>v.value.isRefresh,s=>{var e,t,n,u;s&&((u=(n=(t=(e=P==null?void 0:P.currentRoute)==null?void 0:e.value)==null?void 0:t.name)==null?void 0:n.split("-"))==null?void 0:u[1])=="position"&&J()}),be(()=>{c.value=[],document.addEventListener("click",()=>{j.value=!1}),_.setMyPositionsLoading(!0)}),he(()=>{document.addEventListener("click",()=>{j.value=!1})}),fe(()=>{h.value.connected||(c.value=[])});const K=()=>{o.value=!0;let s=[];a.value.myPositions.forEach(e=>{var C,N,E,D;const t=v.value.addressLpTokens[e.address];let n;t!=null&&t.stable_farming&&t.stable_farming.stable_rewarder.map(ie=>{ie.amount_second>0&&(n=!0)});let u,d;const b=e.amountA*((C=a.value.RATES[e.token_a.address])==null?void 0:C.price),A=e.amountB*((N=a.value.RATES[e.token_b.address])==null?void 0:N.price);(E=a.value.RATES[e.token_a.address])!=null&&E.price&&((D=a.value.RATES[e.token_b.address])!=null&&D.price)?(u=b+A,d=b+A):(u=" --",d=0),console.log(a.value.currentPoolTab,"##pools.value.currentPoolTab"),(a.value.currentPoolTab=="All"||a.value.currentPoolTab!=="All"&&e.category==a.value.currentPoolTab)&&s.push({...e,amountUSD:u,amountUSDOrigin:d,tokenARates:b,tokenBRates:A,isStableFarming:n})}),$.value!="All"?B.value?(c.value=s.sort((e,t)=>Number(t.amountUSDOrigin)-Number(e.amountUSDOrigin)),o.value=!1):(c.value=s.sort((e,t)=>Number(e.amountUSDOrigin)-Number(t.amountUSDOrigin)),o.value=!1):B.value?(c.value=s.sort((e,t)=>t.amountUSDOrigin-e.amountUSDOrigin),o.value=!1):(c.value=s.sort((e,t)=>e.amountUSDOrigin-t.amountUSDOrigin),o.value=!1),console.log(c.value,"list.value========>")};R(()=>[a.value.myPositions,a.value.RATES],([s,e])=>{s&&e&&(console.log("0605==>updateLpList9099999"),K())},{immediate:!0}),R(()=>[h.value.address,a.value.poolConfigList,a.value.poolsObj,v.value.chainName],([s,e,t,n])=>{var u,d,b;s&&e&&e.length>0&&n&&(n!=null&&n.toLowerCase().includes((u=e[0])==null?void 0:u.chain))&&!Ue(t)&&(n==="Aptos"?e.length===Object.values(t).length:(b=(d=Object.values(t)[0])==null?void 0:d.chain)!=null&&b.includes("sui"))&&(console.log(t,e,"0605==>getMyPositons9099999"),_.getMyPositons(h.value.address,t,n))},{immediate:!0,deep:!0}),R(()=>[$.value,B.value,a.value.currentPoolTab],([s])=>{K()});const te=s=>{const e=[];V.value.forEach((t,n)=>{t==s?e[n]=$.value:e[n]=t}),V.value=e,$.value=s},O=Oe(),f=m(()=>O),M=m(()=>_),ae=async s=>{await O.getSourceGroups();const e=f.value.sourceGroups&&f.value.sourceGroups.length>0&&f.value.sourceGroups[0]&&f.value.sourceGroups[0].sources||[];console.log(e,"####source"),console.log(s,"###myPositions");for(let t=0;t<e.length;t++){const{pool_address:n,position_index:u}=JSON.parse(e[t].blockchainAddress);let d=!1,b;for(let A=0;A<s.length;A++){const{poolAddress:C,index:N,positionSource:E,name:D}=s[A];n==C&&Number(E=="clmm"?N:D.split("-")[1])==Number(u)&&(d=!0),b={pool_address:n,position_index:u}}d||await O.subscribePosition(b,"",!1,!1)}},ne=async()=>{await O.getSourceGroups();const s=f.value.sourceGroups&&f.value.sourceGroups.length>0&&f.value.sourceGroups[0]&&f.value.sourceGroups[0].sources||[];for(let e=0;e<s.length;e++){const{pool_address:t,position_index:n}=JSON.parse(s[e].blockchainAddress),{name:u}=s[e],d={pool_address:t,position_index:n};await O.subscribePosition(d,u,!1,!1)}},le=m(()=>M.value.myPositionsLoading);R(()=>M.value.myPositions,(s,e)=>{G.value.hasNotifi&&(s&&s.length>0&&e&&e.length!==s.length?ae(s):s&&s.length==0&&!le.value&&ne())},{immediate:!0});const re=s=>{var e;return(s==null?void 0:s.logoURI)||(s==null?void 0:s.logo_url)||((e=a.value.tokensObj[s==null?void 0:s.address])==null?void 0:e.logo_url)||(v.value.theme==="default"?Q("/image/coins/unknown.png"):Q("/image/coins/sui-unknown.png"))},k=g(null),S=m(()=>k.value&&k.value.firstToken?k.value.firstToken:null),L=m(()=>k.value&&k.value.lastToken?k.value.lastToken:null),ue=m(()=>{let s=[];s=c.value;const e=s.filter((t,n)=>S.value&&L.value?t.coinA.symbol==S.value.symbol&&t.coinB.symbol==L.value.symbol||t.coinA.symbol==L.value.symbol&&t.coinB.symbol==S.value.symbol:S.value?t.coinA.symbol.toLowerCase().includes(S.value.symbol.toLowerCase())||t.coinB.symbol.toLowerCase().includes(S.value.symbol.toLowerCase()):L.value?t.coinA.symbol.toLowerCase().includes(L.value.symbol.toLowerCase())||t.coinB.symbol.toLowerCase().includes(L.value.symbol.toLowerCase()):s);return a.value.myPositionsLoading||U.setPositiomAmount(e.length),e});return _e(()=>{U.setPositiomAmount("--")}),{tabArr:oe,changeTab:se,showList:ue,childTokenSelectRef:k,firstToken:S,lastToken:L,getCoinIcon:re,changeSortLabel:te,label:j,labelList:V,labelValue:$,select:B,selectValue:ee,t:i,pools:a,store:v,wallet:h,list:c,clickRefresh:J,refresh:o,current:q,router:P,searchKey:z}}});const x=o=>(Ae("data-v-16a44b2d"),o=o(),we(),o),Ge={class:"upgrade-position-list-container"},je={class:"content-top"},Ve={class:"content-top-left"},Ie={key:0,class:"tag-list"},Fe=["onClick"],We={class:"content-top-right"},qe={class:"value"},ze=x(()=>p("use",{"xlink:href":"#icon-icon_on"},null,-1)),Je=[ze],Ke={key:0,class:"select-item"},Me=["onClick"],He={class:"search-select-box"},Xe=x(()=>p("span",null,"TVL",-1)),Ze={key:0,src:Y,alt:""},Qe={key:1,class:"fan-img",src:Y,alt:""},Ye={key:0,class:"upgrade-loading"},xe={key:1,class:"position-list"},eo={key:2,class:"no-data"},oo={key:0,src:Be,alt:""},so={key:1,src:Ce,alt:""},to={key:3,class:"no-data"},ao={key:0,src:Ne,alt:""},no={key:1,src:Ee,alt:""};function lo(o,i,q,P,z,U){const v=ce,G=de,c=me,_=Se;return l(),r("div",Ge,[p("div",je,[p("div",Ve,[o.tabArr.length>1?(l(),r("div",Ie,[(l(!0),r(I,null,F(o.tabArr,(a,y)=>(l(),r("div",{key:y,class:X(["tag-item",a==o.pools.currentPoolTab?`tag-active tab-num-${o.tabArr.length}`:`tab-num-${o.tabArr.length}`]),onClick:h=>o.changeTab(a)},T(a),11,Fe))),128))])):w("",!0),W(v,{ref:"childTokenSelectRef"},null,512)]),p("div",We,[o.store.theme=="default"?(l(),r("div",{key:0,class:"search-label",onClick:i[0]||(i[0]=H(a=>o.label=!o.label,["stop"]))},[p("span",null,T(o.$t("newAdd.label")),1),p("div",qe,T(o.labelValue),1),(l(),r("svg",{"aria-hidden":"true",class:X(o.label?"show-icon icon":"icon")},Je,2)),o.label?(l(),r("div",Ke,[(l(!0),r(I,null,F(o.labelList,(a,y)=>(l(),r("div",{key:y,class:"select-menu-item",onClick:h=>o.changeSortLabel(a)},T(a),9,Me))),128))])):w("",!0)])):w("",!0),p("div",He,[p("div",{class:"search-select",onClick:i[1]||(i[1]=H(a=>o.select=!o.select,["stop"]))},[Z(T(o.$t("newAdd.sortBy"))+" ",1),p("div",null,[Xe,o.select?(l(),r("img",Ze)):(l(),r("img",Qe))])])])])]),o.pools.myPositionsLoading&&o.wallet.connected?(l(),r("div",Ye,[W(G,{loading:o.pools.myPositionsLoading,type:"position"},null,8,["loading"])])):w("",!0),o.showList&&o.showList.length>0&&o.wallet.connected&&!o.pools.myPositionsLoading?(l(),r("div",xe,[(l(!0),r(I,null,F(o.showList,(a,y)=>(l(),Le(c,{key:y,"p-item":a},null,8,["p-item"]))),128))])):w("",!0),o.showList&&o.showList.length<=0&&!o.pools.myPositionsLoading&&o.wallet.connected?(l(),r("div",eo,[o.store.theme=="default"?(l(),r("img",oo)):(l(),r("img",so)),p("span",null,T(o.$t("common.noLiquidityPositions")),1)])):w("",!0),o.wallet.connected?w("",!0):(l(),r("div",to,[o.store.theme=="default"?(l(),r("img",ao)):(l(),r("img",no)),W(_,{class:"connect-wallet",onClick:i[2]||(i[2]=a=>o.wallet.setIsShowWalletModal(!0))},{default:ke(()=>[Z(T(o.$t("button.connectWallet")),1)]),_:1})]))])}const Eo=ye(De,[["render",lo],["__scopeId","data-v-16a44b2d"]]);export{Eo as default};
