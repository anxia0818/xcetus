import{u as Je,a as ia,c as Zo}from"./sha256.b0f6d1a3.js";import{a as Ke,m as $,e as Ye,o as S,f as q,r as M,E as xo,l as ca,D as ee,Q as ea,i as se,h as t,x as B,c as Ie,w as Qo,j as Ce,v as De,I as oa,B as va,p as aa,k as ta,b as da,C as ma,q as pa,H as fa,z as ke,t as ga,u as ka}from"./entry.04467954.js";import{_ as ba,b as Ca}from"./new-add-or-create.5b590f2c.js";import{_ as wa}from"./lock.d1d255bf.js";import{_ as ha,a as la,b as ya,c as Sa}from"./new-liquidity-title.355309be.js";import{i as Qe}from"./import-icon.de3e6c66.js";/* empty css              */import{a as na,u as ua,p as Go,s as Jo,e as Ko,c as Yo,f as Ue,b as _a,d as Pa}from"./pool.1b1f9f0e.js";import{_ as Na,a as Ta,s as Aa}from"./poolFee.7c125b3a.js";import{D as u}from"./decimal.0e8aa3f1.js";import{fromCoin as m,toCoin as p,fromCoinAmount as n,toCoinAmount as s,maxPrice as c,minPrice as g,createPoolInfo as r,showFromCoinLock as Z,showToCoinLock as x,amountLock as be,fixedFromCoin as A,currentPriceReverse as Ge,currentPrice as ie,initPrice as me,direction as w,createPoolFromCoin as oe,createPoolToCoin as ae,isFullRange as ue,resetData as Ia,defaultMinPrice as He,defaultMaxPrice as Xe}from"./create-pool-data.ef1bcab8.js";import{_ as qa,a as Ra}from"./icon-Add-Liquidity_2x.0acb06cb.js";import{_ as $a}from"./icon-selected_3x.09e9a6f0.js";import"./token-warning.d35514d3.js";import"./status-block.d153b8e5.js";/* empty css              *//* empty css              */import"./notifi.9743e778.js";import"./useWhale.42d62ce8.js";import"./index.367ee07e.js";/* empty css              */import"./tick.505fdad3.js";/* empty css              */import"./refresh-icon.8ca3327c.js";/* empty css              */import"./swap-setting.240fa4f3.js";const La=Ke({setup(){const e=Je();return{storeIndex:$(()=>e)}}});const Ba={class:"create-pool-lock"},Ma={key:0,src:ba,alt:""},Fa={key:1,src:wa,alt:""};function Oa(e,a,we,pe,D,H){return S(),q("div",Ba,[e.storeIndex.theme=="default"?(S(),q("img",Ma)):(S(),q("img",Fa))])}const sa=Ye(La,[["render",Oa],["__scopeId","data-v-fb497971"]]),Ua=Ke({components:{NewLiquidityTile:ha,NewLiquidityDepositRatio:la},setup(e,a){const we=ia(),pe=Je(),D=$(()=>pe),H=$(()=>D.value.chainName),E=$(()=>we),k=M(!1);M(),M(),M(),M(!1);const h=xo(),{t:X,locale:ve}=ca(),R=$(()=>H.value?na(H.value):{}),W=ua(),T=$(()=>W),d=$(()=>D.value.theme),F=$(()=>E.value.assets&&m.value&&E.value.assets[m.value.address]?Go(E.value.assets[m.value.address].balance,m.value.decimals):"0"),z=$(()=>E.value.assets&&p.value&&E.value.assets[p.value.address]?Go(E.value.assets[p.value.address].balance,p.value.decimals):"0"),Ve=o=>{o==="fromCoin"?(A.value=!0,H.value==="Aptos"?n.value=Number(F.value)>0?m.value.symbol=="APT"?new u(Number(F.value)).sub(new u(.1)).lt(new u(0))?"0":new u(Number(F.value)).sub(new u(.1)).toString():String(F.value):"":n.value=Number(F.value)>0?m.value.symbol=="SUI"?new u(Number(F.value)).sub(new u(.05)).lt(new u(0))?"0":new u(Number(F.value)).sub(new u(.05)).toString():String(F.value):""):(A.value=!1,H.value==="Aptos"?s.value=Number(z.value)>0?p.value.symbol=="APT"?new u(Number(z.value)).sub(new u(.1)).lt(new u(0))?"0":new u(Number(z.value)).sub(new u(.1)).toString():String(z.value):"":s.value=Number(z.value)>0?p.value.symbol=="SUI"?new u(Number(z.value)).sub(new u(.05)).lt(new u(0))?"0":new u(Number(z.value)).sub(new u(.05)).toString():String(z.value):"")},je=o=>{o==="fromCoin"?(A.value=!0,n.value=Number(F.value)>0?Jo(new u(Number(F.value)).div(2).toString(),m.value.decimals).toString():""):(A.value=!1,s.value=Number(z.value)>0?Jo(new u(Number(z.value)).div(2).toString(),p.value.decimals).toString():"")};ee(()=>[T.value.tokensObj,h.query],async([o])=>{if(o){const v=o;if(h&&h.query&&h.query.fromCoin&&(console.log("0410###deposite###watch###route.query.tokena####",h.query.fromCoin,v),h.query.fromCoin)){const i=await R.value.getTokenBySymbol(v,h.query.fromCoin);console.log(i,"###fromCoinValue"),m.value=i,oe.value=i}if(h&&h.query&&h.query.toCoin&&h.query.toCoin){const i=await R.value.getTokenBySymbol(v,h.query.toCoin);p.value=i,ae.value=i}}},{immediate:!0,deep:!0});const Y=M("--"),ye=$(()=>D.value.slippage),Ee=M(),fe=async()=>{if(!g.value&&!c.value)return!1;if(!n.value&&!s.value&&!g.value&&!c.value)return;const o=r.value;if(Yo(o))return;const{TickUtil:v,TickMath:i,getNearestTickByTick:f}=R.value,N=o==null?void 0:o.token_a.decimals,U=o==null?void 0:o.token_b.decimals;let P,I,y,C,L,V,j=o.current_tick_index,G;if(console.log(o,"==>poolInfos"),o.token_a.address.toLowerCase()===m.value.address.toLowerCase()&&o.token_b.address.toLowerCase()===p.value.address.toLowerCase()?G=!0:G=!1,g.value==="0"&&c.value==="âˆž")y=v.getMinIndex(Number(o.tickSpacing)),C=v.getMaxIndex(Number(o.tickSpacing));else{console.log(G,"===>directs1866"),G?(P=Number(g.value),I=Number(c.value)):(P=new u(1).div(c.value).toString(),I=new u(1).div(g.value).toString()),console.log("0518###pre###directs###",G),console.log("0518###pre###minPrice###",g.value),console.log("0518###pre###maxPrice###",c.value),console.log("0518###pre###poolInfos###",o),console.log("0518###pre###decimalsA###",N),console.log("0518###pre###decimalsB###",U),console.log(P,I,"min max1875"),console.log(g.value,c.value,"===>maxPrice.value");try{L=P==0?-443636:i.priceToTickIndex(new u(P),N,U)}catch{L=-443636}try{V=i.priceToTickIndex(new u(I),N,U)}catch{V=443636}y=f(L,Number(o.tickSpacing)),C=f(V,Number(o.tickSpacing))}if(console.log("0518###pre###currentTickIndex###",j,y,C),c.value!=="âˆž"&&y>=C){Z.value=!0,n.value="",x.value=!0,s.value="";return}if(console.log(C,j,y,"1922"),c.value==="âˆž"||j>=y&&j<=C){Z.value=!1,x.value=!1;let le;if(n.value||s.value){if(A.value){const he=new u(n.value).mul(Math.pow(10,m.value.decimals)).toString();le=new Ue(he)}else{const he=new u(s.value).mul(Math.pow(10,p.value.decimals)).toString();le=new Ue(he)}console.log(G,"======>directs");const{liquidityAmount:J,tokenMaxA:K,tokenMaxB:ne,tokenMaxAOrigin:Fe,tokenMaxBOrigin:Oe}=R.value.estLiquidityAndcoinAmountFromOneAmounts({tokenA:o.token_a,tokenB:o.token_b,lowerTick:y,upperTick:C,coinAmount:le,iscoinA:G?A.value:!A.value,roundUp:!0,slippage:Number(ye.value)/100,curSqrtPrice:new Ue(o.current_sqrt_price)});Ee.value={liquidityAmount:J,tokenMaxA:K,tokenMaxB:ne,tokenMaxAOrigin:Fe,tokenMaxBOrigin:Oe},console.log(ne,K,"tokenMaxB===>tokenMaxA"),G?A.value?s.value=Number(ne)>0?ne:"":n.value=Number(K)>0?K:"":A.value?s.value=K:n.value=ne}}else j>C?(Z.value=!0,x.value=!0):j<y?(Z.value=!0,x.value=!0):(Z.value=!0,n.value="",x.value=!0,s.value="")};ee(()=>me.value,o=>{o&&fe()},{immediate:!0}),ee(n,(o,v)=>{console.log(n,"===>fromCoinAmount"),o==""&&A.value&&(s.value=""),o&&A.value&&!k.value&&fe()}),ee(s,(o,v)=>{console.log(o,"===>>>>newValsda"),o==""&&!A.value&&(n.value=""),o&&!A.value&&!k.value&&fe()}),ee(()=>ue.value,o=>{fe()});const We=o=>{console.log(o,"e");const v=o.replace(/[^\d.]/g,""),i="$"+Ko(v);k.value=!0,Y.value=i,o>0?te():(n.value="",s.value="")};ee([g,c],([o,v])=>{console.log(o,v,"==>minPrice,maxPrice"),Number(o)!==0&&Number(v)!==0&&!k.value?fe():Number(o)!==0&&Number(v)!==0&&k.value&&te()},{immediate:!0});const l=()=>{const o=b.value&&b.value[m.value.address]&&b.value[m.value.address].price,v=b.value&&b.value[p.value.address]&&b.value[p.value.address].price;if(o&&v){const i=new u(n.value>0?n.value:0).mul(o),f=new u(s.value>0?s.value:0).mul(v),N=i.add(f).toNumber();Y.value=N>0&&N<.01?"$<0.01":"$"+Ko(N,2)}else Y.value="--"};ee(()=>[n.value,s.value,k.value],([o,v,i])=>{(o||v)&&!i?l():(!o||!v)&&!i&&(Y.value="--")},{immediate:!0});const b=$(()=>T.value.RATES),_=M(),te=async()=>{if(!g.value&&!c.value)return!1;if(!n.value&&!s.value&&!g.value&&!c.value)return;const o=r.value;if(Yo(o))return;const{TickUtil:v,TickMath:i,getNearestTickByTick:f}=R.value,N=o==null?void 0:o.token_a.decimals,U=o==null?void 0:o.token_b.decimals;let P,I,y,C,L,V,j;if(o.token_a.address.toLowerCase()===m.value.address.toLowerCase()&&o.token_b.address.toLowerCase()===p.value.address.toLowerCase()?j=!0:j=!1,g.value==="0"&&c.value==="âˆž")y=v.getMinIndex(Number(o.tickSpacing)),C=v.getMaxIndex(Number(o.tickSpacing));else{j?(P=Number(g.value),I=Number(c.value)):(P=new u(1).div(c.value).toString(),I=new u(1).div(g.value).toString());try{L=P==0?-443636:i.priceToTickIndex(new u(P),N,U)}catch{L=-443636}try{V=i.priceToTickIndex(new u(I),N,U)}catch{V=443636}y=f(L,Number(o.tickSpacing)),C=f(V,Number(o.tickSpacing))}console.log(o.token_a,"poolInfos===>");const G=b.value[o==null?void 0:o.token_a.address].price,le=b.value[o==null?void 0:o.token_b.address].price;console.log(y,C,"####tick_lower tick_upper 889");try{const{amountA:J,amountB:K,tokenAmountsInfo:ne}=await R.value.estCoinAmountsFromTotalAmount({lowerTick:y,upperTick:C,decimalsA:N,decimalsB:U,curSqrtPrice:new Ue(o.current_sqrt_price),totalAmount:Y.value,tokenPriceA:G,tokenPriceB:le});console.log(J,K,"###estCoinAmountsFromTotalAmount 844"),_.value=ne,o.needReverse?w.value?(n.value=J,s.value=K):(n.value=K,s.value=J):(n.value=J,s.value=K)}catch(J){console.log(J,"e===>")}},O=$(()=>{var i,f,N,U,P,I,y,C;const o=(N=b.value[(f=(i=m)==null?void 0:i.value)==null?void 0:f.address])==null?void 0:N.price,v=(I=b.value[(P=(U=p)==null?void 0:U.value)==null?void 0:P.address])==null?void 0:I.price;return console.log(b.value,(C=(y=m)==null?void 0:y.value)==null?void 0:C.address,"===>fromCoin?.value?.address"),!!(o&&v)}),Q=()=>{a.emit("toggle")},re=M(!1),Se=$(()=>{var o;return!m.value||!p.value?X("modal.selectTokenModalTitle"):!((o=h.query)!=null&&o.fee)&&Zo[H.value].hasCreatePool?"Select fee tier":!Number(n.value)&&!Number(s.value)?X("button.enterAmount"):Number(n.value)>Number(F.value)?X("button.insufficientBalance",{name:m.value.symbol}):Number(s.value)>Number(z.value)?X("button.insufficientBalance",{name:p.value.symbol}):c.value!=="âˆž"&&Number(g.value)>=Number(c.value)?X("newAdd.invalidRange"):X("newAdd.preview")}),qe=o=>{const v=new RegExp("[^\\d-]*(\\d*(?:\\.\\d{0,2})?).*$");o.target.value=o.target.value.replace(v,"$1")},Re=$(()=>{var o;return!n.value&&!s.value?(console.log("addLiquidityBtnDisabled11111"),!0):Number(n.value)>Number(F.value)||Number(s.value)>Number(z.value)?(console.log("addLiquidityBtnDisabled22222"),!0):Se.value!==X("newAdd.preview")?!0:!r.value&&!((o=r.value)!=null&&o.currentPrice)?(console.log("addLiquidityBtnDisabled55555"),!0):!!(Number(n.value)<=0&&Number(s.value)<=0||Z.value||x.value)}),{setTransactionTxid:_e,setTransactionDesc:$e,setIsShowWaiting:ge,setIsShowSuccess:Pe,setIsShowRejected:Ne,setPositiomNum:Le}=pe,Be=()=>{H.value=="Sui"&&Me()},Te=M(!1),Me=async()=>{var G,le,J,K,ne,Fe,Oe,he,Ze,xe,eo,oo,ao,to,lo,no,uo,so,ro,io,co,vo,mo,po,fo,go,ko,bo,Co,wo,ho,yo,So,_o,Po,No,To,Ao,Io,qo,Ro,$o,Lo,Bo,Mo,Fo,Oo,Uo,Do,Vo,jo,Eo,Wo,zo,Ho,Xo;re.value=!1,console.log("åˆ›å»ºsuiæ± å­");let o=!1;R.value.getIsSortedSymbols(oe.value.address,ae.value.address)&&(o=!0),_e("");const v=Z.value?"":`${n.value} ${(G=m.value)==null?void 0:G.symbol}`,i=x.value?"":`${s.value} ${(le=p.value)==null?void 0:le.symbol}`;console.log("0424###createPoolFromCoin###",oe.value),console.log("0424###createPoolToCoin###",ae.value),console.log("0424###needReverse###",o),console.log("0424###createPoolInfo?.value?.needReverse###",(K=(J=r)==null?void 0:J.value)==null?void 0:K.needReverse),$e(X("tips.increaseLiquiditySuccess",{from:!o&&!((Fe=(ne=r)==null?void 0:ne.value)!=null&&Fe.needReverse)||o&&((he=(Oe=r)==null?void 0:Oe.value)!=null&&he.needReverse)?v:i,and:!Z.value&&!x.value?"and":"",to:!o&&!((xe=(Ze=r)==null?void 0:Ze.value)!=null&&xe.needReverse)||o&&((oo=(eo=r)==null?void 0:eo.value)!=null&&oo.needReverse)?i:v})),ge(!0);let f="",N="",U="",P="",I="",y="",C=0,L=0,V=!1,j;if(o||(to=(ao=r)==null?void 0:ao.value)!=null&&to.needReverse){const de=o&&!((no=(lo=r)==null?void 0:lo.value)!=null&&no.needReverse);f=de?(vo=(co=(io=r)==null?void 0:io.value)==null?void 0:co.token_b)==null?void 0:vo.address:(ro=(so=(uo=r)==null?void 0:uo.value)==null?void 0:so.token_a)==null?void 0:ro.address,N=de?(bo=(ko=(go=r)==null?void 0:go.value)==null?void 0:ko.token_a)==null?void 0:bo.address:(fo=(po=(mo=r)==null?void 0:mo.value)==null?void 0:po.token_b)==null?void 0:fo.address,U=de?(_o=(So=(yo=r)==null?void 0:yo.value)==null?void 0:So.token_b)==null?void 0:_o.decimals:(ho=(wo=(Co=r)==null?void 0:Co.value)==null?void 0:wo.token_a)==null?void 0:ho.decimals,P=de?(qo=(Io=(Ao=r)==null?void 0:Ao.value)==null?void 0:Io.token_a)==null?void 0:qo.decimals:(To=(No=(Po=r)==null?void 0:Po.value)==null?void 0:No.token_b)==null?void 0:To.decimals,($o=(Ro=r)==null?void 0:Ro.value)!=null&&$o.needReverse?(I=w.value?n.value:s.value,y=w.value?s.value:n.value,C=w.value?Number(g.value):1/Number(c.value),L=w.value?Number(c.value):1/Number(g.value),V=w.value?A.value:!A.value,j=w.value?ie.value:1/Number(ie.value)):(I=w.value?s.value:n.value,y=w.value?n.value:s.value,C=w.value?1/Number(c.value):Number(g.value),L=w.value?1/Number(g.value):Number(c.value),V=w.value?!A.value:A.value,j=w.value?1/Number(ie.value):ie.value)}else f=(Mo=(Bo=(Lo=r)==null?void 0:Lo.value)==null?void 0:Bo.token_a)==null?void 0:Mo.address,N=(Uo=(Oo=(Fo=r)==null?void 0:Fo.value)==null?void 0:Oo.token_b)==null?void 0:Uo.address,U=(jo=(Vo=(Do=r)==null?void 0:Do.value)==null?void 0:Vo.token_a)==null?void 0:jo.decimals,P=(zo=(Wo=(Eo=r)==null?void 0:Eo.value)==null?void 0:Wo.token_b)==null?void 0:zo.decimals,I=w.value?n.value:s.value,y=w.value?s.value:n.value,C=w.value?Number(g.value):1/Number(c.value),L=w.value?Number(c.value):1/Number(g.value),V=w.value?A.value:!A.value,j=w.value?ie.value:1/Number(ie.value);try{console.log("0501###toCreatePool###params###",{coinTypeA:f,coinTypeB:N,decimalsA:U,decimalsB:P,amountA:I,amountB:y,minPrice:C,maxPrice:L,fix_amount_a:V,tick_spacing:Number(r.value.tickSpacing),slippage:Number(ye.value)/100,price:j});const de=await R.value.getCreatPoolTransactionPayload({coinTypeA:f,coinTypeB:N,decimalsA:U,decimalsB:P,amountA:I,amountB:y,minPrice:g.value=="0"&&c.value=="âˆž"?"0":C,maxPrice:g.value=="0"&&c.value=="âˆž"?"âˆž":L,fix_amount_a:V,tick_spacing:Number(r.value.tickSpacing),slippage:Number(ye.value)/100,price:j}),ra=await E.value.currentWallet.signAndExecuteTransactionBlock(de),Ae=R.value.handleTx(ra);if(Ae&&Ae.hash){_e(Ae.hash),ge(!1),Pe(!0);const ze={title:"Created pool",desc:"Pool created successfully ",hash:Ae.hash,tit:"Pool Created",icon:"icon-icon-Position-Created",tokenInfo:{tokena:`${(Ho=m.value)==null?void 0:Ho.address}`,numa:Z.value?"":`- ${n.value}`,logoa:T.value.tokensObj&&m.value&&m.value.address&&T.value.tokensObj[m.value.address]&&T.value.tokensObj[m.value.address].logoURI,tokenb:`${(Xo=p.value)==null?void 0:Xo.address}`,numb:x.value?"":`- ${s.value}`,logob:T.value.tokensObj&&p.value&&p.value.address&&T.value.tokensObj[p.value.address]&&T.value.tokensObj[p.value.address].logoURI},text:"Pool created successfully"};H.value!=="Aptos"&&(ze.res=Ae.res),R.value.showTransitionPending(ze),(await R.value.watchTransaction(ze,!0)).status&&(Pe(!1),Te.value=!0,setTimeout(()=>{W.setPoolConfigList(H.value,D.value.filterCoinsObj),R.value.getAccount(E.value.address)},1e3)),Le()}else ge(!1),Ne(!0);n.value="",s.value=""}catch(de){console.log("0407###createPool###error##",de),re.value=!1,W.setPoolConfigList(H.value,D.value.filterCoinsObj),n.value="",s.value="",ge(!1),Ne(!0)}};return ee(()=>r.value,o=>{console.log(o,"===>newVal")},{immediate:!0}),{amountLock:be,wallet:E,inputChange:qe,fromCoinAmount:n,toCoinAmount:s,fromCoin:m,toCoin:p,maxBtnSelect:Ve,halfBtnSelect:je,showFromCoinLock:Z,showToCoinLock:x,fromCoinBlance:F,toCoinBlance:z,fixedFromCoin:A,isInputTotalAmount:k,toggle:Q,theme:d,liquidityTotalAmount:Y,createPoolInfo:r,minPrice:g,maxPrice:c,currentPriceReverse:Ge,currentPrice:ie,onInput:We,initPrice:me,isShowtotalAmount:O,direction:w,isShowLiquidityModal:re,createPoolBtnText:Se,createPoolBtnDisabled:Re,toCreatePool:Be,isCreateSuccess:Te}}});const Da=e=>(aa("data-v-ec3d709d"),e=e(),ta(),e),Va={class:"create-pool-right"},ja={class:"card-container"},Ea={key:0,class:"lock"},Wa={class:"card-item"},za={class:"card-item"},Ha={key:0,class:"total-amount"},Xa=Da(()=>t("span",null,"Total Amount",-1));function Qa(e,a,we,pe,D,H){const E=ea("NewLiquidityTile"),k=sa,h=ya,X=oa,ve=la,R=Ca,W=va,T=Na;return S(),q("div",Va,[se(E),t("div",ja,[e.amountLock||e.showFromCoinLock||e.showToCoinLock?(S(),q("div",Ea,[se(k)])):B("",!0),t("div",Wa,[se(h,{modelValue:e.fromCoinAmount,"onUpdate:modelValue":a[0]||(a[0]=d=>e.fromCoinAmount=d),"input-value":e.fromCoinAmount,"coin-symbol":e.fromCoin?e.fromCoin.symbol:null,"coin-name":e.fromCoin?e.fromCoin.name:null,balance:e.fromCoinBlance,"coin-icon":e.fromCoin?e.fromCoin.logoURI:"",address:e.fromCoin?e.fromCoin.address:"","swap-direct":"From","import-page":"deposit","has-arrow":!1,onOnMax:a[1]||(a[1]=d=>e.maxBtnSelect("fromCoin")),onOnHalf:a[2]||(a[2]=d=>e.halfBtnSelect("fromCoin")),onOnInput:a[3]||(a[3]=d=>{e.fromCoinAmount=d,e.fixedFromCoin=!0,e.isInputTotalAmount=!1})},null,8,["modelValue","input-value","coin-symbol","coin-name","balance","coin-icon","address"])]),t("div",za,[se(h,{modelValue:e.toCoinAmount,"onUpdate:modelValue":a[4]||(a[4]=d=>e.toCoinAmount=d),"input-value":e.toCoinAmount,"coin-symbol":e.toCoin?e.toCoin.symbol:null,"coin-name":e.toCoin?e.toCoin.name:null,balance:e.toCoinBlance,"swap-direct":"To","coin-icon":e.toCoin?e.toCoin.logoURI:"",address:e.toCoin?e.toCoin.address:"","import-page":"deposit","has-arrow":!1,onOnMax:a[5]||(a[5]=d=>e.maxBtnSelect("toCoin")),onOnHalf:a[6]||(a[6]=d=>e.halfBtnSelect("toCoin")),onOnInput:a[7]||(a[7]=d=>{e.toCoinAmount=d,e.fixedFromCoin=!1,e.isInputTotalAmount=!1})},null,8,["modelValue","input-value","coin-symbol","coin-name","balance","coin-icon","address"])]),e.fromCoin&&e.toCoin&&!e.showToCoinLock&&!e.showFromCoinLock&&e.theme=="default"?(S(),q("img",{key:1,class:"add",src:qa,alt:"",onClick:a[8]||(a[8]=(...d)=>e.toggle&&e.toggle(...d))})):B("",!0),e.fromCoin&&e.toCoin&&!e.showToCoinLock&&!e.showFromCoinLock&&e.theme!=="default"?(S(),q("img",{key:2,class:"add",src:Ra,alt:"",onClick:a[9]||(a[9]=(...d)=>e.toggle&&e.toggle(...d))})):B("",!0)]),e.isShowtotalAmount?(S(),q("div",Ha,[Xa,t("span",null,[se(X,{value:e.liquidityTotalAmount,placeholder:e.isInputTotalAmount?"":e.liquidityTotalAmount,onInput:a[10]||(a[10]=d=>e.onInput(d.target.value))},null,8,["value","placeholder"])])])):B("",!0),e.initPrice?(S(),Ie(ve,{key:1,"from-coin":e.fromCoin,"to-coin":e.toCoin,"from-coin-amount":e.fromCoinAmount,"to-coin-amount":e.toCoinAmount,"fixed-from-coin":e.fixedFromCoin,"is-input-total-amount":e.isInputTotalAmount,"create-pool-info":e.createPoolInfo,"min-price":e.minPrice,"max-price":e.maxPrice,"current-price-tab":"custom","current-price":e.currentPrice,"current-price-reverse":e.currentPriceReverse},null,8,["from-coin","to-coin","from-coin-amount","to-coin-amount","fixed-from-coin","is-input-total-amount","create-pool-info","min-price","max-price","current-price","current-price-reverse"])):B("",!0),e.isShowLiquidityModal?(S(),Ie(R,{key:2,"pool-info":e.createPoolInfo,title:e.$t("newAdd.preview"),"from-coin-amount":e.fromCoinAmount,"to-coin-amount":e.toCoinAmount,"from-coin":e.fromCoin,"to-coin":e.toCoin,"fixed-from-coin":e.fixedFromCoin,"current-price":e.currentPrice,"current-price-reverse":e.currentPriceReverse,"current-price-tab":"custom","min-price":e.minPrice,"max-price":e.maxPrice,"show-from-coin-lock":e.showFromCoinLock,"show-to-coin-lock":e.showToCoinLock,"current-direct":e.direction,"is-increase":!1,onCreatePool:e.toCreatePool,onOnClose:a[11]||(a[11]=d=>e.isShowLiquidityModal=!1)},null,8,["pool-info","title","from-coin-amount","to-coin-amount","from-coin","to-coin","fixed-from-coin","current-price","current-price-reverse","min-price","max-price","show-from-coin-lock","show-to-coin-lock","current-direct","onCreatePool"])):B("",!0),e.wallet.connected?(S(),Ie(W,{key:4,class:"add-liquidity-btn",disabled:e.wallet.connected?e.createPoolBtnDisabled:!1,onClick:a[13]||(a[13]=d=>e.isShowLiquidityModal=!0)},{default:Qo(()=>[Ce(De(e.createPoolBtnText),1)]),_:1},8,["disabled"])):(S(),Ie(W,{key:3,class:"add-liquidity-btn",onClick:a[12]||(a[12]=d=>e.wallet.setIsShowWalletModal(!0))},{default:Qo(()=>[Ce(De(e.$t("button.connectWallet")),1)]),_:1})),e.isCreateSuccess?(S(),Ie(T,{key:5,onOnClose:a[14]||(a[14]=d=>e.isCreateSuccess=!1)})):B("",!0)])}const Ga=Ye(Ua,[["render",Qa],["__scopeId","data-v-ec3d709d"]]),Ja=Ke({components:{CreatePoolRight:Ga},setup(){const e=M(!0),a=M(!0),we=M(!0),pe=M(!1),D=M("1"),H=M(!0),E=M(""),k=xo(),h=da(),X=Je(),ve=$(()=>X),R=ua(),W=$(()=>R),T=$(()=>ve.value.chainName),d=$(()=>T.value?na(T.value):{}),F=M("");ee(()=>[h,W.value.tokensObj],async([l,b])=>{var _,te,O;((_=h==null?void 0:h.currentRoute)==null?void 0:_.value.name)=="liquidity-creat-pool"&&b&&(m.value=W.value.tokensObj[k.query.fromCoin]||await d.value.getTokenBySymbol(b,k.query.fromCoin),p.value=W.value.tokensObj[k.query.toCoin]||await d.value.getTokenBySymbol(b,k.query.toCoin),F.value=k.query.fee!=="null"&&k.query.fee?k.query.fee:""),((te=h==null?void 0:h.currentRoute)==null?void 0:te.value.name)=="liquidity-creat-pool"&&((O=k==null?void 0:k.query)!=null&&O.fee)&&(me.value="",n.value="",s.value="",ue.value=!0)},{immediate:!0,deep:!0}),ee(()=>[m.value,p.value,me.value,F.value,g.value,c.value,n.value,s.value],([l,b,_,te,O,Q,re])=>{!l||!b?(D.value="1",e.value=!0,a.value=!0,be.value=!0):te?_?!O||!Q?(D.value="4",e.value=!1,a.value=!1,be.value=!0):re||(D.value="5",e.value=!1,a.value=!1,be.value=!1):(D.value="3",e.value=!1,a.value=!0,be.value=!0):(D.value="2",e.value=!0,a.value=!0,be.value=!0)},{immediate:!0}),ee(()=>D.value,l=>{Number(l)<5&&(n.value="",s.value="")});const z=l=>{me.value=l},Ve=l=>{var b;return(l==null?void 0:l.logoURI)||(l==null?void 0:l.logo_url)||((b=W.value.tokensObj[l==null?void 0:l.address])==null?void 0:b.logo_url)||(ve.value.theme==="default"?Qe("/image/coins/unknown.png"):Qe("/image/coins/sui-unknown.png"))},je=l=>{switch(l){case"1":return{top:"10%"};case"2":return{top:"29%"};case"3":return{top:"48%"};case"4":return{top:"67%"};case"5":return{top:"87%"}}};$(()=>Zo[T.value].hasCreatePool);const Y=l=>{var Se,qe,Re,_e,$e,ge,Pe,Ne,Le,Be,Te,Me,o,v;console.log("#####emitCurrentPrice",l),l?(me.value=l,ie.value=l,Ge.value=new u(1).div(new u(l)).toString()):(me.value="",ie.value="",Ge.value="");let b,_;const te=W.value.poolConfigList;for(let i=0;i<te.length;i++){const f=te[i];if(f.token_a.address.toUpperCase()===((Re=(qe=(Se=oe)==null?void 0:Se.value)==null?void 0:qe.address)==null?void 0:Re.toUpperCase())&&f.token_b.address.toUpperCase()===((ge=($e=(_e=ae)==null?void 0:_e.value)==null?void 0:$e.address)==null?void 0:ge.toUpperCase())){b=f.needReverse,_=f;break}else if(f.token_b.address.toUpperCase()===((Le=(Ne=(Pe=oe)==null?void 0:Pe.value)==null?void 0:Ne.address)==null?void 0:Le.toUpperCase())&&f.token_a.address.toUpperCase()===((Me=(Te=(Be=ae)==null?void 0:Be.value)==null?void 0:Te.address)==null?void 0:Me.toUpperCase())){b=f.needReverse,_=f;break}}let O=!1;d.value.getIsSortedSymbols((o=oe.value)==null?void 0:o.address,(v=ae.value)==null?void 0:v.address)&&(O=!0);let Q;console.log(O,"###changeCurrentPrice createPoolNeedReverse 289"),console.log(w.value,"####changeCurrentPrice direction.value 290"),O&&w.value?Q=!0:O&&!w.value||!O&&w.value?Q=!1:Q=!0,console.log(Q,"###changeCurrentPrice newDirect 298");const re=T.value=="Aptos"?Ta:Aa;if(m.value&&p.value&&l){const i=_?_==null?void 0:_.token_a.decimals:O?ae.value.decimals:oe.value.decimals,f=_?_==null?void 0:_.token_b.decimals:O?oe.value.decimals:ae.value.decimals,N=l&&d.value.TickMath.priceToSqrtPriceX64(Q?new u(1/l):new u(l),i,f);console.log(N,"===>current_sqrt_price");const U=l&&d.value.TickMath.priceToSqrtPriceX64(new u(1).div(l),m.value.decimals,p.value.decimals);console.log(!Q,"===>!newDirect"),console.log(i,f,"decimalsA,decimalsB===>");const P=d.value.TickMath.priceToTickIndex(Q?new u(1).div(l):new u(l),i,f);console.log(P,"==>currentTickIndex");const I=P-re[k.query.fee]*5,y=P+re[k.query.fee]*5,C=d.value.TickMath.tickIndexToPrice(I,i,f).toString(),L=d.value.TickMath.tickIndexToPrice(y,i,f).toString();ue.value?(g.value="0",c.value="âˆž"):Q?(g.value=String(1/L),c.value=String(1/C),He.value=String(1/L),Xe.value=String(1/C)):(g.value=C,c.value=L,He.value=C,Xe.value=L),console.log("0518###c####createPoolFromCoin.value####",oe.value),console.log("0518###c####createPoolToCoin.value####",ae.value),console.log("0518###c####createPoolNeedReverse####",O);const V={token_a:_?_.token_a:O?ae.value:oe.value,token_b:_?_.token_b:O?oe.value:ae.value,isCreate:!0,tickSpacing:re[k.query.fee],currentPrice:l,current_sqrt_price:N,tick_lower:I,tick_upper:y,current_tick_index:P,currentPriceReverse:_a(String(1/l),6),reverse_current_sqrt_price:U,needReverse:b,fee:k.query.fee};r.value=V,console.log("0518###c####poolInfos####",V)}else r.value=null,g.value="",c.value=""},ye=()=>{ue.value=!ue.value,Y(r.value.currentPrice)},Ee=l=>{console.log(l,"####0731 priceRangeChangeMin"),ue.value?(ue.value=!1,Y(r.value.currentPrice)):g.value=l},fe=l=>{ue.value?(ue.value=!1,Y(r.value.currentPrice)):l=="0"?c.value="âˆž":c.value=l},We=()=>{var l,b;if(console.log(r.value,"==>createPoolInfo.value"),w.value=!w.value,r.value){Y(Pa(new u(1).div(r.value.currentPrice).toString(),(b=(l=p)==null?void 0:l.value)==null?void 0:b.decimals));const _=m.value;m.value=p.value,p.value=_,A.value?n.value=s.value:s.value=n.value}console.log(w.value,"####toggle direction.value")};return ma(()=>{Ia()}),{amountLock:be,currentStep:D,sliderStyle:je,coinAmount:pe,pricerange:E,fromCoin:m,toCoin:p,fee:F,direct:H,getCoinIcon:Ve,isSelectFullRange:we,onInput:z,store:ve,initPrice:me,inputPriceLock:e,specifyPriceLock:a,changeCurrentPrice:Y,minPrice:g,maxPrice:c,defaultMinPrice:He,defaultMaxPrice:Xe,clickFullRange:ye,createPoolInfo:r,isFullRange:ue,priceRangeChangeMin:Ee,priceRangeChangeMax:fe,fromCoinAmount:n,toggle:We,showFromCoinLock:Z,showToCoinLock:x}}});const ce=e=>(aa("data-v-95844966"),e=e(),ta(),e),Ka={class:"creat-pool-container"},Ya={class:"creat-pool-left"},Za={class:"progress"},xa=ce(()=>t("div",{class:"slider-ratio-content"},null,-1)),et=[xa],ot={class:"progress-text"},at={key:0},tt={key:0},lt={key:0},nt={key:0},ut={key:0},st={class:"creat-pool-center"},rt={class:"title"},it=ce(()=>t("div",{class:"left"},"Set Initial Price",-1)),ct={class:"right"},vt={key:0,class:"token-box"},dt=ce(()=>t("div",null,[t("svg",{class:"icon icon-up","aria-hidden":"true"},[t("use",{"xlink:href":"#icon-exchange_up1"})])],-1)),mt=ce(()=>t("div",null,[t("svg",{class:"icon icon-down","aria-hidden":"true"},[t("use",{"xlink:href":"#icon-exchange_down1"})])],-1)),pt=[dt,mt],ft={class:"content top-content"},gt=ce(()=>t("div",{class:"top"},[t("span",null,"ðŸ’¡"),t("span",null,"Please set an initial price for this new pool to start.")],-1)),kt={class:"bottom"},bt={class:"input-div"},Ct={key:0,class:"lock"},wt={class:"title"},ht=ce(()=>t("div",{class:"left"},"Set Price Range",-1)),yt={class:"right"},St={key:0,src:$a},_t=ce(()=>t("span",null,"Full Range",-1)),Pt={class:"content bottom-content"},Nt=ce(()=>t("span",null,"ðŸ’¡",-1)),Tt=ce(()=>t("span",null,"Please specify a price range that you want to provide your liquidity within.",-1)),At=[Nt,Tt],It={class:"bottom"},qt={class:"set-price-box"},Rt={key:0,class:"lock"},$t={key:1,class:"create-pool-warning"},Lt={key:2,class:"position-tips"},Bt=["src"],Mt={class:"error"},Ft={class:"creat-pool-right-container"};function Ot(e,a,we,pe,D,H){var R,W;const E=oa,k=sa,h=Sa,X=ea("CreatePoolRight"),ve=pa("image");return S(),q("div",Ka,[t("div",Ya,[t("div",Za,[t("div",{class:"slider-ratio",style:fa(e.sliderStyle(e.currentStep))},et,4)]),t("div",ot,[t("div",{class:ke(["row",Number(e.currentStep)>=1?"":"color-text"])},[e.currentStep>=1&&e.fromCoin&&e.toCoin?(S(),q("span",at,"âœ“")):B("",!0),Ce(" Select tokens ")],2),t("div",{class:ke(["row",Number(e.currentStep)>=2?"":"color-text"])},[e.currentStep>=2&&e.fee?(S(),q("span",tt,"âœ“")):B("",!0),Ce(" Select Fee Tier ")],2),t("div",{class:ke(["row",Number(e.currentStep)>=3?"":"color-text"])},[e.currentStep>=3&&e.initPrice?(S(),q("span",lt,"âœ“")):B("",!0),Ce(" Set Initial Price ")],2),t("div",{class:ke(["row",Number(e.currentStep)>=4?"":"color-text"])},[e.currentStep>=4&&e.minPrice&&e.maxPrice?(S(),q("span",nt,"âœ“")):B("",!0),Ce(" Select Price Range ")],2),t("div",{class:ke(["row",Number(e.currentStep)>=5?"":"color-text"])},[e.currentStep>=5&&e.fromCoinAmount?(S(),q("span",ut,"âœ“")):B("",!0),Ce(" Confirm Liquidity ")],2)])]),t("div",st,[t("div",rt,[it,t("div",ct,[e.fromCoin&&e.toCoin&&e.initPrice?(S(),q("div",vt,[ga(t("img",null,null,512),[[ve,(R=e.fromCoin)==null?void 0:R.logo_url]]),t("span",null,De((W=e.fromCoin)==null?void 0:W.symbol),1),t("div",{class:"icon-change",onClick:a[0]||(a[0]=(...T)=>e.toggle&&e.toggle(...T))},pt)])):B("",!0)])]),t("div",ft,[gt,t("div",kt,[t("div",bt,[se(E,{value:e.initPrice,type:"text",placeholder:"0.0",onInput:a[1]||(a[1]=T=>e.changeCurrentPrice(T.target.value))},null,8,["value"])]),e.inputPriceLock?(S(),q("div",Ct,[se(k)])):B("",!0)])]),t("div",wt,[ht,t("div",yt,[t("div",{class:ke(["radio",e.isFullRange?"active-radio":""]),onClick:a[2]||(a[2]=(...T)=>e.clickFullRange&&e.clickFullRange(...T))},[e.isFullRange?(S(),q("img",St)):B("",!0)],2),_t])]),t("div",Pt,[t("div",{class:ke(["top",e.specifyPriceLock?"":"no-border"])},At,2),t("div",It,[t("div",qt,[se(h,{min:e.minPrice,max:e.maxPrice,"from-coin":e.fromCoin,"to-coin":e.toCoin,direct:e.direct,"default-min-price":e.defaultMinPrice,"default-max-price":e.defaultMaxPrice,"pool-info":e.createPoolInfo,loading:!1,"current-price-tab":"custom",onOnChangeMinPrice:e.priceRangeChangeMin,onOnChangeMaxPrice:e.priceRangeChangeMax},null,8,["min","max","from-coin","to-coin","direct","default-min-price","default-max-price","pool-info","onOnChangeMinPrice","onOnChangeMaxPrice"])]),e.specifyPriceLock?(S(),q("div",Rt,[se(k)])):B("",!0),e.currentStep>=4&&(e.showFromCoinLock||e.showToCoinLock)&&Number(e.maxPrice)>Number(e.minPrice)?(S(),q("div",$t," To create a new pool, the initial price you set must be within your price range. ")):B("",!0),e.currentStep>=4&&Number(e.minPrice)>Number(e.maxPrice)?(S(),q("div",Lt,[t("img",{src:("importIcon"in e?e.importIcon:ka(Qe))("/image/icon-tips-error@2x.png"),alt:""},null,8,Bt),t("p",Mt,De(e.$t("tips.positionError")),1)])):B("",!0)])])]),t("div",Ft,[se(X,{"create-pool-info":e.createPoolInfo,onToggle:e.toggle},null,8,["create-pool-info","onToggle"])])])}const vl=Ye(Ja,[["render",Ot],["__scopeId","data-v-95844966"]]);export{vl as default};
