import{_ as Jo}from"./back.4fdd475f.js";import{_ as Qo}from"./swap-setting.1d6f9306.js";import{u as Fe,a as fo}from"./sha256.1f7a269f.js";import{a as We,r as $,m as y,e as He,o as C,f as M,h as t,v as D,c as Me,x as ve,p as eo,k as oo,C as Zo,D as we,b as uo,i as ce,z as Ke,y as Lo,t as qe,G as Io,a5 as Ko,H as mo,w as Xe,F as so,s as lo,j as Ae,u as K,L as Vo,E as po,q as qo,l as $o,a6 as xo,a0 as Ye,a7 as So,B as ho,a8 as en,a9 as on,K as nn,Y as tn,M as an,J as sn}from"./entry.a2892cfb.js";import{u as Ve,c as pe,a as no,b as ln,n as rn,d as ye,i as Po,e as V,s as Ee,q as yo,h as Te,p as To,f as Le,x as Mo,y as Bo,T as No,C as un}from"./pool.50d9f7a5.js";import{_ as go}from"./token-warning.fb396607.js";import{_ as Uo}from"./status-block.07d921ee.js";import{s as ao,m as dn,l as cn,b as vn,a as mn}from"./transform.c672907f.js";import{D as k}from"./decimal.0e8aa3f1.js";/* empty css              */import"./index.5f7cb590.js";import{i as ro}from"./import-icon.de3e6c66.js";import{_ as bo}from"./assets-card.776a3d2b.js";import{_ as fn,a as pn,b as hn}from"./icon-Add-Liquidity_2x.4c6f13c0.js";import{c as gn}from"./new-add-or-create.c444bf61.js";/* empty css              */import{u as jo}from"./notifi.9c104050.js";/* empty css              *//* empty css              *//* empty css              *//* empty css              */import"./useWhale.9ea9c1b0.js";import"./index.2539e259.js";const wo=Math.PI,Ao=2*wo,Ze=1e-6,bn=Ao-Ze;function Eo(e){this._+=e[0];for(let n=1,a=e.length;n<a;++n)this._+=arguments[n]+e[n]}function kn(e){let n=Math.floor(e);if(!(n>=0))throw new Error(`invalid digits: ${e}`);if(n>15)return Eo;const a=10**n;return function(i){this._+=i[0];for(let T=1,I=i.length;T<I;++T)this._+=Math.round(arguments[T]*a)/a+i[T]}}class _n{constructor(n){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=n==null?Eo:kn(n)}moveTo(n,a){this._append`M${this._x0=this._x1=+n},${this._y0=this._y1=+a}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(n,a){this._append`L${this._x1=+n},${this._y1=+a}`}quadraticCurveTo(n,a,i,T){this._append`Q${+n},${+a},${this._x1=+i},${this._y1=+T}`}bezierCurveTo(n,a,i,T,I,R){this._append`C${+n},${+a},${+i},${+T},${this._x1=+I},${this._y1=+R}`}arcTo(n,a,i,T,I){if(n=+n,a=+a,i=+i,T=+T,I=+I,I<0)throw new Error(`negative radius: ${I}`);let R=this._x1,c=this._y1,o=i-n,v=T-a,p=R-n,m=c-a,g=p*p+m*m;if(this._x1===null)this._append`M${this._x1=n},${this._y1=a}`;else if(g>Ze)if(!(Math.abs(m*o-v*p)>Ze)||!I)this._append`L${this._x1=n},${this._y1=a}`;else{let A=i-R,H=T-c,ee=o*o+v*v,te=A*A+H*H,s=Math.sqrt(ee),r=Math.sqrt(g),O=I*Math.tan((wo-Math.acos((ee+g-te)/(2*s*r)))/2),l=O/r,S=O/s;Math.abs(l-1)>Ze&&this._append`L${n+l*p},${a+l*m}`,this._append`A${I},${I},0,0,${+(m*A>p*H)},${this._x1=n+S*o},${this._y1=a+S*v}`}}arc(n,a,i,T,I,R){if(n=+n,a=+a,i=+i,R=!!R,i<0)throw new Error(`negative radius: ${i}`);let c=i*Math.cos(T),o=i*Math.sin(T),v=n+c,p=a+o,m=1^R,g=R?T-I:I-T;this._x1===null?this._append`M${v},${p}`:(Math.abs(this._x1-v)>Ze||Math.abs(this._y1-p)>Ze)&&this._append`L${v},${p}`,i&&(g<0&&(g=g%Ao+Ao),g>bn?this._append`A${i},${i},0,1,${m},${n-c},${a-o}A${i},${i},0,1,${m},${this._x1=v},${this._y1=p}`:g>Ze&&this._append`A${i},${i},0,${+(g>=wo)},${m},${this._x1=n+i*Math.cos(I)},${this._y1=a+i*Math.sin(I)}`)}rect(n,a,i,T){this._append`M${this._x0=this._x1=+n},${this._y0=this._y1=+a}h${i=+i}v${+T}h${-i}Z`}toString(){return this._}}function xe(e){return function(){return e}}function yn(e){let n=3;return e.digits=function(a){if(!arguments.length)return n;if(a==null)n=null;else{const i=Math.floor(a);if(!(i>=0))throw new RangeError(`invalid digits: ${a}`);n=i}return e},()=>new _n(n)}function wn(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function Do(e){this._context=e}Do.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,n){switch(e=+e,n=+n,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,n):this._context.moveTo(e,n);break;case 1:this._point=2;default:this._context.lineTo(e,n);break}}};function An(e){return new Do(e)}function Cn(e){return e[0]}function In(e){return e[1]}function $n(e,n){var a=xe(!0),i=null,T=An,I=null,R=yn(c);e=typeof e=="function"?e:e===void 0?Cn:xe(e),n=typeof n=="function"?n:n===void 0?In:xe(n);function c(o){var v,p=(o=wn(o)).length,m,g=!1,A;for(i==null&&(I=T(A=R())),v=0;v<=p;++v)!(v<p&&a(m=o[v],v,o))===g&&((g=!g)?I.lineStart():I.lineEnd()),g&&I.point(+e(m,v,o),+n(m,v,o));if(A)return I=null,A+""||null}return c.x=function(o){return arguments.length?(e=typeof o=="function"?o:xe(+o),c):e},c.y=function(o){return arguments.length?(n=typeof o=="function"?o:xe(+o),c):n},c.defined=function(o){return arguments.length?(a=typeof o=="function"?o:xe(!!o),c):a},c.curve=function(o){return arguments.length?(T=o,i!=null&&(I=T(i)),c):T},c.context=function(o){return arguments.length?(o==null?i=I=null:I=T(i=o),c):i},c}function Ro(){}function Fo(e){this._context=e}Fo.prototype={areaStart:Ro,areaEnd:Ro,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,n){e=+e,n=+n,this._point?this._context.lineTo(e,n):(this._point=1,this._context.moveTo(e,n))}};function Sn(e){return new Fo(e)}const Pn=We({setup(){const e=Fe(),n=$(!1),a=y(()=>e);return{slippage:y(()=>a.value.slippage),isShowSwapSetting:n}}});const Tn=e=>(eo("data-v-82585f8b"),e=e(),oo(),e),Nn=Tn(()=>t("svg",{class:"icon","aria-hidden":"true"},[t("use",{"xlink:href":"#icon-a-icon-setslippage"})],-1));function Rn(e,n,a,i,T,I){const R=Qo;return C(),M("div",{class:"slippage-icon",onClick:n[1]||(n[1]=c=>e.isShowSwapSetting=!0)},[Nn,t("span",null,D(e.slippage)+"%",1),e.isShowSwapSetting?(C(),Me(R,{key:0,onOnClose:n[0]||(n[0]=c=>e.isShowSwapSetting=!1)})):ve("",!0)])}const On=He(Pn,[["render",Rn],["__scopeId","data-v-82585f8b"]]),Ln=We({props:{poolInfo:{type:Object,default:()=>({})}},setup(e,n){const a=$(!1),i=$(null),T=$(0),I=$(20),R=Ve(),c=Fe(),o=$(!1);Zo(()=>{clearInterval(i.value)});const v=()=>{i.value=setInterval(()=>{var te;o.value||T.value<I.value&&(T.value+=1,T.value===I.value&&((te=e==null?void 0:e.poolInfo)!=null&&te.poolAddress&&R.updateCurrentPools(e.poolInfo.poolAddress,c.chainName),T.value=0))},1e3)},p=y(()=>c.slippage),m=()=>{n.emit("clearAll")},g=$(!1),A=()=>{T.value=0,g.value=!0,n.emit("clickRefresh"),setTimeout(()=>{g.value=!1},1e3)};we(()=>e.poolInfo,te=>{te&&!i.value&&v()},{immediate:!0});const H=uo(),ee=y(()=>c.chainName);return{clickRefresh:A,isShowSwapSetting:a,countdown:T,autoRefreshTime:I,slippage:p,clearAll:m,checkNullObj:pe,router:H,loading:o,chainName:ee,refresh:g}}});const qn=e=>(eo("data-v-54c078c7"),e=e(),oo(),e),Mn={class:"new-position-title"},Bn={class:"left"},Un={class:"right"},jn=qn(()=>t("use",{"xlink:href":"#icon-icon-refresh"},null,-1)),En=[jn];function Dn(e,n,a,i,T,I){const R=Jo,c=On;return C(),M("div",Mn,[t("div",Bn,[ce(R,{url:e.chainName=="Sui"?"/pool/position":"/position"},null,8,["url"])]),t("div",Un,[ce(c),(C(),M("svg",{"aria-hidden":"true",class:Ke(e.refresh?"refresh refresh-icon ":"refresh-icon"),onClick:n[0]||(n[0]=(...o)=>e.clickRefresh&&e.clickRefresh(...o))},En,2))])])}const Wo=He(Ln,[["render",Dn],["__scopeId","data-v-54c078c7"]]);function Oo(e,n,a){const i=new k(10).pow(n-a);return new k(1.0001).pow(e).mul(i)}const Fn=We({props:{poolInfo:{type:Object,default:()=>({chartLoading:!1,token_a:{decimal:6},token_b:{decimal:6},currentLiquity:"50000000"})},minPrice:{type:String,default:""},maxPrice:{type:String,default:""},direction:{type:Boolean,default:!0},tickList:{type:Array,default:()=>[]},currentTick:{type:Number,default:0},chartLoading:{type:Boolean,default:!1},currentPriceTab:{type:String,default:""},before7dContractPriceLowest:{type:String,default:""},before7dContractPriceHighest:{type:String,default:""}},setup(e,n){const a=$(1),i=$(""),T=$(""),I=y(()=>{var l,S,L;return m.sqrtPriceX64ToPrice((l=e.poolInfo)==null?void 0:l.current_sqrt_price,(S=e.poolInfo)==null?void 0:S.coinA.decimals,(L=e.poolInfo)==null?void 0:L.coinB.decimals).toString()}),R=y(()=>{let l=0;return e.direction?l=(Number(e.minPrice)/Number(I.value)-1)*100:l=(Number(e.minPrice)/Number(1/Number(I.value))-1)*100,l=l>0&&l<.1?.1:l,l=l<0&&l>-.1?-.1:l,l}),c=y(()=>{let l=0;return e.direction?l=(Number(e.maxPrice)/Number(I.value)-1)*100:l=(Number(e.maxPrice)/Number(1/Number(I.value))-1)*100,l=l>0&&l<.1?.1:l,l=l<0&&l>-.1?-.1:l,l}),o=Fe(),v=y(()=>o),p=y(()=>v.value.chainName?no(v.value.chainName):{}),{TickMath:m,getNearestTickByTick:g}=p.value,A=()=>{const l=a.value/2;a.value=l,te(e.poolInfo,l)},H=()=>{const l=a.value*2;a.value=l,te(e.poolInfo,l)},ee=(l=[])=>{let S=6;const L=Math.abs(Number(l[0])-Number(l[l.length-1]));return L>=6?S=0:L>=1?S=1:L>=.1?S=2:L>=.01?S=3:L>=.001?S=4:L>=1e-4?S=5:L>=1e-5?S=6:L>=1e-6?S=7:L>=1e-7&&(S=8),S},te=(l,S=1)=>{if(l&&l.token_a&&!e.chartLoading&&e.minPrice&&e.maxPrice){console.log(e.poolInfo,"==>props.poolInfo");const L=Number(e.poolInfo.current_tick_index);console.log("0117###dataProcessing###currentTick###",L),console.log("0117###dataProcessing###props.poolInfo###",e.poolInfo),console.log("0117###dataProcessing###minPrice###",e.minPrice),console.log("0117###dataProcessing###maxPrice###",e.maxPrice),console.log("0117###dataProcessing###poolInfo###",e.poolInfo);let w=L+100*S,u=L-100*S,f,B;if(e.maxPrice==="∞")B=p.value.TickUtil.getMaxIndex(Number(e.poolInfo.tickSpacing));else try{e.direction?B=m.priceToTickIndex(new k(e.maxPrice),e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals):B=m.priceToTickIndex(new k(1).div(e.minPrice),e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals)}catch{B=443636}if(e.minPrice==="0")f=p.value.TickUtil.getMinIndex(Number(e.poolInfo.tickSpacing));else try{e.direction?f=m.priceToTickIndex(new k(e.minPrice),e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals):f=m.priceToTickIndex(new k(1).div(e.maxPrice),e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals)}catch{f=-443636}let ie=0;if(e.currentPriceTab!=="full range"){if(L>=f&&L<=B){const F=L-f,fe=B-L;ie=Math.max(Math.abs(F),Math.abs(fe))}else L<f?ie=Math.abs(B-L):ie=Math.abs(L-f);w=L+ie+100*S,u=L-ie-100*S,console.log(S,L,"===>zooms")}else{const F=(Math.abs(L)>5e3,2e4);w=L+F*S,u=L-F*S}u<-443636&&(u=-443636),w>443636&&(w=443636),console.log(u,w,"===>201");const Q=new k(l.liquidity).div(Math.pow(10,8)).toString();console.log(Q,"==>currentLiquity");const U=e.tickList;console.log("0117####drawChart####tick_info_array####",U);const G=[],Z=[];let ne={};for(let F=0;F<U.length;F++){if(ne=U[F],ne.index<=L&&ne.index>=u){if(G.length<1&&F!==0){const fe=U[F-1];G.unshift({...fe,index:u})}G.unshift(ne)}else if(ne.index>L&&ne.index<=w&&(Z.push(ne),G.length<1&&F!==0)){const fe=U[F-1];G.push({...fe,index:u})}if(ne.index>w){const fe=U[F];if(Z.push({...fe,index:w}),G.length<1&&F!==0){const ke=U[F-1];G.push({...ke,index:u})}break}}console.log(L,u,w,"===>currentTick");let ae="0";for(let F=G.length-1;F>=0;F--)ae=new k(ae).plus(new k(G[F].liquidityNet.toString()).div(Math.pow(10,8))).toString(),G[F].liquityAmount=ae;let oe=Q;for(let F=0;F<Z.length;F++)oe=new k(oe).plus(new k(Z[F].liquidityNet.toString()).div(Math.pow(10,8))).toString(),Z[F].liquityAmount=oe;console.log(G.length,Z.length,"leftArray");let le=[];const x=U&&U.length>0?{index:L,liquityAmount:Number(Q)}:{index:L,liquityAmount:0};(G.length>0||Z.length>0)&&(console.log([x,...Z],"279===>"),le=[...G.reverse(),x,...Z],e.direction||(le=le.reverse()));const he=[];U.forEach(F=>{he.push({...F,liquidityGross:F.liquidityGross.toString(),liquidityNet:F.liquidityNet.toString()})}),console.log("0117####drawChart####testTickInfoArray####",he),console.log("0117####drawChart####currentLiquity####",Q),console.log(le,"===>chartData"),r(le,u,w,f,B,L)}};let s=$(!1);Lo(()=>{document.body.clientWidth<750?s.value=!1:s.value=!0,window.onresize=()=>{document.body.clientWidth<750?s.value=!1:s.value=!0,te(e.poolInfo,a.value)}});const r=(l,S,L,w,u,f)=>{console.log("0117####drawChart####chartData####",l),console.log("0117####drawChart####tickMin####",S),console.log("0117####drawChart####tickMax####",L),console.log("0117####drawChart####minPriceTick####",w),console.log("0117####drawChart####maxPriceTick####",u),console.log("0117####drawChart####currentTick####",f),console.log("0117####drawChart####props.direction####",e.direction),console.log("0518###newd3###props.before7dContractPriceLowest###",e.before7dContractPriceLowest),console.log("0518###newd3###props.before7dContractPriceHighest###",e.before7dContractPriceHighest);let B,ie;e.direction?(B=e.before7dContractPriceLowest?m.priceToTickIndex(new k(e.before7dContractPriceLowest),e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals):"",ie=e.before7dContractPriceHighest?m.priceToTickIndex(new k(e.before7dContractPriceHighest),e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals):""):(B=e.before7dContractPriceLowest?m.priceToTickIndex(new k(1).div(e.before7dContractPriceLowest),e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals):"",ie=e.before7dContractPriceHighest?m.priceToTickIndex(new k(1).div(e.before7dContractPriceHighest),e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals):"");const Q={top:30,right:35,bottom:20,left:55};let U,G;s.value,U=340-Q.left-Q.right,G=205-Q.top-Q.bottom;const Z=L-S,ne=parseInt(String(Z/4));let ae=[S+ne/4,S+ne,S+2*ne,L-ne,L-ne/4];const oe=S,le=L,x=U/(le-oe);e.currentPriceTab==="full range"&&(ae=[S,S+2*ne,L]),console.log("0117####drawChart####xArr####",ae),console.log("0117####drawChart####utickMin####",oe),console.log("0117####drawChart####utickMax####",le),console.log("0117####drawChart####unit####",x);const he=ae.map(N=>e.direction?Oo(N,e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals).toString():new k(1).div(Oo(N,e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals)).toString());ee(he),ao("#chart").selectAll("*").remove();const F=ao("#chart").attr("width",U+Q.left+Q.right).attr("height",G+Q.top+Q.bottom).append("g").attr("transform",`translate(${Q.left},${Q.right})`),fe=dn(l,function(N){return Number(Math.abs(N.liquityAmount))})||0,ke=cn().range([0,G]).domain([fe,0]);vn().rangeRound([0,U]).padding(.1);const d=F.append("g").attr("id","barsBox").selectAll("rect").data(l).enter().append("rect");v.value.theme=="default"?d.attr("x",function(N,j){return j===0?0:e.direction?Math.abs(N.index-oe)*x:Math.abs(le-N.index)*x}).attr("y",function(N,j){return e.direction?j===l.length-1?0:ke(N.liquityAmount):j===l.length-1?0:ke(l[j+1].liquityAmount)}).attr("width",function(N,j){return j===0&&l.length===1&&N.liquityAmount>0?U:(e.direction,j!==l.length-1?Math.abs(l[j+1].index-N.index)*x:0)}).attr("height",function(N,j){return j===0&&l.length===1&&N.liquityAmount>0?G:e.direction?j===l.length-1?0:G-ke(N.liquityAmount):j===l.length-1?0:G-ke(l[j+1].liquityAmount)}).attr("fill","#279477").attr("class","bars").attr("stroke-width",1).attr("stroke","#279477"):d.attr("x",function(N,j){return j===0?0:e.direction?Math.abs(N.index-oe)*x:Math.abs(le-N.index)*x}).attr("y",function(N,j){return e.direction?j===l.length-1?0:ke(Math.abs(N.liquityAmount)):j===l.length-1?0:ke(Math.abs(l[j+1].liquityAmount))}).attr("width",function(N,j){return j===0&&l.length===1&&N.liquityAmount>0?U:(e.direction,j!==l.length-1?Math.abs(l[j+1].index-N.index)*x:0)}).attr("height",function(N,j){if(j===0&&l.length===1&&N.liquityAmount>0)return G;if(e.direction)return j===l.length-1?0:Number(N.liquityAmount)?G-ke(Math.abs(N.liquityAmount)):0;{if(j===l.length-1)return 0;const ue=G-ke(Math.abs(l[j+1].liquityAmount));return Number(l[j+1].liquityAmount)?ue:0}}).attr("fill","#407497").attr("class","bars").attr("stroke-width",1).attr("stroke","#407497");const h=F.append("g");h.append("line").attr("x1",0).attr("y1",155).attr("x2",U).attr("y2",155).attr("stroke-width",1).attr("stroke","#50535D"),h.append("g");let P=0;e.direction?P=Math.abs(f-oe)*x:P=Math.abs(f-le)*x,(v.value.theme=="default"?F.append("line").attr("x1",0).attr("y1",0).attr("x2",0).attr("y2",155).attr("stroke-width",2).attr("stroke","#68FFD8"):F.append("line").attr("x1",0).attr("y1",0).attr("x2",0).attr("y2",155).attr("stroke-width",2).attr("stroke","#76C8FF")).attr("transform","translate("+P+", 0)"),ao("#triangle").attr("width",8).attr("height",4);let W=[[0,0],[4,4],[8,0]],X=$n().x(function(N){return N[0]}).y(function(N){return N[1]}).curve(Sn);const E=P-4;F.append("path").attr("d",X(W)).style("fill","#76C8FF").attr("transform","translate("+E+", 0)");let z,J,re,se;e.direction?(console.log("0525###d3###select###minPriceTick###",w),console.log("0525###d3###select###maxPriceTick###",u),console.log("0525###d3###select###props.minPrice###",e.minPrice),console.log("0525###d3###select###props.maxPrice###",e.maxPrice),z=w<oe?-100:parseInt(String(Math.abs(w-oe)*x)),J=u<oe?-100:parseInt(String(Math.abs(u-oe)*x)),re=B<oe?-100:Math.abs(B-oe)*x,se=ie<oe?-100:Math.abs(ie-oe)*x):(J=w<oe?-100:Math.abs(le-w)*x,z=u<oe?-100:Math.abs(le-u)*x,se=B<oe?-100:Math.abs(le-B)*x,re=ie<oe?-100:Math.abs(le-ie)*x),e.minPrice==="0"&&(z=0),e.maxPrice==="∞"&&(J=U),s.value?i.value=U-z+60+"px":i.value=U-z+52+"px",T.value=J+74+"px",B&&re<U&&F.append("line").attr("x1",0).attr("y1",0).attr("x2",0).attr("y2",155).attr("stroke-width",1).attr("stroke-dasharray","5, 5").attr("stroke","rgba(255, 255, 255, 0.5)").attr("transform","translate("+re+", 0)"),ie&&se<U&&F.append("line").attr("x1",0).attr("y1",0).attr("x2",0).attr("y2",155).attr("stroke-width",1).attr("stroke-dasharray","5, 5").attr("stroke","rgba(255, 255, 255, 0.5)").attr("transform","translate("+se+", 0)");const me=mn().extent([[0,0],[U,G]]).handleSize(30).on("end",ge);F.append("g").attr("class","brush").call(me).call(me.move,[z,J]);function ge(N){if(!N.sourceEvent||!N.selection)return;s.value?i.value=U-N.selection[0]+60+"px":i.value=U-N.selection[0]+52+"px",T.value=N.selection[1]+74+"px";let j,ue;console.log("0525###d3###select###e.selection[0]###",N.selection[0]),console.log("0525###d3###select###e.selection[0]###",N.selection[1]),console.log("0525###d3###select###props.direction###",e.direction),console.log("0525###d3###select###width###",U),console.log("0525###d3###select###unit###",x),console.log("0525###d3###select###utickMin###",oe),console.log("0525###d3###select###utickMax###",le),console.log("0525###d3###select###props.poolInfo###",e.poolInfo);let _e=0,b=0;e.direction?(_e=g(parseInt(String(N.selection[0]/x+oe)),Number(e.poolInfo.tickSpacing)),j=m.tickIndexToPrice(_e,e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals).toString(),b=g(parseInt(String(N.selection[1]/x+oe)),Number(e.poolInfo.tickSpacing)),ue=m.tickIndexToPrice(b,e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals).toString(),console.log("0525###d3###select###minTick###",_e),console.log("0525###d3###select###maxTick###",b),console.log("0525###d3###select###minPrice###",j),console.log("0525###d3###select###maxPrice###",ue)):(b=g(le-N.selection[0]/x,Number(e.poolInfo.tickSpacing)),j=1/m.tickIndexToPrice(b,e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals).toString(),_e=g(le-N.selection[1]/x,Number(e.poolInfo.tickSpacing)),ue=1/m.tickIndexToPrice(_e,e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals).toString()),n.emit("onChangeMinPrice",String(ye(String(j),6))),n.emit("onChangeMaxPrice",String(ye(String(ue),6)))}v.value.theme=="default"?ao(".selection").attr("stroke","rgba(255, 255, 255, 0)").attr("fill","#15322C"):ao(".selection").attr("stroke","rgba(255, 255, 255, 0)").attr("fill","rgba(118,200,255,0.7)")};$(""),we(()=>[e.poolInfo,e.minPrice,e.maxPrice,e.currentPriceTab,e.tickList],([l,S,L,w])=>{console.log(l,S,L,L>S,"poolInfo && minPrice && maxPrice && (maxPrice > minPrice)"),l&&S&&L&&te(l,a.value)},{immediate:!0});const O=$(!0);return we(()=>e.chartLoading,(l,S)=>{l!==S&&(O.value=l)},{immediate:!0,deep:!0}),{store:v,loading:O,zoomOut:A,zoomIn:H,rangeSizeLower:R,rangeSizeUpper:c,rangeSizeLowerPosition:i,rangeSizeUpperPosition:T,decimalFormat:ln,numberformat:rn}}});const Wn=e=>(eo("data-v-58b786ed"),e=e(),oo(),e),Hn={class:"chart-box"},Xn={class:"chart"},zn=Wn(()=>t("svg",{id:"chart"},null,-1)),Gn=[zn];function Yn(e,n,a,i,T,I){return C(),M("div",Hn,[qe(t("div",Xn,Gn,512),[[Io,!e.loading]])])}const Ho=He(Fn,[["render",Yn],["__scopeId","data-v-58b786ed"]]),Jn=We({props:{poolInfo:{type:Object,default:()=>({})},minPrice:{type:String,default:""},maxPrice:{type:String,default:""},fromCoin:{type:Object,default:()=>({})},toCoin:{type:Object,default:()=>({})}},setup(e){const n=$("echartsBox"+Date.now()+Math.random()),a=Fe(),i=y(()=>a),T=Ve(),I=y(()=>T),R=(f,B)=>f!=="0"&&B!=="∞"?Ee(1/(1-Number((f/B)**.25)),2)+"x":1,c=y(()=>e.minPrice&&e.maxPrice?R(e.minPrice,e.maxPrice):"--"),o=$(30),v=y(()=>{var f;return console.log(i.value.addressHistTokens,"===>store.value.addressHistTokens"),Object.fromEntries((f=i.value.addressHistTokens[e.poolInfo.poolAddress])==null?void 0:f.data.map(B=>[B.key,B.value]))}),p=y(()=>I.value.tokensObj),m=y(()=>i.value.newTopPoolsObj),g=y(()=>i.value.chainName),A=y(()=>no(g.value)),H=$(),ee=$(0),te=$(0),s=$(0),r=$(0),O=$(1e4),l=async f=>{var le,x,he,F,fe,ke,Ne,d,h,P,_;let B;((x=(le=f==null?void 0:f.token_a)==null?void 0:le.address)==null?void 0:x.toLowerCase())===((F=(he=e==null?void 0:e.fromCoin)==null?void 0:he.address)==null?void 0:F.toLowerCase())&&((ke=(fe=f==null?void 0:f.token_b)==null?void 0:fe.address)==null?void 0:ke.toLowerCase())===((d=(Ne=e==null?void 0:e.toCoin)==null?void 0:Ne.address)==null?void 0:d.toLowerCase())?B=!0:B=!1;const ie=B?Number(e.minPrice):e.maxPrice=="∞"?1/2**50:1/Number(e.maxPrice),Q=isNaN(Number(e.maxPrice))||e.maxPrice=="∞"?2**50:B?Number(e.maxPrice):1/Number(e.minPrice),U=Number(o.value==7?v.value.before_7_d_contract_price_lowest:o.value==24?v.value.before_24_h_contract_price_lowest:v.value.before_30_d_contract_price_lowest),G=Number(o.value==7?v.value.before_7_d_contract_price_highest:o.value==24?v.value.before_24_h_contract_price_highest:v.value.before_30_d_contract_price_highest);console.log("getEstPositionAPRWithMulti###params###lowerUserPrice###",ie),console.log("getEstPositionAPRWithMulti###params###upperUserPrice###",Q),console.log("getEstPositionAPRWithMulti###params###lowerHistPrice###",U),console.log("getEstPositionAPRWithMulti###params###upperHistPrice###",G);const Z=await A.value.getEstPositionAPRWithMulti(ie,Q,U,G);console.log("getEstPositionAPRWithMulti###resMulti###",Z.toString());const ne=Number(Z.toString()),ae=m.value[e.poolInfo.poolAddress];console.log(ae,"===>stats135");let oe;if(ae){const W=Number(ae.apr_7day.replace("%",""))||0,X=Number(ae.apr_24h.replace("%",""))||0,E=Number(ae.apr_30day.replace("%",""))||0;oe=o.value==7?W:o.value==24?X:E;const z=ae.rewarder_apr[0].replace("%","")||0,J=ae.rewarder_apr[1].replace("%","")||0,re=ae.rewarder_apr[2].replace("%","")||0,se=Number(ne*oe),me=Number(ne*z),ge=Number(ne*J),N=Number(ne*re),j=se+(f.rewarder_display1?me:0)+(f.rewarder_display2?ge:0)+(f.rewarder_display3?N:0),ue=f.rewarder_infos[0]?(h=p.value[f.rewarder_infos[0].coinAddress])==null?void 0:h.symbol:"--",_e=f.rewarder_infos[1]?(P=p.value[f.rewarder_infos[1].coinAddress])==null?void 0:P.symbol:"--",b=f.rewarder_infos[2]?(_=p.value[f.rewarder_infos[2].coinAddress])==null?void 0:_.symbol:"--",Y={aprFee:se==1/0||isNaN(se)?0:se,rewardAprList:[{rewarder_name:ue,rewarder_apr:me==1/0||isNaN(me)?0:me,styleName:"one",rewarder_display:f.rewarder_display1},{rewarder_name:_e,rewarder_apr:ge==1/0||isNaN(ge)?0:ge,styleName:"two",rewarder_display:f.rewarder_display2},{rewarder_name:b,rewarder_apr:N==1/0||isNaN(N)?0:N,styleName:"three",rewarder_display:f.rewarder_display2}],aprPercentageTotal:j==1/0||isNaN(j)||j===0?0:j,aprPercentage:Po(se/j,2),is_display_rewarder:f.is_display_rewarder};H.value=Y,console.log(H.value,"===>aprPercentageObj.value")}};we(()=>H.value,(f,B)=>{f&&!pe(f)&&(ee.value=f==null?void 0:f.aprFee,te.value=f!=null&&f.rewardAprList[0].rewarder_display?f==null?void 0:f.rewardAprList[0].rewarder_apr:0,s.value=f!=null&&f.rewardAprList[1].rewarder_display?f==null?void 0:f.rewardAprList[1].rewarder_apr:0,r.value=f!=null&&f.rewardAprList[2].rewarder_display?f==null?void 0:f.rewardAprList[2].rewarder_apr:0,console.log(f==null?void 0:f.aprPercentageTotal,"321==>"),(f==null?void 0:f.aprPercentageTotal)==0||isNaN(f==null?void 0:f.aprPercentageTotal)||(f==null?void 0:f.aprPercentageTotal)==1/0?O.value=1e9:O.value=0,!f.is_display_rewarder&&ee.value==0&&(O.value=1e9),f.is_display_rewarder||(te.value=0,s.value=0,r.value=0),setTimeout(()=>{S()},500))},{immediate:!0,deep:!0});const S=()=>{const f=document.getElementById(n.value);if(!f)return;const B=Ko(f);let ie={tooltip:{show:!0,trigger:"axis",axisPointer:{type:"shadow",axis:"auto",snap:!0},renderMode:"html",backgroundColor:"rgba(50,50,50,0.7)",borderColor:"#333",borderWidth:0,padding:5,textStyle:{color:"#fff",fontStyle:"normal",fontWeight:"normal",fontFamily:"sans-serif",fontSize:14},extraCssText:"box-shadow: 0 0 3px rgba(0, 0, 0, 0.3);",confine:!1,formatter:function(Q){return Q[0].name+"的分数是:"+Q[0].data}},title:{text:"",left:"center",top:"center"},series:[{type:"pie",silent:!0,data:[{value:ee.value,name:"A"},{value:te.value,name:"B"},{value:s.value,name:"C"},{value:r.value,name:"D"},{value:O.value,name:"E"}],labelLine:{show:!1},itemStyle:{normal:{color:function(Q){var U=i.value.theme=="default"?["#9EFFC3","#9E65FF","#6C65FF","#D3E97C","#8D8D8D"]:["#65c8ff","#9E65FF","#6C65FF","#D3E97C","#D3E97C"];return U[Q.dataIndex]}}},radius:["74%","100%"]}]};ie&&B.setOption(ie,!0)};we(()=>[e.poolInfo,o.value],([f,B])=>{f&&!pe(f)&&l(f)},{immediate:!0}),console.log(e,"====>props");const L=y(()=>{var B,ie,Q,U;return((B=H==null?void 0:H.value)==null?void 0:B.aprPercentageTotal)>0&&((ie=H==null?void 0:H.value)==null?void 0:ie.aprPercentageTotal)<.01?"<0.01%":((Q=H==null?void 0:H.value)==null?void 0:Q.aprPercentageTotal)>1e4?">10000%":Po((U=H==null?void 0:H.value)==null?void 0:U.aprPercentageTotal,2)+"%"}),w=$([{time:"24H",num:24},{time:"7D",num:7},{time:"30D",num:30}]),u=f=>{o.value=f};return console.log(ee.value,te.value,s.value,r.value,O.value,"====>472"),{lever:c,aprPercentageObj:H,echartsBox:n,aprOne:ee,aprTwo:te,aprThree:s,aprFour:r,aprPercentageTotal:L,aprRewardsDateList:w,aprRewardsParameter:o,aprTab:u,addCommom:V}}});const to=e=>(eo("data-v-81661bea"),e=e(),oo(),e),Qn={class:"lever-apr"},Zn={key:0,class:"lever"},Kn=to(()=>t("div",{class:"leabl"},"Leverage",-1)),Vn={class:"text"},xn={key:0,class:"chart-conetnt-box"},et={class:"chart-conetnt"},ot=["id"],nt=to(()=>t("div",{class:"ratio-bg"},null,-1)),tt={class:"title"},it={class:"left"},at=to(()=>t("span",null," Estimated APR ",-1)),st=to(()=>t("svg",{"aria-hidden":"true",class:"icon"},[t("use",{"xlink:href":"#icon-icon-tips1"})],-1)),lt={class:"right"},rt=["onClick"],ut={class:"apr-text"},dt={key:0,class:"apr-tooltip"},ct={class:"progress-fees progress-all"},vt=to(()=>t("div",{class:"light-hint"},null,-1)),mt={key:1,class:"h5-lever"},ft=to(()=>t("div",{class:"leabl"},"Leverage",-1)),pt={class:"text"};function ht(e,n,a,i,T,I){var c,o,v,p,m,g;const R=Vo;return C(),M("div",Qn,[e.minPrice!=="0"&&e.maxPrice!=="∞"?(C(),M("div",Zn,[Kn,t("div",Vn,D(e.lever),1)])):ve("",!0),t("div",{class:"apr",style:mo(e.minPrice=="0"&&e.maxPrice=="∞"?{width:"100%"}:{})},[e.aprPercentageTotal!=="0.00%"?(C(),M("div",xn,[t("div",et,[t("div",{id:e.echartsBox,class:"chart-box"},null,8,ot),nt]),t("span",null,D(e.aprPercentageTotal),1)])):ve("",!0),t("div",{class:"estimated-apr",style:mo(e.minPrice!=="0"&&e.maxPrice!=="∞"?{width:"100%"}:{})},[t("div",tt,[t("div",it,[at,ce(R,{placement:"bottom","arrow-point-at-center":""},{title:Xe(()=>[t("span",null," Estimated according to trading activity and farming rewards in the past "+D(e.aprRewardsParameter==7?"7 days":e.aprRewardsParameter==24?"24 hours":"30 days")+". Historical data is only a reference. By no means can it guarantee future returns. ",1)]),default:Xe(()=>[st]),_:1})]),t("div",lt,[(C(!0),M(so,null,lo(e.aprRewardsDateList,A=>(C(),M("div",{key:A.num,class:Ke(["apr-item",{"apr-item-active":A.num===e.aprRewardsParameter}]),onClick:H=>e.aprTab(A.num)},D(A.time),11,rt))),128))])]),t("div",ut,[t("span",{class:Ke(e.poolInfo&&e.poolInfo.rewarder_infos&&e.poolInfo.rewarder_infos.length>0?"apr-underline":"")},D(e.aprPercentageTotal),3),e.poolInfo&&e.poolInfo.rewarder_infos&&e.poolInfo.rewarder_infos.length>0?(C(),M("div",dt,[t("div",ct,[vt,Ae(" Fees  "+D((c=e.aprPercentageObj)!=null&&c.aprFee?((o=e.aprPercentageObj)==null?void 0:o.aprFee)>1e4?">10,000":((v=e.aprPercentageObj)==null?void 0:v.aprFee)<.01?"<0.01":("addCommom"in e?e.addCommom:K(V))((p=e.aprPercentageObj)==null?void 0:p.aprFee,2):(m=e.aprPercentageObj)!=null&&m.rewardAprList?"<0.01":"--")+"% ",1)]),(C(!0),M(so,null,lo((g=e.aprPercentageObj)==null?void 0:g.rewardAprList,A=>qe((C(),M("div",{key:A,class:"progress-rewards progress-all"},[t("div",{class:Ke(["light-hint",A==null?void 0:A.styleName])},null,2),Ae(" "+D(A==null?void 0:A.rewarder_name)+" Rewards  "+D(A!=null&&A.rewarder_apr?(A==null?void 0:A.rewarder_apr)>1e4?">10,000":(A==null?void 0:A.rewarder_apr)<.01?"<0.01":("addCommom"in e?e.addCommom:K(V))(A==null?void 0:A.rewarder_apr,2):"0")+"% ",1)])),[[Io,(A==null?void 0:A.rewarder_name)!="--"&&A.rewarder_display&&e.aprPercentageObj.is_display_rewarder]])),128))])):ve("",!0)])],4)],4),e.minPrice!=="0"&&e.maxPrice!=="∞"?(C(),M("div",mt,[ft,t("div",pt,D(e.lever),1)])):ve("",!0)])}const Xo=He(Jn,[["render",ht],["__scopeId","data-v-81661bea"]]),gt=We({components:{StatusBlock:Uo,NewPositionChart:Ho,NewLeverApr:Xo,TokenWarning:go},setup(e){const n=$(),a=$(),i=y(()=>{var s,r;return(r=(s=p.value)==null?void 0:s.poolInfo)==null?void 0:r.needReverse}),T=Fe(),I=y(()=>T),R=y(()=>I.value.theme),c=y(()=>I.value.chainName),o=Ve(),v=y(()=>o),p=$({}),m=po();we(()=>[v.value.currentPositionInfo,c.value],([s,r])=>{var O;r=="Aptos"&&s?(p.value=s,n.value=p.value.token_a,a.value=p.value.token_b):r=="Sui"&&s&&(s==null?void 0:s.nftHash)==((O=m==null?void 0:m.query)==null?void 0:O.pos)&&(console.log(s,"==>newVal"),p.value=s,n.value=p.value.token_a,a.value=p.value.token_b)},{immediate:!0});const g=s=>{var r;return(s==null?void 0:s.logoURI)||(s==null?void 0:s.logo_url)||((r=v.value.tokensObj[s==null?void 0:s.address])==null?void 0:r.logo_url)||(R.value==="default"?ro("/image/coins/unknown.png"):ro("/image/coins/sui-unknown.png"))},A=y(()=>c.value?no(c.value):{}),H=$([]),ee=async s=>{console.log(s,"===>positionInfo.value.poolInfo");const r=await A.value.getTicks(s),O=r?A.value.getTickDataFromUrlData(r):[];console.log(O,"list===>"),H.value=O};we(()=>[p.value,v.value.poolsObj],([s,r])=>{console.log(s,!pe(s),"177111"),s&&!pe(s)&&s.poolInfo&&r&&!pe(r)&&(console.log(s,r,"==>poolConfigObj"),ee(r[s.poolAddress]))},{immediate:!0});const te=$(!0);return console.log(p.value,"188---------->"),{needReverse:i,getCoinIcon:g,theme:R,indexStore:T,direct:te,addCommom:V,decimalUi:ye,tickList:H,positionInfo:p,fromCoin:n,toCoin:a,getExplorerUrl:yo}}}),bt=""+globalThis.__publicAssetsURL("image/aptos-price.png"),kt=""+globalThis.__publicAssetsURL("sui-image/sui-price.png"),_t=""+globalThis.__publicAssetsURL("image/icon-arrow@2x.png"),yt=""+globalThis.__publicAssetsURL("sui-image/icon-arrow@2x.png");const Je=e=>(eo("data-v-dafc0960"),e=e(),oo(),e),wt={class:"new-position-info"},At={class:"pool-info"},Ct={class:"left"},It={class:"coin-a"},$t={alt:""},St={class:"coin-b"},Pt={alt:""},Tt={class:"position-name"},Nt=["href"],Rt=Je(()=>t("use",{"xlink:href":"#icon-icon-copy1"},null,-1)),Ot=[Rt],Lt={key:0,class:"pool-fee"},qt=Je(()=>t("span",null,"Fee tier",-1)),Mt={class:"right"},Bt={class:"h5-pool-info"},Ut={class:"coin-info"},jt={class:"coin-a"},Et={alt:""},Dt={class:"coin-b"},Ft={alt:""},Wt={class:"position-name"},Ht=["href"],Xt=Je(()=>t("use",{"xlink:href":"#icon-icon-copy1"},null,-1)),zt=[Xt],Gt={key:0,class:"pool-fee"},Yt={class:"price-info"},Jt={class:"price-and-chart"},Qt={class:"left"},Zt={class:"current-price"},Kt=Je(()=>t("span",null,"Current Price",-1)),Vt={class:"coin-rate"},xt=Je(()=>t("div",null,[t("svg",{class:"icon icon-up","aria-hidden":"true"},[t("use",{"xlink:href":"#icon-exchange_up1"})])],-1)),ei=Je(()=>t("div",null,[t("svg",{class:"icon icon-down","aria-hidden":"true"},[t("use",{"xlink:href":"#icon-exchange_down1"})])],-1)),oi=[xt,ei],ni={key:0},ti={key:1},ii={key:0,class:"position-range"},ai=Je(()=>t("div",{class:"position-range-title"}," Position Range ",-1)),si={key:0},li={key:1},ri={key:2,src:bt,alt:""},ui={key:3,src:kt,alt:""},di={key:4},ci={key:5},vi={key:1,class:"position-range position-range-warp"},mi={key:0,class:"position-range-title"},fi={key:1,class:"position-range-title"},pi={key:2},hi={key:3},gi={class:"price-img"},bi={key:0,src:_t,alt:""},ki={key:1,src:yt,alt:""},_i={key:4},yi={key:5},wi={class:"right"},Ai=Je(()=>t("div",{class:"chat-mask"},null,-1));function Ci(e,n,a,i,T,I){var m,g,A,H,ee,te,s,r,O,l,S,L,w,u,f,B,ie,Q,U,G,Z,ne,ae,oe,le,x,he,F,fe,ke;const R=go,c=Uo,o=Ho,v=Xo,p=qo("image");return C(),M("div",wt,[t("div",At,[t("div",Ct,[t("div",It,[qe(t("img",$t,null,512),[[p,e.needReverse?e.getCoinIcon(e.positionInfo.token_b):e.getCoinIcon(e.positionInfo.token_a)]]),ce(R,{address:e.needReverse?(H=(A=e.positionInfo)==null?void 0:A.token_b)==null?void 0:H.address:(g=(m=e.positionInfo)==null?void 0:m.token_a)==null?void 0:g.address,"style-params":{width:"12px",height:"12px",left:"18px",bottom:"4px"}},null,8,["address"])]),t("div",St,[qe(t("img",Pt,null,512),[[p,e.needReverse?e.getCoinIcon(e.positionInfo.token_a):e.getCoinIcon(e.positionInfo.token_b)]]),ce(R,{address:e.needReverse?(r=(s=e.positionInfo)==null?void 0:s.token_a)==null?void 0:r.address:(te=(ee=e.positionInfo)==null?void 0:ee.token_b)==null?void 0:te.address,"style-params":{width:"12px",height:"12px",left:"18px",bottom:"4px"}},null,8,["address"])]),t("div",Tt,[t("a",{href:("getExplorerUrl"in e?e.getExplorerUrl:K(yo))("nftAddress",e.positionInfo.nftHash),target:"_blank"},D((l=(O=e.positionInfo)==null?void 0:O.name)==null?void 0:l.split("|")[1]),9,Nt)]),(C(),M("svg",{class:"copy-icon","aria-hidden":"true",onClick:n[0]||(n[0]=Ne=>e.indexStore.copy(e.positionInfo.nftHash))},Ot)),e.positionInfo.fee?(C(),M("div",Lt,[qt,Ae(" "+D(e.positionInfo.fee*100)+"% ",1)])):ve("",!0)]),t("div",Mt,[ce(c,{"current-status":(S=e.positionInfo)==null?void 0:S.currentStatus},null,8,["current-status"])])]),t("div",Bt,[t("div",null,[t("div",Ut,[t("div",jt,[qe(t("img",Et,null,512),[[p,e.needReverse?e.getCoinIcon(e.positionInfo.token_b):e.getCoinIcon(e.positionInfo.token_a)]]),ce(R,{address:e.needReverse?(f=(u=e.positionInfo)==null?void 0:u.token_b)==null?void 0:f.address:(w=(L=e.positionInfo)==null?void 0:L.token_a)==null?void 0:w.address,"style-params":{width:"12px",height:"12px",left:"18px",bottom:"4px"}},null,8,["address"])]),t("div",Dt,[qe(t("img",Ft,null,512),[[p,e.needReverse?e.getCoinIcon(e.positionInfo.token_a):e.getCoinIcon(e.positionInfo.token_b)]]),ce(R,{address:e.needReverse?(U=(Q=e.positionInfo)==null?void 0:Q.token_a)==null?void 0:U.address:(ie=(B=e.positionInfo)==null?void 0:B.token_b)==null?void 0:ie.address,"style-params":{width:"12px",height:"12px",left:"18px",bottom:"4px"}},null,8,["address"])])]),t("div",Wt,[t("div",null,[t("a",{href:("getExplorerUrl"in e?e.getExplorerUrl:K(yo))("nftAddress",e.positionInfo.nftHash),target:"_blank"},D((Z=(G=e.positionInfo)==null?void 0:G.name)==null?void 0:Z.split("|")[1]),9,Ht),(C(),M("svg",{class:"copy-icon","aria-hidden":"true",onClick:n[1]||(n[1]=Ne=>e.indexStore.copy(e.positionInfo.nftHash))},zt))]),e.positionInfo.fee?(C(),M("div",Gt,D(e.positionInfo.fee*100)+"%",1)):ve("",!0)])]),ce(c,{"current-status":(ne=e.positionInfo)==null?void 0:ne.currentStatus},null,8,["current-status"])]),t("div",Yt,[t("div",Jt,[t("div",Qt,[t("div",Zt,[t("div",null,[Kt,t("div",Vt,[t("div",{onClick:n[2]||(n[2]=Ne=>e.direct=!e.direct)},oi)])]),(e.needReverse?!e.direct:e.direct)?(C(),M("div",ni,[Ae(D(("addCommom"in e?e.addCommom:K(V))(("decimalUi"in e?e.decimalUi:K(ye))(e.positionInfo.currentPrice,6)))+"   ",1),t("span",null,D((ae=e.toCoin)==null?void 0:ae.symbol)+" per "+D((oe=e.fromCoin)==null?void 0:oe.symbol),1)])):(C(),M("div",ti,[Ae(D(("addCommom"in e?e.addCommom:K(V))(("decimalUi"in e?e.decimalUi:K(ye))(1/e.positionInfo.currentPrice,6)))+"   ",1),t("span",null,D((le=e.fromCoin)==null?void 0:le.symbol)+" per "+D((x=e.toCoin)==null?void 0:x.symbol),1)]))]),e.positionInfo.minPrice&&e.positionInfo.minPrice.length<9&&e.positionInfo.maxPrice&&e.positionInfo.maxPrice.length?(C(),M("div",ii,[ai,t("div",null,[(e.needReverse?!e.direct:e.direct)?(C(),M("div",si,[Ae(D(("addCommom"in e?e.addCommom:K(V))(("decimalUi"in e?e.decimalUi:K(ye))(e.positionInfo.minPrice,6)))+" ",1),t("span",null,D(e.positionInfo&&e.positionInfo.token_b&&e.positionInfo.token_b.symbol),1)])):(C(),M("div",li,[Ae(D(((he=e.positionInfo)==null?void 0:he.minPrice)!=="0"?("addCommom"in e?e.addCommom:K(V))(("decimalUi"in e?e.decimalUi:K(ye))(1/e.positionInfo.minPrice,6)):0)+" ",1),t("span",null,D(e.positionInfo&&e.positionInfo.token_a&&e.positionInfo.token_a.symbol),1)])),e.theme=="default"?(C(),M("img",ri)):(C(),M("img",ui)),(e.needReverse?!e.direct:e.direct)?(C(),M("div",di,[Ae(D(((F=e.positionInfo)==null?void 0:F.maxPrice)!=="∞"?("addCommom"in e?e.addCommom:K(V))(("decimalUi"in e?e.decimalUi:K(ye))(e.positionInfo.maxPrice,6)):"∞")+" ",1),t("span",null,D(e.positionInfo&&e.positionInfo.token_b&&e.positionInfo.token_b.symbol),1)])):(C(),M("div",ci,[Ae(D(((fe=e.positionInfo)==null?void 0:fe.maxPrice)!=="∞"?("addCommom"in e?e.addCommom:K(V))(("decimalUi"in e?e.decimalUi:K(ye))(1/e.positionInfo.maxPrice,6)):"∞")+" ",1),t("span",null,D(e.positionInfo&&e.positionInfo.token_a&&e.positionInfo.token_a.symbol),1)]))])])):(C(),M("div",vi,[(e.needReverse?!e.direct:e.direct)?(C(),M("span",mi," Position Range ")):(C(),M("span",fi," Position Range ")),(e.needReverse?!e.direct:e.direct)?(C(),M("div",pi,[Ae(D(("addCommom"in e?e.addCommom:K(V))(("decimalUi"in e?e.decimalUi:K(ye))(e.positionInfo.minPrice,6)))+" ",1),t("span",null,D(e.positionInfo&&e.positionInfo.token_b&&e.positionInfo.token_b.symbol),1)])):(C(),M("div",hi,[Ae(D(e.positionInfo.maxPrice!=="∞"?("addCommom"in e?e.addCommom:K(V))(("decimalUi"in e?e.decimalUi:K(ye))(1/e.positionInfo.maxPrice,6)):"∞")+" ",1),t("span",null,D(e.positionInfo&&e.positionInfo.token_a&&e.positionInfo.token_a.symbol),1)])),t("div",gi,[e.theme=="default"?(C(),M("img",bi)):(C(),M("img",ki))]),(e.needReverse?!e.direct:e.direct)?(C(),M("div",_i,[Ae(D(e.positionInfo.maxPrice!=="∞"?("addCommom"in e?e.addCommom:K(V))(("decimalUi"in e?e.decimalUi:K(ye))(e.positionInfo.maxPrice,6)):"∞")+" ",1),t("span",null,D(e.positionInfo&&e.positionInfo.token_b&&e.positionInfo.token_b.symbol),1)])):(C(),M("div",yi,[Ae(D(((ke=e.positionInfo)==null?void 0:ke.minPrice)!=="0"?("addCommom"in e?e.addCommom:K(V))(("decimalUi"in e?e.decimalUi:K(ye))(1/e.positionInfo.minPrice,6)):0)+" ",1),t("span",null,D(e.positionInfo&&e.positionInfo.token_a&&e.positionInfo.token_a.symbol),1),Ae("   ")]))]))]),t("div",wi,[ce(o,{"pool-info":e.positionInfo.poolInfo,"tick-list":e.tickList,"min-price":e.positionInfo.minPrice,"max-price":e.positionInfo.maxPrice,direction:!0,"current-price-tab":"custom","chart-loading":!1},null,8,["pool-info","tick-list","min-price","max-price"]),Ai])]),ce(v,{"min-price":e.positionInfo.minPrice,"max-price":e.positionInfo.maxPrice,"pool-info":e.positionInfo.poolInfo,"from-coin":e.fromCoin,"to-coin":e.toCoin},null,8,["min-price","max-price","pool-info","from-coin","to-coin"])])])}const zo=He(gt,[["render",Ci],["__scopeId","data-v-dafc0960"]]),Ii=We({components:{TokenWarning:go},setup(e,n){const{t:a}=$o(),{$notify:i}=xo(),T=Fe(),I=y(()=>T),R=Ve(),c=y(()=>R),o=$({}),v=$({}),p=$({}),m=y(()=>I.value.chainName),g=y(()=>m.value?no(m.value):{}),A=po(),H=$(!1),ee=async(d=null)=>{const h=d||o.value;console.log(h,"===>posInfo");const P=c.value.addressLpTokens[h.poolAddress];if(P){const _=await g.value.getTickDataByIndex(P.ticks_handle,Number(h.tick_lower_index)),W=await g.value.getTickDataByIndex(P.ticks_handle,Number(h.tick_upper_index));let X={};m.value==="Aptos"?X=await g.value.getPosRewardersAmount({poolAddress:L.currentRoute.value.query.address,positionName:L.currentRoute.value.query.token,tickLowerData:_,tickUpperData:W}):X=await g.value.fetchPosRewardersAmount({poolAddress:h.poolAddress,positionId:h.pos_object_id,coinTypeA:h.coin_type_a,coinTypeB:h.coin_type_b,rewarderInfo:h.poolInfo.rewarder_infos});const E=[];let z=new k(0);X.forEach((J,re)=>{var N,j;const se=(N=c.value.tokensObj[J.coin_address])==null?void 0:N.decimals,me=J.amount_owed.toString();let ge=new k(me).div(Math.pow(10,se)).toString();if(m.value=="Aptos"&&Number(ge)>999999999&&(ge="0"),h.poolInfo[`rewarder_display${re+1}`]||Number(ge)>0){const ue=c.value.tokensObj[J.coin_address],_e=((j=c.value.RATES[J.coin_address])==null?void 0:j.price)||0,b=new k(ge).mul(_e).toString();z=new k(z).plus(b),E.push({...J,...ue,amount:Number(ge)>0?Te(ge,se):0,amountUSD:Number(b)>0?Te(b,2):0,amountUSDText:b})}}),w.value=E,console.log(E,"====>result722")}};we(()=>[c.value.currentPositionInfo,m.value],([d,h])=>{var P;h=="Aptos"&&d?(o.value=d,v.value=d==null?void 0:d.token_a,p.value=d==null?void 0:d.token_b):h=="Sui"&&d&&(d==null?void 0:d.nftHash)==((P=A==null?void 0:A.query)==null?void 0:P.pos)&&(console.log(d,"==>newVal"),o.value=d,v.value=d==null?void 0:d.token_a,p.value=d==null?void 0:d.token_b,H.value=!1)},{immediate:!0}),we(()=>[o.value,c.value.addressLpTokens],([d,h])=>{!pe(d)&&!pe(h)&&ee(d)},{immediate:!0});const te=y(()=>{var d,h,P,_,W,X,E,z;if(o.value&&!pe(o.value)&&c.value.RATES){const J=o.value.amountA*((h=c.value.RATES[(d=o.value)==null?void 0:d.token_a.address])==null?void 0:h.price),re=o.value.amountB*((_=c.value.RATES[(P=o.value)==null?void 0:P.token_b.address])==null?void 0:_.price);if((X=c.value.RATES[(W=o.value)==null?void 0:W.token_a.address])!=null&&X.price&&((z=c.value.RATES[(E=o.value)==null?void 0:E.token_b.address])!=null&&z.price)){const se=Number(J+re);return se>0&&se<.01?"<0.01":V(Ee(J+re,2),2)}else return" --"}else return" --"}),s=y(()=>{var d,h,P,_;return console.log((h=(d=o.value)==null?void 0:d.poolInfo)==null?void 0:h.needReverse,"===>positionInfo.value?.poolInfo?.needReverse"),(_=(P=o.value)==null?void 0:P.poolInfo)==null?void 0:_.needReverse}),r=y(()=>c.value.RATES),O=y(()=>{var d,h;if(r.value&&v.value&&p.value&&!pe(r.value)&&!pe(v.value)&&!pe(p.value)){const P=[],_=Number(o.value.feeOwedA)||0,W=Number(o.value.feeOwedB)||0;console.log(_,W,"===292"),console.log(r.value,v.value.address,"===293"),console.log(r.value[v.value.address],"===>RATES.value[fromCoin.value.address]"),console.log(r.value[p.value.address],"===>RATES.value[toCoin.value.address]");const X=new k(_).mul(((d=r.value[v.value.address])==null?void 0:d.price)||0),E=new k(W).mul(((h=r.value[p.value.address])==null?void 0:h.price)||0);return console.log(X.toString(),E.toString(),"====>292"),P.push({amount:_,amountUSD:X.toString()},{amount:W,amountUSD:E.toString()}),P}return[]}),l=y(()=>{var h,P;let d=new k(0);return(h=O.value)==null||h.forEach(_=>{d=d.add(new k(_.amountUSD))}),m.value=="Sui"&&((P=w.value)==null||P.forEach(_=>{d=d.add(new k(_.amountUSDText))})),console.log(O.value,w.value,"===>pendingRewarderArr.value"),d.toNumber()}),S=y(()=>{var h;let d=new k(0);return(h=w.value)==null||h.forEach(P=>{d=d.add(new k(P.amountUSDText))}),d.toNumber()}),L=uo(),w=$([]),{setIsShowSuccess:u,setIsShowRejected:f,setIsShowWaiting:B,setTransactionDesc:ie,setTransactionTxid:Q}=T,U=fo(),G=y(()=>U),Z=async()=>{H.value=!0;let d={coinTypeA:o.value.poolInfo.coinTypeA,coinTypeB:o.value.poolInfo.coinTypeB,coinTypeC:"",coinTypeD:"",coinTypeE:"",pool_address:o.value.poolAddress,pos_index:o.value.index,rewarder_nums:w.value.length,collect_fee:!0};d.coinTypeC=w.value[0]?w.value[0].coin_address:"",d.coinTypeD=w.value[1]?w.value[1].coin_address:"",d.coinTypeE=w.value[2]?w.value[2].coin_address:"",B(!0),ie();try{let h;if(m.value==="Aptos"){const P=await g.value.getCollectRewarderTransactionPayload(d);h=await G.value.currentWallet.signAndSubmitTransaction(P)}else{d.pos_index=o.value.pos_object_id;const P=await g.value.getCollectRewarderTransactionPayload(d),_=await G.value.currentWallet.signAndExecuteTransactionBlock(P);h=g.value.handleTx(_)}if(h&&h.hash){Q(h.hash),B(!1),u(!0);const P={title:"Claim",desc:"",hash:h.hash,tit:"Rewards Claimed",icon:"icon-icon-Removed"};m.value!=="Aptos"&&(P.res=h.res),g.value.showTransitionPending(P);const _=await g.value.watchTransaction(P);console.log("0310###toClaimRewards###transitionStatus###",_),_&&n.emit("getDetails")}else console.log("0310###toClaimRewards###else###"),B(!1),f(!0),H.value=!1}catch(h){B(!1),f(!0),H.value=!1,console.log(h,"error===>")}},ne=$(!1),ae=async()=>{console.log("0310###toClaimRewards##start###",o.value),ne.value=!0;const d=w.value;let h={coinTypeA:o.value.poolInfo.coinTypeA,coinTypeB:o.value.poolInfo.coinTypeB,coinTypeC:"",coinTypeD:"",coinTypeE:"",pool_address:o.value.poolAddress,pos_index:o.value.index,rewarder_nums:d.length};h.coinTypeC=d[0]?d[0].coin_address:"",h.coinTypeD=d[1]?d[1].coin_address:"",h.coinTypeE=d[2]?d[2].coin_address:"",console.log(h,"===>collectRewarderParams");try{let P;if(m.value==="Aptos"){const _=await g.value.getCollectRewarderTransactionPayload(h);P=await G.value.currentWallet.signAndSubmitTransaction(_)}else{h.pos_index=o.value.pos_object_id;const _=await g.value.getCollectRewarderTransactionPayload(h),W=await G.value.currentWallet.signAndExecuteTransactionBlock(_);P=g.value.handleTx(W)}if(console.log("0310###toClaimRewards##tx###",P),P&&P.hash){Q(P.hash),B(!1),u(!0);const _=d[0].amount+d[0].symbol,W=h.coinTypeD?" and "+d[1].amount+d[1].symbol:"",X=h.coinTypeE?" and "+d[2].amount+d[2].symbol:"",E={title:"Claim",desc:"",hash:P.hash,tit:"Rewards Claimed",icon:"icon-icon-Removed",tokenInfo:{tokena:d[0].address,numa:`+ ${Number(d[0].amount)}`,logoa:c.value.tokensObj&&d[0]&&d[0].address&&c.value.tokensObj[d[0].address]&&c.value.tokensObj[d[0].address].logoURI,tokenb:d[1]&&d[1].address,numb:h.coinTypeD?`+ ${Number(d[1].amount)}`:"",logob:h.coinTypeD?c.value.tokensObj&&d[1]&&d[1].address&&c.value.tokensObj[d[1].address]&&c.value.tokensObj[d[1].address].logoURI:"",tokenc:d[2]&&d[2].address,numc:h.coinTypeE?`+ ${Number(d[2].amount)}`:"",logoc:h.coinTypeE?c.value.tokensObj&&d[2]&&d[2].address&&c.value.tokensObj[d[2].address]&&c.value.tokensObj[d[2].address].logoURI:""},text:_+W+X};m.value!=="Aptos"&&(E.res=P.res),g.value.showTransitionPending(E);const z=await g.value.watchTransaction(E);console.log("0310###toClaimRewards###transitionStatus###",z),z&&setTimeout(()=>{n.emit("getDetails"),g.value.getAccount(G.value.address)},3e3)}else console.log("0310###toClaimRewards###else###"),B(!1),f(!0);ne.value=!1}catch(P){console.log("0310###collectRewarderParams Error###",P),ne.value=!1,B(!1),f(!0)}},oe=y(()=>c.value.positionDetailCurrentTab),le=y(()=>{var P,_,W,X,E,z;const d=ye(s.value?(_=o.value)==null?void 0:_.amountB:(P=o.value)==null?void 0:P.amountA,s.value?(z=(E=o.value)==null?void 0:E.token_b)==null?void 0:z.decimals:(X=(W=o.value)==null?void 0:W.token_a)==null?void 0:X.decimals),h=s.value?c.value.positionActionAmount.toCoinAmount||0:c.value.positionActionAmount.fromCoinAmount||0;if(oe.value=="increase")return h?new k(d).add(new k(h)).toString():"";if(h){const J=new k(d).minus(new k(h)).toString();return J<0?"0":String(J)}else return""}),x=y(()=>{var P,_,W,X,E,z;const d=ye(s.value?(_=o.value)==null?void 0:_.amountA:(P=o.value)==null?void 0:P.amountB,s.value?(z=(E=o.value)==null?void 0:E.token_a)==null?void 0:z.decimals:(X=(W=o.value)==null?void 0:W.token_b)==null?void 0:X.decimals),h=s.value?c.value.positionActionAmount.fromCoinAmount||0:c.value.positionActionAmount.toCoinAmount||0;if(console.log(d,h,"===>427"),oe.value=="increase")return h?new k(d).add(new k(h)).toString():"";if(h){const J=new k(d).minus(new k(h)).toString();return J<0?"0":String(J)}else return""}),he=y(()=>s.value?c.value.positionActionAmount.toCoinAmount:c.value.positionActionAmount.fromCoinAmount),F=y(()=>s.value?c.value.positionActionAmount.fromCoinAmount:c.value.positionActionAmount.toCoinAmount),fe=d=>{var h;return(d==null?void 0:d.logoURI)||(d==null?void 0:d.logo_url)||((h=c.value.tokensObj[d==null?void 0:d.address])==null?void 0:h.logo_url)||(I.value.theme==="default"?ro("/image/coins/unknown.png"):ro("/image/coins/sui-unknown.png"))},ke=y(()=>{var X,E,z,J,re,se,me,ge,N,j,ue,_e;const{fromCoinAmount:d,toCoinAmount:h}=c.value.positionActionAmount,P=c.value.positionDetailCurrentTab,_=ye(s.value?(E=o.value)==null?void 0:E.amountB:(X=o.value)==null?void 0:X.amountA,s.value?(se=(re=o.value)==null?void 0:re.token_b)==null?void 0:se.decimals:(J=(z=o.value)==null?void 0:z.token_a)==null?void 0:J.decimals),W=ye(s.value?(ge=o.value)==null?void 0:ge.amountA:(me=o.value)==null?void 0:me.amountB,s.value?(_e=(ue=o.value)==null?void 0:ue.token_a)==null?void 0:_e.decimals:(j=(N=o.value)==null?void 0:N.token_b)==null?void 0:j.decimals);return console.log(_,W,d,h,"621===>"),m.value=="Sui"||P=="remove"&&m.value=="Aptos"&&d==_&&h==W});return{amountUSD:te,needReverse:s,decimalUi:ye,pendingFees:O,positionInfo:o,pendingRewarderArr:w,pendingYieldAmount:l,toClaim:async()=>{H.value=!0;const d=V(o.value.feeOwedA,o.value.token_a.decimals)==0?"":`${Te(o.value.feeOwedA,o.value.token_a.decimals)} ${o.value.token_a.symbol}`,h=V(o.value.feeOwedB,o.value.token_b.decimals)==0?"":`${Te(o.value.feeOwedB,o.value.token_b.decimals)} ${o.value.token_b.symbol}`;ie(a("newAdd.claimWaitingText",{from:s.value?h:d,and:V(o.value.feeOwedA,o.value.token_a.decimals)==0||V(o.value.feeOwedB,o.value.token_b.decimals)==0?"":"and",to:s.value?d:h})),B(!0);let P;const _={pool:o.value.poolInfo,position:o.value};try{const W=await g.value.getCollectFeeTransactionPayload(_);if(m.value==="Aptos")P=await G.value.currentWallet.signAndSubmitTransaction(W);else{const X=await G.value.currentWallet.signAndExecuteTransactionBlock(W);P=g.value.handleTx(X)}if(P){Q(P.hash),B(!1),u(!0);const X={title:"Claim",desc:"",hash:P.hash,tit:"Fees Claimed",icon:"icon-icon-Removed",tokenInfo:{tokena:`${o.value.token_a.address}`,numa:V(o.value.feeOwedA,o.value.token_a.decimals)==0?"":`${Te(o.value.feeOwedA,o.value.token_a.decimals)}`,logoa:V(o.value.feeOwedA,o.value.token_a.decimals)==0?"":c.value.tokensObj&&o.value&&o.value.token_a.address&&c.value.tokensObj[o.value.token_a.address]&&c.value.tokensObj[o.value.token_a.address].logoURI,tokenb:`${o.value.token_b.address}`,numb:V(o.value.feeOwedB,o.value.token_b.decimals)==0?"":`${Te(o.value.feeOwedB,o.value.token_b.decimals)}`,logob:V(o.value.feeOwedB,o.value.token_b.decimals)==0?"":c.value.tokensObj&&o.value&&o.value.token_b.address&&c.value.tokensObj[o.value.token_b.address]&&c.value.tokensObj[o.value.token_b.address].logoURI},text:`Claim ${V(o.value.feeOwedA,o.value.token_a.decimals)==0?"":`${Te(o.value.feeOwedA,o.value.token_a.decimals)} ${o.value.token_a.symbol}`}  
              ${V(o.value.feeOwedA,o.value.token_a.decimals)==0||V(o.value.feeOwedB,o.value.token_b.decimals)==0?"":"and"} ${V(o.value.feeOwedB,o.value.token_b.decimals)==0?"":`${Te(o.value.feeOwedB,o.value.token_b.decimals)} ${o.value.token_b.symbol}`}

            `};m.value!=="Aptos"&&(X.res=P.res),g.value.showTransitionPending(X);const E=await g.value.watchTransaction(X);console.log("0310##toClaim###transitionStatus####",E),E&&setTimeout(()=>{n.emit("getDetails")},1e3)}else B(!1),f(!0),i.error({icon:Ye("svg",{class:{icon:!0},"aria-hidden":!0},[Ye("use",{"xlink:href":"#icon-a-icon-Shutdown"})]),duration:4.5,message:Ye("div",{class:"notification-title"},[Ye("span",{innerHTML:So.global.t("newAdd.claimFailed")},null)]),description:a("newAdd.somethingWrong"),class:"ant-notification-copy ant-notification-error"});H.value=!1,console.log("claim####test###",P)}catch(W){console.log("claim###error####",W),H.value=!1,B(!1),f(!0),i.error({icon:Ye("svg",{class:{icon:!0},"aria-hidden":!0},[Ye("use",{"xlink:href":"#icon-a-icon-Shutdown"})]),message:Ye("div",{class:"notification-title"},[Ye("span",{innerHTML:So.global.t("newAdd.claimFailed")},null)]),duration:4.5,description:a("newAdd.somethingWrong"),class:"ant-notification-copy ant-notification-error"})}},claimAll:Z,fromCoin:v,toCoin:p,showNum:Te,claimLoading:H,addCommom:V,afterBase:le,afterQuote:x,fromCoinAmount:he,toCoinAmount:F,checkNullObj:pe,getCoinIcon:fe,chainName:m,isShowAfterAmount:ke,pendingRewarderAmount:S,toClaimRewards:ae,rewarderLoading:ne}}});const $i={class:"liquidity-card"},Si={class:"liquidity-title"},Pi={class:"liquidity-usd"},Ti=t("span",null,"Liquidity",-1),Ni={class:"liquidity-ratio"},Ri={class:"coin-ratio"},Oi={class:"coin-a-ratio"},Li={class:"coin-b-ratio"},qi={class:"ratio-progress"},Mi={class:"base-quote-num"},Bi={class:"base-coin-num"},Ui=t("span",null,"Base",-1),ji={alt:""},Ei={key:0,class:"after"},Di={class:"quote-coin-num"},Fi=t("span",null,"Quote",-1),Wi={alt:""},Hi={key:0,class:"after"},Xi={class:"pending-yield"},zi={class:"left"},Gi={class:"pending-yield-title"},Yi={key:0,class:"after"},Ji={class:"right"},Qi={class:"fees-rewards"},Zi={class:"fees-rewards-item"},Ki=t("span",null,"Fees",-1),Vi={key:0,class:"after"},xi=t("span",null,"Fees",-1),ea={key:0,class:"after"},oa=t("span",null,"Bonus",-1),na={alt:""},ta={key:0,class:"after"},ia={key:0,class:"pending-yield"},aa={class:"left"},sa=t("div",{class:"pending-yield-title"},"Pending rewards",-1),la={key:0,class:"after"},ra={class:"right"},ua={key:1,class:"fees-rewards"},da={class:"fees-rewards-item"},ca=t("span",null,"Bonus",-1),va={alt:""},ma={key:0,class:"after"};function fa(e,n,a,i,T,I){var v,p,m,g,A,H,ee,te,s,r,O,l,S,L,w,u,f,B,ie,Q,U,G,Z,ne,ae,oe,le,x,he,F,fe,ke,Ne,d,h,P,_,W,X,E,z,J,re,se,me,ge,N,j,ue,_e,b,Y,q,de,be,$e,Re,Ce,Pe,Be,Ue,ze,Oe,je;const R=go,c=ho,o=qo("image");return C(),M("div",$i,[t("div",Si,[t("div",Pi,[Ti,t("div",null,"$"+D(e.amountUSD),1)]),t("div",Ni,[t("div",Ri,[t("div",Oi,[t("span",null,D(e.needReverse?(p=e.toCoin)==null?void 0:p.symbol:(v=e.fromCoin)==null?void 0:v.symbol),1),Ae(" "+D(e.needReverse?(g=e.positionInfo)==null?void 0:g.toPercent:(m=e.positionInfo)==null?void 0:m.fromPercent)+"% ",1)]),t("div",Li,[t("span",null,D(e.needReverse?(H=e.fromCoin)==null?void 0:H.symbol:(A=e.toCoin)==null?void 0:A.symbol),1),Ae(" "+D(e.needReverse?(te=e.positionInfo)==null?void 0:te.fromPercent:(ee=e.positionInfo)==null?void 0:ee.toPercent)+"% ",1)])]),t("div",qi,[t("div",{class:"from-percent",style:mo({width:e.needReverse?((r=e.positionInfo)==null?void 0:r.toPercent)+"%":((s=e.positionInfo)==null?void 0:s.fromPercent)+"%"})},null,4),t("div",{class:"to-percent",style:mo({width:e.needReverse?((l=e.positionInfo)==null?void 0:l.fromPercent)+"%":((O=e.positionInfo)==null?void 0:O.toPercent)+"%"})},null,4)])])]),t("div",Mi,[t("div",Bi,[Ui,t("div",null,[qe(t("img",ji,null,512),[[o,(e.needReverse?(L=e.toCoin)==null?void 0:L.logo_url:(S=e.fromCoin)==null?void 0:S.logo_url)||e.getCoinIcon(e.needReverse?(u=e.positionInfo)==null?void 0:u.token_b:(w=e.positionInfo)==null?void 0:w.token_a)]]),ce(R,{address:e.needReverse?(Q=(ie=e.positionInfo)==null?void 0:ie.token_b)==null?void 0:Q.address:(B=(f=e.positionInfo)==null?void 0:f.token_a)==null?void 0:B.address,"style-params":{width:"10px",height:"10px",left:"15px",bottom:"8px"}},null,8,["address"]),t("span",null,D(("addCommom"in e?e.addCommom:K(V))(("decimalUi"in e?e.decimalUi:K(ye))(e.needReverse?(G=e.positionInfo)==null?void 0:G.amountB:(U=e.positionInfo)==null?void 0:U.amountA,e.needReverse?(oe=(ae=e.positionInfo)==null?void 0:ae.token_b)==null?void 0:oe.decimals:(ne=(Z=e.positionInfo)==null?void 0:Z.token_a)==null?void 0:ne.decimals))),1)]),e.afterBase&&!("checkNullObj"in e?e.checkNullObj:K(pe))(e.positionInfo)?(C(),M("div",Ei,D(("addCommom"in e?e.addCommom:K(V))(e.afterBase))+" after ",1)):ve("",!0)]),t("div",Di,[Fi,t("div",null,[qe(t("img",Wi,null,512),[[o,(e.needReverse?(x=e.fromCoin)==null?void 0:x.logo_url:(le=e.toCoin)==null?void 0:le.logo_url)||e.getCoinIcon(e.needReverse?(F=e.positionInfo)==null?void 0:F.token_a:(he=e.positionInfo)==null?void 0:he.token_b)]]),ce(R,{address:e.needReverse?(d=(Ne=e.positionInfo)==null?void 0:Ne.token_a)==null?void 0:d.address:(ke=(fe=e.positionInfo)==null?void 0:fe.token_b)==null?void 0:ke.address,"style-params":{width:"10px",height:"10px",left:"15px",bottom:"8px"}},null,8,["address"]),t("span",null,D(("addCommom"in e?e.addCommom:K(V))(("decimalUi"in e?e.decimalUi:K(ye))(e.needReverse?(P=e.positionInfo)==null?void 0:P.amountA:(h=e.positionInfo)==null?void 0:h.amountB,e.needReverse?(E=(X=e.positionInfo)==null?void 0:X.token_a)==null?void 0:E.decimals:(W=(_=e.positionInfo)==null?void 0:_.token_b)==null?void 0:W.decimals))),1)]),e.afterQuote&&!("checkNullObj"in e?e.checkNullObj:K(pe))(e.positionInfo)?(C(),M("div",Hi,D(("addCommom"in e?e.addCommom:K(V))(e.afterQuote))+" after ",1)):ve("",!0)])]),t("div",Xi,[t("div",zi,[t("div",Gi,D(e.chainName=="Sui"?"Pending Yield":"Pending fees"),1),t("div",null,[Ae(" $"+D(e.pendingYieldAmount>0&&e.pendingYieldAmount<.01?"<0.01":("addCommom"in e?e.addCommom:K(V))(e.pendingYieldAmount,2))+" ",1),e.pendingYieldAmount>0?(C(),M("span",Yi,"$0 after")):ve("",!0)])]),t("div",Ji,[ce(c,{class:"claim-all",loading:e.claimLoading,disabled:e.claimLoading||e.pendingYieldAmount==0,onClick:n[0]||(n[0]=Ie=>e.chainName=="Sui"?e.claimAll():e.toClaim())},{default:Xe(()=>[Ae("Claim")]),_:1},8,["loading","disabled"])])]),t("div",Qi,[t("div",Zi,[t("div",null,[Ki,t("div",null,[qe(t("img",null,null,512),[[o,(e.needReverse?(J=e.toCoin)==null?void 0:J.logo_url:(z=e.fromCoin)==null?void 0:z.logo_url)||e.getCoinIcon(e.needReverse?(se=e.positionInfo)==null?void 0:se.token_b:(re=e.positionInfo)==null?void 0:re.token_a)]]),ce(R,{address:e.needReverse?(j=(N=e.positionInfo)==null?void 0:N.token_b)==null?void 0:j.address:(ge=(me=e.positionInfo)==null?void 0:me.token_a)==null?void 0:ge.address,"style-params":{width:"10px",height:"10px",left:"15px",bottom:"8px"}},null,8,["address"]),t("span",null,D(e.needReverse?("showNum"in e?e.showNum:K(Te))(e.positionInfo.feeOwedB,(Y=(b=e.positionInfo)==null?void 0:b.token_b)==null?void 0:Y.decimals):("showNum"in e?e.showNum:K(Te))(e.positionInfo.feeOwedA,(_e=(ue=e.positionInfo)==null?void 0:ue.token_a)==null?void 0:_e.decimals)),1)]),(e.fromCoinAmount||e.toCoinAmount)&&!("checkNullObj"in e?e.checkNullObj:K(pe))(e.positionInfo)&&e.isShowAfterAmount?(C(),M("div",Vi," 0 after ")):ve("",!0)]),t("div",null,[xi,t("div",null,[qe(t("img",null,null,512),[[o,(e.needReverse?(de=e.fromCoin)==null?void 0:de.logo_url:(q=e.toCoin)==null?void 0:q.logo_url)||e.getCoinIcon(e.needReverse?($e=e.positionInfo)==null?void 0:$e.token_a:(be=e.positionInfo)==null?void 0:be.token_b)]]),ce(R,{address:e.needReverse?(Be=(Pe=e.positionInfo)==null?void 0:Pe.token_a)==null?void 0:Be.address:(Ce=(Re=e.positionInfo)==null?void 0:Re.token_b)==null?void 0:Ce.address,"style-params":{width:"10px",height:"10px",left:"15px",bottom:"8px"}},null,8,["address"]),t("span",null,D(e.needReverse?("showNum"in e?e.showNum:K(Te))(e.positionInfo.feeOwedA,(je=(Oe=e.positionInfo)==null?void 0:Oe.token_a)==null?void 0:je.decimals):("showNum"in e?e.showNum:K(Te))(e.positionInfo.feeOwedB,(ze=(Ue=e.positionInfo)==null?void 0:Ue.token_b)==null?void 0:ze.decimals)),1)]),(e.fromCoinAmount||e.toCoinAmount)&&!("checkNullObj"in e?e.checkNullObj:K(pe))(e.positionInfo)&&e.isShowAfterAmount?(C(),M("div",ea," 0 after ")):ve("",!0)]),e.chainName=="Sui"?(C(!0),M(so,{key:0},lo(e.pendingRewarderArr,Ie=>(C(),M("div",{key:Ie},[oa,t("div",null,[qe(t("img",na,null,512),[[o,Ie.logo_url]]),ce(R,{address:Ie.address,"style-params":{width:"10px",height:"10px",left:"15px",bottom:"8px"}},null,8,["address"]),t("span",null,D(Ie.amount),1)]),(e.fromCoinAmount||e.toCoinAmount)&&!("checkNullObj"in e?e.checkNullObj:K(pe))(e.positionInfo)&&e.isShowAfterAmount?(C(),M("div",ta," 0 after ")):ve("",!0)]))),128)):ve("",!0)])]),e.chainName=="Aptos"&&e.pendingRewarderAmount>0?(C(),M("div",ia,[t("div",aa,[sa,t("div",null,[Ae(" $"+D(e.pendingRewarderAmount>0&&e.pendingRewarderAmount<.01?"<0.01":("addCommom"in e?e.addCommom:K(V))(e.pendingRewarderAmount,2))+" ",1),e.pendingRewarderAmount>0?(C(),M("span",la,"$0 after")):ve("",!0)])]),t("div",ra,[ce(c,{class:"claim-all",loading:e.rewarderLoading,disabled:e.rewarderLoading||e.pendingRewarderAmount==0,onClick:e.toClaimRewards},{default:Xe(()=>[Ae("Claim")]),_:1},8,["loading","disabled","onClick"])])])):ve("",!0),e.chainName=="Aptos"&&e.pendingRewarderAmount>0?(C(),M("div",ua,[t("div",da,[(C(!0),M(so,null,lo(e.pendingRewarderArr,Ie=>(C(),M("div",{key:Ie},[ca,t("div",null,[qe(t("img",va,null,512),[[o,Ie.logo_url]]),ce(R,{address:Ie.address,"style-params":{width:"10px",height:"10px",left:"15px",bottom:"8px"}},null,8,["address"]),t("span",null,D(Ie.amount),1)]),(e.fromCoinAmount||e.toCoinAmount)&&!("checkNullObj"in e?e.checkNullObj:K(pe))(e.positionInfo)&&e.isShowAfterAmount?(C(),M("div",ma," 0 after ")):ve("",!0)]))),128))])])):ve("",!0)])}const Go=He(Ii,[["render",fa]]),pa=We({components:{AssetsCard:bo},setup(e,n){const a=$(""),i=$(""),T=Fe(),I=y(()=>T),R=y(()=>I.value.theme),c=Ve(),o=y(()=>c),v=$(!1),p=$(!1),m=$(!0),g=y(()=>I.value.chainName),A=y(()=>g.value?no(g.value):{}),H=fo(),ee=y(()=>H),te=y(()=>I.value.slippage),s=$(),r=$(),O=y(()=>ee.value.assets&&s.value&&ee.value.assets[s.value.address]?To(ee.value.assets[s.value.address].balance,s.value.decimals):0),l=y(()=>ee.value.assets&&r.value&&ee.value.assets[r.value.address]?To(ee.value.assets[r.value.address].balance,r.value.decimals):0),S=_=>{_==="fromCoin"?(m.value=!0,g.value==="Aptos"?a.value=O.value>0?s.value.symbol=="APT"?new k(Number(O.value)).sub(new k(.1)).lt(new k(0))?"0":new k(Number(O.value)).sub(new k(.1)).toString():String(O.value):"":a.value=O.value>0?s.value.symbol=="SUI"?new k(Number(O.value)).sub(new k(.05)).lt(new k(0))?"0":new k(Number(O.value)).sub(new k(.05)).toString():String(O.value):""):(m.value=!1,g.value==="Aptos"?i.value=l.value>0?r.value.symbol=="APT"?new k(Number(l.value)).sub(new k(.1)).lt(new k(0))?"0":new k(Number(l.value)).sub(new k(.1)).toString():String(l.value):"":i.value=l.value>0?r.value.symbol=="SUI"?new k(Number(l.value)).sub(new k(.05)).lt(new k(0))?"0":new k(Number(l.value)).sub(new k(.05)).toString():String(l.value):"")},L=_=>{_==="fromCoin"?(m.value=!0,a.value=Ee(new k(Number(O.value)).div(2).toString(),s.value.decimals).toString()):(m.value=!1,i.value=Ee(new k(Number(l.value)).div(2).toString(),r.value.decimals).toString())},w=$({}),u=$(!0),f=$({}),B=$(),ie=$(),Q=()=>{var j;if(!w.value||!a.value&&!i.value)return;const{TickMath:_,TickUtil:W}=A.value;console.log(a.value,i.value,"====>369"),console.log(w.value,"===>positionInfo.value339");let X=w.value.minPrice,E=w.value.maxPrice.indexOf("+")>0?"∞":w.value.maxPrice;console.log(w.value,"positionInfo.value====>");let z=Number(w.value.tick_lower_index),J=Number(w.value.tick_upper_index);const re=Number(w.value.current_tick_index);let se,me,ge=Number(X).toString(),N=w.value.maxPrice.indexOf("+")>0||w.value.maxPrice==="∞"?"∞":Number(E);if(ge=="0"&&N=="∞"?(z=Number(w.value.tick_lower_index),J=Number(w.value.tick_upper_index)):(se=_.priceToSqrtPriceX64(new k(X),s.value.decimals,r.value.decimals),me=_.priceToSqrtPriceX64(new k(E),s.value.decimals,r.value.decimals)),B.value=z,ie.value=J,console.log(z,J,"tick_lowertick_lower"),E!=="∞"&&z>=J){v.value=!0,a.value="",p.value=!0,i.value="";return}if(E=="∞"||re>=z&&re<=J){console.log("0413###increase###11111"),v.value=!1,p.value=!1;let ue;if(a.value||i.value){if(m.value){const be=new k(a.value).mul(Math.pow(10,s.value.decimals)).toString();ue=new Le(be)}else{const be=new k(i.value).mul(Math.pow(10,r.value.decimals)).toString();ue=new Le(be)}const{liquidityAmount:_e,tokenMaxA:b,tokenMaxB:Y,tokenMaxAOrigin:q,tokenMaxBOrigin:de}=A.value.estLiquidityAndcoinAmountFromOneAmounts({tokenA:s.value,tokenB:r.value,lowerTick:z,upperTick:J,coinAmount:ue,iscoinA:u.value?m.value:!m.value,roundUp:!0,slippage:Number(te.value)/100,curSqrtPrice:new Le(w.value.current_sqrt_price)});f.value={liquidityAmount:_e,tokenMaxA:b,tokenMaxB:Y,tokenMaxAOrigin:q,tokenMaxBOrigin:de},u.value?m.value?i.value=Number(Y)>0?Y:"":a.value=Number(b)>0?b:"":m.value?i.value=b:a.value=Y}}else if(re>J){if(console.log("0413###increase###22222"),a.value="",v.value=!0,p.value=!1,a.value||i.value){let ue;const _e=new k(i.value).mul(Math.pow(10,(j=r.value)==null?void 0:j.decimals)).toString();ue=new Le(_e),f.value={liquidityAmount:Mo(se,me,ue),tokenMaxA:0,tokenMaxB:i.value}}}else if(re<z){if(console.log("0413###increase###33333"),v.value=!1,p.value=!0,i.value="",a.value||i.value){let ue;const _e=new k(a.value).mul(Math.pow(10,s.value.decimals)).toString();ue=new Le(_e),f.value={liquidityAmount:Bo(se,me,ue),tokenMaxA:a.value,tokenMaxB:0}}}else console.log("0413###increase###4444"),v.value=!0,a.value="",p.value=!0,i.value="";c.setPositionActionAmount({fromCoinAmount:a,toCoinAmount:i}),console.log(f.value.liquidityAmount,"====>liquidityInput.value.liquidityAmount")};we(()=>o.value.currentPositionInfo,_=>{if(_&&!pe(_)){w.value=_,console.log(_,"newVal===>"),s.value=w.value.token_a,r.value=w.value.token_b;let W=Number(w.value.tick_lower_index),X=Number(w.value.tick_upper_index);const E=Number(w.value.current_tick_index);(_.maxPrice.indexOf("+")>0||_.maxPrice==="∞"?"∞":_.maxPrice)=="∞"||E>=W&&E<=X?(v.value=!1,p.value=!1):E>X?(a.value="",v.value=!0,p.value=!1):E<W?(v.value=!1,p.value=!0,i.value=""):(v.value=!0,a.value="",p.value=!0,i.value=""),Q()}},{immediate:!0}),we(a,(_,W)=>{_&&Q(),_==""&&(i.value="")}),we(i,(_,W)=>{_&&Q(),_==""&&(a.value="")});const U=y(()=>{var _,W,X,E;return console.log((W=(_=w.value)==null?void 0:_.poolInfo)==null?void 0:W.needReverse,"===>positionInfo.value?.poolInfo?.needReverse"),(E=(X=w.value)==null?void 0:X.poolInfo)==null?void 0:E.needReverse}),G=y(()=>o.value.RATES),Z=y(()=>{var J,re,se,me;const _=((re=G.value[(J=s.value)==null?void 0:J.address])==null?void 0:re.price)||0,W=((me=G.value[(se=r.value)==null?void 0:se.address])==null?void 0:me.price)||0,X=new k(_).mul(new k(a.value||0)),E=new k(W).mul(new k(i.value||0)),z=X.add(E);return console.log(_,W,X.toString(),E.toString(),"====>amount"),z.toNumber()?z.toNumber()>0&&z.toNumber()>.01?V(z.toString(),2):"<0.01":"--"}),ne=$(!1),{t:ae,locale:oe}=$o(),le=y(()=>{const _=Number(a.value)>Number(O.value),W=Number(i.value)>Number(l.value);return!a.value&&!i.value?ae("button.enterAmount"):_?ae("button.insufficientBalance",{name:s.value.symbol}):W?ae("button.insufficientBalance",{name:r.value.symbol}):ae("newAdd.addMore")}),x=y(()=>{const _=Number(a.value)>Number(O.value),W=Number(i.value)>Number(l.value);return!!(!a.value&&!i.value||_||W)}),{setIsShowSuccess:he,setIsShowRejected:F,setIsShowWaiting:fe,setTransactionDesc:ke,setTransactionTxid:Ne,setPositiomNum:d}=T,h=$(!1);return{theme:R,showFromCoinLock:v,showToCoinLock:p,toCoinAmount:i,fromCoinAmount:a,fromCoinBlance:O,toCoinBlance:l,fromCoin:s,toCoin:r,maxBtnSelect:S,halfBtnSelect:L,fixedFromCoin:m,needReverse:U,totalAmount:Z,wallet:ee,addLiquidityBtnText:le,isShowLiquidityModal:ne,indexStore:T,positionInfo:w,actionLoading:h,toAdd:async()=>{var J,re,se,me,ge,N,j,ue,_e,b;ne.value=!1,h.value=!0,Ne("");const _=v.value?"":`${a.value} ${(J=s.value)==null?void 0:J.symbol}`,W=p.value?"":`${i.value} ${(re=r.value)==null?void 0:re.symbol}`;ke(ae("tips.increaseLiquiditySuccess",{from:U.value?W:_,and:!v.value&&!p.value?"and":"",to:U.value?_:W})),fe(!0);const X=m.value;console.log(X,"===>fix_amount_a"),console.log(B.value,"tickLower.value===>"),console.log(ie.value,"tickUpper.value,===>"),console.log("0222###increase###positionInfo###",w);const E=w.value.poolInfo.rewarder_infos;let z={};z.coinTypeC=E[0]?E[0].coinAddress:"",z.coinTypeD=E[1]?E[1].coinAddress:"",z.coinTypeE=E[2]?E[2].coinAddress:"";try{const Y=await A.value.getAddLiquidityTransactionPayload({pool:{poolAddress:w.value.poolAddress,token_a:w.value.token_a,token_b:w.value.token_b},amount:X?f.value.tokenMaxA:f.value.tokenMaxB,fix_amount_a:X,tick_lower:B.value,tick_upper:ie.value,index:g.value==="Aptos"?w.value.index:w.value.pos_object_id,slippage:Number(te.value)/100,roundUp:!0,collect_fee:!0,...z,curSqrtPrice:new Le(w==null?void 0:w.value.poolInfo.current_sqrt_price)});console.log(Y,"===>payloadAdd11111");let q;if(g.value==="Aptos")q=await ee.value.currentWallet.signAndSubmitTransaction(Y);else{const de=await ee.value.currentWallet.signAndExecuteTransactionBlock(Y);q=A.value.handleTx(de)}if(console.log("toAdd###tx###",q),q&&q.hash){Ne(q.hash),fe(!1),he(!0),console.log(w,"===>positionInfo");const de={title:"Supplied",desc:ae("tips.addLiquiditySuccessText",{from:v.value?"":`${a.value} ${(se=s.value)==null?void 0:se.symbol}`,and:!v.value&&!p.value?"and":"",to:p.value?"":`${i.value} ${(me=r.value)==null?void 0:me.symbol}`}),hash:q.hash,tit:"Liquidity Increased",icon:"icon-icon-Increased",tokenInfo:{tokena:U.value?`${(N=r.value)==null?void 0:N.address}`:`${(ge=s.value)==null?void 0:ge.address}`,numa:U.value?`- ${i.value}`:`- ${a.value}`,logoa:U.value?o.value.tokensObj&&r.value&&r.value.address&&o.value.tokensObj[r.value.address]&&o.value.tokensObj[r.value.address].logoURI:o.value.tokensObj&&s.value&&s.value.address&&o.value.tokensObj[s.value.address]&&o.value.tokensObj[s.value.address].logoURI,tokenb:U.value?`${(ue=s.value)==null?void 0:ue.address}`:`${(j=r.value)==null?void 0:j.address}`,numb:U.value?`- ${a.value}`:`- ${i.value}`,logob:U.value?o.value.tokensObj&&s.value&&s.value.address&&o.value.tokensObj[s.value.address]&&o.value.tokensObj[s.value.address].logoURI:o.value.tokensObj&&r.value&&r.value.address&&o.value.tokensObj[r.value.address]&&o.value.tokensObj[r.value.address].logoURI},text:`Deopsit ${v.value?"":`${a.value} ${(_e=s.value)==null?void 0:_e.symbol}`} ${!v.value&&!p.value?"and":""} ${p.value?"":`${i.value} ${(b=r.value)==null?void 0:b.symbol}`}`};g.value!=="Aptos"&&(de.res=q.res),A.value.showTransitionPending(de),await A.value.watchTransaction(de)&&setTimeout(()=>{n.emit("getDetails"),A.value.getAccount(ee.value.address)},1e3),d()}else fe(!1),F(!0);a.value="",i.value="",h.value=!1}catch(Y){a.value="",i.value="",console.log("addError###",Y),h.value=!1,fe(!1),F(!0)}},addLiquidityBtnDisabled:x,poolStore:c}}});const ha={class:"new-position-asset"},ga={class:"add-or-remove"},ba={class:"liquidity-action-tab"},ka=t("div",{class:"increase tab-active"}," Increase ",-1),_a={class:"card-item"},ya={class:"card-item"},wa={key:0,class:"add",src:fn},Aa={key:1,class:"add",src:pn},Ca={class:"total-amount"},Ia=t("span",null,"Total Amount",-1);function $a(e,n,a,i,T,I){var p;const R=bo,c=hn,o=ho,v=gn;return C(),M("div",ha,[t("div",ga,[t("div",ba,[ka,t("div",{class:"remove",onClick:n[0]||(n[0]=m=>e.poolStore.setPositionDetailCurrentTab("remove"))}," Remove ")]),t("div",{class:Ke(e.needReverse?"card-container reverse":"card-container")},[t("div",_a,[ce(R,{modelValue:e.fromCoinAmount,"onUpdate:modelValue":n[1]||(n[1]=m=>e.fromCoinAmount=m),"input-value":e.fromCoinAmount,"coin-symbol":e.fromCoin?e.fromCoin.symbol:null,"coin-name":e.fromCoin?e.fromCoin.name:null,balance:e.fromCoinBlance,"coin-icon":e.fromCoin?e.fromCoin.logoURI:"",address:e.fromCoin?e.fromCoin.address:"","swap-direct":"From","import-page":"deposit","has-arrow":!1,onOnMax:n[2]||(n[2]=m=>e.maxBtnSelect("fromCoin")),onOnHalf:n[3]||(n[3]=m=>e.halfBtnSelect("fromCoin")),onOnInput:n[4]||(n[4]=m=>{e.fromCoinAmount=m}),onOnFocus:n[5]||(n[5]=()=>{e.fixedFromCoin=!0})},null,8,["modelValue","input-value","coin-symbol","coin-name","balance","coin-icon","address"]),e.showFromCoinLock?(C(),Me(c,{key:0,"from-coin":e.fromCoin,"to-coin":e.toCoin},null,8,["from-coin","to-coin"])):ve("",!0)]),t("div",ya,[ce(R,{modelValue:e.toCoinAmount,"onUpdate:modelValue":n[6]||(n[6]=m=>e.toCoinAmount=m),"input-value":e.toCoinAmount,"coin-symbol":e.toCoin?e.toCoin.symbol:null,"coin-name":e.toCoin?e.toCoin.name:null,balance:e.toCoinBlance,"swap-direct":"To","coin-icon":e.toCoin?e.toCoin.logoURI:"",address:e.toCoin?e.toCoin.address:"","import-page":"deposit","has-arrow":!1,onOnMax:n[7]||(n[7]=m=>e.maxBtnSelect("toCoin")),onOnHalf:n[8]||(n[8]=m=>e.halfBtnSelect("toCoin")),onOnInput:n[9]||(n[9]=m=>{e.toCoinAmount=m}),onOnFocus:n[10]||(n[10]=()=>{e.fixedFromCoin=!1})},null,8,["modelValue","input-value","coin-symbol","coin-name","balance","coin-icon","address"]),e.showToCoinLock?(C(),Me(c,{key:0,"from-coin":e.fromCoin,"to-coin":e.toCoin},null,8,["from-coin","to-coin"])):ve("",!0)]),e.fromCoin&&e.toCoin&&!e.showToCoinLock&&!e.showFromCoinLock&&e.theme=="default"?(C(),M("img",wa)):ve("",!0),e.fromCoin&&e.toCoin&&!e.showToCoinLock&&!e.showFromCoinLock&&e.theme!=="default"?(C(),M("img",Aa)):ve("",!0)],2),t("div",Ca,[Ia,t("span",null,"$"+D(e.totalAmount),1)])]),e.wallet.connected?(C(),Me(o,{key:0,class:"big-btn liquidity-btn",disabled:e.addLiquidityBtnDisabled,loading:e.actionLoading,onClick:n[11]||(n[11]=m=>e.isShowLiquidityModal=!0)},{default:Xe(()=>[t("span",null,D(e.addLiquidityBtnText),1)]),_:1},8,["disabled","loading"])):(C(),Me(o,{key:1,class:"big-btn",onClick:n[12]||(n[12]=m=>e.wallet.connected?e.isShowLiquidityModal=!0:e.wallet.setIsShowWalletModal(!0))},{default:Xe(()=>[t("span",null,D(e.$t("button.connectWallet")),1)]),_:1})),e.isShowLiquidityModal?(C(),Me(v,{key:2,title:e.$t("button.increase"),"is-increase":!0,"from-coin":e.needReverse?e.toCoin:e.fromCoin,"to-coin":e.needReverse?e.fromCoin:e.toCoin,"from-coin-amount":e.needReverse?e.toCoinAmount:e.fromCoinAmount,"to-coin-amount":e.needReverse?e.fromCoinAmount:e.toCoinAmount,"min-price":e.positionInfo.minPrice,"max-price":e.positionInfo.maxPrice,"current-price":e.positionInfo.currentPrice,"current-price-reverse":1/e.positionInfo.currentPrice,"pool-info":(p=e.positionInfo)==null?void 0:p.poolInfo,"show-from-coin-lock":e.showFromCoinLock,"show-to-coin-lock":e.showToCoinLock,"position-total-amount":e.positionInfo.totalAmountUSD,"fixed-from-coin":!0,"tick-lower":e.positionInfo.tick_lower_index,"tick-upper":e.positionInfo.tick_upper_index,"current-price-tab":"custom",onToAdd:e.toAdd,onOnClose:n[13]||(n[13]=m=>e.isShowLiquidityModal=!1)},null,8,["title","from-coin","to-coin","from-coin-amount","to-coin-amount","min-price","max-price","current-price","current-price-reverse","pool-info","show-from-coin-lock","show-to-coin-lock","position-total-amount","tick-lower","tick-upper","onToAdd"])):ve("",!0)])}const Co=He(pa,[["render",$a]]),Sa=We({components:{AssetsCard:bo},setup(e,n){const a=$(""),i=$(""),T=Fe(),I=y(()=>T),R=y(()=>I.value.theme),c=Ve(),o=y(()=>c),v=$(!1),p=$(!1),m=$(!0),g=y(()=>I.value.chainName),A=y(()=>g.value?no(g.value):{}),H=fo(),ee=y(()=>H),te=y(()=>I.value.slippage),s=$(),r=$(),O=y(()=>{var b,Y;return(Y=(b=u.value)==null?void 0:b.poolInfo)==null?void 0:Y.needReverse}),l=y(()=>{var b;return console.log(u==null?void 0:u.value,"==>positionInfo?.value"),console.log(!O.value,"===>!needReverse.value"),ye(u==null?void 0:u.value.amountA,(b=u==null?void 0:u.value.token_a)==null?void 0:b.decimals)}),S=y(()=>{var b;return ye(u==null?void 0:u.value.amountB,(b=u==null?void 0:u.value.token_b)==null?void 0:b.decimals)}),L=b=>{b==="fromCoin"?(m.value=!0,g.value==="Aptos"||console.log(l.value,"213===>"),a.value=String(l.value)):(m.value=!1,g.value,i.value=String(S.value)),U.value=!1},w=b=>{b==="fromCoin"?(m.value=!0,a.value=Ee(new k(Number(l.value)).div(2).toString(),s.value.decimals).toString()):(m.value=!1,i.value=Ee(new k(Number(S.value)).div(2).toString(),r.value.decimals).toString()),U.value=!1},u=$({}),f=$(!0),B=$({}),ie=$(),Q=$(),U=$(!0),G=()=>{var ze;if(U.value||!u.value||!a.value&&!i.value||(console.log(a.value>l.value,Number(i.value)>Number(S.value),"==>toCoinAmount.value"),Number(a.value)>Number(l.value)||Number(i.value)>Number(S.value)))return;if(a.value==l.value||i.value==S.value){Z.value=100,ae({value:1}),U.value=!0;return}const{TickMath:b,TickUtil:Y}=A.value;console.log(a.value,i.value,"====>369"),console.log(u.value,"===>positionInfo.value339");let q=u.value.minPrice,de=u.value.maxPrice.indexOf("+")>0?"∞":u.value.maxPrice;console.log(u.value,"positionInfo.value====>");let be=Number(u.value.tick_lower_index),$e=Number(u.value.tick_upper_index);const Re=Number(u.value.current_tick_index);let Ce,Pe,Be=Number(q).toString(),Ue=u.value.maxPrice.indexOf("+")>0||u.value.maxPrice==="∞"?"∞":Number(de);if(Be=="0"&&Ue=="∞"?(be=Number(u.value.tick_lower_index),$e=Number(u.value.tick_upper_index)):(Ce=b.priceToSqrtPriceX64(new k(q),s.value.decimals,r.value.decimals),Pe=b.priceToSqrtPriceX64(new k(de),s.value.decimals,r.value.decimals)),ie.value=be,Q.value=$e,console.log(be,$e,"tick_lowertick_lower"),de!=="∞"&&be>=$e){v.value=!0,a.value="",p.value=!0,i.value="";return}if(de=="∞"||Re>=be&&Re<=$e){console.log("0413###increase###11111"),console.log(a.value,"==>341"),console.log(i.value,"==>341"),v.value=!1,p.value=!1;let Oe;if(a.value||i.value){if(m.value){const Qe=new k(a.value).mul(Math.pow(10,s.value.decimals)).toString();Oe=new Le(Qe)}else{const Qe=new k(i.value).mul(Math.pow(10,r.value.decimals)).toString();Oe=new Le(Qe)}const{liquidityAmount:je,tokenMaxA:Ie,tokenMaxB:Ge,tokenMaxAOrigin:co,tokenMaxBOrigin:Se}=A.value.estLiquidityAndcoinAmountFromOneAmounts({tokenA:s.value,tokenB:r.value,lowerTick:be,upperTick:$e,coinAmount:Oe,iscoinA:f.value?m.value:!m.value,roundUp:g.value!="Sui",slippage:Number(te.value)/100,curSqrtPrice:new Le(u.value.current_sqrt_price)});B.value={liquidityAmount:je,tokenMaxA:Ie,tokenMaxB:Ge,tokenMaxAOrigin:co,tokenMaxBOrigin:Se},console.log(Ge,Ie,"362===>"),f.value?m.value?i.value=Number(Ge)>0?Ge:"":a.value=Number(Ie)>0?Ie:"":m.value?i.value=Ie:a.value=Ge}}else if(Re>$e){if(console.log("0413###increase###22222"),a.value="",v.value=!0,p.value=!1,a.value||i.value){let Oe;const je=new k(i.value).mul(Math.pow(10,(ze=r.value)==null?void 0:ze.decimals)).toString();Oe=new Le(je),B.value={liquidityAmount:Mo(Ce,Pe,Oe),tokenMaxA:0,tokenMaxB:i.value}}}else if(Re<be){if(console.log("0413###increase###33333"),v.value=!1,p.value=!0,i.value="",a.value||i.value){let Oe;const je=new k(a.value).mul(Math.pow(10,s.value.decimals)).toString();Oe=new Le(je),B.value={liquidityAmount:Bo(Ce,Pe,Oe),tokenMaxA:a.value,tokenMaxB:0}}}else console.log("0413###increase###4444"),v.value=!0,p.value=!0;U.value=!1,Z.value=new k(B.value.liquidityAmount.toString()).div(u.value.liquidity).mul(100).toNumber().toFixed(2),ne.value=B.value.liquidityAmount,console.log(Z.value,"===>sliderVal.value"),console.log(B.value.liquidityAmount,"====>liquidityInput.value.liquidityAmount"),c.setPositionActionAmount({fromCoinAmount:a,toCoinAmount:i}),console.log(Z.value,"===>sliderVal.value")},Z=$(50),ne=$("0"),ae=b=>{if(!U.value)return;U.value=!0;const Y=u.value.token_a.decimals,q=u.value.token_b.decimals,de=u.value.tick_lower_index,be=u.value.tick_upper_index,$e=No.tickIndexToSqrtPriceX64(de),Re=No.tickIndexToSqrtPriceX64(be);let Ce="";b.value!==1?Ce=new k(u.value.liquidity).mul(b.value).toString():Ce=u.value.liquidity,Ce=Ee(Ce,0)||"0",ne.value=Ce;const Pe=un.getCoinAmountFromLiquidity(new Le(Ce),new Le(u.value.current_sqrt_price),$e,Re,g.value!="Sui");console.log(Pe.coinA.toString(),Pe.coinB.toString(),Y,q,"===>amountInfo");const Be=new k(Pe.coinA.toString()).div(Math.pow(10,Y)).toString(),Ue=new k(Pe.coinB.toString()).div(Math.pow(10,q)).toString();console.log(Be,Ue,"amountA121212"),a.value=Number(Be)>0?Be:"",i.value=Number(Ue)>0?Ue:"",c.setPositionActionAmount({fromCoinAmount:a,toCoinAmount:i})};we(()=>o.value.currentPositionInfo,b=>{if(b&&!pe(b)){u.value=b,console.log(b,"newVal===>"),s.value=u.value.token_a,r.value=u.value.token_b,ae({value:Z.value/100});let Y=Number(u.value.tick_lower_index),q=Number(u.value.tick_upper_index);const de=Number(u.value.current_tick_index);(b.maxPrice.indexOf("+")>0||b.maxPrice==="∞"?"∞":b.maxPrice)=="∞"||de>=Y&&de<=q?(v.value=!1,p.value=!1):de>q?(a.value="",v.value=!0,p.value=!1):de<Y?(v.value=!1,p.value=!0,i.value=""):(v.value=!0,a.value="",p.value=!0,i.value=""),G()}},{immediate:!0}),we(a,(b,Y)=>{b&&G(),b==""&&(i.value="",Z.value=0)}),we(i,(b,Y)=>{b&&G(),b==""&&(a.value="",Z.value=0)});const oe=y(()=>o.value.RATES),le=y(()=>{var $e,Re,Ce,Pe;const b=((Re=oe.value[($e=s.value)==null?void 0:$e.address])==null?void 0:Re.price)||0,Y=((Pe=oe.value[(Ce=r.value)==null?void 0:Ce.address])==null?void 0:Pe.price)||0,q=new k(b).mul(new k(a.value||0)),de=new k(Y).mul(new k(i.value||0)),be=q.add(de);return console.log(b,Y,q.toString(),de.toString(),"====>amount"),V(be.toString(),2)}),x=$(!1),{t:he,locale:F}=$o(),fe=y(()=>{const b=Number(a.value)>Number(l.value),Y=Number(i.value)>Number(S.value);return!a.value&&!i.value?he("button.enterAmount"):b||Y?"lnsufficient Liquidity":he("button.remove")}),ke=y(()=>{const b=Number(a.value)>Number(l.value),Y=Number(i.value)>Number(S.value);return!!(!a.value&&!i.value||b||Y)}),{setIsShowSuccess:Ne,setIsShowRejected:d,setIsShowWaiting:h,setTransactionDesc:P,setTransactionTxid:_,setPositiomNum:W,setTransactionDescText:X}=T,E=$(!1);we(Z,en((b,Y)=>{b!==Y&&(Number(b)>100?Z.value=100:b&&u.value?(console.log("687===>"),Z.value=b,ae({value:Z.value/100})):(a.value="",i.value=""))},300)),we(te,b=>{b&&u.value&&ae({value:Z.value/100})});const z=[{name:"25%",value:25},{name:"50%",value:50},{name:"75%",value:75},{name:"MAX",value:100}],J=jo(),re=y(()=>J),se=y(()=>re.value.status),me=$(!1),ge=b=>{const Y=b.sources;Y.forEach(q=>{const{pool_address:de,position_index:be}=JSON.parse(q.blockchainAddress);console.log(de,be,"===>pool_address, position_index"),console.log(u.value.poolAddress,u.value.index,"===>positionInfo.value.index"),de==u.value.poolAddress&&Number(be)==Number(u.value.index)&&(me.value=!0)}),console.log(Y,"===>sources")},N=async()=>{await J.getSources();let b;re.value.allSources.forEach(Y=>{const{pool_address:q,position_index:de}=JSON.parse(Y.blockchainAddress);q==u.value.poolAddress&&de==u.value.index&&(b=Y.id)}),console.log(b,"sourceID649==>"),J.deleteSource(b)};we(()=>[re.value.sourceGroups,u.value],([b,Y])=>{b&&b.sources&&b.sources.length>0&&Y&&!pe(Y)&&ge(b)},{immediate:!0,deep:!0});const j=uo(),ue=po();return{theme:R,showFromCoinLock:v,showToCoinLock:p,toCoinAmount:i,fromCoinAmount:a,fromCoinBlance:l,toCoinBlance:S,fromCoin:s,toCoin:r,maxBtnSelect:L,halfBtnSelect:w,fixedFromCoin:m,needReverse:O,totalAmount:le,wallet:ee,addLiquidityBtnText:fe,isShowLiquidityModal:x,indexStore:T,positionInfo:u,actionLoading:E,addLiquidityBtnDisabled:ke,sliderVal:Z,ratioArr:z,setPercent:ae,poolStore:c,isSlider:U,toRemove:async()=>{var be,$e,Re,Ce,Pe,Be,Ue,ze,Oe,je,Ie,Ge,co;E.value=!0,_("");const b=V(a.value,s.value.decimals)==0?"":`${ye(a.value,s.value.decimals)} ${s.value.symbol}`,Y=V(i.value,r.value.decimals)==0?"":`${ye(i.value,r.value.decimals)} ${r.value.symbol}`;P(he("tips.removeLiquidiyText",{from:O.value?Y:b,and:V(a.value,s.value.decimals)==0||V(i.value,r.value.decimals)==0?"":"and",to:O.value?b:Y})),h(!0),console.log(u.value,"==>positionInfo.value");const q=u.value.poolInfo.rewarder_infos,de=q&&q.length>0&&g.value=="Sui"||q&&q.length>0&&Z.value==100?he("modal.removeLiquidityText1"):he("modal.removeLiquidityText2");X(de);try{let Se={};Se={pool:{...u.value.poolInfo,coinA:u.value.token_a,coinB:u.value.token_b},coinTypeA:u.value.poolInfo.coinTypeA,coinTypeB:u.value.poolInfo.coinTypeB,position:u.value,delta_liquidity:Z.value==100?new Le(u.value.liquidity):new Le(Ee(ne.value,0)),slippage:Number(te.value),rewards_num:q.length},console.log(q,"===>pendingRewarderArr"),Se.coinTypeC=q[0]?q[0].coinAddress:"",Se.coinTypeD=q[1]?q[1].coinAddress:"",Se.coinTypeE=q[2]?q[2].coinAddress:"",console.log(Se,"===>params");const Qe=await A.value.getRemoveLiquidityTransactionPayload(Se);console.log(Qe,"===>payload");let De;if(g.value==="Aptos")De=await ee.value.currentWallet.signAndSubmitTransaction(Qe);else{const io=await ee.value.currentWallet.signAndExecuteTransactionBlock(Qe);De=A.value.handleTx(io),console.log("0331###remove###tx####",De)}if(De&&De.hash){_(De.hash),h(!1),Ne(!0);const io={title:he("common.removeLiquidity"),desc:"",hash:De.hash,descTransactions:`Remove ${a.value} ${(be=s.value)==null?void 0:be.symbol} and ${i.value} ${($e=r.value)==null?void 0:$e.symbol} 
             from the pool`,sender:ee.value.address,chainName:g.value,tit:"Liquidity Removed",icon:"icon-icon-Removed",tokenInfo:{tokena:O.value?`${(Ce=r.value)==null?void 0:Ce.address}`:`${(Re=s.value)==null?void 0:Re.address}`,numa:O.value?`+ ${i.value}`:`+ ${a.value}`,logoa:O.value?o.value.tokensObj&&r.value&&r.value.address&&o.value.tokensObj[r.value.address]&&o.value.tokensObj[r.value.address].logoURI:o.value.tokensObj&&s.value&&s.value.address&&o.value.tokensObj[s.value.address]&&o.value.tokensObj[s.value.address].logoURI,tokenb:O.value?`${(Pe=s.value)==null?void 0:Pe.address}`:`${(Be=r.value)==null?void 0:Be.address}`,numb:O.value?`+ ${a.value}`:`+ ${i.value}`,logob:O.value?o.value.tokensObj&&s.value&&s.value.address&&o.value.tokensObj[s.value.address]&&o.value.tokensObj[s.value.address].logoURI:o.value.tokensObj&&r.value&&r.value.address&&o.value.tokensObj[r.value.address]&&o.value.tokensObj[r.value.address].logoURI},text:`Withdraw ${a.value} ${(Ue=s.value)==null?void 0:Ue.symbol} and ${i.value} ${(ze=r.value)==null?void 0:ze.symbol}`};g.value!=="Aptos"&&(io.res=De.res),A.value.showTransitionPending(io);const vo=await A.value.watchTransaction(io);if(q.value&&q.value.length>0&&(Number((Oe=q[0])==null?void 0:Oe.amount)!==0||Se.coinTypeD&&Number((je=q[1])==null?void 0:je.amount)!==0||Se.coinTypeE&&Number((Ie=q[2])==null?void 0:Ie.amount)!==0)){const ko={title:he("common.removeLiquidity"),desc:"",hash:De.hash,tit:"Rewards Claimed",icon:"icon-icon-Removed",tokenInfo:{tokena:q[0].symbol,numa:`+ ${Number(q[0].amount)}`,logoa:o.value.tokensObj&&q[0]&&q[0].address&&o.value.tokensObj[q[0].address]&&o.value.tokensObj[q[0].address].logoURI,tokenb:Se.coinTypeD?q[1].symbol:"",numb:Se.coinTypeD?`+ ${Number(q[1].amount)}`:"",logob:Se.coinTypeD?o.value.tokensObj&&q[1]&&q[1].address&&o.value.tokensObj[q[1].address]&&o.value.tokensObj[q[1].address].logoURI:"",tokenc:Se.coinTypeE?q[2].symbol:"",numc:Se.coinTypeE?`+ ${Number(q[2].amount)}`:"",logoc:Se.coinTypeE?o.value.tokensObj&&q[2]&&q[2].address&&o.value.tokensObj[q[2].address]&&o.value.tokensObj[q[2].address].logoURI:""},text:`Withdraw ${a.value} ${(Ge=s.value)==null?void 0:Ge.symbol} and ${i.value} ${(co=r.value)==null?void 0:co.symbol}`},_o=await A.value.setTransations(ko);console.log("9999transitionStatusFees",vo,_o)}if(Te(u.value.feeOwedA,u.value.token_a.decimals)!==0||Te(u.value.feeOwedB,u.value.token_b.decimals)!==0){const ko={title:"Claim",desc:"",hash:De.hash,chainName:g.value,tit:"Fees Claimed",icon:"icon-icon-Removed",tokenInfo:{tokena:`${u.value.token_a.symbol}`,numa:V(u.value.feeOwedA,u.value.token_a.decimals)==0?"":`+ ${Te(u.value.feeOwedA,u.value.token_a.decimals)}`,logoa:V(u.value.feeOwedA,u.value.token_a.decimals)==0?"":o.value.tokensObj&&u.value&&u.value.token_a.address&&o.value.tokensObj[u.value.token_a.address]&&o.value.tokensObj[u.value.token_a.address].logoURI,tokenb:`${u.value.token_b.symbol}`,numb:V(u.value.feeOwedB,u.value.token_b.decimals)==0?"":`+ ${Te(u.value.feeOwedB,u.value.token_b.decimals)}`,logob:V(u.value.feeOwedB,u.value.token_b.decimals)==0?"":o.value.tokensObj&&u.value&&u.value.token_b.address&&o.value.tokensObj[u.value.token_b.address]&&o.value.tokensObj[u.value.token_b.address].logoURI}},_o=await A.value.setTransations(ko);console.log("9999transitionStatusFees",vo,_o)}vo&&Number(Z.value)==100&&se.value=="authenticated"&&me.value&&(await J.subscribePosition({pool_address:u.value.poolAddress,position_index:u.value.index},u.value.nftHash,!1),N()),vo&&(a.value="",i.value="",setTimeout(()=>{n.emit("getDetails")},3e3),setTimeout(()=>{n.emit("getDetails")},6e3),console.log(Z.value,ue.name,g.value,"998===>"),Number(Z.value)==100&&ue.name=="new-position-detail"&&(g.value==="Aptos"?j.push("/position"):j.push("/pool/position")),Z.value=0)}else h(!1),d(!0);E.value=!1}catch(Se){console.log("Remove error",Se),E.value=!1,h(!1),d(!0)}},sFixD:Ee}}});const Pa={class:"new-position-asset"},Ta={class:"add-or-remove"},Na={class:"liquidity-action-tab"},Ra=t("div",{class:"remove tab-active"},"Remove",-1),Oa={class:"card-item"},La={key:0,class:"assets-card-mask"},qa={class:"card-item"},Ma={key:0,class:"assets-card-mask"},Ba={class:"remove-ratio"},Ua=t("div",{class:"remove-ratio-title"},"Amount",-1),ja={class:"remove-ratio-select"},Ea={key:0,class:"ratio"},Da={key:1,class:"ratio"},Fa={class:"ratio-list"},Wa=["onClick"];function Ha(e,n,a,i,T,I){const R=bo,c=on,o=ho;return C(),M("div",Pa,[t("div",Ta,[t("div",Na,[t("div",{class:"increase",onClick:n[0]||(n[0]=v=>e.poolStore.setPositionDetailCurrentTab("increase"))}," Increase "),Ra]),t("div",{class:Ke(e.needReverse?"card-container reverse":"card-container")},[t("div",Oa,[ce(R,{modelValue:e.fromCoinAmount,"onUpdate:modelValue":n[1]||(n[1]=v=>e.fromCoinAmount=v),"input-value":e.fromCoinAmount,"coin-symbol":e.fromCoin?e.fromCoin.symbol:null,"coin-name":e.fromCoin?e.fromCoin.name:null,balance:e.fromCoinBlance,"coin-icon":e.fromCoin?e.fromCoin.logoURI:"",address:e.fromCoin?e.fromCoin.address:"","swap-direct":"From","import-page":"deposit","has-arrow":!1,havemax:!1,"amount-leabl":"Available",onOnMax:n[2]||(n[2]=v=>e.maxBtnSelect("fromCoin")),onOnHalf:n[3]||(n[3]=v=>e.halfBtnSelect("fromCoin")),onOnInput:n[4]||(n[4]=v=>{e.fromCoinAmount=v,e.fixedFromCoin=!0,e.isSlider=!1})},null,8,["modelValue","input-value","coin-symbol","coin-name","balance","coin-icon","address"]),e.fromCoinBlance==0?(C(),M("div",La)):ve("",!0)]),t("div",qa,[ce(R,{modelValue:e.toCoinAmount,"onUpdate:modelValue":n[5]||(n[5]=v=>e.toCoinAmount=v),"input-value":e.toCoinAmount,"coin-symbol":e.toCoin?e.toCoin.symbol:null,"coin-name":e.toCoin?e.toCoin.name:null,balance:e.toCoinBlance,"swap-direct":"To","coin-icon":e.toCoin?e.toCoin.logoURI:"",address:e.toCoin?e.toCoin.address:"","import-page":"deposit","has-arrow":!1,havemax:!1,"amount-leabl":"Available",onOnMax:n[6]||(n[6]=v=>e.maxBtnSelect("toCoin")),onOnHalf:n[7]||(n[7]=v=>e.halfBtnSelect("toCoin")),onOnInput:n[8]||(n[8]=v=>{e.toCoinAmount=v,e.fixedFromCoin=!1,e.isSlider=!1})},null,8,["modelValue","input-value","coin-symbol","coin-name","balance","coin-icon","address"]),e.toCoinBlance==0?(C(),M("div",Ma)):ve("",!0)])],2),t("div",Ba,[Ua,t("div",ja,[Number(e.fromCoinBlance)>=Number(e.fromCoinAmount)&&Number(e.toCoinBlance)>=Number(e.toCoinAmount)?(C(),M("div",Ea,D(e.sliderVal>0&&Number(("sFixD"in e?e.sFixD:K(Ee))(e.sliderVal,2))<.01?"<0.01":("sFixD"in e?e.sFixD:K(Ee))(e.sliderVal,2))+"% ",1)):(C(),M("div",Da," -- ")),t("div",Fa,[(C(!0),M(so,null,lo(e.ratioArr,(v,p)=>(C(),M("div",{key:p,class:Ke(["ratio-item",e.sliderVal==v.value?"ratio-item-active":""]),onClick:()=>{e.isSlider=!0,e.sliderVal=v.value}},D(v.name),11,Wa))),128))])]),ce(c,{value:e.sliderVal,"onUpdate:value":n[9]||(n[9]=v=>e.sliderVal=v)},null,8,["value"])])]),e.wallet.connected?(C(),Me(o,{key:0,class:"big-btn liquidity-btn",loading:e.actionLoading,disabled:e.addLiquidityBtnDisabled,onClick:e.toRemove},{default:Xe(()=>[t("span",null,D(e.addLiquidityBtnText),1)]),_:1},8,["loading","disabled","onClick"])):(C(),Me(o,{key:1,class:"big-btn",onClick:n[10]||(n[10]=v=>e.wallet.connected?e.isShowLiquidityModal=!0:e.wallet.setIsShowWalletModal(!0))},{default:Xe(()=>[t("span",null,D(e.$t("button.connectWallet")),1)]),_:1}))])}const Xa=He(Sa,[["render",Ha]]),za=We({props:{positionInfo:{type:Object,default:()=>({})}},setup(e){const n=jo(),a=y(()=>n),i=y(()=>a.value.status),T=Fe();we(()=>[a.value.targetGroups],p=>{console.log("0327###watch###newTargetGoups###",p)},{immediate:!0});const I=$(!1);we(()=>i.value,p=>{p=="authenticated",I.value=!1},{immediate:!0});const R=$(!1),c=async()=>{R.value=!R.value,console.log(R.value,"===>checked.value");const p={pool_address:e.positionInfo.poolAddress,position_index:e.positionInfo.index},m=e.positionInfo.nftHash;console.log("0529###changeSwitch###positionInfo####",e.positionInfo);try{await n.subscribePosition(p,m,R.value)}catch{R.value=!R.value}},o=p=>{const m=p.sources;R.value=m.some(g=>JSON.parse(g.blockchainAddress).pool_address==e.positionInfo.poolAddress&&Number(JSON.parse(g.blockchainAddress).position_index)==Number(e.positionInfo.index))},v=uo();return console.log(v.currentRoute.value.query.token,"===>rouyter"),we(()=>[a.value.sourceGroups,e.positionInfo],([p,m])=>{var g,A,H;console.log(p,"==>newSourceGroups169"),console.log(m,"===>positionInfo170"),R.value=!1,p&&p.length>0&&p[0]&&m&&!pe(m)&&((H=(A=(g=v==null?void 0:v.currentRoute)==null?void 0:g.value)==null?void 0:A.query)==null?void 0:H.token)==(m==null?void 0:m.name)&&(console.log("触发"),console.log(p,"==>newSourceGroups"),console.log(m,"===>positionInfo"),o(p[0]))},{immediate:!0,deep:!0}),{importIcon:ro,isShowSetUp:I,changeSwitch:c,checked:R,notifiStatus:i,store:T}}});const Ga=e=>(eo("data-v-8f838b7e"),e=e(),oo(),e),Ya={class:"range-alerts"},Ja={class:"range-alerts-top"},Qa={class:"title"},Za=Ga(()=>t("div",{class:"title-all"},[t("span",{class:"Range"},"Range Alerts")],-1)),Ka={key:1,class:"h5-switch-box"},Va={class:"range-alerts-bottom"},xa={key:0,class:"pc-switch-box"};function es(e,n,a,i,T,I){const R=ho,c=tn;return C(),M("div",Ya,[t("div",Ja,[t("div",Qa,[Za,e.isShowSetUp||e.notifiStatus!=="authenticated"?(C(),Me(R,{key:0,class:"range-alerts-button",onClick:n[0]||(n[0]=nn(o=>e.store.setIsShowNotifi(!0),["stop"]))},{default:Xe(()=>[Ae(" Set up ")]),_:1})):ve("",!0),!e.isShowSetUp&&e.notifiStatus=="authenticated"?(C(),M("div",Ka,[ce(c,{class:"range-alerts-switch",checked:e.checked,disabled:e.notifiStatus!=="authenticated",onChange:e.changeSwitch},null,8,["checked","disabled","onChange"])])):ve("",!0)])]),t("div",Va,[Ae(" Receive alerts via Telegram, SMS, or email when this position goes out of range. "),!e.isShowSetUp&&e.notifiStatus=="authenticated"?(C(),M("div",xa,[ce(c,{class:"range-alerts-switch",checked:e.checked,disabled:e.notifiStatus!=="authenticated",onChange:e.changeSwitch},null,8,["checked","disabled","onChange"])])):ve("",!0)])])}const Yo=He(za,[["render",es],["__scopeId","data-v-8f838b7e"]]),os=We({components:{NewPositionTitle:Wo,NewPositionInfo:zo,NewPositionLiquidity:Go,NewPositionAssetAdd:Co,NewPositionAssetRemove:Co,NewPositionNotifi:Yo},setup(){const e=$(),n=$(),a=$(),i=Fe(),T=y(()=>i),I=y(()=>T.value.chainName),R=Ve(),c=y(()=>R),o=uo();Lo(()=>{e.value={},R.setPositionActionAmount({fromCoinAmount:"",toCoinAmount:""}),c.value.setCurrentPositionLoading(!0)});const v=async()=>{c.value.setCurrentPositionLoading(!0);const r=o.currentRoute.value.query.token||"",O=o.currentRoute.value.query.collect||"",l=o.currentRoute.value.query.address||"",S=o.currentRoute.value.query.pos||"",L=o.currentRoute.value.query.id||"";I.value==="Aptos"?r&&O&&l&&c.value.setCurrentPositionInfo(l,O,r,I.value):(console.log("0414###position-detail###id#####",L),console.log("0414###position-detail###name#####",r),console.log("0414###position-detail###pool_address#####",l),console.log("0414###position-detail###pos#####",S),r&&l&&S?c.value.setCurrentPositionInfo(l,O,r,I.value,S):L&&c.value.setCurrentPositionInfo("","","",I.value,L))};we(()=>c.value.poolConfigObj,r=>{r&&!pe(r)&&v()},{immediate:!0});const p=y(()=>c.value.currentPositionLoading),m=y(()=>{var O,l,S;const r=((S=(l=(O=o==null?void 0:o.currentRoute)==null?void 0:O.value)==null?void 0:l.query)==null?void 0:S.address)||"";return r&&c.value.addressLpTokens&&!pe(c.value.addressLpTokens)&&c.value.addressLpTokens[r]?c.value.addressLpTokens[r]:null});we(()=>m.value,(r,O)=>{r&&!pe(r)&&(e.value=r),r&&!pe(r)&&r.current_sqrt_price!==(O==null?void 0:O.current_sqrt_price)&&v()},{immediate:!0});const g=po();we(()=>[c.value.currentPositionInfo,I.value],([r,O])=>{var l;O=="Aptos"&&r?(e.value=r,n.value=e.value.token_a,a.value=e.value.token_b):O=="Sui"&&r&&(r==null?void 0:r.nftHash)==((l=g==null?void 0:g.query)==null?void 0:l.pos)&&(console.log(r,"==>newVal"),e.value=r,n.value=e.value.token_a,a.value=e.value.token_b)},{immediate:!0});const A=y(()=>c.value.positionDetailCurrentTab),H=fo(),ee=y(()=>H),te=y(()=>T.value.theme);return an(()=>{ee.value.connected||(te.value==="default"?o.push("/position"):o.push("/pool/position"))}),console.log(e.value,"===>positionInfo.value135"),{positionInfo:e,fromCoin:n,toCoin:a,getDetails:v,currentPositionLoading:p,positionDetailCurrentTab:A,clickRefresh:()=>{v()},chainName:I}}});const ns={class:"new-position-detail"},ts={class:"new-position-content"},is={class:"left"},as={class:"right"},ss={class:"loading-global"};function ls(e,n,a,i,T,I){const R=Wo,c=zo,o=Go,v=Co,p=Xa,m=Yo,g=sn;return C(),M("div",ns,[ce(R,{onClickRefresh:e.clickRefresh},null,8,["onClickRefresh"]),t("div",ts,[t("div",is,[ce(c),ce(o,{class:"pc-module",onGetDetails:e.getDetails},null,8,["onGetDetails"])]),t("div",as,[e.positionDetailCurrentTab=="increase"?(C(),Me(v,{key:0,onGetDetails:e.getDetails},null,8,["onGetDetails"])):(C(),Me(p,{key:1,onGetDetails:e.getDetails},null,8,["onGetDetails"])),ce(o,{class:"h5-module",onGetDetails:e.getDetails},null,8,["onGetDetails"]),e.positionInfo&&e.positionInfo.minPrice!=="0"&&e.positionInfo.maxPrice!=="∞"&&e.chainName=="Sui"?(C(),Me(m,{key:2,"position-info":e.positionInfo},null,8,["position-info"])):ve("",!0)])]),qe(t("div",ss,[ce(g)],512),[[Io,e.currentPositionLoading]])])}const Rs=He(os,[["render",ls],["__scopeId","data-v-6904756a"]]);export{Rs as default};
