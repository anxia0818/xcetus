import{_ as No}from"./new-position-title.8c7df80b.js";import{_ as ao}from"./token-warning.24a19b6e.js";import{_ as Ro}from"./status-block.9e979626.js";import{j as zo,n as Yo,d as he,e as oo,u as no,a as Z,g as fo,c as ge,s as je,q as Pe,b as Oe,p as Io,I as Oo,J as qo,T as Co,C as Jo}from"./pool.53213768.js";import{s as xe,m as Qo,l as Zo,b as Ko,a as Vo}from"./transform.c672907f.js";import{D as g}from"./decimal.0bdeb344.js";import{u as Je,a as so}from"./sha256.af115468.js";import{a as Qe,r as B,l as A,H as Bo,q as _e,e as Ze,o as S,f as M,t as qe,N as Lo,h as a,p as wo,k as Ao,m as lo,s as Mo,i as ve,u as Q,v as E,j as Ie,x as me,y as _o,a4 as xo,b as uo,C as Xe,a8 as So,O as $o,w as Ye,F as po,E as ho,B as ro,A as go,c as Be,D as en,G as on,z as nn,a1 as tn,S as an}from"./entry.d9991fb0.js";import{i as eo}from"./import-icon.de3e6c66.js";import{_ as co}from"./assets-card.60c859cd.js";import{_ as sn}from"./coin-lock.8c8bed44.js";import{a as ln}from"./new-add-or-create.06fbcea5.js";import{_ as un,a as rn}from"./icon-Add-Liquidity_2x.0acb06cb.js";/* empty css              *//* empty css              */import{u as Uo}from"./notifi.aef03785.js";import{_ as jo}from"./farms-position-detail.6ac3c635.js";/* empty css              *//* empty css              */import"./back.c94c84b6.js";import"./swap-setting.2993dcec.js";/* empty css              */import"./icon-error_2x.39c62c3b.js";/* empty css              */import"./img-lock_2x.a28135f4.js";import"./img-lock_2x.72752010.js";import"./useWhale.43b12502.js";import"./farms.6db168c2.js";const bo=Math.PI,ko=2*bo,ze=1e-6,dn=ko-ze;function Eo(e){this._+=e[0];for(let n=1,i=e.length;n<i;++n)this._+=arguments[n]+e[n]}function cn(e){let n=Math.floor(e);if(!(n>=0))throw new Error(`invalid digits: ${e}`);if(n>15)return Eo;const i=10**n;return function(s){this._+=s[0];for(let R=1,C=s.length;R<C;++R)this._+=Math.round(arguments[R]*i)/i+s[R]}}class vn{constructor(n){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=n==null?Eo:cn(n)}moveTo(n,i){this._append`M${this._x0=this._x1=+n},${this._y0=this._y1=+i}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(n,i){this._append`L${this._x1=+n},${this._y1=+i}`}quadraticCurveTo(n,i,s,R){this._append`Q${+n},${+i},${this._x1=+s},${this._y1=+R}`}bezierCurveTo(n,i,s,R,C,O){this._append`C${+n},${+i},${+s},${+R},${this._x1=+C},${this._y1=+O}`}arcTo(n,i,s,R,C){if(n=+n,i=+i,s=+s,R=+R,C=+C,C<0)throw new Error(`negative radius: ${C}`);let O=this._x1,c=this._y1,o=s-n,d=R-i,p=O-n,u=c-i,h=p*p+u*u;if(this._x1===null)this._append`M${this._x1=n},${this._y1=i}`;else if(h>ze)if(!(Math.abs(u*o-d*p)>ze)||!C)this._append`L${this._x1=n},${this._y1=i}`;else{let G=s-O,te=R-c,ie=o*o+d*d,L=G*G+te*te,v=Math.sqrt(ie),f=Math.sqrt(h),W=C*Math.tan((bo-Math.acos((ie+h-L)/(2*v*f)))/2),t=W/f,k=W/v;Math.abs(t-1)>ze&&this._append`L${n+t*p},${i+t*u}`,this._append`A${C},${C},0,0,${+(u*G>p*te)},${this._x1=n+k*o},${this._y1=i+k*d}`}}arc(n,i,s,R,C,O){if(n=+n,i=+i,s=+s,O=!!O,s<0)throw new Error(`negative radius: ${s}`);let c=s*Math.cos(R),o=s*Math.sin(R),d=n+c,p=i+o,u=1^O,h=O?R-C:C-R;this._x1===null?this._append`M${d},${p}`:(Math.abs(this._x1-d)>ze||Math.abs(this._y1-p)>ze)&&this._append`L${d},${p}`,s&&(h<0&&(h=h%ko+ko),h>dn?this._append`A${s},${s},0,1,${u},${n-c},${i-o}A${s},${s},0,1,${u},${this._x1=d},${this._y1=p}`:h>ze&&this._append`A${s},${s},0,${+(h>=bo)},${u},${this._x1=n+s*Math.cos(C)},${this._y1=i+s*Math.sin(C)}`)}rect(n,i,s,R){this._append`M${this._x0=this._x1=+n},${this._y0=this._y1=+i}h${s=+s}v${+R}h${-s}Z`}toString(){return this._}}function Ke(e){return function(){return e}}function mn(e){let n=3;return e.digits=function(i){if(!arguments.length)return n;if(i==null)n=null;else{const s=Math.floor(i);if(!(s>=0))throw new RangeError(`invalid digits: ${i}`);n=s}return e},()=>new vn(n)}function fn(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function Do(e){this._context=e}Do.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,n){switch(e=+e,n=+n,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,n):this._context.moveTo(e,n);break;case 1:this._point=2;default:this._context.lineTo(e,n);break}}};function pn(e){return new Do(e)}function hn(e){return e[0]}function gn(e){return e[1]}function bn(e,n){var i=Ke(!0),s=null,R=pn,C=null,O=mn(c);e=typeof e=="function"?e:e===void 0?hn:Ke(e),n=typeof n=="function"?n:n===void 0?gn:Ke(n);function c(o){var d,p=(o=fn(o)).length,u,h=!1,G;for(s==null&&(C=R(G=O())),d=0;d<=p;++d)!(d<p&&i(u=o[d],d,o))===h&&((h=!h)?C.lineStart():C.lineEnd()),h&&C.point(+e(u,d,o),+n(u,d,o));if(G)return C=null,G+""||null}return c.x=function(o){return arguments.length?(e=typeof o=="function"?o:Ke(+o),c):e},c.y=function(o){return arguments.length?(n=typeof o=="function"?o:Ke(+o),c):n},c.defined=function(o){return arguments.length?(i=typeof o=="function"?o:Ke(!!o),c):i},c.curve=function(o){return arguments.length?(R=o,s!=null&&(C=R(s)),c):R},c.context=function(o){return arguments.length?(o==null?s=C=null:C=R(s=o),c):s},c}function To(){}function Fo(e){this._context=e}Fo.prototype={areaStart:To,areaEnd:To,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,n){e=+e,n=+n,this._point?this._context.lineTo(e,n):(this._point=1,this._context.moveTo(e,n))}};function kn(e){return new Fo(e)}function Po(e,n,i){const s=new g(10).pow(n-i);return new g(1.0001).pow(e).mul(s)}const yn=Qe({props:{poolInfo:{type:Object,default:()=>({chartLoading:!1,token_a:{decimal:6},token_b:{decimal:6},currentLiquity:"50000000"})},minPrice:{type:String,default:""},maxPrice:{type:String,default:""},direction:{type:Boolean,default:!0},tickList:{type:Array,default:()=>[]},currentTick:{type:Number,default:0},chartLoading:{type:Boolean,default:!1},currentPriceTab:{type:String,default:""},before7dContractPriceLowest:{type:String,default:""},before7dContractPriceHighest:{type:String,default:""}},setup(e,n){const i=B(1),s=B(""),R=B(""),C=A(()=>{var t,k,_;return u.sqrtPriceX64ToPrice((t=e.poolInfo)==null?void 0:t.current_sqrt_price,(k=e.poolInfo)==null?void 0:k.coinA.decimals,(_=e.poolInfo)==null?void 0:_.coinB.decimals).toString()}),O=A(()=>{let t=0;return e.direction?t=(Number(e.minPrice)/Number(C.value)-1)*100:t=(Number(e.minPrice)/Number(1/Number(C.value))-1)*100,t=t>0&&t<.1?.1:t,t=t<0&&t>-.1?-.1:t,t}),c=A(()=>{let t=0;return e.direction?t=(Number(e.maxPrice)/Number(C.value)-1)*100:t=(Number(e.maxPrice)/Number(1/Number(C.value))-1)*100,t=t>0&&t<.1?.1:t,t=t<0&&t>-.1?-.1:t,t}),o=Je(),d=A(()=>o),p=A(()=>d.value.chainName?oo(d.value.chainName):{}),{TickMath:u,getNearestTickByTick:h}=p.value,G=()=>{const t=i.value/2;i.value=t,L(e.poolInfo,t)},te=()=>{const t=i.value*2;i.value=t,L(e.poolInfo,t)},ie=(t=[])=>{let k=6;const _=Math.abs(Number(t[0])-Number(t[t.length-1]));return _>=6?k=0:_>=1?k=1:_>=.1?k=2:_>=.01?k=3:_>=.001?k=4:_>=1e-4?k=5:_>=1e-5?k=6:_>=1e-6?k=7:_>=1e-7&&(k=8),k},L=(t,k=1)=>{if(t&&t.token_a&&!e.chartLoading&&e.minPrice&&e.maxPrice){console.log(e.poolInfo,"==>props.poolInfo");const _=Number(e.poolInfo.current_tick_index);console.log("0117###dataProcessing###currentTick###",_),console.log("0117###dataProcessing###props.poolInfo###",e.poolInfo),console.log("0117###dataProcessing###minPrice###",e.minPrice),console.log("0117###dataProcessing###maxPrice###",e.maxPrice),console.log("0117###dataProcessing###poolInfo###",e.poolInfo);let y=_+100*k,l=_-100*k,K,z;if(e.maxPrice==="∞")z=p.value.TickUtil.getMaxIndex(Number(e.poolInfo.tickSpacing));else try{e.direction?z=u.priceToTickIndex(new g(e.maxPrice),e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals):z=u.priceToTickIndex(new g(1).div(e.minPrice),e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals)}catch{z=443636}if(e.minPrice==="0")K=p.value.TickUtil.getMinIndex(Number(e.poolInfo.tickSpacing));else try{e.direction?K=u.priceToTickIndex(new g(e.minPrice),e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals):K=u.priceToTickIndex(new g(1).div(e.maxPrice),e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals)}catch{K=-443636}let de=0;if(e.currentPriceTab!=="full range"){if(_>=K&&_<=z){const U=_-K,fe=z-_;de=Math.max(Math.abs(U),Math.abs(fe))}else _<K?de=Math.abs(z-_):de=Math.abs(_-K);y=_+de+100*k,l=_-de-100*k,console.log(k,_,"===>zooms")}else{const U=(Math.abs(_)>5e3,2e4);y=_+U*k,l=_-U*k}l<-443636&&(l=-443636),y>443636&&(y=443636),console.log(l,y,"===>201");const ee=new g(t.liquidity).div(Math.pow(10,8)).toString();console.log(ee,"==>currentLiquity");const q=e.tickList;console.log("0117####drawChart####tick_info_array####",q);const H=[],J=[];let ne={};for(let U=0;U<q.length;U++){if(ne=q[U],ne.index<=_&&ne.index>=l){if(H.length<1&&U!==0){const fe=q[U-1];H.unshift({...fe,index:l})}H.unshift(ne)}else if(ne.index>_&&ne.index<=y&&(J.push(ne),H.length<1&&U!==0)){const fe=q[U-1];H.push({...fe,index:l})}if(ne.index>y){const fe=q[U];if(J.push({...fe,index:y}),H.length<1&&U!==0){const we=q[U-1];H.push({...we,index:l})}break}}console.log(_,l,y,"===>currentTick");let re="0";for(let U=H.length-1;U>=0;U--)re=new g(re).plus(new g(H[U].liquidityNet.toString()).div(Math.pow(10,8))).toString(),H[U].liquityAmount=re;let x=ee;for(let U=0;U<J.length;U++)x=new g(x).plus(new g(J[U].liquidityNet.toString()).div(Math.pow(10,8))).toString(),J[U].liquityAmount=x;console.log(H.length,J.length,"leftArray");let se=[];const V=q&&q.length>0?{index:_,liquityAmount:Number(ee)}:{index:_,liquityAmount:0};(H.length>0||J.length>0)&&(console.log([V,...J],"279===>"),se=[...H.reverse(),V,...J],e.direction||(se=se.reverse()));const be=[];q.forEach(U=>{be.push({...U,liquidityGross:U.liquidityGross.toString(),liquidityNet:U.liquidityNet.toString()})}),console.log("0117####drawChart####testTickInfoArray####",be),console.log("0117####drawChart####currentLiquity####",ee),console.log(se,"===>chartData"),f(se,l,y,K,z,_)}};let v=B(!1);Bo(()=>{document.body.clientWidth<750?v.value=!1:v.value=!0,window.onresize=()=>{document.body.clientWidth<750?v.value=!1:v.value=!0,L(e.poolInfo,i.value)}});const f=(t,k,_,y,l,K)=>{console.log("0117####drawChart####chartData####",t),console.log("0117####drawChart####tickMin####",k),console.log("0117####drawChart####tickMax####",_),console.log("0117####drawChart####minPriceTick####",y),console.log("0117####drawChart####maxPriceTick####",l),console.log("0117####drawChart####currentTick####",K),console.log("0117####drawChart####props.direction####",e.direction),console.log("0518###newd3###props.before7dContractPriceLowest###",e.before7dContractPriceLowest),console.log("0518###newd3###props.before7dContractPriceHighest###",e.before7dContractPriceHighest);let z,de;e.direction?(z=e.before7dContractPriceLowest?u.priceToTickIndex(new g(e.before7dContractPriceLowest),e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals):"",de=e.before7dContractPriceHighest?u.priceToTickIndex(new g(e.before7dContractPriceHighest),e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals):""):(z=e.before7dContractPriceLowest?u.priceToTickIndex(new g(1).div(e.before7dContractPriceLowest),e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals):"",de=e.before7dContractPriceHighest?u.priceToTickIndex(new g(1).div(e.before7dContractPriceHighest),e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals):"");const ee={top:30,right:35,bottom:20,left:55};let q,H;v.value,q=340-ee.left-ee.right,H=205-ee.top-ee.bottom;const J=_-k,ne=parseInt(String(J/4));let re=[k+ne/4,k+ne,k+2*ne,_-ne,_-ne/4];const x=k,se=_,V=q/(se-x);e.currentPriceTab==="full range"&&(re=[k,k+2*ne,_]),console.log("0117####drawChart####xArr####",re),console.log("0117####drawChart####utickMin####",x),console.log("0117####drawChart####utickMax####",se),console.log("0117####drawChart####unit####",V);const be=re.map($=>e.direction?Po($,e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals).toString():new g(1).div(Po($,e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals)).toString());ie(be),xe("#chart").selectAll("*").remove();const U=xe("#chart").attr("width",q+ee.left+ee.right).attr("height",H+ee.top+ee.bottom).append("g").attr("transform",`translate(${ee.left},${ee.right})`),fe=Qo(t,function($){return Number(Math.abs($.liquityAmount))})||0,we=Zo().range([0,H]).domain([fe,0]);Ko().rangeRound([0,q]).padding(.1);const r=U.append("g").attr("id","barsBox").selectAll("rect").data(t).enter().append("rect");d.value.theme=="default"?r.attr("x",function($,N){return N===0?0:e.direction?Math.abs($.index-x)*V:Math.abs(se-$.index)*V}).attr("y",function($,N){return e.direction?N===t.length-1?0:we($.liquityAmount):N===t.length-1?0:we(t[N+1].liquityAmount)}).attr("width",function($,N){return N===0&&t.length===1&&$.liquityAmount>0?q:(e.direction,N!==t.length-1?Math.abs(t[N+1].index-$.index)*V:0)}).attr("height",function($,N){return N===0&&t.length===1&&$.liquityAmount>0?H:e.direction?N===t.length-1?0:H-we($.liquityAmount):N===t.length-1?0:H-we(t[N+1].liquityAmount)}).attr("fill","#279477").attr("class","bars").attr("stroke-width",1).attr("stroke","#279477"):r.attr("x",function($,N){return N===0?0:e.direction?Math.abs($.index-x)*V:Math.abs(se-$.index)*V}).attr("y",function($,N){return e.direction?N===t.length-1?0:we(Math.abs($.liquityAmount)):N===t.length-1?0:we(Math.abs(t[N+1].liquityAmount))}).attr("width",function($,N){return N===0&&t.length===1&&$.liquityAmount>0?q:(e.direction,N!==t.length-1?Math.abs(t[N+1].index-$.index)*V:0)}).attr("height",function($,N){if(N===0&&t.length===1&&$.liquityAmount>0)return H;if(e.direction)return N===t.length-1?0:Number($.liquityAmount)?H-we(Math.abs($.liquityAmount)):0;{if(N===t.length-1)return 0;const ue=H-we(Math.abs(t[N+1].liquityAmount));return Number(t[N+1].liquityAmount)?ue:0}}).attr("fill","#407497").attr("class","bars").attr("stroke-width",1).attr("stroke","#407497");const m=U.append("g");m.append("line").attr("x1",0).attr("y1",155).attr("x2",q).attr("y2",155).attr("stroke-width",1).attr("stroke","#50535D"),m.append("g");let I=0;e.direction?I=Math.abs(K-x)*V:I=Math.abs(K-se)*V,console.log(d.value.theme=="default","leftHandle#"),(d.value.theme=="default"?U.append("line").attr("x1",0).attr("y1",0).attr("x2",0).attr("y2",155).attr("stroke-width",2).attr("stroke","#68FFD8"):U.append("line").attr("x1",0).attr("y1",0).attr("x2",0).attr("y2",155).attr("stroke-width",2).attr("stroke","#76C8FF")).attr("transform","translate("+I+", 0)"),xe("#triangle").attr("width",8).attr("height",4);let j=[[0,0],[4,4],[8,0]],D=bn().x(function($){return $[0]}).y(function($){return $[1]}).curve(kn);const P=I-4;U.append("path").attr("d",D(j)).style("fill",d.value.theme=="default"?"#68FFD8":"#76C8FF").attr("transform","translate("+P+", 0)");let F,X,le,ce;e.direction?(console.log("0525###d3###select###minPriceTick###",y),console.log("0525###d3###select###maxPriceTick###",l),console.log("0525###d3###select###props.minPrice###",e.minPrice),console.log("0525###d3###select###props.maxPrice###",e.maxPrice),F=y<x?-100:parseInt(String(Math.abs(y-x)*V)),X=l<x?-100:parseInt(String(Math.abs(l-x)*V)),le=z<x?-100:Math.abs(z-x)*V,ce=de<x?-100:Math.abs(de-x)*V):(X=y<x?-100:Math.abs(se-y)*V,F=l<x?-100:Math.abs(se-l)*V,ce=z<x?-100:Math.abs(se-z)*V,le=de<x?-100:Math.abs(se-de)*V),e.minPrice==="0"&&(F=0),e.maxPrice==="∞"&&(X=q),v.value?s.value=q-F+60+"px":s.value=q-F+52+"px",R.value=X+74+"px",console.log(F,X,"##minPriceTickX"),z&&le<q&&U.append("line").attr("x1",0).attr("y1",0).attr("x2",0).attr("y2",155).attr("stroke-width",1).attr("stroke-dasharray","5, 5").attr("stroke","rgba(255, 255, 255, 0.5)").attr("transform","translate("+le+", 0)"),de&&ce<q&&U.append("line").attr("x1",0).attr("y1",0).attr("x2",0).attr("y2",155).attr("stroke-width",1).attr("stroke-dasharray","5, 5").attr("stroke","rgba(255, 255, 255, 0.5)").attr("transform","translate("+ce+", 0)");const ke=Vo().extent([[0,0],[q,H]]).handleSize(30).on("end",Ae);U.append("g").attr("class","brush").call(ke).call(ke.move,[F,X]);function Ae($){if(!$.sourceEvent||!$.selection)return;v.value?s.value=q-$.selection[0]+60+"px":s.value=q-$.selection[0]+52+"px",R.value=$.selection[1]+74+"px";let N,ue;console.log("0525###d3###select###e.selection[0]###",$.selection[0]),console.log("0525###d3###select###e.selection[0]###",$.selection[1]),console.log("0525###d3###select###props.direction###",e.direction),console.log("0525###d3###select###width###",q),console.log("0525###d3###select###unit###",V),console.log("0525###d3###select###utickMin###",x),console.log("0525###d3###select###utickMax###",se),console.log("0525###d3###select###props.poolInfo###",e.poolInfo);let ye=0,b=0;e.direction?(ye=h(parseInt(String($.selection[0]/V+x)),Number(e.poolInfo.tickSpacing)),N=u.tickIndexToPrice(ye,e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals).toString(),b=h(parseInt(String($.selection[1]/V+x)),Number(e.poolInfo.tickSpacing)),ue=u.tickIndexToPrice(b,e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals).toString(),console.log("0525###d3###select###minTick###",ye),console.log("0525###d3###select###maxTick###",b),console.log("0525###d3###select###minPrice###",N),console.log("0525###d3###select###maxPrice###",ue)):(b=h(se-$.selection[0]/V,Number(e.poolInfo.tickSpacing)),N=1/u.tickIndexToPrice(b,e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals).toString(),ye=h(se-$.selection[1]/V,Number(e.poolInfo.tickSpacing)),ue=1/u.tickIndexToPrice(ye,e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals).toString()),n.emit("onChangeMinPrice",String(he(String(N),6))),n.emit("onChangeMaxPrice",String(he(String(ue),6)))}d.value.theme=="default"?xe(".selection").attr("stroke","rgba(255, 255, 255, 0)").attr("fill","#15322C"):xe(".selection").attr("stroke","rgba(255, 255, 255, 0)").attr("fill","rgba(255,255,255,0.7)")};B(""),_e(()=>[e.poolInfo,e.minPrice,e.maxPrice,e.currentPriceTab,e.tickList],([t,k,_,y])=>{console.log(t,k,_,_>k,"poolInfo && minPrice && maxPrice && (maxPrice > minPrice)"),t&&k&&_&&L(t,i.value)},{immediate:!0});const W=B(!0);return _e(()=>e.chartLoading,(t,k)=>{t!==k&&(W.value=t)},{immediate:!0,deep:!0}),{store:d,loading:W,zoomOut:G,zoomIn:te,rangeSizeLower:O,rangeSizeUpper:c,rangeSizeLowerPosition:s,rangeSizeUpperPosition:R,decimalFormat:zo,numberformat:Yo}}});const wn=e=>(wo("data-v-59ae7c8b"),e=e(),Ao(),e),An={class:"chart-box"},_n={class:"chart"},In=wn(()=>a("svg",{id:"chart"},null,-1)),Cn=[In];function Sn(e,n,i,s,R,C){return S(),M("div",An,[qe(a("div",_n,Cn,512),[[Lo,!e.loading]])])}const Wo=Ze(yn,[["render",Sn],["__scopeId","data-v-59ae7c8b"]]),$n=Qe({components:{StatusBlock:Ro,NewPositionChart:Wo,TokenWarning:ao},setup(e){const n=B(),i=B(),s=A(()=>{var t,k;return(k=(t=u.value)==null?void 0:t.poolInfo)==null?void 0:k.needReverse}),R=Je(),C=A(()=>R),O=A(()=>C.value.currentExplorer),c=A(()=>C.value.theme),o=A(()=>C.value.chainName),d=no(),p=A(()=>d),u=B({}),h=lo();_e(()=>[p.value.currentPositionInfo,o.value],([t,k])=>{var _;k=="Aptos"&&t?(u.value=t,n.value=u.value.token_a,i.value=u.value.token_b):k=="Sui"&&t&&(t==null?void 0:t.nftHash)==((_=h==null?void 0:h.query)==null?void 0:_.pos)&&(console.log(t,"==>newVal"),u.value=t,n.value=u.value.token_a,i.value=u.value.token_b,console.log(n.value,i.value,"###fromCoin.value"))},{immediate:!0});const G=t=>{var k;return(t==null?void 0:t.logoURI)||(t==null?void 0:t.logo_url)||((k=p.value.tokensObj[t==null?void 0:t.address])==null?void 0:k.logo_url)||(c.value==="default"?eo("/image/coins/unknown.png"):eo("/image/coins/sui-unknown.png"))},te=A(()=>o.value?oo(o.value):{}),ie=B([]),L=async t=>{console.log(t,"===>positionInfo.value.poolInfo");const k=await te.value.getTicks(t),_=k?te.value.getTickDataFromUrlData(k):[];console.log(_,"list===>"),ie.value=_};_e(()=>[u.value,p.value.poolsObj],([t,k])=>{console.log(t,!ge(t),"177111"),t&&!ge(t)&&t.poolInfo&&k&&!ge(k)&&(console.log(t,k,"==>poolConfigObj"),L(k[t.poolAddress]))},{immediate:!0});const v=B(!0);console.log(u.value,"188---------->");const f=(t,k)=>t!=="0"&&k!=="∞"?je(1/(1-Number((t/k)**.25)),2)+"x":"1x",W=A(()=>u.value.minPrice&&u.value.maxPrice?f(u.value.minPrice,u.value.maxPrice):"--");return{needReverse:s,getCoinIcon:G,theme:c,indexStore:R,direct:v,addCommom:Z,decimalUi:he,tickList:ie,positionInfo:u,fromCoin:n,toCoin:i,getExplorerUrl:fo,lever:W,currentExplorer:O}}}),Tn=""+globalThis.__publicAssetsURL("image/aptos-price.png"),Pn=""+globalThis.__publicAssetsURL("sui-image/sui-price.png"),Nn=""+globalThis.__publicAssetsURL("image/icon-arrow@2x.png"),Rn=""+globalThis.__publicAssetsURL("sui-image/icon-arrow@2x.png");const Fe=e=>(wo("data-v-742e1150"),e=e(),Ao(),e),On={class:"new-position-info"},qn={class:"pool-info"},Bn={class:"left"},Ln={class:"coin-a"},Mn={alt:""},Un={class:"coin-b"},jn={alt:""},En={class:"position-name"},Dn=["href"],Fn=Fe(()=>a("use",{"xlink:href":"#icon-icon-copy1"},null,-1)),Wn=[Fn],Hn={key:0,class:"pool-fee"},Xn=Fe(()=>a("span",null,"Fee tier",-1)),Gn={class:"right"},zn={class:"h5-pool-info"},Yn={class:"coin-info"},Jn={class:"coin-a"},Qn={alt:""},Zn={class:"coin-b"},Kn={alt:""},Vn={class:"position-name"},xn=["href"],et=Fe(()=>a("use",{"xlink:href":"#icon-icon-copy1"},null,-1)),ot=[et],nt={key:0,class:"pool-fee"},tt={class:"price-info"},it={class:"price-and-chart"},at={class:"left"},st={class:"current-price"},lt=Fe(()=>a("span",null,"Current Price",-1)),ut={class:"coin-rate"},rt=Fe(()=>a("div",null,[a("svg",{class:"icon icon-up","aria-hidden":"true"},[a("use",{"xlink:href":"#icon-exchange_up1"})])],-1)),dt=Fe(()=>a("div",null,[a("svg",{class:"icon icon-down","aria-hidden":"true"},[a("use",{"xlink:href":"#icon-exchange_down1"})])],-1)),ct=[rt,dt],vt={key:0},mt={key:1},ft={key:0,class:"position-range"},pt=Fe(()=>a("div",{class:"position-range-title"}," Position Range ",-1)),ht={key:0},gt={key:1},bt={key:2,src:Tn,alt:""},kt={key:3,src:Pn,alt:""},yt={key:4},wt={key:5},At={key:1,class:"position-range position-range-warp"},_t={key:0,class:"position-range-title"},It={key:1,class:"position-range-title"},Ct={key:2},St={key:3},$t={class:"price-img"},Tt={key:0,src:Nn,alt:""},Pt={key:1,src:Rn,alt:""},Nt={key:4},Rt={key:5},Ot={class:"lever"},qt=Fe(()=>a("div",{class:"lever-title"},"Leverage",-1)),Bt={class:"lever-text"},Lt={class:"right"},Mt=Fe(()=>a("div",{class:"chat-mask"},null,-1));function Ut(e,n,i,s,R,C){var p,u,h,G,te,ie,L,v,f,W,t,k,_,y,l,K,z,de,ee,q,H,J,ne,re,x,se,V,be,U,fe;const O=ao,c=Ro,o=Wo,d=Mo("image");return S(),M("div",On,[a("div",qn,[a("div",Bn,[a("div",Ln,[qe(a("img",Mn,null,512),[[d,e.needReverse?e.getCoinIcon(e.positionInfo.token_b):e.getCoinIcon(e.positionInfo.token_a)]]),ve(O,{address:e.needReverse?(G=(h=e.positionInfo)==null?void 0:h.token_b)==null?void 0:G.address:(u=(p=e.positionInfo)==null?void 0:p.token_a)==null?void 0:u.address,"style-params":{width:"12px",height:"12px",left:"18px",bottom:"4px"}},null,8,["address"])]),a("div",Un,[qe(a("img",jn,null,512),[[d,e.needReverse?e.getCoinIcon(e.positionInfo.token_a):e.getCoinIcon(e.positionInfo.token_b)]]),ve(O,{address:e.needReverse?(v=(L=e.positionInfo)==null?void 0:L.token_a)==null?void 0:v.address:(ie=(te=e.positionInfo)==null?void 0:te.token_b)==null?void 0:ie.address,"style-params":{width:"12px",height:"12px",left:"18px",bottom:"4px"}},null,8,["address"])]),a("div",En,[a("a",{href:("getExplorerUrl"in e?e.getExplorerUrl:Q(fo))(e.currentExplorer,"nftAddress",e.positionInfo.nftHash),target:"_blank"},E((W=(f=e.positionInfo)==null?void 0:f.name)==null?void 0:W.split("|")[1]),9,Dn)]),(S(),M("svg",{class:"copy-icon","aria-hidden":"true",onClick:n[0]||(n[0]=we=>e.indexStore.copy(e.positionInfo.nftHash))},Wn)),e.positionInfo.fee?(S(),M("div",Hn,[Xn,Ie(" "+E(e.positionInfo.fee*100)+"% ",1)])):me("",!0)]),a("div",Gn,[ve(c,{"current-status":(t=e.positionInfo)==null?void 0:t.currentStatus},null,8,["current-status"])])]),a("div",zn,[a("div",null,[a("div",Yn,[a("div",Jn,[qe(a("img",Qn,null,512),[[d,e.needReverse?e.getCoinIcon(e.positionInfo.token_b):e.getCoinIcon(e.positionInfo.token_a)]]),ve(O,{address:e.needReverse?(l=(y=e.positionInfo)==null?void 0:y.token_b)==null?void 0:l.address:(_=(k=e.positionInfo)==null?void 0:k.token_a)==null?void 0:_.address,"style-params":{width:"12px",height:"12px",left:"18px",bottom:"4px"}},null,8,["address"])]),a("div",Zn,[qe(a("img",Kn,null,512),[[d,e.needReverse?e.getCoinIcon(e.positionInfo.token_a):e.getCoinIcon(e.positionInfo.token_b)]]),ve(O,{address:e.needReverse?(ee=(de=e.positionInfo)==null?void 0:de.token_a)==null?void 0:ee.address:(z=(K=e.positionInfo)==null?void 0:K.token_b)==null?void 0:z.address,"style-params":{width:"12px",height:"12px",left:"18px",bottom:"4px"}},null,8,["address"])])]),a("div",Vn,[a("div",null,[a("a",{href:("getExplorerUrl"in e?e.getExplorerUrl:Q(fo))(e.currentExplorer,"nftAddress",e.positionInfo.nftHash),target:"_blank"},E((H=(q=e.positionInfo)==null?void 0:q.name)==null?void 0:H.split("|")[1]),9,xn),(S(),M("svg",{class:"copy-icon","aria-hidden":"true",onClick:n[1]||(n[1]=we=>e.indexStore.copy(e.positionInfo.nftHash))},ot))]),e.positionInfo.fee?(S(),M("div",nt,E(e.positionInfo.fee*100)+"%",1)):me("",!0)])]),ve(c,{"current-status":(J=e.positionInfo)==null?void 0:J.currentStatus},null,8,["current-status"])]),a("div",tt,[a("div",it,[a("div",at,[a("div",st,[a("div",null,[lt,a("div",ut,[a("div",{onClick:n[2]||(n[2]=we=>e.direct=!e.direct)},ct)])]),(e.needReverse?!e.direct:e.direct)?(S(),M("div",vt,[Ie(E(("addCommom"in e?e.addCommom:Q(Z))(("decimalUi"in e?e.decimalUi:Q(he))(e.positionInfo.currentPrice,6)))+"   ",1),a("span",null,E((ne=e.toCoin)==null?void 0:ne.symbol)+" per "+E((re=e.fromCoin)==null?void 0:re.symbol),1)])):(S(),M("div",mt,[Ie(E(("addCommom"in e?e.addCommom:Q(Z))(("decimalUi"in e?e.decimalUi:Q(he))(e.positionInfo.currentPriceReverse,6)))+"   ",1),a("span",null,E((x=e.fromCoin)==null?void 0:x.symbol)+" per "+E((se=e.toCoin)==null?void 0:se.symbol),1)]))]),e.positionInfo.minPrice&&e.positionInfo.minPrice.length<9&&e.positionInfo.maxPrice&&e.positionInfo.maxPrice.length?(S(),M("div",ft,[pt,a("div",null,[(e.needReverse?!e.direct:e.direct)?(S(),M("div",ht,[Ie(E(("addCommom"in e?e.addCommom:Q(Z))(("decimalUi"in e?e.decimalUi:Q(he))(e.positionInfo.minPrice,6)))+" ",1),a("span",null,E(e.positionInfo&&e.positionInfo.token_b&&e.positionInfo.token_b.symbol),1)])):(S(),M("div",gt,[Ie(E(((V=e.positionInfo)==null?void 0:V.minPrice)!=="0"?("addCommom"in e?e.addCommom:Q(Z))(("decimalUi"in e?e.decimalUi:Q(he))(1/e.positionInfo.minPrice,6)):0)+" ",1),a("span",null,E(e.positionInfo&&e.positionInfo.token_a&&e.positionInfo.token_a.symbol),1)])),e.theme=="default"?(S(),M("img",bt)):(S(),M("img",kt)),(e.needReverse?!e.direct:e.direct)?(S(),M("div",yt,[Ie(E(((be=e.positionInfo)==null?void 0:be.maxPrice)!=="∞"?("addCommom"in e?e.addCommom:Q(Z))(("decimalUi"in e?e.decimalUi:Q(he))(e.positionInfo.maxPrice,6)):"∞")+" ",1),a("span",null,E(e.positionInfo&&e.positionInfo.token_b&&e.positionInfo.token_b.symbol),1)])):(S(),M("div",wt,[Ie(E(((U=e.positionInfo)==null?void 0:U.maxPrice)!=="∞"?("addCommom"in e?e.addCommom:Q(Z))(("decimalUi"in e?e.decimalUi:Q(he))(1/e.positionInfo.maxPrice,6)):"∞")+" ",1),a("span",null,E(e.positionInfo&&e.positionInfo.token_a&&e.positionInfo.token_a.symbol),1)]))])])):(S(),M("div",At,[(e.needReverse?!e.direct:e.direct)?(S(),M("span",_t," Position Range ")):(S(),M("span",It," Position Range ")),(e.needReverse?!e.direct:e.direct)?(S(),M("div",Ct,[Ie(E(("addCommom"in e?e.addCommom:Q(Z))(("decimalUi"in e?e.decimalUi:Q(he))(e.positionInfo.minPrice,6)))+" ",1),a("span",null,E(e.positionInfo&&e.positionInfo.token_b&&e.positionInfo.token_b.symbol),1)])):(S(),M("div",St,[Ie(E(e.positionInfo.maxPrice!=="∞"?("addCommom"in e?e.addCommom:Q(Z))(("decimalUi"in e?e.decimalUi:Q(he))(1/e.positionInfo.maxPrice,6)):"∞")+" ",1),a("span",null,E(e.positionInfo&&e.positionInfo.token_a&&e.positionInfo.token_a.symbol),1)])),a("div",$t,[e.theme=="default"?(S(),M("img",Tt)):(S(),M("img",Pt))]),(e.needReverse?!e.direct:e.direct)?(S(),M("div",Nt,[Ie(E(e.positionInfo.maxPrice!=="∞"?("addCommom"in e?e.addCommom:Q(Z))(("decimalUi"in e?e.decimalUi:Q(he))(e.positionInfo.maxPrice,6)):"∞")+" ",1),a("span",null,E(e.positionInfo&&e.positionInfo.token_b&&e.positionInfo.token_b.symbol),1)])):(S(),M("div",Rt,[Ie(E(((fe=e.positionInfo)==null?void 0:fe.minPrice)!=="0"?("addCommom"in e?e.addCommom:Q(Z))(("decimalUi"in e?e.decimalUi:Q(he))(1/e.positionInfo.minPrice,6)):0)+" ",1),a("span",null,E(e.positionInfo&&e.positionInfo.token_a&&e.positionInfo.token_a.symbol),1),Ie("   ")]))])),a("div",Ot,[qt,a("div",Bt,E(e.lever),1)])]),a("div",Lt,[ve(o,{"pool-info":e.positionInfo.poolInfo,"tick-list":e.tickList,"min-price":e.needReverse&&e.positionInfo.maxPrice!=="∞"?1/e.positionInfo.maxPrice:e.positionInfo.minPrice,"max-price":e.needReverse&&e.positionInfo.minPrice!=0?1/e.positionInfo.minPrice:e.positionInfo.maxPrice,direction:!e.needReverse,"current-price-tab":"custom","chart-loading":!1},null,8,["pool-info","tick-list","min-price","max-price","direction"]),Mt])])])])}const Ho=Ze($n,[["render",Ut],["__scopeId","data-v-742e1150"]]),jt=Qe({components:{TokenWarning:ao},setup(e,n){const{t:i}=_o(),{$notify:s}=xo(),R=Je(),C=A(()=>R),O=no(),c=A(()=>O),o=B({}),d=B({}),p=B({}),u=A(()=>C.value.chainName),h=A(()=>u.value?oo(u.value):{}),G=lo(),te=B(!1),ie=async(r=null)=>{const m=r||o.value;console.log(m,"===>posInfo");const I=c.value.addressLpTokens[m.poolAddress];if(I){const w=await h.value.getTickDataByIndex(I.ticks_handle,Number(m.tick_lower_index)),j=await h.value.getTickDataByIndex(I.ticks_handle,Number(m.tick_upper_index));let D={};u.value==="Aptos"?D=await h.value.getPosRewardersAmount({poolAddress:_.currentRoute.value.query.address,positionName:_.currentRoute.value.query.token,tickLowerData:w,tickUpperData:j}):D=await h.value.fetchPosRewardersAmount({poolAddress:m.poolAddress,positionId:m.pos_object_id||m.clmm_position_id,coinTypeA:m.coin_type_a||m.coinTypeA,coinTypeB:m.coin_type_b||m.coinTypeB,rewarderInfo:m.poolInfo.rewarder_infos});const P=[];let F=new g(0);D.forEach((X,le)=>{var $,N;const ce=($=c.value.tokensObj[X.coin_address])==null?void 0:$.decimals,ke=X.amount_owed.toString();let Ae=new g(ke).div(Math.pow(10,ce)).toString();if(u.value=="Aptos"&&Number(Ae)>999999999&&(Ae="0"),m.poolInfo[`rewarder_display${le+1}`]||Number(Ae)>0){const ue=c.value.tokensObj[X.coin_address],ye=((N=c.value.RATES[X.coin_address])==null?void 0:N.price)||0,b=new g(Ae).mul(ye).toString();F=new g(F).plus(b),P.push({...X,...ue,amount:Number(Ae)>0?Pe(Ae,ce):0,amountUSD:Number(b)>0?Pe(b,2):0,amountUSDText:b})}}),y.value=P,console.log(P,"====>result722")}};_e(()=>[c.value.currentPositionInfo,u.value],([r,m])=>{var I;m=="Aptos"&&r?(o.value=r,d.value=r==null?void 0:r.token_a,p.value=r==null?void 0:r.token_b):m=="Sui"&&r&&(r==null?void 0:r.nftHash)==((I=G==null?void 0:G.query)==null?void 0:I.pos)&&(console.log(r,"==>newVal"),o.value=r,d.value=r==null?void 0:r.token_a,p.value=r==null?void 0:r.token_b,te.value=!1)},{immediate:!0}),_e(()=>[o.value,c.value.addressLpTokens],([r,m])=>{!ge(r)&&!ge(m)&&ie(r)},{immediate:!0});const L=A(()=>{var r,m,I,w,j,D,P,F;if(o.value&&!ge(o.value)&&c.value.RATES){const X=o.value.amountA*((m=c.value.RATES[(r=o.value)==null?void 0:r.token_a.address])==null?void 0:m.price),le=o.value.amountB*((w=c.value.RATES[(I=o.value)==null?void 0:I.token_b.address])==null?void 0:w.price);if((D=c.value.RATES[(j=o.value)==null?void 0:j.token_a.address])!=null&&D.price&&((F=c.value.RATES[(P=o.value)==null?void 0:P.token_b.address])!=null&&F.price)){const ce=Number(X+le);return ce>0&&ce<.01?"<0.01":Z(je(X+le,2),2)}else return" --"}else return" --"}),v=A(()=>{var r,m,I,w;return console.log((m=(r=o.value)==null?void 0:r.poolInfo)==null?void 0:m.needReverse,"===>positionInfo.value?.poolInfo?.needReverse"),(w=(I=o.value)==null?void 0:I.poolInfo)==null?void 0:w.needReverse}),f=A(()=>c.value.RATES),W=A(()=>{var r,m;if(f.value&&d.value&&p.value&&!ge(f.value)&&!ge(d.value)&&!ge(p.value)){const I=[],w=Number(o.value.feeOwedA)||0,j=Number(o.value.feeOwedB)||0;console.log(w,j,"===292"),console.log(f.value,d.value.address,"===293"),console.log(f.value[d.value.address],"===>RATES.value[fromCoin.value.address]"),console.log(f.value[p.value.address],"===>RATES.value[toCoin.value.address]");const D=new g(w).mul(((r=f.value[d.value.address])==null?void 0:r.price)||0),P=new g(j).mul(((m=f.value[p.value.address])==null?void 0:m.price)||0);return console.log(D.toString(),P.toString(),"====>292"),I.push({amount:w,amountUSD:D.toString()},{amount:j,amountUSD:P.toString()}),I}return[]}),t=A(()=>{var m,I;let r=new g(0);return(m=W.value)==null||m.forEach(w=>{r=r.add(new g(w.amountUSD))}),u.value=="Sui"&&((I=y.value)==null||I.forEach(w=>{r=r.add(new g(w.amountUSDText))})),console.log(W.value,y.value,"===>pendingRewarderArr.value"),r.toNumber()}),k=A(()=>{var m;let r=new g(0);return(m=y.value)==null||m.forEach(I=>{r=r.add(new g(I.amountUSDText))}),r.toNumber()}),_=uo(),y=B([]),{setIsShowSuccess:l,setIsShowRejected:K,setIsShowWaiting:z,setTransactionDesc:de,setTransactionTxid:ee}=R,q=so(),H=A(()=>q),J=async()=>{te.value=!0;let r={coinTypeA:o.value.poolInfo.coinTypeA,coinTypeB:o.value.poolInfo.coinTypeB,coinTypeC:"",coinTypeD:"",coinTypeE:"",pool_address:o.value.poolAddress,pos_index:o.value.index,rewarder_nums:y.value.length,collect_fee:!0};r.coinTypeC=y.value[0]?y.value[0].coin_address:"",r.coinTypeD=y.value[1]?y.value[1].coin_address:"",r.coinTypeE=y.value[2]?y.value[2].coin_address:"",z(!0),de();try{let m;if(u.value==="Aptos"){const I=await h.value.getCollectRewarderTransactionPayload(r);m=await H.value.currentWallet.signAndSubmitTransaction(I)}else{r.pos_index=o.value.pos_object_id;const I=await h.value.getCollectRewarderTransactionPayload(r),w=await H.value.currentWallet.signAndExecuteTransactionBlock(I);m=h.value.handleTx(w)}if(m&&m.hash){ee(m.hash),z(!1),l(!0);const I={title:"Claim",desc:"",hash:m.hash,tit:"Rewards Claimed",icon:"icon-icon-Removed"};u.value!=="Aptos"&&(I.res=m.res),h.value.showTransitionPending(I);const w=await h.value.watchTransaction(I);console.log("0310###toClaimRewards###transitionStatus###",w),w&&n.emit("getDetails")}else console.log("0310###toClaimRewards###else###"),z(!1),K(!0),te.value=!1}catch(m){z(!1),K(!0),te.value=!1,console.log(m,"error===>")}},ne=B(!1),re=async()=>{console.log("0310###toClaimRewards##start###",o.value),ne.value=!0;const r=y.value;let m={coinTypeA:o.value.poolInfo.coinTypeA,coinTypeB:o.value.poolInfo.coinTypeB,coinTypeC:"",coinTypeD:"",coinTypeE:"",pool_address:o.value.poolAddress,pos_index:o.value.index,rewarder_nums:r.length};m.coinTypeC=r[0]?r[0].coin_address:"",m.coinTypeD=r[1]?r[1].coin_address:"",m.coinTypeE=r[2]?r[2].coin_address:"",console.log(m,"===>collectRewarderParams");try{let I;if(u.value==="Aptos"){const w=await h.value.getCollectRewarderTransactionPayload(m);I=await H.value.currentWallet.signAndSubmitTransaction(w)}else{m.pos_index=o.value.pos_object_id;const w=await h.value.getCollectRewarderTransactionPayload(m),j=await H.value.currentWallet.signAndExecuteTransactionBlock(w);I=h.value.handleTx(j)}if(console.log("0310###toClaimRewards##tx###",I),I&&I.hash){ee(I.hash),z(!1),l(!0);const w=r[0].amount+r[0].symbol,j=m.coinTypeD?" and "+r[1].amount+r[1].symbol:"",D=m.coinTypeE?" and "+r[2].amount+r[2].symbol:"",P={title:"Claim",desc:"",hash:I.hash,tit:"Rewards Claimed",icon:"icon-icon-Removed",tokenInfo:{tokena:r[0].address,numa:`+ ${Number(r[0].amount)}`,logoa:c.value.tokensObj&&r[0]&&r[0].address&&c.value.tokensObj[r[0].address]&&c.value.tokensObj[r[0].address].logoURI,tokenb:r[1]&&r[1].address,numb:m.coinTypeD?`+ ${Number(r[1].amount)}`:"",logob:m.coinTypeD?c.value.tokensObj&&r[1]&&r[1].address&&c.value.tokensObj[r[1].address]&&c.value.tokensObj[r[1].address].logoURI:"",tokenc:r[2]&&r[2].address,numc:m.coinTypeE?`+ ${Number(r[2].amount)}`:"",logoc:m.coinTypeE?c.value.tokensObj&&r[2]&&r[2].address&&c.value.tokensObj[r[2].address]&&c.value.tokensObj[r[2].address].logoURI:""},text:w+j+D};u.value!=="Aptos"&&(P.res=I.res),h.value.showTransitionPending(P);const F=await h.value.watchTransaction(P);console.log("0310###toClaimRewards###transitionStatus###",F),F&&setTimeout(()=>{n.emit("getDetails"),h.value.getAccount(H.value.address)},3e3)}else console.log("0310###toClaimRewards###else###"),z(!1),K(!0);ne.value=!1}catch(I){console.log("0310###collectRewarderParams Error###",I),ne.value=!1,z(!1),K(!0)}},x=A(()=>c.value.positionDetailCurrentTab),se=A(()=>{var I,w,j,D,P,F;const r=he(v.value?(w=o.value)==null?void 0:w.amountB:(I=o.value)==null?void 0:I.amountA,v.value?(F=(P=o.value)==null?void 0:P.token_b)==null?void 0:F.decimals:(D=(j=o.value)==null?void 0:j.token_a)==null?void 0:D.decimals),m=v.value?c.value.positionActionAmount.toCoinAmount||0:c.value.positionActionAmount.fromCoinAmount||0;if(x.value=="increase")return m?new g(r).add(new g(m)).toString():"";if(m){const X=new g(r).minus(new g(m)).toString();return X<0?"0":String(X)}else return""}),V=A(()=>{var I,w,j,D,P,F;const r=he(v.value?(w=o.value)==null?void 0:w.amountA:(I=o.value)==null?void 0:I.amountB,v.value?(F=(P=o.value)==null?void 0:P.token_a)==null?void 0:F.decimals:(D=(j=o.value)==null?void 0:j.token_b)==null?void 0:D.decimals),m=v.value?c.value.positionActionAmount.fromCoinAmount||0:c.value.positionActionAmount.toCoinAmount||0;if(console.log(r,m,"===>427"),x.value=="increase")return m?new g(r).add(new g(m)).toString():"";if(m){const X=new g(r).minus(new g(m)).toString();return X<0?"0":String(X)}else return""}),be=A(()=>v.value?c.value.positionActionAmount.toCoinAmount:c.value.positionActionAmount.fromCoinAmount),U=A(()=>v.value?c.value.positionActionAmount.fromCoinAmount:c.value.positionActionAmount.toCoinAmount),fe=r=>{var m;return(r==null?void 0:r.logoURI)||(r==null?void 0:r.logo_url)||((m=c.value.tokensObj[r==null?void 0:r.address])==null?void 0:m.logo_url)||(C.value.theme==="default"?eo("/image/coins/unknown.png"):eo("/image/coins/sui-unknown.png"))},we=A(()=>{var D,P,F,X,le,ce,ke,Ae,$,N,ue,ye;const{fromCoinAmount:r,toCoinAmount:m}=c.value.positionActionAmount,I=c.value.positionDetailCurrentTab,w=he(v.value?(P=o.value)==null?void 0:P.amountB:(D=o.value)==null?void 0:D.amountA,v.value?(ce=(le=o.value)==null?void 0:le.token_b)==null?void 0:ce.decimals:(X=(F=o.value)==null?void 0:F.token_a)==null?void 0:X.decimals),j=he(v.value?(Ae=o.value)==null?void 0:Ae.amountA:(ke=o.value)==null?void 0:ke.amountB,v.value?(ye=(ue=o.value)==null?void 0:ue.token_a)==null?void 0:ye.decimals:(N=($=o.value)==null?void 0:$.token_b)==null?void 0:N.decimals);return console.log(w,j,r,m,"621===>"),u.value=="Sui"||I=="remove"&&u.value=="Aptos"&&r==w&&m==j});return{amountUSD:L,needReverse:v,decimalUi:he,pendingFees:W,positionInfo:o,pendingRewarderArr:y,pendingYieldAmount:t,toClaim:async()=>{te.value=!0;const r=Z(o.value.feeOwedA,o.value.token_a.decimals)==0?"":`${Pe(o.value.feeOwedA,o.value.token_a.decimals)} ${o.value.token_a.symbol}`,m=Z(o.value.feeOwedB,o.value.token_b.decimals)==0?"":`${Pe(o.value.feeOwedB,o.value.token_b.decimals)} ${o.value.token_b.symbol}`;de(i("newAdd.claimWaitingText",{from:v.value?m:r,and:Z(o.value.feeOwedA,o.value.token_a.decimals)==0||Z(o.value.feeOwedB,o.value.token_b.decimals)==0?"":"and",to:v.value?r:m})),z(!0);let I;const w={pool:o.value.poolInfo,position:o.value};try{const j=await h.value.getCollectFeeTransactionPayload(w);if(u.value==="Aptos")I=await H.value.currentWallet.signAndSubmitTransaction(j);else{const D=await H.value.currentWallet.signAndExecuteTransactionBlock(j);I=h.value.handleTx(D)}if(I){ee(I.hash),z(!1),l(!0);const D={title:"Claim",desc:"",hash:I.hash,tit:"Fees Claimed",icon:"icon-icon-Removed",tokenInfo:{tokena:`${o.value.token_a.address}`,numa:Z(o.value.feeOwedA,o.value.token_a.decimals)==0?"":`${Pe(o.value.feeOwedA,o.value.token_a.decimals)}`,logoa:Z(o.value.feeOwedA,o.value.token_a.decimals)==0?"":c.value.tokensObj&&o.value&&o.value.token_a.address&&c.value.tokensObj[o.value.token_a.address]&&c.value.tokensObj[o.value.token_a.address].logoURI,tokenb:`${o.value.token_b.address}`,numb:Z(o.value.feeOwedB,o.value.token_b.decimals)==0?"":`${Pe(o.value.feeOwedB,o.value.token_b.decimals)}`,logob:Z(o.value.feeOwedB,o.value.token_b.decimals)==0?"":c.value.tokensObj&&o.value&&o.value.token_b.address&&c.value.tokensObj[o.value.token_b.address]&&c.value.tokensObj[o.value.token_b.address].logoURI},text:`Claim ${Z(o.value.feeOwedA,o.value.token_a.decimals)==0?"":`${Pe(o.value.feeOwedA,o.value.token_a.decimals)} ${o.value.token_a.symbol}`}  
              ${Z(o.value.feeOwedA,o.value.token_a.decimals)==0||Z(o.value.feeOwedB,o.value.token_b.decimals)==0?"":"and"} ${Z(o.value.feeOwedB,o.value.token_b.decimals)==0?"":`${Pe(o.value.feeOwedB,o.value.token_b.decimals)} ${o.value.token_b.symbol}`}

            `};u.value!=="Aptos"&&(D.res=I.res),h.value.showTransitionPending(D);const P=await h.value.watchTransaction(D);console.log("0310##toClaim###transitionStatus####",P),P&&setTimeout(()=>{n.emit("getDetails")},1e3)}else z(!1),K(!0),s.error({icon:Xe("svg",{class:{icon:!0},"aria-hidden":!0},[Xe("use",{"xlink:href":"#icon-a-icon-Shutdown"})]),duration:4.5,message:Xe("div",{class:"notification-title"},[Xe("span",{innerHTML:So.global.t("newAdd.claimFailed")},null)]),description:i("newAdd.somethingWrong"),class:"ant-notification-copy ant-notification-error"});te.value=!1,console.log("claim####test###",I)}catch(j){console.log("claim###error####",j),te.value=!1,z(!1),K(!0),s.error({icon:Xe("svg",{class:{icon:!0},"aria-hidden":!0},[Xe("use",{"xlink:href":"#icon-a-icon-Shutdown"})]),message:Xe("div",{class:"notification-title"},[Xe("span",{innerHTML:So.global.t("newAdd.claimFailed")},null)]),duration:4.5,description:i("newAdd.somethingWrong"),class:"ant-notification-copy ant-notification-error"})}},claimAll:J,fromCoin:d,toCoin:p,showNum:Pe,claimLoading:te,addCommom:Z,afterBase:se,afterQuote:V,fromCoinAmount:be,toCoinAmount:U,checkNullObj:ge,getCoinIcon:fe,chainName:u,isShowAfterAmount:we,pendingRewarderAmount:k,toClaimRewards:re,rewarderLoading:ne}}});const Et={class:"liquidity-card"},Dt={class:"liquidity-title"},Ft={class:"liquidity-usd"},Wt=a("span",null,"Liquidity",-1),Ht={class:"liquidity-ratio"},Xt={class:"coin-ratio"},Gt={class:"coin-a-ratio"},zt={class:"coin-b-ratio"},Yt={class:"ratio-progress"},Jt={class:"base-quote-num"},Qt={class:"base-coin-num"},Zt=a("span",null,"Base",-1),Kt={alt:""},Vt={key:0,class:"after"},xt={class:"quote-coin-num"},ei=a("span",null,"Quote",-1),oi={alt:""},ni={key:0,class:"after"},ti={class:"pending-yield"},ii={class:"left"},ai={class:"pending-yield-title"},si={key:0,class:"after"},li={class:"right"},ui={class:"fees-rewards"},ri={class:"fees-rewards-item"},di=a("span",null,"Fees",-1),ci={key:0,class:"after"},vi=a("span",null,"Fees",-1),mi={key:0,class:"after"},fi=a("span",null,"Bonus",-1),pi={alt:""},hi={key:0,class:"after"},gi={key:0,class:"pending-yield"},bi={class:"left"},ki=a("div",{class:"pending-yield-title"},"Pending rewards",-1),yi={key:0,class:"after"},wi={class:"right"},Ai={key:1,class:"fees-rewards"},_i={class:"fees-rewards-item"},Ii=a("span",null,"Bonus",-1),Ci={alt:""},Si={key:0,class:"after"};function $i(e,n,i,s,R,C){var d,p,u,h,G,te,ie,L,v,f,W,t,k,_,y,l,K,z,de,ee,q,H,J,ne,re,x,se,V,be,U,fe,we,De,r,m,I,w,j,D,P,F,X,le,ce,ke,Ae,$,N,ue,ye,b,Y,T,ae,oe,pe,Ne,Ce,Te,Le,Me,We,Re,Ue;const O=ao,c=ro,o=Mo("image");return S(),M("div",Et,[a("div",Dt,[a("div",Ft,[Wt,a("div",null,"$"+E(e.amountUSD),1)]),a("div",Ht,[a("div",Xt,[a("div",Gt,[a("span",null,E(e.needReverse?(p=e.toCoin)==null?void 0:p.symbol:(d=e.fromCoin)==null?void 0:d.symbol),1),Ie(" "+E(e.needReverse?(h=e.positionInfo)==null?void 0:h.toPercent:(u=e.positionInfo)==null?void 0:u.fromPercent)+"% ",1)]),a("div",zt,[a("span",null,E(e.needReverse?(te=e.fromCoin)==null?void 0:te.symbol:(G=e.toCoin)==null?void 0:G.symbol),1),Ie(" "+E(e.needReverse?(L=e.positionInfo)==null?void 0:L.fromPercent:(ie=e.positionInfo)==null?void 0:ie.toPercent)+"% ",1)])]),a("div",Yt,[a("div",{class:"from-percent",style:$o({width:e.needReverse?((f=e.positionInfo)==null?void 0:f.toPercent)+"%":((v=e.positionInfo)==null?void 0:v.fromPercent)+"%"})},null,4),a("div",{class:"to-percent",style:$o({width:e.needReverse?((t=e.positionInfo)==null?void 0:t.fromPercent)+"%":((W=e.positionInfo)==null?void 0:W.toPercent)+"%"})},null,4)])])]),a("div",Jt,[a("div",Qt,[Zt,a("div",null,[qe(a("img",Kt,null,512),[[o,(e.needReverse?(_=e.toCoin)==null?void 0:_.logo_url:(k=e.fromCoin)==null?void 0:k.logo_url)||e.getCoinIcon(e.needReverse?(l=e.positionInfo)==null?void 0:l.token_b:(y=e.positionInfo)==null?void 0:y.token_a)]]),ve(O,{address:e.needReverse?(ee=(de=e.positionInfo)==null?void 0:de.token_b)==null?void 0:ee.address:(z=(K=e.positionInfo)==null?void 0:K.token_a)==null?void 0:z.address,"style-params":{width:"10px",height:"10px",left:"15px",bottom:"8px"}},null,8,["address"]),a("span",null,E(("addCommom"in e?e.addCommom:Q(Z))(("decimalUi"in e?e.decimalUi:Q(he))(e.needReverse?(H=e.positionInfo)==null?void 0:H.amountB:(q=e.positionInfo)==null?void 0:q.amountA,e.needReverse?(x=(re=e.positionInfo)==null?void 0:re.token_b)==null?void 0:x.decimals:(ne=(J=e.positionInfo)==null?void 0:J.token_a)==null?void 0:ne.decimals))),1)]),e.afterBase&&!("checkNullObj"in e?e.checkNullObj:Q(ge))(e.positionInfo)?(S(),M("div",Vt,E(("addCommom"in e?e.addCommom:Q(Z))(e.afterBase))+" after ",1)):me("",!0)]),a("div",xt,[ei,a("div",null,[qe(a("img",oi,null,512),[[o,(e.needReverse?(V=e.fromCoin)==null?void 0:V.logo_url:(se=e.toCoin)==null?void 0:se.logo_url)||e.getCoinIcon(e.needReverse?(U=e.positionInfo)==null?void 0:U.token_a:(be=e.positionInfo)==null?void 0:be.token_b)]]),ve(O,{address:e.needReverse?(r=(De=e.positionInfo)==null?void 0:De.token_a)==null?void 0:r.address:(we=(fe=e.positionInfo)==null?void 0:fe.token_b)==null?void 0:we.address,"style-params":{width:"10px",height:"10px",left:"15px",bottom:"8px"}},null,8,["address"]),a("span",null,E(("addCommom"in e?e.addCommom:Q(Z))(("decimalUi"in e?e.decimalUi:Q(he))(e.needReverse?(I=e.positionInfo)==null?void 0:I.amountA:(m=e.positionInfo)==null?void 0:m.amountB,e.needReverse?(P=(D=e.positionInfo)==null?void 0:D.token_a)==null?void 0:P.decimals:(j=(w=e.positionInfo)==null?void 0:w.token_b)==null?void 0:j.decimals))),1)]),e.afterQuote&&!("checkNullObj"in e?e.checkNullObj:Q(ge))(e.positionInfo)?(S(),M("div",ni,E(("addCommom"in e?e.addCommom:Q(Z))(e.afterQuote))+" after ",1)):me("",!0)])]),a("div",ti,[a("div",ii,[a("div",ai,E(e.chainName=="Sui"?"Pending Yield":"Pending fees"),1),a("div",null,[Ie(" $"+E(e.pendingYieldAmount>0&&e.pendingYieldAmount<.01?"<0.01":("addCommom"in e?e.addCommom:Q(Z))(e.pendingYieldAmount,2))+" ",1),e.pendingYieldAmount>0?(S(),M("span",si,"$0 after")):me("",!0)])]),a("div",li,[ve(c,{class:"claim-all",loading:e.claimLoading,disabled:e.claimLoading||e.pendingYieldAmount==0,onClick:n[0]||(n[0]=Se=>e.chainName=="Sui"?e.claimAll():e.toClaim())},{default:Ye(()=>[Ie("Claim")]),_:1},8,["loading","disabled"])])]),a("div",ui,[a("div",ri,[a("div",null,[di,a("div",null,[qe(a("img",null,null,512),[[o,(e.needReverse?(X=e.toCoin)==null?void 0:X.logo_url:(F=e.fromCoin)==null?void 0:F.logo_url)||e.getCoinIcon(e.needReverse?(ce=e.positionInfo)==null?void 0:ce.token_b:(le=e.positionInfo)==null?void 0:le.token_a)]]),ve(O,{address:e.needReverse?(N=($=e.positionInfo)==null?void 0:$.token_b)==null?void 0:N.address:(Ae=(ke=e.positionInfo)==null?void 0:ke.token_a)==null?void 0:Ae.address,"style-params":{width:"10px",height:"10px",left:"15px",bottom:"8px"}},null,8,["address"]),a("span",null,E(e.needReverse?("showNum"in e?e.showNum:Q(Pe))(e.positionInfo.feeOwedB,(Y=(b=e.positionInfo)==null?void 0:b.token_b)==null?void 0:Y.decimals):("showNum"in e?e.showNum:Q(Pe))(e.positionInfo.feeOwedA,(ye=(ue=e.positionInfo)==null?void 0:ue.token_a)==null?void 0:ye.decimals)),1)]),(e.fromCoinAmount||e.toCoinAmount)&&!("checkNullObj"in e?e.checkNullObj:Q(ge))(e.positionInfo)&&e.isShowAfterAmount?(S(),M("div",ci," 0 after ")):me("",!0)]),a("div",null,[vi,a("div",null,[qe(a("img",null,null,512),[[o,(e.needReverse?(ae=e.fromCoin)==null?void 0:ae.logo_url:(T=e.toCoin)==null?void 0:T.logo_url)||e.getCoinIcon(e.needReverse?(pe=e.positionInfo)==null?void 0:pe.token_a:(oe=e.positionInfo)==null?void 0:oe.token_b)]]),ve(O,{address:e.needReverse?(Le=(Te=e.positionInfo)==null?void 0:Te.token_a)==null?void 0:Le.address:(Ce=(Ne=e.positionInfo)==null?void 0:Ne.token_b)==null?void 0:Ce.address,"style-params":{width:"10px",height:"10px",left:"15px",bottom:"8px"}},null,8,["address"]),a("span",null,E(e.needReverse?("showNum"in e?e.showNum:Q(Pe))(e.positionInfo.feeOwedA,(Ue=(Re=e.positionInfo)==null?void 0:Re.token_a)==null?void 0:Ue.decimals):("showNum"in e?e.showNum:Q(Pe))(e.positionInfo.feeOwedB,(We=(Me=e.positionInfo)==null?void 0:Me.token_b)==null?void 0:We.decimals)),1)]),(e.fromCoinAmount||e.toCoinAmount)&&!("checkNullObj"in e?e.checkNullObj:Q(ge))(e.positionInfo)&&e.isShowAfterAmount?(S(),M("div",mi," 0 after ")):me("",!0)]),e.chainName=="Sui"?(S(!0),M(po,{key:0},ho(e.pendingRewarderArr,Se=>(S(),M("div",{key:Se},[fi,a("div",null,[qe(a("img",pi,null,512),[[o,Se.logo_url]]),ve(O,{address:Se.address,"style-params":{width:"10px",height:"10px",left:"15px",bottom:"8px"}},null,8,["address"]),a("span",null,E(Se.amount),1)]),(e.fromCoinAmount||e.toCoinAmount)&&!("checkNullObj"in e?e.checkNullObj:Q(ge))(e.positionInfo)&&e.isShowAfterAmount?(S(),M("div",hi," 0 after ")):me("",!0)]))),128)):me("",!0)])]),e.chainName=="Aptos"&&e.pendingRewarderAmount>0?(S(),M("div",gi,[a("div",bi,[ki,a("div",null,[Ie(" $"+E(e.pendingRewarderAmount>0&&e.pendingRewarderAmount<.01?"<0.01":("addCommom"in e?e.addCommom:Q(Z))(e.pendingRewarderAmount,2))+" ",1),e.pendingRewarderAmount>0?(S(),M("span",yi,"$0 after")):me("",!0)])]),a("div",wi,[ve(c,{class:"claim-all",loading:e.rewarderLoading,disabled:e.rewarderLoading||e.pendingRewarderAmount==0,onClick:e.toClaimRewards},{default:Ye(()=>[Ie("Claim")]),_:1},8,["loading","disabled","onClick"])])])):me("",!0),e.chainName=="Aptos"&&e.pendingRewarderAmount>0?(S(),M("div",Ai,[a("div",_i,[(S(!0),M(po,null,ho(e.pendingRewarderArr,Se=>(S(),M("div",{key:Se},[Ii,a("div",null,[qe(a("img",Ci,null,512),[[o,Se.logo_url]]),ve(O,{address:Se.address,"style-params":{width:"10px",height:"10px",left:"15px",bottom:"8px"}},null,8,["address"]),a("span",null,E(Se.amount),1)]),(e.fromCoinAmount||e.toCoinAmount)&&!("checkNullObj"in e?e.checkNullObj:Q(ge))(e.positionInfo)&&e.isShowAfterAmount?(S(),M("div",Si," 0 after ")):me("",!0)]))),128))])])):me("",!0)])}const Xo=Ze(jt,[["render",$i]]),Ti=Qe({components:{AssetsCard:co},setup(e,n){const i=B(""),s=B(""),R=Je(),C=A(()=>R),O=A(()=>C.value.theme),c=no(),o=A(()=>c),d=B(!1),p=B(!1),u=B(!0),h=A(()=>C.value.chainName),G=A(()=>h.value?oo(h.value):{}),te=so(),ie=A(()=>te),L=A(()=>C.value.slippage),v=B(),f=B(),W=A(()=>ie.value.assets&&v.value&&ie.value.assets[v.value.address]?Io(ie.value.assets[v.value.address].balance,v.value.decimals):0),t=A(()=>ie.value.assets&&f.value&&ie.value.assets[f.value.address]?Io(ie.value.assets[f.value.address].balance,f.value.decimals):0),k=w=>{w==="fromCoin"?(u.value=!0,h.value==="Aptos"?i.value=W.value>0?v.value.symbol=="APT"?new g(Number(W.value)).sub(new g(.1)).lt(new g(0))?"0":new g(Number(W.value)).sub(new g(.1)).toString():String(W.value):"":i.value=W.value>0?v.value.symbol=="SUI"?new g(Number(W.value)).sub(new g(.05)).lt(new g(0))?"0":new g(Number(W.value)).sub(new g(.05)).toString():String(W.value):""):(u.value=!1,h.value==="Aptos"?s.value=t.value>0?f.value.symbol=="APT"?new g(Number(t.value)).sub(new g(.1)).lt(new g(0))?"0":new g(Number(t.value)).sub(new g(.1)).toString():String(t.value):"":s.value=t.value>0?f.value.symbol=="SUI"?new g(Number(t.value)).sub(new g(.05)).lt(new g(0))?"0":new g(Number(t.value)).sub(new g(.05)).toString():String(t.value):"")},_=w=>{w==="fromCoin"?(u.value=!0,i.value=je(new g(Number(W.value)).div(2).toString(),v.value.decimals).toString()):(u.value=!1,s.value=je(new g(Number(t.value)).div(2).toString(),f.value.decimals).toString())},y=B({}),l=B(!0),K=B({}),z=B(),de=B(),ee=()=>{var N;if(!y.value||!i.value&&!s.value)return;const{TickMath:w,TickUtil:j}=G.value;console.log(i.value,s.value,"====>369"),console.log(y.value,"===>positionInfo.value339");let D=y.value.minPrice,P=y.value.maxPrice.indexOf("+")>0?"∞":y.value.maxPrice;console.log(y.value,"positionInfo.value====>");let F=Number(y.value.tick_lower_index),X=Number(y.value.tick_upper_index);const le=Number(y.value.current_tick_index);let ce,ke,Ae=Number(D).toString(),$=y.value.maxPrice.indexOf("+")>0||y.value.maxPrice==="∞"?"∞":Number(P);if(Ae=="0"&&$=="∞"?(F=Number(y.value.tick_lower_index),X=Number(y.value.tick_upper_index)):(ce=w.priceToSqrtPriceX64(new g(D),v.value.decimals,f.value.decimals),ke=w.priceToSqrtPriceX64(new g(P),v.value.decimals,f.value.decimals)),z.value=F,de.value=X,console.log(F,X,"tick_lowertick_lower"),P!=="∞"&&F>=X){d.value=!0,i.value="",p.value=!0,s.value="";return}if(P=="∞"||le>=F&&le<=X){console.log("0413###increase###11111"),d.value=!1,p.value=!1;let ue;if(i.value||s.value){if(u.value){const oe=new g(i.value).mul(Math.pow(10,v.value.decimals)).toString();ue=new Oe(oe)}else{const oe=new g(s.value).mul(Math.pow(10,f.value.decimals)).toString();ue=new Oe(oe)}const{liquidityAmount:ye,tokenMaxA:b,tokenMaxB:Y,tokenMaxAOrigin:T,tokenMaxBOrigin:ae}=G.value.estLiquidityAndcoinAmountFromOneAmounts({tokenA:v.value,tokenB:f.value,lowerTick:F,upperTick:X,coinAmount:ue,iscoinA:l.value?u.value:!u.value,roundUp:!0,slippage:Number(L.value)/100,curSqrtPrice:new Oe(y.value.current_sqrt_price)});K.value={liquidityAmount:ye,tokenMaxA:b,tokenMaxB:Y,tokenMaxAOrigin:T,tokenMaxBOrigin:ae},l.value?u.value?s.value=Number(Y)>0?Y:"":i.value=Number(b)>0?b:"":u.value?s.value=b:i.value=Y}}else if(le>X){if(console.log("0413###increase###22222"),i.value="",d.value=!0,p.value=!1,i.value||s.value){let ue;const ye=new g(s.value).mul(Math.pow(10,(N=f.value)==null?void 0:N.decimals)).toString();ue=new Oe(ye),K.value={liquidityAmount:Oo(ce,ke,ue),tokenMaxA:0,tokenMaxB:s.value}}}else if(le<F){if(console.log("0413###increase###33333"),d.value=!1,p.value=!0,s.value="",i.value||s.value){let ue;const ye=new g(i.value).mul(Math.pow(10,v.value.decimals)).toString();ue=new Oe(ye),K.value={liquidityAmount:qo(ce,ke,ue),tokenMaxA:i.value,tokenMaxB:0}}}else console.log("0413###increase###4444"),d.value=!0,i.value="",p.value=!0,s.value="";c.setPositionActionAmount({fromCoinAmount:i,toCoinAmount:s}),console.log(K.value.liquidityAmount,"====>liquidityInput.value.liquidityAmount")};_e(()=>o.value.currentPositionInfo,w=>{if(w&&!ge(w)){y.value=w,console.log(w,"newVal===>"),v.value=y.value.token_a,f.value=y.value.token_b;let j=Number(y.value.tick_lower_index),D=Number(y.value.tick_upper_index);const P=Number(y.value.current_tick_index);(w.maxPrice.indexOf("+")>0||w.maxPrice==="∞"?"∞":w.maxPrice)=="∞"||P>=j&&P<=D?(d.value=!1,p.value=!1):P>D?(i.value="",d.value=!0,p.value=!1):P<j?(d.value=!1,p.value=!0,s.value=""):(d.value=!0,i.value="",p.value=!0,s.value=""),ee()}},{immediate:!0}),_e(i,(w,j)=>{w&&ee(),w==""&&(s.value="")}),_e(s,(w,j)=>{w&&ee(),w==""&&(i.value="")});const q=A(()=>{var w,j,D,P;return console.log((j=(w=y.value)==null?void 0:w.poolInfo)==null?void 0:j.needReverse,"===>positionInfo.value?.poolInfo?.needReverse"),(P=(D=y.value)==null?void 0:D.poolInfo)==null?void 0:P.needReverse}),H=A(()=>o.value.RATES),J=A(()=>{var X,le,ce,ke;const w=((le=H.value[(X=v.value)==null?void 0:X.address])==null?void 0:le.price)||0,j=((ke=H.value[(ce=f.value)==null?void 0:ce.address])==null?void 0:ke.price)||0,D=new g(w).mul(new g(i.value||0)),P=new g(j).mul(new g(s.value||0)),F=D.add(P);return console.log(w,j,D.toString(),P.toString(),"====>amount"),F.toNumber()?F.toNumber()>0&&F.toNumber()>.01?Z(F.toString(),2):"<0.01":"--"}),ne=B(!1),{t:re,locale:x}=_o(),se=A(()=>{const w=Number(i.value)>Number(W.value),j=Number(s.value)>Number(t.value);return!i.value&&!s.value?re("button.enterAmount"):w?re("button.insufficientBalance",{name:v.value.symbol}):j?re("button.insufficientBalance",{name:f.value.symbol}):re("newAdd.addMore")}),V=A(()=>{const w=Number(i.value)>Number(W.value),j=Number(s.value)>Number(t.value);return!!(!i.value&&!s.value||w||j)}),{setIsShowSuccess:be,setIsShowRejected:U,setIsShowWaiting:fe,setTransactionDesc:we,setTransactionTxid:De,setPositiomNum:r}=R,m=B(!1);return{theme:O,showFromCoinLock:d,showToCoinLock:p,toCoinAmount:s,fromCoinAmount:i,fromCoinBlance:W,toCoinBlance:t,fromCoin:v,toCoin:f,maxBtnSelect:k,halfBtnSelect:_,fixedFromCoin:u,needReverse:q,totalAmount:J,wallet:ie,addLiquidityBtnText:se,isShowLiquidityModal:ne,indexStore:R,positionInfo:y,actionLoading:m,toAdd:async()=>{var X,le,ce,ke,Ae,$,N,ue,ye,b,Y,T;ne.value=!1,m.value=!0,De("");const w=d.value?"":`${i.value} ${(X=v.value)==null?void 0:X.symbol}`,j=p.value?"":`${s.value} ${(le=f.value)==null?void 0:le.symbol}`;we(re("tips.increaseLiquiditySuccess",{from:q.value?j:w,and:!d.value&&!p.value?"and":"",to:q.value?w:j})),fe(!0);const D=u.value;console.log(D,"===>fix_amount_a"),console.log(z.value,"tickLower.value===>"),console.log(de.value,"tickUpper.value,===>"),console.log("0222###increase###positionInfo###",y);const P=y.value.poolInfo.rewarder_infos;let F={};F.coinTypeC=P[0]?P[0].coinAddress:"",F.coinTypeD=P[1]?P[1].coinAddress:"",F.coinTypeE=P[2]?P[2].coinAddress:"",console.log("0103 toAdd positionInfo: ",y),console.log("0103 toAdd liquidityInput: ",K);try{const ae=await G.value.getAddLiquidityTransactionPayload({pool:{poolAddress:y.value.poolAddress,token_a:y.value.token_a,token_b:y.value.token_b},amount:D?K.value.tokenMaxA:K.value.tokenMaxB,fix_amount_a:D,tick_lower:z.value,tick_upper:de.value,index:h.value==="Aptos"?y.value.index:y.value.pos_object_id,slippage:Number(L.value)/100,roundUp:!0,collect_fee:!0,...F,curSqrtPrice:new Oe(y==null?void 0:y.value.poolInfo.current_sqrt_price),positionInfo:y,liquidityAmount:(ke=(ce=K==null?void 0:K.value)==null?void 0:ce.liquidityAmount)==null?void 0:ke.toString()});console.log(ae,"===>payloadAdd11111");let oe;if(h.value==="Aptos")oe=await ie.value.currentWallet.signAndSubmitTransaction(ae);else{const pe=await ie.value.currentWallet.signAndExecuteTransactionBlock(ae);oe=G.value.handleTx(pe)}if(console.log("toAdd###tx###",oe),oe&&oe.hash){De(oe.hash),fe(!1),be(!0),console.log(y,"===>positionInfo");const pe={title:"Supplied",desc:re("tips.addLiquiditySuccessText",{from:d.value?"":`${i.value} ${(Ae=v.value)==null?void 0:Ae.symbol}`,and:!d.value&&!p.value?"and":"",to:p.value?"":`${s.value} ${($=f.value)==null?void 0:$.symbol}`}),hash:oe.hash,tit:"Liquidity Increased",icon:"icon-icon-Increased",tokenInfo:{tokena:q.value?`${(ue=f.value)==null?void 0:ue.address}`:`${(N=v.value)==null?void 0:N.address}`,numa:q.value?`- ${s.value}`:`- ${i.value}`,logoa:q.value?o.value.tokensObj&&f.value&&f.value.address&&o.value.tokensObj[f.value.address]&&o.value.tokensObj[f.value.address].logoURI:o.value.tokensObj&&v.value&&v.value.address&&o.value.tokensObj[v.value.address]&&o.value.tokensObj[v.value.address].logoURI,tokenb:q.value?`${(b=v.value)==null?void 0:b.address}`:`${(ye=f.value)==null?void 0:ye.address}`,numb:q.value?`- ${i.value}`:`- ${s.value}`,logob:q.value?o.value.tokensObj&&v.value&&v.value.address&&o.value.tokensObj[v.value.address]&&o.value.tokensObj[v.value.address].logoURI:o.value.tokensObj&&f.value&&f.value.address&&o.value.tokensObj[f.value.address]&&o.value.tokensObj[f.value.address].logoURI},text:`Deopsit ${d.value?"":`${i.value} ${(Y=v.value)==null?void 0:Y.symbol}`} ${!d.value&&!p.value?"and":""} ${p.value?"":`${s.value} ${(T=f.value)==null?void 0:T.symbol}`}`};h.value!=="Aptos"&&(pe.res=oe.res),G.value.showTransitionPending(pe),await G.value.watchTransaction(pe)&&setTimeout(()=>{n.emit("getDetails"),G.value.getAccount(ie.value.address)},1e3),r()}else fe(!1),U(!0);i.value="",s.value="",m.value=!1}catch(ae){i.value="",s.value="",console.log("addError###",ae),m.value=!1,fe(!1),U(!0)}},addLiquidityBtnDisabled:V,poolStore:c}}});const Pi={class:"new-position-asset"},Ni={class:"add-or-remove"},Ri={class:"liquidity-action-tab"},Oi=a("div",{class:"increase tab-active"}," Increase ",-1),qi={class:"card-item"},Bi={class:"card-item"},Li={key:0,class:"add",src:un},Mi={key:1,class:"add",src:rn},Ui={class:"total-amount"},ji=a("span",null,"Total Amount",-1);function Ei(e,n,i,s,R,C){var p;const O=co,c=sn,o=ro,d=ln;return S(),M("div",Pi,[a("div",Ni,[a("div",Ri,[Oi,a("div",{class:"remove",onClick:n[0]||(n[0]=u=>e.poolStore.setPositionDetailCurrentTab("remove"))}," Remove ")]),a("div",{class:go(e.needReverse?"card-container reverse":"card-container")},[a("div",qi,[ve(O,{modelValue:e.fromCoinAmount,"onUpdate:modelValue":n[1]||(n[1]=u=>e.fromCoinAmount=u),"input-value":e.fromCoinAmount,"coin-symbol":e.fromCoin?e.fromCoin.symbol:null,"coin-name":e.fromCoin?e.fromCoin.name:null,balance:e.fromCoinBlance,"coin-icon":e.fromCoin?e.fromCoin.logoURI:"",address:e.fromCoin?e.fromCoin.address:"","swap-direct":"From","import-page":"deposit","has-arrow":!1,onOnMax:n[2]||(n[2]=u=>e.maxBtnSelect("fromCoin")),onOnHalf:n[3]||(n[3]=u=>e.halfBtnSelect("fromCoin")),onOnInput:n[4]||(n[4]=u=>{e.fromCoinAmount=u}),onOnFocus:n[5]||(n[5]=()=>{e.fixedFromCoin=!0})},null,8,["modelValue","input-value","coin-symbol","coin-name","balance","coin-icon","address"]),e.showFromCoinLock?(S(),Be(c,{key:0,"from-coin":e.fromCoin,"to-coin":e.toCoin},null,8,["from-coin","to-coin"])):me("",!0)]),a("div",Bi,[ve(O,{modelValue:e.toCoinAmount,"onUpdate:modelValue":n[6]||(n[6]=u=>e.toCoinAmount=u),"input-value":e.toCoinAmount,"coin-symbol":e.toCoin?e.toCoin.symbol:null,"coin-name":e.toCoin?e.toCoin.name:null,balance:e.toCoinBlance,"swap-direct":"To","coin-icon":e.toCoin?e.toCoin.logoURI:"",address:e.toCoin?e.toCoin.address:"","import-page":"deposit","has-arrow":!1,onOnMax:n[7]||(n[7]=u=>e.maxBtnSelect("toCoin")),onOnHalf:n[8]||(n[8]=u=>e.halfBtnSelect("toCoin")),onOnInput:n[9]||(n[9]=u=>{e.toCoinAmount=u}),onOnFocus:n[10]||(n[10]=()=>{e.fixedFromCoin=!1})},null,8,["modelValue","input-value","coin-symbol","coin-name","balance","coin-icon","address"]),e.showToCoinLock?(S(),Be(c,{key:0,"from-coin":e.fromCoin,"to-coin":e.toCoin},null,8,["from-coin","to-coin"])):me("",!0)]),e.fromCoin&&e.toCoin&&!e.showToCoinLock&&!e.showFromCoinLock&&e.theme=="default"?(S(),M("img",Li)):me("",!0),e.fromCoin&&e.toCoin&&!e.showToCoinLock&&!e.showFromCoinLock&&e.theme!=="default"?(S(),M("img",Mi)):me("",!0)],2),a("div",Ui,[ji,a("span",null,"$"+E(e.totalAmount),1)])]),e.wallet.connected?(S(),Be(o,{key:0,class:"big-btn liquidity-btn",disabled:e.addLiquidityBtnDisabled,loading:e.actionLoading,onClick:n[11]||(n[11]=u=>e.isShowLiquidityModal=!0)},{default:Ye(()=>[a("span",null,E(e.addLiquidityBtnText),1)]),_:1},8,["disabled","loading"])):(S(),Be(o,{key:1,class:"big-btn",onClick:n[12]||(n[12]=u=>e.wallet.connected?e.isShowLiquidityModal=!0:e.wallet.setIsShowWalletModal(!0))},{default:Ye(()=>[a("span",null,E(e.$t("button.connectWallet")),1)]),_:1})),e.isShowLiquidityModal?(S(),Be(d,{key:2,title:e.$t("button.increase"),"is-increase":!0,"from-coin":e.needReverse?e.toCoin:e.fromCoin,"to-coin":e.needReverse?e.fromCoin:e.toCoin,"from-coin-amount":e.needReverse?e.toCoinAmount:e.fromCoinAmount,"to-coin-amount":e.needReverse?e.fromCoinAmount:e.toCoinAmount,"min-price":e.positionInfo.minPrice,"max-price":e.positionInfo.maxPrice,"current-price":e.positionInfo.currentPrice,"current-price-reverse":1/e.positionInfo.currentPrice,"pool-info":(p=e.positionInfo)==null?void 0:p.poolInfo,"show-from-coin-lock":e.showFromCoinLock,"show-to-coin-lock":e.showToCoinLock,"position-total-amount":e.positionInfo.totalAmountUSD,"fixed-from-coin":!0,"tick-lower":e.positionInfo.tick_lower_index,"tick-upper":e.positionInfo.tick_upper_index,"current-price-tab":"custom",onToAdd:e.toAdd,onOnClose:n[13]||(n[13]=u=>e.isShowLiquidityModal=!1)},null,8,["title","from-coin","to-coin","from-coin-amount","to-coin-amount","min-price","max-price","current-price","current-price-reverse","pool-info","show-from-coin-lock","show-to-coin-lock","position-total-amount","tick-lower","tick-upper","onToAdd"])):me("",!0)])}const yo=Ze(Ti,[["render",Ei]]),Di=Qe({components:{AssetsCard:co},setup(e,n){const i=B(""),s=B(""),R=Je(),C=A(()=>R),O=A(()=>C.value.theme),c=no(),o=A(()=>c),d=B(!1),p=B(!1),u=B(!0),h=A(()=>C.value.chainName),G=A(()=>h.value?oo(h.value):{}),te=so(),ie=A(()=>te),L=A(()=>C.value.slippage),v=B(),f=B(),W=A(()=>{var b,Y;return(Y=(b=l.value)==null?void 0:b.poolInfo)==null?void 0:Y.needReverse}),t=A(()=>{var b;return console.log(l==null?void 0:l.value,"==>positionInfo?.value"),console.log(!W.value,"===>!needReverse.value"),he(l==null?void 0:l.value.amountA,(b=l==null?void 0:l.value.token_a)==null?void 0:b.decimals)}),k=A(()=>{var b;return he(l==null?void 0:l.value.amountB,(b=l==null?void 0:l.value.token_b)==null?void 0:b.decimals)}),_=b=>{b==="fromCoin"?u.value=!0:u.value=!1,J.value=100,re({value:1})},y=b=>{b==="fromCoin"?(u.value=!0,i.value=je(new g(Number(t.value)).div(2).toString(),v.value.decimals).toString()):(u.value=!1,s.value=je(new g(Number(k.value)).div(2).toString(),f.value.decimals).toString()),q.value=!1},l=B({}),K=B(!0),z=B({}),de=B(),ee=B(),q=B(!0),H=()=>{var We;if(q.value||!l.value||!i.value&&!s.value||(console.log(i.value>t.value,Number(s.value)>Number(k.value),"==>toCoinAmount.value"),Number(i.value)>Number(t.value)||Number(s.value)>Number(k.value)))return;if(i.value==t.value&&s.value==k.value){J.value=100,re({value:1}),q.value=!0;return}const{TickMath:b,TickUtil:Y}=G.value;console.log(i.value,s.value,"====>369"),console.log(l.value,"===>positionInfo.value339");let T=l.value.minPrice,ae=l.value.maxPrice.indexOf("+")>0?"∞":l.value.maxPrice;console.log(l.value,"positionInfo.value====>");let oe=Number(l.value.tick_lower_index),pe=Number(l.value.tick_upper_index);const Ne=Number(l.value.current_tick_index);let Ce,Te,Le=Number(T).toString(),Me=l.value.maxPrice.indexOf("+")>0||l.value.maxPrice==="∞"?"∞":Number(ae);if(Le=="0"&&Me=="∞"?(oe=Number(l.value.tick_lower_index),pe=Number(l.value.tick_upper_index)):(Ce=b.priceToSqrtPriceX64(new g(T),v.value.decimals,f.value.decimals),Te=b.priceToSqrtPriceX64(new g(ae),v.value.decimals,f.value.decimals)),de.value=oe,ee.value=pe,console.log(oe,pe,"tick_lowertick_lower"),ae!=="∞"&&oe>=pe){d.value=!0,i.value="",p.value=!0,s.value="";return}if(ae=="∞"||Ne>=oe&&Ne<=pe){console.log("0413###increase###11111"),console.log(i.value,"==>341"),console.log(s.value,"==>341"),d.value=!1,p.value=!1;let Re;if(i.value||s.value){if(u.value){const Ge=new g(i.value).mul(Math.pow(10,v.value.decimals)).toString();Re=new Oe(Ge)}else{const Ge=new g(s.value).mul(Math.pow(10,f.value.decimals)).toString();Re=new Oe(Ge)}const{liquidityAmount:Ue,tokenMaxA:Se,tokenMaxB:He,tokenMaxAOrigin:to,tokenMaxBOrigin:$e}=G.value.estLiquidityAndcoinAmountFromOneAmounts({tokenA:v.value,tokenB:f.value,lowerTick:oe,upperTick:pe,coinAmount:Re,iscoinA:K.value?u.value:!u.value,roundUp:h.value!="Sui",slippage:Number(L.value)/100,curSqrtPrice:new Oe(l.value.current_sqrt_price)});z.value={liquidityAmount:Ue,tokenMaxA:Se,tokenMaxB:He,tokenMaxAOrigin:to,tokenMaxBOrigin:$e},console.log(He,Se,"362===>"),K.value?u.value?s.value=Number(He)>0?He:"":i.value=Number(Se)>0?Se:"":u.value?s.value=Se:i.value=He}}else if(Ne>pe){if(console.log("0413###increase###22222"),i.value="",d.value=!0,p.value=!1,i.value||s.value){let Re;const Ue=new g(s.value).mul(Math.pow(10,(We=f.value)==null?void 0:We.decimals)).toString();Re=new Oe(Ue),z.value={liquidityAmount:Oo(Ce,Te,Re),tokenMaxA:0,tokenMaxB:s.value}}}else if(Ne<oe){if(console.log("0413###increase###33333"),d.value=!1,p.value=!0,s.value="",i.value||s.value){let Re;const Ue=new g(i.value).mul(Math.pow(10,v.value.decimals)).toString();Re=new Oe(Ue),z.value={liquidityAmount:qo(Ce,Te,Re),tokenMaxA:i.value,tokenMaxB:0}}}else console.log("0413###increase###4444"),d.value=!0,p.value=!0;q.value=!1,J.value=new g(z.value.liquidityAmount.toString()).div(l.value.liquidity).mul(100).toNumber().toFixed(2),ne.value=z.value.liquidityAmount,console.log(J.value,"===>sliderVal.value"),console.log(z.value.liquidityAmount,"====>liquidityInput.value.liquidityAmount"),c.setPositionActionAmount({fromCoinAmount:i,toCoinAmount:s}),console.log(J.value,"===>sliderVal.value")},J=B(50),ne=B("0"),re=b=>{if(!q.value)return;q.value=!0;const Y=l.value.token_a.decimals,T=l.value.token_b.decimals,ae=l.value.tick_lower_index,oe=l.value.tick_upper_index,pe=Co.tickIndexToSqrtPriceX64(ae),Ne=Co.tickIndexToSqrtPriceX64(oe);let Ce="";b.value!==1?Ce=new g(l.value.liquidity).mul(b.value).toString():Ce=l.value.liquidity,Ce=je(Ce,0)||"0",ne.value=Ce;const Te=Jo.getCoinAmountFromLiquidity(new Oe(Ce),new Oe(l.value.current_sqrt_price),pe,Ne,h.value!="Sui");console.log(Te.coinA.toString(),Te.coinB.toString(),Y,T,"===>amountInfo");const Le=new g(Te.coinA.toString()).div(Math.pow(10,Y)).toString(),Me=new g(Te.coinB.toString()).div(Math.pow(10,T)).toString();console.log(Le,Me,"amountA121212"),i.value=Number(Le)>0?Le:"",s.value=Number(Me)>0?Me:"",c.setPositionActionAmount({fromCoinAmount:i,toCoinAmount:s})};_e(()=>o.value.currentPositionInfo,b=>{if(b&&!ge(b)){l.value=b,console.log(b,"newVal===>"),v.value=l.value.token_a,f.value=l.value.token_b,re({value:J.value/100});let Y=Number(l.value.tick_lower_index),T=Number(l.value.tick_upper_index);const ae=Number(l.value.current_tick_index);(b.maxPrice.indexOf("+")>0||b.maxPrice==="∞"?"∞":b.maxPrice)=="∞"||ae>=Y&&ae<=T?(d.value=!1,p.value=!1):ae>T?(i.value="",d.value=!0,p.value=!1):ae<Y?(d.value=!1,p.value=!0,s.value=""):(d.value=!0,i.value="",p.value=!0,s.value=""),H()}},{immediate:!0}),_e(i,(b,Y)=>{b&&H(),b==""&&(s.value="",J.value=0)}),_e(s,(b,Y)=>{b&&H(),b==""&&(i.value="",J.value=0)});const x=A(()=>o.value.RATES),se=A(()=>{var pe,Ne,Ce,Te;const b=((Ne=x.value[(pe=v.value)==null?void 0:pe.address])==null?void 0:Ne.price)||0,Y=((Te=x.value[(Ce=f.value)==null?void 0:Ce.address])==null?void 0:Te.price)||0,T=new g(b).mul(new g(i.value||0)),ae=new g(Y).mul(new g(s.value||0)),oe=T.add(ae);return console.log(b,Y,T.toString(),ae.toString(),"====>amount"),Z(oe.toString(),2)}),V=B(!1),{t:be,locale:U}=_o(),fe=A(()=>{const b=Number(i.value)>Number(t.value),Y=Number(s.value)>Number(k.value);return!i.value&&!s.value?be("button.enterAmount"):b||Y?"Invalid Amount":be("button.remove")}),we=A(()=>{const b=Number(i.value)>Number(t.value),Y=Number(s.value)>Number(k.value);return!!(!i.value&&!s.value||b||Y)}),{setIsShowSuccess:De,setIsShowRejected:r,setIsShowWaiting:m,setTransactionDesc:I,setTransactionTxid:w,setPositiomNum:j,setTransactionDescText:D}=R,P=B(!1);_e(J,en((b,Y)=>{b!==Y&&(Number(b)>100?J.value=100:b&&l.value?(console.log("687===>"),J.value=b,re({value:J.value/100})):(i.value="",s.value=""))},300)),_e(L,b=>{b&&l.value&&re({value:J.value/100})});const F=[{name:"25%",value:25},{name:"50%",value:50},{name:"75%",value:75},{name:"MAX",value:100}],X=Uo(),le=A(()=>X),ce=A(()=>le.value.status),ke=B(!1),Ae=b=>{const Y=b.sources;Y.forEach(T=>{const{pool_address:ae,position_index:oe}=JSON.parse(T.blockchainAddress);console.log(ae,oe,"===>pool_address, position_index"),console.log(l.value.poolAddress,l.value.index,"===>positionInfo.value.index"),ae==l.value.poolAddress&&Number(oe)==Number(l.value.index)&&(ke.value=!0)}),console.log(Y,"===>sources")},$=async()=>{await X.getSources();let b;le.value.allSources.forEach(Y=>{const{pool_address:T,position_index:ae}=JSON.parse(Y.blockchainAddress);T==l.value.poolAddress&&ae==l.value.index&&(b=Y.id)}),console.log(b,"sourceID649==>"),X.deleteSource(b)};_e(()=>[le.value.sourceGroups,l.value],([b,Y])=>{b&&b.sources&&b.sources.length>0&&Y&&!ge(Y)&&Ae(b)},{immediate:!0,deep:!0});const N=uo(),ue=lo();return{theme:O,showFromCoinLock:d,showToCoinLock:p,toCoinAmount:s,fromCoinAmount:i,fromCoinBlance:t,toCoinBlance:k,fromCoin:v,toCoin:f,maxBtnSelect:_,halfBtnSelect:y,fixedFromCoin:u,needReverse:W,totalAmount:se,wallet:ie,addLiquidityBtnText:fe,isShowLiquidityModal:V,indexStore:R,positionInfo:l,actionLoading:P,addLiquidityBtnDisabled:we,sliderVal:J,ratioArr:F,setPercent:re,poolStore:c,isSlider:q,toRemove:async()=>{var oe,pe,Ne,Ce,Te,Le,Me,We,Re,Ue,Se,He,to;P.value=!0,w("");const b=Z(i.value,v.value.decimals)==0?"":`${he(i.value,v.value.decimals)} ${v.value.symbol}`,Y=Z(s.value,f.value.decimals)==0?"":`${he(s.value,f.value.decimals)} ${f.value.symbol}`;I(be("tips.removeLiquidiyText",{from:W.value?Y:b,and:Z(i.value,v.value.decimals)==0||Z(s.value,f.value.decimals)==0?"":"and",to:W.value?b:Y})),m(!0),console.log(l.value,"==>positionInfo.value");const T=l.value.poolInfo.rewarder_infos,ae=T&&T.length>0&&h.value=="Sui"||T&&T.length>0&&J.value==100?be("modal.removeLiquidityText1"):be("modal.removeLiquidityText2");D(ae);try{let $e={};$e={pool:{...l.value.poolInfo,coinA:l.value.token_a,coinB:l.value.token_b},coinTypeA:l.value.poolInfo.coinTypeA,coinTypeB:l.value.poolInfo.coinTypeB,position:l.value,delta_liquidity:J.value==100?new Oe(l.value.liquidity):new Oe(je(ne.value,0)),slippage:Number(L.value),rewards_num:T.length},console.log(T,"===>pendingRewarderArr"),$e.coinTypeC=T[0]?T[0].coinAddress:"",$e.coinTypeD=T[1]?T[1].coinAddress:"",$e.coinTypeE=T[2]?T[2].coinAddress:"",console.log($e,"===>params");const Ge=await G.value.getRemoveLiquidityTransactionPayload($e);console.log(Ge,"===>payload");let Ee;if(h.value==="Aptos")Ee=await ie.value.currentWallet.signAndSubmitTransaction(Ge);else{const Ve=await ie.value.currentWallet.signAndExecuteTransactionBlock(Ge);Ee=G.value.handleTx(Ve),console.log("0331###remove###tx####",Ee)}if(Ee&&Ee.hash){w(Ee.hash),m(!1),De(!0);const Ve={title:be("common.removeLiquidity"),desc:"",hash:Ee.hash,descTransactions:`Remove ${i.value} ${(oe=v.value)==null?void 0:oe.symbol} and ${s.value} ${(pe=f.value)==null?void 0:pe.symbol} 
             from the pool`,sender:ie.value.address,chainName:h.value,tit:"Liquidity Removed",icon:"icon-icon-Removed",tokenInfo:{tokena:W.value?`${(Ce=f.value)==null?void 0:Ce.address}`:`${(Ne=v.value)==null?void 0:Ne.address}`,numa:W.value?`+ ${s.value}`:`+ ${i.value}`,logoa:W.value?o.value.tokensObj&&f.value&&f.value.address&&o.value.tokensObj[f.value.address]&&o.value.tokensObj[f.value.address].logoURI:o.value.tokensObj&&v.value&&v.value.address&&o.value.tokensObj[v.value.address]&&o.value.tokensObj[v.value.address].logoURI,tokenb:W.value?`${(Te=v.value)==null?void 0:Te.address}`:`${(Le=f.value)==null?void 0:Le.address}`,numb:W.value?`+ ${i.value}`:`+ ${s.value}`,logob:W.value?o.value.tokensObj&&v.value&&v.value.address&&o.value.tokensObj[v.value.address]&&o.value.tokensObj[v.value.address].logoURI:o.value.tokensObj&&f.value&&f.value.address&&o.value.tokensObj[f.value.address]&&o.value.tokensObj[f.value.address].logoURI},text:`Withdraw ${i.value} ${(Me=v.value)==null?void 0:Me.symbol} and ${s.value} ${(We=f.value)==null?void 0:We.symbol}`};h.value!=="Aptos"&&(Ve.res=Ee.res),G.value.showTransitionPending(Ve);const io=await G.value.watchTransaction(Ve);if(T.value&&T.value.length>0&&(Number((Re=T[0])==null?void 0:Re.amount)!==0||$e.coinTypeD&&Number((Ue=T[1])==null?void 0:Ue.amount)!==0||$e.coinTypeE&&Number((Se=T[2])==null?void 0:Se.amount)!==0)){const vo={title:be("common.removeLiquidity"),desc:"",hash:Ee.hash,tit:"Rewards Claimed",icon:"icon-icon-Removed",tokenInfo:{tokena:T[0].symbol,numa:`+ ${Number(T[0].amount)}`,logoa:o.value.tokensObj&&T[0]&&T[0].address&&o.value.tokensObj[T[0].address]&&o.value.tokensObj[T[0].address].logoURI,tokenb:$e.coinTypeD?T[1].symbol:"",numb:$e.coinTypeD?`+ ${Number(T[1].amount)}`:"",logob:$e.coinTypeD?o.value.tokensObj&&T[1]&&T[1].address&&o.value.tokensObj[T[1].address]&&o.value.tokensObj[T[1].address].logoURI:"",tokenc:$e.coinTypeE?T[2].symbol:"",numc:$e.coinTypeE?`+ ${Number(T[2].amount)}`:"",logoc:$e.coinTypeE?o.value.tokensObj&&T[2]&&T[2].address&&o.value.tokensObj[T[2].address]&&o.value.tokensObj[T[2].address].logoURI:""},text:`Withdraw ${i.value} ${(He=v.value)==null?void 0:He.symbol} and ${s.value} ${(to=f.value)==null?void 0:to.symbol}`},mo=await G.value.setTransations(vo);console.log("9999transitionStatusFees",io,mo)}if(Pe(l.value.feeOwedA,l.value.token_a.decimals)!==0||Pe(l.value.feeOwedB,l.value.token_b.decimals)!==0){const vo={title:"Claim",desc:"",hash:Ee.hash,chainName:h.value,tit:"Fees Claimed",icon:"icon-icon-Removed",tokenInfo:{tokena:`${l.value.token_a.symbol}`,numa:Z(l.value.feeOwedA,l.value.token_a.decimals)==0?"":`+ ${Pe(l.value.feeOwedA,l.value.token_a.decimals)}`,logoa:Z(l.value.feeOwedA,l.value.token_a.decimals)==0?"":o.value.tokensObj&&l.value&&l.value.token_a.address&&o.value.tokensObj[l.value.token_a.address]&&o.value.tokensObj[l.value.token_a.address].logoURI,tokenb:`${l.value.token_b.symbol}`,numb:Z(l.value.feeOwedB,l.value.token_b.decimals)==0?"":`+ ${Pe(l.value.feeOwedB,l.value.token_b.decimals)}`,logob:Z(l.value.feeOwedB,l.value.token_b.decimals)==0?"":o.value.tokensObj&&l.value&&l.value.token_b.address&&o.value.tokensObj[l.value.token_b.address]&&o.value.tokensObj[l.value.token_b.address].logoURI}},mo=await G.value.setTransations(vo);console.log("9999transitionStatusFees",io,mo)}io&&Number(J.value)==100&&ce.value=="authenticated"&&ke.value&&(await X.subscribePosition({pool_address:l.value.poolAddress,position_index:l.value.index},l.value.nftHash,!1),$()),io&&(i.value="",s.value="",setTimeout(()=>{n.emit("getDetails")},3e3),setTimeout(()=>{n.emit("getDetails")},6e3),console.log(J.value,ue.name,h.value,"998===>"),Number(J.value)==100&&ue.name=="new-position-detail"&&(h.value==="Aptos"?N.push("/position"):N.push("/pool/position")),J.value=0)}else m(!1),r(!0);P.value=!1}catch($e){console.log("Remove error",$e),P.value=!1,m(!1),r(!0)}},sFixD:je}}});const Fi={class:"new-position-asset"},Wi={class:"add-or-remove"},Hi={class:"liquidity-action-tab"},Xi=a("div",{class:"remove tab-active"},"Remove",-1),Gi={class:"card-item"},zi={key:0,class:"assets-card-mask"},Yi={class:"card-item"},Ji={key:0,class:"assets-card-mask"},Qi={class:"remove-ratio"},Zi=a("div",{class:"remove-ratio-title"},"Amount",-1),Ki={class:"remove-ratio-select"},Vi={key:0,class:"ratio"},xi={key:1,class:"ratio"},ea={class:"ratio-list"},oa=["onClick"];function na(e,n,i,s,R,C){const O=co,c=on,o=ro;return S(),M("div",Fi,[a("div",Wi,[a("div",Hi,[a("div",{class:"increase",onClick:n[0]||(n[0]=d=>e.poolStore.setPositionDetailCurrentTab("increase"))}," Increase "),Xi]),a("div",{class:go(e.needReverse?"card-container reverse":"card-container")},[a("div",Gi,[ve(O,{modelValue:e.fromCoinAmount,"onUpdate:modelValue":n[1]||(n[1]=d=>e.fromCoinAmount=d),"input-value":e.fromCoinAmount,"coin-symbol":e.fromCoin?e.fromCoin.symbol:null,"coin-name":e.fromCoin?e.fromCoin.name:null,balance:e.fromCoinBlance,"coin-icon":e.fromCoin?e.fromCoin.logoURI:"",address:e.fromCoin?e.fromCoin.address:"","swap-direct":"From","import-page":"deposit","has-arrow":!1,havehalf:!1,"amount-leabl":"Available",onOnMax:n[2]||(n[2]=d=>e.maxBtnSelect("fromCoin")),onOnHalf:n[3]||(n[3]=d=>e.halfBtnSelect("fromCoin")),onOnInput:n[4]||(n[4]=d=>{e.fromCoinAmount=d,e.fixedFromCoin=!0,e.isSlider=!1})},null,8,["modelValue","input-value","coin-symbol","coin-name","balance","coin-icon","address"]),e.fromCoinBlance==0?(S(),M("div",zi)):me("",!0)]),a("div",Yi,[ve(O,{modelValue:e.toCoinAmount,"onUpdate:modelValue":n[5]||(n[5]=d=>e.toCoinAmount=d),"input-value":e.toCoinAmount,"coin-symbol":e.toCoin?e.toCoin.symbol:null,"coin-name":e.toCoin?e.toCoin.name:null,balance:e.toCoinBlance,"swap-direct":"To","coin-icon":e.toCoin?e.toCoin.logoURI:"",address:e.toCoin?e.toCoin.address:"","import-page":"deposit","has-arrow":!1,havehalf:!1,"amount-leabl":"Available",onOnMax:n[6]||(n[6]=d=>e.maxBtnSelect("toCoin")),onOnHalf:n[7]||(n[7]=d=>e.halfBtnSelect("toCoin")),onOnInput:n[8]||(n[8]=d=>{e.toCoinAmount=d,e.fixedFromCoin=!1,e.isSlider=!1})},null,8,["modelValue","input-value","coin-symbol","coin-name","balance","coin-icon","address"]),e.toCoinBlance==0?(S(),M("div",Ji)):me("",!0)])],2),a("div",Qi,[Zi,a("div",Ki,[Number(e.fromCoinBlance)>=Number(e.fromCoinAmount)&&Number(e.toCoinBlance)>=Number(e.toCoinAmount)?(S(),M("div",Vi,E(e.sliderVal>0&&Number(("sFixD"in e?e.sFixD:Q(je))(e.sliderVal,2))<.01?"<0.01":("sFixD"in e?e.sFixD:Q(je))(e.sliderVal,2))+"% ",1)):(S(),M("div",xi," -- ")),a("div",ea,[(S(!0),M(po,null,ho(e.ratioArr,(d,p)=>(S(),M("div",{key:p,class:go(["ratio-item",e.sliderVal==d.value?"ratio-item-active":""]),onClick:()=>{e.isSlider=!0,e.sliderVal=d.value}},E(d.name),11,oa))),128))])]),ve(c,{value:e.sliderVal,"onUpdate:value":n[9]||(n[9]=d=>e.sliderVal=d)},null,8,["value"])])]),e.wallet.connected?(S(),Be(o,{key:0,class:"big-btn liquidity-btn",loading:e.actionLoading,disabled:e.addLiquidityBtnDisabled,onClick:e.toRemove},{default:Ye(()=>[a("span",null,E(e.addLiquidityBtnText),1)]),_:1},8,["loading","disabled","onClick"])):(S(),Be(o,{key:1,class:"big-btn",onClick:n[10]||(n[10]=d=>e.wallet.connected?e.isShowLiquidityModal=!0:e.wallet.setIsShowWalletModal(!0))},{default:Ye(()=>[a("span",null,E(e.$t("button.connectWallet")),1)]),_:1}))])}const ta=Ze(Di,[["render",na]]),ia=Qe({props:{positionInfo:{type:Object,default:()=>({})}},setup(e){const n=Uo(),i=A(()=>n),s=A(()=>i.value.status),R=Je();_e(()=>[i.value.targetGroups],p=>{console.log("0327###watch###newTargetGoups###",p)},{immediate:!0});const C=B(!1);_e(()=>s.value,p=>{p=="authenticated",C.value=!1},{immediate:!0});const O=B(!1),c=async()=>{O.value=!O.value,console.log(O.value,"===>checked.value");const p={pool_address:e.positionInfo.poolAddress,position_index:e.positionInfo.index},u=e.positionInfo.nftHash;console.log("0529###changeSwitch###positionInfo####",e.positionInfo);try{await n.subscribePosition(p,u,O.value)}catch{O.value=!O.value}},o=p=>{const u=p.sources;O.value=u.some(h=>JSON.parse(h.blockchainAddress).pool_address==e.positionInfo.poolAddress&&Number(JSON.parse(h.blockchainAddress).position_index)==Number(e.positionInfo.index))},d=uo();return console.log(d.currentRoute.value.query.token,"===>rouyter"),_e(()=>[i.value.sourceGroups,e.positionInfo],([p,u])=>{var h,G,te;console.log(p,"==>newSourceGroups169"),console.log(u,"===>positionInfo170"),O.value=!1,p&&p.length>0&&p[0]&&u&&!ge(u)&&((te=(G=(h=d==null?void 0:d.currentRoute)==null?void 0:h.value)==null?void 0:G.query)==null?void 0:te.token)==(u==null?void 0:u.name)&&(console.log("触发"),console.log(p,"==>newSourceGroups"),console.log(u,"===>positionInfo"),o(p[0]))},{immediate:!0,deep:!0}),{importIcon:eo,isShowSetUp:C,changeSwitch:c,checked:O,notifiStatus:s,store:R}}});const aa=e=>(wo("data-v-8f838b7e"),e=e(),Ao(),e),sa={class:"range-alerts"},la={class:"range-alerts-top"},ua={class:"title"},ra=aa(()=>a("div",{class:"title-all"},[a("span",{class:"Range"},"Range Alerts")],-1)),da={key:1,class:"h5-switch-box"},ca={class:"range-alerts-bottom"},va={key:0,class:"pc-switch-box"};function ma(e,n,i,s,R,C){const O=ro,c=tn;return S(),M("div",sa,[a("div",la,[a("div",ua,[ra,e.isShowSetUp||e.notifiStatus!=="authenticated"?(S(),Be(O,{key:0,class:"range-alerts-button",onClick:n[0]||(n[0]=nn(o=>e.store.setIsShowNotifi(!0),["stop"]))},{default:Ye(()=>[Ie(" Set up ")]),_:1})):me("",!0),!e.isShowSetUp&&e.notifiStatus=="authenticated"?(S(),M("div",da,[ve(c,{class:"range-alerts-switch",checked:e.checked,disabled:e.notifiStatus!=="authenticated",onChange:e.changeSwitch},null,8,["checked","disabled","onChange"])])):me("",!0)])]),a("div",ca,[Ie(" Receive alerts via Telegram, SMS, or email when this position goes out of range. "),!e.isShowSetUp&&e.notifiStatus=="authenticated"?(S(),M("div",va,[ve(c,{class:"range-alerts-switch",checked:e.checked,disabled:e.notifiStatus!=="authenticated",onChange:e.changeSwitch},null,8,["checked","disabled","onChange"])])):me("",!0)])])}const Go=Ze(ia,[["render",ma],["__scopeId","data-v-8f838b7e"]]),fa=Qe({components:{NewPositionTitle:No,NewPositionInfo:Ho,NewPositionLiquidity:Xo,NewPositionAssetAdd:yo,NewPositionAssetRemove:yo,NewPositionNotifi:Go,FarmsPositionDetail:jo},setup(){const e=B(),n=B(),i=B(),s=Je(),R=A(()=>s),C=A(()=>R.value.chainName),O=no(),c=A(()=>O),o=uo();Bo(()=>{e.value={},O.setPositionActionAmount({fromCoinAmount:"",toCoinAmount:""}),c.value.setCurrentPositionLoading(!0)});const d=async()=>{c.value.setCurrentPositionLoading(!0);const L=o.currentRoute.value.query.token||"",v=o.currentRoute.value.query.collect||"",f=o.currentRoute.value.query.address||"",W=o.currentRoute.value.query.pos||"",t=o.currentRoute.value.query.id||"",k=o.currentRoute.value.query.positionSource||"",_=o.currentRoute.value.query.position_nft_id||"";C.value==="Aptos"?L&&v&&f&&c.value.setCurrentPositionInfo(f,v,L,C.value):(console.log("0414###position-detail###id#####",t),console.log("0414###position-detail###name#####",L),console.log("0414###position-detail###pool_address#####",f),console.log("0414###position-detail###pos#####",W),L&&f&&W?c.value.setCurrentPositionInfo(f,v,L,C.value,W):t?c.value.setCurrentPositionInfo("","","",C.value,t):c.value.setCurrentPositionInfo("","","",C.value,_,k))};_e(()=>c.value.poolConfigObj,L=>{L&&!ge(L)&&d()},{immediate:!0});const p=A(()=>c.value.currentPositionLoading),u=A(()=>{var v,f,W;const L=((W=(f=(v=o==null?void 0:o.currentRoute)==null?void 0:v.value)==null?void 0:f.query)==null?void 0:W.address)||"";return L&&c.value.addressLpTokens&&!ge(c.value.addressLpTokens)&&c.value.addressLpTokens[L]?c.value.addressLpTokens[L]:null});_e(()=>u.value,(L,v)=>{L&&!ge(L)&&(e.value=L),L&&!ge(L)&&L.current_sqrt_price!==(v==null?void 0:v.current_sqrt_price)&&d()},{immediate:!0});const h=lo();_e(()=>[c.value.currentPositionInfo,C.value],([L,v])=>{var f;v=="Aptos"&&L?(e.value=L,n.value=e.value.token_a,i.value=e.value.token_b):v=="Sui"&&L&&(L==null?void 0:L.nftHash)==((f=h==null?void 0:h.query)==null?void 0:f.pos)&&(console.log(L,"==>newVal"),e.value=L,n.value=e.value.token_a,i.value=e.value.token_b)},{immediate:!0});const G=A(()=>c.value.positionDetailCurrentTab),te=so();return A(()=>te),A(()=>R.value.theme),console.log(JSON.stringify(e.value),"===>positionInfo.value135"),{positionInfo:e,fromCoin:n,toCoin:i,getDetails:d,currentPositionLoading:p,positionDetailCurrentTab:G,clickRefresh:()=>{d()},chainName:C}}});const pa={class:"new-position-detail"},ha={class:"new-position-content"},ga={class:"left"},ba={class:"right"},ka={class:"loading-global"};function ya(e,n,i,s,R,C){const O=No,c=Ho,o=Xo,d=yo,p=ta,u=jo,h=Go,G=an;return S(),M("div",pa,[ve(O,{onClickRefresh:e.clickRefresh},null,8,["onClickRefresh"]),a("div",ha,[a("div",ga,[ve(c),ve(o,{class:"pc-module",onGetDetails:e.getDetails},null,8,["onGetDetails"])]),a("div",ba,[e.positionDetailCurrentTab=="increase"?(S(),Be(d,{key:0,onGetDetails:e.getDetails},null,8,["onGetDetails"])):(S(),Be(p,{key:1,onGetDetails:e.getDetails},null,8,["onGetDetails"])),ve(o,{class:"h5-module",onGetDetails:e.getDetails},null,8,["onGetDetails"]),e.positionInfo&&e.positionInfo.positionSource=="farming"?(S(),Be(u,{key:2})):me("",!0),e.positionInfo&&e.positionInfo.minPrice!=="0"&&e.positionInfo.maxPrice!=="∞"&&e.chainName=="Sui"?(S(),Be(h,{key:3,"position-info":e.positionInfo},null,8,["position-info"])):me("",!0)])]),qe(a("div",ka,[ve(G)],512),[[Lo,e.currentPositionLoading]])])}const Qa=Ze(fa,[["render",ya],["__scopeId","data-v-78643f6a"]]);export{Qa as default};
