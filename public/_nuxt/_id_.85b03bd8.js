import{_ as Re}from"./new-position-title.8ed58451.js";import{_ as ie}from"./token-warning.d1ee6fa3.js";import{_ as ye}from"./auto-pool-apy-tips.d0dcd290.js";import{u as Lo,a as M,g as xo,c as Mo,d as le,s as yo,p as pe,b as be,e as Y,T as No,f as qe}from"./pool.b75ae8e9.js";import{u as ae,a as me}from"./sha256.ea1053fd.js";import{u as Do,a as _e}from"./autoPool.2c431d5e.js";import{i as Yo}from"./import-icon.de3e6c66.js";import{a as Uo,l as c,m as Fo,r as I,q as ho,e as Vo,s as ce,o as b,f as N,h as e,t as So,i as E,v as d,j as se,x as ro,u as D,p as Go,k as Zo,y as re,z as ge,A as he,C as de,c as bo,w as zo,B as ke,D as Be,b as Oe,F as Ne,E as Me,G as Le,H as fe}from"./entry.e95e407a.js";import{afterCurrentPrice as oe}from"./data.4db0e0dd.js";import"./decimal.633e31ee.js";import{D as a}from"./decimal.0e8aa3f1.js";import{_ as we}from"./assets-card.7d9ac4ad.js";import{_ as Ie}from"./coin-lock.35316bff.js";import{_ as $e,a as Ce}from"./auto-pool-remove-modal.eae49eaa.js";import{V as ve}from"./index.6ea66758.js";/* empty css              *//* empty css              */import"./back.d98c4068.js";import"./swap-setting.079dd019.js";/* empty css              *//* empty css              *//* empty css              *//* empty css              */import"./img-lock_2x.a28135f4.js";import"./img-lock_2x.eef647c1.js";const De=Uo({components:{AutoPoolApyTips:ye},setup(){const o=ae(),s=c(()=>o),G=Lo(),W=c(()=>G),j=Do(),$=c(()=>j),w=c(()=>s.value.theme),_=Fo(),r=I();ho(()=>[$.value.positionInfoObj,_.params.id],([i,u])=>{i&&!Mo(i)&&u&&(r.value=i[u],console.log(r.value,"##positionInfo.value"))},{immediate:!0,deep:!0});const C=c(()=>{var i;return(i=r.value)==null?void 0:i.needReverse}),t=i=>{var u;return(i==null?void 0:i.logoURI)||(i==null?void 0:i.logo_url)||((u=W.value.tokensObj[i==null?void 0:i.address])==null?void 0:u.logo_url)||(w.value==="default"?Yo("/image/coins/unknown.png"):Yo("/image/coins/sui-unknown.png"))},n=c(()=>{var i,u;return $.value.apyObj&&((u=$.value.apyObj[(i=r.value)==null?void 0:i.id])==null?void 0:u.tvl)||"--"}),k=c(()=>{var i,u;return $.value.apyObj&&((u=$.value.apyObj[(i=r.value)==null?void 0:i.id])==null?void 0:u.apr)||"--"});return{positionInfo:r,needReverse:C,getCoinIcon:t,tvl:n,apy:k,addCommom:M,getExplorerUrl:xo}}});const ko=o=>(Go("data-v-c5a991ac"),o=o(),Zo(),o),Ue={class:"auto-pool-v2-info"},Fe={class:"pool-info"},Ve={class:"left"},Ee={class:"coin-a"},We={alt:""},je={class:"coin-b"},Xe={alt:""},He={class:"position-name"},ze={key:0,class:"pool-fee"},Ye=ko(()=>e("span",null,"Fee tier",-1)),Ge={class:"vault-address"},Ze=ko(()=>e("span",null,"Vault Address",-1)),Je=["href"],Ke=ko(()=>e("svg",{class:"icon","aria-hidden":"true"},[e("use",{"xlink:href":"#icon-icon-link"})],-1)),Qe=[Ke],xe={class:"pool-address"},on=ko(()=>e("span",null,"Pool Address",-1)),en=["href"],nn=ko(()=>e("svg",{class:"icon","aria-hidden":"true"},[e("use",{"xlink:href":"#icon-icon-link"})],-1)),tn=[nn],sn={class:"apy-and-tvl"},ln={class:"apy"},an=ko(()=>e("div",{class:"apy-title"},"APY",-1)),un={class:"apy-text"},rn={class:"tvl"},dn=ko(()=>e("div",{class:"tvl-title"},"TVL",-1)),vn={class:"tvl-text"},mn={class:"pool-info h5-pool-info"},cn={class:"left"},pn={class:"coin-a"},fn={alt:""},yn={class:"coin-b"},bn={alt:""},_n={class:"position-name"},gn={key:0,class:"pool-fee"},hn=ko(()=>e("span",null,"Fee tier",-1)),kn={class:"left"},wn={class:"vault-address"},In=ko(()=>e("span",null,"Vault Address",-1)),$n=["href"],Cn=ko(()=>e("svg",{class:"icon","aria-hidden":"true"},[e("use",{"xlink:href":"#icon-icon-link"})],-1)),An=[Cn],Sn={class:"pool-address"},Pn=ko(()=>e("span",null,"Pool Address",-1)),Tn=["href"],Rn=ko(()=>e("svg",{class:"icon","aria-hidden":"true"},[e("use",{"xlink:href":"#icon-icon-link"})],-1)),qn=[Rn],Bn={class:"apy-and-tvl"},On={class:"apy"},Nn=ko(()=>e("div",{class:"apy-title"},"APY",-1)),Mn={class:"apy-text"},Ln={class:"tvl"},Dn=ko(()=>e("div",{class:"tvl-title"},"TVL",-1)),Un={class:"tvl-text"};function Fn(o,s,G,W,j,$){var C,t,n,k,i,u,f,v,P,S,T,X,g,p,h,F,H,Q,B,y,x,so,lo,io,z,vo,_o,L,mo,Eo,wo,Wo,To,Io,$o,Ro,qo,jo,Xo,ao,po,Ko,m,R,J,V,uo,Z;const w=ie,_=ye,r=ce("image");return b(),N("div",Ue,[e("div",Fe,[e("div",Ve,[e("div",Ee,[So(e("img",We,null,512),[[r,o.needReverse?o.getCoinIcon((t=o.positionInfo)==null?void 0:t.token_b):o.getCoinIcon((C=o.positionInfo)==null?void 0:C.token_a)]]),E(w,{address:o.needReverse?(u=(i=o.positionInfo)==null?void 0:i.token_b)==null?void 0:u.address:(k=(n=o.positionInfo)==null?void 0:n.token_a)==null?void 0:k.address,"style-params":{width:"12px",height:"12px",left:"18px",bottom:"4px"}},null,8,["address"])]),e("div",je,[So(e("img",Xe,null,512),[[r,o.needReverse?o.getCoinIcon((v=o.positionInfo)==null?void 0:v.token_a):o.getCoinIcon((f=o.positionInfo)==null?void 0:f.token_b)]]),E(w,{address:o.needReverse?(X=(T=o.positionInfo)==null?void 0:T.token_a)==null?void 0:X.address:(S=(P=o.positionInfo)==null?void 0:P.token_b)==null?void 0:S.address,"style-params":{width:"12px",height:"12px",left:"18px",bottom:"4px"}},null,8,["address"])]),e("div",He,d(o.needReverse?(p=(g=o.positionInfo)==null?void 0:g.token_b)==null?void 0:p.symbol:(F=(h=o.positionInfo)==null?void 0:h.token_a)==null?void 0:F.symbol)+" - "+d(o.needReverse?(Q=(H=o.positionInfo)==null?void 0:H.token_a)==null?void 0:Q.symbol:(y=(B=o.positionInfo)==null?void 0:B.token_b)==null?void 0:y.symbol),1),(x=o.positionInfo)!=null&&x.fee?(b(),N("div",ze,[Ye,se(" "+d(((so=o.positionInfo)==null?void 0:so.fee)*100)+"% ",1)])):ro("",!0),e("div",Ge,[Ze,e("a",{href:("getExplorerUrl"in o?o.getExplorerUrl:D(xo))("poolAddress",(lo=o.positionInfo)==null?void 0:lo.id),target:"_blank"},Qe,8,Je)]),e("div",xe,[on,e("a",{href:("getExplorerUrl"in o?o.getExplorerUrl:D(xo))("poolAddress",(io=o.positionInfo)==null?void 0:io.address),target:"_blank"},tn,8,en)])]),e("div",sn,[e("div",ln,[an,e("div",un,[se(d(o.apy)+" ",1),E(_)])]),e("div",rn,[dn,e("div",vn,"$"+d(("addCommom"in o?o.addCommom:D(M))(o.tvl,2)),1)])])]),e("div",mn,[e("div",cn,[e("div",pn,[So(e("img",fn,null,512),[[r,o.needReverse?o.getCoinIcon((vo=o.positionInfo)==null?void 0:vo.token_b):o.getCoinIcon((z=o.positionInfo)==null?void 0:z.token_a)]]),E(w,{address:o.needReverse?(Eo=(mo=o.positionInfo)==null?void 0:mo.token_b)==null?void 0:Eo.address:(L=(_o=o.positionInfo)==null?void 0:_o.token_a)==null?void 0:L.address,"style-params":{width:"12px",height:"12px",left:"18px",bottom:"4px"}},null,8,["address"])]),e("div",yn,[So(e("img",bn,null,512),[[r,o.needReverse?o.getCoinIcon((Wo=o.positionInfo)==null?void 0:Wo.token_a):o.getCoinIcon((wo=o.positionInfo)==null?void 0:wo.token_b)]]),E(w,{address:o.needReverse?(Ro=($o=o.positionInfo)==null?void 0:$o.token_a)==null?void 0:Ro.address:(Io=(To=o.positionInfo)==null?void 0:To.token_b)==null?void 0:Io.address,"style-params":{width:"12px",height:"12px",left:"18px",bottom:"4px"}},null,8,["address"])]),e("div",_n,d(o.needReverse?(jo=(qo=o.positionInfo)==null?void 0:qo.token_b)==null?void 0:jo.symbol:(ao=(Xo=o.positionInfo)==null?void 0:Xo.token_a)==null?void 0:ao.symbol)+" - "+d(o.needReverse?(Ko=(po=o.positionInfo)==null?void 0:po.token_a)==null?void 0:Ko.symbol:(R=(m=o.positionInfo)==null?void 0:m.token_b)==null?void 0:R.symbol),1),(J=o.positionInfo)!=null&&J.fee?(b(),N("div",gn,[hn,se(" "+d(((V=o.positionInfo)==null?void 0:V.fee)*100)+"% ",1)])):ro("",!0)]),e("div",kn,[e("div",wn,[In,e("a",{href:("getExplorerUrl"in o?o.getExplorerUrl:D(xo))("poolAddress",(uo=o.positionInfo)==null?void 0:uo.id),target:"_blank"},An,8,$n)]),e("div",Sn,[Pn,e("a",{href:("getExplorerUrl"in o?o.getExplorerUrl:D(xo))("poolAddress",(Z=o.positionInfo)==null?void 0:Z.address),target:"_blank"},qn,8,Tn)])]),e("div",Bn,[e("div",On,[Nn,e("div",Mn,[se(d(o.apy)+" ",1),E(_)])]),e("div",Ln,[Dn,e("div",Un,"$"+d(("addCommom"in o?o.addCommom:D(M))(o.tvl,2)),1)])])])])}const Ae=Vo(De,[["render",Fn],["__scopeId","data-v-c5a991ac"]]),Vn=Uo({setup(){const o=I(!0),s=Lo(),G=c(()=>s),W=Do(),j=c(()=>W),$=Fo(),w=I();ho(()=>[j.value.positionInfoObj,$.params.id],([t,n])=>{t&&!Mo(t)&&n&&(w.value=t[n],console.log(w.value,"##positionInfo.value"))},{immediate:!0,deep:!0});const _=c(()=>{var t;return(t=w.value)==null?void 0:t.needReverse}),r=t=>{var n;return(t==null?void 0:t.logoURI)||(t==null?void 0:t.logo_url)||((n=G.value.tokensObj[t==null?void 0:t.address])==null?void 0:n.logo_url)||Yo("/image/coins/sui-unknown.png")},C=c(()=>{var k;const t=(k=w==null?void 0:w.value)==null?void 0:k.price,n=oe.value;return t&&n?50+new a(n).sub(new a(t)).div(new a(t)).mul(100).toNumber():50});return{direct:o,positionInfo:w,needReverse:_,getCoinIcon:r,decimalUi:le,addCommom:M,sFixD:yo,moveRatio:C}}}),En=""+globalThis.__publicAssetsURL("sui-image/icon_currentprice@2x.png");const Po=o=>(Go("data-v-73e1fd26"),o=o(),Zo(),o),Wn={class:"v2-position-range"},jn={class:"position-range-top"},Xn=Po(()=>e("div",null,"Position Range",-1)),Hn={class:"base-coin"},zn={key:0},Yn={alt:""},Gn={key:1},Zn={alt:""},Jn={key:2},Kn={key:3},Qn=Po(()=>e("p",null,"Base coin",-1)),xn={class:"coin-rate"},ot=Po(()=>e("div",null,[e("svg",{class:"icon icon-up","aria-hidden":"true"},[e("use",{"xlink:href":"#icon-exchange_up1"})])],-1)),et=Po(()=>e("div",null,[e("svg",{class:"icon icon-down","aria-hidden":"true"},[e("use",{"xlink:href":"#icon-exchange_down1"})])],-1)),nt=[ot,et],tt={class:"position-range-bottom"},st={class:"current-price"},lt=Po(()=>e("div",{class:"current-price-title"},"Current Price",-1)),it={key:0,class:"current-price-text"},at={key:1,class:"current-price-text"},ut={class:"price-range"},rt=Po(()=>e("div",{class:"price-range-bg"},[e("div",{class:"price-range-border"})],-1)),dt={class:"min-price"},vt=Po(()=>e("div",null,"Min Price",-1)),mt={class:"max-price"},ct=Po(()=>e("div",null,"Max Price",-1));function pt(o,s,G,W,j,$){var r,C,t,n,k,i,u,f,v,P,S,T,X,g,p,h,F,H,Q,B,y,x,so,lo,io,z;const w=ie,_=ce("image");return b(),N("div",Wn,[e("div",jn,[Xn,e("div",Hn,[o.needReverse?(b(),N("div",Gn,[So(e("img",Zn,null,512),[[_,o.direct?o.getCoinIcon((f=o.positionInfo)==null?void 0:f.token_b):o.getCoinIcon((u=o.positionInfo)==null?void 0:u.token_a)]]),E(w,{address:o.direct?(T=(S=o.positionInfo)==null?void 0:S.token_b)==null?void 0:T.address:(P=(v=o.positionInfo)==null?void 0:v.token_a)==null?void 0:P.address,"style-params":{width:"10px",height:"10px",right:"0",bottom:"0"}},null,8,["address"])])):(b(),N("div",zn,[So(e("img",Yn,null,512),[[_,o.direct?o.getCoinIcon((r=o.positionInfo)==null?void 0:r.token_a):o.getCoinIcon((C=o.positionInfo)==null?void 0:C.token_b)]]),E(w,{address:o.direct?(n=(t=o.positionInfo)==null?void 0:t.token_a)==null?void 0:n.address:(i=(k=o.positionInfo)==null?void 0:k.token_b)==null?void 0:i.address,"style-params":{width:"10px",height:"10px",right:"0",bottom:"0"}},null,8,["address"])])),o.needReverse?(b(),N("span",Kn,d(o.direct?(H=(F=o.positionInfo)==null?void 0:F.token_b)==null?void 0:H.symbol:(B=(Q=o.positionInfo)==null?void 0:Q.token_a)==null?void 0:B.symbol),1)):(b(),N("span",Jn,d(o.direct?(g=(X=o.positionInfo)==null?void 0:X.token_a)==null?void 0:g.symbol:(h=(p=o.positionInfo)==null?void 0:p.token_b)==null?void 0:h.symbol),1)),Qn,e("div",xn,[e("div",{onClick:s[0]||(s[0]=vo=>o.direct=!o.direct)},nt)])])]),e("div",tt,[e("div",st,[lt,(o.needReverse?!o.direct:o.direct)?(b(),N("div",it,d(("addCommom"in o?o.addCommom:D(M))(("decimalUi"in o?o.decimalUi:D(le))((y=o.positionInfo)==null?void 0:y.price,6))),1)):(b(),N("div",at,d(("addCommom"in o?o.addCommom:D(M))(("decimalUi"in o?o.decimalUi:D(le))(1/((x=o.positionInfo)==null?void 0:x.price),6))),1))]),e("div",ut,[rt,e("img",{style:re({left:`${o.moveRatio}%`}),src:En,alt:""},null,4),e("div",dt,[vt,e("div",null,d(((so=o.positionInfo)==null?void 0:so.minPrice)&&("sFixD"in o?o.sFixD:D(yo))((lo=o.positionInfo)==null?void 0:lo.minPrice,6)),1)]),e("div",mt,[ct,e("div",null,d(((io=o.positionInfo)==null?void 0:io.maxPrice)&&("sFixD"in o?o.sFixD:D(yo))((z=o.positionInfo)==null?void 0:z.maxPrice,6)),1)])])])])}const Se=Vo(Vn,[["render",pt],["__scopeId","data-v-73e1fd26"]]),ft=Uo({setup(){const o=Lo(),s=c(()=>o),G=Do(),W=c(()=>G),j=Fo(),$=I();return ho(()=>[W.value.positionInfoObj,j.params.id],([r,C])=>{console.log(r,"##positionInfoObj"),r&&!Mo(r)&&C&&($.value=r[C],console.log($.value,"##positionInfo.value"))},{immediate:!0,deep:!0}),{needReverse:c(()=>{var r;return(r=$.value)==null?void 0:r.needReverse}),positionInfo:$,getCoinIcon:r=>{var C;return console.log(r,"info##"),(r==null?void 0:r.logoURI)||(r==null?void 0:r.logo_url)||((C=s.value.tokensObj[r==null?void 0:r.address])==null?void 0:C.logo_url)||Yo("/image/coins/sui-unknown.png")},addCommom:M}}});const yt=o=>(Go("data-v-16c5df57"),o=o(),Zo(),o),bt={class:"pool-composition"},_t=yt(()=>e("div",{class:"pool-composition-top"},"Pool Composition",-1)),gt={class:"pool-composition-bottom"},ht={class:"token-ratio"},kt={class:"before-coin"},wt={alt:""},It={class:"after-coin"},$t={alt:""},Ct={class:"token-num"},At={class:"num-box"},St={class:"num-box"};function Pt(o,s,G,W,j,$){var r,C,t,n,k,i,u,f,v,P,S,T,X,g,p,h,F,H,Q,B,y,x,so,lo,io,z,vo,_o;const w=ie,_=ce("image");return b(),N("div",bt,[_t,e("div",gt,[e("div",ht,[e("div",kt,[e("div",null,[E(w,{address:o.needReverse?(n=(t=o.positionInfo)==null?void 0:t.token_b)==null?void 0:n.address:(C=(r=o.positionInfo)==null?void 0:r.token_a)==null?void 0:C.address,"style-params":{width:"14px",height:"14px",right:"0",bottom:"0"}},null,8,["address"]),So(e("img",wt,null,512),[[_,o.needReverse?o.getCoinIcon((i=o.positionInfo)==null?void 0:i.token_b):o.getCoinIcon((k=o.positionInfo)==null?void 0:k.token_a)]])]),e("span",null,d((u=o.positionInfo)==null?void 0:u.poolCoinARatio)+"%",1)]),e("div",It,[e("span",null,d((f=o.positionInfo)==null?void 0:f.poolCoinBRatio)+"%",1),e("div",null,[So(e("img",$t,null,512),[[_,o.needReverse?o.getCoinIcon((P=o.positionInfo)==null?void 0:P.token_a):o.getCoinIcon((v=o.positionInfo)==null?void 0:v.token_b)]]),E(w,{address:o.needReverse?(g=(X=o.positionInfo)==null?void 0:X.token_a)==null?void 0:g.address:(T=(S=o.positionInfo)==null?void 0:S.token_b)==null?void 0:T.address,"style-params":{width:"14px",height:"14px",right:"0",bottom:"0"}},null,8,["address"])])])]),e("div",Ct,[e("div",{class:"token-a-bg",style:re({width:`${(p=o.positionInfo)==null?void 0:p.poolCoinARatio}%`})},null,4),e("div",{class:"token-b-bg",style:re({width:`${(h=o.positionInfo)==null?void 0:h.poolCoinBRatio}%`})},null,4),e("div",At,[e("div",null,d(("addCommom"in o?o.addCommom:D(M))((F=o.positionInfo)==null?void 0:F.poolCoinANum))+" "+d(o.needReverse?(y=(B=o.positionInfo)==null?void 0:B.token_b)==null?void 0:y.symbol:(Q=(H=o.positionInfo)==null?void 0:H.token_a)==null?void 0:Q.symbol),1),e("div",null,"$"+d(("addCommom"in o?o.addCommom:D(M))((x=o.positionInfo)==null?void 0:x.poolCoinBUSD)),1)]),e("div",St,[e("div",null,d(("addCommom"in o?o.addCommom:D(M))((so=o.positionInfo)==null?void 0:so.poolCoinBNum))+" "+d(o.needReverse?(vo=(z=o.positionInfo)==null?void 0:z.token_a)==null?void 0:vo.symbol:(io=(lo=o.positionInfo)==null?void 0:lo.token_b)==null?void 0:io.symbol),1),e("div",null,"$"+d(("addCommom"in o?o.addCommom:D(M))((_o=o.positionInfo)==null?void 0:_o.poolCoinBUSD)),1)])])])])}const Pe=Vo(ft,[["render",Pt],["__scopeId","data-v-16c5df57"]]),Tt=Uo({setup(){const o=Lo(),s=c(()=>o),G=Do(),W=c(()=>G),j=Fo(),$=I();ho(()=>[W.value.positionInfoObj,j.params.id],([t,n])=>{console.log(t,"##positionInfoObj"),t&&!Mo(t)&&n&&($.value=t[n],console.log($.value,"##positionInfo.value"))},{immediate:!0,deep:!0});const w=c(()=>{var t;return(t=$.value)==null?void 0:t.needReverse}),_=t=>{var n;return console.log(t,"info##"),(t==null?void 0:t.logoURI)||(t==null?void 0:t.logo_url)||((n=s.value.tokensObj[t==null?void 0:t.address])==null?void 0:n.logo_url)||Yo("/image/coins/sui-unknown.png")},r=me(),C=c(()=>r);return{needReverse:w,positionInfo:$,getCoinIcon:_,addCommom:M,wallet:C}}});const ee=o=>(Go("data-v-0b578037"),o=o(),Zo(),o),Rt={class:"my-liquidity"},qt={class:"my-liquidity-top"},Bt=ee(()=>e("div",null,"My Liquidity",-1)),Ot=ee(()=>e("p",null,"My share of pool",-1)),Nt={class:"my-liquidity-bottom"},Mt={class:"lp-token"},Lt=ee(()=>e("div",null,[e("span",null,"LP Token Balance ")],-1)),Dt={class:"lp-balance"},Ut={class:"token-num-content"},Ft={class:"token-num token-a-num"},Vt={class:"logo"},Et=["src"],Wt={class:"text"},jt={class:"lp-logo"},Xt=["src"],Ht=ee(()=>e("div",null,"Pooled Assets",-1)),zt={class:"token-num"},Yt={class:"logo"},Gt=["src"],Zt={class:"text"},Jt=ee(()=>e("div",{class:"token-num-content-bg"},null,-1));function Kt(o,s,G,W,j,$){var _,r,C,t,n,k,i,u,f,v,P,S,T,X,g,p,h,F,H,Q,B,y,x,so,lo,io,z,vo;const w=ie;return b(),N("div",Rt,[e("div",qt,[Bt,e("div",null,[Ot,e("p",null,d(o.wallet.connected?(_=o.positionInfo)==null?void 0:_.myShare:"--")+"%",1)])]),e("div",Nt,[e("div",Mt,[Lt,e("div",null,[e("span",Dt,d(o.wallet.connected?("addCommom"in o?o.addCommom:D(M))((r=o.positionInfo)==null?void 0:r.myLiquidity):"--")+" LP",1),e("span",null,"$"+d(o.wallet.connected?("addCommom"in o?o.addCommom:D(M))((C=o.positionInfo)==null?void 0:C.myLiquidityUSD):"--"),1)])]),e("div",Ut,[e("div",Ft,[e("div",Vt,[e("img",{src:o.needReverse?o.getCoinIcon((n=o.positionInfo)==null?void 0:n.token_b):o.getCoinIcon((t=o.positionInfo)==null?void 0:t.token_a),alt:""},null,8,Et),E(w,{address:o.needReverse?(f=(u=o.positionInfo)==null?void 0:u.token_b)==null?void 0:f.address:(i=(k=o.positionInfo)==null?void 0:k.token_a)==null?void 0:i.address,"style-params":{width:"14px",height:"14px",left:"18px",bottom:"0"}},null,8,["address"])]),e("div",Wt,[e("div",null,d(o.wallet.connected?("addCommom"in o?o.addCommom:D(M))((v=o.positionInfo)==null?void 0:v.amountA):"--")+" "+d(o.needReverse?(X=(T=o.positionInfo)==null?void 0:T.token_b)==null?void 0:X.symbol:(S=(P=o.positionInfo)==null?void 0:P.token_a)==null?void 0:S.symbol),1),e("div",null,d(o.wallet.connected?("addCommom"in o?o.addCommom:D(M))((g=o.positionInfo)==null?void 0:g.myAmountAUSD):"--"),1)])]),e("div",jt,[e("img",{src:o.getCoinIcon((p=o.positionInfo)==null?void 0:p.lpInfo),alt:""},null,8,Xt),Ht]),e("div",zt,[e("div",Yt,[e("img",{src:o.needReverse?o.getCoinIcon((F=o.positionInfo)==null?void 0:F.token_a):o.getCoinIcon((h=o.positionInfo)==null?void 0:h.token_b),alt:""},null,8,Gt),E(w,{address:o.needReverse?(y=(B=o.positionInfo)==null?void 0:B.token_a)==null?void 0:y.address:(Q=(H=o.positionInfo)==null?void 0:H.token_b)==null?void 0:Q.address,"style-params":{width:"14px",height:"14px",right:"0",bottom:"0"}},null,8,["address"])]),e("div",Zt,[e("div",null,d(o.wallet.connected?("addCommom"in o?o.addCommom:D(M))((x=o.positionInfo)==null?void 0:x.amountB):"--")+" "+d(o.needReverse?(z=(io=o.positionInfo)==null?void 0:io.token_a)==null?void 0:z.symbol:(lo=(so=o.positionInfo)==null?void 0:so.token_b)==null?void 0:lo.symbol),1),e("div",null,d(o.wallet.connected?("addCommom"in o?o.addCommom:D(M))((vo=o.positionInfo)==null?void 0:vo.myAmountBUSD):"--"),1)])]),Jt])])])}const Te=Vo(Tt,[["render",Kt],["__scopeId","data-v-0b578037"]]),Qt=Uo({components:{AutoPoolAddModal:$e},setup(){const o=me(),s=I(!1),G=ae(),W=c(()=>G),j=c(()=>W.value.chainName),$=c(()=>o),w=Do(),_=c(()=>w),r=Lo(),C=c(()=>r),t=I(),n=Fo();ho(()=>[_.value.positionInfoObj,n.params.id],([m,R])=>{m&&!Mo(m)&&R&&(t.value=m[R],console.log(t.value,"##positionInfo.value"))},{immediate:!0,deep:!0});const k=c(()=>{var m,R;return console.log((m=t.value)==null?void 0:m.needReverse,"##positionInfo.value?.needReverse"),(R=t.value)==null?void 0:R.needReverse}),i=I(),u=I(),f=I(),v=I(),P=I(!0),S=c(()=>$.value.assets&&i.value&&$.value.assets[i.value.address]?pe($.value.assets[i.value.address].balance,i.value.decimals):0),T=c(()=>$.value.assets&&u.value&&$.value.assets[u.value.address]?pe($.value.assets[u.value.address].balance,u.value.decimals):0),X=m=>{m==="fromCoin"?(P.value=!0,f.value=S.value>0?i.value.symbol=="SUI"?new a(Number(S.value)).sub(new a(.05)).lt(new a(0))?"0":new a(Number(S.value)).sub(new a(.05)).toString():String(S.value):""):(P.value=!1,v.value=T.value>0?u.value.symbol=="SUI"?new a(Number(T.value)).sub(new a(.05)).lt(new a(0))?"0":new a(Number(T.value)).sub(new a(.05)).toString():String(T.value):"")},g=m=>{m==="fromCoin"?(P.value=!0,f.value=S.value>0?yo(new a(Number(S.value)).div(2).toString(),i.value.decimals).toString():""):(P.value=!1,v.value=T.value>0?yo(new a(Number(T.value)).div(2).toString(),u.value.decimals).toString():"")},p=c(()=>j.value?be(j.value):{}),h=c(()=>W.value.slippage),F=I("--"),H=I("--"),Q=m=>{const R=new a(t.value.autoPoolPositionInfo.liquidity),J=new a(m.toString());if(R.toNumber()>0&&J.toNumber()>0){const V=J.add(R);console.log("totalLiquidity:",J.div(V).mul(100).toString());const uo=J.div(V).mul(100).toNumber(),Z=qe(uo),no=Z==-1?2:Z+2,co=yo(J.div(V).mul(100).toNumber(),no);console.log(t.value.decimals,"##positionInfo.value.decimal");const go=new a(1).div(new a(Math.pow(10,t.value.lpInfo.decimals))).toString();console.log(co,go,"###288"),Number(co)<Number(go)?F.value=`<${go}`:F.value=co}else J.toNumber()>0&&R.toNumber()<=0?F.value="100":F.value="--"},B=m=>{const R=new a(m.toString()),J=new a(h.value).div(100),V=R.mul(J),uo=R.sub(V),Z=ve.get_lp_amount_by_liquidity({liquidity:t.value.liquidity,total_supply:t.value.total_supply},uo),no=new a(Math.pow(10,t.value.lpInfo.decimals)),co=new a(Z).div(no).toString();H.value=co},y=I(!1),x=I(!1),so=I(""),lo=I(),io=async()=>{if(!t.value)return;const m=t.value.autoPoolPositionInfo.tick_lower_index,R=t.value.autoPoolPositionInfo.tick_upper_index,J=No.sqrtPriceX64ToTickIndex(new Y(t.value.current_sqrt_price));J<m&&(k.value?y.value=!0:x.value=!0),J>R&&(k.value?x.value=!0:y.value=!0);let V;if(console.log(f.value||v.value,"#fromCoinAmount.value || toCoinAmount.value"),f.value||v.value){P.value?V=new a(f.value).mul(Math.pow(10,i.value.decimals)).toString():V=new a(v.value).mul(Math.pow(10,u.value.decimals)).toString();let uo,Z=P.value;if(console.log("执行##"),ao.value||po.value){console.log(k.value?P.value:!P.value,"#needReverse.value?fixedFromCoin.value:!fixedFromCoin.value");const l=await jo.calculateDepositSwapAmount({lowerTick:m,upperTick:R,curSqrtPrice:new Y(t.value.current_sqrt_price),fix_amount_a:Z,input_amount:V,coinTypeA:t.value.autoPoolPositionInfo.coin_type_a,coinTypeB:t.value.autoPoolPositionInfo.coin_type_b,clmm_pool:t.value.address});if(console.log(l,"###swapResult"),l){uo=new Y(l.afterSqrtPrice),V=new Y(l.swapOutAmount),lo.value={swap_amount:l.swapInAmount,a2b:Z},Z=!Z;const A=t.value.token_a.decimals,K=t.value.token_b.decimals;oe.value=No.sqrtPriceX64ToPrice(l.afterSqrtPrice,A,K).toString(),console.log(oe.value,"##afterCurrentPrice.value");const q=new a(l.swapInAmount).div(new a(Math.pow(10,A))).toString(),O=new a(l.swapOutAmount).div(new a(Math.pow(10,K))).toString(),U=k.value?t.value.token_b.symbol:t.value.token_a.symbol,fo=k.value?t.value.token_a.symbol:t.value.token_b.symbol;so.value=`To deposit ${ao.value?f.value:v.value} ${ao.value?U:fo},
          ${q} ${ao.value?U:fo}  will be traded for ${O} ${ao.value?fo:U} added to the pool.`}else uo=t.value.current_sqrt_price,V=new Y(V),oe.value=""}else uo=t.value.current_sqrt_price,V=new Y(V),oe.value="",so.value="";console.log(lo,"##swapParams");const{liquidityAmount:no,tokenMaxA:co,tokenMaxB:go}=p.value.estLiquidityAndcoinAmountFromOneAmounts({tokenA:i.value,tokenB:u.value,lowerTick:m,upperTick:R,coinAmount:V,iscoinA:Z,roundUp:!0,slippage:Number(h.value)/100,curSqrtPrice:new Y(uo)});console.log(t.value.current_sqrt_price,"##positionInfo.value.current_sqrt_price"),console.log(go.toString(),co.toString(),t.value,"###323"),!ao.value&&!po.value&&(P.value?v.value=Number(go)>0?go:"":f.value=Number(co)>0?co:""),Q(no),B(no)}};ho(()=>t.value,m=>{m&&!Mo(m)&&(i.value=m==null?void 0:m.token_a,u.value=m==null?void 0:m.token_b,y.value=!1,x.value=!1,io())},{immediate:!0});const z=c(()=>C.value.RATES),vo=c(()=>{var m,R,J,V,uo,Z,no,co,go,l;if((R=z.value[(m=i.value)==null?void 0:m.address])!=null&&R.price&&((V=z.value[(J=u.value)==null?void 0:J.address])!=null&&V.price)){console.log((Z=z.value[(uo=i.value)==null?void 0:uo.address])==null?void 0:Z.price,"RATES.value[fromCoin.value?.address]?.price");const A=new a(f.value||0).mul(new a((co=z.value[(no=i.value)==null?void 0:no.address])==null?void 0:co.price)),K=new a(v.value||0).mul(new a((l=z.value[(go=u.value)==null?void 0:go.address])==null?void 0:l.price));return le(A.add(K).toString(),2)}else return"--"});ho(()=>f.value,(m,R)=>{m?io():(F.value="--",v.value="",H.value="--")},{immediate:!0}),ho(()=>v.value,(m,R)=>{m?io():(f.value="",F.value="--",H.value="--")},{immediate:!0});const{t:_o,locale:L}=ge(),mo=c(()=>{const m=Number(f.value)>Number(S.value),R=Number(v.value)>Number(T.value);return!f.value&&!v.value?_o("button.enterAmount"):m?_o("button.insufficientBalance",{name:i.value.symbol}):R?_o("button.insufficientBalance",{name:u.value.symbol}):"Add Liquidity"}),Eo=c(()=>{const m=Number(f.value)>Number(S.value),R=Number(v.value)>Number(T.value);return!!(!f.value&&!v.value||m||R||f.value<=0&&v.value<=0)}),wo=I(!0),{setIsShowSuccess:Wo,setIsShowRejected:To,setIsShowWaiting:Io,setTransactionDesc:$o,setTransactionTxid:Ro,setPositiomNum:qo}=G,jo=_e("Sui"),Xo=async()=>{var co,go;s.value=!1,wo.value=!0,Ro("");const m=`${M(f.value)} ${(co=i.value)==null?void 0:co.symbol}`,R=`${M(v.value)} ${(go=u.value)==null?void 0:go.symbol}`;$o(`Deposit ${f.value>0?m:""} ${v.value>0&&f.value>0?"and":""} ${v.value>0?R:""}`),Io(!0);const J=P.value,V=t.value.autoPoolPositionInfo.tick_lower_index,uo=t.value.autoPoolPositionInfo.tick_upper_index;let Z;P.value?Z=new a(f.value).mul(Math.pow(10,i.value.decimals)).toString():Z=new a(v.value).mul(Math.pow(10,u.value.decimals)).toString();const no=t.value.rewarderInfo.map(l=>l.coinAddress);try{const l={lowerTick:V,upperTick:uo,coinAmount:Z,fix_amount_a:J,slippage:Number(h.value)/100,curSqrtPrice:new Y(t.value.current_sqrt_price),id:t.value.id,clmm_pool:t.value.autoPoolPositionInfo.pool,lp_token_type:t.value.lp_token_type,coinTypeA:t.value.autoPoolPositionInfo.coin_type_a,coinTypeB:t.value.autoPoolPositionInfo.coin_type_b,rewarder_coin_types:no,swapParams:lo.value,isOnlyA:ao.value,isOnlyB:po.value},A=await jo.deposit(l);console.log(A,"===>payloadAdd11111");const K=await $.value.currentWallet.signAndExecuteTransactionBlock(A);let q=p.value.handleTx(K);if(console.log("toAdd###tx###",q),q&&q.hash){Ro(q.hash),Io(!1),Wo(!0),console.log(t,"===>positionInfo");const O={title:"Supplied",desc:`Deposit ${f.value>0?m:""} ${v.value>0&&f.value>0?"and":""} ${v.value>0?R:""}`,hash:q.hash,tit:"Liquidity Increased",icon:"icon-icon-Increased",text:`Deposit ${f.value>0?m:""} ${v.value>0&&f.value>0?"and":""} ${v.value>0?R:""}`};j.value!=="Aptos"&&(O.res=q.res),p.value.showTransitionPending(O),await p.value.watchTransaction(O)&&setTimeout(()=>{w.updatePositionItem(t.value.id),p.value.getAccount($.value.address)},1e3),qo()}else Io(!1),To(!0);f.value="",v.value="",wo.value=!1}catch(l){f.value="",v.value="",console.log("addError###",l),wo.value=!1,Io(!1),To(!0)}},ao=I(!1),po=I(!1);return{wallet:$,positionInfo:t,isShowAddModal:s,needReverse:k,fromCoin:i,toCoin:u,fromCoinAmount:f,toCoinAmount:v,fromCoinBlance:S,toCoinBlance:T,fixedFromCoin:P,maxBtnSelect:X,halfBtnSelect:g,totalAmountUSD:vo,addCommom:M,shareOfPool:F,minimumReceivedLP:H,addLiquidityBtnText:mo,addLiquidityBtnDisabled:Eo,toAdd:Xo,showToCoinLock:x,showFromCoinLock:y,isOnlyA:ao,isOnlyB:po,onlyToken:m=>{f.value="",v.value="",so.value="",m=="only-a"?(ao.value=!ao.value,po.value=!1):(po.value=!po.value,ao.value=!1)},onlyText:so}}});const Jo=o=>(Go("data-v-1b20b7bd"),o=o(),Zo(),o),xt={class:"auto-pool-add"},os={class:"auto-pool-add-content"},es={class:"liquidity-action-tab"},ns=Jo(()=>e("div",{class:"increase tab-active"},"Add",-1)),ts={class:"only-token"},ss=Jo(()=>e("div",null,"Deposit Amounts",-1)),ls={key:0},is={key:0},as={key:0,class:"card-item"},us={key:1,class:"card-item"},rs=Jo(()=>e("span",null,"Pool Closed",-1)),ds={class:"add-info"},vs={key:0,class:"only-text"},ms={class:"total-amount"},cs=Jo(()=>e("span",null,"Total Amount",-1)),ps={class:"total-amount"},fs=Jo(()=>e("span",null,"Share of Pool",-1)),ys={class:"total-amount"},bs=Jo(()=>e("span",null,"Minimum Received LP",-1));function _s(o,s,G,W,j,$){var t,n,k,i,u,f,v,P,S,T,X,g,p;const w=we,_=Ie,r=ke,C=$e;return b(),N("div",xt,[e("div",os,[e("div",es,[ns,e("div",{class:"remove",onClick:s[0]||(s[0]=he(h=>o.$emit("changeCurrentTab"),["stop"]))},"Remove")]),e("div",ts,[ss,e("div",null,[e("div",{class:"only-a",onClick:s[1]||(s[1]=h=>o.onlyToken("only-a"))},[e("p",null,[o.isOnlyA?(b(),N("span",ls)):ro("",!0)]),e("span",null,d(o.needReverse?(i=(k=o.positionInfo)==null?void 0:k.token_b)==null?void 0:i.symbol:(n=(t=o.positionInfo)==null?void 0:t.token_a)==null?void 0:n.symbol)+" only",1)]),e("div",{class:"only-b",onClick:s[2]||(s[2]=h=>o.onlyToken("only-b"))},[e("p",null,[o.isOnlyB?(b(),N("span",is)):ro("",!0)]),e("span",null,d(o.needReverse?(P=(v=o.positionInfo)==null?void 0:v.token_a)==null?void 0:P.symbol:(f=(u=o.positionInfo)==null?void 0:u.token_b)==null?void 0:f.symbol)+" only",1)])])]),e("div",{class:de(o.needReverse?"card-container reverse":"card-container")},[(o.needReverse?!o.isOnlyA:!o.isOnlyB)?(b(),N("div",as,[E(w,{modelValue:o.fromCoinAmount,"onUpdate:modelValue":s[3]||(s[3]=h=>o.fromCoinAmount=h),"input-value":o.fromCoinAmount,"coin-symbol":o.fromCoin?o.fromCoin.symbol:null,"coin-name":o.fromCoin?o.fromCoin.name:null,balance:o.fromCoinBlance,"coin-icon":o.fromCoin?o.fromCoin.logoURI:"",address:o.fromCoin?o.fromCoin.address:"","swap-direct":"From","import-page":"deposit","has-arrow":!1,onOnMax:s[4]||(s[4]=h=>o.maxBtnSelect("fromCoin")),onOnHalf:s[5]||(s[5]=h=>o.halfBtnSelect("fromCoin")),onOnInput:s[6]||(s[6]=h=>{o.fromCoinAmount=h}),onOnFocus:s[7]||(s[7]=()=>{o.fixedFromCoin=!0})},null,8,["modelValue","input-value","coin-symbol","coin-name","balance","coin-icon","address"]),o.showFromCoinLock?(b(),bo(_,{key:0})):ro("",!0)])):ro("",!0),(o.needReverse?!o.isOnlyB:!o.isOnlyA)?(b(),N("div",us,[E(w,{modelValue:o.toCoinAmount,"onUpdate:modelValue":s[8]||(s[8]=h=>o.toCoinAmount=h),"input-value":o.toCoinAmount,"coin-symbol":o.toCoin?o.toCoin.symbol:null,"coin-name":o.toCoin?o.toCoin.name:null,balance:o.toCoinBlance,"swap-direct":"To","coin-icon":o.toCoin?o.toCoin.logoURI:"",address:o.toCoin?o.toCoin.address:"","import-page":"deposit","has-arrow":!1,onOnMax:s[9]||(s[9]=h=>o.maxBtnSelect("toCoin")),onOnHalf:s[10]||(s[10]=h=>o.halfBtnSelect("toCoin")),onOnInput:s[11]||(s[11]=h=>{o.toCoinAmount=h}),onOnFocus:s[12]||(s[12]=()=>{o.fixedFromCoin=!1})},null,8,["modelValue","input-value","coin-symbol","coin-name","balance","coin-icon","address"]),o.showToCoinLock?(b(),bo(_,{key:0})):ro("",!0)])):ro("",!0)],2)]),(S=o.positionInfo)!=null&&S.is_pause?(b(),bo(r,{key:0,class:"big-btn liquidity-btn",disabled:!0},{default:zo(()=>[rs]),_:1})):o.wallet.connected?(b(),bo(r,{key:1,class:"big-btn liquidity-btn",disabled:o.addLiquidityBtnDisabled,onClick:s[13]||(s[13]=h=>o.isShowAddModal=!0)},{default:zo(()=>[e("span",null,d(o.addLiquidityBtnText),1)]),_:1},8,["disabled"])):(b(),bo(r,{key:2,class:"big-btn liquidity-btn",onClick:s[14]||(s[14]=h=>o.wallet.setIsShowWalletModal(!0))},{default:zo(()=>[e("span",null,d(o.$t("button.connectWallet")),1)]),_:1})),e("div",ds,[o.onlyText?(b(),N("div",vs,d(o.onlyText),1)):ro("",!0),e("div",ms,[cs,e("span",null,"$"+d(("addCommom"in o?o.addCommom:D(M))(o.totalAmountUSD)),1)]),e("div",ps,[fs,e("span",null,d(o.shareOfPool)+"%",1)]),e("div",ys,[bs,e("span",null,d(("addCommom"in o?o.addCommom:D(M))(o.minimumReceivedLP))+" "+d(o.needReverse?(T=o.toCoin)==null?void 0:T.symbol:(X=o.fromCoin)==null?void 0:X.symbol)+"-"+d(o.needReverse?(g=o.fromCoin)==null?void 0:g.symbol:(p=o.toCoin)==null?void 0:p.symbol),1)])]),o.isShowAddModal?(b(),bo(C,{key:3,"pool-info":o.positionInfo,"from-coin":o.needReverse?o.positionInfo.token_b:o.positionInfo.token_a,"to-coin":o.needReverse?o.positionInfo.token_a:o.positionInfo.token_b,"from-coin-amount":o.needReverse?o.toCoinAmount:o.fromCoinAmount,"to-coin-amount":o.needReverse?o.fromCoinAmount:o.toCoinAmount,"total-amount":o.totalAmountUSD,"share-of-pool":o.shareOfPool,"minimum-received-l-p":o.minimumReceivedLP,"is-only-a":o.isOnlyA,"is-only-b":o.isOnlyB,onOnClose:s[15]||(s[15]=h=>o.isShowAddModal=!1),onToAdd:o.toAdd},null,8,["pool-info","from-coin","to-coin","from-coin-amount","to-coin-amount","total-amount","share-of-pool","minimum-received-l-p","is-only-a","is-only-b","onToAdd"])):ro("",!0)])}const gs=Vo(Qt,[["render",_s],["__scopeId","data-v-1b20b7bd"]]),hs=Uo({components:{AutoPoolRemoveModal:Ce},setup(){const o=me(),s=c(()=>o),G=ae(),W=c(()=>G),j=c(()=>W.value.slippage),$=c(()=>W.value.chainName),w=[{name:"25%",value:25},{name:"50%",value:50},{name:"75%",value:75},{name:"MAX",value:100}],_=I(25),r=Fo(),C=Do(),t=c(()=>C),n=c(()=>(console.log(t.value.positionInfoObj[r.params.id],"autoPool.value.positionInfoObj[route.params.id]###"),t.value.positionInfoObj[r.params.id])),k=c(()=>{var l;return(l=n.value)==null?void 0:l.needReverse}),i=I(),u=I(),f=I(!1),v=I(),P=c(()=>{var l;return(l=n.value)==null?void 0:l.myLiquidity}),S=I(!0),T=c(()=>$.value?be($.value):{}),X=_e("Sui"),g=I(""),p=I(""),h=I("--"),F=I(!1),H=I(!1),Q=I(),B=I(!0),y=I(),x=Lo(),so=c(()=>x),lo=c(()=>so.value.RATES),io=async()=>{if(S.value||!n.value)return;const l=n.value.autoPoolPositionInfo.tick_lower_index,A=n.value.autoPoolPositionInfo.tick_upper_index,K=No.sqrtPriceX64ToTickIndex(new Y(n.value.current_sqrt_price));K<l&&(k.value?F.value=!0:H.value=!0),K>A&&(k.value?H.value=!0:F.value=!0);let q;if(console.log(g.value||p.value,"#fromCoinAmount.value || toCoinAmount.value"),g.value||p.value){B.value?q=new a(g.value).mul(Math.pow(10,i.value.decimals)).toString():q=new a(p.value).mul(Math.pow(10,u.value.decimals)).toString();let O,U=B.value;if(console.log("执行##"),L.value||mo.value){const eo=await X.calculateRemoveSwapAmount({lowerTick:l,upperTick:A,curSqrtPrice:new Y(n.value.current_sqrt_price),fix_amount_a:U,receiveAmount:q,coinTypeA:n.value.autoPoolPositionInfo.coin_type_a,coinTypeB:n.value.autoPoolPositionInfo.coin_type_b,clmm_pool:n.value.address});if(console.log(eo,"###swapResult"),eo){O=new Y(eo.afterSqrtPrice),q=new Y(eo.swapOutAmount),Q.value={swap_amount:eo.swapInAmount,liquidity:eo.liquidity,a2b:!U},U=!U;const Co=n.value.token_a.decimals,Oo=n.value.token_b.decimals,Ao=new a(eo.swapInAmount).div(new a(Math.pow(10,Co))).toString(),Qo=new a(eo.swapOutAmount).div(new a(Math.pow(10,Oo))).toString(),te=k.value?n.value.token_b.symbol:n.value.token_a.symbol,ue=k.value?n.value.token_a.symbol:n.value.token_b.symbol;y.value=`To withdraw ${L.value?g.value:p.value} ${L.value?te:ue}, 
          ${Qo} ${L.value?ue:te}  in the pool will be traded for ${Ao} ${L.value?te:ue}`}else O=n.value.current_sqrt_price,q=new Y(q),y.value=""}else O=n.value.current_sqrt_price,q=new Y(q);console.log("执行了吗##");const{liquidityAmount:fo,tokenMaxA:oo,tokenMaxB:to}=T.value.estLiquidityAndcoinAmountFromOneAmounts({tokenA:i.value,tokenB:u.value,lowerTick:l,upperTick:A,coinAmount:q,iscoinA:U,roundUp:!1,slippage:Number(j.value)/100,curSqrtPrice:new Y(O)});console.log(n.value.current_sqrt_price,"##positionInfo.value.current_sqrt_price"),console.log(to.toString(),oo.toString(),n.value,"###323"),!L.value&&!mo.value&&(B.value?p.value=Number(to)>0?to:"":g.value=Number(oo)>0?oo:"");const Bo=ve.get_lp_amount_by_liquidity({liquidity:n.value.liquidity,total_supply:n.value.total_supply},fo.toString());v.value=new a(Bo).div(new a(Math.pow(10,n.value.lpInfo.decimals))).toString();const Ho=new a(v.value).div(new a(P.value)).mul(100);h.value=Bo,z.value=fo.toString(),_.value=Ho.toNumber()}},z=I(),vo=c(()=>{var l;return(l=n==null?void 0:n.value)==null?void 0:l.amountA}),_o=c(()=>{var l;return(l=n==null?void 0:n.value)==null?void 0:l.amountB}),L=I(!1),mo=I(!1),Eo=c(()=>{var U,fo,oo,to;const l=(fo=lo.value[(U=i==null?void 0:i.value)==null?void 0:U.address])==null?void 0:fo.price,A=(to=lo.value[(oo=u==null?void 0:u.value)==null?void 0:oo.address])==null?void 0:to.price;console.log(l,A,g.value,p.value,"####totalWithdraw");let K=g.value!=="--"&&g.value!==""?g.value:0,q=p.value!=="--"&&p.value!==""?p.value:0,O;return l&&A&&(L.value||mo.value?O=new a(L.value?K:q).mul(new a(L.value?l:A)).toString():(O=new a(K).mul(new a(l)).add(new a(q).mul(new a(A))).toString(),console.log(O,"result##"))),O>0&&O<.01?"<$0.01":`$${M(yo(O,2))}`}),wo=async l=>{if(!S.value)return;S.value=!0,n.value.token_a.decimals,n.value.token_b.decimals;const A=n.value.tick_lower_index,K=n.value.tick_upper_index;No.tickIndexToSqrtPriceX64(A),No.tickIndexToSqrtPriceX64(K);let q="",O,U;console.log(l.value,"##item.value"),console.log(U,"##coinAmount");let fo=B.value;if(console.log("执行##"),L.value||mo.value){if(L.value){const to=new a(no.value).mul(Math.pow(10,i.value.decimals)).mul(l.value).toString();console.log(to,"##amount"),U=yo(to,0),g.value=new a(no.value).mul(l.value).toString()}if(mo.value){const to=new a(no.value).mul(l.value).mul(Math.pow(10,u.value.decimals)).toString();U=yo(to,0),p.value=new a(no.value).mul(l.value).toString()}const oo=await X.calculateRemoveSwapAmount({lowerTick:A,upperTick:K,curSqrtPrice:new Y(n.value.current_sqrt_price),fix_amount_a:fo,receiveAmount:U,coinTypeA:n.value.autoPoolPositionInfo.coin_type_a,coinTypeB:n.value.autoPoolPositionInfo.coin_type_b,clmm_pool:n.value.address});if(console.log(oo,"###swapResult"),oo){new Y(oo.afterSqrtPrice),U=new Y(oo.swapOutAmount),Q.value={swap_amount:oo.swapInAmount,liquidity:oo.liquidity,a2b:!fo},fo=!fo;const to=n.value.token_a.decimals,Bo=n.value.token_b.decimals,Ho=new a(oo.swapInAmount).div(new a(Math.pow(10,to))).toString(),eo=new a(oo.swapOutAmount).div(new a(Math.pow(10,Bo))).toString(),Co=k.value?n.value.token_b.symbol:n.value.token_a.symbol,Oo=k.value?n.value.token_a.symbol:n.value.token_b.symbol;y.value=`To withdraw ${L.value?g.value:p.value} ${L.value?Co:Oo}, 
          ${eo} ${L.value?Oo:Co}  in the pool will be traded for ${Ho} ${L.value?Co:Oo}`,q=oo.liquidity}else n.value.current_sqrt_price,U=new Y(U),y.value="";console.log(O,"result###"),h.value=new a(n.value.myLiquidity).mul(new a(l.value)).toString(),console.log(n.value,n.value.liquidity,q,h.value,"###positionInfo.value.liquidity"),v.value=new a(h.value).div(Math.pow(10,n.value.lpInfo.decimals)),z.value=q}else{const oo=new a(vo.value).mul(Math.pow(10,i.value.decimals)).mul(l.value).toString();U=yo(oo,0),g.value=new a(vo.value).mul(l.value).toString();const to=new a(_o.value).mul(l.value).mul(Math.pow(10,u.value.decimals)).toString();U=yo(to,0),p.value=new a(_o.value).mul(l.value).toString(),n.value.current_sqrt_price,U=new Y(U),l.value!==1?O=new a(n.value.myLiquidity).mul(Math.pow(10,n.value.lpInfo.decimals)).mul(l.value).toString():O=new a(n.value.myLiquidity).mul(Math.pow(10,n.value.lpInfo.decimals)).toString(),v.value=new a(O).div(Math.pow(10,n.value.lpInfo.decimals)),q=ve.get_share_liquidity_by_amount({liquidity:n.value.liquidity,total_supply:n.value.total_supply},O),h.value=yo(O,0),z.value=yo(q,0)}};ho(_,Be((l,A)=>{l!==A&&(Number(l)>100?_.value=100:l&&n.value?(console.log("687===>"),_.value=l,wo({value:_.value/100})):(g.value="",p.value=""))},300)),ho(()=>g.value,(l,A)=>{l?io():p.value=""},{immediate:!0}),ho(()=>p.value,(l,A)=>{l?io():g.value=""},{immediate:!0});const Wo=Oe(),{setIsShowSuccess:To,setIsShowRejected:Io,setIsShowWaiting:$o,setTransactionDesc:Ro,setTransactionTxid:qo,setPositiomNum:jo,setTransactionDescText:Xo}=G,ao=I(!1),{t:po}=ge(),Ko=async()=>{var Bo,Ho;ao.value=!0,qo("");const l=Number(g.value)>0?`${M(g.value,i.value.decimals)} ${i.value.symbol}`:"",A=Number(p.value)>0?`${M(p.value,u.value.decimals)} ${u.value.symbol}`:"";console.log(l,A,"###transactionDescTo"),Ro(po("tips.removeLiquidiyText",{from:k.value?A:l,and:Number(g.value)>0&&Number(p.value)>0?"and":"",to:k.value?l:A})),$o(!0);const K=po("modal.removeLiquidityText2");Xo(K);const q=n.value.autoPoolPositionInfo.tick_lower_index,O=n.value.autoPoolPositionInfo.tick_upper_index,U=No.tickIndexToSqrtPriceX64(q),fo=No.tickIndexToSqrtPriceX64(O),oo=n.value.rewarderInfo.map(eo=>eo.coinAddress);console.log(z.value,h.value,"##liquidityVal.value");let to;B.value?to=new a(g.value).mul(Math.pow(10,i.value.decimals)).toString():to=new a(p.value).mul(Math.pow(10,u.value.decimals)).toString();try{const eo={lowerSqrtPrice:U,upperSqrtPrice:fo,lpTokenAmount:new Y(h.value),liquidity:new Y(z.value),curSqrtPrice:new Y(n.value.object.current_sqrt_price),slippage:Number(j.value)/100,id:n.value.id,clmm_pool:n.value.autoPoolPositionInfo.pool,lp_token_type:n.value.lp_token_type,coinTypeA:n.value.autoPoolPositionInfo.coin_type_a,coinTypeB:n.value.autoPoolPositionInfo.coin_type_b,rewarder_coin_types:oo,swapParams:Q.value,fix_amount_a:B.value,isOnlyA:L.value,isOnlyB:mo.value,lowerTick:q,upperTick:O,receiveAmount:to},Co=await X.remove(eo);console.log(Co,"移除流动性payload");const Oo=await s.value.currentWallet.signAndExecuteTransactionBlock(Co);let Ao=T.value.handleTx(Oo);if(console.log("0331###remove###tx####",Ao),Ao&&Ao.hash){qo(Ao.hash),$o(!1),To(!0);const Qo={title:po("common.removeLiquidity"),desc:"",hash:Ao.hash,descTransactions:`Remove ${l} ${Number(g.value)>0&&Number(p.value)>0?"and":""} ${A} from the pool`,sender:s.value.address,chainName:"Sui",tit:"Liquidity Removed",icon:"icon-icon-Removed",text:`Withdraw ${g.value} ${(Bo=i.value)==null?void 0:Bo.symbol} and ${p.value} ${(Ho=u.value)==null?void 0:Ho.symbol}`};Qo.res=Ao.res,T.value.showTransitionPending(Qo),await T.value.watchTransaction(Qo)&&(g.value="",p.value="",v.value="",_.value=0,setTimeout(()=>{C.updatePositionItem(n.value.id),T.value.getAccount(s.value.address)},1e3),Number(_.value)==100&&r.name=="auto-pool-detail"&&Wo.push("/pool/auto"))}else $o(!1),Io(!0);ao.value=!1}catch(eo){console.log("Remove error",eo),ao.value=!1,$o(!1),Io(!0)}};ho(()=>n.value,(l,A)=>{l&&!Mo(l)&&(i.value=l==null?void 0:l.token_a,u.value=l==null?void 0:l.token_b,console.log("触发###"),(!A||A&&A.address!==l.address)&&wo({value:_.value/100}))},{immediate:!0});const m=c(()=>{const l=Number(v.value)>Number(P.value);return!v.value||v.value<=0?po("button.enterAmount"):l?"Invalid Amount":po("button.remove")}),R=c(()=>!1),J=l=>(l==null?void 0:l.logoURI)||(l==null?void 0:l.logo_url)||Yo("/image/coins/sui-unknown.png"),V=l=>{g.value="",p.value="",S.value=!0,y.value="",l=="only-a"?(L.value=!L.value,mo.value=!1,B.value=!0):(mo.value=!mo.value,L.value=!1,B.value=!1)},uo=l=>{S.value=!0,_.value=100,l==="fromCoin"?B.value=!0:B.value=!1},Z=l=>{S.value=!0,_.value=50,l==="fromCoin"?B.value=!0:B.value=!1},no=I(),co=async()=>{B.value;const l=n.value.token_a.decimals,A=n.value.token_b.decimals,K=L.value?_o.value:vo.value;console.log(K,"###receiveAmount");const q=i.value.address===n.value.token_a.address&&u.value.address===n.value.token_b.address?0:1;if(L.value||mo.value){console.log(K,"##receiveAmount");let O=await T.value.preSwap({pool:{address:n.value.address,coinA:n.value.token_a,coinB:n.value.token_b},a2b:q==0,byAmountIn:!0,amount:K});console.log(O,O.estimatedAmountOut,l,A,"##preSwapRes"),no.value=new a(O.estimatedAmountOut).add(new a(L.value?vo.value:_o.value)).toString(),console.log(no.value,"###onlyTokenBalance.value"),wo({value:_.value/100})}};return ho(()=>[L.value,mo.value],([l,A])=>{l||A?co():wo({value:_.value/100})},{immediate:!0}),{removeLiquidityBtnText:m,removeLiquidityBtnDisabled:R,wallet:s,ratioArr:w,positionInfo:n,isShowRemoveModal:f,needReverse:k,fromCoin:i,toCoin:u,lpAmount:v,lpBalance:P,sliderVal:_,sFixD:yo,isSlider:S,fromCoinAmount:g,toCoinAmount:p,setPercent:wo,toRemove:Ko,addCommom:M,getCoinIcon:J,isOnlyA:L,isOnlyB:mo,onlyToken:V,fixedFromCoin:B,maxBtnSelect:uo,halfBtnSelect:Z,fromCoinBlance:vo,toCoinBlance:_o,showFromCoinLock:F,showToCoinLock:H,removeText:y,onlyTokenBalance:no,totalWithdraw:Eo,formatter:l=>`${l}%`}}});const ne=o=>(Go("data-v-258d6866"),o=o(),Zo(),o),ks={class:"auto-pool-add"},ws={class:"auto-pool-add-content"},Is={class:"liquidity-action-tab"},$s=ne(()=>e("div",{class:"remove tab-active"},"Remove",-1)),Cs={class:"only-token"},As=ne(()=>e("div",null,"Deposit Amounts",-1)),Ss={key:0},Ps={key:0},Ts={key:0,class:"card-item"},Rs={key:1,class:"card-item"},qs={class:"remove-ratio"},Bs={class:"remove-ratio-select"},Os={key:0,class:"ratio"},Ns={key:1,class:"ratio"},Ms={class:"ratio-list"},Ls=["onClick"],Ds=ne(()=>e("span",null,"Pool Closed",-1)),Us={class:"remove-info"},Fs={key:0,class:"remove-text total-amount"},Vs={class:"total-amount"},Es=ne(()=>e("span",null,"Total Withdraw",-1)),Ws={class:"total-amount"},js=ne(()=>e("span",null,"LP Burn Amount",-1)),Xs={key:0},Hs={key:1};function zs(o,s,G,W,j,$){var n,k,i,u,f,v,P,S,T,X,g,p,h,F,H,Q,B;const w=we,_=Ie,r=Le,C=ke,t=Ce;return b(),N("div",ks,[e("div",ws,[e("div",Is,[e("div",{class:"increase",onClick:s[0]||(s[0]=he(y=>o.$emit("changeCurrentTab"),["stop"]))},"Add"),$s]),e("div",Cs,[As,e("div",null,[e("div",{class:"only-a",onClick:s[1]||(s[1]=y=>o.onlyToken("only-a"))},[e("p",null,[o.isOnlyA?(b(),N("span",Ss)):ro("",!0)]),e("span",null,d(o.needReverse?(u=(i=o.positionInfo)==null?void 0:i.token_b)==null?void 0:u.symbol:(k=(n=o.positionInfo)==null?void 0:n.token_a)==null?void 0:k.symbol)+" only",1)]),e("div",{class:"only-b",onClick:s[2]||(s[2]=y=>o.onlyToken("only-b"))},[e("p",null,[o.isOnlyB?(b(),N("span",Ps)):ro("",!0)]),e("span",null,d(o.needReverse?(S=(P=o.positionInfo)==null?void 0:P.token_a)==null?void 0:S.symbol:(v=(f=o.positionInfo)==null?void 0:f.token_b)==null?void 0:v.symbol)+" only",1)])])]),e("div",{class:de(o.needReverse?"card-container reverse":"card-container")},[(o.needReverse?!o.isOnlyA:!o.isOnlyB)?(b(),N("div",Ts,[E(w,{modelValue:o.fromCoinAmount,"onUpdate:modelValue":s[3]||(s[3]=y=>o.fromCoinAmount=y),"input-value":o.fromCoinAmount,"coin-symbol":o.fromCoin?o.fromCoin.symbol:null,"coin-name":o.fromCoin?o.fromCoin.name:null,balance:o.isOnlyA?o.onlyTokenBalance:o.fromCoinBlance,"coin-icon":o.fromCoin?o.fromCoin.logoURI:"",address:o.fromCoin?o.fromCoin.address:"","swap-direct":"From","import-page":"deposit","has-arrow":!1,"amount-leabl":"Available",onOnMax:s[4]||(s[4]=y=>o.maxBtnSelect("fromCoin")),onOnHalf:s[5]||(s[5]=y=>o.halfBtnSelect("fromCoin")),onOnInput:s[6]||(s[6]=y=>{o.isSlider=!1,o.fromCoinAmount=y}),onOnFocus:s[7]||(s[7]=()=>{o.isSlider=!1,o.fixedFromCoin=!0})},null,8,["modelValue","input-value","coin-symbol","coin-name","balance","coin-icon","address"]),o.showFromCoinLock?(b(),bo(_,{key:0})):ro("",!0)])):ro("",!0),(o.needReverse?!o.isOnlyB:!o.isOnlyA)?(b(),N("div",Rs,[E(w,{modelValue:o.toCoinAmount,"onUpdate:modelValue":s[8]||(s[8]=y=>o.toCoinAmount=y),"input-value":o.toCoinAmount,"coin-symbol":o.toCoin?o.toCoin.symbol:null,"coin-name":o.toCoin?o.toCoin.name:null,balance:o.isOnlyB?o.onlyTokenBalance:o.toCoinBlance,"swap-direct":"To","coin-icon":o.toCoin?o.toCoin.logoURI:"",address:o.toCoin?o.toCoin.address:"","import-page":"deposit","has-arrow":!1,"amount-leabl":"Available",onOnMax:s[9]||(s[9]=y=>o.maxBtnSelect("toCoin")),onOnHalf:s[10]||(s[10]=y=>o.halfBtnSelect("toCoin")),onOnInput:s[11]||(s[11]=y=>{o.isSlider=!1,o.toCoinAmount=y}),onOnFocus:s[12]||(s[12]=()=>{o.isSlider=!1,o.fixedFromCoin=!1})},null,8,["modelValue","input-value","coin-symbol","coin-name","balance","coin-icon","address"]),o.showToCoinLock?(b(),bo(_,{key:0})):ro("",!0)])):ro("",!0)],2),e("div",qs,[e("div",Bs,[Number(o.lpBalance)>=Number(o.lpAmount)?(b(),N("div",Os,d(o.sliderVal>0&&Number(("sFixD"in o?o.sFixD:D(yo))(o.sliderVal,2))<.01?"<0.01":("sFixD"in o?o.sFixD:D(yo))(o.sliderVal,2))+"% ",1)):(b(),N("div",Ns,"--")),e("div",Ms,[(b(!0),N(Ne,null,Me(o.ratioArr,(y,x)=>(b(),N("div",{key:x,class:de(["ratio-item",o.sliderVal==y.value?"ratio-item-active":""]),onClick:()=>{o.isSlider=!0,o.sliderVal=y.value}},d(y.name),11,Ls))),128))])]),E(r,{value:o.sliderVal,"onUpdate:value":s[13]||(s[13]=y=>o.sliderVal=y),"tip-formatter":o.formatter},null,8,["value","tip-formatter"])])]),(T=o.positionInfo)!=null&&T.is_pause?(b(),bo(C,{key:0,class:"big-btn liquidity-btn",disabled:!0},{default:zo(()=>[Ds]),_:1})):o.wallet.connected?(b(),bo(C,{key:1,class:"big-btn liquidity-btn",disabled:o.removeLiquidityBtnDisabled,onClick:s[14]||(s[14]=y=>o.toRemove())},{default:zo(()=>[e("span",null,d(o.removeLiquidityBtnText),1)]),_:1},8,["disabled"])):(b(),bo(C,{key:2,class:"big-btn liquidity-btn",onClick:s[15]||(s[15]=y=>o.wallet.setIsShowWalletModal(!0))},{default:zo(()=>[e("span",null,d(o.$t("button.connectWallet")),1)]),_:1})),e("div",Us,[o.removeText&&(o.isOnlyA||o.isOnlyB)?(b(),N("div",Fs,d(o.removeText),1)):ro("",!0),e("div",Vs,[Es,e("span",null,d(o.totalWithdraw),1)]),e("div",Ws,[js,o.fromCoinAmount||o.toCoinAmount?(b(),N("span",Xs,d(("addCommom"in o?o.addCommom:D(M))(o.lpAmount))+" "+d(o.needReverse?(X=o.toCoin)==null?void 0:X.symbol:(g=o.fromCoin)==null?void 0:g.symbol)+"-"+d(o.needReverse?(p=o.fromCoin)==null?void 0:p.symbol:(h=o.toCoin)==null?void 0:h.symbol),1)):(b(),N("span",Hs,d(("addCommom"in o?o.addCommom:D(M))(o.lpAmount))+" "+d(o.needReverse?(F=o.toCoin)==null?void 0:F.symbol:(H=o.fromCoin)==null?void 0:H.symbol)+"-"+d(o.needReverse?(Q=o.fromCoin)==null?void 0:Q.symbol:(B=o.toCoin)==null?void 0:B.symbol),1))])]),o.isShowRemoveModal?(b(),bo(t,{key:3,"pool-info":o.positionInfo,"from-coin":o.positionInfo.token_a,"to-coin":o.positionInfo.token_b,onOnClose:s[16]||(s[16]=y=>o.isShowRemoveModal=!1)},null,8,["pool-info","from-coin","to-coin"])):ro("",!0)])}const Ys=Vo(hs,[["render",zs],["__scopeId","data-v-258d6866"]]),Gs=Uo({components:{AutoPoolV2Info:Ae,AutoPoolV2PositionRange:Se,AutoPoolV2PoolComposition:Pe,AutoPoolV2PoolLiquidity:Te,AutoPoolV2PoolAdd:gs,AutoPoolV2PoolRemove:Ys},setup(){const o=Do(),s=Lo(),G=ae(),W=c(()=>G),j=()=>{o.getAutoPoolAPY(),o.getAutoPoolList(),s.setPoolConfigList(W.value.chainName,W.value.filterCoinsObj)},$=I(),w=Fo();return ho(()=>w.query.action,_=>{_&&($.value=_)},{immediate:!0}),{clickRefresh:j,currentTab:$}}});const Zs={class:"auto-pool-detail-v2"},Js={class:"detail-top"},Ks={class:"detail-bottom pc-detail"},Qs={class:"detail-bottom-left"},xs={class:"detail-bottom-right"},ol={class:"h5-detail"};function el(o,s,G,W,j,$){const w=Re,_=Ae,r=Se,C=Pe,t=Te,n=fe("AutoPoolV2PoolAdd"),k=fe("AutoPoolV2PoolRemove");return b(),N("div",Zs,[e("div",Js,[E(w,{onClickRefresh:o.clickRefresh},null,8,["onClickRefresh"]),E(_)]),e("div",Ks,[e("div",Qs,[E(r),E(C),E(t)]),e("div",xs,[o.currentTab=="add"?(b(),bo(n,{key:0,onChangeCurrentTab:s[0]||(s[0]=i=>o.currentTab="remove")})):(b(),bo(k,{key:1,onChangeCurrentTab:s[1]||(s[1]=i=>o.currentTab="add")}))])]),e("div",ol,[o.currentTab=="add"?(b(),bo(n,{key:0,onChangeCurrentTab:s[2]||(s[2]=i=>o.currentTab="remove")})):(b(),bo(k,{key:1,onChangeCurrentTab:s[3]||(s[3]=i=>o.currentTab="add")})),E(r),E(C),E(t)])])}const Sl=Vo(Gs,[["render",el],["__scopeId","data-v-b226cf01"]]);export{Sl as default};
