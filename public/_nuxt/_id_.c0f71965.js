import{_ as tn}from"./back.2a7747d8.js";import{_ as sn}from"./refresh-icon.e668af50.js";import{a as Ee,M as Mo,l as Co,r as w,m as ln,e as Ue,q as no,o as a,c as se,w as ke,h as o,i as z,j as Le,t as d,f,F as ao,s as Oo,v as De,x as E,y as an,I as un,B as Ao,p as We,k as je,z as co,A as po,C as k,D as _e,b as Po,E as Qe,G as So,H as Ke,u as A,J as Lo,K as _o,L as Uo,N as ko}from"./entry.da417373.js";/* empty css              */import{_ as rn,a as dn,b as vn}from"./icon-error_2x.ba7fc4be.js";import{u as He,a as Vo}from"./autoPool.75ec777f.js";import{u as xe,c as Ze,a as R,g as wo,f as mn,s as T,d as Ve,p as Fo,b as Eo,T as Oe,e as me,h as cn,i as pn,j as fn}from"./pool.acf4e942.js";import{_ as fo}from"./token-warning.89584d12.js";import{_ as Wo}from"./auto-pool-apy-tips.a9bf534b.js";import{u as yo,a as To}from"./sha256.a5ba36eb.js";import{i as uo}from"./import-icon.de3e6c66.js";import"./decimal.633e31ee.js";import{D as r}from"./decimal.0e8aa3f1.js";import{_ as jo}from"./assets-card.3741f2c6.js";import{_ as Xo}from"./coin-lock.e3899178.js";import{_ as Go,a as Ho}from"./auto-pool-remove-modal.80b575cc.js";import{afterCurrentPrice as $o}from"./data.71faf2e2.js";import{V as Io}from"./index.d288bee0.js";/* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              */import"./img-lock_2x.a28135f4.js";import"./img-lock_2x.6719bda9.js";const yn=Ee({components:{Modal:Mo},setup(e,n){const{t:X,locale:W}=Co(),N=He(),P=["0.1","0.5","1"],u=w(N.slippage||.1),{setSlippage:c}=N,g=ln();console.log(u.value,"slippage.value");const h=w(!1);function s(q,i){h.value=!1,u.value=i}function t(){c(u.value),n.emit("onClose",!1)}return{settingArr:P,changeActiveIndex:s,confirm:t,emit:g,slippage:u,t:X,isInput:h}}});const Yo=e=>(We("data-v-405dfb5e"),e=e(),je(),e),bn=Yo(()=>o("svg",{class:"icon modal-icon-close","aria-hidden":"true"},[o("use",{"xlink:href":"#icon-a-icon-Shutdown"})],-1)),gn={class:"setting-container"},hn={class:"title"},kn=Yo(()=>o("img",{src:vn,alt:""},null,-1)),$n={class:"tag-list"},_n={key:0,src:rn,alt:""},wn={key:1,src:dn,alt:""},In={class:"footer"};function Cn(e,n,X,W,N,P){const u=an,c=un,g=Ao,h=no("Modal");return a(),se(h,{title:"Settings",class:"setting",centered:"",visible:!0,width:"400px",onCancel:n[3]||(n[3]=s=>e.$emit("onClose"))},{closeIcon:ke(()=>[bn]),footer:ke(()=>[o("div",In,[z(g,{type:"cancel",class:"cancel-btn cancel-btn-new",onClick:n[2]||(n[2]=s=>e.$emit("onClose"))},{default:ke(()=>[Le(d(e.$t("button.cancel")),1)]),_:1}),z(g,{class:"confirmbtn",disabled:Number(e.slippage)==0||Number(e.slippage)>1||Number(e.slippage)<.01,onClick:e.confirm},{default:ke(()=>[Le(d(e.$t("button.confirm")),1)]),_:1},8,["disabled","onClick"])])]),default:ke(()=>[o("div",gn,[o("div",hn,[kn,o("span",null,d(e.$t("modal.slippageTolerance")),1)]),o("div",$n,[(a(!0),f(ao,null,Oo(e.settingArr,(s,t)=>(a(),se(u,{key:t,class:De(!e.isInput&&s==e.slippage?"tag-active":""),onClick:q=>e.changeActiveIndex(t,s)},{default:ke(()=>[Le(d(s)+"% ",1)]),_:2},1032,["class","onClick"]))),128)),z(u,{class:De(["input-tag",e.isInput?"tag-active":""]),onClick:n[1]||(n[1]=s=>e.isInput=!0)},{default:ke(()=>[z(c,{value:e.slippage,"onUpdate:value":n[0]||(n[0]=s=>e.slippage=s),placeholder:"",suffix:"%",class:De(["slippage-input",Number(e.slippage)>.5&&Number(e.slippage)<1?"slippage-input-waring":Number(e.slippage)>1?"slippage-input-error":""])},null,8,["value","class"])]),_:1},8,["class"])])]),Number(e.slippage)>.5&&Number(e.slippage)<1||Number(e.slippage)>1?(a(),f("div",{key:0,class:De(["slippage-hint",Number(e.slippage)>.5&&Number(e.slippage)<1?"slippage-hint-waring":Number(e.slippage)>1?"slippage-hint-error":""])},[Number(e.slippage)>.5&&1>=Number(e.slippage)?(a(),f("img",_n)):E("",!0),Number(e.slippage)>1?(a(),f("img",wn)):E("",!0),o("p",null,d(Number(e.slippage)>.5&&1>=Number(e.slippage)?e.$t("tips.slippageTolerance2"):Number(e.slippage)>1?e.$t("tips.slippageTolerance1"):""),1)],2)):E("",!0)]),_:1})}const An=Ue(yn,[["render",Cn],["__scopeId","data-v-405dfb5e"]]),Pn=Ee({props:{poolInfo:{type:Object,default:()=>({})}},setup(e,n){const X=w(!1),W=w(null),N=w(0);let P=w(!1);const u=w(20),c=xe(),g=He(),h=w(!1);co(()=>{}),po(()=>{clearInterval(W.value)});const s=()=>{P.value=!1,W.value=setInterval(()=>{var m;h.value||N.value<u.value&&(N.value+=1,N.value===u.value&&((m=e==null?void 0:e.poolInfo)!=null&&m.poolAddress&&c.updateCurrentPools(e.poolInfo.poolAddress,store.chainName),N.value=0))},1e3)},t=k(()=>g.slippage),q=()=>{n.emit("clearAll")},i=()=>{P.value=!0,N.value=0,n.emit("clickRefresh"),setTimeout(()=>{P.value=!1,s()},1e3)};_e(()=>e.poolInfo,m=>{m&&!W.value&&s()},{immediate:!0});const v=Po(),b=Qe();return console.log(b,"route"),{refresh:P,clickRefresh:i,isShowSwapSetting:X,countdown:N,autoRefreshTime:u,slippage:t,clearAll:q,checkNullObj:Ze,router:v,route:b}}});const Sn=e=>(We("data-v-7418921d"),e=e(),je(),e),Tn={class:"title"},Rn={class:"left"},qn=Sn(()=>o("svg",{class:"icon","aria-hidden":"true"},[o("use",{"xlink:href":"#icon-a-icon-setslippage"})],-1)),Nn={key:0,class:"deposit-progress"};function Bn(e,n,X,W,N,P){const u=tn,c=sn,g=An;return a(),f("div",Tn,[o("div",Rn,[z(u)]),o("div",{class:De(["right title-right deposit-setting",e.poolInfo?"havePoolInfo":"noPoolInfo"])},[o("div",{class:"slippage-icon",onClick:n[0]||(n[0]=h=>e.isShowSwapSetting=!0)},[qn,o("span",null,d(e.slippage)+"%",1)]),e.route.name!=="liquidity-create"?(a(),f("div",Nn,[z(c,{loading:e.refresh,"auto-refresh-time":e.autoRefreshTime,countdown:e.countdown,onClickRefresh:e.clickRefresh},null,8,["loading","auto-refresh-time","countdown","onClickRefresh"])])):E("",!0)],2),e.isShowSwapSetting?(a(),se(g,{key:0,onOnClose:n[1]||(n[1]=h=>e.isShowSwapSetting=!1)})):E("",!0)])}const Dn=Ue(Pn,[["render",Bn],["__scopeId","data-v-7418921d"]]),Fn=Ee({components:{AutoPoolApyTips:Wo},setup(){const e=yo(),n=k(()=>e),X=xe(),W=k(()=>X),N=He(),P=k(()=>N),u=k(()=>n.value.theme),c=Qe(),g=w();_e(()=>[P.value.positionInfoObj,c.params.id],([i,v])=>{i&&!Ze(i)&&v&&(g.value=i[v],console.log(g.value,"##positionInfo.value"))},{immediate:!0,deep:!0});const h=k(()=>{var i;return(i=g.value)==null?void 0:i.needReverse}),s=i=>{var v;return(i==null?void 0:i.logoURI)||(i==null?void 0:i.logo_url)||((v=W.value.tokensObj[i==null?void 0:i.address])==null?void 0:v.logo_url)||(u.value==="default"?uo("/image/coins/unknown.png"):uo("/image/coins/sui-unknown.png"))},t=k(()=>{var i,v;return console.log((i=g==null?void 0:g.value)==null?void 0:i.poolUSD,"##positionInfo?.value?.poolUSD"),(v=g==null?void 0:g.value)==null?void 0:v.poolUSD}),q=k(()=>{var i,v;return P.value.apyObj&&((v=P.value.apyObj[(i=g.value)==null?void 0:i.id])==null?void 0:v.apr)||"--"});return{positionInfo:g,needReverse:h,getCoinIcon:s,tvl:t,apy:q,addCommom:R,getExplorerUrl:wo}}});const Xe=e=>(We("data-v-64d0287a"),e=e(),je(),e),Mn={class:"auto-pool-v2-info"},On={class:"pool-info"},Ln={class:"left"},Un={class:"coin-a"},Vn={alt:""},En={class:"coin-b"},Wn={alt:""},jn={class:"position-name"},Xn={key:0,class:"pool-fee"},Gn=Xe(()=>o("span",null,"Fee tier",-1)),Hn={class:"vault-address"},Yn=["href"],zn=Xe(()=>o("span",null,"Vault Address",-1)),Jn=Xe(()=>o("svg",{class:"icon","aria-hidden":"true"},[o("use",{"xlink:href":"#icon-icon-link"})],-1)),Kn=[zn,Jn],Zn={class:"apy-and-tvl"},Qn={class:"apy"},xn=Xe(()=>o("div",{class:"apy-title"},"APY",-1)),et={class:"apy-text"},ot={class:"tvl"},nt=Xe(()=>o("div",{class:"tvl-title"},"TVL",-1)),tt={class:"tvl-text"},st={class:"pool-info h5-pool-info"},it={class:"left"},lt={class:"coin-a"},at={alt:""},ut={class:"coin-b"},rt={alt:""},dt={class:"position-name"},vt={key:0,class:"pool-fee"},mt=Xe(()=>o("span",null,"Fee tier",-1)),ct={class:"left"},pt={class:"vault-address"},ft=["href"],yt=Xe(()=>o("span",null,"Vault Address",-1)),bt=Xe(()=>o("svg",{class:"icon","aria-hidden":"true"},[o("use",{"xlink:href":"#icon-icon-link"})],-1)),gt=[yt,bt],ht={class:"apy-and-tvl"},kt={class:"apy"},$t=Xe(()=>o("div",{class:"apy-title"},"APY",-1)),_t={class:"apy-text"},wt={class:"tvl"},It=Xe(()=>o("div",{class:"tvl-title"},"TVL",-1)),Ct={class:"tvl-text"};function At(e,n,X,W,N,P){var h,s,t,q,i,v,b,m,y,p,B,D,L,x,$,_,G,V,Y,M,I,ee,ve,ce,pe,de,ie,ue,H,S,K,qe,ge,we,Ne,Ie,fe,Be,Ce,Fe,Pe,ze,Z,Se,to,eo;const u=fo,c=Wo,g=So("image");return a(),f("div",Mn,[o("div",On,[o("div",Ln,[o("div",Un,[Ke(o("img",Vn,null,512),[[g,e.needReverse?e.getCoinIcon((s=e.positionInfo)==null?void 0:s.token_b):e.getCoinIcon((h=e.positionInfo)==null?void 0:h.token_a)]]),z(u,{address:e.needReverse?(v=(i=e.positionInfo)==null?void 0:i.token_b)==null?void 0:v.address:(q=(t=e.positionInfo)==null?void 0:t.token_a)==null?void 0:q.address,"style-params":{width:"12px",height:"12px",left:"18px",bottom:"4px"}},null,8,["address"])]),o("div",En,[Ke(o("img",Wn,null,512),[[g,e.needReverse?e.getCoinIcon((m=e.positionInfo)==null?void 0:m.token_a):e.getCoinIcon((b=e.positionInfo)==null?void 0:b.token_b)]]),z(u,{address:e.needReverse?(D=(B=e.positionInfo)==null?void 0:B.token_a)==null?void 0:D.address:(p=(y=e.positionInfo)==null?void 0:y.token_b)==null?void 0:p.address,"style-params":{width:"12px",height:"12px",left:"18px",bottom:"4px"}},null,8,["address"])]),o("div",jn,d(e.needReverse?(x=(L=e.positionInfo)==null?void 0:L.token_b)==null?void 0:x.symbol:(_=($=e.positionInfo)==null?void 0:$.token_a)==null?void 0:_.symbol)+" - "+d(e.needReverse?(V=(G=e.positionInfo)==null?void 0:G.token_a)==null?void 0:V.symbol:(M=(Y=e.positionInfo)==null?void 0:Y.token_b)==null?void 0:M.symbol),1),(I=e.positionInfo)!=null&&I.fee?(a(),f("div",Xn,[Gn,Le(" "+d(((ee=e.positionInfo)==null?void 0:ee.fee)*100)+"% ",1)])):E("",!0),o("div",Hn,[o("a",{href:("getExplorerUrl"in e?e.getExplorerUrl:A(wo))("poolAddress",(ve=e.positionInfo)==null?void 0:ve.id),target:"_blank"},Kn,8,Yn)])]),o("div",Zn,[o("div",Qn,[xn,o("div",et,[Le(d(e.apy)+" ",1),z(c)])]),o("div",ot,[nt,o("div",tt,"$"+d(("addCommom"in e?e.addCommom:A(R))(e.tvl,2)),1)])])]),o("div",st,[o("div",it,[o("div",lt,[Ke(o("img",at,null,512),[[g,e.needReverse?e.getCoinIcon((pe=e.positionInfo)==null?void 0:pe.token_b):e.getCoinIcon((ce=e.positionInfo)==null?void 0:ce.token_a)]]),z(u,{address:e.needReverse?(H=(ue=e.positionInfo)==null?void 0:ue.token_b)==null?void 0:H.address:(ie=(de=e.positionInfo)==null?void 0:de.token_a)==null?void 0:ie.address,"style-params":{width:"12px",height:"12px",left:"18px",bottom:"4px"}},null,8,["address"])]),o("div",ut,[Ke(o("img",rt,null,512),[[g,e.needReverse?e.getCoinIcon((K=e.positionInfo)==null?void 0:K.token_a):e.getCoinIcon((S=e.positionInfo)==null?void 0:S.token_b)]]),z(u,{address:e.needReverse?(Ne=(we=e.positionInfo)==null?void 0:we.token_a)==null?void 0:Ne.address:(ge=(qe=e.positionInfo)==null?void 0:qe.token_b)==null?void 0:ge.address,"style-params":{width:"12px",height:"12px",left:"18px",bottom:"4px"}},null,8,["address"])]),o("div",dt,d(e.needReverse?(fe=(Ie=e.positionInfo)==null?void 0:Ie.token_b)==null?void 0:fe.symbol:(Ce=(Be=e.positionInfo)==null?void 0:Be.token_a)==null?void 0:Ce.symbol)+" - "+d(e.needReverse?(Pe=(Fe=e.positionInfo)==null?void 0:Fe.token_a)==null?void 0:Pe.symbol:(Z=(ze=e.positionInfo)==null?void 0:ze.token_b)==null?void 0:Z.symbol),1),(Se=e.positionInfo)!=null&&Se.fee?(a(),f("div",vt,[mt,Le(" "+d(((to=e.positionInfo)==null?void 0:to.fee)*100)+"% ",1)])):E("",!0)]),o("div",ct,[o("div",pt,[o("a",{href:("getExplorerUrl"in e?e.getExplorerUrl:A(wo))("poolAddress",(eo=e.positionInfo)==null?void 0:eo.id),target:"_blank"},gt,8,ft)])]),o("div",ht,[o("div",kt,[$t,o("div",_t,[Le(d(e.apy)+" ",1),z(c)])]),o("div",wt,[It,o("div",Ct,"$"+d(("addCommom"in e?e.addCommom:A(R))(e.tvl,2)),1)])])])])}const zo=Ue(Fn,[["render",At],["__scopeId","data-v-64d0287a"]]),Pt=Ee({components:{Slider:Lo},setup(){const e=w(!0),n=xe(),X=k(()=>n),W=He(),N=k(()=>W),P=Qe(),u=w();_e(()=>[N.value.positionInfoObj,P.params.id],([i,v])=>{i&&!Ze(i)&&v&&(u.value=i[v],console.log(u.value,"##positionInfo.value"))},{immediate:!0,deep:!0});const c=k(()=>{var i;return(i=u.value)==null?void 0:i.needReverse}),g=i=>{var v;return(i==null?void 0:i.logoURI)||(i==null?void 0:i.logo_url)||((v=X.value.tokensObj[i==null?void 0:i.address])==null?void 0:v.logo_url)||uo("/image/coins/sui-unknown.png")},h=k(()=>{var y,p,B;const i=(y=u==null?void 0:u.value)==null?void 0:y.price,v=(p=u==null?void 0:u.value)==null?void 0:p.minPrice,b=(B=u==null?void 0:u.value)==null?void 0:B.maxPrice;let m;if(i>=v&&i<=b){const D=new r(v).add(new r(b)).div(2).toNumber();m=i>D?50+new r(i).sub(D).div(D).toNumber():50-new r(i).sub(D).div(D).toNumber()}else i<v?(m=new r(i).sub(new r(v)).mul(100).toNumber()+15,console.log(m,"##result")):i>b&&(m=new r(i).sub(new r(b)).div(new r(b)).mul(100).toNumber()+70+15);return Number(mn(m,0))}),s=k(()=>{var y,p,B,D,L,x,$;const i=e.value?((y=u.value)==null?void 0:y.minPrice)&&T(u==null?void 0:u.value.minPrice,6):((p=u.value)==null?void 0:p.maxPrice)&&T(1/(u==null?void 0:u.value.maxPrice),6),v=e.value?((B=u.value)==null?void 0:B.maxPrice)&&T((D=u.value)==null?void 0:D.maxPrice,6):((L=u.value)==null?void 0:L.minPrice)&&T(1/(u==null?void 0:u.value.minPrice),6),b=(c.value?!e.value:e.value)?T((x=u.value)==null?void 0:x.price,6):T(1/(($=u.value)==null?void 0:$.price),6);let m={};return m[i]={label:"Min Price"},m[v]={label:"Max Price"},m[b]={label:"Current Price"},b>i&&b<v?m[b]={label:"Current Price"}:b<i?m[Number(i)+1e-9]={label:"Current Price"}:b>v&&(m[Number(v)-1e-9]={label:"Current Price"}),console.log(m,"obj###"),m}),t=k(()=>{var v,b;const i=(c.value?!e.value:e.value)?Ve((v=u.value)==null?void 0:v.price,6):Ve(1/((b=u.value)==null?void 0:b.price),6);return console.log(i,"result##"),i}),q=k(()=>{var v,b;const i=(c.value?!e.value:e.value)?Ve((v=u.value)==null?void 0:v.price,6):Ve(1/((b=u.value)==null?void 0:b.price),6);return console.log(i,"result##111"),i});return{direct:e,positionInfo:u,needReverse:c,getCoinIcon:g,decimalUi:Ve,addCommom:R,sFixD:T,moveRatio:h,marks:s,currentPrice:t,currentPriceResever:q}}});const bo=e=>(We("data-v-29b0f76f"),e=e(),je(),e),St={class:"v2-position-range"},Tt={class:"position-range-top"},Rt=bo(()=>o("div",null,"Position Range",-1)),qt={class:"base-coin"},Nt={key:0},Bt={alt:""},Dt={key:1},Ft={alt:""},Mt={key:2},Ot={key:3},Lt=bo(()=>o("p",null,"Base coin",-1)),Ut={class:"coin-rate"},Vt=bo(()=>o("div",null,[o("svg",{class:"icon icon-up","aria-hidden":"true"},[o("use",{"xlink:href":"#icon-exchange_up1"})])],-1)),Et=bo(()=>o("div",null,[o("svg",{class:"icon icon-down","aria-hidden":"true"},[o("use",{"xlink:href":"#icon-exchange_down1"})])],-1)),Wt=[Vt,Et],jt={class:"position-range-bottom"},Xt={class:"price-range"},Gt={class:"price-range-bg"},Ht={key:0,class:"min-price"},Yt={key:0},zt={key:1},Jt={key:1,class:"max-price"},Kt={key:0},Zt={key:1},Qt={key:0,class:"min-price"},xt={key:0},es={key:1},os={key:1,class:"max-price"},ns={key:0},ts={key:1};function ss(e,n,X,W,N,P){var h,s,t,q,i,v,b,m,y,p,B,D,L,x,$,_,G,V,Y,M,I,ee,ve,ce,pe,de,ie,ue;const u=fo,c=no("Slider"),g=So("image");return a(),f("div",St,[o("div",Tt,[Rt,o("div",qt,[e.needReverse?(a(),f("div",Dt,[Ke(o("img",Ft,null,512),[[g,e.direct?e.getCoinIcon((m=e.positionInfo)==null?void 0:m.token_b):e.getCoinIcon((b=e.positionInfo)==null?void 0:b.token_a)]]),z(u,{address:e.direct?(D=(B=e.positionInfo)==null?void 0:B.token_b)==null?void 0:D.address:(p=(y=e.positionInfo)==null?void 0:y.token_a)==null?void 0:p.address,"style-params":{width:"10px",height:"10px",right:"0",bottom:"0"}},null,8,["address"])])):(a(),f("div",Nt,[Ke(o("img",Bt,null,512),[[g,e.direct?e.getCoinIcon((h=e.positionInfo)==null?void 0:h.token_a):e.getCoinIcon((s=e.positionInfo)==null?void 0:s.token_b)]]),z(u,{address:e.direct?(q=(t=e.positionInfo)==null?void 0:t.token_a)==null?void 0:q.address:(v=(i=e.positionInfo)==null?void 0:i.token_b)==null?void 0:v.address,"style-params":{width:"10px",height:"10px",right:"0",bottom:"0"}},null,8,["address"])])),e.needReverse?(a(),f("span",Ot,d(e.direct?(V=(G=e.positionInfo)==null?void 0:G.token_b)==null?void 0:V.symbol:(M=(Y=e.positionInfo)==null?void 0:Y.token_a)==null?void 0:M.symbol),1)):(a(),f("span",Mt,d(e.direct?(x=(L=e.positionInfo)==null?void 0:L.token_a)==null?void 0:x.symbol:(_=($=e.positionInfo)==null?void 0:$.token_b)==null?void 0:_.symbol),1)),Lt,o("div",Ut,[o("div",{onClick:n[0]||(n[0]=H=>e.direct=!e.direct)},Wt)])])]),o("div",jt,[o("div",Xt,[o("div",Gt,[e.direct?(a(),se(c,{key:0,value:e.currentPrice,class:De(["position-slider",e.currentPrice<Number(("sFixD"in e?e.sFixD:A(T))((I=e.positionInfo)==null?void 0:I.minPrice,6))||e.currentPrice>Number(("sFixD"in e?e.sFixD:A(T))((ee=e.positionInfo)==null?void 0:ee.maxPrice,6))?"hide-handler":""]),step:1e-4,marks:e.marks,disabled:!0,min:Number(("sFixD"in e?e.sFixD:A(T))((ve=e.positionInfo)==null?void 0:ve.minPrice,6)),max:Number(("sFixD"in e?e.sFixD:A(T))((ce=e.positionInfo)==null?void 0:ce.maxPrice,6))},{mark:ke(({label:H})=>{var S,K,qe,ge,we,Ne,Ie,fe,Be,Ce,Fe,Pe;return[H=="Min Price"?(a(),f("div",Ht,[o("div",null,d(H),1),e.direct?(a(),f("div",Yt,d(((S=e.positionInfo)==null?void 0:S.minPrice)&&("sFixD"in e?e.sFixD:A(T))((K=e.positionInfo)==null?void 0:K.minPrice,6)),1)):(a(),f("div",zt,d(((qe=e.positionInfo)==null?void 0:qe.maxPrice)&&("sFixD"in e?e.sFixD:A(T))(1/((ge=e.positionInfo)==null?void 0:ge.maxPrice),6)),1))])):E("",!0),H=="Max Price"?(a(),f("div",Jt,[o("div",null,d(H),1),e.direct?(a(),f("div",Kt,d(((we=e.positionInfo)==null?void 0:we.maxPrice)&&("sFixD"in e?e.sFixD:A(T))((Ne=e.positionInfo)==null?void 0:Ne.maxPrice,6)),1)):(a(),f("div",Zt,d(((Ie=e.positionInfo)==null?void 0:Ie.minPrice)&&("sFixD"in e?e.sFixD:A(T))(1/((fe=e.positionInfo)==null?void 0:fe.minPrice),6)),1))])):E("",!0),H=="Current Price"?(a(),f("div",{key:2,class:De(["current-price",e.currentPrice<Number(("sFixD"in e?e.sFixD:A(T))((Be=e.positionInfo)==null?void 0:Be.minPrice,6))?"current-price-left":e.currentPrice>Number(("sFixD"in e?e.sFixD:A(T))((Ce=e.positionInfo)==null?void 0:Ce.maxPrice,6))?"current-price-right":""])},[o("div",null,d(H),1),o("div",null,[(e.needReverse?!e.direct:e.direct)?(a(),f(ao,{key:0},[Le(d(("addCommom"in e?e.addCommom:A(R))(("decimalUi"in e?e.decimalUi:A(Ve))((Fe=e.positionInfo)==null?void 0:Fe.price,6))),1)],64)):(a(),f(ao,{key:1},[Le(d(("addCommom"in e?e.addCommom:A(R))(("decimalUi"in e?e.decimalUi:A(Ve))(1/((Pe=e.positionInfo)==null?void 0:Pe.price),6))),1)],64))])],2)):E("",!0)]}),_:1},8,["value","class","marks","min","max"])):(a(),se(c,{key:1,value:e.currentPriceResever,class:De(["position-slider",e.currentPriceResever<Number(("sFixD"in e?e.sFixD:A(T))(1/((pe=e.positionInfo)==null?void 0:pe.maxPrice),6))||e.currentPriceResever>Number(("sFixD"in e?e.sFixD:A(T))(1/((de=e.positionInfo)==null?void 0:de.minPrice),6))?"hide-handler":""]),step:null,min:Number(("sFixD"in e?e.sFixD:A(T))(1/((ie=e.positionInfo)==null?void 0:ie.maxPrice),6)),max:Number(("sFixD"in e?e.sFixD:A(T))(1/((ue=e.positionInfo)==null?void 0:ue.minPrice),6)),marks:e.marks,disabled:!0},{mark:ke(({label:H})=>{var S,K,qe,ge,we,Ne,Ie,fe,Be,Ce,Fe,Pe;return[H=="Min Price"?(a(),f("div",Qt,[o("div",null,d(H),1),e.direct?(a(),f("div",xt,d(((S=e.positionInfo)==null?void 0:S.minPrice)&&("sFixD"in e?e.sFixD:A(T))((K=e.positionInfo)==null?void 0:K.minPrice,6)),1)):(a(),f("div",es,d(((qe=e.positionInfo)==null?void 0:qe.maxPrice)&&("sFixD"in e?e.sFixD:A(T))(1/((ge=e.positionInfo)==null?void 0:ge.maxPrice),6)),1))])):E("",!0),H=="Max Price"?(a(),f("div",os,[o("div",null,d(H),1),e.direct?(a(),f("div",ns,d(((we=e.positionInfo)==null?void 0:we.maxPrice)&&("sFixD"in e?e.sFixD:A(T))((Ne=e.positionInfo)==null?void 0:Ne.maxPrice,6)),1)):(a(),f("div",ts,d(((Ie=e.positionInfo)==null?void 0:Ie.minPrice)&&("sFixD"in e?e.sFixD:A(T))(1/((fe=e.positionInfo)==null?void 0:fe.minPrice),6)),1))])):E("",!0),H=="Current Price"?(a(),f("div",{key:2,class:De(["current-price current-price-direct",e.currentPriceResever<Number(("sFixD"in e?e.sFixD:A(T))(1/((Be=e.positionInfo)==null?void 0:Be.maxPrice),6))?"current-price-left":e.currentPriceResever>Number(("sFixD"in e?e.sFixD:A(T))(1/((Ce=e.positionInfo)==null?void 0:Ce.minPrice),6))?"current-price-right":""])},[o("div",null,d(H),1),o("div",null,[(e.needReverse?!e.direct:e.direct)?(a(),f(ao,{key:0},[Le(d(("addCommom"in e?e.addCommom:A(R))(("decimalUi"in e?e.decimalUi:A(Ve))((Fe=e.positionInfo)==null?void 0:Fe.price,6))),1)],64)):(a(),f(ao,{key:1},[Le(d(("addCommom"in e?e.addCommom:A(R))(("decimalUi"in e?e.decimalUi:A(Ve))(1/((Pe=e.positionInfo)==null?void 0:Pe.price),6))),1)],64))])],2)):E("",!0)]}),_:1},8,["value","class","min","max","marks"]))])])])])}const Jo=Ue(Pt,[["render",ss],["__scopeId","data-v-29b0f76f"]]),is=Ee({components:{Modal:Mo},props:{positionInfo:{type:Object,default:()=>({})}},setup(e){const n=k(()=>{var W,N;const X=T(((W=e.positionInfo)==null?void 0:W.poolUSD)/((N=e.positionInfo)==null?void 0:N.quoteUSD)*100,0);return console.log(X,"Pool Capacity Ratio"),Number(X)});return{sFixD:T,addCommom:R,ratio:n}}});const Ro=e=>(We("data-v-2a77a8ab"),e=e(),je(),e),ls=Ro(()=>o("svg",{class:"icon modal-icon-close","aria-hidden":"true"},[o("use",{"xlink:href":"#icon-a-icon-Shutdown"})],-1)),as={class:"deposit-slider"},us={class:"info-block"},rs=Ro(()=>o("div",{class:"leabl"},"Current Deposit：",-1)),ds={class:"text"},vs={class:"info-block"},ms=Ro(()=>o("div",{class:"leabl"},"Max Capacity：",-1)),cs={class:"text"};function ps(e,n,X,W,N,P){const u=no("Modal");return a(),se(u,{width:"440px",visible:!0,footer:null,title:"Vault Capacity",onCancel:n[0]||(n[0]=c=>e.$emit("onClose"))},{closeIcon:ke(()=>[ls]),default:ke(()=>{var c,g;return[o("div",as,[o("div",{class:"current-deposit",style:_o({width:`${e.ratio>100?100:e.ratio}%`})},null,4)]),o("div",us,[rs,o("div",ds,"$"+d(("addCommom"in e?e.addCommom:A(R))(("sFixD"in e?e.sFixD:A(T))((c=e.positionInfo)==null?void 0:c.poolUSD,2))),1)]),o("div",vs,[ms,o("div",cs,"$"+d(("addCommom"in e?e.addCommom:A(R))(("sFixD"in e?e.sFixD:A(T))((g=e.positionInfo)==null?void 0:g.quoteUSD,2))),1)])]}),_:1})}const Ko=Ue(is,[["render",ps],["__scopeId","data-v-2a77a8ab"]]),fs=Ee({components:{AutoPoolV2PoolCapacity:Ko},setup(){const e=xe(),n=k(()=>e),X=He(),W=k(()=>X),N=Qe(),P=w();_e(()=>[W.value.positionInfoObj,N.params.id],([h,s])=>{console.log(h,"##positionInfoObj"),h&&!Ze(h)&&s&&(P.value=h[s],console.log(P.value,"##positionInfo.value"))},{immediate:!0,deep:!0});const u=k(()=>{var h;return(h=P.value)==null?void 0:h.needReverse}),c=h=>{var s;return console.log(h,"info##"),(h==null?void 0:h.logoURI)||(h==null?void 0:h.logo_url)||((s=n.value.tokensObj[h==null?void 0:h.address])==null?void 0:s.logo_url)||uo("/image/coins/sui-unknown.png")},g=w(!1);return{needReverse:u,positionInfo:P,getCoinIcon:c,addCommom:R,isShowModal:g}}});const ys=e=>(We("data-v-f2fb77f4"),e=e(),je(),e),bs={class:"pool-composition"},gs={class:"pool-composition-top"},hs=ys(()=>o("span",null,"Vault Composition",-1)),ks={class:"pool-composition-bottom"},$s={class:"token-ratio"},_s={class:"before-coin"},ws={alt:""},Is={class:"after-coin"},Cs={alt:""},As={class:"token-num"},Ps={class:"num-box"},Ss={class:"num-box"};function Ts(e,n,X,W,N,P){var h,s,t,q,i,v,b,m,y,p,B,D,L,x,$,_,G,V,Y,M,I,ee,ve,ce,pe,de,ie,ue;const u=fo,c=Ko,g=So("image");return a(),f("div",bs,[o("div",gs,[hs,o("div",{class:"pool-capacity",onClick:n[0]||(n[0]=H=>e.isShowModal=!0)},"Vault Capacity")]),o("div",ks,[o("div",$s,[o("div",_s,[o("div",null,[z(u,{address:e.needReverse?(q=(t=e.positionInfo)==null?void 0:t.token_b)==null?void 0:q.address:(s=(h=e.positionInfo)==null?void 0:h.token_a)==null?void 0:s.address,"style-params":{width:"14px",height:"14px",right:"0",bottom:"0"}},null,8,["address"]),Ke(o("img",ws,null,512),[[g,e.needReverse?e.getCoinIcon((v=e.positionInfo)==null?void 0:v.token_b):e.getCoinIcon((i=e.positionInfo)==null?void 0:i.token_a)]])]),o("span",null,d((b=e.positionInfo)==null?void 0:b.poolCoinARatio)+"%",1)]),o("div",Is,[o("span",null,d((m=e.positionInfo)==null?void 0:m.poolCoinBRatio)+"%",1),o("div",null,[Ke(o("img",Cs,null,512),[[g,e.needReverse?e.getCoinIcon((p=e.positionInfo)==null?void 0:p.token_a):e.getCoinIcon((y=e.positionInfo)==null?void 0:y.token_b)]]),z(u,{address:e.needReverse?(x=(L=e.positionInfo)==null?void 0:L.token_a)==null?void 0:x.address:(D=(B=e.positionInfo)==null?void 0:B.token_b)==null?void 0:D.address,"style-params":{width:"14px",height:"14px",right:"0",bottom:"0"}},null,8,["address"])])])]),o("div",As,[o("div",{class:"token-a-bg",style:_o({width:`${($=e.positionInfo)==null?void 0:$.poolCoinARatio}%`})},null,4),o("div",{class:"token-b-bg",style:_o({width:`${(_=e.positionInfo)==null?void 0:_.poolCoinBRatio}%`})},null,4),o("div",Ps,[o("div",null,d(("addCommom"in e?e.addCommom:A(R))((G=e.positionInfo)==null?void 0:G.poolCoinANum))+" "+d(e.needReverse?(I=(M=e.positionInfo)==null?void 0:M.token_b)==null?void 0:I.symbol:(Y=(V=e.positionInfo)==null?void 0:V.token_a)==null?void 0:Y.symbol),1),o("div",null,"$"+d(("addCommom"in e?e.addCommom:A(R))((ee=e.positionInfo)==null?void 0:ee.poolCoinAUSD)),1)]),o("div",Ss,[o("div",null,d(("addCommom"in e?e.addCommom:A(R))((ve=e.positionInfo)==null?void 0:ve.poolCoinBNum))+" "+d(e.needReverse?(ie=(de=e.positionInfo)==null?void 0:de.token_a)==null?void 0:ie.symbol:(pe=(ce=e.positionInfo)==null?void 0:ce.token_b)==null?void 0:pe.symbol),1),o("div",null,"$"+d(("addCommom"in e?e.addCommom:A(R))((ue=e.positionInfo)==null?void 0:ue.poolCoinBUSD)),1)])])]),e.isShowModal?(a(),se(c,{key:0,"position-info":e.positionInfo,onOnClose:n[1]||(n[1]=H=>e.isShowModal=!1)},null,8,["position-info"])):E("",!0)])}const Zo=Ue(fs,[["render",Ts],["__scopeId","data-v-f2fb77f4"]]),Rs=Ee({setup(){const e=xe(),n=k(()=>e),X=He(),W=k(()=>X),N=Qe(),P=w();_e(()=>[W.value.positionInfoObj,N.params.id],([s,t])=>{console.log(s,"##positionInfoObj"),s&&!Ze(s)&&t&&(P.value=s[t],console.log(P.value,"##positionInfo.value"))},{immediate:!0,deep:!0});const u=k(()=>{var s;return(s=P.value)==null?void 0:s.needReverse}),c=s=>{var t;return console.log(s,"info##"),(s==null?void 0:s.logoURI)||(s==null?void 0:s.logo_url)||((t=n.value.tokensObj[s==null?void 0:s.address])==null?void 0:t.logo_url)||uo("/image/coins/sui-unknown.png")},g=To(),h=k(()=>g);return{needReverse:u,positionInfo:P,getCoinIcon:c,addCommom:R,wallet:h}}});const ro=e=>(We("data-v-c9de826f"),e=e(),je(),e),qs={class:"my-liquidity"},Ns={class:"my-liquidity-top"},Bs=ro(()=>o("div",null,"My Liquidity",-1)),Ds=ro(()=>o("p",null,"My share of pool",-1)),Fs={class:"my-liquidity-bottom"},Ms={class:"lp-token"},Os=ro(()=>o("div",null,[o("span",null,"LP Token Balance ")],-1)),Ls={class:"lp-balance"},Us={class:"token-num-content"},Vs={class:"token-num token-a-num"},Es={class:"logo"},Ws=["src"],js={class:"text"},Xs={class:"lp-logo"},Gs=["src"],Hs=ro(()=>o("div",null,"Pooled Assets",-1)),Ys={class:"token-num"},zs={class:"logo"},Js=["src"],Ks={class:"text"},Zs=ro(()=>o("div",{class:"token-num-content-bg"},null,-1));function Qs(e,n,X,W,N,P){var c,g,h,s,t,q,i,v,b,m,y,p,B,D,L,x,$,_,G,V,Y,M,I,ee,ve,ce,pe,de;const u=fo;return a(),f("div",qs,[o("div",Ns,[Bs,o("div",null,[Ds,o("p",null,d(e.wallet.connected?(c=e.positionInfo)==null?void 0:c.myShare:"--")+"%",1)])]),o("div",Fs,[o("div",Ms,[Os,o("div",null,[o("span",Ls,d(e.wallet.connected?("addCommom"in e?e.addCommom:A(R))((g=e.positionInfo)==null?void 0:g.myLiquidity):"--")+" LP",1),o("span",null,"$"+d(e.wallet.connected?("addCommom"in e?e.addCommom:A(R))((h=e.positionInfo)==null?void 0:h.myLiquidityUSD):"--"),1)])]),o("div",Us,[o("div",Vs,[o("div",Es,[o("img",{src:e.needReverse?e.getCoinIcon((t=e.positionInfo)==null?void 0:t.token_b):e.getCoinIcon((s=e.positionInfo)==null?void 0:s.token_a),alt:""},null,8,Ws),z(u,{address:e.needReverse?(b=(v=e.positionInfo)==null?void 0:v.token_b)==null?void 0:b.address:(i=(q=e.positionInfo)==null?void 0:q.token_a)==null?void 0:i.address,"style-params":{width:"14px",height:"14px",left:"18px",bottom:"0"}},null,8,["address"])]),o("div",js,[o("div",null,d(e.wallet.connected?("addCommom"in e?e.addCommom:A(R))((m=e.positionInfo)==null?void 0:m.amountA):"--")+" "+d(e.needReverse?(D=(B=e.positionInfo)==null?void 0:B.token_b)==null?void 0:D.symbol:(p=(y=e.positionInfo)==null?void 0:y.token_a)==null?void 0:p.symbol),1),o("div",null,d(e.wallet.connected?("addCommom"in e?e.addCommom:A(R))((L=e.positionInfo)==null?void 0:L.myAmountAUSD):"--"),1)])]),o("div",Xs,[o("img",{src:e.getCoinIcon((x=e.positionInfo)==null?void 0:x.lpInfo),alt:""},null,8,Gs),Hs]),o("div",Ys,[o("div",zs,[o("img",{src:e.needReverse?e.getCoinIcon((_=e.positionInfo)==null?void 0:_.token_a):e.getCoinIcon(($=e.positionInfo)==null?void 0:$.token_b),alt:""},null,8,Js),z(u,{address:e.needReverse?(M=(Y=e.positionInfo)==null?void 0:Y.token_a)==null?void 0:M.address:(V=(G=e.positionInfo)==null?void 0:G.token_b)==null?void 0:V.address,"style-params":{width:"14px",height:"14px",right:"0",bottom:"0"}},null,8,["address"])]),o("div",Ks,[o("div",null,d(e.wallet.connected?("addCommom"in e?e.addCommom:A(R))((I=e.positionInfo)==null?void 0:I.amountB):"--")+" "+d(e.needReverse?(pe=(ce=e.positionInfo)==null?void 0:ce.token_a)==null?void 0:pe.symbol:(ve=(ee=e.positionInfo)==null?void 0:ee.token_b)==null?void 0:ve.symbol),1),o("div",null,d(e.wallet.connected?("addCommom"in e?e.addCommom:A(R))((de=e.positionInfo)==null?void 0:de.myAmountBUSD):"--"),1)])]),Zs])])])}const Qo=Ue(Rs,[["render",Qs],["__scopeId","data-v-c9de826f"]]),xs=""+globalThis.__publicAssetsURL("image/icon-tips-error@2x.png");const ei={},xo=e=>(We("data-v-fcbc716b"),e=e(),je(),e),oi={class:"status"},ni=xo(()=>o("img",{src:xs,alt:""},null,-1)),ti=xo(()=>o("span",null,"Rebalancing is in processing. New deposits and withdraws are paused and will be back in minutes. ",-1)),si=[ni,ti];function ii(e,n){return a(),f("div",oi,si)}const en=Ue(ei,[["render",ii],["__scopeId","data-v-fcbc716b"]]),li=Ee({components:{AutoPoolAddModal:Go,AutoPoolV2PoolStatus:en},setup(){const e=To(),n=w(!1),X=yo(),W=k(()=>X),N=k(()=>W.value.chainName),P=k(()=>e),u=He(),c=k(()=>u),g=xe(),h=k(()=>g),s=w(),t=Qe(),q=w(!1),i=w(!1);_e(()=>[c.value.positionInfoObj,t.params.id],([C,U])=>{C&&!Ze(C)&&U&&(s.value=C[U],console.log(s.value,"##positionInfo.value"))},{immediate:!0,deep:!0});const v=k(()=>{var C,U;return console.log((C=s.value)==null?void 0:C.needReverse,"##positionInfo.value?.needReverse"),(U=s.value)==null?void 0:U.needReverse}),b=w(),m=w(),y=w(),p=w(),B=w(!0),D=k(()=>P.value.assets&&b.value&&P.value.assets[b.value.address]?Fo(P.value.assets[b.value.address].balance,b.value.decimals):0),L=k(()=>P.value.assets&&m.value&&P.value.assets[m.value.address]?Fo(P.value.assets[m.value.address].balance,m.value.decimals):0),x=C=>{C==="fromCoin"?(B.value=!0,y.value=D.value>0?b.value.symbol=="SUI"?new r(Number(D.value)).sub(new r(.05)).lt(new r(0))?"0":new r(Number(D.value)).sub(new r(.05)).toString():String(D.value):""):(B.value=!1,p.value=L.value>0?m.value.symbol=="SUI"?new r(Number(L.value)).sub(new r(.05)).lt(new r(0))?"0":new r(Number(L.value)).sub(new r(.05)).toString():String(L.value):"")},$=C=>{C==="fromCoin"?(B.value=!0,y.value=D.value>0?T(new r(Number(D.value)).div(2).toString(),b.value.decimals).toString():""):(B.value=!1,p.value=L.value>0?T(new r(Number(L.value)).div(2).toString(),m.value.decimals).toString():"")},_=k(()=>N.value?Eo(N.value):{}),G=k(()=>W.value.slippage),V=w("--"),Y=w("--"),M=C=>{const U=new r(s.value.autoPoolPositionInfo.liquidity),j=new r(C.toString());if(U.toNumber()>0&&j.toNumber()>0){const le=j.add(U);console.log("totalLiquidity:",j.div(le).mul(100).toString());const Te=j.div(le).mul(100).toNumber(),ae=fn(Te),he=ae==-1?2:ae+2,ye=T(j.div(le).mul(100).toNumber(),he);console.log(s.value.decimals,"##positionInfo.value.decimal");const l=new r(1).div(new r(Math.pow(10,s.value.lpInfo.decimals))).toString();console.log(ye,l,"###288"),Number(ye)<Number(l)?V.value=`<${l}`:V.value=ye}else j.toNumber()>0&&U.toNumber()<=0?V.value="100":V.value="--"},I=C=>{const U=new r(C.toString()),j=new r(G.value).div(100),le=U.mul(j),Te=U.sub(le),ae=Io.get_lp_amount_by_liquidity({liquidity:s.value.liquidity,total_supply:s.value.total_supply},Te),he=new r(Math.pow(10,s.value.lpInfo.decimals)),ye=new r(ae).div(he).toString();Y.value=ye},ee=w(!1),ve=w(!1),ce=w(""),pe=w(),de=async()=>{if(!s.value)return;console.log(y.value,p.value,"####updateAmounts"),i.value=!1;const C=s.value.autoPoolPositionInfo.tick_lower_index,U=s.value.autoPoolPositionInfo.tick_upper_index,j=Oe.sqrtPriceX64ToTickIndex(new me(s.value.current_sqrt_price));let le=Oe.tickIndexToSqrtPriceX64(C),Te=Oe.tickIndexToSqrtPriceX64(U);j<C&&(v.value?ee.value=!0:ve.value=!0),j>U&&(v.value?ve.value=!0:ee.value=!0);let ae;if(console.log(y.value||p.value,"#fromCoinAmount.value || toCoinAmount.value"),y.value||p.value){B.value?ae=new r(y.value).mul(Math.pow(10,b.value.decimals)).toString():ae=new r(p.value).mul(Math.pow(10,m.value.decimals)).toString();let he,ye=B.value;if(console.log("执行##"),(Z.value||Se.value)&&!ee.value&&!ve.value){console.log(v.value?B.value:!B.value,"#needReverse.value?fixedFromCoin.value:!fixedFromCoin.value");const F=await Pe.calculateDepositSwapAmount({lowerTick:C,upperTick:U,curSqrtPrice:new me(s.value.current_sqrt_price),fix_amount_a:ye,input_amount:ae,coinTypeA:s.value.autoPoolPositionInfo.coin_type_a,coinTypeB:s.value.autoPoolPositionInfo.coin_type_b,clmm_pool:s.value.address,slippage:Number(G.value)/100,decimals:Z.value?b.value.decimals:m.value.decimals});if(console.log(F,"###swapResult"),F){q.value=F.is_exceed,he=new me(F.afterSqrtPrice),ae=new me(F.swapOutAmount),pe.value={swap_amount:F.swapInAmount,a2b:ye},ye=!ye;const oe=s.value.token_a.decimals,J=s.value.token_b.decimals;$o.value=Oe.sqrtPriceX64ToPrice(F.afterSqrtPrice,oe,J).toString(),console.log($o.value,"##afterCurrentPrice.value");const re=new r(F.swapInAmount).div(new r(Math.pow(10,oe))).toString(),be=new r(F.swapOutAmountLimit).div(new r(Math.pow(10,J))).toString(),ne=v.value?s.value.token_b.symbol:s.value.token_a.symbol,te=v.value?s.value.token_a.symbol:s.value.token_b.symbol;ce.value=`To deposit ${R(Z.value?y.value:p.value)} ${Z.value?ne:te},
          ${R(re)} ${Z.value?ne:te}  will be traded for ${R(be)} ${Z.value?te:ne} added to the pool.`}else i.value=!0}else q.value=!1,he=s.value.current_sqrt_price,ae=new me(ae),$o.value="",ce.value="";console.log(pe,"##swapParams");let l,O,Q;if(j>=C&&j<=U){const F=_.value.estLiquidityAndcoinAmountFromOneAmounts({tokenA:b.value,tokenB:m.value,lowerTick:C,upperTick:U,coinAmount:ae,iscoinA:ye,roundUp:!0,slippage:Number(G.value)/100,curSqrtPrice:new me(he)});l=F.liquidityAmount,O=F.tokenMaxA,Q=F.tokenMaxB,!Z.value&&!Se.value&&(B.value?p.value=Number(Q)>0?Q:"":y.value=Number(O)>0?O:"")}else j<U?l={liquidityAmount:cn(le,Te,ae),tokenMaxA:0,tokenMaxB:p.value}.liquidityAmount:l={liquidityAmount:pn(le,Te,ae),tokenMaxA:y.value,tokenMaxB:0}.liquidityAmount;console.log(l.toString(),"liquidityAmount###"),M(l),I(l)}};_e(()=>s.value,C=>{C&&!Ze(C)&&(b.value=C==null?void 0:C.token_a,m.value=C==null?void 0:C.token_b,ee.value=!1,ve.value=!1,de())},{immediate:!0});const ie=k(()=>h.value.RATES),ue=k(()=>{var C,U,j,le,Te,ae,he,ye,l,O;if((U=ie.value[(C=b.value)==null?void 0:C.address])!=null&&U.price&&((le=ie.value[(j=m.value)==null?void 0:j.address])!=null&&le.price)){console.log((ae=ie.value[(Te=b.value)==null?void 0:Te.address])==null?void 0:ae.price,"RATES.value[fromCoin.value?.address]?.price");const Q=new r(y.value||0).mul(new r((ye=ie.value[(he=b.value)==null?void 0:he.address])==null?void 0:ye.price)),F=new r(p.value||0).mul(new r((O=ie.value[(l=m.value)==null?void 0:l.address])==null?void 0:O.price));return Ve(Q.add(F).toString(),2)}else return"--"});_e(()=>y.value,(C,U)=>{console.log(C,"##newVal"),C?de():(V.value="--",p.value="",Y.value="--")},{immediate:!0}),_e(()=>p.value,(C,U)=>{C?de():(y.value="",V.value="--",Y.value="--")},{immediate:!0});const{t:H,locale:S}=Co(),K=k(()=>{var C,U;if(Z.value||Se.value){const j=Z.value?y.value:p.value,le=Z.value?b.value:m.value;if((C=ie.value[le==null?void 0:le.address])!=null&&C.price)return new r(j||0).mul(new r((U=ie.value[le==null?void 0:le.address])==null?void 0:U.price)).toNumber()}return 0}),qe=k(()=>{const C=Number(y.value)>Number(D.value),U=Number(p.value)>Number(L.value);return!y.value&&!p.value?H("button.enterAmount"):C?H("button.insufficientBalance",{name:b.value.symbol}):U?H("button.insufficientBalance",{name:m.value.symbol}):q.value?H("button.insufficientLiquidity"):Number(s.value.quoteUSD)>0&&Number(ue.value)>Number(s.value.quoteUSD)?"Exceeded the max capacity":i.value?H("button.enterAmount"):(console.log(K.value),"Add Liquidity")}),ge=k(()=>{const C=Number(y.value)>Number(D.value),U=Number(p.value)>Number(L.value);return!!(!y.value&&!p.value||C||U||y.value<=0&&p.value<=0||q.value||eo.value!=="STATUS_RUNNING"||(console.log(ue.value,s.value.quoteUSD,"positionInfo.value.quoteUSD#"),Number(s.value.quoteUSD)>0&&Number(ue.value)>Number(s.value.quoteUSD))||i.value||K.value>1e4)}),we=w(!0),{setIsShowSuccess:Ne,setIsShowRejected:Ie,setIsShowWaiting:fe,setTransactionDesc:Be,setTransactionTxid:Ce,setPositiomNum:Fe}=X,Pe=Vo("Sui"),ze=async()=>{var l,O;n.value=!1,we.value=!0,Ce("");const C=`${R(y.value)} ${(l=b.value)==null?void 0:l.symbol}`,U=`${R(p.value)} ${(O=m.value)==null?void 0:O.symbol}`;Be(`Deposit ${y.value>0?C:""} ${p.value>0&&y.value>0?"and":""} ${p.value>0?U:""}`),fe(!0);const j=B.value,le=s.value.autoPoolPositionInfo.tick_lower_index,Te=s.value.autoPoolPositionInfo.tick_upper_index,ae=Oe.sqrtPriceX64ToTickIndex(new me(s.value.current_sqrt_price));let he;B.value?he=new r(y.value).mul(Math.pow(10,b.value.decimals)).toString():he=new r(p.value).mul(Math.pow(10,m.value.decimals)).toString();const ye=s.value.rewarderInfo.map(Q=>Q.coinAddress);try{const Q={lowerTick:le,upperTick:Te,coinAmount:he,fix_amount_a:j,slippage:Number(G.value)/100,curSqrtPrice:new me(s.value.current_sqrt_price),id:s.value.id,clmm_pool:s.value.autoPoolPositionInfo.pool,lp_token_type:s.value.lp_token_type,coinTypeA:s.value.autoPoolPositionInfo.coin_type_a,coinTypeB:s.value.autoPoolPositionInfo.coin_type_b,rewarder_coin_types:ye,swapParams:pe.value,isOnlyA:Z.value,isOnlyB:Se.value,currentTickIndex:ae},F=await Pe.deposit(Q);console.log(F,"===>payloadAdd11111");const oe=await P.value.currentWallet.signAndExecuteTransactionBlock(F);let J=_.value.handleTx(oe);if(console.log("toAdd###tx###",J),J&&J.hash){Ce(J.hash),fe(!1),Ne(!0),console.log(s,"===>positionInfo");const re={title:"Supplied",desc:`Deposit ${y.value>0?C:""} ${p.value>0&&y.value>0?"and":""} ${p.value>0?U:""}`,hash:J.hash,tit:"Liquidity Increased",icon:"icon-icon-Increased",text:`Deposit ${y.value>0?C:""} ${p.value>0&&y.value>0?"and":""} ${p.value>0?U:""}`};N.value!=="Aptos"&&(re.res=J.res),_.value.showTransitionPending(re),await _.value.watchTransaction(re)&&setTimeout(()=>{u.updatePositionItem(s.value.id),_.value.getAccount(P.value.address)},1e3),Fe()}else fe(!1),Ie(!0);y.value="",p.value="",we.value=!1}catch(Q){y.value="",p.value="",console.log("addError###",Q),we.value=!1,fe(!1),Ie(!0)}},Z=w(!1),Se=w(!1),to=C=>{y.value="",p.value="",ce.value="",C=="only-a"?(Z.value=!Z.value,Se.value=!1):(Se.value=!Se.value,Z.value=!1)},eo=k(()=>c.value.currentAutoPoolStatus),mo=w(),go=()=>{mo.value=window.setInterval(()=>{(y.value||p.value)&&de()},2e4)};return co(()=>{go()}),po(()=>{window.clearInterval(mo.value)}),{currentAutoPoolStatus:eo,wallet:P,positionInfo:s,isShowAddModal:n,needReverse:v,fromCoin:b,toCoin:m,fromCoinAmount:y,toCoinAmount:p,fromCoinBlance:D,toCoinBlance:L,fixedFromCoin:B,maxBtnSelect:x,halfBtnSelect:$,totalAmountUSD:ue,addCommom:R,shareOfPool:V,minimumReceivedLP:Y,addLiquidityBtnText:qe,addLiquidityBtnDisabled:ge,toAdd:ze,showToCoinLock:ve,showFromCoinLock:ee,isOnlyA:Z,isOnlyB:Se,onlyToken:to,onlyText:ce,onlyTokenUSD:K}}});const Ye=e=>(We("data-v-f9bf5cc9"),e=e(),je(),e),ai={class:"auto-pool-add"},ui={class:"auto-pool-add-content"},ri={class:"liquidity-action-tab"},di=Ye(()=>o("div",{class:"increase tab-active"},"Add",-1)),vi={class:"only-token"},mi=Ye(()=>o("div",null,"Deposit Amounts",-1)),ci={key:0},pi=Ye(()=>o("div",{class:"hover-text"},"You can also choose to deposit in only one asset type. In that case, the vault will convert your asset to the required propositions using Cetus. Please note that trading fees & slippage will be applied. When slippage is involved, a certain amount of post-swap dust (no loss of funds) will be returned to you.",-1)),fi={key:0},yi=Ye(()=>o("div",{class:"hover-text"},"You can also choose to deposit in only one asset type. In that case, the vault will convert your asset to the required propositions using Cetus. Please note that trading fees & slippage will be applied. When slippage is involved, a certain amount of post-swap dust (no loss of funds) will be returned to you.",-1)),bi={key:0,class:"card-item"},gi={key:1,class:"card-item"},hi=Ye(()=>o("span",null,"Pool Closed",-1)),ki={key:4,class:"add-info"},$i={key:0,class:"only-text"},_i={class:"total-amount"},wi=Ye(()=>o("span",null,"Total Amount",-1)),Ii={class:"total-amount"},Ci=Ye(()=>o("span",null,"Share of Pool",-1)),Ai={key:0},Pi={key:1},Si={class:"total-amount"},Ti=Ye(()=>o("span",null,"Minimum Received LP",-1)),Ri={key:0},qi={key:1},Ni={key:5,class:"add-info only-add-info"},Bi=Ye(()=>o("div",{class:"only-text"},"Single-asset deposit can't be higher than $10,000 at a time.",-1)),Di=[Bi];function Fi(e,n,X,W,N,P){var t,q,i,v,b,m,y,p,B,D,L,x,$,_,G,V,Y;const u=jo,c=Xo,g=no("AutoPoolV2PoolStatus"),h=Ao,s=Go;return a(),f("div",ai,[o("div",ui,[o("div",ri,[di,o("div",{class:"remove",onClick:n[0]||(n[0]=Uo(M=>e.$emit("changeCurrentTab"),["stop"]))},"Remove")]),o("div",vi,[mi,o("div",null,[o("div",{class:"only-a",onClick:n[1]||(n[1]=M=>e.onlyToken("only-a"))},[o("p",null,[e.isOnlyA?(a(),f("span",ci)):E("",!0)]),o("span",null,d(e.needReverse?(v=(i=e.positionInfo)==null?void 0:i.token_b)==null?void 0:v.symbol:(q=(t=e.positionInfo)==null?void 0:t.token_a)==null?void 0:q.symbol)+" only",1),pi]),o("div",{class:"only-b",onClick:n[2]||(n[2]=M=>e.onlyToken("only-b"))},[o("p",null,[e.isOnlyB?(a(),f("span",fi)):E("",!0)]),o("span",null,d(e.needReverse?(p=(y=e.positionInfo)==null?void 0:y.token_a)==null?void 0:p.symbol:(m=(b=e.positionInfo)==null?void 0:b.token_b)==null?void 0:m.symbol)+" only",1),yi])])]),o("div",{class:De(e.needReverse?"card-container reverse":"card-container")},[(e.needReverse?!e.isOnlyA:!e.isOnlyB)?(a(),f("div",bi,[z(u,{modelValue:e.fromCoinAmount,"onUpdate:modelValue":n[3]||(n[3]=M=>e.fromCoinAmount=M),"input-value":e.fromCoinAmount,"coin-symbol":e.fromCoin?e.fromCoin.symbol:null,"coin-name":e.fromCoin?e.fromCoin.name:null,balance:e.fromCoinBlance,"coin-icon":e.fromCoin?e.fromCoin.logoURI:"",address:e.fromCoin?e.fromCoin.address:"","swap-direct":"From","import-page":"deposit","has-arrow":!1,onOnMax:n[4]||(n[4]=M=>e.maxBtnSelect("fromCoin")),onOnHalf:n[5]||(n[5]=M=>e.halfBtnSelect("fromCoin")),onOnInput:n[6]||(n[6]=M=>{e.fromCoinAmount=M}),onOnFocus:n[7]||(n[7]=()=>{e.fixedFromCoin=!0})},null,8,["modelValue","input-value","coin-symbol","coin-name","balance","coin-icon","address"]),e.showFromCoinLock&&!e.isOnlyA?(a(),se(c,{key:0})):E("",!0)])):E("",!0),(e.needReverse?!e.isOnlyB:!e.isOnlyA)?(a(),f("div",gi,[z(u,{modelValue:e.toCoinAmount,"onUpdate:modelValue":n[8]||(n[8]=M=>e.toCoinAmount=M),"input-value":e.toCoinAmount,"coin-symbol":e.toCoin?e.toCoin.symbol:null,"coin-name":e.toCoin?e.toCoin.name:null,balance:e.toCoinBlance,"swap-direct":"To","coin-icon":e.toCoin?e.toCoin.logoURI:"",address:e.toCoin?e.toCoin.address:"","import-page":"deposit","has-arrow":!1,onOnMax:n[9]||(n[9]=M=>e.maxBtnSelect("toCoin")),onOnHalf:n[10]||(n[10]=M=>e.halfBtnSelect("toCoin")),onOnInput:n[11]||(n[11]=M=>{e.toCoinAmount=M}),onOnFocus:n[12]||(n[12]=()=>{e.fixedFromCoin=!1})},null,8,["modelValue","input-value","coin-symbol","coin-name","balance","coin-icon","address"]),e.showToCoinLock&&!e.isOnlyB?(a(),se(c,{key:0})):E("",!0)])):E("",!0)],2)]),e.currentAutoPoolStatus=="STATUS_REBALANCING"?(a(),se(g,{key:0})):E("",!0),(B=e.positionInfo)!=null&&B.is_pause?(a(),se(h,{key:1,class:"big-btn liquidity-btn",disabled:!0},{default:ke(()=>[hi]),_:1})):e.wallet.connected?(a(),se(h,{key:2,class:"big-btn liquidity-btn",disabled:e.addLiquidityBtnDisabled,onClick:n[13]||(n[13]=M=>e.isShowAddModal=!0)},{default:ke(()=>[o("span",null,d(e.addLiquidityBtnText),1)]),_:1},8,["disabled"])):(a(),se(h,{key:3,class:"big-btn liquidity-btn",onClick:n[14]||(n[14]=M=>e.wallet.setIsShowWalletModal(!0))},{default:ke(()=>[o("span",null,d(e.$t("button.connectWallet")),1)]),_:1})),e.onlyTokenUSD<=1e4?(a(),f("div",ki,[e.onlyText&&(e.isOnlyA&&e.fromCoinAmount>0||e.isOnlyB&&e.toCoinAmount>0)?(a(),f("div",$i,d(e.onlyText),1)):E("",!0),o("div",_i,[wi,o("span",null,"$"+d(("addCommom"in e?e.addCommom:A(R))(e.totalAmountUSD)),1)]),o("div",Ii,[Ci,e.fromCoinAmount&&e.toCoinAmount||e.isOnlyA&&e.fromCoinAmount||e.isOnlyB&&e.toCoinAmount?(a(),f("span",Ai,d(e.shareOfPool)+"%",1)):(a(),f("span",Pi,"--%"))]),o("div",Si,[Ti,e.fromCoinAmount&&e.toCoinAmount||e.isOnlyA&&e.fromCoinAmount||e.isOnlyB&&e.toCoinAmount?(a(),f("span",Ri,d(("addCommom"in e?e.addCommom:A(R))(e.minimumReceivedLP))+" "+d(e.needReverse?(D=e.toCoin)==null?void 0:D.symbol:(L=e.fromCoin)==null?void 0:L.symbol)+"-"+d(e.needReverse?(x=e.fromCoin)==null?void 0:x.symbol:($=e.toCoin)==null?void 0:$.symbol),1)):(a(),f("span",qi,"--"+d(e.needReverse?(_=e.toCoin)==null?void 0:_.symbol:(G=e.fromCoin)==null?void 0:G.symbol)+"-"+d(e.needReverse?(V=e.fromCoin)==null?void 0:V.symbol:(Y=e.toCoin)==null?void 0:Y.symbol),1))])])):(a(),f("div",Ni,Di)),e.isShowAddModal?(a(),se(s,{key:6,"pool-info":e.positionInfo,"from-coin":e.needReverse?e.positionInfo.token_b:e.positionInfo.token_a,"to-coin":e.needReverse?e.positionInfo.token_a:e.positionInfo.token_b,"from-coin-amount":e.needReverse?e.toCoinAmount:e.fromCoinAmount,"to-coin-amount":e.needReverse?e.fromCoinAmount:e.toCoinAmount,"total-amount":e.totalAmountUSD,"share-of-pool":e.shareOfPool,"minimum-received-l-p":e.minimumReceivedLP,"is-only-a":e.isOnlyA,"is-only-b":e.isOnlyB,onOnClose:n[15]||(n[15]=M=>e.isShowAddModal=!1),onToAdd:e.toAdd},null,8,["pool-info","from-coin","to-coin","from-coin-amount","to-coin-amount","total-amount","share-of-pool","minimum-received-l-p","is-only-a","is-only-b","onToAdd"])):E("",!0)])}const Mi=Ue(li,[["render",Fi],["__scopeId","data-v-f9bf5cc9"]]),Oi=Ee({components:{AutoPoolRemoveModal:Ho,AutoPoolV2PoolStatus:en},setup(){const e=To(),n=k(()=>e),X=yo(),W=k(()=>X),N=k(()=>W.value.slippage),P=k(()=>W.value.chainName),u=[{name:"25%",value:25},{name:"50%",value:50},{name:"75%",value:75},{name:"MAX",value:100}],c=w(25),g=Qe(),h=He(),s=k(()=>h),t=k(()=>(console.log(s.value.positionInfoObj[g.params.id],"autoPool.value.positionInfoObj[route.params.id]###"),s.value.positionInfoObj[g.params.id])),q=k(()=>{var l;return(l=t.value)==null?void 0:l.needReverse}),i=w(),v=w(),b=w(!1),m=w(),y=k(()=>{var l;return(l=t.value)==null?void 0:l.myLiquidity}),p=w(!0),B=k(()=>P.value?Eo(P.value):{}),D=w(),L=w(),x=Vo("Sui"),$=w(""),_=w(""),G=w("--"),V=w(!1),Y=w(!1),M=w(),I=w(!0),ee=w(),ve=xe(),ce=k(()=>ve),pe=k(()=>ce.value.RATES),de=async()=>{if(p.value||!t.value)return;L.value=!1;const l=t.value.autoPoolPositionInfo.tick_lower_index,O=t.value.autoPoolPositionInfo.tick_upper_index,Q=Oe.sqrtPriceX64ToTickIndex(new me(t.value.current_sqrt_price));Q<l&&(q.value?V.value=!0:Y.value=!0),Q>O&&(q.value?Y.value=!0:V.value=!0);let F;if(console.log($.value||_.value,"#fromCoinAmount.value || toCoinAmount.value"),$.value||_.value){I.value?F=new r($.value).mul(Math.pow(10,i.value.decimals)).toString():F=new r(_.value).mul(Math.pow(10,v.value.decimals)).toString();let oe,J=I.value;if(S.value||K.value){const te=await x.calculateRemoveSwapAmount({lowerTick:l,upperTick:O,curSqrtPrice:new me(t.value.current_sqrt_price),fix_amount_a:J,receiveAmount:F,coinTypeA:t.value.autoPoolPositionInfo.coin_type_a,coinTypeB:t.value.autoPoolPositionInfo.coin_type_b,clmm_pool:t.value.address,slippage:0,decimals:S.value?i.value.decimals:v.value.decimals});if(console.log(te,"###swapResult"),te){D.value=te.is_exceed,F=new me(te.swapOutAmount),oe=t.value.current_sqrt_price,M.value={swap_amount:te.swapInAmount,liquidity:te.liquidity,a2b:!J},J=!J;const Ge=t.value.token_a.decimals,oo=t.value.token_b.decimals,Ae=new r(te.swapInAmount).div(new r(Math.pow(10,Ge))).toString(),so=new r(te.swapOutAmountLimit).div(new r(Math.pow(10,oo))).toString(),$e=q.value?t.value.token_b.symbol:t.value.token_a.symbol,Re=q.value?t.value.token_a.symbol:t.value.token_b.symbol;ee.value=$.value==j.value||_.value==j.value?`To withdraw ${R(S.value?$.value:_.value)} ${S.value?$e:Re},
          ${R(S.value?t.value.amountB:t.value.amountA)} ${S.value?Re:$e} 
           in the pool will be traded for ${Ae} ${S.value?$e:Re}`:`To withdraw ${R(S.value?$.value:_.value)} ${S.value?$e:Re},
          ${R(Ae)} ${S.value?Re:$e}  in the pool will be traded for ${R(so)} ${S.value?$e:Re}`}else{L.value=!0,ee.value="";return}}else D.value=!1,oe=t.value.current_sqrt_price,F=new me(F);console.log(oe,"##curSqrtPrice"),console.log("执行了吗##");const{liquidityAmount:re,tokenMaxA:be,tokenMaxB:ne}=B.value.estLiquidityAndcoinAmountFromOneAmounts({tokenA:i.value,tokenB:v.value,lowerTick:l,upperTick:O,coinAmount:F,iscoinA:J,roundUp:!1,slippage:Number(N.value)/100,curSqrtPrice:new me(oe)});if(console.log(t.value.current_sqrt_price,"##positionInfo.value.current_sqrt_price"),console.log(ne.toString(),be.toString(),t.value,"###323"),!S.value&&!K.value&&(I.value?_.value=Number(ne)>0?ne:"":$.value=Number(be)>0?be:""),(S.value||K.value)&&($.value==j.value||_.value==j.value)){m.value=t.value.myLiquidity;const te=new r(100);G.value=new r(t.value.myLiquidity).mul(new r(Math.pow(10,t.value.lpInfo.decimals))).toString(),ie.value=re.toString(),c.value=te.toNumber()}else{const te=Io.get_lp_amount_by_liquidity({liquidity:t.value.liquidity,total_supply:t.value.total_supply},re.toString());m.value=new r(te).div(new r(Math.pow(10,t.value.lpInfo.decimals))).toString();const Ge=new r(m.value).div(new r(y.value)).mul(100);console.log(m.value,y.value,"####lpBalance.value"),G.value=te,ie.value=re.toString(),c.value=Ge.toNumber()}}},ie=w(),ue=k(()=>{var l;return(l=t==null?void 0:t.value)==null?void 0:l.amountA}),H=k(()=>{var l;return(l=t==null?void 0:t.value)==null?void 0:l.amountB}),S=w(!1),K=w(!1),qe=k(()=>{var J,re,be,ne;const l=(re=pe.value[(J=i==null?void 0:i.value)==null?void 0:J.address])==null?void 0:re.price,O=(ne=pe.value[(be=v==null?void 0:v.value)==null?void 0:be.address])==null?void 0:ne.price;console.log(l,O,$.value,_.value,"####totalWithdraw");let Q=$.value!=="--"&&$.value!==""?$.value:0,F=_.value!=="--"&&_.value!==""?_.value:0,oe;return l&&O&&(S.value||K.value?oe=new r(S.value?Q:F).mul(new r(S.value?l:O)).toString():(oe=new r(Q).mul(new r(l)).add(new r(F).mul(new r(O))).toString(),console.log(oe,"result##"))),oe>0&&oe<.01?"<$0.01":`$${R(T(oe,2))}`}),ge=async l=>{var Ge,oo,Ae,so,$e,Re,ho,qo,No,Bo;if(!p.value)return;p.value=!0,L.value=!1,(oo=(Ge=t.value)==null?void 0:Ge.token_a)==null||oo.decimals,(so=(Ae=t.value)==null?void 0:Ae.token_b)==null||so.decimals;const O=($e=t.value)==null?void 0:$e.tick_lower_index,Q=(Re=t.value)==null?void 0:Re.tick_upper_index;Oe.tickIndexToSqrtPriceX64(O),Oe.tickIndexToSqrtPriceX64(Q);const F=(qo=(ho=t.value)==null?void 0:ho.autoPoolPositionInfo)==null?void 0:qo.tick_lower_index,oe=(Bo=(No=t.value)==null?void 0:No.autoPoolPositionInfo)==null?void 0:Bo.tick_upper_index,J=Oe.sqrtPriceX64ToTickIndex(new me(t.value.current_sqrt_price));J<F&&(q.value?V.value=!0:Y.value=!0),J>oe&&(q.value?Y.value=!0:V.value=!0);let re="",be,ne;console.log(l.value,"##item.value"),console.log(ne,"##coinAmount");let te=I.value;if(console.log("执行##"),S.value||K.value&&!V.value&&!Y.value){if(S.value){const Je=new r(j.value).mul(Math.pow(10,i.value.decimals)).mul(l.value).toString();console.log(Je,"##amount"),ne=T(Je,0),$.value=T(new r(j.value).mul(l.value).toString(),i.value.decimals)}if(K.value){const Je=new r(j.value).mul(l.value).mul(Math.pow(10,v.value.decimals)).toString();ne=T(Je,0),_.value=T(new r(j.value).mul(l.value).toString(),v.value.decimals)}console.log($.value,"##fromCoinAmount.value");const Me=await x.calculateRemoveSwapAmount({lowerTick:O,upperTick:Q,curSqrtPrice:new me(t.value.current_sqrt_price),fix_amount_a:te,receiveAmount:ne,coinTypeA:t.value.autoPoolPositionInfo.coin_type_a,coinTypeB:t.value.autoPoolPositionInfo.coin_type_b,clmm_pool:t.value.address,slippage:0,decimals:S.value?i.value.decimals:v.value.decimals});if(console.log(Me,"###swapResult536"),Me){D.value=Me.is_exceed,ne=new me(Me.swapOutAmount),t.value.current_sqrt_price,M.value={swap_amount:Me.swapInAmount,liquidity:Me.liquidity,a2b:!te},te=!te;const Je=t.value.token_a.decimals,on=t.value.token_b.decimals,nn=new r(Me.swapInAmount).div(new r(Math.pow(10,Je))).toString(),Do=new r(Me.swapOutAmountLimit).div(new r(Math.pow(10,on))).toString(),io=q.value?t.value.token_b.symbol:t.value.token_a.symbol,lo=q.value?t.value.token_a.symbol:t.value.token_b.symbol;ee.value=l.value==1?`To withdraw ${R(S.value?$.value:_.value)} ${S.value?io:lo},
          ${R(S.value?t.value.amountB:t.value.amountA)} ${S.value?lo:io}  in the pool will be traded for ${R(Do)} ${S.value?io:lo}`:`To withdraw ${R(S.value?$.value:_.value)} ${S.value?io:lo},
          ${R(nn)} ${S.value?lo:io}  in the pool will be traded for ${R(Do)} ${S.value?io:lo}`,re=Me.liquidity}else t.value.current_sqrt_price,ne=new me(ne),ee.value="",L.value=!0;console.log(be,"result###"),G.value=new r(t.value.myLiquidity).mul(new r(l.value)).toString(),console.log(t.value,t.value.liquidity,re,G.value,"###positionInfo.value.liquidity"),console.log(G.value,"##lpTokenAmount.value"),m.value=new r(G.value),ie.value=re}else{D.value=!1;const Me=new r(ue.value).mul(Math.pow(10,i.value.decimals)).mul(l.value).toString();ne=T(Me,0),$.value=T(new r(ue.value).mul(l.value).toString(),i.value.decimals);const Je=new r(H.value).mul(l.value).mul(Math.pow(10,v.value.decimals)).toString();ne=T(Je,0),_.value=T(new r(H.value).mul(l.value).toString(),v.value.decimals),t.value.current_sqrt_price,ne=new me(ne),l.value!==1?be=new r(t.value.myLiquidity).mul(Math.pow(10,t.value.lpInfo.decimals)).mul(l.value).toString():be=new r(t.value.myLiquidity).mul(Math.pow(10,t.value.lpInfo.decimals)).toString(),m.value=new r(be).div(Math.pow(10,t.value.lpInfo.decimals)),re=Io.get_share_liquidity_by_amount({liquidity:t.value.liquidity,total_supply:t.value.total_supply},be),G.value=T(be,0),ie.value=T(re,0),console.log(re,"###newLiquidity525")}};_e(c,ko((l,O)=>{l!==O&&(Number(l)>100?c.value=100:l&&t.value?(console.log("687===>"),c.value=l,ge({value:c.value/100})):($.value="",_.value=""))},300)),_e(()=>$.value,ko((l,O)=>{l?de():(_.value="",c.value=0)},500),{immediate:!0}),_e(()=>_.value,ko((l,O)=>{l?de():($.value="",c.value=0)},500),{immediate:!0});const we=Po(),{setIsShowSuccess:Ne,setIsShowRejected:Ie,setIsShowWaiting:fe,setTransactionDesc:Be,setTransactionTxid:Ce,setPositiomNum:Fe,setTransactionDescText:Pe}=X,ze=w(!1),{t:Z}=Co(),Se=async()=>{var Ge,oo;ze.value=!0,Ce("");const l=Number($.value)>0?`${R($.value,i.value.decimals)} ${i.value.symbol}`:"",O=Number(_.value)>0?`${R(_.value,v.value.decimals)} ${v.value.symbol}`:"";console.log(l,O,"###transactionDescTo"),Be(Z("tips.removeLiquidiyText",{from:q.value?O:l,and:Number($.value)>0&&Number(_.value)>0?"and":"",to:q.value?l:O})),fe(!0);const Q=Z("modal.removeLiquidityText2");Pe(Q);const F=t.value.autoPoolPositionInfo.tick_lower_index,oe=t.value.autoPoolPositionInfo.tick_upper_index,J=Oe.tickIndexToSqrtPriceX64(F),re=Oe.tickIndexToSqrtPriceX64(oe),be=t.value.rewarderInfo.map(Ae=>Ae.coinAddress);console.log(G.value,"##lpTokenAmount.value431");let ne;I.value?ne=new r($.value).mul(Math.pow(10,i.value.decimals)).toString():ne=new r(_.value).mul(Math.pow(10,v.value.decimals)).toString(),console.log();const te={lowerSqrtPrice:J,upperSqrtPrice:re,lpTokenAmount:G.value,liquidity:ie.value,curSqrtPrice:new me(t.value.object.current_sqrt_price),slippage:Number(N.value)/100,id:t.value.id,clmm_pool:t.value.autoPoolPositionInfo.pool,lp_token_type:t.value.lp_token_type,coinTypeA:t.value.autoPoolPositionInfo.coin_type_a,coinTypeB:t.value.autoPoolPositionInfo.coin_type_b,rewarder_coin_types:be,swapParams:M.value,fix_amount_a:I.value,isOnlyA:!V.value&&!Y.value?S.value:!1,isOnlyB:!Y.value&&!V.value?K.value:!1,lowerTick:F,upperTick:oe,receiveAmount:ne,sliderVal:c.value,positionInfo:t.value};try{const Ae=await x.remove(te);console.log(Ae,"移除流动性payload");const so=await n.value.currentWallet.signAndExecuteTransactionBlock(Ae);let $e=B.value.handleTx(so);if(console.log("0331###remove###tx####",$e),$e&&$e.hash){Ce($e.hash),fe(!1),Ne(!0);const Re={title:Z("common.removeLiquidity"),desc:"",hash:$e.hash,descTransactions:`Remove ${l} ${Number($.value)>0&&Number(_.value)>0?"and":""} ${O} from the pool`,sender:n.value.address,chainName:"Sui",tit:"Liquidity Removed",icon:"icon-icon-Removed",text:`Withdraw ${$.value} ${(Ge=i.value)==null?void 0:Ge.symbol} and ${_.value} ${(oo=v.value)==null?void 0:oo.symbol}`};Re.res=$e.res,B.value.showTransitionPending(Re),await B.value.watchTransaction(Re)&&($.value="",_.value="",m.value="",c.value=0,setTimeout(()=>{h.updatePositionItem(t.value.id),B.value.getAccount(n.value.address)},1e3),Number(c.value)==100&&g.name=="auto-pool-detail"&&we.push("/pool/auto"))}else fe(!1),Ie(!0);ze.value=!1}catch(Ae){console.log("Remove error",Ae),ze.value=!1,fe(!1),Ie(!0)}};_e(()=>t.value,(l,O)=>{l&&!Ze(l)&&(i.value=l==null?void 0:l.token_a,v.value=l==null?void 0:l.token_b,console.log("触发###"),(!O||O&&O.address!==l.address)&&(c.value=c.value>0?c.value:25,ge({value:c.value/100})))},{immediate:!0});const to=k(()=>{const l=Number(m.value)>Number(y.value);return!$.value&&!_.value||!m.value||m.value<=0||!$.value&&S.value||!_.value&&K.value?Z("button.enterAmount"):l?"Invalid Amount":D.value?Z("button.insufficientLiquidity"):L.value?Z("button.enterAmount"):Z("button.remove")}),eo=k(()=>{const l=Number(m.value)>Number(y.value);return!!(!$.value&&!_.value||Number($.value)<=0&&S.value||Number(_.value)<=0&&K.value||!m.value||m.value<=0||l||D.value||ae.value!=="STATUS_RUNNING"||L.value)}),mo=l=>(l==null?void 0:l.logoURI)||(l==null?void 0:l.logo_url)||uo("/image/coins/sui-unknown.png"),go=l=>{$.value="",_.value="",p.value=!0,ee.value="",l=="only-a"?(S.value=!S.value,K.value=!1,I.value=!0):(K.value=!K.value,S.value=!1,I.value=!1)},C=l=>{p.value=!0,c.value=100,l==="fromCoin"?I.value=!0:I.value=!1},U=l=>{p.value=!0,c.value=50,l==="fromCoin"?I.value=!0:I.value=!1},j=w(),le=async()=>{I.value;const l=t.value.token_a.decimals,O=t.value.token_b.decimals,Q=S.value?H.value:ue.value;console.log(Q,"###receiveAmount");const F=S.value?v.value.address===t.value.token_a.address:i.value.address===t.value.token_a.address;if(S.value||K.value){console.log(Q,"##receiveAmount");let oe=await B.value.preSwap({pool:{address:t.value.address,coinA:t.value.token_a,coinB:t.value.token_b},a2b:F,byAmountIn:!0,amount:Q});console.log(oe,oe.estimatedAmountOut,l,O,"##preSwapRes");const J=new r(oe.estimatedAmountOut);j.value=J.sub(J.mul(Number(N.value)/100)).add(new r(S.value?ue.value:H.value)).toString(),console.log("转换之后数量:",oe.estimatedAmountOut),console.log("转换之后滑点数量:",J.mul(Number(N.value)/100).toNumber()),console.log("原有数量减滑点数量:",J.sub(J.mul(Number(N.value)/100)).toNumber()),console.log("fromCoin原有数量:",ue.value),console.log(j.value,"###onlyTokenBalance.value"),ge({value:c.value/100})}};_e(()=>[S.value,K.value,ue.value,H.value],([l,O])=>{l||O?le():ge({value:c.value/100})},{immediate:!0});const Te=l=>`${l}%`,ae=k(()=>s.value.currentAutoPoolStatus),he=w(),ye=()=>{he.value=window.setInterval(()=>{($.value||_.value)&&!p.value?de():ge({value:c.value/100})},2e4)};return co(()=>{ye()}),po(()=>{window.clearInterval(he.value)}),{removeLiquidityBtnText:to,removeLiquidityBtnDisabled:eo,wallet:n,ratioArr:u,positionInfo:t,isShowRemoveModal:b,needReverse:q,fromCoin:i,toCoin:v,lpAmount:m,lpBalance:y,sliderVal:c,sFixD:T,isSlider:p,fromCoinAmount:$,toCoinAmount:_,setPercent:ge,toRemove:Se,addCommom:R,getCoinIcon:mo,isOnlyA:S,isOnlyB:K,onlyToken:go,fixedFromCoin:I,maxBtnSelect:C,halfBtnSelect:U,fromCoinBlance:ue,toCoinBlance:H,showFromCoinLock:V,showToCoinLock:Y,removeText:ee,onlyTokenBalance:j,totalWithdraw:qe,formatter:Te,currentAutoPoolStatus:ae}}});const vo=e=>(We("data-v-6416e2a8"),e=e(),je(),e),Li={class:"auto-pool-add"},Ui={class:"auto-pool-add-content"},Vi={class:"liquidity-action-tab"},Ei=vo(()=>o("div",{class:"remove tab-active"},"Remove",-1)),Wi={key:0,class:"only-token"},ji=vo(()=>o("div",null,"Deposit Amounts",-1)),Xi={key:0},Gi={key:0},Hi={key:0,class:"card-item"},Yi={key:1,class:"card-item"},zi={class:"remove-ratio"},Ji={class:"remove-ratio-select"},Ki={key:0,class:"ratio"},Zi={key:1,class:"ratio"},Qi={class:"ratio-list"},xi=["onClick"],el=vo(()=>o("span",null,"Pool Closed",-1)),ol={key:4,class:"remove-info"},nl={key:0,class:"remove-text total-amount"},tl={class:"total-amount"},sl=vo(()=>o("span",null,"Total Withdraw",-1)),il={class:"total-amount"},ll=vo(()=>o("span",null,"LP Burn Amount",-1)),al={key:0},ul={key:1};function rl(e,n,X,W,N,P){var q,i,v,b,m,y,p,B,D,L,x,$,_,G,V,Y,M;const u=jo,c=Xo,g=Lo,h=no("AutoPoolV2PoolStatus"),s=Ao,t=Ho;return a(),f("div",Li,[o("div",Ui,[o("div",Vi,[o("div",{class:"increase",onClick:n[0]||(n[0]=Uo(I=>e.$emit("changeCurrentTab"),["stop"]))},"Add"),Ei]),!e.showFromCoinLock&&!e.showToCoinLock?(a(),f("div",Wi,[ji,o("div",null,[o("div",{class:"only-a",onClick:n[1]||(n[1]=I=>e.onlyToken("only-a"))},[o("p",null,[e.isOnlyA?(a(),f("span",Xi)):E("",!0)]),o("span",null,d(e.needReverse?(b=(v=e.positionInfo)==null?void 0:v.token_b)==null?void 0:b.symbol:(i=(q=e.positionInfo)==null?void 0:q.token_a)==null?void 0:i.symbol)+" only",1)]),o("div",{class:"only-b",onClick:n[2]||(n[2]=I=>e.onlyToken("only-b"))},[o("p",null,[e.isOnlyB?(a(),f("span",Gi)):E("",!0)]),o("span",null,d(e.needReverse?(B=(p=e.positionInfo)==null?void 0:p.token_a)==null?void 0:B.symbol:(y=(m=e.positionInfo)==null?void 0:m.token_b)==null?void 0:y.symbol)+" only",1)])])])):E("",!0),o("div",{class:De(e.needReverse?"card-container reverse":"card-container")},[(e.needReverse?!e.isOnlyA:!e.isOnlyB)?(a(),f("div",Hi,[z(u,{modelValue:e.fromCoinAmount,"onUpdate:modelValue":n[3]||(n[3]=I=>e.fromCoinAmount=I),"input-value":e.fromCoinAmount,"coin-symbol":e.fromCoin?e.fromCoin.symbol:null,"coin-name":e.fromCoin?e.fromCoin.name:null,balance:e.isOnlyA?e.onlyTokenBalance:e.fromCoinBlance,"coin-icon":e.fromCoin?e.fromCoin.logoURI:"",address:e.fromCoin?e.fromCoin.address:"","swap-direct":"From","import-page":"deposit","amount-leabl":"Available","has-arrow":!1,onOnMax:n[4]||(n[4]=I=>e.maxBtnSelect("fromCoin")),onOnHalf:n[5]||(n[5]=I=>e.halfBtnSelect("fromCoin")),onOnInput:n[6]||(n[6]=I=>{e.isSlider=!1,e.fromCoinAmount=I}),onOnFocus:n[7]||(n[7]=()=>{e.isSlider=!1,e.fixedFromCoin=!0})},null,8,["modelValue","input-value","coin-symbol","coin-name","balance","coin-icon","address"]),e.showFromCoinLock?(a(),se(c,{key:0})):E("",!0)])):E("",!0),(e.needReverse?!e.isOnlyB:!e.isOnlyA)?(a(),f("div",Yi,[z(u,{modelValue:e.toCoinAmount,"onUpdate:modelValue":n[8]||(n[8]=I=>e.toCoinAmount=I),"input-value":e.toCoinAmount,"coin-symbol":e.toCoin?e.toCoin.symbol:null,"coin-name":e.toCoin?e.toCoin.name:null,balance:e.isOnlyB?e.onlyTokenBalance:e.toCoinBlance,"swap-direct":"To","coin-icon":e.toCoin?e.toCoin.logoURI:"",address:e.toCoin?e.toCoin.address:"","import-page":"deposit","amount-leabl":"Available","has-arrow":!1,onOnMax:n[9]||(n[9]=I=>e.maxBtnSelect("toCoin")),onOnHalf:n[10]||(n[10]=I=>e.halfBtnSelect("toCoin")),onOnInput:n[11]||(n[11]=I=>{e.isSlider=!1,e.toCoinAmount=I}),onOnFocus:n[12]||(n[12]=()=>{e.isSlider=!1,e.fixedFromCoin=!1})},null,8,["modelValue","input-value","coin-symbol","coin-name","balance","coin-icon","address"]),e.showToCoinLock?(a(),se(c,{key:0})):E("",!0)])):E("",!0)],2),o("div",zi,[o("div",Ji,[Number(e.lpBalance)>=Number(e.lpAmount)?(a(),f("div",Ki,d(e.sliderVal>0&&Number(("sFixD"in e?e.sFixD:A(T))(e.sliderVal,2))<.01?"<0.01":("sFixD"in e?e.sFixD:A(T))(e.sliderVal,2))+"% ",1)):(a(),f("div",Zi,"--")),o("div",Qi,[(a(!0),f(ao,null,Oo(e.ratioArr,(I,ee)=>(a(),f("div",{key:ee,class:De(["ratio-item",e.sliderVal==I.value?"ratio-item-active":""]),onClick:()=>{e.isSlider=!0,e.sliderVal=I.value}},d(I.name),11,xi))),128))])]),z(g,{value:e.sliderVal,"onUpdate:value":n[13]||(n[13]=I=>e.sliderVal=I),"tip-formatter":e.formatter,onChange:n[14]||(n[14]=I=>e.isSlider=!0)},null,8,["value","tip-formatter"])])]),e.currentAutoPoolStatus=="STATUS_REBALANCING"?(a(),se(h,{key:0})):E("",!0),(D=e.positionInfo)!=null&&D.is_pause?(a(),se(s,{key:1,class:"big-btn liquidity-btn",disabled:!0},{default:ke(()=>[el]),_:1})):e.wallet.connected?(a(),se(s,{key:2,class:"big-btn liquidity-btn",disabled:e.removeLiquidityBtnDisabled,onClick:n[15]||(n[15]=I=>e.toRemove())},{default:ke(()=>[o("span",null,d(e.removeLiquidityBtnText),1)]),_:1},8,["disabled"])):(a(),se(s,{key:3,class:"big-btn liquidity-btn",onClick:n[16]||(n[16]=I=>e.wallet.setIsShowWalletModal(!0))},{default:ke(()=>[o("span",null,d(e.$t("button.connectWallet")),1)]),_:1})),e.removeLiquidityBtnDisabled?E("",!0):(a(),f("div",ol,[e.removeText&&(e.isOnlyA&&Number(e.fromCoinAmount)>0||e.isOnlyB&&Number(e.toCoinAmount)>0)?(a(),f("div",nl,d(e.removeText),1)):E("",!0),o("div",tl,[sl,o("span",null,d(e.totalWithdraw),1)]),o("div",il,[ll,e.fromCoinAmount||e.toCoinAmount?(a(),f("span",al,d(("addCommom"in e?e.addCommom:A(R))(e.lpAmount))+" "+d(e.needReverse?(L=e.toCoin)==null?void 0:L.symbol:(x=e.fromCoin)==null?void 0:x.symbol)+"-"+d(e.needReverse?($=e.fromCoin)==null?void 0:$.symbol:(_=e.toCoin)==null?void 0:_.symbol),1)):(a(),f("span",ul,"0 "+d(e.needReverse?(G=e.toCoin)==null?void 0:G.symbol:(V=e.fromCoin)==null?void 0:V.symbol)+"-"+d(e.needReverse?(Y=e.fromCoin)==null?void 0:Y.symbol:(M=e.toCoin)==null?void 0:M.symbol),1))])])),e.isShowRemoveModal?(a(),se(t,{key:5,"pool-info":e.positionInfo,"from-coin":e.positionInfo.token_a,"to-coin":e.positionInfo.token_b,onOnClose:n[17]||(n[17]=I=>e.isShowRemoveModal=!1)},null,8,["pool-info","from-coin","to-coin"])):E("",!0)])}const dl=Ue(Oi,[["render",rl],["__scopeId","data-v-6416e2a8"]]),vl=Ee({components:{AutoPoolV2Info:zo,AutoPoolV2PositionRange:Jo,AutoPoolV2PoolComposition:Zo,AutoPoolV2PoolLiquidity:Qo,AutoPoolV2PoolAdd:Mi,AutoPoolV2PoolRemove:dl},setup(){const e=He();xe();const n=yo(),X=k(()=>n),W=()=>{e.getAutoPoolAPY(),e.getVault(P.params.id)},N=w(),P=Qe();_e(()=>P.query.action,g=>{g&&(N.value=g)},{immediate:!0});const u=w(),c=()=>{u.value=window.setInterval(()=>{e.getVault(P.params.id)},6e4)};return co(()=>{console.log(P,"route##"),c()}),po(()=>{window.clearInterval(u.value)}),k(()=>X.value.chainName),Po(),{clickRefresh:W,currentTab:N}}});const ml={class:"auto-pool-detail-v2"},cl={class:"detail-top"},pl={class:"detail-bottom pc-detail"},fl={class:"detail-bottom-left"},yl={class:"detail-bottom-right"},bl={class:"h5-detail"};function gl(e,n,X,W,N,P){const u=Dn,c=zo,g=Jo,h=Zo,s=Qo,t=no("AutoPoolV2PoolAdd"),q=no("AutoPoolV2PoolRemove");return a(),f("div",ml,[o("div",cl,[z(u,{onClickRefresh:e.clickRefresh},null,8,["onClickRefresh"]),z(c)]),o("div",pl,[o("div",fl,[z(g),z(h),z(s)]),o("div",yl,[e.currentTab=="add"?(a(),se(t,{key:0,onChangeCurrentTab:n[0]||(n[0]=i=>e.currentTab="remove")})):(a(),se(q,{key:1,onChangeCurrentTab:n[1]||(n[1]=i=>e.currentTab="add")}))])]),o("div",bl,[e.currentTab=="add"?(a(),se(t,{key:0,onChangeCurrentTab:n[2]||(n[2]=i=>e.currentTab="remove")})):(a(),se(q,{key:1,onChangeCurrentTab:n[3]||(n[3]=i=>e.currentTab="add")})),z(g),z(h),z(s)])])}const Xl=Ue(vl,[["render",gl],["__scopeId","data-v-963ccb88"]]);export{Xl as default};
