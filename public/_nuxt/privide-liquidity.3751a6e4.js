import{a as st,b as Gt,n as ft,d as Te,u as kt,e as Xe,c as Le,i as Nt,s as gt,T as yt,p as _t,f as je,g as Ct}from"./pool.73654337.js";import{a as tt,r as X,m as M,y as Kt,D as Ie,e as ot,o as h,f as O,c as Ze,x as oe,h as r,t as pt,G as xt,H as bt,v as be,u as Pe,F as ut,J as wt,p as At,k as Lt,s as It,z as Je,l as qt,E as Mt,C as $t,q as Jt,i as He,b as Qt,j as Pt,w as Yt,I as Vt,B as eo}from"./entry.529755dd.js";/* empty css              */import{s as nt,m as to,l as oo,b as io,a as no}from"./transform.c672907f.js";import{D as l}from"./decimal.0e8aa3f1.js";import{u as ct,a as ro}from"./sha256.743615b9.js";import"./decimal.633e31ee.js";import{c as Rt,_ as Bt,b as Ft,a as Ot}from"./new-liquidity-title.07782b03.js";import{i as at}from"./import-icon.de3e6c66.js";import{tickList as et,direction as qe,minPrice as Z,maxPrice as z,fromCoin as k,toCoin as w,positionError as rt,currentPrice as lt,currentPriceReverse as ht,currentPriceTab as Q,defaultMinPrice as mt,defaultMaxPrice as vt,priceConfigObj as xe,fromCoinAmount as C,toCoinAmount as N,fixedFromCoin as Ce,toggle as ao,resetTickList as Tt,resetData as lo}from"./data.ba0b4072.js";import{_ as so,a as uo,b as co}from"./icon-Add-Liquidity_2x.09e3193d.js";import{_ as mo}from"./coin-select.ce8b8c18.js";import{_ as vo}from"./viewDetail.67748296.js";import{_ as fo}from"./token-warning-modal.3c86f0e5.js";import{c as go}from"./new-add-or-create.30bf4f08.js";/* empty css              */import{u as po}from"./notifi.23ae4b8b.js";/* empty css              */import"./tick.505fdad3.js";import"./token-warning.e27aec4d.js";import"./refresh-icon.586493e0.js";/* empty css              *//* empty css              */import"./swap-setting.2d0b9201.js";/* empty css              */import"./img-no-Positions_2x.7bd42ba7.js";import"./status-block.93b6bfa4.js";import"./icon-arrow_2x.948aedb2.js";import"./icon-arrow_2x.4ffddb8e.js";import"./icon-selected_3x.09e9a6f0.js";import"./useWhale.6db30493.js";import"./index.9322a2fe.js";function St(e,a,fe){const E=new l(10).pow(a-fe);return new l(1.0001).pow(e).mul(E)}const bo=tt({props:{poolInfo:{type:Object,default:()=>({chartLoading:!1,token_a:{decimal:6},token_b:{decimal:6},currentLiquity:"50000000"})},minPrice:{type:String,default:""},maxPrice:{type:String,default:""},direction:{type:Boolean,default:!0},tickList:{type:Array,default:()=>[]},currentTick:{type:Number,default:0},chartLoading:{type:Boolean,default:!1},currentPriceTab:{type:String,default:""},before7dContractPriceLowest:{type:String,default:""},before7dContractPriceHighest:{type:String,default:""},zoom:{type:Number,default:1}},setup(e,a){const fe=X(""),E=X(""),U=M(()=>{var n,f,s,q,B,p;return console.log(e.poolInfo,"===>props.poolInfo"),(n=e.poolInfo)!=null&&n.current_sqrt_price&&((f=e.poolInfo)!=null&&f.coinA.decimals)&&((s=e.poolInfo)!=null&&s.coinB.decimals)?i.sqrtPriceX64ToPrice((q=e.poolInfo)==null?void 0:q.current_sqrt_price,(B=e.poolInfo)==null?void 0:B.coinA.decimals,(p=e.poolInfo)==null?void 0:p.coinB.decimals).toString():"0"}),ye=M(()=>{let n=0;return e.direction?n=(Number(e.minPrice)/Number(U.value)-1)*100:n=(Number(e.minPrice)/Number(1/Number(U.value))-1)*100,n=n>0&&n<.1?.1:n,n=n<0&&n>-.1?-.1:n,n}),H=M(()=>{let n=0;return e.direction?n=(Number(e.maxPrice)/Number(U.value)-1)*100:n=(Number(e.maxPrice)/Number(1/Number(U.value))-1)*100,n=n>0&&n<.1?.1:n,n=n<0&&n>-.1?-.1:n,n}),W=ct(),A=M(()=>W),de=M(()=>A.value.chainName?st(A.value.chainName):{}),{TickMath:i,getNearestTickByTick:y}=de.value,G=(n=[])=>{let f=6;const s=Math.abs(Number(n[0])-Number(n[n.length-1]));return s>=6?f=0:s>=1?f=1:s>=.1?f=2:s>=.01?f=3:s>=.001?f=4:s>=1e-4?f=5:s>=1e-5?f=6:s>=1e-6?f=7:s>=1e-7&&(f=8),f},Y=(n,f=1)=>{if(n&&n.token_a&&!e.chartLoading&&e.minPrice&&e.maxPrice){const s=Number(e.poolInfo.current_tick_index);console.log("0117###dataProcessing###currentTick###",s),console.log("0117###dataProcessing###props.poolInfo###",e.poolInfo),console.log("0117###dataProcessing###minPrice###",e.minPrice),console.log("0117###dataProcessing###maxPrice###",e.maxPrice),console.log("0117###dataProcessing###poolInfo###",e.poolInfo);let q=s+100*f,B=s-100*f,p,V;if(e.maxPrice==="∞")V=de.value.TickUtil.getMaxIndex(Number(e.poolInfo.tickSpacing));else try{e.direction?V=i.priceToTickIndex(new l(e.maxPrice),e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals):V=i.priceToTickIndex(new l(1).div(e.minPrice),e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals)}catch{V=443636}if(e.minPrice==="0")p=de.value.TickUtil.getMinIndex(Number(e.poolInfo.tickSpacing));else try{e.direction?p=i.priceToTickIndex(new l(e.minPrice),e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals):p=i.priceToTickIndex(new l(1).div(e.maxPrice),e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals)}catch{p=-443636}let ne=0;if(e.currentPriceTab!=="full range"){if(s>=p&&s<=V){const _=s-p,re=V-s;ne=Math.max(Math.abs(_),Math.abs(re))}else s<p?ne=Math.abs(V-s):ne=Math.abs(s-p);q=s+ne+100*f,B=s-ne-100*f}else{const _=(Math.abs(s)>5e3,2e4);q=s+_*f,B=s-_*f}B<-443636&&(B=-443636),q>443636&&(q=443636);const m=new l(n.liquidity).div(Math.pow(10,8)).toString(),$=e.tickList;console.log("0117####drawChart####tick_info_array####",$);const L=[],P=[];let T={};for(let _=0;_<$.length;_++){if(T=$[_],T.index<=s&&T.index>=B){if(L.length<1&&_!==0){const re=$[_-1];L.unshift({...re,index:B})}L.unshift(T)}else if(T.index>s&&T.index<=q&&(P.push(T),L.length<1&&_!==0)){const re=$[_-1];L.push({...re,index:B})}if(T.index>q){const re=$[_];if(P.push({...re,index:q}),L.length<1&&_!==0){const Ke=$[_-1];L.push({...Ke,index:B})}break}}let K="0";for(let _=L.length-1;_>=0;_--)K=new l(K).plus(new l(L[_].liquidityNet.toString()).div(Math.pow(10,8))).toString(),L[_].liquityAmount=K;let b=m;for(let _=0;_<P.length;_++)b=new l(b).plus(new l(P[_].liquidityNet.toString()).div(Math.pow(10,8))).toString(),P[_].liquityAmount=b;let ee=[];const F=$&&$.length>0?{index:s,liquityAmount:Number(m)}:{index:s,liquityAmount:0};(L.length>0||P.length>0)&&(ee=[...L.reverse(),F,...P],e.direction||(ee=ee.reverse()));const Se=[];$.forEach(_=>{Se.push({..._,liquidityGross:_.liquidityGross.toString(),liquidityNet:_.liquidityNet.toString()})}),console.log("0117####drawChart####testTickInfoArray####",Se),console.log("0117####drawChart####currentLiquity####",m),j(ee,B,q,p,V,s)}};let I=X(!1);Kt(()=>{document.body.clientWidth<750?I.value=!1:I.value=!0,window.onresize=()=>{document.body.clientWidth<750?I.value=!1:I.value=!0,Y(e.poolInfo,e.zoom)}});const j=(n,f,s,q,B,p)=>{console.log("0117####drawChart####chartData####",n),console.log("0117####drawChart####tickMin####",f),console.log("0117####drawChart####tickMax####",s),console.log("0117####drawChart####minPriceTick####",q),console.log("0117####drawChart####maxPriceTick####",B),console.log("0117####drawChart####currentTick####",p),console.log("0117####drawChart####props.direction####",e.direction),console.log("0518###newd3###props.before7dContractPriceLowest###",e.before7dContractPriceLowest),console.log("0518###newd3###props.before7dContractPriceHighest###",e.before7dContractPriceHighest);let V,ne;e.direction?(V=e.before7dContractPriceLowest?i.priceToTickIndex(new l(e.before7dContractPriceLowest),e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals):"",ne=e.before7dContractPriceHighest?i.priceToTickIndex(new l(e.before7dContractPriceHighest),e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals):""):(V=e.before7dContractPriceLowest?i.priceToTickIndex(new l(1).div(e.before7dContractPriceLowest),e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals):"",ne=e.before7dContractPriceHighest?i.priceToTickIndex(new l(1).div(e.before7dContractPriceHighest),e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals):"");const m={top:30,right:35,bottom:20,left:55};let $,L;I.value?($=480-m.left-m.right,L=208-m.top-m.bottom):($=340-m.left-m.right,L=205-m.top-m.bottom);const P=s-f,T=parseInt(String(P/4));let K=[f+T/4,f+T,f+2*T,s-T,s-T/4];const b=f,ee=s,F=$/(ee-b);e.currentPriceTab==="full range"&&(K=[f,f+2*T,s]),console.log("0117####drawChart####xArr####",K),console.log("0117####drawChart####utickMin####",b),console.log("0117####drawChart####utickMax####",ee),console.log("0117####drawChart####unit####",F);const Se=K.map(u=>e.direction?St(u,e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals).toString():new l(1).div(St(u,e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals)).toString()),_=G(Se);nt("#chart").selectAll("*").remove();const re=nt("#chart").attr("width",$+m.left+m.right).attr("height",L+m.top+m.bottom).append("g").attr("transform",`translate(${m.left},${m.right})`),Ke=to(n,function(u){return Number(Math.abs(u.liquityAmount))})||0,t=oo().range([0,L]).domain([Ke,0]);io().rangeRound([0,$]).padding(.1);const R=re.append("g").attr("id","barsBox").selectAll("rect").data(n).enter().append("rect");A.value.theme=="default"?R.attr("x",function(u,c){return c===0?0:e.direction?Math.abs(u.index-b)*F:Math.abs(ee-u.index)*F}).attr("y",function(u,c){return e.direction?c===n.length-1?0:t(u.liquityAmount):c===n.length-1?0:t(n[c+1].liquityAmount)}).attr("width",function(u,c){return c===0&&n.length===1&&u.liquityAmount>0?$:(e.direction,c!==n.length-1?Math.abs(n[c+1].index-u.index)*F:0)}).attr("height",function(u,c){return c===0&&n.length===1&&u.liquityAmount>0?L:e.direction?c===n.length-1?0:L-t(u.liquityAmount):c===n.length-1?0:L-t(n[c+1].liquityAmount)}).attr("fill","#279477").attr("class","bars").attr("stroke-width",1).attr("stroke","#279477"):R.attr("x",function(u,c){return c===0?0:e.direction?Math.abs(u.index-b)*F:Math.abs(ee-u.index)*F}).attr("y",function(u,c){return e.direction?c===n.length-1?0:t(Math.abs(u.liquityAmount)):c===n.length-1?0:t(Math.abs(n[c+1].liquityAmount))}).attr("width",function(u,c){return c===0&&n.length===1&&u.liquityAmount>0?$:(e.direction,c!==n.length-1?Math.abs(n[c+1].index-u.index)*F:0)}).attr("height",function(u,c){if(c===0&&n.length===1&&u.liquityAmount>0)return L;if(e.direction)return c===n.length-1?0:Number(u.liquityAmount)?L-t(Math.abs(u.liquityAmount)):0;{if(c===n.length-1)return 0;const Be=L-t(Math.abs(n[c+1].liquityAmount));return Number(n[c+1].liquityAmount)?Be:0}}).attr("fill","#407497").attr("class","bars").attr("stroke-width",1).attr("stroke","#407497");const D=re.append("g");D.append("line").attr("x1",0).attr("y1",155).attr("x2",$).attr("y2",155).attr("stroke-width",1).attr("stroke","#50535D");const he=D.append("g");let ae=0;if(e.direction){for(let u=0;u<K.length;u++){const c=Te(Se[u],_)||"0";console.log("0423####price####",c),Se.push(c);const Be=Math.abs(K[u]-b)*F;let ge=0;for(let pe=0;pe<c.length;pe++)c[pe]==="1"?ge+=4.02:c[pe]==="."?ge+=2.64:c[pe]==="7"?ge+=5.48:ge+=6;console.log(Be,"x=>>>"),he.append("text").text(c).attr("x",Be-ge/2).attr("y",168).attr("fill","rgba(255, 255, 255, 0.5").style("font-size","10")}ae=Math.abs(p-b)*F}else{for(let u=K.length-1;u>=0;u--){const c=Te(Se[u],_)||0;Se.push(c);const Be=Math.abs(K[u]-ee)*F;let ge=0;for(let pe=0;pe<c.length;pe++)c[pe]==="1"?ge+=4.02:c[pe]==="."?ge+=2.64:c[pe]==="7"?ge+=5.48:ge+=6;he.append("text").text(c).attr("x",Be-ge/2).attr("y",168).attr("fill","rgba(255, 255, 255, 0.5").style("font-size","10")}ae=Math.abs(p-ee)*F}(A.value.theme=="default"?re.append("line").attr("x1",0).attr("y1",0).attr("x2",0).attr("y2",155).attr("stroke-width",2).attr("stroke","#68FFD8"):re.append("line").attr("x1",0).attr("y1",0).attr("x2",0).attr("y2",155).attr("stroke-width",2).attr("stroke","#76C8FF")).attr("transform","translate("+ae+", 0)");let Me,$e,De,ze;e.direction?(console.log("0525###d3###select###minPriceTick###",q),console.log("0525###d3###select###maxPriceTick###",B),console.log("0525###d3###select###props.minPrice###",e.minPrice),console.log("0525###d3###select###props.maxPrice###",e.maxPrice),Me=q<b?-100:parseInt(String(Math.abs(q-b)*F)),$e=B<b?-100:parseInt(String(Math.abs(B-b)*F)),De=V<b?-100:Math.abs(V-b)*F,ze=ne<b?-100:Math.abs(ne-b)*F):($e=q<b?-100:Math.abs(ee-q)*F,Me=B<b?-100:Math.abs(ee-B)*F,ze=V<b?-100:Math.abs(ee-V)*F,De=ne<b?-100:Math.abs(ee-ne)*F),e.minPrice==="0"&&(Me=0),e.maxPrice==="∞"&&($e=$),I.value?fe.value=$-Me+60+"px":fe.value=$-Me+52+"px",E.value=$e+74+"px",V&&De<$&&re.append("line").attr("x1",0).attr("y1",0).attr("x2",0).attr("y2",155).attr("stroke-width",1).attr("stroke-dasharray","5, 5").attr("stroke","rgba(255, 255, 255, 0.5)").attr("transform","translate("+De+", 0)"),ne&&ze<$&&re.append("line").attr("x1",0).attr("y1",0).attr("x2",0).attr("y2",155).attr("stroke-width",1).attr("stroke-dasharray","5, 5").attr("stroke","rgba(255, 255, 255, 0.5)").attr("transform","translate("+ze+", 0)");const Ne=re.append("g").attr("id","left-handle"),Re=re.append("g").attr("id","right-handle");A.value.theme=="default"?(Ne.append("line").attr("x1",0).attr("y1",0).attr("x2",0).attr("y2",155).attr("stroke-dasharray","5, 5").attr("stroke-width",2).attr("stroke","#68FFD8"),Ne.append("path").attr("d","M0 0 L12 0 L12 20 L0 20 Z").attr("fill","#333").attr("stroke","#333").attr("transform","translate(-1, 20) rotate(180)"),Ne.append("rect").attr("width",1).attr("height",7).attr("x",-9).attr("y",6).attr("fill","#68FFD8"),Ne.append("rect").attr("width",1).attr("height",10).attr("x",-7).attr("y",4.5).attr("fill","#68FFD8"),Re.append("line").attr("x1",0).attr("y1",0).attr("x2",0).attr("y2",155).attr("stroke-dasharray","5, 5").attr("stroke-width",2).attr("stroke","#68FFD8"),Re.append("path").attr("d","M0 0 L12 0 L12 20 L0 20 Z").attr("fill","#333").attr("stroke","#333").attr("transform","translate(1, 0)"),Re.append("rect").attr("width",1).attr("height",7).attr("x",7).attr("y",6).attr("fill","#68FFD8"),Re.append("rect").attr("width",1).attr("height",10).attr("x",5).attr("y",4.5).attr("fill","#68FFD8")):(Ne.append("line").attr("x1",0).attr("y1",0).attr("x2",0).attr("y2",155).attr("stroke-dasharray","5, 5").attr("stroke-width",2).attr("stroke","#76C8FF"),Ne.append("path").attr("d","M0 0 L12 0 L12 24 L0 24 Z").attr("fill","#333").attr("stroke","#333").attr("transform","translate(-1, 24) rotate(180)"),Ne.append("rect").attr("width",1).attr("height",7).attr("x",-9).attr("y",8).attr("fill","#76C8FF"),Ne.append("rect").attr("width",1).attr("height",10).attr("x",-7).attr("y",6.5).attr("fill","#76C8FF"),Re.append("line").attr("x1",0).attr("y1",0).attr("x2",0).attr("y2",155).attr("stroke-dasharray","5, 5").attr("stroke-width",2).attr("stroke","#76C8FF"),Re.append("path").attr("d","M0 0 L12 0 L12 24 L0 24 Z").attr("fill","#333").attr("stroke","#333").attr("transform","translate(1, 0)"),Re.append("rect").attr("width",1).attr("height",7).attr("x",7).attr("y",8).attr("fill","#76C8FF"),Re.append("rect").attr("width",1).attr("height",10).attr("x",5).attr("y",6.5).attr("fill","#76C8FF")),console.log("0525###d3###select###minPriceTickX###",Me),console.log("0525###d3###select###maxPriceTickX###",$e),Ne.attr("transform","translate("+Me+", 0)"),Re.attr("transform","translate("+$e+", 0)");const Qe=no().extent([[0,0],[$,L]]).handleSize(30).on("end",it);re.append("g").attr("class","brush").call(Qe).call(Qe.move,[Me,$e]);function it(u){if(!u.sourceEvent||!u.selection)return;Ne.attr("transform","translate("+u.selection[0]+", 0)"),Re.attr("transform","translate("+u.selection[1]+", 0)"),I.value?fe.value=$-u.selection[0]+60+"px":fe.value=$-u.selection[0]+52+"px",E.value=u.selection[1]+74+"px";let c,Be;console.log("0525###d3###select###e.selection[0]###",u.selection[0]),console.log("0525###d3###select###e.selection[0]###",u.selection[1]),console.log("0525###d3###select###props.direction###",e.direction),console.log("0525###d3###select###width###",$),console.log("0525###d3###select###unit###",F),console.log("0525###d3###select###utickMin###",b),console.log("0525###d3###select###utickMax###",ee),console.log("0525###d3###select###props.poolInfo###",e.poolInfo);let ge=0,pe=0;e.direction?(ge=y(parseInt(String(u.selection[0]/F+b)),Number(e.poolInfo.tickSpacing)),c=i.tickIndexToPrice(ge,e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals).toString(),pe=y(parseInt(String(u.selection[1]/F+b)),Number(e.poolInfo.tickSpacing)),Be=i.tickIndexToPrice(pe,e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals).toString(),console.log("0525###d3###select###minTick###",ge),console.log("0525###d3###select###maxTick###",pe),console.log("0525###d3###select###minPrice###",c),console.log("0525###d3###select###maxPrice###",Be)):(pe=y(ee-u.selection[0]/F,Number(e.poolInfo.tickSpacing)),c=1/i.tickIndexToPrice(pe,e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals).toString(),ge=y(ee-u.selection[1]/F,Number(e.poolInfo.tickSpacing)),Be=1/i.tickIndexToPrice(ge,e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals).toString()),a.emit("onChangeMinPrice",String(Te(String(c),6))),a.emit("onChangeMaxPrice",String(Te(String(Be),6)))}A.value.theme=="default"?nt(".selection").attr("stroke","rgba(255, 255, 255, 0)").attr("fill","#15322C"):nt(".selection").attr("stroke","rgba(255, 255, 255, 0)").attr("fill","#152632")};X(""),Ie(()=>[e.poolInfo,e.minPrice,e.maxPrice,e.currentPriceTab,e.zoom],([n,f,s,q,B])=>{console.log(n,f,s,s>f,"poolInfo && minPrice && maxPrice && (maxPrice > minPrice)"),n&&f&&s&&(n!=null&&n.liquidity)&&(q!=="Custom"||console.log("绘制"),Y(n,B))},{immediate:!0});const d=X(!1);return Ie(()=>e.chartLoading,(n,f)=>{n!==f&&(d.value=n)},{immediate:!0,deep:!0}),console.log(e,"props===>"),{store:A,loading:d,rangeSizeLower:ye,rangeSizeUpper:H,rangeSizeLowerPosition:fe,rangeSizeUpperPosition:E,decimalFormat:Gt,numberformat:ft}}});const ho=e=>(At("data-v-16ab6352"),e=e(),Lt(),e),ko={class:"chart-box"},wo={class:"chart"},yo=ho(()=>r("svg",{id:"chart"},null,-1));function _o(e,a,fe,E,U,ye){const H=wt;return h(),O(ut,null,[e.tickList&&e.tickList.length>0&&e.loading?(h(),Ze(H,{key:0})):oe("",!0),r("div",ko,[pt(r("div",wo,[e.currentPriceTab!=="full range"?(h(),O("div",{key:0,class:"range-size range-size-lower",style:bt({right:e.rangeSizeLowerPosition})},be(("numberformat"in e?e.numberformat:Pe(ft))(e.rangeSizeLower.toFixed(1),1))+"% ",5)):oe("",!0),e.currentPriceTab!=="full range"?(h(),O("div",{key:1,class:"range-size range-size-upper",style:bt({left:e.rangeSizeUpperPosition})},be(("numberformat"in e?e.numberformat:Pe(ft))(e.rangeSizeUpper.toFixed(1),1))+"% ",5)):oe("",!0),yo],512),[[xt,!e.loading]])])],64)}const Ut=ot(bo,[["render",_o],["__scopeId","data-v-16ab6352"]]),Co=tt({props:{aprRewardsParameter:{type:Number,default:30},minPrice:{type:String,default:""},maxPrice:{type:String,default:""},fromCoin:{type:Object,default:()=>({})},toCoin:{type:Object,default:()=>({})},poolInfo:{type:Object,default:()=>({})},nameTab:{type:String,default:""}},setup(e){const a=[{label:"24H",value:24},{label:"7D",value:7},{label:"30D",value:30}],fe=ct(),E=M(()=>fe);M(()=>E.value.chainName);const U=kt(),ye=M(()=>U),H=M(()=>E.value.chainName?st(E.value.chainName):{}),W=X(),A=async i=>{var B,p,V;console.log("0607###detail###getAprMethod###poolInfo###",i),console.log("0607###detail###getAprMethod###props.fromCoin###",e.fromCoin),console.log("0607###detail###getAprMethod###props.toCoin###",e.toCoin),console.log("0607###detail###getAprMethod###props.nameTab###",e.nameTab);let y;i.token_a.address.toLowerCase()===e.fromCoin.address.toLowerCase()&&i.token_b.address.toLowerCase()===e.toCoin.address.toLowerCase()?y=!0:y=!1,console.log("0607###detail###getAprMethod###directs###",y),console.log("0607###detail###getAprMethod###props.minPrice###",e.minPrice),console.log("0607###detail###getAprMethod###props.maxPrice###",e.maxPrice);let G,Y;y?(G=Number(e.minPrice),Y=Number(e.maxPrice)):e.maxPrice!=="∞"?(G=1/Number(e.maxPrice),Y=1/Number(e.minPrice)):(G=1/2**50,Y=2**50),console.log("0607###detail###getAprMethod###lowerUserPrice###",G),console.log("0607###detail###getAprMethod###upperUserPrice###",Y);let I=[];I=E.value&&E.value.addressHistTokens&&E.value.addressHistTokens[i.poolAddress]&&E.value.addressHistTokens[i.poolAddress].data&&E.value.addressHistTokens[i.poolAddress].data.length>0&&Object.fromEntries(E.value.addressHistTokens[i.poolAddress].data.map(ne=>[ne.key,ne.value]));let j,d;console.log(I,"===>addressHistTokensList"),e.aprRewardsParameter==7?(j=Number(I==null?void 0:I.before_7_d_contract_price_lowest),d=Number(I==null?void 0:I.before_7_d_contract_price_highest)):e.aprRewardsParameter==24?(j=Number(I==null?void 0:I.before_24_h_contract_price_lowest),d=Number(I==null?void 0:I.before_24_h_contract_price_highest)):(j=Number(I==null?void 0:I.before_30_d_contract_price_lowest),d=Number(I==null?void 0:I.before_30_d_contract_price_highest));const n=ye.value.tokensObj;console.log("getEstPositionAPRWithMulti###params###lowerUserPrice###",G),console.log("getEstPositionAPRWithMulti###params###upperUserPrice###",Y),console.log("getEstPositionAPRWithMulti###params###lowerHistPrice###",j),console.log("getEstPositionAPRWithMulti###params###upperHistPrice###",d);const f=await H.value.getEstPositionAPRWithMulti(G,Y,j,d);console.log("getEstPositionAPRWithMulti###resMulti###",f.toString());const s=E.value.newTopPoolsObj[i.poolAddress];let q;if(s){e.aprRewardsParameter==7?q=Number(s.apr_7day.replace("%","")):e.aprRewardsParameter==24?q=Number(s.apr_24h.replace("%","")):q=Number(s.apr_30day.replace("%",""));const ne=Number(s.rewarder_apr[0].replace("%","")),m=Number(s.rewarder_apr[1].replace("%","")),$=Number(s.rewarder_apr[2].replace("%","")),L=new l(f.toString()).mul(q).toNumber(),P=new l(f.toString()).mul(ne).toNumber(),T=new l(f.toString()).mul(m).toNumber(),K=new l(f.toString()).mul($).toNumber(),b=L+(i.rewarder_display1?P:0)+(i.rewarder_display2?T:0)+(i.rewarder_display3?K:0),ee=i.rewarder_infos[0]?(B=n[i.rewarder_infos[0].coinAddress])==null?void 0:B.symbol:"--",F=i.rewarder_infos[1]?(p=n[i.rewarder_infos[1].coinAddress])==null?void 0:p.symbol:"--",Se=i.rewarder_infos[2]?(V=n[i.rewarder_infos[2].coinAddress])==null?void 0:V.symbol:"--",_={aprFee:L==1/0||isNaN(L)?0:L,rewardAprList:[{rewarder_name:ee,rewarder_apr:P==1/0||isNaN(P)?0:P,styleName:"one",rewarder_display:i.rewarder_display1},{rewarder_name:F,rewarder_apr:T==1/0||isNaN(T)?0:T,styleName:"two",rewarder_display:i.rewarder_display2},{rewarder_name:Se,rewarder_apr:K==1/0||isNaN(K)?0:K,styleName:"three",rewarder_display:i.rewarder_display2}],aprPercentageTotal:b==1/0||isNaN(b)||b===0?0:b,aprPercentage:Nt(L/b,2),is_display_rewarder:i.is_display_rewarder};W.value=_,console.log(W.value,"===>aprPercentageObj.value")}};Ie(()=>[e.poolInfo,e.minPrice,e.maxPrice,E.value.addressHistTokens],([i,y,G,Y])=>{i&&!Le(i)&&Y&&!Le(Y)&&A(i)},{immediate:!0}),Ie(()=>[e.aprRewardsParameter],()=>{A(e.poolInfo)});const de=M(()=>{const i=W.value;return i&&i.is_display_rewarder?(i==null?void 0:i.aprPercentageTotal)>1e4?">10000":i.aprPercentageTotal<.01&&i.aprPercentageTotal>0?"<0.01":Xe(i.aprPercentageTotal,2):i&&!i.is_display_rewarder?(i==null?void 0:i.aprFee)>1e4?">10000":i.aprFee<.01&&i.aprFee>0?"<0.01":Xe(i.aprFee,2):"--"});return{timeList:a,aprPercentageObj:W,totalApr:de}}}),Po=""+globalThis.__publicAssetsURL("sui-image/farming.png");const jt=e=>(At("data-v-240a1eb7"),e=e(),Lt(),e),To={class:"est-apr"},So=jt(()=>r("div",{class:"title"},"Estimated APR",-1)),No={class:"apr-total"},Ao=jt(()=>r("img",{src:Po,alt:""},null,-1)),Lo={class:"time-list"},Io=["onClick"];function qo(e,a,fe,E,U,ye){return h(),O("div",To,[So,r("div",No,[r("span",null,be(e.totalApr)+"%",1),Ao]),r("div",Lo,[(h(!0),O(ut,null,It(e.timeList,H=>(h(),O("div",{key:H.value,class:Je(["time-item",H.value==e.aprRewardsParameter?"time-item-active":""]),onClick:W=>e.$emit("changeAprRewardsParameter",H.value)},be(H.label),11,Io))),128))])])}const zt=ot(Co,[["render",qo],["__scopeId","data-v-240a1eb7"]]),Mo=tt({components:{NewLiquidityD3Chart:Ut,NewLiquidityApr:zt,NewLiquidityPrice:Rt},setup(){const{t:e,locale:a}=qt(),fe=X("liquidity"),E=ct(),U=M(()=>E),ye=M(()=>U.value.chainName),H=kt(),W=M(()=>H),A=M(()=>U.value.chainName?st(U.value.chainName):{}),de=Mt(),i=M(()=>{let t=null;for(let g=0;g<W.value.poolConfigList.length;g++){const R=W.value.poolConfigList[g];R.address==de.query.poolAddress&&(t=R)}return console.log(t,"===>basePoolInfo"),t}),y=M(()=>{let t=null;for(const g in W.value.poolsObj){const R=W.value.poolsObj[g];R.address==de.query.poolAddress&&(console.log(R,"p===>"),t=R)}return t}),G=X(),Y=X(!0),I=async(t,g)=>{if(g){Y.value=!0;const R=t.token_a.decimals,D=t.token_b.decimals;console.log(t,"pool===>1111"),lt.value=yt.sqrtPriceX64ToPrice(t==null?void 0:t.current_sqrt_price,R,D).toString(),ht.value=new l(1).div(yt.sqrtPriceX64ToPrice(t==null?void 0:t.current_sqrt_price,R,D)).toString(),k.value=t.needReverse?t.token_b:t.token_a,w.value=t.needReverse?t.token_a:t.token_b,G.value=t.needReverse,t.token_a.address.toLowerCase()===k.value.address.toLowerCase()&&t.token_b.address.toLowerCase()===w.value.address.toLowerCase()?qe.value=!0:qe.value=!1,console.log(t,"187===>"),console.log(t,"###pool===>");let he={poolAddress:t.address,coinTypeA:t.coin_a_address,coinTypeB:t.coin_b_address};const ae=await A.value.getTicks(he);et.value=ae?A.value.getTickDataFromUrlData(ae):[],console.log(et.value,"===>chartLoadingtickList.value"),n(t)}Y.value=!1,console.log(Y.value,"==>chartLoading.value")},j=X([]),d=X(),n=t=>{const g=t.token_a.decimals,R=t.token_b.decimals;let D=W.value.poolPriceConfigObj&&W.value.poolPriceConfigObj[t.address]&&W.value.poolPriceConfigObj[t.address].recommend_ranges||{};console.log(D,"===>priceConfigList");let he,ae;const ke=t.current_tick_index;d.value=t.current_tick_index,console.log(ke,t.tickSpacing,"==>pool.tickSpacing"),he=ke-Number(t.type=="unstable"?Number(t.tickSpacing)*2:Number(t.tickSpacing)*3),ae=ke+Number(t.type=="unstable"?Number(t.tickSpacing)*2:Number(t.tickSpacing)*3);const Me=A.value.TickMath.tickIndexToPrice(he,g,R).toString(),$e=A.value.TickMath.tickIndexToPrice(ae,g,R).toString();D["full range"]={lower:A.value.TickUtil.getMinIndex(Number(y.value.tickSpacing)),upper:A.value.TickUtil.getMaxIndex(Number(y.value.tickSpacing))},D.custom={lower:he,upper:ae,minPrice:Me,maxPrice:$e};const De=[];for(let ze in D)D[ze]&&(console.log(ze,"j==>"),De.push({...D[ze],key:ze}));console.log(De,"priceList"),t.type?t.isSelfBuilt?Q.value="custom":t.type=="stable"?Q.value="suggested":Q.value="passive":Q.value="custom",j.value=De,xe.value=D,q({key:Q.value,...D[Q.value]})},f=X(""),s=X(""),q=t=>{console.log("priceTab====>",t),console.log("priceTab###poolInfo###",y.value),Q.value=t.key.toLowerCase();const g=y.value.token_a.decimals,R=y.value.token_b.decimals,{lower:D,upper:he}=t,ae=A.value.TickMath.tickIndexToPrice(D,g,R).toString(),ke=A.value.TickMath.tickIndexToPrice(he,g,R).toString();if(t.key=="full range"){f.value=D,s.value=he,B();return}console.log(qe.value,"===>direct.value"),qe.value?(mt.value=String(ae),Z.value=String(ae),vt.value=String(ke),z.value=String(ke),f.value=D,s.value=he):(mt.value=String(1/Number(ke)),Z.value=String(1/Number(ke)),vt.value=String(1/Number(ae)),z.value=String(1/Number(ae)),f.value=A.value.TickMath.priceToTickIndex(new l(1/Number(ke)),g,R),s.value=A.value.TickMath.priceToTickIndex(new l(1/Number(ae)),g,R)),console.log(Z.value,z.value,"===>111")},B=t=>{Z.value="0",z.value="∞"};Ie(()=>y.value,(t,g)=>{console.log(g,"===>oldVal"),console.log(t,"===>newVal"),(!g&&t&&!Le(t)||g&&t&&g.address!==t.address)&&(console.log("池子信息"),I(t,!g||t.address!==g.address))},{immediate:!0}),$t(()=>{et.value=[]}),Ie(()=>[i.value,y.value,W.value.recommendRangesObj],(t,g)=>{var R,D;console.log(t,"===>newValue369"),console.log(g,"===>oldValue369"),(!g||t[0]&&t[1]&&t[2]&&!Le(t[0])&&!Le(t[1]&&!Le(t[2]))||((R=t[0])==null?void 0:R.address)!==((D=g[0])==null?void 0:D.address))&&(console.log("3731111111"),t[0]&&t[2]&&!Le(t[0])&&!Le(t[2])&&(console.log(t[0],t[2],"======>374"),H.setSinglePool(t[0],t[2],ye.value)))},{immediate:!0,deep:!0});const p=t=>{if(ye.value=="Sui")switch(t){case"passive":return"/sui-image/icon_ conservative@2x.png";case"active":return"/sui-image/icon_active@2x.png";case"full range":return"/sui-image/icon_fullrange@2x.png";case"custom":return"/sui-image/icon_costom@2x.png";case"suggested":return"/sui-image/icon_stabel@2x.png"}else switch(t){case"passive":return"/image/icon_ conservative@2x.png";case"active":return"/image/icon_active@2x.png";case"full range":return"/image/icon_fullrange@2x.png";case"custom":return"/image/icon_costom@2x.png";case"suggested":return"/image/icon_stabel@2x.png"}},V=t=>{switch(t){case"suggested":return e("newAdd.suggested");case"active":return e("newAdd.active");case"passive":return e("newAdd.conservative");case"full range":return e("newAdd.fullRange");case"custom":return e("newAdd.custom")}},ne=t=>{var R,D;const g=W.value.poolPriceConfigObj&&W.value.poolPriceConfigObj[(R=y.value)==null?void 0:R.address]&&W.value.poolPriceConfigObj[(D=y.value)==null?void 0:D.address].type||"";if(console.log(g,t,"==>poolType"),g=="unstable")switch(t){case"active":return{top:"35%"};case"passive":return{top:"10%"};case"full range":return{top:"60%"};case"custom":return{top:"85%"}}else switch(t){case"suggested":return{top:"23%"};case"full range":return{top:"48%"};case"custom":return{top:"73%"}}},m=X(1),$=()=>{const t=m.value/2;m.value=t},L=()=>{const t=m.value*2;m.value=t};console.log(j.value,"==>priceTablList");const P=M(()=>{var t,g,R;return!y.value||Le(U.value.addressHistTokens)||!U.value.addressHistTokens[(t=y.value)==null?void 0:t.poolAddress]?null:Object.fromEntries((R=U.value.addressHistTokens[(g=y.value)==null?void 0:g.poolAddress])==null?void 0:R.data.map(D=>[D.key,D.value]))}),T=X(30),K=X("30D"),b=M(()=>qe.value?P.value&&Te(T.value==7?P.value.before_7_d_contract_price_lowest:T.value==24?P.value.before_24_h_contract_price_lowest:P.value.before_30_d_contract_price_lowest,6)||0:P.value&&Te(new l(1).div(T.value==7?P.value.before_7_d_contract_price_highest:T.value==24?P.value.before_24_h_contract_price_highest:P.value.before_30_d_contract_price_highest).toString(),6)||0),ee=M(()=>qe.value?P.value&&Te(T.value==7?P.value.before_7_d_contract_price_highest:T.value==24?P.value.before_24_h_contract_price_highest:P.value.before_30_d_contract_price_highest,6)||0:(P.value&&Te(1/Number(T.value==7?P.value.before_7_d_contract_price_lowest:T.value==24?P.value.before_24_h_contract_price_lowest:P.value.before_30_d_contract_price_lowest),6))==1/0?0:P.value&&Te(1/Number(T.value==7?P.value.before_7_d_contract_price_lowest:T.value==24?P.value.before_24_h_contract_price_lowest:P.value.before_30_d_contract_price_lowest),6)||0),F=M(()=>{const t=Number(Z.value),g=Number(z.value);return Z.value&&z.value&&Z.value!=="0"&&z.value!=="∞"?gt(1/(1-Number((t/g)**.25)),2)+"x":1}),Se=M(()=>{var t,g,R,D,he,ae;return((t=k.value)==null?void 0:t.isSelfBuilt)||((g=w.value)==null?void 0:g.isSelfBuilt)||((D=W.value.tokensObj[(R=k.value)==null?void 0:R.address])==null?void 0:D.isSelfBuilt)||((ae=W.value.tokensObj[(he=w.value)==null?void 0:he.address])==null?void 0:ae.isSelfBuilt)}),_=t=>{console.log(t,"####0731 priceRangeChangeMin"),t!==Z.value&&Q.value=="full range"?(console.log(j.value,"===>priceTablList"),q({key:"custom",...j.value.custom})):Q.value!=="full range"&&Q.value!=="custom"?(Q.value="custom",Z.value=t):Z.value=t},re=t=>{t!==z.value&&Q.value=="full range"?q({key:"custom",...j.value.custom}):Q.value!=="full range"&&Q.value!=="custom"?(Q.value="custom",z.value=t):z.value=t};return console.log(Z.value,z.value,"683==>"),Ie(()=>[Z.value,z.value],([t,g])=>{console.log(t,g,"minmax new-liquidity-left")},{deep:!0,immediate:!0}),{positionError:rt,getCoinIcon:t=>{var g;return(t==null?void 0:t.logoURI)||(t==null?void 0:t.logo_url)||((g=W.value.tokensObj[t==null?void 0:t.address])==null?void 0:g.logo_url)||(U.value.theme==="default"?at("/image/coins/unknown.png"):at("/image/coins/sui-unknown.png"))},chainName:ye,store:U,currentTab:fe,currentPrice:lt,currentPriceReverse:ht,fromCoin:k,toCoin:w,direction:qe,needReverse:G,addCommom:Xe,decimalUi:Te,priceTablList:j,currentPriceTab:Q,sliderStyle:ne,poolInfo:y,tickList:et,getPriceTabImage:p,getPriceTabText:V,defaultMinPrice:mt,defaultMaxPrice:vt,minPrice:Z,maxPrice:z,currentTick:d,chartLoading:Y,zoomOut:$,zoomIn:L,zoom:m,priceTab:q,before7dContractPriceLowest:b,before7dContractPriceHighest:ee,aprRewardsTime:K,lever:F,aprRewardsParameter:T,isSelfBuilt:Se,priceRangeChangeMin:_,priceRangeChangeMax:re}}});const $o={class:"new-liquidity-left"},Ro={class:"select-range"},Bo=r("span",null,"Select Range",-1),Fo={class:"range-tab"},Oo=["src"],Uo=["src"],jo=r("span",null,"Liquidity",-1),zo=["src"],Ho=["src"],Do=r("span",null,"Price",-1),Eo={class:"price-info"},Wo={class:"left"},Xo={class:"base-coin"},Zo={class:"base-coin-title"},Go=r("span",null,"Base coin",-1),Ko=r("svg",{class:"icon icon-up","aria-hidden":"true"},[r("use",{"xlink:href":"#icon-exchange_up1"})],-1),xo=r("svg",{class:"icon icon-down","aria-hidden":"true"},[r("use",{"xlink:href":"#icon-exchange_down1"})],-1),Jo=[Ko,xo],Qo={key:0,class:"base-coin-bottom"},Yo={alt:""},Vo={key:1,class:"base-coin-bottom"},ei={alt:""},ti={class:"leverage"},oi=r("div",{class:"leverage-title"},"Leverage",-1),ii={class:"laverage-value"},ni={class:"current-price"},ri=r("div",{class:"current-price-title"},"Current Price",-1),ai={key:0,class:"from-pre-to"},li={class:"right"},si={class:"price-range"},ui={class:"left"},ci={class:"price-slider"},di={class:"slider"},mi=r("div",{class:"slider-ratio-content"},null,-1),vi=[mi],fi={class:"price-tab-list"},gi=["onClick"],pi=["src"],bi={class:"right"},hi={class:"range-tab"},ki=["src"],wi=["src"],yi=r("span",null,"Liquidity",-1),_i=["src"],Ci=["src"],Pi=r("span",null,"Price",-1),Ti={class:"price-zoom"},Si={class:"current-price"},Ni=r("div",{class:"current-price-title"},"Current Price",-1),Ai={key:0,class:"from-pre-to"},Li={class:"price-zoom-right"},Ii={key:2,class:"position-tips"},qi=["src"],Mi={class:"error"},$i={class:"leverage"},Ri={class:"left"},Bi=r("div",{class:"leverage-title"},"Leverage",-1),Fi={class:"laverage-value"},Oi={class:"right"},Ui={key:0,class:"day-7-price-range"},ji=r("i",null,null,-1),zi={class:"gray"},Hi={class:"apr-and-price"},Di={key:0,class:"position-tips"},Ei=["src"],Wi={class:"error"};function Xi(e,a,fe,E,U,ye){var y,G,Y,I,j,d,n,f,s,q,B;const H=Ut,W=wt,A=zt,de=Rt,i=Jt("image");return h(),O("div",$o,[r("div",Ro,[Bo,r("div",Fo,[r("div",{class:Je(["liquidity",e.currentTab=="liquidity"?"liquidity-tab-active":""]),onClick:a[0]||(a[0]=p=>e.currentTab="liquidity")},[e.chainName=="Sui"?(h(),O("img",{key:0,src:e.currentTab=="liquidity"?"/sui-image/Liquidity-Sel.png":"/sui-image/Liquidity-Def.png",alt:""},null,8,Oo)):(h(),O("img",{key:1,src:e.currentTab=="liquidity"?"/image/green_chart.png":"/sui-image/Liquidity-Def.png",alt:""},null,8,Uo)),jo],2),r("div",{class:Je(["price",e.currentTab=="price"?"price-tab-active":""]),onClick:a[1]||(a[1]=p=>e.currentTab="price")},[e.chainName=="Sui"?(h(),O("img",{key:0,src:e.currentTab=="price"?"/sui-image/Price-Sel.png":"/sui-image/Price-Def.png",alt:""},null,8,zo)):(h(),O("img",{key:1,src:e.currentTab=="price"?"/image/price-chart.png":"/sui-image/Price-Def.png",alt:""},null,8,Ho)),Do],2)])]),r("div",Eo,[r("div",Wo,[r("div",Xo,[r("div",Zo,[Go,r("div",{class:"change-price",onClick:a[2]||(a[2]=p=>e.direction=!e.direction)},Jo)]),e.direction?(h(),O("div",Vo,[pt(r("img",ei,null,512),[[i,e.getCoinIcon(e.toCoin)]]),r("span",null,be((G=e.toCoin)==null?void 0:G.symbol),1)])):(h(),O("div",Qo,[pt(r("img",Yo,null,512),[[i,e.getCoinIcon(e.fromCoin)]]),r("span",null,be((y=e.fromCoin)==null?void 0:y.symbol),1)]))]),r("div",ti,[oi,r("div",ii,be(e.lever),1)]),r("div",ni,[ri,r("div",null,[r("span",null,be(e.poolInfo?e.direction&&!e.needReverse?("addCommom"in e?e.addCommom:Pe(Xe))(("decimalUi"in e?e.decimalUi:Pe(Te))(e.currentPrice,6)):("addCommom"in e?e.addCommom:Pe(Xe))(("decimalUi"in e?e.decimalUi:Pe(Te))(e.currentPriceReverse,6)):"--"),1),e.fromCoin&&e.toCoin?(h(),O("span",ai,be(e.direction&&!e.needReverse?`${(Y=e.fromCoin)==null?void 0:Y.symbol} per ${(I=e.toCoin)==null?void 0:I.symbol}`:`${(j=e.toCoin)==null?void 0:j.symbol} per ${(d=e.fromCoin)==null?void 0:d.symbol}`),1)):oe("",!0)])])]),r("div",li,[e.currentTab=="liquidity"?(h(),O("div",{key:0,class:"zoom-in",onClick:a[3]||(a[3]=(...p)=>e.zoomIn&&e.zoomIn(...p))}," - ")):oe("",!0),e.currentTab=="liquidity"?(h(),O("div",{key:1,class:"zoom-out",onClick:a[4]||(a[4]=(...p)=>e.zoomOut&&e.zoomOut(...p))}," + ")):oe("",!0)])]),r("div",si,[r("div",ui,[r("div",ci,[r("div",di,[r("div",{class:"slider-ratio",style:bt(e.sliderStyle(e.currentPriceTab))},vi,4)])]),r("div",fi,[(h(!0),O(ut,null,It(e.priceTablList,p=>(h(),O("div",{key:p.key,class:Je(["price-tab-item",e.currentPriceTab==p.key?"price-tab-item-active":""]),onClick:V=>e.priceTab(p)},[r("img",{src:e.getPriceTabImage(p.key),alt:""},null,8,pi),r("span",null,be(e.getPriceTabText(p.key)),1)],10,gi))),128))])]),r("div",bi,[r("div",hi,[r("div",{class:Je(["liquidity",e.currentTab=="liquidity"?"liquidity-tab-active":""]),onClick:a[5]||(a[5]=p=>e.currentTab="liquidity")},[e.chainName=="Sui"?(h(),O("img",{key:0,src:e.currentTab=="liquidity"?"/sui-image/Liquidity-Sel.png":"/sui-image/Liquidity-Def.png",alt:""},null,8,ki)):(h(),O("img",{key:1,src:e.currentTab=="liquidity"?"/image/green_chart.png":"/sui-image/Price-Def.png",alt:""},null,8,wi)),yi],2),r("div",{class:Je(["price",e.currentTab=="price"?"price-tab-active":""]),onClick:a[6]||(a[6]=p=>e.currentTab="price")},[e.chainName=="sui"?(h(),O("img",{key:0,src:e.currentTab=="price"?"/sui-image/Price-Sel.png":"/sui-image/Price-Def.png",alt:""},null,8,_i)):(h(),O("img",{key:1,src:e.currentTab=="price"?"/image/price-chart.png":"/sui-image/Liquidity-Def.png",alt:""},null,8,Ci)),Pi],2)]),r("div",Ti,[r("div",Si,[Ni,r("div",null,[r("span",null,be(e.poolInfo?e.direction&&!e.needReverse?("addCommom"in e?e.addCommom:Pe(Xe))(("decimalUi"in e?e.decimalUi:Pe(Te))(e.currentPrice,6)):("addCommom"in e?e.addCommom:Pe(Xe))(("decimalUi"in e?e.decimalUi:Pe(Te))(e.currentPriceReverse,6)):"--"),1),e.fromCoin&&e.toCoin?(h(),O("span",Ai,be(e.direction&&!e.needReverse?`${(n=e.fromCoin)==null?void 0:n.symbol} per ${(f=e.toCoin)==null?void 0:f.symbol}`:`${(s=e.toCoin)==null?void 0:s.symbol} per ${(q=e.fromCoin)==null?void 0:q.symbol}`),1)):oe("",!0)])]),r("div",Li,[e.currentTab=="liquidity"?(h(),O("div",{key:0,class:"zoom-in",onClick:a[7]||(a[7]=(...p)=>e.zoomIn&&e.zoomIn(...p))}," - ")):oe("",!0),e.currentTab=="liquidity"?(h(),O("div",{key:1,class:"zoom-out",onClick:a[8]||(a[8]=(...p)=>e.zoomOut&&e.zoomOut(...p))}," + ")):oe("",!0)])]),e.fromCoin&&e.toCoin&&e.poolInfo&&e.currentTab=="liquidity"?(h(),Ze(H,{key:0,"pool-info":e.poolInfo,"min-price":e.minPrice,"max-price":e.maxPrice,direction:e.direction,"current-price-tab":e.currentPriceTab,"tick-list":e.tickList,"current-tick":e.currentTick,"chart-loading":e.chartLoading,zoom:e.zoom,"before7d-contract-price-lowest":e.before7dContractPriceLowest,"before7d-contract-price-highest":e.before7dContractPriceHighest,onOnChangeMinPrice:e.priceRangeChangeMin,onOnChangeMaxPrice:e.priceRangeChangeMax},null,8,["pool-info","min-price","max-price","direction","current-price-tab","tick-list","current-tick","chart-loading","zoom","before7d-contract-price-lowest","before7d-contract-price-highest","onOnChangeMinPrice","onOnChangeMaxPrice"])):oe("",!0),((B=e.tickList)==null?void 0:B.length)<=0&&e.chartLoading?(h(),Ze(W,{key:1})):oe("",!0),e.positionError&&e.poolInfo?(h(),O("div",Ii,[r("img",{src:("importIcon"in e?e.importIcon:Pe(at))("/image/icon-tips-error@2x.png"),alt:""},null,8,qi),r("p",Mi,be(e.$t("tips.positionError")),1)])):oe("",!0)])]),r("div",$i,[r("div",Ri,[Bi,r("div",Fi,be(e.lever),1)]),r("div",Oi,[e.poolInfo&&(e.before7dContractPriceLowest||e.before7dContractPriceHighest)?(h(),O("div",Ui,[ji,r("span",zi,be(e.aprRewardsParameter==7?"7D":e.aprRewardsParameter==24?"24H":"30D")+" Price Range",1),r("span",null,be(("addCommom"in e?e.addCommom:Pe(Xe))(("decimalUi"in e?e.decimalUi:Pe(Te))(e.before7dContractPriceLowest,6)))+" - "+be(("addCommom"in e?e.addCommom:Pe(Xe))(("decimalUi"in e?e.decimalUi:Pe(Te))(e.before7dContractPriceHighest,6))),1)])):oe("",!0)])]),r("div",Hi,[He(A,{"apr-rewards-parameter":e.aprRewardsParameter,"name-tab":"deposit","from-coin":e.fromCoin,"to-coin":e.toCoin,"pool-info":e.poolInfo,"min-price":e.minPrice,"max-price":e.maxPrice,onChangeAprRewardsParameter:a[9]||(a[9]=p=>{e.aprRewardsParameter=p})},null,8,["apr-rewards-parameter","from-coin","to-coin","pool-info","min-price","max-price"]),He(de,{min:e.minPrice,max:e.maxPrice,"from-coin":e.fromCoin,"to-coin":e.toCoin,direct:e.direction,"default-min-price":e.defaultMinPrice,"default-max-price":e.defaultMaxPrice,"pool-info":e.poolInfo,loading:e.chartLoading,"current-price-tab":e.currentPriceTab,onOnChangeMinPrice:e.priceRangeChangeMin,onOnChangeMaxPrice:e.priceRangeChangeMax},null,8,["min","max","from-coin","to-coin","direct","default-min-price","default-max-price","pool-info","loading","current-price-tab","onOnChangeMinPrice","onOnChangeMaxPrice"]),e.positionError&&e.poolInfo?(h(),O("div",Di,[r("img",{src:("importIcon"in e?e.importIcon:Pe(at))("/image/icon-tips-error@2x.png"),alt:""},null,8,Ei),r("p",Wi,be(e.$t("tips.positionError")),1)])):oe("",!0)])])}const Ht=ot(Mo,[["render",Xi]]),Zi=tt({components:{NewLiquidityTitle:Bt,NewLiquidityAssetsCard:Ft,NewLiquidityDepositRatio:Ot},setup(){const{t:e,locale:a}=qt(),fe=ct(),E=M(()=>fe),U=M(()=>E.value.chainName),ye=kt(),H=M(()=>ye),W=ro(),A=M(()=>W),de=Mt(),i=M(()=>{let o=null;for(const v in H.value.poolsObj){const S=H.value.poolsObj[v];S.address==de.query.poolAddress&&(console.log(S,"p===>"),o=S)}return o}),y=X(!1),G=X(!1),Y=M(()=>E.value.theme),I=async(o,v)=>{k.value=o.needReverse?o.token_b:o.token_a,w.value=o.needReverse?o.token_a:o.token_b};Ie(()=>i.value,(o,v)=>{console.log(v,"===>oldVal"),console.log(o,"===>newVal"),(!v&&o&&!Le(o)||v&&o&&v.address!==o.address)&&(console.log("池子信息"),I(o,!v||o.address!==v.address))},{immediate:!0});const j=M(()=>A.value.assets&&k.value&&A.value.assets[k.value.address]?_t(A.value.assets[k.value.address].balance,k.value.decimals):"0"),d=M(()=>A.value.assets&&w.value&&A.value.assets[w.value.address]?_t(A.value.assets[w.value.address].balance,w.value.decimals):"0"),n=o=>{o==="fromCoin"?(Ce.value=!0,U.value==="Aptos"?C.value=Number(j.value)>0?k.value.symbol=="APT"?new l(Number(j.value)).sub(new l(.1)).lt(new l(0))?"0":new l(Number(j.value)).sub(new l(.1)).toString():String(j.value):"":C.value=Number(j.value)>0?k.value.symbol=="SUI"?new l(Number(j.value)).sub(new l(.05)).lt(new l(0))?"0":new l(Number(j.value)).sub(new l(.05)).toString():String(j.value):""):(Ce.value=!1,U.value==="Aptos"?N.value=Number(d.value)>0?w.value.symbol=="APT"?new l(Number(d.value)).sub(new l(.1)).lt(new l(0))?"0":new l(Number(d.value)).sub(new l(.1)).toString():String(d.value):"":N.value=Number(d.value)>0?w.value.symbol=="SUI"?new l(Number(d.value)).sub(new l(.05)).lt(new l(0))?"0":new l(Number(d.value)).sub(new l(.05)).toString():String(d.value):"")},f=o=>{o==="fromCoin"?(Ce.value=!0,C.value=Number(j.value)>0?gt(new l(Number(j.value)).div(2).toString(),k.value.decimals).toString():""):(Ce.value=!1,N.value=Number(d.value)>0?gt(new l(Number(d.value)).div(2).toString(),w.value.decimals).toString():"")},s=X(),q=X(),B=X(),p=X(!1),V=o=>{var v,S,se,x;s.value=o,o==="fromCoin"?(q.value=((v=w.value)==null?void 0:v.address)||"",B.value=de.query.actions=="new-position"?(S=k.value)==null?void 0:S.address:i.value.needReverse?i.value.token_b.address:i.value.token_a.address):(q.value=((se=k.value)==null?void 0:se.address)||"",B.value=de.query.actions=="new-position"?(x=w.value)==null?void 0:x.address:i.value.needReverse?i.value.token_a.address:i.value.token_b.address),p.value=!0,console.log(p.value,"==>showCoinSelect.value ")},ne=o=>{var se,x,ue,me,ve,ie,te,_e;const v=i.value.needReverse?i.value.token_b:i.value.token_a,S=i.value.needReverse?i.value.token_a:i.value.token_b;s.value==="fromCoin"?(((se=k.value)==null?void 0:se.address)===(v==null?void 0:v.address)||!((x=k.value)!=null&&x.address)?(w.value&&o.address.toLowerCase()===((ue=w)==null?void 0:ue.value.address.toLowerCase())&&(w.value=null),k.value=o):(k.value&&o.address.toLowerCase()===((me=k)==null?void 0:me.value.address.toLowerCase())&&(k.value=null),w.value=o),de.query.action||(de.query.fee="")):((ve=w.value)==null?void 0:ve.address)===(S==null?void 0:S.address)||!((ie=w.value)!=null&&ie.address)?(k.value&&o.address.toLowerCase()===((te=k)==null?void 0:te.value.address.toLowerCase())&&(k.value=null),w.value=o):(w.value&&o.address.toLowerCase()===((_e=w)==null?void 0:_e.value.address.toLowerCase())&&(w.value=null),k.value=o),p.value=!1},m=M(()=>E.value.chainName?st(E.value.chainName):{}),$=M(()=>E.value.slippage),L=X(),P=async()=>{var Fe,We,Ue,ce;if(K.value)return console.log("跳出"),!1;if(!Z.value&&!z.value)return!1;if(!C.value&&!N.value&&!Z.value&&!z.value)return;const o=i.value||{};if(Le(o))return;const{TickUtil:v,TickMath:S,getNearestTickByTick:se}=m.value,x=o==null?void 0:o.token_a.decimals,ue=o==null?void 0:o.token_b.decimals;let me,ve,ie,te,_e,Ae,Ee,Ge,we=o==null?void 0:o.current_tick_index,J;if(o.token_a.address.toLowerCase()===k.value.address.toLowerCase()&&o.token_b.address.toLowerCase()===w.value.address.toLowerCase()?J=!0:J=!1,Z.value==="0"&&z.value==="∞")ie=v.getMinIndex(Number(o.tickSpacing)),te=v.getMaxIndex(Number(o.tickSpacing)),_e=S.tickIndexToSqrtPriceX64(ie),Ae=S.tickIndexToSqrtPriceX64(te);else if(Q.value=="custom"){console.log(J,"===>directs1866"),J?(me=Number(Z.value),ve=Number(z.value)):(me=new l(1).div(z.value).toString(),ve=new l(1).div(Z.value).toString());try{Ee=me==0?-443636:S.priceToTickIndex(new l(me),x,ue)}catch{Ee=-443636}try{Ge=S.priceToTickIndex(new l(ve),x,ue)}catch{Ge=443636}ie=se(Ee,Number(o.tickSpacing)),te=se(Ge,Number(o.tickSpacing)),_e=S.priceToSqrtPriceX64(new l(me),x,ue);try{Ae=S.priceToSqrtPriceX64(new l(ve),x,ue)}catch{console.log("0523###test###max###",ve),ve===1/0&&(console.log("0523###test###max###11111"),Ae=S.tickIndexToSqrtPriceX64(v.getMaxIndex(Number(o.tickSpacing))))}console.log("0518###pre###tick_lower###",ie,te,we),console.log("0518###pre###tick_upper###",te)}else ie=(Fe=xe.value[Q.value])==null?void 0:Fe.lower,te=(We=xe.value[Q.value])==null?void 0:We.upper,_e=S.tickIndexToSqrtPriceX64(ie),Ae=S.tickIndexToSqrtPriceX64(te);if(z.value!=="∞"&&ie>=te){y.value=!0,C.value="",G.value=!0,N.value="";return}if(console.log(te,we,ie,"1922"),z.value==="∞"||we>=ie&&we<=te){y.value=!1,G.value=!1;let le;if(C.value||N.value){if(Ce.value){const dt=new l(C.value).mul(Math.pow(10,k.value.decimals)).toString();le=new je(dt)}else{const dt=new l(N.value).mul(Math.pow(10,w.value.decimals)).toString();le=new je(dt)}console.log(J,"======>directs");const{liquidityAmount:Oe,tokenMaxA:Ye,tokenMaxB:Ve,tokenMaxAOrigin:Xt,tokenMaxBOrigin:Zt}=m.value.estLiquidityAndcoinAmountFromOneAmounts({tokenA:o.token_a,tokenB:o.token_b,lowerTick:ie,upperTick:te,coinAmount:le,iscoinA:J?Ce.value:!Ce.value,roundUp:!0,slippage:Number($.value)/100,curSqrtPrice:new je(o.current_sqrt_price)});L.value={liquidityAmount:Oe,tokenMaxA:Ye,tokenMaxB:Ve,tokenMaxAOrigin:Xt,tokenMaxBOrigin:Zt},console.log(Ye,Ve,"preAdd"),J?Ce.value?N.value=Number(Ve)>0?Ve:"":C.value=Number(Ye)>0?Ye:"":Ce.value?N.value=Ye:C.value=Ve}}else if(we>te){if(J?C.value="":N.value="",y.value=J,G.value=!J,C.value||N.value){let le;if(J){const Oe=new l(N.value).mul(Math.pow(10,(Ue=w.value)==null?void 0:Ue.decimals)).toString();le=new je(Oe),L.value={liquidityAmount:m.value.estimateLiquidityForCoinB(_e,Ae,le),tokenMaxA:0,tokenMaxB:N.value}}else{const Oe=new l(C.value).mul(Math.pow(10,(ce=k.value)==null?void 0:ce.decimals)).toString();le=new je(Oe),L.value={liquidityAmount:m.value.estimateLiquidityForCoinB(_e,Ae,le),tokenMaxA:0,tokenMaxB:C.value}}}}else if(we<ie){if(y.value=!J,G.value=J,J?N.value="":C.value="",C.value||N.value){let le;if(J){const Oe=new l(C.value).mul(Math.pow(10,k.value.decimals)).toString();le=new je(Oe),L.value={liquidityAmount:m.value.estimateLiquidityForCoinA(_e,Ae,le),tokenMaxA:C.value,tokenMaxB:0}}else{const Oe=new l(N.value).mul(Math.pow(10,w.value.decimals)).toString();le=new je(Oe),L.value={liquidityAmount:m.value.estimateLiquidityForCoinA(_e,Ae,le),tokenMaxA:N.value,tokenMaxB:0}}}}else y.value=!0,C.value="",G.value=!0,N.value=""};Ie(C,(o,v)=>{console.log(C,"===>fromCoinAmount"),o==""&&Ce.value&&(N.value=""),o&&Ce.value&&!K.value&&P()}),Ie(N,(o,v)=>{console.log(o,"===>>>>newValsda"),o==""&&!Ce.value&&(C.value=""),o&&!Ce.value&&!K.value&&P()});const T=X("--"),K=X(!1),b=M(()=>H.value.RATES),ee=()=>{const o=b.value&&b.value[k.value.address]&&b.value[k.value.address].price,v=b.value&&b.value[w.value.address]&&b.value[w.value.address].price;if(o&&v){const S=new l(C.value>0?C.value:0).mul(o),se=new l(N.value>0?N.value:0).mul(v),x=S.add(se).toNumber();T.value=x>0&&x<.01?"<0.01":Nt(x,2)}else T.value="--"};Ie(()=>[C.value,N.value,K.value],([o,v,S])=>{(o||v)&&!S?ee():(!o||!v)&&!S&&(T.value="--")},{immediate:!0}),Ie(()=>T,o=>{console.log(o,"71911111")},{immediate:!0}),Ie([Z,z],([o,v])=>{console.log(o,v,"==>minPrice,maxPrice"),Number(o)!==0&&Number(v)!==0&&!K.value?P():Number(o)!==0&&Number(v)!==0&&K.value&&_(),v!=="∞"&&Number(o)!==0&&Number(v)!==0&&Number(o)>=Number(v)?rt.value=!0:rt.value=!1,Number(o)==0&&Number(v)==0&&lt.value&&(rt.value=!0,console.log("价格区间错误"))},{deep:!0,immediate:!0});const F=o=>{console.log(o,"e"),K.value=!0,T.value=o,o>0?_():(C.value="",N.value="")},Se=X(),_=async()=>{var J,Fe,We,Ue;if(!Z.value&&!z.value)return!1;if(!C.value&&!N.value&&!Z.value&&!z.value)return;const o=i.value;if(Le(o))return;const{TickUtil:v,TickMath:S,getNearestTickByTick:se}=m.value,x=o==null?void 0:o.token_a.decimals,ue=o==null?void 0:o.token_b.decimals;let me,ve,ie,te,_e,Ae,Ee;if(o.token_a.address.toLowerCase()===k.value.address.toLowerCase()&&o.token_b.address.toLowerCase()===w.value.address.toLowerCase()?Ee=!0:Ee=!1,Z.value==="0"&&z.value==="∞")ie=v.getMinIndex(Number(o.tickSpacing)),te=v.getMaxIndex(Number(o.tickSpacing));else if(Q.value=="custom"){Ee?(me=Number(Z.value),ve=Number(z.value)):(me=new l(1).div(z.value).toString(),ve=new l(1).div(Z.value).toString());try{_e=me==0?-443636:S.priceToTickIndex(new l(me),x,ue)}catch{_e=-443636}try{Ae=S.priceToTickIndex(new l(ve),x,ue)}catch{Ae=443636}ie=se(_e,Number(o.tickSpacing)),te=se(Ae,Number(o.tickSpacing))}else ie=(J=xe.value[Q.value])==null?void 0:J.lower,te=(Fe=xe.value[Q.value])==null?void 0:Fe.upper;const Ge=b.value[(We=o.value)==null?void 0:We.token_a.address].price,we=b.value[(Ue=o.value)==null?void 0:Ue.token_b.address].price;qe.value?new je(o.current_sqrt_price):new je(1/o.current_sqrt_price),console.log(qe.value,"===>direction.value"),console.log(o,"poolInfos===>"),console.log(ie,te,"####tick_lower tick_upper 889");try{const{amountA:ce,amountB:le,tokenAmountsInfo:Oe}=await m.value.estCoinAmountsFromTotalAmount({lowerTick:ie,upperTick:te,decimalsA:x,decimalsB:ue,curSqrtPrice:new je(o.current_sqrt_price),totalAmount:T.value,tokenPriceA:Ge,tokenPriceB:we});console.log(ce,le,"###estCoinAmountsFromTotalAmount 844"),console.log(o.needReverse,qe.value,"===>849"),Se.value=Oe,o.needReverse?qe.value?(C.value=ce,N.value=le):(C.value=le,N.value=ce):(C.value=ce,N.value=le)}catch(ce){console.log(ce,"e===>")}},re=X(!1),{setTransactionTxid:Ke,setTransactionDesc:t,setIsShowWaiting:g,setIsShowSuccess:R,setPositiomNum:D,setIsShowRejected:he}=fe,ae=po(),ke=M(()=>H.value.currentPositionInfo),Me=X(!1),$e=async o=>{var _e,Ae,Ee,Ge;console.log(i.value,"===> poolInfo.value"),re.value=!1,H.value.currentPositionInfo={},Ke(""),t(e("tips.increaseLiquiditySuccess",{from:y.value?"":`${C.value} ${(_e=k.value)==null?void 0:_e.symbol}`,and:!y.value&&!G.value?"and":"",to:G.value?"":`${N.value} ${(Ae=w.value)==null?void 0:Ae.symbol}`})),g(!0);const v=qe.value?Ce.value:!Ce.value;let S,se,x,ue,me,ve;const ie=i.value.token_a.decimals,te=i.value.token_b.decimals;if(Z.value==="0"&&z.value==="∞")x=m.value.TickUtil.getMinIndex(Number(i.value.tickSpacing)),ue=m.value.TickUtil.getMaxIndex(Number(i.value.tickSpacing));else if(Q.value=="custom"){qe.value?(S=Number(Z.value),se=Number(z.value)):(S=new l(1).div(z.value).toString(),se=new l(1).div(Z.value).toString()),console.log("0519###toAdd###min###",S),console.log("0519###toAdd###max###",se),console.log("0519###toAdd###minPrice.value###",Z.value),console.log("0519###toAdd###maxPrice.value###",z.value);try{me=S==0?m.value.TickUtil.getMinIndex(Number(i.value.tickSpacing)):m.value.TickMath.priceToTickIndex(new l(S),ie,te)}catch{me=m.value.TickUtil.getMinIndex(Number(i.value.tickSpacing))}try{ve=m.value.TickMath.priceToTickIndex(new l(se),ie,te)}catch{ve=m.value.TickUtil.getMaxIndex(Number(i.value.tickSpacing))}x=m.value.getNearestTickByTick(me,Number(i.value.tickSpacing)),ue=m.value.getNearestTickByTick(ve,Number(i.value.tickSpacing))}else x=xe.value[Q.value].lower,ue=xe.value[Q.value].upper;console.log(x,ue,"####tick_lower tick_upper 889"),console.log(i.value,"==>poolInfo.value.curSqrtPrice");try{let we;K.value?we=await m.value.getCreateAddLiquidityPayload({pool:i.value,curSqrtPrice:new je(i.value.current_sqrt_price),tickLower:x,tickUpper:ue,slippage:Number($.value)/100,tokenAmounts:Se.value}):we=await m.value.getAddLiquidityTransactionPayload({pool:{poolAddress:i.value.poolAddress,token_a:i.value.token_a,token_b:i.value.token_b},amount:Ce.value?C.value:N.value,fix_amount_a:v,tick_lower:x,tick_upper:ue,index:0,slippage:Number($.value)/100,roundUp:!0,collect_fee:!1,curSqrtPrice:new je(i.value.current_sqrt_price)}),console.log(we,"payload===?");let J;if(U.value==="Aptos")J=await A.value.currentWallet.signAndSubmitTransaction(we);else{const Fe=await A.value.currentWallet.signAndExecuteTransactionBlock(we);J=m.value.handleTx(Fe)}if(console.log("0410###tx###",J),J&&J.hash){Ke(J.hash),g(!1),R(!0);let Fe;i.value.needReverse?i.value.token_a.address.toLowerCase()===k.value.address.toLowerCase()&&i.value.token_b.address.toLowerCase()===w.value.address.toLowerCase()?Fe=!1:Fe=!0:i.value.token_a.address.toLowerCase()===k.value.address.toLowerCase()&&i.value.token_b.address.toLowerCase()===w.value.address.toLowerCase()?Fe=!0:Fe=!1,console.log(Fe,"===>directs");const We={title:"Supplied",desc:e("tips.addLiquiditySuccessText",{from:y.value?"":`${C.value} ${(Ee=k.value)==null?void 0:Ee.symbol}`,and:!y.value&&!G.value?"and":"",to:G.value?"":`${N.value} ${(Ge=w.value)==null?void 0:Ge.symbol}`}),hash:J.hash,tit:"Position Created",icon:"icon-icon-Position-Created"};U.value!=="Aptos"&&(We.res=J.res),m.value.showTransitionPending(We);const Ue=await m.value.watchTransaction(We,!0);if(Ue.status){if(R(!1),H.value.setCurrentPositionLoading(!0),Me.value=!0,console.log(Ue.nftInfo,"===> watchInfo.nftInfo"),U.value==="Aptos"){if(await H.value.setCurrentPositionInfo(Ue.nftInfo[0].data.id.creator,Ue.nftInfo[0].data.id.collection,Ue.nftInfo[0].data.name,U.value),o)try{await ae.subscribePosition({pool_address:ke.value.poolAddress,position_index:ke.value.index},ke.value.nftHash)}catch(ce){console.log(ce,"e")}}else{const ce=Ue.nftInfo,le=await Ct(2e3);if(await H.value.setCurrentPositionInfo(ce==null?void 0:ce.pool,"","",U.value,ce==null?void 0:ce.position),await Ct(1e3),console.log("0529###nftInfo###",ce),console.log("0529###currentPositionInfo.value.index###",ke.value.index),o)try{await ae.subscribePosition({pool_address:ke.value.poolAddress,position_index:ke.value.index},ke.value.nftHash)}catch(Oe){console.log(Oe)}}setTimeout(()=>{ye.updateCurrentPools(i.value.poolAddress,U.value),m.value.getAccount(A.value.address)},3e3),setTimeout(async()=>{Tt(m,i)},3e3)}D()}else g(!1),he(!0);C.value="",N.value=""}catch(we){C.value="",N.value="",console.log("0330###Add liquidity Error###",we),g(!1),he(!0)}},De=M(()=>!C.value&&!N.value?(console.log("addLiquidityBtnDisabled11111"),!0):Number(C.value)>Number(j.value)||Number(N.value)>Number(d.value)?(console.log("addLiquidityBtnDisabled22222"),!0):Ne.value!==e("button.addLiquidity")&&Ne.value!==e("newAdd.preview")?(console.log("addLiquidityBtnDisabled33333###",Ne.value),!0):i.value&&i.value&&i.value.is_pause?(console.log("addLiquidityBtnDisabled44444"),!0):Number(C.value)<=0&&Number(N.value)<=0||!y.value&&Number(C.value)==0||!G.value&&Number(N.value)==0),ze=M(()=>!k.value||!w.value),Ne=M(()=>i.value&&i.value.is_pause?"Pool Closed":!k.value||!w.value||ze.value?e("modal.selectTokenModalTitle"):Number(C.value)>Number(j.value)?e("button.insufficientBalance",{name:k.value.symbol}):Number(N.value)>Number(d.value)?e("button.insufficientBalance",{name:w.value.symbol}):!Number(C.value)&&!Number(N.value)?e("button.enterAmount"):z.value!=="∞"&&Number(Z.value)>=Number(z.value)?e("newAdd.invalidRange"):e("button.addLiquidity")),Re=X({}),Qe=X({}),it=(o,v)=>{console.log(s.value,"===>currentCoinKey.value"),console.log(o);const S=localStorage.getItem(o.address);console.log(H.value.tokensObj,"===>pools.value.tokensObj"),console.log(S,"===>coinLocak"),H.value.tokensObj&&H.value.tokensObj[o.address]&&H.value.tokensObj[o.address].isSelfBuilt&&!S&&(v=="fromCoin"&&(Re.value=o),v=="toCoin"&&(Qe.value=o),c.value=!0)};Ie(()=>[k.value,w.value],([o,v])=>{o&&!Le(o)&&it(o,"fromCoin"),v&&!Le(v)&&it(v,"toCoin")},{immediate:!0});const u=Qt(),c=X(!1),Be=()=>{U.value!=="Aptos"?u.push("/pool/list"):u.push("/pools")},ge=o=>{K.value,$e(o)},pe=o=>{const v=new RegExp("[^\\d-]*(\\d*(?:\\.\\d*)?).*$");o.target.value=o.target.value.replace(v,"$1")},Et=()=>{de.query.action!=="create-pool"&&de.query.actions!=="new-position"&&(Tt(m,i),P(),ye.updateCurrentPools(i.value.poolAddress,U.value)),ye.setPoolConfigList(U.value,E.value.filterCoinsObj)},Wt=M(()=>{var S,se,x,ue,me,ve;const o=(x=b.value[(se=(S=k)==null?void 0:S.value)==null?void 0:se.address])==null?void 0:x.price,v=(ve=b.value[(me=(ue=w)==null?void 0:ue.value)==null?void 0:me.address])==null?void 0:ve.price;return!!(o&&v)});return{inputChange:pe,poolInfo:i,fromCoinAmount:C,toCoinAmount:N,fromCoin:k,toCoin:w,theme:Y,showFromCoinLock:y,showToCoinLock:G,fromCoinBlance:j,toCoinBlance:d,maxBtnSelect:n,halfBtnSelect:f,fixedFromCoin:Ce,openCoinSelect:V,currentCoinKey:s,existingCoins:q,lastSelectCoin:B,showCoinSelect:p,onCoinSelect:ne,liquidityTotalAmount:T,toggle:ao,onInput:F,isInputTotalAmount:K,isViewDetail:Me,addLiquidityBtnDisabled:De,addLiquidityBtnText:Ne,isShowTokenWarning:c,chainName:U,closeTokenWarning:Be,warningFromCoin:Re,warningToCoin:Qe,isShowLiquidityModal:re,currentPrice:lt,currentPriceReverse:ht,currentPriceTab:Q,minPrice:Z,maxPrice:z,toAdd:$e,direction:qe,wallet:A,getAddLiquidityType:ge,clickRefresh:Et,isShowtotalAmount:Wt}}});const Gi={class:"new-liquidity-right"},Ki={class:"deposit-title"},xi={class:"card-container"},Ji={class:"card-item"},Qi={class:"card-item"},Yi={key:0,class:"total-amount"},Vi=r("span",null,"Total Amount",-1);function en(e,a,fe,E,U,ye){const H=Bt,W=Ft,A=co,de=Vt,i=Ot,y=eo,G=mo,Y=vo,I=fo,j=go;return h(),O("div",Gi,[r("div",Ki,[He(H,{"pool-info":e.poolInfo,onClickRefresh:e.clickRefresh},null,8,["pool-info","onClickRefresh"])]),r("div",xi,[r("div",Ji,[He(W,{modelValue:e.fromCoinAmount,"onUpdate:modelValue":a[0]||(a[0]=d=>e.fromCoinAmount=d),"input-value":e.fromCoinAmount,"coin-symbol":e.fromCoin?e.fromCoin.symbol:null,"coin-name":e.fromCoin?e.fromCoin.name:null,balance:e.fromCoinBlance,"coin-icon":e.fromCoin?e.fromCoin.logoURI:"",address:e.fromCoin?e.fromCoin.address:"","swap-direct":"From","import-page":"deposit","has-arrow":!1,onOnMax:a[1]||(a[1]=d=>e.maxBtnSelect("fromCoin")),onOnHalf:a[2]||(a[2]=d=>e.halfBtnSelect("fromCoin")),onOnInput:a[3]||(a[3]=d=>{e.fromCoinAmount=d,e.fixedFromCoin=!0,e.isInputTotalAmount=!1}),onOnSelect:a[4]||(a[4]=d=>e.openCoinSelect("fromCoin"))},null,8,["modelValue","input-value","coin-symbol","coin-name","balance","coin-icon","address"]),e.showFromCoinLock?(h(),Ze(A,{key:0,"from-coin":e.fromCoin,"to-coin":e.toCoin,"pool-info":e.poolInfo},null,8,["from-coin","to-coin","pool-info"])):oe("",!0)]),r("div",Qi,[He(W,{modelValue:e.toCoinAmount,"onUpdate:modelValue":a[5]||(a[5]=d=>e.toCoinAmount=d),"input-value":e.toCoinAmount,"coin-symbol":e.toCoin?e.toCoin.symbol:null,"coin-name":e.toCoin?e.toCoin.name:null,balance:e.toCoinBlance,"swap-direct":"To","coin-icon":e.toCoin?e.toCoin.logoURI:"",address:e.toCoin?e.toCoin.address:"","import-page":"deposit","has-arrow":!1,onOnMax:a[6]||(a[6]=d=>e.maxBtnSelect("toCoin")),onOnHalf:a[7]||(a[7]=d=>e.halfBtnSelect("toCoin")),onOnInput:a[8]||(a[8]=d=>{e.toCoinAmount=d,e.fixedFromCoin=!1,e.isInputTotalAmount=!1}),onOnSelect:a[9]||(a[9]=d=>e.openCoinSelect("toCoin"))},null,8,["modelValue","input-value","coin-symbol","coin-name","balance","coin-icon","address"]),e.showToCoinLock?(h(),Ze(A,{key:0,"from-coin":e.fromCoin,"to-coin":e.toCoin,"pool-info":e.poolInfo},null,8,["from-coin","to-coin","pool-info"])):oe("",!0)]),e.fromCoin&&e.toCoin&&!e.showToCoinLock&&!e.showFromCoinLock&&e.theme=="default"?(h(),O("img",{key:0,class:"add",src:so,alt:"",onClick:a[10]||(a[10]=(...d)=>e.toggle&&e.toggle(...d))})):oe("",!0),e.fromCoin&&e.toCoin&&!e.showToCoinLock&&!e.showFromCoinLock&&e.theme!=="default"?(h(),O("img",{key:1,class:"add",src:uo,alt:"",onClick:a[11]||(a[11]=(...d)=>e.toggle&&e.toggle(...d))})):oe("",!0)]),e.isShowtotalAmount?(h(),O("div",Yi,[Vi,r("span",null,[Pt("$ "),He(de,{value:e.liquidityTotalAmount,placeholder:e.isInputTotalAmount?"":e.liquidityTotalAmount,onChange:e.inputChange,onInput:a[12]||(a[12]=d=>e.onInput(d.target.value))},null,8,["value","placeholder","onChange"])])])):oe("",!0),He(i,{"from-coin":e.fromCoin,"to-coin":e.toCoin,"from-coin-amount":e.fromCoinAmount,"to-coin-amount":e.toCoinAmount,"fixed-from-coin":e.fixedFromCoin,"is-input-total-amount":e.isInputTotalAmount,"min-price":e.minPrice,"max-price":e.maxPrice,"current-price-tab":e.currentPriceTab,"current-price":e.currentPrice,"current-price-reverse":e.currentPriceReverse},null,8,["from-coin","to-coin","from-coin-amount","to-coin-amount","fixed-from-coin","is-input-total-amount","min-price","max-price","current-price-tab","current-price","current-price-reverse"]),He(y,{class:"add-liquidity-btn",disabled:e.addLiquidityBtnDisabled,onClick:a[13]||(a[13]=d=>e.wallet.connected?e.isShowLiquidityModal=!0:e.wallet.setIsShowWalletModal(!0))},{default:Yt(()=>[Pt(be(e.addLiquidityBtnText),1)]),_:1},8,["disabled"]),e.showCoinSelect?(h(),Ze(G,{key:1,"existing-coins":e.existingCoins,"last-select-coin":e.lastSelectCoin,onOnSelect:e.onCoinSelect,onOnClose:a[14]||(a[14]=d=>e.showCoinSelect=!1)},null,8,["existing-coins","last-select-coin","onOnSelect"])):oe("",!0),e.isViewDetail?(h(),Ze(Y,{key:2,"pool-info":e.poolInfo,onOnClose:a[15]||(a[15]=d=>e.isViewDetail=!1)},null,8,["pool-info"])):oe("",!0),e.chainName=="Sui"&&e.isShowTokenWarning?(h(),Ze(I,{key:3,"from-coin":e.warningFromCoin,"to-coin":e.warningToCoin,onClose:e.closeTokenWarning,onClickContinue:a[16]||(a[16]=d=>e.isShowTokenWarning=!1)},null,8,["from-coin","to-coin","onClose"])):oe("",!0),e.isShowLiquidityModal?(h(),Ze(j,{key:4,"pool-info":e.poolInfo,title:e.$t("button.addLiquidity"),"from-coin-amount":e.fromCoinAmount,"to-coin-amount":e.toCoinAmount,"from-coin":e.fromCoin,"to-coin":e.toCoin,"fixed-from-coin":e.fixedFromCoin,"current-price":e.currentPrice,"current-price-reverse":e.currentPriceReverse,"current-price-tab":e.currentPriceTab,"min-price":e.minPrice,"max-price":e.maxPrice,"show-from-coin-lock":e.showFromCoinLock,"show-to-coin-lock":e.showToCoinLock,"current-direct":e.direction,"is-increase":!1,onToAdd:e.getAddLiquidityType,onOnClose:a[17]||(a[17]=d=>e.isShowLiquidityModal=!1)},null,8,["pool-info","title","from-coin-amount","to-coin-amount","from-coin","to-coin","fixed-from-coin","current-price","current-price-reverse","current-price-tab","min-price","max-price","show-from-coin-lock","show-to-coin-lock","current-direct","onToAdd"])):oe("",!0)])}const Dt=ot(Zi,[["render",en]]),tn=tt({components:{NewLiquidityLeft:Ht,NewLiquidityRight:Dt},setup(){return $t(()=>{lo()}),{tickList:et}}});const on={key:0,class:"loading-spin-liquidity loading-global"},nn={class:"privide-liquidity"};function rn(e,a,fe,E,U,ye){const H=wt,W=Ht,A=Dt;return h(),O(ut,null,[e.tickList?oe("",!0):(h(),O("div",on,[He(H)])),r("div",nn,[He(W),He(A)])],64)}const Un=ot(tn,[["render",rn],["__scopeId","data-v-f338bf1f"]]);export{Un as default};
