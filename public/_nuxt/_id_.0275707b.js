import{_ as Se}from"./new-position-title.2d91f9e3.js";import{_ as Pe}from"./token-warning.b79e0fb1.js";import{_ as ce}from"./auto-pool-apy-tips.93388007.js";import{u as No,a as J,g as Qo,c as Oo,d as te,s as lo,p as re,b as me,e as U,T as Xo,f as Te}from"./pool.6412dc9f.js";import{u as se,a as pe}from"./sha256.e5b91111.js";import{u as Mo,a as fe}from"./autoPool.ba27b030.js";import{i as zo}from"./import-icon.de3e6c66.js";import{a as Lo,l as y,m as Do,r as w,q as vo,e as Uo,s as ue,o as _,f as B,h as e,t as Co,i as K,v as c,j as ne,x as eo,u as Z,p as Yo,k as Go,y as de,z as _e,A as ye,C as ae,c as ao,w as Ho,B as be,D as Re,b as qe,F as Be,E as Oe,G as Ne,H as ve}from"./entry.8278fad2.js";import{_ as ge}from"./assets-card.5ae786cc.js";import{_ as ke}from"./coin-lock.c1625032.js";import{_ as he,a as we}from"./auto-pool-remove-modal.e397d414.js";import{D as u}from"./decimal.0e8aa3f1.js";/* empty css              *//* empty css              */import"./decimal.633e31ee.js";import{V as ie}from"./index.99bd5734.js";import"./back.e2282130.js";import"./swap-setting.61e13184.js";/* empty css              *//* empty css              *//* empty css              *//* empty css              */import"./img-lock_2x.a28135f4.js";import"./img-lock_2x.066951d5.js";const Me=Lo({components:{AutoPoolApyTips:ce},setup(){const o=se(),t=y(()=>o),W=No(),F=y(()=>W),V=Mo(),I=y(()=>V),A=y(()=>t.value.theme),k=Do(),i=w();vo(()=>[I.value.positionInfoObj,k.params.id],([l,v])=>{l&&!Oo(l)&&v&&(i.value=l[v],console.log(i.value,"##positionInfo.value"))},{immediate:!0,deep:!0});const d=y(()=>{var l;return(l=i.value)==null?void 0:l.needReverse}),a=l=>{var v;return(l==null?void 0:l.logoURI)||(l==null?void 0:l.logo_url)||((v=F.value.tokensObj[l==null?void 0:l.address])==null?void 0:v.logo_url)||(A.value==="default"?zo("/image/coins/unknown.png"):zo("/image/coins/sui-unknown.png"))},n=y(()=>{var l,v;return I.value.apyObj&&((v=I.value.apyObj[(l=i.value)==null?void 0:l.id])==null?void 0:v.tvl)||"--"}),C=y(()=>{var l,v;return I.value.apyObj&&((v=I.value.apyObj[(l=i.value)==null?void 0:l.id])==null?void 0:v.apr)||"--"});return{positionInfo:i,needReverse:d,getCoinIcon:a,tvl:n,apy:C,addCommom:J,getExplorerUrl:Qo}}});const co=o=>(Yo("data-v-688e28b6"),o=o(),Go(),o),Le={class:"auto-pool-v2-info"},De={class:"pool-info"},Ue={class:"left"},Fe={class:"coin-a"},Ve={alt:""},Ee={class:"coin-b"},We={alt:""},je={class:"position-name"},Xe={key:0,class:"pool-fee"},He=co(()=>e("span",null,"Fee tier",-1)),ze={class:"vault-address"},Ye=co(()=>e("span",null,"Vault Address",-1)),Ge=["href"],Ze=co(()=>e("svg",{class:"icon","aria-hidden":"true"},[e("use",{"xlink:href":"#icon-icon-link"})],-1)),Je=[Ze],Ke={class:"pool-address"},Qe=co(()=>e("span",null,"Pool Address",-1)),xe=["href"],on=co(()=>e("svg",{class:"icon","aria-hidden":"true"},[e("use",{"xlink:href":"#icon-icon-link"})],-1)),en=[on],nn={class:"apy-and-tvl"},tn={class:"apy"},sn=co(()=>e("div",{class:"apy-title"},"APY",-1)),ln={class:"apy-text"},an={class:"tvl"},un=co(()=>e("div",{class:"tvl-title"},"TVL",-1)),rn={class:"tvl-text"},dn={class:"pool-info h5-pool-info"},vn={class:"left"},cn={class:"coin-a"},mn={alt:""},pn={class:"coin-b"},fn={alt:""},_n={class:"position-name"},yn={key:0,class:"pool-fee"},bn=co(()=>e("span",null,"Fee tier",-1)),gn={class:"left"},kn={class:"vault-address"},hn=co(()=>e("span",null,"Vault Address",-1)),wn=["href"],In=co(()=>e("svg",{class:"icon","aria-hidden":"true"},[e("use",{"xlink:href":"#icon-icon-link"})],-1)),$n=[In],Cn={class:"pool-address"},An=co(()=>e("span",null,"Pool Address",-1)),Sn=["href"],Pn=co(()=>e("svg",{class:"icon","aria-hidden":"true"},[e("use",{"xlink:href":"#icon-icon-link"})],-1)),Tn=[Pn],Rn={class:"apy-and-tvl"},qn={class:"apy"},Bn=co(()=>e("div",{class:"apy-title"},"APY",-1)),On={class:"apy-text"},Nn={class:"tvl"},Mn=co(()=>e("div",{class:"tvl-title"},"TVL",-1)),Ln={class:"tvl-text"};function Dn(o,t,W,F,V,I){var d,a,n,C,l,v,f,r,T,S,R,b,h,g,$,E,Q,mo,x,po,bo,Ao,go,ko,ro,ho,fo,N,no,Fo,_o,Vo,So,yo,wo,Po,To,Eo,Wo,oo,io,Jo,m,P,j,L,to,z;const A=Pe,k=ce,i=ue("image");return _(),B("div",Le,[e("div",De,[e("div",Ue,[e("div",Fe,[Co(e("img",Ve,null,512),[[i,o.needReverse?o.getCoinIcon((a=o.positionInfo)==null?void 0:a.token_b):o.getCoinIcon((d=o.positionInfo)==null?void 0:d.token_a)]]),K(A,{address:o.needReverse?(v=(l=o.positionInfo)==null?void 0:l.token_b)==null?void 0:v.address:(C=(n=o.positionInfo)==null?void 0:n.token_a)==null?void 0:C.address,"style-params":{width:"12px",height:"12px",left:"18px",bottom:"4px"}},null,8,["address"])]),e("div",Ee,[Co(e("img",We,null,512),[[i,o.needReverse?o.getCoinIcon((r=o.positionInfo)==null?void 0:r.token_a):o.getCoinIcon((f=o.positionInfo)==null?void 0:f.token_b)]]),K(A,{address:o.needReverse?(b=(R=o.positionInfo)==null?void 0:R.token_a)==null?void 0:b.address:(S=(T=o.positionInfo)==null?void 0:T.token_b)==null?void 0:S.address,"style-params":{width:"12px",height:"12px",left:"18px",bottom:"4px"}},null,8,["address"])]),e("div",je,c(o.needReverse?(g=(h=o.positionInfo)==null?void 0:h.token_b)==null?void 0:g.symbol:(E=($=o.positionInfo)==null?void 0:$.token_a)==null?void 0:E.symbol)+" - "+c(o.needReverse?(mo=(Q=o.positionInfo)==null?void 0:Q.token_a)==null?void 0:mo.symbol:(po=(x=o.positionInfo)==null?void 0:x.token_b)==null?void 0:po.symbol),1),(bo=o.positionInfo)!=null&&bo.fee?(_(),B("div",Xe,[He,ne(" "+c(((Ao=o.positionInfo)==null?void 0:Ao.fee)*100)+"% ",1)])):eo("",!0),e("div",ze,[Ye,e("a",{href:("getExplorerUrl"in o?o.getExplorerUrl:Z(Qo))("poolAddress",(go=o.positionInfo)==null?void 0:go.id),target:"_blank"},Je,8,Ge)]),e("div",Ke,[Qe,e("a",{href:("getExplorerUrl"in o?o.getExplorerUrl:Z(Qo))("poolAddress",(ko=o.positionInfo)==null?void 0:ko.id),target:"_blank"},en,8,xe)])]),e("div",nn,[e("div",tn,[sn,e("div",ln,[ne(c(o.apy)+" ",1),K(k)])]),e("div",an,[un,e("div",rn,"$"+c(("addCommom"in o?o.addCommom:Z(J))(o.tvl,2)),1)])])]),e("div",dn,[e("div",vn,[e("div",cn,[Co(e("img",mn,null,512),[[i,o.needReverse?o.getCoinIcon((ho=o.positionInfo)==null?void 0:ho.token_b):o.getCoinIcon((ro=o.positionInfo)==null?void 0:ro.token_a)]]),K(A,{address:o.needReverse?(Fo=(no=o.positionInfo)==null?void 0:no.token_b)==null?void 0:Fo.address:(N=(fo=o.positionInfo)==null?void 0:fo.token_a)==null?void 0:N.address,"style-params":{width:"12px",height:"12px",left:"18px",bottom:"4px"}},null,8,["address"])]),e("div",pn,[Co(e("img",fn,null,512),[[i,o.needReverse?o.getCoinIcon((Vo=o.positionInfo)==null?void 0:Vo.token_a):o.getCoinIcon((_o=o.positionInfo)==null?void 0:_o.token_b)]]),K(A,{address:o.needReverse?(Po=(wo=o.positionInfo)==null?void 0:wo.token_a)==null?void 0:Po.address:(yo=(So=o.positionInfo)==null?void 0:So.token_b)==null?void 0:yo.address,"style-params":{width:"12px",height:"12px",left:"18px",bottom:"4px"}},null,8,["address"])]),e("div",_n,c(o.needReverse?(Eo=(To=o.positionInfo)==null?void 0:To.token_b)==null?void 0:Eo.symbol:(oo=(Wo=o.positionInfo)==null?void 0:Wo.token_a)==null?void 0:oo.symbol)+" - "+c(o.needReverse?(Jo=(io=o.positionInfo)==null?void 0:io.token_a)==null?void 0:Jo.symbol:(P=(m=o.positionInfo)==null?void 0:m.token_b)==null?void 0:P.symbol),1),(j=o.positionInfo)!=null&&j.fee?(_(),B("div",yn,[bn,ne(" "+c(((L=o.positionInfo)==null?void 0:L.fee)*100)+"% ",1)])):eo("",!0)]),e("div",gn,[e("div",kn,[hn,e("a",{href:("getExplorerUrl"in o?o.getExplorerUrl:Z(Qo))("poolAddress",(to=o.positionInfo)==null?void 0:to.id),target:"_blank"},$n,8,wn)]),e("div",Cn,[An,e("a",{href:("getExplorerUrl"in o?o.getExplorerUrl:Z(Qo))("poolAddress",(z=o.positionInfo)==null?void 0:z.id),target:"_blank"},Tn,8,Sn)])]),e("div",Rn,[e("div",qn,[Bn,e("div",On,[ne(c(o.apy)+" ",1),K(k)])]),e("div",Nn,[Mn,e("div",Ln,"$"+c(("addCommom"in o?o.addCommom:Z(J))(o.tvl,2)),1)])])])])}const Ie=Uo(Me,[["render",Dn],["__scopeId","data-v-688e28b6"]]),Un=Lo({setup(){const o=w(!0),t=No(),W=y(()=>t),F=Mo(),V=y(()=>F),I=Do(),A=w();vo(()=>[V.value.positionInfoObj,I.params.id],([d,a])=>{d&&!Oo(d)&&a&&(A.value=d[a],console.log(A.value,"##positionInfo.value"))},{immediate:!0,deep:!0});const k=y(()=>{var d;return(d=A.value)==null?void 0:d.needReverse});return{direct:o,positionInfo:A,needReverse:k,getCoinIcon:d=>{var a;return(d==null?void 0:d.logoURI)||(d==null?void 0:d.logo_url)||((a=W.value.tokensObj[d==null?void 0:d.address])==null?void 0:a.logo_url)||zo("/image/coins/sui-unknown.png")},decimalUi:te,addCommom:J,sFixD:lo}}}),Fn=""+globalThis.__publicAssetsURL("sui-image/icon_currentprice@2x.png");const Io=o=>(Yo("data-v-5fd7732d"),o=o(),Go(),o),Vn={class:"v2-position-range"},En={class:"position-range-top"},Wn=Io(()=>e("div",null,"Position Range",-1)),jn={class:"base-coin"},Xn={key:0,alt:""},Hn={key:1,alt:""},zn={key:2},Yn={key:3},Gn=Io(()=>e("p",null,"Base coin",-1)),Zn={class:"coin-rate"},Jn=Io(()=>e("div",null,[e("svg",{class:"icon icon-up","aria-hidden":"true"},[e("use",{"xlink:href":"#icon-exchange_up1"})])],-1)),Kn=Io(()=>e("div",null,[e("svg",{class:"icon icon-down","aria-hidden":"true"},[e("use",{"xlink:href":"#icon-exchange_down1"})])],-1)),Qn=[Jn,Kn],xn={class:"position-range-bottom"},ot={class:"current-price"},et=Io(()=>e("div",{class:"current-price-title"},"Current Price",-1)),nt={key:0,class:"current-price-text"},tt={key:1,class:"current-price-text"},st={class:"price-range"},lt=Io(()=>e("div",{class:"price-range-bg"},[e("div",{class:"price-range-border"})],-1)),it=Io(()=>e("img",{src:Fn,alt:""},null,-1)),at={class:"min-price"},ut=Io(()=>e("div",null,"Min Price",-1)),rt={class:"max-price"},dt=Io(()=>e("div",null,"Max Price",-1));function vt(o,t,W,F,V,I){var k,i,d,a,n,C,l,v,f,r,T,S,R,b,h,g,$,E;const A=ue("image");return _(),B("div",Vn,[e("div",En,[Wn,e("div",jn,[o.needReverse?Co((_(),B("img",Hn,null,512)),[[A,o.direct?o.getCoinIcon((a=o.positionInfo)==null?void 0:a.token_b):o.getCoinIcon((d=o.positionInfo)==null?void 0:d.token_a)]]):Co((_(),B("img",Xn,null,512)),[[A,o.direct?o.getCoinIcon((k=o.positionInfo)==null?void 0:k.token_a):o.getCoinIcon((i=o.positionInfo)==null?void 0:i.token_b)]]),o.needReverse?(_(),B("span",Yn,c(o.direct?(r=(f=o.positionInfo)==null?void 0:f.token_b)==null?void 0:r.symbol:(S=(T=o.positionInfo)==null?void 0:T.token_a)==null?void 0:S.symbol),1)):(_(),B("span",zn,c(o.direct?(C=(n=o.positionInfo)==null?void 0:n.token_a)==null?void 0:C.symbol:(v=(l=o.positionInfo)==null?void 0:l.token_b)==null?void 0:v.symbol),1)),Gn,e("div",Zn,[e("div",{onClick:t[0]||(t[0]=Q=>o.direct=!o.direct)},Qn)])])]),e("div",xn,[e("div",ot,[et,(o.needReverse?!o.direct:o.direct)?(_(),B("div",nt,c(("addCommom"in o?o.addCommom:Z(J))(("decimalUi"in o?o.decimalUi:Z(te))((R=o.positionInfo)==null?void 0:R.price,6))),1)):(_(),B("div",tt,c(("addCommom"in o?o.addCommom:Z(J))(("decimalUi"in o?o.decimalUi:Z(te))(1/((b=o.positionInfo)==null?void 0:b.price),6))),1))]),e("div",st,[lt,it,e("div",at,[ut,e("div",null,c(((h=o.positionInfo)==null?void 0:h.minPrice)&&("sFixD"in o?o.sFixD:Z(lo))((g=o.positionInfo)==null?void 0:g.minPrice,6)),1)]),e("div",rt,[dt,e("div",null,c((($=o.positionInfo)==null?void 0:$.maxPrice)&&("sFixD"in o?o.sFixD:Z(lo))((E=o.positionInfo)==null?void 0:E.maxPrice,6)),1)])])])])}const $e=Uo(Un,[["render",vt],["__scopeId","data-v-5fd7732d"]]),ct=Lo({setup(){const o=No(),t=y(()=>o),W=Mo(),F=y(()=>W),V=Do(),I=w();return vo(()=>[F.value.positionInfoObj,V.params.id],([i,d])=>{console.log(i,"##positionInfoObj"),i&&!Oo(i)&&d&&(I.value=i[d],console.log(I.value,"##positionInfo.value"))},{immediate:!0,deep:!0}),{needReverse:y(()=>{var i;return(i=I.value)==null?void 0:i.needReverse}),positionInfo:I,getCoinIcon:i=>{var d;return console.log(i,"info##"),(i==null?void 0:i.logoURI)||(i==null?void 0:i.logo_url)||((d=t.value.tokensObj[i==null?void 0:i.address])==null?void 0:d.logo_url)||zo("/image/coins/sui-unknown.png")},addCommom:J}}});const mt=o=>(Yo("data-v-faf2f95d"),o=o(),Go(),o),pt={class:"pool-composition"},ft=mt(()=>e("div",{class:"pool-composition-top"},"Pool Composition",-1)),_t={class:"pool-composition-bottom"},yt={class:"token-ratio"},bt={class:"before-coin"},gt={alt:""},kt={class:"after-coin"},ht={alt:""},wt={class:"token-num"},It={class:"num-box"},$t={class:"num-box"};function Ct(o,t,W,F,V,I){var k,i,d,a,n,C,l,v,f,r,T,S,R,b,h,g,$,E,Q,mo;const A=ue("image");return _(),B("div",pt,[ft,e("div",_t,[e("div",yt,[e("div",bt,[Co(e("img",gt,null,512),[[A,o.needReverse?o.getCoinIcon((i=o.positionInfo)==null?void 0:i.token_b):o.getCoinIcon((k=o.positionInfo)==null?void 0:k.token_a)]]),e("span",null,c((d=o.positionInfo)==null?void 0:d.poolCoinARatio)+"%",1)]),e("div",kt,[e("span",null,c((a=o.positionInfo)==null?void 0:a.poolCoinBRatio)+"%",1),Co(e("img",ht,null,512),[[A,o.needReverse?o.getCoinIcon((C=o.positionInfo)==null?void 0:C.token_a):o.getCoinIcon((n=o.positionInfo)==null?void 0:n.token_b)]])])]),e("div",wt,[e("div",{class:"token-a-bg",style:de({width:`${(l=o.positionInfo)==null?void 0:l.poolCoinARatio}%`})},null,4),e("div",{class:"token-b-bg",style:de({width:`${(v=o.positionInfo)==null?void 0:v.poolCoinBRatio}%`})},null,4),e("div",It,[e("div",null,c(("addCommom"in o?o.addCommom:Z(J))((f=o.positionInfo)==null?void 0:f.poolCoinANum))+" "+c(o.needReverse?(R=(S=o.positionInfo)==null?void 0:S.token_b)==null?void 0:R.symbol:(T=(r=o.positionInfo)==null?void 0:r.token_a)==null?void 0:T.symbol),1),e("div",null,"$"+c(("addCommom"in o?o.addCommom:Z(J))((b=o.positionInfo)==null?void 0:b.poolCoinBUSD)),1)]),e("div",$t,[e("div",null,c(("addCommom"in o?o.addCommom:Z(J))((h=o.positionInfo)==null?void 0:h.poolCoinBNum))+" "+c(o.needReverse?(Q=(E=o.positionInfo)==null?void 0:E.token_a)==null?void 0:Q.symbol:($=(g=o.positionInfo)==null?void 0:g.token_b)==null?void 0:$.symbol),1),e("div",null,"$"+c(("addCommom"in o?o.addCommom:Z(J))((mo=o.positionInfo)==null?void 0:mo.poolCoinBUSD)),1)])])])])}const Ce=Uo(ct,[["render",Ct],["__scopeId","data-v-faf2f95d"]]),At=Lo({setup(){const o=No(),t=y(()=>o),W=Mo(),F=y(()=>W),V=Do(),I=w();return vo(()=>[F.value.positionInfoObj,V.params.id],([i,d])=>{console.log(i,"##positionInfoObj"),i&&!Oo(i)&&d&&(I.value=i[d],console.log(I.value,"##positionInfo.value"))},{immediate:!0,deep:!0}),{needReverse:y(()=>{var i;return(i=I.value)==null?void 0:i.needReverse}),positionInfo:I,getCoinIcon:i=>{var d;return console.log(i,"info##"),(i==null?void 0:i.logoURI)||(i==null?void 0:i.logo_url)||((d=t.value.tokensObj[i==null?void 0:i.address])==null?void 0:d.logo_url)||zo("/image/coins/sui-unknown.png")}}}});const xo=o=>(Yo("data-v-96161b2a"),o=o(),Go(),o),St={class:"my-liquidity"},Pt={class:"my-liquidity-top"},Tt=xo(()=>e("div",null,"My Liquidity",-1)),Rt=xo(()=>e("p",null,"My share of pool",-1)),qt={class:"my-liquidity-bottom"},Bt={class:"lp-token"},Ot=xo(()=>e("div",null,[e("span",null,"LP Token Balance")],-1)),Nt={class:"token-num-content"},Mt={class:"token-num"},Lt={class:"logo"},Dt=["src"],Ut={class:"text"},Ft={class:"lp-logo"},Vt=["src"],Et=xo(()=>e("div",null,"Pooled Assets",-1)),Wt={class:"token-num"},jt={class:"logo"},Xt=["src"],Ht={class:"text"},zt=xo(()=>e("div",{class:"token-num-content-bg"},null,-1));function Yt(o,t,W,F,V,I){var A,k,i,d,a,n,C,l,v,f,r,T,S,R,b,h,g,$,E,Q;return _(),B("div",St,[e("div",Pt,[Tt,e("div",null,[Rt,e("p",null,c((A=o.positionInfo)==null?void 0:A.myShare)+"%",1)])]),e("div",qt,[e("div",Bt,[Ot,e("div",null,[e("span",null,c((k=o.positionInfo)==null?void 0:k.myLiquidity)+"LP",1),e("span",null,"$"+c((i=o.positionInfo)==null?void 0:i.myLiquidityUSD),1)])]),e("div",Nt,[e("div",Mt,[e("div",Lt,[e("img",{src:o.needReverse?o.getCoinIcon((a=o.positionInfo)==null?void 0:a.token_b):o.getCoinIcon((d=o.positionInfo)==null?void 0:d.token_a),alt:""},null,8,Dt)]),e("div",Ut,[e("div",null,c((n=o.positionInfo)==null?void 0:n.amountA)+" "+c(o.needReverse?(f=(v=o.positionInfo)==null?void 0:v.token_b)==null?void 0:f.symbol:(l=(C=o.positionInfo)==null?void 0:C.token_a)==null?void 0:l.symbol),1),e("div",null,c((r=o.positionInfo)==null?void 0:r.myAmountAUSD),1)])]),e("div",Ft,[e("img",{src:o.getCoinIcon((T=o.positionInfo)==null?void 0:T.lpInfo),alt:""},null,8,Vt),Et]),e("div",Wt,[e("div",jt,[e("img",{src:o.needReverse?o.getCoinIcon((R=o.positionInfo)==null?void 0:R.token_a):o.getCoinIcon((S=o.positionInfo)==null?void 0:S.token_b),alt:""},null,8,Xt)]),e("div",Ht,[e("div",null,c((b=o.positionInfo)==null?void 0:b.amountB)+" "+c(o.needReverse?(E=($=o.positionInfo)==null?void 0:$.token_a)==null?void 0:E.symbol:(g=(h=o.positionInfo)==null?void 0:h.token_b)==null?void 0:g.symbol),1),e("div",null,c((Q=o.positionInfo)==null?void 0:Q.myAmountBUSD),1)])]),zt])])])}const Ae=Uo(At,[["render",Yt],["__scopeId","data-v-96161b2a"]]),Gt=Lo({components:{AutoPoolAddModal:he},setup(){const o=pe(),t=w(!1),W=se(),F=y(()=>W),V=y(()=>F.value.chainName),I=y(()=>o),A=Mo(),k=y(()=>A),i=No(),d=y(()=>i),a=w(),n=Do();vo(()=>[k.value.positionInfoObj,n.params.id],([m,P])=>{m&&!Oo(m)&&P&&(a.value=m[P],console.log(a.value,"##positionInfo.value"))},{immediate:!0,deep:!0});const C=y(()=>{var m,P;return console.log((m=a.value)==null?void 0:m.needReverse,"##positionInfo.value?.needReverse"),(P=a.value)==null?void 0:P.needReverse}),l=w(),v=w(),f=w(),r=w(),T=w(!0),S=y(()=>I.value.assets&&l.value&&I.value.assets[l.value.address]?re(I.value.assets[l.value.address].balance,l.value.decimals):0),R=y(()=>I.value.assets&&v.value&&I.value.assets[v.value.address]?re(I.value.assets[v.value.address].balance,v.value.decimals):0),b=m=>{m==="fromCoin"?(T.value=!0,f.value=S.value>0?l.value.symbol=="SUI"?new u(Number(S.value)).sub(new u(.05)).lt(new u(0))?"0":new u(Number(S.value)).sub(new u(.05)).toString():String(S.value):""):(T.value=!1,r.value=R.value>0?v.value.symbol=="SUI"?new u(Number(R.value)).sub(new u(.05)).lt(new u(0))?"0":new u(Number(R.value)).sub(new u(.05)).toString():String(R.value):"")},h=m=>{m==="fromCoin"?(T.value=!0,f.value=S.value>0?lo(new u(Number(S.value)).div(2).toString(),l.value.decimals).toString():""):(T.value=!1,r.value=R.value>0?lo(new u(Number(R.value)).div(2).toString(),v.value.decimals).toString():"")},g=y(()=>V.value?me(V.value):{}),$=y(()=>F.value.slippage),E=w("--"),Q=w("--"),mo=m=>{const P=new u(a.value.autoPoolPositionInfo.liquidity),j=new u(m.toString());if(P.toNumber()>0&&j.toNumber()>0){const L=j.add(P);console.log("totalLiquidity:",j.div(L).mul(100).toString());const to=j.div(L).mul(100).toNumber(),z=Te(to),so=z==-1?2:z+2,uo=lo(j.div(L).mul(100).toNumber(),so);console.log(a.value.decimals,"##positionInfo.value.decimal");const s=new u(1).div(new u(Math.pow(10,a.value.lpInfo.decimals))).toString();console.log(uo,s,"###288"),Number(uo)<Number(s)?E.value=`<${s}`:E.value=uo}else j.toNumber()>0&&P.toNumber()<=0?E.value="100":E.value="--"},x=m=>{const P=new u(m.toString());console.log(m.toString(),"##liquidityAmount.toString()");const j=P.mul(new u($.value).div(100)),L=new u(Math.pow(10,a.value.lpInfo.decimals));console.log(P.minus(j).div(L).toString(),"##liquidity.minus(minimum).div(decimals).toString()"),Q.value=lo(P.minus(j).div(L).toString(),a.value.lpInfo.decimals)},po=w(!1),bo=w(!1),Ao=w(""),go=w(),ko=async()=>{if(!a.value)return;const m=a.value.autoPoolPositionInfo.tick_lower_index,P=a.value.autoPoolPositionInfo.tick_upper_index,j=Xo.sqrtPriceX64ToTickIndex(new U(a.value.current_sqrt_price));j<m&&(C.value?po.value=!0:bo.value=!0),j>P&&(C.value?bo.value=!0:po.value=!0);let L;if(console.log(f.value||r.value,"#fromCoinAmount.value || toCoinAmount.value"),f.value||r.value){T.value?L=new u(f.value).mul(Math.pow(10,l.value.decimals)).toString():L=new u(r.value).mul(Math.pow(10,v.value.decimals)).toString();let to,z=T.value;if(console.log("执行##"),oo.value||io.value){const p=await Eo.calculateDepositSwapAmount({lowerTick:m,upperTick:P,curSqrtPrice:new U(a.value.current_sqrt_price),fix_amount_a:z,input_amount:L,coinTypeA:a.value.autoPoolPositionInfo.coin_type_a,coinTypeB:a.value.autoPoolPositionInfo.coin_type_b,clmm_pool:a.value.address});if(console.log(p,"###swapResult"),p){to=new U(p.afterSqrtPrice),L=new U(p.swapOutAmount),to=a.value.current_sqrt_price,go.value={swap_amount:p.swapInAmount,a2b:z},z=!z;const X=a.value.token_a.decimals,O=a.value.token_b.decimals,M=new u(p.swapInAmount).div(new u(Math.pow(10,X))).toString(),q=new u(p.swapOutAmount).div(new u(Math.pow(10,O))).toString(),H=C.value?a.value.token_b.symbol:a.value.token_a.symbol,D=C.value?a.value.token_a.symbol:a.value.token_b.symbol;Ao.value=`To deposit ${oo.value?f.value:r.value} ${oo.value?H:D}, 
          ${M} ${oo.value?H:D}  will be traded for ${q} ${oo.value?D:H} added to the pool.`}else to=a.value.current_sqrt_price,L=new U(L)}else to=a.value.current_sqrt_price,L=new U(L);console.log(go,"##swapParams");const{liquidityAmount:so,tokenMaxA:uo,tokenMaxB:s}=g.value.estLiquidityAndcoinAmountFromOneAmounts({tokenA:l.value,tokenB:v.value,lowerTick:m,upperTick:P,coinAmount:L,iscoinA:z,roundUp:!0,slippage:Number($.value)/100,curSqrtPrice:new U(to)});console.log(a.value.current_sqrt_price,"##positionInfo.value.current_sqrt_price"),console.log(s.toString(),uo.toString(),a.value,"###323"),!oo.value&&!io.value&&(T.value?r.value=Number(s)>0?s:"":f.value=Number(uo)>0?uo:""),mo(so),x(so)}};vo(()=>a.value,m=>{m&&!Oo(m)&&(l.value=m==null?void 0:m.token_a,v.value=m==null?void 0:m.token_b,po.value=!1,bo.value=!1,ko())},{immediate:!0});const ro=y(()=>d.value.RATES),ho=y(()=>{var m,P,j,L,to,z,so,uo,s,p;if((P=ro.value[(m=l.value)==null?void 0:m.address])!=null&&P.price&&((L=ro.value[(j=v.value)==null?void 0:j.address])!=null&&L.price)){console.log((z=ro.value[(to=l.value)==null?void 0:to.address])==null?void 0:z.price,"RATES.value[fromCoin.value?.address]?.price");const X=new u(f.value||0).mul(new u((uo=ro.value[(so=l.value)==null?void 0:so.address])==null?void 0:uo.price)),O=new u(r.value||0).mul(new u((p=ro.value[(s=v.value)==null?void 0:s.address])==null?void 0:p.price));return te(X.add(O).toString(),2)}else return"--"});vo(()=>f.value,(m,P)=>{m?ko():(E.value="--",r.value="",Q.value="--")},{immediate:!0}),vo(()=>r.value,(m,P)=>{m?ko():(f.value="",E.value="--",Q.value="--")},{immediate:!0});const{t:fo,locale:N}=_e(),no=y(()=>{const m=Number(f.value)>Number(S.value),P=Number(r.value)>Number(R.value);return!f.value&&!r.value?fo("button.enterAmount"):m?fo("button.insufficientBalance",{name:l.value.symbol}):P?fo("button.insufficientBalance",{name:v.value.symbol}):"Add Liquidity"}),Fo=y(()=>{const m=Number(f.value)>Number(S.value),P=Number(r.value)>Number(R.value);return!!(!f.value&&!r.value||m||P||f.value<=0&&r.value<=0)}),_o=w(!0),{setIsShowSuccess:Vo,setIsShowRejected:So,setIsShowWaiting:yo,setTransactionDesc:wo,setTransactionTxid:Po,setPositiomNum:To}=W,Eo=fe("Sui"),Wo=async()=>{var uo,s;t.value=!1,_o.value=!0,Po("");const m=`${J(f.value)} ${(uo=l.value)==null?void 0:uo.symbol}`,P=`${J(r.value)} ${(s=v.value)==null?void 0:s.symbol}`;wo(`Deposit ${f.value>0?m:""} ${r.value>0&&f.value>0?"and":""} ${r.value>0?P:""}`),yo(!0);const j=T.value,L=a.value.autoPoolPositionInfo.tick_lower_index,to=a.value.autoPoolPositionInfo.tick_upper_index;let z;T.value?z=new u(f.value).mul(Math.pow(10,l.value.decimals)).toString():z=new u(r.value).mul(Math.pow(10,v.value.decimals)).toString();const so=a.value.rewarderInfo.map(p=>p.coinAddress);try{const p={lowerTick:L,upperTick:to,coinAmount:z,fix_amount_a:j,slippage:Number($.value)/100,curSqrtPrice:new U(a.value.current_sqrt_price),id:a.value.id,clmm_pool:a.value.autoPoolPositionInfo.pool,lp_token_type:a.value.lp_token_type,coinTypeA:a.value.autoPoolPositionInfo.coin_type_a,coinTypeB:a.value.autoPoolPositionInfo.coin_type_b,rewarder_coin_types:so,swapParams:go.value,isOnlyA:oo.value,isOnlyB:io.value},X=await Eo.deposit(p);console.log(X,"===>payloadAdd11111");const O=await I.value.currentWallet.signAndExecuteTransactionBlock(X);let M=g.value.handleTx(O);if(console.log("toAdd###tx###",M),M&&M.hash){Po(M.hash),yo(!1),Vo(!0),console.log(a,"===>positionInfo");const q={title:"Supplied",desc:`Deposit ${f.value>0?m:""} ${r.value>0&&f.value>0?"and":""} ${r.value>0?P:""}`,hash:M.hash,tit:"Liquidity Increased",icon:"icon-icon-Increased",text:`Deposit ${f.value>0?m:""} ${r.value>0&&f.value>0?"and":""} ${r.value>0?P:""}`};V.value!=="Aptos"&&(q.res=M.res),g.value.showTransitionPending(q),await g.value.watchTransaction(q)&&setTimeout(()=>{A.updatePositionItem(a.value.id),g.value.getAccount(I.value.address)},1e3),To()}else yo(!1),So(!0);f.value="",r.value="",_o.value=!1}catch(p){f.value="",r.value="",console.log("addError###",p),_o.value=!1,yo(!1),So(!0)}},oo=w(!1),io=w(!1);return{wallet:I,positionInfo:a,isShowAddModal:t,needReverse:C,fromCoin:l,toCoin:v,fromCoinAmount:f,toCoinAmount:r,fromCoinBlance:S,toCoinBlance:R,fixedFromCoin:T,maxBtnSelect:b,halfBtnSelect:h,totalAmountUSD:ho,addCommom:J,shareOfPool:E,minimumReceivedLP:Q,addLiquidityBtnText:no,addLiquidityBtnDisabled:Fo,toAdd:Wo,showToCoinLock:bo,showFromCoinLock:po,isOnlyA:oo,isOnlyB:io,onlyToken:m=>{f.value="",r.value="",m=="only-a"?(oo.value=!oo.value,io.value=!1):(io.value=!io.value,oo.value=!1)},onlyText:Ao}}});const Zo=o=>(Yo("data-v-7d3c586a"),o=o(),Go(),o),Zt={class:"auto-pool-add"},Jt={class:"auto-pool-add-content"},Kt={class:"liquidity-action-tab"},Qt=Zo(()=>e("div",{class:"increase tab-active"},"Add",-1)),xt={class:"only-token"},os=Zo(()=>e("div",null,"Deposit Amounts",-1)),es={key:0},ns={key:0},ts={key:0,class:"card-item"},ss={key:1,class:"card-item"},ls=Zo(()=>e("span",null,"Pool Closed",-1)),is={class:"add-info"},as={key:0,class:"only-text"},us={class:"total-amount"},rs=Zo(()=>e("span",null,"Total Amount",-1)),ds={class:"total-amount"},vs=Zo(()=>e("span",null,"Share of Pool",-1)),cs={class:"total-amount"},ms=Zo(()=>e("span",null,"Minimum Received LP",-1));function ps(o,t,W,F,V,I){var a,n,C,l,v,f,r,T,S,R,b,h,g;const A=ge,k=ke,i=be,d=he;return _(),B("div",Zt,[e("div",Jt,[e("div",Kt,[Qt,e("div",{class:"remove",onClick:t[0]||(t[0]=ye($=>o.$emit("changeCurrentTab"),["stop"]))},"Remove")]),e("div",xt,[os,e("div",null,[e("div",{class:"only-a",onClick:t[1]||(t[1]=$=>o.onlyToken("only-a"))},[e("p",null,[o.isOnlyA?(_(),B("span",es)):eo("",!0)]),e("span",null,c(o.needReverse?(l=(C=o.positionInfo)==null?void 0:C.token_b)==null?void 0:l.symbol:(n=(a=o.positionInfo)==null?void 0:a.token_a)==null?void 0:n.symbol)+" only",1)]),e("div",{class:"only-b",onClick:t[2]||(t[2]=$=>o.onlyToken("only-b"))},[e("p",null,[o.isOnlyB?(_(),B("span",ns)):eo("",!0)]),e("span",null,c(o.needReverse?(T=(r=o.positionInfo)==null?void 0:r.token_a)==null?void 0:T.symbol:(f=(v=o.positionInfo)==null?void 0:v.token_b)==null?void 0:f.symbol)+" only",1)])])]),e("div",{class:ae(o.needReverse?"card-container reverse":"card-container")},[(o.needReverse?!o.isOnlyA:!o.isOnlyB)?(_(),B("div",ts,[K(A,{modelValue:o.fromCoinAmount,"onUpdate:modelValue":t[3]||(t[3]=$=>o.fromCoinAmount=$),"input-value":o.fromCoinAmount,"coin-symbol":o.fromCoin?o.fromCoin.symbol:null,"coin-name":o.fromCoin?o.fromCoin.name:null,balance:o.fromCoinBlance,"coin-icon":o.fromCoin?o.fromCoin.logoURI:"",address:o.fromCoin?o.fromCoin.address:"","swap-direct":"From","import-page":"deposit","has-arrow":!1,onOnMax:t[4]||(t[4]=$=>o.maxBtnSelect("fromCoin")),onOnHalf:t[5]||(t[5]=$=>o.halfBtnSelect("fromCoin")),onOnInput:t[6]||(t[6]=$=>{o.fromCoinAmount=$}),onOnFocus:t[7]||(t[7]=()=>{o.fixedFromCoin=!0})},null,8,["modelValue","input-value","coin-symbol","coin-name","balance","coin-icon","address"]),o.showFromCoinLock?(_(),ao(k,{key:0})):eo("",!0)])):eo("",!0),(o.needReverse?!o.isOnlyB:!o.isOnlyA)?(_(),B("div",ss,[K(A,{modelValue:o.toCoinAmount,"onUpdate:modelValue":t[8]||(t[8]=$=>o.toCoinAmount=$),"input-value":o.toCoinAmount,"coin-symbol":o.toCoin?o.toCoin.symbol:null,"coin-name":o.toCoin?o.toCoin.name:null,balance:o.toCoinBlance,"swap-direct":"To","coin-icon":o.toCoin?o.toCoin.logoURI:"",address:o.toCoin?o.toCoin.address:"","import-page":"deposit","has-arrow":!1,onOnMax:t[9]||(t[9]=$=>o.maxBtnSelect("toCoin")),onOnHalf:t[10]||(t[10]=$=>o.halfBtnSelect("toCoin")),onOnInput:t[11]||(t[11]=$=>{o.toCoinAmount=$}),onOnFocus:t[12]||(t[12]=()=>{o.fixedFromCoin=!1})},null,8,["modelValue","input-value","coin-symbol","coin-name","balance","coin-icon","address"]),o.showToCoinLock?(_(),ao(k,{key:0})):eo("",!0)])):eo("",!0)],2)]),(S=o.positionInfo)!=null&&S.is_pause?(_(),ao(i,{key:0,class:"big-btn liquidity-btn",disabled:!0},{default:Ho(()=>[ls]),_:1})):o.wallet.connected?(_(),ao(i,{key:1,class:"big-btn liquidity-btn",disabled:o.addLiquidityBtnDisabled,onClick:t[13]||(t[13]=$=>o.isShowAddModal=!0)},{default:Ho(()=>[e("span",null,c(o.addLiquidityBtnText),1)]),_:1},8,["disabled"])):(_(),ao(i,{key:2,class:"big-btn",onClick:t[14]||(t[14]=$=>o.wallet.setIsShowWalletModal(!0))},{default:Ho(()=>[e("span",null,c(o.$t("button.connectWallet")),1)]),_:1})),e("div",is,[o.fromCoinAmount||o.toCoinAmount?(_(),B("div",as,c(o.onlyText),1)):eo("",!0),e("div",us,[rs,e("span",null,"$"+c(("addCommom"in o?o.addCommom:Z(J))(o.totalAmountUSD)),1)]),e("div",ds,[vs,e("span",null,c(o.shareOfPool)+"%",1)]),e("div",cs,[ms,e("span",null,c(("addCommom"in o?o.addCommom:Z(J))(o.minimumReceivedLP))+" "+c(o.needReverse?(R=o.toCoin)==null?void 0:R.symbol:(b=o.fromCoin)==null?void 0:b.symbol)+"-"+c(o.needReverse?(h=o.fromCoin)==null?void 0:h.symbol:(g=o.toCoin)==null?void 0:g.symbol),1)])]),o.isShowAddModal?(_(),ao(d,{key:3,"pool-info":o.positionInfo,"from-coin":o.needReverse?o.positionInfo.token_b:o.positionInfo.token_a,"to-coin":o.needReverse?o.positionInfo.token_a:o.positionInfo.token_b,"from-coin-amount":o.needReverse?o.toCoinAmount:o.fromCoinAmount,"to-coin-amount":o.needReverse?o.fromCoinAmount:o.toCoinAmount,"total-amount":o.totalAmountUSD,"share-of-pool":o.shareOfPool,"minimum-received-l-p":o.minimumReceivedLP,"is-only-a":o.isOnlyA,"is-only-b":o.isOnlyB,onOnClose:t[15]||(t[15]=$=>o.isShowAddModal=!1),onToAdd:o.toAdd},null,8,["pool-info","from-coin","to-coin","from-coin-amount","to-coin-amount","total-amount","share-of-pool","minimum-received-l-p","is-only-a","is-only-b","onToAdd"])):eo("",!0)])}const fs=Uo(Gt,[["render",ps],["__scopeId","data-v-7d3c586a"]]),_s=Lo({components:{AutoPoolRemoveModal:we},setup(){const o=pe(),t=y(()=>o),W=se(),F=y(()=>W),V=y(()=>F.value.slippage),I=y(()=>F.value.chainName),A=[{name:"25%",value:25},{name:"50%",value:50},{name:"75%",value:75},{name:"MAX",value:100}],k=w(25),i=Do(),d=Mo(),a=y(()=>d),n=y(()=>(console.log(a.value.positionInfoObj[i.params.id],"autoPool.value.positionInfoObj[route.params.id]###"),a.value.positionInfoObj[i.params.id])),C=y(()=>{var s;return(s=n.value)==null?void 0:s.needReverse}),l=w(),v=w(),f=w(!1),r=w(),T=y(()=>{var s;return(s=n.value)==null?void 0:s.myLiquidity}),S=w(!0),R=y(()=>I.value?me(I.value):{}),b=fe("Sui"),h=w(""),g=w(""),$=w("--"),E=w(!1),Q=w(!1),mo=w(),x=w(!0),po=w(),bo=No(),Ao=y(()=>bo),go=y(()=>Ao.value.RATES),ko=async()=>{if(S.value||!n.value)return;const s=n.value.autoPoolPositionInfo.tick_lower_index,p=n.value.autoPoolPositionInfo.tick_upper_index,X=Xo.sqrtPriceX64ToTickIndex(new U(n.value.current_sqrt_price));X<s&&(C.value?E.value=!0:Q.value=!0),X>p&&(C.value?Q.value=!0:E.value=!0);let O;if(console.log(h.value||g.value,"#fromCoinAmount.value || toCoinAmount.value"),h.value||g.value){x.value?O=new u(h.value).mul(Math.pow(10,l.value.decimals)).toString():O=new u(g.value).mul(Math.pow(10,v.value.decimals)).toString();let M,q=x.value;if(console.log("执行##"),N.value||no.value){const G=await b.calculateRemoveSwapAmount({lowerTick:s,upperTick:p,curSqrtPrice:new U(n.value.current_sqrt_price),fix_amount_a:q,receiveAmount:O,coinTypeA:n.value.autoPoolPositionInfo.coin_type_a,coinTypeB:n.value.autoPoolPositionInfo.coin_type_b,clmm_pool:n.value.address});if(console.log(G,"###swapResult"),G){M=new U(G.afterSqrtPrice),O=new U(G.swapOutAmount),M=n.value.current_sqrt_price,mo.value={swap_amount:G.swapInAmount,liquidity:G.liquidity,a2b:!q},q=!q;const qo=n.value.token_a.decimals,Bo=n.value.token_b.decimals,$o=new u(G.swapInAmount).div(new u(Math.pow(10,qo))).toString(),Ko=new u(G.swapOutAmount).div(new u(Math.pow(10,Bo))).toString(),ee=C.value?n.value.token_b.symbol:n.value.token_a.symbol,le=C.value?n.value.token_a.symbol:n.value.token_b.symbol;po.value=`To withdraw ${N.value?h.value:g.value} ${N.value?ee:le}, 
          ${$o} ${N.value?ee:le}  in the pool will be traded for ${Ko} ${N.value?le:ee} added to the pool.`}else M=n.value.current_sqrt_price,O=new U(O)}else M=n.value.current_sqrt_price,O=new U(O);console.log("执行了吗##");const{liquidityAmount:H,tokenMaxA:D,tokenMaxB:Y}=R.value.estLiquidityAndcoinAmountFromOneAmounts({tokenA:l.value,tokenB:v.value,lowerTick:s,upperTick:p,coinAmount:O,iscoinA:q,roundUp:!1,slippage:Number(V.value)/100,curSqrtPrice:new U(M)});console.log(n.value.current_sqrt_price,"##positionInfo.value.current_sqrt_price"),console.log(Y.toString(),D.toString(),n.value,"###323"),!N.value&&!no.value&&(x.value?g.value=Number(Y)>0?Y:"":h.value=Number(D)>0?D:"");const Ro=ie.get_lp_amount_by_liquidity({liquidity:n.value.liquidity,total_supply:n.value.total_supply},H.toString());r.value=new u(Ro).div(new u(Math.pow(10,n.value.lpInfo.decimals))).toString();const jo=new u(r.value).div(new u(T.value)).mul(100);$.value=Ro,ro.value=H.toString(),k.value=jo.toNumber()}},ro=w(),ho=y(()=>{var s;return(s=n==null?void 0:n.value)==null?void 0:s.amountA}),fo=y(()=>{var s;return(s=n==null?void 0:n.value)==null?void 0:s.amountB}),N=w(!1),no=w(!1),Fo=y(()=>{var O,M,q,H;const s=(M=go.value[(O=l==null?void 0:l.value)==null?void 0:O.address])==null?void 0:M.price,p=(H=go.value[(q=l==null?void 0:l.value)==null?void 0:q.address])==null?void 0:H.price;let X;return s&&p&&(N.value||no.value?X=new u(N.value?h.value:g.value).mul(new u(N.value?s:p)).toString():X=new u(h.value).mul(new u(s)).add(new u(g.value).mul(new u(p))).toString()),X>0&&X<.01?"<$0.01":`$${J(lo(X,2))}`}),_o=async s=>{if(!S.value)return;S.value=!0,n.value.token_a.decimals,n.value.token_b.decimals;const p=n.value.tick_lower_index,X=n.value.tick_upper_index;Xo.tickIndexToSqrtPriceX64(p),Xo.tickIndexToSqrtPriceX64(X);let O="",M,q;console.log(s.value,"##item.value"),console.log(q,"##coinAmount");let H=x.value;if(console.log("执行##"),N.value||no.value){if(N.value){const Y=new u(so.value).mul(Math.pow(10,l.value.decimals)).mul(s.value).toString();console.log(Y,"##amount"),q=lo(Y,0),h.value=new u(so.value).mul(s.value).toString()}if(no.value){const Y=new u(so.value).mul(s.value).mul(Math.pow(10,v.value.decimals)).toString();q=lo(Y,0),g.value=new u(so.value).mul(s.value).toString()}const D=await b.calculateRemoveSwapAmount({lowerTick:p,upperTick:X,curSqrtPrice:new U(n.value.current_sqrt_price),fix_amount_a:H,receiveAmount:q,coinTypeA:n.value.autoPoolPositionInfo.coin_type_a,coinTypeB:n.value.autoPoolPositionInfo.coin_type_b,clmm_pool:n.value.address});if(console.log(D,"###swapResult"),D){new U(D.afterSqrtPrice),q=new U(D.swapOutAmount),n.value.current_sqrt_price,mo.value={swap_amount:D.swapInAmount,liquidity:D.liquidity,a2b:!H},H=!H;const Y=n.value.token_a.decimals,Ro=n.value.token_b.decimals,jo=new u(D.swapInAmount).div(new u(Math.pow(10,Y))).toString(),G=new u(D.swapOutAmount).div(new u(Math.pow(10,Ro))).toString(),qo=C.value?n.value.token_b.symbol:n.value.token_a.symbol,Bo=C.value?n.value.token_a.symbol:n.value.token_b.symbol;po.value=`To withdraw ${N.value?h.value:g.value} ${N.value?qo:Bo}, 
          ${jo} ${N.value?qo:Bo}  in the pool will be traded for ${G} ${N.value?Bo:qo} added to the pool.`,O=D.liquidity}else n.value.current_sqrt_price,q=new U(q);$.value=ie.get_lp_amount_by_liquidity({liquidity:n.value.liquidity,total_supply:n.value.total_supply},O),r.value=new u($.value).div(Math.pow(10,n.value.lpInfo.decimals)),ro.value=O}else{const D=new u(ho.value).mul(Math.pow(10,l.value.decimals)).mul(s.value).toString();q=lo(D,0),h.value=new u(ho.value).mul(s.value).toString();const Y=new u(fo.value).mul(s.value).mul(Math.pow(10,v.value.decimals)).toString();q=lo(Y,0),g.value=new u(fo.value).mul(s.value).toString(),n.value.current_sqrt_price,q=new U(q),s.value!==1?M=new u(n.value.myLiquidity).mul(Math.pow(10,n.value.lpInfo.decimals)).mul(s.value).toString():M=new u(n.value.myLiquidity).mul(Math.pow(10,n.value.lpInfo.decimals)).toString(),r.value=new u(M).div(Math.pow(10,n.value.lpInfo.decimals)),O=ie.get_share_liquidity_by_amount({liquidity:n.value.liquidity,total_supply:n.value.total_supply},M),$.value=lo(M,0),ro.value=lo(O,0)}};vo(k,Re((s,p)=>{s!==p&&(Number(s)>100?k.value=100:s&&n.value?(console.log("687===>"),k.value=s,_o({value:k.value/100})):(h.value="--",g.value="--"))},300)),vo(()=>h.value,(s,p)=>{s?ko():g.value=""},{immediate:!0}),vo(()=>g.value,(s,p)=>{s?ko():h.value=""},{immediate:!0});const Vo=qe(),{setIsShowSuccess:So,setIsShowRejected:yo,setIsShowWaiting:wo,setTransactionDesc:Po,setTransactionTxid:To,setPositiomNum:Eo,setTransactionDescText:Wo}=W,oo=w(!1),{t:io}=_e(),Jo=async()=>{var Ro,jo;oo.value=!0,To("");const s=Number(h.value)>0?`${J(h.value,l.value.decimals)} ${l.value.symbol}`:"",p=Number(g.value)>0?`${J(g.value,v.value.decimals)} ${v.value.symbol}`:"";console.log(s,p,"###transactionDescTo"),Po(io("tips.removeLiquidiyText",{from:C.value?p:s,and:Number(h.value)>0&&Number(g.value)>0?"and":"",to:C.value?s:p})),wo(!0);const X=io("modal.removeLiquidityText2");Wo(X);const O=n.value.autoPoolPositionInfo.tick_lower_index,M=n.value.autoPoolPositionInfo.tick_upper_index,q=Xo.tickIndexToSqrtPriceX64(O),H=Xo.tickIndexToSqrtPriceX64(M),D=n.value.rewarderInfo.map(G=>G.coinAddress);console.log(ro.value,$.value,"##liquidityVal.value");let Y;x.value?Y=new u(h.value).mul(Math.pow(10,l.value.decimals)).toString():Y=new u(g.value).mul(Math.pow(10,v.value.decimals)).toString();try{const G={lowerSqrtPrice:q,upperSqrtPrice:H,lpTokenAmount:new U($.value),liquidity:new U(ro.value),curSqrtPrice:new U(n.value.object.current_sqrt_price),slippage:Number(V.value)/100,id:n.value.id,clmm_pool:n.value.autoPoolPositionInfo.pool,lp_token_type:n.value.lp_token_type,coinTypeA:n.value.autoPoolPositionInfo.coin_type_a,coinTypeB:n.value.autoPoolPositionInfo.coin_type_b,rewarder_coin_types:D,swapParams:mo.value,fix_amount_a:x.value,isOnlyA:N.value,isOnlyB:no.value,lowerTick:O,upperTick:M,receiveAmount:Y},qo=await b.remove(G),Bo=await t.value.currentWallet.signAndExecuteTransactionBlock(qo);let $o=R.value.handleTx(Bo);if(console.log("0331###remove###tx####",$o),$o&&$o.hash){To($o.hash),wo(!1),So(!0);const Ko={title:io("common.removeLiquidity"),desc:"",hash:$o.hash,descTransactions:`Remove ${s} ${Number(h.value)>0&&Number(g.value)>0?"and":""} ${p} from the pool`,sender:t.value.address,chainName:"Sui",tit:"Liquidity Removed",icon:"icon-icon-Removed",text:`Withdraw ${h.value} ${(Ro=l.value)==null?void 0:Ro.symbol} and ${g.value} ${(jo=v.value)==null?void 0:jo.symbol}`};Ko.res=$o.res,R.value.showTransitionPending(Ko),await R.value.watchTransaction(Ko)&&(h.value="",g.value="",r.value="",k.value=0,setTimeout(()=>{d.updatePositionItem(n.value.id),R.value.getAccount(t.value.address)},1e3),Number(k.value)==100&&i.name=="auto-pool-detail"&&Vo.push("/pool/auto"))}else wo(!1),yo(!0);oo.value=!1}catch(G){console.log("Remove error",G),oo.value=!1,wo(!1),yo(!0)}};vo(()=>n.value,(s,p)=>{s&&!Oo(s)&&(l.value=s==null?void 0:s.token_a,v.value=s==null?void 0:s.token_b,console.log("触发###"),(!p||p&&p.address!==s.address)&&_o({value:k.value/100}))},{immediate:!0});const m=y(()=>{const s=Number(r.value)>Number(T.value);return!r.value||r.value<=0?io("button.enterAmount"):s?"Invalid Amount":io("button.remove")}),P=y(()=>{const s=Number(r.value)>Number(T.value);return!!(!r.value||r.value<=0||s)}),j=s=>(s==null?void 0:s.logoURI)||(s==null?void 0:s.logo_url)||zo("/image/coins/sui-unknown.png"),L=s=>{h.value="",g.value="",S.value=!0,s=="only-a"?(N.value=!N.value,no.value=!1,x.value=!0):(no.value=!no.value,N.value=!1,x.value=!1)},to=s=>{S.value=!0,k.value=100,s==="fromCoin"?x.value=!0:x.value=!1},z=s=>{S.value=!0,k.value=50,s==="fromCoin"?x.value=!0:x.value=!1},so=w(),uo=async()=>{const s=n.value.autoPoolPositionInfo.tick_lower_index,p=n.value.autoPoolPositionInfo.tick_upper_index,X=!1,O=n.value.token_a.decimals,M=n.value.token_b.decimals,q=new u(ho.value).mul(new u(Math.pow(10,O))).toString(),H=new u(fo.value).mul(new u(Math.pow(10,M))).toString(),D=N.value?H:q;if(console.log(D,"##receiveAmount"),N.value||no.value){const Y=await b.calculateRemoveSwapAmount({lowerTick:s,upperTick:p,curSqrtPrice:new U(n.value.current_sqrt_price),fix_amount_a:X,receiveAmount:D,coinTypeA:n.value.autoPoolPositionInfo.coin_type_a,coinTypeB:n.value.autoPoolPositionInfo.coin_type_b,clmm_pool:n.value.address});console.log(Y.swapOutAmount,q,H,"775##"),so.value=new u(Y.swapOutAmount).add(new u(N.value?q:H)).div(new u(Math.pow(10,N.value?O:M))).toString(),console.log(Y,"##swapResult"),_o({value:.25}),console.log(so.value,"onlyTokenBalance##")}};return vo(()=>[N.value,no.value,h.value,g.value],([s,p])=>{(s||p)&&uo()},{immediate:!0}),{removeLiquidityBtnText:m,removeLiquidityBtnDisabled:P,wallet:t,ratioArr:A,positionInfo:n,isShowRemoveModal:f,needReverse:C,fromCoin:l,toCoin:v,lpAmount:r,lpBalance:T,sliderVal:k,sFixD:lo,isSlider:S,fromCoinAmount:h,toCoinAmount:g,setPercent:_o,toRemove:Jo,addCommom:J,getCoinIcon:j,isOnlyA:N,isOnlyB:no,onlyToken:L,fixedFromCoin:x,maxBtnSelect:to,halfBtnSelect:z,fromCoinBlance:ho,toCoinBlance:fo,showFromCoinLock:E,showToCoinLock:Q,removeText:po,onlyTokenBalance:so,totalWithdraw:Fo}}});const oe=o=>(Yo("data-v-4b010ba5"),o=o(),Go(),o),ys={class:"auto-pool-add"},bs={class:"auto-pool-add-content"},gs={class:"liquidity-action-tab"},ks=oe(()=>e("div",{class:"remove tab-active"},"Remove",-1)),hs={class:"only-token"},ws=oe(()=>e("div",null,"Deposit Amounts",-1)),Is={key:0},$s={key:0},Cs={key:0,class:"card-item"},As={key:1,class:"card-item"},Ss={class:"remove-ratio"},Ps={class:"remove-ratio-select"},Ts={key:0,class:"ratio"},Rs={key:1,class:"ratio"},qs={class:"ratio-list"},Bs=["onClick"],Os=oe(()=>e("span",null,"Pool Closed",-1)),Ns={class:"remove-info"},Ms={key:0,class:"remove-text"},Ls={class:"total-amount"},Ds=oe(()=>e("span",null,"Total Withdraw",-1)),Us={class:"total-amount"},Fs=oe(()=>e("span",null,"LP Burn Amount",-1)),Vs={key:0},Es={key:1};function Ws(o,t,W,F,V,I){var n,C,l,v,f,r,T,S,R;const A=ge,k=ke,i=Ne,d=be,a=we;return _(),B("div",ys,[e("div",bs,[e("div",gs,[e("div",{class:"increase",onClick:t[0]||(t[0]=ye(b=>o.$emit("changeCurrentTab"),["stop"]))},"Add"),ks]),e("div",hs,[ws,e("div",null,[e("div",{class:"only-a",onClick:t[1]||(t[1]=b=>o.onlyToken("only-a"))},[e("p",null,[o.isOnlyA?(_(),B("span",Is)):eo("",!0)]),e("span",null,c(o.needReverse?(v=(l=o.positionInfo)==null?void 0:l.token_b)==null?void 0:v.symbol:(C=(n=o.positionInfo)==null?void 0:n.token_a)==null?void 0:C.symbol)+" only",1)]),e("div",{class:"only-b",onClick:t[2]||(t[2]=b=>o.onlyToken("only-b"))},[e("p",null,[o.isOnlyB?(_(),B("span",$s)):eo("",!0)]),e("span",null,c(o.needReverse?(S=(T=o.positionInfo)==null?void 0:T.token_a)==null?void 0:S.symbol:(r=(f=o.positionInfo)==null?void 0:f.token_b)==null?void 0:r.symbol)+" only",1)])])]),e("div",{class:ae(o.needReverse?"card-container reverse":"card-container")},[(o.needReverse?!o.isOnlyA:!o.isOnlyB)?(_(),B("div",Cs,[K(A,{modelValue:o.fromCoinAmount,"onUpdate:modelValue":t[3]||(t[3]=b=>o.fromCoinAmount=b),"input-value":o.fromCoinAmount,"coin-symbol":o.fromCoin?o.fromCoin.symbol:null,"coin-name":o.fromCoin?o.fromCoin.name:null,balance:o.isOnlyA?o.onlyTokenBalance:o.fromCoinBlance,"coin-icon":o.fromCoin?o.fromCoin.logoURI:"",address:o.fromCoin?o.fromCoin.address:"","swap-direct":"From","import-page":"deposit","has-arrow":!1,"amount-leabl":"Available",onOnMax:t[4]||(t[4]=b=>o.maxBtnSelect("fromCoin")),onOnHalf:t[5]||(t[5]=b=>o.halfBtnSelect("fromCoin")),onOnInput:t[6]||(t[6]=b=>{o.isSlider=!1,o.fromCoinAmount=b}),onOnFocus:t[7]||(t[7]=()=>{o.isSlider=!1,o.fixedFromCoin=!0})},null,8,["modelValue","input-value","coin-symbol","coin-name","balance","coin-icon","address"]),o.showFromCoinLock?(_(),ao(k,{key:0})):eo("",!0)])):eo("",!0),(o.needReverse?!o.isOnlyB:!o.isOnlyA)?(_(),B("div",As,[K(A,{modelValue:o.toCoinAmount,"onUpdate:modelValue":t[8]||(t[8]=b=>o.toCoinAmount=b),"input-value":o.toCoinAmount,"coin-symbol":o.toCoin?o.toCoin.symbol:null,"coin-name":o.toCoin?o.toCoin.name:null,balance:o.isOnlyB?o.onlyTokenBalance:o.toCoinBlance,"swap-direct":"To","coin-icon":o.toCoin?o.toCoin.logoURI:"",address:o.toCoin?o.toCoin.address:"","import-page":"deposit","has-arrow":!1,"amount-leabl":"Available",onOnMax:t[9]||(t[9]=b=>o.maxBtnSelect("toCoin")),onOnHalf:t[10]||(t[10]=b=>o.halfBtnSelect("toCoin")),onOnInput:t[11]||(t[11]=b=>{o.isSlider=!1,o.toCoinAmount=b}),onOnFocus:t[12]||(t[12]=()=>{o.isSlider=!1,o.fixedFromCoin=!1})},null,8,["modelValue","input-value","coin-symbol","coin-name","balance","coin-icon","address"]),o.showToCoinLock?(_(),ao(k,{key:0})):eo("",!0)])):eo("",!0)],2),e("div",Ss,[e("div",Ps,[Number(o.lpBalance)>=Number(o.lpAmount)?(_(),B("div",Ts,c(o.sliderVal>0&&Number(("sFixD"in o?o.sFixD:Z(lo))(o.sliderVal,2))<.01?"<0.01":("sFixD"in o?o.sFixD:Z(lo))(o.sliderVal,2))+"% ",1)):(_(),B("div",Rs,"--")),e("div",qs,[(_(!0),B(Be,null,Oe(o.ratioArr,(b,h)=>(_(),B("div",{key:h,class:ae(["ratio-item",o.sliderVal==b.value?"ratio-item-active":""]),onClick:()=>{o.isSlider=!0,o.sliderVal=b.value}},c(b.name),11,Bs))),128))])]),K(i,{value:o.sliderVal,"onUpdate:value":t[13]||(t[13]=b=>o.sliderVal=b)},null,8,["value"])])]),(R=o.positionInfo)!=null&&R.is_pause?(_(),ao(d,{key:0,class:"big-btn liquidity-btn",disabled:!0},{default:Ho(()=>[Os]),_:1})):o.wallet.connected?(_(),ao(d,{key:1,class:"big-btn liquidity-btn",disabled:o.removeLiquidityBtnDisabled,onClick:o.toRemove},{default:Ho(()=>[e("span",null,c(o.removeLiquidityBtnText),1)]),_:1},8,["disabled","onClick"])):(_(),ao(d,{key:2,class:"big-btn",onClick:t[14]||(t[14]=b=>o.wallet.setIsShowWalletModal(!0))},{default:Ho(()=>[e("span",null,c(o.$t("button.connectWallet")),1)]),_:1})),e("div",Ns,[o.isOnlyA||o.isOnlyB?(_(),B("div",Ms,c(o.removeText),1)):eo("",!0),e("div",Ls,[Ds,e("span",null,c(o.totalWithdraw),1)]),e("div",Us,[Fs,o.fromCoinAmount||o.toCoinAmount?(_(),B("span",Vs,c(o.lpAmount)+" USDT-USDC",1)):(_(),B("span",Es,c(o.lpAmount)+" USDT-USDC",1))])]),o.isShowRemoveModal?(_(),ao(a,{key:3,"pool-info":o.positionInfo,"from-coin":o.positionInfo.token_a,"to-coin":o.positionInfo.token_b,onOnClose:t[15]||(t[15]=b=>o.isShowRemoveModal=!1)},null,8,["pool-info","from-coin","to-coin"])):eo("",!0)])}const js=Uo(_s,[["render",Ws],["__scopeId","data-v-4b010ba5"]]),Xs=Lo({components:{AutoPoolV2Info:Ie,AutoPoolV2PositionRange:$e,AutoPoolV2PoolComposition:Ce,AutoPoolV2PoolLiquidity:Ae,AutoPoolV2PoolAdd:fs,AutoPoolV2PoolRemove:js},setup(){const o=Mo(),t=No(),W=se(),F=y(()=>W),V=()=>{o.getAutoPoolAPY(),o.getAutoPoolList(),t.setPoolConfigList(F.value.chainName,F.value.filterCoinsObj)},I=w(),A=Do();return vo(()=>A.query.action,k=>{k&&(I.value=k)},{immediate:!0}),{clickRefresh:V,currentTab:I}}});const Hs={class:"auto-pool-detail-v2"},zs={class:"detail-top"},Ys={class:"detail-bottom pc-detail"},Gs={class:"detail-bottom-left"},Zs={class:"detail-bottom-right"},Js={class:"h5-detail"};function Ks(o,t,W,F,V,I){const A=Se,k=Ie,i=$e,d=Ce,a=Ae,n=ve("AutoPoolV2PoolAdd"),C=ve("AutoPoolV2PoolRemove");return _(),B("div",Hs,[e("div",zs,[K(A,{onClickRefresh:o.clickRefresh},null,8,["onClickRefresh"]),K(k)]),e("div",Ys,[e("div",Gs,[K(i),K(d),K(a)]),e("div",Zs,[o.currentTab=="add"?(_(),ao(n,{key:0,onChangeCurrentTab:t[0]||(t[0]=l=>o.currentTab="remove")})):(_(),ao(C,{key:1,onChangeCurrentTab:t[1]||(t[1]=l=>o.currentTab="add")}))])]),e("div",Js,[o.currentTab=="add"?(_(),ao(n,{key:0,onChangeCurrentTab:t[2]||(t[2]=l=>o.currentTab="remove")})):(_(),ao(C,{key:1,onChangeCurrentTab:t[3]||(t[3]=l=>o.currentTab="add")})),K(i),K(d),K(a)])])}const wl=Uo(Xs,[["render",Ks],["__scopeId","data-v-b226cf01"]]);export{wl as default};
