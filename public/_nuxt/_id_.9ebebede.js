import{_ as tn}from"./back.0f340f80.js";import{_ as sn}from"./refresh-icon.e855e1c2.js";import{a as je,M as Mo,l as Co,r as w,m as ln,e as Ue,q as no,o as a,c as se,w as ke,h as o,i as z,j as Le,t as v,f as y,F as ao,s as Oo,v as Fe,x as E,y as an,I as un,B as Ao,p as Ee,k as We,z as co,A as po,C as $,D as $e,b as Po,E as Qe,G as So,H as Ke,u as P,J as Lo,K as $o,L as Uo,N as ko}from"./entry.3104b8e4.js";/* empty css              */import{_ as rn,a as dn,b as vn}from"./icon-error_2x.ce515367.js";import{u as He,a as Vo}from"./autoPool.00296248.js";import{u as xe,c as Ze,a as R,g as wo,d as Ve,s as T,f as mn,T as Oe,b as ve,p as Fo,e as jo,h as cn,i as pn,j as fn}from"./pool.c8444d30.js";import{_ as fo}from"./token-warning.a245eaa2.js";import{_ as Eo}from"./auto-pool-apy-tips.11c6acff.js";import{u as yo,a as To}from"./sha256.86091e5e.js";import{i as uo}from"./import-icon.de3e6c66.js";import"./decimal.6f03adc8.js";import{D as r}from"./decimal.0bdeb344.js";import{_ as Wo}from"./assets-card.ee44b26e.js";import{_ as Xo}from"./coin-lock.89451e44.js";import{_ as Go,a as Ho}from"./auto-pool-remove-modal.f015084c.js";import{afterCurrentPrice as _o}from"./data.6d006106.js";import{V as Io}from"./index.c71b1ae4.js";/* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              */import"./img-lock_2x.a28135f4.js";import"./img-lock_2x.03e32ff7.js";const yn=je({components:{Modal:Mo},setup(e,n){const{t:X,locale:H}=Co(),q=He(),S=["0.1","0.5","1"],u=w(q.slippage||.1),{setSlippage:c}=q,k=ln();console.log(u.value,"slippage.value");const _=w(!1);function s(N,i){_.value=!1,u.value=i}function t(){c(u.value),n.emit("onClose",!1)}return{settingArr:S,changeActiveIndex:s,confirm:t,emit:k,slippage:u,t:X,isInput:_}}});const Yo=e=>(Ee("data-v-405dfb5e"),e=e(),We(),e),bn=Yo(()=>o("svg",{class:"icon modal-icon-close","aria-hidden":"true"},[o("use",{"xlink:href":"#icon-a-icon-Shutdown"})],-1)),gn={class:"setting-container"},hn={class:"title"},kn=Yo(()=>o("img",{src:vn,alt:""},null,-1)),_n={class:"tag-list"},$n={key:0,src:rn,alt:""},wn={key:1,src:dn,alt:""},In={class:"footer"};function Cn(e,n,X,H,q,S){const u=an,c=un,k=Ao,_=no("Modal");return a(),se(_,{title:"Settings",class:"setting",centered:"",visible:!0,width:"400px",onCancel:n[3]||(n[3]=s=>e.$emit("onClose"))},{closeIcon:ke(()=>[bn]),footer:ke(()=>[o("div",In,[z(k,{type:"cancel",class:"cancel-btn cancel-btn-new",onClick:n[2]||(n[2]=s=>e.$emit("onClose"))},{default:ke(()=>[Le(v(e.$t("button.cancel")),1)]),_:1}),z(k,{class:"confirmbtn",disabled:Number(e.slippage)==0||Number(e.slippage)>1||Number(e.slippage)<.01,onClick:e.confirm},{default:ke(()=>[Le(v(e.$t("button.confirm")),1)]),_:1},8,["disabled","onClick"])])]),default:ke(()=>[o("div",gn,[o("div",hn,[kn,o("span",null,v(e.$t("modal.slippageTolerance")),1)]),o("div",_n,[(a(!0),y(ao,null,Oo(e.settingArr,(s,t)=>(a(),se(u,{key:t,class:Fe(!e.isInput&&s==e.slippage?"tag-active":""),onClick:N=>e.changeActiveIndex(t,s)},{default:ke(()=>[Le(v(s)+"% ",1)]),_:2},1032,["class","onClick"]))),128)),z(u,{class:Fe(["input-tag",e.isInput?"tag-active":""]),onClick:n[1]||(n[1]=s=>e.isInput=!0)},{default:ke(()=>[z(c,{value:e.slippage,"onUpdate:value":n[0]||(n[0]=s=>e.slippage=s),placeholder:"",suffix:"%",class:Fe(["slippage-input",Number(e.slippage)>.5&&Number(e.slippage)<1?"slippage-input-waring":Number(e.slippage)>1?"slippage-input-error":""])},null,8,["value","class"])]),_:1},8,["class"])])]),Number(e.slippage)>.5&&Number(e.slippage)<1||Number(e.slippage)>1?(a(),y("div",{key:0,class:Fe(["slippage-hint",Number(e.slippage)>.5&&Number(e.slippage)<1?"slippage-hint-waring":Number(e.slippage)>1?"slippage-hint-error":""])},[Number(e.slippage)>.5&&1>=Number(e.slippage)?(a(),y("img",$n)):E("",!0),Number(e.slippage)>1?(a(),y("img",wn)):E("",!0),o("p",null,v(Number(e.slippage)>.5&&1>=Number(e.slippage)?e.$t("tips.slippageTolerance2"):Number(e.slippage)>1?e.$t("tips.slippageTolerance1"):""),1)],2)):E("",!0)]),_:1})}const An=Ue(yn,[["render",Cn],["__scopeId","data-v-405dfb5e"]]),Pn=je({props:{poolInfo:{type:Object,default:()=>({})}},setup(e,n){const X=w(!1),H=w(null),q=w(0);let S=w(!1);const u=w(20),c=xe(),k=He(),_=w(!1);co(()=>{}),po(()=>{clearInterval(H.value)});const s=()=>{S.value=!1,H.value=setInterval(()=>{var m;_.value||q.value<u.value&&(q.value+=1,q.value===u.value&&((m=e==null?void 0:e.poolInfo)!=null&&m.poolAddress&&c.updateCurrentPools(e.poolInfo.poolAddress,store.chainName),q.value=0))},1e3)},t=$(()=>k.slippage),N=()=>{n.emit("clearAll")},i=()=>{S.value=!0,q.value=0,n.emit("clickRefresh"),setTimeout(()=>{S.value=!1,s()},1e3)};$e(()=>e.poolInfo,m=>{m&&!H.value&&s()},{immediate:!0});const d=Po(),b=Qe();return console.log(b,"route"),{refresh:S,clickRefresh:i,isShowSwapSetting:X,countdown:q,autoRefreshTime:u,slippage:t,clearAll:N,checkNullObj:Ze,router:d,route:b}}});const Sn=e=>(Ee("data-v-7418921d"),e=e(),We(),e),Tn={class:"title"},Rn={class:"left"},Nn=Sn(()=>o("svg",{class:"icon","aria-hidden":"true"},[o("use",{"xlink:href":"#icon-a-icon-setslippage"})],-1)),qn={key:0,class:"deposit-progress"};function Bn(e,n,X,H,q,S){const u=tn,c=sn,k=An;return a(),y("div",Tn,[o("div",Rn,[z(u)]),o("div",{class:Fe(["right title-right deposit-setting",e.poolInfo?"havePoolInfo":"noPoolInfo"])},[o("div",{class:"slippage-icon",onClick:n[0]||(n[0]=_=>e.isShowSwapSetting=!0)},[Nn,o("span",null,v(e.slippage)+"%",1)]),e.route.name!=="liquidity-create"?(a(),y("div",qn,[z(c,{loading:e.refresh,"auto-refresh-time":e.autoRefreshTime,countdown:e.countdown,onClickRefresh:e.clickRefresh},null,8,["loading","auto-refresh-time","countdown","onClickRefresh"])])):E("",!0)],2),e.isShowSwapSetting?(a(),se(k,{key:0,onOnClose:n[1]||(n[1]=_=>e.isShowSwapSetting=!1)})):E("",!0)])}const Dn=Ue(Pn,[["render",Bn],["__scopeId","data-v-7418921d"]]),Fn=je({components:{AutoPoolApyTips:Eo},setup(){const e=yo(),n=$(()=>e),X=xe(),H=$(()=>X),q=He(),S=$(()=>q),u=$(()=>n.value.theme),c=Qe(),k=w();$e(()=>[S.value.positionInfoObj,c.params.id],([i,d])=>{i&&!Ze(i)&&d&&(k.value=i[d],console.log(k.value,"##positionInfo.value"))},{immediate:!0,deep:!0});const _=$(()=>{var i;return(i=k.value)==null?void 0:i.needReverse}),s=i=>{var d;return(i==null?void 0:i.logoURI)||(i==null?void 0:i.logo_url)||((d=H.value.tokensObj[i==null?void 0:i.address])==null?void 0:d.logo_url)||(u.value==="default"?uo("/image/coins/unknown.png"):uo("/image/coins/sui-unknown.png"))},t=$(()=>{var i,d;return console.log((i=k==null?void 0:k.value)==null?void 0:i.poolUSD,"##positionInfo?.value?.poolUSD"),(d=k==null?void 0:k.value)==null?void 0:d.poolUSD}),N=$(()=>{var i,d;return S.value.apyObj&&((d=S.value.apyObj[(i=k.value)==null?void 0:i.id])==null?void 0:d.apr)||"--"});return{positionInfo:k,needReverse:_,getCoinIcon:s,tvl:t,apy:N,addCommom:R,getExplorerUrl:wo}}});const Xe=e=>(Ee("data-v-64d0287a"),e=e(),We(),e),Mn={class:"auto-pool-v2-info"},On={class:"pool-info"},Ln={class:"left"},Un={class:"coin-a"},Vn={alt:""},jn={class:"coin-b"},En={alt:""},Wn={class:"position-name"},Xn={key:0,class:"pool-fee"},Gn=Xe(()=>o("span",null,"Fee tier",-1)),Hn={class:"vault-address"},Yn=["href"],zn=Xe(()=>o("span",null,"Vault Address",-1)),Jn=Xe(()=>o("svg",{class:"icon","aria-hidden":"true"},[o("use",{"xlink:href":"#icon-icon-link"})],-1)),Kn=[zn,Jn],Zn={class:"apy-and-tvl"},Qn={class:"apy"},xn=Xe(()=>o("div",{class:"apy-title"},"APY",-1)),et={class:"apy-text"},ot={class:"tvl"},nt=Xe(()=>o("div",{class:"tvl-title"},"TVL",-1)),tt={class:"tvl-text"},st={class:"pool-info h5-pool-info"},it={class:"left"},lt={class:"coin-a"},at={alt:""},ut={class:"coin-b"},rt={alt:""},dt={class:"position-name"},vt={key:0,class:"pool-fee"},mt=Xe(()=>o("span",null,"Fee tier",-1)),ct={class:"left"},pt={class:"vault-address"},ft=["href"],yt=Xe(()=>o("span",null,"Vault Address",-1)),bt=Xe(()=>o("svg",{class:"icon","aria-hidden":"true"},[o("use",{"xlink:href":"#icon-icon-link"})],-1)),gt=[yt,bt],ht={class:"apy-and-tvl"},kt={class:"apy"},_t=Xe(()=>o("div",{class:"apy-title"},"APY",-1)),$t={class:"apy-text"},wt={class:"tvl"},It=Xe(()=>o("div",{class:"tvl-title"},"TVL",-1)),Ct={class:"tvl-text"};function At(e,n,X,H,q,S){var _,s,t,N,i,d,b,m,f,p,B,D,V,ee,g,h,W,j,Y,M,I,te,me,ce,pe,de,le,ue,G,A,J,Ne,ge,we,qe,Ie,fe,Be,Ce,Me,Pe,ze,K,Se,to,eo;const u=fo,c=Eo,k=So("image");return a(),y("div",Mn,[o("div",On,[o("div",Ln,[o("div",Un,[Ke(o("img",Vn,null,512),[[k,e.needReverse?e.getCoinIcon((s=e.positionInfo)==null?void 0:s.token_b):e.getCoinIcon((_=e.positionInfo)==null?void 0:_.token_a)]]),z(u,{address:e.needReverse?(d=(i=e.positionInfo)==null?void 0:i.token_b)==null?void 0:d.address:(N=(t=e.positionInfo)==null?void 0:t.token_a)==null?void 0:N.address,"style-params":{width:"12px",height:"12px",left:"18px",bottom:"4px"}},null,8,["address"])]),o("div",jn,[Ke(o("img",En,null,512),[[k,e.needReverse?e.getCoinIcon((m=e.positionInfo)==null?void 0:m.token_a):e.getCoinIcon((b=e.positionInfo)==null?void 0:b.token_b)]]),z(u,{address:e.needReverse?(D=(B=e.positionInfo)==null?void 0:B.token_a)==null?void 0:D.address:(p=(f=e.positionInfo)==null?void 0:f.token_b)==null?void 0:p.address,"style-params":{width:"12px",height:"12px",left:"18px",bottom:"4px"}},null,8,["address"])]),o("div",Wn,v(e.needReverse?(ee=(V=e.positionInfo)==null?void 0:V.token_b)==null?void 0:ee.symbol:(h=(g=e.positionInfo)==null?void 0:g.token_a)==null?void 0:h.symbol)+" - "+v(e.needReverse?(j=(W=e.positionInfo)==null?void 0:W.token_a)==null?void 0:j.symbol:(M=(Y=e.positionInfo)==null?void 0:Y.token_b)==null?void 0:M.symbol),1),(I=e.positionInfo)!=null&&I.fee?(a(),y("div",Xn,[Gn,Le(" "+v(((te=e.positionInfo)==null?void 0:te.fee)*100)+"% ",1)])):E("",!0),o("div",Hn,[o("a",{href:("getExplorerUrl"in e?e.getExplorerUrl:P(wo))("poolAddress",(me=e.positionInfo)==null?void 0:me.id),target:"_blank"},Kn,8,Yn)])]),o("div",Zn,[o("div",Qn,[xn,o("div",et,[Le(v(e.apy)+" ",1),z(c)])]),o("div",ot,[nt,o("div",tt,"$"+v(("addCommom"in e?e.addCommom:P(R))(e.tvl,2)),1)])])]),o("div",st,[o("div",it,[o("div",lt,[Ke(o("img",at,null,512),[[k,e.needReverse?e.getCoinIcon((pe=e.positionInfo)==null?void 0:pe.token_b):e.getCoinIcon((ce=e.positionInfo)==null?void 0:ce.token_a)]]),z(u,{address:e.needReverse?(G=(ue=e.positionInfo)==null?void 0:ue.token_b)==null?void 0:G.address:(le=(de=e.positionInfo)==null?void 0:de.token_a)==null?void 0:le.address,"style-params":{width:"12px",height:"12px",left:"18px",bottom:"4px"}},null,8,["address"])]),o("div",ut,[Ke(o("img",rt,null,512),[[k,e.needReverse?e.getCoinIcon((J=e.positionInfo)==null?void 0:J.token_a):e.getCoinIcon((A=e.positionInfo)==null?void 0:A.token_b)]]),z(u,{address:e.needReverse?(qe=(we=e.positionInfo)==null?void 0:we.token_a)==null?void 0:qe.address:(ge=(Ne=e.positionInfo)==null?void 0:Ne.token_b)==null?void 0:ge.address,"style-params":{width:"12px",height:"12px",left:"18px",bottom:"4px"}},null,8,["address"])]),o("div",dt,v(e.needReverse?(fe=(Ie=e.positionInfo)==null?void 0:Ie.token_b)==null?void 0:fe.symbol:(Ce=(Be=e.positionInfo)==null?void 0:Be.token_a)==null?void 0:Ce.symbol)+" - "+v(e.needReverse?(Pe=(Me=e.positionInfo)==null?void 0:Me.token_a)==null?void 0:Pe.symbol:(K=(ze=e.positionInfo)==null?void 0:ze.token_b)==null?void 0:K.symbol),1),(Se=e.positionInfo)!=null&&Se.fee?(a(),y("div",vt,[mt,Le(" "+v(((to=e.positionInfo)==null?void 0:to.fee)*100)+"% ",1)])):E("",!0)]),o("div",ct,[o("div",pt,[o("a",{href:("getExplorerUrl"in e?e.getExplorerUrl:P(wo))("poolAddress",(eo=e.positionInfo)==null?void 0:eo.id),target:"_blank"},gt,8,ft)])]),o("div",ht,[o("div",kt,[_t,o("div",$t,[Le(v(e.apy)+" ",1),z(c)])]),o("div",wt,[It,o("div",Ct,"$"+v(("addCommom"in e?e.addCommom:P(R))(e.tvl,2)),1)])])])])}const zo=Ue(Fn,[["render",At],["__scopeId","data-v-64d0287a"]]),Pt=je({components:{Slider:Lo},setup(){const e=w(!0),n=xe(),X=$(()=>n),H=He(),q=$(()=>H),S=Qe(),u=w();$e(()=>[q.value.positionInfoObj,S.params.id],([i,d])=>{i&&!Ze(i)&&d&&(u.value=i[d],console.log(u.value,"##positionInfo.value"))},{immediate:!0,deep:!0});const c=$(()=>{var i;return(i=u.value)==null?void 0:i.needReverse}),k=i=>{var d;return(i==null?void 0:i.logoURI)||(i==null?void 0:i.logo_url)||((d=X.value.tokensObj[i==null?void 0:i.address])==null?void 0:d.logo_url)||uo("/image/coins/sui-unknown.png")},_=$(()=>{var f,p,B;const i=(f=u==null?void 0:u.value)==null?void 0:f.price,d=(p=u==null?void 0:u.value)==null?void 0:p.minPrice,b=(B=u==null?void 0:u.value)==null?void 0:B.maxPrice;let m;if(i>=d&&i<=b){const D=new r(d).add(new r(b)).div(2).toNumber();m=i>D?50+new r(i).sub(D).div(D).toNumber():50-new r(i).sub(D).div(D).toNumber()}else i<d?(m=new r(i).sub(new r(d)).mul(100).toNumber()+15,console.log(m,"##result")):i>b&&(m=new r(i).sub(new r(b)).div(new r(b)).mul(100).toNumber()+70+15);return Number(mn(m,0))}),s=$(()=>{var f,p,B,D,V,ee,g;const i=e.value?((f=u.value)==null?void 0:f.minPrice)&&T(u==null?void 0:u.value.minPrice,6):((p=u.value)==null?void 0:p.maxPrice)&&T(1/(u==null?void 0:u.value.maxPrice),6),d=e.value?((B=u.value)==null?void 0:B.maxPrice)&&T((D=u.value)==null?void 0:D.maxPrice,6):((V=u.value)==null?void 0:V.minPrice)&&T(1/(u==null?void 0:u.value.minPrice),6),b=(c.value?!e.value:e.value)?T((ee=u.value)==null?void 0:ee.price,6):T(1/((g=u.value)==null?void 0:g.price),6);let m={};return m[i]={label:"Min Price"},m[d]={label:"Max Price"},b>i&&b<d?m[b]={label:"Current Price"}:b<i?m[Number(i)+1e-9]={label:"Current Price"}:b>d&&(m[Number(d)-1e-9]={label:"Current Price"}),console.log(m,"obj###"),m}),t=$(()=>{var d,b;const i=(c.value?!e.value:e.value)?Ve((d=u.value)==null?void 0:d.price,6):Ve(1/((b=u.value)==null?void 0:b.price),6);return console.log(i,"result##"),i}),N=$(()=>{var d,b;const i=(c.value?!e.value:e.value)?Ve((d=u.value)==null?void 0:d.price,6):Ve(1/((b=u.value)==null?void 0:b.price),6);return console.log(i,"result##111"),i});return{direct:e,positionInfo:u,needReverse:c,getCoinIcon:k,decimalUi:Ve,addCommom:R,sFixD:T,moveRatio:_,marks:s,currentPrice:t,currentPriceResever:N}}});const bo=e=>(Ee("data-v-220133b5"),e=e(),We(),e),St={class:"v2-position-range"},Tt={class:"position-range-top"},Rt=bo(()=>o("div",null,"Position Range",-1)),Nt={class:"base-coin"},qt={key:0},Bt={alt:""},Dt={key:1},Ft={alt:""},Mt={key:2},Ot={key:3},Lt=bo(()=>o("p",null,"Base coin",-1)),Ut={class:"coin-rate"},Vt=bo(()=>o("div",null,[o("svg",{class:"icon icon-up","aria-hidden":"true"},[o("use",{"xlink:href":"#icon-exchange_up1"})])],-1)),jt=bo(()=>o("div",null,[o("svg",{class:"icon icon-down","aria-hidden":"true"},[o("use",{"xlink:href":"#icon-exchange_down1"})])],-1)),Et=[Vt,jt],Wt={class:"position-range-bottom"},Xt={class:"price-range"},Gt={class:"price-range-bg"},Ht={key:0,class:"min-price"},Yt={key:0},zt={key:1},Jt={key:1,class:"max-price"},Kt={key:0},Zt={key:1},Qt={key:0,class:"min-price"},xt={key:0},es={key:1},os={key:1,class:"max-price"},ns={key:0},ts={key:1};function ss(e,n,X,H,q,S){var _,s,t,N,i,d,b,m,f,p,B,D,V,ee,g,h,W,j,Y,M,I,te,me,ce,pe,de,le,ue;const u=fo,c=no("Slider"),k=So("image");return a(),y("div",St,[o("div",Tt,[Rt,o("div",Nt,[e.needReverse?(a(),y("div",Dt,[Ke(o("img",Ft,null,512),[[k,e.direct?e.getCoinIcon((m=e.positionInfo)==null?void 0:m.token_b):e.getCoinIcon((b=e.positionInfo)==null?void 0:b.token_a)]]),z(u,{address:e.direct?(D=(B=e.positionInfo)==null?void 0:B.token_b)==null?void 0:D.address:(p=(f=e.positionInfo)==null?void 0:f.token_a)==null?void 0:p.address,"style-params":{width:"10px",height:"10px",right:"0",bottom:"0"}},null,8,["address"])])):(a(),y("div",qt,[Ke(o("img",Bt,null,512),[[k,e.direct?e.getCoinIcon((_=e.positionInfo)==null?void 0:_.token_a):e.getCoinIcon((s=e.positionInfo)==null?void 0:s.token_b)]]),z(u,{address:e.direct?(N=(t=e.positionInfo)==null?void 0:t.token_a)==null?void 0:N.address:(d=(i=e.positionInfo)==null?void 0:i.token_b)==null?void 0:d.address,"style-params":{width:"10px",height:"10px",right:"0",bottom:"0"}},null,8,["address"])])),e.needReverse?(a(),y("span",Ot,v(e.direct?(j=(W=e.positionInfo)==null?void 0:W.token_b)==null?void 0:j.symbol:(M=(Y=e.positionInfo)==null?void 0:Y.token_a)==null?void 0:M.symbol),1)):(a(),y("span",Mt,v(e.direct?(ee=(V=e.positionInfo)==null?void 0:V.token_a)==null?void 0:ee.symbol:(h=(g=e.positionInfo)==null?void 0:g.token_b)==null?void 0:h.symbol),1)),Lt,o("div",Ut,[o("div",{onClick:n[0]||(n[0]=G=>e.direct=!e.direct)},Et)])])]),o("div",Wt,[o("div",Xt,[o("div",Gt,[e.direct?(a(),se(c,{key:0,value:e.currentPrice,class:Fe(["position-slider",e.currentPrice<Number(("sFixD"in e?e.sFixD:P(T))((I=e.positionInfo)==null?void 0:I.minPrice,6))||e.currentPrice>Number(("sFixD"in e?e.sFixD:P(T))((te=e.positionInfo)==null?void 0:te.maxPrice,6))?"hide-handler":""]),step:1e-4,marks:e.marks,disabled:!0,min:Number(("sFixD"in e?e.sFixD:P(T))((me=e.positionInfo)==null?void 0:me.minPrice,6)),max:Number(("sFixD"in e?e.sFixD:P(T))((ce=e.positionInfo)==null?void 0:ce.maxPrice,6))},{mark:ke(({label:G})=>{var A,J,Ne,ge,we,qe,Ie,fe,Be,Ce,Me,Pe;return[G=="Min Price"?(a(),y("div",Ht,[o("div",null,v(G),1),e.direct?(a(),y("div",Yt,v(((A=e.positionInfo)==null?void 0:A.minPrice)&&("sFixD"in e?e.sFixD:P(T))((J=e.positionInfo)==null?void 0:J.minPrice,6)),1)):(a(),y("div",zt,v(((Ne=e.positionInfo)==null?void 0:Ne.maxPrice)&&("sFixD"in e?e.sFixD:P(T))(1/((ge=e.positionInfo)==null?void 0:ge.maxPrice),6)),1))])):E("",!0),G=="Max Price"?(a(),y("div",Jt,[o("div",null,v(G),1),e.direct?(a(),y("div",Kt,v(((we=e.positionInfo)==null?void 0:we.maxPrice)&&("sFixD"in e?e.sFixD:P(T))((qe=e.positionInfo)==null?void 0:qe.maxPrice,6)),1)):(a(),y("div",Zt,v(((Ie=e.positionInfo)==null?void 0:Ie.minPrice)&&("sFixD"in e?e.sFixD:P(T))(1/((fe=e.positionInfo)==null?void 0:fe.minPrice),6)),1))])):E("",!0),G=="Current Price"?(a(),y("div",{key:2,class:Fe(["current-price",e.currentPrice<Number(("sFixD"in e?e.sFixD:P(T))((Be=e.positionInfo)==null?void 0:Be.minPrice,6))?"current-price-left":e.currentPrice>Number(("sFixD"in e?e.sFixD:P(T))((Ce=e.positionInfo)==null?void 0:Ce.maxPrice,6))?"current-price-right":""])},[o("div",null,v(G),1),o("div",null,[(e.needReverse?!e.direct:e.direct)?(a(),y(ao,{key:0},[Le(v(("addCommom"in e?e.addCommom:P(R))(("decimalUi"in e?e.decimalUi:P(Ve))((Me=e.positionInfo)==null?void 0:Me.price,6))),1)],64)):(a(),y(ao,{key:1},[Le(v(("addCommom"in e?e.addCommom:P(R))(("decimalUi"in e?e.decimalUi:P(Ve))(1/((Pe=e.positionInfo)==null?void 0:Pe.price),6))),1)],64))])],2)):E("",!0)]}),_:1},8,["value","class","marks","min","max"])):(a(),se(c,{key:1,value:e.currentPriceResever,class:Fe(["position-slider",e.currentPriceResever<Number(("sFixD"in e?e.sFixD:P(T))(1/((pe=e.positionInfo)==null?void 0:pe.maxPrice),6))||e.currentPriceResever>Number(("sFixD"in e?e.sFixD:P(T))(1/((de=e.positionInfo)==null?void 0:de.minPrice),6))?"hide-handler":""]),step:null,min:Number(("sFixD"in e?e.sFixD:P(T))(1/((le=e.positionInfo)==null?void 0:le.maxPrice),6)),max:Number(("sFixD"in e?e.sFixD:P(T))(1/((ue=e.positionInfo)==null?void 0:ue.minPrice),6)),marks:e.marks,disabled:!0},{mark:ke(({label:G})=>{var A,J,Ne,ge,we,qe,Ie,fe,Be,Ce,Me,Pe;return[G=="Min Price"?(a(),y("div",Qt,[o("div",null,v(G),1),e.direct?(a(),y("div",xt,v(((A=e.positionInfo)==null?void 0:A.minPrice)&&("sFixD"in e?e.sFixD:P(T))((J=e.positionInfo)==null?void 0:J.minPrice,6)),1)):(a(),y("div",es,v(((Ne=e.positionInfo)==null?void 0:Ne.maxPrice)&&("sFixD"in e?e.sFixD:P(T))(1/((ge=e.positionInfo)==null?void 0:ge.maxPrice),6)),1))])):E("",!0),G=="Max Price"?(a(),y("div",os,[o("div",null,v(G),1),e.direct?(a(),y("div",ns,v(((we=e.positionInfo)==null?void 0:we.maxPrice)&&("sFixD"in e?e.sFixD:P(T))((qe=e.positionInfo)==null?void 0:qe.maxPrice,6)),1)):(a(),y("div",ts,v(((Ie=e.positionInfo)==null?void 0:Ie.minPrice)&&("sFixD"in e?e.sFixD:P(T))(1/((fe=e.positionInfo)==null?void 0:fe.minPrice),6)),1))])):E("",!0),G=="Current Price"?(a(),y("div",{key:2,class:Fe(["current-price current-price-direct",e.currentPriceResever<Number(("sFixD"in e?e.sFixD:P(T))(1/((Be=e.positionInfo)==null?void 0:Be.maxPrice),6))?"current-price-left":e.currentPriceResever>Number(("sFixD"in e?e.sFixD:P(T))(1/((Ce=e.positionInfo)==null?void 0:Ce.minPrice),6))?"current-price-right":""])},[o("div",null,v(G),1),o("div",null,[(e.needReverse?!e.direct:e.direct)?(a(),y(ao,{key:0},[Le(v(("addCommom"in e?e.addCommom:P(R))(("decimalUi"in e?e.decimalUi:P(Ve))((Me=e.positionInfo)==null?void 0:Me.price,6))),1)],64)):(a(),y(ao,{key:1},[Le(v(("addCommom"in e?e.addCommom:P(R))(("decimalUi"in e?e.decimalUi:P(Ve))(1/((Pe=e.positionInfo)==null?void 0:Pe.price),6))),1)],64))])],2)):E("",!0)]}),_:1},8,["value","class","min","max","marks"]))])])])])}const Jo=Ue(Pt,[["render",ss],["__scopeId","data-v-220133b5"]]),is=je({components:{Modal:Mo},props:{positionInfo:{type:Object,default:()=>({})}},setup(e){const n=$(()=>{var H,q;const X=T(((H=e.positionInfo)==null?void 0:H.poolUSD)/((q=e.positionInfo)==null?void 0:q.quoteUSD)*100,0);return console.log(X,"Pool Capacity Ratio"),Number(X)});return{sFixD:T,addCommom:R,ratio:n}}});const Ro=e=>(Ee("data-v-2a77a8ab"),e=e(),We(),e),ls=Ro(()=>o("svg",{class:"icon modal-icon-close","aria-hidden":"true"},[o("use",{"xlink:href":"#icon-a-icon-Shutdown"})],-1)),as={class:"deposit-slider"},us={class:"info-block"},rs=Ro(()=>o("div",{class:"leabl"},"Current Deposit：",-1)),ds={class:"text"},vs={class:"info-block"},ms=Ro(()=>o("div",{class:"leabl"},"Max Capacity：",-1)),cs={class:"text"};function ps(e,n,X,H,q,S){const u=no("Modal");return a(),se(u,{width:"440px",visible:!0,footer:null,title:"Vault Capacity",onCancel:n[0]||(n[0]=c=>e.$emit("onClose"))},{closeIcon:ke(()=>[ls]),default:ke(()=>{var c,k;return[o("div",as,[o("div",{class:"current-deposit",style:$o({width:`${e.ratio>100?100:e.ratio}%`})},null,4)]),o("div",us,[rs,o("div",ds,"$"+v(("addCommom"in e?e.addCommom:P(R))(("sFixD"in e?e.sFixD:P(T))((c=e.positionInfo)==null?void 0:c.poolUSD,2))),1)]),o("div",vs,[ms,o("div",cs,"$"+v(("addCommom"in e?e.addCommom:P(R))(("sFixD"in e?e.sFixD:P(T))((k=e.positionInfo)==null?void 0:k.quoteUSD,2))),1)])]}),_:1})}const Ko=Ue(is,[["render",ps],["__scopeId","data-v-2a77a8ab"]]),fs=je({components:{AutoPoolV2PoolCapacity:Ko},setup(){const e=xe(),n=$(()=>e),X=He(),H=$(()=>X),q=Qe(),S=w();$e(()=>[H.value.positionInfoObj,q.params.id],([_,s])=>{console.log(_,"##positionInfoObj"),_&&!Ze(_)&&s&&(S.value=_[s],console.log(S.value,"##positionInfo.value"))},{immediate:!0,deep:!0});const u=$(()=>{var _;return(_=S.value)==null?void 0:_.needReverse}),c=_=>{var s;return console.log(_,"info##"),(_==null?void 0:_.logoURI)||(_==null?void 0:_.logo_url)||((s=n.value.tokensObj[_==null?void 0:_.address])==null?void 0:s.logo_url)||uo("/image/coins/sui-unknown.png")},k=w(!1);return{needReverse:u,positionInfo:S,getCoinIcon:c,addCommom:R,isShowModal:k}}});const ys=e=>(Ee("data-v-f2fb77f4"),e=e(),We(),e),bs={class:"pool-composition"},gs={class:"pool-composition-top"},hs=ys(()=>o("span",null,"Vault Composition",-1)),ks={class:"pool-composition-bottom"},_s={class:"token-ratio"},$s={class:"before-coin"},ws={alt:""},Is={class:"after-coin"},Cs={alt:""},As={class:"token-num"},Ps={class:"num-box"},Ss={class:"num-box"};function Ts(e,n,X,H,q,S){var _,s,t,N,i,d,b,m,f,p,B,D,V,ee,g,h,W,j,Y,M,I,te,me,ce,pe,de,le,ue;const u=fo,c=Ko,k=So("image");return a(),y("div",bs,[o("div",gs,[hs,o("div",{class:"pool-capacity",onClick:n[0]||(n[0]=G=>e.isShowModal=!0)},"Vault Capacity")]),o("div",ks,[o("div",_s,[o("div",$s,[o("div",null,[z(u,{address:e.needReverse?(N=(t=e.positionInfo)==null?void 0:t.token_b)==null?void 0:N.address:(s=(_=e.positionInfo)==null?void 0:_.token_a)==null?void 0:s.address,"style-params":{width:"14px",height:"14px",right:"0",bottom:"0"}},null,8,["address"]),Ke(o("img",ws,null,512),[[k,e.needReverse?e.getCoinIcon((d=e.positionInfo)==null?void 0:d.token_b):e.getCoinIcon((i=e.positionInfo)==null?void 0:i.token_a)]])]),o("span",null,v((b=e.positionInfo)==null?void 0:b.poolCoinARatio)+"%",1)]),o("div",Is,[o("span",null,v((m=e.positionInfo)==null?void 0:m.poolCoinBRatio)+"%",1),o("div",null,[Ke(o("img",Cs,null,512),[[k,e.needReverse?e.getCoinIcon((p=e.positionInfo)==null?void 0:p.token_a):e.getCoinIcon((f=e.positionInfo)==null?void 0:f.token_b)]]),z(u,{address:e.needReverse?(ee=(V=e.positionInfo)==null?void 0:V.token_a)==null?void 0:ee.address:(D=(B=e.positionInfo)==null?void 0:B.token_b)==null?void 0:D.address,"style-params":{width:"14px",height:"14px",right:"0",bottom:"0"}},null,8,["address"])])])]),o("div",As,[o("div",{class:"token-a-bg",style:$o({width:`${(g=e.positionInfo)==null?void 0:g.poolCoinARatio}%`})},null,4),o("div",{class:"token-b-bg",style:$o({width:`${(h=e.positionInfo)==null?void 0:h.poolCoinBRatio}%`})},null,4),o("div",Ps,[o("div",null,v(("addCommom"in e?e.addCommom:P(R))((W=e.positionInfo)==null?void 0:W.poolCoinANum))+" "+v(e.needReverse?(I=(M=e.positionInfo)==null?void 0:M.token_b)==null?void 0:I.symbol:(Y=(j=e.positionInfo)==null?void 0:j.token_a)==null?void 0:Y.symbol),1),o("div",null,"$"+v(("addCommom"in e?e.addCommom:P(R))((te=e.positionInfo)==null?void 0:te.poolCoinAUSD)),1)]),o("div",Ss,[o("div",null,v(("addCommom"in e?e.addCommom:P(R))((me=e.positionInfo)==null?void 0:me.poolCoinBNum))+" "+v(e.needReverse?(le=(de=e.positionInfo)==null?void 0:de.token_a)==null?void 0:le.symbol:(pe=(ce=e.positionInfo)==null?void 0:ce.token_b)==null?void 0:pe.symbol),1),o("div",null,"$"+v(("addCommom"in e?e.addCommom:P(R))((ue=e.positionInfo)==null?void 0:ue.poolCoinBUSD)),1)])])]),e.isShowModal?(a(),se(c,{key:0,"position-info":e.positionInfo,onOnClose:n[1]||(n[1]=G=>e.isShowModal=!1)},null,8,["position-info"])):E("",!0)])}const Zo=Ue(fs,[["render",Ts],["__scopeId","data-v-f2fb77f4"]]),Rs=je({setup(){const e=xe(),n=$(()=>e),X=He(),H=$(()=>X),q=Qe(),S=w();$e(()=>[H.value.positionInfoObj,q.params.id],([s,t])=>{console.log(s,"##positionInfoObj"),s&&!Ze(s)&&t&&(S.value=s[t],console.log(S.value,"##positionInfo.value"))},{immediate:!0,deep:!0});const u=$(()=>{var s;return(s=S.value)==null?void 0:s.needReverse}),c=s=>{var t;return console.log(s,"info##"),(s==null?void 0:s.logoURI)||(s==null?void 0:s.logo_url)||((t=n.value.tokensObj[s==null?void 0:s.address])==null?void 0:t.logo_url)||uo("/image/coins/sui-unknown.png")},k=To(),_=$(()=>k);return{needReverse:u,positionInfo:S,getCoinIcon:c,addCommom:R,wallet:_}}});const ro=e=>(Ee("data-v-c9de826f"),e=e(),We(),e),Ns={class:"my-liquidity"},qs={class:"my-liquidity-top"},Bs=ro(()=>o("div",null,"My Liquidity",-1)),Ds=ro(()=>o("p",null,"My share of pool",-1)),Fs={class:"my-liquidity-bottom"},Ms={class:"lp-token"},Os=ro(()=>o("div",null,[o("span",null,"LP Token Balance ")],-1)),Ls={class:"lp-balance"},Us={class:"token-num-content"},Vs={class:"token-num token-a-num"},js={class:"logo"},Es=["src"],Ws={class:"text"},Xs={class:"lp-logo"},Gs=["src"],Hs=ro(()=>o("div",null,"Pooled Assets",-1)),Ys={class:"token-num"},zs={class:"logo"},Js=["src"],Ks={class:"text"},Zs=ro(()=>o("div",{class:"token-num-content-bg"},null,-1));function Qs(e,n,X,H,q,S){var c,k,_,s,t,N,i,d,b,m,f,p,B,D,V,ee,g,h,W,j,Y,M,I,te,me,ce,pe,de;const u=fo;return a(),y("div",Ns,[o("div",qs,[Bs,o("div",null,[Ds,o("p",null,v(e.wallet.connected?(c=e.positionInfo)==null?void 0:c.myShare:"--")+"%",1)])]),o("div",Fs,[o("div",Ms,[Os,o("div",null,[o("span",Ls,v(e.wallet.connected?("addCommom"in e?e.addCommom:P(R))((k=e.positionInfo)==null?void 0:k.myLiquidity):"--")+" LP",1),o("span",null,"$"+v(e.wallet.connected?("addCommom"in e?e.addCommom:P(R))((_=e.positionInfo)==null?void 0:_.myLiquidityUSD):"--"),1)])]),o("div",Us,[o("div",Vs,[o("div",js,[o("img",{src:e.needReverse?e.getCoinIcon((t=e.positionInfo)==null?void 0:t.token_b):e.getCoinIcon((s=e.positionInfo)==null?void 0:s.token_a),alt:""},null,8,Es),z(u,{address:e.needReverse?(b=(d=e.positionInfo)==null?void 0:d.token_b)==null?void 0:b.address:(i=(N=e.positionInfo)==null?void 0:N.token_a)==null?void 0:i.address,"style-params":{width:"14px",height:"14px",left:"18px",bottom:"0"}},null,8,["address"])]),o("div",Ws,[o("div",null,v(e.wallet.connected?("addCommom"in e?e.addCommom:P(R))((m=e.positionInfo)==null?void 0:m.amountA):"--")+" "+v(e.needReverse?(D=(B=e.positionInfo)==null?void 0:B.token_b)==null?void 0:D.symbol:(p=(f=e.positionInfo)==null?void 0:f.token_a)==null?void 0:p.symbol),1),o("div",null,v(e.wallet.connected?("addCommom"in e?e.addCommom:P(R))((V=e.positionInfo)==null?void 0:V.myAmountAUSD):"--"),1)])]),o("div",Xs,[o("img",{src:e.getCoinIcon((ee=e.positionInfo)==null?void 0:ee.lpInfo),alt:""},null,8,Gs),Hs]),o("div",Ys,[o("div",zs,[o("img",{src:e.needReverse?e.getCoinIcon((h=e.positionInfo)==null?void 0:h.token_a):e.getCoinIcon((g=e.positionInfo)==null?void 0:g.token_b),alt:""},null,8,Js),z(u,{address:e.needReverse?(M=(Y=e.positionInfo)==null?void 0:Y.token_a)==null?void 0:M.address:(j=(W=e.positionInfo)==null?void 0:W.token_b)==null?void 0:j.address,"style-params":{width:"14px",height:"14px",right:"0",bottom:"0"}},null,8,["address"])]),o("div",Ks,[o("div",null,v(e.wallet.connected?("addCommom"in e?e.addCommom:P(R))((I=e.positionInfo)==null?void 0:I.amountB):"--")+" "+v(e.needReverse?(pe=(ce=e.positionInfo)==null?void 0:ce.token_a)==null?void 0:pe.symbol:(me=(te=e.positionInfo)==null?void 0:te.token_b)==null?void 0:me.symbol),1),o("div",null,v(e.wallet.connected?("addCommom"in e?e.addCommom:P(R))((de=e.positionInfo)==null?void 0:de.myAmountBUSD):"--"),1)])]),Zs])])])}const Qo=Ue(Rs,[["render",Qs],["__scopeId","data-v-c9de826f"]]),xs=""+globalThis.__publicAssetsURL("image/icon-tips-error@2x.png");const ei={},xo=e=>(Ee("data-v-fcbc716b"),e=e(),We(),e),oi={class:"status"},ni=xo(()=>o("img",{src:xs,alt:""},null,-1)),ti=xo(()=>o("span",null,"Rebalancing is in processing. New deposits and withdraws are paused and will be back in minutes. ",-1)),si=[ni,ti];function ii(e,n){return a(),y("div",oi,si)}const en=Ue(ei,[["render",ii],["__scopeId","data-v-fcbc716b"]]),li=je({components:{AutoPoolAddModal:Go,AutoPoolV2PoolStatus:en},setup(){const e=To(),n=w(!1),X=yo(),H=$(()=>X),q=$(()=>H.value.chainName),S=$(()=>e),u=He(),c=$(()=>u),k=xe(),_=$(()=>k),s=w(),t=Qe(),N=w(!1),i=w(!1);$e(()=>[c.value.positionInfoObj,t.params.id],([C,O])=>{C&&!Ze(C)&&O&&(s.value=C[O],console.log(s.value,"##positionInfo.value"))},{immediate:!0,deep:!0});const d=$(()=>{var C,O;return console.log((C=s.value)==null?void 0:C.needReverse,"##positionInfo.value?.needReverse"),(O=s.value)==null?void 0:O.needReverse}),b=w(),m=w(),f=w(),p=w(),B=w(!0),D=$(()=>S.value.assets&&b.value&&S.value.assets[b.value.address]?Fo(S.value.assets[b.value.address].balance,b.value.decimals):0),V=$(()=>S.value.assets&&m.value&&S.value.assets[m.value.address]?Fo(S.value.assets[m.value.address].balance,m.value.decimals):0),ee=C=>{C==="fromCoin"?(B.value=!0,f.value=D.value>0?b.value.symbol=="SUI"?new r(Number(D.value)).sub(new r(.05)).lt(new r(0))?"0":new r(Number(D.value)).sub(new r(.05)).toString():String(D.value):""):(B.value=!1,p.value=V.value>0?m.value.symbol=="SUI"?new r(Number(V.value)).sub(new r(.05)).lt(new r(0))?"0":new r(Number(V.value)).sub(new r(.05)).toString():String(V.value):"")},g=C=>{C==="fromCoin"?(B.value=!0,f.value=D.value>0?T(new r(Number(D.value)).div(2).toString(),b.value.decimals).toString():""):(B.value=!1,p.value=V.value>0?T(new r(Number(V.value)).div(2).toString(),m.value.decimals).toString():"")},h=$(()=>q.value?jo(q.value):{}),W=$(()=>c.value.slippage),j=w("--"),Y=w("--"),M=C=>{const O=new r(s.value.autoPoolPositionInfo.liquidity),L=new r(C.toString());if(O.toNumber()>0&&L.toNumber()>0){const ae=L.add(O);console.log("totalLiquidity:",L.div(ae).mul(100).toString());const Te=L.div(ae).mul(100).toNumber(),ie=fn(Te),he=ie==-1?2:ie+2,ye=T(L.div(ae).mul(100).toNumber(),he);console.log(s.value.decimals,"##positionInfo.value.decimal");const l=new r(1).div(new r(Math.pow(10,s.value.lpInfo.decimals))).toString();console.log(ye,l,"###288"),Number(ye)<Number(l)?j.value=`<${l}`:j.value=ye}else L.toNumber()>0&&O.toNumber()<=0?j.value="100":j.value="--"},I=C=>{const O=new r(C.toString()),L=new r(W.value).div(100),ae=O.mul(L),Te=O.sub(ae),ie=Io.get_lp_amount_by_liquidity({liquidity:s.value.liquidity,total_supply:s.value.total_supply},Te),he=new r(Math.pow(10,s.value.lpInfo.decimals)),ye=new r(ie).div(he).toString();Y.value=ye},te=w(!1),me=w(!1),ce=w(""),pe=w(),de=async()=>{if(!s.value)return;console.log(f.value,p.value,"####updateAmounts"),i.value=!1;const C=s.value.autoPoolPositionInfo.tick_lower_index,O=s.value.autoPoolPositionInfo.tick_upper_index,L=Oe.sqrtPriceX64ToTickIndex(new ve(s.value.current_sqrt_price));let ae=Oe.tickIndexToSqrtPriceX64(C),Te=Oe.tickIndexToSqrtPriceX64(O);L<C&&(d.value?te.value=!0:me.value=!0),L>O&&(d.value?me.value=!0:te.value=!0);let ie;if(console.log(f.value||p.value,"#fromCoinAmount.value || toCoinAmount.value"),f.value||p.value){B.value?ie=new r(f.value).mul(Math.pow(10,b.value.decimals)).toString():ie=new r(p.value).mul(Math.pow(10,m.value.decimals)).toString();let he,ye=B.value;if(console.log("执行##"),K.value||Se.value){console.log(d.value?B.value:!B.value,"#needReverse.value?fixedFromCoin.value:!fixedFromCoin.value"),console.log("1106###needReverse.value####",d.value),console.log("1106###calculateDepositSwapAmount###params###",{lowerTick:C,upperTick:O,curSqrtPrice:new ve(s.value.current_sqrt_price),fix_amount_a:ye,input_amount:ie,coinTypeA:s.value.autoPoolPositionInfo.coin_type_a,coinTypeB:s.value.autoPoolPositionInfo.coin_type_b,clmm_pool:s.value.address,slippage:Number(W.value)/100,decimals:K.value?b.value.decimals:m.value.decimals});const F=await Pe.calculateDepositSwapAmount({lowerTick:C,upperTick:O,curSqrtPrice:new ve(s.value.current_sqrt_price),fix_amount_a:ye,input_amount:ie,coinTypeA:s.value.autoPoolPositionInfo.coin_type_a,coinTypeB:s.value.autoPoolPositionInfo.coin_type_b,clmm_pool:s.value.address,slippage:Number(W.value)/100,decimals:K.value?b.value.decimals:m.value.decimals});if(console.log(F,"###swapResult"),console.log("1106###calculateDepositSwapAmount###result###",F),F){N.value=F.is_exceed,he=new ve(F.afterSqrtPrice),ie=new ve(F.swapOutAmount),pe.value={swap_amount:F.swapInAmount,route_obj:F.route_obj,a2b:ye},ye=F.fixAmountA;const oe=s.value.token_a.decimals,Q=s.value.token_b.decimals;_o.value=Oe.sqrtPriceX64ToPrice(F.afterSqrtPrice,oe,Q).toString(),console.log(_o.value,"##afterCurrentPrice.value");const re=new r(F.swapInAmount).div(new r(Math.pow(10,oe))).toString(),be=new r(F.swapOutAmountLimit).div(new r(Math.pow(10,Q))).toString(),ne=d.value?s.value.token_b.symbol:s.value.token_a.symbol,x=d.value?s.value.token_a.symbol:s.value.token_b.symbol;ce.value=`To deposit ${R(K.value?f.value:p.value)} ${K.value?ne:x},
          ${R(re)} ${K.value?ne:x}  will be traded for ${R(be)} ${K.value?x:ne} added to the pool.`}else i.value=!0}else N.value=!1,he=s.value.current_sqrt_price,ie=new ve(ie),_o.value="",ce.value="";console.log(pe,"##swapParams");let l,U,Z;if(L>=C&&L<=O){const F=h.value.estLiquidityAndcoinAmountFromOneAmounts({tokenA:b.value,tokenB:m.value,lowerTick:C,upperTick:O,coinAmount:ie,iscoinA:ye,roundUp:!0,slippage:Number(W.value)/100,curSqrtPrice:new ve(he)});l=F.liquidityAmount,U=F.tokenMaxA,Z=F.tokenMaxB,!K.value&&!Se.value&&(B.value?p.value=Number(Z)>0?Z:"":f.value=Number(U)>0?U:"")}else L<O?l={liquidityAmount:cn(ae,Te,ie),tokenMaxA:0,tokenMaxB:p.value}.liquidityAmount:l={liquidityAmount:pn(ae,Te,ie),tokenMaxA:f.value,tokenMaxB:0}.liquidityAmount;console.log(l.toString(),"liquidityAmount###"),M(l),I(l)}};$e(()=>s.value,C=>{C&&!Ze(C)&&(b.value=C==null?void 0:C.token_a,m.value=C==null?void 0:C.token_b,te.value=!1,me.value=!1,de())},{immediate:!0});const le=$(()=>_.value.RATES),ue=$(()=>{var C,O,L,ae,Te,ie,he,ye,l,U;if((O=le.value[(C=b.value)==null?void 0:C.address])!=null&&O.price&&((ae=le.value[(L=m.value)==null?void 0:L.address])!=null&&ae.price)){console.log((ie=le.value[(Te=b.value)==null?void 0:Te.address])==null?void 0:ie.price,"RATES.value[fromCoin.value?.address]?.price");const Z=new r(f.value||0).mul(new r((ye=le.value[(he=b.value)==null?void 0:he.address])==null?void 0:ye.price)),F=new r(p.value||0).mul(new r((U=le.value[(l=m.value)==null?void 0:l.address])==null?void 0:U.price));return Ve(Z.add(F).toString(),2)}else return"--"});$e(()=>f.value,(C,O)=>{console.log(C,"##newVal"),C?de():(j.value="--",p.value="",Y.value="--")},{immediate:!0}),$e(()=>p.value,(C,O)=>{C?de():(f.value="",j.value="--",Y.value="--")},{immediate:!0});const{t:G,locale:A}=Co(),J=$(()=>{var C,O;if(K.value||Se.value){const L=K.value?f.value:p.value,ae=K.value?b.value:m.value;if((C=le.value[ae==null?void 0:ae.address])!=null&&C.price)return new r(L||0).mul(new r((O=le.value[ae==null?void 0:ae.address])==null?void 0:O.price)).toNumber()}return 0}),Ne=$(()=>{const C=Number(f.value)>Number(D.value),O=Number(p.value)>Number(V.value);return!f.value&&!p.value?G("button.enterAmount"):C?G("button.insufficientBalance",{name:b.value.symbol}):O?G("button.insufficientBalance",{name:m.value.symbol}):N.value?G("button.insufficientLiquidity"):Number(s.value.quoteUSD)>0&&Number(ue.value)>Number(s.value.quoteUSD)?"Exceeded the max capacity":i.value?G("button.enterAmount"):(console.log(J.value),"Add Liquidity")}),ge=$(()=>{const C=Number(f.value)>Number(D.value),O=Number(p.value)>Number(V.value);return!!(!f.value&&!p.value||C||O||f.value<=0&&p.value<=0||N.value||eo.value!=="STATUS_RUNNING"||(console.log(ue.value,s.value.quoteUSD,"positionInfo.value.quoteUSD#"),Number(s.value.quoteUSD)>0&&Number(ue.value)>Number(s.value.quoteUSD))||i.value||J.value>1e4)}),we=w(!0),{setIsShowSuccess:qe,setIsShowRejected:Ie,setIsShowWaiting:fe,setTransactionDesc:Be,setTransactionTxid:Ce,setPositiomNum:Me}=X,Pe=Vo("Sui"),ze=async()=>{var l,U;n.value=!1,we.value=!0,Ce("");const C=`${R(f.value)} ${(l=b.value)==null?void 0:l.symbol}`,O=`${R(p.value)} ${(U=m.value)==null?void 0:U.symbol}`;Be(`Deposit ${f.value>0?C:""} ${p.value>0&&f.value>0?"and":""} ${p.value>0?O:""}`),fe(!0);const L=B.value,ae=s.value.autoPoolPositionInfo.tick_lower_index,Te=s.value.autoPoolPositionInfo.tick_upper_index,ie=Oe.sqrtPriceX64ToTickIndex(new ve(s.value.current_sqrt_price));let he;B.value?he=new r(f.value).mul(Math.pow(10,b.value.decimals)).toString():he=new r(p.value).mul(Math.pow(10,m.value.decimals)).toString();const ye=s.value.rewarderInfo.map(Z=>Z.coinAddress);console.log("1109###deposit###positionInfo###",s);try{const Z={lowerTick:ae,upperTick:Te,coinAmount:he,fix_amount_a:L,slippage:Number(W.value)/100,curSqrtPrice:new ve(s.value.current_sqrt_price),id:s.value.id,clmm_pool:s.value.autoPoolPositionInfo.pool,lp_token_type:s.value.lp_token_type,coinTypeA:s.value.autoPoolPositionInfo.coin_type_a,coinTypeB:s.value.autoPoolPositionInfo.coin_type_b,rewarder_coin_types:ye,swapParams:pe.value,isOnlyA:K.value,isOnlyB:Se.value,currentTickIndex:ie,decimal_b:s.value.coinB.decimals};console.log("1106###deposit###params###",Z);const F=await Pe.deposit(Z);console.log(F,"===>payloadAdd11111");const oe=await S.value.currentWallet.signAndExecuteTransactionBlock(F);let Q=h.value.handleTx(oe);if(console.log("toAdd###tx###",Q),Q&&Q.hash){Ce(Q.hash),fe(!1),qe(!0),console.log(s,"===>positionInfo");const re={title:"Supplied",desc:`Deposit ${f.value>0?C:""} ${p.value>0&&f.value>0?"and":""} ${p.value>0?O:""}`,hash:Q.hash,tit:"Liquidity Increased",icon:"icon-icon-Increased",text:`Deposit ${f.value>0?C:""} ${p.value>0&&f.value>0?"and":""} ${p.value>0?O:""}`};q.value!=="Aptos"&&(re.res=Q.res),h.value.showTransitionPending(re),await h.value.watchTransaction(re)&&setTimeout(()=>{u.updatePositionItem(s.value.id),h.value.getAccount(S.value.address)},1e3),Me()}else fe(!1),Ie(!0);f.value="",p.value="",we.value=!1}catch(Z){f.value="",p.value="",console.log("addError###",Z),we.value=!1,fe(!1),Ie(!0)}},K=w(!1),Se=w(!1),to=C=>{f.value="",p.value="",ce.value="",C=="only-a"?(K.value=!K.value,Se.value=!1):(Se.value=!Se.value,K.value=!1)},eo=$(()=>c.value.currentAutoPoolStatus),mo=w(),go=()=>{mo.value=window.setInterval(()=>{(f.value||p.value)&&de()},2e4)};return co(()=>{go()}),po(()=>{window.clearInterval(mo.value)}),{currentAutoPoolStatus:eo,wallet:S,positionInfo:s,isShowAddModal:n,needReverse:d,fromCoin:b,toCoin:m,fromCoinAmount:f,toCoinAmount:p,fromCoinBlance:D,toCoinBlance:V,fixedFromCoin:B,maxBtnSelect:ee,halfBtnSelect:g,totalAmountUSD:ue,addCommom:R,shareOfPool:j,minimumReceivedLP:Y,addLiquidityBtnText:Ne,addLiquidityBtnDisabled:ge,toAdd:ze,showToCoinLock:me,showFromCoinLock:te,isOnlyA:K,isOnlyB:Se,onlyToken:to,onlyText:ce,onlyTokenUSD:J}}});const Ye=e=>(Ee("data-v-db5038d3"),e=e(),We(),e),ai={class:"auto-pool-add"},ui={class:"auto-pool-add-content"},ri={class:"liquidity-action-tab"},di=Ye(()=>o("div",{class:"increase tab-active"},"Add",-1)),vi={class:"only-token"},mi=Ye(()=>o("div",null,"Deposit Amounts",-1)),ci={key:0},pi=Ye(()=>o("div",{class:"hover-text"},"You can also choose to deposit in only one asset type. In that case, the vault will convert your asset to the required propositions using Cetus. Please note that trading fees & slippage will be applied. When slippage is involved, a certain amount of post-swap dust (no loss of funds) will be returned to you.",-1)),fi={key:0},yi=Ye(()=>o("div",{class:"hover-text"},"You can also choose to deposit in only one asset type. In that case, the vault will convert your asset to the required propositions using Cetus. Please note that trading fees & slippage will be applied. When slippage is involved, a certain amount of post-swap dust (no loss of funds) will be returned to you.",-1)),bi={key:0,class:"card-item"},gi={key:1,class:"card-item"},hi=Ye(()=>o("span",null,"Pool Closed",-1)),ki={key:4,class:"add-info"},_i={key:0,class:"only-text"},$i={class:"total-amount"},wi=Ye(()=>o("span",null,"Total Amount",-1)),Ii={class:"total-amount"},Ci=Ye(()=>o("span",null,"Share of Pool",-1)),Ai={key:0},Pi={key:1},Si={class:"total-amount"},Ti=Ye(()=>o("span",null,"Minimum Received LP",-1)),Ri={key:0},Ni={key:1},qi={key:5,class:"add-info only-add-info"},Bi=Ye(()=>o("div",{class:"only-text"},"Single-asset deposit can't be higher than $10,000 at a time.",-1)),Di=[Bi];function Fi(e,n,X,H,q,S){var t,N,i,d,b,m,f,p,B,D,V,ee,g,h,W,j,Y;const u=Wo,c=Xo,k=no("AutoPoolV2PoolStatus"),_=Ao,s=Go;return a(),y("div",ai,[o("div",ui,[o("div",ri,[di,o("div",{class:"remove",onClick:n[0]||(n[0]=Uo(M=>e.$emit("changeCurrentTab"),["stop"]))},"Remove")]),o("div",vi,[mi,o("div",null,[o("div",{class:"only-a",onClick:n[1]||(n[1]=M=>e.onlyToken("only-a"))},[o("p",null,[e.isOnlyA?(a(),y("span",ci)):E("",!0)]),o("span",null,v(e.needReverse?(d=(i=e.positionInfo)==null?void 0:i.token_b)==null?void 0:d.symbol:(N=(t=e.positionInfo)==null?void 0:t.token_a)==null?void 0:N.symbol)+" only",1),pi]),o("div",{class:"only-b",onClick:n[2]||(n[2]=M=>e.onlyToken("only-b"))},[o("p",null,[e.isOnlyB?(a(),y("span",fi)):E("",!0)]),o("span",null,v(e.needReverse?(p=(f=e.positionInfo)==null?void 0:f.token_a)==null?void 0:p.symbol:(m=(b=e.positionInfo)==null?void 0:b.token_b)==null?void 0:m.symbol)+" only",1),yi])])]),o("div",{class:Fe(e.needReverse?"card-container reverse":"card-container")},[(e.needReverse?!e.isOnlyA:!e.isOnlyB)?(a(),y("div",bi,[z(u,{modelValue:e.fromCoinAmount,"onUpdate:modelValue":n[3]||(n[3]=M=>e.fromCoinAmount=M),"input-value":e.fromCoinAmount,"coin-symbol":e.fromCoin?e.fromCoin.symbol:null,"coin-name":e.fromCoin?e.fromCoin.name:null,balance:e.fromCoinBlance,"coin-icon":e.fromCoin?e.fromCoin.logoURI:"",address:e.fromCoin?e.fromCoin.address:"","swap-direct":"From","import-page":"deposit","has-arrow":!1,onOnMax:n[4]||(n[4]=M=>e.maxBtnSelect("fromCoin")),onOnHalf:n[5]||(n[5]=M=>e.halfBtnSelect("fromCoin")),onOnInput:n[6]||(n[6]=M=>{e.fromCoinAmount=M}),onOnFocus:n[7]||(n[7]=()=>{e.fixedFromCoin=!0})},null,8,["modelValue","input-value","coin-symbol","coin-name","balance","coin-icon","address"]),e.showFromCoinLock&&!e.isOnlyA?(a(),se(c,{key:0})):E("",!0)])):E("",!0),(e.needReverse?!e.isOnlyB:!e.isOnlyA)?(a(),y("div",gi,[z(u,{modelValue:e.toCoinAmount,"onUpdate:modelValue":n[8]||(n[8]=M=>e.toCoinAmount=M),"input-value":e.toCoinAmount,"coin-symbol":e.toCoin?e.toCoin.symbol:null,"coin-name":e.toCoin?e.toCoin.name:null,balance:e.toCoinBlance,"swap-direct":"To","coin-icon":e.toCoin?e.toCoin.logoURI:"",address:e.toCoin?e.toCoin.address:"","import-page":"deposit","has-arrow":!1,onOnMax:n[9]||(n[9]=M=>e.maxBtnSelect("toCoin")),onOnHalf:n[10]||(n[10]=M=>e.halfBtnSelect("toCoin")),onOnInput:n[11]||(n[11]=M=>{e.toCoinAmount=M}),onOnFocus:n[12]||(n[12]=()=>{e.fixedFromCoin=!1})},null,8,["modelValue","input-value","coin-symbol","coin-name","balance","coin-icon","address"]),e.showToCoinLock&&!e.isOnlyB?(a(),se(c,{key:0})):E("",!0)])):E("",!0)],2)]),e.currentAutoPoolStatus=="STATUS_REBALANCING"?(a(),se(k,{key:0})):E("",!0),(B=e.positionInfo)!=null&&B.is_pause?(a(),se(_,{key:1,class:"big-btn liquidity-btn",disabled:!0},{default:ke(()=>[hi]),_:1})):e.wallet.connected?(a(),se(_,{key:2,class:"big-btn liquidity-btn",disabled:e.addLiquidityBtnDisabled,onClick:n[13]||(n[13]=M=>e.isShowAddModal=!0)},{default:ke(()=>[o("span",null,v(e.addLiquidityBtnText),1)]),_:1},8,["disabled"])):(a(),se(_,{key:3,class:"big-btn liquidity-btn",onClick:n[14]||(n[14]=M=>e.wallet.setIsShowWalletModal(!0))},{default:ke(()=>[o("span",null,v(e.$t("button.connectWallet")),1)]),_:1})),e.onlyTokenUSD<=1e4?(a(),y("div",ki,[e.onlyText&&(e.isOnlyA&&e.fromCoinAmount>0||e.isOnlyB&&e.toCoinAmount>0)?(a(),y("div",_i,v(e.onlyText),1)):E("",!0),o("div",$i,[wi,o("span",null,"$"+v(("addCommom"in e?e.addCommom:P(R))(e.totalAmountUSD)),1)]),o("div",Ii,[Ci,e.fromCoinAmount&&e.toCoinAmount||e.isOnlyA&&e.fromCoinAmount||e.isOnlyB&&e.toCoinAmount?(a(),y("span",Ai,v(e.shareOfPool)+"%",1)):(a(),y("span",Pi,"--%"))]),o("div",Si,[Ti,e.fromCoinAmount&&e.toCoinAmount||e.isOnlyA&&e.fromCoinAmount||e.isOnlyB&&e.toCoinAmount?(a(),y("span",Ri,v(("addCommom"in e?e.addCommom:P(R))(e.minimumReceivedLP))+" "+v(e.needReverse?(D=e.toCoin)==null?void 0:D.symbol:(V=e.fromCoin)==null?void 0:V.symbol)+"-"+v(e.needReverse?(ee=e.fromCoin)==null?void 0:ee.symbol:(g=e.toCoin)==null?void 0:g.symbol),1)):(a(),y("span",Ni,"--"+v(e.needReverse?(h=e.toCoin)==null?void 0:h.symbol:(W=e.fromCoin)==null?void 0:W.symbol)+"-"+v(e.needReverse?(j=e.fromCoin)==null?void 0:j.symbol:(Y=e.toCoin)==null?void 0:Y.symbol),1))])])):(a(),y("div",qi,Di)),e.isShowAddModal?(a(),se(s,{key:6,"pool-info":e.positionInfo,"from-coin":e.needReverse?e.positionInfo.token_b:e.positionInfo.token_a,"to-coin":e.needReverse?e.positionInfo.token_a:e.positionInfo.token_b,"from-coin-amount":e.needReverse?e.toCoinAmount:e.fromCoinAmount,"to-coin-amount":e.needReverse?e.fromCoinAmount:e.toCoinAmount,"total-amount":e.totalAmountUSD,"share-of-pool":e.shareOfPool,"minimum-received-l-p":e.minimumReceivedLP,"is-only-a":e.isOnlyA,"is-only-b":e.isOnlyB,onOnClose:n[15]||(n[15]=M=>e.isShowAddModal=!1),onToAdd:e.toAdd},null,8,["pool-info","from-coin","to-coin","from-coin-amount","to-coin-amount","total-amount","share-of-pool","minimum-received-l-p","is-only-a","is-only-b","onToAdd"])):E("",!0)])}const Mi=Ue(li,[["render",Fi],["__scopeId","data-v-db5038d3"]]),Oi=je({components:{AutoPoolRemoveModal:Ho,AutoPoolV2PoolStatus:en},setup(){const e=To(),n=$(()=>e),X=yo(),H=$(()=>X),q=$(()=>s.value.slippage),S=$(()=>H.value.chainName),u=[{name:"25%",value:25},{name:"50%",value:50},{name:"75%",value:75},{name:"MAX",value:100}],c=w(25),k=Qe(),_=He(),s=$(()=>_),t=$(()=>(console.log(s.value.positionInfoObj[k.params.id],"autoPool.value.positionInfoObj[route.params.id]###"),s.value.positionInfoObj[k.params.id])),N=$(()=>{var l;return(l=t.value)==null?void 0:l.needReverse}),i=w(),d=w(),b=w(!1),m=w(),f=$(()=>{var l;return(l=t.value)==null?void 0:l.myLiquidity}),p=w(!0),B=$(()=>S.value?jo(S.value):{}),D=w(),V=w(),ee=Vo("Sui"),g=w(""),h=w(""),W=w("--"),j=w(!1),Y=w(!1),M=w(),I=w(!0),te=w(),me=xe(),ce=$(()=>me),pe=$(()=>ce.value.RATES),de=async()=>{if(p.value||!t.value)return;V.value=!1;const l=t.value.autoPoolPositionInfo.tick_lower_index,U=t.value.autoPoolPositionInfo.tick_upper_index,Z=Oe.sqrtPriceX64ToTickIndex(new ve(t.value.current_sqrt_price));Z<l&&(N.value?j.value=!0:Y.value=!0),Z>U&&(N.value?Y.value=!0:j.value=!0);let F;if(console.log(g.value||h.value,"#fromCoinAmount.value || toCoinAmount.value"),g.value||h.value){I.value?F=new r(g.value).mul(Math.pow(10,i.value.decimals)).toString():F=new r(h.value).mul(Math.pow(10,d.value.decimals)).toString();let oe,Q=I.value;if(A.value||J.value){const x=await ee.calculateRemoveSwapAmount({lowerTick:l,upperTick:U,curSqrtPrice:new ve(t.value.current_sqrt_price),fix_amount_a:Q,receiveAmount:F,coinTypeA:t.value.autoPoolPositionInfo.coin_type_a,coinTypeB:t.value.autoPoolPositionInfo.coin_type_b,clmm_pool:t.value.address,slippage:0,decimals:A.value?i.value.decimals:d.value.decimals});if(console.log(x,"###swapResult"),x){D.value=x.is_exceed,F=new ve(x.swapOutAmount),oe=t.value.current_sqrt_price,M.value={swap_amount:x.swapInAmount,liquidity:x.liquidity,a2b:!Q,route_obj:x.route_obj},Q=!Q;const Ge=t.value.token_a.decimals,oo=t.value.token_b.decimals,Ae=new r(x.swapInAmount).div(new r(Math.pow(10,Ge))).toString(),so=new r(x.swapOutAmountLimit).div(new r(Math.pow(10,oo))).toString(),_e=N.value?t.value.token_b.symbol:t.value.token_a.symbol,Re=N.value?t.value.token_a.symbol:t.value.token_b.symbol;te.value=g.value==L.value||h.value==L.value?`To withdraw ${R(A.value?g.value:h.value)} ${A.value?_e:Re},
          ${R(A.value?t.value.amountB:t.value.amountA)} ${A.value?Re:_e} 
           in the pool will be traded for ${Ae} ${A.value?_e:Re}`:`To withdraw ${R(A.value?g.value:h.value)} ${A.value?_e:Re},
          ${R(Ae)} ${A.value?Re:_e}  in the pool will be traded for ${R(so)} ${A.value?_e:Re}`}else{V.value=!0,te.value="";return}}else D.value=!1,oe=t.value.current_sqrt_price,F=new ve(F);console.log(oe,"##curSqrtPrice"),console.log("执行了吗##");const{liquidityAmount:re,tokenMaxA:be,tokenMaxB:ne}=B.value.estLiquidityAndcoinAmountFromOneAmounts({tokenA:i.value,tokenB:d.value,lowerTick:l,upperTick:U,coinAmount:F,iscoinA:Q,roundUp:!1,slippage:Number(q.value)/100,curSqrtPrice:new ve(oe)});if(console.log(t.value.current_sqrt_price,"##positionInfo.value.current_sqrt_price"),console.log(ne.toString(),be.toString(),t.value,"###323"),!A.value&&!J.value&&(I.value?h.value=Number(ne)>0?ne:"":g.value=Number(be)>0?be:""),(A.value||J.value)&&(g.value>=L.value||h.value>=L.value)){m.value=t.value.myLiquidity;const x=new r(100);W.value=new r(t.value.myLiquidity).mul(new r(Math.pow(10,t.value.lpInfo.decimals))).toString(),le.value=re.toString(),c.value=x.toNumber()}else{const x=Io.get_lp_amount_by_liquidity({liquidity:t.value.liquidity,total_supply:t.value.total_supply},re.toString());m.value=new r(x).div(new r(Math.pow(10,t.value.lpInfo.decimals))).toString();const Ge=new r(m.value).div(new r(f.value)).mul(100);console.log(m.value,f.value,"####lpBalance.value"),W.value=x,le.value=re.toString(),c.value=Ge.toNumber()}}},le=w(),ue=$(()=>{var l;return(l=t==null?void 0:t.value)==null?void 0:l.amountA}),G=$(()=>{var l;return(l=t==null?void 0:t.value)==null?void 0:l.amountB}),A=w(!1),J=w(!1),Ne=$(()=>{var Q,re,be,ne;const l=(re=pe.value[(Q=i==null?void 0:i.value)==null?void 0:Q.address])==null?void 0:re.price,U=(ne=pe.value[(be=d==null?void 0:d.value)==null?void 0:be.address])==null?void 0:ne.price;console.log(l,U,g.value,h.value,"####totalWithdraw");let Z=g.value!=="--"&&g.value!==""?g.value:0,F=h.value!=="--"&&h.value!==""?h.value:0,oe;return l&&U&&(A.value||J.value?oe=new r(A.value?Z:F).mul(new r(A.value?l:U)).toString():(oe=new r(Z).mul(new r(l)).add(new r(F).mul(new r(U))).toString(),console.log(oe,"result##"))),oe>0&&oe<.01?"<$0.01":`$${R(T(oe,2))}`}),ge=async l=>{var Ge,oo,Ae,so,_e,Re,ho,No,qo,Bo;if(!p.value)return;p.value=!0,V.value=!1,(oo=(Ge=t.value)==null?void 0:Ge.token_a)==null||oo.decimals,(so=(Ae=t.value)==null?void 0:Ae.token_b)==null||so.decimals;const U=(_e=t.value)==null?void 0:_e.tick_lower_index,Z=(Re=t.value)==null?void 0:Re.tick_upper_index;Oe.tickIndexToSqrtPriceX64(U),Oe.tickIndexToSqrtPriceX64(Z);const F=(No=(ho=t.value)==null?void 0:ho.autoPoolPositionInfo)==null?void 0:No.tick_lower_index,oe=(Bo=(qo=t.value)==null?void 0:qo.autoPoolPositionInfo)==null?void 0:Bo.tick_upper_index,Q=Oe.sqrtPriceX64ToTickIndex(new ve(t.value.current_sqrt_price));Q<F&&(N.value?j.value=!0:Y.value=!0),Q>oe&&(N.value?Y.value=!0:j.value=!0);let re="",be,ne;console.log(l.value,"##item.value"),console.log(ne,"##coinAmount");let x=I.value;if(console.log("执行##"),A.value||J.value&&!j.value&&!Y.value){if(A.value){const Je=new r(L.value).mul(Math.pow(10,i.value.decimals)).mul(l.value).toString();console.log(Je,"##amount"),ne=T(Je,0),g.value=T(new r(L.value).mul(l.value).toString(),i.value.decimals)}if(J.value){const Je=new r(L.value).mul(l.value).mul(Math.pow(10,d.value.decimals)).toString();ne=T(Je,0),h.value=T(new r(L.value).mul(l.value).toString(),d.value.decimals)}console.log(g.value,"##fromCoinAmount.value");const De=await ee.calculateRemoveSwapAmount({lowerTick:U,upperTick:Z,curSqrtPrice:new ve(t.value.current_sqrt_price),fix_amount_a:x,receiveAmount:ne,coinTypeA:t.value.autoPoolPositionInfo.coin_type_a,coinTypeB:t.value.autoPoolPositionInfo.coin_type_b,clmm_pool:t.value.address,slippage:0,decimals:A.value?i.value.decimals:d.value.decimals});if(console.log(De,"###swapResult536"),De){D.value=De.is_exceed,ne=new ve(De.swapOutAmount),t.value.current_sqrt_price,M.value={swap_amount:De.swapInAmount,liquidity:De.liquidity,route_obj:De.route_obj,a2b:!x},x=!x;const Je=t.value.token_a.decimals,on=t.value.token_b.decimals,nn=new r(De.swapInAmount).div(new r(Math.pow(10,Je))).toString(),Do=new r(De.swapOutAmountLimit).div(new r(Math.pow(10,on))).toString(),io=N.value?t.value.token_b.symbol:t.value.token_a.symbol,lo=N.value?t.value.token_a.symbol:t.value.token_b.symbol;te.value=l.value==1?`To withdraw ${R(A.value?g.value:h.value)} ${A.value?io:lo},
          ${R(A.value?t.value.amountB:t.value.amountA)} ${A.value?lo:io}  in the pool will be traded for ${R(Do)} ${A.value?io:lo}`:`To withdraw ${R(A.value?g.value:h.value)} ${A.value?io:lo},
          ${R(nn)} ${A.value?lo:io}  in the pool will be traded for ${R(Do)} ${A.value?io:lo}`,re=De.liquidity}else t.value.current_sqrt_price,ne=new ve(ne),te.value="",V.value=!0;console.log(be,"result###"),W.value=new r(t.value.myLiquidity).mul(new r(l.value)).toString(),console.log(t.value,t.value.liquidity,re,W.value,"###positionInfo.value.liquidity"),console.log(W.value,"##lpTokenAmount.value"),m.value=new r(W.value),le.value=re}else{D.value=!1;const De=new r(ue.value).mul(Math.pow(10,i.value.decimals)).mul(l.value).toString();ne=T(De,0),g.value=T(new r(ue.value).mul(l.value).toString(),i.value.decimals);const Je=new r(G.value).mul(l.value).mul(Math.pow(10,d.value.decimals)).toString();ne=T(Je,0),h.value=T(new r(G.value).mul(l.value).toString(),d.value.decimals),t.value.current_sqrt_price,ne=new ve(ne),l.value!==1?be=new r(t.value.myLiquidity).mul(Math.pow(10,t.value.lpInfo.decimals)).mul(l.value).toString():be=new r(t.value.myLiquidity).mul(Math.pow(10,t.value.lpInfo.decimals)).toString(),m.value=new r(be).div(Math.pow(10,t.value.lpInfo.decimals)),re=Io.get_share_liquidity_by_amount({liquidity:t.value.liquidity,total_supply:t.value.total_supply},be),W.value=T(be,0),le.value=T(re,0),console.log(re,"###newLiquidity525")}};$e(c,ko((l,U)=>{l!==U&&(Number(l)>100?c.value=100:l&&t.value?(console.log("687===>"),c.value=l,ge({value:c.value/100})):(g.value="",h.value=""))},300)),$e(()=>g.value,ko((l,U)=>{l?de():(h.value="",c.value=0)},500),{immediate:!0}),$e(()=>h.value,ko((l,U)=>{l?de():(g.value="",c.value=0)},500),{immediate:!0});const we=Po(),{setIsShowSuccess:qe,setIsShowRejected:Ie,setIsShowWaiting:fe,setTransactionDesc:Be,setTransactionTxid:Ce,setPositiomNum:Me,setTransactionDescText:Pe}=X,ze=w(!1),{t:K}=Co(),Se=async()=>{var Ge,oo;ze.value=!0,Ce("");const l=Number(g.value)>0?`${R(g.value,i.value.decimals)} ${i.value.symbol}`:"",U=Number(h.value)>0?`${R(h.value,d.value.decimals)} ${d.value.symbol}`:"";console.log(l,U,"###transactionDescTo"),Be(K("tips.removeLiquidiyText",{from:N.value?U:l,and:Number(g.value)>0&&Number(h.value)>0?"and":"",to:N.value?l:U})),fe(!0);const Z=K("modal.removeLiquidityText2");Pe(Z);const F=t.value.autoPoolPositionInfo.tick_lower_index,oe=t.value.autoPoolPositionInfo.tick_upper_index,Q=Oe.tickIndexToSqrtPriceX64(F),re=Oe.tickIndexToSqrtPriceX64(oe),be=t.value.rewarderInfo.map(Ae=>Ae.coinAddress);console.log(W.value,"##lpTokenAmount.value431");let ne;I.value?ne=new r(g.value).mul(Math.pow(10,i.value.decimals)).toString():ne=new r(h.value).mul(Math.pow(10,d.value.decimals)).toString(),console.log();const x={lowerSqrtPrice:Q,upperSqrtPrice:re,lpTokenAmount:W.value,liquidity:le.value,curSqrtPrice:new ve(t.value.object.current_sqrt_price),slippage:Number(q.value)/100,id:t.value.id,clmm_pool:t.value.autoPoolPositionInfo.pool,lp_token_type:t.value.lp_token_type,coinTypeA:t.value.autoPoolPositionInfo.coin_type_a,coinTypeB:t.value.autoPoolPositionInfo.coin_type_b,rewarder_coin_types:be,swapParams:M.value,fix_amount_a:I.value,isOnlyA:!j.value&&!Y.value?A.value:!1,isOnlyB:!Y.value&&!j.value?J.value:!1,lowerTick:F,upperTick:oe,receiveAmount:ne,sliderVal:c.value,positionInfo:t.value};try{const Ae=await ee.remove(x);console.log(Ae,"移除流动性payload");const so=await n.value.currentWallet.signAndExecuteTransactionBlock(Ae);let _e=B.value.handleTx(so);if(console.log("0331###remove###tx####",_e),_e&&_e.hash){Ce(_e.hash),fe(!1),qe(!0);const Re={title:K("common.removeLiquidity"),desc:"",hash:_e.hash,descTransactions:`Remove ${l} ${Number(g.value)>0&&Number(h.value)>0?"and":""} ${U} from the pool`,sender:n.value.address,chainName:"Sui",tit:"Liquidity Removed",icon:"icon-icon-Removed",text:`Withdraw ${g.value} ${(Ge=i.value)==null?void 0:Ge.symbol} and ${h.value} ${(oo=d.value)==null?void 0:oo.symbol}`};Re.res=_e.res,B.value.showTransitionPending(Re),await B.value.watchTransaction(Re)&&(g.value="",h.value="",m.value="",c.value=0,setTimeout(()=>{_.updatePositionItem(t.value.id),B.value.getAccount(n.value.address)},1e3),Number(c.value)==100&&k.name=="auto-pool-detail"&&we.push("/pool/auto"))}else fe(!1),Ie(!0);ze.value=!1}catch(Ae){console.log("Remove error",Ae),ze.value=!1,fe(!1),Ie(!0)}};$e(()=>t.value,(l,U)=>{l&&!Ze(l)&&(i.value=l==null?void 0:l.token_a,d.value=l==null?void 0:l.token_b,console.log("触发###"),(!U||U&&U.address!==l.address)&&(c.value=c.value>0?c.value:25,ge({value:c.value/100})))},{immediate:!0});const to=$(()=>{const l=Number(m.value)>Number(f.value);return!g.value&&!h.value||!m.value||m.value<=0||!g.value&&A.value||!h.value&&J.value?K("button.enterAmount"):l?"Invalid Amount":D.value?K("button.insufficientLiquidity"):V.value?K("button.enterAmount"):(console.log(g.value,L.value,h.value,"856##"),A.value&&Number(g.value)>Number(L.value)||J.value&&Number(h.value)>Number(L.value)?"Invalid Amount":K("button.remove"))}),eo=$(()=>{console.log(m.value.toString(),f.value,"###864");const l=Number(m.value)>Number(f.value);return!!(!g.value&&!h.value||Number(g.value)<=0&&A.value||Number(h.value)<=0&&J.value||!m.value||m.value<=0||l||D.value||ie.value!=="STATUS_RUNNING"||V.value||A.value&&Number(g.value)>Number(L.value)||J.value&&Number(h.value)>Number(L.value))}),mo=l=>(l==null?void 0:l.logoURI)||(l==null?void 0:l.logo_url)||uo("/image/coins/sui-unknown.png"),go=l=>{g.value="",h.value="",p.value=!0,te.value="",l=="only-a"?(A.value=!A.value,J.value=!1,I.value=!0):(J.value=!J.value,A.value=!1,I.value=!1)},C=l=>{p.value=!0,c.value=100,l==="fromCoin"?I.value=!0:I.value=!1},O=l=>{p.value=!0,c.value=50,l==="fromCoin"?I.value=!0:I.value=!1},L=w(),ae=async()=>{I.value;const l=t.value.token_a.decimals,U=t.value.token_b.decimals,Z=A.value?G.value:ue.value;console.log(Z,"###receiveAmount");const F=A.value?d.value.address===t.value.token_a.address:i.value.address===t.value.token_a.address;if(A.value||J.value){console.log(Z,"##receiveAmount");let oe=await B.value.preSwap({pool:{address:t.value.address,coinA:t.value.token_a,coinB:t.value.token_b},a2b:F,byAmountIn:!0,amount:Z});console.log(oe,oe.estimatedAmountOut,l,U,"##preSwapRes");const Q=new r(oe.estimatedAmountOut);L.value=Q.sub(Q.mul(Number(q.value)/100)).add(new r(A.value?ue.value:G.value)).toString(),console.log("转换之后数量:",oe.estimatedAmountOut),console.log("转换之后滑点数量:",Q.mul(Number(q.value)/100).toNumber()),console.log("原有数量减滑点数量:",Q.sub(Q.mul(Number(q.value)/100)).toNumber()),console.log("fromCoin原有数量:",ue.value),console.log(L.value,"###onlyTokenBalance.value"),ge({value:c.value/100})}};$e(()=>[A.value,J.value,ue.value,G.value],([l,U])=>{l||U?ae():ge({value:c.value/100})},{immediate:!0});const Te=l=>`${l}%`,ie=$(()=>s.value.currentAutoPoolStatus),he=w(),ye=()=>{he.value=window.setInterval(()=>{(g.value||h.value)&&!p.value?de():ge({value:c.value/100})},2e4)};return co(()=>{ye()}),po(()=>{window.clearInterval(he.value)}),{removeLiquidityBtnText:to,removeLiquidityBtnDisabled:eo,wallet:n,ratioArr:u,positionInfo:t,isShowRemoveModal:b,needReverse:N,fromCoin:i,toCoin:d,lpAmount:m,lpBalance:f,sliderVal:c,sFixD:T,isSlider:p,fromCoinAmount:g,toCoinAmount:h,setPercent:ge,toRemove:Se,addCommom:R,getCoinIcon:mo,isOnlyA:A,isOnlyB:J,onlyToken:go,fixedFromCoin:I,maxBtnSelect:C,halfBtnSelect:O,fromCoinBlance:ue,toCoinBlance:G,showFromCoinLock:j,showToCoinLock:Y,removeText:te,onlyTokenBalance:L,totalWithdraw:Ne,formatter:Te,currentAutoPoolStatus:ie}}});const vo=e=>(Ee("data-v-c45d66f9"),e=e(),We(),e),Li={class:"auto-pool-add"},Ui={class:"auto-pool-add-content"},Vi={class:"liquidity-action-tab"},ji=vo(()=>o("div",{class:"remove tab-active"},"Remove",-1)),Ei={key:0,class:"only-token"},Wi=vo(()=>o("div",null,"Deposit Amounts",-1)),Xi={key:0},Gi={key:0},Hi={key:0,class:"card-item"},Yi={key:1,class:"card-item"},zi={class:"remove-ratio"},Ji={class:"remove-ratio-select"},Ki={key:0,class:"ratio"},Zi={key:1,class:"ratio"},Qi={class:"ratio-list"},xi=["onClick"],el=vo(()=>o("span",null,"Pool Closed",-1)),ol={key:4,class:"remove-info"},nl={key:0,class:"remove-text total-amount"},tl={class:"total-amount"},sl=vo(()=>o("span",null,"Total Withdraw",-1)),il={class:"total-amount"},ll=vo(()=>o("span",null,"LP Burn Amount",-1)),al={key:0},ul={key:1};function rl(e,n,X,H,q,S){var N,i,d,b,m,f,p,B,D,V,ee,g,h,W,j,Y,M;const u=Wo,c=Xo,k=Lo,_=no("AutoPoolV2PoolStatus"),s=Ao,t=Ho;return a(),y("div",Li,[o("div",Ui,[o("div",Vi,[o("div",{class:"increase",onClick:n[0]||(n[0]=Uo(I=>e.$emit("changeCurrentTab"),["stop"]))},"Add"),ji]),!e.showFromCoinLock&&!e.showToCoinLock?(a(),y("div",Ei,[Wi,o("div",null,[o("div",{class:"only-a",onClick:n[1]||(n[1]=I=>e.onlyToken("only-a"))},[o("p",null,[e.isOnlyA?(a(),y("span",Xi)):E("",!0)]),o("span",null,v(e.needReverse?(b=(d=e.positionInfo)==null?void 0:d.token_b)==null?void 0:b.symbol:(i=(N=e.positionInfo)==null?void 0:N.token_a)==null?void 0:i.symbol)+" only",1)]),o("div",{class:"only-b",onClick:n[2]||(n[2]=I=>e.onlyToken("only-b"))},[o("p",null,[e.isOnlyB?(a(),y("span",Gi)):E("",!0)]),o("span",null,v(e.needReverse?(B=(p=e.positionInfo)==null?void 0:p.token_a)==null?void 0:B.symbol:(f=(m=e.positionInfo)==null?void 0:m.token_b)==null?void 0:f.symbol)+" only",1)])])])):E("",!0),o("div",{class:Fe(e.needReverse?"card-container reverse":"card-container")},[(e.needReverse?!e.isOnlyA:!e.isOnlyB)?(a(),y("div",Hi,[z(u,{modelValue:e.fromCoinAmount,"onUpdate:modelValue":n[3]||(n[3]=I=>e.fromCoinAmount=I),"input-value":e.fromCoinAmount,"coin-symbol":e.fromCoin?e.fromCoin.symbol:null,"coin-name":e.fromCoin?e.fromCoin.name:null,balance:e.isOnlyA?e.onlyTokenBalance:e.fromCoinBlance,"coin-icon":e.fromCoin?e.fromCoin.logoURI:"",address:e.fromCoin?e.fromCoin.address:"","swap-direct":"From","import-page":"deposit","amount-leabl":"Available","has-arrow":!1,onOnMax:n[4]||(n[4]=I=>e.maxBtnSelect("fromCoin")),onOnHalf:n[5]||(n[5]=I=>e.halfBtnSelect("fromCoin")),onOnInput:n[6]||(n[6]=I=>{e.isSlider=!1,e.fromCoinAmount=I}),onOnFocus:n[7]||(n[7]=()=>{e.isSlider=!1,e.fixedFromCoin=!0})},null,8,["modelValue","input-value","coin-symbol","coin-name","balance","coin-icon","address"]),e.showFromCoinLock?(a(),se(c,{key:0})):E("",!0)])):E("",!0),(e.needReverse?!e.isOnlyB:!e.isOnlyA)?(a(),y("div",Yi,[z(u,{modelValue:e.toCoinAmount,"onUpdate:modelValue":n[8]||(n[8]=I=>e.toCoinAmount=I),"input-value":e.toCoinAmount,"coin-symbol":e.toCoin?e.toCoin.symbol:null,"coin-name":e.toCoin?e.toCoin.name:null,balance:e.isOnlyB?e.onlyTokenBalance:e.toCoinBlance,"swap-direct":"To","coin-icon":e.toCoin?e.toCoin.logoURI:"",address:e.toCoin?e.toCoin.address:"","import-page":"deposit","amount-leabl":"Available","has-arrow":!1,onOnMax:n[9]||(n[9]=I=>e.maxBtnSelect("toCoin")),onOnHalf:n[10]||(n[10]=I=>e.halfBtnSelect("toCoin")),onOnInput:n[11]||(n[11]=I=>{e.isSlider=!1,e.toCoinAmount=I}),onOnFocus:n[12]||(n[12]=()=>{e.isSlider=!1,e.fixedFromCoin=!1})},null,8,["modelValue","input-value","coin-symbol","coin-name","balance","coin-icon","address"]),e.showToCoinLock?(a(),se(c,{key:0})):E("",!0)])):E("",!0)],2),o("div",zi,[o("div",Ji,[Number(e.lpBalance)>=Number(e.lpAmount)?(a(),y("div",Ki,v(e.sliderVal>0&&Number(("sFixD"in e?e.sFixD:P(T))(e.sliderVal,2))<.01?"<0.01":("sFixD"in e?e.sFixD:P(T))(e.sliderVal,2))+"% ",1)):(a(),y("div",Zi,"--")),o("div",Qi,[(a(!0),y(ao,null,Oo(e.ratioArr,(I,te)=>(a(),y("div",{key:te,class:Fe(["ratio-item",e.sliderVal==I.value?"ratio-item-active":""]),onClick:()=>{e.isSlider=!0,e.sliderVal=I.value}},v(I.name),11,xi))),128))])]),z(k,{value:e.sliderVal,"onUpdate:value":n[13]||(n[13]=I=>e.sliderVal=I),"tip-formatter":e.formatter,onChange:n[14]||(n[14]=I=>e.isSlider=!0)},null,8,["value","tip-formatter"])])]),e.currentAutoPoolStatus=="STATUS_REBALANCING"?(a(),se(_,{key:0})):E("",!0),(D=e.positionInfo)!=null&&D.is_pause?(a(),se(s,{key:1,class:"big-btn liquidity-btn",disabled:!0},{default:ke(()=>[el]),_:1})):e.wallet.connected?(a(),se(s,{key:2,class:"big-btn liquidity-btn",disabled:e.removeLiquidityBtnDisabled,onClick:n[15]||(n[15]=I=>e.toRemove())},{default:ke(()=>[o("span",null,v(e.removeLiquidityBtnText),1)]),_:1},8,["disabled"])):(a(),se(s,{key:3,class:"big-btn liquidity-btn",onClick:n[16]||(n[16]=I=>e.wallet.setIsShowWalletModal(!0))},{default:ke(()=>[o("span",null,v(e.$t("button.connectWallet")),1)]),_:1})),e.removeLiquidityBtnDisabled?E("",!0):(a(),y("div",ol,[e.removeText&&(e.isOnlyA&&Number(e.fromCoinAmount)>0||e.isOnlyB&&Number(e.toCoinAmount)>0)?(a(),y("div",nl,v(e.removeText),1)):E("",!0),o("div",tl,[sl,o("span",null,v(e.totalWithdraw),1)]),o("div",il,[ll,e.fromCoinAmount||e.toCoinAmount?(a(),y("span",al,v(("addCommom"in e?e.addCommom:P(R))(e.lpAmount))+" "+v(e.needReverse?(V=e.toCoin)==null?void 0:V.symbol:(ee=e.fromCoin)==null?void 0:ee.symbol)+"-"+v(e.needReverse?(g=e.fromCoin)==null?void 0:g.symbol:(h=e.toCoin)==null?void 0:h.symbol),1)):(a(),y("span",ul,"0 "+v(e.needReverse?(W=e.toCoin)==null?void 0:W.symbol:(j=e.fromCoin)==null?void 0:j.symbol)+"-"+v(e.needReverse?(Y=e.fromCoin)==null?void 0:Y.symbol:(M=e.toCoin)==null?void 0:M.symbol),1))])])),e.isShowRemoveModal?(a(),se(t,{key:5,"pool-info":e.positionInfo,"from-coin":e.positionInfo.token_a,"to-coin":e.positionInfo.token_b,onOnClose:n[17]||(n[17]=I=>e.isShowRemoveModal=!1)},null,8,["pool-info","from-coin","to-coin"])):E("",!0)])}const dl=Ue(Oi,[["render",rl],["__scopeId","data-v-c45d66f9"]]),vl=je({components:{AutoPoolV2Info:zo,AutoPoolV2PositionRange:Jo,AutoPoolV2PoolComposition:Zo,AutoPoolV2PoolLiquidity:Qo,AutoPoolV2PoolAdd:Mi,AutoPoolV2PoolRemove:dl},setup(){const e=He();xe();const n=yo(),X=$(()=>n),H=()=>{e.getAutoPoolAPY(),e.getVault(S.params.id)},q=w(),S=Qe();$e(()=>S.query.action,k=>{k&&(q.value=k)},{immediate:!0});const u=w(),c=()=>{u.value=window.setInterval(()=>{e.getVault(S.params.id)},6e4)};return co(()=>{console.log(S,"route##"),c()}),po(()=>{window.clearInterval(u.value)}),$(()=>X.value.chainName),Po(),{clickRefresh:H,currentTab:q}}});const ml={class:"auto-pool-detail-v2"},cl={class:"detail-top"},pl={class:"detail-bottom pc-detail"},fl={class:"detail-bottom-left"},yl={class:"detail-bottom-right"},bl={class:"h5-detail"};function gl(e,n,X,H,q,S){const u=Dn,c=zo,k=Jo,_=Zo,s=Qo,t=no("AutoPoolV2PoolAdd"),N=no("AutoPoolV2PoolRemove");return a(),y("div",ml,[o("div",cl,[z(u,{onClickRefresh:e.clickRefresh},null,8,["onClickRefresh"]),z(c)]),o("div",pl,[o("div",fl,[z(k),z(_),z(s)]),o("div",yl,[e.currentTab=="add"?(a(),se(t,{key:0,onChangeCurrentTab:n[0]||(n[0]=i=>e.currentTab="remove")})):(a(),se(N,{key:1,onChangeCurrentTab:n[1]||(n[1]=i=>e.currentTab="add")}))])]),o("div",bl,[e.currentTab=="add"?(a(),se(t,{key:0,onChangeCurrentTab:n[2]||(n[2]=i=>e.currentTab="remove")})):(a(),se(N,{key:1,onChangeCurrentTab:n[3]||(n[3]=i=>e.currentTab="add")})),z(k),z(_),z(s)])])}const Xl=Ue(vl,[["render",gl],["__scopeId","data-v-963ccb88"]]);export{Xl as default};
