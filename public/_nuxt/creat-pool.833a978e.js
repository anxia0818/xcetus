import{u as Xe,a as aa,c as ta}from"./sha256.a943f970.js";import{a as Qe,m as R,e as Ge,o as N,f as O,r as q,E as Xo,l as la,D as ce,Q as Qo,i as ae,h as a,c as qe,x as D,j as Ce,w as na,v as Go,I as Jo,B as sa,p as Ko,k as Yo,b as ia,C as ua,q as ra,H as ca,z as ke,t as va}from"./entry.0896c5aa.js";import{_ as da,c as ma}from"./new-add-or-create.9e45303c.js";import{_ as pa}from"./lock.4f03159d.js";import{_ as fa,a as Zo,b as ga,c as ka}from"./new-liquidity-title.fe269c3d.js";/* empty css              */import{a as xo,u as ea,p as Eo,s as zo,c as Ho,f as De,b as Ca,d as ba}from"./pool.16528a62.js";import{i as Wo}from"./import-icon.de3e6c66.js";import{_ as wa,a as ha,b as _a}from"./icon-Add-Liquidity_2x.ed3c231b.js";import{_ as ya,a as Pa,s as Sa}from"./poolFee.ee550bc2.js";import{D as n}from"./decimal.0e8aa3f1.js";import{fromCoin as v,toCoin as d,fromCoinAmount as s,toCoinAmount as i,maxPrice as c,minPrice as m,createPoolInfo as u,fixedFromCoin as I,currentPriceReverse as We,currentPrice as se,initPrice as be,direction as h,createPoolFromCoin as ee,createPoolToCoin as oe,isFullRange as Re,resetData as Na,defaultMinPrice as ze,defaultMaxPrice as He}from"./create-pool-data.045cfb88.js";import{_ as Ta}from"./icon-selected_3x.09e9a6f0.js";import"./token-warning.1db4368c.js";import"./status-block.8c56df70.js";/* empty css              *//* empty css              */import"./notifi.40da92dc.js";import"./useWhale.e535d8cf.js";import"./index.531680ad.js";/* empty css              */import"./tick.505fdad3.js";/* empty css              */import"./refresh-icon.aff9c90a.js";/* empty css              */import"./swap-setting.d465ea18.js";const Aa=Qe({setup(){const e=Xe();return{storeIndex:R(()=>e)}}});const Ia={class:"create-pool-lock"},qa={key:0,src:da,alt:""},Ra={key:1,src:pa,alt:""};function La(e,t,Y,ve,Z,L){return N(),O("div",Ia,[e.storeIndex.theme=="default"?(N(),O("img",qa)):(N(),O("img",Ra))])}const $a=Ge(Aa,[["render",La],["__scopeId","data-v-fb497971"]]),Ba=Qe({components:{NewLiquidityTile:fa,NewLiquidityDepositRatio:Zo},setup(e,t){const Y=aa(),ve=Xe(),Z=R(()=>ve),L=R(()=>Z.value.chainName),H=R(()=>Y),$=q(!1),b=q(!1),E=q(!1);q(),q(),q(),q(!1);const w=Xo(),{t:j,locale:de}=la(),g=R(()=>L.value?xo(L.value):{}),p=ea(),G=R(()=>p),je=R(()=>Z.value.theme),z=R(()=>H.value.assets&&v.value&&H.value.assets[v.value.address]?Eo(H.value.assets[v.value.address].balance,v.value.decimals):"0"),V=R(()=>H.value.assets&&d.value&&H.value.assets[d.value.address]?Eo(H.value.assets[d.value.address].balance,d.value.decimals):"0"),ie=o=>{o==="fromCoin"?(I.value=!0,L.value==="Aptos"?s.value=Number(z.value)>0?v.value.symbol=="APT"?new n(Number(z.value)).sub(new n(.1)).lt(new n(0))?"0":new n(Number(z.value)).sub(new n(.1)).toString():String(z.value):"":s.value=Number(z.value)>0?v.value.symbol=="SUI"?new n(Number(z.value)).sub(new n(.05)).lt(new n(0))?"0":new n(Number(z.value)).sub(new n(.05)).toString():String(z.value):""):(I.value=!1,L.value==="Aptos"?i.value=Number(V.value)>0?d.value.symbol=="APT"?new n(Number(V.value)).sub(new n(.1)).lt(new n(0))?"0":new n(Number(V.value)).sub(new n(.1)).toString():String(V.value):"":i.value=Number(V.value)>0?d.value.symbol=="SUI"?new n(Number(V.value)).sub(new n(.05)).lt(new n(0))?"0":new n(Number(V.value)).sub(new n(.05)).toString():String(V.value):"")},he=o=>{o==="fromCoin"?(I.value=!0,s.value=Number(z.value)>0?zo(new n(Number(z.value)).div(2).toString(),v.value.decimals).toString():""):(I.value=!1,i.value=Number(V.value)>0?zo(new n(Number(V.value)).div(2).toString(),d.value.decimals).toString():"")};ce(()=>[G.value.tokens,w.query],async([o])=>{if(o&&o.length>0){const k=o;if(w&&w.query&&w.query.fromCoin&&(console.log("0410###deposite###watch###route.query.tokena####",w.query.fromCoin),w.query.fromCoin)){const f=await g.value.getTokenBySymbol(k,w.query.fromCoin);v.value=f,ee.value=f}if(w&&w.query&&w.query.toCoin&&w.query.toCoin){const f=await g.value.getTokenBySymbol(k,w.query.toCoin);d.value=f,oe.value=f}}},{immediate:!0});const _e=q("--"),ye=R(()=>Z.value.slippage),Ve=q(),me=async()=>{var ge,ue;if(!m.value&&!c.value)return!1;if(!s.value&&!i.value&&!m.value&&!c.value)return;const o=u.value;if(Ho(o))return;const{TickUtil:k,TickMath:f,getNearestTickByTick:C}=g.value,r=o==null?void 0:o.token_a.decimals,A=o==null?void 0:o.token_b.decimals;let S,T,_,y,F,U,M=o.current_tick_index,X;if(o.token_a.address.toLowerCase()===v.value.address.toLowerCase()&&o.token_b.address.toLowerCase()===d.value.address.toLowerCase()?X=!0:X=!1,m.value==="0"&&c.value==="∞")_=k.getMinIndex(Number(o.tickSpacing)),y=k.getMaxIndex(Number(o.tickSpacing));else{console.log(X,"===>directs1866"),X?(S=Number(m.value),T=Number(c.value)):(S=new n(1).div(c.value).toString(),T=new n(1).div(m.value).toString()),console.log("0518###pre###directs###",X),console.log("0518###pre###minPrice###",m.value),console.log("0518###pre###maxPrice###",c.value),console.log("0518###pre###poolInfos###",o),console.log("0518###pre###decimalsA###",r),console.log("0518###pre###decimalsB###",A),console.log("0518###pre###currentTickIndex###",M),console.log(S,T,"min max1875"),console.log(m.value,c.value,"===>maxPrice.value");try{F=S==0?-443636:f.priceToTickIndex(new n(S),r,A)}catch{F=-443636}try{U=f.priceToTickIndex(new n(T),r,A)}catch{U=443636}_=C(F,Number(o.tickSpacing)),y=C(U,Number(o.tickSpacing))}if(c.value!=="∞"&&_>=y){$.value=!0,s.value="",b.value=!0,i.value="";return}if(console.log(y,M,_,"1922"),c.value==="∞"||M>=_&&M<=y){$.value=!1,b.value=!1;let x;if(s.value||i.value){if(I.value){const we=new n(s.value).mul(Math.pow(10,v.value.decimals)).toString();x=new De(we)}else{const we=new n(i.value).mul(Math.pow(10,d.value.decimals)).toString();x=new De(we)}console.log(X,"======>directs");const{liquidityAmount:Q,tokenMaxA:K,tokenMaxB:ne,tokenMaxAOrigin:Ue,tokenMaxBOrigin:Oe}=g.value.estLiquidityAndcoinAmountFromOneAmounts({tokenA:o.token_a,tokenB:o.token_b,lowerTick:_,upperTick:y,coinAmount:x,iscoinA:X?I.value:!I.value,roundUp:!0,slippage:Number(ye.value)/100,curSqrtPrice:new De(o.current_sqrt_price)});Ve.value={liquidityAmount:Q,tokenMaxA:K,tokenMaxB:ne,tokenMaxAOrigin:Ue,tokenMaxBOrigin:Oe},X?I.value?i.value=Number(ne)>0?ne:"":s.value=Number(K)>0?K:"":I.value?i.value=K:s.value=ne}}else M>y?(ge=w==null?void 0:w.query)!=null&&ge.action&&($.value=!0,b.value=!0):M<_?(ue=w==null?void 0:w.query)!=null&&ue.action&&($.value=!0,b.value=!0):($.value=!0,s.value="",b.value=!0,i.value="")};ce(()=>be.value,o=>{o&&me()},{immediate:!0}),ce(s,(o,k)=>{console.log(s,"===>fromCoinAmount"),o==""&&I.value&&(i.value=""),o&&I.value&&!E.value&&me()}),ce(i,(o,k)=>{console.log(o,"===>>>>newValsda"),o==""&&!I.value&&(s.value=""),o&&!I.value&&!E.value&&me()}),ce(()=>Re.value,o=>{me()});const l=o=>{console.log(o,"e"),E.value=!0,_e.value=o,o>0?pe():(s.value="",i.value="")};ce([m,c],([o,k])=>{console.log(o,k,"==>minPrice,maxPrice"),Number(o)!==0&&Number(k)!==0&&!E.value?me():Number(o)!==0&&Number(k)!==0&&E.value&&pe()},{immediate:!0});const B=R(()=>G.value.RATES),P=q(),pe=async()=>{var ue,x;if(!m.value&&!c.value)return!1;if(!s.value&&!i.value&&!m.value&&!c.value)return;const o=u.value;if(Ho(o))return;const{TickUtil:k,TickMath:f,getNearestTickByTick:C}=g.value,r=o==null?void 0:o.token_a.decimals,A=o==null?void 0:o.token_b.decimals;let S,T,_,y,F,U,M;if(o.token_a.address.toLowerCase()===v.value.address.toLowerCase()&&o.token_b.address.toLowerCase()===d.value.address.toLowerCase()?M=!0:M=!1,m.value==="0"&&c.value==="∞")_=k.getMinIndex(Number(o.tickSpacing)),y=k.getMaxIndex(Number(o.tickSpacing));else{M?(S=Number(m.value),T=Number(c.value)):(S=new n(1).div(c.value).toString(),T=new n(1).div(m.value).toString());try{F=S==0?-443636:f.priceToTickIndex(new n(S),r,A)}catch{F=-443636}try{U=f.priceToTickIndex(new n(T),r,A)}catch{U=443636}_=C(F,Number(o.tickSpacing)),y=C(U,Number(o.tickSpacing))}console.log(o.token_a,"poolInfos===>");const X=B.value[(ue=o.value)==null?void 0:ue.token_a.address].price,ge=B.value[(x=o.value)==null?void 0:x.token_b.address].price;console.log(_,y,"####tick_lower tick_upper 889");try{const{amountA:Q,amountB:K,tokenAmountsInfo:ne}=await g.value.estCoinAmountsFromTotalAmount({lowerTick:_,upperTick:y,decimalsA:r,decimalsB:A,curSqrtPrice:new De(o.current_sqrt_price),totalAmount:_e.value,tokenPriceA:X,tokenPriceB:ge});console.log(Q,K,"###estCoinAmountsFromTotalAmount 844"),P.value=ne,o.needReverse?h.value?(s.value=Q,i.value=K):(s.value=K,i.value=Q):(s.value=Q,i.value=K)}catch(Q){console.log(Q,"e===>")}},W=R(()=>{var f,C,r,A,S,T,_,y;const o=(r=B.value[(C=(f=v)==null?void 0:f.value)==null?void 0:C.address])==null?void 0:r.price,k=(T=B.value[(S=(A=d)==null?void 0:A.value)==null?void 0:S.address])==null?void 0:T.price;return console.log(B.value,(y=(_=v)==null?void 0:_.value)==null?void 0:y.address,"===>fromCoin?.value?.address"),!!(o&&k)}),J=()=>{t.emit("toggle")},le=q(!1);R(()=>{if(G.value.poolConfigList&&v.value&&d.value){const o=G.value.poolConfigList.filter(f=>{var C,r,A,S;return f.token_a.address.toUpperCase()===((C=v.value.address)==null?void 0:C.toUpperCase())&&f.token_b.address.toUpperCase()===((r=d.value.address)==null?void 0:r.toUpperCase())||f.token_b.address.toUpperCase()===((A=v.value.address)==null?void 0:A.toUpperCase())&&f.token_a.address.toUpperCase()===((S=d.value.address)==null?void 0:S.toUpperCase())});console.log(o,"===>info");const k=[];return o.forEach(f=>{k.push(Number(f.fee))}),console.log(k,"===>>result"),k}else return[]}),R(()=>{var o;return(o=Z.value)==null?void 0:o.filterCreatePoolCoin});const Pe=R(()=>{var o;return!v.value||!d.value?j("modal.selectTokenModalTitle"):!((o=w.query)!=null&&o.fee)&&ta[L.value].hasCreatePool?"Select fee tier":!Number(s.value)&&!Number(i.value)?j("button.enterAmount"):Number(s.value)>Number(z.value)?j("button.insufficientBalance",{name:v.value.symbol}):Number(i.value)>Number(V.value)?j("button.insufficientBalance",{name:d.value.symbol}):c.value!=="∞"&&Number(m.value)>=Number(c.value)?j("newAdd.invalidRange"):j("newAdd.preview")}),Le=R(()=>{var o;return!s.value&&!i.value?(console.log("addLiquidityBtnDisabled11111"),!0):Number(s.value)>Number(z.value)||Number(i.value)>Number(V.value)?(console.log("addLiquidityBtnDisabled22222"),!0):Pe.value!==j("newAdd.preview")?!0:!u.value&&!((o=u.value)!=null&&o.currentPrice)?(console.log("addLiquidityBtnDisabled55555"),!0):!!(Number(s.value)<=0&&Number(i.value)<=0||$.value||b.value)}),{setTransactionTxid:Se,setTransactionDesc:$e,setIsShowWaiting:fe,setIsShowSuccess:Ne,setIsShowRejected:Te,setPositiomNum:Be}=ve,Me=()=>{L.value=="Sui"&&Fe()},Ae=q(!1),Fe=async()=>{var X,ge,ue,x,Q,K,ne,Ue,Oe,we,Je,Ke,Ye,Ze,xe,eo,oo,ao,to,lo,no,so,io,uo,ro,co,vo,mo,po,fo,go,ko,Co,bo,wo,ho,_o,yo,Po,So,No,To,Ao,Io,qo,Ro,Lo,$o,Bo,Mo,Fo,Uo,Oo,Do,jo,Vo;le.value=!1,console.log("创建sui池子");let o=!1;g.value.getIsSortedSymbols(ee.value.address,oe.value.address)&&(o=!0),Se("");const k=$.value?"":`${s.value} ${(X=v.value)==null?void 0:X.symbol}`,f=b.value?"":`${i.value} ${(ge=d.value)==null?void 0:ge.symbol}`;console.log("0424###createPoolFromCoin###",ee.value),console.log("0424###createPoolToCoin###",oe.value),console.log("0424###needReverse###",o),console.log("0424###createPoolInfo?.value?.needReverse###",(x=(ue=u)==null?void 0:ue.value)==null?void 0:x.needReverse),$e(j("tips.increaseLiquiditySuccess",{from:!o&&!((K=(Q=u)==null?void 0:Q.value)!=null&&K.needReverse)||o&&((Ue=(ne=u)==null?void 0:ne.value)!=null&&Ue.needReverse)?k:f,and:!$.value&&!b.value?"and":"",to:!o&&!((we=(Oe=u)==null?void 0:Oe.value)!=null&&we.needReverse)||o&&((Ke=(Je=u)==null?void 0:Je.value)!=null&&Ke.needReverse)?f:k})),fe(!0);let C="",r="",A="",S="",T="",_="",y=0,F=0,U=!1,M;if(o||(Ze=(Ye=u)==null?void 0:Ye.value)!=null&&Ze.needReverse){const re=o&&!((eo=(xe=u)==null?void 0:xe.value)!=null&&eo.needReverse);C=re?(so=(no=(lo=u)==null?void 0:lo.value)==null?void 0:no.token_b)==null?void 0:so.address:(to=(ao=(oo=u)==null?void 0:oo.value)==null?void 0:ao.token_a)==null?void 0:to.address,r=re?(mo=(vo=(co=u)==null?void 0:co.value)==null?void 0:vo.token_a)==null?void 0:mo.address:(ro=(uo=(io=u)==null?void 0:io.value)==null?void 0:uo.token_b)==null?void 0:ro.address,A=re?(bo=(Co=(ko=u)==null?void 0:ko.value)==null?void 0:Co.token_b)==null?void 0:bo.decimals:(go=(fo=(po=u)==null?void 0:po.value)==null?void 0:fo.token_a)==null?void 0:go.decimals,S=re?(So=(Po=(yo=u)==null?void 0:yo.value)==null?void 0:Po.token_a)==null?void 0:So.decimals:(_o=(ho=(wo=u)==null?void 0:wo.value)==null?void 0:ho.token_b)==null?void 0:_o.decimals,(To=(No=u)==null?void 0:No.value)!=null&&To.needReverse?(T=h.value?s.value:i.value,_=h.value?i.value:s.value,y=h.value?Number(m.value):1/Number(c.value),F=h.value?Number(c.value):1/Number(m.value),U=h.value?I.value:!I.value,M=h.value?se.value:1/Number(se.value)):(T=h.value?i.value:s.value,_=h.value?s.value:i.value,y=h.value?1/Number(c.value):Number(m.value),F=h.value?1/Number(m.value):Number(c.value),U=h.value?!I.value:I.value,M=h.value?1/Number(se.value):se.value)}else C=(qo=(Io=(Ao=u)==null?void 0:Ao.value)==null?void 0:Io.token_a)==null?void 0:qo.address,r=($o=(Lo=(Ro=u)==null?void 0:Ro.value)==null?void 0:Lo.token_b)==null?void 0:$o.address,A=(Fo=(Mo=(Bo=u)==null?void 0:Bo.value)==null?void 0:Mo.token_a)==null?void 0:Fo.decimals,S=(Do=(Oo=(Uo=u)==null?void 0:Uo.value)==null?void 0:Oo.token_b)==null?void 0:Do.decimals,T=h.value?s.value:i.value,_=h.value?i.value:s.value,y=h.value?Number(m.value):1/Number(c.value),F=h.value?Number(c.value):1/Number(m.value),U=h.value?I.value:!I.value,M=h.value?se.value:1/Number(se.value);try{console.log("0501###toCreatePool###params###",{coinTypeA:C,coinTypeB:r,decimalsA:A,decimalsB:S,amountA:T,amountB:_,minPrice:y,maxPrice:F,fix_amount_a:U,tick_spacing:Number(u.value.tickSpacing),slippage:Number(ye.value)/100,price:M});const re=await g.value.getCreatPoolTransactionPayload({coinTypeA:C,coinTypeB:r,decimalsA:A,decimalsB:S,amountA:T,amountB:_,minPrice:m.value=="0"&&c.value=="∞"?"0":y,maxPrice:m.value=="0"&&c.value=="∞"?"∞":F,fix_amount_a:U,tick_spacing:Number(u.value.tickSpacing),slippage:Number(ye.value)/100,price:M}),oa=await H.value.currentWallet.signAndExecuteTransactionBlock(re),Ie=g.value.handleTx(oa);if(Ie&&Ie.hash){Se(Ie.hash),fe(!1),Ne(!0);const Ee={title:"Created pool",desc:"Pool created successfully ",hash:Ie.hash,tit:"Pool Created",icon:"icon-icon-Position-Created",tokenInfo:{tokena:`${(jo=v.value)==null?void 0:jo.address}`,numa:$.value?"":`- ${s.value}`,logoa:G.value.tokensObj&&v.value&&v.value.address&&G.value.tokensObj[v.value.address]&&G.value.tokensObj[v.value.address].logoURI,tokenb:`${(Vo=d.value)==null?void 0:Vo.address}`,numb:b.value?"":`- ${i.value}`,logob:G.value.tokensObj&&d.value&&d.value.address&&G.value.tokensObj[d.value.address]&&G.value.tokensObj[d.value.address].logoURI},text:"Pool created successfully"};L.value!=="Aptos"&&(Ee.res=Ie.res),g.value.showTransitionPending(Ee),(await g.value.watchTransaction(Ee,!0)).status&&(Ne(!1),Ae.value=!0,setTimeout(()=>{p.setPoolConfigList(L.value,Z.value.filterCoinsObj),g.value.getAccount(H.value.address)},1e3)),Be()}else fe(!1),Te(!0);s.value="",i.value=""}catch(re){console.log("0407###createPool###error##",re),le.value=!1,p.setPoolConfigList(L.value,Z.value.filterCoinsObj),s.value="",i.value="",fe(!1),Te(!0)}};return{fromCoinAmount:s,toCoinAmount:i,fromCoin:v,toCoin:d,maxBtnSelect:ie,halfBtnSelect:he,showFromCoinLock:$,showToCoinLock:b,fromCoinBlance:z,toCoinBlance:V,fixedFromCoin:I,isInputTotalAmount:E,toggle:J,theme:je,liquidityTotalAmount:_e,createPoolInfo:u,minPrice:m,maxPrice:c,currentPriceReverse:We,currentPrice:se,onInput:l,initPrice:be,isShowtotalAmount:W,direction:h,isShowLiquidityModal:le,createPoolBtnText:Pe,createPoolBtnDisabled:Le,toCreatePool:Me,isCreateSuccess:Ae}}});const Ma=e=>(Ko("data-v-25e43d01"),e=e(),Yo(),e),Fa={class:"create-pool-right"},Ua={class:"card-container"},Oa={class:"card-item"},Da={class:"card-item"},ja={key:0,class:"total-amount"},Va=Ma(()=>a("span",null,"Total Amount",-1));function Ea(e,t,Y,ve,Z,L){const H=Qo("NewLiquidityTile"),$=ga,b=_a,E=Jo,w=Zo,j=ma,de=sa,g=ya;return N(),O("div",Fa,[ae(H),a("div",Ua,[a("div",Oa,[ae($,{modelValue:e.fromCoinAmount,"onUpdate:modelValue":t[0]||(t[0]=p=>e.fromCoinAmount=p),"input-value":e.fromCoinAmount,"coin-symbol":e.fromCoin?e.fromCoin.symbol:null,"coin-name":e.fromCoin?e.fromCoin.name:null,balance:e.fromCoinBlance,"coin-icon":e.fromCoin?e.fromCoin.logoURI:"",address:e.fromCoin?e.fromCoin.address:"","swap-direct":"From","import-page":"deposit","has-arrow":!1,onOnMax:t[1]||(t[1]=p=>e.maxBtnSelect("fromCoin")),onOnHalf:t[2]||(t[2]=p=>e.halfBtnSelect("fromCoin")),onOnInput:t[3]||(t[3]=p=>{e.fromCoinAmount=p,e.fixedFromCoin=!0,e.isInputTotalAmount=!1})},null,8,["modelValue","input-value","coin-symbol","coin-name","balance","coin-icon","address"]),e.showFromCoinLock?(N(),qe(b,{key:0,"from-coin":e.fromCoin,"to-coin":e.toCoin},null,8,["from-coin","to-coin"])):D("",!0)]),a("div",Da,[ae($,{modelValue:e.toCoinAmount,"onUpdate:modelValue":t[4]||(t[4]=p=>e.toCoinAmount=p),"input-value":e.toCoinAmount,"coin-symbol":e.toCoin?e.toCoin.symbol:null,"coin-name":e.toCoin?e.toCoin.name:null,balance:e.toCoinBlance,"swap-direct":"To","coin-icon":e.toCoin?e.toCoin.logoURI:"",address:e.toCoin?e.toCoin.address:"","import-page":"deposit","has-arrow":!1,onOnMax:t[5]||(t[5]=p=>e.maxBtnSelect("toCoin")),onOnHalf:t[6]||(t[6]=p=>e.halfBtnSelect("toCoin")),onOnInput:t[7]||(t[7]=p=>{e.toCoinAmount=p,e.fixedFromCoin=!1,e.isInputTotalAmount=!1})},null,8,["modelValue","input-value","coin-symbol","coin-name","balance","coin-icon","address"]),e.showToCoinLock?(N(),qe(b,{key:0,"from-coin":e.fromCoin,"to-coin":e.toCoin},null,8,["from-coin","to-coin"])):D("",!0)]),e.fromCoin&&e.toCoin&&!e.showToCoinLock&&!e.showFromCoinLock&&e.theme=="default"?(N(),O("img",{key:0,class:"add",src:wa,alt:"",onClick:t[8]||(t[8]=(...p)=>e.toggle&&e.toggle(...p))})):D("",!0),e.fromCoin&&e.toCoin&&!e.showToCoinLock&&!e.showFromCoinLock&&e.theme!=="default"?(N(),O("img",{key:1,class:"add",src:ha,alt:"",onClick:t[9]||(t[9]=(...p)=>e.toggle&&e.toggle(...p))})):D("",!0)]),e.isShowtotalAmount?(N(),O("div",ja,[Va,a("span",null,[Ce("$ "),ae(E,{value:e.liquidityTotalAmount,placeholder:e.isInputTotalAmount?"":e.liquidityTotalAmount,onInput:t[10]||(t[10]=p=>e.onInput(p.target.value))},null,8,["value","placeholder"])])])):D("",!0),e.initPrice?(N(),qe(w,{key:1,"from-coin":e.fromCoin,"to-coin":e.toCoin,"from-coin-amount":e.fromCoinAmount,"to-coin-amount":e.toCoinAmount,"fixed-from-coin":e.fixedFromCoin,"is-input-total-amount":e.isInputTotalAmount,"create-pool-info":e.createPoolInfo,"min-price":e.minPrice,"max-price":e.maxPrice,"current-price-tab":"custom","current-price":e.currentPrice,"current-price-reverse":e.currentPriceReverse},null,8,["from-coin","to-coin","from-coin-amount","to-coin-amount","fixed-from-coin","is-input-total-amount","create-pool-info","min-price","max-price","current-price","current-price-reverse"])):D("",!0),e.isShowLiquidityModal?(N(),qe(j,{key:2,"pool-info":e.createPoolInfo,title:e.$t("newAdd.preview"),"from-coin-amount":e.fromCoinAmount,"to-coin-amount":e.toCoinAmount,"from-coin":e.fromCoin,"to-coin":e.toCoin,"fixed-from-coin":e.fixedFromCoin,"current-price":e.currentPrice,"current-price-reverse":e.currentPriceReverse,"current-price-tab":"custom","min-price":e.minPrice,"max-price":e.maxPrice,"show-from-coin-lock":e.showFromCoinLock,"show-to-coin-lock":e.showToCoinLock,"current-direct":e.direction,"is-increase":!1,onCreatePool:e.toCreatePool,onOnClose:t[11]||(t[11]=p=>e.isShowLiquidityModal=!1)},null,8,["pool-info","title","from-coin-amount","to-coin-amount","from-coin","to-coin","fixed-from-coin","current-price","current-price-reverse","min-price","max-price","show-from-coin-lock","show-to-coin-lock","current-direct","onCreatePool"])):D("",!0),ae(de,{class:"add-liquidity-btn",disabled:e.createPoolBtnDisabled,onClick:t[12]||(t[12]=p=>e.isShowLiquidityModal=!0)},{default:na(()=>[Ce(Go(e.createPoolBtnText),1)]),_:1},8,["disabled"]),e.isCreateSuccess?(N(),qe(g,{key:3,onOnClose:t[13]||(t[13]=p=>e.isCreateSuccess=!1)})):D("",!0)])}const za=Ge(Ba,[["render",Ea],["__scopeId","data-v-25e43d01"]]),Ha=Qe({components:{CreatePoolRight:za},setup(){const e=q(!0),t=q(!0),Y=q(!0),ve=q(!0),Z=q(!1),L=q("1"),H=q(!0),$=q(""),b=Xo(),E=ia(),w=Xe(),j=R(()=>w),de=ea(),g=R(()=>de),p=q("");ce(()=>[E,g.value.tokensObj],([l,B])=>{var P;((P=E==null?void 0:E.currentRoute)==null?void 0:P.value.name)=="liquidity-creat-pool"&&B&&(v.value=g.value.tokensObj[b.query.fromCoin],d.value=g.value.tokensObj[b.query.toCoin],console.log("z"),p.value=b.query.fee!=="null"&&b.query.fee?b.query.fee:"")},{immediate:!0,deep:!0}),ce(()=>[v.value,d.value,be.value,p.value,m.value,c.value,s.value,i.value],([l,B,P,pe,W,J,le])=>{!l||!B?(L.value="1",e.value=!0,t.value=!0,Y.value=!0):pe?P?!W||!J?(L.value="4",e.value=!1,t.value=!1,Y.value=!0):le||(L.value="5",e.value=!1,t.value=!1,Y.value=!1):(L.value="3",e.value=!1,t.value=!0,Y.value=!0):(L.value="2",e.value=!0,t.value=!0,Y.value=!0)},{immediate:!0});const G=l=>{be.value=l},je=l=>{var B;return(l==null?void 0:l.logoURI)||(l==null?void 0:l.logo_url)||((B=g.value.tokensObj[l==null?void 0:l.address])==null?void 0:B.logo_url)||(j.value.theme==="default"?Wo("/image/coins/unknown.png"):Wo("/image/coins/sui-unknown.png"))},z=l=>{switch(l){case"1":return{top:"10%"};case"2":return{top:"29%"};case"3":return{top:"48%"};case"4":return{top:"67%"};case"5":return{top:"87%"}}},V=R(()=>j.value.chainName),ie=R(()=>V.value?xo(V.value):{}),he=l=>{var Pe,Le,Se,$e,fe,Ne,Te,Be,Me,Ae,Fe,o,k,f;l?(be.value=l,se.value=l,We.value=new n(1).div(new n(l)).toString()):(be.value="",se.value="",We.value="");let B,P;const pe=g.value.poolConfigList;for(let C=0;C<pe.length;C++){const r=pe[C];if(r.token_a.address.toUpperCase()===((Se=(Le=(Pe=ee)==null?void 0:Pe.value)==null?void 0:Le.address)==null?void 0:Se.toUpperCase())&&r.token_b.address.toUpperCase()===((Ne=(fe=($e=oe)==null?void 0:$e.value)==null?void 0:fe.address)==null?void 0:Ne.toUpperCase())){B=r.needReverse,P=r;break}else if(r.token_b.address.toUpperCase()===((Me=(Be=(Te=ee)==null?void 0:Te.value)==null?void 0:Be.address)==null?void 0:Me.toUpperCase())&&r.token_a.address.toUpperCase()===((o=(Fe=(Ae=oe)==null?void 0:Ae.value)==null?void 0:Fe.address)==null?void 0:o.toUpperCase())){B=r.needReverse,P=r;break}}let W=!1;ie.value.getIsSortedSymbols((k=ee.value)==null?void 0:k.address,(f=oe.value)==null?void 0:f.address)&&(W=!0);let J;W&&!h.value?J=!0:W&&h.value||!W&&h.value?J=!1:J=!0;const le=V.value=="Aptos"?Pa:Sa;if(v.value&&d.value&&l){const C=P?P==null?void 0:P.token_a.decimals:W?oe.value.decimals:ee.value.decimals,r=P?P==null?void 0:P.token_b.decimals:W?ee.value.decimals:oe.value.decimals,A=l&&ie.value.TickMath.priceToSqrtPriceX64(J?new n(1/l):new n(l),C,r);console.log(A,"===>current_sqrt_price");const S=l&&ie.value.TickMath.priceToSqrtPriceX64(new n(1).div(l),v.value.decimals,d.value.decimals);console.log(!J,"===>!newDirect"),console.log(C,r,"decimalsA,decimalsB===>");const T=ie.value.TickMath.priceToTickIndex(J?new n(1).div(l):new n(l),C,r);console.log(T,"==>currentTickIndex");const _=T-le[b.query.fee]*5,y=T+le[b.query.fee]*5,F=ie.value.TickMath.tickIndexToPrice(_,C,r).toString(),U=ie.value.TickMath.tickIndexToPrice(y,C,r).toString();Re.value?(m.value="0",c.value="∞"):J?(m.value=String(1/U),c.value=String(1/F),ze.value=String(1/U),He.value=String(1/F)):(m.value=F,c.value=U,ze.value=F,He.value=U),console.log("0518###c####createPoolFromCoin.value####",ee.value),console.log("0518###c####createPoolToCoin.value####",oe.value),console.log("0518###c####createPoolNeedReverse####",W);const M={token_a:P?P.token_a:W?oe.value:ee.value,token_b:P?P.token_b:W?ee.value:oe.value,isCreate:!0,tickSpacing:le[b.query.fee],currentPrice:l,current_sqrt_price:A,tick_lower:_,tick_upper:y,current_tick_index:T,currentPriceReverse:Ca(String(1/l),6),reverse_current_sqrt_price:S,needReverse:B,fee:b.query.fee};u.value=M,console.log("0518###c####poolInfos####",M)}else u.value=null,m.value="",c.value=""},_e=()=>{Re.value=!Re.value,he(u.value.currentPrice)},ye=l=>{console.log(l,"####0731 priceRangeChangeMin"),m.value=l},Ve=l=>{c.value=l},me=()=>{var l,B;if(console.log(u.value,"==>createPoolInfo.value"),h.value=!h.value,u.value){he(ba(new n(1).div(u.value.currentPrice).toString(),(B=(l=d)==null?void 0:l.value)==null?void 0:B.decimals));const P=v.value;v.value=d.value,d.value=P,I.value?s.value=i.value:i.value=s.value}};return ua(()=>{Na()}),{amountLock:Y,currentStep:L,sliderStyle:z,coinAmount:Z,pricerange:$,fromCoin:v,toCoin:d,fee:p,direct:H,getCoinIcon:je,isSelectFullRange:ve,onInput:G,store:j,initPrice:be,inputPriceLock:e,specifyPriceLock:t,changeCurrentPrice:he,minPrice:m,maxPrice:c,defaultMinPrice:ze,defaultMaxPrice:He,clickFullRange:_e,createPoolInfo:u,isFullRange:Re,priceRangeChangeMin:ye,priceRangeChangeMax:Ve,fromCoinAmount:s,toggle:me}}});const te=e=>(Ko("data-v-ffaa8b79"),e=e(),Yo(),e),Wa={class:"creat-pool-container"},Xa={class:"creat-pool-left"},Qa={class:"progress"},Ga=te(()=>a("div",{class:"slider-ratio-content"},null,-1)),Ja=[Ga],Ka={class:"progress-text"},Ya={key:0},Za={key:0},xa={key:0},et={key:0},ot={key:0},at={class:"creat-pool-center"},tt={class:"title"},lt=te(()=>a("div",{class:"left"},"Set Initial Price",-1)),nt={class:"right"},st={key:0,class:"token-box"},it=te(()=>a("div",null,[a("svg",{class:"icon icon-up","aria-hidden":"true"},[a("use",{"xlink:href":"#icon-exchange_up1"})])],-1)),ut=te(()=>a("div",null,[a("svg",{class:"icon icon-down","aria-hidden":"true"},[a("use",{"xlink:href":"#icon-exchange_down1"})])],-1)),rt=[it,ut],ct={class:"content top-content"},vt=te(()=>a("div",{class:"top"},[a("span",null,"💡"),a("span",null,"Please set an initial price for this new pool to start.")],-1)),dt={class:"bottom"},mt={class:"input-div"},pt={key:0,class:"lock"},ft={class:"title"},gt=te(()=>a("div",{class:"left"},"Set Initial Price",-1)),kt={class:"right"},Ct={key:0,src:Ta},bt=te(()=>a("span",null,"Full Range",-1)),wt={class:"content bottom-content"},ht=te(()=>a("span",null,"💡",-1)),_t=te(()=>a("span",null,"Please specify a price range that you want to provide your liquidity within.",-1)),yt=[ht,_t],Pt={class:"bottom"},St={class:"set-price-box"},Nt={key:0,class:"lock"},Tt=te(()=>a("div",{class:"create-pool-warning"}," To create a new pool, the initial price you set must be within your price range. ",-1)),At={class:"creat-pool-right"},It={key:0,class:"lock"};function qt(e,t,Y,ve,Z,L){var j,de;const H=Jo,$=$a,b=ka,E=Qo("CreatePoolRight"),w=ra("image");return N(),O("div",Wa,[a("div",Xa,[a("div",Qa,[a("div",{class:"slider-ratio",style:ca(e.sliderStyle(e.currentStep))},Ja,4)]),a("div",Ka,[a("div",{class:ke(["row",!e.fromCoin||!e.toCoin?"color-text":""])},[e.fromCoin&&e.toCoin?(N(),O("span",Ya,"✓")):D("",!0),Ce(" Select Pool ")],2),a("div",{class:ke(["row",e.fee?"":"color-text"])},[e.fee?(N(),O("span",Za,"✓")):D("",!0),Ce(" Select Fee Tier ")],2),a("div",{class:ke(["row",e.initPrice?"":"color-text"])},[e.initPrice?(N(),O("span",xa,"✓")):D("",!0),Ce(" Set Initial Price ")],2),a("div",{class:ke(["row",!e.minPrice||!e.maxPrice?"color-text":""])},[e.minPrice&&e.maxPrice?(N(),O("span",et,"✓")):D("",!0),Ce(" Select Price Range ")],2),a("div",{class:ke(["row",e.fromCoinAmount?"":"color-text"])},[e.fromCoinAmount?(N(),O("span",ot,"✓")):D("",!0),Ce(" Confirm Liquidity ")],2)])]),a("div",at,[a("div",tt,[lt,a("div",nt,[e.fromCoin&&e.toCoin&&e.initPrice?(N(),O("div",st,[va(a("img",null,null,512),[[w,(j=e.fromCoin)==null?void 0:j.logo_url]]),a("span",null,Go((de=e.fromCoin)==null?void 0:de.symbol),1),a("div",{class:"icon-change",onClick:t[0]||(t[0]=(...g)=>e.toggle&&e.toggle(...g))},rt)])):D("",!0)])]),a("div",ct,[vt,a("div",dt,[a("div",mt,[ae(H,{type:"text",placeholder:"0.0",value:e.initPrice,onInput:t[1]||(t[1]=g=>e.changeCurrentPrice(g.target.value))},null,8,["value"])]),e.inputPriceLock?(N(),O("div",pt,[ae($)])):D("",!0)])]),a("div",ft,[gt,a("div",kt,[a("div",{class:ke(["radio",e.isFullRange?"active-radio":""]),onClick:t[2]||(t[2]=(...g)=>e.clickFullRange&&e.clickFullRange(...g))},[e.isFullRange?(N(),O("img",Ct)):D("",!0)],2),bt])]),a("div",wt,[a("div",{class:ke(["top",e.specifyPriceLock?"":"no-border"])},yt,2),a("div",Pt,[a("div",St,[ae(b,{min:e.minPrice,max:e.maxPrice,"from-coin":e.fromCoin,"to-coin":e.toCoin,direct:e.direct,"default-min-price":e.defaultMinPrice,"default-max-price":e.defaultMaxPrice,"pool-info":e.createPoolInfo,loading:!1,"current-price-tab":"custom",onOnChangeMinPrice:e.priceRangeChangeMin,onOnChangeMaxPrice:e.priceRangeChangeMax},null,8,["min","max","from-coin","to-coin","direct","default-min-price","default-max-price","pool-info","onOnChangeMinPrice","onOnChangeMaxPrice"])]),e.specifyPriceLock?(N(),O("div",Nt,[ae($)])):D("",!0),Tt])])]),a("div",At,[e.amountLock?(N(),O("div",It,[ae($)])):D("",!0),ae(E,{"create-pool-info":e.createPoolInfo,onToggle:e.toggle},null,8,["create-pool-info","onToggle"])])])}const ll=Ge(Ha,[["render",qt],["__scopeId","data-v-ffaa8b79"]]);export{ll as default};
