import{_ as vo}from"./refresh-icon.cc28270e.js";import{_ as fo,a as po}from"./coin-select.b53f1f36.js";import{a as bo,_ as Co}from"./network-tips.9ba0c7cb.js";import{i as G}from"./import-icon.de3e6c66.js";import{a as Ae,i as qe,u as ke,f as E,g as ye,o as Ee,_ as go,q as je,b as ho,D as p,s as he,p as Le,c as we}from"./pool.ccb2d30f.js";import{x as Qe,M as wo,a as Xe,b as S,r as u,e as Ie,K as So,o as b,c as Y,w as le,h as o,u as $,t as i,k as oe,f as A,s as ce,l as ee,B as He,p as Ne,m as Oe,Y as yo,A as z,j as P,R as Ao,T as ko,q as Io,z as No,a0 as Se,y as We,J as Oo,D as To}from"./entry.555960f3.js";/* empty css              *//* empty css              */import{_ as Bo}from"./img-leverage_2x.1c577303.js";/* empty css              *//* empty css              */import"./img-no-Positions_2x.01c4e398.js";const Me={SUI:{symbol:"SUI",name:"Sui Coin",decimals:8,balance:0,address:"0x84dc9d921d277db5047dcb17addc2ecfbddfad087dd4ea825b2d17785755cb29::cetus_faucet::BTC"},sBTC:{symbol:"sBTC",name:"Wrapped BTC",decimals:8,balance:0,address:"0x84dc9d921d277db5047dcb17addc2ecfbddfad087dd4ea825b2d17785755cb29::cetus_faucet::BTC"},sETH:{symbol:"sETH",name:"Wrapped Ether",decimals:8,balance:0,address:"0x84dc9d921d277db5047dcb17addc2ecfbddfad087dd4ea825b2d17785755cb29::cetus_faucet::ETH"},USDC:{symbol:"USDC",name:"USDC Coin",decimals:6,balance:12e3,address:"0x84dc9d921d277db5047dcb17addc2ecfbddfad087dd4ea825b2d17785755cb29::cetus_faucet::USDC"},USDT:{symbol:"USDT",name:"Tether USD",decimals:6,balance:1e4,address:"0x84dc9d921d277db5047dcb17addc2ecfbddfad087dd4ea825b2d17785755cb29::cetus_faucet::USDT"}},Uo={"USDT-USDC":{symbol:"USDT-USDC",name:"USDT-USDC",decimals:6,coinA:Me.USDT,coinB:Me.USDC,feeDenominator:"10000",feeNumerator:"1",fee:"0.01",address:"0x1ce98d89494e9d3d7935bc3bd5fc714fc2abb99db3f024162552c4ba172f4d28::amm_swap::PoolLiquidityCoin<0x84dc9d921d277db5047dcb17addc2ecfbddfad087dd4ea825b2d17785755cb29::cetus_faucet::USDT,0x84dc9d921d277db5047dcb17addc2ecfbddfad087dd4ea825b2d17785755cb29::cetus_faucet::USDC>"}};function Do(e,t){const c=Object.values(Uo).filter(m=>e===m.coinA.symbol&&t===m.coinB.symbol||e===m.coinB.symbol&&t===m.coinA.symbol);return c&&c[0]||null}const $o=Qe({components:{Modal:wo},props:{fromCoin:{type:Object,required:!0},toCoin:{type:Object,required:!0},fromCoinAmount:{type:String,required:!0},toCoinAmount:{type:String,required:!0},impact:{type:Number,required:!0},fee:{type:String,required:!0},fixedFromCoin:{type:Boolean,required:!0},formatFee:{type:String,default:""}},emits:["to-swap","on-close"],setup(e,t){const{t:c,locale:m}=Xe(),N=Ae(),R=qe();S(()=>R);const d=S(()=>{const f=Do(e.fromCoin.symbol,e.toCoin.symbol);return ye(Ee(e.fromCoinAmount).mul(Ee(f.fee).div(100)).toString(),e.fromCoin.decimals)}),T=u(N.slippage||.5),k=u(!0),V=u(!1);function x(f){k.value=f}const M=async()=>{t.emit("to-swap")},X=ke(),I=S(()=>X),H=S(()=>I.value.tokensObj&&e.fromCoin.address&&I.value.tokensObj[e.fromCoin.address]&&I.value.tokensObj[e.fromCoin.address].logoURI),q=S(()=>I.value.tokensObj&&e.toCoin.address&&I.value.tokensObj[e.toCoin.address]&&I.value.tokensObj[e.toCoin.address].logoURI);return{fromCoinUrl:H,toCoinUrl:q,t:c,importIcon:G,fixD:E,decimalFormat:ye,direct:k,changeDirect:x,rateChange:V,clickNextBtn:M,slippage:T,liquidityProviderFee:d}}});const Te=e=>(Ne("data-v-b18c1738"),e=e(),Oe(),e),Ro=Te(()=>o("svg",{class:"icon modal-icon-close","aria-hidden":"true"},[o("use",{"xlink:href":"#icon-a-icon-Shutdown"})],-1)),Po={class:"swap-confirm-container"},Fo={class:"card-content"},_o={class:"top"},Eo={class:"coin"},jo=["src"],Lo=Te(()=>o("div",{class:"svg-box"},[o("svg",{class:"icon modal-icon-close","aria-hidden":"true"},[o("use",{"xlink:href":"#icon-icon-swap2"})])],-1)),Wo={class:"coin"},Mo=["src"],qo={class:"bottom"},Qo={class:"induction"},Xo={class:"item"},Ho={class:"induction-text"},Jo={class:"induction-value induction-value-change"},Zo={key:0},Ko={key:1},Yo=Te(()=>o("use",{"xlink:href":"#icon-a-icon-change2"},null,-1)),zo=[Yo],Go={class:"item"},Vo={class:"induction-text"},xo={class:"induction-value"},en={class:"item"},on={class:"induction-text"},nn={class:"induction-value"},sn={class:"item"},an={class:"induction-text"},tn={class:"item"},ln={class:"induction-text"},rn={class:"induction-value"};function un(e,t,c,m,N,R){const d=He,T=So("Modal");return b(),Y(T,{width:"440px",visible:!0,footer:null,title:e.$t("modal.swapConfirmTitle"),class:"swap-confirm-modal",onCancel:t[2]||(t[2]=k=>e.$emit("on-close"))},{closeIcon:le(()=>[Ro]),default:le(()=>[o("div",Po,[o("div",Fo,[o("div",_o,[o("div",Eo,[o("img",{src:e.fromCoinUrl||("importIcon"in e?e.importIcon:$(G))(`/image/coins/${e.fromCoin.symbol.toLowerCase()}.png`)},null,8,jo),o("p",null,i(e.fromCoinAmount),1),oe("    "),o("p",null,i(e.fromCoin.symbol),1)]),Lo,o("div",Wo,[o("img",{src:e.toCoinUrl||("importIcon"in e?e.importIcon:$(G))(`/image/coins/${e.toCoin.symbol.toLowerCase()}.png`)},null,8,Mo),o("p",null,i(e.toCoinAmount),1),oe("    "),o("p",null,i(e.toCoin.symbol),1)])]),o("div",qo,[o("div",Qo,[o("div",Xo,[o("div",Ho,i(e.$t("common.rate")),1),o("div",Jo,[e.rateChange?(b(),A("span",Ko," 1 "+i(e.toCoin.symbol)+" ≈ "+i(("fixD"in e?e.fixD:$(E))(Number(e.fromCoinAmount)/Number(e.toCoinAmount),e.toCoin.decimals))+" "+i(e.fromCoin.symbol),1)):(b(),A("span",Zo," 1 "+i(e.fromCoin.symbol)+" ≈ "+i(("fixD"in e?e.fixD:$(E))(Number(e.toCoinAmount)/Number(e.fromCoinAmount),e.toCoin.decimals))+" "+i(e.toCoin.symbol),1)),(b(),A("svg",{class:"icon-change","aria-hidden":"true",onClick:t[0]||(t[0]=k=>e.rateChange=!e.rateChange)},zo))])]),o("div",Go,[o("div",Vo,i(e.$t("modal.slippageTolerance")),1),o("div",xo,i(e.slippage)+"%",1)]),o("div",en,[o("div",on,i(e.fixedFromCoin?e.$t("common.minimumReceived"):e.$t("common.maximumSold")),1),o("div",nn,i(e.fixedFromCoin?("fixD"in e?e.fixD:$(E))(e.toCoinAmount-Number(e.toCoinAmount)*Number(e.slippage)/100,e.toCoin.decimals):("fixD"in e?e.fixD:$(E))(Number(e.fromCoinAmount)*Number(e.slippage)/100+Number(e.fromCoinAmount),e.fromCoin.decimals))+" "+i(e.fixedFromCoin?e.toCoin.symbol:e.fromCoin.symbol),1)]),o("div",sn,[o("div",an,i(e.$t("common.priceImpact")),1),o("div",{class:ce(["induction-value",e.impact<1?"impact-s":e.impact<10&&e.impact>1?"impact-w":"impact-e"])},i(e.impact<.01?"<0.01":e.impact>100?"100":e.impact)+"% ",3)]),o("div",tn,[o("div",ln,i(e.$t("common.fee")),1),o("div",rn,i(e.formatFee)+" "+i(e.fromCoin.symbol)+" ("+i(e.fee*100)+"%) ",1)])])])])]),ee(d,{class:"big-btn swap-confirm-btn",onClick:t[1]||(t[1]=k=>e.clickNextBtn())},{default:le(()=>[oe(i(e.$t("button.confirmSwap")),1)]),_:1})]),_:1},8,["title"])}const dn=Ie($o,[["render",un],["__scopeId","data-v-b18c1738"]]);async function cn(e){const{prices:t}=await $fetch(`https://api.coingecko.com/api/v3/coins/${e}/market_chart?vs_currency=usd&id=${e}&days=1&interval=hourly`,{headers:{Connection:"keep-alive",Accept:"*/*"}});return t}const mn={props:{coin:{type:Object,default:()=>({})},refresh:{type:Boolean,default:!1},id:{type:String,default:""}},setup(e,t){const{$echarts:c}=yo();let m=null,N;const R=u(!0),d=(g,y,r)=>{N={xAxis:{type:"category",boundaryGap:!1,show:!1,data:y},yAxis:{type:"value",show:!1,min:function(n){return n.min-n.min*.1},max:function(n){return n.max+n.max*.1}},grid:{top:1,right:1,bottom:1,left:1},tooltip:{trigger:"axis",borderWidth:0,padding:0,backgroundColor:"transparent",axisPointer:{lineStyle:{color:I.value.chainName=="Aptos"?"#68FFD8":"#76C8FF"}},formatter:function(n){return`<div class="chart-tip">
              <div>${n&&n[0]&&n[0].name}</div>
              <div>$${E(n&&n[0]&&n[0].value,4)}</div>
            </chart-tip>`}},color:{type:"linear",x:0,y:0,x2:0,y2:1,colorStops:[{offset:0,color:I.value.chainName=="Aptos"?"#0C4535":"#2E546D"},{offset:1,color:I.value.chainName=="Aptos"?"#151817":"#1B1B1B"}]},series:[{data:g,type:"line",showSymbol:!1,areaStyle:{},lineStyle:{color:I.value.chainName=="Aptos"?"#68FFD8":"#76C8FF",width:2,type:"solid"}}]},N&&m.clear(),N&&m.setOption(N,!0),m.resize(),R.value=!1},T=ke(),k=S(()=>T),V=u(""),x=u(""),M=async g=>{var J,ne;const y=[],r=[],n=await cn(g);V.value=n&&n.length>1&&(n[n.length-1][1]-n[0][1])/n[0][1]*100,x.value=n&&n.length>1&&n[n.length-1][1],n.forEach(ae=>{y.push(ae[1]);const me=je(ae[0],"MD"),O=je(ae[0],"HM");r.push(me+" "+O)});let ue=document.getElementById(`main${(J=e.coin)==null?void 0:J.name}`);m=c.init(ue),d(y,r,(ne=e.coin)==null?void 0:ne.name)},X=Ae(),I=S(()=>X),H=S(()=>I.value.chainName),q=S(()=>go[H.value]);z(()=>e.id,(g,y)=>{console.log(g,y,"===>oldValue"),console.log(!R.value,"!isFirst.value"),g&&setTimeout(()=>{M(g)},1e3)},{immediate:!0});const f=u(""),C=u(""),re=u("");return z(()=>[k.value.tokensObj,e.coin],([g,y])=>{var r,n;g&&y&&g[y.address]&&(console.log(g[y.address],"===>newValue[coin.address]"),C.value=((r=g[y.address])==null?void 0:r.labels)&&((n=g[y.address])==null?void 0:n.labels[0]),f.value=g[y.address].name,re.value=g[y.address].symbol)},{immediate:!0,deep:!0}),z(()=>e.refresh,g=>{g&&M(e.id)}),{store:X,importIcon:G,fixD:E,config:q,price_rate_24h:V,nowPrice:x,coinName:f,coinLabels:C,coinSymbol:re}}};const vn=e=>(Ne("data-v-f7d5a1ed"),e=e(),Oe(),e),fn={class:"token-info"},pn={class:"token-info-padding"},bn={class:"token-info-header"},Cn={class:"left"},gn=["src"],hn={class:"name"},wn={class:"desc"},Sn={class:"right"},yn={class:"price"},An={class:"token-info-footer"},kn={class:"left"},In={class:"address"},Nn={class:"pc-address"},On={class:"h5-address"},Tn=vn(()=>o("use",{"xlink:href":"#icon-icon-copy"},null,-1)),Bn=[Tn],Un={class:"right"},Dn=["id"];function $n(e,t,c,m,N,R){var d;return b(),A("div",fn,[o("div",pn,[o("div",bn,[o("div",Cn,[o("img",{src:c.coin.logoURI||m.importIcon(`/image/coins/${c.coin.symbol.toLowerCase()}.png`)},null,8,gn),o("div",null,[o("div",hn,i(m.coinSymbol),1),o("div",wn,[o("span",null,i(m.coinName)+" "+i(m.coinLabels?`(${m.coinLabels})`:""),1)])])]),o("div",Sn,[o("div",yn,"$"+i(m.fixD(m.nowPrice,2)),1),m.price_rate_24h?(b(),A("div",{key:0,class:ce(m.price_rate_24h>0?"increase up":m.price_rate_24h<0?"increase down":"increase up")},i(m.price_rate_24h>0?`+ ${m.fixD(m.price_rate_24h,2)}`:m.price_rate_24h<0?+`${m.fixD(m.price_rate_24h,2)}`:`+${m.fixD(m.price_rate_24h,2)}`)+"% ",3)):P("",!0)])]),o("div",An,[o("div",kn,[o("div",In,[o("span",Nn,i(c.coin&&c.coin.address.substr(0,8))+" ... "+i(c.coin&&c.coin.address.substr(c.coin.address.length-8,8)),1),o("span",On,i(c.coin&&c.coin.address.substr(0,4))+" ... "+i(c.coin&&c.coin.address.substr(c.coin.address.length-4,4)),1),(b(),A("svg",{class:"icon","aria-hidden":"true",onClick:t[0]||(t[0]=T=>m.store.copy(c.coin&&c.coin.address))},Bn))])]),o("div",Un,[o("div",{id:`main${(d=c.coin)==null?void 0:d.name}`,class:"main"},null,8,Dn)])])])])}const Rn=Ie(mn,[["render",$n],["__scopeId","data-v-f7d5a1ed"]]),Pn=Qe({setup(){const e=We(),t=Ao(ko,{style:{fontSize:"12px",color:"#fff",paddingBottom:"3px"},spin:!0}),{t:c,locale:m}=Xe(),N=Ae(),R=ke(),d=S(()=>R);let T=u(!1),k=u(!1),V=u(!1),x=u(!1),M=u(!1),X=u(!1);const I=u("fromCoin"),H=u(""),q=u(""),f=u(!1),C=u(!0),re=u(!1),g=u(!1),y=u(!1),r=u(""),n=u(""),ue=u(20),J=u(0),ne=u(null),ae=u(!1),me=S(()=>N.slippage),O=S(()=>N.chainName),F=S(()=>O.value?ho(O.value):{}),s=u(),l=u(),be=S(()=>R.getPoolInfoSuccess),Je=S(()=>h.value&&h.value.is_pause?"Pool Closed":!s.value||!l.value?c("modal.selectTokenModalTitle"):!h.value&&be.value?"Pool Not Found":ae.value?c("button.insufficientLiquidity"):!Number(r.value)||Number(r.value)==0||Number(n.value)==0?c("button.enterAmount"):Number(r.value)>Number(_.value)?c("button.insufficientBalance",{name:s.value.symbol}):c("button.swap")),Ze=a=>{var w,v,L,B;I.value=a,a==="fromCoin"?(H.value=((w=l.value)==null?void 0:w.address)||"",q.value=((v=s.value)==null?void 0:v.address)||""):(H.value=((L=s.value)==null?void 0:L.address)||"",q.value=((B=l.value)==null?void 0:B.address)||""),f.value=!0},Ke=a=>{r.value="",n.value="",I.value==="fromCoin"?(l.value&&a.address.toLowerCase()===(l==null?void 0:l.value.address.toLowerCase())&&(l.value=null),s.value=a):(s.value&&a.address.toLowerCase()===(s==null?void 0:s.value.address.toLowerCase())&&(s.value=null),l.value=a),f.value=!1},Ye=a=>{a==="fromCoin"?(C.value=!0,O.value==="Aptos"?r.value=_.value>0?s.value.symbol=="APT"?new p(Number(_.value)).sub(new p(.1)).lt(new p(0))?"0":new p(Number(_.value)).sub(new p(.1)).toString():String(_.value):"":r.value=_.value>0?s.value.symbol=="SUI"?new p(Number(_.value)).sub(new p(1e-4)).lt(new p(0))?"0":new p(Number(_.value)).sub(new p(1e-4)).toString():String(_.value):""):(C.value=!1,O.value==="Aptos"?n.value=j.value>0?l.value.symbol=="APT"?new p(Number(j.value)).sub(new p(.1)).lt(new p(0))?"0":new p(Number(j.value)).sub(new p(.1)).toString():String(j.value):"":n.value=j.value>0?l.value.symbol=="SUI"?new p(Number(j.value)).sub(new p(1e-4)).lt(new p(0))?"0":new p(Number(j.value)).sub(new p(1e-4)).toString():String(j.value):"")},ze=a=>{a==="fromCoin"?(C.value=!0,r.value=_.value>0?he(new p(Number(_.value)).div(2).toString(),s.value.decimals).toString():""):(C.value=!1,n.value=j.value>0?he(new p(Number(j.value)).div(2).toString(),l.value.decimals).toString():"")};Io(()=>{Ce()}),No(()=>{clearInterval(ne.value)});const Ge=()=>{h.value&&(clearInterval(ne.value),J.value=0,k.value=!0,R.updateCurrentPools(h.value.poolAddress,O.value),te(C.value?r.value:n.value),N.getStatsData(O.value),setTimeout(()=>{k.value=!1,Ce()},1e3))},Ve=()=>{const a=s.value;s.value=l.value,l.value=a,T.value=!0,C.value=!C.value,C.value?(r.value=n.value,n.value=""):(n.value=r.value,r.value=""),setTimeout(()=>{T.value=!1},300)},Ce=()=>{ne.value=setInterval(()=>{k.value=!1,re.value||J.value<ue.value&&(J.value+=1,J.value===ue.value&&(h.value&&h.value.poolAddress&&R.updateCurrentPools(h.value.poolAddress,O.value),J.value=0,k.value=!0))},1e3)};z(C,Se((a,w)=>{C.value=a},500));const Be=u(!1);z(r,Se((a,w)=>{a&&C.value&&te(a),a==""&&C.value&&(n.value="")},500)),z(n,Se((a,w)=>{a&&!C.value&&te(a),a==""&&!C.value&&(r.value="")},500));const Ue=u(1e-4),xe=()=>{if(h.value.current_sqrt_price&&r.value&&n.value){const w=(s.value.address===h.value.coinA.address&&l.value.address===h.value.coinB.address?0:1)==0,v=new p(r.value),L=new p(n.value),B=v.sub(v.mul(new p(h.value.fee)).div(100));console.log("getImpact###fAmount####",v.toString()),console.log("getImpact###tAmount####",L.toString()),console.log("getImpact###f####",B.toString());const Z=L.div(B);return console.log("getImpact####rates####",Z.toString()),F.value.getPriceImpactPct(h.value,Z.toString(),w)}return 1e-4},De=u(0),$e=u(0),te=async a=>{if(h.value)if(s.value&&l.value&&(r.value||n.value)){g.value=!0,y.value=!0,Be.value=!0,console.log(h.value,"poolInfo=====>451");const w=s.value.address===h.value.coinA.address&&l.value.address===h.value.coinB.address?0:1;console.log(C.value?r.value:n.value,"fixedFromCoin.value ? fromCoinAmount.value : toCoinAmount.value"),console.log(w,"===>direct");try{const v=await F.value.preSwap({pool:h.value,a2b:w==0,byAmountIn:C.value,amount:C.value?r.value:n.value});console.log(v,"preSwapRespreSwapRes"),ae.value=v.isExceed,C.value?(n.value=v.estimatedAmountOut,M.value?ve.value=(a/Number(v.estimatedAmountOut)).toString():fe.value=(Number(v.estimatedAmountOut)/a).toString()):(r.value=v.estimatedAmountIn,M.value?ve.value=(Number(v.estimatedAmountIn)/a).toString():fe.value=(a/Number(v.estimatedAmountIn)).toString()),De.value=Number(n.value)/Number(r.value),$e.value=Number(r.value)/Number(n.value),Ue.value=xe(),g.value=!1,y.value=!1}catch(v){console.log("pre swap error",v),g.value=!1,y.value=!1}}else C.value?n.value="":r.value="",g.value=!1,y.value=!1},eo=qe(),Q=S(()=>eo),oo=u({}),ve=u(""),fe=u("");z(T,()=>{ve.value="",fe.value="",C.value?te(r.value):te(n.value)});const _=S(()=>Q.value.assets&&s.value&&Q.value.assets[s.value.address]?Le(Q.value.assets[s.value.address].balance,s.value.decimals):0),j=S(()=>Q.value.assets&&l.value&&Q.value.assets[l.value.address]?Le(Q.value.assets[l.value.address].balance,l.value.decimals):0),no=We();z(()=>d.value.tokensObj,async a=>{if(!we(a)){console.log(a,"===>newValue626"),console.log(no,"===>route625");const w=e?e.currentRoute.value.query.to:"",v=e?e.currentRoute.value.query.from:"";v?s.value=await F.value.getTokenBySymbol(a,v):(s.value=await F.value.getTokenBySymbol(a,N.chainName==="Aptos"?"0x5e156f1207d0ebfa19a9eeff00d62a282278fb8719f4fab3a586a0a2c0fffbea::coin::T":"0x4d892ceccd1497b9be7701e09d51c580bc83f22c9c97050821b373a77d0d9a9e::usdt::USDT"),console.log(s.value,"===>fromCoin.value")),w?l.value=await F.value.getTokenBySymbol(a,w):l.value=await F.value.getTokenBySymbol(a,N.chainName==="Aptos"?"0x1::aptos_coin::AptosCoin":"0x4d892ceccd1497b9be7701e09d51c580bc83f22c9c97050821b373a77d0d9a9e::usdc::USDC"),!v&&w&&(s.value="")}},{immediate:!0});const h=S(()=>{var a,w,v,L;if(d.value.tokensObj&&s.value&&l.value){let B=null;const Z={};if(Object.values(d.value.poolConfigList).forEach(U=>{var D,de,K,W;(U.coinA.address.toUpperCase()===((D=s.value.address)==null?void 0:D.toUpperCase())&&U.coinB.address.toUpperCase()===((de=l.value.address)==null?void 0:de.toUpperCase())||U.coinB.address.toUpperCase()===((K=s.value.address)==null?void 0:K.toUpperCase())&&U.coinA.address.toUpperCase()===((W=l.value.address)==null?void 0:W.toUpperCase()))&&(Z[U.address]={...U})}),d.value.poolsObj&&!we(d.value.poolsObj))for(const U in d.value.poolsObj){const D=d.value.poolsObj[U];(D.token_a.address.toUpperCase()===((a=s.value.address)==null?void 0:a.toUpperCase())&&D.token_b.address.toUpperCase()===((w=l.value.address)==null?void 0:w.toUpperCase())||D.token_b.address.toUpperCase()===((v=s.value.address)==null?void 0:v.toUpperCase())&&D.token_a.address.toUpperCase()===((L=l.value.address)==null?void 0:L.toUpperCase()))&&(Z[D.address]={...D})}return B=Object.values(Z).sort((U,D)=>U.fee-D.fee)[0],console.log("0412###swap###poolInfo###",B),B&&!we(B)?B:null}return null}),Re=u(!0),ge=u(!1),so=async a=>{a&&(te(C.value?r.value:n.value),ge.value=!0,a.coinA.symbol.toLowerCase()===s.value.symbol.toLowerCase()&&a.coinB.symbol.toLowerCase()===l.value.symbol.toLowerCase()?Re.value=!0:Re.value=!1)};z(()=>h.value,(a,w)=>{a&&(!w||a.address!==w.address||a.current_sqrt_price!==w.current_sqrt_price)&&so(a)},{immediate:!0,deep:!0});const ao=S(()=>d.value.tokensObj&&s.value&&s.value.address&&d.value.tokensObj[s.value.address]&&d.value.tokensObj[s.value.address].logoURI),to=S(()=>(console.log(d.value.tokensObj,"===>pools.value.tokensObj"),d.value.tokensObj&&l.value&&l.value.address&&d.value.tokensObj[l.value.address]&&d.value.tokensObj[l.value.address].logoURI)),io=S(()=>d.value.tokensObj&&s.value&&s.value.address&&d.value.tokensObj[s.value.address]&&d.value.tokensObj[s.value.address].coingecko_id||null),lo=S(()=>d.value.tokensObj&&l.value&&l.value.address&&d.value.tokensObj[l.value.address]&&d.value.tokensObj[l.value.address].coingecko_id||null),ro=S(()=>{const a=new p(r.value),w=new p(h.value.fee),v=a.mul(w).toString();return console.log(v,"===>fee"),Number(v)<1/Math.pow(10,s.value.decimals)?`<${new p(1).div(new p(Math.pow(10,s.value.decimals))).toString()}`:he(v,s.value.decimals)}),{setIsShowSuccess:uo,setIsShowRejected:Pe,setIsShowWaiting:pe,setTransactionDesc:co,setTransactionTxid:Fe}=N,mo=async()=>{var w,v,L,B,Z,U,D,de;X.value=!1,g.value=!0,Fe(""),co(c("tips.swapping",{from:`${r.value} ${(w=s.value)==null?void 0:w.symbol}`,to:`${n.value} ${(v=l.value)==null?void 0:v.symbol}`})),pe(!0);const a=s.value.address===h.value.token_a.address&&l.value.address===h.value.token_b.address?0:1;try{console.log("0221####swap start####",O.value,"###",F),console.log("0412###toSwap###poolInfo.value###",h.value);const K=await F.value.getSwapTransactionPayload({pool:h.value,a2b:a==0,byAmountIn:C.value,amount:C.value?r.value:n.value,slippage:Number(me.value)/100});console.log("0221####swap###swapPayload###",K);let W;if(O.value==="Aptos")W=await Q.value.currentWallet.signAndSubmitTransaction(K);else{console.log("0221###swap###sui##signAndExecuteTransaction前###",O.value,"###swapPayload###",K);const ie=await Q.value.currentWallet.signAndExecuteTransactionBlock(K);console.log("0221###sui swap res###",ie),W=F.value.handleTx(ie),console.log("0221###swap###sui##tx###",W)}if(W&&W.hash){Fe(W.hash),pe(!1),uo(!0);const ie={title:c("tips.swap"),desc:c("tips.swapSuccessText",{from:`${r.value} ${(L=s.value)==null?void 0:L.symbol}`,to:`${n.value} ${(B=l.value)==null?void 0:B.symbol}`}),hash:W.hash,tit:"Swap",icon:"icon-icon-swap1",tokenInfo:{tokena:`${(Z=s.value)==null?void 0:Z.symbol}`,numa:`- ${r.value}`,logoa:d.value.tokensObj&&s.value&&s.value.address&&d.value.tokensObj[s.value.address]&&d.value.tokensObj[s.value.address].logoURI,tokenb:`${(U=l.value)==null?void 0:U.symbol}`,numb:`+ ${n.value}`,logob:d.value.tokensObj&&l.value&&l.value.address&&d.value.tokensObj[l.value.address]&&d.value.tokensObj[l.value.address].logoURI},text:`Pay ${r.value} ${(D=s.value)==null?void 0:D.symbol} to receive ${n.value} ${(de=l.value)==null?void 0:de.symbol}`};O.value!=="Aptos"&&(ie.res=W.res),F.value.showTransitionPending(ie);const _e=await F.value.watchTransaction(ie);console.log("0221###swap###transitionStatus####",_e),_e&&setTimeout(()=>{R.updateCurrentPools(h.value.poolAddress,O.value),F.value.getAccount(Q.value.address)},1e3)}else pe(!1),Pe(!0);r.value="",n.value="",g.value=!1}catch(K){r.value="",n.value="",console.log("Swap Error###",K),g.value=!1,pe(!1),Pe(!0)}};return console.log(ge.value,be.value,"===>getPoolInfoSuccess"),{hasPool:ge,getPoolInfoSuccess:be,halfBtnSelect:ze,formCoinId:io,toCoinId:lo,fromCoinUrl:ao,toCoinUrl:to,t:c,indicator:t,wallet:Q,currentLpInfo:oo,fixD:E,decimalFormat:ye,impact:Ue,oneFromAmount:ve,oneToAmount:fe,importIcon:G,clickExchange:Ve,clickRefresh:Ge,refresh:k,change:T,isShowAddress:V,isShowSwapSetting:x,fromCoin:s,toCoin:l,slippage:me,openCoinSelect:Ze,onCoinSelect:Ke,existingCoins:H,lastSelectCoin:q,currentCoinKey:I,showCoinSelect:f,fromCoinAmount:r,toCoinAmount:n,maxBtnSelect:Ye,fixedFromCoin:C,swapBtnText:Je,toSwap:mo,loading:re,swaping:g,autoRefreshTime:ue,countdown:J,setMarketTimer:Ce,marketTimer:ne,rateChange:M,isSwapConfirmMpdal:X,fromCoinBlance:_,toCoinBlance:j,poolInfo:h,chainName:O,swapRouterLoading:Be,formatFee:ro,calculating:y,currentRate:De,currentRateReverse:$e}}}),Fn="data:image/png;base64,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";const se=e=>(Ne("data-v-7d440934"),e=e(),Oe(),e),_n={class:"swap-container"},En={class:"title"},jn={class:"left"},Ln={class:"right title-right"},Wn=se(()=>o("svg",{class:"icon","aria-hidden":"true"},[o("use",{"xlink:href":"#icon-a-icon-setslippage"})],-1)),Mn={class:"swap-card"},qn={class:"card-container"},Qn={class:"card-item"},Xn={class:"card-item"},Hn=se(()=>o("use",{"xlink:href":"#icon-icon-swap1"},null,-1)),Jn=[Hn],Zn={key:0,class:"induction"},Kn={key:0,class:"exchange-rate-btn"},Yn={key:0},zn=["src"],Gn={key:0},Vn=["src"],xn={key:0},es={key:1},os={key:0},ns=["src"],ss=["src"],as=se(()=>o("use",{"xlink:href":"#icon-a-icon-change2"},null,-1)),ts=[as],is={class:"item"},ls={class:"induction-text"},rs={key:1},us={class:"item"},ds={class:"induction-text"},cs={class:"induction-value"},ms={class:"item"},vs={class:"induction-text"},fs={class:"induction-value"},ps={key:0,class:"icon","aria-hidden":"true"},bs=se(()=>o("use",{"xlink:href":"#icon-icon-swap"},null,-1)),Cs=[bs],gs={key:3,class:"token-info-container"},hs={class:"token-info-title"},ws=se(()=>o("span",{class:"coingecko"},"Ref. CoinGecko",-1)),Ss=se(()=>o("img",{src:Fn,alt:""},null,-1)),ys=se(()=>o("svg",{class:"icon","aria-hidden":"true"},[o("use",{"xlink:href":"#icon-icon-information"})],-1));function As(e,t,c,m,N,R){const d=vo,T=fo,k=Oo,V=He,x=bo,M=po,X=Co,I=dn,H=To,q=Rn;return b(),A("div",_n,[o("div",En,[o("div",jn,i(e.$t("menu.swap")),1),o("div",Ln,[o("div",{class:"slippage-icon",onClick:t[0]||(t[0]=f=>e.isShowSwapSetting=!0)},[Wn,o("span",null,i(e.slippage)+"%",1)]),ee(d,{loading:e.refresh,"auto-refresh-time":e.autoRefreshTime,countdown:e.countdown,onClickRefresh:e.clickRefresh},null,8,["loading","auto-refresh-time","countdown","onClickRefresh"])])]),o("div",Mn,[o("div",qn,[o("div",Qn,[ee(T,{modelValue:e.fromCoinAmount,"onUpdate:modelValue":t[1]||(t[1]=f=>e.fromCoinAmount=f),"input-value":e.fromCoinAmount,"coin-symbol":e.fromCoin?e.fromCoin.symbol:null,"coin-name":e.fromCoin?e.fromCoin.name:null,balance:e.fromCoinBlance,"coin-icon":e.fromCoin?e.fromCoin.logo_url:"",address:e.fromCoin?e.fromCoin.address:"","swap-direction":"From",onOnMax:t[2]||(t[2]=f=>e.maxBtnSelect("fromCoin")),onOnHalf:t[3]||(t[3]=f=>e.halfBtnSelect("fromCoin")),onOnInput:t[4]||(t[4]=f=>{e.fromCoinAmount=f,e.fixedFromCoin=!0}),onOnSelect:t[5]||(t[5]=f=>e.openCoinSelect("fromCoin"))},null,8,["modelValue","input-value","coin-symbol","coin-name","balance","coin-icon","address"])]),o("div",Xn,[ee(T,{modelValue:e.toCoinAmount,"onUpdate:modelValue":t[6]||(t[6]=f=>e.toCoinAmount=f),"input-value":e.toCoinAmount,havemax:!1,"coin-symbol":e.toCoin?e.toCoin.symbol:null,"coin-name":e.toCoin?e.toCoin.name:null,balance:e.toCoinBlance,"swap-direction":"To","coin-icon":e.toCoin?e.toCoin.logo_url:"",address:e.toCoin?e.toCoin.address:"",onOnInput:t[7]||(t[7]=f=>{e.toCoinAmount=f,e.fixedFromCoin=!1}),onOnSelect:t[8]||(t[8]=f=>e.openCoinSelect("toCoin"))},null,8,["modelValue","input-value","coin-symbol","coin-name","balance","coin-icon","address"])]),o("img",{class:ce(e.change?"gang animationex":"gang"),src:Bo,alt:""},null,2),o("div",{class:"exchange",onClick:t[9]||(t[9]=f=>e.clickExchange())},[(b(),A("svg",{class:ce(e.change?"icon animationex":"icon"),"aria-hidden":"true"},Jn,2))])]),e.poolInfo&&e.fromCoinAmount&&e.toCoinAmount&&e.fromCoinAmount!=="0"&&e.toCoinAmount!=="0"&&e.swapBtnText!==e.$t("button.poolNotFound")?(b(),A("div",Zn,[e.fromCoinAmount&&e.toCoinAmount?(b(),A("div",Kn,[e.rateChange?Number(e.fromCoinAmount)&&Number(e.toCoinAmount)&&e.rateChange?(b(),A("span",es,[Number(e.fromCoinAmount)&&Number(e.toCoinAmount)?(b(),A("span",os,[o("img",{src:e.toCoinUrl||("importIcon"in e?e.importIcon:$(G))(`/image/coins/${e.toCoin.symbol.toLowerCase()}.png`)},null,8,ns),oe(" 1 "+i(e.toCoin.symbol)+" ≈ ",1),o("img",{src:e.fromCoinUrl||("importIcon"in e?e.importIcon:$(G))(`/image/coins/${e.fromCoin.symbol.toLowerCase()}.png`)},null,8,ss),oe(" "+i(("fixD"in e?e.fixD:$(E))(e.currentRateReverse,e.fromCoin.decimals))+" "+i(e.fromCoin.symbol),1)])):(b(),Y(k,{key:1,indicator:e.indicator},null,8,["indicator"]))])):P("",!0):(b(),A("span",Yn,[o("img",{src:e.fromCoinUrl||("importIcon"in e?e.importIcon:$(G))(`/image/coins/${e.fromCoin.symbol.toLowerCase()}.png`)},null,8,zn),oe(" 1 "+i(e.fromCoin.symbol)+" ≈ ",1),Number(e.fromCoinAmount)&&Number(e.toCoinAmount)?(b(),A("span",Gn,[o("img",{src:e.toCoinUrl||("importIcon"in e?e.importIcon:$(G))(`/image/coins/${e.toCoin.symbol.toLowerCase()}.png`)},null,8,Vn),e.calculating?P("",!0):(b(),A("span",xn,i(("fixD"in e?e.fixD:$(E))(e.currentRate,e.toCoin.decimals)),1)),e.calculating?(b(),Y(k,{key:1,indicator:e.indicator},null,8,["indicator"])):P("",!0),oe(" "+i(e.toCoin.symbol),1)])):(b(),Y(k,{key:1,indicator:e.indicator},null,8,["indicator"]))])),(b(),A("svg",{class:"icon-change","aria-hidden":"true",onClick:t[10]||(t[10]=f=>e.rateChange=!e.rateChange)},ts))])):P("",!0),o("div",is,[o("div",ls,i(e.$t("common.priceImpact")),1),e.swaping?(b(),A("div",rs,[ee(k,{indicator:e.indicator},null,8,["indicator"])])):(b(),A("div",{key:0,class:ce(["induction-value",e.impact<1?"impact-s":e.impact<10&&e.impact>1?"impact-w":"impact-e"])},i(e.impact<.01?"<0.01":e.impact>100?"100":e.impact)+"% ",3))]),o("div",us,[o("div",ds,i(e.fixedFromCoin?e.$t("common.minimumReceived"):e.$t("common.maximumSold")),1),o("div",cs,i(e.fixedFromCoin?("fixD"in e?e.fixD:$(E))(Number(e.toCoinAmount)-Number(e.toCoinAmount)*Number(e.slippage)/100,e.toCoin.decimals):("fixD"in e?e.fixD:$(E))(Number(e.fromCoinAmount)*Number(e.slippage)/100+Number(e.fromCoinAmount),e.fromCoin.decimals))+" "+i(e.fixedFromCoin?e.toCoin.symbol:e.fromCoin.symbol),1)]),o("div",ms,[o("div",vs,i(e.$t("common.fee")),1),o("div",fs,i(e.formatFee)+" "+i(e.fromCoin.symbol)+" ("+i(e.poolInfo.fee*100)+"%) ",1)])])):P("",!0)]),ee(V,{disabled:e.wallet.connected?e.swaping||!e.fromCoin||!e.toCoin||!Number(e.fromCoinAmount)||!Number(e.toCoinAmount)||Number(e.fromCoinAmount)>Number(e.fromCoinBlance)||e.swapBtnText==e.$t("button.poolNotFound")||e.swapBtnText!==e.$t("button.swap")||e.poolInfo.is_pause:!1,class:"big-btn",loading:e.swaping,onClick:t[11]||(t[11]=f=>e.wallet.connected?e.isSwapConfirmMpdal=!0:e.wallet.setIsShowWalletModal(!0))},{default:le(()=>[e.wallet.connected?(b(),A("svg",ps,Cs)):P("",!0),o("span",null,i(e.wallet.connected?e.swapBtnText:e.$t("button.connectWallet")),1)]),_:1},8,["disabled","loading"]),ee(x),e.showCoinSelect?(b(),Y(M,{key:0,"existing-coins":e.existingCoins,"last-select-coin":e.lastSelectCoin,onOnSelect:e.onCoinSelect,onOnClose:t[12]||(t[12]=f=>e.showCoinSelect=!1)},null,8,["existing-coins","last-select-coin","onOnSelect"])):P("",!0),e.isShowSwapSetting?(b(),Y(X,{key:1,onOnClose:t[13]||(t[13]=f=>e.isShowSwapSetting=!1)})):P("",!0),e.isSwapConfirmMpdal?(b(),Y(I,{key:2,"fixed-from-coin":e.fixedFromCoin,"from-coin":e.fromCoin,"to-coin":e.toCoin,"from-coin-amount":e.fromCoinAmount,"to-coin-amount":e.toCoinAmount,impact:e.impact,fee:e.poolInfo.fee,"format-fee":e.formatFee,onOnClose:t[14]||(t[14]=f=>e.isSwapConfirmMpdal=!1),onToSwap:e.toSwap},null,8,["fixed-from-coin","from-coin","to-coin","from-coin-amount","to-coin-amount","impact","fee","format-fee","onToSwap"])):P("",!0),e.chainName&&(e.formCoinId||e.toCoinId)?(b(),A("div",gs,[o("div",hs,[ws,Ss,ee(H,{placement:"top","arrow-point-at-center":""},{title:le(()=>[oe(" The following price is only an external reference from CoinGecko, which may not reflect actual data on Cetus. ")]),default:le(()=>[ys]),_:1})]),e.fromCoin&&e.formCoinId?(b(),Y(q,{key:0,id:e.formCoinId,coin:e.fromCoin,refresh:e.refresh},null,8,["id","coin","refresh"])):P("",!0),e.toCoin&&e.toCoinId?(b(),Y(q,{key:1,id:e.toCoinId,coin:e.toCoin,refresh:e.refresh},null,8,["id","coin","refresh"])):P("",!0)])):P("",!0)])}const _s=Ie(Pn,[["render",As],["__scopeId","data-v-7d440934"]]);export{_s as default};
