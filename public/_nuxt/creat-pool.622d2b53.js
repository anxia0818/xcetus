import{u as Je,a as ua,c as ra}from"./sha256.97b1e8c2.js";import{a as Ke,m as R,e as Ye,o as _,f as $,r as F,E as Yo,l as ia,D as se,Q as Zo,i as le,h as t,x as M,c as qe,w as Qo,j as Ce,v as Ve,I as xo,B as ca,p as ea,k as oa,b as va,C as da,q as ma,H as pa,z as ge,t as fa,u as ga}from"./entry.06373f20.js";import{_ as ka,b as Ca}from"./new-add-or-create.9f13df24.js";import{_ as ba}from"./lock.49c9cd6d.js";import{_ as wa,a as aa,b as ha,c as ya}from"./new-liquidity-title.c0a5487f.js";import{i as Qe}from"./import-icon.de3e6c66.js";/* empty css              */import{a as ta,u as la,p as Go,s as Jo,c as Ko,f as je,i as _a,b as Pa,d as Sa}from"./pool.68b91df5.js";import{_ as Na,a as Ta,s as Aa}from"./poolFee.44de5aa9.js";import{D as l}from"./decimal.0e8aa3f1.js";import{fromCoin as c,toCoin as d,fromCoinAmount as s,toCoinAmount as r,maxPrice as p,minPrice as f,createPoolInfo as v,showFromCoinLock as Y,showToCoinLock as Z,amountLock as ke,fixedFromCoin as A,currentPriceReverse as Ge,currentPrice as ue,initPrice as be,direction as y,createPoolFromCoin as x,createPoolToCoin as ee,isFullRange as Re,resetData as Ia,defaultMinPrice as He,defaultMaxPrice as Xe}from"./create-pool-data.3326775c.js";import{_ as qa,a as Ra}from"./icon-Add-Liquidity_2x.0acb06cb.js";import{_ as $a}from"./icon-selected_3x.09e9a6f0.js";import"./token-warning.dec0de57.js";import"./status-block.6e12844a.js";/* empty css              *//* empty css              */import"./notifi.2313fd4c.js";import"./useWhale.8949bb19.js";import"./index.c5eb0457.js";/* empty css              */import"./tick.505fdad3.js";/* empty css              */import"./refresh-icon.87a2307b.js";/* empty css              */import"./swap-setting.fe695109.js";const La=Ke({setup(){const e=Je();return{storeIndex:R(()=>e)}}});const Ba={class:"create-pool-lock"},Ma={key:0,src:ka,alt:""},Fa={key:1,src:ba,alt:""};function Ua(e,a,we,de,U,z){return _(),$("div",Ba,[e.storeIndex.theme=="default"?(_(),$("img",Ma)):(_(),$("img",Fa))])}const na=Ye(La,[["render",Ua],["__scopeId","data-v-fb497971"]]),Oa=Ke({components:{NewLiquidityTile:wa,NewLiquidityDepositRatio:aa},setup(e,a){const we=ua(),de=Je(),U=R(()=>de),z=R(()=>U.value.chainName),j=R(()=>we),N=F(!1);F(),F(),F(),F(!1);const P=Yo(),{t:H,locale:ie}=ia(),L=R(()=>z.value?ta(z.value):{}),V=la(),T=R(()=>V),C=R(()=>U.value.theme),E=R(()=>j.value.assets&&c.value&&j.value.assets[c.value.address]?Go(j.value.assets[c.value.address].balance,c.value.decimals):"0"),W=R(()=>j.value.assets&&d.value&&j.value.assets[d.value.address]?Go(j.value.assets[d.value.address].balance,d.value.decimals):"0"),ye=o=>{o==="fromCoin"?(A.value=!0,z.value==="Aptos"?s.value=Number(E.value)>0?c.value.symbol=="APT"?new l(Number(E.value)).sub(new l(.1)).lt(new l(0))?"0":new l(Number(E.value)).sub(new l(.1)).toString():String(E.value):"":s.value=Number(E.value)>0?c.value.symbol=="SUI"?new l(Number(E.value)).sub(new l(.05)).lt(new l(0))?"0":new l(Number(E.value)).sub(new l(.05)).toString():String(E.value):""):(A.value=!1,z.value==="Aptos"?r.value=Number(W.value)>0?d.value.symbol=="APT"?new l(Number(W.value)).sub(new l(.1)).lt(new l(0))?"0":new l(Number(W.value)).sub(new l(.1)).toString():String(W.value):"":r.value=Number(W.value)>0?d.value.symbol=="SUI"?new l(Number(W.value)).sub(new l(.05)).lt(new l(0))?"0":new l(Number(W.value)).sub(new l(.05)).toString():String(W.value):"")},ce=o=>{o==="fromCoin"?(A.value=!0,s.value=Number(E.value)>0?Jo(new l(Number(E.value)).div(2).toString(),c.value.decimals).toString():""):(A.value=!1,r.value=Number(W.value)>0?Jo(new l(Number(W.value)).div(2).toString(),d.value.decimals).toString():"")};se(()=>[T.value.tokens,P.query],async([o])=>{if(o&&o.length>0){const i=o;if(P&&P.query&&P.query.fromCoin&&(console.log("0410###deposite###watch###route.query.tokena####",P.query.fromCoin),P.query.fromCoin)){const u=await L.value.getTokenBySymbol(i,P.query.fromCoin);c.value=u,x.value=u}if(P&&P.query&&P.query.toCoin&&P.query.toCoin){const u=await L.value.getTokenBySymbol(i,P.query.toCoin);d.value=u,ee.value=u}}},{immediate:!0});const oe=F("--"),_e=R(()=>U.value.slippage),Ee=F(),me=async()=>{if(!f.value&&!p.value)return!1;if(!s.value&&!r.value&&!f.value&&!p.value)return;const o=v.value;if(Ko(o))return;const{TickUtil:i,TickMath:u,getNearestTickByTick:m}=L.value,w=o==null?void 0:o.token_a.decimals,I=o==null?void 0:o.token_b.decimals;let k,q,h,g,B,O,D=o.current_tick_index,Q;if(console.log(o,"==>poolInfos"),o.token_a.address.toLowerCase()===c.value.address.toLowerCase()&&o.token_b.address.toLowerCase()===d.value.address.toLowerCase()?Q=!0:Q=!1,f.value==="0"&&p.value==="∞")h=i.getMinIndex(Number(o.tickSpacing)),g=i.getMaxIndex(Number(o.tickSpacing));else{console.log(Q,"===>directs1866"),Q?(k=Number(f.value),q=Number(p.value)):(k=new l(1).div(p.value).toString(),q=new l(1).div(f.value).toString()),console.log("0518###pre###directs###",Q),console.log("0518###pre###minPrice###",f.value),console.log("0518###pre###maxPrice###",p.value),console.log("0518###pre###poolInfos###",o),console.log("0518###pre###decimalsA###",w),console.log("0518###pre###decimalsB###",I),console.log(k,q,"min max1875"),console.log(f.value,p.value,"===>maxPrice.value");try{B=k==0?-443636:u.priceToTickIndex(new l(k),w,I)}catch{B=-443636}try{O=u.priceToTickIndex(new l(q),w,I)}catch{O=443636}h=m(B,Number(o.tickSpacing)),g=m(O,Number(o.tickSpacing))}if(console.log("0518###pre###currentTickIndex###",D,h,g),p.value!=="∞"&&h>=g){Y.value=!0,s.value="",Z.value=!0,r.value="";return}if(console.log(g,D,h,"1922"),p.value==="∞"||D>=h&&D<=g){Y.value=!1,Z.value=!1;let ae;if(s.value||r.value){if(A.value){const he=new l(s.value).mul(Math.pow(10,c.value.decimals)).toString();ae=new je(he)}else{const he=new l(r.value).mul(Math.pow(10,d.value.decimals)).toString();ae=new je(he)}console.log(Q,"======>directs");const{liquidityAmount:G,tokenMaxA:J,tokenMaxB:te,tokenMaxAOrigin:Oe,tokenMaxBOrigin:De}=L.value.estLiquidityAndcoinAmountFromOneAmounts({tokenA:o.token_a,tokenB:o.token_b,lowerTick:h,upperTick:g,coinAmount:ae,iscoinA:Q?A.value:!A.value,roundUp:!0,slippage:Number(_e.value)/100,curSqrtPrice:new je(o.current_sqrt_price)});Ee.value={liquidityAmount:G,tokenMaxA:J,tokenMaxB:te,tokenMaxAOrigin:Oe,tokenMaxBOrigin:De},console.log(te,J,"tokenMaxB===>tokenMaxA"),Q?A.value?r.value=Number(te)>0?te:"":s.value=Number(J)>0?J:"":A.value?r.value=J:s.value=te}}else D>g?(Y.value=!0,Z.value=!0):D<h?(Y.value=!0,Z.value=!0):(Y.value=!0,s.value="",Z.value=!0,r.value="")};se(()=>be.value,o=>{o&&me()},{immediate:!0}),se(s,(o,i)=>{console.log(s,"===>fromCoinAmount"),o==""&&A.value&&(r.value=""),o&&A.value&&!N.value&&me()}),se(r,(o,i)=>{console.log(o,"===>>>>newValsda"),o==""&&!A.value&&(s.value=""),o&&!A.value&&!N.value&&me()}),se(()=>Re.value,o=>{me()});const We=o=>{console.log(o,"e"),N.value=!0,oe.value=o,o>0?pe():(s.value="",r.value="")};se([f,p],([o,i])=>{console.log(o,i,"==>minPrice,maxPrice"),Number(o)!==0&&Number(i)!==0&&!N.value?me():Number(o)!==0&&Number(i)!==0&&N.value&&pe()},{immediate:!0});const n=()=>{const o=b.value&&b.value[c.value.address]&&b.value[c.value.address].price,i=b.value&&b.value[d.value.address]&&b.value[d.value.address].price;if(o&&i){const u=new l(s.value>0?s.value:0).mul(o),m=new l(r.value>0?r.value:0).mul(i),w=u.add(m).toNumber();oe.value=w>0&&w<.01?"<0.01":_a(w,2)}else oe.value="--"};se(()=>[s.value,r.value,N.value],([o,i,u])=>{(o||i)&&!u?n():(!o||!i)&&!u&&(oe.value="--")},{immediate:!0});const b=R(()=>T.value.RATES),S=F(),pe=async()=>{if(!f.value&&!p.value)return!1;if(!s.value&&!r.value&&!f.value&&!p.value)return;const o=v.value;if(Ko(o))return;const{TickUtil:i,TickMath:u,getNearestTickByTick:m}=L.value,w=o==null?void 0:o.token_a.decimals,I=o==null?void 0:o.token_b.decimals;let k,q,h,g,B,O,D;if(o.token_a.address.toLowerCase()===c.value.address.toLowerCase()&&o.token_b.address.toLowerCase()===d.value.address.toLowerCase()?D=!0:D=!1,f.value==="0"&&p.value==="∞")h=i.getMinIndex(Number(o.tickSpacing)),g=i.getMaxIndex(Number(o.tickSpacing));else{D?(k=Number(f.value),q=Number(p.value)):(k=new l(1).div(p.value).toString(),q=new l(1).div(f.value).toString());try{B=k==0?-443636:u.priceToTickIndex(new l(k),w,I)}catch{B=-443636}try{O=u.priceToTickIndex(new l(q),w,I)}catch{O=443636}h=m(B,Number(o.tickSpacing)),g=m(O,Number(o.tickSpacing))}console.log(o.token_a,"poolInfos===>");const Q=b.value[o==null?void 0:o.token_a.address].price,ae=b.value[o==null?void 0:o.token_b.address].price;console.log(h,g,"####tick_lower tick_upper 889");try{const{amountA:G,amountB:J,tokenAmountsInfo:te}=await L.value.estCoinAmountsFromTotalAmount({lowerTick:h,upperTick:g,decimalsA:w,decimalsB:I,curSqrtPrice:new je(o.current_sqrt_price),totalAmount:oe.value,tokenPriceA:Q,tokenPriceB:ae});console.log(G,J,"###estCoinAmountsFromTotalAmount 844"),S.value=te,o.needReverse?y.value?(s.value=G,r.value=J):(s.value=J,r.value=G):(s.value=G,r.value=J)}catch(G){console.log(G,"e===>")}},X=R(()=>{var u,m,w,I,k,q,h,g;const o=(w=b.value[(m=(u=c)==null?void 0:u.value)==null?void 0:m.address])==null?void 0:w.price,i=(q=b.value[(k=(I=d)==null?void 0:I.value)==null?void 0:k.address])==null?void 0:q.price;return console.log(b.value,(g=(h=c)==null?void 0:h.value)==null?void 0:g.address,"===>fromCoin?.value?.address"),!!(o&&i)}),K=()=>{a.emit("toggle")},ne=F(!1);R(()=>{if(T.value.poolConfigList&&c.value&&d.value){const o=T.value.poolConfigList.filter(u=>{var m,w,I,k;return u.token_a.address.toUpperCase()===((m=c.value.address)==null?void 0:m.toUpperCase())&&u.token_b.address.toUpperCase()===((w=d.value.address)==null?void 0:w.toUpperCase())||u.token_b.address.toUpperCase()===((I=c.value.address)==null?void 0:I.toUpperCase())&&u.token_a.address.toUpperCase()===((k=d.value.address)==null?void 0:k.toUpperCase())});console.log(o,"===>info");const i=[];return o.forEach(u=>{i.push(Number(u.fee))}),console.log(i,"===>>result"),i}else return[]}),R(()=>{var o;return(o=U.value)==null?void 0:o.filterCreatePoolCoin});const Pe=R(()=>{var o;return!c.value||!d.value?H("modal.selectTokenModalTitle"):!((o=P.query)!=null&&o.fee)&&ra[z.value].hasCreatePool?"Select fee tier":!Number(s.value)&&!Number(r.value)?H("button.enterAmount"):Number(s.value)>Number(E.value)?H("button.insufficientBalance",{name:c.value.symbol}):Number(r.value)>Number(W.value)?H("button.insufficientBalance",{name:d.value.symbol}):p.value!=="∞"&&Number(f.value)>=Number(p.value)?H("newAdd.invalidRange"):H("newAdd.preview")}),$e=o=>{const i=new RegExp("[^\\d-]*(\\d*(?:\\.\\d{0,2})?).*$");o.target.value=o.target.value.replace(i,"$1")},Le=R(()=>{var o;return!s.value&&!r.value?(console.log("addLiquidityBtnDisabled11111"),!0):Number(s.value)>Number(E.value)||Number(r.value)>Number(W.value)?(console.log("addLiquidityBtnDisabled22222"),!0):Pe.value!==H("newAdd.preview")?!0:!v.value&&!((o=v.value)!=null&&o.currentPrice)?(console.log("addLiquidityBtnDisabled55555"),!0):!!(Number(s.value)<=0&&Number(r.value)<=0||Y.value||Z.value)}),{setTransactionTxid:Se,setTransactionDesc:Be,setIsShowWaiting:fe,setIsShowSuccess:Ne,setIsShowRejected:Te,setPositiomNum:Me}=de,Fe=()=>{z.value=="Sui"&&Ue()},Ae=F(!1),Ue=async()=>{var Q,ae,G,J,te,Oe,De,he,Ze,xe,eo,oo,ao,to,lo,no,so,uo,ro,io,co,vo,mo,po,fo,go,ko,Co,bo,wo,ho,yo,_o,Po,So,No,To,Ao,Io,qo,Ro,$o,Lo,Bo,Mo,Fo,Uo,Oo,Do,jo,Vo,Eo,Wo,zo,Ho,Xo;ne.value=!1,console.log("创建sui池子");let o=!1;L.value.getIsSortedSymbols(x.value.address,ee.value.address)&&(o=!0),Se("");const i=Y.value?"":`${s.value} ${(Q=c.value)==null?void 0:Q.symbol}`,u=Z.value?"":`${r.value} ${(ae=d.value)==null?void 0:ae.symbol}`;console.log("0424###createPoolFromCoin###",x.value),console.log("0424###createPoolToCoin###",ee.value),console.log("0424###needReverse###",o),console.log("0424###createPoolInfo?.value?.needReverse###",(J=(G=v)==null?void 0:G.value)==null?void 0:J.needReverse),Be(H("tips.increaseLiquiditySuccess",{from:!o&&!((Oe=(te=v)==null?void 0:te.value)!=null&&Oe.needReverse)||o&&((he=(De=v)==null?void 0:De.value)!=null&&he.needReverse)?i:u,and:!Y.value&&!Z.value?"and":"",to:!o&&!((xe=(Ze=v)==null?void 0:Ze.value)!=null&&xe.needReverse)||o&&((oo=(eo=v)==null?void 0:eo.value)!=null&&oo.needReverse)?u:i})),fe(!0);let m="",w="",I="",k="",q="",h="",g=0,B=0,O=!1,D;if(o||(to=(ao=v)==null?void 0:ao.value)!=null&&to.needReverse){const ve=o&&!((no=(lo=v)==null?void 0:lo.value)!=null&&no.needReverse);m=ve?(vo=(co=(io=v)==null?void 0:io.value)==null?void 0:co.token_b)==null?void 0:vo.address:(ro=(uo=(so=v)==null?void 0:so.value)==null?void 0:uo.token_a)==null?void 0:ro.address,w=ve?(Co=(ko=(go=v)==null?void 0:go.value)==null?void 0:ko.token_a)==null?void 0:Co.address:(fo=(po=(mo=v)==null?void 0:mo.value)==null?void 0:po.token_b)==null?void 0:fo.address,I=ve?(Po=(_o=(yo=v)==null?void 0:yo.value)==null?void 0:_o.token_b)==null?void 0:Po.decimals:(ho=(wo=(bo=v)==null?void 0:bo.value)==null?void 0:wo.token_a)==null?void 0:ho.decimals,k=ve?(qo=(Io=(Ao=v)==null?void 0:Ao.value)==null?void 0:Io.token_a)==null?void 0:qo.decimals:(To=(No=(So=v)==null?void 0:So.value)==null?void 0:No.token_b)==null?void 0:To.decimals,($o=(Ro=v)==null?void 0:Ro.value)!=null&&$o.needReverse?(q=y.value?s.value:r.value,h=y.value?r.value:s.value,g=y.value?Number(f.value):1/Number(p.value),B=y.value?Number(p.value):1/Number(f.value),O=y.value?A.value:!A.value,D=y.value?ue.value:1/Number(ue.value)):(q=y.value?r.value:s.value,h=y.value?s.value:r.value,g=y.value?1/Number(p.value):Number(f.value),B=y.value?1/Number(f.value):Number(p.value),O=y.value?!A.value:A.value,D=y.value?1/Number(ue.value):ue.value)}else m=(Mo=(Bo=(Lo=v)==null?void 0:Lo.value)==null?void 0:Bo.token_a)==null?void 0:Mo.address,w=(Oo=(Uo=(Fo=v)==null?void 0:Fo.value)==null?void 0:Uo.token_b)==null?void 0:Oo.address,I=(Vo=(jo=(Do=v)==null?void 0:Do.value)==null?void 0:jo.token_a)==null?void 0:Vo.decimals,k=(zo=(Wo=(Eo=v)==null?void 0:Eo.value)==null?void 0:Wo.token_b)==null?void 0:zo.decimals,q=y.value?s.value:r.value,h=y.value?r.value:s.value,g=y.value?Number(f.value):1/Number(p.value),B=y.value?Number(p.value):1/Number(f.value),O=y.value?A.value:!A.value,D=y.value?ue.value:1/Number(ue.value);try{console.log("0501###toCreatePool###params###",{coinTypeA:m,coinTypeB:w,decimalsA:I,decimalsB:k,amountA:q,amountB:h,minPrice:g,maxPrice:B,fix_amount_a:O,tick_spacing:Number(v.value.tickSpacing),slippage:Number(_e.value)/100,price:D});const ve=await L.value.getCreatPoolTransactionPayload({coinTypeA:m,coinTypeB:w,decimalsA:I,decimalsB:k,amountA:q,amountB:h,minPrice:f.value=="0"&&p.value=="∞"?"0":g,maxPrice:f.value=="0"&&p.value=="∞"?"∞":B,fix_amount_a:O,tick_spacing:Number(v.value.tickSpacing),slippage:Number(_e.value)/100,price:D}),sa=await j.value.currentWallet.signAndExecuteTransactionBlock(ve),Ie=L.value.handleTx(sa);if(Ie&&Ie.hash){Se(Ie.hash),fe(!1),Ne(!0);const ze={title:"Created pool",desc:"Pool created successfully ",hash:Ie.hash,tit:"Pool Created",icon:"icon-icon-Position-Created",tokenInfo:{tokena:`${(Ho=c.value)==null?void 0:Ho.address}`,numa:Y.value?"":`- ${s.value}`,logoa:T.value.tokensObj&&c.value&&c.value.address&&T.value.tokensObj[c.value.address]&&T.value.tokensObj[c.value.address].logoURI,tokenb:`${(Xo=d.value)==null?void 0:Xo.address}`,numb:Z.value?"":`- ${r.value}`,logob:T.value.tokensObj&&d.value&&d.value.address&&T.value.tokensObj[d.value.address]&&T.value.tokensObj[d.value.address].logoURI},text:"Pool created successfully"};z.value!=="Aptos"&&(ze.res=Ie.res),L.value.showTransitionPending(ze),(await L.value.watchTransaction(ze,!0)).status&&(Ne(!1),Ae.value=!0,setTimeout(()=>{V.setPoolConfigList(z.value,U.value.filterCoinsObj),L.value.getAccount(j.value.address)},1e3)),Me()}else fe(!1),Te(!0);s.value="",r.value=""}catch(ve){console.log("0407###createPool###error##",ve),ne.value=!1,V.setPoolConfigList(z.value,U.value.filterCoinsObj),s.value="",r.value="",fe(!1),Te(!0)}};return{amountLock:ke,wallet:j,inputChange:$e,fromCoinAmount:s,toCoinAmount:r,fromCoin:c,toCoin:d,maxBtnSelect:ye,halfBtnSelect:ce,showFromCoinLock:Y,showToCoinLock:Z,fromCoinBlance:E,toCoinBlance:W,fixedFromCoin:A,isInputTotalAmount:N,toggle:K,theme:C,liquidityTotalAmount:oe,createPoolInfo:v,minPrice:f,maxPrice:p,currentPriceReverse:Ge,currentPrice:ue,onInput:We,initPrice:be,isShowtotalAmount:X,direction:y,isShowLiquidityModal:ne,createPoolBtnText:Pe,createPoolBtnDisabled:Le,toCreatePool:Fe,isCreateSuccess:Ae}}});const Da=e=>(ea("data-v-da5d2794"),e=e(),oa(),e),ja={class:"create-pool-right"},Va={class:"card-container"},Ea={key:0,class:"lock"},Wa={class:"card-item"},za={class:"card-item"},Ha={key:0,class:"total-amount"},Xa=Da(()=>t("span",null,"Total Amount",-1));function Qa(e,a,we,de,U,z){const j=Zo("NewLiquidityTile"),N=na,P=ha,H=xo,ie=aa,L=Ca,V=ca,T=Na;return _(),$("div",ja,[le(j),t("div",Va,[e.amountLock||e.showFromCoinLock||e.showToCoinLock?(_(),$("div",Ea,[le(N)])):M("",!0),t("div",Wa,[le(P,{modelValue:e.fromCoinAmount,"onUpdate:modelValue":a[0]||(a[0]=C=>e.fromCoinAmount=C),"input-value":e.fromCoinAmount,"coin-symbol":e.fromCoin?e.fromCoin.symbol:null,"coin-name":e.fromCoin?e.fromCoin.name:null,balance:e.fromCoinBlance,"coin-icon":e.fromCoin?e.fromCoin.logoURI:"",address:e.fromCoin?e.fromCoin.address:"","swap-direct":"From","import-page":"deposit","has-arrow":!1,onOnMax:a[1]||(a[1]=C=>e.maxBtnSelect("fromCoin")),onOnHalf:a[2]||(a[2]=C=>e.halfBtnSelect("fromCoin")),onOnInput:a[3]||(a[3]=C=>{e.fromCoinAmount=C,e.fixedFromCoin=!0,e.isInputTotalAmount=!1})},null,8,["modelValue","input-value","coin-symbol","coin-name","balance","coin-icon","address"])]),t("div",za,[le(P,{modelValue:e.toCoinAmount,"onUpdate:modelValue":a[4]||(a[4]=C=>e.toCoinAmount=C),"input-value":e.toCoinAmount,"coin-symbol":e.toCoin?e.toCoin.symbol:null,"coin-name":e.toCoin?e.toCoin.name:null,balance:e.toCoinBlance,"swap-direct":"To","coin-icon":e.toCoin?e.toCoin.logoURI:"",address:e.toCoin?e.toCoin.address:"","import-page":"deposit","has-arrow":!1,onOnMax:a[5]||(a[5]=C=>e.maxBtnSelect("toCoin")),onOnHalf:a[6]||(a[6]=C=>e.halfBtnSelect("toCoin")),onOnInput:a[7]||(a[7]=C=>{e.toCoinAmount=C,e.fixedFromCoin=!1,e.isInputTotalAmount=!1})},null,8,["modelValue","input-value","coin-symbol","coin-name","balance","coin-icon","address"])]),e.fromCoin&&e.toCoin&&!e.showToCoinLock&&!e.showFromCoinLock&&e.theme=="default"?(_(),$("img",{key:1,class:"add",src:qa,alt:"",onClick:a[8]||(a[8]=(...C)=>e.toggle&&e.toggle(...C))})):M("",!0),e.fromCoin&&e.toCoin&&!e.showToCoinLock&&!e.showFromCoinLock&&e.theme!=="default"?(_(),$("img",{key:2,class:"add",src:Ra,alt:"",onClick:a[9]||(a[9]=(...C)=>e.toggle&&e.toggle(...C))})):M("",!0)]),e.isShowtotalAmount?(_(),$("div",Ha,[Xa,t("span",null,[le(H,{value:"$"+e.liquidityTotalAmount,placeholder:e.isInputTotalAmount?"":e.liquidityTotalAmount,onChange:e.inputChange,onInput:a[10]||(a[10]=C=>e.onInput(C.target.value))},null,8,["value","placeholder","onChange"])])])):M("",!0),e.initPrice?(_(),qe(ie,{key:1,"from-coin":e.fromCoin,"to-coin":e.toCoin,"from-coin-amount":e.fromCoinAmount,"to-coin-amount":e.toCoinAmount,"fixed-from-coin":e.fixedFromCoin,"is-input-total-amount":e.isInputTotalAmount,"create-pool-info":e.createPoolInfo,"min-price":e.minPrice,"max-price":e.maxPrice,"current-price-tab":"custom","current-price":e.currentPrice,"current-price-reverse":e.currentPriceReverse},null,8,["from-coin","to-coin","from-coin-amount","to-coin-amount","fixed-from-coin","is-input-total-amount","create-pool-info","min-price","max-price","current-price","current-price-reverse"])):M("",!0),e.isShowLiquidityModal?(_(),qe(L,{key:2,"pool-info":e.createPoolInfo,title:e.$t("newAdd.preview"),"from-coin-amount":e.fromCoinAmount,"to-coin-amount":e.toCoinAmount,"from-coin":e.fromCoin,"to-coin":e.toCoin,"fixed-from-coin":e.fixedFromCoin,"current-price":e.currentPrice,"current-price-reverse":e.currentPriceReverse,"current-price-tab":"custom","min-price":e.minPrice,"max-price":e.maxPrice,"show-from-coin-lock":e.showFromCoinLock,"show-to-coin-lock":e.showToCoinLock,"current-direct":e.direction,"is-increase":!1,onCreatePool:e.toCreatePool,onOnClose:a[11]||(a[11]=C=>e.isShowLiquidityModal=!1)},null,8,["pool-info","title","from-coin-amount","to-coin-amount","from-coin","to-coin","fixed-from-coin","current-price","current-price-reverse","min-price","max-price","show-from-coin-lock","show-to-coin-lock","current-direct","onCreatePool"])):M("",!0),e.wallet.connected?(_(),qe(V,{key:4,class:"add-liquidity-btn",disabled:e.wallet.connected?e.createPoolBtnDisabled:!1,onClick:a[13]||(a[13]=C=>e.isShowLiquidityModal=!0)},{default:Qo(()=>[Ce(Ve(e.createPoolBtnText),1)]),_:1},8,["disabled"])):(_(),qe(V,{key:3,class:"add-liquidity-btn",onClick:a[12]||(a[12]=C=>e.wallet.setIsShowWalletModal(!0))},{default:Qo(()=>[Ce(Ve(e.$t("button.connectWallet")),1)]),_:1})),e.isCreateSuccess?(_(),qe(T,{key:5,onOnClose:a[14]||(a[14]=C=>e.isCreateSuccess=!1)})):M("",!0)])}const Ga=Ye(Oa,[["render",Qa],["__scopeId","data-v-da5d2794"]]),Ja=Ke({components:{CreatePoolRight:Ga},setup(){const e=F(!0),a=F(!0),we=F(!0),de=F(!1),U=F("1"),z=F(!0),j=F(""),N=Yo(),P=va(),H=Je(),ie=R(()=>H),L=la(),V=R(()=>L),T=F("");se(()=>[P,V.value.tokensObj],([n,b])=>{var S;((S=P==null?void 0:P.currentRoute)==null?void 0:S.value.name)=="liquidity-creat-pool"&&b&&(c.value=V.value.tokensObj[N.query.fromCoin],d.value=V.value.tokensObj[N.query.toCoin],console.log("z"),T.value=N.query.fee!=="null"&&N.query.fee?N.query.fee:"")},{immediate:!0,deep:!0}),se(()=>[c.value,d.value,be.value,T.value,f.value,p.value,s.value,r.value],([n,b,S,pe,X,K,ne])=>{!n||!b?(U.value="1",e.value=!0,a.value=!0,ke.value=!0):pe?S?!X||!K?(U.value="4",e.value=!1,a.value=!1,ke.value=!0):ne||(U.value="5",e.value=!1,a.value=!1,ke.value=!1):(U.value="3",e.value=!1,a.value=!0,ke.value=!0):(U.value="2",e.value=!0,a.value=!0,ke.value=!0)},{immediate:!0});const C=n=>{be.value=n},E=n=>{var b;return(n==null?void 0:n.logoURI)||(n==null?void 0:n.logo_url)||((b=V.value.tokensObj[n==null?void 0:n.address])==null?void 0:b.logo_url)||(ie.value.theme==="default"?Qe("/image/coins/unknown.png"):Qe("/image/coins/sui-unknown.png"))},W=n=>{switch(n){case"1":return{top:"10%"};case"2":return{top:"29%"};case"3":return{top:"48%"};case"4":return{top:"67%"};case"5":return{top:"87%"}}},ye=R(()=>ie.value.chainName),ce=R(()=>ye.value?ta(ye.value):{}),oe=n=>{var Pe,$e,Le,Se,Be,fe,Ne,Te,Me,Fe,Ae,Ue,o,i;n?(be.value=n,ue.value=n,Ge.value=new l(1).div(new l(n)).toString()):(be.value="",ue.value="",Ge.value="");let b,S;const pe=V.value.poolConfigList;for(let u=0;u<pe.length;u++){const m=pe[u];if(m.token_a.address.toUpperCase()===((Le=($e=(Pe=x)==null?void 0:Pe.value)==null?void 0:$e.address)==null?void 0:Le.toUpperCase())&&m.token_b.address.toUpperCase()===((fe=(Be=(Se=ee)==null?void 0:Se.value)==null?void 0:Be.address)==null?void 0:fe.toUpperCase())){b=m.needReverse,S=m;break}else if(m.token_b.address.toUpperCase()===((Me=(Te=(Ne=x)==null?void 0:Ne.value)==null?void 0:Te.address)==null?void 0:Me.toUpperCase())&&m.token_a.address.toUpperCase()===((Ue=(Ae=(Fe=ee)==null?void 0:Fe.value)==null?void 0:Ae.address)==null?void 0:Ue.toUpperCase())){b=m.needReverse,S=m;break}}let X=!1;ce.value.getIsSortedSymbols((o=x.value)==null?void 0:o.address,(i=ee.value)==null?void 0:i.address)&&(X=!0);let K;X&&!y.value?K=!0:X&&y.value||!X&&y.value?K=!1:K=!0;const ne=ye.value=="Aptos"?Ta:Aa;if(c.value&&d.value&&n){const u=S?S==null?void 0:S.token_a.decimals:X?ee.value.decimals:x.value.decimals,m=S?S==null?void 0:S.token_b.decimals:X?x.value.decimals:ee.value.decimals,w=n&&ce.value.TickMath.priceToSqrtPriceX64(K?new l(1/n):new l(n),u,m);console.log(w,"===>current_sqrt_price");const I=n&&ce.value.TickMath.priceToSqrtPriceX64(new l(1).div(n),c.value.decimals,d.value.decimals);console.log(!K,"===>!newDirect"),console.log(u,m,"decimalsA,decimalsB===>");const k=ce.value.TickMath.priceToTickIndex(K?new l(1).div(n):new l(n),u,m);console.log(k,"==>currentTickIndex");const q=k-ne[N.query.fee]*5,h=k+ne[N.query.fee]*5,g=ce.value.TickMath.tickIndexToPrice(q,u,m).toString(),B=ce.value.TickMath.tickIndexToPrice(h,u,m).toString();Re.value?(f.value="0",p.value="∞"):K?(f.value=String(1/B),p.value=String(1/g),He.value=String(1/B),Xe.value=String(1/g)):(f.value=g,p.value=B,He.value=g,Xe.value=B),console.log("0518###c####createPoolFromCoin.value####",x.value),console.log("0518###c####createPoolToCoin.value####",ee.value),console.log("0518###c####createPoolNeedReverse####",X);const O={token_a:S?S.token_a:X?ee.value:x.value,token_b:S?S.token_b:X?x.value:ee.value,isCreate:!0,tickSpacing:ne[N.query.fee],currentPrice:n,current_sqrt_price:w,tick_lower:q,tick_upper:h,current_tick_index:k,currentPriceReverse:Pa(String(1/n),6),reverse_current_sqrt_price:I,needReverse:b,fee:N.query.fee};v.value=O,console.log("0518###c####poolInfos####",O)}else v.value=null,f.value="",p.value=""},_e=()=>{Re.value=!Re.value,oe(v.value.currentPrice)},Ee=n=>{console.log(n,"####0731 priceRangeChangeMin"),f.value=n},me=n=>{p.value=n},We=()=>{var n,b;if(console.log(v.value,"==>createPoolInfo.value"),y.value=!y.value,v.value){oe(Sa(new l(1).div(v.value.currentPrice).toString(),(b=(n=d)==null?void 0:n.value)==null?void 0:b.decimals));const S=c.value;c.value=d.value,d.value=S,A.value?s.value=r.value:r.value=s.value}};return da(()=>{Ia()}),{amountLock:ke,currentStep:U,sliderStyle:W,coinAmount:de,pricerange:j,fromCoin:c,toCoin:d,fee:T,direct:z,getCoinIcon:E,isSelectFullRange:we,onInput:C,store:ie,initPrice:be,inputPriceLock:e,specifyPriceLock:a,changeCurrentPrice:oe,minPrice:f,maxPrice:p,defaultMinPrice:He,defaultMaxPrice:Xe,clickFullRange:_e,createPoolInfo:v,isFullRange:Re,priceRangeChangeMin:Ee,priceRangeChangeMax:me,fromCoinAmount:s,toggle:We,showFromCoinLock:Y,showToCoinLock:Z}}});const re=e=>(ea("data-v-0e023f5e"),e=e(),oa(),e),Ka={class:"creat-pool-container"},Ya={class:"creat-pool-left"},Za={class:"progress"},xa=re(()=>t("div",{class:"slider-ratio-content"},null,-1)),et=[xa],ot={class:"progress-text"},at={key:0},tt={key:0},lt={key:0},nt={key:0},st={key:0},ut={class:"creat-pool-center"},rt={class:"title"},it=re(()=>t("div",{class:"left"},"Set Initial Price",-1)),ct={class:"right"},vt={key:0,class:"token-box"},dt=re(()=>t("div",null,[t("svg",{class:"icon icon-up","aria-hidden":"true"},[t("use",{"xlink:href":"#icon-exchange_up1"})])],-1)),mt=re(()=>t("div",null,[t("svg",{class:"icon icon-down","aria-hidden":"true"},[t("use",{"xlink:href":"#icon-exchange_down1"})])],-1)),pt=[dt,mt],ft={class:"content top-content"},gt=re(()=>t("div",{class:"top"},[t("span",null,"💡"),t("span",null,"Please set an initial price for this new pool to start.")],-1)),kt={class:"bottom"},Ct={class:"input-div"},bt={key:0,class:"lock"},wt={class:"title"},ht=re(()=>t("div",{class:"left"},"Set Price Range",-1)),yt={class:"right"},_t={key:0,src:$a},Pt=re(()=>t("span",null,"Full Range",-1)),St={class:"content bottom-content"},Nt=re(()=>t("span",null,"💡",-1)),Tt=re(()=>t("span",null,"Please specify a price range that you want to provide your liquidity within.",-1)),At=[Nt,Tt],It={class:"bottom"},qt={class:"set-price-box"},Rt={key:0,class:"lock"},$t={key:1,class:"create-pool-warning"},Lt={key:2,class:"position-tips"},Bt=["src"],Mt={class:"error"},Ft={class:"creat-pool-right-container"};function Ut(e,a,we,de,U,z){var L,V;const j=xo,N=na,P=ya,H=Zo("CreatePoolRight"),ie=ma("image");return _(),$("div",Ka,[t("div",Ya,[t("div",Za,[t("div",{class:"slider-ratio",style:pa(e.sliderStyle(e.currentStep))},et,4)]),t("div",ot,[t("div",{class:ge(["row",!e.fromCoin||!e.toCoin?"color-text":""])},[e.fromCoin&&e.toCoin?(_(),$("span",at,"✓")):M("",!0),Ce(" Select Pool ")],2),t("div",{class:ge(["row",e.fee?"":"color-text"])},[e.fee?(_(),$("span",tt,"✓")):M("",!0),Ce(" Select Fee Tier ")],2),t("div",{class:ge(["row",e.initPrice?"":"color-text"])},[e.initPrice?(_(),$("span",lt,"✓")):M("",!0),Ce(" Set Initial Price ")],2),t("div",{class:ge(["row",!e.minPrice||!e.maxPrice?"color-text":""])},[e.minPrice&&e.maxPrice?(_(),$("span",nt,"✓")):M("",!0),Ce(" Select Price Range ")],2),t("div",{class:ge(["row",e.fromCoinAmount?"":"color-text"])},[e.fromCoinAmount?(_(),$("span",st,"✓")):M("",!0),Ce(" Confirm Liquidity ")],2)])]),t("div",ut,[t("div",rt,[it,t("div",ct,[e.fromCoin&&e.toCoin&&e.initPrice?(_(),$("div",vt,[fa(t("img",null,null,512),[[ie,(L=e.fromCoin)==null?void 0:L.logo_url]]),t("span",null,Ve((V=e.fromCoin)==null?void 0:V.symbol),1),t("div",{class:"icon-change",onClick:a[0]||(a[0]=(...T)=>e.toggle&&e.toggle(...T))},pt)])):M("",!0)])]),t("div",ft,[gt,t("div",kt,[t("div",Ct,[le(j,{type:"text",placeholder:"0.0",value:e.initPrice,onInput:a[1]||(a[1]=T=>e.changeCurrentPrice(T.target.value))},null,8,["value"])]),e.inputPriceLock?(_(),$("div",bt,[le(N)])):M("",!0)])]),t("div",wt,[ht,t("div",yt,[t("div",{class:ge(["radio",e.isFullRange?"active-radio":""]),onClick:a[2]||(a[2]=(...T)=>e.clickFullRange&&e.clickFullRange(...T))},[e.isFullRange?(_(),$("img",_t)):M("",!0)],2),Pt])]),t("div",St,[t("div",{class:ge(["top",e.specifyPriceLock?"":"no-border"])},At,2),t("div",It,[t("div",qt,[le(P,{min:e.minPrice,max:e.maxPrice,"from-coin":e.fromCoin,"to-coin":e.toCoin,direct:e.direct,"default-min-price":e.defaultMinPrice,"default-max-price":e.defaultMaxPrice,"pool-info":e.createPoolInfo,loading:!1,"current-price-tab":"custom",onOnChangeMinPrice:e.priceRangeChangeMin,onOnChangeMaxPrice:e.priceRangeChangeMax},null,8,["min","max","from-coin","to-coin","direct","default-min-price","default-max-price","pool-info","onOnChangeMinPrice","onOnChangeMaxPrice"])]),e.specifyPriceLock?(_(),$("div",Rt,[le(N)])):M("",!0),e.currentStep>=4&&(e.showFromCoinLock||e.showToCoinLock)&&Number(e.maxPrice)>Number(e.minPrice)?(_(),$("div",$t," To create a new pool, the initial price you set must be within your price range. ")):M("",!0),e.currentStep>=4&&Number(e.minPrice)>Number(e.maxPrice)?(_(),$("div",Lt,[t("img",{src:("importIcon"in e?e.importIcon:ga(Qe))("/image/icon-tips-error@2x.png"),alt:""},null,8,Bt),t("p",Mt,Ve(e.$t("tips.positionError")),1)])):M("",!0)])])]),t("div",Ft,[le(H,{"create-pool-info":e.createPoolInfo,onToggle:e.toggle},null,8,["create-pool-info","onToggle"])])])}const vl=Ye(Ja,[["render",Ut],["__scopeId","data-v-0e023f5e"]]);export{vl as default};
