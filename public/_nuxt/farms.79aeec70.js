import{m as So,e as Po,s as X,a as O,o as Ho,u as go,d as mo,q as No,c as x,k as Fo}from"./pool.9c35598a.js";import{a as Y,l as d,r as V,e as Z,o as n,f as t,h as s,i as k,v,u as b,c as T,w as B,S as zo,B as wo,j as U,p as io,k as lo,s as Lo,t as ao,x as E,b as Co,A as ho,F as H,E as no,P as us,q as Io,z as $o,N as Qo,M as Do,H as Go,Q as ms}from"./entry.91620dd3.js";/* empty css              */import{a as ro,u as jo}from"./sha256.5c96fd9b.js";import{u as po}from"./farms.baec4d27.js";import{R as Bo}from"./farms-range.a719b7cc.js";import{_ as Ko}from"./apr-tips.8b0d0114.js";import{i as Oo}from"./import-icon.de3e6c66.js";/* empty css              *//* empty css              */import{D as Jo}from"./decimal.0bdeb344.js";import{_ as Xo}from"./img-connect-wallet_2x.8ae89a0f.js";import{_ as Yo}from"./img-no-Positions_2x.bd6e3951.js";import{_ as ps}from"./upgrade-loading.2a4d9626.js";import{p as _s}from"./precision.a7a6c57b.js";import"./icon_rewards_2x.f0a75ca0.js";/* empty css              */import"./icon-Amount-for-Sale_2x.b2e65df2.js";const fs=Y({setup(){const o=ro(),r=d(()=>o),p=po(),u=d(()=>p),m=d(()=>(console.log(u.value.farmsRewardObj,"##farmsRewardObj"),Object.values(u.value.farmsRewardObj))),a=d(()=>{const J=m.value.reduce(function(G,F){const R=F&&F.amountUsd?F.amountUsd:0;return Number(R)>.01?Ho(Number(G)).plus(X(Number(R),2)).toString():Ho(Number(G)).plus(Number(R)).toString()},0);return console.log(u.value.farmsRewardObj,m.value,J,"resultresult67"),J}),l=d(()=>u.value.farmsPositionList),c=d(()=>u.value.farmsAllPositionLoading),g=d(()=>u.value.farmsPoolListLoading),y=jo(),f=So("Sui"),_=Po("Sui"),{setIsShowSuccess:I,setIsShowRejected:L,setIsShowWaiting:e,setTransactionDesc:j,setTransactionTxid:D}=y,w=V(!1);return{farmsPoolListLoading:g,wallet:r,farms:u,totalRwadrdUsd:a,sFixD:X,claimAllPoolReward:async J=>{w.value=!0,console.log(l.value,"farmsRewardObj###");const G=[];l.value.forEach(F=>{console.log(J,F,"#position"),F.positionSource=="farming"&&G.push({pool_id:F.pool_id,position_nft_id:F.id})}),console.log(JSON.stringify(G),"##params"),D(""),j("Claim Rewards"),e(!0);try{const F=await f.batchHarvest(G),R=await r.value.currentWallet.signAndExecuteTransactionBlock(F);console.log("0221###sui swap res###",R);let A=_.handleTx(R);if(A&&A.hash){D(A.hash),e(!1),I(!0);let M={res:A.res,title:"Claim",hash:A.hash};_.showTransitionPending(M),await _.watchTransaction(M)&&setTimeout(()=>{p.getFarmsPoolList()},4e3)}else e(!1),L(!0);w.value=!1}catch(F){console.log("Claim all error",F),e(!1),L(!0),w.value=!1}},loading:w,addCommom:O,farmsAllPositionLoading:c}}});const Zo=o=>(io("data-v-3e0a1ace"),o=o(),lo(),o),vs={class:"farms-banner-bg"},hs={class:"farms-banner"},gs={class:"farms-banner-center"},bs=Zo(()=>s("div",{class:"title"},"Farms",-1)),$s=Zo(()=>s("div",{class:"desc"},"Stake your positions to earn higher yield.",-1)),ws={class:"claim-rewards"},ys={class:"claim-title"},ks={key:0,class:"loading-spin"},Is={key:1},Ss={key:2},Ps={class:"claim-content"};function Ls(o,r,p,u,m,a){const l=zo,c=wo;return n(),t("div",vs,[s("div",hs,[s("div",gs,[bs,$s,s("div",ws,[s("div",ys,[o.farmsAllPositionLoading||o.farmsPoolListLoading?(n(),t("span",ks,[k(l)])):o.wallet.address?(n(),t("span",Is,v(Number(o.totalRwadrdUsd)>0&&Number(o.totalRwadrdUsd)<.01?"<$0.01":`$${("addCommom"in o?o.addCommom:b(O))(("sFixD"in o?o.sFixD:b(X))(o.totalRwadrdUsd||0,2))}`),1)):(n(),t("span",Ss,"--"))]),s("div",Ps,[o.wallet.address?(n(),T(c,{key:0,class:"claim-btn",loading:o.loading,disabled:Number(o.totalRwadrdUsd)==0||o.farmsAllPositionLoading,onClick:o.claimAllPoolReward},{default:B(()=>[U(" Claim All Rewards ")]),_:1},8,["loading","disabled","onClick"])):(n(),T(c,{key:1,class:"claim-btn",onClick:r[0]||(r[0]=g=>o.wallet.setIsShowWalletModal(!0))},{default:B(()=>[U("Connect")]),_:1}))])])])])])}const xo=Z(fs,[["render",Ls],["__scopeId","data-v-3e0a1ace"]]),js=Y({props:{poolInfo:{type:Object,default:()=>({})}},setup(){const o=V(!0);return{sFixD:X,direct:o}}});const Cs=o=>(io("data-v-14f67ada"),o=o(),lo(),o),Os={class:"valid-range"},Us=Cs(()=>s("div",{class:"title"},"Valid Range",-1));function Ts(o,r,p,u,m,a){const l=Bo;return n(),t("div",Os,[Us,k(l,{"pool-info":o.poolInfo},null,8,["pool-info"])])}const Rs=Z(js,[["render",Ts],["__scopeId","data-v-14f67ada"]]),As=Y({props:{poolInfo:{type:Object,default:()=>({})}},setup(){return{}}});const Fs={class:"pool"},Ns={class:"pool-info"},Ds={class:"token-logo"},Bs={alt:""},Es={alt:""},Ms={class:"token-symbol"},qs={class:"symbol"},Ws={class:"fee-rate"};function Vs(o,r,p,u,m,a){var g,y,f,_;const l=Rs,c=Lo("image");return n(),t("div",Fs,[s("div",Ns,[s("div",Ds,[ao(s("img",Bs,null,512),[[c,(g=o.poolInfo.coinA)==null?void 0:g.logo_url]]),ao(s("img",Es,null,512),[[c,(y=o.poolInfo.coinB)==null?void 0:y.logo_url]])]),s("div",Ms,[s("div",qs,v((f=o.poolInfo.coinA)==null?void 0:f.symbol)+" - "+v((_=o.poolInfo.coinB)==null?void 0:_.symbol),1),s("div",Ws,v(o.poolInfo.fee),1)])]),k(l,{"pool-info":o.poolInfo},null,8,["pool-info"])])}const os=Z(As,[["render",Vs],["__scopeId","data-v-c027f63c"]]),Hs=Y({props:{currentTab:{type:String,default:""},rewardInfo:{type:Object,default:()=>({})}},setup(){const o=go(),r=d(()=>o);return{sFixD:X,addCommom:O,getCoinIcon:u=>{var m;return((m=r.value.tokensObj[u])==null?void 0:m.logo_url)||Oo("/image/coins/sui-unknown.png")}}}});const Js={key:0,class:"rewards-day"},zs={class:"rewards-day-box"},Qs={alt:""};function Gs(o,r,p,u,m,a){const l=Lo("image");return o.rewardInfo.allocate_point>0||o.currentTab=="Ended"?(n(),t("div",Js,[s("div",null,[s("div",zs,[ao(s("img",Qs,null,512),[[l,o.getCoinIcon(o.rewardInfo.reward_coin)]]),s("span",null,v(("addCommom"in o?o.addCommom:b(O))(("sFixD"in o?o.sFixD:b(X))(o.rewardInfo.emission_per_day,4))),1)])])])):E("",!0)}const ss=Z(Hs,[["render",Gs],["__scopeId","data-v-416b96fb"]]),Ks=Y({props:{positionInfo:{type:Object,default:()=>({})}},setup(o){console.log(o.positionInfo,"props.positionInfo");const r=go(),p=d(()=>r);return{addCommom:O,decimalUi:mo,fixD:No,getCoinIcon:m=>{var a;return((a=p.value.tokensObj[m])==null?void 0:a.logo_url)||Oo("/image/coins/sui-unknown.png")}}}});const Xs={class:"hover-rewarder"},Ys={class:"rewarder-info"},Zs={class:"left-rewarder"},xs={alt:""},oe={class:"right-rewarder"},se={class:"amount"},ee={key:0,class:"amount-usd"},ne={key:1,class:"amount-usd"},te={class:"rewarder-info"},ae={class:"left-rewarder"},ie={alt:""},le={class:"right-rewarder"},re={class:"amount"},de={key:0,class:"amount-usd"},ce={key:1,class:"amount-usd"};function ue(o,r,p,u,m,a){const l=Lo("image");return n(),t("div",Xs,[s("div",Ys,[s("div",Zs,[ao(s("img",xs,null,512),[[l,o.getCoinIcon(o.positionInfo.needReverse?o.positionInfo.coinB.address:o.positionInfo.coinA.address)]]),s("span",null,v(o.positionInfo.needReverse?o.positionInfo.coinB.symbol:o.positionInfo.coinA.symbol),1)]),s("div",oe,[s("div",se,v(o.positionInfo.needReverse?("addCommom"in o?o.addCommom:b(O))(("decimalUi"in o?o.decimalUi:b(mo))(o.positionInfo.amountB,o.positionInfo.coinB.decimals)):("addCommom"in o?o.addCommom:b(O))(("decimalUi"in o?o.decimalUi:b(mo))(o.positionInfo.amountA,o.positionInfo.coinA.decimals))),1),o.positionInfo.needReverse?(n(),t("div",ne,v(o.positionInfo.amountBUsd==0?"$0":o.positionInfo.amountBUsd>.01?"$"+("fixD"in o?o.fixD:b(No))(o.positionInfo.amountBUsd,2):"<$0.01"),1)):(n(),t("div",ee,v(o.positionInfo.amountAUsd==0?"$0":o.positionInfo.amountAUsd>.01?"$"+("fixD"in o?o.fixD:b(No))(o.positionInfo.amountAUsd,2):"<$0.01"),1))])]),s("div",te,[s("div",ae,[ao(s("img",ie,null,512),[[l,o.getCoinIcon(o.positionInfo.needReverse?o.positionInfo.coinA.address:o.positionInfo.coinB.address)]]),s("span",null,v(o.positionInfo.needReverse?o.positionInfo.coinA.symbol:o.positionInfo.coinB.symbol),1)]),s("div",le,[s("div",re,v(o.positionInfo.needReverse?("addCommom"in o?o.addCommom:b(O))(("decimalUi"in o?o.decimalUi:b(mo))(o.positionInfo.amountA,o.positionInfo.coinA.decimals)):("addCommom"in o?o.addCommom:b(O))(("decimalUi"in o?o.decimalUi:b(mo))(o.positionInfo.amountB,o.positionInfo.coinB.decimals))),1),o.positionInfo.needReverse?(n(),t("div",ce,v(o.positionInfo.amountAUsd==0?"$0":o.positionInfo.amountAUsd>.01?"$"+("addCommom"in o?o.addCommom:b(O))(("decimalUi"in o?o.decimalUi:b(mo))(o.positionInfo.amountAUsd,2)):"<$0.01"),1)):(n(),t("div",de,v(o.positionInfo.amountBUsd==0?"$0":o.positionInfo.amountBUsd>.01?"$"+("addCommom"in o?o.addCommom:b(O))(("decimalUi"in o?o.decimalUi:b(mo))(o.positionInfo.amountBUsd,2)):"<$0.01"),1))])])])}const es=Z(Ks,[["render",ue],["__scopeId","data-v-0ca1f131"]]),me=Y({components:{FarmsPositionAmountTips:es},props:{positionInfo:{type:Object,default:()=>({})},currentTab:{type:String,default:""}},setup(o){const r=ro(),p=d(()=>r);console.log(o.positionInfo,"positionInfo#");const u=po(),m=d(()=>u),a=Po("Sui"),l=So("Sui"),c=V(!1),g=jo();d(()=>g);const y=Co(),{setIsShowSuccess:f,setIsShowRejected:_,setIsShowWaiting:I,setTransactionDesc:L,setTransactionTxid:e}=g,j=async()=>{console.log(o.positionInfo,"props.positionInfo"),c.value=!0,e(""),L(`Stake ${o.positionInfo.name}`),I(!0);const $={clmm_pool_id:o.positionInfo.clmmPool,clmm_position_id:o.positionInfo.pos_object_id,coinTypeA:o.positionInfo.coin_type_a,coinTypeB:o.positionInfo.coin_type_b};console.log(R.value,"##farmsPoolObj.value");const S=R.value[o.positionInfo.clmmPool].id;try{const N=await l.farmsDeposit($,S),W=await p.value.currentWallet.signAndExecuteTransactionBlock(N);console.log("0221###sui swap res###",W);let q=a.handleTx(W);if(q&&q.hash){e(q.hash),I(!1),f(!0);let eo={res:q.res,title:"Staked",hash:q.hash};a.showTransitionPending(eo),await a.watchTransaction(eo)&&setTimeout(()=>{u.getPositionByPool(p.value.address,o.positionInfo.clmm_pool_id,o.positionInfo.farmsPoolId),c.value=!1},2e3)}else I(!1),_(!0)}catch(N){console.log("farmsDeposit error",N),I(!1),_(!0),c.value=!1}},D=async()=>{console.log(o.positionInfo,"props.positionInfo"),c.value=!0,e(""),L(`Unstake ${o.positionInfo.name}`),I(!0);const $=o.positionInfo.farmsPoolId,S=o.positionInfo.id;try{const N=await l.farmsWithdraw($,S),W=await p.value.currentWallet.signAndExecuteTransactionBlock(N);console.log("0221###sui swap res###",W);let q=a.handleTx(W);if(console.log(q,"unStaketx##"),q&&q.hash){e(q.hash),I(!1),f(!0);let eo={res:q.res,title:"Unstaked",hash:q.hash};a.showTransitionPending(eo),await a.watchTransaction(eo)&&setTimeout(()=>{console.log(o.positionInfo,"##props.positionInfo"),u.getPositionByPool(p.value.address,o.positionInfo.clmm_pool_id,o.positionInfo.farmsPoolId),c.value=!1},2e3)}else I(!1),_(!0)}catch(N){console.log("farmsDeposit error",N),I(!1),_(!0),c.value=!1}},w=async()=>{console.log(o.positionInfo,"props.positionInfo"),c.value=!0,e(""),L("Claim rewards"),I(!0);const $={pool_id:o.positionInfo.farmsPoolId,position_nft_id:o.positionInfo.id};try{const S=await l.harvestFarms($),N=await p.value.currentWallet.signAndExecuteTransactionBlock(S);console.log("0221###sui swap res###",N);let W=a.handleTx(N);if(W&&W.hash){e(W.hash),I(!1),f(!0);let q={title:"Claim",res:W.res,hash:W.hash};a.showTransitionPending(q),await a.watchTransaction(q)&&setTimeout(()=>{u.getPositionByPool(p.value.address,o.positionInfo.clmm_pool_id,o.positionInfo.farmsPoolId)},2e3)}else I(!1),_(!0);c.value=!1}catch(S){console.log("farmsDeposit error",S),I(!1),_(!0),c.value=!1}},co=d(()=>m.value.farmsRewardObj),J=go(),G=d(()=>J),F=d(()=>m.value.farmsLoadingObj),R=d(()=>m.value.farmsPoolObj);return{sFixD:X,stake:j,loading:c,unStake:D,router:y,claim:w,farmsRewardObj:co,getCoinIcon:$=>{var S;return((S=G.value.tokensObj[$])==null?void 0:S.logo_url)||Oo("/image/coins/sui-unknown.png")},toPositionDetails:$=>{console.log("toPositionDetails:",$),$.positionSource=="clmm"?y.push(`/new-position-detail?collect=${$.collectionName}&&token=${$.tokenName}&&address=${$.pool}&pos=${$.pos_object_id}`):y.push(`/new-position-detail?position_nft_id=${$.id}&positionSource=farming`)},farmsLoadingObj:F,addCommom:O}}}),ns=""+globalThis.__publicAssetsURL("sui-image/position-active.png");const Uo=o=>(io("data-v-d5747c90"),o=o(),lo(),o),pe={class:"farms-position-item"},_e=Uo(()=>s("thead",null,[s("tr",null,[s("th",null,"Position"),s("th",null,"Liquidity"),s("th",null,"Earnings"),s("th")])],-1)),fe={class:"position-info"},ve={key:0,class:"status-bg"},he=Uo(()=>s("img",{src:ns,alt:""},null,-1)),ge=[he],be={class:"status-text"},$e={class:"name-range"},we=Uo(()=>s("span",null,"Details",-1)),ye=Uo(()=>s("svg",{class:"arrow-icon","aria-hidden":"true"},[s("use",{"xlink:href":"#icon-icon_arrow"})],-1)),ke=[we,ye],Ie={class:"liquidity"},Se={class:"rewards-day-box"},Pe={alt:""},Le={key:1,class:"rewards-day"},je={class:"action-btn"};function Ce(o,r,p,u,m,a){const l=Bo,c=es,g=wo,y=us,f=Lo("image");return n(),t("div",pe,[s("table",null,[_e,s("tbody",null,[s("tr",null,[s("td",null,[s("div",fe,[s("div",{class:ho(["position-status",o.positionInfo.positionStatus!=="Active"?"position-status-inactive":""])},[o.positionInfo.positionStatus=="Active"?(n(),t("div",ve,ge)):E("",!0),s("div",be,v(o.positionInfo.positionStatus),1)],2),s("div",$e,[s("span",null,v(o.positionInfo.name),1),k(l,{"pool-info":o.positionInfo},null,8,["pool-info"])]),s("div",{class:"details",onClick:r[0]||(r[0]=_=>o.toPositionDetails(o.positionInfo))},ke)])]),s("td",null,[s("div",Ie,[s("span",null,[U(v(o.positionInfo.positionUSD>0&&o.positionInfo.positionUSD<.01?"<$0.01":`~$${("addCommom"in o?o.addCommom:b(O))(("sFixD"in o?o.sFixD:b(X))(o.positionInfo.positionUSD,2))}`)+" ",1),k(c,{"position-info":o.positionInfo},null,8,["position-info"])])])]),s("td",null,[o.positionInfo.rewards&&o.positionInfo.rewards.length>0?(n(!0),t(H,{key:0},no(o.positionInfo.rewards,_=>(n(),t("div",{key:_.rewarder_type,class:"rewards-day"},[s("div",null,[s("div",Se,[ao(s("img",Pe,null,512),[[f,o.getCoinIcon(_.rewarder_type)]]),s("span",null,v(_.rewarderAmount),1)])])]))),128)):(n(),t("div",Le,"0"))]),s("td",null,[s("div",je,[o.positionInfo.positionSource=="clmm"?(n(),t(H,{key:0},[o.positionInfo&&o.positionInfo.positionStatus!=="Active"?(n(),T(y,{key:0},{title:B(()=>[U("Farming rewards are only available for active positions.")]),default:B(()=>[k(g,{class:"unstake-btn",loading:o.loading,disabled:o.positionInfo.positionStatus!=="Active",onClick:o.stake},{default:B(()=>[U("Stake")]),_:1},8,["loading","disabled","onClick"])]),_:1})):(n(),T(g,{key:1,class:"unstake-btn",loading:o.loading,disabled:o.positionInfo.positionStatus!=="Active",onClick:o.stake},{default:B(()=>[U("Stake")]),_:1},8,["loading","disabled","onClick"]))],64)):(n(),T(g,{key:1,class:"unstake-btn",onClick:o.unStake},{default:B(()=>[U("Unstake")]),_:1},8,["onClick"])),o.positionInfo.positionSource=="clmm"?(n(),T(g,{key:2,class:"claim-btn",disabled:!0},{default:B(()=>[U("↑ Claim")]),_:1})):(n(),T(g,{key:3,class:"claim-btn",disabled:o.positionInfo.positionRewardAmount==0,onClick:o.claim},{default:B(()=>[U("↑ Claim")]),_:1},8,["disabled","onClick"]))])])])])])])}const ts=Z(me,[["render",Ce],["__scopeId","data-v-d5747c90"]]),Oe=Y({props:{noDataImg:{type:String,default:""},desc:{type:String,default:""},type:{type:String,default:""},addLiquidityUrl:{type:String,default:""}},setup(){return{walletStore:ro()}}});const Ue={class:"no-data"},Te=["src"],Re={key:0,class:"desc"};function Ae(o,r,p,u,m,a){const l=wo;return n(),t("div",Ue,[s("img",{src:o.noDataImg,alt:""},null,8,Te),o.desc?(n(),t("div",Re,v(o.desc),1)):E("",!0),o.type=="addLiquidity"?(n(),T(l,{key:1,class:"add-liquidity-btn",onClick:r[0]||(r[0]=c=>o.addLiquidityUrl?o.$router.push(o.addLiquidityUrl):"")},{default:B(()=>[U("Add Liquidity")]),_:1})):E("",!0),o.type=="connectWallet"?(n(),T(l,{key:2,class:"add-liquidity-btn",onClick:r[1]||(r[1]=c=>o.walletStore.setIsShowWalletModal(!0))},{default:B(()=>[U("Connect Wallet")]),_:1})):E("",!0)])}const as=Z(Oe,[["render",Ae],["__scopeId","data-v-130f9462"]]),Fe=Y({components:{FarmsPositionItem:ts},props:{currentTab:{type:String,default:""},sortValue:{type:String,default:"APR"}},setup(o){const r=V({}),p=ro(),u=d(()=>p),m=po(),a=d(()=>m),l=d(()=>a.value.farmsPoolList),c=d(()=>a.value.farmsPoolList),g=jo(),y=d(()=>g),f=d(()=>y.value.addressLpTokens),_=V([]),I=d(()=>a.value.myFarmsPoolList),L=Q=>{console.log(c.value,"###list.value");let z,K;o.currentTab=="My Farms"&&(z=u.value.address?I.value:[]),console.log("getPageList:",z),o.currentTab=="Ended"&&(z=a.value.farmsPoolList.filter(i=>(console.log(i.status,"##ele.status "),i.status=="Ended"))),o.currentTab=="Live"&&(z=a.value.farmsPoolList.filter(i=>i.status=="Live")),Q=="APR"?K=z.sort((i,h)=>h.stable_farming.apr-i.stable_farming.apr):K=z.sort((i,h)=>h.stable_farming.tvl-i.stable_farming.tvl),_.value=K.map(i=>{var vo,bo,ko;console.log(i,"pool###");let h;i.rewarder&&i.rewarder.rewarder_coin&&i.rewarder.rewarder_coin.length>0&&(h=(bo=(vo=i.rewarder)==null?void 0:vo.rewarder_coin)==null?void 0:bo.map((uo,Ao)=>({...uo,amountDay:new Jo(uo.amount_second).mul(new Jo(60*60*24)).toNumber(),rewarder_display:i.rewarder[`rewarder_display${Ao+1}`],rewarderApr:uo.apr.replace("%","")})));let P;i.stable_farming&&i.stable_farming.stable_rewarder.map(uo=>{uo.amount_second>0&&(P=!0)});const C=i.apr_24h.replace("%",""),oo=i.rewarder&&i.rewarder.apr.replace("%","")||0;return console.log(C,oo,"rewardApr####"),{...i,needReverse:i.is_forward===!1,coinA:i.coin_a,coinB:i.coin_b,liquidity:i.tvl_in_usd,vol:i.vol_in_usd_24h,clmmApr:Number(C)+Number(oo),stableFarmingApr:i.stable_farming&&i.stable_farming.apr*100,rewarder:{...i.rewarder,rewardList:h},apr:i.apr_24h.replace("%",""),is_display_rewarder:(ko=i==null?void 0:i.rewarder)==null?void 0:ko.is_display_rewarder,aprTotal:Number(C)+Number(oo),isStableFarming:P}})};Io(()=>[c.value,o.sortValue,o.currentTab,I.value],([Q,z])=>{console.log(z,"sortValue326"),Q&&Q.length>0&&z&&L(z)},{immediate:!0});const e=Q=>{r.value[Q.clmm_pool_id]?r.value[Q.clmm_pool_id]=!1:(r.value[Q.clmm_pool_id]=!0,console.log("执行了吗"),m.getPositionByPool(u.value.address,Q.clmm_pool_id,Q.id))},j=d(()=>a.value.farmsPositionObj),D=d(()=>(console.log(a.value.farmsLoadingObj,"##farms.value.farmsLoadingObj"),a.value.farmsLoadingObj)),w=d(()=>a.value.farmsUserUsd),co=d(()=>(console.log(a.value.farmsRewardObj,"##farmsRewardObj"),a.value.farmsRewardObj)),J=d(()=>a.value.farmsPositionList),G=d(()=>a.value.farmsAllPositionLoading),F=Co(),R=So("Sui"),A=Po("Sui"),{setIsShowSuccess:M,setIsShowRejected:$,setIsShowWaiting:S,setTransactionDesc:N,setTransactionTxid:W}=g,q=async Q=>{console.log(J.value,"farmsRewardObj###");const z=[];J.value.forEach(K=>{console.log(Q,K,"#position"),Q==K.clmm_pool_id&&z.push({pool_id:K.pool_id,position_nft_id:K.id})}),console.log(JSON.stringify(z),"##params"),W(""),N("Claim rewards"),S(!0);try{const K=await R.batchHarvest(z),i=await u.value.currentWallet.signAndExecuteTransactionBlock(K);console.log("0221###sui swap res###",i);let h=A.handleTx(i);if(h&&h.hash){W(h.hash),S(!1),M(!0);let P={res:h.res,title:"Claim",hash:h.hash};A.showTransitionPending(P),await A.watchTransaction(P)&&setTimeout(()=>{m.getFarmsPoolList()},4e3)}else S(!1),$(!0)}catch(K){console.log("Claim all error",K),S(!1),$(!0)}},eo=go(),to=d(()=>eo),To=d(()=>(console.log(to.value.poolsObj,"##pools.value.poolsObj"),to.value.poolsObj));d(()=>to.value.tokensObj);const Ro=V({}),fo=d(()=>a.value.farmsPoolObj);return console.log(f.value,"addressLpTokens:"),{wallet:u,walletStore:p,farmsPoolList:l,openMore:e,openMoreObj:r,checkNullObj:x,router:F,farmsPositionObj:j,farmsLoadingObj:D,farmsUserUsd:w,sFixD:X,farmsRewardObj:co,claimPoolReward:q,farmsAllPositionLoading:G,addCommom:O,addressLpTokens:f,poolsObj:To,rewardInfoObj:Ro,pageList:_,farmsPoolObj:fo}}});const _o=o=>(io("data-v-d2fd23d8"),o=o(),lo(),o),Ne={class:"farms-table"},De=_o(()=>s("thead",null,[s("tr",null,[s("th",null,"Pools"),s("th",null,"Staked TVL"),s("th",null,"APR"),s("th",null,"Rewards / day"),s("th",null,"My Staked"),s("th",null,"Earned"),s("th",null,"Actions")]),s("tr",{style:{height:"4px"}})],-1)),Be={key:0},Ee=["onClick"],Me={class:"staked-tvl"},qe={class:"apr"},We={key:0,class:"apr-hover-box"},Ve={class:"farms-reward-box"},He={key:0,class:"my-staked"},Je={key:0,class:"my-staked-loading"},ze={key:0,class:"position-usd"},Qe={key:1,class:"position-usd"},Ge={key:2,class:"position-usd"},Ke={key:3,class:"position-num"},Xe={key:1,class:"my-staked"},Ye=_o(()=>s("div",{class:"position-usd"},"--",-1)),Ze=[Ye],xe={class:"earned"},on={key:0,class:"my-staked-loading"},sn={key:0,class:"ratio-bg"},en=_o(()=>s("div",{class:"ratio"},null,-1)),nn=[en],tn={key:1},an={key:2},ln={key:3},rn={key:2},dn={class:"actions"},cn={class:"actions-btn"},un=["onClick"],mn=_o(()=>s("use",{"xlink:href":"#icon-icon_arrow"},null,-1)),pn=[mn],_n={colspan:"7",style:{padding:"0 16px 16px"}},fn={key:0,class:"farm-position-list"},vn={key:0,class:"farm-position-loading"},hn={key:1,class:"farm-position-list"},gn=_o(()=>s("tr",{style:{height:"8px"}},null,-1)),bn={key:1},$n={colspan:"7"},wn={key:0,class:"no-data"},yn=_o(()=>s("img",{src:Xo,alt:""},null,-1)),kn={key:1,class:"no-data"},In=_o(()=>s("img",{src:Yo,alt:""},null,-1)),Sn=_o(()=>s("span",null,"No farms found",-1)),Pn=[In,Sn];function Ln(o,r,p,u,m,a){const l=os,c=Ko,g=ss,y=Do,f=wo,_=zo,I=ts,L=as;return n(),t("div",Ne,[s("table",null,[De,o.pageList&&o.pageList.length>0?(n(),t("tbody",Be,[(n(!0),t(H,null,no(o.pageList,e=>(n(),t(H,{key:e.id},[s("tr",{onClick:j=>o.openMore(e)},[s("td",null,[k(l,{"pool-info":e},null,8,["pool-info"])]),s("td",null,[s("div",Me," $"+v(("addCommom"in o?o.addCommom:b(O))(e.stable_farming.tvl,2)),1)]),s("td",null,[s("div",qe,[e.isStableFarming?(n(),t("div",We,[k(c,{"l-item":e,"rewarder-info":e.rewarder.rewardList,class:"noHover apr-hover-con"},null,8,["l-item","rewarder-info"])])):E("",!0),s("span",null,v((e==null?void 0:e.total_apr)>0&&e.total_apr<1e-4?"<0.01%":`${("addCommom"in o?o.addCommom:b(O))(e.total_apr*100,2)}%`),1)])]),s("td",null,[s("div",Ve,[(n(!0),t(H,null,no(e.rewarders,j=>(n(),T(g,{key:j.reward_coin,"reward-info":j,"current-tab":o.currentTab},null,8,["reward-info","current-tab"]))),128))])]),s("td",null,[o.wallet.address?(n(),t("div",He,[o.farmsLoadingObj[e.clmm_pool_id]||o.farmsAllPositionLoading?(n(),t("div",Je,[k(y,{class:"upgrade-title-skeleton",loading:!0,active:"",paragraph:!1})])):(n(),t(H,{key:1},[o.farmsUserUsd&&o.farmsUserUsd[e.clmm_pool_id]&&o.farmsUserUsd[e.clmm_pool_id].amount>0&&o.farmsUserUsd[e.clmm_pool_id].amount>.01?(n(),t("div",ze,v(Number(o.farmsUserUsd[e.clmm_pool_id].amount)>0&&Number(o.farmsUserUsd[e.clmm_pool_id].amount)<.01?"<$0.01":"$"+("addCommom"in o?o.addCommom:b(O))(o.farmsUserUsd[e.clmm_pool_id].amount,2)),1)):o.farmsUserUsd&&o.farmsUserUsd[e.clmm_pool_id]&&o.farmsUserUsd[e.clmm_pool_id].amount>0&&o.farmsUserUsd[e.clmm_pool_id].amount<.01?(n(),t("div",Qe," <$0.01 ")):(n(),t("div",Ge,"0")),o.farmsUserUsd&&o.farmsUserUsd[e.clmm_pool_id]&&o.farmsUserUsd[e.clmm_pool_id].positionNum?(n(),t("div",Ke,v(o.farmsUserUsd[e.clmm_pool_id].positionNum)+" "+v(o.farmsUserUsd[e.clmm_pool_id].positionNum>1?"Positions":"Position"),1)):E("",!0)],64))])):(n(),t("div",Xe,Ze))]),s("td",null,[s("div",xe,[o.farmsLoadingObj[e.clmm_pool_id]||o.farmsAllPositionLoading?(n(),t("div",on,[k(y,{class:"upgrade-title-skeleton",loading:!0,active:"",paragraph:!1})])):o.wallet.address&&o.farmsRewardObj&&o.farmsRewardObj[e.clmm_pool_id]&&o.farmsRewardObj[e.clmm_pool_id].amountUsd?(n(),t(H,{key:1},[o.wallet.address&&o.farmsRewardObj&&o.farmsRewardObj[e.clmm_pool_id]&&o.farmsRewardObj[e.clmm_pool_id].amountUsd>0?(n(),t("div",sn,nn)):E("",!0),Number(o.farmsRewardObj[e.clmm_pool_id].amountUsd)>.01?(n(),t("span",tn,"$"+v(("addCommom"in o?o.addCommom:b(O))(("sFixD"in o?o.sFixD:b(X))(o.farmsRewardObj[e.clmm_pool_id].amountUsd||0,2))),1)):Number(o.farmsRewardObj[e.clmm_pool_id].amountUsd)>0&&Number(o.farmsRewardObj[e.clmm_pool_id].amountUsd)<.01?(n(),t("span",an,"<$0.01")):(n(),t("span",ln,"0"))],64)):(n(),t("span",rn,"0"))])]),s("td",null,[s("div",dn,[s("div",cn,[k(f,{class:"claim-btn",disabled:!o.wallet.address||!o.farmsRewardObj[e.clmm_pool_id]||!o.farmsRewardObj[e.clmm_pool_id].amountUsd||o.farmsRewardObj[e.clmm_pool_id].amountUsd<=0||o.farmsLoadingObj[e.clmm_pool_id],onClick:$o(j=>o.claimPoolReward(e.clmm_pool_id),["stop"])},{default:B(()=>[U("Claim")]),_:2},1032,["disabled","onClick"]),k(f,{class:"add-liquidity-btn",onClick:$o(j=>o.router.push(`/liquidity/deposit?poolAddress=${e.clmm_pool_id}`),["stop"])},{default:B(()=>[U("+ Add liquidity")]),_:2},1032,["onClick"])]),s("div",{class:"more",onClick:$o(j=>o.openMore(e),["stop"])},[(n(),t("svg",{class:ho(["arrow-icon",o.openMoreObj[e.clmm_pool_id]?"open-more":""]),"aria-hidden":"true"},pn,2))],8,un)])])],8,Ee),ao(s("tr",null,[s("td",_n,[o.wallet.address?(n(),t("div",fn,[!("checkNullObj"in o?o.checkNullObj:b(x))(o.farmsLoadingObj)&&o.farmsLoadingObj[e.clmm_pool_id]||o.farmsAllPositionLoading?(n(),t("div",vn,[k(_)])):o.farmsPositionObj[e.clmm_pool_id]&&o.farmsPositionObj[e.clmm_pool_id].length>0?(n(!0),t(H,{key:1},no(o.farmsPositionObj[e.clmm_pool_id],j=>(n(),T(I,{key:j.clmm_position_id,"current-tab":o.currentTab,"position-info":{...j,clmm_pool_id:e.clmm_pool_id}},null,8,["current-tab","position-info"]))),128)):(n(),T(L,{key:2,"no-data-img":"/sui-image/img-no-Positions@2x.png",desc:"No Position Found",type:"addLiquidity","add-liquidity-url":`/liquidity/deposit?poolAddress=${e.clmm_pool_id}`},null,8,["add-liquidity-url"]))])):(n(),t("div",hn,[k(L,{"no-data-img":"/sui-image/img-connect-wallet@2x.png",type:"connectWallet"})]))])],512),[[Qo,!("checkNullObj"in o?o.checkNullObj:b(x))(o.openMoreObj)&&o.openMoreObj[e==null?void 0:e.clmm_pool_id]]]),gn],64))),128))])):(n(),t("tbody",bn,[s("tr",null,[s("td",$n,[!o.wallet.connected&&o.currentTab=="My Farms"?(n(),t("div",wn,[yn,k(f,{class:"connect-wallet",onClick:r[0]||(r[0]=e=>o.wallet.setIsShowWalletModal(!0))},{default:B(()=>[U(v(o.$t("button.connectWallet")),1)]),_:1})])):o.pageList.length==0?(n(),t("div",kn,Pn)):E("",!0)])])]))])])}const is=Z(Fe,[["render",Ln],["__scopeId","data-v-d2fd23d8"]]),jn=Y({props:{currentTab:{type:String,default:""}},setup(){const o=V(!1),r=ro(),p=d(()=>r),u=po(),m=d(()=>u),a=d(()=>m.value.farmsPoolList);return{isShowMore:o,wallet:p,walletStore:r,farmsPoolList:a}}});const ls=o=>(io("data-v-f521ea67"),o=o(),lo(),o),Cn={class:"farms-table"},On=ls(()=>s("thead",null,[s("tr",null,[s("th",null,"Pools"),s("th",null,"Staked TVL"),s("th",null,"APR"),s("th",null,"Rewards / day"),s("th",null,"My Staked"),s("th",null,"Earned"),s("th",null,"Actions")]),s("tr",{style:{height:"4px",background:"unset"}})],-1)),Un={class:"pool"},Tn={class:"staked-tvl"},Rn={class:"apr"},An={class:"my-staked"},Fn={class:"actions"},Nn={class:"actions"},Dn={class:"actions"},Bn=ls(()=>s("tr",{style:{height:"8px",background:"unset !important"}},null,-1));function En(o,r,p,u,m,a){const l=Do;return n(),t("div",Cn,[s("table",null,[On,s("tbody",null,[(n(),t(H,null,no(4,(c,g)=>(n(),t(H,{key:g},[s("tr",null,[s("td",null,[s("div",Un,[k(l,{class:"upgrade-title-skeleton",loading:!0,active:"",paragraph:!1}),k(l,{class:"upgrade-title-skeleton",loading:!0,active:"",paragraph:!1})])]),s("td",null,[s("div",Tn,[k(l,{class:"upgrade-title-skeleton",loading:!0,active:"",paragraph:!1})])]),s("td",null,[s("div",Rn,[s("span",null,[k(l,{class:"upgrade-title-skeleton",loading:!0,active:"",paragraph:!1})])])]),s("td",null,[s("div",An,[k(l,{class:"upgrade-title-skeleton",loading:!0,active:"",paragraph:!1})])]),s("td",null,[s("div",Fn,[k(l,{class:"upgrade-title-skeleton",loading:!0,active:"",paragraph:!1})])]),s("td",null,[s("div",Nn,[k(l,{class:"upgrade-title-skeleton",loading:!0,active:"",paragraph:!1})])]),s("td",null,[s("div",Dn,[k(l,{class:"upgrade-title-skeleton",loading:!0,active:"",paragraph:!1})])])]),Bn],64))),64))])])])}const Mn=Z(jn,[["render",En],["__scopeId","data-v-f521ea67"]]),qn=Y({props:{positionStatus:{type:String,default:"Active"},positionInfo:{type:Object,default:()=>({})}},setup(){return{}}});const Wn=o=>(io("data-v-882c76c0"),o=o(),lo(),o),Vn={class:"position-info"},Hn={key:0,class:"status-bg"},Jn=Wn(()=>s("img",{src:ns,alt:""},null,-1)),zn=[Jn],Qn={class:"status-text"},Gn={class:"name-range"};function Kn(o,r,p,u,m,a){const l=Bo;return n(),t("div",Vn,[s("div",{class:ho(["position-status",o.positionStatus!=="Active"?"position-status-inactive":""])},[o.positionStatus=="Active"?(n(),t("div",Hn,zn)):E("",!0),s("div",Qn,v(o.positionStatus),1)],2),s("div",Gn,[s("span",null,v(o.positionInfo.name),1),o.positionStatus=="Active"?(n(),T(l,{key:0,"pool-info":o.positionInfo},null,8,["pool-info"])):E("",!0)])])}const Xn=Z(qn,[["render",Kn],["__scopeId","data-v-882c76c0"]]),Yn=Y({props:{positionInfo:{type:Object,default:()=>({})},currentTab:{type:String,default:""}},setup(o){const r=go(),p=d(()=>r),u=Co(),m=R=>{var A;return((A=p.value.tokensObj[R])==null?void 0:A.logo_url)||Oo("/image/coins/sui-unknown.png")},a=Po("Sui"),l=So("Sui"),c=V(!1),g=jo(),y=ro(),f=po(),_=d(()=>y),{setIsShowSuccess:I,setIsShowRejected:L,setIsShowWaiting:e,setTransactionDesc:j,setTransactionTxid:D}=g,w=async()=>{console.log(o.positionInfo,"props.positionInfo"),c.value=!0,D(""),j("Claim rewards"),e(!0);const R={pool_id:F.value[o.positionInfo.clmmPool].id,position_nft_id:o.positionInfo.id};try{const A=await l.harvestFarms(R),M=await _.value.currentWallet.signAndExecuteTransactionBlock(A);console.log("0221###sui swap res###",M);let $=a.handleTx(M);if($&&$.hash){D($.hash),e(!1),I(!0);let S={title:"Claim",res:$.res,hash:$.hash};a.showTransitionPending(S),await a.watchTransaction(S)&&setTimeout(()=>{f.getPositionByPool(_.value.address,o.positionInfo.clmm_pool_id,o.positionInfo.farmsPoolId)},2e3)}else e(!1),L(!0);c.value=!1}catch(A){console.log("farmsDeposit error",A),e(!1),L(!0),c.value=!1}},co=async()=>{console.log(o.positionInfo,"props.positionInfo"),c.value=!0,D(""),j(`Unstake ${o.positionInfo.name}`),e(!0);const R=F.value[o.positionInfo.clmmPool].id,A=o.positionInfo.id;try{const M=await l.farmsWithdraw(R,A),$=await _.value.currentWallet.signAndExecuteTransactionBlock(M);console.log("0221###sui swap res###",$);let S=a.handleTx($);if(S&&S.hash){D(S.hash),e(!1),I(!0);let N={res:S.res,title:"Unstaked",hash:S.hash};a.showTransitionPending(N),await a.watchTransaction(N)&&setTimeout(()=>{console.log(o.positionInfo,"##props.positionInfo"),f.getPositionByPool(_.value.address,o.positionInfo.clmm_pool_id,o.positionInfo.farmsPoolId),c.value=!1},2e3)}else e(!1),L(!0)}catch(M){console.log("farmsDeposit error",M),e(!1),L(!0),c.value=!1}},J=async()=>{console.log(o.positionInfo,"props.positionInfo"),c.value=!0,D(""),j(`Stake ${o.positionInfo.name}`),e(!0);const R={clmm_pool_id:o.positionInfo.clmmPool,clmm_position_id:o.positionInfo.pos_object_id,coinTypeA:o.positionInfo.coin_type_a,coinTypeB:o.positionInfo.coin_type_b},A=F.value[o.positionInfo.clmmPool].id;try{const M=await l.farmsDeposit(R,A),$=await _.value.currentWallet.signAndExecuteTransactionBlock(M);console.log("0221###sui swap res###",$);let S=a.handleTx($);if(S&&S.hash){D(S.hash),e(!1),I(!0);let N={res:S.res,title:"Staked",hash:S.hash};a.showTransitionPending(N),await a.watchTransaction(N)&&setTimeout(()=>{f.getPositionByPool(_.value.address,o.positionInfo.clmm_pool_id,o.positionInfo.farmsPoolId),c.value=!1},2e3)}else e(!1),L(!0)}catch(M){console.log("farmsDeposit error",M),e(!1),L(!0),c.value=!1}},G=d(()=>f),F=d(()=>G.value.farmsPoolObj);return{getCoinIcon:m,router:u,claim:w,unStake:co,loading:c,stake:J,sFixD:X,addCommom:O}}});const rs=o=>(io("data-v-523e7f54"),o=o(),lo(),o),Zn={class:"farms-position"},xn={class:"farms-position-box"},ot={class:"position-info-block"},st={class:"block-item"},et=rs(()=>s("div",{class:"leabl"},"Liquidity",-1)),nt={class:"text"},tt={class:"earnings"},at={class:"block-item"},it=rs(()=>s("div",{class:"leabl"},"Earnings",-1)),lt={class:"text"},rt={key:0},dt={alt:""},ct={key:1,class:"rewards-day"},ut={class:"unstake-btn-box"};function mt(o,r,p,u,m,a){const l=Xn,c=wo,g=Lo("image");return n(),t("div",Zn,[s("div",xn,[k(l,{"position-info":o.positionInfo},null,8,["position-info"])]),s("div",ot,[s("div",st,[et,s("div",nt,v(o.positionInfo.positionUSD>0&&o.positionInfo.positionUSD<.01?"<$0.01":`~$${("addCommom"in o?o.addCommom:b(O))(("sFixD"in o?o.sFixD:b(X))(o.positionInfo.positionUSD,2))}`),1)])]),s("div",tt,[s("div",at,[it,s("div",lt,[o.positionInfo.rewards&&o.positionInfo.rewards.length>0?(n(!0),t(H,{key:0},no(o.positionInfo.rewards,y=>(n(),t("div",{key:y.rewarder_type,class:"rewards-day"},[y.rewarderAmount>0?(n(),t("div",rt,[ao(s("img",dt,null,512),[[g,o.getCoinIcon(y.rewarder_type)]]),s("span",null,v(y.rewarderAmount),1)])):E("",!0)]))),128)):(n(),t("div",ct,"--"))])]),o.positionInfo.positionSource=="clmm"?(n(),T(c,{key:0,class:"add-liquidity-btn claim-btn",onClick:r[0]||(r[0]=y=>o.router.push(`/new-position-detail?collect=${o.positionInfo.collectionName}&&token=${o.positionInfo.tokenName}&&address=${o.positionInfo.pool}&pos=${o.positionInfo.pos_object_id}`))},{default:B(()=>[U("+ Add liquidity")]),_:1})):(n(),T(c,{key:1,class:"claim-btn",disabled:o.positionInfo.positionRewardAmount==0||o.currentTab=="Ended",onClick:o.claim},{default:B(()=>[U("↑ Claim")]),_:1},8,["disabled","onClick"]))]),s("div",ut,[s("div",null,[o.positionInfo.positionSource=="clmm"?(n(),T(c,{key:0,class:"unstake-btn",loading:o.loading,disabled:o.positionInfo.positionStatus!=="Active",onClick:o.stake},{default:B(()=>[U("Stake")]),_:1},8,["loading","disabled","onClick"])):(n(),T(c,{key:1,class:"unstake-btn",onClick:o.unStake},{default:B(()=>[U("Unstake")]),_:1},8,["onClick"]))])])])}const ds=Z(Yn,[["render",mt],["__scopeId","data-v-523e7f54"]]),pt=Y({components:{FarmsH5Position:ds},props:{currentTab:{type:String,default:""},sortValue:{type:String,default:"APR"}},setup(o){const r=V(!1),p=ro(),u=d(()=>p),m=po(),a=d(()=>m),l=d(()=>(console.log(a.value.farmsPoolList,"##farms.value.farmsPoolList"),o.currentTab=="My Farms"?u.value.address?a.value.myFarmsPoolList:[]:o.currentTab=="Ended"?a.value.farmsPoolList.filter(i=>i.status=="Ended"):a.value.farmsPoolList.filter(i=>i.status=="Live"))),c=V([]),g=jo(),y=d(()=>g),f=d(()=>y.value.addressLpTokens),_=i=>{const h=l.value.map(P=>{const{stable_farming:C}=f.value[P.clmm_pool_id];return{...P,apr:C.apr,tvl:C.tvl}});i=="APR"?c.value=h.sort((P,C)=>C.apr-P.apr):c.value=h.sort((P,C)=>C.tvl-P.tvl),console.log(c.value,"##farmsPoolList.value")};Io(()=>[l.value,o.sortValue,f.value],([i,h,P])=>{console.log(h,"sortValue326"),i&&i.length>0&&h&&P&&!x(P)&&_(h)},{immediate:!0});const I=d(()=>a.value.farmsUserUsd),L=d(()=>(console.log(a.value.farmsRewardObj,"##farmsRewardObj"),a.value.farmsRewardObj)),e=d(()=>a.value.farmsPositionObj),j=d(()=>a.value.farmsPoolListLoading),D=d(()=>a.value.farmsPositionList),w=d(()=>(console.log(a.value.farmsLoadingObj,"##farms.value.farmsLoadingObj"),a.value.farmsLoadingObj)),co=d(()=>a.value.farmsAllPositionLoading),J=V({}),G=i=>{J.value[i.clmm_pool_id]?J.value[i.clmm_pool_id]=!1:(J.value[i.clmm_pool_id]=!0,console.log("执行了吗"),m.getPositionByPool(u.value.address,i.clmm_pool_id,i.id))},F=So("Sui"),R=Po("Sui"),{setIsShowSuccess:A,setIsShowRejected:M,setIsShowWaiting:$,setTransactionDesc:S,setTransactionTxid:N}=g,W=async i=>{console.log(D.value,"farmsRewardObj###");const h=[];D.value.forEach(P=>{console.log(i,P,"#position"),i==P.clmm_pool_id&&h.push({pool_id:P.pool_id,position_nft_id:P.id})}),console.log(JSON.stringify(h),"##params"),N(""),S("Claim rewards"),$(!0);try{const P=await F.batchHarvest(h),C=await u.value.currentWallet.signAndExecuteTransactionBlock(P);console.log("0221###sui swap res###",C);let oo=R.handleTx(C);if(oo&&oo.hash){N(oo.hash),$(!1),A(!0);let vo={res:oo.res,title:"Claim",hash:oo.hash};R.showTransitionPending(vo),await R.watchTransaction(vo)&&setTimeout(()=>{m.getFarmsPoolList()},4e3)}else $(!1),M(!0)}catch(P){console.log("Claim all error",P),$(!1),M(!0)}},q=Co(),eo=go(),to=d(()=>eo),To=d(()=>(console.log(to.value.poolsObj,"##pools.value.poolsObj"),to.value.poolsObj)),Ro=d(()=>to.value.tokensObj),fo=V({}),Q=(i,h)=>i&&h?_s.plus(Fo(i),Fo(h)):i||0,z=i=>{let h=0;return i&&i.forEach(P=>{h+=Fo(String(P))}),String(mo(String(h),2))},K=(i,h,P)=>{console.log(i,"poolsObj##473"),Object.keys(i).forEach(C=>{var bo,ko,uo;const oo=(bo=h[C])==null?void 0:bo.apr_7day,vo=Q((ko=h[C])==null?void 0:ko.apr_7day,z((uo=h[C])==null?void 0:uo.rewarder_apr));fo.value[C]={...i[C],apr:String(oo).replace("%",""),aprTotal:vo},fo.value[C].rewards=[],i[C].rewarderInfo.forEach((Ao,Eo)=>{var Wo,Vo;const Mo=(Wo=P[Ao.coinAddress])==null?void 0:Wo.symbol,qo=(Vo=h[C])==null?void 0:Vo.rewarder_apr[Eo];console.log(Mo,qo,"getRewardInfo:"),console.log(i[C],"## poolsObj[key]"),fo.value[C].rewards.push({symbol:Mo,rewarderApr:qo,rewarder_display:i[C][`rewarder_display${Eo+1}`]})})}),console.log(fo.value,"##rewardInfoObj")};return Io(()=>[To.value,f.value,Ro.value],([i,h,P])=>{i&&!x(i)&&h&&!x(h)&&P&&!x(P)&&K(i,h,P)},{immediate:!0}),{isShowMore:r,wallet:u,farmsPoolList:c,farmsUserUsd:I,sFixD:X,farmsRewardObj:L,farmsPositionObj:e,openMore:G,checkNullObj:x,openMoreObj:J,farmsPoolListLoading:j,claimPoolReward:W,router:q,addCommom:O,farmsLoadingObj:w,farmsAllPositionLoading:co,addressLpTokens:f,rewardInfoObj:fo}}});const so=o=>(io("data-v-87ff3267"),o=o(),lo(),o),_t={key:0,class:"farms-pool-list"},ft={class:"farms-block"},vt={class:"item-block"},ht=so(()=>s("div",{class:"leabl"},"Staked TVL",-1)),gt={class:"text"},bt={class:"item-block apr"},$t=so(()=>s("div",{class:"leabl"},"APR",-1)),wt={class:"text"},yt={class:"apr-hover-box"},kt={class:"item-block"},It=so(()=>s("div",{class:"leabl"},"Rewards / day",-1)),St={class:"text"},Pt={class:"item-block my-staked"},Lt=so(()=>s("div",{class:"leabl"},"My Staked",-1)),jt={key:0,class:"text"},Ct={class:"position-usd"},Ot={key:0,class:"position-num"},Ut={key:1,class:"text"},Tt=so(()=>s("div",{class:"position-usd"},"--",-1)),Rt=[Tt],At={class:"item-block"},Ft=so(()=>s("div",{class:"leabl"},"Earned",-1)),Nt={class:"text earned-box"},Dt={class:"earned"},Bt={key:0,class:"my-staked-loading"},Et=so(()=>s("div",{class:"ratio-bg"},[s("div",{class:"ratio"})],-1)),Mt={key:0},qt={key:1},Wt={key:2},Vt={key:2},Ht={class:"add-liquidity-box"},Jt=["onClick"],zt=so(()=>s("use",{"xlink:href":"#icon-icon_arrow"},null,-1)),Qt=[zt],Gt={key:1,class:"upgrade-loading"},Kt={key:2,class:"no-data"},Xt=so(()=>s("img",{src:Xo,alt:""},null,-1)),Yt={key:3,class:"no-data"},Zt=so(()=>s("img",{src:Yo,alt:""},null,-1)),xt=so(()=>s("span",null,"No Data",-1)),oa=[Zt,xt];function sa(o,r,p,u,m,a){const l=os,c=Ko,g=ss,y=Do,f=wo,_=ds,I=as,L=ps;return n(),t(H,null,[o.farmsPoolListLoading?o.farmsPoolListLoading?(n(),t("div",Gt,[k(L,{type:"poolsCard",loading:!0})])):E("",!0):(n(),t("div",_t,[(n(!0),t(H,null,no(o.farmsPoolList,e=>{var j,D;return n(),t("div",{key:e.id,class:"farms-item"},[k(l,{"pool-info":e},null,8,["pool-info"]),s("div",ft,[s("div",vt,[ht,s("div",gt,"$"+v(("addCommom"in o?o.addCommom:b(O))(e.tvl,2)),1)]),s("div",bt,[$t,s("div",wt,[U(v(e.total_apr>0&&e.total_apr<1e-4?"<0.01%":("addCommom"in o?o.addCommom:b(O))(e.total_apr*100,2))+"% ",1),s("div",yt,[!("checkNullObj"in o?o.checkNullObj:b(x))(o.rewardInfoObj)&&o.rewardInfoObj[e.clmm_pool_id]?(n(),T(c,{key:0,"l-item":o.rewardInfoObj[e.clmm_pool_id],"rewarder-info":o.rewardInfoObj[e.clmm_pool_id].rewards,class:"noHover apr-hover-con"},null,8,["l-item","rewarder-info"])):E("",!0)])])]),s("div",kt,[It,s("div",St,[(n(!0),t(H,null,no(e.rewarders,w=>(n(),T(g,{key:w.reward_coin,"reward-info":w,"current-tab":o.currentTab},null,8,["reward-info","current-tab"]))),128))])]),s("div",Pt,[Lt,o.wallet.address?(n(),t("div",jt,[s("div",Ct,v(Number((j=o.farmsUserUsd[e.clmm_pool_id])==null?void 0:j.amount)>0&&Number((D=o.farmsUserUsd[e.clmm_pool_id])==null?void 0:D.amount)<.01?"<$0.01":"$"+("addCommom"in o?o.addCommom:b(O))(o.farmsUserUsd&&o.farmsUserUsd[e.clmm_pool_id]&&o.farmsUserUsd[e.clmm_pool_id].amount||0,2)),1),o.farmsUserUsd&&o.farmsUserUsd[e.clmm_pool_id]&&o.farmsUserUsd[e.clmm_pool_id].positionNum?(n(),t("div",Ot,v(o.farmsUserUsd[e.clmm_pool_id].positionNum)+" "+v(o.farmsUserUsd[e.clmm_pool_id].positionNum>1?"Positions":"Position"),1)):E("",!0)])):(n(),t("div",Ut,Rt))]),s("div",At,[Ft,s("div",Nt,[s("div",Dt,[o.farmsLoadingObj[e.clmm_pool_id]||o.farmsAllPositionLoading?(n(),t("div",Bt,[k(y,{class:"upgrade-title-skeleton",loading:!0,active:"",paragraph:!1})])):o.wallet.address&&o.farmsRewardObj&&o.farmsRewardObj[e.clmm_pool_id]&&o.farmsRewardObj[e.clmm_pool_id].amountUsd?(n(),t(H,{key:1},[Et,o.farmsRewardObj[e.clmm_pool_id].amountUsd>.01?(n(),t("span",Mt,"$"+v(("addCommom"in o?o.addCommom:b(O))(("sFixD"in o?o.sFixD:b(X))(o.farmsRewardObj[e.clmm_pool_id].amountUsd||0,2))),1)):o.farmsRewardObj[e.clmm_pool_id].amountUsd>0&&o.farmsRewardObj[e.clmm_pool_id].amountUsd<.01?(n(),t("span",qt,"<$0.01")):(n(),t("span",Wt,"0"))],64)):(n(),t("span",Vt,"--"))]),k(f,{class:"claim-btn",disabled:!o.wallet.address||!o.farmsRewardObj[e.clmm_pool_id]||o.farmsRewardObj[e.clmm_pool_id].amountUsd<=0,onClick:$o(w=>o.claimPoolReward(e.clmm_pool_id),["stop"])},{default:B(()=>[U("Claim")]),_:2},1032,["disabled","onClick"])])])]),s("div",Ht,[k(f,{class:"add-liquidity-btn",onClick:$o(w=>o.router.push(`/liquidity/deposit?poolAddress=${e.clmm_pool_id}`),["stop"])},{default:B(()=>[U("+ Add liquidity")]),_:2},1032,["onClick"])]),s("div",{class:"more-btn",onClick:w=>o.openMore(e)},[(n(),t("svg",{class:ho(["arrow-icon",!("checkNullObj"in o?o.checkNullObj:b(x))(o.openMoreObj)&&o.openMoreObj[e==null?void 0:e.clmm_pool_id]?"open-more":""]),"aria-hidden":"true"},Qt,2))],8,Jt),(n(!0),t(H,null,no(o.farmsPositionObj[e.clmm_pool_id],w=>ao((n(),T(_,{key:w.clmm_pool_id,"current-tab":o.currentTab,"position-info":{...w,clmm_pool_id:e.clmm_pool_id}},null,8,["current-tab","position-info"])),[[Qo,!("checkNullObj"in o?o.checkNullObj:b(x))(o.openMoreObj)&&o.openMoreObj[e==null?void 0:e.clmm_pool_id]]])),128)),o.farmsPositionObj&&o.farmsPositionObj[e.clmm_pool_id]&&o.farmsPositionObj[e.clmm_pool_id].length==0?(n(),T(I,{key:0,"no-data-img":"/sui-image/img-no-Positions@2x.png",desc:"No Position Found",type:"addLiquidity","add-liquidity-url":`/liquidity/deposit?poolAddress=${e.clmm_pool_id}`},null,8,["add-liquidity-url"])):E("",!0),o.wallet.address?E("",!0):(n(),T(I,{key:1,"no-data-img":"/sui-image/img-connect-wallet@2x.png",type:"connectWallet"},null,8,["no-data-img"]))])}),128))])),!o.wallet.connected&&o.currentTab=="My Farms"?(n(),t("div",Kt,[Xt,k(f,{class:"connect-wallet",onClick:r[0]||(r[0]=e=>o.wallet.setIsShowWalletModal(!0))},{default:B(()=>[U(v(o.$t("button.connectWallet")),1)]),_:1})])):o.farmsPoolList.length==0?(n(),t("div",Yt,oa)):E("",!0)],64)}const cs=Z(pt,[["render",sa],["__scopeId","data-v-87ff3267"]]),ea=Y({setup(o,r){const p=V("Live"),u=V("APR"),m=V(!1),a=V(!1),l=po(),c=d(()=>l),g=ro(),y=d(()=>g),f=d(()=>p.value=="My Farms"?y.value.address?c.value.myFarmsPoolList:[]:p.value=="Ended"?c.value.farmsPoolList.filter(w=>w.status=="Ended"):c.value.farmsPoolList.filter(w=>w.status=="Live")),_=d(()=>c.value.farmsPoolList.filter(w=>w.status=="Ended")),I=d(()=>_.value.length>0?["Live","Ended","My Farms"]:["Live","My Farms"]),L=w=>f.value.length,e=()=>{m.value=!0,l.getFarmsPoolList(),setTimeout(()=>{m.value=!1},1e3)},j=w=>{p.value=w,r.emit("changeTab",w)},D=w=>{u.value=w,r.emit("changeSortValue",w)};return Go(()=>{document.addEventListener("click",()=>{a.value=!1})}),{isOpenList:a,tabList:I,currentTab:p,sortValue:u,clickRefresh:e,isRefresh:m,farmsPoolList:f,getListNum:L,changeTab:j,changeSortValue:D}}});const yo=o=>(io("data-v-d69fe9df"),o=o(),lo(),o),na={class:"farms-tab"},ta={class:"tab-left"},aa=["onClick"],ia={key:0},la={class:"tab-right"},ra={class:"sort-select"},da=yo(()=>s("div",null,"Sort by",-1)),ca={class:"showSort"},ua=yo(()=>s("svg",{class:"sort-icon","aria-hidden":"true"},[s("use",{"xlink:href":"#icon-icon_on-pool"})],-1)),ma=yo(()=>s("use",{"xlink:href":"#icon-icon_arrow"},null,-1)),pa=[ma],_a={key:0,class:"sort-list"},fa=yo(()=>s("svg",{class:"sort-icon","aria-hidden":"true"},[s("use",{"xlink:href":"#icon-icon_on-pool"})],-1)),va=yo(()=>s("svg",{class:"sort-icon","aria-hidden":"true"},[s("use",{"xlink:href":"#icon-icon_on-pool"})],-1)),ha={class:"refresh"},ga=yo(()=>s("use",{"xlink:href":"#icon-icon-refresh2"},null,-1)),ba=[ga];function $a(o,r,p,u,m,a){return n(),t("div",na,[s("div",ta,[(n(!0),t(H,null,no(o.tabList,l=>(n(),t("div",{key:l,class:ho(["tab-item",o.currentTab==l?"tab-item-active":""]),onClick:c=>o.changeTab(l)},[s("span",null,v(l=="Ended"?"Finished":l),1),o.currentTab==l&&o.getListNum(l)?(n(),t("p",ia,v(o.getListNum(l)),1)):E("",!0)],10,aa))),128))]),s("div",la,[s("div",ra,[s("div",{class:"sort-select-box",onClick:r[0]||(r[0]=$o(l=>o.isOpenList=!o.isOpenList,["stop"]))},[da,s("div",ca,[s("span",null,v(o.sortValue),1),ua,(n(),t("svg",{class:ho(["arrow-icon",o.isOpenList?"arrow-icon-active":""]),"aria-hidden":"true"},pa,2))])]),o.isOpenList?(n(),t("div",_a,[s("div",{class:"sort-item",onClick:r[1]||(r[1]=l=>o.changeSortValue("APR"))},[U("APR "),fa]),s("div",{class:"sort-item",onClick:r[2]||(r[2]=l=>o.changeSortValue("TVL"))},[U("TVL "),va])])):E("",!0)]),s("div",ha,[(n(),t("svg",{"aria-hidden":"true",class:ho(["refresh-icon",o.isRefresh?"refreshing":""]),onClick:r[3]||(r[3]=(...l)=>o.clickRefresh&&o.clickRefresh(...l))},ba,2))])])])}const wa=Z(ea,[["render",$a],["__scopeId","data-v-d69fe9df"]]),ya=Y({components:{FarmsBanner:xo,FarmsTabs:wa,FarmsTable:is,FarmsH5List:cs},setup(){const o=po(),r=d(()=>o),p=d(()=>r.value.farmsPoolListLoading),u=V("APR"),m=d(()=>r.value.farmsPoolList),a=ro(),l=d(()=>a),c=go(),g=d(()=>c);Io(()=>[l.value.address,m.value,g.value.tokensObj,g.value.RATES],([f,_,I,L])=>{f&&_.length>0&&!x(I)&&!x(L)&&o.getPositionByAllPool(f)},{immediate:!0}),Go(()=>{o.getFarmsPoolList()}),Io(()=>l.value.address,f=>{f||o.logOut()},{immediate:!0});const y=V("Live");return{farmsPoolListLoading:p,currentTab:y,sortValue:u}}});const ka={class:"farm-container"},Ia={class:"farm-container-center"};function Sa(o,r,p,u,m,a){const l=xo,c=ms("FarmsTabs"),g=is,y=Mn,f=cs;return n(),t("div",ka,[k(l),s("div",Ia,[k(c,{onChangeTab:r[0]||(r[0]=_=>{o.currentTab=_}),onChangeSortValue:r[1]||(r[1]=_=>{o.sortValue=_})}),o.farmsPoolListLoading?(n(),T(y,{key:1,"current-tab":o.currentTab},null,8,["current-tab"])):(n(),T(g,{key:0,"current-tab":o.currentTab,"sort-value":o.sortValue},null,8,["current-tab","sort-value"])),k(f,{"current-tab":o.currentTab,"sort-value":o.sortValue},null,8,["current-tab","sort-value"])])])}const Ha=Z(ya,[["render",Sa],["__scopeId","data-v-12d06cb2"]]);export{Ha as default};
