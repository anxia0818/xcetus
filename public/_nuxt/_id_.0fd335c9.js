import{_ as an}from"./back.295a9631.js";import{_ as un}from"./refresh-icon.a3ebc4ec.js";import{a as je,M as Lo,l as Po,r as k,m as rn,e as We,q as lo,o as u,c as ne,w as we,h as o,i as G,j as Ee,t as m,f,F as so,s as Uo,v as Le,x as U,y as dn,I as vn,B as So,p as Xe,k as Ge,z as fo,A as bo,C as g,D as Se,b as To,E as eo,G as Ro,H as Qe,u as I,J as Vo,K as Io,L as Eo,N as wo}from"./entry.90fb2bd1.js";/* empty css              */import{_ as mn,a as cn,b as pn}from"./icon-error_2x.493727a6.js";import{u as Je,a as Wo}from"./autoPool.cfd1e1b5.js";import{u as oo,c as xe,a as T,g as Co,d as ze,s as S,f as jo,T as Ve,b as re,p as Mo,e as Xo,h as fn}from"./pool.7374d26d.js";import{_ as yo}from"./token-warning.94c5ac25.js";import{_ as Go}from"./auto-pool-apy-tips.57318208.js";import{u as go,a as No}from"./sha256.57951879.js";import{i as ro}from"./import-icon.de3e6c66.js";import"./decimal.6f03adc8.js";import{D as i}from"./decimal.0bdeb344.js";import{_ as Ho}from"./assets-card.a992dbac.js";import{_ as Yo}from"./coin-lock.17b10a72.js";import{_ as zo,a as Jo}from"./auto-pool-remove-modal.e76ef22f.js";import{afterCurrentPrice as $o}from"./data.41fac29b.js";import{V as Ao}from"./index.b4efb019.js";/* empty css              *//* empty css              */import{u as bn}from"./swapRouter.cafdee74.js";/* empty css              *//* empty css              *//* empty css              */import"./img-lock_2x.a28135f4.js";import"./img-lock_2x.8a1bcf0c.js";const yn=je({components:{Modal:Lo},setup(e,t){const{t:V,locale:X}=Po(),R=Je(),C=["0.1","0.5","1"],r=k(R.slippage||.1),{setSlippage:P}=R,h=rn();console.log(r.value,"slippage.value");const v=k(!1);function s(F,n){v.value=!1,r.value=n}function D(){P(r.value),t.emit("onClose",!1)}return{settingArr:C,changeActiveIndex:s,confirm:D,emit:h,slippage:r,t:V,isInput:v}}});const Ko=e=>(Xe("data-v-405dfb5e"),e=e(),Ge(),e),gn=Ko(()=>o("svg",{class:"icon modal-icon-close","aria-hidden":"true"},[o("use",{"xlink:href":"#icon-a-icon-Shutdown"})],-1)),hn={class:"setting-container"},kn={class:"title"},_n=Ko(()=>o("img",{src:pn,alt:""},null,-1)),wn={class:"tag-list"},$n={key:0,src:mn,alt:""},In={key:1,src:cn,alt:""},Cn={class:"footer"};function An(e,t,V,X,R,C){const r=dn,P=vn,h=So,v=lo("Modal");return u(),ne(v,{title:"Settings",class:"setting",centered:"",visible:!0,width:"400px",onCancel:t[3]||(t[3]=s=>e.$emit("onClose"))},{closeIcon:we(()=>[gn]),footer:we(()=>[o("div",Cn,[G(h,{type:"cancel",class:"cancel-btn cancel-btn-new",onClick:t[2]||(t[2]=s=>e.$emit("onClose"))},{default:we(()=>[Ee(m(e.$t("button.cancel")),1)]),_:1}),G(h,{class:"confirmbtn",disabled:Number(e.slippage)==0||Number(e.slippage)>1||Number(e.slippage)<.01,onClick:e.confirm},{default:we(()=>[Ee(m(e.$t("button.confirm")),1)]),_:1},8,["disabled","onClick"])])]),default:we(()=>[o("div",hn,[o("div",kn,[_n,o("span",null,m(e.$t("modal.slippageTolerance")),1)]),o("div",wn,[(u(!0),f(so,null,Uo(e.settingArr,(s,D)=>(u(),ne(r,{key:D,class:Le(!e.isInput&&s==e.slippage?"tag-active":""),onClick:F=>e.changeActiveIndex(D,s)},{default:we(()=>[Ee(m(s)+"% ",1)]),_:2},1032,["class","onClick"]))),128)),G(r,{class:Le(["input-tag",e.isInput?"tag-active":""]),onClick:t[1]||(t[1]=s=>e.isInput=!0)},{default:we(()=>[G(P,{value:e.slippage,"onUpdate:value":t[0]||(t[0]=s=>e.slippage=s),placeholder:"",suffix:"%",class:Le(["slippage-input",Number(e.slippage)>.5&&Number(e.slippage)<1?"slippage-input-waring":Number(e.slippage)>1?"slippage-input-error":""])},null,8,["value","class"])]),_:1},8,["class"])])]),Number(e.slippage)>.5&&Number(e.slippage)<1||Number(e.slippage)>1?(u(),f("div",{key:0,class:Le(["slippage-hint",Number(e.slippage)>.5&&Number(e.slippage)<1?"slippage-hint-waring":Number(e.slippage)>1?"slippage-hint-error":""])},[Number(e.slippage)>.5&&1>=Number(e.slippage)?(u(),f("img",$n)):U("",!0),Number(e.slippage)>1?(u(),f("img",In)):U("",!0),o("p",null,m(Number(e.slippage)>.5&&1>=Number(e.slippage)?e.$t("tips.slippageTolerance2"):Number(e.slippage)>1?e.$t("tips.slippageTolerance1"):""),1)],2)):U("",!0)]),_:1})}const Pn=We(yn,[["render",An],["__scopeId","data-v-405dfb5e"]]),Sn=je({props:{poolInfo:{type:Object,default:()=>({})}},setup(e,t){const V=k(!1),X=k(null),R=k(0);let C=k(!1);const r=k(20),P=oo(),h=Je(),v=k(!1);fo(()=>{}),bo(()=>{clearInterval(X.value)});const s=()=>{C.value=!1,X.value=setInterval(()=>{var c;v.value||R.value<r.value&&(R.value+=1,R.value===r.value&&((c=e==null?void 0:e.poolInfo)!=null&&c.poolAddress&&P.updateCurrentPools(e.poolInfo.poolAddress,store.chainName),R.value=0))},1e3)},D=g(()=>h.slippage),F=()=>{t.emit("clearAll")},n=()=>{C.value=!0,R.value=0,t.emit("clickRefresh"),setTimeout(()=>{C.value=!1,s()},1e3)};Se(()=>e.poolInfo,c=>{c&&!X.value&&s()},{immediate:!0});const d=To(),a=eo();return console.log(a,"route"),{refresh:C,clickRefresh:n,isShowSwapSetting:V,countdown:R,autoRefreshTime:r,slippage:D,clearAll:F,checkNullObj:xe,router:d,route:a}}});const Tn=e=>(Xe("data-v-7418921d"),e=e(),Ge(),e),Rn={class:"title"},Nn={class:"left"},qn=Tn(()=>o("svg",{class:"icon","aria-hidden":"true"},[o("use",{"xlink:href":"#icon-a-icon-setslippage"})],-1)),Dn={key:0,class:"deposit-progress"};function Bn(e,t,V,X,R,C){const r=an,P=un,h=Pn;return u(),f("div",Rn,[o("div",Nn,[G(r)]),o("div",{class:Le(["right title-right deposit-setting",e.poolInfo?"havePoolInfo":"noPoolInfo"])},[o("div",{class:"slippage-icon",onClick:t[0]||(t[0]=v=>e.isShowSwapSetting=!0)},[qn,o("span",null,m(e.slippage)+"%",1)]),e.route.name!=="liquidity-create"?(u(),f("div",Dn,[G(P,{loading:e.refresh,"auto-refresh-time":e.autoRefreshTime,countdown:e.countdown,onClickRefresh:e.clickRefresh},null,8,["loading","auto-refresh-time","countdown","onClickRefresh"])])):U("",!0)],2),e.isShowSwapSetting?(u(),ne(h,{key:0,onOnClose:t[1]||(t[1]=v=>e.isShowSwapSetting=!1)})):U("",!0)])}const Fn=We(Sn,[["render",Bn],["__scopeId","data-v-7418921d"]]),On=je({components:{AutoPoolApyTips:Go},setup(){const e=go(),t=g(()=>e),V=oo(),X=g(()=>V),R=Je(),C=g(()=>R),r=g(()=>t.value.theme),P=eo(),h=k();Se(()=>[C.value.positionInfoObj,P.params.id],([d,a])=>{d&&!xe(d)&&a&&(h.value=d[a],console.log(h.value,"##positionInfo.value"))},{immediate:!0,deep:!0});const v=g(()=>{var d;return(d=h.value)==null?void 0:d.needReverse}),s=d=>{var a;return(d==null?void 0:d.logoURI)||(d==null?void 0:d.logo_url)||((a=X.value.tokensObj[d==null?void 0:d.address])==null?void 0:a.logo_url)||(r.value==="default"?ro("/image/coins/unknown.png"):ro("/image/coins/sui-unknown.png"))},D=g(()=>{var d,a;return console.log((d=h==null?void 0:h.value)==null?void 0:d.poolUSD,"##positionInfo?.value?.poolUSD"),(a=h==null?void 0:h.value)==null?void 0:a.poolUSD}),F=g(()=>{var d,a;return C.value.apyObj&&((a=C.value.apyObj[(d=h.value)==null?void 0:d.id])==null?void 0:a.apr)||"--"}),n=g(()=>t.value.currentExplorer);return{positionInfo:h,needReverse:v,getCoinIcon:s,tvl:D,apy:F,addCommom:T,getExplorerUrl:Co,currentExplorer:n}}});const He=e=>(Xe("data-v-0947d30b"),e=e(),Ge(),e),Mn={class:"auto-pool-v2-info"},Ln={class:"pool-info"},Un={class:"left"},Vn={class:"coin-a"},En={alt:""},Wn={class:"coin-b"},jn={alt:""},Xn={class:"position-name"},Gn={key:0,class:"pool-fee"},Hn=He(()=>o("span",null,"Fee tier",-1)),Yn={class:"vault-address"},zn=["href"],Jn=He(()=>o("span",null,"Vault Address",-1)),Kn=He(()=>o("svg",{class:"icon","aria-hidden":"true"},[o("use",{"xlink:href":"#icon-icon-link"})],-1)),Zn=[Jn,Kn],Qn={class:"apy-and-tvl"},xn={class:"apy"},et=He(()=>o("div",{class:"apy-title"},"APY",-1)),ot={class:"apy-text"},nt={class:"tvl"},tt=He(()=>o("div",{class:"tvl-title"},"TVL",-1)),st={class:"tvl-text"},lt={class:"pool-info h5-pool-info"},it={class:"left"},at={class:"coin-a"},ut={alt:""},rt={class:"coin-b"},dt={alt:""},vt={class:"position-name"},mt={key:0,class:"pool-fee"},ct=He(()=>o("span",null,"Fee tier",-1)),pt={class:"left"},ft={class:"vault-address"},bt=["href"],yt=He(()=>o("span",null,"Vault Address",-1)),gt=He(()=>o("svg",{class:"icon","aria-hidden":"true"},[o("use",{"xlink:href":"#icon-icon-link"})],-1)),ht=[yt,gt],kt={class:"apy-and-tvl"},_t={class:"apy"},wt=He(()=>o("div",{class:"apy-title"},"APY",-1)),$t={class:"apy-text"},It={class:"tvl"},Ct=He(()=>o("div",{class:"tvl-title"},"TVL",-1)),At={class:"tvl-text"};function Pt(e,t,V,X,R,C){var v,s,D,F,n,d,a,c,_,p,q,N,O,z,J,x,y,b,E,K,A,B,H,te,he,fe,pe,ke,W,de,ve,w,Z,Te,be,De,Ae,Be,$e,Oe,Re,vo,ue,Pe,Ne,no;const r=yo,P=Go,h=Ro("image");return u(),f("div",Mn,[o("div",Ln,[o("div",Un,[o("div",Vn,[Qe(o("img",En,null,512),[[h,e.needReverse?e.getCoinIcon((s=e.positionInfo)==null?void 0:s.token_b):e.getCoinIcon((v=e.positionInfo)==null?void 0:v.token_a)]]),G(r,{address:e.needReverse?(d=(n=e.positionInfo)==null?void 0:n.token_b)==null?void 0:d.address:(F=(D=e.positionInfo)==null?void 0:D.token_a)==null?void 0:F.address,"style-params":{width:"12px",height:"12px",left:"18px",bottom:"4px"}},null,8,["address"])]),o("div",Wn,[Qe(o("img",jn,null,512),[[h,e.needReverse?e.getCoinIcon((c=e.positionInfo)==null?void 0:c.token_a):e.getCoinIcon((a=e.positionInfo)==null?void 0:a.token_b)]]),G(r,{address:e.needReverse?(N=(q=e.positionInfo)==null?void 0:q.token_a)==null?void 0:N.address:(p=(_=e.positionInfo)==null?void 0:_.token_b)==null?void 0:p.address,"style-params":{width:"12px",height:"12px",left:"18px",bottom:"4px"}},null,8,["address"])]),o("div",Xn,m(e.needReverse?(z=(O=e.positionInfo)==null?void 0:O.token_b)==null?void 0:z.symbol:(x=(J=e.positionInfo)==null?void 0:J.token_a)==null?void 0:x.symbol)+" - "+m(e.needReverse?(b=(y=e.positionInfo)==null?void 0:y.token_a)==null?void 0:b.symbol:(K=(E=e.positionInfo)==null?void 0:E.token_b)==null?void 0:K.symbol),1),(A=e.positionInfo)!=null&&A.fee?(u(),f("div",Gn,[Hn,Ee(" "+m(((B=e.positionInfo)==null?void 0:B.fee)*100)+"% ",1)])):U("",!0),o("div",Yn,[o("a",{href:("getExplorerUrl"in e?e.getExplorerUrl:I(Co))(e.currentExplorer,"poolAddress",(H=e.positionInfo)==null?void 0:H.id),target:"_blank"},Zn,8,zn)])]),o("div",Qn,[o("div",xn,[et,o("div",ot,[Ee(m(e.apy)+" ",1),G(P)])]),o("div",nt,[tt,o("div",st,"$"+m(("addCommom"in e?e.addCommom:I(T))(e.tvl,2)),1)])])]),o("div",lt,[o("div",it,[o("div",at,[Qe(o("img",ut,null,512),[[h,e.needReverse?e.getCoinIcon((he=e.positionInfo)==null?void 0:he.token_b):e.getCoinIcon((te=e.positionInfo)==null?void 0:te.token_a)]]),G(r,{address:e.needReverse?(W=(ke=e.positionInfo)==null?void 0:ke.token_b)==null?void 0:W.address:(pe=(fe=e.positionInfo)==null?void 0:fe.token_a)==null?void 0:pe.address,"style-params":{width:"12px",height:"12px",left:"18px",bottom:"4px"}},null,8,["address"])]),o("div",rt,[Qe(o("img",dt,null,512),[[h,e.needReverse?e.getCoinIcon((ve=e.positionInfo)==null?void 0:ve.token_a):e.getCoinIcon((de=e.positionInfo)==null?void 0:de.token_b)]]),G(r,{address:e.needReverse?(be=(Te=e.positionInfo)==null?void 0:Te.token_a)==null?void 0:be.address:(Z=(w=e.positionInfo)==null?void 0:w.token_b)==null?void 0:Z.address,"style-params":{width:"12px",height:"12px",left:"18px",bottom:"4px"}},null,8,["address"])]),o("div",vt,m(e.needReverse?(Ae=(De=e.positionInfo)==null?void 0:De.token_b)==null?void 0:Ae.symbol:($e=(Be=e.positionInfo)==null?void 0:Be.token_a)==null?void 0:$e.symbol)+" - "+m(e.needReverse?(Re=(Oe=e.positionInfo)==null?void 0:Oe.token_a)==null?void 0:Re.symbol:(ue=(vo=e.positionInfo)==null?void 0:vo.token_b)==null?void 0:ue.symbol),1),(Pe=e.positionInfo)!=null&&Pe.fee?(u(),f("div",mt,[ct,Ee(" "+m(((Ne=e.positionInfo)==null?void 0:Ne.fee)*100)+"% ",1)])):U("",!0)]),o("div",pt,[o("div",ft,[o("a",{href:("getExplorerUrl"in e?e.getExplorerUrl:I(Co))(e.currentExplorer,"poolAddress",(no=e.positionInfo)==null?void 0:no.id),target:"_blank"},ht,8,bt)])]),o("div",kt,[o("div",_t,[wt,o("div",$t,[Ee(m(e.apy)+" ",1),G(P)])]),o("div",It,[Ct,o("div",At,"$"+m(("addCommom"in e?e.addCommom:I(T))(e.tvl,2)),1)])])])])}const Zo=We(On,[["render",Pt],["__scopeId","data-v-0947d30b"]]),St=je({components:{Slider:Vo},setup(){const e=k(!0),t=oo(),V=g(()=>t),X=Je(),R=g(()=>X),C=eo(),r=k();Se(()=>[R.value.positionInfoObj,C.params.id],([n,d])=>{n&&!xe(n)&&d&&(r.value=n[d],console.log(r.value,"##positionInfo.value"))},{immediate:!0,deep:!0});const P=g(()=>{var n;return(n=r.value)==null?void 0:n.needReverse}),h=n=>{var d;return(n==null?void 0:n.logoURI)||(n==null?void 0:n.logo_url)||((d=V.value.tokensObj[n==null?void 0:n.address])==null?void 0:d.logo_url)||ro("/image/coins/sui-unknown.png")},v=g(()=>{var _,p,q;const n=(_=r==null?void 0:r.value)==null?void 0:_.price,d=(p=r==null?void 0:r.value)==null?void 0:p.minPrice,a=(q=r==null?void 0:r.value)==null?void 0:q.maxPrice;let c;if(n>=d&&n<=a){const N=new i(d).add(new i(a)).div(2).toNumber();c=n>N?50+new i(n).sub(N).div(N).toNumber():50-new i(n).sub(N).div(N).toNumber()}else n<d?(c=new i(n).sub(new i(d)).mul(100).toNumber()+15,console.log(c,"##result")):n>a&&(c=new i(n).sub(new i(a)).div(new i(a)).mul(100).toNumber()+70+15);return Number(jo(c,0))}),s=g(()=>{var _,p,q,N,O,z,J;const n=e.value?((_=r.value)==null?void 0:_.minPrice)&&S(r==null?void 0:r.value.minPrice,6):((p=r.value)==null?void 0:p.maxPrice)&&S(1/(r==null?void 0:r.value.maxPrice),6),d=e.value?((q=r.value)==null?void 0:q.maxPrice)&&S((N=r.value)==null?void 0:N.maxPrice,6):((O=r.value)==null?void 0:O.minPrice)&&S(1/(r==null?void 0:r.value.minPrice),6),a=(P.value?!e.value:e.value)?S((z=r.value)==null?void 0:z.price,6):S(1/((J=r.value)==null?void 0:J.price),6);let c={};return c[n]={label:"Min Price"},c[d]={label:"Max Price"},a>n&&a<d?c[a]={label:"Current Price"}:a<n?c[Number(n)+1e-9]={label:"Current Price"}:a>d&&(c[Number(d)-1e-9]={label:"Current Price"}),console.log(c,"obj###"),c}),D=g(()=>{var d,a;const n=(P.value?!e.value:e.value)?ze((d=r.value)==null?void 0:d.price,6):ze(1/((a=r.value)==null?void 0:a.price),6);return console.log(n,"result##"),n}),F=g(()=>{var d,a;const n=(P.value?!e.value:e.value)?ze((d=r.value)==null?void 0:d.price,6):ze(1/((a=r.value)==null?void 0:a.price),6);return console.log(n,"result##111"),n});return{direct:e,positionInfo:r,needReverse:P,getCoinIcon:h,decimalUi:ze,addCommom:T,sFixD:S,moveRatio:v,marks:s,currentPrice:D,currentPriceResever:F}}});const ho=e=>(Xe("data-v-220133b5"),e=e(),Ge(),e),Tt={class:"v2-position-range"},Rt={class:"position-range-top"},Nt=ho(()=>o("div",null,"Position Range",-1)),qt={class:"base-coin"},Dt={key:0},Bt={alt:""},Ft={key:1},Ot={alt:""},Mt={key:2},Lt={key:3},Ut=ho(()=>o("p",null,"Base coin",-1)),Vt={class:"coin-rate"},Et=ho(()=>o("div",null,[o("svg",{class:"icon icon-up","aria-hidden":"true"},[o("use",{"xlink:href":"#icon-exchange_up1"})])],-1)),Wt=ho(()=>o("div",null,[o("svg",{class:"icon icon-down","aria-hidden":"true"},[o("use",{"xlink:href":"#icon-exchange_down1"})])],-1)),jt=[Et,Wt],Xt={class:"position-range-bottom"},Gt={class:"price-range"},Ht={class:"price-range-bg"},Yt={key:0,class:"min-price"},zt={key:0},Jt={key:1},Kt={key:1,class:"max-price"},Zt={key:0},Qt={key:1},xt={key:0,class:"min-price"},es={key:0},os={key:1},ns={key:1,class:"max-price"},ts={key:0},ss={key:1};function ls(e,t,V,X,R,C){var v,s,D,F,n,d,a,c,_,p,q,N,O,z,J,x,y,b,E,K,A,B,H,te,he,fe,pe,ke;const r=yo,P=lo("Slider"),h=Ro("image");return u(),f("div",Tt,[o("div",Rt,[Nt,o("div",qt,[e.needReverse?(u(),f("div",Ft,[Qe(o("img",Ot,null,512),[[h,e.direct?e.getCoinIcon((c=e.positionInfo)==null?void 0:c.token_b):e.getCoinIcon((a=e.positionInfo)==null?void 0:a.token_a)]]),G(r,{address:e.direct?(N=(q=e.positionInfo)==null?void 0:q.token_b)==null?void 0:N.address:(p=(_=e.positionInfo)==null?void 0:_.token_a)==null?void 0:p.address,"style-params":{width:"10px",height:"10px",right:"0",bottom:"0"}},null,8,["address"])])):(u(),f("div",Dt,[Qe(o("img",Bt,null,512),[[h,e.direct?e.getCoinIcon((v=e.positionInfo)==null?void 0:v.token_a):e.getCoinIcon((s=e.positionInfo)==null?void 0:s.token_b)]]),G(r,{address:e.direct?(F=(D=e.positionInfo)==null?void 0:D.token_a)==null?void 0:F.address:(d=(n=e.positionInfo)==null?void 0:n.token_b)==null?void 0:d.address,"style-params":{width:"10px",height:"10px",right:"0",bottom:"0"}},null,8,["address"])])),e.needReverse?(u(),f("span",Lt,m(e.direct?(b=(y=e.positionInfo)==null?void 0:y.token_b)==null?void 0:b.symbol:(K=(E=e.positionInfo)==null?void 0:E.token_a)==null?void 0:K.symbol),1)):(u(),f("span",Mt,m(e.direct?(z=(O=e.positionInfo)==null?void 0:O.token_a)==null?void 0:z.symbol:(x=(J=e.positionInfo)==null?void 0:J.token_b)==null?void 0:x.symbol),1)),Ut,o("div",Vt,[o("div",{onClick:t[0]||(t[0]=W=>e.direct=!e.direct)},jt)])])]),o("div",Xt,[o("div",Gt,[o("div",Ht,[e.direct?(u(),ne(P,{key:0,value:e.currentPrice,class:Le(["position-slider",e.currentPrice<Number(("sFixD"in e?e.sFixD:I(S))((A=e.positionInfo)==null?void 0:A.minPrice,6))||e.currentPrice>Number(("sFixD"in e?e.sFixD:I(S))((B=e.positionInfo)==null?void 0:B.maxPrice,6))?"hide-handler":""]),step:1e-4,marks:e.marks,disabled:!0,min:Number(("sFixD"in e?e.sFixD:I(S))((H=e.positionInfo)==null?void 0:H.minPrice,6)),max:Number(("sFixD"in e?e.sFixD:I(S))((te=e.positionInfo)==null?void 0:te.maxPrice,6))},{mark:we(({label:W})=>{var de,ve,w,Z,Te,be,De,Ae,Be,$e,Oe,Re;return[W=="Min Price"?(u(),f("div",Yt,[o("div",null,m(W),1),e.direct?(u(),f("div",zt,m(((de=e.positionInfo)==null?void 0:de.minPrice)&&("sFixD"in e?e.sFixD:I(S))((ve=e.positionInfo)==null?void 0:ve.minPrice,6)),1)):(u(),f("div",Jt,m(((w=e.positionInfo)==null?void 0:w.maxPrice)&&("sFixD"in e?e.sFixD:I(S))(1/((Z=e.positionInfo)==null?void 0:Z.maxPrice),6)),1))])):U("",!0),W=="Max Price"?(u(),f("div",Kt,[o("div",null,m(W),1),e.direct?(u(),f("div",Zt,m(((Te=e.positionInfo)==null?void 0:Te.maxPrice)&&("sFixD"in e?e.sFixD:I(S))((be=e.positionInfo)==null?void 0:be.maxPrice,6)),1)):(u(),f("div",Qt,m(((De=e.positionInfo)==null?void 0:De.minPrice)&&("sFixD"in e?e.sFixD:I(S))(1/((Ae=e.positionInfo)==null?void 0:Ae.minPrice),6)),1))])):U("",!0),W=="Current Price"?(u(),f("div",{key:2,class:Le(["current-price",e.currentPrice<Number(("sFixD"in e?e.sFixD:I(S))((Be=e.positionInfo)==null?void 0:Be.minPrice,6))?"current-price-left":e.currentPrice>Number(("sFixD"in e?e.sFixD:I(S))(($e=e.positionInfo)==null?void 0:$e.maxPrice,6))?"current-price-right":""])},[o("div",null,m(W),1),o("div",null,[(e.needReverse?!e.direct:e.direct)?(u(),f(so,{key:0},[Ee(m(("addCommom"in e?e.addCommom:I(T))(("decimalUi"in e?e.decimalUi:I(ze))((Oe=e.positionInfo)==null?void 0:Oe.price,6))),1)],64)):(u(),f(so,{key:1},[Ee(m(("addCommom"in e?e.addCommom:I(T))(("decimalUi"in e?e.decimalUi:I(ze))(1/((Re=e.positionInfo)==null?void 0:Re.price),6))),1)],64))])],2)):U("",!0)]}),_:1},8,["value","class","marks","min","max"])):(u(),ne(P,{key:1,value:e.currentPriceResever,class:Le(["position-slider",e.currentPriceResever<Number(("sFixD"in e?e.sFixD:I(S))(1/((he=e.positionInfo)==null?void 0:he.maxPrice),6))||e.currentPriceResever>Number(("sFixD"in e?e.sFixD:I(S))(1/((fe=e.positionInfo)==null?void 0:fe.minPrice),6))?"hide-handler":""]),step:null,min:Number(("sFixD"in e?e.sFixD:I(S))(1/((pe=e.positionInfo)==null?void 0:pe.maxPrice),6)),max:Number(("sFixD"in e?e.sFixD:I(S))(1/((ke=e.positionInfo)==null?void 0:ke.minPrice),6)),marks:e.marks,disabled:!0},{mark:we(({label:W})=>{var de,ve,w,Z,Te,be,De,Ae,Be,$e,Oe,Re;return[W=="Min Price"?(u(),f("div",xt,[o("div",null,m(W),1),e.direct?(u(),f("div",es,m(((de=e.positionInfo)==null?void 0:de.minPrice)&&("sFixD"in e?e.sFixD:I(S))((ve=e.positionInfo)==null?void 0:ve.minPrice,6)),1)):(u(),f("div",os,m(((w=e.positionInfo)==null?void 0:w.maxPrice)&&("sFixD"in e?e.sFixD:I(S))(1/((Z=e.positionInfo)==null?void 0:Z.maxPrice),6)),1))])):U("",!0),W=="Max Price"?(u(),f("div",ns,[o("div",null,m(W),1),e.direct?(u(),f("div",ts,m(((Te=e.positionInfo)==null?void 0:Te.maxPrice)&&("sFixD"in e?e.sFixD:I(S))((be=e.positionInfo)==null?void 0:be.maxPrice,6)),1)):(u(),f("div",ss,m(((De=e.positionInfo)==null?void 0:De.minPrice)&&("sFixD"in e?e.sFixD:I(S))(1/((Ae=e.positionInfo)==null?void 0:Ae.minPrice),6)),1))])):U("",!0),W=="Current Price"?(u(),f("div",{key:2,class:Le(["current-price current-price-direct",e.currentPriceResever<Number(("sFixD"in e?e.sFixD:I(S))(1/((Be=e.positionInfo)==null?void 0:Be.maxPrice),6))?"current-price-left":e.currentPriceResever>Number(("sFixD"in e?e.sFixD:I(S))(1/(($e=e.positionInfo)==null?void 0:$e.minPrice),6))?"current-price-right":""])},[o("div",null,m(W),1),o("div",null,[(e.needReverse?!e.direct:e.direct)?(u(),f(so,{key:0},[Ee(m(("addCommom"in e?e.addCommom:I(T))(("decimalUi"in e?e.decimalUi:I(ze))((Oe=e.positionInfo)==null?void 0:Oe.price,6))),1)],64)):(u(),f(so,{key:1},[Ee(m(("addCommom"in e?e.addCommom:I(T))(("decimalUi"in e?e.decimalUi:I(ze))(1/((Re=e.positionInfo)==null?void 0:Re.price),6))),1)],64))])],2)):U("",!0)]}),_:1},8,["value","class","min","max","marks"]))])])])])}const Qo=We(St,[["render",ls],["__scopeId","data-v-220133b5"]]),is=je({components:{Modal:Lo},props:{positionInfo:{type:Object,default:()=>({})}},setup(e){const t=g(()=>{var X,R;const V=Math.ceil(((X=e.positionInfo)==null?void 0:X.poolUSD)/((R=e.positionInfo)==null?void 0:R.quoteUSD)*100);return console.log(V,"Pool Capacity Ratio"),Number(V)});return{sFixD:S,addCommom:T,ratio:t}}});const qo=e=>(Xe("data-v-78a51262"),e=e(),Ge(),e),as=qo(()=>o("svg",{class:"icon modal-icon-close","aria-hidden":"true"},[o("use",{"xlink:href":"#icon-a-icon-Shutdown"})],-1)),us={class:"deposit-slider"},rs={class:"info-block"},ds=qo(()=>o("div",{class:"leabl"},"Current Deposit：",-1)),vs={class:"text"},ms={class:"info-block"},cs=qo(()=>o("div",{class:"leabl"},"Max Capacity：",-1)),ps={class:"text"};function fs(e,t,V,X,R,C){const r=lo("Modal");return u(),ne(r,{width:"440px",visible:!0,footer:null,title:"Vault Capacity",onCancel:t[0]||(t[0]=P=>e.$emit("onClose"))},{closeIcon:we(()=>[as]),default:we(()=>{var P,h,v,s;return[o("div",us,[o("div",{class:"current-deposit",style:Io({width:`${e.ratio>100?100:e.ratio}%`})},null,4)]),o("div",rs,[ds,o("div",vs,m(("addCommom"in e?e.addCommom:I(T))(("sFixD"in e?e.sFixD:I(S))((P=e.positionInfo)==null?void 0:P.currentDeposit,2)))+" "+m((h=e.positionInfo)==null?void 0:h.quoteCoinInfo.symbol),1)]),o("div",ms,[cs,o("div",ps,m(("addCommom"in e?e.addCommom:I(T))(("sFixD"in e?e.sFixD:I(S))((v=e.positionInfo)==null?void 0:v.quoteUSD,2)))+" "+m((s=e.positionInfo)==null?void 0:s.quoteCoinInfo.symbol),1)])]}),_:1})}const xo=We(is,[["render",fs],["__scopeId","data-v-78a51262"]]),bs=je({components:{AutoPoolV2PoolCapacity:xo},setup(){const e=oo(),t=g(()=>e),V=Je(),X=g(()=>V),R=eo(),C=k();Se(()=>[X.value.positionInfoObj,R.params.id],([v,s])=>{console.log(v,"##positionInfoObj"),v&&!xe(v)&&s&&(C.value=v[s],console.log(C.value,"##positionInfo.value"))},{immediate:!0,deep:!0});const r=g(()=>{var v;return(v=C.value)==null?void 0:v.needReverse}),P=v=>{var s;return console.log(v,"info##"),(v==null?void 0:v.logoURI)||(v==null?void 0:v.logo_url)||((s=t.value.tokensObj[v==null?void 0:v.address])==null?void 0:s.logo_url)||ro("/image/coins/sui-unknown.png")},h=k(!1);return{needReverse:r,positionInfo:C,getCoinIcon:P,addCommom:T,isShowModal:h}}});const ys=e=>(Xe("data-v-ad8a33e9"),e=e(),Ge(),e),gs={class:"pool-composition"},hs={class:"pool-composition-top"},ks=ys(()=>o("span",null,"Vault Composition",-1)),_s={class:"pool-composition-bottom"},ws={class:"token-ratio"},$s={class:"before-coin"},Is={alt:""},Cs={class:"after-coin"},As={alt:""},Ps={class:"token-num"},Ss={class:"num-box"},Ts={class:"num-box"};function Rs(e,t,V,X,R,C){var v,s,D,F,n,d,a,c,_,p,q,N,O,z,J,x,y,b,E,K,A,B,H,te,he,fe,pe,ke,W;const r=yo,P=xo,h=Ro("image");return u(),f("div",gs,[o("div",hs,[ks,Number((v=e.positionInfo)==null?void 0:v.quoteUSD)>0?(u(),f("div",{key:0,class:"pool-capacity",onClick:t[0]||(t[0]=de=>e.isShowModal=!0)},"Vault Capacity")):U("",!0)]),o("div",_s,[o("div",ws,[o("div",$s,[o("div",null,[G(r,{address:e.needReverse?(n=(F=e.positionInfo)==null?void 0:F.token_b)==null?void 0:n.address:(D=(s=e.positionInfo)==null?void 0:s.token_a)==null?void 0:D.address,"style-params":{width:"14px",height:"14px",right:"0",bottom:"0"}},null,8,["address"]),Qe(o("img",Is,null,512),[[h,e.needReverse?e.getCoinIcon((a=e.positionInfo)==null?void 0:a.token_b):e.getCoinIcon((d=e.positionInfo)==null?void 0:d.token_a)]])]),o("span",null,m((c=e.positionInfo)==null?void 0:c.poolCoinARatio)+"%",1)]),o("div",Cs,[o("span",null,m((_=e.positionInfo)==null?void 0:_.poolCoinBRatio)+"%",1),o("div",null,[Qe(o("img",As,null,512),[[h,e.needReverse?e.getCoinIcon((q=e.positionInfo)==null?void 0:q.token_a):e.getCoinIcon((p=e.positionInfo)==null?void 0:p.token_b)]]),G(r,{address:e.needReverse?(J=(z=e.positionInfo)==null?void 0:z.token_a)==null?void 0:J.address:(O=(N=e.positionInfo)==null?void 0:N.token_b)==null?void 0:O.address,"style-params":{width:"14px",height:"14px",right:"0",bottom:"0"}},null,8,["address"])])])]),o("div",Ps,[o("div",{class:"token-a-bg",style:Io({width:`${(x=e.positionInfo)==null?void 0:x.poolCoinARatio}%`})},null,4),o("div",{class:"token-b-bg",style:Io({width:`${(y=e.positionInfo)==null?void 0:y.poolCoinBRatio}%`})},null,4),o("div",Ss,[o("div",null,m(("addCommom"in e?e.addCommom:I(T))((b=e.positionInfo)==null?void 0:b.poolCoinANum))+" "+m(e.needReverse?(B=(A=e.positionInfo)==null?void 0:A.token_b)==null?void 0:B.symbol:(K=(E=e.positionInfo)==null?void 0:E.token_a)==null?void 0:K.symbol),1),o("div",null,"$"+m(("addCommom"in e?e.addCommom:I(T))((H=e.positionInfo)==null?void 0:H.poolCoinAUSD)),1)]),o("div",Ts,[o("div",null,m(("addCommom"in e?e.addCommom:I(T))((te=e.positionInfo)==null?void 0:te.poolCoinBNum))+" "+m(e.needReverse?(ke=(pe=e.positionInfo)==null?void 0:pe.token_a)==null?void 0:ke.symbol:(fe=(he=e.positionInfo)==null?void 0:he.token_b)==null?void 0:fe.symbol),1),o("div",null,"$"+m(("addCommom"in e?e.addCommom:I(T))((W=e.positionInfo)==null?void 0:W.poolCoinBUSD)),1)])])]),e.isShowModal?(u(),ne(P,{key:0,"position-info":e.positionInfo,onOnClose:t[1]||(t[1]=de=>e.isShowModal=!1)},null,8,["position-info"])):U("",!0)])}const en=We(bs,[["render",Rs],["__scopeId","data-v-ad8a33e9"]]),Ns=je({setup(){const e=oo(),t=g(()=>e),V=Je(),X=g(()=>V),R=eo(),C=k();Se(()=>[X.value.positionInfoObj,R.params.id],([s,D])=>{console.log(s,"##positionInfoObj"),s&&!xe(s)&&D&&(C.value=s[D],console.log(C.value,"##positionInfo.value"))},{immediate:!0,deep:!0});const r=g(()=>{var s;return(s=C.value)==null?void 0:s.needReverse}),P=s=>{var D;return console.log(s,"info##"),(s==null?void 0:s.logoURI)||(s==null?void 0:s.logo_url)||((D=t.value.tokensObj[s==null?void 0:s.address])==null?void 0:D.logo_url)||ro("/image/coins/sui-unknown.png")},h=No(),v=g(()=>h);return{needReverse:r,positionInfo:C,getCoinIcon:P,addCommom:T,wallet:v}}});const mo=e=>(Xe("data-v-c9de826f"),e=e(),Ge(),e),qs={class:"my-liquidity"},Ds={class:"my-liquidity-top"},Bs=mo(()=>o("div",null,"My Liquidity",-1)),Fs=mo(()=>o("p",null,"My share of pool",-1)),Os={class:"my-liquidity-bottom"},Ms={class:"lp-token"},Ls=mo(()=>o("div",null,[o("span",null,"LP Token Balance ")],-1)),Us={class:"lp-balance"},Vs={class:"token-num-content"},Es={class:"token-num token-a-num"},Ws={class:"logo"},js=["src"],Xs={class:"text"},Gs={class:"lp-logo"},Hs=["src"],Ys=mo(()=>o("div",null,"Pooled Assets",-1)),zs={class:"token-num"},Js={class:"logo"},Ks=["src"],Zs={class:"text"},Qs=mo(()=>o("div",{class:"token-num-content-bg"},null,-1));function xs(e,t,V,X,R,C){var P,h,v,s,D,F,n,d,a,c,_,p,q,N,O,z,J,x,y,b,E,K,A,B,H,te,he,fe;const r=yo;return u(),f("div",qs,[o("div",Ds,[Bs,o("div",null,[Fs,o("p",null,m(e.wallet.connected?(P=e.positionInfo)==null?void 0:P.myShare:"--")+"%",1)])]),o("div",Os,[o("div",Ms,[Ls,o("div",null,[o("span",Us,m(e.wallet.connected?("addCommom"in e?e.addCommom:I(T))((h=e.positionInfo)==null?void 0:h.myLiquidity):"--")+" LP",1),o("span",null,"$"+m(e.wallet.connected?("addCommom"in e?e.addCommom:I(T))((v=e.positionInfo)==null?void 0:v.myLiquidityUSD):"--"),1)])]),o("div",Vs,[o("div",Es,[o("div",Ws,[o("img",{src:e.needReverse?e.getCoinIcon((D=e.positionInfo)==null?void 0:D.token_b):e.getCoinIcon((s=e.positionInfo)==null?void 0:s.token_a),alt:""},null,8,js),G(r,{address:e.needReverse?(a=(d=e.positionInfo)==null?void 0:d.token_b)==null?void 0:a.address:(n=(F=e.positionInfo)==null?void 0:F.token_a)==null?void 0:n.address,"style-params":{width:"14px",height:"14px",left:"18px",bottom:"0"}},null,8,["address"])]),o("div",Xs,[o("div",null,m(e.wallet.connected?("addCommom"in e?e.addCommom:I(T))((c=e.positionInfo)==null?void 0:c.amountA):"--")+" "+m(e.needReverse?(N=(q=e.positionInfo)==null?void 0:q.token_b)==null?void 0:N.symbol:(p=(_=e.positionInfo)==null?void 0:_.token_a)==null?void 0:p.symbol),1),o("div",null,m(e.wallet.connected?("addCommom"in e?e.addCommom:I(T))((O=e.positionInfo)==null?void 0:O.myAmountAUSD):"--"),1)])]),o("div",Gs,[o("img",{src:e.getCoinIcon((z=e.positionInfo)==null?void 0:z.lpInfo),alt:""},null,8,Hs),Ys]),o("div",zs,[o("div",Js,[o("img",{src:e.needReverse?e.getCoinIcon((x=e.positionInfo)==null?void 0:x.token_a):e.getCoinIcon((J=e.positionInfo)==null?void 0:J.token_b),alt:""},null,8,Ks),G(r,{address:e.needReverse?(K=(E=e.positionInfo)==null?void 0:E.token_a)==null?void 0:K.address:(b=(y=e.positionInfo)==null?void 0:y.token_b)==null?void 0:b.address,"style-params":{width:"14px",height:"14px",right:"0",bottom:"0"}},null,8,["address"])]),o("div",Zs,[o("div",null,m(e.wallet.connected?("addCommom"in e?e.addCommom:I(T))((A=e.positionInfo)==null?void 0:A.amountB):"--")+" "+m(e.needReverse?(he=(te=e.positionInfo)==null?void 0:te.token_a)==null?void 0:he.symbol:(H=(B=e.positionInfo)==null?void 0:B.token_b)==null?void 0:H.symbol),1),o("div",null,m(e.wallet.connected?("addCommom"in e?e.addCommom:I(T))((fe=e.positionInfo)==null?void 0:fe.myAmountBUSD):"--"),1)])]),Qs])])])}const on=We(Ns,[["render",xs],["__scopeId","data-v-c9de826f"]]),el=""+globalThis.__publicAssetsURL("image/icon-tips-error@2x.png");const ol={},nn=e=>(Xe("data-v-fcbc716b"),e=e(),Ge(),e),nl={class:"status"},tl=nn(()=>o("img",{src:el,alt:""},null,-1)),sl=nn(()=>o("span",null,"Rebalancing is in processing. New deposits and withdraws are paused and will be back in minutes. ",-1)),ll=[tl,sl];function il(e,t){return u(),f("div",nl,ll)}const tn=We(ol,[["render",il],["__scopeId","data-v-fcbc716b"]]),al=je({components:{AutoPoolAddModal:zo,AutoPoolV2PoolStatus:tn},setup(){const e=No(),t=k(!1),V=go(),X=g(()=>V),R=g(()=>X.value.chainName),C=g(()=>e),r=Je(),P=g(()=>r),h=oo(),v=g(()=>h),s=k(),D=eo(),F=k(!1),n=k(!1);Se(()=>[P.value.positionInfoObj,D.params.id],([$,L])=>{$&&!xe($)&&L&&(s.value=$[L],console.log(s.value,"##positionInfo.value"))},{immediate:!0,deep:!0});const d=g(()=>{var $,L;return console.log(($=s.value)==null?void 0:$.needReverse,"##positionInfo.value?.needReverse"),(L=s.value)==null?void 0:L.needReverse}),a=k(),c=k(),_=k(),p=k(),q=k(!0),N=g(()=>C.value.assets&&a.value&&C.value.assets[a.value.address]?Mo(C.value.assets[a.value.address].balance,a.value.decimals):0),O=g(()=>C.value.assets&&c.value&&C.value.assets[c.value.address]?Mo(C.value.assets[c.value.address].balance,c.value.decimals):0),z=$=>{$==="fromCoin"?(q.value=!0,_.value=N.value>0?a.value.symbol=="SUI"?new i(Number(N.value)).sub(new i(.05)).lt(new i(0))?"0":new i(Number(N.value)).sub(new i(.05)).toString():String(N.value):""):(q.value=!1,p.value=O.value>0?c.value.symbol=="SUI"?new i(Number(O.value)).sub(new i(.05)).lt(new i(0))?"0":new i(Number(O.value)).sub(new i(.05)).toString():String(O.value):"")},J=$=>{$==="fromCoin"?(q.value=!0,_.value=N.value>0?S(new i(Number(N.value)).div(2).toString(),a.value.decimals).toString():""):(q.value=!1,p.value=O.value>0?S(new i(Number(O.value)).div(2).toString(),c.value.decimals).toString():"")},x=g(()=>R.value?Xo(R.value):{}),y=g(()=>P.value.slippage),b=k("--"),E=k("--"),K=$=>{const L=new i(s.value.autoPoolPositionInfo.liquidity),ie=new i($.toString());if(L.toNumber()>0&&ie.toNumber()>0){const j=ie.add(L);console.log("totalLiquidity:",ie.div(j).mul(100).toString());const Y=ie.div(j).mul(100).toNumber(),me=fn(Y),ye=me==-1?2:me+2,ge=S(ie.div(j).mul(100).toNumber(),ye);console.log(s.value.decimals,"##positionInfo.value.decimal");const Ie=new i(1).div(new i(Math.pow(10,s.value.lpInfo.decimals))).toString();console.log(ge,Ie,"###288"),Number(ge)<Number(Ie)?b.value=`<${Ie}`:b.value=ge}else ie.toNumber()>0&&L.toNumber()<=0?b.value="100":b.value="--"},A=$=>{const L=new i($.toString()),ie=new i(y.value).div(100);console.log(ie.toString(),"#slippageNum");const j=Ao.get_lp_amount_by_liquidity({liquidity:s.value.liquidity,total_supply:s.value.total_supply},$.toString()),Y=new i(Math.pow(10,s.value.lpInfo.decimals)),me=new i(j).div(Y).toString(),ye=new i(me).mul(ie);console.log(j,ye.toString(),"###409");const ge=new i(me).sub(ye);console.log(ge.toString(),"##minLp"),console.log(L.toString(),j,me,"lpDecimalNum##"),E.value=ge.toString()},B=k(!1),H=k(!1),te=k(""),he=k(),fe=async()=>{if(!s.value)return;console.log(_.value,p.value,"####updateAmounts"),n.value=!1;const $=s.value.autoPoolPositionInfo.tick_lower_index,L=s.value.autoPoolPositionInfo.tick_upper_index,ie=Ve.sqrtPriceX64ToTickIndex(new re(s.value.current_sqrt_price));Ve.tickIndexToSqrtPriceX64($),Ve.tickIndexToSqrtPriceX64(L),ie<$&&(d.value?B.value=!0:H.value=!0),ie>L&&(d.value?H.value=!0:B.value=!0);let j;if(console.log(_.value||p.value,"#fromCoinAmount.value || toCoinAmount.value"),_.value||p.value){q.value?j=new i(_.value).mul(Math.pow(10,a.value.decimals)).toString():j=new i(p.value).mul(Math.pow(10,c.value.decimals)).toString();let Y,me=q.value;if(console.log("执行##"),console.log(ie,$,L,"###520"),ue.value||Pe.value){console.log(d.value?q.value:!q.value,"#needReverse.value?fixedFromCoin.value:!fixedFromCoin.value"),console.log("1106###needReverse.value####",d.value),console.log("1106###calculateDepositSwapAmount###params###",{lowerTick:$,upperTick:L,curSqrtPrice:new re(s.value.current_sqrt_price),fix_amount_a:me,input_amount:j,coinTypeA:s.value.autoPoolPositionInfo.coin_type_a,coinTypeB:s.value.autoPoolPositionInfo.coin_type_b,clmm_pool:s.value.address,slippage:Number(y.value)/100,decimals:ue.value?a.value.decimals:c.value.decimals});const l=await Re.calculateDepositSwapAmount({lowerTick:$,upperTick:L,curSqrtPrice:new re(s.value.current_sqrt_price),fix_amount_a:me,input_amount:j,coinTypeA:s.value.autoPoolPositionInfo.coin_type_a,coinTypeB:s.value.autoPoolPositionInfo.coin_type_b,clmm_pool:s.value.address,slippage:Number(y.value)/100,decimals:ue.value?a.value.decimals:c.value.decimals});if(console.log(l,"###swapResult"),console.log("1106###calculateDepositSwapAmount###result###",l),l){F.value=l.is_exceed,Y=new re(l.afterSqrtPrice),j=l.fixAmountA===me?new re(new i(j).sub(l.swapInAmount).toString()):new re(l.swapOutAmount),he.value={swap_amount:l.swapInAmount,route_obj:l.route_obj,a2b:me,input_amount:j},me=l.fixAmountA;const M=s.value.token_a.decimals,_e=s.value.token_b.decimals;$o.value=Ve.sqrtPriceX64ToPrice(l.afterSqrtPrice,M,_e).toString(),console.log($o.value,"##afterCurrentPrice.value");const ee=new i(l.swapInAmount).div(new i(Math.pow(10,M))).toString(),oe=new i(l.swapOutAmountLimit).div(new i(Math.pow(10,_e))).toString(),ce=d.value?s.value.token_b.symbol:s.value.token_a.symbol,ae=d.value?s.value.token_a.symbol:s.value.token_b.symbol;te.value=`To deposit ${T(ue.value?_.value:p.value)} ${ue.value?ce:ae},
          ${T(ee)} ${ue.value?ce:ae}  will be traded for ${T(oe)} ${ue.value?ae:ce} added to the pool.`}else n.value=!0}else F.value=!1,Y=s.value.current_sqrt_price,j=new re(j),$o.value="",te.value="";console.log(he,"##swapParams");let ye,ge,Ie;const Ue=x.value.estLiquidityAndcoinAmountFromOneAmounts({tokenA:a.value,tokenB:c.value,lowerTick:$,upperTick:L,coinAmount:j,iscoinA:me,roundUp:!0,slippage:Number(y.value)/100,curSqrtPrice:new re(Y)});ye=Ue.liquidityAmount,ge=Ue.tokenMaxA,Ie=Ue.tokenMaxB,!ue.value&&!Pe.value&&(q.value?p.value=Number(Ie)>0?Ie:"":_.value=Number(ge)>0?ge:""),console.log(ye.toString(),"liquidityAmount###"),K(ye),A(ye)}};Se(()=>s.value,$=>{$&&!xe($)&&(a.value=$==null?void 0:$.token_a,c.value=$==null?void 0:$.token_b,B.value=!1,H.value=!1,fe())},{immediate:!0});const pe=g(()=>v.value.RATES),ke=g(()=>{var $,L,ie,j,Y,me,ye,ge,Ie,Ue;if((L=pe.value[($=a.value)==null?void 0:$.address])!=null&&L.price&&((j=pe.value[(ie=c.value)==null?void 0:ie.address])!=null&&j.price)){console.log((me=pe.value[(Y=a.value)==null?void 0:Y.address])==null?void 0:me.price,"RATES.value[fromCoin.value?.address]?.price");const l=new i(_.value||0).mul(new i((ge=pe.value[(ye=a.value)==null?void 0:ye.address])==null?void 0:ge.price)),M=new i(p.value||0).mul(new i((Ue=pe.value[(Ie=c.value)==null?void 0:Ie.address])==null?void 0:Ue.price));return jo(l.add(M).toString(),2)}else return"--"});Se(()=>_.value,($,L)=>{console.log($,"##newVal"),$?fe():(b.value="--",p.value="",E.value="--")},{immediate:!0}),Se(()=>p.value,($,L)=>{$?fe():(_.value="",b.value="--",E.value="--")},{immediate:!0});const{t:W,locale:de}=Po(),ve=g(()=>{var $,L;if(ue.value||Pe.value){const ie=ue.value?_.value:p.value,j=ue.value?a.value:c.value;if(($=pe.value[j==null?void 0:j.address])!=null&&$.price)return new i(ie||0).mul(new i((L=pe.value[j==null?void 0:j.address])==null?void 0:L.price)).toNumber()}return 0}),w=g(()=>{const $=Number(_.value)>Number(N.value),L=Number(p.value)>Number(O.value);return!_.value&&!p.value?W("button.enterAmount"):$?W("button.insufficientBalance",{name:a.value.symbol}):L?W("button.insufficientBalance",{name:c.value.symbol}):F.value?W("button.insufficientLiquidity"):Number(s.value.remainingTokenUSD)!==0&&Number(s.value.quoteUSD)>0&&Number(ke.value)>Number(s.value.remainingTokenUSD)?"Exceeded the max capacity":n.value?W("button.enterAmount"):(console.log(ve.value),"Add Liquidity")}),Z=g(()=>{const $=Number(_.value)>Number(N.value),L=Number(p.value)>Number(O.value);return!!(!_.value&&!p.value||$||L||_.value<=0&&p.value<=0||F.value||no.value!=="STATUS_RUNNING"||(console.log(ke.value,s.value.quoteUSD,"positionInfo.value.quoteUSD#"),Number(s.value.remainingTokenUSD)!==0&&Number(s.value.quoteUSD)>0&&Number(ke.value)>Number(s.value.remainingTokenUSD))||n.value||ve.value>1e4)}),Te=k(!0),{setIsShowSuccess:be,setIsShowRejected:De,setIsShowWaiting:Ae,setTransactionDesc:Be,setTransactionTxid:$e,setPositiomNum:Oe}=V,Re=Wo("Sui"),vo=async()=>{var Ie,Ue;t.value=!1,Te.value=!0,$e("");const $=`${T(_.value)} ${(Ie=a.value)==null?void 0:Ie.symbol}`,L=`${T(p.value)} ${(Ue=c.value)==null?void 0:Ue.symbol}`;Be(`Deposit ${_.value>0?$:""} ${p.value>0&&_.value>0?"and":""} ${p.value>0?L:""}`),Ae(!0);const ie=q.value,j=s.value.autoPoolPositionInfo.tick_lower_index,Y=s.value.autoPoolPositionInfo.tick_upper_index,me=Ve.sqrtPriceX64ToTickIndex(new re(s.value.current_sqrt_price));let ye;q.value?ye=new i(_.value).mul(Math.pow(10,a.value.decimals)).toString():ye=new i(p.value).mul(Math.pow(10,c.value.decimals)).toString();const ge=s.value.rewarderInfo.map(l=>l.coinAddress);console.log("1109###deposit###positionInfo###",s);try{const l={lowerTick:j,upperTick:Y,coinAmount:ye,fix_amount_a:ie,slippage:Number(y.value)/100,curSqrtPrice:new re(s.value.current_sqrt_price),id:s.value.id,clmm_pool:s.value.autoPoolPositionInfo.pool,lp_token_type:s.value.lp_token_type,coinTypeA:s.value.autoPoolPositionInfo.coin_type_a,coinTypeB:s.value.autoPoolPositionInfo.coin_type_b,rewarder_coin_types:ge,swapParams:he.value,isOnlyA:ue.value,isOnlyB:Pe.value,currentTickIndex:me,decimal_b:s.value.coinB.decimals};console.log("1106###deposit###params###",l);const M=await Re.deposit(l);console.log(M,"===>payloadAdd11111");const _e=await C.value.currentWallet.signAndExecuteTransactionBlock(M);let ee=x.value.handleTx(_e);if(console.log("toAdd###tx###",ee),ee&&ee.hash){$e(ee.hash),Ae(!1),be(!0),console.log(s,"===>positionInfo");const oe={title:"Supplied",desc:`Deposit ${_.value>0?$:""} ${p.value>0&&_.value>0?"and":""} ${p.value>0?L:""}`,hash:ee.hash,tit:"Liquidity Increased",icon:"icon-icon-Increased",text:`Deposit ${_.value>0?$:""} ${p.value>0&&_.value>0?"and":""} ${p.value>0?L:""}`};R.value!=="Aptos"&&(oe.res=ee.res),x.value.showTransitionPending(oe),await x.value.watchTransaction(oe)&&setTimeout(()=>{r.updatePositionItem(s.value.id),x.value.getAccount(C.value.address)},1e3),Oe()}else Ae(!1),De(!0);_.value="",p.value="",Te.value=!1}catch(l){_.value="",p.value="",console.log("addError###",l),Te.value=!1,Ae(!1),De(!0)}},ue=k(!1),Pe=k(!1),Ne=$=>{_.value="",p.value="",te.value="",$=="only-a"?(ue.value=!ue.value,Pe.value=!1):(Pe.value=!Pe.value,ue.value=!1)},no=g(()=>P.value.currentAutoPoolStatus),po=k(),ko=()=>{po.value=window.setInterval(()=>{(_.value||p.value)&&fe()},2e4)};return fo(()=>{ko()}),bo(()=>{window.clearInterval(po.value)}),{currentAutoPoolStatus:no,wallet:C,positionInfo:s,isShowAddModal:t,needReverse:d,fromCoin:a,toCoin:c,fromCoinAmount:_,toCoinAmount:p,fromCoinBlance:N,toCoinBlance:O,fixedFromCoin:q,maxBtnSelect:z,halfBtnSelect:J,totalAmountUSD:ke,addCommom:T,shareOfPool:b,minimumReceivedLP:E,addLiquidityBtnText:w,addLiquidityBtnDisabled:Z,toAdd:vo,showToCoinLock:H,showFromCoinLock:B,isOnlyA:ue,isOnlyB:Pe,onlyToken:Ne,onlyText:te,onlyTokenUSD:ve}}});const Ke=e=>(Xe("data-v-c5d4c1a7"),e=e(),Ge(),e),ul={class:"auto-pool-add"},rl={class:"auto-pool-add-content"},dl={class:"liquidity-action-tab"},vl=Ke(()=>o("div",{class:"increase tab-active"},"Add",-1)),ml={class:"only-token"},cl=Ke(()=>o("div",null,"Deposit Amounts",-1)),pl={key:0},fl=Ke(()=>o("div",{class:"hover-text"},"You can also choose to deposit in only one asset type. In that case, the vault will convert your asset to the required propositions using Cetus. Please note that trading fees & slippage will be applied. When slippage is involved, a certain amount of post-swap dust (no loss of funds) will be returned to you.",-1)),bl={key:0},yl=Ke(()=>o("div",{class:"hover-text"},"You can also choose to deposit in only one asset type. In that case, the vault will convert your asset to the required propositions using Cetus. Please note that trading fees & slippage will be applied. When slippage is involved, a certain amount of post-swap dust (no loss of funds) will be returned to you.",-1)),gl={key:0,class:"card-item"},hl={key:1,class:"card-item"},kl=Ke(()=>o("span",null,"Pool Closed",-1)),_l={key:0,class:"add-info"},wl={key:0,class:"only-text"},$l={class:"total-amount"},Il=Ke(()=>o("span",null,"Total Amount",-1)),Cl={class:"total-amount"},Al=Ke(()=>o("span",null,"Share of Pool",-1)),Pl={key:0},Sl={key:1},Tl={class:"total-amount"},Rl=Ke(()=>o("span",null,"Minimum Received LP",-1)),Nl={key:0},ql={key:1},Dl={key:1,class:"add-info only-add-info"},Bl=Ke(()=>o("div",{class:"only-text"},"Single-asset deposit can't be higher than $10,000 at a time.",-1)),Fl=[Bl];function Ol(e,t,V,X,R,C){var D,F,n,d,a,c,_,p,q,N,O,z,J,x,y,b,E,K,A;const r=Ho,P=Yo,h=lo("AutoPoolV2PoolStatus"),v=So,s=zo;return u(),f("div",ul,[o("div",rl,[o("div",dl,[vl,o("div",{class:"remove",onClick:t[0]||(t[0]=Eo(B=>e.$emit("changeCurrentTab"),["stop"]))},"Remove")]),o("div",ml,[cl,o("div",null,[o("div",{class:"only-a",onClick:t[1]||(t[1]=B=>e.onlyToken("only-a"))},[o("p",null,[e.isOnlyA?(u(),f("span",pl)):U("",!0)]),o("span",null,m(e.needReverse?(d=(n=e.positionInfo)==null?void 0:n.token_b)==null?void 0:d.symbol:(F=(D=e.positionInfo)==null?void 0:D.token_a)==null?void 0:F.symbol)+" only",1),fl]),o("div",{class:"only-b",onClick:t[2]||(t[2]=B=>e.onlyToken("only-b"))},[o("p",null,[e.isOnlyB?(u(),f("span",bl)):U("",!0)]),o("span",null,m(e.needReverse?(p=(_=e.positionInfo)==null?void 0:_.token_a)==null?void 0:p.symbol:(c=(a=e.positionInfo)==null?void 0:a.token_b)==null?void 0:c.symbol)+" only",1),yl])])]),o("div",{class:Le(e.needReverse?"card-container reverse":"card-container")},[(e.needReverse?!e.isOnlyA:!e.isOnlyB)?(u(),f("div",gl,[G(r,{modelValue:e.fromCoinAmount,"onUpdate:modelValue":t[3]||(t[3]=B=>e.fromCoinAmount=B),"input-value":e.fromCoinAmount,"coin-symbol":e.fromCoin?e.fromCoin.symbol:null,"coin-name":e.fromCoin?e.fromCoin.name:null,balance:e.fromCoinBlance,"coin-icon":e.fromCoin?e.fromCoin.logoURI:"",address:e.fromCoin?e.fromCoin.address:"","swap-direct":"From","import-page":"deposit","has-arrow":!1,onOnMax:t[4]||(t[4]=B=>e.maxBtnSelect("fromCoin")),onOnHalf:t[5]||(t[5]=B=>e.halfBtnSelect("fromCoin")),onOnInput:t[6]||(t[6]=B=>{e.fromCoinAmount=B}),onOnFocus:t[7]||(t[7]=()=>{e.fixedFromCoin=!0})},null,8,["modelValue","input-value","coin-symbol","coin-name","balance","coin-icon","address"]),e.showFromCoinLock&&!e.isOnlyA?(u(),ne(P,{key:0})):U("",!0)])):U("",!0),(e.needReverse?!e.isOnlyB:!e.isOnlyA)?(u(),f("div",hl,[G(r,{modelValue:e.toCoinAmount,"onUpdate:modelValue":t[8]||(t[8]=B=>e.toCoinAmount=B),"input-value":e.toCoinAmount,"coin-symbol":e.toCoin?e.toCoin.symbol:null,"coin-name":e.toCoin?e.toCoin.name:null,balance:e.toCoinBlance,"swap-direct":"To","coin-icon":e.toCoin?e.toCoin.logoURI:"",address:e.toCoin?e.toCoin.address:"","import-page":"deposit","has-arrow":!1,onOnMax:t[9]||(t[9]=B=>e.maxBtnSelect("toCoin")),onOnHalf:t[10]||(t[10]=B=>e.halfBtnSelect("toCoin")),onOnInput:t[11]||(t[11]=B=>{e.toCoinAmount=B}),onOnFocus:t[12]||(t[12]=()=>{e.fixedFromCoin=!1})},null,8,["modelValue","input-value","coin-symbol","coin-name","balance","coin-icon","address"]),e.showToCoinLock&&!e.isOnlyB?(u(),ne(P,{key:0})):U("",!0)])):U("",!0)],2)]),e.currentAutoPoolStatus=="STATUS_REBALANCING"?(u(),ne(h,{key:0})):U("",!0),(q=e.positionInfo)!=null&&q.is_pause?(u(),ne(v,{key:1,class:"big-btn liquidity-btn",disabled:!0},{default:we(()=>[kl]),_:1})):e.wallet.connected?(u(),ne(v,{key:2,class:"big-btn liquidity-btn",disabled:e.addLiquidityBtnDisabled,onClick:t[13]||(t[13]=B=>e.isShowAddModal=!0)},{default:we(()=>[o("span",null,m(e.addLiquidityBtnText),1)]),_:1},8,["disabled"])):(u(),ne(v,{key:3,class:"big-btn liquidity-btn",onClick:t[14]||(t[14]=B=>e.wallet.setIsShowWalletModal(!0))},{default:we(()=>[o("span",null,m(e.$t("button.connectWallet")),1)]),_:1})),((N=e.positionInfo)==null?void 0:N.quoteUSD)==0||Number((O=e.positionInfo)==null?void 0:O.remainingTokenUSD)>Number(e.totalAmountUSD)?(u(),f(so,{key:4},[e.onlyTokenUSD<=1e4?(u(),f("div",_l,[e.onlyText&&(e.isOnlyA&&e.fromCoinAmount>0||e.isOnlyB&&e.toCoinAmount>0)?(u(),f("div",wl,m(e.onlyText),1)):U("",!0),o("div",$l,[Il,o("span",null,"$"+m(("addCommom"in e?e.addCommom:I(T))(e.totalAmountUSD)),1)]),o("div",Cl,[Al,e.fromCoinAmount&&e.toCoinAmount||e.isOnlyA&&e.fromCoinAmount||e.isOnlyB&&e.toCoinAmount?(u(),f("span",Pl,m(e.shareOfPool)+"%",1)):(u(),f("span",Sl,"--%"))]),o("div",Tl,[Rl,e.fromCoinAmount&&e.toCoinAmount||e.isOnlyA&&e.fromCoinAmount||e.isOnlyB&&e.toCoinAmount?(u(),f("span",Nl,m(("addCommom"in e?e.addCommom:I(T))(e.minimumReceivedLP))+" "+m(e.needReverse?(z=e.toCoin)==null?void 0:z.symbol:(J=e.fromCoin)==null?void 0:J.symbol)+"-"+m(e.needReverse?(x=e.fromCoin)==null?void 0:x.symbol:(y=e.toCoin)==null?void 0:y.symbol),1)):(u(),f("span",ql,"--"+m(e.needReverse?(b=e.toCoin)==null?void 0:b.symbol:(E=e.fromCoin)==null?void 0:E.symbol)+"-"+m(e.needReverse?(K=e.fromCoin)==null?void 0:K.symbol:(A=e.toCoin)==null?void 0:A.symbol),1))])])):(u(),f("div",Dl,Fl))],64)):U("",!0),e.isShowAddModal?(u(),ne(s,{key:5,"pool-info":e.positionInfo,"from-coin":e.needReverse?e.positionInfo.token_b:e.positionInfo.token_a,"to-coin":e.needReverse?e.positionInfo.token_a:e.positionInfo.token_b,"from-coin-amount":e.needReverse?e.toCoinAmount:e.fromCoinAmount,"to-coin-amount":e.needReverse?e.fromCoinAmount:e.toCoinAmount,"total-amount":e.totalAmountUSD,"share-of-pool":e.shareOfPool,"minimum-received-l-p":e.minimumReceivedLP,"is-only-a":e.isOnlyA,"is-only-b":e.isOnlyB,onOnClose:t[15]||(t[15]=B=>e.isShowAddModal=!1),onToAdd:e.toAdd},null,8,["pool-info","from-coin","to-coin","from-coin-amount","to-coin-amount","total-amount","share-of-pool","minimum-received-l-p","is-only-a","is-only-b","onToAdd"])):U("",!0)])}const Ml=We(al,[["render",Ol],["__scopeId","data-v-c5d4c1a7"]]),Ll=je({components:{AutoPoolRemoveModal:Jo,AutoPoolV2PoolStatus:tn},setup(){const e=No(),t=g(()=>e),V=go(),X=g(()=>V),R=g(()=>F.value.slippage),C=g(()=>X.value.chainName),r=bn(),P=g(()=>r),h=[{name:"25%",value:25},{name:"50%",value:50},{name:"75%",value:75},{name:"MAX",value:100}],v=k(25),s=eo(),D=Je(),F=g(()=>D),n=g(()=>(console.log(F.value.positionInfoObj[s.params.id],"autoPool.value.positionInfoObj[route.params.id]###"),F.value.positionInfoObj[s.params.id])),d=g(()=>{var l;return(l=n.value)==null?void 0:l.needReverse}),a=k(),c=k(),_=k(!1),p=k(),q=g(()=>{var l;return(l=n.value)==null?void 0:l.myLiquidity}),N=k(!0),O=g(()=>C.value?Xo(C.value):{}),z=k(),J=k(),x=Wo("Sui"),y=k(""),b=k(""),E=k("--"),K=k(!1),A=k(!1),B=k(),H=k(!0),te=k(),he=oo(),fe=g(()=>he),pe=g(()=>fe.value.RATES),ke=async()=>{if(N.value||!n.value)return;J.value=!1;const l=n.value.autoPoolPositionInfo.tick_lower_index,M=n.value.autoPoolPositionInfo.tick_upper_index,_e=Ve.sqrtPriceX64ToTickIndex(new re(n.value.current_sqrt_price));_e<l&&(d.value?K.value=!0:A.value=!0),_e>M&&(d.value?A.value=!0:K.value=!0);let ee;if(console.log(y.value||b.value,"#fromCoinAmount.value || toCoinAmount.value"),y.value||b.value){H.value?ee=new i(y.value).mul(Math.pow(10,a.value.decimals)).toString():ee=new i(b.value).mul(Math.pow(10,c.value.decimals)).toString();let oe,ce=H.value;if(w.value||Z.value){const le=await x.calculateRemoveSwapAmount({lowerTick:l,upperTick:M,curSqrtPrice:new re(n.value.current_sqrt_price),fix_amount_a:ce,receiveAmount:ee,coinTypeA:n.value.autoPoolPositionInfo.coin_type_a,coinTypeB:n.value.autoPoolPositionInfo.coin_type_b,clmm_pool:n.value.address,slippage:0,decimals:w.value?a.value.decimals:c.value.decimals});if(console.log(le,"###swapResult"),le){z.value=le.is_exceed,ee=new re(le.swapOutAmount),oe=n.value.current_sqrt_price,B.value={swap_amount:le.swapInAmount,liquidity:le.liquidity,a2b:!ce,route_obj:le.route_obj},ce=!ce;const Ye=n.value.token_a.decimals,to=n.value.token_b.decimals,qe=new i(le.swapInAmount).div(new i(Math.pow(10,Ye))).toString(),io=new i(le.swapOutAmountLimit).div(new i(Math.pow(10,to))).toString(),Ce=d.value?n.value.token_b.symbol:n.value.token_a.symbol,Fe=d.value?n.value.token_a.symbol:n.value.token_b.symbol;te.value=y.value==Y.value||b.value==Y.value?`To withdraw ${T(w.value?y.value:b.value)} ${w.value?Ce:Fe},
          ${T(w.value?n.value.amountB:n.value.amountA)} ${w.value?Fe:Ce} 
           in the pool will be traded for ${qe} ${w.value?Ce:Fe}`:`To withdraw ${T(w.value?y.value:b.value)} ${w.value?Ce:Fe},
          ${T(qe)} ${w.value?Fe:Ce}  in the pool will be traded for ${T(io)} ${w.value?Ce:Fe}`}else{J.value=!0,te.value="";return}}else z.value=!1,oe=n.value.current_sqrt_price,ee=new re(ee);console.log(oe,"##curSqrtPrice"),console.log("执行了吗##");const{liquidityAmount:ae,tokenMaxA:se,tokenMaxB:Q}=O.value.estLiquidityAndcoinAmountFromOneAmounts({tokenA:a.value,tokenB:c.value,lowerTick:l,upperTick:M,coinAmount:ee,iscoinA:ce,roundUp:!1,slippage:Number(R.value)/100,curSqrtPrice:new re(oe)});if(console.log(n.value.current_sqrt_price,"##positionInfo.value.current_sqrt_price"),console.log(Q.toString(),se.toString(),n.value,"###323"),!w.value&&!Z.value&&(H.value?b.value=Number(Q)>0?Q:"":y.value=Number(se)>0?se:""),(w.value||Z.value)&&(y.value>=Y.value||b.value>=Y.value)){p.value=n.value.myLiquidity;const le=new i(100);E.value=new i(n.value.myLiquidity).mul(new i(Math.pow(10,n.value.lpInfo.decimals))).toString(),W.value=ae.toString(),v.value=le.toNumber()}else{const le=Ao.get_lp_amount_by_liquidity({liquidity:n.value.liquidity,total_supply:n.value.total_supply},ae.toString());p.value=new i(le).div(new i(Math.pow(10,n.value.lpInfo.decimals))).toString();const Ye=new i(p.value).div(new i(q.value)).mul(100);console.log(p.value,q.value,"####lpBalance.value"),E.value=le,W.value=ae.toString(),v.value=Ye.toNumber()}}},W=k(),de=g(()=>{var l;return(l=n==null?void 0:n.value)==null?void 0:l.amountA}),ve=g(()=>{var l;return(l=n==null?void 0:n.value)==null?void 0:l.amountB}),w=k(!1),Z=k(!1),Te=g(()=>{var ce,ae,se,Q;const l=(ae=pe.value[(ce=a==null?void 0:a.value)==null?void 0:ce.address])==null?void 0:ae.price,M=(Q=pe.value[(se=c==null?void 0:c.value)==null?void 0:se.address])==null?void 0:Q.price;console.log(l,M,y.value,b.value,"####totalWithdraw");let _e=y.value!=="--"&&y.value!==""?y.value:0,ee=b.value!=="--"&&b.value!==""?b.value:0,oe;return l&&M&&(w.value||Z.value?oe=new i(w.value?_e:ee).mul(new i(w.value?l:M)).toString():(oe=new i(_e).mul(new i(l)).add(new i(ee).mul(new i(M))).toString(),console.log(oe,"result##"))),oe>0&&oe<.01?"<$0.01":`$${T(S(oe,2))}`}),be=async l=>{var Ye,to,qe,io,Ce,Fe,_o,Do,Bo,Fo;if(!N.value)return;N.value=!0,J.value=!1,(to=(Ye=n.value)==null?void 0:Ye.token_a)==null||to.decimals,(io=(qe=n.value)==null?void 0:qe.token_b)==null||io.decimals;const M=(Ce=n.value)==null?void 0:Ce.tick_lower_index,_e=(Fe=n.value)==null?void 0:Fe.tick_upper_index;Ve.tickIndexToSqrtPriceX64(M),Ve.tickIndexToSqrtPriceX64(_e);const ee=(Do=(_o=n.value)==null?void 0:_o.autoPoolPositionInfo)==null?void 0:Do.tick_lower_index,oe=(Fo=(Bo=n.value)==null?void 0:Bo.autoPoolPositionInfo)==null?void 0:Fo.tick_upper_index,ce=Ve.sqrtPriceX64ToTickIndex(new re(n.value.current_sqrt_price));ce<ee&&(d.value?K.value=!0:A.value=!0),ce>oe&&(d.value?A.value=!0:K.value=!0);let ae="",se,Q;console.log(l.value,"##item.value"),console.log(Q,"##coinAmount");let le=H.value;if(console.log("执行##"),w.value||Z.value&&!K.value&&!A.value){if(w.value){const Ze=new i(Y.value).mul(Math.pow(10,a.value.decimals)).mul(l.value).toString();console.log(Ze,"##amount"),Q=S(Ze,0),y.value=S(new i(Y.value).mul(l.value).toString(),a.value.decimals)}if(Z.value){const Ze=new i(Y.value).mul(l.value).mul(Math.pow(10,c.value.decimals)).toString();Q=S(Ze,0),b.value=S(new i(Y.value).mul(l.value).toString(),c.value.decimals)}console.log(y.value,"##fromCoinAmount.value");const Me=await x.calculateRemoveSwapAmount({lowerTick:M,upperTick:_e,curSqrtPrice:new re(n.value.current_sqrt_price),fix_amount_a:le,receiveAmount:Q,coinTypeA:n.value.autoPoolPositionInfo.coin_type_a,coinTypeB:n.value.autoPoolPositionInfo.coin_type_b,clmm_pool:n.value.address,slippage:0,decimals:w.value?a.value.decimals:c.value.decimals});if(console.log(Me,"###swapResult536"),Me){z.value=Me.is_exceed,Q=new re(Me.swapOutAmount),n.value.current_sqrt_price,B.value={swap_amount:Me.swapInAmount,liquidity:Me.liquidity,route_obj:Me.route_obj,a2b:!le},le=!le;const Ze=n.value.token_a.decimals,sn=n.value.token_b.decimals,ln=new i(Me.swapInAmount).div(new i(Math.pow(10,Ze))).toString(),Oo=new i(Me.swapOutAmountLimit).div(new i(Math.pow(10,sn))).toString(),ao=d.value?n.value.token_b.symbol:n.value.token_a.symbol,uo=d.value?n.value.token_a.symbol:n.value.token_b.symbol;te.value=l.value==1?`To withdraw ${T(w.value?y.value:b.value)} ${w.value?ao:uo},
          ${T(w.value?n.value.amountB:n.value.amountA)} ${w.value?uo:ao}  in the pool will be traded for ${T(Oo)} ${w.value?ao:uo}`:`To withdraw ${T(w.value?y.value:b.value)} ${w.value?ao:uo},
          ${T(ln)} ${w.value?uo:ao}  in the pool will be traded for ${T(Oo)} ${w.value?ao:uo}`,ae=Me.liquidity}else n.value.current_sqrt_price,Q=new re(Q),te.value="",J.value=!0;console.log(se,"result###"),E.value=new i(n.value.myLiquidity).mul(new i(l.value)).toString(),console.log(n.value,n.value.liquidity,ae,E.value,"###positionInfo.value.liquidity"),console.log(E.value,"##lpTokenAmount.value"),p.value=new i(E.value),W.value=ae}else{z.value=!1;const Me=new i(de.value).mul(Math.pow(10,a.value.decimals)).mul(l.value).toString();Q=S(Me,0),y.value=S(new i(de.value).mul(l.value).toString(),a.value.decimals);const Ze=new i(ve.value).mul(l.value).mul(Math.pow(10,c.value.decimals)).toString();Q=S(Ze,0),b.value=S(new i(ve.value).mul(l.value).toString(),c.value.decimals),n.value.current_sqrt_price,Q=new re(Q),l.value!==1?se=new i(n.value.myLiquidity).mul(Math.pow(10,n.value.lpInfo.decimals)).mul(l.value).toString():se=new i(n.value.myLiquidity).mul(Math.pow(10,n.value.lpInfo.decimals)).toString(),p.value=new i(se).div(Math.pow(10,n.value.lpInfo.decimals)),ae=Ao.get_share_liquidity_by_amount({liquidity:n.value.liquidity,total_supply:n.value.total_supply},se),E.value=S(se,0),W.value=S(ae,0),console.log(ae,"###newLiquidity525")}};Se(v,wo((l,M)=>{l!==M&&(Number(l)>100?v.value=100:l&&n.value?(console.log("687===>"),v.value=l,be({value:v.value/100})):(y.value="",b.value=""))},300)),Se(()=>y.value,wo((l,M)=>{l?ke():(b.value="",v.value=0)},500),{immediate:!0}),Se(()=>b.value,wo((l,M)=>{l?ke():(y.value="",v.value=0)},500),{immediate:!0});const De=To(),{setIsShowSuccess:Ae,setIsShowRejected:Be,setIsShowWaiting:$e,setTransactionDesc:Oe,setTransactionTxid:Re,setPositiomNum:vo,setTransactionDescText:ue}=V,Pe=k(!1),{t:Ne}=Po(),no=async()=>{var Ye,to;Pe.value=!0,Re("");const l=Number(y.value)>0?`${T(y.value,a.value.decimals)} ${a.value.symbol}`:"",M=Number(b.value)>0?`${T(b.value,c.value.decimals)} ${c.value.symbol}`:"";console.log(l,M,"###transactionDescTo"),Oe(Ne("tips.removeLiquidiyText",{from:d.value?M:l,and:Number(y.value)>0&&Number(b.value)>0?"and":"",to:d.value?l:M})),$e(!0);const _e=Ne("modal.removeLiquidityText2");ue(_e);const ee=n.value.autoPoolPositionInfo.tick_lower_index,oe=n.value.autoPoolPositionInfo.tick_upper_index,ce=Ve.tickIndexToSqrtPriceX64(ee),ae=Ve.tickIndexToSqrtPriceX64(oe),se=n.value.rewarderInfo.map(qe=>qe.coinAddress);console.log(E.value,"##lpTokenAmount.value431");let Q;H.value?Q=new i(y.value).mul(Math.pow(10,a.value.decimals)).toString():Q=new i(b.value).mul(Math.pow(10,c.value.decimals)).toString(),console.log();const le={lowerSqrtPrice:ce,upperSqrtPrice:ae,lpTokenAmount:E.value,liquidity:W.value,curSqrtPrice:new re(n.value.object.current_sqrt_price),slippage:Number(R.value)/100,id:n.value.id,clmm_pool:n.value.autoPoolPositionInfo.pool,lp_token_type:n.value.lp_token_type,coinTypeA:n.value.autoPoolPositionInfo.coin_type_a,coinTypeB:n.value.autoPoolPositionInfo.coin_type_b,rewarder_coin_types:se,swapParams:B.value,fix_amount_a:H.value,isOnlyA:!K.value&&!A.value?w.value:!1,isOnlyB:!A.value&&!K.value?Z.value:!1,lowerTick:ee,upperTick:oe,receiveAmount:Q,sliderVal:v.value,positionInfo:n.value};try{const qe=await x.remove(le);console.log(qe,"移除流动性payload");const io=await t.value.currentWallet.signAndExecuteTransactionBlock(qe);let Ce=O.value.handleTx(io);if(console.log("0331###remove###tx####",Ce),Ce&&Ce.hash){Re(Ce.hash),$e(!1),Ae(!0);const Fe={title:Ne("common.removeLiquidity"),desc:"",hash:Ce.hash,descTransactions:`Remove ${l} ${Number(y.value)>0&&Number(b.value)>0?"and":""} ${M} from the pool`,sender:t.value.address,chainName:"Sui",tit:"Liquidity Removed",icon:"icon-icon-Removed",text:`Withdraw ${y.value} ${(Ye=a.value)==null?void 0:Ye.symbol} and ${b.value} ${(to=c.value)==null?void 0:to.symbol}`};Fe.res=Ce.res,O.value.showTransitionPending(Fe),await O.value.watchTransaction(Fe)&&(y.value="",b.value="",p.value="",v.value=0,setTimeout(()=>{D.updatePositionItem(n.value.id),O.value.getAccount(t.value.address)},1e3),Number(v.value)==100&&s.name=="auto-pool-detail"&&De.push("/pool/auto"))}else $e(!1),Be(!0);Pe.value=!1}catch(qe){console.log("Remove error",qe),Pe.value=!1,$e(!1),Be(!0)}};Se(()=>n.value,(l,M)=>{l&&!xe(l)&&(a.value=l==null?void 0:l.token_a,c.value=l==null?void 0:l.token_b,console.log("触发###"),(!M||M&&M.address!==l.address)&&(v.value=v.value>0?v.value:25,be({value:v.value/100})))},{immediate:!0});const po=g(()=>{const l=Number(p.value)>Number(q.value);return!y.value&&!b.value||!p.value||p.value<=0||!y.value&&w.value||!b.value&&Z.value?Ne("button.enterAmount"):l?"Invalid Amount":z.value?Ne("button.insufficientLiquidity"):J.value?Ne("button.enterAmount"):(console.log(y.value,Y.value,b.value,"856##"),w.value&&Number(y.value)>Number(Y.value)||Z.value&&Number(b.value)>Number(Y.value)?"Invalid Amount":Ne("button.remove"))}),ko=g(()=>{console.log(p.value.toString(),q.value,"###864");const l=Number(p.value)>Number(q.value);return!!(!y.value&&!b.value||Number(y.value)<=0&&w.value||Number(b.value)<=0&&Z.value||!p.value||p.value<=0||l||z.value||ge.value!=="STATUS_RUNNING"||J.value||w.value&&Number(y.value)>Number(Y.value)||Z.value&&Number(b.value)>Number(Y.value))}),$=l=>(l==null?void 0:l.logoURI)||(l==null?void 0:l.logo_url)||ro("/image/coins/sui-unknown.png"),L=l=>{y.value="",b.value="",N.value=!0,te.value="",l=="only-a"?(w.value=!w.value,Z.value=!1,H.value=!0):(Z.value=!Z.value,w.value=!1,H.value=!1)},ie=l=>{N.value=!0,v.value=100,l==="fromCoin"?H.value=!0:H.value=!1},j=l=>{N.value=!0,v.value=50,l==="fromCoin"?H.value=!0:H.value=!1},Y=k(),me=async()=>{const l=n.value.token_a.decimals,M=n.value.token_b.decimals,_e=new i(de.value).mul(new i(Math.pow(10,l))).toString(),ee=new i(ve.value).mul(new i(Math.pow(10,M))).toString(),oe=w.value?ee:_e,ce=w.value?c.value.address===n.value.token_a.address:a.value.address===n.value.token_a.address;try{const ae=await P.value.swapRouterContract.getSwapRouter(w.value?c:a,w.value?a:c,oe.toString(),!0,Number(R.value)/100,"",""),se=new i(ae.amountOut);Y.value=se.sub(se.mul(Number(R.value)/100)).add(new i(w.value?de.value:ve.value)).toString()}catch{if(w.value||Z.value){console.log(oe,"##receiveAmount");let se=await O.value.preSwap({pool:{address:n.value.address,coinA:n.value.token_a,coinB:n.value.token_b},a2b:ce,byAmountIn:!0,amount:oe});console.log(se,se.estimatedAmountOut,l,M,"##preSwapRes");const Q=new i(se.estimatedAmountOut);Y.value=Q.sub(Q.mul(Number(R.value)/100)).add(new i(w.value?de.value:ve.value)).toString(),console.log("转换之后数量:",se.estimatedAmountOut),console.log("转换之后滑点数量:",Q.mul(Number(R.value)/100).toNumber()),console.log("原有数量减滑点数量:",Q.sub(Q.mul(Number(R.value)/100)).toNumber()),console.log("fromCoin原有数量:",de.value),console.log(Y.value,"###onlyTokenBalance.value"),be({value:v.value/100})}}be({value:v.value/100})};Se(()=>[w.value,Z.value,de.value,ve.value],([l,M])=>{l||M?me():be({value:v.value/100})},{immediate:!0});const ye=l=>`${l}%`,ge=g(()=>F.value.currentAutoPoolStatus),Ie=k(),Ue=()=>{Ie.value=window.setInterval(()=>{(y.value||b.value)&&!N.value?ke():be({value:v.value/100})},2e4)};return fo(()=>{Ue()}),bo(()=>{window.clearInterval(Ie.value)}),{removeLiquidityBtnText:po,removeLiquidityBtnDisabled:ko,wallet:t,ratioArr:h,positionInfo:n,isShowRemoveModal:_,needReverse:d,fromCoin:a,toCoin:c,lpAmount:p,lpBalance:q,sliderVal:v,sFixD:S,isSlider:N,fromCoinAmount:y,toCoinAmount:b,setPercent:be,toRemove:no,addCommom:T,getCoinIcon:$,isOnlyA:w,isOnlyB:Z,onlyToken:L,fixedFromCoin:H,maxBtnSelect:ie,halfBtnSelect:j,fromCoinBlance:de,toCoinBlance:ve,showFromCoinLock:K,showToCoinLock:A,removeText:te,onlyTokenBalance:Y,totalWithdraw:Te,formatter:ye,currentAutoPoolStatus:ge}}});const co=e=>(Xe("data-v-8c61bfb6"),e=e(),Ge(),e),Ul={class:"auto-pool-add"},Vl={class:"auto-pool-add-content"},El={class:"liquidity-action-tab"},Wl=co(()=>o("div",{class:"remove tab-active"},"Remove",-1)),jl={key:0,class:"only-token"},Xl=co(()=>o("div",null,"Deposit Amounts",-1)),Gl={key:0},Hl={key:0},Yl={key:0,class:"card-item"},zl={key:1,class:"card-item"},Jl={class:"remove-ratio"},Kl={class:"remove-ratio-select"},Zl={key:0,class:"ratio"},Ql={key:1,class:"ratio"},xl={class:"ratio-list"},ei=["onClick"],oi=co(()=>o("span",null,"Pool Closed",-1)),ni={key:4,class:"remove-info"},ti={key:0,class:"remove-text total-amount"},si={class:"total-amount"},li=co(()=>o("span",null,"Total Withdraw",-1)),ii={class:"total-amount"},ai=co(()=>o("span",null,"LP Burn Amount",-1)),ui={key:0},ri={key:1};function di(e,t,V,X,R,C){var F,n,d,a,c,_,p,q,N,O,z,J,x,y,b,E,K;const r=Ho,P=Yo,h=Vo,v=lo("AutoPoolV2PoolStatus"),s=So,D=Jo;return u(),f("div",Ul,[o("div",Vl,[o("div",El,[o("div",{class:"increase",onClick:t[0]||(t[0]=Eo(A=>e.$emit("changeCurrentTab"),["stop"]))},"Add"),Wl]),!e.showFromCoinLock&&!e.showToCoinLock?(u(),f("div",jl,[Xl,o("div",null,[o("div",{class:"only-a",onClick:t[1]||(t[1]=A=>e.onlyToken("only-a"))},[o("p",null,[e.isOnlyA?(u(),f("span",Gl)):U("",!0)]),o("span",null,m(e.needReverse?(a=(d=e.positionInfo)==null?void 0:d.token_b)==null?void 0:a.symbol:(n=(F=e.positionInfo)==null?void 0:F.token_a)==null?void 0:n.symbol)+" only",1)]),o("div",{class:"only-b",onClick:t[2]||(t[2]=A=>e.onlyToken("only-b"))},[o("p",null,[e.isOnlyB?(u(),f("span",Hl)):U("",!0)]),o("span",null,m(e.needReverse?(q=(p=e.positionInfo)==null?void 0:p.token_a)==null?void 0:q.symbol:(_=(c=e.positionInfo)==null?void 0:c.token_b)==null?void 0:_.symbol)+" only",1)])])])):U("",!0),o("div",{class:Le(e.needReverse?"card-container reverse":"card-container")},[(e.needReverse?!e.isOnlyA:!e.isOnlyB)?(u(),f("div",Yl,[G(r,{modelValue:e.fromCoinAmount,"onUpdate:modelValue":t[3]||(t[3]=A=>e.fromCoinAmount=A),"input-value":e.fromCoinAmount,"coin-symbol":e.fromCoin?e.fromCoin.symbol:null,"coin-name":e.fromCoin?e.fromCoin.name:null,balance:e.isOnlyA?e.onlyTokenBalance:e.fromCoinBlance,"coin-icon":e.fromCoin?e.fromCoin.logoURI:"",address:e.fromCoin?e.fromCoin.address:"","swap-direct":"From","import-page":"deposit","amount-leabl":"Available","has-arrow":!1,onOnMax:t[4]||(t[4]=A=>e.maxBtnSelect("fromCoin")),onOnHalf:t[5]||(t[5]=A=>e.halfBtnSelect("fromCoin")),onOnInput:t[6]||(t[6]=A=>{e.isSlider=!1,e.fromCoinAmount=A}),onOnFocus:t[7]||(t[7]=()=>{e.isSlider=!1,e.fixedFromCoin=!0})},null,8,["modelValue","input-value","coin-symbol","coin-name","balance","coin-icon","address"]),e.showFromCoinLock?(u(),ne(P,{key:0})):U("",!0)])):U("",!0),(e.needReverse?!e.isOnlyB:!e.isOnlyA)?(u(),f("div",zl,[G(r,{modelValue:e.toCoinAmount,"onUpdate:modelValue":t[8]||(t[8]=A=>e.toCoinAmount=A),"input-value":e.toCoinAmount,"coin-symbol":e.toCoin?e.toCoin.symbol:null,"coin-name":e.toCoin?e.toCoin.name:null,balance:e.isOnlyB?e.onlyTokenBalance:e.toCoinBlance,"swap-direct":"To","coin-icon":e.toCoin?e.toCoin.logoURI:"",address:e.toCoin?e.toCoin.address:"","import-page":"deposit","amount-leabl":"Available","has-arrow":!1,onOnMax:t[9]||(t[9]=A=>e.maxBtnSelect("toCoin")),onOnHalf:t[10]||(t[10]=A=>e.halfBtnSelect("toCoin")),onOnInput:t[11]||(t[11]=A=>{e.isSlider=!1,e.toCoinAmount=A}),onOnFocus:t[12]||(t[12]=()=>{e.isSlider=!1,e.fixedFromCoin=!1})},null,8,["modelValue","input-value","coin-symbol","coin-name","balance","coin-icon","address"]),e.showToCoinLock?(u(),ne(P,{key:0})):U("",!0)])):U("",!0)],2),o("div",Jl,[o("div",Kl,[Number(e.lpBalance)>=Number(e.lpAmount)?(u(),f("div",Zl,m(e.sliderVal>0&&Number(("sFixD"in e?e.sFixD:I(S))(e.sliderVal,2))<.01?"<0.01":("sFixD"in e?e.sFixD:I(S))(e.sliderVal,2))+"% ",1)):(u(),f("div",Ql,"--")),o("div",xl,[(u(!0),f(so,null,Uo(e.ratioArr,(A,B)=>(u(),f("div",{key:B,class:Le(["ratio-item",e.sliderVal==A.value?"ratio-item-active":""]),onClick:()=>{e.isSlider=!0,e.sliderVal=A.value}},m(A.name),11,ei))),128))])]),G(h,{value:e.sliderVal,"onUpdate:value":t[13]||(t[13]=A=>e.sliderVal=A),"tip-formatter":e.formatter,onChange:t[14]||(t[14]=A=>e.isSlider=!0)},null,8,["value","tip-formatter"])])]),e.currentAutoPoolStatus=="STATUS_REBALANCING"?(u(),ne(v,{key:0})):U("",!0),(N=e.positionInfo)!=null&&N.is_pause?(u(),ne(s,{key:1,class:"big-btn liquidity-btn",disabled:!0},{default:we(()=>[oi]),_:1})):e.wallet.connected?(u(),ne(s,{key:2,class:"big-btn liquidity-btn",disabled:e.removeLiquidityBtnDisabled,onClick:t[15]||(t[15]=A=>e.toRemove())},{default:we(()=>[o("span",null,m(e.removeLiquidityBtnText),1)]),_:1},8,["disabled"])):(u(),ne(s,{key:3,class:"big-btn liquidity-btn",onClick:t[16]||(t[16]=A=>e.wallet.setIsShowWalletModal(!0))},{default:we(()=>[o("span",null,m(e.$t("button.connectWallet")),1)]),_:1})),e.removeLiquidityBtnDisabled?U("",!0):(u(),f("div",ni,[e.removeText&&(e.isOnlyA&&Number(e.fromCoinAmount)>0||e.isOnlyB&&Number(e.toCoinAmount)>0)?(u(),f("div",ti,m(e.removeText),1)):U("",!0),o("div",si,[li,o("span",null,m(e.totalWithdraw),1)]),o("div",ii,[ai,e.fromCoinAmount||e.toCoinAmount?(u(),f("span",ui,m(("addCommom"in e?e.addCommom:I(T))(e.lpAmount))+" "+m(e.needReverse?(O=e.toCoin)==null?void 0:O.symbol:(z=e.fromCoin)==null?void 0:z.symbol)+"-"+m(e.needReverse?(J=e.fromCoin)==null?void 0:J.symbol:(x=e.toCoin)==null?void 0:x.symbol),1)):(u(),f("span",ri,"0 "+m(e.needReverse?(y=e.toCoin)==null?void 0:y.symbol:(b=e.fromCoin)==null?void 0:b.symbol)+"-"+m(e.needReverse?(E=e.fromCoin)==null?void 0:E.symbol:(K=e.toCoin)==null?void 0:K.symbol),1))])])),e.isShowRemoveModal?(u(),ne(D,{key:5,"pool-info":e.positionInfo,"from-coin":e.positionInfo.token_a,"to-coin":e.positionInfo.token_b,onOnClose:t[17]||(t[17]=A=>e.isShowRemoveModal=!1)},null,8,["pool-info","from-coin","to-coin"])):U("",!0)])}const vi=We(Ll,[["render",di],["__scopeId","data-v-8c61bfb6"]]),mi=je({components:{AutoPoolV2Info:Zo,AutoPoolV2PositionRange:Qo,AutoPoolV2PoolComposition:en,AutoPoolV2PoolLiquidity:on,AutoPoolV2PoolAdd:Ml,AutoPoolV2PoolRemove:vi},setup(){const e=Je();oo();const t=go(),V=g(()=>t),X=()=>{e.getAutoPoolAPY(),e.getVault(C.params.id)},R=k(),C=eo();Se(()=>C.query.action,h=>{h&&(R.value=h)},{immediate:!0});const r=k(),P=()=>{r.value=window.setInterval(()=>{e.getVault(C.params.id)},6e4)};return fo(()=>{console.log(C,"route##"),P()}),bo(()=>{window.clearInterval(r.value)}),g(()=>V.value.chainName),To(),{clickRefresh:X,currentTab:R}}});const ci={class:"auto-pool-detail-v2"},pi={class:"detail-top"},fi={class:"detail-bottom pc-detail"},bi={class:"detail-bottom-left"},yi={class:"detail-bottom-right"},gi={class:"h5-detail"};function hi(e,t,V,X,R,C){const r=Fn,P=Zo,h=Qo,v=en,s=on,D=lo("AutoPoolV2PoolAdd"),F=lo("AutoPoolV2PoolRemove");return u(),f("div",ci,[o("div",pi,[G(r,{onClickRefresh:e.clickRefresh},null,8,["onClickRefresh"]),G(P)]),o("div",fi,[o("div",bi,[G(h),G(v),G(s)]),o("div",yi,[e.currentTab=="add"?(u(),ne(D,{key:0,onChangeCurrentTab:t[0]||(t[0]=n=>e.currentTab="remove")})):(u(),ne(F,{key:1,onChangeCurrentTab:t[1]||(t[1]=n=>e.currentTab="add")}))])]),o("div",gi,[e.currentTab=="add"?(u(),ne(D,{key:0,onChangeCurrentTab:t[2]||(t[2]=n=>e.currentTab="remove")})):(u(),ne(F,{key:1,onChangeCurrentTab:t[3]||(t[3]=n=>e.currentTab="add")})),G(h),G(v),G(s)])])}const Hi=We(mi,[["render",hi],["__scopeId","data-v-963ccb88"]]);export{Hi as default};
