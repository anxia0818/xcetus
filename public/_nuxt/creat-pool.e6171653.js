import{u as Xe,a as la,c as na}from"./sha256.1f7a269f.js";import{a as Qe,m as q,e as Ge,o as P,f as B,r as A,E as Go,l as sa,D as ne,Q as Jo,i as oe,h as a,c as Ie,x as M,w as ua,j as we,v as Ko,I as Yo,B as ia,p as Zo,k as xo,b as ra,C as ca,q as va,H as da,z as fe,t as ma}from"./entry.a2892cfb.js";import{_ as pa,c as fa}from"./new-add-or-create.c444bf61.js";import{_ as ga}from"./lock.92dc3aac.js";import{_ as ka,a as ea,b as Ca,c as ba}from"./new-liquidity-title.2de0e022.js";/* empty css              */import{a as oa,u as aa,p as Ho,s as Wo,c as Xo,f as De,i as wa,b as ha,d as _a}from"./pool.50d9f7a5.js";import{i as Qo}from"./import-icon.de3e6c66.js";import{_ as ya,a as Sa,b as Pa}from"./icon-Add-Liquidity_2x.4c6f13c0.js";import{_ as Na,a as Ta,s as Aa}from"./poolFee.d21f57f2.js";import{D as n}from"./decimal.0e8aa3f1.js";import{fromCoin as c,toCoin as d,fromCoinAmount as i,toCoinAmount as r,maxPrice as p,minPrice as f,createPoolInfo as v,fixedFromCoin as T,currentPriceReverse as We,currentPrice as se,initPrice as ge,direction as h,createPoolFromCoin as x,createPoolToCoin as ee,isFullRange as qe,resetData as Ia,defaultMinPrice as ze,defaultMaxPrice as He}from"./create-pool-data.bb7bbd67.js";import{_ as qa}from"./icon-selected_3x.09e9a6f0.js";import"./token-warning.fb396607.js";import"./status-block.07d921ee.js";/* empty css              *//* empty css              */import"./notifi.9c104050.js";import"./useWhale.9ea9c1b0.js";import"./index.2539e259.js";/* empty css              */import"./tick.505fdad3.js";/* empty css              */import"./refresh-icon.e3e5de13.js";/* empty css              */import"./swap-setting.1d6f9306.js";const Ra=Qe({setup(){const e=Xe();return{storeIndex:q(()=>e)}}});const La={class:"create-pool-lock"},$a={key:0,src:pa,alt:""},Ba={key:1,src:ga,alt:""};function Ma(e,t,Y,ce,Z,R){return P(),B("div",La,[e.storeIndex.theme=="default"?(P(),B("img",$a)):(P(),B("img",Ba))])}const Fa=Ge(Ra,[["render",Ma],["__scopeId","data-v-fb497971"]]),Ua=Qe({components:{NewLiquidityTile:ka,NewLiquidityDepositRatio:ea},setup(e,t){const Y=la(),ce=Xe(),Z=q(()=>ce),R=q(()=>Z.value.chainName),z=q(()=>Y),L=A(!1),w=A(!1),O=A(!1);A(),A(),A(),A(!1);const $=Go(),{t:F,locale:ve}=sa(),k=q(()=>R.value?oa(R.value):{}),g=aa(),J=q(()=>g),je=q(()=>Z.value.theme),V=q(()=>z.value.assets&&c.value&&z.value.assets[c.value.address]?Ho(z.value.assets[c.value.address].balance,c.value.decimals):"0"),U=q(()=>z.value.assets&&d.value&&z.value.assets[d.value.address]?Ho(z.value.assets[d.value.address].balance,d.value.decimals):"0"),ue=o=>{o==="fromCoin"?(T.value=!0,R.value==="Aptos"?i.value=Number(V.value)>0?c.value.symbol=="APT"?new n(Number(V.value)).sub(new n(.1)).lt(new n(0))?"0":new n(Number(V.value)).sub(new n(.1)).toString():String(V.value):"":i.value=Number(V.value)>0?c.value.symbol=="SUI"?new n(Number(V.value)).sub(new n(.05)).lt(new n(0))?"0":new n(Number(V.value)).sub(new n(.05)).toString():String(V.value):""):(T.value=!1,R.value==="Aptos"?r.value=Number(U.value)>0?d.value.symbol=="APT"?new n(Number(U.value)).sub(new n(.1)).lt(new n(0))?"0":new n(Number(U.value)).sub(new n(.1)).toString():String(U.value):"":r.value=Number(U.value)>0?d.value.symbol=="SUI"?new n(Number(U.value)).sub(new n(.05)).lt(new n(0))?"0":new n(Number(U.value)).sub(new n(.05)).toString():String(U.value):"")},he=o=>{o==="fromCoin"?(T.value=!0,i.value=Number(V.value)>0?Wo(new n(Number(V.value)).div(2).toString(),c.value.decimals).toString():""):(T.value=!1,r.value=Number(U.value)>0?Wo(new n(Number(U.value)).div(2).toString(),d.value.decimals).toString():"")};ne(()=>[J.value.tokens,$.query],async([o])=>{if(o&&o.length>0){const u=o;if($&&$.query&&$.query.fromCoin&&(console.log("0410###deposite###watch###route.query.tokena####",$.query.fromCoin),$.query.fromCoin)){const l=await k.value.getTokenBySymbol(u,$.query.fromCoin);c.value=l,x.value=l}if($&&$.query&&$.query.toCoin&&$.query.toCoin){const l=await k.value.getTokenBySymbol(u,$.query.toCoin);d.value=l,ee.value=l}}},{immediate:!0});const ie=A("--"),_e=q(()=>Z.value.slippage),Ve=A(),de=async()=>{if(!f.value&&!p.value)return!1;if(!i.value&&!r.value&&!f.value&&!p.value)return;const o=v.value;if(Xo(o))return;const{TickUtil:u,TickMath:l,getNearestTickByTick:N}=k.value,_=o==null?void 0:o.token_a.decimals,S=o==null?void 0:o.token_b.decimals;let y,I,C,b,D,W,j=o.current_tick_index,X;if(o.token_a.address.toLowerCase()===c.value.address.toLowerCase()&&o.token_b.address.toLowerCase()===d.value.address.toLowerCase()?X=!0:X=!1,f.value==="0"&&p.value==="∞")C=u.getMinIndex(Number(o.tickSpacing)),b=u.getMaxIndex(Number(o.tickSpacing));else{console.log(X,"===>directs1866"),X?(y=Number(f.value),I=Number(p.value)):(y=new n(1).div(p.value).toString(),I=new n(1).div(f.value).toString()),console.log("0518###pre###directs###",X),console.log("0518###pre###minPrice###",f.value),console.log("0518###pre###maxPrice###",p.value),console.log("0518###pre###poolInfos###",o),console.log("0518###pre###decimalsA###",_),console.log("0518###pre###decimalsB###",S),console.log("0518###pre###currentTickIndex###",j),console.log(y,I,"min max1875"),console.log(f.value,p.value,"===>maxPrice.value");try{D=y==0?-443636:l.priceToTickIndex(new n(y),_,S)}catch{D=-443636}try{W=l.priceToTickIndex(new n(I),_,S)}catch{W=443636}C=N(D,Number(o.tickSpacing)),b=N(W,Number(o.tickSpacing))}if(p.value!=="∞"&&C>=b){L.value=!0,i.value="",w.value=!0,r.value="";return}if(console.log(b,j,C,"1922"),p.value==="∞"||j>=C&&j<=b){L.value=!1,w.value=!1;let ae;if(i.value||r.value){if(T.value){const be=new n(i.value).mul(Math.pow(10,c.value.decimals)).toString();ae=new De(be)}else{const be=new n(r.value).mul(Math.pow(10,d.value.decimals)).toString();ae=new De(be)}console.log(X,"======>directs");const{liquidityAmount:Q,tokenMaxA:G,tokenMaxB:te,tokenMaxAOrigin:Ue,tokenMaxBOrigin:Oe}=k.value.estLiquidityAndcoinAmountFromOneAmounts({tokenA:o.token_a,tokenB:o.token_b,lowerTick:C,upperTick:b,coinAmount:ae,iscoinA:X?T.value:!T.value,roundUp:!0,slippage:Number(_e.value)/100,curSqrtPrice:new De(o.current_sqrt_price)});Ve.value={liquidityAmount:Q,tokenMaxA:G,tokenMaxB:te,tokenMaxAOrigin:Ue,tokenMaxBOrigin:Oe},console.log(te,G,"tokenMaxB===>tokenMaxA"),X?T.value?r.value=Number(te)>0?te:"":i.value=Number(G)>0?G:"":T.value?r.value=G:i.value=te}}else j>b||j<C?(L.value=!0,w.value=!0):(L.value=!0,i.value="",w.value=!0,r.value="")};ne(()=>ge.value,o=>{o&&de()},{immediate:!0}),ne(i,(o,u)=>{console.log(i,"===>fromCoinAmount"),o==""&&T.value&&(r.value=""),o&&T.value&&!O.value&&de()}),ne(r,(o,u)=>{console.log(o,"===>>>>newValsda"),o==""&&!T.value&&(i.value=""),o&&!T.value&&!O.value&&de()}),ne(()=>qe.value,o=>{de()});const s=o=>{console.log(o,"e"),O.value=!0,ie.value=o,o>0?H():(i.value="",r.value="")};ne([f,p],([o,u])=>{console.log(o,u,"==>minPrice,maxPrice"),Number(o)!==0&&Number(u)!==0&&!O.value?de():Number(o)!==0&&Number(u)!==0&&O.value&&H()},{immediate:!0});const E=()=>{const o=m.value&&m.value[c.value.address]&&m.value[c.value.address].price,u=m.value&&m.value[d.value.address]&&m.value[d.value.address].price;if(o&&u){const l=new n(i.value>0?i.value:0).mul(o),N=new n(r.value>0?r.value:0).mul(u),_=l.add(N).toNumber();ie.value=_>0&&_<.01?"<0.01":wa(_,2)}else ie.value="--"};ne(()=>[i.value,r.value,O.value],([o,u,l])=>{(o||u)&&!l?E():(!o||!u)&&!l&&(ie.value="--")},{immediate:!0});const m=q(()=>J.value.RATES),ke=A(),H=async()=>{if(!f.value&&!p.value)return!1;if(!i.value&&!r.value&&!f.value&&!p.value)return;const o=v.value;if(Xo(o))return;const{TickUtil:u,TickMath:l,getNearestTickByTick:N}=k.value,_=o==null?void 0:o.token_a.decimals,S=o==null?void 0:o.token_b.decimals;let y,I,C,b,D,W,j;if(o.token_a.address.toLowerCase()===c.value.address.toLowerCase()&&o.token_b.address.toLowerCase()===d.value.address.toLowerCase()?j=!0:j=!1,f.value==="0"&&p.value==="∞")C=u.getMinIndex(Number(o.tickSpacing)),b=u.getMaxIndex(Number(o.tickSpacing));else{j?(y=Number(f.value),I=Number(p.value)):(y=new n(1).div(p.value).toString(),I=new n(1).div(f.value).toString());try{D=y==0?-443636:l.priceToTickIndex(new n(y),_,S)}catch{D=-443636}try{W=l.priceToTickIndex(new n(I),_,S)}catch{W=443636}C=N(D,Number(o.tickSpacing)),b=N(W,Number(o.tickSpacing))}console.log(o.token_a,"poolInfos===>");const X=m.value[o==null?void 0:o.token_a.address].price,ae=m.value[o==null?void 0:o.token_b.address].price;console.log(C,b,"####tick_lower tick_upper 889");try{const{amountA:Q,amountB:G,tokenAmountsInfo:te}=await k.value.estCoinAmountsFromTotalAmount({lowerTick:C,upperTick:b,decimalsA:_,decimalsB:S,curSqrtPrice:new De(o.current_sqrt_price),totalAmount:ie.value,tokenPriceA:X,tokenPriceB:ae});console.log(Q,G,"###estCoinAmountsFromTotalAmount 844"),ke.value=te,o.needReverse?h.value?(i.value=Q,r.value=G):(i.value=G,r.value=Q):(i.value=Q,r.value=G)}catch(Q){console.log(Q,"e===>")}},K=q(()=>{var l,N,_,S,y,I,C,b;const o=(_=m.value[(N=(l=c)==null?void 0:l.value)==null?void 0:N.address])==null?void 0:_.price,u=(I=m.value[(y=(S=d)==null?void 0:S.value)==null?void 0:y.address])==null?void 0:I.price;return console.log(m.value,(b=(C=c)==null?void 0:C.value)==null?void 0:b.address,"===>fromCoin?.value?.address"),!!(o&&u)}),me=()=>{t.emit("toggle")},Ce=A(!1);q(()=>{if(J.value.poolConfigList&&c.value&&d.value){const o=J.value.poolConfigList.filter(l=>{var N,_,S,y;return l.token_a.address.toUpperCase()===((N=c.value.address)==null?void 0:N.toUpperCase())&&l.token_b.address.toUpperCase()===((_=d.value.address)==null?void 0:_.toUpperCase())||l.token_b.address.toUpperCase()===((S=c.value.address)==null?void 0:S.toUpperCase())&&l.token_a.address.toUpperCase()===((y=d.value.address)==null?void 0:y.toUpperCase())});console.log(o,"===>info");const u=[];return o.forEach(l=>{u.push(Number(l.fee))}),console.log(u,"===>>result"),u}else return[]}),q(()=>{var o;return(o=Z.value)==null?void 0:o.filterCreatePoolCoin});const ye=q(()=>{var o;return!c.value||!d.value?F("modal.selectTokenModalTitle"):!((o=$.query)!=null&&o.fee)&&na[R.value].hasCreatePool?"Select fee tier":!Number(i.value)&&!Number(r.value)?F("button.enterAmount"):Number(i.value)>Number(V.value)?F("button.insufficientBalance",{name:c.value.symbol}):Number(r.value)>Number(U.value)?F("button.insufficientBalance",{name:d.value.symbol}):p.value!=="∞"&&Number(f.value)>=Number(p.value)?F("newAdd.invalidRange"):F("newAdd.preview")}),Re=o=>{const u=new RegExp("[^\\d-]*(\\d*(?:\\.\\d{0,2})?).*$");o.target.value=o.target.value.replace(u,"$1")},Le=q(()=>{var o;return!i.value&&!r.value?(console.log("addLiquidityBtnDisabled11111"),!0):Number(i.value)>Number(V.value)||Number(r.value)>Number(U.value)?(console.log("addLiquidityBtnDisabled22222"),!0):ye.value!==F("newAdd.preview")?!0:!v.value&&!((o=v.value)!=null&&o.currentPrice)?(console.log("addLiquidityBtnDisabled55555"),!0):!!(Number(i.value)<=0&&Number(r.value)<=0||L.value||w.value)}),{setTransactionTxid:Se,setTransactionDesc:$e,setIsShowWaiting:pe,setIsShowSuccess:Pe,setIsShowRejected:Ne,setPositiomNum:Be}=ce,Me=()=>{R.value=="Sui"&&Fe()},Te=A(!1),Fe=async()=>{var X,ae,Q,G,te,Ue,Oe,be,Je,Ke,Ye,Ze,xe,eo,oo,ao,to,lo,no,so,uo,io,ro,co,vo,mo,po,fo,go,ko,Co,bo,wo,ho,_o,yo,So,Po,No,To,Ao,Io,qo,Ro,Lo,$o,Bo,Mo,Fo,Uo,Oo,Do,jo,Vo,Eo,zo;Ce.value=!1,console.log("创建sui池子");let o=!1;k.value.getIsSortedSymbols(x.value.address,ee.value.address)&&(o=!0),Se("");const u=L.value?"":`${i.value} ${(X=c.value)==null?void 0:X.symbol}`,l=w.value?"":`${r.value} ${(ae=d.value)==null?void 0:ae.symbol}`;console.log("0424###createPoolFromCoin###",x.value),console.log("0424###createPoolToCoin###",ee.value),console.log("0424###needReverse###",o),console.log("0424###createPoolInfo?.value?.needReverse###",(G=(Q=v)==null?void 0:Q.value)==null?void 0:G.needReverse),$e(F("tips.increaseLiquiditySuccess",{from:!o&&!((Ue=(te=v)==null?void 0:te.value)!=null&&Ue.needReverse)||o&&((be=(Oe=v)==null?void 0:Oe.value)!=null&&be.needReverse)?u:l,and:!L.value&&!w.value?"and":"",to:!o&&!((Ke=(Je=v)==null?void 0:Je.value)!=null&&Ke.needReverse)||o&&((Ze=(Ye=v)==null?void 0:Ye.value)!=null&&Ze.needReverse)?l:u})),pe(!0);let N="",_="",S="",y="",I="",C="",b=0,D=0,W=!1,j;if(o||(eo=(xe=v)==null?void 0:xe.value)!=null&&eo.needReverse){const re=o&&!((ao=(oo=v)==null?void 0:oo.value)!=null&&ao.needReverse);N=re?(io=(uo=(so=v)==null?void 0:so.value)==null?void 0:uo.token_b)==null?void 0:io.address:(no=(lo=(to=v)==null?void 0:to.value)==null?void 0:lo.token_a)==null?void 0:no.address,_=re?(fo=(po=(mo=v)==null?void 0:mo.value)==null?void 0:po.token_a)==null?void 0:fo.address:(vo=(co=(ro=v)==null?void 0:ro.value)==null?void 0:co.token_b)==null?void 0:vo.address,S=re?(ho=(wo=(bo=v)==null?void 0:bo.value)==null?void 0:wo.token_b)==null?void 0:ho.decimals:(Co=(ko=(go=v)==null?void 0:go.value)==null?void 0:ko.token_a)==null?void 0:Co.decimals,y=re?(To=(No=(Po=v)==null?void 0:Po.value)==null?void 0:No.token_a)==null?void 0:To.decimals:(So=(yo=(_o=v)==null?void 0:_o.value)==null?void 0:yo.token_b)==null?void 0:So.decimals,(Io=(Ao=v)==null?void 0:Ao.value)!=null&&Io.needReverse?(I=h.value?i.value:r.value,C=h.value?r.value:i.value,b=h.value?Number(f.value):1/Number(p.value),D=h.value?Number(p.value):1/Number(f.value),W=h.value?T.value:!T.value,j=h.value?se.value:1/Number(se.value)):(I=h.value?r.value:i.value,C=h.value?i.value:r.value,b=h.value?1/Number(p.value):Number(f.value),D=h.value?1/Number(f.value):Number(p.value),W=h.value?!T.value:T.value,j=h.value?1/Number(se.value):se.value)}else N=(Lo=(Ro=(qo=v)==null?void 0:qo.value)==null?void 0:Ro.token_a)==null?void 0:Lo.address,_=(Mo=(Bo=($o=v)==null?void 0:$o.value)==null?void 0:Bo.token_b)==null?void 0:Mo.address,S=(Oo=(Uo=(Fo=v)==null?void 0:Fo.value)==null?void 0:Uo.token_a)==null?void 0:Oo.decimals,y=(Vo=(jo=(Do=v)==null?void 0:Do.value)==null?void 0:jo.token_b)==null?void 0:Vo.decimals,I=h.value?i.value:r.value,C=h.value?r.value:i.value,b=h.value?Number(f.value):1/Number(p.value),D=h.value?Number(p.value):1/Number(f.value),W=h.value?T.value:!T.value,j=h.value?se.value:1/Number(se.value);try{console.log("0501###toCreatePool###params###",{coinTypeA:N,coinTypeB:_,decimalsA:S,decimalsB:y,amountA:I,amountB:C,minPrice:b,maxPrice:D,fix_amount_a:W,tick_spacing:Number(v.value.tickSpacing),slippage:Number(_e.value)/100,price:j});const re=await k.value.getCreatPoolTransactionPayload({coinTypeA:N,coinTypeB:_,decimalsA:S,decimalsB:y,amountA:I,amountB:C,minPrice:f.value=="0"&&p.value=="∞"?"0":b,maxPrice:f.value=="0"&&p.value=="∞"?"∞":D,fix_amount_a:W,tick_spacing:Number(v.value.tickSpacing),slippage:Number(_e.value)/100,price:j}),ta=await z.value.currentWallet.signAndExecuteTransactionBlock(re),Ae=k.value.handleTx(ta);if(Ae&&Ae.hash){Se(Ae.hash),pe(!1),Pe(!0);const Ee={title:"Created pool",desc:"Pool created successfully ",hash:Ae.hash,tit:"Pool Created",icon:"icon-icon-Position-Created",tokenInfo:{tokena:`${(Eo=c.value)==null?void 0:Eo.address}`,numa:L.value?"":`- ${i.value}`,logoa:J.value.tokensObj&&c.value&&c.value.address&&J.value.tokensObj[c.value.address]&&J.value.tokensObj[c.value.address].logoURI,tokenb:`${(zo=d.value)==null?void 0:zo.address}`,numb:w.value?"":`- ${r.value}`,logob:J.value.tokensObj&&d.value&&d.value.address&&J.value.tokensObj[d.value.address]&&J.value.tokensObj[d.value.address].logoURI},text:"Pool created successfully"};R.value!=="Aptos"&&(Ee.res=Ae.res),k.value.showTransitionPending(Ee),(await k.value.watchTransaction(Ee,!0)).status&&(Pe(!1),Te.value=!0,setTimeout(()=>{g.setPoolConfigList(R.value,Z.value.filterCoinsObj),k.value.getAccount(z.value.address)},1e3)),Be()}else pe(!1),Ne(!0);i.value="",r.value=""}catch(re){console.log("0407###createPool###error##",re),Ce.value=!1,g.setPoolConfigList(R.value,Z.value.filterCoinsObj),i.value="",r.value="",pe(!1),Ne(!0)}};return{inputChange:Re,fromCoinAmount:i,toCoinAmount:r,fromCoin:c,toCoin:d,maxBtnSelect:ue,halfBtnSelect:he,showFromCoinLock:L,showToCoinLock:w,fromCoinBlance:V,toCoinBlance:U,fixedFromCoin:T,isInputTotalAmount:O,toggle:me,theme:je,liquidityTotalAmount:ie,createPoolInfo:v,minPrice:f,maxPrice:p,currentPriceReverse:We,currentPrice:se,onInput:s,initPrice:ge,isShowtotalAmount:K,direction:h,isShowLiquidityModal:Ce,createPoolBtnText:ye,createPoolBtnDisabled:Le,toCreatePool:Me,isCreateSuccess:Te}}});const Oa=e=>(Zo("data-v-d9263849"),e=e(),xo(),e),Da={class:"create-pool-right"},ja={class:"card-container"},Va={class:"card-item"},Ea={class:"card-item"},za={key:0,class:"total-amount"},Ha=Oa(()=>a("span",null,"Total Amount",-1));function Wa(e,t,Y,ce,Z,R){const z=Jo("NewLiquidityTile"),L=Ca,w=Pa,O=Yo,$=ea,F=fa,ve=ia,k=Na;return P(),B("div",Da,[oe(z),a("div",ja,[a("div",Va,[oe(L,{modelValue:e.fromCoinAmount,"onUpdate:modelValue":t[0]||(t[0]=g=>e.fromCoinAmount=g),"input-value":e.fromCoinAmount,"coin-symbol":e.fromCoin?e.fromCoin.symbol:null,"coin-name":e.fromCoin?e.fromCoin.name:null,balance:e.fromCoinBlance,"coin-icon":e.fromCoin?e.fromCoin.logoURI:"",address:e.fromCoin?e.fromCoin.address:"","swap-direct":"From","import-page":"deposit","has-arrow":!1,onOnMax:t[1]||(t[1]=g=>e.maxBtnSelect("fromCoin")),onOnHalf:t[2]||(t[2]=g=>e.halfBtnSelect("fromCoin")),onOnInput:t[3]||(t[3]=g=>{e.fromCoinAmount=g,e.fixedFromCoin=!0,e.isInputTotalAmount=!1})},null,8,["modelValue","input-value","coin-symbol","coin-name","balance","coin-icon","address"]),e.showFromCoinLock?(P(),Ie(w,{key:0,"from-coin":e.fromCoin,"to-coin":e.toCoin},null,8,["from-coin","to-coin"])):M("",!0)]),a("div",Ea,[oe(L,{modelValue:e.toCoinAmount,"onUpdate:modelValue":t[4]||(t[4]=g=>e.toCoinAmount=g),"input-value":e.toCoinAmount,"coin-symbol":e.toCoin?e.toCoin.symbol:null,"coin-name":e.toCoin?e.toCoin.name:null,balance:e.toCoinBlance,"swap-direct":"To","coin-icon":e.toCoin?e.toCoin.logoURI:"",address:e.toCoin?e.toCoin.address:"","import-page":"deposit","has-arrow":!1,onOnMax:t[5]||(t[5]=g=>e.maxBtnSelect("toCoin")),onOnHalf:t[6]||(t[6]=g=>e.halfBtnSelect("toCoin")),onOnInput:t[7]||(t[7]=g=>{e.toCoinAmount=g,e.fixedFromCoin=!1,e.isInputTotalAmount=!1})},null,8,["modelValue","input-value","coin-symbol","coin-name","balance","coin-icon","address"]),e.showToCoinLock?(P(),Ie(w,{key:0,"from-coin":e.fromCoin,"to-coin":e.toCoin},null,8,["from-coin","to-coin"])):M("",!0)]),e.fromCoin&&e.toCoin&&!e.showToCoinLock&&!e.showFromCoinLock&&e.theme=="default"?(P(),B("img",{key:0,class:"add",src:ya,alt:"",onClick:t[8]||(t[8]=(...g)=>e.toggle&&e.toggle(...g))})):M("",!0),e.fromCoin&&e.toCoin&&!e.showToCoinLock&&!e.showFromCoinLock&&e.theme!=="default"?(P(),B("img",{key:1,class:"add",src:Sa,alt:"",onClick:t[9]||(t[9]=(...g)=>e.toggle&&e.toggle(...g))})):M("",!0)]),e.isShowtotalAmount?(P(),B("div",za,[Ha,a("span",null,[oe(O,{value:"$"+e.liquidityTotalAmount,placeholder:e.isInputTotalAmount?"":e.liquidityTotalAmount,onChange:e.inputChange,onInput:t[10]||(t[10]=g=>e.onInput(g.target.value))},null,8,["value","placeholder","onChange"])])])):M("",!0),e.initPrice?(P(),Ie($,{key:1,"from-coin":e.fromCoin,"to-coin":e.toCoin,"from-coin-amount":e.fromCoinAmount,"to-coin-amount":e.toCoinAmount,"fixed-from-coin":e.fixedFromCoin,"is-input-total-amount":e.isInputTotalAmount,"create-pool-info":e.createPoolInfo,"min-price":e.minPrice,"max-price":e.maxPrice,"current-price-tab":"custom","current-price":e.currentPrice,"current-price-reverse":e.currentPriceReverse},null,8,["from-coin","to-coin","from-coin-amount","to-coin-amount","fixed-from-coin","is-input-total-amount","create-pool-info","min-price","max-price","current-price","current-price-reverse"])):M("",!0),e.isShowLiquidityModal?(P(),Ie(F,{key:2,"pool-info":e.createPoolInfo,title:e.$t("newAdd.preview"),"from-coin-amount":e.fromCoinAmount,"to-coin-amount":e.toCoinAmount,"from-coin":e.fromCoin,"to-coin":e.toCoin,"fixed-from-coin":e.fixedFromCoin,"current-price":e.currentPrice,"current-price-reverse":e.currentPriceReverse,"current-price-tab":"custom","min-price":e.minPrice,"max-price":e.maxPrice,"show-from-coin-lock":e.showFromCoinLock,"show-to-coin-lock":e.showToCoinLock,"current-direct":e.direction,"is-increase":!1,onCreatePool:e.toCreatePool,onOnClose:t[11]||(t[11]=g=>e.isShowLiquidityModal=!1)},null,8,["pool-info","title","from-coin-amount","to-coin-amount","from-coin","to-coin","fixed-from-coin","current-price","current-price-reverse","min-price","max-price","show-from-coin-lock","show-to-coin-lock","current-direct","onCreatePool"])):M("",!0),oe(ve,{class:"add-liquidity-btn",disabled:e.createPoolBtnDisabled,onClick:t[12]||(t[12]=g=>e.isShowLiquidityModal=!0)},{default:ua(()=>[we(Ko(e.createPoolBtnText),1)]),_:1},8,["disabled"]),e.isCreateSuccess?(P(),Ie(k,{key:3,onOnClose:t[13]||(t[13]=g=>e.isCreateSuccess=!1)})):M("",!0)])}const Xa=Ge(Ua,[["render",Wa],["__scopeId","data-v-d9263849"]]),Qa=Qe({components:{CreatePoolRight:Xa},setup(){const e=A(!0),t=A(!0),Y=A(!0),ce=A(!0),Z=A(!1),R=A("1"),z=A(!0),L=A(""),w=Go(),O=ra(),$=Xe(),F=q(()=>$),ve=aa(),k=q(()=>ve),g=A("");ne(()=>[O,k.value.tokensObj],([s,E])=>{var m;((m=O==null?void 0:O.currentRoute)==null?void 0:m.value.name)=="liquidity-creat-pool"&&E&&(c.value=k.value.tokensObj[w.query.fromCoin],d.value=k.value.tokensObj[w.query.toCoin],console.log("z"),g.value=w.query.fee!=="null"&&w.query.fee?w.query.fee:"")},{immediate:!0,deep:!0}),ne(()=>[c.value,d.value,ge.value,g.value,f.value,p.value,i.value,r.value],([s,E,m,ke,H,K,me])=>{!s||!E?(R.value="1",e.value=!0,t.value=!0,Y.value=!0):ke?m?!H||!K?(R.value="4",e.value=!1,t.value=!1,Y.value=!0):me||(R.value="5",e.value=!1,t.value=!1,Y.value=!1):(R.value="3",e.value=!1,t.value=!0,Y.value=!0):(R.value="2",e.value=!0,t.value=!0,Y.value=!0)},{immediate:!0});const J=s=>{ge.value=s},je=s=>{var E;return(s==null?void 0:s.logoURI)||(s==null?void 0:s.logo_url)||((E=k.value.tokensObj[s==null?void 0:s.address])==null?void 0:E.logo_url)||(F.value.theme==="default"?Qo("/image/coins/unknown.png"):Qo("/image/coins/sui-unknown.png"))},V=s=>{switch(s){case"1":return{top:"10%"};case"2":return{top:"29%"};case"3":return{top:"48%"};case"4":return{top:"67%"};case"5":return{top:"87%"}}},U=q(()=>F.value.chainName),ue=q(()=>U.value?oa(U.value):{}),he=s=>{var Ce,ye,Re,Le,Se,$e,pe,Pe,Ne,Be,Me,Te,Fe,o;s?(ge.value=s,se.value=s,We.value=new n(1).div(new n(s)).toString()):(ge.value="",se.value="",We.value="");let E,m;const ke=k.value.poolConfigList;for(let u=0;u<ke.length;u++){const l=ke[u];if(l.token_a.address.toUpperCase()===((Re=(ye=(Ce=x)==null?void 0:Ce.value)==null?void 0:ye.address)==null?void 0:Re.toUpperCase())&&l.token_b.address.toUpperCase()===(($e=(Se=(Le=ee)==null?void 0:Le.value)==null?void 0:Se.address)==null?void 0:$e.toUpperCase())){E=l.needReverse,m=l;break}else if(l.token_b.address.toUpperCase()===((Ne=(Pe=(pe=x)==null?void 0:pe.value)==null?void 0:Pe.address)==null?void 0:Ne.toUpperCase())&&l.token_a.address.toUpperCase()===((Te=(Me=(Be=ee)==null?void 0:Be.value)==null?void 0:Me.address)==null?void 0:Te.toUpperCase())){E=l.needReverse,m=l;break}}let H=!1;ue.value.getIsSortedSymbols((Fe=x.value)==null?void 0:Fe.address,(o=ee.value)==null?void 0:o.address)&&(H=!0);let K;H&&!h.value?K=!0:H&&h.value||!H&&h.value?K=!1:K=!0;const me=U.value=="Aptos"?Ta:Aa;if(c.value&&d.value&&s){const u=m?m==null?void 0:m.token_a.decimals:H?ee.value.decimals:x.value.decimals,l=m?m==null?void 0:m.token_b.decimals:H?x.value.decimals:ee.value.decimals,N=s&&ue.value.TickMath.priceToSqrtPriceX64(K?new n(1/s):new n(s),u,l);console.log(N,"===>current_sqrt_price");const _=s&&ue.value.TickMath.priceToSqrtPriceX64(new n(1).div(s),c.value.decimals,d.value.decimals);console.log(!K,"===>!newDirect"),console.log(u,l,"decimalsA,decimalsB===>");const S=ue.value.TickMath.priceToTickIndex(K?new n(1).div(s):new n(s),u,l);console.log(S,"==>currentTickIndex");const y=S-me[w.query.fee]*5,I=S+me[w.query.fee]*5,C=ue.value.TickMath.tickIndexToPrice(y,u,l).toString(),b=ue.value.TickMath.tickIndexToPrice(I,u,l).toString();qe.value?(f.value="0",p.value="∞"):K?(f.value=String(1/b),p.value=String(1/C),ze.value=String(1/b),He.value=String(1/C)):(f.value=C,p.value=b,ze.value=C,He.value=b),console.log("0518###c####createPoolFromCoin.value####",x.value),console.log("0518###c####createPoolToCoin.value####",ee.value),console.log("0518###c####createPoolNeedReverse####",H);const D={token_a:m?m.token_a:H?ee.value:x.value,token_b:m?m.token_b:H?x.value:ee.value,isCreate:!0,tickSpacing:me[w.query.fee],currentPrice:s,current_sqrt_price:N,tick_lower:y,tick_upper:I,current_tick_index:S,currentPriceReverse:ha(String(1/s),6),reverse_current_sqrt_price:_,needReverse:E,fee:w.query.fee};v.value=D,console.log("0518###c####poolInfos####",D)}else v.value=null,f.value="",p.value=""},ie=()=>{qe.value=!qe.value,he(v.value.currentPrice)},_e=s=>{console.log(s,"####0731 priceRangeChangeMin"),f.value=s},Ve=s=>{p.value=s},de=()=>{var s,E;if(console.log(v.value,"==>createPoolInfo.value"),h.value=!h.value,v.value){he(_a(new n(1).div(v.value.currentPrice).toString(),(E=(s=d)==null?void 0:s.value)==null?void 0:E.decimals));const m=c.value;c.value=d.value,d.value=m,T.value?i.value=r.value:r.value=i.value}};return ca(()=>{Ia()}),{amountLock:Y,currentStep:R,sliderStyle:V,coinAmount:Z,pricerange:L,fromCoin:c,toCoin:d,fee:g,direct:z,getCoinIcon:je,isSelectFullRange:ce,onInput:J,store:F,initPrice:ge,inputPriceLock:e,specifyPriceLock:t,changeCurrentPrice:he,minPrice:f,maxPrice:p,defaultMinPrice:ze,defaultMaxPrice:He,clickFullRange:ie,createPoolInfo:v,isFullRange:qe,priceRangeChangeMin:_e,priceRangeChangeMax:Ve,fromCoinAmount:i,toggle:de}}});const le=e=>(Zo("data-v-4b15fbc6"),e=e(),xo(),e),Ga={class:"creat-pool-container"},Ja={class:"creat-pool-left"},Ka={class:"progress"},Ya=le(()=>a("div",{class:"slider-ratio-content"},null,-1)),Za=[Ya],xa={class:"progress-text"},et={key:0},ot={key:0},at={key:0},tt={key:0},lt={key:0},nt={class:"creat-pool-center"},st={class:"title"},ut=le(()=>a("div",{class:"left"},"Set Initial Price",-1)),it={class:"right"},rt={key:0,class:"token-box"},ct=le(()=>a("div",null,[a("svg",{class:"icon icon-up","aria-hidden":"true"},[a("use",{"xlink:href":"#icon-exchange_up1"})])],-1)),vt=le(()=>a("div",null,[a("svg",{class:"icon icon-down","aria-hidden":"true"},[a("use",{"xlink:href":"#icon-exchange_down1"})])],-1)),dt=[ct,vt],mt={class:"content top-content"},pt=le(()=>a("div",{class:"top"},[a("span",null,"💡"),a("span",null,"Please set an initial price for this new pool to start.")],-1)),ft={class:"bottom"},gt={class:"input-div"},kt={key:0,class:"lock"},Ct={class:"title"},bt=le(()=>a("div",{class:"left"},"Set Price Range",-1)),wt={class:"right"},ht={key:0,src:qa},_t=le(()=>a("span",null,"Full Range",-1)),yt={class:"content bottom-content"},St=le(()=>a("span",null,"💡",-1)),Pt=le(()=>a("span",null,"Please specify a price range that you want to provide your liquidity within.",-1)),Nt=[St,Pt],Tt={class:"bottom"},At={class:"set-price-box"},It={key:0,class:"lock"},qt=le(()=>a("div",{class:"create-pool-warning"}," To create a new pool, the initial price you set must be within your price range. ",-1)),Rt={class:"creat-pool-right-container"},Lt={key:0,class:"lock"};function $t(e,t,Y,ce,Z,R){var F,ve;const z=Yo,L=Fa,w=ba,O=Jo("CreatePoolRight"),$=va("image");return P(),B("div",Ga,[a("div",Ja,[a("div",Ka,[a("div",{class:"slider-ratio",style:da(e.sliderStyle(e.currentStep))},Za,4)]),a("div",xa,[a("div",{class:fe(["row",!e.fromCoin||!e.toCoin?"color-text":""])},[e.fromCoin&&e.toCoin?(P(),B("span",et,"✓")):M("",!0),we(" Select Pool ")],2),a("div",{class:fe(["row",e.fee?"":"color-text"])},[e.fee?(P(),B("span",ot,"✓")):M("",!0),we(" Select Fee Tier ")],2),a("div",{class:fe(["row",e.initPrice?"":"color-text"])},[e.initPrice?(P(),B("span",at,"✓")):M("",!0),we(" Set Initial Price ")],2),a("div",{class:fe(["row",!e.minPrice||!e.maxPrice?"color-text":""])},[e.minPrice&&e.maxPrice?(P(),B("span",tt,"✓")):M("",!0),we(" Select Price Range ")],2),a("div",{class:fe(["row",e.fromCoinAmount?"":"color-text"])},[e.fromCoinAmount?(P(),B("span",lt,"✓")):M("",!0),we(" Confirm Liquidity ")],2)])]),a("div",nt,[a("div",st,[ut,a("div",it,[e.fromCoin&&e.toCoin&&e.initPrice?(P(),B("div",rt,[ma(a("img",null,null,512),[[$,(F=e.fromCoin)==null?void 0:F.logo_url]]),a("span",null,Ko((ve=e.fromCoin)==null?void 0:ve.symbol),1),a("div",{class:"icon-change",onClick:t[0]||(t[0]=(...k)=>e.toggle&&e.toggle(...k))},dt)])):M("",!0)])]),a("div",mt,[pt,a("div",ft,[a("div",gt,[oe(z,{type:"text",placeholder:"0.0",value:e.initPrice,onInput:t[1]||(t[1]=k=>e.changeCurrentPrice(k.target.value))},null,8,["value"])]),e.inputPriceLock?(P(),B("div",kt,[oe(L)])):M("",!0)])]),a("div",Ct,[bt,a("div",wt,[a("div",{class:fe(["radio",e.isFullRange?"active-radio":""]),onClick:t[2]||(t[2]=(...k)=>e.clickFullRange&&e.clickFullRange(...k))},[e.isFullRange?(P(),B("img",ht)):M("",!0)],2),_t])]),a("div",yt,[a("div",{class:fe(["top",e.specifyPriceLock?"":"no-border"])},Nt,2),a("div",Tt,[a("div",At,[oe(w,{min:e.minPrice,max:e.maxPrice,"from-coin":e.fromCoin,"to-coin":e.toCoin,direct:e.direct,"default-min-price":e.defaultMinPrice,"default-max-price":e.defaultMaxPrice,"pool-info":e.createPoolInfo,loading:!1,"current-price-tab":"custom",onOnChangeMinPrice:e.priceRangeChangeMin,onOnChangeMaxPrice:e.priceRangeChangeMax},null,8,["min","max","from-coin","to-coin","direct","default-min-price","default-max-price","pool-info","onOnChangeMinPrice","onOnChangeMaxPrice"])]),e.specifyPriceLock?(P(),B("div",It,[oe(L)])):M("",!0),qt])])]),a("div",Rt,[e.amountLock?(P(),B("div",Lt,[oe(L)])):M("",!0),oe(O,{"create-pool-info":e.createPoolInfo,onToggle:e.toggle},null,8,["create-pool-info","onToggle"])])])}const ul=Ge(Qa,[["render",$t],["__scopeId","data-v-4b15fbc6"]]);export{ul as default};
