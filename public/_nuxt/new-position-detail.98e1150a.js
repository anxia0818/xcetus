import{_ as Oo}from"./new-position-title.ea5f3181.js";import{_ as mo}from"./token-warning.938a4923.js";import{_ as qo}from"./status-block.9ca52567.js";import{j as Qo,n as Ko,d as ge,e as to,u as io,a as Z,g as bo,c as ce,s as Me,r as $e,b as Oe,p as So,J as Lo,K as Bo,T as $o,C as Zo,m as Vo}from"./pool.801b6dc0.js";import{s as ao,m as xo,l as en,b as on,a as nn}from"./transform.c672907f.js";import{D as w}from"./decimal.0bdeb344.js";import{u as Je,a as lo}from"./sha256.6473538a.js";import{a as Ye,r as E,l as C,H as Mo,q as Ie,e as Qe,o as I,f as P,t as Pe,N as Uo,h as n,p as vo,k as fo,m as po,s as Ao,i as le,u as K,v as H,j as fe,x as de,y as Co,a4 as tn,b as ro,C as Xe,L as sn,a8 as Po,O as To,w as Le,F as Ve,E as oo,B as uo,M as an,A as wo,c as qe,D as ln,G as rn,z as jo,P as un,$ as dn,K as cn,S as mn}from"./entry.4af10731.js";import{i as no}from"./import-icon.de3e6c66.js";/* empty css              */import{_ as ho}from"./assets-card.17c1991c.js";import{_ as vn}from"./coin-lock.edc4bc78.js";import{a as fn}from"./new-add-or-create.9679b1f0.js";import{_ as pn,a as hn}from"./icon-Add-Liquidity_2x.0acb06cb.js";/* empty css              *//* empty css              */import{u as Eo}from"./notifi.404537b4.js";import{_ as gn}from"./apr-tips.2bb69a9f.js";import{u as Do}from"./farms.43c570c7.js";/* empty css              *//* empty css              */import"./back.a58d5ddc.js";import"./swap-setting.f410950f.js";/* empty css              */import"./icon-error_2x.f26cfead.js";import"./img-lock_2x.a28135f4.js";import"./img-lock_2x.99137bb9.js";import"./useWhale.1d642cbb.js";import"./icon_rewards_2x.3d50962a.js";const _o=Math.PI,yo=2*_o,Ze=1e-6,kn=yo-Ze;function Fo(e){this._+=e[0];for(let t=1,s=e.length;t<s;++t)this._+=arguments[t]+e[t]}function bn(e){let t=Math.floor(e);if(!(t>=0))throw new Error(`invalid digits: ${e}`);if(t>15)return Fo;const s=10**t;return function(a){this._+=a[0];for(let B=1,g=a.length;B<g;++B)this._+=Math.round(arguments[B]*s)/s+a[B]}}class wn{constructor(t){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=t==null?Fo:bn(t)}moveTo(t,s){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+s}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(t,s){this._append`L${this._x1=+t},${this._y1=+s}`}quadraticCurveTo(t,s,a,B){this._append`Q${+t},${+s},${this._x1=+a},${this._y1=+B}`}bezierCurveTo(t,s,a,B,g,R){this._append`C${+t},${+s},${+a},${+B},${this._x1=+g},${this._y1=+R}`}arcTo(t,s,a,B,g){if(t=+t,s=+s,a=+a,B=+B,g=+g,g<0)throw new Error(`negative radius: ${g}`);let R=this._x1,m=this._y1,o=a-t,l=B-s,v=R-t,d=m-s,b=v*v+d*d;if(this._x1===null)this._append`M${this._x1=t},${this._y1=s}`;else if(b>Ze)if(!(Math.abs(d*o-l*v)>Ze)||!g)this._append`L${this._x1=t},${this._y1=s}`;else{let G=a-R,se=B-m,oe=o*o+l*l,ne=G*G+se*se,r=Math.sqrt(oe),f=Math.sqrt(b),T=g*Math.tan((_o-Math.acos((oe+b-ne)/(2*r*f)))/2),i=T/f,k=T/r;Math.abs(i-1)>Ze&&this._append`L${t+i*v},${s+i*d}`,this._append`A${g},${g},0,0,${+(d*G>v*se)},${this._x1=t+k*o},${this._y1=s+k*l}`}}arc(t,s,a,B,g,R){if(t=+t,s=+s,a=+a,R=!!R,a<0)throw new Error(`negative radius: ${a}`);let m=a*Math.cos(B),o=a*Math.sin(B),l=t+m,v=s+o,d=1^R,b=R?B-g:g-B;this._x1===null?this._append`M${l},${v}`:(Math.abs(this._x1-l)>Ze||Math.abs(this._y1-v)>Ze)&&this._append`L${l},${v}`,a&&(b<0&&(b=b%yo+yo),b>kn?this._append`A${a},${a},0,1,${d},${t-m},${s-o}A${a},${a},0,1,${d},${this._x1=l},${this._y1=v}`:b>Ze&&this._append`A${a},${a},0,${+(b>=_o)},${d},${this._x1=t+a*Math.cos(g)},${this._y1=s+a*Math.sin(g)}`)}rect(t,s,a,B){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+s}h${a=+a}v${+B}h${-a}Z`}toString(){return this._}}function eo(e){return function(){return e}}function _n(e){let t=3;return e.digits=function(s){if(!arguments.length)return t;if(s==null)t=null;else{const a=Math.floor(s);if(!(a>=0))throw new RangeError(`invalid digits: ${s}`);t=a}return e},()=>new wn(t)}function yn(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function Wo(e){this._context=e}Wo.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t);break}}};function In(e){return new Wo(e)}function An(e){return e[0]}function Cn(e){return e[1]}function Sn(e,t){var s=eo(!0),a=null,B=In,g=null,R=_n(m);e=typeof e=="function"?e:e===void 0?An:eo(e),t=typeof t=="function"?t:t===void 0?Cn:eo(t);function m(o){var l,v=(o=yn(o)).length,d,b=!1,G;for(a==null&&(g=B(G=R())),l=0;l<=v;++l)!(l<v&&s(d=o[l],l,o))===b&&((b=!b)?g.lineStart():g.lineEnd()),b&&g.point(+e(d,l,o),+t(d,l,o));if(G)return g=null,G+""||null}return m.x=function(o){return arguments.length?(e=typeof o=="function"?o:eo(+o),m):e},m.y=function(o){return arguments.length?(t=typeof o=="function"?o:eo(+o),m):t},m.defined=function(o){return arguments.length?(s=typeof o=="function"?o:eo(!!o),m):s},m.curve=function(o){return arguments.length?(B=o,a!=null&&(g=B(a)),m):B},m.context=function(o){return arguments.length?(o==null?a=g=null:g=B(a=o),m):a},m}function No(){}function Ho(e){this._context=e}Ho.prototype={areaStart:No,areaEnd:No,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}};function $n(e){return new Ho(e)}function Ro(e,t,s){const a=new w(10).pow(t-s);return new w(1.0001).pow(e).mul(a)}const Pn=Ye({props:{poolInfo:{type:Object,default:()=>({chartLoading:!1,token_a:{decimal:6},token_b:{decimal:6},currentLiquity:"50000000"})},minPrice:{type:String,default:""},maxPrice:{type:String,default:""},direction:{type:Boolean,default:!0},tickList:{type:Array,default:()=>[]},currentTick:{type:Number,default:0},chartLoading:{type:Boolean,default:!1},currentPriceTab:{type:String,default:""},before7dContractPriceLowest:{type:String,default:""},before7dContractPriceHighest:{type:String,default:""}},setup(e,t){const s=E(1),a=E(""),B=E(""),g=C(()=>{var i,k,A;return d.sqrtPriceX64ToPrice((i=e.poolInfo)==null?void 0:i.current_sqrt_price,(k=e.poolInfo)==null?void 0:k.coinA.decimals,(A=e.poolInfo)==null?void 0:A.coinB.decimals).toString()}),R=C(()=>{let i=0;return e.direction?i=(Number(e.minPrice)/Number(g.value)-1)*100:i=(Number(e.minPrice)/Number(1/Number(g.value))-1)*100,i=i>0&&i<.1?.1:i,i=i<0&&i>-.1?-.1:i,i}),m=C(()=>{let i=0;return e.direction?i=(Number(e.maxPrice)/Number(g.value)-1)*100:i=(Number(e.maxPrice)/Number(1/Number(g.value))-1)*100,i=i>0&&i<.1?.1:i,i=i<0&&i>-.1?-.1:i,i}),o=Je(),l=C(()=>o),v=C(()=>l.value.chainName?to(l.value.chainName):{}),{TickMath:d,getNearestTickByTick:b}=v.value,G=()=>{const i=s.value/2;s.value=i,ne(e.poolInfo,i)},se=()=>{const i=s.value*2;s.value=i,ne(e.poolInfo,i)},oe=(i=[])=>{let k=6;const A=Math.abs(Number(i[0])-Number(i[i.length-1]));return A>=6?k=0:A>=1?k=1:A>=.1?k=2:A>=.01?k=3:A>=.001?k=4:A>=1e-4?k=5:A>=1e-5?k=6:A>=1e-6?k=7:A>=1e-7&&(k=8),k},ne=(i,k=1)=>{if(i&&i.token_a&&!e.chartLoading&&e.minPrice&&e.maxPrice){console.log(e.poolInfo,"==>props.poolInfo");const A=Number(e.poolInfo.current_tick_index);console.log("0117###dataProcessing###currentTick###",A),console.log("0117###dataProcessing###props.poolInfo###",e.poolInfo),console.log("0117###dataProcessing###minPrice###",e.minPrice),console.log("0117###dataProcessing###maxPrice###",e.maxPrice),console.log("0117###dataProcessing###poolInfo###",e.poolInfo);let _=A+100*k,u=A-100*k,te,J;if(e.maxPrice==="∞")J=v.value.TickUtil.getMaxIndex(Number(e.poolInfo.tickSpacing));else try{e.direction?J=d.priceToTickIndex(new w(e.maxPrice),e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals):J=d.priceToTickIndex(new w(1).div(e.minPrice),e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals)}catch{J=443636}if(e.minPrice==="0")te=v.value.TickUtil.getMinIndex(Number(e.poolInfo.tickSpacing));else try{e.direction?te=d.priceToTickIndex(new w(e.minPrice),e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals):te=d.priceToTickIndex(new w(1).div(e.maxPrice),e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals)}catch{te=-443636}let ue=0;if(e.currentPriceTab!=="full range"){if(A>=te&&A<=J){const W=A-te,he=J-A;ue=Math.max(Math.abs(W),Math.abs(he))}else A<te?ue=Math.abs(J-A):ue=Math.abs(A-te);_=A+ue+100*k,u=A-ue-100*k,console.log(k,A,"===>zooms")}else{const W=(Math.abs(A)>5e3,2e4);_=A+W*k,u=A-W*k}u<-443636&&(u=-443636),_>443636&&(_=443636),console.log(u,_,"===>201");const F=new w(i.liquidity).div(Math.pow(10,8)).toString();console.log(F,"==>currentLiquity");const S=e.tickList;console.log("0117####drawChart####tick_info_array####",S);const O=[],q=[];let D={};for(let W=0;W<S.length;W++){if(D=S[W],D.index<=A&&D.index>=u){if(O.length<1&&W!==0){const he=S[W-1];O.unshift({...he,index:u})}O.unshift(D)}else if(D.index>A&&D.index<=_&&(q.push(D),O.length<1&&W!==0)){const he=S[W-1];O.push({...he,index:u})}if(D.index>_){const he=S[W];if(q.push({...he,index:_}),O.length<1&&W!==0){const we=S[W-1];O.push({...we,index:u})}break}}console.log(A,u,_,"===>currentTick");let ie="0";for(let W=O.length-1;W>=0;W--)ie=new w(ie).plus(new w(O[W].liquidityNet.toString()).div(Math.pow(10,8))).toString(),O[W].liquityAmount=ie;let V=F;for(let W=0;W<q.length;W++)V=new w(V).plus(new w(q[W].liquidityNet.toString()).div(Math.pow(10,8))).toString(),q[W].liquityAmount=V;console.log(O.length,q.length,"leftArray");let x=[];const Q=S&&S.length>0?{index:A,liquityAmount:Number(F)}:{index:A,liquityAmount:0};(O.length>0||q.length>0)&&(console.log([Q,...q],"279===>"),x=[...O.reverse(),Q,...q],e.direction||(x=x.reverse()));const ke=[];S.forEach(W=>{ke.push({...W,liquidityGross:W.liquidityGross.toString(),liquidityNet:W.liquidityNet.toString()})}),console.log("0117####drawChart####testTickInfoArray####",ke),console.log("0117####drawChart####currentLiquity####",F),console.log(x,"===>chartData"),f(x,u,_,te,J,A)}};let r=E(!1);Mo(()=>{document.body.clientWidth<750?r.value=!1:r.value=!0,window.onresize=()=>{document.body.clientWidth<750?r.value=!1:r.value=!0,ne(e.poolInfo,s.value)}});const f=(i,k,A,_,u,te)=>{console.log("0117####drawChart####chartData####",i),console.log("0117####drawChart####tickMin####",k),console.log("0117####drawChart####tickMax####",A),console.log("0117####drawChart####minPriceTick####",_),console.log("0117####drawChart####maxPriceTick####",u),console.log("0117####drawChart####currentTick####",te),console.log("0117####drawChart####props.direction####",e.direction),console.log("0518###newd3###props.before7dContractPriceLowest###",e.before7dContractPriceLowest),console.log("0518###newd3###props.before7dContractPriceHighest###",e.before7dContractPriceHighest);let J,ue;e.direction?(J=e.before7dContractPriceLowest?d.priceToTickIndex(new w(e.before7dContractPriceLowest),e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals):"",ue=e.before7dContractPriceHighest?d.priceToTickIndex(new w(e.before7dContractPriceHighest),e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals):""):(J=e.before7dContractPriceLowest?d.priceToTickIndex(new w(1).div(e.before7dContractPriceLowest),e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals):"",ue=e.before7dContractPriceHighest?d.priceToTickIndex(new w(1).div(e.before7dContractPriceHighest),e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals):"");const F={top:30,right:35,bottom:20,left:55};let S,O;r.value,S=340-F.left-F.right,O=205-F.top-F.bottom;const q=A-k,D=parseInt(String(q/4));let ie=[k+D/4,k+D,k+2*D,A-D,A-D/4];const V=k,x=A,Q=S/(x-V);e.currentPriceTab==="full range"&&(ie=[k,k+2*D,A]),console.log("0117####drawChart####xArr####",ie),console.log("0117####drawChart####utickMin####",V),console.log("0117####drawChart####utickMax####",x),console.log("0117####drawChart####unit####",Q);const ke=ie.map($=>e.direction?Ro($,e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals).toString():new w(1).div(Ro($,e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals)).toString());oe(ke),ao("#chart").selectAll("*").remove();const W=ao("#chart").attr("width",S+F.left+F.right).attr("height",O+F.top+F.bottom).append("g").attr("transform",`translate(${F.left},${F.right})`),he=xo(i,function($){return Number(Math.abs($.liquityAmount))})||0,we=en().range([0,O]).domain([he,0]);on().rangeRound([0,S]).padding(.1);const Be=W.append("g").attr("id","barsBox").selectAll("rect").data(i).enter().append("rect");l.value.theme=="default"?Be.attr("x",function($,j){return j===0?0:e.direction?Math.abs($.index-V)*Q:Math.abs(x-$.index)*Q}).attr("y",function($,j){return e.direction?j===i.length-1?0:we($.liquityAmount):j===i.length-1?0:we(i[j+1].liquityAmount)}).attr("width",function($,j){return j===0&&i.length===1&&$.liquityAmount>0?S:(e.direction,j!==i.length-1?Math.abs(i[j+1].index-$.index)*Q:0)}).attr("height",function($,j){return j===0&&i.length===1&&$.liquityAmount>0?O:e.direction?j===i.length-1?0:O-we($.liquityAmount):j===i.length-1?0:O-we(i[j+1].liquityAmount)}).attr("fill","#279477").attr("class","bars").attr("stroke-width",1).attr("stroke","#279477"):Be.attr("x",function($,j){return j===0?0:e.direction?Math.abs($.index-V)*Q:Math.abs(x-$.index)*Q}).attr("y",function($,j){return e.direction?j===i.length-1?0:we(Math.abs($.liquityAmount)):j===i.length-1?0:we(Math.abs(i[j+1].liquityAmount))}).attr("width",function($,j){return j===0&&i.length===1&&$.liquityAmount>0?S:(e.direction,j!==i.length-1?Math.abs(i[j+1].index-$.index)*Q:0)}).attr("height",function($,j){if(j===0&&i.length===1&&$.liquityAmount>0)return O;if(e.direction)return j===i.length-1?0:Number($.liquityAmount)?O-we(Math.abs($.liquityAmount)):0;{if(j===i.length-1)return 0;const re=O-we(Math.abs(i[j+1].liquityAmount));return Number(i[j+1].liquityAmount)?re:0}}).attr("fill","#407497").attr("class","bars").attr("stroke-width",1).attr("stroke","#407497");const c=W.append("g");c.append("line").attr("x1",0).attr("y1",155).attr("x2",S).attr("y2",155).attr("stroke-width",1).attr("stroke","#50535D"),c.append("g");let h=0;e.direction?h=Math.abs(te-V)*Q:h=Math.abs(te-x)*Q,console.log(l.value.theme=="default","leftHandle#"),(l.value.theme=="default"?W.append("line").attr("x1",0).attr("y1",0).attr("x2",0).attr("y2",155).attr("stroke-width",2).attr("stroke","#68FFD8"):W.append("line").attr("x1",0).attr("y1",0).attr("x2",0).attr("y2",155).attr("stroke-width",2).attr("stroke","#76C8FF")).attr("transform","translate("+h+", 0)"),ao("#triangle").attr("width",8).attr("height",4);let L=[[0,0],[4,4],[8,0]],z=Sn().x(function($){return $[0]}).y(function($){return $[1]}).curve($n);const M=h-4;W.append("path").attr("d",z(L)).style("fill",l.value.theme=="default"?"#68FFD8":"#76C8FF").attr("transform","translate("+M+", 0)");let U,Y,ee,me;e.direction?(console.log("0525###d3###select###minPriceTick###",_),console.log("0525###d3###select###maxPriceTick###",u),console.log("0525###d3###select###props.minPrice###",e.minPrice),console.log("0525###d3###select###props.maxPrice###",e.maxPrice),U=_<V?-100:parseInt(String(Math.abs(_-V)*Q)),Y=u<V?-100:parseInt(String(Math.abs(u-V)*Q)),ee=J<V?-100:Math.abs(J-V)*Q,me=ue<V?-100:Math.abs(ue-V)*Q):(Y=_<V?-100:Math.abs(x-_)*Q,U=u<V?-100:Math.abs(x-u)*Q,me=J<V?-100:Math.abs(x-J)*Q,ee=ue<V?-100:Math.abs(x-ue)*Q),e.minPrice==="0"&&(U=0),e.maxPrice==="∞"&&(Y=S),r.value?a.value=S-U+60+"px":a.value=S-U+52+"px",B.value=Y+74+"px",console.log(U,Y,"##minPriceTickX"),J&&ee<S&&W.append("line").attr("x1",0).attr("y1",0).attr("x2",0).attr("y2",155).attr("stroke-width",1).attr("stroke-dasharray","5, 5").attr("stroke","rgba(255, 255, 255, 0.5)").attr("transform","translate("+ee+", 0)"),ue&&me<S&&W.append("line").attr("x1",0).attr("y1",0).attr("x2",0).attr("y2",155).attr("stroke-width",1).attr("stroke-dasharray","5, 5").attr("stroke","rgba(255, 255, 255, 0.5)").attr("transform","translate("+me+", 0)");const ve=nn().extent([[0,0],[S,O]]).handleSize(30).on("end",Te);W.append("g").attr("class","brush").call(ve).call(ve.move,[U,Y]);function Te($){if(!$.sourceEvent||!$.selection)return;r.value?a.value=S-$.selection[0]+60+"px":a.value=S-$.selection[0]+52+"px",B.value=$.selection[1]+74+"px";let j,re;console.log("0525###d3###select###e.selection[0]###",$.selection[0]),console.log("0525###d3###select###e.selection[0]###",$.selection[1]),console.log("0525###d3###select###props.direction###",e.direction),console.log("0525###d3###select###width###",S),console.log("0525###d3###select###unit###",Q),console.log("0525###d3###select###utickMin###",V),console.log("0525###d3###select###utickMax###",x),console.log("0525###d3###select###props.poolInfo###",e.poolInfo);let be=0,y=0;e.direction?(be=b(parseInt(String($.selection[0]/Q+V)),Number(e.poolInfo.tickSpacing)),j=d.tickIndexToPrice(be,e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals).toString(),y=b(parseInt(String($.selection[1]/Q+V)),Number(e.poolInfo.tickSpacing)),re=d.tickIndexToPrice(y,e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals).toString(),console.log("0525###d3###select###minTick###",be),console.log("0525###d3###select###maxTick###",y),console.log("0525###d3###select###minPrice###",j),console.log("0525###d3###select###maxPrice###",re)):(y=b(x-$.selection[0]/Q,Number(e.poolInfo.tickSpacing)),j=1/d.tickIndexToPrice(y,e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals).toString(),be=b(x-$.selection[1]/Q,Number(e.poolInfo.tickSpacing)),re=1/d.tickIndexToPrice(be,e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals).toString()),t.emit("onChangeMinPrice",String(ge(String(j),6))),t.emit("onChangeMaxPrice",String(ge(String(re),6)))}l.value.theme=="default"?ao(".selection").attr("stroke","rgba(255, 255, 255, 0)").attr("fill","#15322C"):ao(".selection").attr("stroke","rgba(255, 255, 255, 0)").attr("fill","rgba(255,255,255,0.7)")};E(""),Ie(()=>[e.poolInfo,e.minPrice,e.maxPrice,e.currentPriceTab,e.tickList],([i,k,A,_])=>{console.log(i,k,A,A>k,"poolInfo && minPrice && maxPrice && (maxPrice > minPrice)"),i&&k&&A&&ne(i,s.value)},{immediate:!0});const T=E(!0);return Ie(()=>e.chartLoading,(i,k)=>{i!==k&&(T.value=i)},{immediate:!0,deep:!0}),{store:l,loading:T,zoomOut:G,zoomIn:se,rangeSizeLower:R,rangeSizeUpper:m,rangeSizeLowerPosition:a,rangeSizeUpperPosition:B,decimalFormat:Qo,numberformat:Ko}}});const Tn=e=>(vo("data-v-59ae7c8b"),e=e(),fo(),e),Nn={class:"chart-box"},Rn={class:"chart"},On=Tn(()=>n("svg",{id:"chart"},null,-1)),qn=[On];function Ln(e,t,s,a,B,g){return I(),P("div",Nn,[Pe(n("div",Rn,qn,512),[[Uo,!e.loading]])])}const Xo=Qe(Pn,[["render",Ln],["__scopeId","data-v-59ae7c8b"]]),Bn=Ye({components:{StatusBlock:qo,NewPositionChart:Xo,TokenWarning:mo},setup(e){const t=E(),s=E(),a=C(()=>{var i,k;return(k=(i=d.value)==null?void 0:i.poolInfo)==null?void 0:k.needReverse}),B=Je(),g=C(()=>B),R=C(()=>g.value.currentExplorer),m=C(()=>g.value.theme),o=C(()=>g.value.chainName),l=io(),v=C(()=>l),d=E({}),b=po();Ie(()=>[v.value.currentPositionInfo,o.value],([i,k])=>{var A;k=="Aptos"&&i?(d.value=i,t.value=d.value.token_a,s.value=d.value.token_b):k=="Sui"&&i&&(i==null?void 0:i.nftHash)==((A=b==null?void 0:b.query)==null?void 0:A.pos)&&(console.log(i,"==>newVal"),d.value=i,t.value=d.value.token_a,s.value=d.value.token_b,console.log(t.value,s.value,"###fromCoin.value"))},{immediate:!0});const G=i=>{var k;return(i==null?void 0:i.logoURI)||(i==null?void 0:i.logo_url)||((k=v.value.tokensObj[i==null?void 0:i.address])==null?void 0:k.logo_url)||(m.value==="default"?no("/image/coins/unknown.png"):no("/image/coins/sui-unknown.png"))},se=C(()=>o.value?to(o.value):{}),oe=E([]),ne=async i=>{console.log(i,"===>positionInfo.value.poolInfo");const{list:k}=await se.value.getTicks(i),A=k?se.value.getTickDataFromUrlData(k):[];console.log(A,"list===>"),oe.value=A};Ie(()=>[d.value,v.value.poolsObj],([i,k])=>{console.log(i,!ce(i),"177111"),i&&!ce(i)&&i.poolInfo&&k&&!ce(k)&&(console.log(i,k,"==>poolConfigObj"),ne(k[i.poolAddress]))},{immediate:!0});const r=E(!0);console.log(d.value,"188---------->");const f=(i,k)=>i!=="0"&&k!=="∞"?Me(1/(1-Number((i/k)**.25)),2)+"x":"1x",T=C(()=>d.value.minPrice&&d.value.maxPrice?f(d.value.minPrice,d.value.maxPrice):"--");return{needReverse:a,getCoinIcon:G,theme:m,indexStore:B,direct:r,addCommom:Z,decimalUi:ge,tickList:oe,positionInfo:d,fromCoin:t,toCoin:s,getExplorerUrl:bo,lever:T,currentExplorer:R}}}),Mn=""+globalThis.__publicAssetsURL("image/aptos-price.png"),Un=""+globalThis.__publicAssetsURL("sui-image/sui-price.png"),jn=""+globalThis.__publicAssetsURL("image/icon-arrow@2x.png"),En=""+globalThis.__publicAssetsURL("sui-image/icon-arrow@2x.png");const Ge=e=>(vo("data-v-39ad5090"),e=e(),fo(),e),Dn={class:"new-position-info"},Fn={class:"pool-info"},Wn={class:"left"},Hn={class:"coin-a"},Xn={alt:""},Gn={class:"coin-b"},zn={alt:""},Jn={class:"position-name"},Yn=["href"],Qn=Ge(()=>n("use",{"xlink:href":"#icon-icon_copy1"},null,-1)),Kn=[Qn],Zn={key:0,class:"pool-fee"},Vn=Ge(()=>n("span",null,"Fee tier",-1)),xn={class:"right"},et={class:"h5-pool-info"},ot={class:"coin-info"},nt={class:"coin-a"},tt={alt:""},it={class:"coin-b"},st={alt:""},at={class:"position-name"},lt=["href"],rt=Ge(()=>n("use",{"xlink:href":"#icon-icon_copy1"},null,-1)),ut=[rt],dt={key:0,class:"pool-fee"},ct={class:"price-info"},mt={class:"price-and-chart"},vt={class:"left"},ft={class:"current-price"},pt=Ge(()=>n("span",null,"Current Price",-1)),ht={class:"coin-rate"},gt=Ge(()=>n("div",null,[n("svg",{class:"icon icon-up","aria-hidden":"true"},[n("use",{"xlink:href":"#icon-exchange_up1"})])],-1)),kt=Ge(()=>n("div",null,[n("svg",{class:"icon icon-down","aria-hidden":"true"},[n("use",{"xlink:href":"#icon-exchange_down1"})])],-1)),bt=[gt,kt],wt={key:0},_t={key:1},yt={key:0,class:"position-range"},It=Ge(()=>n("div",{class:"position-range-title"}," Position Range ",-1)),At={key:0},Ct={key:1},St={key:2,src:Mn,alt:""},$t={key:3,src:Un,alt:""},Pt={key:4},Tt={key:5},Nt={key:1,class:"position-range position-range-warp"},Rt={key:0,class:"position-range-title"},Ot={key:1,class:"position-range-title"},qt={key:2},Lt={key:3},Bt={class:"price-img"},Mt={key:0,src:jn,alt:""},Ut={key:1,src:En,alt:""},jt={key:4},Et={key:5},Dt={class:"lever"},Ft=Ge(()=>n("div",{class:"lever-title"},"Leverage",-1)),Wt={class:"lever-text"},Ht={class:"right"},Xt=Ge(()=>n("div",{class:"chat-mask"},null,-1));function Gt(e,t,s,a,B,g){var v,d,b,G,se,oe,ne,r,f,T,i,k,A,_,u,te,J,ue,F,S,O,q,D,ie,V,x,Q,ke,W,he;const R=mo,m=qo,o=Xo,l=Ao("image");return I(),P("div",Dn,[n("div",Fn,[n("div",Wn,[n("div",Hn,[Pe(n("img",Xn,null,512),[[l,e.needReverse?e.getCoinIcon(e.positionInfo.token_b):e.getCoinIcon(e.positionInfo.token_a)]]),le(R,{address:e.needReverse?(G=(b=e.positionInfo)==null?void 0:b.token_b)==null?void 0:G.address:(d=(v=e.positionInfo)==null?void 0:v.token_a)==null?void 0:d.address,"style-params":{width:"12px",height:"12px",left:"18px",bottom:"4px"}},null,8,["address"])]),n("div",Gn,[Pe(n("img",zn,null,512),[[l,e.needReverse?e.getCoinIcon(e.positionInfo.token_a):e.getCoinIcon(e.positionInfo.token_b)]]),le(R,{address:e.needReverse?(r=(ne=e.positionInfo)==null?void 0:ne.token_a)==null?void 0:r.address:(oe=(se=e.positionInfo)==null?void 0:se.token_b)==null?void 0:oe.address,"style-params":{width:"12px",height:"12px",left:"18px",bottom:"4px"}},null,8,["address"])]),n("div",Jn,[n("a",{href:("getExplorerUrl"in e?e.getExplorerUrl:K(bo))(e.currentExplorer,"nftAddress",e.positionInfo.nftHash),target:"_blank"},H((T=(f=e.positionInfo)==null?void 0:f.name)==null?void 0:T.split("|")[1]),9,Yn)]),(I(),P("svg",{class:"copy-icon","aria-hidden":"true",onClick:t[0]||(t[0]=we=>e.indexStore.copy(e.positionInfo.nftHash||e.positionInfo.clmm_position_id))},Kn)),e.positionInfo.fee?(I(),P("div",Zn,[Vn,fe(" "+H(e.positionInfo.fee*100)+"% ",1)])):de("",!0)]),n("div",xn,[le(m,{"current-status":(i=e.positionInfo)==null?void 0:i.currentStatus},null,8,["current-status"])])]),n("div",et,[n("div",null,[n("div",ot,[n("div",nt,[Pe(n("img",tt,null,512),[[l,e.needReverse?e.getCoinIcon(e.positionInfo.token_b):e.getCoinIcon(e.positionInfo.token_a)]]),le(R,{address:e.needReverse?(u=(_=e.positionInfo)==null?void 0:_.token_b)==null?void 0:u.address:(A=(k=e.positionInfo)==null?void 0:k.token_a)==null?void 0:A.address,"style-params":{width:"12px",height:"12px",left:"18px",bottom:"4px"}},null,8,["address"])]),n("div",it,[Pe(n("img",st,null,512),[[l,e.needReverse?e.getCoinIcon(e.positionInfo.token_a):e.getCoinIcon(e.positionInfo.token_b)]]),le(R,{address:e.needReverse?(F=(ue=e.positionInfo)==null?void 0:ue.token_a)==null?void 0:F.address:(J=(te=e.positionInfo)==null?void 0:te.token_b)==null?void 0:J.address,"style-params":{width:"12px",height:"12px",left:"18px",bottom:"4px"}},null,8,["address"])])]),n("div",at,[n("div",null,[n("a",{href:("getExplorerUrl"in e?e.getExplorerUrl:K(bo))(e.currentExplorer,"nftAddress",e.positionInfo.nftHash),target:"_blank"},H((O=(S=e.positionInfo)==null?void 0:S.name)==null?void 0:O.split("|")[1]),9,lt),(I(),P("svg",{class:"copy-icon","aria-hidden":"true",onClick:t[1]||(t[1]=we=>e.indexStore.copy(e.positionInfo.nftHash))},ut))]),e.positionInfo.fee?(I(),P("div",dt,H(e.positionInfo.fee*100)+"%",1)):de("",!0)])]),le(m,{"current-status":(q=e.positionInfo)==null?void 0:q.currentStatus},null,8,["current-status"])]),n("div",ct,[n("div",mt,[n("div",vt,[n("div",ft,[n("div",null,[pt,n("div",ht,[n("div",{onClick:t[2]||(t[2]=we=>e.direct=!e.direct)},bt)])]),(e.needReverse?!e.direct:e.direct)?(I(),P("div",wt,[fe(H(("addCommom"in e?e.addCommom:K(Z))(("decimalUi"in e?e.decimalUi:K(ge))(e.positionInfo.currentPrice,6)))+"   ",1),n("span",null,H((D=e.toCoin)==null?void 0:D.symbol)+" per "+H((ie=e.fromCoin)==null?void 0:ie.symbol),1)])):(I(),P("div",_t,[fe(H(("addCommom"in e?e.addCommom:K(Z))(("decimalUi"in e?e.decimalUi:K(ge))(e.positionInfo.currentPriceReverse,6)))+"   ",1),n("span",null,H((V=e.fromCoin)==null?void 0:V.symbol)+" per "+H((x=e.toCoin)==null?void 0:x.symbol),1)]))]),e.positionInfo.minPrice&&e.positionInfo.minPrice.length<9&&e.positionInfo.maxPrice&&e.positionInfo.maxPrice.length?(I(),P("div",yt,[It,n("div",null,[(e.needReverse?!e.direct:e.direct)?(I(),P("div",At,[fe(H(("addCommom"in e?e.addCommom:K(Z))(("decimalUi"in e?e.decimalUi:K(ge))(e.positionInfo.minPrice,6)))+" ",1),n("span",null,H(e.positionInfo&&e.positionInfo.token_b&&e.positionInfo.token_b.symbol),1)])):(I(),P("div",Ct,[fe(H(((Q=e.positionInfo)==null?void 0:Q.minPrice)!=="0"?("addCommom"in e?e.addCommom:K(Z))(("decimalUi"in e?e.decimalUi:K(ge))(1/e.positionInfo.minPrice,6)):0)+" ",1),n("span",null,H(e.positionInfo&&e.positionInfo.token_a&&e.positionInfo.token_a.symbol),1)])),e.theme=="default"?(I(),P("img",St)):(I(),P("img",$t)),(e.needReverse?!e.direct:e.direct)?(I(),P("div",Pt,[fe(H(((ke=e.positionInfo)==null?void 0:ke.maxPrice)!=="∞"?("addCommom"in e?e.addCommom:K(Z))(("decimalUi"in e?e.decimalUi:K(ge))(e.positionInfo.maxPrice,6)):"∞")+" ",1),n("span",null,H(e.positionInfo&&e.positionInfo.token_b&&e.positionInfo.token_b.symbol),1)])):(I(),P("div",Tt,[fe(H(((W=e.positionInfo)==null?void 0:W.maxPrice)!=="∞"?("addCommom"in e?e.addCommom:K(Z))(("decimalUi"in e?e.decimalUi:K(ge))(1/e.positionInfo.maxPrice,6)):"∞")+" ",1),n("span",null,H(e.positionInfo&&e.positionInfo.token_a&&e.positionInfo.token_a.symbol),1)]))])])):(I(),P("div",Nt,[(e.needReverse?!e.direct:e.direct)?(I(),P("span",Rt," Position Range ")):(I(),P("span",Ot," Position Range ")),(e.needReverse?!e.direct:e.direct)?(I(),P("div",qt,[fe(H(("addCommom"in e?e.addCommom:K(Z))(("decimalUi"in e?e.decimalUi:K(ge))(e.positionInfo.minPrice,6)))+" ",1),n("span",null,H(e.positionInfo&&e.positionInfo.token_b&&e.positionInfo.token_b.symbol),1)])):(I(),P("div",Lt,[fe(H(e.positionInfo.maxPrice!=="∞"?("addCommom"in e?e.addCommom:K(Z))(("decimalUi"in e?e.decimalUi:K(ge))(1/e.positionInfo.maxPrice,6)):"∞")+" ",1),n("span",null,H(e.positionInfo&&e.positionInfo.token_a&&e.positionInfo.token_a.symbol),1)])),n("div",Bt,[e.theme=="default"?(I(),P("img",Mt)):(I(),P("img",Ut))]),(e.needReverse?!e.direct:e.direct)?(I(),P("div",jt,[fe(H(e.positionInfo.maxPrice!=="∞"?("addCommom"in e?e.addCommom:K(Z))(("decimalUi"in e?e.decimalUi:K(ge))(e.positionInfo.maxPrice,6)):"∞")+" ",1),n("span",null,H(e.positionInfo&&e.positionInfo.token_b&&e.positionInfo.token_b.symbol),1)])):(I(),P("div",Et,[fe(H(((he=e.positionInfo)==null?void 0:he.minPrice)!=="0"?("addCommom"in e?e.addCommom:K(Z))(("decimalUi"in e?e.decimalUi:K(ge))(1/e.positionInfo.minPrice,6)):0)+" ",1),n("span",null,H(e.positionInfo&&e.positionInfo.token_a&&e.positionInfo.token_a.symbol),1),fe("   ")]))])),n("div",Dt,[Ft,n("div",Wt,H(e.lever),1)])]),n("div",Ht,[le(o,{"pool-info":e.positionInfo.poolInfo,"tick-list":e.tickList,"min-price":e.needReverse&&e.positionInfo.maxPrice!=="∞"?1/e.positionInfo.maxPrice:e.positionInfo.minPrice,"max-price":e.needReverse&&e.positionInfo.minPrice!=0?1/e.positionInfo.minPrice:e.positionInfo.maxPrice,direction:!e.needReverse,"current-price-tab":"custom","chart-loading":!1},null,8,["pool-info","tick-list","min-price","max-price","direction"]),Xt])])])])}const Go=Qe(Bn,[["render",Gt],["__scopeId","data-v-39ad5090"]]),zt=Ye({components:{TokenWarning:mo},setup(e,t){const{t:s}=Co(),{$notify:a}=tn(),B=Je(),g=C(()=>B),R=io(),m=C(()=>R),o=E({}),l=E({}),v=E({}),d=C(()=>g.value.chainName),b=C(()=>d.value?to(d.value):{}),G=po(),se=E(!1),oe=async(c=null)=>{const h=c||o.value;console.log(h,"===>posInfo");const p=m.value.addressLpTokens[h.poolAddress];if(p){const L=await b.value.getTickDataByIndex(p.ticks_handle,Number(h.tick_lower_index)),z=await b.value.getTickDataByIndex(p.ticks_handle,Number(h.tick_upper_index));let M={};d.value==="Aptos"?M=await b.value.getPosRewardersAmount({poolAddress:A.currentRoute.value.query.address,positionName:A.currentRoute.value.query.token,tickLowerData:L,tickUpperData:z}):(M=await b.value.fetchPosRewardersAmount({poolAddress:h.poolAddress,positionId:h.pos_object_id||h.clmm_position_id,coinTypeA:h.coin_type_a||h.coinTypeA,coinTypeB:h.coin_type_b||h.coinTypeB,rewarderInfo:h.poolInfo.rewarder_infos}),console.log(h,"##rewarderInfo"));const U=[];let Y=new w(0);M.forEach((ee,me)=>{var j,re;const ve=(j=m.value.tokensObj[ee.coin_address])==null?void 0:j.decimals,Te=ee.amount_owed.toString();let $=new w(Te).div(Math.pow(10,ve)).toString();if(d.value=="Aptos"&&Number($)>999999999&&($="0"),console.log(h.poolInfo,"##posInfo.poolInfo"),h.poolInfo[`rewarder_display${me+1}`]||Number($)>0){const be=m.value.tokensObj[ee.coin_address],y=((re=m.value.RATES[ee.coin_address])==null?void 0:re.price)||0,X=new w($).mul(y).toString();Y=new w(Y).plus(X),U.push({...ee,...be,amount:Number($)>0?$e($,ve):0,amountUSD:Number(X)>0?$e(X,2):0,amountUSDText:X})}}),_.value=U,console.log(U,"====>result722")}};Ie(()=>[m.value.currentPositionInfo,d.value],([c,h])=>{var p;h=="Aptos"&&c?(o.value=c,l.value=c==null?void 0:c.token_a,v.value=c==null?void 0:c.token_b):h=="Sui"&&c&&(c==null?void 0:c.nftHash)==((p=G==null?void 0:G.query)==null?void 0:p.pos)&&(console.log(c,"==>newVal"),o.value=c,l.value=c==null?void 0:c.token_a,v.value=c==null?void 0:c.token_b,se.value=!1)},{immediate:!0}),Ie(()=>[o.value,m.value.addressLpTokens],([c,h])=>{!ce(c)&&!ce(h)&&oe(c)},{immediate:!0});const ne=C(()=>{var c,h,p,L,z,M,U,Y;if(o.value&&!ce(o.value)&&m.value.RATES){const ee=o.value.amountA*((h=m.value.RATES[(c=o.value)==null?void 0:c.token_a.address])==null?void 0:h.price),me=o.value.amountB*((L=m.value.RATES[(p=o.value)==null?void 0:p.token_b.address])==null?void 0:L.price);if((M=m.value.RATES[(z=o.value)==null?void 0:z.token_a.address])!=null&&M.price&&((Y=m.value.RATES[(U=o.value)==null?void 0:U.token_b.address])!=null&&Y.price)){const ve=Number(ee+me);return ve>0&&ve<.01?"<0.01":Z(Me(ee+me,2),2)}else return" --"}else return" --"}),r=C(()=>{var c,h,p,L;return console.log((h=(c=o.value)==null?void 0:c.poolInfo)==null?void 0:h.needReverse,"===>positionInfo.value?.poolInfo?.needReverse"),(L=(p=o.value)==null?void 0:p.poolInfo)==null?void 0:L.needReverse}),f=C(()=>m.value.RATES),T=C(()=>{var c,h;if(f.value&&l.value&&v.value&&!ce(f.value)&&!ce(l.value)&&!ce(v.value)){const p=[],L=Number(o.value.feeOwedA)||0,z=Number(o.value.feeOwedB)||0;console.log(L,z,"===292"),console.log(f.value,l.value.address,"===293"),console.log(f.value[l.value.address],"===>RATES.value[fromCoin.value.address]"),console.log(f.value[v.value.address],"===>RATES.value[toCoin.value.address]");const M=new w(L).mul(((c=f.value[l.value.address])==null?void 0:c.price)||0),U=new w(z).mul(((h=f.value[v.value.address])==null?void 0:h.price)||0);return console.log(M.toString(),U.toString(),"====>292"),p.push({amount:L,amountUSD:M.toString()},{amount:z,amountUSD:U.toString()}),p}return[]}),i=C(()=>{var h,p;let c=new w(0);return(h=T.value)==null||h.forEach(L=>{c=c.add(new w(L.amountUSD))}),d.value=="Sui"&&((p=_.value)==null||p.forEach(L=>{c=c.add(new w(L.amountUSDText))})),console.log(T.value,_.value,"===>pendingRewarderArr.value"),c.toNumber()}),k=C(()=>{var h;let c=new w(0);return(h=_.value)==null||h.forEach(p=>{c=c.add(new w(p.amountUSDText))}),c.toNumber()}),A=ro(),_=E([]),{setIsShowSuccess:u,setIsShowRejected:te,setIsShowWaiting:J,setTransactionDesc:ue,setTransactionTxid:F}=B,S=lo(),O=C(()=>S),q=async()=>{se.value=!0;let c={coinTypeA:o.value.poolInfo.coinTypeA,coinTypeB:o.value.poolInfo.coinTypeB,coinTypeC:"",coinTypeD:"",coinTypeE:"",pool_address:o.value.poolAddress,pos_index:o.value.index,rewarder_nums:_.value.length,collect_fee:!0};c.coinTypeC=_.value[0]?_.value[0].coin_address:"",c.coinTypeD=_.value[1]?_.value[1].coin_address:"",c.coinTypeE=_.value[2]?_.value[2].coin_address:"",J(!0),ue(),console.log(c,o.value,"###collectRewarderParams");try{let h;if(d.value==="Aptos"){const p=await b.value.getCollectRewarderTransactionPayload(c);h=await O.value.currentWallet.signAndSubmitTransaction(p)}else{c.pos_index=o.value.pos_object_id;const p=await b.value.getCollectRewarderTransactionPayload(c,o.value),L=await O.value.currentWallet.signAndExecuteTransactionBlock(p);h=b.value.handleTx(L)}if(h&&h.hash){F(h.hash),J(!1),u(!0);const p={title:"Claim",desc:"",hash:h.hash,tit:"Rewards Claimed",icon:"icon-icon-Removed"};d.value!=="Aptos"&&(p.res=h.res),b.value.showTransitionPending(p);const L=await b.value.watchTransaction(p);console.log("0310###toClaimRewards###transitionStatus###",L),L&&t.emit("getDetails")}else console.log("0310###toClaimRewards###else###"),J(!1),te(!0),se.value=!1}catch(h){J(!1),te(!0),se.value=!1,console.log(h,"error===>")}},D=E(!1),ie=async()=>{console.log("0310###toClaimRewards##start###",o.value),D.value=!0;const c=_.value;let h={coinTypeA:o.value.poolInfo.coinTypeA,coinTypeB:o.value.poolInfo.coinTypeB,coinTypeC:"",coinTypeD:"",coinTypeE:"",pool_address:o.value.poolAddress,pos_index:o.value.index,rewarder_nums:c.length};h.coinTypeC=c[0]?c[0].coin_address:"",h.coinTypeD=c[1]?c[1].coin_address:"",h.coinTypeE=c[2]?c[2].coin_address:"",console.log(h,"===>collectRewarderParams");try{let p;if(d.value==="Aptos"){const L=await b.value.getCollectRewarderTransactionPayload(h);p=await O.value.currentWallet.signAndSubmitTransaction(L)}else{h.pos_index=o.value.pos_object_id;const L=await b.value.getCollectRewarderTransactionPayload(h),z=await O.value.currentWallet.signAndExecuteTransactionBlock(L);p=b.value.handleTx(z)}if(console.log("0310###toClaimRewards##tx###",p),p&&p.hash){F(p.hash),J(!1),u(!0);const L=c[0].amount+c[0].symbol,z=h.coinTypeD?" and "+c[1].amount+c[1].symbol:"",M=h.coinTypeE?" and "+c[2].amount+c[2].symbol:"",U={title:"Claim",desc:"",hash:p.hash,tit:"Rewards Claimed",icon:"icon-icon-Removed",tokenInfo:{tokena:c[0].address,numa:`+ ${Number(c[0].amount)}`,logoa:m.value.tokensObj&&c[0]&&c[0].address&&m.value.tokensObj[c[0].address]&&m.value.tokensObj[c[0].address].logoURI,tokenb:c[1]&&c[1].address,numb:h.coinTypeD?`+ ${Number(c[1].amount)}`:"",logob:h.coinTypeD?m.value.tokensObj&&c[1]&&c[1].address&&m.value.tokensObj[c[1].address]&&m.value.tokensObj[c[1].address].logoURI:"",tokenc:c[2]&&c[2].address,numc:h.coinTypeE?`+ ${Number(c[2].amount)}`:"",logoc:h.coinTypeE?m.value.tokensObj&&c[2]&&c[2].address&&m.value.tokensObj[c[2].address]&&m.value.tokensObj[c[2].address].logoURI:""},text:L+z+M};d.value!=="Aptos"&&(U.res=p.res),b.value.showTransitionPending(U);const Y=await b.value.watchTransaction(U);console.log("0310###toClaimRewards###transitionStatus###",Y),Y&&setTimeout(()=>{t.emit("getDetails"),b.value.getAccount(O.value.address)},3e3)}else console.log("0310###toClaimRewards###else###"),J(!1),te(!0);D.value=!1}catch(p){console.log("0310###collectRewarderParams Error###",p),D.value=!1,J(!1),te(!0)}},V=C(()=>m.value.positionDetailCurrentTab),x=C(()=>{var p,L,z,M,U,Y;const c=ge(r.value?(L=o.value)==null?void 0:L.amountB:(p=o.value)==null?void 0:p.amountA,r.value?(Y=(U=o.value)==null?void 0:U.token_b)==null?void 0:Y.decimals:(M=(z=o.value)==null?void 0:z.token_a)==null?void 0:M.decimals),h=r.value?m.value.positionActionAmount.toCoinAmount||0:m.value.positionActionAmount.fromCoinAmount||0;if(V.value=="increase")return h?new w(c).add(new w(h)).toString():"";if(h){const ee=new w(c).minus(new w(h)).toString();return ee<0?"0":String(ee)}else return""}),Q=C(()=>{var p,L,z,M,U,Y;const c=ge(r.value?(L=o.value)==null?void 0:L.amountA:(p=o.value)==null?void 0:p.amountB,r.value?(Y=(U=o.value)==null?void 0:U.token_a)==null?void 0:Y.decimals:(M=(z=o.value)==null?void 0:z.token_b)==null?void 0:M.decimals),h=r.value?m.value.positionActionAmount.fromCoinAmount||0:m.value.positionActionAmount.toCoinAmount||0;if(console.log(c,h,"===>427"),V.value=="increase")return h?new w(c).add(new w(h)).toString():"";if(h){const ee=new w(c).minus(new w(h)).toString();return ee<0?"0":String(ee)}else return""}),ke=C(()=>r.value?m.value.positionActionAmount.toCoinAmount:m.value.positionActionAmount.fromCoinAmount),W=C(()=>r.value?m.value.positionActionAmount.fromCoinAmount:m.value.positionActionAmount.toCoinAmount),he=c=>{var h;return(c==null?void 0:c.logoURI)||(c==null?void 0:c.logo_url)||((h=m.value.tokensObj[c==null?void 0:c.address])==null?void 0:h.logo_url)||(g.value.theme==="default"?no("/image/coins/unknown.png"):no("/image/coins/sui-unknown.png"))},we=C(()=>{var M,U,Y,ee,me,ve,Te,$,j,re,be,y;const{fromCoinAmount:c,toCoinAmount:h}=m.value.positionActionAmount,p=m.value.positionDetailCurrentTab,L=ge(r.value?(U=o.value)==null?void 0:U.amountB:(M=o.value)==null?void 0:M.amountA,r.value?(ve=(me=o.value)==null?void 0:me.token_b)==null?void 0:ve.decimals:(ee=(Y=o.value)==null?void 0:Y.token_a)==null?void 0:ee.decimals),z=ge(r.value?($=o.value)==null?void 0:$.amountA:(Te=o.value)==null?void 0:Te.amountB,r.value?(y=(be=o.value)==null?void 0:be.token_a)==null?void 0:y.decimals:(re=(j=o.value)==null?void 0:j.token_b)==null?void 0:re.decimals);return console.log(L,z,c,h,"621===>"),d.value=="Sui"||p=="remove"&&d.value=="Aptos"&&c==L&&h==z}),We=async()=>{se.value=!0;const c=Z(o.value.feeOwedA,o.value.token_a.decimals)==0?"":`${$e(o.value.feeOwedA,o.value.token_a.decimals)} ${o.value.token_a.symbol}`,h=Z(o.value.feeOwedB,o.value.token_b.decimals)==0?"":`${$e(o.value.feeOwedB,o.value.token_b.decimals)} ${o.value.token_b.symbol}`;ue(s("newAdd.claimWaitingText",{from:r.value?h:c,and:Z(o.value.feeOwedA,o.value.token_a.decimals)==0||Z(o.value.feeOwedB,o.value.token_b.decimals)==0?"":"and",to:r.value?c:h})),J(!0);let p;const L={pool:o.value.poolInfo,position:o.value};try{const z=await b.value.getCollectFeeTransactionPayload(L);if(d.value==="Aptos")p=await O.value.currentWallet.signAndSubmitTransaction(z);else{const M=await O.value.currentWallet.signAndExecuteTransactionBlock(z);p=b.value.handleTx(M)}if(p){F(p.hash),J(!1),u(!0);const M={title:"Claim",desc:"",hash:p.hash,tit:"Fees Claimed",icon:"icon-icon-Removed",tokenInfo:{tokena:`${o.value.token_a.address}`,numa:Z(o.value.feeOwedA,o.value.token_a.decimals)==0?"":`${$e(o.value.feeOwedA,o.value.token_a.decimals)}`,logoa:Z(o.value.feeOwedA,o.value.token_a.decimals)==0?"":m.value.tokensObj&&o.value&&o.value.token_a.address&&m.value.tokensObj[o.value.token_a.address]&&m.value.tokensObj[o.value.token_a.address].logoURI,tokenb:`${o.value.token_b.address}`,numb:Z(o.value.feeOwedB,o.value.token_b.decimals)==0?"":`${$e(o.value.feeOwedB,o.value.token_b.decimals)}`,logob:Z(o.value.feeOwedB,o.value.token_b.decimals)==0?"":m.value.tokensObj&&o.value&&o.value.token_b.address&&m.value.tokensObj[o.value.token_b.address]&&m.value.tokensObj[o.value.token_b.address].logoURI},text:`Claim ${Z(o.value.feeOwedA,o.value.token_a.decimals)==0?"":`${$e(o.value.feeOwedA,o.value.token_a.decimals)} ${o.value.token_a.symbol}`}  
              ${Z(o.value.feeOwedA,o.value.token_a.decimals)==0||Z(o.value.feeOwedB,o.value.token_b.decimals)==0?"":"and"} ${Z(o.value.feeOwedB,o.value.token_b.decimals)==0?"":`${$e(o.value.feeOwedB,o.value.token_b.decimals)} ${o.value.token_b.symbol}`}

            `};d.value!=="Aptos"&&(M.res=p.res),b.value.showTransitionPending(M);const U=await b.value.watchTransaction(M);console.log("0310##toClaim###transitionStatus####",U),U&&setTimeout(()=>{t.emit("getDetails")},1e3)}else J(!1),te(!0),a.error({icon:Xe("svg",{class:{icon:!0},"aria-hidden":!0},[Xe("use",{"xlink:href":"#icon-a-icon-Shutdown"})]),duration:4.5,message:Xe("div",{class:"notification-title"},[Xe("span",{innerHTML:Po.global.t("newAdd.claimFailed")},null)]),description:s("newAdd.somethingWrong"),class:"ant-notification-copy ant-notification-error"});se.value=!1,console.log("claim####test###",p)}catch(z){console.log("claim###error####",z),se.value=!1,J(!1),te(!0),a.error({icon:Xe("svg",{class:{icon:!0},"aria-hidden":!0},[Xe("use",{"xlink:href":"#icon-a-icon-Shutdown"})]),message:Xe("div",{class:"notification-title"},[Xe("span",{innerHTML:Po.global.t("newAdd.claimFailed")},null)]),duration:4.5,description:s("newAdd.somethingWrong"),class:"ant-notification-copy ant-notification-error"})}},Be=Xe(sn,{style:{fontSize:"12px",color:"#fff",paddingBottom:"3px"},spin:!0});return{amountUSD:ne,needReverse:r,decimalUi:ge,pendingFees:T,positionInfo:o,pendingRewarderArr:_,pendingYieldAmount:i,toClaim:We,claimAll:q,fromCoin:l,toCoin:v,showNum:$e,claimLoading:se,addCommom:Z,afterBase:x,afterQuote:Q,fromCoinAmount:ke,toCoinAmount:W,checkNullObj:ce,getCoinIcon:he,chainName:d,isShowAfterAmount:we,pendingRewarderAmount:k,toClaimRewards:ie,rewarderLoading:D,indicator:Be}}});const Jt={class:"liquidity-card"},Yt={class:"liquidity-title"},Qt={class:"liquidity-usd"},Kt=n("span",null,"Liquidity",-1),Zt={class:"liquidity-ratio"},Vt={class:"coin-ratio"},xt={class:"coin-a-ratio"},ei={class:"coin-b-ratio"},oi={class:"ratio-progress"},ni={class:"base-quote-num"},ti={class:"base-coin-num"},ii=n("span",null,"Base",-1),si={alt:""},ai={key:0,class:"after"},li={class:"quote-coin-num"},ri=n("span",null,"Quote",-1),ui={alt:""},di={key:0,class:"after"},ci={class:"pending-yield"},mi={class:"left"},vi={class:"pending-yield-title"},fi={key:0,class:"after"},pi={class:"right"},hi={class:"fees-rewards"},gi={class:"fees-rewards-item"},ki=n("span",null,"Fees",-1),bi={key:0,class:"after"},wi=n("span",null,"Fees",-1),_i={key:0,class:"after"},yi=n("span",null,"Mining Rewards",-1),Ii={style:{"margin-top":"5px"}},Ai={alt:""},Ci=n("span",null,"Mining Rewards",-1),Si={alt:""},$i={key:0,class:"after"},Pi={key:0,class:"pending-yield"},Ti={class:"left"},Ni=n("div",{class:"pending-yield-title"},"Pending rewards",-1),Ri={key:0,class:"after"},Oi={class:"right"},qi={key:1,class:"fees-rewards"},Li={class:"fees-rewards-item"},Bi=n("span",null,"Mining Rewards",-1),Mi={alt:""},Ui={key:0,class:"after"};function ji(e,t,s,a,B,g){var v,d,b,G,se,oe,ne,r,f,T,i,k,A,_,u,te,J,ue,F,S,O,q,D,ie,V,x,Q,ke,W,he,we,We,Be,c,h,p,L,z,M,U,Y,ee,me,ve,Te,$,j,re,be,y,X,N,ae,pe,Ce,Ne,Ae,Se,Ue,je,ze,Re,Ee,De,Fe,Ke,_e;const R=mo,m=uo,o=an,l=Ao("image");return I(),P("div",Jt,[n("div",Yt,[n("div",Qt,[Kt,n("div",null,"$"+H(e.amountUSD),1)]),n("div",Zt,[n("div",Vt,[n("div",xt,[n("span",null,H(e.needReverse?(d=e.toCoin)==null?void 0:d.symbol:(v=e.fromCoin)==null?void 0:v.symbol),1),fe(" "+H(e.needReverse?(G=e.positionInfo)==null?void 0:G.toPercent:(b=e.positionInfo)==null?void 0:b.fromPercent)+"% ",1)]),n("div",ei,[n("span",null,H(e.needReverse?(oe=e.fromCoin)==null?void 0:oe.symbol:(se=e.toCoin)==null?void 0:se.symbol),1),fe(" "+H(e.needReverse?(r=e.positionInfo)==null?void 0:r.fromPercent:(ne=e.positionInfo)==null?void 0:ne.toPercent)+"% ",1)])]),n("div",oi,[n("div",{class:"from-percent",style:To({width:e.needReverse?((T=e.positionInfo)==null?void 0:T.toPercent)+"%":((f=e.positionInfo)==null?void 0:f.fromPercent)+"%"})},null,4),n("div",{class:"to-percent",style:To({width:e.needReverse?((k=e.positionInfo)==null?void 0:k.fromPercent)+"%":((i=e.positionInfo)==null?void 0:i.toPercent)+"%"})},null,4)])])]),n("div",ni,[n("div",ti,[ii,n("div",null,[Pe(n("img",si,null,512),[[l,(e.needReverse?(_=e.toCoin)==null?void 0:_.logo_url:(A=e.fromCoin)==null?void 0:A.logo_url)||e.getCoinIcon(e.needReverse?(te=e.positionInfo)==null?void 0:te.token_b:(u=e.positionInfo)==null?void 0:u.token_a)]]),le(R,{address:e.needReverse?(S=(F=e.positionInfo)==null?void 0:F.token_b)==null?void 0:S.address:(ue=(J=e.positionInfo)==null?void 0:J.token_a)==null?void 0:ue.address,"style-params":{width:"10px",height:"10px",left:"15px",bottom:"8px"}},null,8,["address"]),n("span",null,H(("addCommom"in e?e.addCommom:K(Z))(("decimalUi"in e?e.decimalUi:K(ge))(e.needReverse?(q=e.positionInfo)==null?void 0:q.amountB:(O=e.positionInfo)==null?void 0:O.amountA,e.needReverse?(x=(V=e.positionInfo)==null?void 0:V.token_b)==null?void 0:x.decimals:(ie=(D=e.positionInfo)==null?void 0:D.token_a)==null?void 0:ie.decimals))),1)]),e.afterBase&&!("checkNullObj"in e?e.checkNullObj:K(ce))(e.positionInfo)?(I(),P("div",ai,H(("addCommom"in e?e.addCommom:K(Z))(e.afterBase))+" after ",1)):de("",!0)]),n("div",li,[ri,n("div",null,[Pe(n("img",ui,null,512),[[l,(e.needReverse?(ke=e.fromCoin)==null?void 0:ke.logo_url:(Q=e.toCoin)==null?void 0:Q.logo_url)||e.getCoinIcon(e.needReverse?(he=e.positionInfo)==null?void 0:he.token_a:(W=e.positionInfo)==null?void 0:W.token_b)]]),le(R,{address:e.needReverse?(c=(Be=e.positionInfo)==null?void 0:Be.token_a)==null?void 0:c.address:(We=(we=e.positionInfo)==null?void 0:we.token_b)==null?void 0:We.address,"style-params":{width:"10px",height:"10px",left:"15px",bottom:"8px"}},null,8,["address"]),n("span",null,H(("addCommom"in e?e.addCommom:K(Z))(("decimalUi"in e?e.decimalUi:K(ge))(e.needReverse?(p=e.positionInfo)==null?void 0:p.amountA:(h=e.positionInfo)==null?void 0:h.amountB,e.needReverse?(U=(M=e.positionInfo)==null?void 0:M.token_a)==null?void 0:U.decimals:(z=(L=e.positionInfo)==null?void 0:L.token_b)==null?void 0:z.decimals))),1)]),e.afterQuote&&!("checkNullObj"in e?e.checkNullObj:K(ce))(e.positionInfo)?(I(),P("div",di,H(("addCommom"in e?e.addCommom:K(Z))(e.afterQuote))+" after ",1)):de("",!0)])]),n("div",ci,[n("div",mi,[n("div",vi,H(e.chainName=="Sui"?"Pending Yield":"Pending fees"),1),n("div",null,[fe(" $"+H(e.pendingYieldAmount>0&&e.pendingYieldAmount<.01?"<0.01":("addCommom"in e?e.addCommom:K(Z))(e.pendingYieldAmount,2))+" ",1),e.pendingYieldAmount>0?(I(),P("span",fi,"$0 after")):de("",!0)])]),n("div",pi,[le(m,{class:"claim-all",loading:e.claimLoading,disabled:e.claimLoading||e.pendingYieldAmount==0,onClick:t[0]||(t[0]=ye=>e.chainName=="Sui"?e.claimAll():e.toClaim())},{default:Le(()=>[fe("Claim")]),_:1},8,["loading","disabled"])])]),n("div",hi,[n("div",gi,[n("div",null,[ki,n("div",null,[Pe(n("img",null,null,512),[[l,(e.needReverse?(ee=e.toCoin)==null?void 0:ee.logo_url:(Y=e.fromCoin)==null?void 0:Y.logo_url)||e.getCoinIcon(e.needReverse?(ve=e.positionInfo)==null?void 0:ve.token_b:(me=e.positionInfo)==null?void 0:me.token_a)]]),le(R,{address:e.needReverse?(re=(j=e.positionInfo)==null?void 0:j.token_b)==null?void 0:re.address:($=(Te=e.positionInfo)==null?void 0:Te.token_a)==null?void 0:$.address,"style-params":{width:"10px",height:"10px",left:"15px",bottom:"8px"}},null,8,["address"]),n("span",null,H(e.needReverse?("showNum"in e?e.showNum:K($e))(e.positionInfo.feeOwedB,(N=(X=e.positionInfo)==null?void 0:X.token_b)==null?void 0:N.decimals):("showNum"in e?e.showNum:K($e))(e.positionInfo.feeOwedA,(y=(be=e.positionInfo)==null?void 0:be.token_a)==null?void 0:y.decimals)),1)]),(e.fromCoinAmount||e.toCoinAmount)&&!("checkNullObj"in e?e.checkNullObj:K(ce))(e.positionInfo)&&e.isShowAfterAmount?(I(),P("div",bi," 0 after ")):de("",!0)]),n("div",null,[wi,n("div",null,[Pe(n("img",null,null,512),[[l,(e.needReverse?(pe=e.fromCoin)==null?void 0:pe.logo_url:(ae=e.toCoin)==null?void 0:ae.logo_url)||e.getCoinIcon(e.needReverse?(Ne=e.positionInfo)==null?void 0:Ne.token_a:(Ce=e.positionInfo)==null?void 0:Ce.token_b)]]),le(R,{address:e.needReverse?(je=(Ue=e.positionInfo)==null?void 0:Ue.token_a)==null?void 0:je.address:(Se=(Ae=e.positionInfo)==null?void 0:Ae.token_b)==null?void 0:Se.address,"style-params":{width:"10px",height:"10px",left:"15px",bottom:"8px"}},null,8,["address"]),n("span",null,H(e.needReverse?("showNum"in e?e.showNum:K($e))(e.positionInfo.feeOwedA,(De=(Ee=e.positionInfo)==null?void 0:Ee.token_a)==null?void 0:De.decimals):("showNum"in e?e.showNum:K($e))(e.positionInfo.feeOwedB,(Re=(ze=e.positionInfo)==null?void 0:ze.token_b)==null?void 0:Re.decimals)),1)]),(e.fromCoinAmount||e.toCoinAmount)&&!("checkNullObj"in e?e.checkNullObj:K(ce))(e.positionInfo)&&e.isShowAfterAmount?(I(),P("div",_i," 0 after ")):de("",!0)]),e.chainName=="Sui"?(I(),P(Ve,{key:0},[e.pendingRewarderArr.length==0&&((_e=(Ke=(Fe=e.positionInfo)==null?void 0:Fe.poolInfo)==null?void 0:Ke.rewarderInfo)==null?void 0:_e.length)>0?(I(!0),P(Ve,{key:0},oo(e.positionInfo.poolInfo.rewarderInfo,ye=>(I(),P("div",{key:ye.coinAddress},[yi,n("div",Ii,[Pe(n("img",Ai,null,512),[[l,e.getCoinIcon({address:ye.coinAddress})]]),le(R,{address:ye.coinAddress,"style-params":{width:"10px",height:"10px",left:"15px",bottom:"8px"}},null,8,["address"]),le(o,{class:"upgrade-text-skeleton",loading:!0,active:"",paragraph:!1})])]))),128)):de("",!0),(I(!0),P(Ve,null,oo(e.pendingRewarderArr,ye=>(I(),P("div",{key:ye},[Ci,n("div",null,[Pe(n("img",Si,null,512),[[l,ye.logo_url]]),le(R,{address:ye.address,"style-params":{width:"10px",height:"10px",left:"15px",bottom:"8px"}},null,8,["address"]),n("span",null,H(ye.amount),1)]),(e.fromCoinAmount||e.toCoinAmount)&&!("checkNullObj"in e?e.checkNullObj:K(ce))(e.positionInfo)&&e.isShowAfterAmount?(I(),P("div",$i," 0 after ")):de("",!0)]))),128))],64)):de("",!0)])]),e.chainName=="Aptos"&&e.pendingRewarderAmount>0?(I(),P("div",Pi,[n("div",Ti,[Ni,n("div",null,[fe(" $"+H(e.pendingRewarderAmount>0&&e.pendingRewarderAmount<.01?"<0.01":("addCommom"in e?e.addCommom:K(Z))(e.pendingRewarderAmount,2))+" ",1),e.pendingRewarderAmount>0?(I(),P("span",Ri,"$0 after")):de("",!0)])]),n("div",Oi,[le(m,{class:"claim-all",loading:e.rewarderLoading,disabled:e.rewarderLoading||e.pendingRewarderAmount==0,onClick:e.toClaimRewards},{default:Le(()=>[fe("Claim")]),_:1},8,["loading","disabled","onClick"])])])):de("",!0),e.chainName=="Aptos"&&e.pendingRewarderAmount>0?(I(),P("div",qi,[n("div",Li,[(I(!0),P(Ve,null,oo(e.pendingRewarderArr,ye=>(I(),P("div",{key:ye},[Bi,n("div",null,[Pe(n("img",Mi,null,512),[[l,ye.logo_url]]),le(R,{address:ye.address,"style-params":{width:"10px",height:"10px",left:"15px",bottom:"8px"}},null,8,["address"]),n("span",null,H(ye.amount),1)]),(e.fromCoinAmount||e.toCoinAmount)&&!("checkNullObj"in e?e.checkNullObj:K(ce))(e.positionInfo)&&e.isShowAfterAmount?(I(),P("div",Ui," 0 after ")):de("",!0)]))),128))])])):de("",!0)])}const zo=Qe(zt,[["render",ji]]),Ei=Ye({components:{AssetsCard:ho},setup(e,t){const s=E(""),a=E(""),B=Je(),g=C(()=>B),R=C(()=>g.value.theme),m=io(),o=C(()=>m),l=E(!1),v=E(!1),d=E(!0),b=C(()=>g.value.chainName),G=C(()=>b.value?to(b.value):{}),se=lo(),oe=C(()=>se),ne=C(()=>g.value.slippage),r=E(),f=E(),T=C(()=>oe.value.assets&&r.value&&oe.value.assets[r.value.address]?So(oe.value.assets[r.value.address].balance,r.value.decimals):0),i=C(()=>oe.value.assets&&f.value&&oe.value.assets[f.value.address]?So(oe.value.assets[f.value.address].balance,f.value.decimals):0),k=p=>{p==="fromCoin"?(d.value=!0,b.value==="Aptos"?s.value=T.value>0?r.value.symbol=="APT"?new w(Number(T.value)).sub(new w(.1)).lt(new w(0))?"0":new w(Number(T.value)).sub(new w(.1)).toString():String(T.value):"":s.value=T.value>0?r.value.symbol=="SUI"?new w(Number(T.value)).sub(new w(.05)).lt(new w(0))?"0":new w(Number(T.value)).sub(new w(.05)).toString():String(T.value):""):(d.value=!1,b.value==="Aptos"?a.value=i.value>0?f.value.symbol=="APT"?new w(Number(i.value)).sub(new w(.1)).lt(new w(0))?"0":new w(Number(i.value)).sub(new w(.1)).toString():String(i.value):"":a.value=i.value>0?f.value.symbol=="SUI"?new w(Number(i.value)).sub(new w(.05)).lt(new w(0))?"0":new w(Number(i.value)).sub(new w(.05)).toString():String(i.value):"")},A=p=>{p==="fromCoin"?(d.value=!0,s.value=Me(new w(Number(T.value)).div(2).toString(),r.value.decimals).toString()):(d.value=!1,a.value=Me(new w(Number(i.value)).div(2).toString(),f.value.decimals).toString())},_=E({}),u=E(!0),te=E({}),J=E(),ue=E(),F=()=>{var j;if(!_.value||!s.value&&!a.value)return;const{TickMath:p,TickUtil:L}=G.value;console.log(s.value,a.value,"====>369"),console.log(_.value,"===>positionInfo.value339");let z=_.value.minPrice,M=_.value.maxPrice.indexOf("+")>0?"∞":_.value.maxPrice;console.log(_.value,"positionInfo.value====>");let U=Number(_.value.tick_lower_index),Y=Number(_.value.tick_upper_index);const ee=Number(_.value.current_tick_index);let me,ve,Te=Number(z).toString(),$=_.value.maxPrice.indexOf("+")>0||_.value.maxPrice==="∞"?"∞":Number(M);if(Te=="0"&&$=="∞"?(U=Number(_.value.tick_lower_index),Y=Number(_.value.tick_upper_index)):(me=p.priceToSqrtPriceX64(new w(z),r.value.decimals,f.value.decimals),ve=p.priceToSqrtPriceX64(new w(M),r.value.decimals,f.value.decimals)),J.value=U,ue.value=Y,console.log(U,Y,"tick_lowertick_lower"),M!=="∞"&&U>=Y){l.value=!0,s.value="",v.value=!0,a.value="";return}if(M=="∞"||ee>=U&&ee<=Y){console.log("0413###increase###11111"),l.value=!1,v.value=!1;let re;if(s.value||a.value){if(d.value){const pe=new w(s.value).mul(Math.pow(10,r.value.decimals)).toString();re=new Oe(pe)}else{const pe=new w(a.value).mul(Math.pow(10,f.value.decimals)).toString();re=new Oe(pe)}const{liquidityAmount:be,tokenMaxA:y,tokenMaxB:X,tokenMaxAOrigin:N,tokenMaxBOrigin:ae}=G.value.estLiquidityAndcoinAmountFromOneAmounts({tokenA:r.value,tokenB:f.value,lowerTick:U,upperTick:Y,coinAmount:re,iscoinA:u.value?d.value:!d.value,roundUp:!0,slippage:Number(ne.value)/100,curSqrtPrice:new Oe(_.value.current_sqrt_price)});te.value={liquidityAmount:be,tokenMaxA:y,tokenMaxB:X,tokenMaxAOrigin:N,tokenMaxBOrigin:ae},u.value?d.value?a.value=Number(X)>0?X:"":s.value=Number(y)>0?y:"":d.value?a.value=y:s.value=X}}else if(ee>Y){if(console.log("0413###increase###22222"),s.value="",l.value=!0,v.value=!1,s.value||a.value){let re;const be=new w(a.value).mul(Math.pow(10,(j=f.value)==null?void 0:j.decimals)).toString();re=new Oe(be),te.value={liquidityAmount:Lo(me,ve,re),tokenMaxA:0,tokenMaxB:a.value}}}else if(ee<U){if(console.log("0413###increase###33333"),l.value=!1,v.value=!0,a.value="",s.value||a.value){let re;const be=new w(s.value).mul(Math.pow(10,r.value.decimals)).toString();re=new Oe(be),te.value={liquidityAmount:Bo(me,ve,re),tokenMaxA:s.value,tokenMaxB:0}}}else console.log("0413###increase###4444"),l.value=!0,s.value="",v.value=!0,a.value="";m.setPositionActionAmount({fromCoinAmount:s,toCoinAmount:a}),console.log(te.value.liquidityAmount,"====>liquidityInput.value.liquidityAmount")};Ie(()=>o.value.currentPositionInfo,p=>{if(p&&!ce(p)){_.value=p,console.log(p,"newVal===>"),r.value=_.value.token_a,f.value=_.value.token_b;let L=Number(_.value.tick_lower_index),z=Number(_.value.tick_upper_index);const M=Number(_.value.current_tick_index);(p.maxPrice.indexOf("+")>0||p.maxPrice==="∞"?"∞":p.maxPrice)=="∞"||M>=L&&M<=z?(l.value=!1,v.value=!1):M>z?(s.value="",l.value=!0,v.value=!1):M<L?(l.value=!1,v.value=!0,a.value=""):(l.value=!0,s.value="",v.value=!0,a.value=""),F()}},{immediate:!0}),Ie(s,(p,L)=>{p&&F(),p==""&&(a.value="")}),Ie(a,(p,L)=>{p&&F(),p==""&&(s.value="")});const S=C(()=>{var p,L,z,M;return console.log((L=(p=_.value)==null?void 0:p.poolInfo)==null?void 0:L.needReverse,"===>positionInfo.value?.poolInfo?.needReverse"),(M=(z=_.value)==null?void 0:z.poolInfo)==null?void 0:M.needReverse}),O=C(()=>o.value.RATES),q=C(()=>{var Y,ee,me,ve;const p=((ee=O.value[(Y=r.value)==null?void 0:Y.address])==null?void 0:ee.price)||0,L=((ve=O.value[(me=f.value)==null?void 0:me.address])==null?void 0:ve.price)||0,z=new w(p).mul(new w(s.value||0)),M=new w(L).mul(new w(a.value||0)),U=z.add(M);return console.log(p,L,z.toString(),M.toString(),"====>amount"),U.toNumber()?U.toNumber()>0&&U.toNumber()>.01?Z(U.toString(),2):"<0.01":"--"}),D=E(!1),{t:ie,locale:V}=Co(),x=C(()=>{const p=Number(s.value)>Number(T.value),L=Number(a.value)>Number(i.value);return!s.value&&!a.value?ie("button.enterAmount"):p?ie("button.insufficientBalance",{name:r.value.symbol}):L?ie("button.insufficientBalance",{name:f.value.symbol}):ie("newAdd.addMore")}),Q=C(()=>{const p=Number(s.value)>Number(T.value),L=Number(a.value)>Number(i.value);return!!(!s.value&&!a.value||p||L)}),{setIsShowSuccess:ke,setIsShowRejected:W,setIsShowWaiting:he,setTransactionDesc:we,setTransactionTxid:We,setPositiomNum:Be}=B,c=E(!1);return{theme:R,showFromCoinLock:l,showToCoinLock:v,toCoinAmount:a,fromCoinAmount:s,fromCoinBlance:T,toCoinBlance:i,fromCoin:r,toCoin:f,maxBtnSelect:k,halfBtnSelect:A,fixedFromCoin:d,needReverse:S,totalAmount:q,wallet:oe,addLiquidityBtnText:x,isShowLiquidityModal:D,indexStore:B,positionInfo:_,actionLoading:c,toAdd:async()=>{var Y,ee,me,ve,Te,$,j,re,be,y;D.value=!1,c.value=!0,We("");const p=l.value?"":`${s.value} ${(Y=r.value)==null?void 0:Y.symbol}`,L=v.value?"":`${a.value} ${(ee=f.value)==null?void 0:ee.symbol}`;we(ie("tips.increaseLiquiditySuccess",{from:S.value?L:p,and:!l.value&&!v.value?"and":"",to:S.value?p:L})),he(!0);const z=d.value;console.log(z,"===>fix_amount_a"),console.log(J.value,"tickLower.value===>"),console.log(ue.value,"tickUpper.value,===>"),console.log("0222###increase###positionInfo###",_);const M=_.value.poolInfo.rewarder_infos;let U={};U.coinTypeC=M[0]?M[0].coinAddress:"",U.coinTypeD=M[1]?M[1].coinAddress:"",U.coinTypeE=M[2]?M[2].coinAddress:"",console.log("0103 toAdd positionInfo: ",_),console.log("0103 toAdd liquidityInput: ",te);try{const X=await G.value.getAddLiquidityTransactionPayload({pool:{poolAddress:_.value.poolAddress,token_a:_.value.token_a,token_b:_.value.token_b},amount:z?te.value.tokenMaxA:te.value.tokenMaxB,fix_amount_a:z,tick_lower:J.value,tick_upper:ue.value,index:b.value==="Aptos"?_.value.index:_.value.pos_object_id,slippage:Number(ne.value)/100,roundUp:!0,collect_fee:!0,...U,curSqrtPrice:new Oe(_==null?void 0:_.value.poolInfo.current_sqrt_price),positionInfo:_});console.log(X,"===>payloadAdd11111");let N;if(b.value==="Aptos")N=await oe.value.currentWallet.signAndSubmitTransaction(X);else{const ae=await oe.value.currentWallet.signAndExecuteTransactionBlock(X);N=G.value.handleTx(ae)}if(console.log("toAdd###tx###",N),N&&N.hash){We(N.hash),he(!1),ke(!0),console.log(_,"===>positionInfo");const ae={title:"Supplied",desc:ie("tips.addLiquiditySuccessText",{from:l.value?"":`${s.value} ${(me=r.value)==null?void 0:me.symbol}`,and:!l.value&&!v.value?"and":"",to:v.value?"":`${a.value} ${(ve=f.value)==null?void 0:ve.symbol}`}),hash:N.hash,tit:"Liquidity Increased",icon:"icon-icon-Increased",tokenInfo:{tokena:S.value?`${($=f.value)==null?void 0:$.address}`:`${(Te=r.value)==null?void 0:Te.address}`,numa:S.value?`- ${a.value}`:`- ${s.value}`,logoa:S.value?o.value.tokensObj&&f.value&&f.value.address&&o.value.tokensObj[f.value.address]&&o.value.tokensObj[f.value.address].logoURI:o.value.tokensObj&&r.value&&r.value.address&&o.value.tokensObj[r.value.address]&&o.value.tokensObj[r.value.address].logoURI,tokenb:S.value?`${(re=r.value)==null?void 0:re.address}`:`${(j=f.value)==null?void 0:j.address}`,numb:S.value?`- ${s.value}`:`- ${a.value}`,logob:S.value?o.value.tokensObj&&r.value&&r.value.address&&o.value.tokensObj[r.value.address]&&o.value.tokensObj[r.value.address].logoURI:o.value.tokensObj&&f.value&&f.value.address&&o.value.tokensObj[f.value.address]&&o.value.tokensObj[f.value.address].logoURI},text:`Deopsit ${l.value?"":`${s.value} ${(be=r.value)==null?void 0:be.symbol}`} ${!l.value&&!v.value?"and":""} ${v.value?"":`${a.value} ${(y=f.value)==null?void 0:y.symbol}`}`};b.value!=="Aptos"&&(ae.res=N.res),G.value.showTransitionPending(ae),await G.value.watchTransaction(ae)&&setTimeout(()=>{t.emit("getDetails"),G.value.getAccount(oe.value.address)},1e3),Be()}else he(!1),W(!0);s.value="",a.value="",c.value=!1}catch(X){s.value="",a.value="",console.log("addError###",X),c.value=!1,he(!1),W(!0)}},addLiquidityBtnDisabled:Q,poolStore:m}}});const Di={class:"new-position-asset"},Fi={class:"add-or-remove"},Wi={class:"liquidity-action-tab"},Hi=n("div",{class:"increase tab-active"}," Increase ",-1),Xi={class:"card-item"},Gi={class:"card-item"},zi={key:0,class:"add",src:pn},Ji={key:1,class:"add",src:hn},Yi={class:"total-amount"},Qi=n("span",null,"Total Amount",-1);function Ki(e,t,s,a,B,g){var v;const R=ho,m=vn,o=uo,l=fn;return I(),P("div",Di,[n("div",Fi,[n("div",Wi,[Hi,n("div",{class:"remove",onClick:t[0]||(t[0]=d=>e.poolStore.setPositionDetailCurrentTab("remove"))}," Remove ")]),n("div",{class:wo(e.needReverse?"card-container reverse":"card-container")},[n("div",Xi,[le(R,{modelValue:e.fromCoinAmount,"onUpdate:modelValue":t[1]||(t[1]=d=>e.fromCoinAmount=d),"input-value":e.fromCoinAmount,"coin-symbol":e.fromCoin?e.fromCoin.symbol:null,"coin-name":e.fromCoin?e.fromCoin.name:null,balance:e.fromCoinBlance,"coin-icon":e.fromCoin?e.fromCoin.logoURI:"",address:e.fromCoin?e.fromCoin.address:"","swap-direct":"From","import-page":"deposit","has-arrow":!1,onOnMax:t[2]||(t[2]=d=>e.maxBtnSelect("fromCoin")),onOnHalf:t[3]||(t[3]=d=>e.halfBtnSelect("fromCoin")),onOnInput:t[4]||(t[4]=d=>{e.fromCoinAmount=d}),onOnFocus:t[5]||(t[5]=()=>{e.fixedFromCoin=!0})},null,8,["modelValue","input-value","coin-symbol","coin-name","balance","coin-icon","address"]),e.showFromCoinLock?(I(),qe(m,{key:0,"from-coin":e.fromCoin,"to-coin":e.toCoin},null,8,["from-coin","to-coin"])):de("",!0)]),n("div",Gi,[le(R,{modelValue:e.toCoinAmount,"onUpdate:modelValue":t[6]||(t[6]=d=>e.toCoinAmount=d),"input-value":e.toCoinAmount,"coin-symbol":e.toCoin?e.toCoin.symbol:null,"coin-name":e.toCoin?e.toCoin.name:null,balance:e.toCoinBlance,"swap-direct":"To","coin-icon":e.toCoin?e.toCoin.logoURI:"",address:e.toCoin?e.toCoin.address:"","import-page":"deposit","has-arrow":!1,onOnMax:t[7]||(t[7]=d=>e.maxBtnSelect("toCoin")),onOnHalf:t[8]||(t[8]=d=>e.halfBtnSelect("toCoin")),onOnInput:t[9]||(t[9]=d=>{e.toCoinAmount=d}),onOnFocus:t[10]||(t[10]=()=>{e.fixedFromCoin=!1})},null,8,["modelValue","input-value","coin-symbol","coin-name","balance","coin-icon","address"]),e.showToCoinLock?(I(),qe(m,{key:0,"from-coin":e.fromCoin,"to-coin":e.toCoin},null,8,["from-coin","to-coin"])):de("",!0)]),e.fromCoin&&e.toCoin&&!e.showToCoinLock&&!e.showFromCoinLock&&e.theme=="default"?(I(),P("img",zi)):de("",!0),e.fromCoin&&e.toCoin&&!e.showToCoinLock&&!e.showFromCoinLock&&e.theme!=="default"?(I(),P("img",Ji)):de("",!0)],2),n("div",Yi,[Qi,n("span",null,"$"+H(e.totalAmount),1)])]),e.wallet.connected?(I(),qe(o,{key:0,class:"big-btn liquidity-btn",disabled:e.addLiquidityBtnDisabled,loading:e.actionLoading,onClick:t[11]||(t[11]=d=>e.isShowLiquidityModal=!0)},{default:Le(()=>[n("span",null,H(e.addLiquidityBtnText),1)]),_:1},8,["disabled","loading"])):(I(),qe(o,{key:1,class:"big-btn",onClick:t[12]||(t[12]=d=>e.wallet.connected?e.isShowLiquidityModal=!0:e.wallet.setIsShowWalletModal(!0))},{default:Le(()=>[n("span",null,H(e.$t("button.connectWallet")),1)]),_:1})),e.isShowLiquidityModal?(I(),qe(l,{key:2,title:e.$t("button.increase"),"is-increase":!0,"from-coin":e.needReverse?e.toCoin:e.fromCoin,"to-coin":e.needReverse?e.fromCoin:e.toCoin,"from-coin-amount":e.needReverse?e.toCoinAmount:e.fromCoinAmount,"to-coin-amount":e.needReverse?e.fromCoinAmount:e.toCoinAmount,"min-price":e.positionInfo.minPrice,"max-price":e.positionInfo.maxPrice,"current-price":e.positionInfo.currentPrice,"current-price-reverse":1/e.positionInfo.currentPrice,"pool-info":(v=e.positionInfo)==null?void 0:v.poolInfo,"show-from-coin-lock":e.showFromCoinLock,"show-to-coin-lock":e.showToCoinLock,"position-total-amount":e.positionInfo.totalAmountUSD,"fixed-from-coin":!0,"tick-lower":e.positionInfo.tick_lower_index,"tick-upper":e.positionInfo.tick_upper_index,"current-price-tab":"custom",onToAdd:e.toAdd,onOnClose:t[13]||(t[13]=d=>e.isShowLiquidityModal=!1)},null,8,["title","from-coin","to-coin","from-coin-amount","to-coin-amount","min-price","max-price","current-price","current-price-reverse","pool-info","show-from-coin-lock","show-to-coin-lock","position-total-amount","tick-lower","tick-upper","onToAdd"])):de("",!0)])}const Io=Qe(Ei,[["render",Ki]]),Zi=Ye({components:{AssetsCard:ho},setup(e,t){const s=E(""),a=E(""),B=Je(),g=C(()=>B),R=C(()=>g.value.theme),m=io(),o=C(()=>m),l=E(!1),v=E(!1),d=E(!0),b=C(()=>g.value.chainName),G=C(()=>b.value?to(b.value):{}),se=lo(),oe=C(()=>se),ne=C(()=>g.value.slippage),r=E(),f=E(),T=C(()=>{var y,X;return(X=(y=u.value)==null?void 0:y.poolInfo)==null?void 0:X.needReverse}),i=C(()=>{var y;return console.log(u==null?void 0:u.value,"==>positionInfo?.value"),console.log(!T.value,"===>!needReverse.value"),ge(u==null?void 0:u.value.amountA,(y=u==null?void 0:u.value.token_a)==null?void 0:y.decimals)}),k=C(()=>{var y;return ge(u==null?void 0:u.value.amountB,(y=u==null?void 0:u.value.token_b)==null?void 0:y.decimals)}),A=y=>{y==="fromCoin"?d.value=!0:d.value=!1,q.value=100,ie({value:1})},_=y=>{y==="fromCoin"?(d.value=!0,s.value=Me(new w(Number(i.value)).div(2).toString(),r.value.decimals).toString()):(d.value=!1,a.value=Me(new w(Number(k.value)).div(2).toString(),f.value.decimals).toString()),S.value=!1},u=E({}),te=E(!0),J=E({}),ue=E(),F=E(),S=E(!0),O=()=>{var ze;if(S.value||!u.value||!s.value&&!a.value||(console.log(s.value>i.value,Number(a.value)>Number(k.value),"==>toCoinAmount.value"),Number(s.value)>Number(i.value)||Number(a.value)>Number(k.value)))return;if(s.value==i.value&&a.value==k.value){q.value=100,ie({value:1}),S.value=!0;return}const{TickMath:y,TickUtil:X}=G.value;console.log(s.value,a.value,"====>369"),console.log(u.value,"===>positionInfo.value339");let N=u.value.minPrice,ae=u.value.maxPrice.indexOf("+")>0?"∞":u.value.maxPrice;console.log(u.value,"positionInfo.value====>");let pe=Number(u.value.tick_lower_index),Ce=Number(u.value.tick_upper_index);const Ne=Number(u.value.current_tick_index);let Ae,Se,Ue=Number(N).toString(),je=u.value.maxPrice.indexOf("+")>0||u.value.maxPrice==="∞"?"∞":Number(ae);if(Ue=="0"&&je=="∞"?(pe=Number(u.value.tick_lower_index),Ce=Number(u.value.tick_upper_index)):(Ae=y.priceToSqrtPriceX64(new w(N),r.value.decimals,f.value.decimals),Se=y.priceToSqrtPriceX64(new w(ae),r.value.decimals,f.value.decimals)),ue.value=pe,F.value=Ce,console.log(pe,Ce,"tick_lowertick_lower"),ae!=="∞"&&pe>=Ce){l.value=!0,s.value="",v.value=!0,a.value="";return}if(ae=="∞"||Ne>=pe&&Ne<=Ce){console.log("0413###increase###11111"),console.log(s.value,"==>341"),console.log(a.value,"==>341"),l.value=!1,v.value=!1;let Re;if(s.value||a.value){if(d.value){const ye=new w(s.value).mul(Math.pow(10,r.value.decimals)).toString();Re=new Oe(ye)}else{const ye=new w(a.value).mul(Math.pow(10,f.value.decimals)).toString();Re=new Oe(ye)}const{liquidityAmount:Ee,tokenMaxA:De,tokenMaxB:Fe,tokenMaxAOrigin:Ke,tokenMaxBOrigin:_e}=G.value.estLiquidityAndcoinAmountFromOneAmounts({tokenA:r.value,tokenB:f.value,lowerTick:pe,upperTick:Ce,coinAmount:Re,iscoinA:te.value?d.value:!d.value,roundUp:b.value!="Sui",slippage:Number(ne.value)/100,curSqrtPrice:new Oe(u.value.current_sqrt_price)});J.value={liquidityAmount:Ee,tokenMaxA:De,tokenMaxB:Fe,tokenMaxAOrigin:Ke,tokenMaxBOrigin:_e},console.log(Fe,De,"362===>"),te.value?d.value?a.value=Number(Fe)>0?Fe:"":s.value=Number(De)>0?De:"":d.value?a.value=De:s.value=Fe}}else if(Ne>Ce){if(console.log("0413###increase###22222"),s.value="",l.value=!0,v.value=!1,s.value||a.value){let Re;const Ee=new w(a.value).mul(Math.pow(10,(ze=f.value)==null?void 0:ze.decimals)).toString();Re=new Oe(Ee),J.value={liquidityAmount:Lo(Ae,Se,Re),tokenMaxA:0,tokenMaxB:a.value}}}else if(Ne<pe){if(console.log("0413###increase###33333"),l.value=!1,v.value=!0,a.value="",s.value||a.value){let Re;const Ee=new w(s.value).mul(Math.pow(10,r.value.decimals)).toString();Re=new Oe(Ee),J.value={liquidityAmount:Bo(Ae,Se,Re),tokenMaxA:s.value,tokenMaxB:0}}}else console.log("0413###increase###4444"),l.value=!0,v.value=!0;S.value=!1,q.value=new w(J.value.liquidityAmount.toString()).div(u.value.liquidity).mul(100).toNumber().toFixed(2),D.value=J.value.liquidityAmount,console.log(q.value,"===>sliderVal.value"),console.log(J.value.liquidityAmount,"====>liquidityInput.value.liquidityAmount"),m.setPositionActionAmount({fromCoinAmount:s,toCoinAmount:a}),console.log(q.value,"===>sliderVal.value")},q=E(50),D=E("0"),ie=y=>{if(!S.value)return;S.value=!0;const X=u.value.token_a.decimals,N=u.value.token_b.decimals,ae=u.value.tick_lower_index,pe=u.value.tick_upper_index,Ce=$o.tickIndexToSqrtPriceX64(ae),Ne=$o.tickIndexToSqrtPriceX64(pe);let Ae="";y.value!==1?Ae=new w(u.value.liquidity).mul(y.value).toString():Ae=u.value.liquidity,Ae=Me(Ae,0)||"0",D.value=Ae;const Se=Zo.getCoinAmountFromLiquidity(new Oe(Ae),new Oe(u.value.current_sqrt_price),Ce,Ne,b.value!="Sui");console.log(Se.coinA.toString(),Se.coinB.toString(),X,N,"===>amountInfo");const Ue=new w(Se.coinA.toString()).div(Math.pow(10,X)).toString(),je=new w(Se.coinB.toString()).div(Math.pow(10,N)).toString();console.log(Ue,je,"amountA121212"),s.value=Number(Ue)>0?Ue:"",a.value=Number(je)>0?je:"",m.setPositionActionAmount({fromCoinAmount:s,toCoinAmount:a})};Ie(()=>o.value.currentPositionInfo,y=>{if(y&&!ce(y)){u.value=y,console.log(y,"newVal===>"),r.value=u.value.token_a,f.value=u.value.token_b,ie({value:q.value/100});let X=Number(u.value.tick_lower_index),N=Number(u.value.tick_upper_index);const ae=Number(u.value.current_tick_index);(y.maxPrice.indexOf("+")>0||y.maxPrice==="∞"?"∞":y.maxPrice)=="∞"||ae>=X&&ae<=N?(l.value=!1,v.value=!1):ae>N?(s.value="",l.value=!0,v.value=!1):ae<X?(l.value=!1,v.value=!0,a.value=""):(l.value=!0,s.value="",v.value=!0,a.value=""),O()}},{immediate:!0}),Ie(s,(y,X)=>{y&&O(),y==""&&(a.value="",q.value=0)}),Ie(a,(y,X)=>{y&&O(),y==""&&(s.value="",q.value=0)});const V=C(()=>o.value.RATES),x=C(()=>{var Ce,Ne,Ae,Se;const y=((Ne=V.value[(Ce=r.value)==null?void 0:Ce.address])==null?void 0:Ne.price)||0,X=((Se=V.value[(Ae=f.value)==null?void 0:Ae.address])==null?void 0:Se.price)||0,N=new w(y).mul(new w(s.value||0)),ae=new w(X).mul(new w(a.value||0)),pe=N.add(ae);return console.log(y,X,N.toString(),ae.toString(),"====>amount"),Z(pe.toString(),2)}),Q=E(!1),{t:ke,locale:W}=Co(),he=C(()=>{const y=Number(s.value)>Number(i.value),X=Number(a.value)>Number(k.value);return!s.value&&!a.value?ke("button.enterAmount"):y||X?"Invalid Amount":ke("button.remove")}),we=C(()=>{const y=Number(s.value)>Number(i.value),X=Number(a.value)>Number(k.value);return!!(!s.value&&!a.value||y||X)}),{setIsShowSuccess:We,setIsShowRejected:Be,setIsShowWaiting:c,setTransactionDesc:h,setTransactionTxid:p,setPositiomNum:L,setTransactionDescText:z}=B,M=E(!1);Ie(q,ln((y,X)=>{y!==X&&(Number(y)>100?q.value=100:y&&u.value?(console.log("687===>"),q.value=y,ie({value:q.value/100})):(s.value="",a.value=""))},300)),Ie(ne,y=>{y&&u.value&&ie({value:q.value/100})});const U=[{name:"25%",value:25},{name:"50%",value:50},{name:"75%",value:75},{name:"MAX",value:100}],Y=Eo(),ee=C(()=>Y),me=C(()=>ee.value.status),ve=E(!1),Te=y=>{const X=y.sources;X.forEach(N=>{const{pool_address:ae,position_index:pe}=JSON.parse(N.blockchainAddress);console.log(ae,pe,"===>pool_address, position_index"),console.log(u.value.poolAddress,u.value.index,"===>positionInfo.value.index"),ae==u.value.poolAddress&&Number(pe)==Number(u.value.index)&&(ve.value=!0)}),console.log(X,"===>sources")},$=async()=>{await Y.getSources();let y;ee.value.allSources.forEach(X=>{const{pool_address:N,position_index:ae}=JSON.parse(X.blockchainAddress);N==u.value.poolAddress&&ae==u.value.index&&(y=X.id)}),console.log(y,"sourceID649==>"),Y.deleteSource(y)};Ie(()=>[ee.value.sourceGroups,u.value],([y,X])=>{y&&y.sources&&y.sources.length>0&&X&&!ce(X)&&Te(y)},{immediate:!0,deep:!0});const j=ro(),re=po();return{theme:R,showFromCoinLock:l,showToCoinLock:v,toCoinAmount:a,fromCoinAmount:s,fromCoinBlance:i,toCoinBlance:k,fromCoin:r,toCoin:f,maxBtnSelect:A,halfBtnSelect:_,fixedFromCoin:d,needReverse:T,totalAmount:x,wallet:oe,addLiquidityBtnText:he,isShowLiquidityModal:Q,indexStore:B,positionInfo:u,actionLoading:M,addLiquidityBtnDisabled:we,sliderVal:q,ratioArr:U,setPercent:ie,poolStore:m,isSlider:S,toRemove:async()=>{var pe,Ce,Ne,Ae,Se,Ue,je,ze,Re,Ee,De,Fe,Ke;M.value=!0,p("");const y=Z(s.value,r.value.decimals)==0?"":`${ge(s.value,r.value.decimals)} ${r.value.symbol}`,X=Z(a.value,f.value.decimals)==0?"":`${ge(a.value,f.value.decimals)} ${f.value.symbol}`;h(ke("tips.removeLiquidiyText",{from:T.value?X:y,and:Z(s.value,r.value.decimals)==0||Z(a.value,f.value.decimals)==0?"":"and",to:T.value?y:X})),c(!0),console.log(u.value,"==>positionInfo.value");const N=u.value.poolInfo.rewarder_infos,ae=N&&N.length>0&&b.value=="Sui"||N&&N.length>0&&q.value==100?ke("modal.removeLiquidityText1"):ke("modal.removeLiquidityText2");z(ae);try{let _e={};_e={pool:{...u.value.poolInfo,coinA:u.value.token_a,coinB:u.value.token_b},coinTypeA:u.value.poolInfo.coinTypeA,coinTypeB:u.value.poolInfo.coinTypeB,position:u.value,delta_liquidity:q.value==100?new Oe(u.value.liquidity):new Oe(Me(D.value,0)),slippage:Number(ne.value),rewards_num:N.length,positionInfo:u.value},console.log(N,"===>pendingRewarderArr"),_e.coinTypeC=N[0]?N[0].coinAddress:"",_e.coinTypeD=N[1]?N[1].coinAddress:"",_e.coinTypeE=N[2]?N[2].coinAddress:"",console.log(_e,q.value,_e.delta_liquidity.toString(),"===>params");const ye=await G.value.getRemoveLiquidityTransactionPayload(_e);console.log(ye,"===>payload");let He;if(b.value==="Aptos")He=await oe.value.currentWallet.signAndSubmitTransaction(ye);else{const so=await oe.value.currentWallet.signAndExecuteTransactionBlock(ye);He=G.value.handleTx(so),console.log("0331###remove###tx####",He)}if(He&&He.hash){p(He.hash),c(!1),We(!0);const so={title:ke("common.removeLiquidity"),desc:"",hash:He.hash,descTransactions:`Remove ${s.value} ${(pe=r.value)==null?void 0:pe.symbol} and ${a.value} ${(Ce=f.value)==null?void 0:Ce.symbol} 
             from the pool`,sender:oe.value.address,chainName:b.value,tit:"Liquidity Removed",icon:"icon-icon-Removed",tokenInfo:{tokena:T.value?`${(Ae=f.value)==null?void 0:Ae.address}`:`${(Ne=r.value)==null?void 0:Ne.address}`,numa:T.value?`+ ${a.value}`:`+ ${s.value}`,logoa:T.value?o.value.tokensObj&&f.value&&f.value.address&&o.value.tokensObj[f.value.address]&&o.value.tokensObj[f.value.address].logoURI:o.value.tokensObj&&r.value&&r.value.address&&o.value.tokensObj[r.value.address]&&o.value.tokensObj[r.value.address].logoURI,tokenb:T.value?`${(Se=r.value)==null?void 0:Se.address}`:`${(Ue=f.value)==null?void 0:Ue.address}`,numb:T.value?`+ ${s.value}`:`+ ${a.value}`,logob:T.value?o.value.tokensObj&&r.value&&r.value.address&&o.value.tokensObj[r.value.address]&&o.value.tokensObj[r.value.address].logoURI:o.value.tokensObj&&f.value&&f.value.address&&o.value.tokensObj[f.value.address]&&o.value.tokensObj[f.value.address].logoURI},text:`Withdraw ${s.value} ${(je=r.value)==null?void 0:je.symbol} and ${a.value} ${(ze=f.value)==null?void 0:ze.symbol}`};b.value!=="Aptos"&&(so.res=He.res),G.value.showTransitionPending(so);const co=await G.value.watchTransaction(so);if(N.value&&N.value.length>0&&(Number((Re=N[0])==null?void 0:Re.amount)!==0||_e.coinTypeD&&Number((Ee=N[1])==null?void 0:Ee.amount)!==0||_e.coinTypeE&&Number((De=N[2])==null?void 0:De.amount)!==0)){const go={title:ke("common.removeLiquidity"),desc:"",hash:He.hash,tit:"Rewards Claimed",icon:"icon-icon-Removed",tokenInfo:{tokena:N[0].symbol,numa:`+ ${Number(N[0].amount)}`,logoa:o.value.tokensObj&&N[0]&&N[0].address&&o.value.tokensObj[N[0].address]&&o.value.tokensObj[N[0].address].logoURI,tokenb:_e.coinTypeD?N[1].symbol:"",numb:_e.coinTypeD?`+ ${Number(N[1].amount)}`:"",logob:_e.coinTypeD?o.value.tokensObj&&N[1]&&N[1].address&&o.value.tokensObj[N[1].address]&&o.value.tokensObj[N[1].address].logoURI:"",tokenc:_e.coinTypeE?N[2].symbol:"",numc:_e.coinTypeE?`+ ${Number(N[2].amount)}`:"",logoc:_e.coinTypeE?o.value.tokensObj&&N[2]&&N[2].address&&o.value.tokensObj[N[2].address]&&o.value.tokensObj[N[2].address].logoURI:""},text:`Withdraw ${s.value} ${(Fe=r.value)==null?void 0:Fe.symbol} and ${a.value} ${(Ke=f.value)==null?void 0:Ke.symbol}`},ko=await G.value.setTransations(go);console.log("9999transitionStatusFees",co,ko)}if($e(u.value.feeOwedA,u.value.token_a.decimals)!==0||$e(u.value.feeOwedB,u.value.token_b.decimals)!==0){const go={title:"Claim",desc:"",hash:He.hash,chainName:b.value,tit:"Fees Claimed",icon:"icon-icon-Removed",tokenInfo:{tokena:`${u.value.token_a.symbol}`,numa:Z(u.value.feeOwedA,u.value.token_a.decimals)==0?"":`+ ${$e(u.value.feeOwedA,u.value.token_a.decimals)}`,logoa:Z(u.value.feeOwedA,u.value.token_a.decimals)==0?"":o.value.tokensObj&&u.value&&u.value.token_a.address&&o.value.tokensObj[u.value.token_a.address]&&o.value.tokensObj[u.value.token_a.address].logoURI,tokenb:`${u.value.token_b.symbol}`,numb:Z(u.value.feeOwedB,u.value.token_b.decimals)==0?"":`+ ${$e(u.value.feeOwedB,u.value.token_b.decimals)}`,logob:Z(u.value.feeOwedB,u.value.token_b.decimals)==0?"":o.value.tokensObj&&u.value&&u.value.token_b.address&&o.value.tokensObj[u.value.token_b.address]&&o.value.tokensObj[u.value.token_b.address].logoURI}},ko=await G.value.setTransations(go);console.log("9999transitionStatusFees",co,ko)}co&&Number(q.value)==100&&me.value=="authenticated"&&ve.value&&(await Y.subscribePosition({pool_address:u.value.poolAddress,position_index:u.value.index},u.value.nftHash,!1),$()),co&&(s.value="",a.value="",setTimeout(()=>{t.emit("getDetails")},3e3),setTimeout(()=>{t.emit("getDetails")},6e3),console.log(q.value,re.name,b.value,"998===>"),Number(q.value)==100&&re.name=="new-position-detail"&&(b.value==="Aptos"?j.push("/position"):j.push("/pool/position")),q.value=0)}else c(!1),Be(!0);M.value=!1}catch(_e){console.log("Remove error",_e),M.value=!1,c(!1),Be(!0)}},sFixD:Me}}});const Vi={class:"new-position-asset"},xi={class:"add-or-remove"},es={class:"liquidity-action-tab"},os=n("div",{class:"remove tab-active"},"Remove",-1),ns={class:"card-item"},ts={key:0,class:"assets-card-mask"},is={class:"card-item"},ss={key:0,class:"assets-card-mask"},as={class:"remove-ratio"},ls=n("div",{class:"remove-ratio-title"},"Amount",-1),rs={class:"remove-ratio-select"},us={key:0,class:"ratio"},ds={key:1,class:"ratio"},cs={class:"ratio-list"},ms=["onClick"];function vs(e,t,s,a,B,g){const R=ho,m=rn,o=uo;return I(),P("div",Vi,[n("div",xi,[n("div",es,[n("div",{class:"increase",onClick:t[0]||(t[0]=l=>e.poolStore.setPositionDetailCurrentTab("increase"))}," Increase "),os]),n("div",{class:wo(e.needReverse?"card-container reverse":"card-container")},[n("div",ns,[le(R,{modelValue:e.fromCoinAmount,"onUpdate:modelValue":t[1]||(t[1]=l=>e.fromCoinAmount=l),"input-value":e.fromCoinAmount,"coin-symbol":e.fromCoin?e.fromCoin.symbol:null,"coin-name":e.fromCoin?e.fromCoin.name:null,balance:e.fromCoinBlance,"coin-icon":e.fromCoin?e.fromCoin.logoURI:"",address:e.fromCoin?e.fromCoin.address:"","swap-direct":"From","import-page":"deposit","has-arrow":!1,havehalf:!1,"amount-leabl":"Available",onOnMax:t[2]||(t[2]=l=>e.maxBtnSelect("fromCoin")),onOnHalf:t[3]||(t[3]=l=>e.halfBtnSelect("fromCoin")),onOnInput:t[4]||(t[4]=l=>{e.fromCoinAmount=l,e.fixedFromCoin=!0,e.isSlider=!1})},null,8,["modelValue","input-value","coin-symbol","coin-name","balance","coin-icon","address"]),e.fromCoinBlance==0?(I(),P("div",ts)):de("",!0)]),n("div",is,[le(R,{modelValue:e.toCoinAmount,"onUpdate:modelValue":t[5]||(t[5]=l=>e.toCoinAmount=l),"input-value":e.toCoinAmount,"coin-symbol":e.toCoin?e.toCoin.symbol:null,"coin-name":e.toCoin?e.toCoin.name:null,balance:e.toCoinBlance,"swap-direct":"To","coin-icon":e.toCoin?e.toCoin.logoURI:"",address:e.toCoin?e.toCoin.address:"","import-page":"deposit","has-arrow":!1,havehalf:!1,"amount-leabl":"Available",onOnMax:t[6]||(t[6]=l=>e.maxBtnSelect("toCoin")),onOnHalf:t[7]||(t[7]=l=>e.halfBtnSelect("toCoin")),onOnInput:t[8]||(t[8]=l=>{e.toCoinAmount=l,e.fixedFromCoin=!1,e.isSlider=!1})},null,8,["modelValue","input-value","coin-symbol","coin-name","balance","coin-icon","address"]),e.toCoinBlance==0?(I(),P("div",ss)):de("",!0)])],2),n("div",as,[ls,n("div",rs,[Number(e.fromCoinBlance)>=Number(e.fromCoinAmount)&&Number(e.toCoinBlance)>=Number(e.toCoinAmount)?(I(),P("div",us,H(e.sliderVal>0&&Number(("sFixD"in e?e.sFixD:K(Me))(e.sliderVal,2))<.01?"<0.01":("sFixD"in e?e.sFixD:K(Me))(e.sliderVal,2))+"% ",1)):(I(),P("div",ds," -- ")),n("div",cs,[(I(!0),P(Ve,null,oo(e.ratioArr,(l,v)=>(I(),P("div",{key:v,class:wo(["ratio-item",e.sliderVal==l.value?"ratio-item-active":""]),onClick:()=>{e.isSlider=!0,e.sliderVal=l.value}},H(l.name),11,ms))),128))])]),le(m,{value:e.sliderVal,"onUpdate:value":t[9]||(t[9]=l=>e.sliderVal=l)},null,8,["value"])])]),e.wallet.connected?(I(),qe(o,{key:0,class:"big-btn liquidity-btn",loading:e.actionLoading,disabled:e.addLiquidityBtnDisabled,onClick:e.toRemove},{default:Le(()=>[n("span",null,H(e.addLiquidityBtnText),1)]),_:1},8,["loading","disabled","onClick"])):(I(),qe(o,{key:1,class:"big-btn",onClick:t[10]||(t[10]=l=>e.wallet.connected?e.isShowLiquidityModal=!0:e.wallet.setIsShowWalletModal(!0))},{default:Le(()=>[n("span",null,H(e.$t("button.connectWallet")),1)]),_:1}))])}const fs=Qe(Zi,[["render",vs]]),ps=Ye({setup(){const e=io(),t=C(()=>e),s=Do(),a=C(()=>s),B=ro(),g=C(()=>t.value.currentPositionInfo),R=E(),m=F=>{var S;return((S=t.value.tokensObj[F])==null?void 0:S.logo_url)||no("/image/coins/sui-unknown.png")},o=Vo("Sui"),l=E(),v=async F=>{l.value=0;try{const S=await o.calculateFarmingRewards([{pool_id:F.pool_id,position_nft_id:F.id}]),O=[];let q=new w(0);S[F.id].forEach((D,ie)=>{var Q;const V=(Q=t.value.tokensObj[D.rewarder_type])==null?void 0:Q.decimals;let x=new w(D.rewarder_amount).div(Math.pow(10,V)).toString();Number(x)>0&&b.value.rewarders[ie]&&(q=q.add(x),O.push({...D,rewarderAmount:x,rewarderAmountPer:x}))}),l.value=q,R.value=O,console.log("getRewarder",F,O)}catch(S){console.log(S,"getRewarder")}},d=C(()=>a.value.farmsPoolObj),b=C(()=>d.value[g.value.poolAddress]);Ie(()=>[g.value,d.value,b.value],([F,S,O])=>{var q;!ce(F)&&F.positionSource=="farming"&&!ce(O)?v(F):!ce(S)&&!ce(F)&&(console.log(S,"##farmsPoolObj"),R.value=(q=S[F.poolAddress])==null?void 0:q.rewarders)},{immediate:!0});const G=lo(),se=C(()=>G),oe=Je(),ne=to("Sui"),{setIsShowSuccess:r,setIsShowRejected:f,setIsShowWaiting:T,setTransactionDesc:i,setTransactionTxid:k}=oe,A=E(!1),_=async()=>{A.value=!0,k(""),i("Claim rewards"),T(!0);const F={pool_id:g.value.pool_id,position_nft_id:g.value.id};try{const S=await o.harvestFarms(F),O=await se.value.currentWallet.signAndExecuteTransactionBlock(S);console.log("0221###sui swap res###",O);let q=ne.handleTx(O);if(q&&q.hash){k(q.hash),T(!1),r(!0);let D={title:"Claim",res:q.res,hash:q.hash};ne.showTransitionPending(D),await ne.watchTransaction(D)&&setTimeout(()=>{v(g.value)},2e3)}else T(!1),f(!0);A.value=!1}catch(S){console.log("farmsDeposit error",S),T(!1),f(!0),A.value=!1}},u=async()=>{A.value=!0,k(""),i(`Unstake ${g.value.name}`),T(!0);const F=g.value.pool_id,S=g.value.id;try{const O=await o.farmsWithdraw(F,S),q=await se.value.currentWallet.signAndExecuteTransactionBlock(O);console.log("0221###sui swap res###",q);let D=ne.handleTx(q);if(console.log(D,"unStaketx##"),D&&D.hash){k(D.hash),T(!1),r(!0);let ie={res:D.res,title:"Unstake",hash:D.hash};ne.showTransitionPending(ie),await ne.watchTransaction(ie)&&setTimeout(()=>{console.log("unstake success"),B.replace(`/new-position-detail?token=${g.value.tokenName}&address=${g.value.clmm_pool_id}&pos=${g.value.clmm_position_id}`),t.value.setCurrentPositionInfo(g.value.clmm_pool_id,"",g.value.tokenName,"Sui",g.value.clmm_position_id),l.value=0,A.value=!1},2e3)}else T(!1),f(!0)}catch(O){console.log("farmsDeposit error",O),T(!1),f(!0),A.value=!1}},te=async()=>{console.log(g.value,"currentPositionInfo.value"),A.value=!0,k(""),i(`Stake ${g.value.name}`),T(!0);const F={clmm_pool_id:g.value.poolAddress,clmm_position_id:g.value.pos_object_id,coinTypeA:g.value.coin_type_a,coinTypeB:g.value.coin_type_b},S=d.value[g.value.poolAddress].id;try{const O=await o.farmsDeposit(F,S),q=await se.value.currentWallet.signAndExecuteTransactionBlock(O);console.log("0221###sui swap res###",q);let D=ne.handleTx(q);if(D&&D.hash){k(D.hash),T(!1),r(!0);let ie={res:D.res,title:"Staked",hash:D.hash};ne.showTransitionPending(ie);const V=await ne.watchTransaction(ie);let x;console.log(D,"tx###"),V&&setTimeout(async()=>{D.res.events.forEach(Q=>{Q.type.indexOf("::pool::DepositEvent")>-1&&(x=Q.parsedJson.wrapped_position_id)}),B.replace(`/new-position-detail?position_nft_id=${x}&positionSource=farming`),console.log(x,"###farmPositionId"),await t.value.setCurrentPositionInfo("","","","Sui",x,"farming"),A.value=!1},2e3)}else T(!1),f(!0)}catch(O){console.log("farmsDeposit error",O),T(!1),f(!0),A.value=!1}},J=C(()=>oe),ue=C(()=>J.value.addressLpTokens);return{getCoinIcon:m,rewardList:R,sFixD:Me,addCommom:Z,claim:_,unStake:u,loading:A,totalRewardAmount:l,currentPositionInfo:g,stake:te,farmsPoolObj:d,addressLpTokens:ue,farmsPoolInfo:b}}});const xe=e=>(vo("data-v-9b39419a"),e=e(),fo(),e),hs={key:0,class:"farms-position-detail"},gs={class:"farms-top"},ks=xe(()=>n("div",{class:"left"},[n("div",{class:"title"},"Farming"),n("div",{class:"desc"},"Stake Position to Earn")],-1)),bs={class:"right"},ws={class:"apr"},_s={class:"apr-tips-box"},ys=xe(()=>n("span",null,"View",-1)),Is=xe(()=>n("svg",{class:"arrow-icon","aria-hidden":"true"},[n("use",{"xlink:href":"#icon-icon_arrow"})],-1)),As=[ys,Is],Cs={class:"farms-bottom"},Ss=xe(()=>n("div",{class:"title"},"Farming Rewards",-1)),$s={key:0,class:"reward-list"},Ps={key:0,class:"rewards-item-bg"},Ts={class:"rewards-item-box"},Ns={alt:""},Rs={key:1},Os={class:"rewards-item-bg"},qs={class:"rewards-item-box"},Ls={alt:""},Bs=xe(()=>n("span",null,"0",-1)),Ms={key:1,class:"reward-list"},Us={key:0,class:"rewards-item-bg"},js={class:"rewards-item-box"},Es={alt:""},Ds=xe(()=>n("span",null,"0",-1)),Fs={key:1},Ws={class:"rewards-item-bg"},Hs={class:"rewards-item-box"},Xs={alt:""},Gs=xe(()=>n("span",null,"0",-1)),zs={class:"actions-box"};function Js(e,t,s,a,B,g){const R=gn,m=uo,o=un,l=Ao("image");return e.farmsPoolObj&&e.farmsPoolObj[e.currentPositionInfo.poolAddress]&&e.farmsPoolObj[e.currentPositionInfo.poolAddress].status=="Live"||e.currentPositionInfo.positionSource=="farming"?(I(),P("div",hs,[n("div",gs,[ks,n("div",bs,[n("div",ws,[fe(" APR  "),n("span",null,[fe(H(("addCommom"in e?e.addCommom:K(Z))(e.farmsPoolInfo.total_apr*100,2))+"%  ",1),n("div",_s,[le(R,{"l-item":e.farmsPoolInfo,"rewarder-info":e.farmsPoolInfo.rewarder.rewardList},null,8,["l-item","rewarder-info"])])])]),n("div",{class:"view",onClick:t[0]||(t[0]=v=>e.$router.push("/farms"))},As)])]),n("div",Cs,[Ss,e.rewardList&&e.rewardList.length>0?(I(),P("div",$s,[(I(!0),P(Ve,null,oo(e.rewardList,v=>(I(),P("div",{key:v,class:"rewards-item"},[e.currentPositionInfo.positionSource=="farming"?(I(),P("div",Ps,[n("div",Ts,[Pe(n("img",Ns,null,512),[[l,e.getCoinIcon(v.rewarder_type)]]),n("span",null,H(("addCommom"in e?e.addCommom:K(Z))(v.rewarderAmount||0)),1)])])):(I(),P("div",Rs,[n("div",Os,[n("div",qs,[Pe(n("img",Ls,null,512),[[l,e.getCoinIcon(v.reward_coin)]]),Bs])])]))]))),128))])):(I(),P("div",Ms,[(I(!0),P(Ve,null,oo(e.currentPositionInfo.rewards,v=>(I(),P("div",{key:v,class:"rewards-item"},[e.currentPositionInfo.positionSource=="farming"?(I(),P("div",Us,[n("div",js,[Pe(n("img",Es,null,512),[[l,e.getCoinIcon(v.rewarder_type)]]),Ds])])):(I(),P("div",Fs,[n("div",Ws,[n("div",Hs,[Pe(n("img",Xs,null,512),[[l,e.getCoinIcon(v.reward_coin)]]),Gs])])]))]))),128))])),n("div",zs,[e.currentPositionInfo&&e.currentPositionInfo.positionSource=="farming"?(I(),qe(m,{key:0,class:"unstake-btn",loading:e.loading,onClick:e.unStake},{default:Le(()=>[fe("Unstake")]),_:1},8,["loading","onClick"])):de("",!0),e.currentPositionInfo&&e.currentPositionInfo.positionSource=="clmm"&&e.currentPositionInfo.currentStatus!=="Active"?(I(),qe(o,{key:1},{title:Le(()=>[fe("Farming rewards are only available for active positions.")]),default:Le(()=>[le(m,{class:"unstake-btn",loading:e.loading,disabled:!0,onClick:e.stake},{default:Le(()=>[fe("Stake")]),_:1},8,["loading","onClick"])]),_:1})):e.currentPositionInfo&&e.currentPositionInfo.positionSource=="clmm"?(I(),qe(m,{key:2,class:"unstake-btn",loading:e.loading,onClick:e.stake},{default:Le(()=>[fe("Stake")]),_:1},8,["loading","onClick"])):de("",!0),le(m,{class:"unstake-btn btn-margin",loading:e.loading,disabled:e.totalRewardAmount==0||e.currentPositionInfo&&e.currentPositionInfo.positionSource!=="farming",onClick:jo(e.claim,["stop"])},{default:Le(()=>[fe("↑ Claim")]),_:1},8,["loading","disabled","onClick"])])])])):de("",!0)}const Jo=Qe(ps,[["render",Js],["__scopeId","data-v-9b39419a"]]),Ys=Ye({props:{positionInfo:{type:Object,default:()=>({})}},setup(e){const t=Eo(),s=C(()=>t),a=C(()=>s.value.status),B=Je();Ie(()=>[s.value.targetGroups],v=>{console.log("0327###watch###newTargetGoups###",v)},{immediate:!0});const g=E(!1);Ie(()=>a.value,v=>{v=="authenticated",g.value=!1},{immediate:!0});const R=E(!1),m=async()=>{R.value=!R.value,console.log(R.value,"===>checked.value"),console.log(e.positionInfo,"##props.positionInfo");const v={pool_address:e.positionInfo.poolAddress||e.positionInfo.clmm_pool_id,position_index:e.positionInfo.index||e.positionInfo.name.split("-")[1]},d=e.positionInfo.clmm_position_id||e.positionInfo.nftHash;console.log("0529###changeSwitch###positionInfo####",e.positionInfo);try{await t.subscribePosition(v,d,R.value)}catch{R.value=!R.value}},o=v=>{const d=v.sources;console.log(e.positionInfo,d,"getPositionNotifiStatus##"),R.value=d.some(b=>JSON.parse(b.blockchainAddress).pool_address==e.positionInfo.poolAddress&&Number(JSON.parse(b.blockchainAddress).position_index)==(Number(e.positionInfo.index)||Number(e.positionInfo.name.split("-")[1])))},l=ro();return console.log(l.currentRoute.value.query.token,"===>rouyter"),Ie(()=>[s.value.sourceGroups,e.positionInfo],([v,d])=>{var b,G,se,oe,ne,r;console.log(v,"==>newSourceGroups169"),console.log(d,"===>positionInfo170"),R.value=!1,v&&v.length>0&&v[0]&&d&&!ce(d)&&(((se=(G=(b=l==null?void 0:l.currentRoute)==null?void 0:b.value)==null?void 0:G.query)==null?void 0:se.token)==(d==null?void 0:d.name)||((r=(ne=(oe=l==null?void 0:l.currentRoute)==null?void 0:oe.value)==null?void 0:ne.query)==null?void 0:r.positionSource)=="farming")&&(console.log("触发"),console.log(v,"==>newSourceGroups"),console.log(d,"===>positionInfo"),o(v[0]))},{immediate:!0,deep:!0}),{importIcon:no,isShowSetUp:g,changeSwitch:m,checked:R,notifiStatus:a,store:B}}});const Qs=e=>(vo("data-v-7878455d"),e=e(),fo(),e),Ks={class:"range-alerts"},Zs={class:"range-alerts-top"},Vs={class:"title"},xs=Qs(()=>n("div",{class:"title-all"},[n("span",{class:"Range"},"Range Alerts")],-1)),ea={key:1,class:"h5-switch-box"},oa={class:"range-alerts-bottom"},na={key:0,class:"pc-switch-box"};function ta(e,t,s,a,B,g){const R=uo,m=dn;return I(),P("div",Ks,[n("div",Zs,[n("div",Vs,[xs,e.isShowSetUp||e.notifiStatus!=="authenticated"?(I(),qe(R,{key:0,class:"range-alerts-button",onClick:t[0]||(t[0]=jo(o=>e.store.setIsShowNotifi(!0),["stop"]))},{default:Le(()=>[fe(" Set up ")]),_:1})):de("",!0),!e.isShowSetUp&&e.notifiStatus=="authenticated"?(I(),P("div",ea,[le(m,{class:"range-alerts-switch",checked:e.checked,disabled:e.notifiStatus!=="authenticated",onChange:e.changeSwitch},null,8,["checked","disabled","onChange"])])):de("",!0)])]),n("div",oa,[fe(" Receive alerts via Telegram, SMS, or email when this position goes out of range. "),!e.isShowSetUp&&e.notifiStatus=="authenticated"?(I(),P("div",na,[le(m,{class:"range-alerts-switch",checked:e.checked,disabled:e.notifiStatus!=="authenticated",onChange:e.changeSwitch},null,8,["checked","disabled","onChange"])])):de("",!0)])])}const Yo=Qe(Ys,[["render",ta],["__scopeId","data-v-7878455d"]]),ia=Ye({components:{NewPositionTitle:Oo,NewPositionInfo:Go,NewPositionLiquidity:zo,NewPositionAssetAdd:Io,NewPositionAssetRemove:Io,NewPositionNotifi:Yo,FarmsPositionDetail:Jo},setup(){const e=E(),t=E(),s=E(),a=Je(),B=C(()=>a),g=C(()=>B.value.chainName),R=io(),m=C(()=>R),o=Do(),l=ro();Mo(()=>{e.value={},R.setPositionActionAmount({fromCoinAmount:"",toCoinAmount:""}),m.value.setCurrentPositionLoading(!0),o.getFarmsPoolList()});const v=async()=>{m.value.setCurrentPositionLoading(!0);const r=l.currentRoute.value.query.token||"",f=l.currentRoute.value.query.collect||"",T=l.currentRoute.value.query.address||"",i=l.currentRoute.value.query.pos||"",k=l.currentRoute.value.query.id||"",A=l.currentRoute.value.query.positionSource||"",_=l.currentRoute.value.query.position_nft_id||"";g.value==="Aptos"?r&&f&&T&&m.value.setCurrentPositionInfo(T,f,r,g.value):(console.log("0414###position-detail###id#####",k),console.log("0414###position-detail###name#####",r),console.log("0414###position-detail###pool_address#####",T),console.log("0414###position-detail###pos#####",i),r&&T&&i?m.value.setCurrentPositionInfo(T,f,r,g.value,i):k&&!A?m.value.setCurrentPositionInfo("","","",g.value,k):m.value.setCurrentPositionInfo("","","",g.value,_,A))};Ie(()=>m.value.poolConfigObj,r=>{r&&!ce(r)&&v()},{immediate:!0});const d=C(()=>m.value.currentPositionLoading),b=C(()=>{var f,T,i;const r=((i=(T=(f=l==null?void 0:l.currentRoute)==null?void 0:f.value)==null?void 0:T.query)==null?void 0:i.address)||"";return r&&m.value.addressLpTokens&&!ce(m.value.addressLpTokens)&&m.value.addressLpTokens[r]?m.value.addressLpTokens[r]:null});Ie(()=>b.value,(r,f)=>{r&&!ce(r)&&(e.value=r),r&&!ce(r)&&r.current_sqrt_price!==(f==null?void 0:f.current_sqrt_price)&&v()},{immediate:!0});const G=po();Ie(()=>[m.value.currentPositionInfo,g.value],([r,f])=>{var T;f=="Aptos"&&r?(e.value=r,t.value=e.value.token_a,s.value=e.value.token_b):f=="Sui"&&r&&(r==null?void 0:r.nftHash)==((T=G==null?void 0:G.query)==null?void 0:T.pos)&&(console.log(r,"==>newVal"),e.value=r,t.value=e.value.token_a,s.value=e.value.token_b)},{immediate:!0});const se=C(()=>m.value.positionDetailCurrentTab),oe=lo();C(()=>oe),C(()=>B.value.theme),console.log(JSON.stringify(e.value),"===>positionInfo.value135");const ne=()=>{v()};return cn(()=>{R.clearCurrentPositionInfo()}),{positionInfo:e,fromCoin:t,toCoin:s,getDetails:v,currentPositionLoading:d,positionDetailCurrentTab:se,clickRefresh:ne,chainName:g}}});const sa={class:"new-position-detail"},aa={class:"new-position-content"},la={class:"left"},ra={class:"right"},ua={class:"loading-global"};function da(e,t,s,a,B,g){const R=Oo,m=Go,o=zo,l=Io,v=fs,d=Jo,b=Yo,G=mn;return I(),P("div",sa,[le(R,{onClickRefresh:e.clickRefresh},null,8,["onClickRefresh"]),n("div",aa,[n("div",la,[le(m),le(o,{class:"pc-module",onGetDetails:e.getDetails},null,8,["onGetDetails"])]),n("div",ra,[e.positionDetailCurrentTab=="increase"?(I(),qe(l,{key:0,onGetDetails:e.getDetails},null,8,["onGetDetails"])):(I(),qe(v,{key:1,onGetDetails:e.getDetails},null,8,["onGetDetails"])),le(o,{class:"h5-module",onGetDetails:e.getDetails},null,8,["onGetDetails"]),e.chainName=="Sui"?(I(),qe(d,{key:2})):de("",!0),e.positionInfo&&e.positionInfo.minPrice!=="0"&&e.positionInfo.maxPrice!=="∞"&&e.chainName=="Sui"?(I(),qe(b,{key:3,"position-info":e.positionInfo},null,8,["position-info"])):de("",!0)])]),Pe(n("div",ua,[le(G)],512),[[Uo,e.currentPositionLoading]])])}const Da=Qe(ia,[["render",da],["__scopeId","data-v-441cff21"]]);export{Da as default};
