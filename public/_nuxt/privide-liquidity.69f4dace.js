import{a as st,b as Zt,n as ft,d as Se,u as kt,e as Ee,c as Ie,i as Nt,s as gt,T as Ct,p as _t,f as je,g as Pt}from"./pool.50d9f7a5.js";import{a as tt,r as E,m as M,y as Gt,D as qe,e as ot,o as h,f as O,c as Xe,x as ee,h as r,t as pt,G as Kt,H as bt,v as he,u as Te,F as ut,J as wt,p as At,k as Lt,s as It,z as Qe,l as qt,E as yt,C as Mt,q as Jt,i as ze,b as Qt,w as Yt,j as xt,I as Vt,B as eo}from"./entry.a2892cfb.js";/* empty css              */import{s as nt,m as to,l as oo,b as io,a as no}from"./transform.c672907f.js";import{D as l}from"./decimal.0e8aa3f1.js";import{u as ct,a as ro}from"./sha256.1f7a269f.js";import"./decimal.633e31ee.js";import{c as $t,_ as Rt,b as Bt,a as Ot}from"./new-liquidity-title.2de0e022.js";import{i as at}from"./import-icon.de3e6c66.js";import{tickList as et,direction as Me,minPrice as Z,maxPrice as H,fromCoin as w,toCoin as y,positionError as rt,currentPrice as lt,currentPriceReverse as ht,currentPriceTab as x,defaultMinPrice as mt,defaultMaxPrice as vt,toggle as Ft,priceConfigObj as Je,fromCoinAmount as P,toCoinAmount as A,fixedFromCoin as Pe,resetTickList as Tt,resetData as ao}from"./data.feec794b.js";import{_ as lo,a as so,b as uo}from"./icon-Add-Liquidity_2x.4c6f13c0.js";import{_ as co}from"./coin-select.e83884a3.js";import{_ as mo}from"./viewDetail.20a6fcb8.js";import{_ as vo}from"./token-warning-modal.9de2b2af.js";import{c as fo}from"./new-add-or-create.c444bf61.js";/* empty css              */import{u as go}from"./notifi.9c104050.js";/* empty css              */import"./tick.505fdad3.js";import"./token-warning.fb396607.js";/* empty css              */import"./refresh-icon.e3e5de13.js";/* empty css              */import"./swap-setting.1d6f9306.js";/* empty css              */import"./img-no-Positions_2x.e5e8aabe.js";import"./status-block.07d921ee.js";import"./icon-arrow_2x.948aedb2.js";import"./icon-arrow_2x.4ffddb8e.js";import"./icon-selected_3x.09e9a6f0.js";import"./useWhale.9ea9c1b0.js";import"./index.2539e259.js";function St(e,a,ge){const W=new l(10).pow(a-ge);return new l(1.0001).pow(e).mul(W)}const po=tt({props:{poolInfo:{type:Object,default:()=>({chartLoading:!1,token_a:{decimal:6},token_b:{decimal:6},currentLiquity:"50000000"})},minPrice:{type:String,default:""},maxPrice:{type:String,default:""},direction:{type:Boolean,default:!0},tickList:{type:Array,default:()=>[]},currentTick:{type:Number,default:0},chartLoading:{type:Boolean,default:!1},currentPriceTab:{type:String,default:""},before7dContractPriceLowest:{type:String,default:""},before7dContractPriceHighest:{type:String,default:""},zoom:{type:Number,default:1}},setup(e,a){const ge=E(""),W=E(""),j=M(()=>{var n,f,s,q,F,g;return console.log(e.poolInfo,"===>props.poolInfo"),(n=e.poolInfo)!=null&&n.current_sqrt_price&&((f=e.poolInfo)!=null&&f.coinA.decimals)&&((s=e.poolInfo)!=null&&s.coinB.decimals)?i.sqrtPriceX64ToPrice((q=e.poolInfo)==null?void 0:q.current_sqrt_price,(F=e.poolInfo)==null?void 0:F.coinA.decimals,(g=e.poolInfo)==null?void 0:g.coinB.decimals).toString():"0"}),ye=M(()=>{let n=0;return e.direction?n=(Number(e.minPrice)/Number(j.value)-1)*100:n=(Number(e.minPrice)/Number(1/Number(j.value))-1)*100,n=n>0&&n<.1?.1:n,n=n<0&&n>-.1?-.1:n,n}),X=M(()=>{let n=0;return e.direction?n=(Number(e.maxPrice)/Number(j.value)-1)*100:n=(Number(e.maxPrice)/Number(1/Number(j.value))-1)*100,n=n>0&&n<.1?.1:n,n=n<0&&n>-.1?-.1:n,n}),$=ct(),k=M(()=>$),J=M(()=>k.value.chainName?st(k.value.chainName):{}),{TickMath:i,getNearestTickByTick:C}=J.value,G=(n=[])=>{let f=6;const s=Math.abs(Number(n[0])-Number(n[n.length-1]));return s>=6?f=0:s>=1?f=1:s>=.1?f=2:s>=.01?f=3:s>=.001?f=4:s>=1e-4?f=5:s>=1e-5?f=6:s>=1e-6?f=7:s>=1e-7&&(f=8),f},V=(n,f=1)=>{if(n&&n.token_a&&!e.chartLoading&&e.minPrice&&e.maxPrice){const s=Number(e.poolInfo.current_tick_index);console.log("0117###dataProcessing###currentTick###",s),console.log("0117###dataProcessing###props.poolInfo###",e.poolInfo),console.log("0117###dataProcessing###minPrice###",e.minPrice),console.log("0117###dataProcessing###maxPrice###",e.maxPrice),console.log("0117###dataProcessing###poolInfo###",e.poolInfo);let q=s+100*f,F=s-100*f,g,te;if(e.maxPrice==="∞")te=J.value.TickUtil.getMaxIndex(Number(e.poolInfo.tickSpacing));else try{e.direction?te=i.priceToTickIndex(new l(e.maxPrice),e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals):te=i.priceToTickIndex(new l(1).div(e.minPrice),e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals)}catch{te=443636}if(e.minPrice==="0")g=J.value.TickUtil.getMinIndex(Number(e.poolInfo.tickSpacing));else try{e.direction?g=i.priceToTickIndex(new l(e.minPrice),e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals):g=i.priceToTickIndex(new l(1).div(e.maxPrice),e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals)}catch{g=-443636}let re=0;if(e.currentPriceTab!=="full range"){if(s>=g&&s<=te){const _=s-g,ae=te-s;re=Math.max(Math.abs(_),Math.abs(ae))}else s<g?re=Math.abs(te-s):re=Math.abs(s-g);q=s+re+100*f,F=s-re-100*f}else{const _=(Math.abs(s)>5e3,2e4);q=s+_*f,F=s-_*f}F<-443636&&(F=-443636),q>443636&&(q=443636);const m=new l(n.liquidity).div(Math.pow(10,8)).toString(),R=e.tickList;console.log("0117####drawChart####tick_info_array####",R);const L=[],T=[];let S={};for(let _=0;_<R.length;_++){if(S=R[_],S.index<=s&&S.index>=F){if(L.length<1&&_!==0){const ae=R[_-1];L.unshift({...ae,index:F})}L.unshift(S)}else if(S.index>s&&S.index<=q&&(T.push(S),L.length<1&&_!==0)){const ae=R[_-1];L.push({...ae,index:F})}if(S.index>q){const ae=R[_];if(T.push({...ae,index:q}),L.length<1&&_!==0){const Ke=R[_-1];L.push({...Ke,index:F})}break}}let K="0";for(let _=L.length-1;_>=0;_--)K=new l(K).plus(new l(L[_].liquidityNet.toString()).div(Math.pow(10,8))).toString(),L[_].liquityAmount=K;let b=m;for(let _=0;_<T.length;_++)b=new l(b).plus(new l(T[_].liquidityNet.toString()).div(Math.pow(10,8))).toString(),T[_].liquityAmount=b;let oe=[];const U=R&&R.length>0?{index:s,liquityAmount:Number(m)}:{index:s,liquityAmount:0};(L.length>0||T.length>0)&&(oe=[...L.reverse(),U,...T],e.direction||(oe=oe.reverse()));const Ne=[];R.forEach(_=>{Ne.push({..._,liquidityGross:_.liquidityGross.toString(),liquidityNet:_.liquidityNet.toString()})}),console.log("0117####drawChart####testTickInfoArray####",Ne),console.log("0117####drawChart####currentLiquity####",m),z(oe,F,q,g,te,s)}};let I=E(!1);Gt(()=>{document.body.clientWidth<750?I.value=!1:I.value=!0,window.onresize=()=>{document.body.clientWidth<750?I.value=!1:I.value=!0,V(e.poolInfo,e.zoom)}});const z=(n,f,s,q,F,g)=>{console.log("0117####drawChart####chartData####",n),console.log("0117####drawChart####tickMin####",f),console.log("0117####drawChart####tickMax####",s),console.log("0117####drawChart####minPriceTick####",q),console.log("0117####drawChart####maxPriceTick####",F),console.log("0117####drawChart####currentTick####",g),console.log("0117####drawChart####props.direction####",e.direction),console.log("0518###newd3###props.before7dContractPriceLowest###",e.before7dContractPriceLowest),console.log("0518###newd3###props.before7dContractPriceHighest###",e.before7dContractPriceHighest);let te,re;e.direction?(te=e.before7dContractPriceLowest?i.priceToTickIndex(new l(e.before7dContractPriceLowest),e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals):"",re=e.before7dContractPriceHighest?i.priceToTickIndex(new l(e.before7dContractPriceHighest),e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals):""):(te=e.before7dContractPriceLowest?i.priceToTickIndex(new l(1).div(e.before7dContractPriceLowest),e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals):"",re=e.before7dContractPriceHighest?i.priceToTickIndex(new l(1).div(e.before7dContractPriceHighest),e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals):"");const m={top:30,right:35,bottom:20,left:55};let R,L;I.value?(R=506-m.left-m.right,L=208-m.top-m.bottom):(R=340-m.left-m.right,L=205-m.top-m.bottom);const T=s-f,S=parseInt(String(T/4));let K=[f+S/4,f+S,f+2*S,s-S,s-S/4];const b=f,oe=s,U=R/(oe-b);e.currentPriceTab==="full range"&&(K=[f,f+2*S,s]),console.log("0117####drawChart####xArr####",K),console.log("0117####drawChart####utickMin####",b),console.log("0117####drawChart####utickMax####",oe),console.log("0117####drawChart####unit####",U);const Ne=K.map(u=>e.direction?St(u,e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals).toString():new l(1).div(St(u,e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals)).toString()),_=G(Ne);nt("#chart").selectAll("*").remove();const ae=nt("#chart").attr("width",R+m.left+m.right).attr("height",L+m.top+m.bottom).append("g").attr("transform",`translate(${m.left},${m.right})`),Ke=to(n,function(u){return Number(Math.abs(u.liquityAmount))})||0,t=oo().range([0,L]).domain([Ke,0]);io().rangeRound([0,R]).padding(.1);const B=ae.append("g").attr("id","barsBox").selectAll("rect").data(n).enter().append("rect");k.value.theme=="default"?B.attr("x",function(u,c){return c===0?0:e.direction?Math.abs(u.index-b)*U:Math.abs(oe-u.index)*U}).attr("y",function(u,c){return e.direction?c===n.length-1?0:t(u.liquityAmount):c===n.length-1?0:t(n[c+1].liquityAmount)}).attr("width",function(u,c){return c===0&&n.length===1&&u.liquityAmount>0?R:(e.direction,c!==n.length-1?Math.abs(n[c+1].index-u.index)*U:0)}).attr("height",function(u,c){return c===0&&n.length===1&&u.liquityAmount>0?L:e.direction?c===n.length-1?0:L-t(u.liquityAmount):c===n.length-1?0:L-t(n[c+1].liquityAmount)}).attr("fill","#279477").attr("class","bars").attr("stroke-width",1).attr("stroke","#279477"):B.attr("x",function(u,c){return c===0?0:e.direction?Math.abs(u.index-b)*U:Math.abs(oe-u.index)*U}).attr("y",function(u,c){return e.direction?c===n.length-1?0:t(Math.abs(u.liquityAmount)):c===n.length-1?0:t(Math.abs(n[c+1].liquityAmount))}).attr("width",function(u,c){return c===0&&n.length===1&&u.liquityAmount>0?R:(e.direction,c!==n.length-1?Math.abs(n[c+1].index-u.index)*U:0)}).attr("height",function(u,c){if(c===0&&n.length===1&&u.liquityAmount>0)return L;if(e.direction)return c===n.length-1?0:Number(u.liquityAmount)?L-t(Math.abs(u.liquityAmount)):0;{if(c===n.length-1)return 0;const Be=L-t(Math.abs(n[c+1].liquityAmount));return Number(n[c+1].liquityAmount)?Be:0}}).attr("fill","#407497").attr("class","bars").attr("stroke-width",1).attr("stroke","#407497");const D=ae.append("g");D.append("line").attr("x1",0).attr("y1",155).attr("x2",R).attr("y2",155).attr("stroke-width",1).attr("stroke","#50535D");const Ce=D.append("g");let le=0;if(e.direction){for(let u=0;u<K.length;u++){const c=Se(Ne[u],_)||"0";console.log("0423####price####",c),Ne.push(c);const Be=Math.abs(K[u]-b)*U;let pe=0;for(let be=0;be<c.length;be++)c[be]==="1"?pe+=4.02:c[be]==="."?pe+=2.64:c[be]==="7"?pe+=5.48:pe+=6;console.log(Be,"x=>>>"),Ce.append("text").text(c).attr("x",Be-pe/2).attr("y",168).attr("fill","rgba(255, 255, 255, 0.5").style("font-size","10")}le=Math.abs(g-b)*U}else{for(let u=K.length-1;u>=0;u--){const c=Se(Ne[u],_)||0;Ne.push(c);const Be=Math.abs(K[u]-oe)*U;let pe=0;for(let be=0;be<c.length;be++)c[be]==="1"?pe+=4.02:c[be]==="."?pe+=2.64:c[be]==="7"?pe+=5.48:pe+=6;Ce.append("text").text(c).attr("x",Be-pe/2).attr("y",168).attr("fill","rgba(255, 255, 255, 0.5").style("font-size","10")}le=Math.abs(g-oe)*U}(k.value.theme=="default"?ae.append("line").attr("x1",0).attr("y1",0).attr("x2",0).attr("y2",155).attr("stroke-width",2).attr("stroke","#68FFD8"):ae.append("line").attr("x1",0).attr("y1",0).attr("x2",0).attr("y2",155).attr("stroke-width",2).attr("stroke","#76C8FF")).attr("transform","translate("+le+", 0)");let Ae,$e,Ze,He;e.direction?(console.log("0525###d3###select###minPriceTick###",q),console.log("0525###d3###select###maxPriceTick###",F),console.log("0525###d3###select###props.minPrice###",e.minPrice),console.log("0525###d3###select###props.maxPrice###",e.maxPrice),Ae=q<b?-100:parseInt(String(Math.abs(q-b)*U)),$e=F<b?-100:parseInt(String(Math.abs(F-b)*U)),Ze=te<b?-100:Math.abs(te-b)*U,He=re<b?-100:Math.abs(re-b)*U):($e=q<b?-100:Math.abs(oe-q)*U,Ae=F<b?-100:Math.abs(oe-F)*U,He=te<b?-100:Math.abs(oe-te)*U,Ze=re<b?-100:Math.abs(oe-re)*U),e.minPrice==="0"&&(Ae=0),e.maxPrice==="∞"&&($e=R),I.value?ge.value=R-Ae+60+"px":ge.value=R-Ae+52+"px",W.value=$e+74+"px",te&&Ze<R&&ae.append("line").attr("x1",0).attr("y1",0).attr("x2",0).attr("y2",155).attr("stroke-width",1).attr("stroke-dasharray","5, 5").attr("stroke","rgba(255, 255, 255, 0.5)").attr("transform","translate("+Ze+", 0)"),re&&He<R&&ae.append("line").attr("x1",0).attr("y1",0).attr("x2",0).attr("y2",155).attr("stroke-width",1).attr("stroke-dasharray","5, 5").attr("stroke","rgba(255, 255, 255, 0.5)").attr("transform","translate("+He+", 0)");const me=ae.append("g").attr("id","left-handle"),Re=ae.append("g").attr("id","right-handle");k.value.theme=="default"?(me.append("line").attr("x1",0).attr("y1",0).attr("x2",0).attr("y2",155).attr("stroke-dasharray","5, 5").attr("stroke-width",2).attr("stroke","#68FFD8"),me.append("path").attr("d","M0 0 L12 0 L12 20 L0 20 Z").attr("fill","#333").attr("stroke","#333").attr("transform","translate(-1, 20) rotate(180)"),me.append("rect").attr("width",1).attr("height",7).attr("x",-9).attr("y",6).attr("fill","#68FFD8"),me.append("rect").attr("width",1).attr("height",10).attr("x",-7).attr("y",4.5).attr("fill","#68FFD8"),Re.append("line").attr("x1",0).attr("y1",0).attr("x2",0).attr("y2",155).attr("stroke-dasharray","5, 5").attr("stroke-width",2).attr("stroke","#68FFD8"),Re.append("path").attr("d","M0 0 L12 0 L12 20 L0 20 Z").attr("fill","#333").attr("stroke","#333").attr("transform","translate(1, 0)"),Re.append("rect").attr("width",1).attr("height",7).attr("x",7).attr("y",6).attr("fill","#68FFD8"),Re.append("rect").attr("width",1).attr("height",10).attr("x",5).attr("y",4.5).attr("fill","#68FFD8")):(me.append("line").attr("x1",0).attr("y1",0).attr("x2",0).attr("y2",155).attr("stroke-dasharray","5, 5").attr("stroke-width",2).attr("stroke","#76C8FF"),me.append("path").attr("d","M0 0 L12 0 L12 24 L0 24 Z").attr("fill","#333").attr("stroke","#333").attr("transform","translate(-1, 24) rotate(180)"),me.append("rect").attr("width",1).attr("height",7).attr("x",-9).attr("y",8).attr("fill","#76C8FF"),me.append("rect").attr("width",1).attr("height",10).attr("x",-7).attr("y",6.5).attr("fill","#76C8FF"),Re.append("line").attr("x1",0).attr("y1",0).attr("x2",0).attr("y2",155).attr("stroke-dasharray","5, 5").attr("stroke-width",2).attr("stroke","#76C8FF"),Re.append("path").attr("d","M0 0 L12 0 L12 24 L0 24 Z").attr("fill","#333").attr("stroke","#333").attr("transform","translate(1, 0)"),Re.append("rect").attr("width",1).attr("height",7).attr("x",7).attr("y",8).attr("fill","#76C8FF"),Re.append("rect").attr("width",1).attr("height",10).attr("x",5).attr("y",6.5).attr("fill","#76C8FF")),console.log("0525###d3###select###minPriceTickX###",Ae),console.log("0525###d3###select###maxPriceTickX###",$e),me.attr("transform","translate("+Ae+", 0)"),Re.attr("transform","translate("+$e+", 0)");const Ye=no().extent([[0,0],[R,L]]).handleSize(30).on("end",it);ae.append("g").attr("class","brush").call(Ye).call(Ye.move,[Ae,$e]);function it(u){if(!u.sourceEvent||!u.selection)return;me.attr("transform","translate("+u.selection[0]+", 0)"),Re.attr("transform","translate("+u.selection[1]+", 0)"),I.value?ge.value=R-u.selection[0]+60+"px":ge.value=R-u.selection[0]+52+"px",W.value=u.selection[1]+74+"px";let c,Be;console.log("0525###d3###select###e.selection[0]###",u.selection[0]),console.log("0525###d3###select###e.selection[0]###",u.selection[1]),console.log("0525###d3###select###props.direction###",e.direction),console.log("0525###d3###select###width###",R),console.log("0525###d3###select###unit###",U),console.log("0525###d3###select###utickMin###",b),console.log("0525###d3###select###utickMax###",oe),console.log("0525###d3###select###props.poolInfo###",e.poolInfo);let pe=0,be=0;e.direction?(pe=C(parseInt(String(u.selection[0]/U+b)),Number(e.poolInfo.tickSpacing)),c=i.tickIndexToPrice(pe,e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals).toString(),be=C(parseInt(String(u.selection[1]/U+b)),Number(e.poolInfo.tickSpacing)),Be=i.tickIndexToPrice(be,e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals).toString(),console.log("0525###d3###select###minTick###",pe),console.log("0525###d3###select###maxTick###",be),console.log("0525###d3###select###minPrice###",c),console.log("0525###d3###select###maxPrice###",Be)):(be=C(oe-u.selection[0]/U,Number(e.poolInfo.tickSpacing)),c=1/i.tickIndexToPrice(be,e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals).toString(),pe=C(oe-u.selection[1]/U,Number(e.poolInfo.tickSpacing)),Be=1/i.tickIndexToPrice(pe,e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals).toString()),a.emit("onChangeMinPrice",String(Se(String(c),6))),a.emit("onChangeMaxPrice",String(Se(String(Be),6)))}k.value.theme=="default"?nt(".selection").attr("stroke","rgba(255, 255, 255, 0)").attr("fill","#15322C"):nt(".selection").attr("stroke","rgba(255, 255, 255, 0)").attr("fill","#152632")};E(""),qe(()=>[e.poolInfo,e.minPrice,e.maxPrice,e.currentPriceTab,e.zoom],([n,f,s,q,F])=>{console.log(n,f,s,s>f,"poolInfo && minPrice && maxPrice && (maxPrice > minPrice)"),n&&f&&s&&(n!=null&&n.liquidity)&&(q!=="Custom"||console.log("绘制"),V(n,F))},{immediate:!0});const d=E(!1);return qe(()=>e.chartLoading,(n,f)=>{n!==f&&(d.value=n)},{immediate:!0,deep:!0}),console.log(e,"props===>"),{store:k,loading:d,rangeSizeLower:ye,rangeSizeUpper:X,rangeSizeLowerPosition:ge,rangeSizeUpperPosition:W,decimalFormat:Zt,numberformat:ft}}});const bo=e=>(At("data-v-32d48923"),e=e(),Lt(),e),ho={class:"chart-box"},ko={class:"chart"},wo=bo(()=>r("svg",{id:"chart"},null,-1));function yo(e,a,ge,W,j,ye){const X=wt;return h(),O(ut,null,[e.tickList&&e.tickList.length>0&&e.loading?(h(),Xe(X,{key:0})):ee("",!0),r("div",ho,[pt(r("div",ko,[e.currentPriceTab!=="full range"?(h(),O("div",{key:0,class:"range-size range-size-lower",style:bt({right:e.rangeSizeLowerPosition})},he(("numberformat"in e?e.numberformat:Te(ft))(e.rangeSizeLower.toFixed(1),1))+"% ",5)):ee("",!0),e.currentPriceTab!=="full range"?(h(),O("div",{key:1,class:"range-size range-size-upper",style:bt({left:e.rangeSizeUpperPosition})},he(("numberformat"in e?e.numberformat:Te(ft))(e.rangeSizeUpper.toFixed(1),1))+"% ",5)):ee("",!0),wo],512),[[Kt,!e.loading]])])],64)}const Ut=ot(po,[["render",yo],["__scopeId","data-v-32d48923"]]),Co=tt({props:{aprRewardsParameter:{type:Number,default:30},minPrice:{type:String,default:""},maxPrice:{type:String,default:""},fromCoin:{type:Object,default:()=>({})},toCoin:{type:Object,default:()=>({})},poolInfo:{type:Object,default:()=>({})},nameTab:{type:String,default:""}},setup(e){const a=[{label:"24H",value:24},{label:"7D",value:7},{label:"30D",value:30}],ge=ct(),W=M(()=>ge);M(()=>W.value.chainName);const j=kt(),ye=M(()=>j),X=M(()=>W.value.chainName?st(W.value.chainName):{}),$=E(),k=async i=>{var F,g,te;console.log("0607###detail###getAprMethod###poolInfo###",i),console.log("0607###detail###getAprMethod###props.fromCoin###",e.fromCoin),console.log("0607###detail###getAprMethod###props.toCoin###",e.toCoin),console.log("0607###detail###getAprMethod###props.nameTab###",e.nameTab);let C;i.token_a.address.toLowerCase()===e.fromCoin.address.toLowerCase()&&i.token_b.address.toLowerCase()===e.toCoin.address.toLowerCase()?C=!0:C=!1,console.log("0607###detail###getAprMethod###directs###",C),console.log("0607###detail###getAprMethod###props.minPrice###",e.minPrice),console.log("0607###detail###getAprMethod###props.maxPrice###",e.maxPrice);let G,V;C?(G=Number(e.minPrice),V=Number(e.maxPrice)):e.maxPrice!=="∞"?(G=1/Number(e.maxPrice),V=1/Number(e.minPrice)):(G=1/2**50,V=2**50),console.log("0607###detail###getAprMethod###lowerUserPrice###",G),console.log("0607###detail###getAprMethod###upperUserPrice###",V);let I=[];I=W.value&&W.value.addressHistTokens&&W.value.addressHistTokens[i.poolAddress]&&W.value.addressHistTokens[i.poolAddress].data&&W.value.addressHistTokens[i.poolAddress].data.length>0&&Object.fromEntries(W.value.addressHistTokens[i.poolAddress].data.map(re=>[re.key,re.value]));let z,d;console.log(I,"===>addressHistTokensList"),e.aprRewardsParameter==7?(z=Number(I==null?void 0:I.before_7_d_contract_price_lowest),d=Number(I==null?void 0:I.before_7_d_contract_price_highest)):e.aprRewardsParameter==24?(z=Number(I==null?void 0:I.before_24_h_contract_price_lowest),d=Number(I==null?void 0:I.before_24_h_contract_price_highest)):(z=Number(I==null?void 0:I.before_30_d_contract_price_lowest),d=Number(I==null?void 0:I.before_30_d_contract_price_highest));const n=ye.value.tokensObj;console.log("getEstPositionAPRWithMulti###params###lowerUserPrice###",G),console.log("getEstPositionAPRWithMulti###params###upperUserPrice###",V),console.log("getEstPositionAPRWithMulti###params###lowerHistPrice###",z),console.log("getEstPositionAPRWithMulti###params###upperHistPrice###",d);const f=await X.value.getEstPositionAPRWithMulti(G,V,z,d);console.log("getEstPositionAPRWithMulti###resMulti###",f.toString());const s=W.value.newTopPoolsObj[i.poolAddress];let q;if(s){e.aprRewardsParameter==7?q=Number(s.apr_7day.replace("%","")):e.aprRewardsParameter==24?q=Number(s.apr_24h.replace("%","")):q=Number(s.apr_30day.replace("%",""));const re=Number(s.rewarder_apr[0].replace("%","")),m=Number(s.rewarder_apr[1].replace("%","")),R=Number(s.rewarder_apr[2].replace("%","")),L=new l(f.toString()).mul(q).toNumber(),T=new l(f.toString()).mul(re).toNumber(),S=new l(f.toString()).mul(m).toNumber(),K=new l(f.toString()).mul(R).toNumber(),b=L+(i.rewarder_display1?T:0)+(i.rewarder_display2?S:0)+(i.rewarder_display3?K:0),oe=i.rewarder_infos[0]?(F=n[i.rewarder_infos[0].coinAddress])==null?void 0:F.symbol:"--",U=i.rewarder_infos[1]?(g=n[i.rewarder_infos[1].coinAddress])==null?void 0:g.symbol:"--",Ne=i.rewarder_infos[2]?(te=n[i.rewarder_infos[2].coinAddress])==null?void 0:te.symbol:"--",_={aprFee:L==1/0||isNaN(L)?0:L,rewardAprList:[{rewarder_name:oe,rewarder_apr:T==1/0||isNaN(T)?0:T,styleName:"one",rewarder_display:i.rewarder_display1},{rewarder_name:U,rewarder_apr:S==1/0||isNaN(S)?0:S,styleName:"two",rewarder_display:i.rewarder_display2},{rewarder_name:Ne,rewarder_apr:K==1/0||isNaN(K)?0:K,styleName:"three",rewarder_display:i.rewarder_display2}],aprPercentageTotal:b==1/0||isNaN(b)||b===0?0:b,aprPercentage:Nt(L/b,2),is_display_rewarder:i.is_display_rewarder};$.value=_,console.log($.value,"===>aprPercentageObj.value")}};qe(()=>[e.poolInfo,e.minPrice,e.maxPrice,W.value.addressHistTokens],([i,C,G,V])=>{i&&!Ie(i)&&V&&!Ie(V)&&k(i)},{immediate:!0}),qe(()=>[e.aprRewardsParameter],()=>{k(e.poolInfo)});const J=M(()=>{const i=$.value;return i&&i.is_display_rewarder?(i==null?void 0:i.aprPercentageTotal)>1e4?">10000":i.aprPercentageTotal<.01&&i.aprPercentageTotal>0?"<0.01":Ee(i.aprPercentageTotal,2):i&&!i.is_display_rewarder?(i==null?void 0:i.aprFee)>1e4?">10000":i.aprFee<.01&&i.aprFee>0?"<0.01":Ee(i.aprFee,2):"--"});return{timeList:a,aprPercentageObj:$,totalApr:J}}}),_o=""+globalThis.__publicAssetsURL("sui-image/farming.png");const Po=e=>(At("data-v-714ff8dc"),e=e(),Lt(),e),To={class:"est-apr"},So=Po(()=>r("div",{class:"title"},"Estimated APR",-1)),No={class:"apr-total"},Ao={key:0,src:_o,alt:""},Lo={class:"time-list"},Io=["onClick"];function qo(e,a,ge,W,j,ye){var X,$,k;return h(),O("div",To,[So,r("div",No,[r("span",null,he(e.totalApr)+"%",1),(X=e.poolInfo)!=null&&X.is_display_rewarder&&(($=e.poolInfo)!=null&&$.rewarderInfo)&&((k=e.poolInfo)==null?void 0:k.rewarderInfo.length)>0?(h(),O("img",Ao)):ee("",!0)]),r("div",Lo,[(h(!0),O(ut,null,It(e.timeList,J=>(h(),O("div",{key:J.value,class:Qe(["time-item",J.value==e.aprRewardsParameter?"time-item-active":""]),onClick:i=>e.$emit("changeAprRewardsParameter",J.value)},he(J.label),11,Io))),128))])])}const jt=ot(Co,[["render",qo],["__scopeId","data-v-714ff8dc"]]),Mo=tt({components:{NewLiquidityD3Chart:Ut,NewLiquidityApr:jt,NewLiquidityPrice:$t},setup(){const{t:e,locale:a}=qt(),ge=E("liquidity"),W=ct(),j=M(()=>W),ye=M(()=>j.value.chainName),X=kt(),$=M(()=>X),k=M(()=>j.value.chainName?st(j.value.chainName):{}),J=yt(),i=M(()=>{let t=null;for(let p=0;p<$.value.poolConfigList.length;p++){const B=$.value.poolConfigList[p];B.address==J.query.poolAddress&&(t=B)}return console.log(t,"===>basePoolInfo"),t}),C=M(()=>{let t=null;for(const p in $.value.poolsObj){const B=$.value.poolsObj[p];B.address==J.query.poolAddress&&(console.log(B,"p===>"),t=B)}return t}),G=E(),V=E(!0),I=async(t,p)=>{if(p){V.value=!0;const B=t.token_a.decimals,D=t.token_b.decimals;console.log(t,"pool===>1111"),lt.value=Ct.sqrtPriceX64ToPrice(t==null?void 0:t.current_sqrt_price,B,D).toString(),ht.value=new l(1).div(Ct.sqrtPriceX64ToPrice(t==null?void 0:t.current_sqrt_price,B,D)).toString(),w.value=t.needReverse?t.token_b:t.token_a,y.value=t.needReverse?t.token_a:t.token_b,G.value=t.needReverse,t.token_a.address.toLowerCase()===w.value.address.toLowerCase()&&t.token_b.address.toLowerCase()===y.value.address.toLowerCase()?Me.value=!0:Me.value=!1,console.log(t,"187===>"),console.log(t,"###pool===>");let Ce={poolAddress:t.address,coinTypeA:t.coin_a_address,coinTypeB:t.coin_b_address};const le=await k.value.getTicks(Ce);et.value=le?k.value.getTickDataFromUrlData(le):[],console.log(et.value,"===>chartLoadingtickList.value"),n(t)}V.value=!1,console.log(V.value,"==>chartLoading.value")},z=E([]),d=E(),n=t=>{const p=t.token_a.decimals,B=t.token_b.decimals;let D=$.value.poolPriceConfigObj&&$.value.poolPriceConfigObj[t.address]&&$.value.poolPriceConfigObj[t.address].recommend_ranges||{};const Ce=$.value.poolPriceConfigObj&&$.value.poolPriceConfigObj[t.address]&&$.value.poolPriceConfigObj[t.address].type||"";console.log(D,"===>priceConfigList");let le,ke;const Ae=t.current_tick_index;d.value=t.current_tick_index,console.log(Ae,t.tickSpacing,"==>pool.tickSpacing"),le=Ae-Number(t.type=="unstable"?Number(t.tickSpacing)*2:Number(t.tickSpacing)*3),ke=Ae+Number(t.type=="unstable"?Number(t.tickSpacing)*2:Number(t.tickSpacing)*3);const $e=k.value.TickMath.tickIndexToPrice(le,p,B).toString(),Ze=k.value.TickMath.tickIndexToPrice(ke,p,B).toString();D["full range"]={lower:k.value.TickUtil.getMinIndex(Number(C.value.tickSpacing)),upper:k.value.TickUtil.getMaxIndex(Number(C.value.tickSpacing))},D.custom={lower:le,upper:ke,minPrice:$e,maxPrice:Ze};const He=[];for(let me in D)D[me]&&(console.log(me,"j==>"),He.push({...D[me],key:me}));console.log(He,"priceList"),console.log(t,"###pool.type 504"),Ce?t.isSelfBuilt?x.value="custom":Ce=="stable"?x.value="suggested":x.value="passive":x.value="custom",z.value=He,Je.value=D,q({key:x.value,...D[x.value]})},f=E(""),s=E(""),q=t=>{console.log("priceTab====>",t),console.log("priceTab###poolInfo###",C.value),x.value=t.key.toLowerCase();const p=C.value.token_a.decimals,B=C.value.token_b.decimals,{lower:D,upper:Ce}=t,le=k.value.TickMath.tickIndexToPrice(D,p,B).toString(),ke=k.value.TickMath.tickIndexToPrice(Ce,p,B).toString();if(t.key=="full range"){f.value=D,s.value=Ce,F();return}console.log(Me.value,"===>direct.value"),Me.value?(mt.value=String(le),Z.value=String(le),vt.value=String(ke),H.value=String(ke),f.value=D,s.value=Ce):(mt.value=String(1/Number(ke)),Z.value=String(1/Number(ke)),vt.value=String(1/Number(le)),H.value=String(1/Number(le)),f.value=k.value.TickMath.priceToTickIndex(new l(1/Number(ke)),p,B),s.value=k.value.TickMath.priceToTickIndex(new l(1/Number(le)),p,B)),console.log(Z.value,H.value,"===>111")},F=t=>{Z.value="0",H.value="∞"};qe(()=>C.value,(t,p)=>{console.log(p,"===>oldVal"),console.log(t,"===>newVal"),(!p&&t&&!Ie(t)||p&&t&&p.address!==t.address)&&(console.log("池子信息"),I(t,!p||t.address!==p.address))},{immediate:!0}),Mt(()=>{et.value=[]}),qe(()=>[i.value,C.value,$.value.recommendRangesObj],(t,p)=>{var B,D;console.log(t,"===>newValue369"),console.log(p,"===>oldValue369"),(!p||t[0]&&t[1]&&t[2]&&!Ie(t[0])&&!Ie(t[1]&&!Ie(t[2]))||((B=t[0])==null?void 0:B.address)!==((D=p[0])==null?void 0:D.address))&&(console.log("3731111111"),t[0]&&t[2]&&!Ie(t[0])&&!Ie(t[2])&&(console.log(t[0],t[2],"======>374"),X.setSinglePool(t[0],t[2],ye.value)))},{immediate:!0,deep:!0});const g=t=>{if(ye.value=="Sui")switch(t){case"passive":return"/sui-image/icon_ conservative@2x.png";case"active":return"/sui-image/icon_active@2x.png";case"full range":return"/sui-image/icon_fullrange@2x.png";case"custom":return"/sui-image/icon_costom@2x.png";case"suggested":return"/sui-image/icon_stabel@2x.png"}else switch(t){case"passive":return"/image/icon_ conservative@2x.png";case"active":return"/image/icon_active@2x.png";case"full range":return"/image/icon_fullrange@2x.png";case"custom":return"/image/icon_costom@2x.png";case"suggested":return"/image/icon_stabel@2x.png"}},te=t=>{switch(t){case"suggested":return e("newAdd.suggested");case"active":return e("newAdd.active");case"passive":return e("newAdd.conservative");case"full range":return e("newAdd.fullRange");case"custom":return e("newAdd.custom")}},re=t=>{var B,D;const p=$.value.poolPriceConfigObj&&$.value.poolPriceConfigObj[(B=C.value)==null?void 0:B.address]&&$.value.poolPriceConfigObj[(D=C.value)==null?void 0:D.address].type||"";if(console.log(p,t,"==>poolType"),p=="unstable")switch(t){case"active":return{top:"35%"};case"passive":return{top:"10%"};case"full range":return{top:"60%"};case"custom":return{top:"85%"}}else switch(t){case"suggested":return{top:"23%"};case"full range":return{top:"48%"};case"custom":return{top:"73%"}}},m=E(1),R=()=>{const t=m.value/2;m.value=t},L=()=>{const t=m.value*2;m.value=t};console.log(z.value,"==>priceTablList");const T=M(()=>{var t,p,B;return!C.value||Ie(j.value.addressHistTokens)||!j.value.addressHistTokens[(t=C.value)==null?void 0:t.poolAddress]?null:Object.fromEntries((B=j.value.addressHistTokens[(p=C.value)==null?void 0:p.poolAddress])==null?void 0:B.data.map(D=>[D.key,D.value]))}),S=E(30),K=E("30D"),b=M(()=>Me.value?T.value&&Se(S.value==7?T.value.before_7_d_contract_price_lowest:S.value==24?T.value.before_24_h_contract_price_lowest:T.value.before_30_d_contract_price_lowest,6)||0:T.value&&Se(new l(1).div(S.value==7?T.value.before_7_d_contract_price_highest:S.value==24?T.value.before_24_h_contract_price_highest:T.value.before_30_d_contract_price_highest).toString(),6)||0),oe=M(()=>Me.value?T.value&&Se(S.value==7?T.value.before_7_d_contract_price_highest:S.value==24?T.value.before_24_h_contract_price_highest:T.value.before_30_d_contract_price_highest,6)||0:(T.value&&Se(1/Number(S.value==7?T.value.before_7_d_contract_price_lowest:S.value==24?T.value.before_24_h_contract_price_lowest:T.value.before_30_d_contract_price_lowest),6))==1/0?0:T.value&&Se(1/Number(S.value==7?T.value.before_7_d_contract_price_lowest:S.value==24?T.value.before_24_h_contract_price_lowest:T.value.before_30_d_contract_price_lowest),6)||0),U=M(()=>{const t=Number(Z.value),p=Number(H.value);return Z.value&&H.value&&Z.value!=="0"&&H.value!=="∞"?gt(1/(1-Number((t/p)**.25)),2)+"x":1}),Ne=M(()=>{var t,p,B,D,Ce,le;return((t=w.value)==null?void 0:t.isSelfBuilt)||((p=y.value)==null?void 0:p.isSelfBuilt)||((D=$.value.tokensObj[(B=w.value)==null?void 0:B.address])==null?void 0:D.isSelfBuilt)||((le=$.value.tokensObj[(Ce=y.value)==null?void 0:Ce.address])==null?void 0:le.isSelfBuilt)}),_=t=>{console.log(t,"####0731 priceRangeChangeMin"),t!==Z.value&&x.value=="full range"?(console.log(z.value,"===>priceTablList"),q({key:"custom",...z.value.custom})):x.value!=="full range"&&x.value!=="custom"?(x.value="custom",Z.value=t):Z.value=t},ae=t=>{t!==H.value&&x.value=="full range"?q({key:"custom",...z.value.custom}):x.value!=="full range"&&x.value!=="custom"?(x.value="custom",H.value=t):H.value=t};return console.log(Z.value,H.value,"683==>"),qe(()=>[Z.value,H.value],([t,p])=>{console.log(t,p,"minmax new-liquidity-left")},{deep:!0,immediate:!0}),{positionError:rt,getCoinIcon:t=>{var p;return(t==null?void 0:t.logoURI)||(t==null?void 0:t.logo_url)||((p=$.value.tokensObj[t==null?void 0:t.address])==null?void 0:p.logo_url)||(j.value.theme==="default"?at("/image/coins/unknown.png"):at("/image/coins/sui-unknown.png"))},chainName:ye,store:j,currentTab:ge,currentPrice:lt,currentPriceReverse:ht,fromCoin:w,toCoin:y,direction:Me,needReverse:G,addCommom:Ee,decimalUi:Se,priceTablList:z,currentPriceTab:x,sliderStyle:re,poolInfo:C,tickList:et,getPriceTabImage:g,getPriceTabText:te,defaultMinPrice:mt,defaultMaxPrice:vt,minPrice:Z,maxPrice:H,currentTick:d,chartLoading:V,zoomOut:R,zoomIn:L,zoom:m,priceTab:q,before7dContractPriceLowest:b,before7dContractPriceHighest:oe,aprRewardsTime:K,lever:U,aprRewardsParameter:S,isSelfBuilt:Ne,priceRangeChangeMin:_,priceRangeChangeMax:ae,toggle:Ft}}});const $o={class:"new-liquidity-left"},Ro={class:"select-range"},Bo=r("span",null,"Select Range",-1),Oo={class:"range-tab"},Fo=["src"],Uo=["src"],jo=r("span",null,"Liquidity",-1),zo=["src"],Ho=["src"],Do=r("span",null,"Price",-1),Wo={class:"price-info"},Eo={class:"left"},Xo={class:"base-coin"},Zo={class:"base-coin-title"},Go=r("span",null,"Base coin",-1),Ko=r("svg",{class:"icon icon-up","aria-hidden":"true"},[r("use",{"xlink:href":"#icon-exchange_up1"})],-1),Jo=r("svg",{class:"icon icon-down","aria-hidden":"true"},[r("use",{"xlink:href":"#icon-exchange_down1"})],-1),Qo=[Ko,Jo],Yo={key:0,class:"base-coin-bottom"},xo={alt:""},Vo={key:1,class:"base-coin-bottom"},ei={alt:""},ti={class:"leverage"},oi=r("div",{class:"leverage-title"},"Leverage",-1),ii={class:"laverage-value"},ni={class:"current-price"},ri=r("div",{class:"current-price-title"},"Current Price",-1),ai={key:0,class:"from-pre-to"},li={class:"right"},si={class:"price-range"},ui={class:"left"},ci={class:"price-slider"},di={class:"slider"},mi=r("div",{class:"slider-ratio-content"},null,-1),vi=[mi],fi={class:"price-tab-list"},gi=["onClick"],pi=["src"],bi={class:"right"},hi={class:"range-tab"},ki=["src"],wi=["src"],yi=r("span",null,"Liquidity",-1),Ci=["src"],_i=["src"],Pi=r("span",null,"Price",-1),Ti={class:"price-zoom"},Si={class:"current-price"},Ni=r("div",{class:"current-price-title"},"Current Price",-1),Ai={key:0,class:"from-pre-to"},Li={class:"price-zoom-right"},Ii={key:2,class:"position-tips"},qi=["src"],Mi={class:"error"},$i={class:"leverage"},Ri={class:"left"},Bi=r("div",{class:"leverage-title"},"Leverage",-1),Oi={class:"laverage-value"},Fi={class:"right"},Ui={key:0,class:"day-7-price-range"},ji=r("i",null,null,-1),zi={class:"gray"},Hi={class:"apr-and-price"},Di={key:0,class:"position-tips"},Wi=["src"],Ei={class:"error"};function Xi(e,a,ge,W,j,ye){var C,G,V,I,z,d,n,f,s,q,F;const X=Ut,$=wt,k=jt,J=$t,i=Jt("image");return h(),O("div",$o,[r("div",Ro,[Bo,r("div",Oo,[r("div",{class:Qe(["liquidity",e.currentTab=="liquidity"?"liquidity-tab-active":""]),onClick:a[0]||(a[0]=g=>e.currentTab="liquidity")},[e.chainName=="Sui"?(h(),O("img",{key:0,src:e.currentTab=="liquidity"?"/sui-image/Liquidity-Sel.png":"/sui-image/Liquidity-Def.png",alt:""},null,8,Fo)):(h(),O("img",{key:1,src:e.currentTab=="liquidity"?"/image/green_chart.png":"/sui-image/Liquidity-Def.png",alt:""},null,8,Uo)),jo],2),r("div",{class:Qe(["price",e.currentTab=="price"?"price-tab-active":""]),onClick:a[1]||(a[1]=g=>e.currentTab="price")},[e.chainName=="Sui"?(h(),O("img",{key:0,src:e.currentTab=="price"?"/sui-image/Price-Sel.png":"/sui-image/Price-Def.png",alt:""},null,8,zo)):(h(),O("img",{key:1,src:e.currentTab=="price"?"/image/price-chart.png":"/sui-image/Price-Def.png",alt:""},null,8,Ho)),Do],2)])]),r("div",Wo,[r("div",Eo,[r("div",Xo,[r("div",Zo,[Go,r("div",{class:"change-price",onClick:a[2]||(a[2]=(...g)=>e.toggle&&e.toggle(...g))},Qo)]),e.direction?(h(),O("div",Vo,[pt(r("img",ei,null,512),[[i,e.getCoinIcon(e.toCoin)]]),r("span",null,he((G=e.toCoin)==null?void 0:G.symbol),1)])):(h(),O("div",Yo,[pt(r("img",xo,null,512),[[i,e.getCoinIcon(e.fromCoin)]]),r("span",null,he((C=e.fromCoin)==null?void 0:C.symbol),1)]))]),r("div",ti,[oi,r("div",ii,he(e.lever),1)]),r("div",ni,[ri,r("div",null,[r("span",null,he(e.poolInfo?e.direction?("addCommom"in e?e.addCommom:Te(Ee))(("decimalUi"in e?e.decimalUi:Te(Se))(e.currentPrice,6)):("addCommom"in e?e.addCommom:Te(Ee))(("decimalUi"in e?e.decimalUi:Te(Se))(e.currentPriceReverse,6)):"--"),1),e.fromCoin&&e.toCoin?(h(),O("span",ai,he(e.direction?`${(V=e.fromCoin)==null?void 0:V.symbol} per ${(I=e.toCoin)==null?void 0:I.symbol}`:`${(z=e.toCoin)==null?void 0:z.symbol} per ${(d=e.fromCoin)==null?void 0:d.symbol}`),1)):ee("",!0)])])]),r("div",li,[e.currentTab=="liquidity"?(h(),O("div",{key:0,class:"zoom-in",onClick:a[3]||(a[3]=(...g)=>e.zoomIn&&e.zoomIn(...g))}," - ")):ee("",!0),e.currentTab=="liquidity"?(h(),O("div",{key:1,class:"zoom-out",onClick:a[4]||(a[4]=(...g)=>e.zoomOut&&e.zoomOut(...g))}," + ")):ee("",!0)])]),r("div",si,[r("div",ui,[r("div",ci,[r("div",di,[r("div",{class:"slider-ratio",style:bt(e.sliderStyle(e.currentPriceTab))},vi,4)])]),r("div",fi,[(h(!0),O(ut,null,It(e.priceTablList,g=>(h(),O("div",{key:g.key,class:Qe(["price-tab-item",e.currentPriceTab==g.key?"price-tab-item-active":""]),onClick:te=>e.priceTab(g)},[r("img",{src:e.getPriceTabImage(g.key),alt:""},null,8,pi),r("span",null,he(e.getPriceTabText(g.key)),1)],10,gi))),128))])]),r("div",bi,[r("div",hi,[r("div",{class:Qe(["liquidity",e.currentTab=="liquidity"?"liquidity-tab-active":""]),onClick:a[5]||(a[5]=g=>e.currentTab="liquidity")},[e.chainName=="Sui"?(h(),O("img",{key:0,src:e.currentTab=="liquidity"?"/sui-image/Liquidity-Sel.png":"/sui-image/Liquidity-Def.png",alt:""},null,8,ki)):(h(),O("img",{key:1,src:e.currentTab=="liquidity"?"/image/green_chart.png":"/sui-image/Price-Def.png",alt:""},null,8,wi)),yi],2),r("div",{class:Qe(["price",e.currentTab=="price"?"price-tab-active":""]),onClick:a[6]||(a[6]=g=>e.currentTab="price")},[e.chainName=="sui"?(h(),O("img",{key:0,src:e.currentTab=="price"?"/sui-image/Price-Sel.png":"/sui-image/Price-Def.png",alt:""},null,8,Ci)):(h(),O("img",{key:1,src:e.currentTab=="price"?"/image/price-chart.png":"/sui-image/Liquidity-Def.png",alt:""},null,8,_i)),Pi],2)]),r("div",Ti,[r("div",Si,[Ni,r("div",null,[r("span",null,he(e.poolInfo?e.direction&&!e.needReverse?("addCommom"in e?e.addCommom:Te(Ee))(("decimalUi"in e?e.decimalUi:Te(Se))(e.currentPrice,6)):("addCommom"in e?e.addCommom:Te(Ee))(("decimalUi"in e?e.decimalUi:Te(Se))(e.currentPriceReverse,6)):"--"),1),e.fromCoin&&e.toCoin?(h(),O("span",Ai,he(e.direction&&!e.needReverse?`${(n=e.fromCoin)==null?void 0:n.symbol} per ${(f=e.toCoin)==null?void 0:f.symbol}`:`${(s=e.toCoin)==null?void 0:s.symbol} per ${(q=e.fromCoin)==null?void 0:q.symbol}`),1)):ee("",!0)])]),r("div",Li,[e.currentTab=="liquidity"?(h(),O("div",{key:0,class:"zoom-in",onClick:a[7]||(a[7]=(...g)=>e.zoomIn&&e.zoomIn(...g))}," - ")):ee("",!0),e.currentTab=="liquidity"?(h(),O("div",{key:1,class:"zoom-out",onClick:a[8]||(a[8]=(...g)=>e.zoomOut&&e.zoomOut(...g))}," + ")):ee("",!0)])]),e.fromCoin&&e.toCoin&&e.poolInfo&&e.currentTab=="liquidity"?(h(),Xe(X,{key:0,"pool-info":e.poolInfo,"min-price":e.minPrice,"max-price":e.maxPrice,direction:e.direction,"current-price-tab":e.currentPriceTab,"tick-list":e.tickList,"current-tick":e.currentTick,"chart-loading":e.chartLoading,zoom:e.zoom,"before7d-contract-price-lowest":e.before7dContractPriceLowest,"before7d-contract-price-highest":e.before7dContractPriceHighest,onOnChangeMinPrice:e.priceRangeChangeMin,onOnChangeMaxPrice:e.priceRangeChangeMax},null,8,["pool-info","min-price","max-price","direction","current-price-tab","tick-list","current-tick","chart-loading","zoom","before7d-contract-price-lowest","before7d-contract-price-highest","onOnChangeMinPrice","onOnChangeMaxPrice"])):ee("",!0),((F=e.tickList)==null?void 0:F.length)<=0&&e.chartLoading?(h(),Xe($,{key:1})):ee("",!0),e.positionError&&e.poolInfo?(h(),O("div",Ii,[r("img",{src:("importIcon"in e?e.importIcon:Te(at))("/image/icon-tips-error@2x.png"),alt:""},null,8,qi),r("p",Mi,he(e.$t("tips.positionError")),1)])):ee("",!0)])]),r("div",$i,[r("div",Ri,[Bi,r("div",Oi,he(e.lever),1)]),r("div",Fi,[e.poolInfo&&(e.before7dContractPriceLowest||e.before7dContractPriceHighest)?(h(),O("div",Ui,[ji,r("span",zi,he(e.aprRewardsParameter==7?"7D":e.aprRewardsParameter==24?"24H":"30D")+" Price Range",1),r("span",null,he(("addCommom"in e?e.addCommom:Te(Ee))(("decimalUi"in e?e.decimalUi:Te(Se))(e.before7dContractPriceLowest,6)))+" - "+he(("addCommom"in e?e.addCommom:Te(Ee))(("decimalUi"in e?e.decimalUi:Te(Se))(e.before7dContractPriceHighest,6))),1)])):ee("",!0)])]),r("div",Hi,[ze(k,{"apr-rewards-parameter":e.aprRewardsParameter,"name-tab":"deposit","from-coin":e.fromCoin,"to-coin":e.toCoin,"pool-info":e.poolInfo,"min-price":e.minPrice,"max-price":e.maxPrice,onChangeAprRewardsParameter:a[9]||(a[9]=g=>{e.aprRewardsParameter=g})},null,8,["apr-rewards-parameter","from-coin","to-coin","pool-info","min-price","max-price"]),ze(J,{min:e.minPrice,max:e.maxPrice,"from-coin":e.fromCoin,"to-coin":e.toCoin,direct:e.direction,"default-min-price":e.defaultMinPrice,"default-max-price":e.defaultMaxPrice,"pool-info":e.poolInfo,loading:e.chartLoading,"current-price-tab":e.currentPriceTab,onOnChangeMinPrice:e.priceRangeChangeMin,onOnChangeMaxPrice:e.priceRangeChangeMax},null,8,["min","max","from-coin","to-coin","direct","default-min-price","default-max-price","pool-info","loading","current-price-tab","onOnChangeMinPrice","onOnChangeMaxPrice"]),e.positionError&&e.poolInfo?(h(),O("div",Di,[r("img",{src:("importIcon"in e?e.importIcon:Te(at))("/image/icon-tips-error@2x.png"),alt:""},null,8,Wi),r("p",Ei,he(e.$t("tips.positionError")),1)])):ee("",!0)])])}const zt=ot(Mo,[["render",Xi]]),Zi=tt({components:{NewLiquidityTitle:Rt,NewLiquidityAssetsCard:Bt,NewLiquidityDepositRatio:Ot},setup(){const{t:e,locale:a}=qt(),ge=ct(),W=M(()=>ge),j=M(()=>W.value.chainName),ye=kt(),X=M(()=>ye),$=ro(),k=M(()=>$),J=yt(),i=M(()=>{let o=null;for(const v in X.value.poolsObj){const N=X.value.poolsObj[v];N.address==J.query.poolAddress&&(console.log(N,"p===>"),o=N)}return o}),C=E(!1),G=E(!1),V=M(()=>W.value.theme),I=async(o,v)=>{w.value=o.needReverse?o.token_b:o.token_a,y.value=o.needReverse?o.token_a:o.token_b};qe(()=>i.value,(o,v)=>{console.log(v,"===>oldVal"),console.log(o,"===>newVal"),(!v&&o&&!Ie(o)||v&&o&&v.address!==o.address)&&(console.log("池子信息"),I(o,!v||o.address!==v.address))},{immediate:!0});const z=M(()=>k.value.assets&&w.value&&k.value.assets[w.value.address]?_t(k.value.assets[w.value.address].balance,w.value.decimals):"0"),d=M(()=>k.value.assets&&y.value&&k.value.assets[y.value.address]?_t(k.value.assets[y.value.address].balance,y.value.decimals):"0"),n=o=>{o==="fromCoin"?(Pe.value=!0,j.value==="Aptos"?P.value=Number(z.value)>0?w.value.symbol=="APT"?new l(Number(z.value)).sub(new l(.1)).lt(new l(0))?"0":new l(Number(z.value)).sub(new l(.1)).toString():String(z.value):"":P.value=Number(z.value)>0?w.value.symbol=="SUI"?new l(Number(z.value)).sub(new l(.05)).lt(new l(0))?"0":new l(Number(z.value)).sub(new l(.05)).toString():String(z.value):""):(Pe.value=!1,j.value==="Aptos"?A.value=Number(d.value)>0?y.value.symbol=="APT"?new l(Number(d.value)).sub(new l(.1)).lt(new l(0))?"0":new l(Number(d.value)).sub(new l(.1)).toString():String(d.value):"":A.value=Number(d.value)>0?y.value.symbol=="SUI"?new l(Number(d.value)).sub(new l(.05)).lt(new l(0))?"0":new l(Number(d.value)).sub(new l(.05)).toString():String(d.value):"")},f=o=>{o==="fromCoin"?(Pe.value=!0,P.value=Number(z.value)>0?gt(new l(Number(z.value)).div(2).toString(),w.value.decimals).toString():""):(Pe.value=!1,A.value=Number(d.value)>0?gt(new l(Number(d.value)).div(2).toString(),y.value.decimals).toString():"")},s=E(),q=E(),F=E(),g=E(!1),te=o=>{var v,N,ue,Q;s.value=o,o==="fromCoin"?(q.value=((v=y.value)==null?void 0:v.address)||"",F.value=J.query.actions=="new-position"?(N=w.value)==null?void 0:N.address:i.value.needReverse?i.value.token_b.address:i.value.token_a.address):(q.value=((ue=w.value)==null?void 0:ue.address)||"",F.value=J.query.actions=="new-position"?(Q=y.value)==null?void 0:Q.address:i.value.needReverse?i.value.token_a.address:i.value.token_b.address),g.value=!0,console.log(g.value,"==>showCoinSelect.value ")},re=o=>{var ue,Q,ce,ve,fe,ne,ie,_e;const v=i.value.needReverse?i.value.token_b:i.value.token_a,N=i.value.needReverse?i.value.token_a:i.value.token_b;s.value==="fromCoin"?(((ue=w.value)==null?void 0:ue.address)===(v==null?void 0:v.address)||!((Q=w.value)!=null&&Q.address)?(y.value&&o.address.toLowerCase()===((ce=y)==null?void 0:ce.value.address.toLowerCase())&&(y.value=null),w.value=o):(w.value&&o.address.toLowerCase()===((ve=w)==null?void 0:ve.value.address.toLowerCase())&&(w.value=null),y.value=o),J.query.action||(J.query.fee="")):((fe=y.value)==null?void 0:fe.address)===(N==null?void 0:N.address)||!((ne=y.value)!=null&&ne.address)?(w.value&&o.address.toLowerCase()===((ie=w)==null?void 0:ie.value.address.toLowerCase())&&(w.value=null),y.value=o):(y.value&&o.address.toLowerCase()===((_e=y)==null?void 0:_e.value.address.toLowerCase())&&(y.value=null),w.value=o),g.value=!1},m=M(()=>W.value.chainName?st(W.value.chainName):{}),R=M(()=>W.value.slippage),L=E(),T=async()=>{var Oe,We,Ue,de;if(K.value)return console.log("跳出"),!1;if(!Z.value&&!H.value)return!1;if(!P.value&&!A.value&&!Z.value&&!H.value)return;const o=i.value||{};if(Ie(o))return;const{TickUtil:v,TickMath:N,getNearestTickByTick:ue}=m.value,Q=o==null?void 0:o.token_a.decimals,ce=o==null?void 0:o.token_b.decimals;let ve,fe,ne,ie,_e,Le,De,Ge,we=o==null?void 0:o.current_tick_index,Y;if(o.token_a.address.toLowerCase()===w.value.address.toLowerCase()&&o.token_b.address.toLowerCase()===y.value.address.toLowerCase()?Y=!0:Y=!1,Z.value==="0"&&H.value==="∞")ne=v.getMinIndex(Number(o.tickSpacing)),ie=v.getMaxIndex(Number(o.tickSpacing)),_e=N.tickIndexToSqrtPriceX64(ne),Le=N.tickIndexToSqrtPriceX64(ie);else if(x.value=="custom"){console.log(Y,"===>directs1866"),Y?(ve=Number(Z.value),fe=Number(H.value)):(ve=new l(1).div(H.value).toString(),fe=new l(1).div(Z.value).toString());try{De=ve==0?-443636:N.priceToTickIndex(new l(ve),Q,ce)}catch{De=-443636}try{Ge=N.priceToTickIndex(new l(fe),Q,ce)}catch{Ge=443636}ne=ue(De,Number(o.tickSpacing)),ie=ue(Ge,Number(o.tickSpacing)),_e=N.priceToSqrtPriceX64(new l(ve),Q,ce);try{Le=N.priceToSqrtPriceX64(new l(fe),Q,ce)}catch{console.log("0523###test###max###",fe),fe===1/0&&(console.log("0523###test###max###11111"),Le=N.tickIndexToSqrtPriceX64(v.getMaxIndex(Number(o.tickSpacing))))}console.log("0518###pre###tick_lower###",ne,ie,we),console.log("0518###pre###tick_upper###",ie)}else ne=(Oe=Je.value[x.value])==null?void 0:Oe.lower,ie=(We=Je.value[x.value])==null?void 0:We.upper,_e=N.tickIndexToSqrtPriceX64(ne),Le=N.tickIndexToSqrtPriceX64(ie);if(H.value!=="∞"&&ne>=ie){C.value=!0,P.value="",G.value=!0,A.value="";return}if(console.log(ie,we,ne,"1922"),H.value==="∞"||we>=ne&&we<=ie){C.value=!1,G.value=!1;let se;if(P.value||A.value){if(Pe.value){const dt=new l(P.value).mul(Math.pow(10,w.value.decimals)).toString();se=new je(dt)}else{const dt=new l(A.value).mul(Math.pow(10,y.value.decimals)).toString();se=new je(dt)}console.log(Y,"======>directs");const{liquidityAmount:Fe,tokenMaxA:xe,tokenMaxB:Ve,tokenMaxAOrigin:Et,tokenMaxBOrigin:Xt}=m.value.estLiquidityAndcoinAmountFromOneAmounts({tokenA:o.token_a,tokenB:o.token_b,lowerTick:ne,upperTick:ie,coinAmount:se,iscoinA:Y?Pe.value:!Pe.value,roundUp:!0,slippage:Number(R.value)/100,curSqrtPrice:new je(o.current_sqrt_price)});L.value={liquidityAmount:Fe,tokenMaxA:xe,tokenMaxB:Ve,tokenMaxAOrigin:Et,tokenMaxBOrigin:Xt},console.log(xe,Ve,"preAdd"),Y?Pe.value?A.value=Number(Ve)>0?Ve:"":P.value=Number(xe)>0?xe:"":Pe.value?A.value=xe:P.value=Ve}}else if(we>ie){if(Y?P.value="":A.value="",C.value=Y,G.value=!Y,P.value||A.value){let se;if(Y){const Fe=new l(A.value).mul(Math.pow(10,(Ue=y.value)==null?void 0:Ue.decimals)).toString();se=new je(Fe),L.value={liquidityAmount:m.value.estimateLiquidityForCoinB(_e,Le,se),tokenMaxA:0,tokenMaxB:A.value}}else{const Fe=new l(P.value).mul(Math.pow(10,(de=w.value)==null?void 0:de.decimals)).toString();se=new je(Fe),L.value={liquidityAmount:m.value.estimateLiquidityForCoinB(_e,Le,se),tokenMaxA:0,tokenMaxB:P.value}}}}else if(we<ne){if(C.value=!Y,G.value=Y,Y?A.value="":P.value="",P.value||A.value){let se;if(Y){const Fe=new l(P.value).mul(Math.pow(10,w.value.decimals)).toString();se=new je(Fe),L.value={liquidityAmount:m.value.estimateLiquidityForCoinA(_e,Le,se),tokenMaxA:P.value,tokenMaxB:0}}else{const Fe=new l(A.value).mul(Math.pow(10,y.value.decimals)).toString();se=new je(Fe),L.value={liquidityAmount:m.value.estimateLiquidityForCoinA(_e,Le,se),tokenMaxA:A.value,tokenMaxB:0}}}}else C.value=!0,P.value="",G.value=!0,A.value=""};qe(P,(o,v)=>{console.log(P,"===>fromCoinAmount"),o==""&&Pe.value&&(A.value=""),o&&Pe.value&&!K.value&&T()}),qe(A,(o,v)=>{console.log(o,"===>>>>newValsda"),o==""&&!Pe.value&&(P.value=""),o&&!Pe.value&&!K.value&&T()});const S=E("--"),K=E(!1),b=M(()=>X.value.RATES),oe=()=>{const o=b.value&&b.value[w.value.address]&&b.value[w.value.address].price,v=b.value&&b.value[y.value.address]&&b.value[y.value.address].price;if(o&&v){const N=new l(P.value>0?P.value:0).mul(o),ue=new l(A.value>0?A.value:0).mul(v),Q=N.add(ue).toNumber();S.value=Q>0&&Q<.01?"<0.01":Nt(Q,2)}else S.value="--"};qe(()=>[P.value,A.value,K.value],([o,v,N])=>{(o||v)&&!N?oe():(!o||!v)&&!N&&(S.value="--")},{immediate:!0}),qe(()=>S,o=>{console.log(o,"71911111")},{immediate:!0}),qe([Z,H],([o,v])=>{console.log(o,v,"==>minPrice,maxPrice"),Number(o)!==0&&Number(v)!==0&&!K.value?T():Number(o)!==0&&Number(v)!==0&&K.value&&_(),v!=="∞"&&Number(o)!==0&&Number(v)!==0&&Number(o)>=Number(v)?rt.value=!0:rt.value=!1,Number(o)==0&&Number(v)==0&&lt.value&&(rt.value=!0,console.log("价格区间错误"))},{deep:!0,immediate:!0});const U=o=>{console.log(o,"e"),K.value=!0,S.value=o,o>0?_():(P.value="",A.value="")},Ne=E(),_=async()=>{var Y,Oe,We,Ue;if(!Z.value&&!H.value)return!1;if(!P.value&&!A.value&&!Z.value&&!H.value)return;const o=i.value;if(Ie(o))return;const{TickUtil:v,TickMath:N,getNearestTickByTick:ue}=m.value,Q=o==null?void 0:o.token_a.decimals,ce=o==null?void 0:o.token_b.decimals;let ve,fe,ne,ie,_e,Le,De;if(o.token_a.address.toLowerCase()===w.value.address.toLowerCase()&&o.token_b.address.toLowerCase()===y.value.address.toLowerCase()?De=!0:De=!1,Z.value==="0"&&H.value==="∞")ne=v.getMinIndex(Number(o.tickSpacing)),ie=v.getMaxIndex(Number(o.tickSpacing));else if(x.value=="custom"){De?(ve=Number(Z.value),fe=Number(H.value)):(ve=new l(1).div(H.value).toString(),fe=new l(1).div(Z.value).toString());try{_e=ve==0?-443636:N.priceToTickIndex(new l(ve),Q,ce)}catch{_e=-443636}try{Le=N.priceToTickIndex(new l(fe),Q,ce)}catch{Le=443636}ne=ue(_e,Number(o.tickSpacing)),ie=ue(Le,Number(o.tickSpacing))}else ne=(Y=Je.value[x.value])==null?void 0:Y.lower,ie=(Oe=Je.value[x.value])==null?void 0:Oe.upper;const Ge=b.value[(We=o.value)==null?void 0:We.token_a.address].price,we=b.value[(Ue=o.value)==null?void 0:Ue.token_b.address].price;Me.value?new je(o.current_sqrt_price):new je(1/o.current_sqrt_price),console.log(Me.value,"===>direction.value"),console.log(o,"poolInfos===>"),console.log(ne,ie,"####tick_lower tick_upper 889");try{const{amountA:de,amountB:se,tokenAmountsInfo:Fe}=await m.value.estCoinAmountsFromTotalAmount({lowerTick:ne,upperTick:ie,decimalsA:Q,decimalsB:ce,curSqrtPrice:new je(o.current_sqrt_price),totalAmount:S.value,tokenPriceA:Ge,tokenPriceB:we});console.log(de,se,"###estCoinAmountsFromTotalAmount 844"),console.log(o.needReverse,Me.value,"===>849"),Ne.value=Fe,o.needReverse?Me.value?(P.value=de,A.value=se):(P.value=se,A.value=de):(P.value=de,A.value=se)}catch(de){console.log(de,"e===>")}},ae=E(!1),{setTransactionTxid:Ke,setTransactionDesc:t,setIsShowWaiting:p,setIsShowSuccess:B,setPositiomNum:D,setIsShowRejected:Ce}=ge,le=go(),ke=M(()=>X.value.currentPositionInfo),Ae=E(!1),$e=async o=>{var _e,Le,De,Ge;console.log(i.value,"===> poolInfo.value"),ae.value=!1,X.value.currentPositionInfo={},Ke(""),t(e("tips.increaseLiquiditySuccess",{from:C.value?"":`${P.value} ${(_e=w.value)==null?void 0:_e.symbol}`,and:!C.value&&!G.value?"and":"",to:G.value?"":`${A.value} ${(Le=y.value)==null?void 0:Le.symbol}`})),p(!0);const v=Me.value?Pe.value:!Pe.value;let N,ue,Q,ce,ve,fe;const ne=i.value.token_a.decimals,ie=i.value.token_b.decimals;if(Z.value==="0"&&H.value==="∞")Q=m.value.TickUtil.getMinIndex(Number(i.value.tickSpacing)),ce=m.value.TickUtil.getMaxIndex(Number(i.value.tickSpacing));else if(x.value=="custom"){Me.value?(N=Number(Z.value),ue=Number(H.value)):(N=new l(1).div(H.value).toString(),ue=new l(1).div(Z.value).toString()),console.log("0519###toAdd###min###",N),console.log("0519###toAdd###max###",ue),console.log("0519###toAdd###minPrice.value###",Z.value),console.log("0519###toAdd###maxPrice.value###",H.value);try{ve=N==0?m.value.TickUtil.getMinIndex(Number(i.value.tickSpacing)):m.value.TickMath.priceToTickIndex(new l(N),ne,ie)}catch{ve=m.value.TickUtil.getMinIndex(Number(i.value.tickSpacing))}try{fe=m.value.TickMath.priceToTickIndex(new l(ue),ne,ie)}catch{fe=m.value.TickUtil.getMaxIndex(Number(i.value.tickSpacing))}Q=m.value.getNearestTickByTick(ve,Number(i.value.tickSpacing)),ce=m.value.getNearestTickByTick(fe,Number(i.value.tickSpacing))}else Q=Je.value[x.value].lower,ce=Je.value[x.value].upper;console.log(Q,ce,"####tick_lower tick_upper 889"),console.log(i.value,"==>poolInfo.value.curSqrtPrice");try{let we;K.value?we=await m.value.getCreateAddLiquidityPayload({pool:i.value,curSqrtPrice:new je(i.value.current_sqrt_price),tickLower:Q,tickUpper:ce,slippage:Number(R.value)/100,tokenAmounts:Ne.value}):we=await m.value.getAddLiquidityTransactionPayload({pool:{poolAddress:i.value.poolAddress,token_a:i.value.token_a,token_b:i.value.token_b},amount:Pe.value?P.value:A.value,fix_amount_a:v,tick_lower:Q,tick_upper:ce,index:0,slippage:Number(R.value)/100,roundUp:!0,collect_fee:!1,curSqrtPrice:new je(i.value.current_sqrt_price)}),console.log(we,"payload===?");let Y;if(j.value==="Aptos")Y=await k.value.currentWallet.signAndSubmitTransaction(we);else{const Oe=await k.value.currentWallet.signAndExecuteTransactionBlock(we);Y=m.value.handleTx(Oe)}if(console.log("0410###tx###",Y),Y&&Y.hash){Ke(Y.hash),p(!1),B(!0);let Oe;i.value.needReverse?i.value.token_a.address.toLowerCase()===w.value.address.toLowerCase()&&i.value.token_b.address.toLowerCase()===y.value.address.toLowerCase()?Oe=!1:Oe=!0:i.value.token_a.address.toLowerCase()===w.value.address.toLowerCase()&&i.value.token_b.address.toLowerCase()===y.value.address.toLowerCase()?Oe=!0:Oe=!1,console.log(Oe,"===>directs");const We={title:"Supplied",desc:e("tips.addLiquiditySuccessText",{from:C.value?"":`${P.value} ${(De=w.value)==null?void 0:De.symbol}`,and:!C.value&&!G.value?"and":"",to:G.value?"":`${A.value} ${(Ge=y.value)==null?void 0:Ge.symbol}`}),hash:Y.hash,tit:"Position Created",icon:"icon-icon-Position-Created"};j.value!=="Aptos"&&(We.res=Y.res),m.value.showTransitionPending(We);const Ue=await m.value.watchTransaction(We,!0);if(Ue.status){if(B(!1),X.value.setCurrentPositionLoading(!0),Ae.value=!0,console.log(Ue.nftInfo,"===> watchInfo.nftInfo"),j.value==="Aptos"){if(await X.value.setCurrentPositionInfo(Ue.nftInfo[0].data.id.creator,Ue.nftInfo[0].data.id.collection,Ue.nftInfo[0].data.name,j.value),o)try{await le.subscribePosition({pool_address:ke.value.poolAddress,position_index:ke.value.index},ke.value.nftHash)}catch(de){console.log(de,"e")}}else{const de=Ue.nftInfo,se=await Pt(2e3);if(await X.value.setCurrentPositionInfo(de==null?void 0:de.pool,"","",j.value,de==null?void 0:de.position),await Pt(1e3),console.log("0529###nftInfo###",de),console.log("0529###currentPositionInfo.value.index###",ke.value.index),o)try{await le.subscribePosition({pool_address:ke.value.poolAddress,position_index:ke.value.index},ke.value.nftHash)}catch(Fe){console.log(Fe)}}setTimeout(()=>{ye.updateCurrentPools(i.value.poolAddress,j.value),m.value.getAccount(k.value.address)},3e3),setTimeout(async()=>{Tt(m,i)},3e3)}D()}else p(!1),Ce(!0);P.value="",A.value=""}catch(we){P.value="",A.value="",console.log("0330###Add liquidity Error###",we),p(!1),Ce(!0)}},Ze=M(()=>!P.value&&!A.value?(console.log("addLiquidityBtnDisabled11111"),!0):Number(P.value)>Number(z.value)||Number(A.value)>Number(d.value)?(console.log("addLiquidityBtnDisabled22222"),!0):me.value!==e("button.addLiquidity")&&me.value!==e("newAdd.preview")?(console.log("addLiquidityBtnDisabled33333###",me.value),!0):i.value&&i.value&&i.value.is_pause?(console.log("addLiquidityBtnDisabled44444"),!0):Number(P.value)<=0&&Number(A.value)<=0||!C.value&&Number(P.value)==0||!G.value&&Number(A.value)==0),He=M(()=>!w.value||!y.value),me=M(()=>i.value&&i.value.is_pause?"Pool Closed":!w.value||!y.value||He.value?e("modal.selectTokenModalTitle"):Number(P.value)>Number(z.value)?e("button.insufficientBalance",{name:w.value.symbol}):Number(A.value)>Number(d.value)?e("button.insufficientBalance",{name:y.value.symbol}):!Number(P.value)&&!Number(A.value)?e("button.enterAmount"):H.value!=="∞"&&Number(Z.value)>=Number(H.value)?e("newAdd.invalidRange"):e("button.addLiquidity")),Re=E({}),Ye=E({}),it=E(!1),u=(o,v)=>{console.log(s.value,"===>currentCoinKey.value"),console.log(o);const N=localStorage.getItem(o.address);console.log(X.value.tokensObj,"===>pools.value.tokensObj"),console.log(N,"===>coinLocak"),X.value.tokensObj&&X.value.tokensObj[o.address]&&X.value.tokensObj[o.address].isSelfBuilt&&!N&&(v=="fromCoin"&&(Re.value=o),v=="toCoin"&&(Ye.value=o),it.value=!0)};qe(()=>[w.value,y.value],([o,v])=>{o&&!Ie(o)&&u(o,"fromCoin"),v&&!Ie(v)&&u(v,"toCoin")},{immediate:!0});const c=Qt(),Be=()=>{j.value!=="Aptos"?c.push("/pool/list"):c.push("/pools")},pe=o=>{K.value,$e(o)},be=o=>{const v=new RegExp("[^\\d-]*(\\d*(?:\\.\\d{0,2})?).*$");o.target.value=o.target.value.replace(v,"$1")},Dt=()=>{J.query.action!=="create-pool"&&J.query.actions!=="new-position"&&(Tt(m,i),T(),ye.updateCurrentPools(i.value.poolAddress,j.value)),ye.setPoolConfigList(j.value,W.value.filterCoinsObj)},Wt=M(()=>{var N,ue,Q,ce,ve,fe;const o=(Q=b.value[(ue=(N=w)==null?void 0:N.value)==null?void 0:ue.address])==null?void 0:Q.price,v=(fe=b.value[(ve=(ce=y)==null?void 0:ce.value)==null?void 0:ve.address])==null?void 0:fe.price;return!!(o&&v)});return{inputChange:be,poolInfo:i,fromCoinAmount:P,toCoinAmount:A,fromCoin:w,toCoin:y,theme:V,showFromCoinLock:C,showToCoinLock:G,fromCoinBlance:z,toCoinBlance:d,maxBtnSelect:n,halfBtnSelect:f,fixedFromCoin:Pe,openCoinSelect:te,currentCoinKey:s,existingCoins:q,lastSelectCoin:F,showCoinSelect:g,onCoinSelect:re,liquidityTotalAmount:S,toggle:Ft,onInput:U,isInputTotalAmount:K,isViewDetail:Ae,addLiquidityBtnDisabled:Ze,addLiquidityBtnText:me,isShowTokenWarning:it,chainName:j,closeTokenWarning:Be,warningFromCoin:Re,warningToCoin:Ye,isShowLiquidityModal:ae,currentPrice:lt,currentPriceReverse:ht,currentPriceTab:x,minPrice:Z,maxPrice:H,toAdd:$e,direction:Me,wallet:k,getAddLiquidityType:pe,clickRefresh:Dt,isShowtotalAmount:Wt}}});const Gi={class:"new-liquidity-right"},Ki={class:"deposit-title"},Ji={class:"card-container"},Qi={class:"card-item"},Yi={class:"card-item"},xi={key:0,class:"total-amount"},Vi=r("span",null,"Total Amount",-1);function en(e,a,ge,W,j,ye){const X=Rt,$=Bt,k=uo,J=Vt,i=Ot,C=eo,G=co,V=mo,I=vo,z=fo;return h(),O("div",Gi,[r("div",Ki,[ze(X,{"pool-info":e.poolInfo,onClickRefresh:e.clickRefresh},null,8,["pool-info","onClickRefresh"])]),r("div",Ji,[r("div",Qi,[ze($,{modelValue:e.fromCoinAmount,"onUpdate:modelValue":a[0]||(a[0]=d=>e.fromCoinAmount=d),"input-value":e.fromCoinAmount,"coin-symbol":e.fromCoin?e.fromCoin.symbol:null,"coin-name":e.fromCoin?e.fromCoin.name:null,balance:e.fromCoinBlance,"coin-icon":e.fromCoin?e.fromCoin.logoURI:"",address:e.fromCoin?e.fromCoin.address:"","swap-direct":"From","import-page":"deposit","has-arrow":!1,onOnMax:a[1]||(a[1]=d=>e.maxBtnSelect("fromCoin")),onOnHalf:a[2]||(a[2]=d=>e.halfBtnSelect("fromCoin")),onOnInput:a[3]||(a[3]=d=>{e.fromCoinAmount=d,e.fixedFromCoin=!0,e.isInputTotalAmount=!1}),onOnSelect:a[4]||(a[4]=d=>e.openCoinSelect("fromCoin"))},null,8,["modelValue","input-value","coin-symbol","coin-name","balance","coin-icon","address"]),e.showFromCoinLock?(h(),Xe(k,{key:0,"from-coin":e.fromCoin,"to-coin":e.toCoin,"pool-info":e.poolInfo},null,8,["from-coin","to-coin","pool-info"])):ee("",!0)]),r("div",Yi,[ze($,{modelValue:e.toCoinAmount,"onUpdate:modelValue":a[5]||(a[5]=d=>e.toCoinAmount=d),"input-value":e.toCoinAmount,"coin-symbol":e.toCoin?e.toCoin.symbol:null,"coin-name":e.toCoin?e.toCoin.name:null,balance:e.toCoinBlance,"swap-direct":"To","coin-icon":e.toCoin?e.toCoin.logoURI:"",address:e.toCoin?e.toCoin.address:"","import-page":"deposit","has-arrow":!1,onOnMax:a[6]||(a[6]=d=>e.maxBtnSelect("toCoin")),onOnHalf:a[7]||(a[7]=d=>e.halfBtnSelect("toCoin")),onOnInput:a[8]||(a[8]=d=>{e.toCoinAmount=d,e.fixedFromCoin=!1,e.isInputTotalAmount=!1}),onOnSelect:a[9]||(a[9]=d=>e.openCoinSelect("toCoin"))},null,8,["modelValue","input-value","coin-symbol","coin-name","balance","coin-icon","address"]),e.showToCoinLock?(h(),Xe(k,{key:0,"from-coin":e.fromCoin,"to-coin":e.toCoin,"pool-info":e.poolInfo},null,8,["from-coin","to-coin","pool-info"])):ee("",!0)]),e.fromCoin&&e.toCoin&&!e.showToCoinLock&&!e.showFromCoinLock&&e.theme=="default"?(h(),O("img",{key:0,class:"add",src:lo,alt:"",onClick:a[10]||(a[10]=(...d)=>e.toggle&&e.toggle(...d))})):ee("",!0),e.fromCoin&&e.toCoin&&!e.showToCoinLock&&!e.showFromCoinLock&&e.theme!=="default"?(h(),O("img",{key:1,class:"add",src:so,alt:"",onClick:a[11]||(a[11]=(...d)=>e.toggle&&e.toggle(...d))})):ee("",!0)]),e.isShowtotalAmount?(h(),O("div",xi,[Vi,r("span",null,[ze(J,{value:"$"+e.liquidityTotalAmount,placeholder:e.isInputTotalAmount?"":e.liquidityTotalAmount,onChange:e.inputChange,onInput:a[12]||(a[12]=d=>e.onInput(d.target.value))},null,8,["value","placeholder","onChange"])])])):ee("",!0),ze(i,{"from-coin":e.fromCoin,"to-coin":e.toCoin,"from-coin-amount":e.fromCoinAmount,"to-coin-amount":e.toCoinAmount,"fixed-from-coin":e.fixedFromCoin,"is-input-total-amount":e.isInputTotalAmount,"min-price":e.minPrice,"max-price":e.maxPrice,"current-price-tab":e.currentPriceTab,"current-price":e.currentPrice,"current-price-reverse":e.currentPriceReverse},null,8,["from-coin","to-coin","from-coin-amount","to-coin-amount","fixed-from-coin","is-input-total-amount","min-price","max-price","current-price-tab","current-price","current-price-reverse"]),ze(C,{class:"add-liquidity-btn",disabled:e.addLiquidityBtnDisabled,onClick:a[13]||(a[13]=d=>e.wallet.connected?e.isShowLiquidityModal=!0:e.wallet.setIsShowWalletModal(!0))},{default:Yt(()=>[xt(he(e.wallet.connected?e.addLiquidityBtnText:e.$t("button.connectWallet")),1)]),_:1},8,["disabled"]),e.showCoinSelect?(h(),Xe(G,{key:1,"existing-coins":e.existingCoins,"last-select-coin":e.lastSelectCoin,onOnSelect:e.onCoinSelect,onOnClose:a[14]||(a[14]=d=>e.showCoinSelect=!1)},null,8,["existing-coins","last-select-coin","onOnSelect"])):ee("",!0),e.isViewDetail?(h(),Xe(V,{key:2,"pool-info":e.poolInfo,onOnClose:a[15]||(a[15]=d=>e.isViewDetail=!1)},null,8,["pool-info"])):ee("",!0),e.chainName=="Sui"&&e.isShowTokenWarning?(h(),Xe(I,{key:3,"from-coin":e.warningFromCoin,"to-coin":e.warningToCoin,onClose:e.closeTokenWarning,onClickContinue:a[16]||(a[16]=d=>e.isShowTokenWarning=!1)},null,8,["from-coin","to-coin","onClose"])):ee("",!0),e.isShowLiquidityModal?(h(),Xe(z,{key:4,"pool-info":e.poolInfo,title:e.$t("button.addLiquidity"),"from-coin-amount":e.fromCoinAmount,"to-coin-amount":e.toCoinAmount,"from-coin":e.fromCoin,"to-coin":e.toCoin,"fixed-from-coin":e.fixedFromCoin,"current-price":e.currentPrice,"current-price-reverse":e.currentPriceReverse,"current-price-tab":e.currentPriceTab,"min-price":e.minPrice,"max-price":e.maxPrice,"show-from-coin-lock":e.showFromCoinLock,"show-to-coin-lock":e.showToCoinLock,"current-direct":e.direction,"is-increase":!1,onToAdd:e.getAddLiquidityType,onOnClose:a[17]||(a[17]=d=>e.isShowLiquidityModal=!1)},null,8,["pool-info","title","from-coin-amount","to-coin-amount","from-coin","to-coin","fixed-from-coin","current-price","current-price-reverse","current-price-tab","min-price","max-price","show-from-coin-lock","show-to-coin-lock","current-direct","onToAdd"])):ee("",!0)])}const Ht=ot(Zi,[["render",en]]),tn=tt({components:{NewLiquidityLeft:zt,NewLiquidityRight:Ht},setup(){Mt(()=>{ao()});const e=yt();return{tickList:et,route:e}}});const on={key:0,class:"loading-spin-liquidity loading-global"},nn={class:"privide-liquidity"};function rn(e,a,ge,W,j,ye){var J,i;const X=wt,$=zt,k=Ht;return h(),O(ut,null,[!e.tickList&&((i=(J=e.route)==null?void 0:J.query)!=null&&i.poolAddress)?(h(),O("div",on,[ze(X)])):ee("",!0),r("div",nn,[ze($),ze(k)])],64)}const Un=ot(tn,[["render",rn],["__scopeId","data-v-58b2e9d3"]]);export{Un as default};
