var Gs=Object.defineProperty;var Ws=(t,e,n)=>e in t?Gs(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var $=(t,e,n)=>(Ws(t,typeof e!="symbol"?e+"":e,n),n);import{f as Ro,s as c,u as V,o as g,n as E,l as T,d as Pe,r as Pt,b as J,a as O,c as w,e as qt,g as Be,h as xo,i as A,t as gt,j as kt,B as G,k as Js,m as Ks,p as Ut,q as Xs,v as Qe,w as _n,x as zs,y as Hs,z as Zs,A as fe,C as xe,D as Qs,E as X,F as p,G as Ys,H as so,I as ti,J as Wt,K as on,T as ei,L as Ye,M as ni,N as wn,O as bn,P as jo,Q as Ht,R as St}from"./index.01287209.js";import{a as Ct,w as oi,b as io,h as st,i as le,e as si,f as Rn,j as xn,r as yn,k as tn,o as j,l as D,m as b,u as rt,t as ot,p as Zt,q as ro,s as Do,v as Mo,x as ii,y as Rt,z as je,A as De,F as ao,B as co,C as ri,S as ai,D as ci}from"./entry.715dbc8e.js";const No="3.7.5",ui=No,li=typeof atob=="function",di=typeof btoa=="function",be=typeof Buffer=="function",uo=typeof TextDecoder=="function"?new TextDecoder:void 0,lo=typeof TextEncoder=="function"?new TextEncoder:void 0,pi="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",ve=Array.prototype.slice.call(pi),Me=(t=>{let e={};return t.forEach((n,o)=>e[n]=o),e})(ve),hi=/^(?:[A-Za-z\d+\/]{4})*?(?:[A-Za-z\d+\/]{2}(?:==)?|[A-Za-z\d+\/]{3}=?)?$/,dt=String.fromCharCode.bind(String),po=typeof Uint8Array.from=="function"?Uint8Array.from.bind(Uint8Array):t=>new Uint8Array(Array.prototype.slice.call(t,0)),Fo=t=>t.replace(/=/g,"").replace(/[+\/]/g,e=>e=="+"?"-":"_"),qo=t=>t.replace(/[^A-Za-z0-9\+\/]/g,""),Lo=t=>{let e,n,o,s,i="";const r=t.length%3;for(let a=0;a<t.length;){if((n=t.charCodeAt(a++))>255||(o=t.charCodeAt(a++))>255||(s=t.charCodeAt(a++))>255)throw new TypeError("invalid character found");e=n<<16|o<<8|s,i+=ve[e>>18&63]+ve[e>>12&63]+ve[e>>6&63]+ve[e&63]}return r?i.slice(0,r-3)+"===".substring(r):i},jn=di?t=>btoa(t):be?t=>Buffer.from(t,"binary").toString("base64"):Lo,vn=be?t=>Buffer.from(t).toString("base64"):t=>{let n=[];for(let o=0,s=t.length;o<s;o+=4096)n.push(dt.apply(null,t.subarray(o,o+4096)));return jn(n.join(""))},We=(t,e=!1)=>e?Fo(vn(t)):vn(t),fi=t=>{if(t.length<2){var e=t.charCodeAt(0);return e<128?t:e<2048?dt(192|e>>>6)+dt(128|e&63):dt(224|e>>>12&15)+dt(128|e>>>6&63)+dt(128|e&63)}else{var e=65536+(t.charCodeAt(0)-55296)*1024+(t.charCodeAt(1)-56320);return dt(240|e>>>18&7)+dt(128|e>>>12&63)+dt(128|e>>>6&63)+dt(128|e&63)}},gi=/[\uD800-\uDBFF][\uDC00-\uDFFFF]|[^\x00-\x7F]/g,$o=t=>t.replace(gi,fi),ho=be?t=>Buffer.from(t,"utf8").toString("base64"):lo?t=>vn(lo.encode(t)):t=>jn($o(t)),ge=(t,e=!1)=>e?Fo(ho(t)):ho(t),fo=t=>ge(t,!0),mi=/[\xC0-\xDF][\x80-\xBF]|[\xE0-\xEF][\x80-\xBF]{2}|[\xF0-\xF7][\x80-\xBF]{3}/g,_i=t=>{switch(t.length){case 4:var e=(7&t.charCodeAt(0))<<18|(63&t.charCodeAt(1))<<12|(63&t.charCodeAt(2))<<6|63&t.charCodeAt(3),n=e-65536;return dt((n>>>10)+55296)+dt((n&1023)+56320);case 3:return dt((15&t.charCodeAt(0))<<12|(63&t.charCodeAt(1))<<6|63&t.charCodeAt(2));default:return dt((31&t.charCodeAt(0))<<6|63&t.charCodeAt(1))}},Uo=t=>t.replace(mi,_i),Vo=t=>{if(t=t.replace(/\s+/g,""),!hi.test(t))throw new TypeError("malformed base64.");t+="==".slice(2-(t.length&3));let e,n="",o,s;for(let i=0;i<t.length;)e=Me[t.charAt(i++)]<<18|Me[t.charAt(i++)]<<12|(o=Me[t.charAt(i++)])<<6|(s=Me[t.charAt(i++)]),n+=o===64?dt(e>>16&255):s===64?dt(e>>16&255,e>>8&255):dt(e>>16&255,e>>8&255,e&255);return n},Dn=li?t=>atob(qo(t)):be?t=>Buffer.from(t,"base64").toString("binary"):Vo,Go=be?t=>po(Buffer.from(t,"base64")):t=>po(Dn(t).split("").map(e=>e.charCodeAt(0))),Wo=t=>Go(Jo(t)),wi=be?t=>Buffer.from(t,"base64").toString("utf8"):uo?t=>uo.decode(Go(t)):t=>Uo(Dn(t)),Jo=t=>qo(t.replace(/[-_]/g,e=>e=="-"?"+":"/")),An=t=>wi(Jo(t)),bi=t=>{if(typeof t!="string")return!1;const e=t.replace(/\s+/g,"").replace(/={0,2}$/,"");return!/[^\s0-9a-zA-Z\+/]/.test(e)||!/[^\s0-9a-zA-Z\-_]/.test(e)},Ko=t=>({value:t,enumerable:!1,writable:!0,configurable:!0}),Xo=function(){const t=(e,n)=>Object.defineProperty(String.prototype,e,Ko(n));t("fromBase64",function(){return An(this)}),t("toBase64",function(e){return ge(this,e)}),t("toBase64URI",function(){return ge(this,!0)}),t("toBase64URL",function(){return ge(this,!0)}),t("toUint8Array",function(){return Wo(this)})},zo=function(){const t=(e,n)=>Object.defineProperty(Uint8Array.prototype,e,Ko(n));t("toBase64",function(e){return We(this,e)}),t("toBase64URI",function(){return We(this,!0)}),t("toBase64URL",function(){return We(this,!0)})},yi=()=>{Xo(),zo()},Je={version:No,VERSION:ui,atob:Dn,atobPolyfill:Vo,btoa:jn,btoaPolyfill:Lo,fromBase64:An,toBase64:ge,encode:ge,encodeURI:fo,encodeURL:fo,utob:$o,btou:Uo,decode:An,isValid:bi,fromUint8Array:We,toUint8Array:Wo,extendString:Xo,extendUint8Array:zo,extendBuiltins:yi},vi=32;function go(t){try{return Ro(t).length===vi}catch{return!1}}const Ho=32;function Xt(t){return Ai(t)&&Ci(t)===Ho}function Ae(t){return Xt(t)}function at(t,e=!1){let n=t.toLowerCase();return!e&&n.startsWith("0x")&&(n=n.slice(2)),`0x${n.padStart(Ho*2,"0")}`}function ht(t,e=!1){return at(t,e)}function Ai(t){return/^(0x|0X)?[a-fA-F0-9]+$/.test(t)&&t.length%2===0}function Ci(t){return/^(0x|0X)/.test(t)?(t.length-2)/2:t.length/2}BigInt(1e9);ht("0x6");ht("0x5");c();c();c();c();c();c();const ae=V([g({AddressOwner:c()}),g({ObjectOwner:c()}),g({Shared:g({initial_shared_version:E(c())})}),T("Immutable")]),Ti=Pe("SuiJsonValue",()=>!0),ki=V([g({u32:c()}),g({u64:c()}),g({f64:c()})]);g({attributes:Pt(c(),E(ki)),featureFlags:Pt(c(),J()),maxSupportedProtocolVersion:c(),minSupportedProtocolVersion:c(),protocolVersion:c()});V([c(),T("package")]);const Et=g({digest:c(),objectId:c(),version:V([O(),c()])}),Si=g({payment:w(Et),owner:c(),price:c(),budget:c()}),Ii=qt(Et,g({type:c(),owner:ae,previousTransaction:c()})),Pi=Pt(c(),Be()),Bi=Pt(c(),xo()),Oi=g({type:c(),fields:Pi,hasPublicTransfer:J()}),Cn=g({disassembled:Bi}),Ei=V([qt(Oi,g({dataType:T("moveObject")})),qt(Cn,g({dataType:T("package")}))]),Ri=g({type:c(),hasPublicTransfer:J(),version:c(),bcsBytes:c()}),xi=g({id:c(),moduleMap:Pt(c(),c())}),ji=V([qt(Ri,g({dataType:T("moveObject")})),qt(xi,g({dataType:T("package")}))]);BigInt(1e9);c();const Zo=g({code:c(),error:A(c()),object_id:A(c()),parent_object_id:A(c()),version:A(c()),digest:A(c())}),Di=g({data:E(A(Pt(c(),c()))),error:E(A(Zo))}),Mi=V([Di,A(Pt(c(),c()))]),Qo=g({objectId:c(),version:c(),digest:c(),type:E(A(c())),content:E(A(Ei)),bcs:E(A(ji)),owner:E(A(ae)),previousTransaction:E(A(c())),storageRebate:E(A(c())),display:E(A(Mi))});g({showType:E(A(J())),showContent:E(A(J())),showBcs:E(A(J())),showOwner:E(A(J())),showPreviousTransaction:E(A(J())),showStorageRebate:E(A(J())),showDisplay:E(A(J()))});V([T("Exists"),T("notExists"),T("Deleted")]);w(Ii);const Ni=g({data:E(A(Qo)),error:E(A(Zo))});function Fi(t){return t.data}function qi(t){if(t.error&&"object_id"in t.error&&"version"in t.error&&"digest"in t.error){const e=t.error;return{objectId:e.object_id,version:e.version,digest:e.digest}}}function Li(t){if("reference"in t)return t.reference;const e=Fi(t);return e?{objectId:e.objectId,version:e.version,digest:e.digest}:qi(t)}g({objectId:c(),atCheckpoint:A(O())});g({data:w(Ni),nextCursor:A(E(c())),hasNextPage:J()});V([g({details:Qo,status:T("VersionFound")}),g({details:c(),status:T("ObjectNotExists")}),g({details:Et,status:T("ObjectDeleted")}),g({details:gt([c(),O()]),status:T("VersionNotFound")}),g({details:g({asked_version:O(),latest_version:O(),object_id:c()}),status:T("VersionTooHigh")})]);const Yo=g({txDigest:c(),eventSeq:c()}),ts=g({id:Yo,packageId:c(),transactionModule:c(),sender:c(),type:c(),parsedJson:A(Pt(c(),Be())),bcs:A(c()),timestampMs:A(c())});g({data:w(ts),nextCursor:E(Yo),hasNextPage:J()});c();const $i=g({epoch:c(),storage_charge:c(),computation_charge:c(),storage_rebate:c(),epoch_start_timestamp_ms:A(c())}),Ui=g({epoch:c(),round:c(),commit_timestamp_ms:c()}),Vi=g({objects:w(c())}),Ot=V([T("GasCoin"),g({Input:O()}),g({Result:O()}),g({NestedResult:gt([O(),O()])})]),Gi=g({arguments:A(w(Ot)),type_arguments:A(w(c())),package:c(),module:c(),function:c()}),Wi=V([g({MoveCall:Gi}),g({TransferObjects:gt([w(Ot),Ot])}),g({SplitCoins:gt([Ot,w(Ot)])}),g({MergeCoins:gt([Ot,w(Ot)])}),g({Publish:V([gt([Cn,w(c())]),w(c())])}),g({Upgrade:V([gt([Cn,w(c()),c(),Ot]),gt([w(c()),c(),Ot])])}),g({MakeMoveVec:gt([E(c()),w(Ot)])})]),Ji=V([g({type:T("pure"),valueType:E(c()),value:Ti}),g({type:T("object"),objectType:T("immOrOwnedObject"),objectId:c(),version:c(),digest:c()}),g({type:T("object"),objectType:T("sharedObject"),objectId:c(),initialSharedVersion:c(),mutable:J()})]),Ki=g({transactions:w(Wi),inputs:w(Ji)}),Xi=V([qt($i,g({kind:T("ChangeEpoch")})),qt(Ui,g({kind:T("ConsensusCommitPrologue")})),qt(Vi,g({kind:T("Genesis")})),qt(Ki,g({kind:T("ProgrammableTransaction")}))]),es=g({messageVersion:T("v1"),transaction:Xi,sender:c(),gasData:Si});c();const zi=V([c(),w(c())]);g({epoch:c(),signature:zi,signers_map:w(O())});const Hi=g({computationCost:c(),storageCost:c(),storageRebate:c(),nonRefundableStorageFee:c()}),Zi=V([T("success"),T("failure")]),Qi=g({status:Zi,error:A(c())}),Ne=g({owner:ae,reference:Et}),Yi=g({objectId:c(),sequenceNumber:c()}),Mn=g({messageVersion:T("v1"),status:Qi,executedEpoch:c(),modifiedAtVersions:A(w(Yi)),gasUsed:Hi,sharedObjects:A(w(Et)),transactionDigest:c(),created:A(w(Ne)),mutated:A(w(Ne)),unwrapped:A(w(Ne)),deleted:A(w(Et)),unwrappedThenDeleted:A(w(Et)),wrapped:A(w(Et)),gasObject:Ne,eventsDigest:E(A(c())),dependencies:A(w(c()))}),Nn=w(ts),tr=gt([w(O()),c()]),er=gt([Ot,w(O()),c()]),nr=g({mutableReferenceOutputs:A(w(er)),returnValues:A(w(tr))});g({effects:Mn,events:Nn,results:A(w(nr)),error:A(c())});c();const or=g({data:es,txSignatures:w(c())}),sr=g({type:T("published"),packageId:c(),version:c(),digest:c(),modules:w(c())}),ir=g({type:T("transferred"),sender:c(),recipient:ae,objectType:c(),objectId:c(),version:c(),digest:c()}),rr=g({type:T("mutated"),sender:c(),owner:ae,objectType:c(),objectId:c(),version:c(),previousVersion:c(),digest:c()}),ar=g({type:T("deleted"),sender:c(),objectType:c(),objectId:c(),version:c()}),cr=g({type:T("wrapped"),sender:c(),objectType:c(),objectId:c(),version:c()}),ur=g({type:T("created"),sender:c(),owner:ae,objectType:c(),objectId:c(),version:c(),digest:c()}),ns=V([sr,ir,rr,ar,cr,ur]),os=g({owner:ae,coinType:c(),amount:c()}),lr=g({digest:c(),transaction:A(or),effects:A(Mn),events:A(Nn),timestampMs:A(c()),checkpoint:A(c()),confirmedLocalExecution:A(J()),objectChanges:A(w(ns)),balanceChanges:A(w(os)),errors:A(w(c()))});g({showInput:A(J()),showEffects:A(J()),showEvents:A(J()),showObjectChanges:A(J()),showBalanceChanges:A(J())});g({data:w(lr),nextCursor:E(c()),hasNextPage:J()});g({effects:Mn,events:Nn,objectChanges:w(ns),balanceChanges:w(os),input:A(es)});const dr=V([c(),g({Object:c()})]);w(dr);const pr=g({address:c(),name:c()}),hr=V([T("Private"),T("Public"),T("Friend")]),Fn=g({abilities:w(c())}),fr=g({constraints:Fn,isPhantom:J()}),gr=g({TypeParameter:O()}),un=gt([g({module:c(),package:c(),function:c()}),c()]);g({rank3Days:w(un),rank7Days:w(un),rank30Days:w(un)});function ss(t){if(!t)return!1;if(typeof t=="string"||kt(t,gr)||is(t))return!0;if(typeof t!="object")return!1;const e=t;return!!(kt(e.Reference,me)||kt(e.MutableReference,me)||kt(e.Vector,me))}const me=Pe("SuiMoveNormalizedType",ss);function is(t){if(!t||typeof t!="object")return!1;const e=t;if(!e.Struct||typeof e.Struct!="object")return!1;const n=e.Struct;return!(typeof n.address!="string"||typeof n.module!="string"||typeof n.name!="string"||!Array.isArray(n.typeArguments)||!n.typeArguments.every(o=>ss(o)))}Pe("SuiMoveNormalizedStructType",is);const mr=g({visibility:hr,isEntry:J(),typeParameters:w(Fn),parameters:w(me),return:w(me)}),_r=g({name:c(),type:me}),wr=g({abilities:Fn,typeParameters:w(fr),fields:w(_r)}),br=g({fileFormatVersion:O(),address:c(),name:c(),friends:w(pr),structs:Pt(c(),wr),exposedFunctions:Pt(c(),mr)});Pt(c(),br);function rs(t){return typeof t=="object"&&"MutableReference"in t?t.MutableReference:void 0}function yr(t){return typeof t=="object"&&"Reference"in t?t.Reference:void 0}function as(t){if(typeof t=="object"&&"Struct"in t)return t;const e=yr(t),n=rs(t);if(typeof e=="object"&&"Struct"in e)return e;if(typeof n=="object"&&"Struct"in n)return n}const vr=g({apy:O(),address:c()});g({epoch:c(),apys:w(vr)});g({value:O()});const Ar=g({stakedSuiId:c(),stakeRequestEpoch:c(),stakeActiveEpoch:c(),principal:c(),status:V([T("Active"),T("Pending"),T("Unstaked")]),estimatedReward:A(c())});g({validatorAddress:c(),stakingPool:c(),stakes:w(Ar)});const Cr=g({balance:g({value:O()}),distribution_counter:O(),current_distribution_amount:O(),stake_subsidy_period_length:O(),stake_subsidy_decrease_rate:O()});g({type:c(),fields:Cr});g({value:O()});const Tr=g({id:c(),size:O(),head:g({vec:w()}),tail:g({vec:w()})});g({id:c(),size:O()});g({type:c(),fields:Tr});const kr=g({exchangeRates:g({id:c(),size:O()}),id:c(),pendingStake:O(),pendingPoolTokenWithdraw:O(),pendingTotalSuiWithdraw:O(),poolTokenBalance:O(),rewardsPool:g({value:O()}),activationEpoch:g({vec:w()}),deactivationEpoch:g({vec:w()}),suiBalance:O()});g({type:c(),fields:kr});const Sr=w(gt([c(),c()]));g({epoch:c(),validators:Sr});const cs=g({suiAddress:c(),protocolPubkeyBytes:c(),networkPubkeyBytes:c(),workerPubkeyBytes:c(),proofOfPossessionBytes:c(),operationCapId:c(),name:c(),description:c(),imageUrl:c(),projectUrl:c(),p2pAddress:c(),netAddress:c(),primaryAddress:c(),workerAddress:c(),nextEpochProtocolPubkeyBytes:E(c()),nextEpochProofOfPossession:E(c()),nextEpochNetworkPubkeyBytes:E(c()),nextEpochWorkerPubkeyBytes:E(c()),nextEpochNetAddress:E(c()),nextEpochP2pAddress:E(c()),nextEpochPrimaryAddress:E(c()),nextEpochWorkerAddress:E(c()),votingPower:c(),gasPrice:c(),commissionRate:c(),nextEpochStake:c(),nextEpochGasPrice:c(),nextEpochCommissionRate:c(),stakingPoolId:c(),stakingPoolActivationEpoch:E(c()),stakingPoolDeactivationEpoch:E(c()),stakingPoolSuiBalance:c(),rewardsPool:c(),poolTokenBalance:c(),pendingStake:c(),pendingPoolTokenWithdraw:c(),pendingTotalSuiWithdraw:c(),exchangeRatesId:c(),exchangeRatesSize:c()});g({epoch:c(),protocolVersion:c(),systemStateVersion:c(),storageFundTotalObjectStorageRebates:c(),storageFundNonRefundableBalance:c(),referenceGasPrice:c(),safeMode:J(),safeModeStorageRewards:c(),safeModeComputationRewards:c(),safeModeStorageRebates:c(),safeModeNonRefundableStorageFee:c(),epochStartTimestampMs:c(),epochDurationMs:c(),stakeSubsidyStartEpoch:c(),maxValidatorCount:c(),minValidatorJoiningStake:c(),validatorLowStakeThreshold:c(),validatorVeryLowStakeThreshold:c(),validatorLowStakeGracePeriod:c(),stakeSubsidyBalance:c(),stakeSubsidyDistributionCounter:c(),stakeSubsidyCurrentDistributionAmount:c(),stakeSubsidyPeriodLength:c(),stakeSubsidyDecreaseRate:O(),totalStake:c(),activeValidators:w(cs),pendingActiveValidatorsId:c(),pendingActiveValidatorsSize:c(),pendingRemovals:w(c()),stakingPoolMappingsId:c(),stakingPoolMappingsSize:c(),inactivePoolsId:c(),inactivePoolsSize:c(),validatorCandidatesId:c(),validatorCandidatesSize:c(),atRiskValidators:w(gt([c(),c()])),validatorReportRecords:w(gt([c(),w(c())]))});const Ir=g({coinType:c(),coinObjectId:c(),version:c(),digest:c(),balance:c(),previousTransaction:c()});g({data:w(Ir),nextCursor:E(c()),hasNextPage:J()});g({coinType:c(),coinObjectCount:O(),totalBalance:c(),lockedBalance:g({epochId:A(O()),number:A(O())})});g({value:c()});const Pr=g({lastCheckpointId:c(),epochEndTimestamp:c(),protocolVersion:c(),referenceGasPrice:c(),totalStake:c(),storageFundReinvestment:c(),storageCharge:c(),storageRebate:c(),storageFundBalance:c(),stakeSubsidyAmount:c(),totalGasFees:c(),totalStakeRewardsDistributed:c(),leftoverStorageFundInflow:c()}),Br=g({epoch:c(),validators:w(cs),epochTotalTransactions:c(),firstCheckpointId:c(),epochStartTimestamp:c(),endOfEpochInfo:E(Pr),referenceGasPrice:E(O())});g({data:w(Br),nextCursor:E(c()),hasNextPage:J()});g({data:w(c()),hasNextPage:J(),nextCursor:E(c())});const Or=V([T("DynamicField"),T("DynamicObject")]),Er=g({type:c(),value:Be()}),Rr=g({name:Er,bcsName:c(),type:Or,objectType:c(),objectId:c(),version:O(),digest:c()});g({data:w(Rr),nextCursor:E(c()),hasNextPage:J()});const xr=g({computationCost:c(),storageCost:c(),storageRebate:c(),nonRefundableStorageFee:c()});c();c();g({digest:w(O())});const us=Be();c();const jr=g({nextEpochCommittee:w(gt([c(),c()])),nextEpochProtocolVersion:c(),epochCommitments:w(us)});g({transaction:c(),effects:c()});const Dr=g({epoch:c(),sequenceNumber:c(),digest:c(),networkTotalTransactions:c(),previousDigest:A(c()),epochRollingGasCostSummary:xr,timestampMs:c(),endOfEpochData:A(jr),validatorSignature:c(),transactions:w(c()),checkpointCommitments:w(us)});g({data:w(Dr),nextCursor:E(c()),hasNextPage:J()});g({currentTps:O(),tps30Days:O(),currentCheckpoint:c(),currentEpoch:c(),totalAddresses:c(),totalObjects:c(),totalPackages:c()});const Mr=g({checkpoint:O(),epoch:O(),timestampMs:O(),cumulativeAddresses:O(),cumulativeActiveAddresses:O(),dailyActiveAddresses:O()});w(Mr);const ls="0x2",qn="0x1",Nr="object",Fr="ID",qr=`${ls}::sui::SUI`;ht("0x6");g({decimals:O(),name:c(),symbol:c(),description:c(),iconUrl:E(c()),id:E(c())});const Lr="ascii",$r="String",Ur="string",Vr="String",Gr="option",Wr="Option",Jr={address:ls,module:Nr,name:Fr},Kr={address:qn,module:Lr,name:$r},Xr={address:qn,module:Ur,name:Vr},zr={address:qn,module:Gr,name:Wr},Fe=(t,e)=>t.address===e.address&&t.module===e.module&&t.name===e.name;function Hr(t){var n;const e=(n=as(t))==null?void 0:n.Struct;return(e==null?void 0:e.address)==="0x2"&&(e==null?void 0:e.module)==="tx_context"&&(e==null?void 0:e.name)==="TxContext"}function ln(t,e){if(!(typeof e>"u")&&typeof e!==t)throw new Error(`Expect ${e} to be ${t}, received ${typeof e}`)}const Zr=["Address","Bool","U8","U16","U32","U64","U128","U256"];function Tn(t,e){if(typeof t=="string"&&Zr.includes(t)){if(t in["U8","U16","U32","U64","U128","U256"])ln("number",e);else if(t==="Bool")ln("boolean",e);else if(t==="Address"&&(ln("string",e),e&&!Xt(e)))throw new Error("Invalid Sui Address");return t.toLowerCase()}else if(typeof t=="string")throw new Error(`Unknown pure normalized type ${JSON.stringify(t,null,2)}`);if("Vector"in t){if((e===void 0||typeof e=="string")&&t.Vector==="U8")return"string";if(e!==void 0&&!Array.isArray(e))throw new Error(`Expect ${e} to be a array, received ${typeof e}`);const n=Tn(t.Vector,e?e[0]:void 0);return n===void 0?void 0:`vector<${n}>`}if("Struct"in t){if(Fe(t.Struct,Kr))return"string";if(Fe(t.Struct,Xr))return"utf8string";if(Fe(t.Struct,Jr))return"address";if(Fe(t.Struct,zr)){const n={Vector:t.Struct.typeArguments[0]};return Tn(n,e)}}}const de="vector",Qr={kind:"TransactionKind",sender:G.ADDRESS,gasData:"GasData",expiration:"TransactionExpiration"},Yr={enums:{"Option<T>":{None:null,Some:"T"},ObjectArg:{ImmOrOwned:"SuiObjectRef",Shared:"SharedObjectRef"},CallArg:{Pure:[de,G.U8],Object:"ObjectArg",ObjVec:[de,"ObjectArg"]},TypeTag:{bool:null,u8:null,u64:null,u128:null,address:null,signer:null,vector:"TypeTag",struct:"StructTag",u16:null,u32:null,u256:null},TransactionKind:{ProgrammableTransaction:"ProgrammableTransaction",ChangeEpoch:null,Genesis:null,ConsensusCommitPrologue:null},TransactionExpiration:{None:null,Epoch:"unsafe_u64"},TransactionData:{V1:"TransactionDataV1"}},structs:{SuiObjectRef:{objectId:G.ADDRESS,version:G.U64,digest:"ObjectDigest"},SharedObjectRef:{objectId:G.ADDRESS,initialSharedVersion:G.U64,mutable:G.BOOL},StructTag:{address:G.ADDRESS,module:G.STRING,name:G.STRING,typeParams:[de,"TypeTag"]},GasData:{payment:[de,"SuiObjectRef"],owner:G.ADDRESS,price:G.U64,budget:G.U64},SenderSignedData:{data:"TransactionData",txSignatures:[de,[de,G.U8]]},TransactionDataV1:Qr},aliases:{ObjectDigest:G.BASE58}},Ln=new G({...Js(),types:Yr});Ln.registerType("utf8string",(t,e)=>{const n=Array.from(new TextEncoder().encode(e));return t.writeVec(n,(o,s)=>o.write8(s))},t=>{let e=t.readVec(n=>n.read8());return new TextDecoder().decode(new Uint8Array(e))});Ln.registerType("unsafe_u64",(t,e)=>t.write64(e),t=>Number.parseInt(t.read64(),10));const ta=/^vector<(.+)>$/,ea=/^([^:]+)::([^:]+)::([^<]+)(<(.+)>)?/;class Nt{static parseFromStr(e,n=!1){if(e==="address")return{address:null};if(e==="bool")return{bool:null};if(e==="u8")return{u8:null};if(e==="u16")return{u16:null};if(e==="u32")return{u32:null};if(e==="u64")return{u64:null};if(e==="u128")return{u128:null};if(e==="u256")return{u256:null};if(e==="signer")return{signer:null};const o=e.match(ta);if(o)return{vector:Nt.parseFromStr(o[1],n)};const s=e.match(ea);if(s)return{struct:{address:n?at(s[1]):s[1],module:s[2],name:s[3],typeParams:s[5]===void 0?[]:Nt.parseStructTypeArgs(s[5],n)}};throw new Error(`Encountered unexpected token when parsing type args for ${e}`)}static parseStructTypeArgs(e,n=!1){return Ks(e).map(o=>Nt.parseFromStr(o,n))}static tagToString(e){if("bool"in e)return"bool";if("u8"in e)return"u8";if("u16"in e)return"u16";if("u32"in e)return"u32";if("u64"in e)return"u64";if("u128"in e)return"u128";if("u256"in e)return"u256";if("address"in e)return"address";if("signer"in e)return"signer";if("vector"in e)return`vector<${Nt.tagToString(e.vector)}>`;if("struct"in e){const n=e.struct,o=n.typeParams.map(Nt.tagToString).join(", ");return`${n.address}::${n.module}::${n.name}${o?`<${o}>`:""}`}throw new Error("Invalid TypeTag")}}const ds="Argument",ft="vector",na="Option",oa="CallArg",mo="TypeTag",sa="ProgrammableTransaction",kn="ProgrammableMoveCall",ps="Transaction",_o="CompressedSignature",wo="PublicKey",bo="MultiSigPublicKey",yo="MultiSigPkMap",ia="MultiSig",$n="EnumKind",ra=[$n,ps],Mt=[$n,ds],hs="SimpleProgrammableMoveCall",It=new G(Ln);Un(It,"FixedArray[64]",64);Un(It,"FixedArray[33]",33);Un(It,"FixedArray[32]",32);It.registerStructType(sa,{inputs:[ft,oa],transactions:[ft,ra]}).registerEnumType(ds,{GasCoin:null,Input:{index:G.U16},Result:{index:G.U16},NestedResult:{index:G.U16,resultIndex:G.U16}}).registerStructType(kn,{package:G.ADDRESS,module:G.STRING,function:G.STRING,type_arguments:[ft,mo],arguments:[ft,Mt]}).registerEnumType(ps,{MoveCall:hs,TransferObjects:{objects:[ft,Mt],address:Mt},SplitCoins:{coin:Mt,amounts:[ft,Mt]},MergeCoins:{destination:Mt,sources:[ft,Mt]},Publish:{modules:[ft,[ft,G.U8]],dependencies:[ft,G.ADDRESS]},MakeMoveVec:{type:[na,mo],objects:[ft,Mt]},Upgrade:{modules:[ft,[ft,G.U8]],dependencies:[ft,G.ADDRESS],packageId:G.ADDRESS,ticket:Mt}}).registerEnumType(_o,{ED25519:["FixedArray[64]","u8"],Secp256k1:["FixedArray[64]","u8"],Secp256r1:["FixedArray[64]","u8"]}).registerEnumType(wo,{ED25519:["FixedArray[32]","u8"],Secp256k1:["FixedArray[33]","u8"],Secp256r1:["FixedArray[33]","u8"]}).registerStructType(yo,{pubKey:wo,weight:G.U8}).registerStructType(bo,{pk_map:[ft,yo],threshold:G.U16}).registerStructType(ia,{sigs:[ft,_o],bitmap:G.U16,multisig_pk:bo});It.registerType([$n,"T"],function(e,n,o,s){const r={[n.kind]:n},[a]=o;return this.getTypeInterface(a)._encodeRaw.call(this,e,r,o,s)},function(e,n,o){const[s]=n,i=this.getTypeInterface(s)._decodeRaw.call(this,e,n,o),r=Object.keys(i)[0];return{kind:r,...i[r]}},t=>{if(typeof t!="object"&&!("kind"in t))throw new Error(`EnumKind: Missing property "kind" in the input ${JSON.stringify(t)}`);return!0});It.registerType(hs,function(e,n,o,s){const[i,r,a]=n.target.split("::"),u=n.typeArguments.map(l=>Nt.parseFromStr(l,!0));return this.getTypeInterface(kn)._encodeRaw.call(this,e,{package:at(i),module:r,function:a,type_arguments:u,arguments:n.arguments},o,s)},function(e,n,o){let s=It.getTypeInterface(kn)._decodeRaw.call(this,e,n,o);return{target:[s.package,s.module,s.function].join("::"),arguments:s.arguments,typeArguments:s.type_arguments.map(Nt.tagToString)}},t=>t.target.split("::").length===3);function Un(t,e,n){t.registerType(e,function(s,i,r,a){if(i.length!==n)throw new Error(`Expected fixed array of length ${n}, got ${i.length}`);if(r.length!==1)throw new Error(`Expected one type parameter in a fixed array, got ${r.length}`);let[u]=typeof r[0]=="string"?[r[0],[]]:r[0];for(let l of i)this.getTypeInterface(u)._encodeRaw.call(this,s,l,r,a);return s},function(s,i,r){if(i.length!==1)throw new Error(`Expected one type parameter in a fixed array, got ${i.length}`);let a=[],[u]=typeof i[0]=="string"?[i[0],[]]:i[0];for(let l=0;l<n;l++)a.push(this.getTypeInterface(u)._decodeRaw.call(this,s,i,r));return a})}const aa=V([g({ImmOrOwned:Et}),g({Shared:g({objectId:c(),initialSharedVersion:V([Ut(),c()]),mutable:J()})})]),en=g({Pure:w(Ut())}),ca=g({Object:aa}),Te=V([en,ca]),Ft={Pure(t,e){return{Pure:Array.from(t instanceof Uint8Array?t:It.ser(e,t,{maxSize:1/0}).toBytes())}},ObjectRef({objectId:t,digest:e,version:n}){return{Object:{ImmOrOwned:{digest:e,version:n,objectId:at(t)}}}},SharedObjectRef({objectId:t,mutable:e,initialSharedVersion:n}){return{Object:{Shared:{mutable:e,initialSharedVersion:n,objectId:at(t)}}}}};function vo(t){return typeof t=="string"?at(t):"ImmOrOwned"in t.Object?at(t.Object.ImmOrOwned.objectId):at(t.Object.Shared.objectId)}function ua(t){return typeof t=="object"&&"Object"in t&&"Shared"in t.Object?t.Object.Shared:void 0}function la(t){var e;return((e=ua(t))==null?void 0:e.mutable)??!1}function bt(t,e){return Xs(t,e)}const nn=Symbol("transaction-argument-type"),da=t=>V([g({None:V([T(!0),T(null)])}),g({Some:t})]),Se=g({kind:T("Input"),index:Ut(),value:A(Be()),type:A(V([T("pure"),T("object")]))}),Vn=[Se,g({kind:T("GasCoin")}),g({kind:T("Result"),index:Ut()}),g({kind:T("NestedResult"),index:Ut(),resultIndex:Ut()})],pa=V([...Vn]),oe=V([...Vn]);oe[nn]={kind:"object"};const fs=t=>{const e=V([...Vn]);return e[nn]={kind:"pure",type:t},e},gs=g({kind:T("MoveCall"),target:Pe("target",c().validator),typeArguments:w(c()),arguments:w(pa)}),ms=g({kind:T("TransferObjects"),objects:w(oe),address:fs(G.ADDRESS)}),_s=g({kind:T("SplitCoins"),coin:oe,amounts:w(fs("u64"))}),ws=g({kind:T("MergeCoins"),destination:oe,sources:w(oe)}),bs=g({kind:T("MakeMoveVec"),type:A(da(Pt(c(),xo()))),objects:w(oe)}),ys=g({kind:T("Publish"),modules:w(w(Ut())),dependencies:w(c())}),vs=g({kind:T("Upgrade"),modules:w(w(Ut())),dependencies:w(c()),packageId:c(),ticket:oe}),As=[gs,ms,_s,ws,ys,vs,bs],Cs=V([...As]);function ha(t){return _n(t,Cs),As.find(e=>kt(t,e))}const Jt={MoveCall(t){return bt({kind:"MoveCall",target:t.target,arguments:t.arguments??[],typeArguments:t.typeArguments??[]},gs)},TransferObjects(t,e){return bt({kind:"TransferObjects",objects:t,address:e},ms)},SplitCoins(t,e){return bt({kind:"SplitCoins",coin:t,amounts:e},_s)},MergeCoins(t,e){return bt({kind:"MergeCoins",destination:t,sources:e},ws)},Publish({modules:t,dependencies:e}){return bt({kind:"Publish",modules:t.map(n=>typeof n=="string"?Array.from(Qe(n)):n),dependencies:e.map(n=>ht(n))},ys)},Upgrade({modules:t,dependencies:e,packageId:n,ticket:o}){return bt({kind:"Upgrade",modules:t.map(s=>typeof s=="string"?Array.from(Qe(s)):s),dependencies:e.map(s=>ht(s)),packageId:n,ticket:o},vs)},MakeMoveVec({type:t,objects:e}){return bt({kind:"MakeMoveVec",type:t?{Some:Nt.parseFromStr(t)}:{None:null},objects:e},bs)}};function fa(t,e){const n=Array.from(`${t}::`).map(s=>s.charCodeAt(0)),o=new Uint8Array(n.length+e.length);return o.set(n),o.set(e,n.length),zs(o,{dkLen:32})}const ga=A(E(V([g({Epoch:Ut()}),g({None:V([T(!0),T(null)])})]))),Ao=Pe("StringEncodedBigint",t=>{if(!["string","number","bigint"].includes(typeof t))return!1;try{return BigInt(t),!0}catch{return!1}}),ma=g({budget:A(Ao),price:A(Ao),payment:A(w(Et)),owner:A(c())}),qe=g({version:T(1),sender:A(c()),expiration:ga,gasConfig:ma,inputs:w(Se),transactions:w(Cs)});function Co(t){return at(t).replace("0x","")}class Lt{constructor(e){this.version=1,this.sender=e==null?void 0:e.sender,this.expiration=e==null?void 0:e.expiration,this.gasConfig=(e==null?void 0:e.gasConfig)??{},this.inputs=(e==null?void 0:e.inputs)??[],this.transactions=(e==null?void 0:e.transactions)??[]}static fromKindBytes(e){const n=It.de("TransactionKind",e),o=n==null?void 0:n.ProgrammableTransaction;if(!o)throw new Error("Unable to deserialize from bytes.");const s=bt({version:1,gasConfig:{},inputs:o.inputs.map((i,r)=>bt({kind:"Input",value:i,index:r,type:kt(i,en)?"pure":"object"},Se)),transactions:o.transactions},qe);return Lt.restore(s)}static fromBytes(e){var r;const n=It.de("TransactionData",e),o=n==null?void 0:n.V1,s=(r=o==null?void 0:o.kind)==null?void 0:r.ProgrammableTransaction;if(!o||!s)throw new Error("Unable to deserialize from bytes.");const i=bt({version:1,sender:o.sender,expiration:o.expiration,gasConfig:o.gasData,inputs:s.inputs.map((a,u)=>bt({kind:"Input",value:a,index:u,type:kt(a,en)?"pure":"object"},Se)),transactions:s.transactions},qe);return Lt.restore(i)}static restore(e){_n(e,qe);const n=new Lt;return Object.assign(n,e),n}static getDigestFromBytes(e){const n=fa("TransactionData",e);return Hs(n)}build({maxSizeBytes:e=1/0,overrides:n,onlyTransactionKind:o}={}){const s=this.inputs.map(d=>(_n(d.value,Te),d.value)),i={ProgrammableTransaction:{inputs:s,transactions:this.transactions}};if(o)return It.ser("TransactionKind",i,{maxSize:e}).toBytes();const r=(n==null?void 0:n.expiration)??this.expiration,a=(n==null?void 0:n.sender)??this.sender,u={...this.gasConfig,...n==null?void 0:n.gasConfig};if(!a)throw new Error("Missing transaction sender");if(!u.budget)throw new Error("Missing gas budget");if(!u.payment)throw new Error("Missing gas payment");if(!u.price)throw new Error("Missing gas price");const l={sender:Co(a),expiration:r||{None:!0},gasData:{payment:u.payment,owner:Co(this.gasConfig.owner??a),price:BigInt(u.price),budget:BigInt(u.budget)},kind:{ProgrammableTransaction:{inputs:s,transactions:this.transactions}}};return It.ser("TransactionData",{V1:l},{maxSize:e}).toBytes()}getDigest(){const e=this.build({onlyTransactionKind:!1});return Lt.getDigestFromBytes(e)}snapshot(){return bt(this,qe)}}var Gn=(t,e,n)=>{if(!e.has(t))throw TypeError("Cannot "+n)},K=(t,e,n)=>(Gn(t,e,"read from private field"),n?n.call(t):e.get(t)),Kt=(t,e,n)=>{if(e.has(t))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(t):e.set(t,n)},Le=(t,e,n,o)=>(Gn(t,e,"write to private field"),o?o.call(t,n):e.set(t,n),n),_t=(t,e,n)=>(Gn(t,e,"access private method"),n),U,Ke,Sn,Yt,se,Wn,Ts,Jn,ks,Kn,Ss,Xn,Is,Xe,In;const _a={maxPureArgumentSize:16*1024,maxTxGas:5e10,maxGasObjects:256,maxTxSizeBytes:128*1024};function wa(t){const e={kind:"Result",index:t},n=[],o=s=>n[s]??(n[s]={kind:"NestedResult",index:t,resultIndex:s});return new Proxy(e,{set(){throw new Error("The transaction result is a proxy, and does not support setting properties directly")},get(s,i){if(i in s)return Reflect.get(s,i);if(i===Symbol.iterator)return function*(){let a=0;for(;;)yield o(a),a++};if(typeof i=="symbol")return;const r=parseInt(i,10);if(!(Number.isNaN(r)||r<0))return o(r)}})}function Ie(t){if(!t.client&&!t.provider)throw new Error("No provider passed to Transaction#build, but transaction data was not sufficient to build offline.");return t.client??t.provider}const Pn=Symbol.for("@mysten/transaction"),dn={maxTxGas:"max_tx_gas",maxGasObjects:"max_gas_payment_objects",maxTxSizeBytes:"max_tx_size_bytes",maxPureArgumentSize:"max_pure_argument_size"},ba=1000n,ya=50,va=(t,e)=>Array.from({length:Math.ceil(t.length/e)},(n,o)=>t.slice(o*e,o*e+e));function Aa(t){return!!t&&typeof t=="object"&&t[Pn]===!0}const Ca=class Bn{constructor(e){Kt(this,Ke),Kt(this,Yt),Kt(this,Wn),Kt(this,Jn),Kt(this,Kn),Kt(this,Xn),Kt(this,Xe),Kt(this,U,void 0),Le(this,U,new Lt(e?e.blockData:void 0))}static is(e){return!!e&&typeof e=="object"&&e[Pn]===!0}static fromKind(e){const n=new Bn;return Le(n,U,Lt.fromKindBytes(typeof e=="string"?Qe(e):e)),n}static from(e){const n=new Bn;return typeof e!="string"||!e.startsWith("{")?Le(n,U,Lt.fromBytes(typeof e=="string"?Qe(e):e)):Le(n,U,Lt.restore(JSON.parse(e))),n}static get Transactions(){return Jt}static get Inputs(){return Ft}setSender(e){K(this,U).sender=e}setSenderIfNotSet(e){K(this,U).sender||(K(this,U).sender=e)}setExpiration(e){K(this,U).expiration=e}setGasPrice(e){K(this,U).gasConfig.price=String(e)}setGasBudget(e){K(this,U).gasConfig.budget=String(e)}setGasOwner(e){K(this,U).gasConfig.owner=e}setGasPayment(e){K(this,U).gasConfig.payment=e.map(n=>Zs(n,Et))}get blockData(){return K(this,U).snapshot()}get[Pn](){return!0}get gas(){return{kind:"GasCoin"}}object(e){const n=vo(e);return K(this,U).inputs.find(s=>s.type==="object"&&n===vo(s.value))??_t(this,Ke,Sn).call(this,"object",e)}objectRef(...e){return this.object(Ft.ObjectRef(...e))}sharedObjectRef(...e){return this.object(Ft.SharedObjectRef(...e))}pure(e,n){return _t(this,Ke,Sn).call(this,"pure",e instanceof Uint8Array?Ft.Pure(e):n?Ft.Pure(e,n):e)}add(e){const n=K(this,U).transactions.push(e);return wa(n-1)}splitCoins(...e){return this.add(Jt.SplitCoins(...e))}mergeCoins(...e){return this.add(Jt.MergeCoins(...e))}publish(...e){return this.add(Jt.Publish(...e))}upgrade(...e){return this.add(Jt.Upgrade(...e))}moveCall(...e){return this.add(Jt.MoveCall(...e))}transferObjects(...e){return this.add(Jt.TransferObjects(...e))}makeMoveVec(...e){return this.add(Jt.MakeMoveVec(...e))}serialize(){return JSON.stringify(K(this,U).snapshot())}async sign(e){const{signer:n,...o}=e,s=await this.build(o);return n.signTransactionBlock(s)}async build(e={}){return await _t(this,Xe,In).call(this,e),K(this,U).build({maxSizeBytes:_t(this,Yt,se).call(this,"maxTxSizeBytes",e),onlyTransactionKind:e.onlyTransactionKind})}async getDigest(e={}){return await _t(this,Xe,In).call(this,e),K(this,U).getDigest()}};U=new WeakMap;Ke=new WeakSet;Sn=function(t,e){const n=K(this,U).inputs.length,o=bt({kind:"Input",value:typeof e=="bigint"?String(e):e,index:n,type:t},Se);return K(this,U).inputs.push(o),o};Yt=new WeakSet;se=function(t,{protocolConfig:e,limits:n}){if(n&&typeof n[t]=="number")return n[t];if(!e)return _a[t];const o=e==null?void 0:e.attributes[dn[t]];if(!o)throw new Error(`Missing expected protocol config: "${dn[t]}"`);const s="u64"in o?o.u64:"u32"in o?o.u32:o.f64;if(!s)throw new Error(`Unexpected protocol config value found for: "${dn[t]}"`);return Number(s)};Wn=new WeakSet;Ts=function(t){const e=_t(this,Yt,se).call(this,"maxPureArgumentSize",t);K(this,U).inputs.forEach((n,o)=>{if(kt(n.value,en)&&n.value.Pure.length>e)throw new Error(`Input at index ${o} is too large, max pure input size is ${e} bytes, got ${n.value.Pure.length} bytes`)})};Jn=new WeakSet;ks=async function(t){if(K(this,U).gasConfig.payment){const s=_t(this,Yt,se).call(this,"maxGasObjects",t);if(K(this,U).gasConfig.payment.length>s)throw new Error(`Payment objects exceed maximum amount: ${s}`)}if(t.onlyTransactionKind||K(this,U).gasConfig.payment)return;const e=K(this,U).gasConfig.owner??K(this,U).sender,o=(await Ie(t).getCoins({owner:e,coinType:qr})).data.filter(s=>!K(this,U).inputs.find(r=>kt(r.value,Te)&&"Object"in r.value&&"ImmOrOwned"in r.value.Object?s.coinObjectId===r.value.Object.ImmOrOwned.objectId:!1)).slice(0,_t(this,Yt,se).call(this,"maxGasObjects",t)-1).map(s=>({objectId:s.coinObjectId,digest:s.digest,version:s.version}));if(!o.length)throw new Error("No valid gas coins found for the transaction.");this.setGasPayment(o)};Kn=new WeakSet;Ss=async function(t){t.onlyTransactionKind||K(this,U).gasConfig.price||this.setGasPrice(await Ie(t).getReferenceGasPrice())};Xn=new WeakSet;Is=async function(t){const{inputs:e,transactions:n}=K(this,U),o=[],s=[];if(n.forEach(i=>{if(i.kind==="MoveCall"){i.arguments.some(u=>u.kind==="Input"&&!kt(e[u.index].value,Te))&&o.push(i);return}const r=ha(i);r.schema&&Object.entries(i).forEach(([a,u])=>{if(a==="kind")return;const l=r.schema[a],d=l.type==="array",h=d?l.schema[nn]:l[nn];if(!h)return;const f=_=>{const v=e[_];if(!v)throw new Error(`Missing input ${u.index}`);if(!kt(v.value,Te))if(h.kind==="object"&&typeof v.value=="string")s.push({id:v.value,input:v});else if(h.kind==="pure")v.value=Ft.Pure(v.value,h.type);else throw new Error("Unexpected input format.")};if(d)u.forEach(_=>{_.kind==="Input"&&f(_.index)});else{if(u.kind!=="Input")return;f(u.index)}})}),o.length&&await Promise.all(o.map(async i=>{const[r,a,u]=i.target.split("::"),l=await Ie(t).getNormalizedMoveFunction({package:ht(r),module:a,function:u}),h=l.parameters.length>0&&Hr(l.parameters.at(-1))?l.parameters.slice(0,l.parameters.length-1):l.parameters;if(h.length!==i.arguments.length)throw new Error("Incorrect number of arguments.");h.forEach((f,_)=>{const v=i.arguments[_];if(v.kind!=="Input")return;const I=e[v.index];if(kt(I.value,Te))return;const m=I.value,y=Tn(f,m);if(y){I.value=Ft.Pure(m,y);return}if(as(f)!=null||typeof f=="object"&&"TypeParameter"in f){if(typeof m!="string")throw new Error(`Expect the argument to be an object id string, got ${JSON.stringify(m,null,2)}`);s.push({id:m,input:I,normalizedType:f});return}throw new Error(`Unknown call arg type ${JSON.stringify(f,null,2)} for value ${JSON.stringify(m,null,2)}`)})})),s.length){const i=[...new Set(s.map(({id:d})=>d))],r=va(i,ya),a=(await Promise.all(r.map(d=>Ie(t).multiGetObjects({ids:d,options:{showOwner:!0}})))).flat();let u=new Map(i.map((d,h)=>[d,a[h]]));const l=Array.from(u).filter(([d,h])=>h.error).map(([d,h])=>d);if(l.length)throw new Error(`The following input objects are invalid: ${l.join(", ")}`);s.forEach(({id:d,input:h,normalizedType:f})=>{var m;const _=u.get(d),v=(m=_.data)==null?void 0:m.owner,I=v&&typeof v=="object"&&"Shared"in v?v.Shared.initial_shared_version:void 0;if(I){const y=la(h.value)||f!=null&&rs(f)!=null;h.value=Ft.SharedObjectRef({objectId:d,initialSharedVersion:I,mutable:y})}else h.value=Ft.ObjectRef(Li(_))})}};Xe=new WeakSet;In=async function(t){if(!t.onlyTransactionKind&&!K(this,U).sender)throw new Error("Missing transaction sender");const e=t.client||t.provider;if(!t.protocolConfig&&!t.limits&&e&&(t.protocolConfig=await e.getProtocolConfig()),await Promise.all([_t(this,Kn,Ss).call(this,t),_t(this,Xn,Is).call(this,t)]),!t.onlyTransactionKind&&(await _t(this,Jn,ks).call(this,t),!K(this,U).gasConfig.budget)){const n=await Ie(t).dryRunTransactionBlock({transactionBlock:K(this,U).build({maxSizeBytes:_t(this,Yt,se).call(this,"maxTxSizeBytes",t),overrides:{gasConfig:{budget:String(_t(this,Yt,se).call(this,"maxTxGas",t)),payment:[]}}})});if(n.effects.status.status!=="success")throw new Error(`Dry run failed, could not automatically determine a budget: ${n.effects.status.error}`,{cause:n});const o=ba*BigInt(this.blockData.gasConfig.price||1n),s=BigInt(n.effects.gasUsed.computationCost)+o,i=s+BigInt(n.effects.gasUsed.storageCost)-BigInt(n.effects.gasUsed.storageRebate);this.setGasBudget(i>s?i:s)}_t(this,Wn,Ts).call(this,t)};let H=Ca,$e;const Ta=new Uint8Array(16);function ka(){if(!$e&&($e=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!$e))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return $e(Ta)}const ct=[];for(let t=0;t<256;++t)ct.push((t+256).toString(16).slice(1));function Sa(t,e=0){return(ct[t[e+0]]+ct[t[e+1]]+ct[t[e+2]]+ct[t[e+3]]+"-"+ct[t[e+4]]+ct[t[e+5]]+"-"+ct[t[e+6]]+ct[t[e+7]]+"-"+ct[t[e+8]]+ct[t[e+9]]+"-"+ct[t[e+10]]+ct[t[e+11]]+ct[t[e+12]]+ct[t[e+13]]+ct[t[e+14]]+ct[t[e+15]]).toLowerCase()}const Ia=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),To={randomUUID:Ia};function Pa(t,e,n){if(To.randomUUID&&!e&&!t)return To.randomUUID();t=t||{};const o=t.random||(t.rng||ka)();if(o[6]=o[6]&15|64,o[8]=o[8]&63|128,e){n=n||0;for(let s=0;s<16;++s)e[n+s]=o[s];return e}return Sa(o)}const Ba="0.41.1",Oa="1.9.0";var zn=(t,e,n)=>{if(!e.has(t))throw TypeError("Cannot "+n)},Tt=(t,e,n)=>(zn(t,e,"read from private field"),n?n.call(t):e.get(t)),ye=(t,e,n)=>{if(e.has(t))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(t):e.set(t,n)},ee=(t,e,n,o)=>(zn(t,e,"write to private field"),o?o.call(t,n):e.set(t,n),n),Ea=(t,e,n,o)=>({set _(s){ee(t,e,s,n)},get _(){return Tt(t,e,o)}}),On=(t,e,n)=>(zn(t,e,"access private method"),n),xt,zt,_e,ze,En,Hn,Ps;const Ra=(t,e)=>{const n=new URL(t);return n.protocol=n.protocol.replace("http","ws"),e&&(n.port=e.toString()),n.toString()},xa={callTimeout:3e4,reconnectTimeout:3e3,maxReconnects:5};class ja{constructor(e,n={}){ye(this,ze),ye(this,Hn),ye(this,xt,void 0),ye(this,zt,void 0),ye(this,_e,void 0),this.endpoint=e,this.options={...xa,...n},this.endpoint.startsWith("http")&&(this.endpoint=Ra(this.endpoint)),ee(this,xt,null),ee(this,zt,new Map),ee(this,_e,0)}async request(e){const o=await On(this,ze,En).call(this).request({method:e.method,params:e.params},this.options.callTimeout),s=e.initialId||o;return Tt(this,zt).set(s,{...e,id:o,initialId:s}),async()=>{const i=On(this,ze,En).call(this),r=Tt(this,zt).get(s);return r?(Tt(this,zt).delete(s),i.request({method:e.unsubscribe,params:[r.id]},this.options.callTimeout)):!1}}}xt=new WeakMap;zt=new WeakMap;_e=new WeakMap;ze=new WeakSet;En=function(){if(Tt(this,xt))return Tt(this,xt);const t=new fe.WebSocketTransport(this.endpoint),e=new fe.RequestManager([t]);return ee(this,xt,new fe.Client(e)),t.connection.addEventListener("open",()=>{ee(this,_e,0)}),t.connection.addEventListener("close",()=>{Ea(this,_e)._++,Tt(this,_e)<=this.options.maxReconnects&&setTimeout(()=>{On(this,Hn,Ps).call(this)},this.options.reconnectTimeout)}),Tt(this,xt).onNotification(n=>{const o=n.params;Tt(this,zt).forEach(s=>{s.method===n.method&&o.subscription===s.id&&s.onMessage(o.result)})}),Tt(this,xt)};Hn=new WeakSet;Ps=function(){var t;(t=Tt(this,xt))==null||t.close(),ee(this,xt,null),Tt(this,zt).forEach(e=>this.request(e))};class Da{constructor({url:e,websocket:{url:n,...o}={},rpc:s}){const i=new fe.HTTPTransport((s==null?void 0:s.url)??e,{headers:{"Content-Type":"application/json","Client-Sdk-Type":"typescript","Client-Sdk-Version":Ba,"Client-Target-Api-Version":Oa,...s==null?void 0:s.headers}});this.rpcClient=new fe.Client(new fe.RequestManager([i])),this.websocketClient=new ja(n??e,o)}async request(e){return await this.rpcClient.request(e)}async subscribe(e){const n=await this.websocketClient.request(e);return async()=>!!await n()}}const Ma=Symbol.for("@mysten/SuiClient");class Na{get[Ma](){return!0}constructor(e){this.transport=e.transport??new Da({url:e.url})}async getRpcApiVersion(){return(await this.transport.request({method:"rpc.discover",params:[]})).info.version}async getCoins(e){if(!e.owner||!Xt(at(e.owner)))throw new Error("Invalid Sui address");return await this.transport.request({method:"suix_getCoins",params:[e.owner,e.coinType,e.cursor,e.limit]})}async getAllCoins(e){if(!e.owner||!Xt(at(e.owner)))throw new Error("Invalid Sui address");return await this.transport.request({method:"suix_getAllCoins",params:[e.owner,e.cursor,e.limit]})}async getBalance(e){if(!e.owner||!Xt(at(e.owner)))throw new Error("Invalid Sui address");return await this.transport.request({method:"suix_getBalance",params:[e.owner,e.coinType]})}async getAllBalances(e){if(!e.owner||!Xt(at(e.owner)))throw new Error("Invalid Sui address");return await this.transport.request({method:"suix_getAllBalances",params:[e.owner]})}async getCoinMetadata(e){return await this.transport.request({method:"suix_getCoinMetadata",params:[e.coinType]})}async getTotalSupply(e){return await this.transport.request({method:"suix_getTotalSupply",params:[e.coinType]})}async call(e,n){return await this.transport.request({method:e,params:n})}async getMoveFunctionArgTypes(e){return await this.transport.request({method:"sui_getMoveFunctionArgTypes",params:[e.package,e.module,e.function]})}async getNormalizedMoveModulesByPackage(e){return await this.transport.request({method:"sui_getNormalizedMoveModulesByPackage",params:[e.package]})}async getNormalizedMoveModule(e){return await this.transport.request({method:"sui_getNormalizedMoveModule",params:[e.package,e.module]})}async getNormalizedMoveFunction(e){return await this.transport.request({method:"sui_getNormalizedMoveFunction",params:[e.package,e.module,e.function]})}async getNormalizedMoveStruct(e){return await this.transport.request({method:"sui_getNormalizedMoveStruct",params:[e.package,e.module,e.struct]})}async getOwnedObjects(e){if(!e.owner||!Xt(at(e.owner)))throw new Error("Invalid Sui address");return await this.transport.request({method:"suix_getOwnedObjects",params:[e.owner,{filter:e.filter,options:e.options},e.cursor,e.limit]})}async getObject(e){if(!e.id||!Ae(ht(e.id)))throw new Error("Invalid Sui Object id");return await this.transport.request({method:"sui_getObject",params:[e.id,e.options]})}async tryGetPastObject(e){return await this.transport.request({method:"sui_tryGetPastObject",params:[e.id,e.version,e.options]})}async multiGetObjects(e){if(e.ids.forEach(o=>{if(!o||!Ae(ht(o)))throw new Error(`Invalid Sui Object id ${o}`)}),e.ids.length!==new Set(e.ids).size)throw new Error(`Duplicate object ids in batch call ${e.ids}`);return await this.transport.request({method:"sui_multiGetObjects",params:[e.ids,e.options]})}async queryTransactionBlocks(e){return await this.transport.request({method:"suix_queryTransactionBlocks",params:[{filter:e.filter,options:e.options},e.cursor,e.limit,(e.order||"descending")==="descending"]})}async getTransactionBlock(e){if(!go(e.digest))throw new Error("Invalid Transaction digest");return await this.transport.request({method:"sui_getTransactionBlock",params:[e.digest,e.options]})}async multiGetTransactionBlocks(e){if(e.digests.forEach(o=>{if(!go(o))throw new Error(`Invalid Transaction digest ${o}`)}),e.digests.length!==new Set(e.digests).size)throw new Error(`Duplicate digests in batch call ${e.digests}`);return await this.transport.request({method:"sui_multiGetTransactionBlocks",params:[e.digests,e.options]})}async executeTransactionBlock(e){return await this.transport.request({method:"sui_executeTransactionBlock",params:[typeof e.transactionBlock=="string"?e.transactionBlock:xe(e.transactionBlock),Array.isArray(e.signature)?e.signature:[e.signature],e.options,e.requestType]})}async signAndExecuteTransactionBlock({transactionBlock:e,signer:n,...o}){let s;e instanceof Uint8Array?s=e:(e.setSenderIfNotSet(await n.getPublicKey().toSuiAddress()),s=await e.build({client:this}));const{signature:i,bytes:r}=await n.signTransactionBlock(s);return this.executeTransactionBlock({transactionBlock:r,signature:i,...o})}async getTotalTransactionBlocks(){const e=await this.transport.request({method:"sui_getTotalTransactionBlocks",params:[]});return BigInt(e)}async getReferenceGasPrice(){const e=await this.transport.request({method:"suix_getReferenceGasPrice",params:[]});return BigInt(e)}async getStakes(e){if(!e.owner||!Xt(at(e.owner)))throw new Error("Invalid Sui address");return await this.transport.request({method:"suix_getStakes",params:[e.owner]})}async getStakesByIds(e){return e.stakedSuiIds.forEach(n=>{if(!n||!Ae(ht(n)))throw new Error(`Invalid Sui Stake id ${n}`)}),await this.transport.request({method:"suix_getStakesByIds",params:[e.stakedSuiIds]})}async getLatestSuiSystemState(){return await this.transport.request({method:"suix_getLatestSuiSystemState",params:[]})}async queryEvents(e){return await this.transport.request({method:"suix_queryEvents",params:[e.query,e.cursor,e.limit,(e.order||"descending")==="descending"]})}async subscribeEvent(e){return this.transport.subscribe({method:"suix_subscribeEvent",unsubscribe:"suix_unsubscribeEvent",params:[e.filter],onMessage:e.onMessage})}async subscribeTransaction(e){return this.transport.subscribe({method:"suix_subscribeTransaction",unsubscribe:"suix_unsubscribeTransaction",params:[e.filter],onMessage:e.onMessage})}async devInspectTransactionBlock(e){let n;if(Aa(e.transactionBlock))e.transactionBlock.setSenderIfNotSet(e.sender),n=xe(await e.transactionBlock.build({client:this,onlyTransactionKind:!0}));else if(typeof e.transactionBlock=="string")n=e.transactionBlock;else if(e.transactionBlock instanceof Uint8Array)n=xe(e.transactionBlock);else throw new Error("Unknown transaction block format.");return await this.transport.request({method:"sui_devInspectTransactionBlock",params:[e.sender,n,e.gasPrice,e.epoch]})}async dryRunTransactionBlock(e){return await this.transport.request({method:"sui_dryRunTransactionBlock",params:[typeof e.transactionBlock=="string"?e.transactionBlock:xe(e.transactionBlock)]})}async getDynamicFields(e){if(!e.parentId||!Ae(ht(e.parentId)))throw new Error("Invalid Sui Object id");return await this.transport.request({method:"suix_getDynamicFields",params:[e.parentId,e.cursor,e.limit]})}async getDynamicFieldObject(e){return await this.transport.request({method:"suix_getDynamicFieldObject",params:[e.parentId,e.name]})}async getLatestCheckpointSequenceNumber(){const e=await this.transport.request({method:"sui_getLatestCheckpointSequenceNumber",params:[]});return String(e)}async getCheckpoint(e){return await this.transport.request({method:"sui_getCheckpoint",params:[e.id]})}async getCheckpoints(e){return await this.transport.request({method:"sui_getCheckpoints",params:[e.cursor,e==null?void 0:e.limit,e.descendingOrder]})}async getCommitteeInfo(e){return await this.transport.request({method:"suix_getCommitteeInfo",params:[e==null?void 0:e.epoch]})}async getNetworkMetrics(){return await this.transport.request({method:"suix_getNetworkMetrics",params:[]})}async getAddressMetrics(){return await this.transport.request({method:"suix_getLatestAddressMetrics",params:[]})}async getAllEpochAddressMetrics(e){return await this.transport.request({method:"suix_getAllEpochAddressMetrics",params:[e==null?void 0:e.descendingOrder]})}async getEpochs(e){return await this.transport.request({method:"suix_getEpochs",params:[e==null?void 0:e.cursor,e==null?void 0:e.limit,e==null?void 0:e.descendingOrder]})}async getMoveCallMetrics(){return await this.transport.request({method:"suix_getMoveCallMetrics",params:[]})}async getCurrentEpoch(){return await this.transport.request({method:"suix_getCurrentEpoch",params:[]})}async getValidatorsApy(){return await this.transport.request({method:"suix_getValidatorsApy",params:[]})}async getChainIdentifier(){const e=await this.getCheckpoint({id:"0"}),n=Ro(e.digest);return Qs(n.slice(0,4))}async resolveNameServiceAddress(e){return await this.transport.request({method:"suix_resolveNameServiceAddress",params:[e.name]})}async resolveNameServiceNames(e){return await this.transport.request({method:"suix_resolveNameServiceNames",params:[e.address,e.cursor,e.limit]})}async getProtocolConfig(e){return await this.transport.request({method:"sui_getProtocolConfig",params:[e==null?void 0:e.version]})}async waitForTransactionBlock({signal:e,timeout:n=60*1e3,pollInterval:o=2*1e3,...s}){const i=AbortSignal.timeout(n),r=new Promise((a,u)=>{i.addEventListener("abort",()=>u(i.reason))});for(r.catch(()=>{});!i.aborted;){e==null||e.throwIfAborted();try{return await this.getTransactionBlock(s)}catch{await Promise.race([new Promise(u=>setTimeout(u,o)),r])}}throw i.throwIfAborted(),new Error("Unexpected error while waiting for transaction block.")}}var Fa=Object.defineProperty,qa=(t,e,n)=>e in t?Fa(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,La=(t,e,n)=>(qa(t,typeof e!="symbol"?e+"":e,n),n),sn=5*60*1e3,tt=24*60*60*1e3;function Dt(t){return Date.parse(new Date().toString())+t}var Oe=class{constructor(t,e=0){$(this,"overdueTime");$(this,"value");this.overdueTime=e,this.value=t}isValid(){return this.value===null?!1:this.overdueTime===0?!0:!(Date.parse(new Date().toString())>this.overdueTime)}};X.config({precision:64,rounding:X.ROUND_DOWN,toExpNeg:-64,toExpPos:64});var lt=X,ut=class extends Error{constructor(e,n){super(e);$(this,"message");$(this,"errorCode");this.message=e,this.errorCode=n}static isClmmpoolsErrorCode(e,n){return e instanceof ut&&e.errorCode===n}},P=new p(0),jt=new p(1),rn=new p(2);rn.pow(new p(128));var we=rn.pow(new p(64)).sub(jt),$a=rn.pow(new p(128)).sub(jt),W=class{static toX64_BN(t){return t.mul(new p(2).pow(new p(64)))}static toX64_Decimal(t){return t.mul(lt.pow(2,64))}static toX64(t){return new p(t.mul(lt.pow(2,64)).floor().toFixed())}static fromX64(t){return new lt(t.toString()).mul(lt.pow(2,-64))}static fromX64_Decimal(t){return t.mul(lt.pow(2,-64))}static fromX64_BN(t){return t.div(new p(2).pow(new p(64)))}static shiftRightRoundUp(t){let e=t.shrn(64);return t.mod(we).gt(P)&&(e=e.add(jt)),e}static divRoundUp(t,e){return t.mod(e).eq(P)?t.div(e):t.div(e).add(new p(1))}static subUnderflowU128(t,e){return t.lt(e)?t.sub(e).add($a):t.sub(e)}static checkUnsignedSub(t,e){const n=t.sub(e);if(n.isNeg())throw new ut("Unsigned integer sub overflow","UnsignedIntegerOverflow");return n}static checkMul(t,e,n){const o=t.mul(e);if(this.isOverflow(o,n))throw new ut("Multiplication overflow","MultiplicationOverflow");return o}static checkMulDivFloor(t,e,n,o){if(n.eq(P))throw new ut("Devide by zero","DivideByZero");const s=t.mul(e).div(n);if(this.isOverflow(s,o))throw new ut("Multiplication div overflow","MulDivOverflow");return s}static checkMulDivCeil(t,e,n,o){if(n.eq(P))throw new ut("Devide by zero","DivideByZero");const s=t.mul(e).add(n.sub(jt)).div(n);if(this.isOverflow(s,o))throw new ut("Multiplication div overflow","MulDivOverflow");return s}static checkMulDivRound(t,e,n,o){if(n.eq(P))throw new ut("Devide by zero","DivideByZero");const s=t.mul(e.add(n.shrn(1))).div(n);if(this.isOverflow(s,o))throw new ut("Multiplication div overflow","MulDivOverflow");return s}static checkMulShiftRight(t,e,n,o){const s=t.mul(e).div(new p(2).pow(new p(n)));if(this.isOverflow(s,o))throw new ut("Multiplication shift right overflow","MulShiftRightOverflow");return s}static checkMulShiftRight64RoundUpIf(t,e,n,o){const s=t.mul(e),r=o&&s.and(we).gt(P)?s.shrn(64).add(jt):s.shrn(64);if(this.isOverflow(r,n))throw new ut("Multiplication shift right overflow","MulShiftRightOverflow");return r}static checkMulShiftLeft(t,e,n,o){const s=t.mul(e).shln(n);if(this.isOverflow(s,o))throw new ut("Multiplication shift left overflow","MulShiftLeftOverflow");return s}static checkDivRoundUpIf(t,e,n){if(e.eq(P))throw new ut("Devide by zero","DivideByZero");return n?this.divRoundUp(t,e):t.div(e)}static isOverflow(t,e){return t.gte(rn.pow(new p(e)))}};function Ua(t){return{coinA:t.coinTypeA,coinB:t.coinTypeB,currentSqrtPrice:new p(t.current_sqrt_price),currentTickIndex:t.current_tick_index,feeGrowthGlobalA:new p(t.fee_growth_global_a),feeGrowthGlobalB:new p(t.fee_growth_global_b),feeProtocolCoinA:new p(t.fee_protocol_coin_a),feeProtocolCoinB:new p(t.fee_protocol_coin_b),feeRate:new p(t.fee_rate),liquidity:new p(t.liquidity),tickIndexes:[],tickSpacing:Number(t.tickSpacing),ticks:[],collection_name:""}}var an="79226673515401279992447579055",cn="4295048016",he=new p(1e6),et="0x0000000000000000000000000000000000000000000000000000000000000006",He="pool_script",ne="pool_script_v2",Ce="router",ko="router_with_partner",ie="fetcher_script",Va="expect_swap",Ga="utils",pn="custodian_v2",Wa="clob_v2",Ja="endpoints_v2";function Z(t){if(t.config===void 0)throw Error(`package: ${t.package_id}  not config in sdk SdkOptions`);return t.config}var Ka=14,Xa="59543866431248",za="184467440737095516",Ha="15793534762490258745",Za=443636;function Qa(t,e,n){const o=t.toTwos(n).shln(e);return o.imaskn(n+1),o.fromTwos(n)}function F(t,e,n){const o=t.toTwos(n).shrn(e);return o.imaskn(n-e+1),o.fromTwos(n-e)}function Ya(t){let e;return t&1?e=new p("79232123823359799118286999567"):e=new p("79228162514264337593543950336"),t&2&&(e=F(e.mul(new p("79236085330515764027303304731")),96,256)),t&4&&(e=F(e.mul(new p("79244008939048815603706035061")),96,256)),t&8&&(e=F(e.mul(new p("79259858533276714757314932305")),96,256)),t&16&&(e=F(e.mul(new p("79291567232598584799939703904")),96,256)),t&32&&(e=F(e.mul(new p("79355022692464371645785046466")),96,256)),t&64&&(e=F(e.mul(new p("79482085999252804386437311141")),96,256)),t&128&&(e=F(e.mul(new p("79736823300114093921829183326")),96,256)),t&256&&(e=F(e.mul(new p("80248749790819932309965073892")),96,256)),t&512&&(e=F(e.mul(new p("81282483887344747381513967011")),96,256)),t&1024&&(e=F(e.mul(new p("83390072131320151908154831281")),96,256)),t&2048&&(e=F(e.mul(new p("87770609709833776024991924138")),96,256)),t&4096&&(e=F(e.mul(new p("97234110755111693312479820773")),96,256)),t&8192&&(e=F(e.mul(new p("119332217159966728226237229890")),96,256)),t&16384&&(e=F(e.mul(new p("179736315981702064433883588727")),96,256)),t&32768&&(e=F(e.mul(new p("407748233172238350107850275304")),96,256)),t&65536&&(e=F(e.mul(new p("2098478828474011932436660412517")),96,256)),t&131072&&(e=F(e.mul(new p("55581415166113811149459800483533")),96,256)),t&262144&&(e=F(e.mul(new p("38992368544603139932233054999993551")),96,256)),F(e,32,256)}function tc(t){const e=Math.abs(t);let n;return e&1?n=new p("18445821805675392311"):n=new p("18446744073709551616"),e&2&&(n=F(n.mul(new p("18444899583751176498")),64,256)),e&4&&(n=F(n.mul(new p("18443055278223354162")),64,256)),e&8&&(n=F(n.mul(new p("18439367220385604838")),64,256)),e&16&&(n=F(n.mul(new p("18431993317065449817")),64,256)),e&32&&(n=F(n.mul(new p("18417254355718160513")),64,256)),e&64&&(n=F(n.mul(new p("18387811781193591352")),64,256)),e&128&&(n=F(n.mul(new p("18329067761203520168")),64,256)),e&256&&(n=F(n.mul(new p("18212142134806087854")),64,256)),e&512&&(n=F(n.mul(new p("17980523815641551639")),64,256)),e&1024&&(n=F(n.mul(new p("17526086738831147013")),64,256)),e&2048&&(n=F(n.mul(new p("16651378430235024244")),64,256)),e&4096&&(n=F(n.mul(new p("15030750278693429944")),64,256)),e&8192&&(n=F(n.mul(new p("12247334978882834399")),64,256)),e&16384&&(n=F(n.mul(new p("8131365268884726200")),64,256)),e&32768&&(n=F(n.mul(new p("3584323654723342297")),64,256)),e&65536&&(n=F(n.mul(new p("696457651847595233")),64,256)),e&131072&&(n=F(n.mul(new p("26294789957452057")),64,256)),e&262144&&(n=F(n.mul(new p("37481735321082")),64,256)),n}var z=class{static priceToSqrtPriceX64(t,e,n){return W.toX64(t.mul(lt.pow(10,n-e)).sqrt())}static sqrtPriceX64ToPrice(t,e,n){return W.fromX64(t).pow(2).mul(lt.pow(10,e-n))}static tickIndexToSqrtPriceX64(t){return t>0?new p(Ya(t)):new p(tc(t))}static sqrtPriceX64ToTickIndex(t){if(t.gt(new p(an))||t.lt(new p(cn)))throw new Error("Provided sqrtPrice is not within the supported sqrtPrice range.");const e=t.bitLength()-1,n=new p(e-64),o=Qa(n,32,128);let s=new p("8000000000000000","hex"),i=0,r=new p(0),a=e>=64?t.shrn(e-63):t.shln(63-e);for(;s.gt(new p(0))&&i<Ka;){a=a.mul(a);const v=a.shrn(127);a=a.shrn(63+v.toNumber()),r=r.add(s.mul(v)),s=s.shrn(1),i+=1}const u=r.shrn(32),d=o.add(u).mul(new p(Xa)),h=F(d.sub(new p(za)),64,128).toNumber(),f=F(d.add(new p(Ha)),64,128).toNumber();return h===f?h:z.tickIndexToSqrtPriceX64(f).lte(t)?f:h}static tickIndexToPrice(t,e,n){return z.sqrtPriceX64ToPrice(z.tickIndexToSqrtPriceX64(t),e,n)}static priceToTickIndex(t,e,n){return z.sqrtPriceX64ToTickIndex(z.priceToSqrtPriceX64(t,e,n))}static priceToInitializableTickIndex(t,e,n,o){return z.getInitializableTickIndex(z.priceToTickIndex(t,e,n),o)}static getInitializableTickIndex(t,e){return t-t%e}static getNextInitializableTickIndex(t,e){return z.getInitializableTickIndex(t,e)+e}static getPrevInitializableTickIndex(t,e){return z.getInitializableTickIndex(t,e)-e}};function ec(t){return it(t).add(it(Za))}new p(365);new p(24);new p(3600);new p(.5);var te=class{static getDefaultSqrtPriceLimit(t){return new p(t?cn:an)}static getDefaultOtherAmountThreshold(t){return t?P:we}};function Bs(t,e,n,o){if(n.eq(P))return t;const s=W.checkMulShiftLeft(t,e,64,256),i=e.shln(64),r=W.checkMul(t,n,256);if(!o&&i.lte(r))throw new ut("getNextSqrtPriceAUp - Unable to divide liquidityShl64 by product","DivideByZero");const a=o?W.checkDivRoundUpIf(s,i.add(r),!0):W.checkDivRoundUpIf(s,i.sub(r),!0);if(a.lt(new p(cn)))throw new ut("getNextSqrtPriceAUp - Next sqrt price less than min sqrt price","CoinAmountMinSubceeded ");if(a.gt(new p(an)))throw new ut("getNextSqrtPriceAUp - Next sqrt price greater than max sqrt price","CoinAmountMaxExceeded");return a}function Os(t,e,n,o){const s=W.checkDivRoundUpIf(n.shln(64),e,!o),i=o?t.add(s):t.sub(s);if(i.lt(new p(cn))||i.gt(new p(an)))throw new ut("getNextSqrtPriceAUp - Next sqrt price out of bounds","SqrtPriceOutOfBounds");return i}function nc(t,e,n,o){return o?Bs(t,e,n,!0):Os(t,e,n,!0)}function oc(t,e,n,o){return o?Os(t,e,n,!1):Bs(t,e,n,!1)}function So(t,e,n,o){const s=t.gt(e)?t.sub(e):e.sub(t);if(n.lte(P)||s.eq(P))return P;let i;if(o){const r=new p(n).mul(new p(s)).shln(64),a=e.mul(t),u=r.div(a);i=r.mod(a).eq(P)?u:u.add(jt)}else{const r=new p(n).mul(new p(s));i=r.and(we).gt(P)?r.shrn(64).add(jt):r.shrn(64)}return i}function Io(t,e,n,o){const s=t.gt(e)?t.sub(e):e.sub(t);if(n.lte(P)||s.eq(P))return P;let i;if(o)i=n.mul(s).shrn(64);else{const r=n.mul(s).shln(64),a=e.mul(t);i=r.div(a)}return i}function sc(t,e,n,o,s,i){if(n===P)return{amountIn:P,amountOut:P,nextSqrtPrice:e,feeAmount:P};const r=t.gte(e);let a,u,l,d;if(i){const h=W.checkMulDivFloor(o,W.checkUnsignedSub(he,s),he,64),f=So(t,e,n,r);f.gt(h)?(a=h,d=W.checkUnsignedSub(o,h),l=nc(t,n,h,r)):(a=f,d=W.checkMulDivCeil(a,s,he.sub(s),64),l=e),u=Io(t,l,n,r)}else{const h=Io(t,e,n,r);h.gt(o)?(u=o,l=oc(t,n,o,r)):(u=h,l=e),a=So(t,l,n,r),d=W.checkMulDivCeil(a,s,he.sub(s),64)}return{amountIn:a,amountOut:u,nextSqrtPrice:l,feeAmount:d}}function ic(t,e,n,o,s){let i=n,r=o.liquidity,{currentSqrtPrice:a}=o;const u={amountIn:P,amountOut:P,feeAmount:P,refAmount:P,nextSqrtPrice:P,crossTickNum:0};let l,d;const h=te.getDefaultSqrtPriceLimit(t);for(const f of s){if(t&&o.currentTickIndex<f.index||!t&&o.currentTickIndex>f.index||f===null)continue;t&&h.gt(f.sqrtPrice)||!t&&h.lt(f.sqrtPrice)?l=h:l=f.sqrtPrice;const _=sc(a,l,r,i,o.feeRate,e);if(_.amountIn.eq(P)||(i=e?i.sub(_.amountIn.add(_.feeAmount)):i.sub(_.amountOut)),u.amountIn=u.amountIn.add(_.amountIn),u.amountOut=u.amountOut.add(_.amountOut),u.feeAmount=u.feeAmount.add(_.feeAmount),_.nextSqrtPrice.eq(f.sqrtPrice)?(d=t?f.liquidityNet.mul(new p(-1)):f.liquidityNet,r=d.gt(P)?r.add(d):r.sub(d.abs()),a=f.sqrtPrice):a=_.nextSqrtPrice,u.crossTickNum+=1,i.eq(P))break}return u.amountIn=u.amountIn.add(u.feeAmount),u.nextSqrtPrice=a,u}function Ue(t,e,n){const o=p.min(t,e),s=p.max(t,e),i=W.fromX64_BN(n.mul(s).mul(o)),r=s.sub(o);return i.div(r)}function Ve(t,e,n){const o=p.min(t,e),i=p.max(t,e).sub(o);return n.shln(64).div(i)}var Ze=class{static updateFeeRate(t,e,n,o,s){const i=W.checkMulDivCeil(e,new p(o),he,64),r=n===0?P:W.checkMulDivFloor(e,new p(n),he,64),a=e.mul(i).mul(r);if(s?t.feeProtocolCoinA=t.feeProtocolCoinA.add(i):t.feeProtocolCoinB=t.feeProtocolCoinB.add(i),a.eq(P)||t.liquidity.eq(P))return{refFee:r,clmm:t};const u=a.shln(64).div(t.liquidity);return s?t.feeGrowthGlobalA=t.feeGrowthGlobalA.add(u):t.feeGrowthGlobalB=t.feeGrowthGlobalB.add(u),{refFee:r,clmm:t}}static getCoinAmountFromLiquidity(t,e,n,o,s){const i=new lt(t.toString()),r=new lt(e.toString()),a=new lt(n.toString()),u=new lt(o.toString());let l,d;return e.lt(n)?(l=W.toX64_Decimal(i).mul(u.sub(a)).div(a.mul(u)),d=new lt(0)):e.lt(o)?(l=W.toX64_Decimal(i).mul(u.sub(r)).div(r.mul(u)),d=W.fromX64_Decimal(i.mul(r.sub(a)))):(l=new lt(0),d=W.fromX64_Decimal(i.mul(u.sub(a)))),s?{coinA:new p(l.ceil().toString()),coinB:new p(d.ceil().toString())}:{coinA:new p(l.floor().toString()),coinB:new p(d.floor().toString())}}static estLiquidityAndcoinAmountFromOneAmounts(t,e,n,o,s,i,r){const a=z.sqrtPriceX64ToTickIndex(r),u=z.tickIndexToSqrtPriceX64(t),l=z.tickIndexToSqrtPriceX64(e);let d;if(a<t){if(!o)throw new Error("lower tick cannot calculate liquidity by coinB");d=Ue(u,l,n)}else if(a>e){if(o)throw new Error("upper tick cannot calculate liquidity by coinA");d=Ve(l,u,n)}else o?d=Ue(r,l,n):d=Ve(r,u,n);const h=Ze.getCoinAmountFromLiquidity(d,r,u,l,s),f=s?it(h.coinA.toString()).mul(1+i).toString():it(h.coinA.toString()).mul(1-i).toString(),_=s?it(h.coinB.toString()).mul(1+i).toString():it(h.coinB.toString()).mul(1-i).toString();return{coinAmountA:h.coinA,coinAmountB:h.coinB,tokenMaxA:s?new p(lt.ceil(f).toString()):new p(lt.floor(f).toString()),tokenMaxB:s?new p(lt.ceil(_).toString()):new p(lt.floor(_).toString()),liquidityAmount:d,fix_amount_a:o}}static estimateLiquidityFromcoinAmounts(t,e,n,o){if(e>n)throw new Error("lower tick cannot be greater than lower tick");const s=z.sqrtPriceX64ToTickIndex(t),i=z.tickIndexToSqrtPriceX64(e),r=z.tickIndexToSqrtPriceX64(n);if(s<e)return Ue(i,r,o.coinA);if(s>=n)return Ve(r,i,o.coinB);const a=Ue(t,r,o.coinA),u=Ve(t,i,o.coinB);return p.min(a,u)}static estCoinAmountsFromTotalAmount(t,e,n,o,s,i){const{ratioA:r,ratioB:a}=Ze.calculateDepositRatioFixTokenA(t,e,n);console.log({ratioA:r,ratioB:a});const u=it(o).mul(r).div(s),l=it(o).mul(a).div(i);return{amountA:u,amountB:l}}static calculateDepositRatioFixTokenA(t,e,n){const o=new p(1e8),{coinAmountB:s}=Ze.estLiquidityAndcoinAmountFromOneAmounts(t,e,o,!0,!0,0,n),i=z.sqrtPriceX64ToPrice(n,0,0),r=it(o.toString()).mul(i),a=r.add(s.toString()),u=r.div(a),l=it(s.toString()).div(a);return{ratioA:u,ratioB:l}}};function rc(t){return t.startsWith("0x")?`${t.slice(2)}`:t}var ac=0,Es=1,cc=2;function Po(t,e){return t===e?ac:t<e?Es:cc}function uc(t,e){let n=0;const o=t.length<=e.length?t.length:e.length,s=Po(t.length,e.length);for(;n<o;){const i=Po(t.charCodeAt(n),e.charCodeAt(n));if(n+=1,i!==0)return i}return s}function Bo(t,e){return uc(t,e)===Es}function Oo(t,...e){const n=Array.isArray(e[e.length-1])?e.pop():[];let s=[t,...e].filter(Boolean).join("::");return n&&n.length&&(s+=`<${n.join(", ")}>`),s}function N(t){var e;try{let n=t.replace(/\s/g,"");const o=n.match(/(<.+>)$/),s=(e=o==null?void 0:o[0])==null?void 0:e.match(/(\w+::\w+::\w+)(?:<.*?>(?!>))?/g);if(s){n=n.slice(0,n.indexOf("<"));const l={...N(n),type_arguments:s.map(d=>N(d).source_address)};return l.type_arguments=l.type_arguments.map(d=>Q.isSuiCoin(d)?d:N(d).source_address),l.source_address=Oo(l.full_address,l.type_arguments),l}const i=n.split("::"),a={full_address:n,address:n===xs||n===fc?"0x2":ht(i[0]),module:i[1],name:i[2],type_arguments:[],source_address:""};return a.full_address=`${a.address}::${a.module}::${a.name}`,a.source_address=Oo(a.full_address,a.type_arguments),a}catch{return{full_address:t,address:"",module:"",name:"",type_arguments:[],source_address:t}}}function Vt(t){return N(t).source_address}function lc(t){return t.toLowerCase().startsWith("0x")?ht(t):t}var dc=(t,e=!0)=>{const n=t.split("::"),o=n.shift();let s=ht(o);return e&&(s=rc(s)),`${s}::${n.join("::")}`};function Rs(t){for(const e in t){const n=typeof t[e];if(n==="object")Rs(t[e]);else if(n==="string"){const o=t[e];t[e]=lc(o)}}}var pc="0x2::coin::Coin",hc=/^0x2::coin::Coin<(.+)>$/,xs="0x2::sui::SUI",fc="0x0000000000000000000000000000000000000000000000000000000000000002::sui::SUI",Q=class{static getCoinTypeArg(t){const e=t.type.match(hc);return e?e[1]:null}static isSUI(t){const e=Q.getCoinTypeArg(t);return e?Q.getCoinSymbol(e)==="SUI":!1}static getCoinSymbol(t){return t.substring(t.lastIndexOf(":")+1)}static getBalance(t){return BigInt(t.fields.balance)}static totalBalance(t,e){let n=BigInt(0);return t.forEach(o=>{e===o.coinAddress&&(n+=BigInt(o.balance))}),n}static getID(t){return t.fields.id.id}static getCoinTypeFromArg(t){return`${pc}<${t}>`}static getFaucetCoins(t){const{events:e}=t,n=[];return e==null||e.forEach(o=>{const{type:s}=o;if(N(s).name==="InitEvent"){const i=o.parsedJson;n.push({transactionModule:o.transactionModule,suplyID:i.suplyID,decimals:i.decimals})}}),n}static getCoinAssets(t,e){const n=[];return e.forEach(o=>{Vt(o.coinAddress)===Vt(t)&&n.push(o)}),n}static isSuiCoin(t){return N(t).full_address===xs}static selectCoinObjectIdGreaterThanOrEqual(t,e,n=[]){const o=Q.selectCoinAssetGreaterThanOrEqual(t,e,n).selectedCoins.map(i=>i.coinObjectId),s=Q.selectCoinAssetGreaterThanOrEqual(t,e,n).remainingCoins;return{objectArray:o,remainCoins:s}}static selectCoinAssetGreaterThanOrEqual(t,e,n=[]){const o=Q.sortByBalance(t.filter(u=>!n.includes(u.coinObjectId))),s=Q.calculateTotalBalance(o);if(s<e)return{selectedCoins:[],remainingCoins:o};if(s===e)return{selectedCoins:o,remainingCoins:[]};let i=BigInt(0);const r=[],a=[...o];for(;i<s;){const u=e-i,l=a.findIndex(h=>h.balance>=u);if(l!==-1){r.push(a[l]),a.splice(l,1);break}const d=a.pop();d.balance>0&&(r.push(d),i+=d.balance)}return{selectedCoins:Q.sortByBalance(r),remainingCoins:Q.sortByBalance(a)}}static sortByBalance(t){return t.sort((e,n)=>e.balance<n.balance?-1:e.balance>n.balance?1:0)}static sortByBalanceDes(t){return t.sort((e,n)=>e.balance>n.balance?-1:e.balance<n.balance?0:1)}static calculateTotalBalance(t){return t.reduce((e,n)=>e+n.balance,BigInt(0))}};function gc(t,{numerator:e,denominator:n},o){return o?t.mul(n.add(e)).div(n):t.mul(n).div(n.add(e))}function it(t){return X.isDecimal(t)?t:new X(t===void 0?0:t)}function Ee(t){return t.data}function js(t){if(t.error&&"object_id"in t.error&&"version"in t.error&&"digest"in t.error){const{error:e}=t;return{objectId:e.object_id,version:e.version,digest:e.digest}}}function Ds(t){if(t.error&&"object_id"in t.error&&!("version"in t.error)&&!("digest"in t.error))return t.error.object_id}function mc(t){if("reference"in t)return t.reference;const e=Ee(t);return e?{objectId:e.objectId,version:e.version,digest:e.digest}:js(t)}function ke(t){var e;return"objectId"in t?t.objectId:((e=mc(t))==null?void 0:e.objectId)??Ds(t)}function _c(t){return t.data!==void 0}function wc(t){return t.content!==void 0}function Ms(t){const e="data"in t?Ee(t):t;if(!(!e||!wc(e)||e.content.dataType!=="moveObject"))return e.content}function Zn(t){var e;return(e=Ms(t))==null?void 0:e.type}function bc(t){var n;const e=_c(t)?t.data:t;return!(e!=null&&e.type)&&"data"in t?((n=e==null?void 0:e.content)==null?void 0:n.dataType)==="package"?"package":Zn(t):e==null?void 0:e.type}function Qn(t){var e;return(e=Ee(t))==null?void 0:e.previousTransaction}function yc(t){var e;return(e=Ee(t))==null?void 0:e.owner}function vc(t){var n;const e=(n=Ee(t))==null?void 0:n.display;return e||{data:null,error:null}}function Qt(t){var n;const e=(n=Ms(t))==null?void 0:n.fields;if(e)return"fields"in e?e.fields:e}function $t(t,e=32){return BigInt.asUintN(e,BigInt(t)).toString()}function re(t,e=32){return Number(BigInt.asIntN(e,BigInt(t)))}function Ac(t,e,n){const o=N(t).name,s=N(e).name;return`${o}-${s}[${n}]`}function hn(t){const e=Zn(t),n=N(e),o=Qt(t),s=[];o.rewarder_manager.fields.rewarders.forEach(r=>{const{emissions_per_second:a}=r.fields,u=W.fromX64(new p(a)),l=Math.floor(u.toNumber()*60*60*24);s.push({emissions_per_second:a,coinAddress:N(r.fields.reward_coin.fields.name).source_address,growth_global:r.fields.growth_global,emissionsEveryDay:l})});const i={poolAddress:ke(t),poolType:e,coinTypeA:n.type_arguments[0],coinTypeB:n.type_arguments[1],coinAmountA:o.coin_a,coinAmountB:o.coin_b,current_sqrt_price:o.current_sqrt_price,current_tick_index:re(BigInt(o.current_tick_index.fields.bits)),fee_growth_global_a:o.fee_growth_global_a,fee_growth_global_b:o.fee_growth_global_b,fee_protocol_coin_a:o.fee_protocol_coin_a,fee_protocol_coin_b:o.fee_protocol_coin_b,fee_rate:o.fee_rate,is_pause:o.is_pause,liquidity:o.liquidity,position_manager:{positions_handle:o.position_manager.fields.positions.fields.id.id,size:o.position_manager.fields.positions.fields.size},rewarder_infos:s,rewarder_last_updated_time:o.rewarder_manager.fields.last_updated_time,tickSpacing:o.tick_spacing,ticks_handle:o.tick_manager.fields.ticks.fields.id.id,uri:o.url,index:Number(o.index),name:""};return i.name=Ac(i.coinTypeA,i.coinTypeB,i.tickSpacing),i}function Cc(t){const e=vc(t).data,n={creator:"",description:"",image_url:"",link:"",name:"",project_url:""};return e&&(n.creator=e.creator,n.description=e.description,n.image_url=e.image_url,n.link=e.link,n.name=e.name,n.project_url=e.project_url),n}function fn(t){let e={creator:"",description:"",image_url:"",link:"",name:"",project_url:""},n={...e,pos_object_id:"",owner:"",type:"",coin_type_a:"",coin_type_b:"",liquidity:"",tick_lower_index:0,tick_upper_index:0,index:0,pool:"",reward_amount_owed_0:"0",reward_amount_owed_1:"0",reward_amount_owed_2:"0",reward_growth_inside_0:"0",reward_growth_inside_1:"0",reward_growth_inside_2:"0",fee_growth_inside_a:"0",fee_owed_a:"0",fee_growth_inside_b:"0",fee_owed_b:"0",position_status:"Exists"},o=Qt(t);if(o){const r=Zn(t),a=yc(t);"nft"in o?(o=o.nft.fields,e.description=o.description,e.name=o.name,e.link=o.url):e=Cc(t),n={...e,pos_object_id:o.id.id,owner:a.AddressOwner,type:r,coin_type_a:o.coin_type_a.fields.name,coin_type_b:o.coin_type_b.fields.name,liquidity:o.liquidity,tick_lower_index:re(BigInt(o.tick_lower_index.fields.bits)),tick_upper_index:re(BigInt(o.tick_upper_index.fields.bits)),index:o.index,pool:o.pool,reward_amount_owed_0:"0",reward_amount_owed_1:"0",reward_amount_owed_2:"0",reward_growth_inside_0:"0",reward_growth_inside_1:"0",reward_growth_inside_2:"0",fee_growth_inside_a:"0",fee_owed_a:"0",fee_growth_inside_b:"0",fee_owed_b:"0",position_status:"Exists"}}const s=js(t);s&&(n.pos_object_id=s.objectId,n.position_status="Deleted");const i=Ds(t);return i&&(n.pos_object_id=i,n.position_status="NotExists"),n}function Ns(t){const e={reward_amount_owed_0:"0",reward_amount_owed_1:"0",reward_amount_owed_2:"0",reward_growth_inside_0:"0",reward_growth_inside_1:"0",reward_growth_inside_2:"0"};t="fields"in t?t.fields:t,t.rewards.forEach((i,r)=>{const{amount_owned:a,growth_inside:u}="fields"in i?i.fields:i;r===0?(e.reward_amount_owed_0=a,e.reward_growth_inside_0=u):r===1?(e.reward_amount_owed_1=a,e.reward_growth_inside_1=u):r===2&&(e.reward_amount_owed_2=a,e.reward_growth_inside_2=u)});const n="fields"in t.tick_lower_index?t.tick_lower_index.fields.bits:t.tick_lower_index.bits,o="fields"in t.tick_upper_index?t.tick_upper_index.fields.bits:t.tick_upper_index.bits;return{liquidity:t.liquidity,tick_lower_index:re(BigInt(n)),tick_upper_index:re(BigInt(o)),...e,fee_growth_inside_a:t.fee_growth_inside_a,fee_owed_a:t.fee_owned_a,fee_growth_inside_b:t.fee_growth_inside_b,fee_owed_b:t.fee_owned_b,pos_object_id:t.position_id}}function gn(t){const n=Qt(t).value.fields.value.fields;return{objectId:ke(t),index:re(BigInt(n.index.fields.bits)),sqrtPrice:new p(n.sqrt_price),liquidityNet:new p(n.liquidity_net.fields.bits),liquidityGross:new p(n.liquidity_gross),feeGrowthOutsideA:new p(n.fee_growth_outside_a),feeGrowthOutsideB:new p(n.fee_growth_outside_b),rewardersGrowthOutside:n.rewards_growth_outside}}function Tc(t){return{objectId:"",index:re(BigInt(t.index.bits)),sqrtPrice:new p(t.sqrt_price),liquidityNet:new p(t.liquidity_net.bits),liquidityGross:new p(t.liquidity_gross),feeGrowthOutsideA:new p(t.fee_growth_outside_a),feeGrowthOutsideB:new p(t.fee_growth_outside_b),rewardersGrowthOutside:t.rewards_growth_outside}}function kc(t,e,n,o,s,i){const r=t.rewarder_infos,a=[];for(let u=0;u<r.length;u+=1){let l=i[u];e!==null&&(t.current_tick_index<o?l=i[u].sub(new p(e.rewardersGrowthOutside[u])):l=e.rewardersGrowthOutside[u]);let d=new p(0);n!==null&&(t.current_tick_index>=s?d=i[u].sub(new p(n.rewardersGrowthOutside[u])):d=n.rewardersGrowthOutside[u]);const h=W.subUnderflowU128(W.subUnderflowU128(new p(i[u]),new p(l)),new p(d));a.push(h)}return a}function Yn(t){const e=Q.isSuiCoin(t.coinTypeA),n=Q.isSuiCoin(t.coinTypeB);return{isAdjustCoinA:e,isAdjustCoinB:n}}function Sc(t,e){return X.ceil(it(t).div(1+e)).toString()}var R=class{static createCollectRewarderAndFeeParams(t,e,n,o,s,i){s===void 0&&(s=[...o]),i===void 0&&(i=[...o]);const r=Vt(n.coinTypeA),a=Vt(n.coinTypeB);if(n.collect_fee){const l=R.buildCoinInputForAmount(e,s,BigInt(0),r,!1);s=l.remainCoins;const d=R.buildCoinInputForAmount(e,i,BigInt(0),a,!1);i=d.remainCoins,e=t.Position.createCollectFeePaylod({pool_id:n.pool_id,pos_id:n.pos_id,coinTypeA:n.coinTypeA,coinTypeB:n.coinTypeB},e,l.transactionArgument,d.transactionArgument)}const u=[];return n.rewarder_coin_types.forEach(l=>{switch(Vt(l)){case n.coinTypeA:u.push(R.buildCoinInputForAmount(e,s,BigInt(0),l,!1).transactionArgument);break;case n.coinTypeB:u.push(R.buildCoinInputForAmount(e,i,BigInt(0),l,!1).transactionArgument);break;default:u.push(R.buildCoinInputForAmount(e,o,BigInt(0),l,!1).transactionArgument);break}}),e=t.Rewarder.createCollectRewarderPaylod(n,e,u),e}static async adjustTransactionForGas(t,e,n,o){o.setSender(t.senderAddress);const s=Q.selectCoinAssetGreaterThanOrEqual(e,n).selectedCoins;if(s.length===0)throw new Error("Insufficient balance");const i=Q.calculateTotalBalance(e);if(i-n>1e9)return{fixAmount:n};const r=await t.fullClient.calculationTxGas(o);if(Q.selectCoinAssetGreaterThanOrEqual(e,BigInt(r),s.map(u=>u.coinObjectId)).selectedCoins.length===0){const u=BigInt(r)+BigInt(500);if(i-n<u){if(n-=u,n<0)throw new Error("gas Insufficient balance");const l=new H;return{fixAmount:n,newTx:l}}}return{fixAmount:n}}static async buildAddLiquidityFixTokenForGas(t,e,n,o){let s=await R.buildAddLiquidityFixToken(t,e,n);const{isAdjustCoinA:i}=Yn(n),r=i?n.amount_a:n.amount_b,a=await R.adjustTransactionForGas(t,Q.getCoinAssets(i?n.coinTypeA:n.coinTypeB,e),BigInt(r),s),{fixAmount:u}=a,{newTx:l}=a;if(l!==void 0){let d,h;if(i)n.amount_a=Number(u),d=R.buildAddLiquidityFixTokenCoinInput(l,!n.fix_amount_a,u.toString(),n.slippage,n.coinTypeA,e,!1),h=R.buildAddLiquidityFixTokenCoinInput(l,n.fix_amount_a,n.amount_b,n.slippage,n.coinTypeB,e,!1);else return n.amount_b=Number(u),d=R.buildAddLiquidityFixTokenCoinInput(l,!n.fix_amount_a,n.amount_a,n.slippage,n.coinTypeA,e,!1),h=R.buildAddLiquidityFixTokenCoinInput(l,n.fix_amount_a,u.toString(),n.slippage,n.coinTypeB,e,!1),n=R.fixAddLiquidityFixTokenParams(n,o.slippage,o.curSqrtPrice),s=await R.buildAddLiquidityFixTokenArgs(l,t,e,n,d,h),s}return s}static async buildAddLiquidityFixToken(t,e,n){if(t.senderAddress.length===0)throw Error("this config sdk senderAddress is empty");let o=new H;const s=R.buildAddLiquidityFixTokenCoinInput(o,!n.fix_amount_a,n.amount_a,n.slippage,n.coinTypeA,e,!1),i=R.buildAddLiquidityFixTokenCoinInput(o,n.fix_amount_a,n.amount_b,n.slippage,n.coinTypeB,e,!1);return o=R.buildAddLiquidityFixTokenArgs(o,t,e,n,s,i),o}static buildAddLiquidityFixTokenCoinInput(t,e,n,o,s,i,r=!0){return e?R.buildCoinInputForAmountInterval(t,i,{amountSecond:BigInt(Sc(n,o)),amountFirst:BigInt(n)},s,r):R.buildCoinInputForAmount(t,i,BigInt(n),s,r)}static fixAddLiquidityFixTokenParams(t,e,n){const o=t.fix_amount_a?t.amount_a:t.amount_b,s=Ze.estLiquidityAndcoinAmountFromOneAmounts(Number(t.tick_lower),Number(t.tick_upper),new p(o),t.fix_amount_a,!0,e,n);return t.amount_a=t.fix_amount_a?t.amount_a:s.tokenMaxA.toNumber(),t.amount_b=t.fix_amount_a?s.tokenMaxB.toNumber():t.amount_b,t}static buildAddLiquidityFixTokenArgs(t,e,n,o,s,i){const r=[o.coinTypeA,o.coinTypeB],a=o.is_open?"open_position_with_liquidity_by_fix_coin":"add_liquidity_by_fix_coin",{clmm_pool:u,integrate:l}=e.sdkOptions;o.is_open||(t=R.createCollectRewarderAndFeeParams(e,t,o,n,s.remainCoins,i.remainCoins));const d=Z(u),h=o.is_open?[t.object(d.global_config_id),t.object(o.pool_id),t.pure($t(BigInt(o.tick_lower)).toString()),t.pure($t(BigInt(o.tick_upper)).toString()),s.transactionArgument,i.transactionArgument,t.pure(o.amount_a),t.pure(o.amount_b),t.pure(o.fix_amount_a),t.object(et)]:[t.object(d.global_config_id),t.object(o.pool_id),t.object(o.pos_id),s.transactionArgument,i.transactionArgument,t.pure(o.amount_a),t.pure(o.amount_b),t.pure(o.fix_amount_a),t.object(et)];return t.moveCall({target:`${l.published_at}::${ne}::${a}`,typeArguments:r,arguments:h}),t}static async buildSwapTransactionForGas(t,e,n,o){let s=R.buildSwapTransaction(t,e,n);s.setSender(t.senderAddress);const i=await R.adjustTransactionForGas(t,Q.getCoinAssets(e.a2b?e.coinTypeA:e.coinTypeB,n),BigInt(e.by_amount_in?e.amount:e.amount_limit),s),{fixAmount:r,newTx:a}=i;if(a!==void 0){a.setSender(t.senderAddress),e.by_amount_in?e.amount=r.toString():e.amount_limit=r.toString(),e=R.fixSwapParams(t,e,o);const u=R.buildCoinInputForAmount(s,n,e.a2b?BigInt(e.by_amount_in?e.amount:e.amount_limit):BigInt(0),e.coinTypeA),l=R.buildCoinInputForAmount(s,n,e.a2b?BigInt(0):BigInt(e.by_amount_in?e.amount:e.amount_limit),e.coinTypeB);s=R.buildSwapTransactionArgs(a,e,t.sdkOptions,u,l)}return s}static buildSwapTransaction(t,e,n){let o=new H;o.setSender(t.senderAddress);const s=R.buildCoinInputForAmount(o,n,e.a2b?BigInt(e.by_amount_in?e.amount:e.amount_limit):BigInt(0),e.coinTypeA,!1),i=R.buildCoinInputForAmount(o,n,e.a2b?BigInt(0):BigInt(e.by_amount_in?e.amount:e.amount_limit),e.coinTypeB,!1);return o=R.buildSwapTransactionArgs(o,e,t.sdkOptions,s,i),o}static buildSwapTransactionArgs(t,e,n,o,s){const{clmm_pool:i,integrate:r}=n,a=te.getDefaultSqrtPriceLimit(e.a2b),u=[e.coinTypeA,e.coinTypeB],{global_config_id:l}=Z(i);if(l===void 0)throw Error("clmm.config.global_config_id is undefined");const d=e.swap_partner!==void 0,h=d?e.a2b?"swap_a2b_with_partner":"swap_b2a_with_partner":e.a2b?"swap_a2b":"swap_b2a",f=d?[t.pure(l),t.pure(e.pool_id),t.pure(e.swap_partner),o.transactionArgument,s.transactionArgument,t.pure(e.by_amount_in),t.pure(e.amount),t.pure(e.amount_limit),t.pure(a.toString()),t.pure(et)]:[t.pure(l),t.pure(e.pool_id),o.transactionArgument,s.transactionArgument,t.pure(e.by_amount_in),t.pure(e.amount),t.pure(e.amount_limit),t.pure(a.toString()),t.pure(et)];return t.moveCall({target:`${r.published_at}::${ne}::${h}`,typeArguments:u,arguments:f}),t}static fixSwapParams(t,e,n){const o=t.Swap.calculateRates({decimalsA:n.decimalsA,decimalsB:n.decimalsB,a2b:e.a2b,byAmountIn:e.by_amount_in,amount:new p(e.amount),swapTicks:n.swapTicks,currentPool:n.currentPool}),s=n.byAmountIn?o.estimatedAmountOut:o.estimatedAmountIn,i=gc(s,n.slippage,!n.byAmountIn);return e.amount_limit=i.toString(),e}static async syncBuildCoinInputForAmount(t,e,n,o,s=!0){if(t.senderAddress.length===0)throw Error("this config sdk senderAddress is empty");const i=await t.getOwnerCoinAssets(t.senderAddress,o);return R.buildCoinInputForAmount(e,i,n,o,s).transactionArgument}static buildCoinInputForAmount(t,e,n,o,s=!0){const i=Q.getCoinAssets(o,e);if(n===BigInt(0))return i.length>0?R.buildCoinInput(t,[...e],[...i],n,o,s):R.buildCoinZero(e,t,o,s);const r=Q.calculateTotalBalance(i);if(r<n)throw new Error(`The amount(${r}) is Insufficient balance for ${o} , expect ${n} `);return R.buildCoinInput(t,e,i,n,o,s)}static buildCoinInput(t,e,n,o,s,i=!0){if(Q.isSuiCoin(s)){if(i){const _=t.splitCoins(t.gas,[t.pure(o.toString())]);return{transactionArgument:t.makeMoveVec({objects:[_]}),remainCoins:e}}if(o===BigInt(0)&&n.length>1){const _=Q.selectCoinObjectIdGreaterThanOrEqual(n,o);return{transactionArgument:t.object(_.objectArray[0]),remainCoins:_.remainCoins}}const h=Q.selectCoinObjectIdGreaterThanOrEqual(n,o);return{transactionArgument:t.splitCoins(t.gas,[t.pure(o.toString())]),remainCoins:h.remainCoins}}const r=Q.selectCoinObjectIdGreaterThanOrEqual(n,o),a=r.objectArray;if(i)return{transactionArgument:t.makeMoveVec({objects:a.map(h=>t.object(h))}),remainCoins:r.remainCoins};const[u,...l]=a,d=t.object(u);return l.length>0&&t.mergeCoins(d,l.map(h=>t.object(h))),{transactionArgument:d,remainCoins:r.remainCoins}}static buildCoinZero(t,e,n,o=!0){const s=R.moveCallCoinZero(e,n);return o?{transactionArgument:e.makeMoveVec({objects:[s]}),remainCoins:t,isMintCoin:!0}:{transactionArgument:s,remainCoins:t,isMintCoin:!0}}static buildCoinInputForAmountInterval(t,e,n,o,s=!0){const i=Q.getCoinAssets(o,e);if(n.amountFirst===BigInt(0))return i.length>0?R.buildCoinInput(t,[...e],[...i],n.amountFirst,o,s):R.buildCoinZero(e,t,o,s);const r=Q.calculateTotalBalance(i);if(r>=n.amountFirst)return R.buildCoinInput(t,[...e],[...i],n.amountFirst,o,s);if(r<n.amountSecond)throw new Error(`The amount(${r}) is Insufficient balance for ${o} , expect ${n.amountSecond} `);return R.buildCoinInput(t,[...e],[...i],n.amountSecond,o,s)}static async buildRouterSwapTransaction(t,e,n,o){let s=new H;return e.paths.length>1&&(e.partner=""),s=await this.buildRouterBasePathTx(t,e,n,o,s),s}static async buildAggregatorSwapTransaction(t,e,n,o,s){var a,u;let i=new H;e.splitPaths.length>1&&(o="");const r=e.splitPaths.some(l=>l.basePaths.some(d=>d.label==="Deepbook"));if((!e.byAmountIn||e.splitPaths.length===1)&&!r){const l=[];for(const h of e.splitPaths){const f=[],_=[],v=[],I=[];for(let y=0;y<h.basePaths.length;y+=1){const S=h.basePaths[y];f.push(S.direction),_.push(S.poolAddress),v.push(new p(S.inputAmount)),y===0?I.push(S.fromCoin,S.toCoin):I.push(S.toCoin)}const m={amountIn:new p(h.inputAmount),amountOut:new p(h.outputAmount),poolAddress:_,a2b:f,rawAmountLimit:v,isExceed:!1,coinType:I};l.push(m)}const d={paths:l,partner:o,priceSplitPoint:s};i=await this.buildRouterBasePathTx(t,d,e.byAmountIn,n,i)}else{const l=Math.round(e.outputAmount*(1-s));let d=(a=R.buildCoinInputForAmount(i,n,e.byAmountIn?BigInt(e.inputAmount):BigInt(l),e.fromCoin,!1))==null?void 0:a.transactionArgument,h=(u=R.buildCoinInputForAmount(i,n,BigInt(0),e.toCoin,!1))==null?void 0:u.transactionArgument;const f=[];let _=!1,v;if(r){const[I,m]=Eo.createAccountCap(t.senderAddress,t.sdkOptions,i);i=m,v=I,_=!0}for(let I=0;I<e.splitPaths.length;I+=1){const m=e.splitPaths[I];let y;for(let S=0;S<m.basePaths.length;S+=1){const C=m.basePaths[S];if(C.label==="Deepbook")if(S===0)if(m.basePaths.length===1){const B=this.buildDeepbookBasePathTx(t,C,i,v,d,h,!1);d=B.from,h=B.to}else{y=R.moveCallCoinZero(i,C.toCoin);const B=this.buildDeepbookBasePathTx(t,C,i,v,d,y,!1);d=B.from,y=B.to}else{const B=this.buildDeepbookBasePathTx(t,C,i,v,y,h,!0);y=B.from,h=B.to}if(C.label==="Cetus")if(S===0)if(m.basePaths.length===1){const B=this.buildClmmBasePathTx(t,C,i,e.byAmountIn,d,h,!1,o);d=B.from,h=B.to}else{y=R.moveCallCoinZero(i,C.toCoin);const B=this.buildClmmBasePathTx(t,C,i,e.byAmountIn,d,y,!1,o);d=B.from,y=B.to}else{const B=this.buildClmmBasePathTx(t,C,i,e.byAmountIn,y,h,!0,o);y=B.from,h=B.to,i.moveCall({target:`${t.sdkOptions.integrate.published_at}::${Ga}::send_coin`,typeArguments:[C.fromCoin],arguments:[y,i.pure(t.senderAddress)]})}}}f.push(d,h),_&&(i=Eo.deleteAccountCapByObject(v,t.sdkOptions,i)),e.byAmountIn&&i.moveCall({target:`${t.sdkOptions.integrate.published_at}::${Ce}::check_coin_threshold`,typeArguments:[e.toCoin],arguments:[h,i.pure(l)]}),i.transferObjects(f,i.pure(t.senderAddress))}return i}static buildDeepbookBasePathTx(t,e,n,o,s,i,r){const a=e.direction?s:i,u=e.direction?i:s,l=[n.object(e.poolAddress),o,n.pure(e.inputAmount),n.pure(0),n.pure(e.direction),a,u,n.pure(r),n.object(et)],d=e.direction?[e.fromCoin,e.toCoin]:[e.toCoin,e.fromCoin],h=n.moveCall({target:`${t.sdkOptions.deepbook_endpoint_v2.published_at}::endpoints_v2::swap`,typeArguments:d,arguments:l});return s=e.direction?h[0]:h[1],i=e.direction?h[1]:h[0],{from:s,to:i,tx:n}}static buildClmmBasePathTx(t,e,n,o,s,i,r,a){const{clmm_pool:u,integrate:l}=t.sdkOptions,d=Z(u).global_config_id;let h=e.direction?s:i,f=e.direction?i:s;const _=a==="",v=_?Ce:ko,I=_?"swap":"swap_with_partner",m=o?e.inputAmount.toString():e.outputAmount.toString(),y=te.getDefaultSqrtPriceLimit(e.direction),S=_?[n.object(d),n.object(e.poolAddress),h,f,n.pure(e.direction),n.pure(o),n.pure(m),n.pure(y.toString()),n.pure(r),n.object(et)]:[n.object(d),n.object(e.poolAddress),n.pure(a),h,f,n.pure(e.direction),n.pure(o),n.pure(m),n.pure(y.toString()),n.pure(r),n.object(et)],C=e.direction?[e.fromCoin,e.toCoin]:[e.toCoin,e.fromCoin],B=n.moveCall({target:`${l.published_at}::${v}::${I}`,typeArguments:C,arguments:S});return h=B[0],f=B[1],s=e.direction?h:f,i=e.direction?f:h,{from:s,to:i,tx:n}}static async buildRouterBasePathTx(t,e,n,o,s){var C,B;const{clmm_pool:i,integrate:r}=t.sdkOptions,a=Z(i).global_config_id,u=e.paths.filter(k=>k&&k.poolAddress),l=Number(u.reduce((k,q)=>k.add(q.amountIn),P).toString()),d=Number(u.reduce((k,q)=>k.add(q.amountOut),P).toString()),h=Math.round(n?Number(d.toString())*(1-e.priceSplitPoint):Number(l.toString())*(1+e.priceSplitPoint)),f=e.paths[0].coinType[0],_=e.paths[0].coinType[e.paths[0].coinType.length-1];let v=(C=R.buildCoinInputForAmount(s,o,BigInt(n?l:h),f,!1))==null?void 0:C.transactionArgument,I=(B=R.buildCoinInputForAmount(s,o,BigInt(0),_,!1))==null?void 0:B.transactionArgument;const m=[],y=e.partner==="",S=y?Ce:ko;for(const k of u)if(k.poolAddress.length===1){const q=k.a2b[0],M={amount:Number(k.amountIn.toString()),amountLimit:h,poolCoinA:k.a2b[0]?f:_,poolCoinB:k.a2b[0]?_:f},Y=y?"swap":"swap_with_partner",Bt=q?v:I,x=q?I:v,L=n?k.amountIn.toString():k.amountOut.toString(),nt=te.getDefaultSqrtPriceLimit(q).toString(),mt=y?[s.object(a),s.object(k.poolAddress[0]),Bt,x,s.pure(q),s.pure(n),s.pure(L),s.pure(nt),s.pure(!1),s.object(et)]:[s.object(a),s.object(k.poolAddress[0]),s.pure(e.partner),Bt,x,s.pure(q),s.pure(n),s.pure(L),s.pure(nt),s.pure(!1),s.object(et)],Gt=[M.poolCoinA,M.poolCoinB],vt=s.moveCall({target:`${t.sdkOptions.integrate.published_at}::${S}::${Y}`,typeArguments:Gt,arguments:mt});v=q?vt[0]:vt[1],I=q?vt[1]:vt[0]}else{const q=n?k.amountIn:k.rawAmountLimit[0],M=n?0:k.amountOut;let Y="";y&&(k.a2b[0]?k.a2b[1]?Y="swap_ab_bc":Y="swap_ab_cb":k.a2b[1]?Y="swap_ba_bc":Y="swap_ba_cb"),y||(k.a2b[0]?k.a2b[1]?Y="swap_ab_bc_with_partner":Y="swap_ab_cb_with_partner":k.a2b[1]?Y="swap_ba_bc_with_partner":Y="swap_ba_cb_with_partner");const Bt=te.getDefaultSqrtPriceLimit(k.a2b[0]),x=te.getDefaultSqrtPriceLimit(k.a2b[1]),L=y?[s.object(a),s.object(k.poolAddress[0]),s.object(k.poolAddress[1]),v,I,s.pure(n),s.pure(q.toString()),s.pure(M.toString()),s.pure(Bt.toString()),s.pure(x.toString()),s.object(et)]:[s.object(a),s.object(k.poolAddress[0]),s.object(k.poolAddress[1]),s.pure(e.partner),v,I,s.pure(n),s.pure(q.toString()),s.pure(M.toString()),s.pure(Bt.toString()),s.pure(x.toString()),s.object(et)],nt=[k.coinType[0],k.coinType[1],k.coinType[2]],mt=s.moveCall({target:`${r.published_at}::${S}::${Y}`,typeArguments:nt,arguments:L});v=mt[0],I=mt[1]}return n&&s.moveCall({target:`${r.published_at}::${Ce}::check_coin_threshold`,typeArguments:[_],arguments:[I,s.pure(h)]}),m.push(v,I),s.transferObjects(m,s.pure(t.senderAddress)),s}static buildCoinTypePair(t,e){const n=[];if(t.length===2){const o=[];o.push(t[0],t[1]),n.push(o)}else{const o=[];o.push(t[0],t[t.length-1]),n.push(o);for(let s=1;s<t.length-1;s+=1){if(e[s-1]===0)continue;const i=[];i.push(t[0],t[s],t[t.length-1]),n.push(i)}}return n}},pt=R;La(pt,"moveCallCoinZero",(t,e)=>t.moveCall({target:"0x2::coin::zero",typeArguments:[e]}));var pe=new p(1e9),Eo=class{static createAccountCap(t,e,n,o=!1){const{deepbook:s}=e,[i]=n.moveCall({target:`${s.published_at}::${Wa}::create_account`,typeArguments:[],arguments:[]});return o&&n.transferObjects([i],n.pure(t)),[i,n]}static deleteAccountCap(t,e,n){const{deepbook:o}=e,s=[n.pure(t)];return n.moveCall({target:`${o.published_at}::${pn}::delete_account_cap`,typeArguments:[],arguments:s}),n}static deleteAccountCapByObject(t,e,n){const{deepbook:o}=e,s=[t];return n.moveCall({target:`${o.published_at}::${pn}::delete_account_cap`,typeArguments:[],arguments:s}),n}static async getAccountCap(t){const e=await t.fullClient.getOwnedObjectsByPage(t.senderAddress,{options:{showType:!0,showContent:!0,showDisplay:!0,showOwner:!0},filter:{MoveModule:{package:t.sdkOptions.deepbook.package_id,module:pn}}});return e.data.length===0?"":e.data[0].data.objectId}static async getPools(t){const e=t.sdkOptions.deepbook.package_id,n=[];try{(await t.fullClient.queryEventsByPage({MoveEventType:`${e}::clob_v2::PoolCreated`})).data.forEach(s=>{const i=s.parsedJson;i&&n.push({poolID:i.pool_id,tickSize:Number(i.tick_size),lotSize:Number(i.lot_size),takerFeeRate:Number(i.taker_fee_rate),makerRebateRate:Number(i.maker_rebate_rate),baseAsset:i.base_asset.name,quoteAsset:i.quote_asset.name})})}catch(o){console.log("getPoolImmutables",o)}return n}static async getPoolAsks(t,e,n,o){var f;const{simulationAccount:s}=t.sdkOptions,{deepbook_endpoint_v2:i}=t.sdkOptions,r=new H,a=[],u=[n,o],l=[r.pure(e),r.pure("0"),r.pure("999999999999"),r.pure(et)];r.moveCall({target:`${i.published_at}::endpoints_v2::get_level2_book_status_ask_side`,arguments:l,typeArguments:u});const h=(f=(await t.fullClient.devInspectTransactionBlock({transactionBlock:r,sender:s.address})).events)==null?void 0:f.filter(_=>N(_.type).name==="BookStatus");if(h.length===0)return a;for(let _=0;_<h[0].parsedJson.depths.length;_++){const v=h[0].parsedJson.price[_],I=h[0].parsedJson.depths[_],m={price:parseInt(v,10),quantity:parseInt(I,10)};a.push(m)}return a}static async getPoolBids(t,e,n,o){var f;const{simulationAccount:s}=t.sdkOptions,{deepbook_endpoint_v2:i}=t.sdkOptions,r=new H,a=[],u=[n,o],l=[r.pure(e),r.pure("0"),r.pure("999999999999"),r.pure(et)];r.moveCall({target:`${i.published_at}::endpoints_v2::get_level2_book_status_bid_side`,arguments:l,typeArguments:u});const h=(f=(await t.fullClient.devInspectTransactionBlock({transactionBlock:r,sender:s.address})).events)==null?void 0:f.filter(_=>N(_.type).name==="BookStatus");if(h.length===0)return a;for(let _=0;_<h[0].parsedJson.depths.length;_++){const v=h[0].parsedJson.price[_],I=h[0].parsedJson.depths[_],m={price:parseInt(v,10),quantity:parseInt(I,10)};a.push(m)}return a}static async preSwap(t,e,n,o){let s=!1,i=P,r=new p(o),a=P;const u=new p(o);if(n){let l=await this.getPoolBids(t,e.poolID,e.baseAsset,e.quoteAsset);l===null&&(s=!0),l=l.sort((d,h)=>h.price-d.price);for(let d=0;d<l.length;d+=1){const h=new p(l[d].quantity),f=new p(l[d].price),_=h.mul(new p(f)).mul(new p(e.takerFeeRate)).div(pe).div(pe);if(r.gt(h))r=r.sub(h),i=i.add(h.mul(f).div(pe).sub(_)),a=a.add(_);else{const v=r.mul(new p(l[d].price)).div(pe),I=v.mul(new p(e.takerFeeRate)).div(pe);i=i.add(v.sub(I)),r=r.sub(r),a=a.add(I)}if(r.eq(P))break}}else{const l=await this.getPoolAsks(t,e.poolID,e.baseAsset,e.quoteAsset);l===null&&(s=!0);for(let d=0;d<l.length;d+=1){const h=new p(l[d].price).mul(new p(l[d].quantity)).div(new p(1e9)),f=h.mul(new p(e.takerFeeRate)).div(pe),_=h.add(f);if(r.gt(h))i=i.add(new p(l[d].quantity)),r=r.sub(_),a=a.add(f);else{const v=new p(l[d].quantity).div(new p(e.lotSize)),I=_.div(v),m=r.div(I);i=i.add(m.muln(e.lotSize)),r=r.sub(m.mul(I)),a=a.add(m.div(v).mul(f))}if(r.eq(P))break}}return{poolAddress:e.poolID,estimatedAmountIn:u.sub(r).toNumber(),estimatedAmountOut:i.toNumber(),estimatedFeeAmount:a,isExceed:s,amount:Number(o),aToB:n,byAmountIn:!0}}static async simulateSwap(t,e,n,o,s,i){var k;const{deepbook_endpoint_v2:r}=t.sdkOptions;let a=new H;const u=await this.getAccountCap(t);let l;if(u===""){const q=this.createAccountCap(t.senderAddress,t.sdkOptions,a),M=q[0];a=q[1],l=M}else l=a.pure(u);const d=await t.getOwnerCoinAssets(t.senderAddress),h=pt.buildCoinInputForAmount(a,d,BigInt(i),n,!1),f=h==null?void 0:h.transactionArgument,_=pt.buildCoinInputForAmount(a,d,BigInt(i),o,!1),v=_==null?void 0:_.transactionArgument,I=[n,o],m=[a.pure(e),l,a.pure(i),a.pure(0),a.pure(s),f,v,a.pure(et)];a.moveCall({target:`${r.published_at}::${Ja}::swap`,arguments:m,typeArguments:I});const{simulationAccount:y}=t.sdkOptions,C=(k=(await t.fullClient.devInspectTransactionBlock({transactionBlock:a,sender:y.address})).events)==null?void 0:k.filter(q=>N(q.type).name==="DeepbookSwapEvent");if(C.length===0)return null;const B=C[0].parsedJson;return{poolAddress:B.pool,estimatedAmountIn:B.amount_in,estimatedAmountOut:B.amount_out,aToB:B.atob}}},Ic=class{constructor(t){$(this,"_sdk");$(this,"_cache",{});this._sdk=t}get sdk(){return this._sdk}async getPositionList(t,e="all"){const n={data:[],hasNextPage:!0},o=await this._sdk.fullClient.getDynamicFieldsByPage(t,e);n.hasNextPage=o.hasNextPage,n.nextCursor=o.nextCursor;const s=o.data.map(r=>r.name.value),i=await this._sdk.Position.getSipmlePositionList(s);return n.data=i,n}async getPoolImmutables(t=[],e=0,n=100,o=!1){const{package_id:s}=this._sdk.sdkOptions.clmm_pool,i=`${s}_getInitPoolEvent`,r=this.getCache(i,o),a=[],u=[];if(r!==void 0&&a.push(...r),a.length===0)try{(await this._sdk.fullClient.queryEventsByPage({MoveEventType:`${s}::factory::CreatePoolEvent`})).data.forEach(h=>{const f=h.parsedJson;f&&a.push({poolAddress:f.pool_id,tickSpacing:f.tick_spacing,coinTypeA:N(f.coin_type_a).full_address,coinTypeB:N(f.coin_type_b).full_address})}),this.updateCache(i,a,tt)}catch(d){console.log("getPoolImmutables",d)}const l=t.length>0;for(let d=0;d<a.length;d+=1){const h=a[d];l&&!t.includes(h.poolAddress)||!l&&(d<e||d>=e+n)||u.push(h)}return u}async getPools(t=[],e=0,n=100){const o=[];let s=[];t.length>0?s=[...t]:(await this.getPoolImmutables([],e,n,!1)).forEach(a=>s.push(a.poolAddress));const i=await this._sdk.fullClient.batchGetObjects(s,{showContent:!0,showType:!0});for(const r of i){const a=hn(r);o.push(a);const u=`${a.poolAddress}_getPoolObject`;this.updateCache(u,a,tt)}return o}async getPoolImmutablesWithPage(t="all",e=!1){const{package_id:n}=this._sdk.sdkOptions.clmm_pool,o=[],s={data:[],hasNextPage:!1},i=t==="all",r=`${n}_getPoolImmutables`;if(i){const a=this.getCache(r,e);a&&o.push(...a)}if(o.length===0)try{const a=`${n}::factory::CreatePoolEvent`,u=await this._sdk.fullClient.queryEventsByPage({MoveEventType:a},t);s.hasNextPage=u.hasNextPage,s.nextCursor=u.nextCursor,u.data.forEach(l=>{const d=l.parsedJson;if(d){const h={poolAddress:d.pool_id,tickSpacing:d.tick_spacing,coinTypeA:N(d.coin_type_a).full_address,coinTypeB:N(d.coin_type_b).full_address};o.push(h)}})}catch(a){console.log("getPoolImmutables",a)}return s.data=o,i&&this.updateCache(`${n}_getPoolImmutables`,o,tt),s}async getPoolsWithPage(t=[]){const e=[];let n=[];t.length>0?n=[...t]:(await this.getPoolImmutablesWithPage()).data.forEach(i=>n.push(i.poolAddress));const o=await this._sdk.fullClient.batchGetObjects(n,{showContent:!0,showType:!0});for(const s of o){const i=hn(s);e.push(i);const r=`${i.poolAddress}_getPoolObject`;this.updateCache(r,i,tt)}return e}async getPool(t,e=!0){const n=`${t}_getPoolObject`,o=this.getCache(n,e);if(o!==void 0)return o;const s=await this._sdk.fullClient.getObject({id:t,options:{showType:!0,showContent:!0}}),i=hn(s);return this.updateCache(n,i),i}async creatPoolsTransactionPayload(t){for(const n of t)if(Bo(at(n.coinTypeA),at(n.coinTypeB))){const o=n.coinTypeB;n.coinTypeB=n.coinTypeA,n.coinTypeA=o}return await this.creatPool(t)}async creatPoolTransactionPayload(t){if(Bo(at(t.coinTypeA),at(t.coinTypeB))){const e=t.coinTypeB;t.coinTypeB=t.coinTypeA,t.coinTypeA=e}return"fix_amount_a"in t?await this.creatPoolAndAddLiquidity(t):await this.creatPool([t])}async getClmmConfigs(t=!1){const{package_id:e}=this._sdk.sdkOptions.clmm_pool,n=`${e}_getInitEvent`,o=this.getCache(n,t);if(o!==void 0)return o;const s=await this._sdk.fullClient.getObject({id:e,options:{showPreviousTransaction:!0}}),i=Qn(s),r=(await this._sdk.fullClient.queryEventsByPage({Transaction:i})).data,a={pools_id:"",global_config_id:"",global_vault_id:"",admin_cap_id:""};return r.length>0&&(r.forEach(u=>{const l=u.parsedJson;if(u.type)switch(N(u.type).full_address){case`${e}::config::InitConfigEvent`:a.global_config_id=l.global_config_id,a.admin_cap_id=l.admin_cap_id;break;case`${e}::factory::InitFactoryEvent`:a.pools_id=l.pools_id;break;case`${e}::rewarder::RewarderInitEvent`:a.global_vault_id=l.global_vault_id;break;case`${e}::partner::InitPartnerEvent`:a.partners_id=l.partners_id;break}}),this.updateCache(n,a,tt)),a}async getSuiTransactionResponse(t,e=!1){const n=`${t}_getSuiTransactionResponse`,o=this.getCache(n,e);if(o!==void 0)return o;let s;try{s=await this._sdk.fullClient.getTransactionBlock({digest:t,options:{showEvents:!0,showEffects:!0,showBalanceChanges:!0,showInput:!0,showObjectChanges:!0}})}catch{s=await this._sdk.fullClient.getTransactionBlock({digest:t,options:{showEvents:!0,showEffects:!0}})}return this.updateCache(n,s,tt),s}async creatPool(t){const e=new H,{integrate:n,clmm_pool:o}=this.sdk.sdkOptions,s=Z(o),i=s.global_config_id,r=s.pools_id;return t.forEach(a=>{const u=[e.object(i),e.object(r),e.pure(a.tick_spacing.toString()),e.pure(a.initialize_sqrt_price),e.pure(a.uri),e.object(et)];e.moveCall({target:`${n.published_at}::${He}::create_pool`,typeArguments:[a.coinTypeA,a.coinTypeB],arguments:u})}),e}async creatPoolAndAddLiquidity(t){if(this._sdk.senderAddress.length===0)throw Error("this config sdk senderAddress is empty");const e=new H,{integrate:n,clmm_pool:o}=this.sdk.sdkOptions,s=Z(o),i=s.global_config_id,r=s.pools_id,a=await this._sdk.getOwnerCoinAssets(this._sdk.senderAddress),u=pt.buildAddLiquidityFixTokenCoinInput(e,!t.fix_amount_a,t.amount_a,t.slippage,t.coinTypeA,a,!1),l=pt.buildAddLiquidityFixTokenCoinInput(e,t.fix_amount_a,t.amount_b,t.slippage,t.coinTypeB,a,!1),d=[e.pure(i),e.pure(r),e.pure(t.tick_spacing.toString()),e.pure(t.initialize_sqrt_price),e.pure(t.uri),u.transactionArgument,l.transactionArgument,e.pure($t(BigInt(t.tick_lower)).toString()),e.pure($t(BigInt(t.tick_upper)).toString()),e.pure(t.amount_a),e.pure(t.amount_b),e.pure(t.fix_amount_a),e.pure(et)];return e.moveCall({target:`${n.published_at}::${ne}::create_pool_with_liquidity`,typeArguments:[t.coinTypeA,t.coinTypeB],arguments:d}),e}async fetchTicks(t){let e=[],n=[];for(;;){const s=await this.getTicks({pool_id:t.pool_id,coinTypeA:t.coinTypeA,coinTypeB:t.coinTypeB,start:n,limit:512});if(e=[...e,...s],s.length<512)break;n=[s[s.length-1].index]}return e}async getTicks(t){var u;const{integrate:e,simulationAccount:n}=this.sdk.sdkOptions,o=[],s=[t.coinTypeA,t.coinTypeB],i=new H,r=[i.pure(t.pool_id),i.pure(t.start),i.pure(t.limit.toString())];return i.moveCall({target:`${e.published_at}::${ie}::fetch_ticks`,arguments:r,typeArguments:s}),(u=(await this.sdk.fullClient.devInspectTransactionBlock({transactionBlock:i,sender:n.address})).events)==null||u.forEach(l=>{N(l.type).name==="FetchTicksResultEvent"&&l.parsedJson.ticks.forEach(d=>{o.push(Tc(d))})}),o}async fetchPositionRewardList(t){var r;const{integrate:e,simulationAccount:n}=this.sdk.sdkOptions,o=[];let s=[];const i=512;for(;;){const a=[t.coinTypeA,t.coinTypeB],u=new H,l=[u.pure(t.pool_id),u.pure(s),u.pure(i.toString())];u.moveCall({target:`${e.published_at}::${ie}::fetch_positions`,arguments:l,typeArguments:a});const d=await this.sdk.fullClient.devInspectTransactionBlock({transactionBlock:u,sender:n.address}),h=[];if((r=d.events)==null||r.forEach(f=>{N(f.type).name==="FetchPositionsEvent"&&f.parsedJson.positions.forEach(_=>{const v=Ns(_);h.push(v)})}),o.push(...h),h.length<i)break;s=[h[h.length-1].pos_object_id]}return o}async fetchTicksByRpc(t){let e=[],n=null;const o=512;for(;;){const s=[],i=await this.sdk.fullClient.getDynamicFields({parentId:t,cursor:n,limit:o});if(n=i.nextCursor,i.data.forEach(r=>{N(r.objectType).module==="skip_list"&&s.push(r.objectId)}),e=[...e,...await this.getTicksByRpc(s)],n===null||i.data.length<o)break}return e}async getTicksByRpc(t){const e=[],n=await this.sdk.fullClient.batchGetObjects(t,{showContent:!0,showType:!0});for(const o of n)e.push(gn(o));return e}async getTickDataByIndex(t,e){const n={type:"u64",value:$t(BigInt(ec(e).toString())).toString()},o=await this.sdk.fullClient.getDynamicFieldObject({parentId:t,name:n});return gn(o)}async getTickDataByObjectId(t){const e=await this.sdk.fullClient.getObject({id:t,options:{showContent:!0}});return gn(e)}async getPartnerRefFeeAmount(t){const e=await this._sdk.fullClient.batchGetObjects([t],{showOwner:!0,showContent:!0,showDisplay:!0,showType:!0});let n;e.forEach(a=>{n=a.data.content.fields.balances});const o=await this._sdk.fullClient.getDynamicFieldsByPage(n.fields.id.id),s=[];o.data.forEach(a=>{s.push(a.objectId)});const i=[];return(await this._sdk.fullClient.batchGetObjects(s,{showOwner:!0,showContent:!0,showDisplay:!0,showType:!0})).forEach(a=>{const u={coinAddress:a.data.content.fields.name,coinObjectId:a.data.objectId,balance:BigInt(a.data.content.fields.value)};i.push(u)}),i}updateCache(t,e,n=sn){let o=this._cache[t];o?(o.overdueTime=Dt(n),o.value=e):o=new Oe(e,Dt(n)),this._cache[t]=o}getCache(t,e=!1){const n=this._cache[t],o=n==null?void 0:n.isValid();if(!e&&o)return n.value;o||delete this._cache[t]}},Pc=class{constructor(t){$(this,"_sdk");$(this,"_cache",{});this._sdk=t}get sdk(){return this._sdk}buildPositionType(){return`${this._sdk.sdkOptions.clmm_pool.package_id}::position::Position`}async getPositionList(t,e=[]){const n=[],o=await this._sdk.fullClient.getOwnedObjectsByPage(t,{options:{showType:!0,showContent:!0,showDisplay:!0,showOwner:!0},filter:{Package:this._sdk.sdkOptions.clmm_pool.package_id}}),s=e.length>0;for(const i of o.data)if(N(i.data.type).full_address===this.buildPositionType()){const a=fn(i),u=`${a.pos_object_id}_getPositionList`;this.updateCache(u,a,tt),s?e.includes(a.pool)&&n.push(a):n.push(a)}return n}async getPosition(t,e,n=!0){let o=await this.getSimplePosition(e);return n&&(o=await this.updatePositionRewarders(t,o)),o}async getPositionById(t,e=!0){const n=await this.getSimplePosition(t);if(e){const o=await this._sdk.Pool.getPool(n.pool,!1);return await this.updatePositionRewarders(o.position_manager.positions_handle,n)}return n}async getSimplePosition(t){const e=`${t}_getPositionList`;let n=this.getSimplePositionByCache(t);if(n===void 0){const o=await this.sdk.fullClient.getObject({id:t,options:{showContent:!0,showType:!0,showDisplay:!0,showOwner:!0}});n=fn(o),this.updateCache(e,n,tt)}return n}getSimplePositionByCache(t){const e=`${t}_getPositionList`;return this.getCache(e)}async getSipmlePositionList(t){const e=[],n=[];return t.forEach(o=>{const s=this.getSimplePositionByCache(o);s?e.push(s):n.push(o)}),n.length>0&&(await this._sdk.fullClient.batchGetObjects(n,{showOwner:!0,showContent:!0,showDisplay:!0,showType:!0})).forEach(s=>{const i=fn(s);e.push(i);const r=`${i.pos_object_id}_getPositionList`;this.updateCache(r,i,tt)}),e}async updatePositionRewarders(t,e){const n=await this.getPositionRewarders(t,e.pos_object_id);return{...e,...n}}async getPositionRewarders(t,e){try{const n=await this._sdk.fullClient.getDynamicFieldObject({parentId:t,name:{type:"0x2::object::ID",value:e}}),s=Qt(n.data).value.fields.value;return Ns(s)}catch(n){console.log(n);return}}async fetchPosFeeAmount(t){var u;const{clmm_pool:e,integrate:n,simulationAccount:o}=this.sdk.sdkOptions,s=new H;for(const l of t){const d=[l.coinTypeA,l.coinTypeB],h=[s.object(Z(e).global_config_id),s.object(l.poolAddress),s.pure(l.positionId)];s.moveCall({target:`${n.published_at}::${ie}::fetch_position_fees`,arguments:h,typeArguments:d})}const r=(u=(await this.sdk.fullClient.devInspectTransactionBlock({transactionBlock:s,sender:o.address})).events)==null?void 0:u.filter(l=>N(l.type).name==="FetchPositionFeesEvent");if(r.length===0)return[];const a=[];for(let l=0;l<r.length;l+=1){const{parsedJson:d}=r[l],h={feeOwedA:new p(d.fee_owned_a),feeOwedB:new p(d.fee_owned_b),position_id:d.position_id};a.push(h)}return a}async batchFetchPositionFees(t){const e=[];for(const o of t){const s=await this._sdk.Position.getPositionById(o,!1),i=await this._sdk.Pool.getPool(s.pool,!1);e.push({poolAddress:i.poolAddress,positionId:s.pos_object_id,coinTypeA:i.coinTypeA,coinTypeB:i.coinTypeB})}const n={};if(e.length>0){const o=await this.fetchPosFeeAmount(e);for(const s of o)n[s.position_id]=s;return n}return n}async createAddLiquidityFixTokenPayload(t,e){if(this._sdk.senderAddress.length===0)throw Error("this config sdk senderAddress is empty");const n=await this._sdk.getOwnerCoinAssets(this._sdk.senderAddress);if(e){const{isAdjustCoinA:o,isAdjustCoinB:s}=Yn(t);if(t=t,t.fix_amount_a&&o||!t.fix_amount_a&&s)return await pt.buildAddLiquidityFixTokenForGas(this._sdk,n,t,e)}return pt.buildAddLiquidityFixToken(this._sdk,n,t)}async createAddLiquidityPayload(t){const{integrate:e,clmm_pool:n}=this._sdk.sdkOptions;if(this._sdk.senderAddress.length===0)throw Error("this config sdk senderAddress is empty");const o=$t(BigInt(t.tick_lower)).toString(),s=$t(BigInt(t.tick_upper)).toString(),i=[t.coinTypeA,t.coinTypeB];let r=new H;const a=!Ae(t.pos_id),u=BigInt(t.max_amount_a),l=BigInt(t.max_amount_b),d=await this._sdk.getOwnerCoinAssets(this._sdk.senderAddress),h=pt.buildCoinInputForAmount(r,d,u,t.coinTypeA,!1),f=pt.buildCoinInputForAmount(r,d,l,t.coinTypeB,!1);return a?r.moveCall({target:`${e.published_at}::${ne}::open_position_with_liquidity`,typeArguments:i,arguments:[r.object(Z(n).global_config_id),r.object(t.pool_id),r.pure(o),r.pure(s),h.transactionArgument,f.transactionArgument,r.pure(t.max_amount_a),r.pure(t.max_amount_b),r.pure(t.delta_liquidity),r.object(et)]}):(r=pt.createCollectRewarderAndFeeParams(this._sdk,r,t,d,h.remainCoins,f.remainCoins),r.moveCall({target:`${e.published_at}::${ne}::add_liquidity`,typeArguments:i,arguments:[r.object(Z(n).global_config_id),r.object(t.pool_id),r.object(t.pos_id),h.transactionArgument,f.transactionArgument,r.pure(t.max_amount_a),r.pure(t.max_amount_b),r.pure(t.delta_liquidity),r.object(et)]})),r}async removeLiquidityTransactionPayload(t){const{clmm_pool:e,integrate:n}=this.sdk.sdkOptions,o="remove_liquidity";let s=new H;const i=[t.coinTypeA,t.coinTypeB],r=await this._sdk.getOwnerCoinAssets(this._sdk.senderAddress);s=pt.createCollectRewarderAndFeeParams(this._sdk,s,t,r);const a=[s.object(Z(e).global_config_id),s.object(t.pool_id),s.object(t.pos_id),s.pure(t.delta_liquidity),s.pure(t.min_amount_a),s.pure(t.min_amount_b),s.object(et)];return s.moveCall({target:`${n.published_at}::${He}::${o}`,typeArguments:i,arguments:a}),s}async closePositionTransactionPayload(t){const{clmm_pool:e,integrate:n}=this.sdk.sdkOptions;let o=new H;const s=[t.coinTypeA,t.coinTypeB],i=await this._sdk.getOwnerCoinAssets(this._sdk.senderAddress);return o=pt.createCollectRewarderAndFeeParams(this._sdk,o,t,i),o.moveCall({target:`${n.published_at}::${He}::close_position`,typeArguments:s,arguments:[o.object(Z(e).global_config_id),o.object(t.pool_id),o.object(t.pos_id),o.pure(t.min_amount_a),o.pure(t.min_amount_b),o.object(et)]}),o}openPositionTransactionPayload(t){const{clmm_pool:e,integrate:n}=this.sdk.sdkOptions,o=new H,s=[t.coinTypeA,t.coinTypeB],i=$t(BigInt(t.tick_lower)).toString(),r=$t(BigInt(t.tick_upper)).toString(),a=[o.pure(Z(e).global_config_id),o.pure(t.pool_id),o.pure(i),o.pure(r)];return o.moveCall({target:`${n.published_at}::${He}::open_position`,typeArguments:s,arguments:a}),o}async collectFeeTransactionPayload(t){const e=await this._sdk.getOwnerCoinAssets(this._sdk.senderAddress,null,!0),n=new H,o=pt.buildCoinInputForAmount(n,e,BigInt(0),t.coinTypeA,!1),s=pt.buildCoinInputForAmount(n,e,BigInt(0),t.coinTypeB,!1);return this.createCollectFeePaylod(t,n,o.transactionArgument,s.transactionArgument),n}createCollectFeePaylod(t,e,n,o){const{clmm_pool:s,integrate:i}=this.sdk.sdkOptions,r=[t.coinTypeA,t.coinTypeB],a=[e.object(Z(s).global_config_id),e.object(t.pool_id),e.object(t.pos_id),n,o];return e.moveCall({target:`${i.published_at}::${ne}::collect_fee`,typeArguments:r,arguments:a}),e}async calculateFee(t){const e=await this.collectFeeTransactionPayload(t),n=await this._sdk.fullClient.devInspectTransactionBlock({transactionBlock:e,sender:this._sdk.senderAddress});for(const o of n.events)if(N(o.type).name==="CollectFeeEvent"){const s=o.parsedJson;return{feeOwedA:s.amount_a,feeOwedB:s.amount_b}}return{feeOwedA:"0",feeOwedB:"0"}}updateCache(t,e,n=sn){let o=this._cache[t];o?(o.overdueTime=Dt(n),o.value=e):o=new Oe(e,Dt(n)),this._cache[t]=o}getCache(t,e=!1){const n=this._cache[t],o=n==null?void 0:n.isValid();if(!e&&o)return n.value;o||delete this._cache[t]}},Bc=class{constructor(t){$(this,"_sdk");$(this,"growthGlobal");this._sdk=t,this.growthGlobal=[P,P,P]}get sdk(){return this._sdk}async emissionsEveryDay(t){const n=(await this.sdk.Pool.getPool(t)).rewarder_infos;if(!n)return null;const o=[];for(const s of n){const i=W.fromX64(new p(s.emissions_per_second));o.push({emissions:Math.floor(i.toNumber()*60*60*24),coin_address:s.coinAddress})}return o}async updatePoolRewarder(t,e){const n=await this.sdk.Pool.getPool(t),o=n.rewarder_last_updated_time;if(n.rewarder_last_updated_time=e.toString(),Number(n.liquidity)===0||e.eq(new p(o)))return n;const s=e.div(new p(1e3)).sub(new p(o)).add(new p(15)),i=n.rewarder_infos;for(let r=0;r<i.length;r+=1){const a=i[r],u=W.checkMulDivFloor(s,new p(a.emissions_per_second),new p(n.liquidity),128);this.growthGlobal[r]=new p(a.growth_global).add(new p(u))}return n}async posRewardersAmount(t,e,n){const o=Date.parse(new Date().toString()),s=await this.updatePoolRewarder(t,new p(o)),i=await this.sdk.Position.getPositionRewarders(e,n);if(i===void 0)return[];const r=s.ticks_handle,a=await this.sdk.Pool.getTickDataByIndex(r,i.tick_lower_index),u=await this.sdk.Pool.getTickDataByIndex(r,i.tick_upper_index);return this.posRewardersAmountInternal(s,i,a,u)}async poolRewardersAmount(t,e){const n=Date.parse(new Date().toString()),o=await this.updatePoolRewarder(e,new p(n)),s=await this.sdk.Position.getPositionList(t,[e]),i=await this.getPoolLowerAndUpperTicks(o.ticks_handle,s),r=[P,P,P];for(let a=0;a<s.length;a+=1){const u=await this.posRewardersAmountInternal(o,s[a],i[0][a],i[1][a]);for(let l=0;l<3;l+=1)r[l]=r[l].add(u[l].amount_owed)}return r}posRewardersAmountInternal(t,e,n,o){const s=e.tick_lower_index,i=e.tick_upper_index,r=kc(t,n,o,s,i,this.growthGlobal),a=[],u=[];if(r.length>0){let l=W.subUnderflowU128(r[0],new p(e.reward_growth_inside_0));l.gt(new p("3402823669209384634633745948738404"))&&(l=jt);const d=W.checkMulShiftRight(new p(e.liquidity),l,64,128);a.push(r[0]),u.push({amount_owed:new p(e.reward_amount_owed_0).add(d),coin_address:t.rewarder_infos[0].coinAddress})}if(r.length>1){let l=W.subUnderflowU128(r[1],new p(e.reward_growth_inside_1));l.gt(new p("3402823669209384634633745948738404"))&&(l=jt);const d=W.checkMulShiftRight(new p(e.liquidity),l,64,128);a.push(r[1]),u.push({amount_owed:new p(e.reward_amount_owed_1).add(d),coin_address:t.rewarder_infos[1].coinAddress})}if(r.length>2){let l=W.subUnderflowU128(r[2],new p(e.reward_growth_inside_2));l.gt(new p("3402823669209384634633745948738404"))&&(l=jt);const d=W.checkMulShiftRight(new p(e.liquidity),l,64,128);a.push(r[2]),u.push({amount_owed:new p(e.reward_amount_owed_2).add(d),coin_address:t.rewarder_infos[2].coinAddress})}return u}async batchFetchPositionRewarders(t){const e=[];for(const o of t){const s=await this._sdk.Position.getPositionById(o,!1),i=await this._sdk.Pool.getPool(s.pool,!1);e.push({poolAddress:i.poolAddress,positionId:s.pos_object_id,coinTypeA:i.coinTypeA,coinTypeB:i.coinTypeB,rewarderInfo:i.rewarder_infos})}const n={};if(e.length>0){const o=await this.fetchPosRewardersAmount(e);for(const s of o)n[s.positionId]=s.rewarderAmountOwed;return n}return n}async batchFetchPositionFees(t){const e=[];for(const o of t){const s=await this._sdk.Position.getPositionById(o,!1),i=await this._sdk.Pool.getPool(s.pool,!1);e.push({poolAddress:i.poolAddress,positionId:s.pos_object_id,coinTypeA:i.coinTypeA,coinTypeB:i.coinTypeB})}const n={};if(e.length>0){const o=await this.fetchPosFeeAmount(e);for(const s of o)n[s.position_id]=s;return n}return n}async fetchPosFeeAmount(t){var u;const{clmm_pool:e,integrate:n,simulationAccount:o}=this.sdk.sdkOptions,s=new H;for(const l of t){const d=[l.coinTypeA,l.coinTypeB],h=[s.object(Z(e).global_config_id),s.object(l.poolAddress),s.pure(l.positionId)];s.moveCall({target:`${n.published_at}::${ie}::fetch_position_fees`,arguments:h,typeArguments:d})}const r=(u=(await this.sdk.fullClient.devInspectTransactionBlock({transactionBlock:s,sender:o.address})).events)==null?void 0:u.filter(l=>N(l.type).name==="FetchPositionFeesEvent");if(r.length===0)return[];const a=[];for(let l=0;l<r.length;l+=1){const{parsedJson:d}=r[l],h={feeOwedA:new p(d.fee_owned_a),feeOwedB:new p(d.fee_owned_b),position_id:d.position_id};a.push(h)}return a}async fetchPosRewardersAmount(t){var u;const{clmm_pool:e,integrate:n,simulationAccount:o}=this.sdk.sdkOptions,s=new H;for(const l of t){const d=[l.coinTypeA,l.coinTypeB],h=[s.object(Z(e).global_config_id),s.object(l.poolAddress),s.pure(l.positionId),s.object(et)];s.moveCall({target:`${n.published_at}::${ie}::fetch_position_rewards`,arguments:h,typeArguments:d})}const r=(u=(await this.sdk.fullClient.devInspectTransactionBlock({transactionBlock:s,sender:o.address})).events)==null?void 0:u.filter(l=>N(l.type).name==="FetchPositionRewardsEvent");if(r.length===0)return[];if(r.length!==t.length)throw new Error("valueData.length !== params.pools.length");const a=[];for(let l=0;l<r.length;l+=1){console.log("params ",t[l]);const d={poolAddress:t[l].poolAddress,positionId:t[l].positionId,rewarderAmountOwed:[]};for(let h=0;h<t[l].rewarderInfo.length;h+=1)d.rewarderAmountOwed.push({amount_owed:new p(r[l].parsedJson.data[h]),coin_address:t[l].rewarderInfo[h].coinAddress});a.push(d)}return a}async fetchPoolRewardersAmount(t,e){const n=await this.sdk.Pool.getPool(e),o=await this.sdk.Position.getPositionList(t,[e]),s=[];for(const a of o)s.push({poolAddress:n.poolAddress,positionId:a.pos_object_id,rewarderInfo:n.rewarder_infos,coinTypeA:n.coinTypeA,coinTypeB:n.coinTypeB});const i=await this.fetchPosRewardersAmount(s),r=[P,P,P];if(i!=null)for(const a of i)for(let u=0;u<a.rewarderAmountOwed.length;u+=1)r[u]=r[u].add(a.rewarderAmountOwed[u].amount_owed);return r}async getPoolLowerAndUpperTicks(t,e){const n=[],o=[];for(const s of e){const i=await this.sdk.Pool.getTickDataByIndex(t,s.tick_lower_index),r=await this.sdk.Pool.getTickDataByIndex(t,s.tick_upper_index);n.push(i),o.push(r)}return[n,o]}async collectRewarderTransactionPayload(t){const e=await this._sdk.getOwnerCoinAssets(this._sdk.senderAddress,null);let n=new H;return n=pt.createCollectRewarderAndFeeParams(this._sdk,n,t,e),n}createCollectRewarderPaylod(t,e,n){const{clmm_pool:o,integrate:s}=this.sdk.sdkOptions,i=Z(o),r=[t.coinTypeA,t.coinTypeB];return t.rewarder_coin_types.forEach((a,u)=>{e&&e.moveCall({target:`${s.published_at}::${ne}::collect_reward`,typeArguments:[...r,a],arguments:[e.object(i.global_config_id),e.object(t.pool_id),e.object(t.pos_id),e.object(i.global_vault_id),n[u],e.object(et)]})}),e}};function Ge(t,e){return{pair:`${t}-${e}`,reversePair:`${e}-${t}`}}var Oc=class{constructor(t){$(this,"graph");$(this,"pathProviders");$(this,"coinProviders");$(this,"_coinAddressMap");$(this,"poolAddressMap");$(this,"_sdk");this.pathProviders=[],this.coinProviders={coins:[]},this.graph=new Ys(!1),this._coinAddressMap=new Map,this.poolAddressMap=new Map,this._sdk=t,this.getPoolAddressMapAndDirection=this.getPoolAddressMapAndDirection.bind(this),this.setCoinList=this.setCoinList.bind(this),this.loadGraph=this.loadGraph.bind(this),this.addCoinProvider=this.addCoinProvider.bind(this),this.addPathProvider=this.addPathProvider.bind(this),this.preRouterSwapA2B2C=this.preRouterSwapA2B2C.bind(this),this.price=this.price.bind(this),this.getPoolWithTVL=this.getPoolWithTVL.bind(this)}get sdk(){return this._sdk}getPoolAddressMapAndDirection(t,e){const{pair:n,reversePair:o}=Ge(t,e);let s=this.poolAddressMap.get(n);if(s!=null)return{addressMap:s,direction:!0};if(s=this.poolAddressMap.get(o),s!=null)return{addressMap:s,direction:!1}}setCoinList(){this.coinProviders.coins.forEach(t=>{this._coinAddressMap.set(t.address,t)})}loadGraph(t,e){this.addCoinProvider(t),this.addPathProvider(e),this.setCoinList(),this.pathProviders.forEach(n=>{const{paths:o}=n;o.forEach(s=>{const i=this.graph.getVertexByKey(s.base)??new so(s.base),r=this.graph.getVertexByKey(s.quote)??new so(s.quote);this.graph.addEdge(new ti(i,r));const a=this._coinAddressMap.get(s.base),u=this._coinAddressMap.get(s.quote);if(a!=null&&u!=null){const l=Ge(s.base,s.quote).pair;this.poolAddressMap.set(l,s.addressMap)}})})}addPathProvider(t){for(let e=0;e<t.paths.length;e+=1){const{base:n,quote:o}=t.paths[e];n.localeCompare(o)<0&&(t.paths[e].base=o,t.paths[e].quote=n),n==="0x2::sui::SUI"&&(t.paths[e].base=o,t.paths[e].quote=n),o==="0x2::sui::SUI"&&(t.paths[e].base=n,t.paths[e].quote=o)}return this.pathProviders.push(t),this}addCoinProvider(t){return this.coinProviders=t,this}tokenInfo(t){return this._coinAddressMap.get(t)}getFeeRate(t,e,n){const o=Ge(t,e).pair,s=this.poolAddressMap.get(o);if(s!=null){for(const[a,u]of s.entries())if(u===n)return a*100}const i=Ge(t,e).reversePair,r=this.poolAddressMap.get(i);if(r!=null){for(const[a,u]of r.entries())if(console.log({key:a,value:u}),u===n)return a*100}return 0}async price(t,e,n,o,s,i,r){const a=this.tokenInfo(t),u=this.tokenInfo(e);if(a===void 0||u===void 0)throw new Error("From/To coin is undefined");const l=this.graph.getVertexByKey(a.address),d=this.graph.getVertexByKey(u.address),h=this.graph.findAllPath(l,d),f=Array.from(h);if(f.length===0)throw new Error("No find valid path in coin graph");let _=[];for(let x=0;x<f.length;x+=1){const L=f[x];if(L.length>3)continue;const nt=[],mt=[],Gt=[],vt=[];for(let At=0;At<L.length-1;At+=1){const ce=L[At].value.toString(),Re=L[At+1].value.toString(),ue=this.getPoolAddressMapAndDirection(ce,Re),eo=ue==null?void 0:ue.addressMap,no=ue==null?void 0:ue.direction;eo!=null&&no!=null&&(mt.push(no),nt.push(ce),nt.push(Re),eo.forEach(oo=>{At===0?Gt.push(oo):vt.push(oo)}))}for(const At of Gt)if(vt.length>0)for(const ce of vt){const Re={stepNums:2,poolAB:At,poolBC:ce,a2b:mt[0],b2c:mt[1],amount:n,byAmountIn:o,coinTypeA:nt[0],coinTypeB:nt[1],coinTypeC:nt[3]};_.push(Re)}else{const ce={stepNums:1,poolAB:At,poolBC:void 0,a2b:mt[0],b2c:void 0,amount:n,byAmountIn:o,coinTypeA:nt[0],coinTypeB:nt[1],coinTypeC:void 0};_.push(ce)}}const v=_.filter(x=>x.stepNums===1);let I=_.filter(x=>x.stepNums!==1),m=[];try{m=await this.getPoolWithTVL()}catch{m=[]}if(m.length>0){const x=new Map(m.map(L=>[L.poolAddress,L]));I.sort((L,nt)=>{let mt=0,Gt=0;if(x.has(L.poolAB)&&x.has(L.poolBC)){const vt=x.get(L.poolAB),At=x.get(L.poolBC);mt=Math.min(vt.tvl,At.tvl)}if(x.has(nt.poolAB)&&x.has(nt.poolBC)){const vt=x.get(nt.poolAB),At=x.get(nt.poolBC);Gt=Math.min(vt.tvl,At.tvl)}return Gt-mt})}if(_=[...v,...I],_.length===0){if(r!=null){const x=await this.sdk.Swap.preSwapWithMultiPool(r),L={amountIn:new p(x.estimatedAmountIn),amountOut:new p(x.estimatedAmountOut),poolAddress:[x.poolAddress],a2b:[x.aToB],rawAmountLimit:o?[x.estimatedAmountOut]:[x.estimatedAmountIn],isExceed:x.isExceed,coinType:[t,e]},nt={paths:[L],partner:i,priceSplitPoint:s};return{amountIn:new p(x.estimatedAmountIn),amountOut:new p(x.estimatedAmountOut),paths:[L],a2b:x.aToB,b2c:void 0,byAmountIn:o,isExceed:x.isExceed,targetSqrtPrice:[x.estimatedEndSqrtPrice],currentSqrtPrice:[x.estimatedStartSqrtPrice],coinTypeA:t,coinTypeB:e,coinTypeC:void 0,createTxParams:nt}}throw new Error("No parameters available for service downgrade")}const y=await this.preRouterSwapA2B2C(_.slice(0,16));if(y==null){if(r!=null){const L=await this.sdk.Swap.preSwapWithMultiPool(r),nt={amountIn:new p(L.estimatedAmountIn),amountOut:new p(L.estimatedAmountOut),poolAddress:[L.poolAddress],a2b:[L.aToB],rawAmountLimit:o?[L.estimatedAmountOut]:[L.estimatedAmountIn],isExceed:L.isExceed,coinType:[t,e]},mt={paths:[nt],partner:i,priceSplitPoint:s};return{amountIn:new p(L.estimatedAmountIn),amountOut:new p(L.estimatedAmountOut),paths:[nt],a2b:L.aToB,b2c:void 0,byAmountIn:o,isExceed:L.isExceed,targetSqrtPrice:[L.estimatedEndSqrtPrice],currentSqrtPrice:[L.estimatedStartSqrtPrice],coinTypeA:t,coinTypeB:e,coinTypeC:void 0,createTxParams:mt}}return{amountIn:P,amountOut:P,paths:[],a2b:!1,b2c:!1,byAmountIn:o,isExceed:!0,targetSqrtPrice:[],currentSqrtPrice:[],coinTypeA:"",coinTypeB:"",coinTypeC:void 0,createTxParams:void 0}}const S=y.index,C=_[S].poolBC!=null?[_[S].poolAB,_[S].poolBC]:[_[S].poolAB],B=o?[y.amountMedium,y.amountOut]:[y.amountIn,y.amountMedium],k=[];k.push(_[S].a2b),y.stepNum>1&&k.push(_[S].b2c);const q=[];q.push(_[S].coinTypeA),q.push(_[S].coinTypeB),y.stepNum>1&&q.push(_[S].coinTypeC);const M={amountIn:y.amountIn,amountOut:y.amountOut,poolAddress:C,a2b:k,rawAmountLimit:B,isExceed:y.isExceed,coinType:q},Y={paths:[M],partner:i,priceSplitPoint:s};return{amountIn:y.amountIn,amountOut:y.amountOut,paths:[M],a2b:_[S].a2b,b2c:y.stepNum>1?_[S].b2c:void 0,byAmountIn:o,isExceed:y.isExceed,targetSqrtPrice:y.targetSqrtPrice,currentSqrtPrice:y.currentSqrtPrice,coinTypeA:_[S].coinTypeA,coinTypeB:_[S].coinTypeB,coinTypeC:y.stepNum>1?_[S].coinTypeC:void 0,createTxParams:Y}}async preRouterSwapA2B2C(t){var h;if(t.length===0)return null;const{integrate:e,simulationAccount:n}=this.sdk.sdkOptions,o=new H;for(const f of t)if(f.stepNums>1){const _=[o.object(f.poolAB),o.object(f.poolBC),o.pure(f.a2b),o.pure(f.b2c),o.pure(f.byAmountIn),o.pure(f.amount.toString())],v=[];f.a2b?v.push(f.coinTypeA,f.coinTypeB):v.push(f.coinTypeB,f.coinTypeA),f.b2c?v.push(f.coinTypeB,f.coinTypeC):v.push(f.coinTypeC,f.coinTypeB),o.moveCall({target:`${e.published_at}::${Ce}::calculate_router_swap_result`,typeArguments:v,arguments:_})}else{const _=[o.pure(f.poolAB),o.pure(f.a2b),o.pure(f.byAmountIn),o.pure(f.amount.toString())],v=f.a2b?[f.coinTypeA,f.coinTypeB]:[f.coinTypeB,f.coinTypeA];o.moveCall({target:`${e.published_at}::${Va}::get_expect_swap_result`,arguments:_,typeArguments:v})}const i=(h=(await this.sdk.fullClient.devInspectTransactionBlock({transactionBlock:o,sender:n.address})).events)==null?void 0:h.filter(f=>N(f.type).name==="CalculatedRouterSwapResultEvent"||N(f.type).name==="ExpectSwapResultEvent");if(i.length===0)return null;let r=t[0].byAmountIn?P:we,a=0;for(let f=0;f<i.length;f+=1)if(!i[f].parsedJson.data.is_exceed)if(t[0].byAmountIn){const _=new p(i[f].parsedJson.data.amount_out);_.gt(r)&&(a=f,r=_)}else{const _=t[f].stepNums>1?new p(i[f].parsedJson.data.amount_in):new p(i[f].parsedJson.data.amount_in).add(new p(i[f].parsedJson.data.fee_amount));_.lt(r)&&(a=f,r=_)}const u=[],l=[];return t[a].stepNums>1?(l.push(i[a].parsedJson.data.target_sqrt_price_ab,i[a].parsedJson.data.target_sqrt_price_cd),u.push(i[a].parsedJson.data.current_sqrt_price_ab,i[a].parsedJson.data.current_sqrt_price_cd)):(l.push(i[a].parsedJson.data.after_sqrt_price),u.push(i[a].parsedJson.current_sqrt_price)),{index:a,amountIn:t[0].byAmountIn?t[a].amount:r,amountMedium:i[a].parsedJson.data.amount_medium,amountOut:t[0].byAmountIn?r:t[a].amount,targetSqrtPrice:l,currentSqrtPrice:u,isExceed:i[a].parsedJson.data.is_exceed,stepNum:t[a].stepNums}}async getPoolWithTVL(){const t=[],{swapCountUrl:e}=this._sdk.sdkOptions;let n;try{n=await fetch(e)}catch{throw new Error(`Failed to get pool list with liquidity from ${e}.`)}const o=await n.json();if(o.code!==200)throw new Error(`Failed to get pool list from ${e}. Statu code is ${o.code}.`);const s=o.data.pools;for(const i of s)t.push({poolAddress:i.swap_account,tvl:Number(i.tvl_in_usd)});return t}},Ec=class{constructor(t){$(this,"_sdk");$(this,"calculateSingleImpact",(t,e)=>e.minus(t).div(e).mul(100));this._sdk=t}get sdk(){return this._sdk}calculateSwapFee(t){let e=it(0);return t.forEach(n=>{const o=n.basePaths.length;if(o>0){const s=n.basePaths[0],i=s.label==="Cetus"?new X(s.feeRate).div(10**6):new X(s.feeRate).div(10**9),r=it(s.inputAmount).div(10**s.fromDecimal).mul(i);if(e=e.add(r),o>1){const a=n.basePaths[1],u=s.direction?s.currentPrice:new X(1).div(s.currentPrice),l=a.direction?a.currentPrice:new X(1).div(a.currentPrice),d=a.label==="Cetus"?new X(s.feeRate).div(10**6):new X(s.feeRate).div(10**9),f=it(a.outputAmount).div(10**a.toDecimal).mul(d).div(u.mul(l));e=e.add(f)}}}),e.toString()}calculateSwapPriceImpact(t){let e=it(0);return t.forEach(n=>{const o=n.basePaths.length;if(o===1){const s=n.basePaths[0],i=it(s.outputAmount).div(10**s.toDecimal),r=it(s.inputAmount).div(10**s.fromDecimal),a=i.div(r),u=s.direction?new X(s.currentPrice):new X(1).div(s.currentPrice);e=e.add(this.calculateSingleImpact(a,u))}if(o===2){const s=n.basePaths[0],i=n.basePaths[1],r=s.direction?new X(s.currentPrice):new X(1).div(s.currentPrice),a=i.direction?new X(i.currentPrice):new X(1).div(i.currentPrice),u=r.mul(a),l=new X(i.outputAmount).div(10**i.toDecimal),d=new X(s.inputAmount).div(10**s.fromDecimal),h=l.div(d);e=e.add(this.calculateSingleImpact(h,u))}}),e.toString()}async calculateFee(t,e,n,o){const s=await this.sdk.Token.getTokenListByCoinTypes([e.coinTypeA,e.coinTypeB]),i=s[e.coinTypeA].decimals,r=s[e.coinTypeB].decimals,a=z.sqrtPriceX64ToPrice(new p(e.current_sqrt_price),i,r),u=it(e.fee_rate).div(1e4).div(100),l=t===e.coinTypeA;return console.log({a2b:l,feeTier:u}),{fee:it(n).mul(u),to_amount:o,currPrice:a,to_type:l?e.coinTypeB:e.coinTypeA,decimalsA:i,decimalsB:r}}changeAmount(t,e,n,o){let s;return t?s=it(e).mul(n):s=it(e).div(n),s.div(10**o)}async preSwapWithMultiPool(t){var l;const{integrate:e,simulationAccount:n}=this.sdk.sdkOptions,o=new H,s=[t.coinTypeA,t.coinTypeB];for(let d=0;d<t.poolAddresses.length;d+=1){const h=[o.pure(t.poolAddresses[d]),o.pure(t.a2b),o.pure(t.byAmountIn),o.pure(t.amount)];o.moveCall({target:`${e.published_at}::${ie}::calculate_swap_result`,arguments:h,typeArguments:s})}const r=(l=(await this.sdk.fullClient.devInspectTransactionBlock({transactionBlock:o,sender:n.address})).events)==null?void 0:l.filter(d=>N(d.type).name==="CalculatedSwapResultEvent");if(r.length===0)return null;if(r.length!==t.poolAddresses.length)throw new Error("valueData.length !== params.pools.length");let a=t.byAmountIn?P:we,u=0;for(let d=0;d<r.length;d+=1)if(!r[d].parsedJson.data.is_exceed)if(t.byAmountIn){const h=new p(r[d].parsedJson.data.amount_out);h.gt(a)&&(u=d,a=h)}else{const h=new p(r[d].parsedJson.data.amount_out);h.lt(a)&&(u=d,a=h)}return this.transformSwapWithMultiPoolData({poolAddress:t.poolAddresses[u],a2b:t.a2b,byAmountIn:t.byAmountIn,amount:t.amount,coinTypeA:t.coinTypeA,coinTypeB:t.coinTypeB},r[u].parsedJson)}async preswap(t){var u;const{integrate:e,simulationAccount:n}=this.sdk.sdkOptions,o=new H,s=[t.coinTypeA,t.coinTypeB],i=[o.pure(t.pool.poolAddress),o.pure(t.a2b),o.pure(t.byAmountIn),o.pure(t.amount)];o.moveCall({target:`${e.published_at}::${ie}::calculate_swap_result`,arguments:i,typeArguments:s});const a=(u=(await this.sdk.fullClient.devInspectTransactionBlock({transactionBlock:o,sender:n.address})).events)==null?void 0:u.filter(l=>N(l.type).name==="CalculatedSwapResultEvent");return a.length===0?null:this.transformSwapData(t,a[0].parsedJson.data)}transformSwapData(t,e){const n=e.amount_in&&e.fee_amount?new p(e.amount_in).add(new p(e.fee_amount)).toString():"";return{poolAddress:t.pool.poolAddress,currentSqrtPrice:t.currentSqrtPrice,estimatedAmountIn:n,estimatedAmountOut:e.amount_out,estimatedEndSqrtPrice:e.after_sqrt_price,estimatedFeeAmount:e.fee_amount,isExceed:e.is_exceed,amount:t.amount,aToB:t.a2b,byAmountIn:t.byAmountIn}}transformSwapWithMultiPoolData(t,e){const{data:n}=e,o=n.amount_in&&n.fee_amount?new p(n.amount_in).add(new p(n.fee_amount)).toString():"";return{poolAddress:t.poolAddress,estimatedAmountIn:o,estimatedAmountOut:n.amount_out,estimatedEndSqrtPrice:n.after_sqrt_price,estimatedStartSqrtPrice:e.current_sqrt_price,estimatedFeeAmount:n.fee_amount,isExceed:n.is_exceed,amount:t.amount,aToB:t.a2b,byAmountIn:t.byAmountIn}}calculateRates(t){const{currentPool:e}=t,n=Ua(e);let o;t.a2b?o=t.swapTicks.sort((h,f)=>f.index-h.index):o=t.swapTicks.sort((h,f)=>h.index-f.index);const s=ic(t.a2b,t.byAmountIn,t.amount,n,o);let i=!1;t.byAmountIn?(console.log(s.amountIn.toString(),t.amount.toString(),t.byAmountIn),i=s.amountIn.lt(t.amount)):(console.log(s.amountOut.toString(),t.amount.toString(),t.byAmountIn),i=s.amountOut.lt(t.amount));const r=te.getDefaultSqrtPriceLimit(t.a2b);t.a2b&&s.nextSqrtPrice.lt(r)&&(i=!0),!t.a2b&&s.nextSqrtPrice.gt(r)&&(i=!0);let a=0;s.crossTickNum>6&&s.crossTickNum<40&&(a=22e3*(s.crossTickNum-6)),s.crossTickNum>40&&(i=!0);const u=z.sqrtPriceX64ToPrice(n.currentSqrtPrice,t.decimalsA,t.decimalsB).toNumber(),l=z.sqrtPriceX64ToPrice(s.nextSqrtPrice,t.decimalsA,t.decimalsB).toNumber(),d=Math.abs(u-l)/u*100;return{estimatedAmountIn:s.amountIn,estimatedAmountOut:s.amountOut,estimatedEndSqrtPrice:s.nextSqrtPrice,estimatedFeeAmount:s.feeAmount,isExceed:i,extraComputeLimit:a,amount:t.amount,aToB:t.a2b,byAmountIn:t.byAmountIn,priceImpactPct:d}}async createSwapTransactionPayload(t,e){if(this._sdk.senderAddress.length===0)throw Error("this config sdk senderAddress is empty");const n=await this._sdk.getOwnerCoinAssets(this._sdk.senderAddress);if(e){const{isAdjustCoinA:o,isAdjustCoinB:s}=Yn(t);if(t.a2b&&o||!t.a2b&&s)return await pt.buildSwapTransactionForGas(this._sdk,t,n,e)}return pt.buildSwapTransaction(this.sdk,t,n)}},Rc=class{constructor(t){$(this,"_sdk");$(this,"_cache",{});this._sdk=t}get sdk(){return this._sdk}async getAllRegisteredTokenList(t=!1){return await this.factchTokenList("",t)}async getOwnerTokenList(t="",e=!1){return await this.factchTokenList(t,e)}async getAllRegisteredPoolList(t=!1){return await this.factchPoolList("",t)}async getOwnerPoolList(t="",e=!1){return await this.factchPoolList(t,e)}async getWarpPoolList(t=!1){return await this.factchWarpPoolList("","",t)}async getOwnerWarpPoolList(t="",e="",n=!1){return await this.factchWarpPoolList(t,e,n)}async getTokenListByCoinTypes(t){const e={},n="getAllRegisteredTokenList",o=this.getCache(n);if(o!==void 0){const i=o;for(const r of t)for(const a of i)if(Vt(r)===Vt(a.address)){e[r]=a;continue}}const s=t.filter(i=>e[i]===void 0);for(const i of s){const r=`${i}_metadata`,a=this.getCache(r);if(a!==void 0)e[i]=a;else{const u=await this._sdk.fullClient.getCoinMetadata({coinType:i});if(u){const l={id:u.id,name:u.name,symbol:u.symbol,official_symbol:u.symbol,coingecko_id:"",decimals:u.decimals,project_url:"",logo_url:u.iconUrl,address:i};e[i]=l,this.updateCache(r,l,tt)}}}return e}async factchTokenList(t="",e=!1){var h;const{simulationAccount:n,token:o}=this.sdk.sdkOptions,s="getAllRegisteredTokenList",i=this.getCache(s,e);if(i!==void 0)return i;const r=t.length>0,a=512;let u=0,l=[];if(o===void 0)throw Error("please config token ofsdkOptions");const d=Z(o);for(;;){const f=new H;f.moveCall({target:`${o.published_at}::coin_list::${r?"fetch_full_list_with_limit":"fetch_all_registered_coin_info_with_limit"}`,arguments:r?[f.pure(d.coin_registry_id),f.pure(t),f.pure(u),f.pure(a)]:[f.pure(d.coin_registry_id),f.pure(u),f.pure(a)]});const _=await this.sdk.fullClient.devInspectTransactionBlock({transactionBlock:f,sender:n.address}),v=[];if((h=_.events)==null||h.forEach(I=>{N(I.type).full_address===`${o.published_at}::coin_list::FetchCoinListEvent`&&I.parsedJson.full_list.value_list.forEach(y=>{v.push(this.transformData(y,!1))})}),l=[...l,...v],v.length<a)break;u=l.length}return l}async factchPoolList(t="",e=!1){var h;const{simulationAccount:n,token:o}=this.sdk.sdkOptions,s="getAllRegisteredPoolList",i=this.getCache(s,e);if(i!==void 0)return i;let r=[];const a=512;let u=0;const l=t.length>0;if(o===void 0)throw Error("please config token ofsdkOptions");const d=Z(o);for(;;){const f=new H;f.moveCall({target:`${o.published_at}::lp_list::${l?"fetch_full_list_with_limit":"fetch_all_registered_coin_info_with_limit"}`,arguments:l?[f.pure(d.pool_registry_id),f.pure(t),f.pure(u),f.pure(a)]:[f.pure(d.pool_registry_id),f.pure(u),f.pure(a)]});const _=await this.sdk.fullClient.devInspectTransactionBlock({transactionBlock:f,sender:n.address}),v=[];if((h=_.events)==null||h.forEach(I=>{N(I.type).full_address===`${o.published_at}::lp_list::FetchPoolListEvent`&&I.parsedJson.full_list.value_list.forEach(y=>{v.push(this.transformData(y,!0))})}),r=[...r,...v],v.length<a)break;u=r.length}return r}async factchWarpPoolList(t="",e="",n=!1){const o=await this.factchPoolList(t,n);if(o.length===0)return[];const s=await this.factchTokenList(e,n),i=[];for(const r of o){for(const a of s)a.address===r.coin_a_address&&(r.coinA=a),a.address===r.coin_b_address&&(r.coinB=a);i.push(r)}return i}async getTokenConfigEvent(t=!1){const e=this._sdk.sdkOptions.token.package_id,n=`${e}_getTokenConfigEvent`,o=this.getCache(n,t);if(o!==void 0)return o;const s=await this._sdk.fullClient.getObject({id:e,options:{showPreviousTransaction:!0}}),i=Qn(s),r=await this._sdk.fullClient.queryEventsByPage({Transaction:i}),a={coin_registry_id:"",pool_registry_id:"",coin_list_owner:"",pool_list_owner:""};return r.data.length>0&&r.data.forEach(u=>{const l=N(u.type);if(u.transactionModule==="coin_list")switch(l.name){case"InitListEvent":a.coin_list_owner=u.parsedJson.list_id;break;case"InitRegistryEvent":a.coin_registry_id=u.parsedJson.registry_id;break}else if(u.transactionModule==="lp_list")switch(l.name){case"InitListEvent<address>":a.pool_list_owner=u.parsedJson.list_id;break;case"InitRegistryEvent<address>":a.pool_registry_id=u.parsedJson.registry_id;break}}),a.coin_registry_id.length>0&&this.updateCache(n,a,tt),a}transformData(t,e){const n={...t};if(e)try{n.coin_a_address=N(n.coin_a_address).full_address,n.coin_b_address=N(n.coin_b_address).full_address}catch{}else n.address=N(n.address).full_address;if(t.extensions){const o=t.extensions.contents;for(const s of o){const{key:i}=s;let{value:r}=s;if(i==="labels")try{r=JSON.parse(decodeURIComponent(Je.decode(r)))}catch{}i==="pyth_id"&&(r=ht(r)),n[i]=r}delete n.extensions}return n}updateCache(t,e,n=sn){let o=this._cache[t];o?(o.overdueTime=Dt(n),o.value=e):o=new Oe(e,Dt(n)),this._cache[t]=o}getCache(t,e=!1){const n=this._cache[t],o=n==null?void 0:n.isValid();if(!e&&o)return n.value;o||delete this._cache[t]}},xc=class{constructor(t){$(this,"_sdk");this._sdk=t}get sdk(){return this._sdk}calculatePrice(t,e,n,o,s){const i=o?e:n,r=o?n:e;return s==="Cetus"?z.sqrtPriceX64ToPrice(t,i,r):new X(t.toString()).div(new X(10).pow(new X(r+9-i)))}parseJsonResult(t){return{isExceed:t.is_exceed,isTimeout:t.is_timeout,inputAmount:t.input_amount,outputAmount:t.output_amount,fromCoin:t.from_coin,toCoin:t.to_coin,byAmountIn:t.by_amount_in,splitPaths:t.split_paths.map(n=>({pathIndex:n.path_index,lastQuoteOutput:n.last_quote_output,percent:n.percent,basePaths:n.best_path.map(s=>({direction:s.direction,label:s.label,poolAddress:s.provider,fromCoin:s.from_coin,toCoin:s.to_coin,outputAmount:s.output_amount,inputAmount:s.input_amount,feeRate:s.fee_rate,currentSqrtPrice:new p(s.current_sqrt_price.toString()),fromDecimal:s.from_decimal,toDecimal:s.to_decimal,currentPrice:this.calculatePrice(new p(s.current_sqrt_price.toString()),s.from_decimal,s.to_decimal,s.direction,s.label)})),inputAmount:n.input_amount,outputAmount:n.output_amount}))}}async fetchWithTimeout(t,e,n){const o=new AbortController,s=setTimeout(()=>o.abort(),n);try{const i=await fetch(t,{signal:o.signal});return clearTimeout(s),i}catch{return null}}async fetchAndParseData(t){try{const n=await this.fetchWithTimeout(t,{},1500);return n.status===200?this.parseJsonResult(await n.json()):null}catch{return null}}async getBestRouter(t,e,n,o,s,i,r,a,u=!1,l=!1){let d=null,h="v2";const f=`
    ${this.sdk.sdkOptions.aggregatorUrl}?from=${encodeURIComponent(t)}&to=${encodeURIComponent(e)}&amount=${encodeURIComponent(n)}&by_amount_in=${encodeURIComponent(o)}&order_split=${encodeURIComponent(u)}&external_router=${encodeURIComponent(l)}&sender_address=''&request_id=${encodeURIComponent(Pa())}
    `;if(d=await this.fetchAndParseData(f),d!=null&&d.isTimeout||d==null){const _=await this.sdk.Router.price(t,e,new p(n),o,s,i,a),v=[];for(const m of _.paths){const y=[];if(m.poolAddress.length>1){const C=this.sdk.Router.tokenInfo(m.coinType[0]).decimals,B=this.sdk.Router.tokenInfo(m.coinType[1]).decimals,k=m.a2b[0]?z.sqrtPriceX64ToPrice(new p(_.currentSqrtPrice[0]),C,B):z.sqrtPriceX64ToPrice(new p(_.currentSqrtPrice[0]),B,C),q={direction:m.a2b[0],label:"Cetus",poolAddress:m.poolAddress[0],fromCoin:m.coinType[0],toCoin:m.coinType[1],feeRate:this.sdk.Router.getFeeRate(m.coinType[0],m.coinType[1],m.poolAddress[0]),outputAmount:_.byAmountIn?m.rawAmountLimit[0].toString():m.rawAmountLimit[1].toString(),inputAmount:m.amountIn.toString(),currentSqrtPrice:_.currentSqrtPrice[0],currentPrice:k,fromDecimal:C,toDecimal:B},M=this.sdk.Router.tokenInfo(m.coinType[1]).decimals,Y=this.sdk.Router.tokenInfo(m.coinType[2]).decimals,Bt=m.a2b[1]?z.sqrtPriceX64ToPrice(new p(_.currentSqrtPrice[1]),M,Y):z.sqrtPriceX64ToPrice(new p(_.currentSqrtPrice[1]),Y,M),x={direction:m.a2b[1],label:"Cetus",poolAddress:m.poolAddress[1],fromCoin:m.coinType[1],toCoin:m.coinType[2],feeRate:this.sdk.Router.getFeeRate(m.coinType[1],m.coinType[2],m.poolAddress[1]),outputAmount:m.amountOut.toString(),inputAmount:_.byAmountIn?m.rawAmountLimit[0].toString():m.rawAmountLimit[1].toString(),currentSqrtPrice:_.currentSqrtPrice[1],currentPrice:Bt,fromDecimal:M,toDecimal:Y};y.push(q,x)}else{const C=this.sdk.Router.tokenInfo(m.coinType[0]).decimals,B=this.sdk.Router.tokenInfo(m.coinType[1]).decimals,k=m.a2b[0]?z.sqrtPriceX64ToPrice(new p(_.currentSqrtPrice[0]),C,B):z.sqrtPriceX64ToPrice(new p(_.currentSqrtPrice[0]),B,C),q={direction:m.a2b[0],label:"Cetus",poolAddress:m.poolAddress[0],fromCoin:m.coinType[0],toCoin:m.coinType[1],feeRate:this.sdk.Router.getFeeRate(m.coinType[0],m.coinType[1],m.poolAddress[0]),outputAmount:m.amountOut.toString(),inputAmount:m.amountIn.toString(),currentSqrtPrice:_.currentSqrtPrice[0],currentPrice:k,fromDecimal:C,toDecimal:B};y.push(q)}const S={percent:Number(m.amountIn)/Number(_.amountIn)*100,inputAmount:Number(m.amountIn.toString()),outputAmount:Number(m.amountOut.toString()),pathIndex:0,lastQuoteOutput:0,basePaths:y};v.push(S)}const I={isExceed:_.isExceed,isTimeout:!0,inputAmount:Number(_.amountIn.toString()),outputAmount:Number(_.amountOut.toString()),fromCoin:_.coinTypeA,toCoin:_.coinTypeC!=null?_.coinTypeC:_.coinTypeB,byAmountIn:_.byAmountIn,splitPaths:v};h="v1",d=I}return{result:d,version:h}}},jc=class{constructor(t){$(this,"_sdk");$(this,"_cache",{});this._sdk=t}get sdk(){return this._sdk}async getTokenListByCoinTypes(t){const e={},{coin_list_handle:n}=Z(this.sdk.sdkOptions.cetus_config),o=`${n}_getCoinConfigs`,s=this.getCache(o);if(s!==void 0){const r=s;for(const a of t)for(const u of r)if(Vt(a)===Vt(u.address)){e[a]=u;continue}}const i=t.filter(r=>e[r]===void 0);for(const r of i){const a=`${r}_metadata`,u=this.getCache(a);if(u!==void 0)e[r]=u;else{const l=await this._sdk.fullClient.getCoinMetadata({coinType:r});if(l){const d={id:l.id,pyth_id:"",name:l.name,symbol:l.symbol,official_symbol:l.symbol,coingecko_id:"",decimals:l.decimals,project_url:"",logo_url:l.iconUrl,address:r};e[r]=d,this.updateCache(a,d,tt)}else console.log(`not found ${r}`)}}return e}async getCoinConfigs(t=!1,e=!0){const{coin_list_handle:n}=Z(this.sdk.sdkOptions.cetus_config),o=`${n}_getCoinConfigs`,s=this.getCache(o,t);if(s)return s;const r=(await this._sdk.fullClient.getDynamicFieldsByPage(n)).data.map(l=>l.objectId),a=await this._sdk.fullClient.batchGetObjects(r,{showContent:!0}),u=[];return a.forEach(l=>{const d=this.buildCoinConfig(l,e);this.updateCache(`${n}_${d.address}_getCoinConfig`,d,tt),u.push({...d})}),this.updateCache(o,u,tt),u}async getCoinConfig(t,e=!1,n=!0){const{coin_list_handle:o}=Z(this.sdk.sdkOptions.cetus_config),s=`${o}_${t}_getCoinConfig`,i=this.getCache(s,e);if(i)return i;const r=await this._sdk.fullClient.getDynamicFieldObject({parentId:o,name:{type:"0x1::type_name::TypeName",value:{name:dc(t)}}}),a=this.buildCoinConfig(r,n);return this.updateCache(s,a,tt),a}buildCoinConfig(t,e=!0){let n=Qt(t);n=n.value.fields;const o={...n};return o.id=ke(t),o.address=N(n.coin_type.fields.name).full_address,n.pyth_id&&(o.pyth_id=ht(n.pyth_id)),this.transformExtensions(o,n.extension_fields.fields.contents,e),delete o.coin_type,o}async getClmmPoolConfigs(t=!1,e=!0){const{clmm_pools_handle:n}=Z(this.sdk.sdkOptions.cetus_config),o=`${n}_getClmmPoolConfigs`,s=this.getCache(o,t);if(s)return s;const r=(await this._sdk.fullClient.getDynamicFieldsByPage(n)).data.map(l=>l.objectId),a=await this._sdk.fullClient.batchGetObjects(r,{showContent:!0}),u=[];return a.forEach(l=>{const d=this.buildClmmPoolConfig(l,e);this.updateCache(`${d.pool_address}_getClmmPoolConfig`,d,tt),u.push({...d})}),this.updateCache(o,u,tt),u}async getClmmPoolConfig(t,e=!1,n=!0){const{clmm_pools_handle:o}=Z(this.sdk.sdkOptions.cetus_config),s=`${t}_getClmmPoolConfig`,i=this.getCache(s,e);if(i)return i;const r=await this._sdk.fullClient.getDynamicFieldObject({parentId:o,name:{type:"address",value:t}}),a=this.buildClmmPoolConfig(r,n);return this.updateCache(s,a,tt),a}buildClmmPoolConfig(t,e=!0){let n=Qt(t);n=n.value.fields;const o={...n};return o.id=ke(t),o.pool_address=ht(n.pool_address),this.transformExtensions(o,n.extension_fields.fields.contents,e),o}async getLaunchpadPoolConfigs(t=!1,e=!0){const{launchpad_pools_handle:n}=Z(this.sdk.sdkOptions.cetus_config),o=`${n}_getLaunchpadPoolConfigs`,s=this.getCache(o,t);if(s)return s;const r=(await this._sdk.fullClient.getDynamicFieldsByPage(n)).data.map(l=>l.objectId),a=await this._sdk.fullClient.batchGetObjects(r,{showContent:!0}),u=[];return a.forEach(l=>{const d=this.buildLaunchpadPoolConfig(l,e);this.updateCache(`${d.pool_address}_getLaunchpadPoolConfig`,d,tt),u.push({...d})}),this.updateCache(o,u,tt),u}async getLaunchpadPoolConfig(t,e=!1,n=!0){const{launchpad_pools_handle:o}=Z(this.sdk.sdkOptions.cetus_config),s=`${t}_getLaunchpadPoolConfig`,i=this.getCache(s,e);if(i)return i;const r=await this._sdk.fullClient.getDynamicFieldObject({parentId:o,name:{type:"address",value:t}}),a=this.buildLaunchpadPoolConfig(r,n);return this.updateCache(s,a,tt),a}buildLaunchpadPoolConfig(t,e=!0){let n=Qt(t);n=n.value.fields;const o={...n};o.id=ke(t),o.pool_address=ht(n.pool_address),this.transformExtensions(o,n.extension_fields.fields.contents,e);const s=[];n.social_media.fields.contents.forEach(i=>{s.push({name:i.fields.value.fields.name,link:i.fields.value.fields.link})}),o.social_media=s;try{o.regulation=decodeURIComponent(Je.decode(o.regulation).replace(/%/g,"%25"))}catch{o.regulation=Je.decode(o.regulation)}return o}transformExtensions(t,e,n=!0){const o=[];for(const s of e){const{key:i}=s.fields;let{value:r}=s.fields;if(i==="labels")try{r=JSON.parse(decodeURIComponent(Je.decode(r)))}catch{}n&&(t[i]=r),o.push({key:i,value:r})}delete t.extension_fields,n||(t.extensions=o)}async getCetusConfig(t=!1){const e=this._sdk.sdkOptions.cetus_config.package_id,n=`${e}_getCetusConfig`,o=this.getCache(n,t);if(o!==void 0)return o;const s=await this._sdk.fullClient.getObject({id:e,options:{showPreviousTransaction:!0}}),i=Qn(s),r=await this._sdk.fullClient.queryEventsByPage({Transaction:i});let a={coin_list_id:"",launchpad_pools_id:"",clmm_pools_id:"",admin_cap_id:"",global_config_id:"",coin_list_handle:"",launchpad_pools_handle:"",clmm_pools_handle:""};if(r.data.length>0)for(const u of r.data)switch(N(u.type).name){case"InitCoinListEvent":a.coin_list_id=u.parsedJson.coin_list_id;break;case"InitLaunchpadPoolsEvent":a.launchpad_pools_id=u.parsedJson.launchpad_pools_id;break;case"InitClmmPoolsEvent":a.clmm_pools_id=u.parsedJson.pools_id;break;case"InitConfigEvent":a.global_config_id=u.parsedJson.global_config_id,a.admin_cap_id=u.parsedJson.admin_cap_id;break}return a=await this.getCetusConfigHandle(a),a.clmm_pools_id.length>0&&this.updateCache(n,a,tt),a}async getCetusConfigHandle(t){const e=[t.clmm_pools_id,t.coin_list_id,t.launchpad_pools_id];return(await this._sdk.fullClient.multiGetObjects({ids:e,options:{showContent:!0}})).forEach(o=>{const s=Qt(o),i=bc(o);switch(N(i).name){case"ClmmPools":t.clmm_pools_handle=s.pools.fields.id.id;break;case"CoinList":t.coin_list_handle=s.coins.fields.id.id;break;case"LaunchpadPools":t.launchpad_pools_handle=s.pools.fields.id.id;break}}),t}updateCache(t,e,n=sn){let o=this._cache[t];o?(o.overdueTime=Dt(n),o.value=e):o=new Oe(e,Dt(n)),this._cache[t]=o}getCache(t,e=!1){const n=this._cache[t],o=n==null?void 0:n.isValid();if(!e&&o)return n.value;o||delete this._cache[t]}},Dc=class extends Na{async queryEventsByPage(t,e="all"){let n=[],o=!0;const s=e==="all";let i=s?null:e.cursor;do{const r=await this.queryEvents({query:t,cursor:i,limit:s?null:e.limit});r.data?(n=[...n,...r.data],o=r.hasNextPage,i=r.nextCursor):o=!1}while(s&&o);return{data:n,nextCursor:i,hasNextPage:o}}async getOwnedObjectsByPage(t,e,n="all"){let o=[],s=!0;const i=n==="all";let r=i?null:n.cursor;do{const a=await this.getOwnedObjects({owner:t,...e,cursor:r,limit:i?null:n.limit});a.data?(o=[...o,...a.data],s=a.hasNextPage,r=a.nextCursor):s=!1}while(i&&s);return{data:o,nextCursor:r,hasNextPage:s}}async getDynamicFieldsByPage(t,e="all"){let n=[],o=!0;const s=e==="all";let i=s?null:e.cursor;do{const r=await this.getDynamicFields({parentId:t,cursor:i,limit:s?null:e.limit});r.data?(n=[...n,...r.data],o=r.hasNextPage,i=r.nextCursor):o=!1}while(s&&o);return{data:n,nextCursor:i,hasNextPage:o}}async batchGetObjects(t,e,n=50){let o=[];try{for(let s=0;s<Math.ceil(t.length/n);s++){const i=await this.multiGetObjects({ids:t.slice(s*n,n*(s+1)),options:e});o=[...o,...i]}}catch(s){console.log(s)}return o}async calculationTxGas(t){const{sender:e}=t.blockData;if(e===void 0)throw Error("sdk sender is empty");const n=await this.devInspectTransactionBlock({transactionBlock:t,sender:e}),{gasUsed:o}=n.effects;return Number(o.computationCost)+Number(o.storageCost)-Number(o.storageRebate)}async sendTransaction(t,e){try{return await this.signAndExecuteTransactionBlock({transactionBlock:e,signer:t,options:{showEffects:!0,showEvents:!0}})}catch(n){console.log("error: ",n)}}},Mc=class{constructor(t){$(this,"_cache",{});$(this,"_rpcModule");$(this,"_pool");$(this,"_position");$(this,"_swap");$(this,"_rewarder");$(this,"_router");$(this,"_router_v2");$(this,"_token");$(this,"_config");$(this,"_sdkOptions");$(this,"_senderAddress","");this._sdkOptions=t,this._rpcModule=new Dc({url:t.fullRpcUrl}),this._swap=new Ec(this),this._pool=new Ic(this),this._position=new Pc(this),this._rewarder=new Bc(this),this._router=new Oc(this),this._router_v2=new xc(this),this._token=new Rc(this),this._config=new jc(this),Rs(this._sdkOptions)}get senderAddress(){return this._senderAddress}set senderAddress(t){this._senderAddress=t}get Swap(){return this._swap}get fullClient(){return this._rpcModule}get sdkOptions(){return this._sdkOptions}get Pool(){return this._pool}get Position(){return this._position}get Rewarder(){return this._rewarder}get Router(){return this._router}get RouterV2(){return this._router_v2}get CetusConfig(){return this._config}get Token(){return this._token}async getOwnerCoinAssets(t,e,n=!0){const o=[];let s=null;const i=`${this.sdkOptions.fullRpcUrl}_${t}_${e}_getOwnerCoinAssets`,r=this.getCache(i,n);if(r)return r;for(;;){const a=await(e?this.fullClient.getCoins({owner:t,coinType:e,cursor:s}):this.fullClient.getAllCoins({owner:t,cursor:s}));if(a.data.forEach(u=>{BigInt(u.balance)>0&&o.push({coinAddress:N(u.coinType).source_address,coinObjectId:u.coinObjectId,balance:BigInt(u.balance)})}),s=a.nextCursor,!a.hasNextPage)break}return this.updateCache(i,o,30*1e3),o}async getOwnerCoinBalances(t,e){let n=[];return e?n=[await this.fullClient.getBalance({owner:t,coinType:e})]:n=[...await this.fullClient.getAllBalances({owner:t})],n}updateCache(t,e,n=tt){let o=this._cache[t];o?(o.overdueTime=Dt(n),o.value=e):o=new Oe(e,Dt(n)),this._cache[t]=o}getCache(t,e=!1){const n=this._cache[t],o=n==null?void 0:n.isValid();if(!e&&o)return n.value;o||delete this._cache[t]}},Nc=Mc;const mn={package_id:"0x97387ad756eb2d3f44ffb46469e8da8379a1afe359f33fbc01fed0e8f80d52c6",published_at:"0x97387ad756eb2d3f44ffb46469e8da8379a1afe359f33fbc01fed0e8f80d52c6",cetus_coin_type:"0xdc612ad030d4db39334d8e38a99fc6a49fc85b74c036839f13803beae66c6164::cetus::CETUS"};function Fs(t){const e={fullRpcUrl:localStorage.getItem(`${t}-currentRpclocal2`)||Wt[t||"Sui"].fullRpcUrl,simulationAccount:Wt[t||"Sui"].simulationAccount,cetus_config:Wt[t||"Sui"].cetus_config,clmm_pool:Wt[t||"Sui"].clmm_pool,integrate:Wt[t||"Sui"].integrate,deepbook:Wt[t||"Sui"].deepbook,deepbook_endpoint_v2:Wt[t||"Sui"].deepbook_endpoint_v2,aggregatorUrl:Wt[t||"Sui"].aggregatorUrl,swapCountUrl:""},n=new Nc(e),o=on(),s=Ct(()=>o);oi(()=>{s.value.address&&(n.senderAddress=s.value.address)});const i=async()=>{if(n.senderAddress.length!==0)try{const y=(await n.fullClient.getOwnedObjectsByPage(n.senderAddress,{options:{showContent:!0},filter:{StructType:`${mn.package_id}::token_vesting::VestingNFT`}})).data.map(S=>a(S));return y.length>0?y:void 0}catch(m){console.log("getVestingNFTIds ",m);return}},r=async m=>{try{const y=await n.fullClient.getObject({id:m,options:{showContent:!0}});return a(y)}catch(y){console.log("getVestingNFTById",y);return}},a=m=>{var y;try{const S=(y=m.data)==null?void 0:y.content,C=S.fields,B=C.period_infos.map(q=>({...q.fields}));return{nft_id:C.id.id,amount:C.amount,released_amount:C.released_amount,start_time:C.start_time,pool:C.pool,type:S.type,period_infos:B}}catch(S){console.log("getVestingNFTById",S);return}},u=(m,y,S)=>{const C=new ei;return console.log(m,y,S,"##periods"),S.forEach(B=>{C.moveCall({target:`${mn.published_at}::router::redeem`,typeArguments:[mn.cetus_coin_type],arguments:[C.object(y),C.object(m),C.pure(B),C.object(et)]})}),l(C)},l=m=>({transactionBlock:m,options:{showEffects:!0,showEvents:!0,showInput:!0,showRawInput:!0,showObjectChanges:!0,showBalanceChanges:!0}}),{$notify:d}=io(),h=m=>{d.success({key:m.hash+"loading",icon:st("img",{class:{"notify-icon":!0,"loading-animate":!0},src:"/images/img-loading.png"}),message:st("div",{class:"notification-title"},[st("span",{innerHTML:m.title},null)]),description:st("div",{class:"notification-title"},[st("div",{class:"notification-text",innerHTML:le.global.t("newAdd.confirmingTransaction")},null),st("a",{href:Ye("tx",m.hash),target:"_blank",innerHTML:le.global.t("common.viewTransaction")},null)]),duration:0,class:"ant-notification-copy ant-notification-swap"})},f=m=>{d.success({icon:st("svg",{class:{icon:!0},"aria-hidden":!0},[st("use",{"xlink:href":"#icon-icon-change1"})]),message:st("div",{class:"notification-title"},[st("span",{innerHTML:`${m.title} `+le.global.t("newAdd.success")},null)]),description:st("div",{class:"notification-title"},[st("div",{class:"notification-text",innerHTML:m.desc},null),st("a",{href:Ye("tx",window.encodeURIComponent(m.hash)),target:"_blank",innerHTML:le.global.t("common.viewTransaction")},null)]),duration:4.5,class:"ant-notification-copy ant-notification-swap"})},_=m=>{d.error({icon:st("svg",{class:{icon:!0},"aria-hidden":!0},[st("use",{"xlink:href":"#icon-a-icon-Shutdown"})]),message:st("div",{class:"notification-title"},[st("span",{innerHTML:`${m} `+le.global.t("newAdd.failed")},null)]),description:le.global.t("newAdd.somethingWrong"),duration:4.5,class:"ant-notification-copy ant-notification-error"})},v=async(m,y=!1)=>{var C,B,k,q;const{$notify:S}=io();try{let M={};if(!m.res||!((C=m==null?void 0:m.res)!=null&&C.digest)){const Y=await ni(2e3);M=await sdk.Pool.getSuiTransactionResponse(m.hash),console.log("0503###watchTransaction###res###",M)}else M=m.res;if(console.log("0411###watchTransaction###res###",M),console.log(m,"====>params"),((k=(B=M==null?void 0:M.effects)==null?void 0:B.status)==null?void 0:k.status)==="success"){S.close(m.hash+"loading"),f(m);const Y={walletAddress:o.address,chainName:"Sui",...m,...M,date:new Date().getTime()+6048e5};if(y)if(console.log("0222###watchTransaction###isGetNftInfo true###res####",M),M.events){const x=M.events.filter(L=>L.type.includes("OpenPositionEvent"));return{status:!0,nftInfo:x[0]&&((q=x[0])==null?void 0:q.parsedJson)}}else return{status:!0,nftInfo:M.effects.events};return!0}else{if(M&&M.effects&&M.effects.status&&M.effects.status.status!=="success")return S.close(m.hash+"loading"),_(m.title),!1;setTimeout(()=>v(m),3e3)}}catch(M){return console.log("watchTransaction###error###",M),S.close(m.hash+"loading"),S.error({icon:st("svg",{class:{icon:!0},"aria-hidden":!0},[st("use",{"xlink:href":"#icon-a-icon-Shutdown"})]),message:st("div",{class:"notification-title"},[st("span",{innerHTML:`${m.title} Failed`},null)]),duration:4.5,description:"Something went wrong",class:"ant-notification-copy ant-notification-error"}),!0}};return{getVestingNFT:i,getVestingNFTById:r,buildRedeemPayload:u,handleTx:m=>{var S,C,B,k,q;let y;return m!=null&&m.digest?y={hash:m==null?void 0:m.digest,status:(C=(S=m==null?void 0:m.effects)==null?void 0:S.status)==null?void 0:C.status,res:m}:m!=null&&m.effects&&(y={hash:(B=m==null?void 0:m.effects)==null?void 0:B.transactionDigest,status:(q=(k=m==null?void 0:m.effects)==null?void 0:k.status)==null?void 0:q.status,res:m}),y},watchTransaction:v,showTransitionPending:h}}const to=si("vesting",{state:()=>({vestingList:[],currentVesting:{},unLockList:[],vestingLoading:!0}),actions:{async getOwnerVestingNFT(){const e=await Fs("Sui").getVestingNFT()||[];this.vestingList=e,this.vestingLoading=!1,console.log(e,"##ownerVestingNFT")},setCurrentVestingNFT(t){let e=new X(0),n=new X(0);const o=[],s=[],i=[],r=a=>{console.log(a,"item##");const u=parseInt(String(new Date().getTime()/1e3));if(console.log(a.release_time,u,"dasdas"),a.release_time<u&&a.is_redeemed)return"Claimed";if(a.release_time<u&&!a.is_redeemed)return"Pending Withdraw";if(a.release_time>u&&!a.is_redeemed)return"Locked"};console.log(t,"info###"),t==null||t.period_infos.forEach(a=>{console.log(a,"ele##");const u=parseInt(String(new Date().getTime()/1e3));a.release_time<u&&!a.is_redeemed&&(e=e.add(new X(a.amount)),s.push(a));const l=r(a);l=="Locked"&&(o.push(a),n=n.add(new X(a.amount))),console.log(o,"##lockList"),i.push({...a,status:l})}),console.log(n,"lockedAmount##"),this.currentVesting={...t,unLockedAmount:e.toNumber(),period_infos:i,lockedAmount:n.toNumber(),nextRelease:o.length>0?wn((o[0].release_time-28800)*1e3,"")+" "+bn(new Date((o[0].release_time-28800)*1e3))+" (UTC)":"--"},this.unLockList=s,console.log(this.currentVesting,"##this.currentVesting")},loginOut(){this.vestingList=[],this.currentVesting={}}}}),Fc=""+globalThis.__publicAssetsURL("images/banner@2x.png"),qc=""+globalThis.__publicAssetsURL("images/h5-banner@2x.png");const Lc=xn({setup(){const t=to(),e=Ct(()=>t),n=yn(0);tn(()=>e.value.vestingList,d=>{d&&d.length>0&&t.setCurrentVestingNFT(d[n.value])},{immediate:!0});const o=on(),s=Ct(()=>o);tn(()=>s.value.address,d=>{d||t.loginOut()},{immediate:!0});const i=Ct(()=>e.value.currentVesting),r=Ct(()=>e.value.vestingList),a=()=>{n.value!=0&&(n.value--,t.setCurrentVestingNFT(r.value[n.value]))},u=()=>{console.log(n.value,r.value.length,"##208"),n.value+1!=r.value.length&&(n.value++,t.setCurrentVestingNFT(r.value[n.value]))},l=jo();return{addCommom:Ht,currentVestingNFT:i,vestingList:r,currentNftIndex:n,prev:a,next:u,prettyAmount:St,indexStore:l}}}),yt=t=>(Do("data-v-17a1cba6"),t=t(),Mo(),t),$c={class:"vesting-top"},Uc={class:"vesting-top-center"},Vc={class:"vesting-info"},Gc={class:"left"},Wc=yt(()=>b("div",{class:"title"},"Vesting",-1)),Jc={class:"info-block"},Kc={class:"info-item"},Xc=yt(()=>b("div",{class:"leabl"},"NFT",-1)),zc={key:0,class:"text"},Hc=["href"],Zc=yt(()=>b("use",{"xlink:href":"#icon-icon-copy1"},null,-1)),Qc=[Zc],Yc={key:1,class:"text"},tu={class:"info-item"},eu=yt(()=>b("div",{class:"leabl"},"Total Locked",-1)),nu={key:0,class:"text"},ou={key:1,class:"text"},su={class:"info-item"},iu=yt(()=>b("div",{class:"leabl"},"Remaining Locked",-1)),ru={key:0,class:"text"},au={key:1,class:"text"},cu={class:"info-item"},uu=yt(()=>b("div",{class:"leabl"},"Next Release",-1)),lu={key:0,class:"text"},du={key:1,class:"text"},pu=yt(()=>b("div",{class:"right"},[b("img",{src:Fc,alt:""})],-1)),hu={key:0,class:"tab-nft"},fu={class:"h5-vesting-top-center"},gu={class:"nft-info"},mu={class:"info-block"},_u=yt(()=>b("div",null,"NFT",-1)),wu={key:0},bu=["href"],yu=yt(()=>b("use",{"xlink:href":"#icon-icon-copy1"},null,-1)),vu=[yu],Au={key:1},Cu={class:"info-block"},Tu=yt(()=>b("div",null,"Total Locked",-1)),ku={key:0},Su={key:1},Iu={class:"info-block"},Pu=yt(()=>b("div",null,"Remaining Locked",-1)),Bu={key:0},Ou={key:1},Eu={class:"info-block"},Ru=yt(()=>b("div",null,"Next Release",-1)),xu={key:0},ju={key:1},Du={key:0,class:"prev-next"},Mu=yt(()=>b("div",{class:"banner"},[b("img",{src:qc,alt:""})],-1));function Nu(t,e,n,o,s,i){return j(),D("div",$c,[b("div",Uc,[b("div",Vc,[b("div",Gc,[Wc,b("div",Jc,[b("div",Kc,[Xc,t.vestingList&&t.vestingList.length>0?(j(),D("div",zc,[b("span",null,[b("a",{href:("getExplorerUrl"in t?t.getExplorerUrl:rt(Ye))("nftAddress",t.currentVestingNFT.nft_id),target:"_blank"},ot(t.currentVestingNFT.nft_id&&t.currentVestingNFT.nft_id.substr(0,6))+" ... "+ot(t.currentVestingNFT.nft_id&&t.currentVestingNFT.nft_id.substr(t.currentVestingNFT.nft_id.length-6,6)),9,Hc)]),(j(),D("svg",{class:"copy-icon","aria-hidden":"true",onClick:e[0]||(e[0]=r=>t.indexStore.copy(t.currentVestingNFT.nft_id))},Qc))])):(j(),D("div",Yc,"--"))]),b("div",tu,[eu,t.vestingList&&t.vestingList.length>0?(j(),D("div",nu,ot(("addCommom"in t?t.addCommom:rt(Ht))(("prettyAmount"in t?t.prettyAmount:rt(St))(t.currentVestingNFT.amount,9))),1)):(j(),D("div",ou,"--"))]),b("div",su,[iu,t.vestingList&&t.vestingList.length>0?(j(),D("div",ru,ot(("addCommom"in t?t.addCommom:rt(Ht))(("prettyAmount"in t?t.prettyAmount:rt(St))(t.currentVestingNFT.lockedAmount,9))),1)):(j(),D("div",au,"--"))]),b("div",cu,[uu,t.vestingList&&t.vestingList.length>0?(j(),D("div",lu,ot(t.currentVestingNFT.nextRelease),1)):(j(),D("div",du,"--"))])])]),pu]),t.vestingList&&t.vestingList.length>1?(j(),D("div",hu,[b("div",{class:Zt(["prev",t.currentNftIndex==0?"prev-disabled":""]),onClick:e[1]||(e[1]=(...r)=>t.prev&&t.prev(...r))},null,2),b("div",{class:Zt(["next",t.currentNftIndex+1==t.vestingList.length?"prev-disabled":""]),onClick:e[2]||(e[2]=(...r)=>t.next&&t.next(...r))},null,2)])):ro("",!0)]),b("div",fu,[b("div",gu,[b("div",mu,[_u,t.vestingList&&t.vestingList.length>0?(j(),D("div",wu,[b("span",null,[b("a",{href:("getExplorerUrl"in t?t.getExplorerUrl:rt(Ye))("nftAddress",t.currentVestingNFT.nft_id),target:"_blank"},ot(t.currentVestingNFT.nft_id&&t.currentVestingNFT.nft_id.substr(0,6))+" ... "+ot(t.currentVestingNFT.nft_id&&t.currentVestingNFT.nft_id.substr(t.currentVestingNFT.nft_id.length-6,6)),9,bu)]),(j(),D("svg",{class:"copy-icon","aria-hidden":"true",onClick:e[3]||(e[3]=r=>t.indexStore.copy(t.currentVestingNFT.nft_id))},vu))])):(j(),D("div",Au,"--"))]),b("div",Cu,[Tu,t.vestingList&&t.vestingList.length>0?(j(),D("div",ku,ot(("addCommom"in t?t.addCommom:rt(Ht))(("prettyAmount"in t?t.prettyAmount:rt(St))(t.currentVestingNFT.amount,9))),1)):(j(),D("div",Su,"--"))]),b("div",Iu,[Pu,t.vestingList&&t.vestingList.length>0?(j(),D("div",Bu,ot(("addCommom"in t?t.addCommom:rt(Ht))(("prettyAmount"in t?t.prettyAmount:rt(St))(t.currentVestingNFT.lockedAmount,9))),1)):(j(),D("div",Ou,"--"))]),b("div",Eu,[Ru,t.vestingList&&t.vestingList.length>0?(j(),D("div",xu,ot(t.currentVestingNFT.nextRelease),1)):(j(),D("div",ju,"--"))])]),t.vestingList&&t.vestingList.length>1?(j(),D("div",Du,[b("div",{class:Zt(["prev",t.currentNftIndex==0?"prev-disabled":""]),onClick:e[4]||(e[4]=(...r)=>t.prev&&t.prev(...r))},null,2),b("div",{class:Zt(["next",t.currentNftIndex+1==t.vestingList.length?"prev-disabled":""]),onClick:e[5]||(e[5]=(...r)=>t.next&&t.next(...r))},null,2)])):ro("",!0),Mu])])}const qs=Rn(Lc,[["render",Nu],["__scopeId","data-v-17a1cba6"]]);const Ls=""+globalThis.__publicAssetsURL("images/logo_cetus@2x.png"),$s=""+globalThis.__publicAssetsURL("images/img-no-Positions@2x.png"),Us=""+globalThis.__publicAssetsURL("images/img-connect-wallet@2x.png");const Fu=xn({setup(){const t=to(),e=Ct(()=>t),{t:n}=ii(),o=on(),s=Ct(()=>o),i=yn(0);tn(()=>e.value.vestingList,C=>{C&&C.length>0&&t.setCurrentVestingNFT(C[i.value])},{immediate:!0});const r=Ct(()=>e.value.currentVesting),a=Ct(()=>e.value.unLockList),u=C=>{switch(C){case"Claimed":return"claimed";case"Pending Withdraw":return"pending-withdraw";case"Locked":return"locked"}},l=yn(!1),d=jo(),{setIsShowSuccess:h,setIsShowRejected:f,setIsShowWaiting:_,setTransactionDesc:v,setTransactionTxid:I}=d,m=async()=>{l.value=!0;const C=Fs("Sui");_(!0),I(""),v(`Claiming ${St(r.value.unLockedAmount,9)} CETUS`);const B=a.value.map(k=>k.period);try{const k=await C.buildRedeemPayload(r.value.nft_id,r.value.pool,B);console.log(k,"payload##");const q=await s.value.currentWallet.signAndExecuteTransactionBlock(k),M=C.handleTx(q);if(M&&M.hash){I(M.hash),_(!1),h(!0),l.value=!1;const Y={title:"Claimed",desc:`Claimed ${St(r.value.unLockedAmount,9)} CETUS`,hash:M.hash,icon:"icon-icon-Increased"};Y.res=M.res,C.showTransitionPending(Y),await C.watchTransaction(Y)&&setTimeout(()=>{t.getOwnerVestingNFT()},1e3)}else _(!1),f(!0)}catch(k){console.log(k,"claim error"),l.value=!1,_(!1)}},y=Ct(()=>e.value.vestingList),S=Ct(()=>e.value.vestingLoading);return{currentVestingNFT:r,getStatusClass:u,claim:m,loading:l,addCommom:Ht,prettyAmount:St,vestingList:y,vestingLoading:S,t:n,wallet:s,walletStore:o}}}),wt=t=>(Do("data-v-e2fc707e"),t=t(),Mo(),t),qu={class:"vesting-bottom"},Lu={class:"pc-vesting-bottom-center"},$u={key:0,class:"vesting-bottom-center"},Uu={class:"claimable-tokens"},Vu=wt(()=>b("div",{class:"title"},"Claimable Tokens",-1)),Gu={class:"claim-num"},Wu=wt(()=>b("img",{src:Ls,alt:""},null,-1)),Ju={class:"table-content"},Ku=wt(()=>b("thead",{class:"table-header"},[b("tr",{class:"table-tr"},[b("th",null,"#"),b("th",null,"Release Date"),b("th",null,"Amount (CETUS)"),b("th",null,"Status")])],-1)),Xu={class:"table-body"},zu={key:1,class:"vesting-bottom-no-data"},Hu={key:0,class:"no-data"},Zu={key:0,class:"token-loading"},Qu={key:1,class:"no-data-content"},Yu=wt(()=>b("img",{src:$s},null,-1)),tl={key:1,class:"no-data"},el={key:2,class:"vesting-bottom-no-data"},nl={class:"no-data"},ol={class:"no-data-content"},sl=wt(()=>b("img",{src:Us},null,-1)),il=wt(()=>b("p",null,"Connect your wallet to view this page.",-1)),rl={class:"h5-vesting-bottom-center"},al={class:"claimable-tokens"},cl=wt(()=>b("div",{class:"title"},"Claimable Tokens",-1)),ul={class:"num"},ll=wt(()=>b("img",{src:Ls,alt:""},null,-1)),dl={key:0,class:"release-list"},pl={class:"index"},hl={class:"date"},fl=wt(()=>b("div",null,"Release Date",-1)),gl={class:"amount"},ml=wt(()=>b("div",null,"Amount (CETUS)",-1)),_l={class:"status"},wl=wt(()=>b("div",null,"Status",-1)),bl={key:1,class:"vesting-bottom-no-data"},yl={key:0,class:"no-data"},vl={key:0,class:"token-loading"},Al={key:1,class:"no-data-content"},Cl=wt(()=>b("img",{src:$s},null,-1)),Tl={key:1,class:"no-data"},kl={key:2,class:"vesting-bottom-no-data"},Sl={class:"no-data"},Il={class:"no-data-content"},Pl=wt(()=>b("img",{src:Us},null,-1)),Bl=wt(()=>b("p",null,"Connect your wallet to view this page.",-1));function Ol(t,e,n,o,s,i){const r=ri,a=ai;return j(),D("div",qu,[b("div",Lu,[t.vestingList.length>0?(j(),D("div",$u,[b("div",Uu,[Vu,b("div",Gu,[Wu,b("span",null,ot(("addCommom"in t?t.addCommom:rt(Ht))(("prettyAmount"in t?t.prettyAmount:rt(St))(t.currentVestingNFT.unLockedAmount,9)))+" CETUS",1),Rt(r,{class:"claim-btn",loading:t.loading,disabled:t.currentVestingNFT.unLockedAmount<=0||t.vestingList.length==0,onClick:t.claim},{default:je(()=>[De("Claim")]),_:1},8,["loading","disabled","onClick"])])]),b("div",Ju,[b("table",null,[Ku,b("tbody",Xu,[(j(!0),D(ao,null,co(t.currentVestingNFT.period_infos,u=>(j(),D("tr",{key:u,class:Zt(t.getStatusClass(u.status))},[b("td",null,ot(u.period),1),b("td",null,ot(("timeFormat"in t?t.timeFormat:rt(wn))((u.release_time-28800)*1e3,"")+" "+("getAmOrPm"in t?t.getAmOrPm:rt(bn))(new Date((u.release_time-28800)*1e3))+" (UTC)"),1),b("td",null,ot(("prettyAmount"in t?t.prettyAmount:rt(St))(u.amount,9)),1),b("td",{class:Zt(t.getStatusClass(u.status))},ot(u.status),3)],2))),128))])])])])):t.wallet&&t.wallet.address?(j(),D("div",zu,[t.vestingLoading?(j(),D("div",tl,[Rt(a)])):(j(),D("div",Hu,[t.vestingLoading?(j(),D("div",Zu,[Rt(a)])):(j(),D("div",Qu,[Yu,b("p",null,ot(t.t("common.noData")),1)]))]))])):(j(),D("div",el,[b("div",nl,[b("div",ol,[sl,il,Rt(r,{onClick:e[0]||(e[0]=u=>t.wallet.setIsShowWalletModal(!0))},{default:je(()=>[De("Connect Wallet")]),_:1})])])]))]),b("div",rl,[b("div",al,[cl,b("div",ul,[ll,b("span",null,ot(("addCommom"in t?t.addCommom:rt(Ht))(("prettyAmount"in t?t.prettyAmount:rt(St))(t.currentVestingNFT.unLockedAmount,9)))+" CETUS",1)]),Rt(r,{class:"claim-btn",loading:t.loading,disabled:t.currentVestingNFT.unLockedAmount<=0||t.vestingList.length==0,onClick:t.claim},{default:je(()=>[De("Claim")]),_:1},8,["loading","disabled","onClick"])]),t.vestingList.length>0?(j(),D("div",dl,[(j(!0),D(ao,null,co(t.currentVestingNFT.period_infos,u=>(j(),D("div",{key:u,class:Zt(["release-item",t.getStatusClass(u.status)])},[b("div",pl,"#"+ot(u.period),1),b("div",hl,[fl,b("div",null,ot(("timeFormat"in t?t.timeFormat:rt(wn))((u.release_time-28800)*1e3,"")+" "+("getAmOrPm"in t?t.getAmOrPm:rt(bn))(new Date((u.release_time-28800)*1e3))+" (UTC)"),1)]),b("div",gl,[ml,b("div",null,ot(("prettyAmount"in t?t.prettyAmount:rt(St))(u.amount,9)),1)]),b("div",_l,[wl,b("div",{class:Zt(t.getStatusClass(u.status))},ot(u.status),3)])],2))),128))])):t.wallet&&t.wallet.address?(j(),D("div",bl,[t.vestingLoading?(j(),D("div",Tl,[Rt(a)])):(j(),D("div",yl,[t.vestingLoading?(j(),D("div",vl,[Rt(a)])):(j(),D("div",Al,[Cl,b("p",null,ot(t.t("common.noData")),1)]))]))])):(j(),D("div",kl,[b("div",Sl,[b("div",Il,[Pl,Bl,Rt(r,{onClick:e[1]||(e[1]=u=>t.wallet.setIsShowWalletModal(!0))},{default:je(()=>[De("Connect Wallet")]),_:1})])])]))])])}const Vs=Rn(Fu,[["render",Ol],["__scopeId","data-v-e2fc707e"]]);const El=xn({components:{VestingTop:qs,VestingBottom:Vs},setup(){const t=to(),e=on(),n=Ct(()=>e);return tn(()=>n.value.address,o=>{o&&t.getOwnerVestingNFT()},{immediate:!0}),ci(()=>{window.setInterval(()=>{t.getOwnerVestingNFT()},12e4)}),{}}}),Rl={class:"vesting"};function xl(t,e,n,o,s,i){const r=qs,a=Vs;return j(),D("div",Rl,[Rt(r),Rt(a)])}const Nl=Rn(El,[["render",xl]]);export{Nl as default};
