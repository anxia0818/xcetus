import{_ as ra,a as Jo,b as Ko,c as ia,d as ca}from"./new-liquidity-title.5ef7e082.js";import{i as Xe}from"./import-icon.de3e6c66.js";import{a as Yo,m as $,r as F,E as Zo,l as va,D as x,e as xo,Q as ea,o as N,f as D,i as re,h as l,x as M,v as qe,c as Ae,w as zo,j as be,B as da,p as oa,k as aa,b as ma,C as pa,q as fa,H as ga,z as ge,t as ka,u as ba,I as Ca}from"./entry.a5afa453.js";/* empty css              */import{a as wa,u as la,c as ta}from"./sha256.e2617b6c.js";import{a as na,u as ua,p as Ho,s as Xo,e as Qo,c as Go,f as Ue,b as ha,d as ya}from"./pool.7113183f.js";import{b as Sa}from"./new-add-or-create.eec8ce04.js";import{_ as Pa,a as Na,s as Ta}from"./poolFee.57f69546.js";import{D as u}from"./decimal.0e8aa3f1.js";import{fromCoin as m,toCoin as p,fromCoinAmount as n,toCoinAmount as s,maxPrice as v,minPrice as f,createPoolInfo as i,showFromCoinLock as Y,showToCoinLock as Z,amountLock as ke,fixedFromCoin as T,currentPriceReverse as Qe,currentPrice as se,initPrice as me,direction as k,createPoolFromCoin as ee,createPoolToCoin as oe,isFullRange as ne,resetData as _a,defaultMinPrice as ze,defaultMaxPrice as He}from"./create-pool-data.e6f9aa76.js";import{_ as Aa,a as qa}from"./icon-Add-Liquidity_2x.0acb06cb.js";import{_ as Ra}from"./icon-selected_3x.09e9a6f0.js";import"./lock.ff9fbc3a.js";/* empty css              */import"./tick.505fdad3.js";import"./token-warning.99a7f7f4.js";/* empty css              *//* empty css              */import"./refresh-icon.bad1449a.js";/* empty css              */import"./swap-setting.9bea4f58.js";/* empty css              */import"./status-block.b94dbcc5.js";import"./notifi.d53f51ce.js";import"./useWhale.a08eb724.js";import"./index.9ee8809e.js";const Ia=Yo({components:{NewLiquidityTile:ra,NewLiquidityDepositRatio:Jo},setup(e,t){const he=wa(),Ce=la(),V=$(()=>Ce),X=$(()=>V.value.chainName),j=$(()=>he),b=F(!1);F(),F(),F(),F(!1);const w=Zo(),{t:z,locale:ce}=va(),_=$(()=>X.value?na(X.value):{}),H=ua(),r=$(()=>H),ae=$(()=>V.value.theme),O=$(()=>j.value.assets&&m.value&&j.value.assets[m.value.address]?Ho(j.value.assets[m.value.address].balance,m.value.decimals):"0"),E=$(()=>j.value.assets&&p.value&&j.value.assets[p.value.address]?Ho(j.value.assets[p.value.address].balance,p.value.decimals):"0"),De=o=>{o==="fromCoin"?(T.value=!0,X.value==="Aptos"?n.value=Number(O.value)>0?m.value.symbol=="APT"?new u(Number(O.value)).sub(new u(.1)).lt(new u(0))?"0":new u(Number(O.value)).sub(new u(.1)).toString():String(O.value):"":n.value=Number(O.value)>0?m.value.symbol=="SUI"?new u(Number(O.value)).sub(new u(.05)).lt(new u(0))?"0":new u(Number(O.value)).sub(new u(.05)).toString():String(O.value):""):(T.value=!1,X.value==="Aptos"?s.value=Number(E.value)>0?p.value.symbol=="APT"?new u(Number(E.value)).sub(new u(.1)).lt(new u(0))?"0":new u(Number(E.value)).sub(new u(.1)).toString():String(E.value):"":s.value=Number(E.value)>0?p.value.symbol=="SUI"?new u(Number(E.value)).sub(new u(.05)).lt(new u(0))?"0":new u(Number(E.value)).sub(new u(.05)).toString():String(E.value):"")},Ve=o=>{o==="fromCoin"?(T.value=!0,n.value=Number(O.value)>0?Xo(new u(Number(O.value)).div(2).toString(),m.value.decimals).toString():""):(T.value=!1,s.value=Number(E.value)>0?Xo(new u(Number(E.value)).div(2).toString(),p.value.decimals).toString():"")};x(()=>[r.value.tokensObj,w.query],async([o])=>{if(o){const d=o;if(w&&w.query&&w.query.fromCoin&&(console.log("0410###deposite###watch###route.query.tokena####",w.query.fromCoin,d),w.query.fromCoin)){const g=await _.value.getTokenBySymbol(d,w.query.fromCoin);console.log(g,"###fromCoinValue"),m.value=g,ee.value=g}if(w&&w.query&&w.query.toCoin&&w.query.toCoin){const g=await _.value.getTokenBySymbol(d,w.query.toCoin);p.value=g,oe.value=g}}},{immediate:!0,deep:!0});const K=F("--"),ye=$(()=>V.value.slippage),je=F(),pe=async()=>{if(!f.value&&!v.value)return!1;if(!n.value&&!s.value&&!f.value&&!v.value)return;const o=i.value||{};if(Go(o))return;const{TickUtil:d,TickMath:g,getNearestTickByTick:h}=_.value,c=o==null?void 0:o.token_a.decimals,B=o==null?void 0:o.token_b.decimals;let A,P,y,S,R,I,L=o.current_tick_index,Q;if(console.log(o,"==>poolInfos"),o.token_a.address.toLowerCase()===m.value.address.toLowerCase()&&o.token_b.address.toLowerCase()===p.value.address.toLowerCase()?Q=!0:Q=!1,f.value==="0"&&v.value==="âˆž")y=d.getMinIndex(Number(o.tickSpacing)),S=d.getMaxIndex(Number(o.tickSpacing));else{console.log(Q,"===>directs1866"),Q?(A=Number(f.value),P=Number(v.value)):(A=new u(1).div(v.value).toString(),P=new u(1).div(f.value).toString()),console.log("0518###pre###directs###",Q),console.log("0518###pre###minPrice###",f.value),console.log("0518###pre###maxPrice###",v.value),console.log("0518###pre###poolInfos###",o),console.log("0518###pre###decimalsA###",c),console.log("0518###pre###decimalsB###",B),console.log(A,P,"min max1875"),console.log(f.value,v.value,"===>maxPrice.value");try{R=A==0?-443636:g.priceToTickIndex(new u(A),c,B)}catch{R=-443636}try{I=g.priceToTickIndex(new u(P),c,B)}catch{I=443636}console.log(R,I,"#####minTick maxTick"),y=h(R,Number(o.tickSpacing)),S=h(I,Number(o.tickSpacing))}if(console.log("0518###pre###currentTickIndex###",L,y,S),v.value!=="âˆž"&&y>=S){Y.value=!0,n.value="",Z.value=!0,s.value="";return}if(console.log(S,L,y,"1922"),v.value==="âˆž"||L>=y&&L<=S){Y.value=!1,Z.value=!1;let le;if(n.value||s.value){if(T.value){const we=new u(n.value).mul(Math.pow(10,m.value.decimals)).toString();le=new Ue(we)}else{const we=new u(s.value).mul(Math.pow(10,p.value.decimals)).toString();le=new Ue(we)}console.log(Q,"======>directs");const{liquidityAmount:G,tokenMaxA:J,tokenMaxB:te,tokenMaxAOrigin:Fe,tokenMaxBOrigin:Oe}=_.value.estLiquidityAndcoinAmountFromOneAmounts({tokenA:o.token_a,tokenB:o.token_b,lowerTick:y,upperTick:S,coinAmount:le,iscoinA:Q?T.value:!T.value,roundUp:!0,slippage:Number(ye.value)/100,curSqrtPrice:new Ue(o.current_sqrt_price)});je.value={liquidityAmount:G,tokenMaxA:J,tokenMaxB:te,tokenMaxAOrigin:Fe,tokenMaxBOrigin:Oe},console.log(te,J,"tokenMaxB===>tokenMaxA"),Q?T.value?s.value=Number(te)>0?te:"":n.value=Number(J)>0?J:"":T.value?s.value=J:n.value=te}}else L>S?(Y.value=!0,Z.value=!0):L<y?(Y.value=!0,Z.value=!0):(Y.value=!0,n.value="",Z.value=!0,s.value="")};x(()=>me.value,o=>{o&&pe()},{immediate:!0}),x(n,(o,d)=>{console.log(n,"===>fromCoinAmount"),o==""&&T.value&&(s.value=""),o&&T.value&&!b.value&&pe()}),x(s,(o,d)=>{console.log(o,"===>>>>newValsda"),o==""&&!T.value&&(n.value=""),o&&!T.value&&!b.value&&pe()}),x(()=>ne.value,o=>{pe()});const Ee=o=>{console.log(o,"e");const d=o.replace(/[^\d.]/g,""),g="$"+Qo(d);b.value=!0,K.value=g,o>0?C():(n.value="",s.value="")};x([f,v],([o,d])=>{console.log(o,d,"==>minPrice,maxPrice"),Number(o)!==0&&Number(d)!==0&&!b.value?pe():Number(o)!==0&&Number(d)!==0&&b.value&&C()},{immediate:!0});const Ge=()=>{const o=a.value&&a.value[m.value.address]&&a.value[m.value.address].price,d=a.value&&a.value[p.value.address]&&a.value[p.value.address].price;if(o&&d){const g=new u(n.value>0?n.value:0).mul(o),h=new u(s.value>0?s.value:0).mul(d),c=g.add(h).toNumber();K.value=c>0&&c<.01?"$<0.01":"$"+Qo(c,2)}else K.value="--"};x(()=>[n.value,s.value,b.value],([o,d,g])=>{(o||d)&&!g?Ge():(!o||!d)&&!g&&(K.value="--")},{immediate:!0});const a=$(()=>r.value.RATES),q=F(),C=async()=>{if(!f.value&&!v.value)return!1;if(!n.value&&!s.value&&!f.value&&!v.value)return;const o=i.value||{};if(Go(o))return;const{TickUtil:d,TickMath:g,getNearestTickByTick:h}=_.value,c=o==null?void 0:o.token_a.decimals,B=o==null?void 0:o.token_b.decimals;let A,P,y,S,R,I,L;if(o.token_a.address.toLowerCase()===m.value.address.toLowerCase()&&o.token_b.address.toLowerCase()===p.value.address.toLowerCase()?L=!0:L=!1,f.value==="0"&&v.value==="âˆž")y=d.getMinIndex(Number(o.tickSpacing)),S=d.getMaxIndex(Number(o.tickSpacing));else{L?(A=Number(f.value),P=Number(v.value)):(A=new u(1).div(v.value).toString(),P=new u(1).div(f.value).toString());try{R=A==0?-443636:g.priceToTickIndex(new u(A),c,B)}catch{R=-443636}try{I=g.priceToTickIndex(new u(P),c,B)}catch{I=443636}y=h(R,Number(o.tickSpacing)),S=h(I,Number(o.tickSpacing))}console.log(o.token_a,"poolInfos===>");const Q=a.value[o==null?void 0:o.token_a.address].price,le=a.value[o==null?void 0:o.token_b.address].price;console.log(y,S,"####tick_lower tick_upper 889");try{const{amountA:G,amountB:J,tokenAmountsInfo:te}=await _.value.estCoinAmountsFromTotalAmount({lowerTick:y,upperTick:S,decimalsA:c,decimalsB:B,curSqrtPrice:new Ue(o.current_sqrt_price),totalAmount:K.value,tokenPriceA:Q,tokenPriceB:le});console.log(G,J,"###estCoinAmountsFromTotalAmount 844"),q.value=te,o.needReverse?k.value?(n.value=G,s.value=J):(n.value=J,s.value=G):(n.value=G,s.value=J)}catch(G){console.log(G,"e===>")}},ue=$(()=>{var g,h,c,B,A,P,y,S;const o=(c=a.value[(h=(g=m)==null?void 0:g.value)==null?void 0:h.address])==null?void 0:c.price,d=(P=a.value[(A=(B=p)==null?void 0:B.value)==null?void 0:A.address])==null?void 0:P.price;return console.log(a.value,(S=(y=m)==null?void 0:y.value)==null?void 0:S.address,"===>fromCoin?.value?.address"),!!(o&&d)}),U=()=>{t.emit("toggle")},W=F(!1),ve=$(()=>{var o;return!m.value||!p.value?z("modal.selectTokenModalTitle"):!((o=w.query)!=null&&o.fee)&&ta[X.value].hasCreatePool?"Select fee tier":!Number(n.value)&&!Number(s.value)?z("button.enterAmount"):Number(n.value)>Number(O.value)?z("button.insufficientBalance",{name:m.value.symbol}):Number(s.value)>Number(E.value)?z("button.insufficientBalance",{name:p.value.symbol}):v.value!=="âˆž"&&Number(f.value)>=Number(v.value)?z("newAdd.invalidRange"):z("newAdd.preview")}),Re=o=>{const d=new RegExp("[^\\d-]*(\\d*(?:\\.\\d{0,2})?).*$");o.target.value=o.target.value.replace(d,"$1")},Ie=$(()=>{var o;return!n.value&&!s.value?(console.log("addLiquidityBtnDisabled11111"),!0):Number(n.value)>Number(O.value)||Number(s.value)>Number(E.value)?(console.log("addLiquidityBtnDisabled22222"),!0):ve.value!==z("newAdd.preview")?!0:!i.value&&!((o=i.value)!=null&&o.currentPrice)?(console.log("addLiquidityBtnDisabled55555"),!0):!!(Number(n.value)<=0&&Number(s.value)<=0||Y.value||Z.value)}),{setTransactionTxid:Se,setTransactionDesc:Le,setIsShowWaiting:fe,setIsShowSuccess:Pe,setIsShowRejected:Ne,setPositiomNum:Be}=Ce,$e=()=>{X.value=="Sui"&&Me()},Te=F(!1),Me=async()=>{var Q,le,G,J,te,Fe,Oe,we,Je,Ke,Ye,Ze,xe,eo,oo,ao,lo,to,no,uo,so,ro,io,co,vo,mo,po,fo,go,ko,bo,Co,wo,ho,yo,So,Po,No,To,_o,Ao,qo,Ro,Io,Lo,Bo,$o,Mo,Fo,Oo,Uo,Do,Vo,jo,Eo,Wo;W.value=!1,console.log("åˆ›å»ºsuiæ± å­");let o=!1;_.value.getIsSortedSymbols(ee.value.address,oe.value.address)&&(o=!0),Se("");const d=Y.value?"":`${n.value} ${(Q=m.value)==null?void 0:Q.symbol}`,g=Z.value?"":`${s.value} ${(le=p.value)==null?void 0:le.symbol}`;console.log("0424###createPoolFromCoin###",ee.value),console.log("0424###createPoolToCoin###",oe.value),console.log("0424###needReverse###",o),console.log("0424###createPoolInfo?.value?.needReverse###",(J=(G=i)==null?void 0:G.value)==null?void 0:J.needReverse),Le(z("tips.increaseLiquiditySuccess",{from:!o&&!((Fe=(te=i)==null?void 0:te.value)!=null&&Fe.needReverse)||o&&((we=(Oe=i)==null?void 0:Oe.value)!=null&&we.needReverse)?d:g,and:!Y.value&&!Z.value?"and":"",to:!o&&!((Ke=(Je=i)==null?void 0:Je.value)!=null&&Ke.needReverse)||o&&((Ze=(Ye=i)==null?void 0:Ye.value)!=null&&Ze.needReverse)?g:d})),fe(!0);let h="",c="",B="",A="",P="",y="",S=0,R=0,I=!1,L;if(o||(eo=(xe=i)==null?void 0:xe.value)!=null&&eo.needReverse){const de=o&&!((ao=(oo=i)==null?void 0:oo.value)!=null&&ao.needReverse);h=de?(ro=(so=(uo=i)==null?void 0:uo.value)==null?void 0:so.token_b)==null?void 0:ro.address:(no=(to=(lo=i)==null?void 0:lo.value)==null?void 0:to.token_a)==null?void 0:no.address,c=de?(fo=(po=(mo=i)==null?void 0:mo.value)==null?void 0:po.token_a)==null?void 0:fo.address:(vo=(co=(io=i)==null?void 0:io.value)==null?void 0:co.token_b)==null?void 0:vo.address,B=de?(ho=(wo=(Co=i)==null?void 0:Co.value)==null?void 0:wo.token_b)==null?void 0:ho.decimals:(bo=(ko=(go=i)==null?void 0:go.value)==null?void 0:ko.token_a)==null?void 0:bo.decimals,A=de?(_o=(To=(No=i)==null?void 0:No.value)==null?void 0:To.token_a)==null?void 0:_o.decimals:(Po=(So=(yo=i)==null?void 0:yo.value)==null?void 0:So.token_b)==null?void 0:Po.decimals,(qo=(Ao=i)==null?void 0:Ao.value)!=null&&qo.needReverse?(P=k.value?n.value:s.value,y=k.value?s.value:n.value,S=k.value?Number(f.value):1/Number(v.value),R=k.value?Number(v.value):1/Number(f.value),I=k.value?T.value:!T.value,L=k.value?se.value:1/Number(se.value)):(P=k.value?s.value:n.value,y=k.value?n.value:s.value,S=k.value?1/Number(v.value):Number(f.value),R=k.value?1/Number(f.value):Number(v.value),I=k.value?!T.value:T.value,L=k.value?1/Number(se.value):se.value)}else h=(Lo=(Io=(Ro=i)==null?void 0:Ro.value)==null?void 0:Io.token_a)==null?void 0:Lo.address,c=(Mo=($o=(Bo=i)==null?void 0:Bo.value)==null?void 0:$o.token_b)==null?void 0:Mo.address,B=(Uo=(Oo=(Fo=i)==null?void 0:Fo.value)==null?void 0:Oo.token_a)==null?void 0:Uo.decimals,A=(jo=(Vo=(Do=i)==null?void 0:Do.value)==null?void 0:Vo.token_b)==null?void 0:jo.decimals,P=k.value?n.value:s.value,y=k.value?s.value:n.value,S=k.value?Number(f.value):1/Number(v.value),R=k.value?Number(v.value):1/Number(f.value),I=k.value?T.value:!T.value,L=k.value?se.value:1/Number(se.value);try{console.log("0501###toCreatePool###params###",{coinTypeA:h,coinTypeB:c,decimalsA:B,decimalsB:A,amountA:P,amountB:y,minPrice:S,maxPrice:R,fix_amount_a:I,tick_spacing:Number(i.value.tickSpacing),slippage:Number(ye.value)/100,price:L});const de=await _.value.getCreatPoolTransactionPayload({coinTypeA:h,coinTypeB:c,decimalsA:B,decimalsB:A,amountA:P,amountB:y,minPrice:f.value=="0"&&v.value=="âˆž"?"0":S,maxPrice:f.value=="0"&&v.value=="âˆž"?"âˆž":R,fix_amount_a:I,tick_spacing:Number(i.value.tickSpacing),slippage:Number(ye.value)/100,price:L}),sa=await j.value.currentWallet.signAndExecuteTransactionBlock(de),_e=_.value.handleTx(sa);if(_e&&_e.hash){Se(_e.hash),fe(!1),Pe(!0);const We={title:"Created pool",desc:"Pool created successfully ",hash:_e.hash,tit:"Pool Created",icon:"icon-icon-Position-Created",tokenInfo:{tokena:`${(Eo=m.value)==null?void 0:Eo.address}`,numa:Y.value?"":`- ${n.value}`,logoa:r.value.tokensObj&&m.value&&m.value.address&&r.value.tokensObj[m.value.address]&&r.value.tokensObj[m.value.address].logoURI,tokenb:`${(Wo=p.value)==null?void 0:Wo.address}`,numb:Z.value?"":`- ${s.value}`,logob:r.value.tokensObj&&p.value&&p.value.address&&r.value.tokensObj[p.value.address]&&r.value.tokensObj[p.value.address].logoURI},text:"Pool created successfully"};X.value!=="Aptos"&&(We.res=_e.res),_.value.showTransitionPending(We),(await _.value.watchTransaction(We,!0)).status&&(Pe(!1),Te.value=!0,setTimeout(()=>{H.setPoolConfigList(X.value,V.value.filterCoinsObj),_.value.getAccount(j.value.address)},1e3)),Be()}else fe(!1),Ne(!0);n.value="",s.value=""}catch(de){console.log("0407###createPool###error##",de),W.value=!1,H.setPoolConfigList(X.value,V.value.filterCoinsObj),n.value="",s.value="",fe(!1),Ne(!0)}};return x(()=>i.value,o=>{console.log(o,"===>newVal")},{immediate:!0}),{amountLock:ke,wallet:j,inputChange:Re,fromCoinAmount:n,toCoinAmount:s,fromCoin:m,toCoin:p,maxBtnSelect:De,halfBtnSelect:Ve,showFromCoinLock:Y,showToCoinLock:Z,fromCoinBlance:O,toCoinBlance:E,fixedFromCoin:T,isInputTotalAmount:b,toggle:U,theme:ae,liquidityTotalAmount:K,createPoolInfo:i,minPrice:f,maxPrice:v,currentPriceReverse:Qe,currentPrice:se,onInput:Ee,initPrice:me,isShowtotalAmount:ue,direction:k,isShowLiquidityModal:W,createPoolBtnText:ve,createPoolBtnDisabled:Ie,toCreatePool:$e,isCreateSuccess:Te}}});const La=e=>(oa("data-v-786df486"),e=e(),aa(),e),Ba={class:"create-pool-right"},$a={class:"card-container"},Ma={key:0,class:"lock"},Fa={class:"card-item"},Oa={class:"card-item"},Ua={key:0,class:"total-amount"},Da=La(()=>l("span",null,"Total Amount",-1));function Va(e,t,he,Ce,V,X){const j=ea("NewLiquidityTile"),b=Ko,w=ia,z=Jo,ce=Sa,_=da,H=Pa;return N(),D("div",Ba,[re(j),l("div",$a,[e.amountLock||e.showFromCoinLock||e.showToCoinLock?(N(),D("div",Ma,[re(b)])):M("",!0),l("div",Fa,[re(w,{modelValue:e.fromCoinAmount,"onUpdate:modelValue":t[0]||(t[0]=r=>e.fromCoinAmount=r),"input-value":e.fromCoinAmount,"coin-symbol":e.fromCoin?e.fromCoin.symbol:null,"coin-name":e.fromCoin?e.fromCoin.name:null,balance:e.fromCoinBlance,"coin-icon":e.fromCoin?e.fromCoin.logoURI:"",address:e.fromCoin?e.fromCoin.address:"","swap-direct":"From","import-page":"deposit","has-arrow":!1,onOnMax:t[1]||(t[1]=r=>e.maxBtnSelect("fromCoin")),onOnHalf:t[2]||(t[2]=r=>e.halfBtnSelect("fromCoin")),onOnInput:t[3]||(t[3]=r=>{e.fromCoinAmount=r,e.fixedFromCoin=!0,e.isInputTotalAmount=!1})},null,8,["modelValue","input-value","coin-symbol","coin-name","balance","coin-icon","address"])]),l("div",Oa,[re(w,{modelValue:e.toCoinAmount,"onUpdate:modelValue":t[4]||(t[4]=r=>e.toCoinAmount=r),"input-value":e.toCoinAmount,"coin-symbol":e.toCoin?e.toCoin.symbol:null,"coin-name":e.toCoin?e.toCoin.name:null,balance:e.toCoinBlance,"swap-direct":"To","coin-icon":e.toCoin?e.toCoin.logoURI:"",address:e.toCoin?e.toCoin.address:"","import-page":"deposit","has-arrow":!1,onOnMax:t[5]||(t[5]=r=>e.maxBtnSelect("toCoin")),onOnHalf:t[6]||(t[6]=r=>e.halfBtnSelect("toCoin")),onOnInput:t[7]||(t[7]=r=>{e.toCoinAmount=r,e.fixedFromCoin=!1,e.isInputTotalAmount=!1})},null,8,["modelValue","input-value","coin-symbol","coin-name","balance","coin-icon","address"])]),e.fromCoin&&e.toCoin&&!e.showToCoinLock&&!e.showFromCoinLock&&e.theme=="default"?(N(),D("img",{key:1,class:"add",src:Aa,alt:"",onClick:t[8]||(t[8]=(...r)=>e.toggle&&e.toggle(...r))})):M("",!0),e.fromCoin&&e.toCoin&&!e.showToCoinLock&&!e.showFromCoinLock&&e.theme!=="default"?(N(),D("img",{key:2,class:"add",src:qa,alt:"",onClick:t[9]||(t[9]=(...r)=>e.toggle&&e.toggle(...r))})):M("",!0)]),e.isShowtotalAmount?(N(),D("div",Ua,[Da,l("span",null,qe(e.liquidityTotalAmount)+" ",1)])):M("",!0),e.initPrice?(N(),Ae(z,{key:1,"from-coin":e.fromCoin,"to-coin":e.toCoin,"from-coin-amount":e.fromCoinAmount,"to-coin-amount":e.toCoinAmount,"fixed-from-coin":e.fixedFromCoin,"is-input-total-amount":e.isInputTotalAmount,"create-pool-info":e.createPoolInfo,"min-price":e.minPrice,"max-price":e.maxPrice,"current-price-tab":"custom","current-price":e.currentPrice,"current-price-reverse":e.currentPriceReverse},null,8,["from-coin","to-coin","from-coin-amount","to-coin-amount","fixed-from-coin","is-input-total-amount","create-pool-info","min-price","max-price","current-price","current-price-reverse"])):M("",!0),e.isShowLiquidityModal?(N(),Ae(ce,{key:2,"pool-info":e.createPoolInfo,title:e.$t("newAdd.preview"),"from-coin-amount":e.fromCoinAmount,"to-coin-amount":e.toCoinAmount,"from-coin":e.fromCoin,"to-coin":e.toCoin,"fixed-from-coin":e.fixedFromCoin,"current-price":e.currentPrice,"current-price-reverse":e.currentPriceReverse,"current-price-tab":"custom","min-price":e.minPrice,"max-price":e.maxPrice,"show-from-coin-lock":e.showFromCoinLock,"show-to-coin-lock":e.showToCoinLock,"current-direct":e.direction,"is-increase":!1,"is-create":!0,onCreatePool:e.toCreatePool,onOnClose:t[10]||(t[10]=r=>e.isShowLiquidityModal=!1)},null,8,["pool-info","title","from-coin-amount","to-coin-amount","from-coin","to-coin","fixed-from-coin","current-price","current-price-reverse","min-price","max-price","show-from-coin-lock","show-to-coin-lock","current-direct","onCreatePool"])):M("",!0),e.wallet.connected?(N(),Ae(_,{key:4,class:"add-liquidity-btn",disabled:e.wallet.connected?e.createPoolBtnDisabled:!1,onClick:t[12]||(t[12]=r=>e.isShowLiquidityModal=!0)},{default:zo(()=>[be(qe(e.createPoolBtnText),1)]),_:1},8,["disabled"])):(N(),Ae(_,{key:3,class:"add-liquidity-btn",onClick:t[11]||(t[11]=r=>e.wallet.setIsShowWalletModal(!0))},{default:zo(()=>[be(qe(e.$t("button.connectWallet")),1)]),_:1})),e.isCreateSuccess?(N(),Ae(H,{key:5,onOnClose:t[13]||(t[13]=r=>e.isCreateSuccess=!1)})):M("",!0)])}const ja=xo(Ia,[["render",Va],["__scopeId","data-v-786df486"]]),Ea=Yo({components:{CreatePoolRight:ja},setup(){const e=F(!0),t=F(!0),he=F(!0),Ce=F(!1),V=F("1"),X=F(!0),j=F(""),b=Zo(),w=ma(),z=la(),ce=$(()=>z),_=ua(),H=$(()=>_),r=$(()=>ce.value.chainName),ae=$(()=>r.value?na(r.value):{}),O=F("");x(()=>[w,H.value.tokensObj],async([a,q])=>{var C,ue,U;((C=w==null?void 0:w.currentRoute)==null?void 0:C.value.name)=="liquidity-creat-pool"&&q&&(m.value=H.value.tokensObj[b.query.fromCoin]||await ae.value.getTokenBySymbol(q,b.query.fromCoin),p.value=H.value.tokensObj[b.query.toCoin]||await ae.value.getTokenBySymbol(q,b.query.toCoin),O.value=b.query.fee!=="null"&&b.query.fee?b.query.fee:""),((ue=w==null?void 0:w.currentRoute)==null?void 0:ue.value.name)=="liquidity-creat-pool"&&((U=b==null?void 0:b.query)!=null&&U.fee)&&(me.value="",n.value="",s.value="",ne.value=!0)},{immediate:!0,deep:!0}),x(()=>[m.value,p.value,me.value,O.value,f.value,v.value,n.value,s.value],([a,q,C,ue,U,W,ve])=>{!a||!q?(V.value="1",e.value=!0,t.value=!0,ke.value=!0):ue?C?!U||!W?(V.value="4",e.value=!1,t.value=!1,ke.value=!0):ve||(V.value="5",e.value=!1,t.value=!1,ke.value=!1):(V.value="3",e.value=!1,t.value=!0,ke.value=!0):(V.value="2",e.value=!0,t.value=!0,ke.value=!0)},{immediate:!0}),x(()=>V.value,a=>{Number(a)<5&&(n.value="",s.value="")});const E=a=>{me.value=a},De=a=>{var q;return(a==null?void 0:a.logoURI)||(a==null?void 0:a.logo_url)||((q=H.value.tokensObj[a==null?void 0:a.address])==null?void 0:q.logo_url)||(ce.value.theme==="default"?Xe("/image/coins/unknown.png"):Xe("/image/coins/sui-unknown.png"))},Ve=a=>{switch(a){case"1":return{top:"10%"};case"2":return{top:"29%"};case"3":return{top:"48%"};case"4":return{top:"67%"};case"5":return{top:"87%"}}};$(()=>ta[r.value].hasCreatePool);const K=async a=>{var Re,Ie,Se,Le,fe,Pe,Ne,Be,$e,Te,Me,o,d,g;console.log("#####emitCurrentPrice",a),a?(me.value=a,se.value=a,Qe.value=new u(1).div(new u(a)).toString()):(me.value="",se.value="",Qe.value="");let q,C;const ue=H.value.poolConfigList;for(let h=0;h<ue.length;h++){const c=ue[h];if(c.token_a.address.toUpperCase()===((Se=(Ie=(Re=ee)==null?void 0:Re.value)==null?void 0:Ie.address)==null?void 0:Se.toUpperCase())&&c.token_b.address.toUpperCase()===((Pe=(fe=(Le=oe)==null?void 0:Le.value)==null?void 0:fe.address)==null?void 0:Pe.toUpperCase())){q=c.needReverse,C=c;break}else if(c.token_b.address.toUpperCase()===(($e=(Be=(Ne=ee)==null?void 0:Ne.value)==null?void 0:Be.address)==null?void 0:$e.toUpperCase())&&c.token_a.address.toUpperCase()===((o=(Me=(Te=oe)==null?void 0:Te.value)==null?void 0:Me.address)==null?void 0:o.toUpperCase())){q=c.needReverse,C=c;break}}let U=!1;await ae.value.getIsSortedSymbols((d=ee.value)==null?void 0:d.address,(g=oe.value)==null?void 0:g.address)&&(U=!0);let W;console.log(U,"###changeCurrentPrice createPoolNeedReverse 289"),console.log(k.value,"####changeCurrentPrice direction.value 290"),U&&k.value?W=!0:U&&!k.value||!U&&k.value?W=!1:W=!0,console.log(W,"###changeCurrentPrice newDirect 298");const ve=r.value=="Aptos"?Na:Ta;if(m.value&&p.value&&a){const h=C?C==null?void 0:C.token_a.decimals:U?oe.value.decimals:ee.value.decimals,c=C?C==null?void 0:C.token_b.decimals:U?ee.value.decimals:oe.value.decimals,B=a&&ae.value.TickMath.priceToSqrtPriceX64(W?new u(1/a):new u(a),h,c);console.log(B.toString(),"===>current_sqrt_price");const A=a&&ae.value.TickMath.priceToSqrtPriceX64(new u(1).div(a),m.value.decimals,p.value.decimals);console.log(!W,a,"===>!newDirect"),console.log(h,c,"decimalsA,decimalsB===>");const P=ae.value.TickMath.priceToTickIndex(W?new u(1).div(a):new u(a),h,c);console.log(P,"==>currentTickIndex");const y=P-ve[b.query.fee]*5,S=P+ve[b.query.fee]*5,R=ae.value.TickMath.tickIndexToPrice(y,h,c).toString(),I=ae.value.TickMath.tickIndexToPrice(S,h,c).toString();ne.value?(f.value="0",v.value="âˆž"):W?(f.value=String(1/I),v.value=String(1/R),ze.value=String(1/I),He.value=String(1/R)):(f.value=R,v.value=I,ze.value=R,He.value=I),console.log("0518###c####createPoolFromCoin.value####",ee.value),console.log("0518###c####createPoolToCoin.value####",oe.value),console.log("0518###c####createPoolNeedReverse####",U);const L={token_a:C?C.token_a:U?oe.value:ee.value,token_b:C?C.token_b:U?ee.value:oe.value,isCreate:!0,tickSpacing:ve[b.query.fee],currentPrice:a,current_sqrt_price:B,tick_lower:y,tick_upper:S,current_tick_index:P,currentPriceReverse:ha(String(1/a),6),reverse_current_sqrt_price:A,needReverse:q,fee:b.query.fee};i.value=L,console.log("0518###c####poolInfos####",L)}else i.value=null,f.value="",v.value=""},ye=()=>{ne.value=!ne.value,K(i.value.currentPrice)},je=a=>{console.log(a,"####0731 priceRangeChangeMin"),ne.value?(ne.value=!1,K(i.value.currentPrice)):f.value=a},pe=a=>{ne.value?(ne.value=!1,K(i.value.currentPrice)):a=="0"?v.value="âˆž":v.value=a},Ee=()=>{var q,C;console.log(i.value,"==>createPoolInfo.value"),k.value=!k.value;const a=m.value;m.value=p.value,p.value=a,i.value&&(K(ya(new u(1).div(i.value.currentPrice).toString(),(C=(q=p)==null?void 0:q.value)==null?void 0:C.decimals)),T.value?n.value=s.value:s.value=n.value),console.log(k.value,"####toggle direction.value")};return pa(()=>{_a()}),{amountLock:ke,currentStep:V,sliderStyle:Ve,coinAmount:Ce,pricerange:j,fromCoin:m,toCoin:p,fee:O,direct:X,getCoinIcon:De,isSelectFullRange:he,onInput:E,store:ce,initPrice:me,inputPriceLock:e,specifyPriceLock:t,changeCurrentPrice:K,minPrice:f,maxPrice:v,defaultMinPrice:ze,defaultMaxPrice:He,clickFullRange:ye,createPoolInfo:i,isFullRange:ne,priceRangeChangeMin:je,priceRangeChangeMax:pe,fromCoinAmount:n,toggle:Ee,showFromCoinLock:Y,showToCoinLock:Z,inputChange:a=>{const q=k.value?p.value.decimals:m.value.decimals,C=new RegExp(`[^\\d-]*(\\d*(?:\\.\\d{0,${q}})?).*$`);a.target.value=a.target.value.replace(C,"$1")}}}});const ie=e=>(oa("data-v-b18295ef"),e=e(),aa(),e),Wa={class:"creat-pool-container"},za={class:"creat-pool-left"},Ha={class:"progress"},Xa=ie(()=>l("div",{class:"slider-ratio-content"},null,-1)),Qa=[Xa],Ga={class:"progress-text"},Ja={key:0},Ka={key:0},Ya={key:0},Za={key:0},xa={key:0},el={class:"creat-pool-center"},ol={class:"title"},al=ie(()=>l("div",{class:"left"},"Set Initial Price",-1)),ll={class:"right"},tl={key:0,class:"token-box"},nl=ie(()=>l("div",null,[l("svg",{class:"icon icon-up","aria-hidden":"true"},[l("use",{"xlink:href":"#icon-exchange_up1"})])],-1)),ul=ie(()=>l("div",null,[l("svg",{class:"icon icon-down","aria-hidden":"true"},[l("use",{"xlink:href":"#icon-exchange_down1"})])],-1)),sl=[nl,ul],rl={class:"content top-content"},il=ie(()=>l("div",{class:"top"},[l("span",null,"ðŸ’¡"),l("span",null,"Please set an initial price for this new pool to start.")],-1)),cl={class:"bottom"},vl={class:"input-div"},dl={key:0,class:"lock"},ml={class:"title"},pl=ie(()=>l("div",{class:"left"},"Set Price Range",-1)),fl={class:"right"},gl={key:0,src:Ra},kl=ie(()=>l("span",null,"Full Range",-1)),bl={class:"content bottom-content"},Cl=ie(()=>l("span",null,"ðŸ’¡",-1)),wl=ie(()=>l("span",null,"Please specify a price range that you want to provide your liquidity within.",-1)),hl=[Cl,wl],yl={class:"bottom"},Sl={class:"set-price-box"},Pl={key:0,class:"lock"},Nl={key:1,class:"create-pool-warning"},Tl={key:2,class:"position-tips"},_l=["src"],Al={class:"error"},ql={class:"creat-pool-right-container"};function Rl(e,t,he,Ce,V,X){var _,H;const j=Ca,b=Ko,w=ca,z=ea("CreatePoolRight"),ce=fa("image");return N(),D("div",Wa,[l("div",za,[l("div",Ha,[l("div",{class:"slider-ratio",style:ga(e.sliderStyle(e.currentStep))},Qa,4)]),l("div",Ga,[l("div",{class:ge(["row",Number(e.currentStep)>=1?"":"color-text"])},[e.currentStep>=1&&e.fromCoin&&e.toCoin?(N(),D("span",Ja,"âœ“")):M("",!0),be(" Select Tokens ")],2),l("div",{class:ge(["row",Number(e.currentStep)>=2?"":"color-text"])},[e.currentStep>=2&&e.fee?(N(),D("span",Ka,"âœ“")):M("",!0),be(" Select Fee Tier ")],2),l("div",{class:ge(["row",Number(e.currentStep)>=3?"":"color-text"])},[e.currentStep>=3&&e.initPrice?(N(),D("span",Ya,"âœ“")):M("",!0),be(" Set Initial Price ")],2),l("div",{class:ge(["row",Number(e.currentStep)>=4?"":"color-text"])},[e.currentStep>=4&&e.minPrice&&e.maxPrice?(N(),D("span",Za,"âœ“")):M("",!0),be(" Select Price Range ")],2),l("div",{class:ge(["row",Number(e.currentStep)>=5?"":"color-text"])},[e.currentStep>=5&&e.fromCoinAmount?(N(),D("span",xa,"âœ“")):M("",!0),be(" Confirm Liquidity ")],2)])]),l("div",el,[l("div",ol,[al,l("div",ll,[e.fromCoin&&e.toCoin?(N(),D("div",tl,[ka(l("img",null,null,512),[[ce,(_=e.fromCoin)==null?void 0:_.logo_url]]),l("span",null,qe((H=e.fromCoin)==null?void 0:H.symbol),1),l("div",{class:"icon-change",onClick:t[0]||(t[0]=(...r)=>e.toggle&&e.toggle(...r))},sl)])):M("",!0)])]),l("div",rl,[il,l("div",cl,[l("div",vl,[re(j,{value:e.initPrice,type:"text",placeholder:"0.0",onChange:e.inputChange,onInput:t[1]||(t[1]=r=>e.changeCurrentPrice(r.target.value))},null,8,["value","onChange"])]),e.inputPriceLock?(N(),D("div",dl,[re(b)])):M("",!0)])]),l("div",ml,[pl,l("div",fl,[l("div",{class:ge(["radio",e.isFullRange?"active-radio":""]),onClick:t[2]||(t[2]=(...r)=>e.clickFullRange&&e.clickFullRange(...r))},[e.isFullRange?(N(),D("img",gl)):M("",!0)],2),kl])]),l("div",bl,[l("div",{class:ge(["top",e.specifyPriceLock?"":"no-border"])},hl,2),l("div",yl,[l("div",Sl,[re(w,{min:e.minPrice,max:e.maxPrice,"from-coin":e.fromCoin,"to-coin":e.toCoin,direct:e.direct,"default-min-price":e.defaultMinPrice,"default-max-price":e.defaultMaxPrice,"pool-info":e.createPoolInfo,loading:!1,"current-price-tab":"custom",onOnChangeMinPrice:e.priceRangeChangeMin,onOnChangeMaxPrice:e.priceRangeChangeMax},null,8,["min","max","from-coin","to-coin","direct","default-min-price","default-max-price","pool-info","onOnChangeMinPrice","onOnChangeMaxPrice"])]),e.specifyPriceLock?(N(),D("div",Pl,[re(b)])):M("",!0),e.currentStep>=4&&(e.showFromCoinLock||e.showToCoinLock)&&Number(e.maxPrice)>Number(e.minPrice)?(N(),D("div",Nl," To create a new pool, the initial price you set must be within your price range. ")):M("",!0),e.currentStep>=4&&Number(e.minPrice)>Number(e.maxPrice)?(N(),D("div",Tl,[l("img",{src:("importIcon"in e?e.importIcon:ba(Xe))("/image/icon-tips-error@2x.png"),alt:""},null,8,_l),l("p",Al,qe(e.$t("tips.positionError")),1)])):M("",!0)])])]),l("div",ql,[re(z,{"create-pool-info":e.createPoolInfo,onToggle:e.toggle},null,8,["create-pool-info","onToggle"])])])}const tt=xo(Ea,[["render",Rl],["__scopeId","data-v-b18295ef"]]);export{tt as default};
