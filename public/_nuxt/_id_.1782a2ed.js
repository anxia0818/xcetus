import{_ as Te}from"./new-position-title.68886d9c.js";import{_ as le}from"./token-warning.7651177d.js";import{_ as fe}from"./auto-pool-apy-tips.e9ff18d5.js";import{u as Mo,a as M,g as xo,c as No,d as se,s as vo,p as me,b as ye,e as Y,T as Ho,f as Re}from"./pool.1338590d.js";import{u as ie,a as de}from"./sha256.caba64f7.js";import{u as Lo,a as _e}from"./autoPool.ac81b874.js";import{i as Yo}from"./import-icon.de3e6c66.js";import{a as Do,l as f,m as Uo,r as w,q as go,e as Fo,s as ve,o as _,f as O,h as e,t as Po,i as E,v as d,j as te,x as io,u as D,p as Go,k as Zo,y as ce,z as be,A as he,C as re,c as _o,w as zo,B as ge,D as qe,b as Be,F as Oe,E as Ne,G as Me,H as pe}from"./entry.af38826c.js";import{_ as ke}from"./assets-card.627680cf.js";import{_ as we}from"./coin-lock.deddfce6.js";import{_ as Ie,a as $e}from"./auto-pool-remove-modal.b8fbd540.js";import{D as a}from"./decimal.0e8aa3f1.js";/* empty css              *//* empty css              */import"./decimal.633e31ee.js";import{V as ue}from"./index.6d7ab101.js";import"./back.32084ea4.js";import"./swap-setting.37be86f4.js";/* empty css              *//* empty css              *//* empty css              *//* empty css              */import"./img-lock_2x.a28135f4.js";import"./img-lock_2x.e5ccf890.js";const Le=Do({components:{AutoPoolApyTips:fe},setup(){const o=ie(),t=f(()=>o),G=Mo(),W=f(()=>G),j=Lo(),I=f(()=>j),C=f(()=>t.value.theme),b=Uo(),r=w();go(()=>[I.value.positionInfoObj,b.params.id],([i,u])=>{i&&!No(i)&&u&&(r.value=i[u],console.log(r.value,"##positionInfo.value"))},{immediate:!0,deep:!0});const m=f(()=>{var i;return(i=r.value)==null?void 0:i.needReverse}),l=i=>{var u;return(i==null?void 0:i.logoURI)||(i==null?void 0:i.logo_url)||((u=W.value.tokensObj[i==null?void 0:i.address])==null?void 0:u.logo_url)||(C.value==="default"?Yo("/image/coins/unknown.png"):Yo("/image/coins/sui-unknown.png"))},n=f(()=>{var i,u;return I.value.apyObj&&((u=I.value.apyObj[(i=r.value)==null?void 0:i.id])==null?void 0:u.tvl)||"--"}),$=f(()=>{var i,u;return I.value.apyObj&&((u=I.value.apyObj[(i=r.value)==null?void 0:i.id])==null?void 0:u.apr)||"--"});return{positionInfo:r,needReverse:m,getCoinIcon:l,tvl:n,apy:$,addCommom:M,getExplorerUrl:xo}}});const ko=o=>(Go("data-v-c5a991ac"),o=o(),Zo(),o),De={class:"auto-pool-v2-info"},Ue={class:"pool-info"},Fe={class:"left"},Ve={class:"coin-a"},Ee={alt:""},We={class:"coin-b"},je={alt:""},Xe={class:"position-name"},He={key:0,class:"pool-fee"},ze=ko(()=>e("span",null,"Fee tier",-1)),Ye={class:"vault-address"},Ge=ko(()=>e("span",null,"Vault Address",-1)),Ze=["href"],Je=ko(()=>e("svg",{class:"icon","aria-hidden":"true"},[e("use",{"xlink:href":"#icon-icon-link"})],-1)),Ke=[Je],Qe={class:"pool-address"},xe=ko(()=>e("span",null,"Pool Address",-1)),on=["href"],en=ko(()=>e("svg",{class:"icon","aria-hidden":"true"},[e("use",{"xlink:href":"#icon-icon-link"})],-1)),nn=[en],tn={class:"apy-and-tvl"},sn={class:"apy"},ln=ko(()=>e("div",{class:"apy-title"},"APY",-1)),an={class:"apy-text"},un={class:"tvl"},rn=ko(()=>e("div",{class:"tvl-title"},"TVL",-1)),dn={class:"tvl-text"},vn={class:"pool-info h5-pool-info"},mn={class:"left"},cn={class:"coin-a"},pn={alt:""},fn={class:"coin-b"},yn={alt:""},_n={class:"position-name"},bn={key:0,class:"pool-fee"},hn=ko(()=>e("span",null,"Fee tier",-1)),gn={class:"left"},kn={class:"vault-address"},wn=ko(()=>e("span",null,"Vault Address",-1)),In=["href"],$n=ko(()=>e("svg",{class:"icon","aria-hidden":"true"},[e("use",{"xlink:href":"#icon-icon-link"})],-1)),Cn=[$n],An={class:"pool-address"},Sn=ko(()=>e("span",null,"Pool Address",-1)),Pn=["href"],Tn=ko(()=>e("svg",{class:"icon","aria-hidden":"true"},[e("use",{"xlink:href":"#icon-icon-link"})],-1)),Rn=[Tn],qn={class:"apy-and-tvl"},Bn={class:"apy"},On=ko(()=>e("div",{class:"apy-title"},"APY",-1)),Nn={class:"apy-text"},Mn={class:"tvl"},Ln=ko(()=>e("div",{class:"tvl-title"},"TVL",-1)),Dn={class:"tvl-text"};function Un(o,t,G,W,j,I){var m,l,n,$,i,u,y,v,T,A,R,X,h,p,g,U,H,K,q,k,Q,mo,no,to,z,so,co,L,ao,Vo,wo,Eo,To,Io,$o,Ro,qo,Wo,jo,lo,po,Ko,c,S,Z,F,uo,x;const C=le,b=fe,r=ve("image");return _(),O("div",De,[e("div",Ue,[e("div",Fe,[e("div",Ve,[Po(e("img",Ee,null,512),[[r,o.needReverse?o.getCoinIcon((l=o.positionInfo)==null?void 0:l.token_b):o.getCoinIcon((m=o.positionInfo)==null?void 0:m.token_a)]]),E(C,{address:o.needReverse?(u=(i=o.positionInfo)==null?void 0:i.token_b)==null?void 0:u.address:($=(n=o.positionInfo)==null?void 0:n.token_a)==null?void 0:$.address,"style-params":{width:"12px",height:"12px",left:"18px",bottom:"4px"}},null,8,["address"])]),e("div",We,[Po(e("img",je,null,512),[[r,o.needReverse?o.getCoinIcon((v=o.positionInfo)==null?void 0:v.token_a):o.getCoinIcon((y=o.positionInfo)==null?void 0:y.token_b)]]),E(C,{address:o.needReverse?(X=(R=o.positionInfo)==null?void 0:R.token_a)==null?void 0:X.address:(A=(T=o.positionInfo)==null?void 0:T.token_b)==null?void 0:A.address,"style-params":{width:"12px",height:"12px",left:"18px",bottom:"4px"}},null,8,["address"])]),e("div",Xe,d(o.needReverse?(p=(h=o.positionInfo)==null?void 0:h.token_b)==null?void 0:p.symbol:(U=(g=o.positionInfo)==null?void 0:g.token_a)==null?void 0:U.symbol)+" - "+d(o.needReverse?(K=(H=o.positionInfo)==null?void 0:H.token_a)==null?void 0:K.symbol:(k=(q=o.positionInfo)==null?void 0:q.token_b)==null?void 0:k.symbol),1),(Q=o.positionInfo)!=null&&Q.fee?(_(),O("div",He,[ze,te(" "+d(((mo=o.positionInfo)==null?void 0:mo.fee)*100)+"% ",1)])):io("",!0),e("div",Ye,[Ge,e("a",{href:("getExplorerUrl"in o?o.getExplorerUrl:D(xo))("poolAddress",(no=o.positionInfo)==null?void 0:no.id),target:"_blank"},Ke,8,Ze)]),e("div",Qe,[xe,e("a",{href:("getExplorerUrl"in o?o.getExplorerUrl:D(xo))("poolAddress",(to=o.positionInfo)==null?void 0:to.address),target:"_blank"},nn,8,on)])]),e("div",tn,[e("div",sn,[ln,e("div",an,[te(d(o.apy)+" ",1),E(b)])]),e("div",un,[rn,e("div",dn,"$"+d(("addCommom"in o?o.addCommom:D(M))(o.tvl,2)),1)])])]),e("div",vn,[e("div",mn,[e("div",cn,[Po(e("img",pn,null,512),[[r,o.needReverse?o.getCoinIcon((so=o.positionInfo)==null?void 0:so.token_b):o.getCoinIcon((z=o.positionInfo)==null?void 0:z.token_a)]]),E(C,{address:o.needReverse?(Vo=(ao=o.positionInfo)==null?void 0:ao.token_b)==null?void 0:Vo.address:(L=(co=o.positionInfo)==null?void 0:co.token_a)==null?void 0:L.address,"style-params":{width:"12px",height:"12px",left:"18px",bottom:"4px"}},null,8,["address"])]),e("div",fn,[Po(e("img",yn,null,512),[[r,o.needReverse?o.getCoinIcon((Eo=o.positionInfo)==null?void 0:Eo.token_a):o.getCoinIcon((wo=o.positionInfo)==null?void 0:wo.token_b)]]),E(C,{address:o.needReverse?(Ro=($o=o.positionInfo)==null?void 0:$o.token_a)==null?void 0:Ro.address:(Io=(To=o.positionInfo)==null?void 0:To.token_b)==null?void 0:Io.address,"style-params":{width:"12px",height:"12px",left:"18px",bottom:"4px"}},null,8,["address"])]),e("div",_n,d(o.needReverse?(Wo=(qo=o.positionInfo)==null?void 0:qo.token_b)==null?void 0:Wo.symbol:(lo=(jo=o.positionInfo)==null?void 0:jo.token_a)==null?void 0:lo.symbol)+" - "+d(o.needReverse?(Ko=(po=o.positionInfo)==null?void 0:po.token_a)==null?void 0:Ko.symbol:(S=(c=o.positionInfo)==null?void 0:c.token_b)==null?void 0:S.symbol),1),(Z=o.positionInfo)!=null&&Z.fee?(_(),O("div",bn,[hn,te(" "+d(((F=o.positionInfo)==null?void 0:F.fee)*100)+"% ",1)])):io("",!0)]),e("div",gn,[e("div",kn,[wn,e("a",{href:("getExplorerUrl"in o?o.getExplorerUrl:D(xo))("poolAddress",(uo=o.positionInfo)==null?void 0:uo.id),target:"_blank"},Cn,8,In)]),e("div",An,[Sn,e("a",{href:("getExplorerUrl"in o?o.getExplorerUrl:D(xo))("poolAddress",(x=o.positionInfo)==null?void 0:x.address),target:"_blank"},Rn,8,Pn)])]),e("div",qn,[e("div",Bn,[On,e("div",Nn,[te(d(o.apy)+" ",1),E(b)])]),e("div",Mn,[Ln,e("div",Dn,"$"+d(("addCommom"in o?o.addCommom:D(M))(o.tvl,2)),1)])])])])}const Ce=Fo(Le,[["render",Un],["__scopeId","data-v-c5a991ac"]]),Fn=Do({setup(){const o=w(!0),t=Mo(),G=f(()=>t),W=Lo(),j=f(()=>W),I=Uo(),C=w();go(()=>[j.value.positionInfoObj,I.params.id],([m,l])=>{m&&!No(m)&&l&&(C.value=m[l],console.log(C.value,"##positionInfo.value"))},{immediate:!0,deep:!0});const b=f(()=>{var m;return(m=C.value)==null?void 0:m.needReverse});return{direct:o,positionInfo:C,needReverse:b,getCoinIcon:m=>{var l;return(m==null?void 0:m.logoURI)||(m==null?void 0:m.logo_url)||((l=G.value.tokensObj[m==null?void 0:m.address])==null?void 0:l.logo_url)||Yo("/image/coins/sui-unknown.png")},decimalUi:se,addCommom:M,sFixD:vo}}}),Vn=""+globalThis.__publicAssetsURL("sui-image/icon_currentprice@2x.png");const Co=o=>(Go("data-v-9f746a5c"),o=o(),Zo(),o),En={class:"v2-position-range"},Wn={class:"position-range-top"},jn=Co(()=>e("div",null,"Position Range",-1)),Xn={class:"base-coin"},Hn={key:0},zn={alt:""},Yn={key:1},Gn={alt:""},Zn={key:2},Jn={key:3},Kn=Co(()=>e("p",null,"Base coin",-1)),Qn={class:"coin-rate"},xn=Co(()=>e("div",null,[e("svg",{class:"icon icon-up","aria-hidden":"true"},[e("use",{"xlink:href":"#icon-exchange_up1"})])],-1)),ot=Co(()=>e("div",null,[e("svg",{class:"icon icon-down","aria-hidden":"true"},[e("use",{"xlink:href":"#icon-exchange_down1"})])],-1)),et=[xn,ot],nt={class:"position-range-bottom"},tt={class:"current-price"},st=Co(()=>e("div",{class:"current-price-title"},"Current Price",-1)),lt={key:0,class:"current-price-text"},it={key:1,class:"current-price-text"},at={class:"price-range"},ut=Co(()=>e("div",{class:"price-range-bg"},[e("div",{class:"price-range-border"})],-1)),rt=Co(()=>e("img",{src:Vn,alt:""},null,-1)),dt={class:"min-price"},vt=Co(()=>e("div",null,"Min Price",-1)),mt={class:"max-price"},ct=Co(()=>e("div",null,"Max Price",-1));function pt(o,t,G,W,j,I){var r,m,l,n,$,i,u,y,v,T,A,R,X,h,p,g,U,H,K,q,k,Q,mo,no,to,z;const C=le,b=ve("image");return _(),O("div",En,[e("div",Wn,[jn,e("div",Xn,[o.needReverse?(_(),O("div",Yn,[Po(e("img",Gn,null,512),[[b,o.direct?o.getCoinIcon((y=o.positionInfo)==null?void 0:y.token_b):o.getCoinIcon((u=o.positionInfo)==null?void 0:u.token_a)]]),E(C,{address:o.direct?(R=(A=o.positionInfo)==null?void 0:A.token_b)==null?void 0:R.address:(T=(v=o.positionInfo)==null?void 0:v.token_a)==null?void 0:T.address,"style-params":{width:"10px",height:"10px",right:"0",bottom:"0"}},null,8,["address"])])):(_(),O("div",Hn,[Po(e("img",zn,null,512),[[b,o.direct?o.getCoinIcon((r=o.positionInfo)==null?void 0:r.token_a):o.getCoinIcon((m=o.positionInfo)==null?void 0:m.token_b)]]),E(C,{address:o.direct?(n=(l=o.positionInfo)==null?void 0:l.token_a)==null?void 0:n.address:(i=($=o.positionInfo)==null?void 0:$.token_b)==null?void 0:i.address,"style-params":{width:"10px",height:"10px",right:"0",bottom:"0"}},null,8,["address"])])),o.needReverse?(_(),O("span",Jn,d(o.direct?(H=(U=o.positionInfo)==null?void 0:U.token_b)==null?void 0:H.symbol:(q=(K=o.positionInfo)==null?void 0:K.token_a)==null?void 0:q.symbol),1)):(_(),O("span",Zn,d(o.direct?(h=(X=o.positionInfo)==null?void 0:X.token_a)==null?void 0:h.symbol:(g=(p=o.positionInfo)==null?void 0:p.token_b)==null?void 0:g.symbol),1)),Kn,e("div",Qn,[e("div",{onClick:t[0]||(t[0]=so=>o.direct=!o.direct)},et)])])]),e("div",nt,[e("div",tt,[st,(o.needReverse?!o.direct:o.direct)?(_(),O("div",lt,d(("addCommom"in o?o.addCommom:D(M))(("decimalUi"in o?o.decimalUi:D(se))((k=o.positionInfo)==null?void 0:k.price,6))),1)):(_(),O("div",it,d(("addCommom"in o?o.addCommom:D(M))(("decimalUi"in o?o.decimalUi:D(se))(1/((Q=o.positionInfo)==null?void 0:Q.price),6))),1))]),e("div",at,[ut,rt,e("div",dt,[vt,e("div",null,d(((mo=o.positionInfo)==null?void 0:mo.minPrice)&&("sFixD"in o?o.sFixD:D(vo))((no=o.positionInfo)==null?void 0:no.minPrice,6)),1)]),e("div",mt,[ct,e("div",null,d(((to=o.positionInfo)==null?void 0:to.maxPrice)&&("sFixD"in o?o.sFixD:D(vo))((z=o.positionInfo)==null?void 0:z.maxPrice,6)),1)])])])])}const Ae=Fo(Fn,[["render",pt],["__scopeId","data-v-9f746a5c"]]),ft=Do({setup(){const o=Mo(),t=f(()=>o),G=Lo(),W=f(()=>G),j=Uo(),I=w();return go(()=>[W.value.positionInfoObj,j.params.id],([r,m])=>{console.log(r,"##positionInfoObj"),r&&!No(r)&&m&&(I.value=r[m],console.log(I.value,"##positionInfo.value"))},{immediate:!0,deep:!0}),{needReverse:f(()=>{var r;return(r=I.value)==null?void 0:r.needReverse}),positionInfo:I,getCoinIcon:r=>{var m;return console.log(r,"info##"),(r==null?void 0:r.logoURI)||(r==null?void 0:r.logo_url)||((m=t.value.tokensObj[r==null?void 0:r.address])==null?void 0:m.logo_url)||Yo("/image/coins/sui-unknown.png")},addCommom:M}}});const yt=o=>(Go("data-v-16c5df57"),o=o(),Zo(),o),_t={class:"pool-composition"},bt=yt(()=>e("div",{class:"pool-composition-top"},"Pool Composition",-1)),ht={class:"pool-composition-bottom"},gt={class:"token-ratio"},kt={class:"before-coin"},wt={alt:""},It={class:"after-coin"},$t={alt:""},Ct={class:"token-num"},At={class:"num-box"},St={class:"num-box"};function Pt(o,t,G,W,j,I){var r,m,l,n,$,i,u,y,v,T,A,R,X,h,p,g,U,H,K,q,k,Q,mo,no,to,z,so,co;const C=le,b=ve("image");return _(),O("div",_t,[bt,e("div",ht,[e("div",gt,[e("div",kt,[e("div",null,[E(C,{address:o.needReverse?(n=(l=o.positionInfo)==null?void 0:l.token_b)==null?void 0:n.address:(m=(r=o.positionInfo)==null?void 0:r.token_a)==null?void 0:m.address,"style-params":{width:"14px",height:"14px",right:"0",bottom:"0"}},null,8,["address"]),Po(e("img",wt,null,512),[[b,o.needReverse?o.getCoinIcon((i=o.positionInfo)==null?void 0:i.token_b):o.getCoinIcon(($=o.positionInfo)==null?void 0:$.token_a)]])]),e("span",null,d((u=o.positionInfo)==null?void 0:u.poolCoinARatio)+"%",1)]),e("div",It,[e("span",null,d((y=o.positionInfo)==null?void 0:y.poolCoinBRatio)+"%",1),e("div",null,[Po(e("img",$t,null,512),[[b,o.needReverse?o.getCoinIcon((T=o.positionInfo)==null?void 0:T.token_a):o.getCoinIcon((v=o.positionInfo)==null?void 0:v.token_b)]]),E(C,{address:o.needReverse?(h=(X=o.positionInfo)==null?void 0:X.token_a)==null?void 0:h.address:(R=(A=o.positionInfo)==null?void 0:A.token_b)==null?void 0:R.address,"style-params":{width:"14px",height:"14px",right:"0",bottom:"0"}},null,8,["address"])])])]),e("div",Ct,[e("div",{class:"token-a-bg",style:ce({width:`${(p=o.positionInfo)==null?void 0:p.poolCoinARatio}%`})},null,4),e("div",{class:"token-b-bg",style:ce({width:`${(g=o.positionInfo)==null?void 0:g.poolCoinBRatio}%`})},null,4),e("div",At,[e("div",null,d(("addCommom"in o?o.addCommom:D(M))((U=o.positionInfo)==null?void 0:U.poolCoinANum))+" "+d(o.needReverse?(k=(q=o.positionInfo)==null?void 0:q.token_b)==null?void 0:k.symbol:(K=(H=o.positionInfo)==null?void 0:H.token_a)==null?void 0:K.symbol),1),e("div",null,"$"+d(("addCommom"in o?o.addCommom:D(M))((Q=o.positionInfo)==null?void 0:Q.poolCoinBUSD)),1)]),e("div",St,[e("div",null,d(("addCommom"in o?o.addCommom:D(M))((mo=o.positionInfo)==null?void 0:mo.poolCoinBNum))+" "+d(o.needReverse?(so=(z=o.positionInfo)==null?void 0:z.token_a)==null?void 0:so.symbol:(to=(no=o.positionInfo)==null?void 0:no.token_b)==null?void 0:to.symbol),1),e("div",null,"$"+d(("addCommom"in o?o.addCommom:D(M))((co=o.positionInfo)==null?void 0:co.poolCoinBUSD)),1)])])])])}const Se=Fo(ft,[["render",Pt],["__scopeId","data-v-16c5df57"]]),Tt=Do({setup(){const o=Mo(),t=f(()=>o),G=Lo(),W=f(()=>G),j=Uo(),I=w();go(()=>[W.value.positionInfoObj,j.params.id],([l,n])=>{console.log(l,"##positionInfoObj"),l&&!No(l)&&n&&(I.value=l[n],console.log(I.value,"##positionInfo.value"))},{immediate:!0,deep:!0});const C=f(()=>{var l;return(l=I.value)==null?void 0:l.needReverse}),b=l=>{var n;return console.log(l,"info##"),(l==null?void 0:l.logoURI)||(l==null?void 0:l.logo_url)||((n=t.value.tokensObj[l==null?void 0:l.address])==null?void 0:n.logo_url)||Yo("/image/coins/sui-unknown.png")},r=de(),m=f(()=>r);return{needReverse:C,positionInfo:I,getCoinIcon:b,addCommom:M,wallet:m}}});const oe=o=>(Go("data-v-0b578037"),o=o(),Zo(),o),Rt={class:"my-liquidity"},qt={class:"my-liquidity-top"},Bt=oe(()=>e("div",null,"My Liquidity",-1)),Ot=oe(()=>e("p",null,"My share of pool",-1)),Nt={class:"my-liquidity-bottom"},Mt={class:"lp-token"},Lt=oe(()=>e("div",null,[e("span",null,"LP Token Balance ")],-1)),Dt={class:"lp-balance"},Ut={class:"token-num-content"},Ft={class:"token-num token-a-num"},Vt={class:"logo"},Et=["src"],Wt={class:"text"},jt={class:"lp-logo"},Xt=["src"],Ht=oe(()=>e("div",null,"Pooled Assets",-1)),zt={class:"token-num"},Yt={class:"logo"},Gt=["src"],Zt={class:"text"},Jt=oe(()=>e("div",{class:"token-num-content-bg"},null,-1));function Kt(o,t,G,W,j,I){var b,r,m,l,n,$,i,u,y,v,T,A,R,X,h,p,g,U,H,K,q,k,Q,mo,no,to,z,so;const C=le;return _(),O("div",Rt,[e("div",qt,[Bt,e("div",null,[Ot,e("p",null,d(o.wallet.connected?(b=o.positionInfo)==null?void 0:b.myShare:"--")+"%",1)])]),e("div",Nt,[e("div",Mt,[Lt,e("div",null,[e("span",Dt,d(o.wallet.connected?("addCommom"in o?o.addCommom:D(M))((r=o.positionInfo)==null?void 0:r.myLiquidity):"--")+" LP",1),e("span",null,"$"+d(o.wallet.connected?("addCommom"in o?o.addCommom:D(M))((m=o.positionInfo)==null?void 0:m.myLiquidityUSD):"--"),1)])]),e("div",Ut,[e("div",Ft,[e("div",Vt,[e("img",{src:o.needReverse?o.getCoinIcon((n=o.positionInfo)==null?void 0:n.token_b):o.getCoinIcon((l=o.positionInfo)==null?void 0:l.token_a),alt:""},null,8,Et),E(C,{address:o.needReverse?(y=(u=o.positionInfo)==null?void 0:u.token_b)==null?void 0:y.address:(i=($=o.positionInfo)==null?void 0:$.token_a)==null?void 0:i.address,"style-params":{width:"14px",height:"14px",left:"18px",bottom:"0"}},null,8,["address"])]),e("div",Wt,[e("div",null,d(o.wallet.connected?("addCommom"in o?o.addCommom:D(M))((v=o.positionInfo)==null?void 0:v.amountA):"--")+" "+d(o.needReverse?(X=(R=o.positionInfo)==null?void 0:R.token_b)==null?void 0:X.symbol:(A=(T=o.positionInfo)==null?void 0:T.token_a)==null?void 0:A.symbol),1),e("div",null,d(o.wallet.connected?("addCommom"in o?o.addCommom:D(M))((h=o.positionInfo)==null?void 0:h.myAmountAUSD):"--"),1)])]),e("div",jt,[e("img",{src:o.getCoinIcon((p=o.positionInfo)==null?void 0:p.lpInfo),alt:""},null,8,Xt),Ht]),e("div",zt,[e("div",Yt,[e("img",{src:o.needReverse?o.getCoinIcon((U=o.positionInfo)==null?void 0:U.token_a):o.getCoinIcon((g=o.positionInfo)==null?void 0:g.token_b),alt:""},null,8,Gt),E(C,{address:o.needReverse?(k=(q=o.positionInfo)==null?void 0:q.token_a)==null?void 0:k.address:(K=(H=o.positionInfo)==null?void 0:H.token_b)==null?void 0:K.address,"style-params":{width:"14px",height:"14px",right:"0",bottom:"0"}},null,8,["address"])]),e("div",Zt,[e("div",null,d(o.wallet.connected?("addCommom"in o?o.addCommom:D(M))((Q=o.positionInfo)==null?void 0:Q.amountB):"--")+" "+d(o.needReverse?(z=(to=o.positionInfo)==null?void 0:to.token_a)==null?void 0:z.symbol:(no=(mo=o.positionInfo)==null?void 0:mo.token_b)==null?void 0:no.symbol),1),e("div",null,d(o.wallet.connected?("addCommom"in o?o.addCommom:D(M))((so=o.positionInfo)==null?void 0:so.myAmountBUSD):"--"),1)])]),Jt])])])}const Pe=Fo(Tt,[["render",Kt],["__scopeId","data-v-0b578037"]]),Qt=Do({components:{AutoPoolAddModal:Ie},setup(){const o=de(),t=w(!1),G=ie(),W=f(()=>G),j=f(()=>W.value.chainName),I=f(()=>o),C=Lo(),b=f(()=>C),r=Mo(),m=f(()=>r),l=w(),n=Uo();go(()=>[b.value.positionInfoObj,n.params.id],([c,S])=>{c&&!No(c)&&S&&(l.value=c[S],console.log(l.value,"##positionInfo.value"))},{immediate:!0,deep:!0});const $=f(()=>{var c,S;return console.log((c=l.value)==null?void 0:c.needReverse,"##positionInfo.value?.needReverse"),(S=l.value)==null?void 0:S.needReverse}),i=w(),u=w(),y=w(),v=w(),T=w(!0),A=f(()=>I.value.assets&&i.value&&I.value.assets[i.value.address]?me(I.value.assets[i.value.address].balance,i.value.decimals):0),R=f(()=>I.value.assets&&u.value&&I.value.assets[u.value.address]?me(I.value.assets[u.value.address].balance,u.value.decimals):0),X=c=>{c==="fromCoin"?(T.value=!0,y.value=A.value>0?i.value.symbol=="SUI"?new a(Number(A.value)).sub(new a(.05)).lt(new a(0))?"0":new a(Number(A.value)).sub(new a(.05)).toString():String(A.value):""):(T.value=!1,v.value=R.value>0?u.value.symbol=="SUI"?new a(Number(R.value)).sub(new a(.05)).lt(new a(0))?"0":new a(Number(R.value)).sub(new a(.05)).toString():String(R.value):"")},h=c=>{c==="fromCoin"?(T.value=!0,y.value=A.value>0?vo(new a(Number(A.value)).div(2).toString(),i.value.decimals).toString():""):(T.value=!1,v.value=R.value>0?vo(new a(Number(R.value)).div(2).toString(),u.value.decimals).toString():"")},p=f(()=>j.value?ye(j.value):{}),g=f(()=>W.value.slippage),U=w("--"),H=w("--"),K=c=>{const S=new a(l.value.autoPoolPositionInfo.liquidity),Z=new a(c.toString());if(S.toNumber()>0&&Z.toNumber()>0){const F=Z.add(S);console.log("totalLiquidity:",Z.div(F).mul(100).toString());const uo=Z.div(F).mul(100).toNumber(),x=Re(uo),fo=x==-1?2:x+2,bo=vo(Z.div(F).mul(100).toNumber(),fo);console.log(l.value.decimals,"##positionInfo.value.decimal");const ho=new a(1).div(new a(Math.pow(10,l.value.lpInfo.decimals))).toString();console.log(bo,ho,"###288"),Number(bo)<Number(ho)?U.value=`<${ho}`:U.value=bo}else Z.toNumber()>0&&S.toNumber()<=0?U.value="100":U.value="--"},q=c=>{const S=new a(c.toString());console.log(c.toString(),"##liquidityAmount.toString()");const Z=S.mul(new a(g.value).div(100)),F=new a(Math.pow(10,l.value.lpInfo.decimals));console.log(S.minus(Z).div(F).toString(),"##liquidity.minus(minimum).div(decimals).toString()"),H.value=vo(S.minus(Z).div(F).toString(),l.value.lpInfo.decimals)},k=w(!1),Q=w(!1),mo=w(""),no=w(),to=async()=>{if(!l.value)return;const c=l.value.autoPoolPositionInfo.tick_lower_index,S=l.value.autoPoolPositionInfo.tick_upper_index,Z=Ho.sqrtPriceX64ToTickIndex(new Y(l.value.current_sqrt_price));Z<c&&($.value?k.value=!0:Q.value=!0),Z>S&&($.value?Q.value=!0:k.value=!0);let F;if(console.log(y.value||v.value,"#fromCoinAmount.value || toCoinAmount.value"),y.value||v.value){T.value?F=new a(y.value).mul(Math.pow(10,i.value.decimals)).toString():F=new a(v.value).mul(Math.pow(10,u.value.decimals)).toString();let uo,x=T.value;if(console.log("执行##"),lo.value||po.value){console.log($.value?T.value:!T.value,"#needReverse.value?fixedFromCoin.value:!fixedFromCoin.value");const s=await Wo.calculateDepositSwapAmount({lowerTick:c,upperTick:S,curSqrtPrice:new Y(l.value.current_sqrt_price),fix_amount_a:x,input_amount:F,coinTypeA:l.value.autoPoolPositionInfo.coin_type_a,coinTypeB:l.value.autoPoolPositionInfo.coin_type_b,clmm_pool:l.value.address});if(console.log(s,"###swapResult"),s){uo=new Y(s.afterSqrtPrice),F=new Y(s.swapOutAmount),uo=l.value.current_sqrt_price,no.value={swap_amount:s.swapInAmount,a2b:x},x=!x;const P=l.value.token_a.decimals,J=l.value.token_b.decimals,B=new a(s.swapInAmount).div(new a(Math.pow(10,P))).toString(),V=new a(s.swapOutAmount).div(new a(Math.pow(10,J))).toString(),N=$.value?l.value.token_b.symbol:l.value.token_a.symbol,eo=$.value?l.value.token_a.symbol:l.value.token_b.symbol;mo.value=`To deposit ${lo.value?y.value:v.value} ${lo.value?N:eo}, 
          ${B} ${lo.value?N:eo}  will be traded for ${V} ${lo.value?eo:N} added to the pool.`}else uo=l.value.current_sqrt_price,F=new Y(F)}else uo=l.value.current_sqrt_price,F=new Y(F);console.log(no,"##swapParams");const{liquidityAmount:fo,tokenMaxA:bo,tokenMaxB:ho}=p.value.estLiquidityAndcoinAmountFromOneAmounts({tokenA:i.value,tokenB:u.value,lowerTick:c,upperTick:S,coinAmount:F,iscoinA:x,roundUp:!0,slippage:Number(g.value)/100,curSqrtPrice:new Y(uo)});console.log(l.value.current_sqrt_price,"##positionInfo.value.current_sqrt_price"),console.log(ho.toString(),bo.toString(),l.value,"###323"),!lo.value&&!po.value&&(T.value?v.value=Number(ho)>0?ho:"":y.value=Number(bo)>0?bo:""),K(fo),q(fo)}};go(()=>l.value,c=>{c&&!No(c)&&(i.value=c==null?void 0:c.token_a,u.value=c==null?void 0:c.token_b,k.value=!1,Q.value=!1,to())},{immediate:!0});const z=f(()=>m.value.RATES),so=f(()=>{var c,S,Z,F,uo,x,fo,bo,ho,s;if((S=z.value[(c=i.value)==null?void 0:c.address])!=null&&S.price&&((F=z.value[(Z=u.value)==null?void 0:Z.address])!=null&&F.price)){console.log((x=z.value[(uo=i.value)==null?void 0:uo.address])==null?void 0:x.price,"RATES.value[fromCoin.value?.address]?.price");const P=new a(y.value||0).mul(new a((bo=z.value[(fo=i.value)==null?void 0:fo.address])==null?void 0:bo.price)),J=new a(v.value||0).mul(new a((s=z.value[(ho=u.value)==null?void 0:ho.address])==null?void 0:s.price));return se(P.add(J).toString(),2)}else return"--"});go(()=>y.value,(c,S)=>{c?to():(U.value="--",v.value="",H.value="--")},{immediate:!0}),go(()=>v.value,(c,S)=>{c?to():(y.value="",U.value="--",H.value="--")},{immediate:!0});const{t:co,locale:L}=be(),ao=f(()=>{const c=Number(y.value)>Number(A.value),S=Number(v.value)>Number(R.value);return!y.value&&!v.value?co("button.enterAmount"):c?co("button.insufficientBalance",{name:i.value.symbol}):S?co("button.insufficientBalance",{name:u.value.symbol}):"Add Liquidity"}),Vo=f(()=>{const c=Number(y.value)>Number(A.value),S=Number(v.value)>Number(R.value);return!!(!y.value&&!v.value||c||S||y.value<=0&&v.value<=0)}),wo=w(!0),{setIsShowSuccess:Eo,setIsShowRejected:To,setIsShowWaiting:Io,setTransactionDesc:$o,setTransactionTxid:Ro,setPositiomNum:qo}=G,Wo=_e("Sui"),jo=async()=>{var bo,ho;t.value=!1,wo.value=!0,Ro("");const c=`${M(y.value)} ${(bo=i.value)==null?void 0:bo.symbol}`,S=`${M(v.value)} ${(ho=u.value)==null?void 0:ho.symbol}`;$o(`Deposit ${y.value>0?c:""} ${v.value>0&&y.value>0?"and":""} ${v.value>0?S:""}`),Io(!0);const Z=T.value,F=l.value.autoPoolPositionInfo.tick_lower_index,uo=l.value.autoPoolPositionInfo.tick_upper_index;let x;T.value?x=new a(y.value).mul(Math.pow(10,i.value.decimals)).toString():x=new a(v.value).mul(Math.pow(10,u.value.decimals)).toString();const fo=l.value.rewarderInfo.map(s=>s.coinAddress);try{const s={lowerTick:F,upperTick:uo,coinAmount:x,fix_amount_a:Z,slippage:Number(g.value)/100,curSqrtPrice:new Y(l.value.current_sqrt_price),id:l.value.id,clmm_pool:l.value.autoPoolPositionInfo.pool,lp_token_type:l.value.lp_token_type,coinTypeA:l.value.autoPoolPositionInfo.coin_type_a,coinTypeB:l.value.autoPoolPositionInfo.coin_type_b,rewarder_coin_types:fo,swapParams:no.value,isOnlyA:lo.value,isOnlyB:po.value},P=await Wo.deposit(s);console.log(P,"===>payloadAdd11111");const J=await I.value.currentWallet.signAndExecuteTransactionBlock(P);let B=p.value.handleTx(J);if(console.log("toAdd###tx###",B),B&&B.hash){Ro(B.hash),Io(!1),Eo(!0),console.log(l,"===>positionInfo");const V={title:"Supplied",desc:`Deposit ${y.value>0?c:""} ${v.value>0&&y.value>0?"and":""} ${v.value>0?S:""}`,hash:B.hash,tit:"Liquidity Increased",icon:"icon-icon-Increased",text:`Deposit ${y.value>0?c:""} ${v.value>0&&y.value>0?"and":""} ${v.value>0?S:""}`};j.value!=="Aptos"&&(V.res=B.res),p.value.showTransitionPending(V),await p.value.watchTransaction(V)&&setTimeout(()=>{C.updatePositionItem(l.value.id),p.value.getAccount(I.value.address)},1e3),qo()}else Io(!1),To(!0);y.value="",v.value="",wo.value=!1}catch(s){y.value="",v.value="",console.log("addError###",s),wo.value=!1,Io(!1),To(!0)}},lo=w(!1),po=w(!1);return{wallet:I,positionInfo:l,isShowAddModal:t,needReverse:$,fromCoin:i,toCoin:u,fromCoinAmount:y,toCoinAmount:v,fromCoinBlance:A,toCoinBlance:R,fixedFromCoin:T,maxBtnSelect:X,halfBtnSelect:h,totalAmountUSD:so,addCommom:M,shareOfPool:U,minimumReceivedLP:H,addLiquidityBtnText:ao,addLiquidityBtnDisabled:Vo,toAdd:jo,showToCoinLock:Q,showFromCoinLock:k,isOnlyA:lo,isOnlyB:po,onlyToken:c=>{y.value="",v.value="",c=="only-a"?(lo.value=!lo.value,po.value=!1):(po.value=!po.value,lo.value=!1)},onlyText:mo}}});const Jo=o=>(Go("data-v-ba12b2cc"),o=o(),Zo(),o),xt={class:"auto-pool-add"},os={class:"auto-pool-add-content"},es={class:"liquidity-action-tab"},ns=Jo(()=>e("div",{class:"increase tab-active"},"Add",-1)),ts={class:"only-token"},ss=Jo(()=>e("div",null,"Deposit Amounts",-1)),ls={key:0},is={key:0},as={key:0,class:"card-item"},us={key:1,class:"card-item"},rs=Jo(()=>e("span",null,"Pool Closed",-1)),ds={class:"add-info"},vs={key:0,class:"only-text"},ms={class:"total-amount"},cs=Jo(()=>e("span",null,"Total Amount",-1)),ps={class:"total-amount"},fs=Jo(()=>e("span",null,"Share of Pool",-1)),ys={class:"total-amount"},_s=Jo(()=>e("span",null,"Minimum Received LP",-1));function bs(o,t,G,W,j,I){var l,n,$,i,u,y,v,T,A,R,X,h,p;const C=ke,b=we,r=ge,m=Ie;return _(),O("div",xt,[e("div",os,[e("div",es,[ns,e("div",{class:"remove",onClick:t[0]||(t[0]=he(g=>o.$emit("changeCurrentTab"),["stop"]))},"Remove")]),e("div",ts,[ss,e("div",null,[e("div",{class:"only-a",onClick:t[1]||(t[1]=g=>o.onlyToken("only-a"))},[e("p",null,[o.isOnlyA?(_(),O("span",ls)):io("",!0)]),e("span",null,d(o.needReverse?(i=($=o.positionInfo)==null?void 0:$.token_b)==null?void 0:i.symbol:(n=(l=o.positionInfo)==null?void 0:l.token_a)==null?void 0:n.symbol)+" only",1)]),e("div",{class:"only-b",onClick:t[2]||(t[2]=g=>o.onlyToken("only-b"))},[e("p",null,[o.isOnlyB?(_(),O("span",is)):io("",!0)]),e("span",null,d(o.needReverse?(T=(v=o.positionInfo)==null?void 0:v.token_a)==null?void 0:T.symbol:(y=(u=o.positionInfo)==null?void 0:u.token_b)==null?void 0:y.symbol)+" only",1)])])]),e("div",{class:re(o.needReverse?"card-container reverse":"card-container")},[(o.needReverse?!o.isOnlyA:!o.isOnlyB)?(_(),O("div",as,[E(C,{modelValue:o.fromCoinAmount,"onUpdate:modelValue":t[3]||(t[3]=g=>o.fromCoinAmount=g),"input-value":o.fromCoinAmount,"coin-symbol":o.fromCoin?o.fromCoin.symbol:null,"coin-name":o.fromCoin?o.fromCoin.name:null,balance:o.fromCoinBlance,"coin-icon":o.fromCoin?o.fromCoin.logoURI:"",address:o.fromCoin?o.fromCoin.address:"","swap-direct":"From","import-page":"deposit","has-arrow":!1,onOnMax:t[4]||(t[4]=g=>o.maxBtnSelect("fromCoin")),onOnHalf:t[5]||(t[5]=g=>o.halfBtnSelect("fromCoin")),onOnInput:t[6]||(t[6]=g=>{o.fromCoinAmount=g}),onOnFocus:t[7]||(t[7]=()=>{o.fixedFromCoin=!0})},null,8,["modelValue","input-value","coin-symbol","coin-name","balance","coin-icon","address"]),o.showFromCoinLock?(_(),_o(b,{key:0})):io("",!0)])):io("",!0),(o.needReverse?!o.isOnlyB:!o.isOnlyA)?(_(),O("div",us,[E(C,{modelValue:o.toCoinAmount,"onUpdate:modelValue":t[8]||(t[8]=g=>o.toCoinAmount=g),"input-value":o.toCoinAmount,"coin-symbol":o.toCoin?o.toCoin.symbol:null,"coin-name":o.toCoin?o.toCoin.name:null,balance:o.toCoinBlance,"swap-direct":"To","coin-icon":o.toCoin?o.toCoin.logoURI:"",address:o.toCoin?o.toCoin.address:"","import-page":"deposit","has-arrow":!1,onOnMax:t[9]||(t[9]=g=>o.maxBtnSelect("toCoin")),onOnHalf:t[10]||(t[10]=g=>o.halfBtnSelect("toCoin")),onOnInput:t[11]||(t[11]=g=>{o.toCoinAmount=g}),onOnFocus:t[12]||(t[12]=()=>{o.fixedFromCoin=!1})},null,8,["modelValue","input-value","coin-symbol","coin-name","balance","coin-icon","address"]),o.showToCoinLock?(_(),_o(b,{key:0})):io("",!0)])):io("",!0)],2)]),(A=o.positionInfo)!=null&&A.is_pause?(_(),_o(r,{key:0,class:"big-btn liquidity-btn",disabled:!0},{default:zo(()=>[rs]),_:1})):o.wallet.connected?(_(),_o(r,{key:1,class:"big-btn liquidity-btn",disabled:o.addLiquidityBtnDisabled,onClick:t[13]||(t[13]=g=>o.isShowAddModal=!0)},{default:zo(()=>[e("span",null,d(o.addLiquidityBtnText),1)]),_:1},8,["disabled"])):(_(),_o(r,{key:2,class:"big-btn",onClick:t[14]||(t[14]=g=>o.wallet.setIsShowWalletModal(!0))},{default:zo(()=>[e("span",null,d(o.$t("button.connectWallet")),1)]),_:1})),e("div",ds,[o.fromCoinAmount||o.toCoinAmount?(_(),O("div",vs,d(o.onlyText),1)):io("",!0),e("div",ms,[cs,e("span",null,"$"+d(("addCommom"in o?o.addCommom:D(M))(o.totalAmountUSD)),1)]),e("div",ps,[fs,e("span",null,d(o.shareOfPool)+"%",1)]),e("div",ys,[_s,e("span",null,d(("addCommom"in o?o.addCommom:D(M))(o.minimumReceivedLP))+" "+d(o.needReverse?(R=o.toCoin)==null?void 0:R.symbol:(X=o.fromCoin)==null?void 0:X.symbol)+"-"+d(o.needReverse?(h=o.fromCoin)==null?void 0:h.symbol:(p=o.toCoin)==null?void 0:p.symbol),1)])]),o.isShowAddModal?(_(),_o(m,{key:3,"pool-info":o.positionInfo,"from-coin":o.needReverse?o.positionInfo.token_b:o.positionInfo.token_a,"to-coin":o.needReverse?o.positionInfo.token_a:o.positionInfo.token_b,"from-coin-amount":o.needReverse?o.toCoinAmount:o.fromCoinAmount,"to-coin-amount":o.needReverse?o.fromCoinAmount:o.toCoinAmount,"total-amount":o.totalAmountUSD,"share-of-pool":o.shareOfPool,"minimum-received-l-p":o.minimumReceivedLP,"is-only-a":o.isOnlyA,"is-only-b":o.isOnlyB,onOnClose:t[15]||(t[15]=g=>o.isShowAddModal=!1),onToAdd:o.toAdd},null,8,["pool-info","from-coin","to-coin","from-coin-amount","to-coin-amount","total-amount","share-of-pool","minimum-received-l-p","is-only-a","is-only-b","onToAdd"])):io("",!0)])}const hs=Fo(Qt,[["render",bs],["__scopeId","data-v-ba12b2cc"]]),gs=Do({components:{AutoPoolRemoveModal:$e},setup(){const o=de(),t=f(()=>o),G=ie(),W=f(()=>G),j=f(()=>W.value.slippage),I=f(()=>W.value.chainName),C=[{name:"25%",value:25},{name:"50%",value:50},{name:"75%",value:75},{name:"MAX",value:100}],b=w(25),r=Uo(),m=Lo(),l=f(()=>m),n=f(()=>(console.log(l.value.positionInfoObj[r.params.id],"autoPool.value.positionInfoObj[route.params.id]###"),l.value.positionInfoObj[r.params.id])),$=f(()=>{var s;return(s=n.value)==null?void 0:s.needReverse}),i=w(),u=w(),y=w(!1),v=w(),T=f(()=>{var s;return(s=n.value)==null?void 0:s.myLiquidity}),A=w(!0),R=f(()=>I.value?ye(I.value):{}),X=_e("Sui"),h=w(""),p=w(""),g=w("--"),U=w(!1),H=w(!1),K=w(),q=w(!0),k=w(),Q=Mo(),mo=f(()=>Q),no=f(()=>mo.value.RATES),to=async()=>{if(A.value||!n.value)return;const s=n.value.autoPoolPositionInfo.tick_lower_index,P=n.value.autoPoolPositionInfo.tick_upper_index,J=Ho.sqrtPriceX64ToTickIndex(new Y(n.value.current_sqrt_price));J<s&&($.value?U.value=!0:H.value=!0),J>P&&($.value?H.value=!0:U.value=!0);let B;if(console.log(h.value||p.value,"#fromCoinAmount.value || toCoinAmount.value"),h.value||p.value){q.value?B=new a(h.value).mul(Math.pow(10,i.value.decimals)).toString():B=new a(p.value).mul(Math.pow(10,u.value.decimals)).toString();let V,N=q.value;if(console.log("执行##"),L.value||ao.value){const oo=await X.calculateRemoveSwapAmount({lowerTick:s,upperTick:P,curSqrtPrice:new Y(n.value.current_sqrt_price),fix_amount_a:N,receiveAmount:B,coinTypeA:n.value.autoPoolPositionInfo.coin_type_a,coinTypeB:n.value.autoPoolPositionInfo.coin_type_b,clmm_pool:n.value.address});if(console.log(oo,"###swapResult"),oo){V=new Y(oo.afterSqrtPrice),B=new Y(oo.swapOutAmount),V=n.value.current_sqrt_price,K.value={swap_amount:oo.swapInAmount,liquidity:oo.liquidity,a2b:!N},N=!N;const Ao=n.value.token_a.decimals,Oo=n.value.token_b.decimals,So=new a(oo.swapInAmount).div(new a(Math.pow(10,Ao))).toString(),Qo=new a(oo.swapOutAmount).div(new a(Math.pow(10,Oo))).toString(),ne=$.value?n.value.token_b.symbol:n.value.token_a.symbol,ae=$.value?n.value.token_a.symbol:n.value.token_b.symbol;k.value=`To withdraw ${L.value?h.value:p.value} ${L.value?ne:ae}, 
          ${Qo} ${L.value?ae:ne}  in the pool will be traded for ${So} ${L.value?ne:ae}`}else V=n.value.current_sqrt_price,B=new Y(B)}else V=n.value.current_sqrt_price,B=new Y(B);console.log("执行了吗##");const{liquidityAmount:eo,tokenMaxA:ro,tokenMaxB:yo}=R.value.estLiquidityAndcoinAmountFromOneAmounts({tokenA:i.value,tokenB:u.value,lowerTick:s,upperTick:P,coinAmount:B,iscoinA:N,roundUp:!1,slippage:Number(j.value)/100,curSqrtPrice:new Y(V)});console.log(n.value.current_sqrt_price,"##positionInfo.value.current_sqrt_price"),console.log(yo.toString(),ro.toString(),n.value,"###323"),!L.value&&!ao.value&&(q.value?p.value=Number(yo)>0?yo:"":h.value=Number(ro)>0?ro:"");const Bo=ue.get_lp_amount_by_liquidity({liquidity:n.value.liquidity,total_supply:n.value.total_supply},eo.toString());v.value=new a(Bo).div(new a(Math.pow(10,n.value.lpInfo.decimals))).toString();const Xo=new a(v.value).div(new a(T.value)).mul(100);g.value=Bo,z.value=eo.toString(),b.value=Xo.toNumber()}},z=w(),so=f(()=>{var s;return(s=n==null?void 0:n.value)==null?void 0:s.amountA}),co=f(()=>{var s;return(s=n==null?void 0:n.value)==null?void 0:s.amountB}),L=w(!1),ao=w(!1),Vo=f(()=>{var B,V,N,eo;const s=(V=no.value[(B=i==null?void 0:i.value)==null?void 0:B.address])==null?void 0:V.price,P=(eo=no.value[(N=u==null?void 0:u.value)==null?void 0:N.address])==null?void 0:eo.price;console.log(s,P,h.value,p.value,"####totalWithdraw");let J;return s&&P&&(L.value||ao.value?J=new a(L.value?h.value||0:p.value||0).mul(new a(L.value?s:P)).toString():(J=new a(h.value||0).mul(new a(s)).add(new a(p.value||0).mul(new a(P))).toString(),console.log(J,"result##"))),J>0&&J<.01?"<$0.01":`$${M(vo(J,2))}`}),wo=async s=>{if(!A.value)return;A.value=!0,n.value.token_a.decimals,n.value.token_b.decimals;const P=n.value.tick_lower_index,J=n.value.tick_upper_index;Ho.tickIndexToSqrtPriceX64(P),Ho.tickIndexToSqrtPriceX64(J);let B="",V,N;console.log(s.value,"##item.value"),console.log(N,"##coinAmount");let eo=q.value;if(console.log("执行##"),L.value||ao.value){if(L.value){const yo=new a(fo.value).mul(Math.pow(10,i.value.decimals)).mul(s.value).toString();console.log(yo,"##amount"),N=vo(yo,0),h.value=new a(fo.value).mul(s.value).toString()}if(ao.value){const yo=new a(fo.value).mul(s.value).mul(Math.pow(10,u.value.decimals)).toString();N=vo(yo,0),p.value=new a(fo.value).mul(s.value).toString()}const ro=await X.calculateRemoveSwapAmount({lowerTick:P,upperTick:J,curSqrtPrice:new Y(n.value.current_sqrt_price),fix_amount_a:eo,receiveAmount:N,coinTypeA:n.value.autoPoolPositionInfo.coin_type_a,coinTypeB:n.value.autoPoolPositionInfo.coin_type_b,clmm_pool:n.value.address});if(console.log(ro,"###swapResult"),ro){new Y(ro.afterSqrtPrice),N=new Y(ro.swapOutAmount),n.value.current_sqrt_price,K.value={swap_amount:ro.swapInAmount,liquidity:ro.liquidity,a2b:!eo},eo=!eo;const yo=n.value.token_a.decimals,Bo=n.value.token_b.decimals,Xo=new a(ro.swapInAmount).div(new a(Math.pow(10,yo))).toString(),oo=new a(ro.swapOutAmount).div(new a(Math.pow(10,Bo))).toString(),Ao=$.value?n.value.token_b.symbol:n.value.token_a.symbol,Oo=$.value?n.value.token_a.symbol:n.value.token_b.symbol;k.value=`To withdraw ${L.value?h.value:p.value} ${L.value?Ao:Oo}, 
          ${oo} ${L.value?Oo:Ao}  in the pool will be traded for ${Xo} ${L.value?Ao:Oo}`,B=ro.liquidity}else n.value.current_sqrt_price,N=new Y(N);g.value=ue.get_lp_amount_by_liquidity({liquidity:n.value.liquidity,total_supply:n.value.total_supply},B),v.value=new a(g.value).div(Math.pow(10,n.value.lpInfo.decimals)),z.value=B}else{const ro=new a(so.value).mul(Math.pow(10,i.value.decimals)).mul(s.value).toString();N=vo(ro,0),h.value=new a(so.value).mul(s.value).toString();const yo=new a(co.value).mul(s.value).mul(Math.pow(10,u.value.decimals)).toString();N=vo(yo,0),p.value=new a(co.value).mul(s.value).toString(),n.value.current_sqrt_price,N=new Y(N),s.value!==1?V=new a(n.value.myLiquidity).mul(Math.pow(10,n.value.lpInfo.decimals)).mul(s.value).toString():V=new a(n.value.myLiquidity).mul(Math.pow(10,n.value.lpInfo.decimals)).toString(),v.value=new a(V).div(Math.pow(10,n.value.lpInfo.decimals)),B=ue.get_share_liquidity_by_amount({liquidity:n.value.liquidity,total_supply:n.value.total_supply},V),g.value=vo(V,0),z.value=vo(B,0)}};go(b,qe((s,P)=>{s!==P&&(Number(s)>100?b.value=100:s&&n.value?(console.log("687===>"),b.value=s,wo({value:b.value/100})):(h.value="--",p.value="--"))},300)),go(()=>h.value,(s,P)=>{s?to():p.value=""},{immediate:!0}),go(()=>p.value,(s,P)=>{s?to():h.value=""},{immediate:!0});const Eo=Be(),{setIsShowSuccess:To,setIsShowRejected:Io,setIsShowWaiting:$o,setTransactionDesc:Ro,setTransactionTxid:qo,setPositiomNum:Wo,setTransactionDescText:jo}=G,lo=w(!1),{t:po}=be(),Ko=async()=>{var Bo,Xo;lo.value=!0,qo("");const s=Number(h.value)>0?`${M(h.value,i.value.decimals)} ${i.value.symbol}`:"",P=Number(p.value)>0?`${M(p.value,u.value.decimals)} ${u.value.symbol}`:"";console.log(s,P,"###transactionDescTo"),Ro(po("tips.removeLiquidiyText",{from:$.value?P:s,and:Number(h.value)>0&&Number(p.value)>0?"and":"",to:$.value?s:P})),$o(!0);const J=po("modal.removeLiquidityText2");jo(J);const B=n.value.autoPoolPositionInfo.tick_lower_index,V=n.value.autoPoolPositionInfo.tick_upper_index,N=Ho.tickIndexToSqrtPriceX64(B),eo=Ho.tickIndexToSqrtPriceX64(V),ro=n.value.rewarderInfo.map(oo=>oo.coinAddress);console.log(z.value,g.value,"##liquidityVal.value");let yo;q.value?yo=new a(h.value).mul(Math.pow(10,i.value.decimals)).toString():yo=new a(p.value).mul(Math.pow(10,u.value.decimals)).toString();try{const oo={lowerSqrtPrice:N,upperSqrtPrice:eo,lpTokenAmount:new Y(g.value),liquidity:new Y(z.value),curSqrtPrice:new Y(n.value.object.current_sqrt_price),slippage:Number(j.value)/100,id:n.value.id,clmm_pool:n.value.autoPoolPositionInfo.pool,lp_token_type:n.value.lp_token_type,coinTypeA:n.value.autoPoolPositionInfo.coin_type_a,coinTypeB:n.value.autoPoolPositionInfo.coin_type_b,rewarder_coin_types:ro,swapParams:K.value,fix_amount_a:q.value,isOnlyA:L.value,isOnlyB:ao.value,lowerTick:B,upperTick:V,receiveAmount:yo},Ao=await X.remove(oo);console.log(Ao,"移除流动性payload");const Oo=await t.value.currentWallet.signAndExecuteTransactionBlock(Ao);let So=R.value.handleTx(Oo);if(console.log("0331###remove###tx####",So),So&&So.hash){qo(So.hash),$o(!1),To(!0);const Qo={title:po("common.removeLiquidity"),desc:"",hash:So.hash,descTransactions:`Remove ${s} ${Number(h.value)>0&&Number(p.value)>0?"and":""} ${P} from the pool`,sender:t.value.address,chainName:"Sui",tit:"Liquidity Removed",icon:"icon-icon-Removed",text:`Withdraw ${h.value} ${(Bo=i.value)==null?void 0:Bo.symbol} and ${p.value} ${(Xo=u.value)==null?void 0:Xo.symbol}`};Qo.res=So.res,R.value.showTransitionPending(Qo),await R.value.watchTransaction(Qo)&&(h.value="",p.value="",v.value="",b.value=0,setTimeout(()=>{m.updatePositionItem(n.value.id),R.value.getAccount(t.value.address)},1e3),Number(b.value)==100&&r.name=="auto-pool-detail"&&Eo.push("/pool/auto"))}else $o(!1),Io(!0);lo.value=!1}catch(oo){console.log("Remove error",oo),lo.value=!1,$o(!1),Io(!0)}};go(()=>n.value,(s,P)=>{s&&!No(s)&&(i.value=s==null?void 0:s.token_a,u.value=s==null?void 0:s.token_b,console.log("触发###"),(!P||P&&P.address!==s.address)&&wo({value:b.value/100}))},{immediate:!0});const c=f(()=>{const s=Number(v.value)>Number(T.value);return!v.value||v.value<=0?po("button.enterAmount"):s?"Invalid Amount":po("button.remove")}),S=f(()=>!1),Z=s=>(s==null?void 0:s.logoURI)||(s==null?void 0:s.logo_url)||Yo("/image/coins/sui-unknown.png"),F=s=>{h.value="",p.value="",A.value=!0,s=="only-a"?(L.value=!L.value,ao.value=!1,q.value=!0):(ao.value=!ao.value,L.value=!1,q.value=!1)},uo=s=>{A.value=!0,b.value=100,s==="fromCoin"?q.value=!0:q.value=!1},x=s=>{A.value=!0,b.value=50,s==="fromCoin"?q.value=!0:q.value=!1},fo=w(),bo=async()=>{const s=q.value,P=n.value.token_a.decimals,J=n.value.token_b.decimals,B=new a(so.value).mul(new a(Math.pow(10,P))).toString(),V=new a(co.value).mul(new a(Math.pow(10,J))).toString(),N=L.value?V:B;if(L.value||ao.value){console.log(N,"##receiveAmount");let eo=await R.value.preSwap({pool:{address:n.value.address,coinA:n.value.token_a,coinB:n.value.token_b},a2b:s,byAmountIn:q.value,amount:q.value?so.value:co.value});console.log(eo,"##preSwapRes"),fo.value=new a(eo.estimatedAmountOut).add(new a(L.value?co.value:so.value)).toString(),wo({value:b.value/100})}};return go(()=>[L.value,ao.value,h.value,p.value],([s,P])=>{(s||P)&&bo()},{immediate:!0}),{removeLiquidityBtnText:c,removeLiquidityBtnDisabled:S,wallet:t,ratioArr:C,positionInfo:n,isShowRemoveModal:y,needReverse:$,fromCoin:i,toCoin:u,lpAmount:v,lpBalance:T,sliderVal:b,sFixD:vo,isSlider:A,fromCoinAmount:h,toCoinAmount:p,setPercent:wo,toRemove:Ko,addCommom:M,getCoinIcon:Z,isOnlyA:L,isOnlyB:ao,onlyToken:F,fixedFromCoin:q,maxBtnSelect:uo,halfBtnSelect:x,fromCoinBlance:so,toCoinBlance:co,showFromCoinLock:U,showToCoinLock:H,removeText:k,onlyTokenBalance:fo,totalWithdraw:Vo,formatter:s=>`${s}%`}}});const ee=o=>(Go("data-v-0c7e546f"),o=o(),Zo(),o),ks={class:"auto-pool-add"},ws={class:"auto-pool-add-content"},Is={class:"liquidity-action-tab"},$s=ee(()=>e("div",{class:"remove tab-active"},"Remove",-1)),Cs={class:"only-token"},As=ee(()=>e("div",null,"Deposit Amounts",-1)),Ss={key:0},Ps={key:0},Ts={key:0,class:"card-item"},Rs={key:1,class:"card-item"},qs={class:"remove-ratio"},Bs={class:"remove-ratio-select"},Os={key:0,class:"ratio"},Ns={key:1,class:"ratio"},Ms={class:"ratio-list"},Ls=["onClick"],Ds=ee(()=>e("span",null,"Pool Closed",-1)),Us={class:"remove-info"},Fs={key:0,class:"remove-text"},Vs={class:"total-amount"},Es=ee(()=>e("span",null,"Total Withdraw",-1)),Ws={class:"total-amount"},js=ee(()=>e("span",null,"LP Burn Amount",-1)),Xs={key:0},Hs={key:1};function zs(o,t,G,W,j,I){var n,$,i,u,y,v,T,A,R,X,h,p,g,U,H,K,q;const C=ke,b=we,r=Me,m=ge,l=$e;return _(),O("div",ks,[e("div",ws,[e("div",Is,[e("div",{class:"increase",onClick:t[0]||(t[0]=he(k=>o.$emit("changeCurrentTab"),["stop"]))},"Add"),$s]),e("div",Cs,[As,e("div",null,[e("div",{class:"only-a",onClick:t[1]||(t[1]=k=>o.onlyToken("only-a"))},[e("p",null,[o.isOnlyA?(_(),O("span",Ss)):io("",!0)]),e("span",null,d(o.needReverse?(u=(i=o.positionInfo)==null?void 0:i.token_b)==null?void 0:u.symbol:($=(n=o.positionInfo)==null?void 0:n.token_a)==null?void 0:$.symbol)+" only",1)]),e("div",{class:"only-b",onClick:t[2]||(t[2]=k=>o.onlyToken("only-b"))},[e("p",null,[o.isOnlyB?(_(),O("span",Ps)):io("",!0)]),e("span",null,d(o.needReverse?(A=(T=o.positionInfo)==null?void 0:T.token_a)==null?void 0:A.symbol:(v=(y=o.positionInfo)==null?void 0:y.token_b)==null?void 0:v.symbol)+" only",1)])])]),e("div",{class:re(o.needReverse?"card-container reverse":"card-container")},[(o.needReverse?!o.isOnlyA:!o.isOnlyB)?(_(),O("div",Ts,[E(C,{modelValue:o.fromCoinAmount,"onUpdate:modelValue":t[3]||(t[3]=k=>o.fromCoinAmount=k),"input-value":o.fromCoinAmount,"coin-symbol":o.fromCoin?o.fromCoin.symbol:null,"coin-name":o.fromCoin?o.fromCoin.name:null,balance:o.isOnlyA?o.onlyTokenBalance:o.fromCoinBlance,"coin-icon":o.fromCoin?o.fromCoin.logoURI:"",address:o.fromCoin?o.fromCoin.address:"","swap-direct":"From","import-page":"deposit","has-arrow":!1,"amount-leabl":"Available",onOnMax:t[4]||(t[4]=k=>o.maxBtnSelect("fromCoin")),onOnHalf:t[5]||(t[5]=k=>o.halfBtnSelect("fromCoin")),onOnInput:t[6]||(t[6]=k=>{o.isSlider=!1,o.fromCoinAmount=k}),onOnFocus:t[7]||(t[7]=()=>{o.isSlider=!1,o.fixedFromCoin=!0})},null,8,["modelValue","input-value","coin-symbol","coin-name","balance","coin-icon","address"]),o.showFromCoinLock?(_(),_o(b,{key:0})):io("",!0)])):io("",!0),(o.needReverse?!o.isOnlyB:!o.isOnlyA)?(_(),O("div",Rs,[E(C,{modelValue:o.toCoinAmount,"onUpdate:modelValue":t[8]||(t[8]=k=>o.toCoinAmount=k),"input-value":o.toCoinAmount,"coin-symbol":o.toCoin?o.toCoin.symbol:null,"coin-name":o.toCoin?o.toCoin.name:null,balance:o.isOnlyB?o.onlyTokenBalance:o.toCoinBlance,"swap-direct":"To","coin-icon":o.toCoin?o.toCoin.logoURI:"",address:o.toCoin?o.toCoin.address:"","import-page":"deposit","has-arrow":!1,"amount-leabl":"Available",onOnMax:t[9]||(t[9]=k=>o.maxBtnSelect("toCoin")),onOnHalf:t[10]||(t[10]=k=>o.halfBtnSelect("toCoin")),onOnInput:t[11]||(t[11]=k=>{o.isSlider=!1,o.toCoinAmount=k}),onOnFocus:t[12]||(t[12]=()=>{o.isSlider=!1,o.fixedFromCoin=!1})},null,8,["modelValue","input-value","coin-symbol","coin-name","balance","coin-icon","address"]),o.showToCoinLock?(_(),_o(b,{key:0})):io("",!0)])):io("",!0)],2),e("div",qs,[e("div",Bs,[Number(o.lpBalance)>=Number(o.lpAmount)?(_(),O("div",Os,d(o.sliderVal>0&&Number(("sFixD"in o?o.sFixD:D(vo))(o.sliderVal,2))<.01?"<0.01":("sFixD"in o?o.sFixD:D(vo))(o.sliderVal,2))+"% ",1)):(_(),O("div",Ns,"--")),e("div",Ms,[(_(!0),O(Oe,null,Ne(o.ratioArr,(k,Q)=>(_(),O("div",{key:Q,class:re(["ratio-item",o.sliderVal==k.value?"ratio-item-active":""]),onClick:()=>{o.isSlider=!0,o.sliderVal=k.value}},d(k.name),11,Ls))),128))])]),E(r,{value:o.sliderVal,"onUpdate:value":t[13]||(t[13]=k=>o.sliderVal=k),"tip-formatter":o.formatter},null,8,["value","tip-formatter"])])]),(R=o.positionInfo)!=null&&R.is_pause?(_(),_o(m,{key:0,class:"big-btn liquidity-btn",disabled:!0},{default:zo(()=>[Ds]),_:1})):o.wallet.connected?(_(),_o(m,{key:1,class:"big-btn liquidity-btn",disabled:o.removeLiquidityBtnDisabled,onClick:o.toRemove},{default:zo(()=>[e("span",null,d(o.removeLiquidityBtnText),1)]),_:1},8,["disabled","onClick"])):(_(),_o(m,{key:2,class:"big-btn",onClick:t[14]||(t[14]=k=>o.wallet.setIsShowWalletModal(!0))},{default:zo(()=>[e("span",null,d(o.$t("button.connectWallet")),1)]),_:1})),e("div",Us,[o.isOnlyA||o.isOnlyB?(_(),O("div",Fs,d(o.removeText),1)):io("",!0),e("div",Vs,[Es,e("span",null,d(o.totalWithdraw),1)]),e("div",Ws,[js,o.fromCoinAmount||o.toCoinAmount?(_(),O("span",Xs,d(("addCommom"in o?o.addCommom:D(M))(o.lpAmount))+" "+d(o.needReverse?(X=o.toCoin)==null?void 0:X.symbol:(h=o.fromCoin)==null?void 0:h.symbol)+"-"+d(o.needReverse?(p=o.fromCoin)==null?void 0:p.symbol:(g=o.toCoin)==null?void 0:g.symbol),1)):(_(),O("span",Hs,d(("addCommom"in o?o.addCommom:D(M))(o.lpAmount))+" "+d(o.needReverse?(U=o.toCoin)==null?void 0:U.symbol:(H=o.fromCoin)==null?void 0:H.symbol)+"-"+d(o.needReverse?(K=o.fromCoin)==null?void 0:K.symbol:(q=o.toCoin)==null?void 0:q.symbol),1))])]),o.isShowRemoveModal?(_(),_o(l,{key:3,"pool-info":o.positionInfo,"from-coin":o.positionInfo.token_a,"to-coin":o.positionInfo.token_b,onOnClose:t[15]||(t[15]=k=>o.isShowRemoveModal=!1)},null,8,["pool-info","from-coin","to-coin"])):io("",!0)])}const Ys=Fo(gs,[["render",zs],["__scopeId","data-v-0c7e546f"]]),Gs=Do({components:{AutoPoolV2Info:Ce,AutoPoolV2PositionRange:Ae,AutoPoolV2PoolComposition:Se,AutoPoolV2PoolLiquidity:Pe,AutoPoolV2PoolAdd:hs,AutoPoolV2PoolRemove:Ys},setup(){const o=Lo(),t=Mo(),G=ie(),W=f(()=>G),j=()=>{o.getAutoPoolAPY(),o.getAutoPoolList(),t.setPoolConfigList(W.value.chainName,W.value.filterCoinsObj)},I=w(),C=Uo();return go(()=>C.query.action,b=>{b&&(I.value=b)},{immediate:!0}),{clickRefresh:j,currentTab:I}}});const Zs={class:"auto-pool-detail-v2"},Js={class:"detail-top"},Ks={class:"detail-bottom pc-detail"},Qs={class:"detail-bottom-left"},xs={class:"detail-bottom-right"},ol={class:"h5-detail"};function el(o,t,G,W,j,I){const C=Te,b=Ce,r=Ae,m=Se,l=Pe,n=pe("AutoPoolV2PoolAdd"),$=pe("AutoPoolV2PoolRemove");return _(),O("div",Zs,[e("div",Js,[E(C,{onClickRefresh:o.clickRefresh},null,8,["onClickRefresh"]),E(b)]),e("div",Ks,[e("div",Qs,[E(r),E(m),E(l)]),e("div",xs,[o.currentTab=="add"?(_(),_o(n,{key:0,onChangeCurrentTab:t[0]||(t[0]=i=>o.currentTab="remove")})):(_(),_o($,{key:1,onChangeCurrentTab:t[1]||(t[1]=i=>o.currentTab="add")}))])]),e("div",ol,[o.currentTab=="add"?(_(),_o(n,{key:0,onChangeCurrentTab:t[2]||(t[2]=i=>o.currentTab="remove")})):(_(),_o($,{key:1,onChangeCurrentTab:t[3]||(t[3]=i=>o.currentTab="add")})),E(r),E(m),E(l)])])}const Al=Fo(Gs,[["render",el],["__scopeId","data-v-b226cf01"]]);export{Al as default};
