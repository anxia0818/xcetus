import{a as st,b as xt,n as ft,d as Pe,u as kt,e as Ee,c as qe,i as Zt,s as gt,T as Ct,p as Pt,f as je,g as Tt}from"./pool.6da076ac.js";import{a as it,r as X,m as L,y as At,D as Me,e as nt,o as h,f as O,c as xe,x as te,h as a,t as Lt,G as Gt,H as pt,v as ge,u as Ne,F as ut,J as wt,p as It,k as qt,i as ze,s as Mt,z as Qe,l as $t,E as yt,C as Rt,q as Kt,b as Jt,w as Qt,j as Yt,I as Vt,B as eo}from"./entry.02649e34.js";/* empty css              */import{s as at,m as to,l as oo,b as io,a as no,_ as ro}from"./transform.a807ea21.js";import{D as u}from"./decimal.0e8aa3f1.js";import{u as ct,a as ao}from"./sha256.49997ed8.js";import{_ as lo}from"./apr-tips.ad056adb.js";import"./decimal.633e31ee.js";import{g as so}from"./common-fun.c5073e67.js";import{c as Bt,_ as Ot,b as Ft,a as Ut}from"./new-liquidity-title.0b0faa92.js";import{i as bt}from"./import-icon.de3e6c66.js";import{positionError as ot,tickList as tt,direction as $e,minPrice as E,maxPrice as z,fromCoin as y,toCoin as _,currentPrice as lt,currentPriceReverse as ht,currentPriceTab as ee,defaultMinPrice as mt,defaultMaxPrice as vt,toggle as jt,isInputTotalAmount as We,priceConfigObj as Ke,fromCoinAmount as S,toCoinAmount as N,fixedFromCoin as Ce,resetTickList as St,resetData as uo}from"./data.180a5571.js";import{_ as co}from"./coin-select.1b79bf7e.js";import{_ as mo}from"./viewDetail.6610222c.js";import{_ as vo}from"./token-warning-modal.b9b96338.js";import{b as fo}from"./new-add-or-create.57b5e225.js";/* empty css              */import{u as go}from"./notifi.3f6a449e.js";import{_ as po,a as bo}from"./icon-Add-Liquidity_2x.0acb06cb.js";import"./img-lock_2x.1ac53eb1.js";import"./precision.a7a6c57b.js";/* empty css              */import"./tick.505fdad3.js";import"./token-warning.d5490d1c.js";/* empty css              */import"./refresh-icon.4546f4f8.js";/* empty css              */import"./swap-setting.2290883f.js";/* empty css              */import"./img-no-Positions_2x.e81e7930.js";import"./status-block.d042b45f.js";import"./icon-arrow_2x.948aedb2.js";import"./icon-arrow_2x.4ffddb8e.js";import"./icon-selected_3x.09e9a6f0.js";import"./useWhale.69eeac25.js";import"./index.8a40657b.js";function Nt(e,s,me){const H=new u(10).pow(s-me);return new u(1.0001).pow(e).mul(H)}const ho=it({props:{poolInfo:{type:Object,default:()=>({chartLoading:!1,token_a:{decimal:6},token_b:{decimal:6},currentLiquity:"50000000"})},minPrice:{type:String,default:""},maxPrice:{type:String,default:""},direction:{type:Boolean,default:!0},tickList:{type:Array,default:()=>[]},currentTick:{type:Number,default:0},chartLoading:{type:Boolean,default:!1},currentPriceTab:{type:String,default:""},before7dContractPriceLowest:{type:String,default:""},before7dContractPriceHighest:{type:String,default:""},zoom:{type:Number,default:1}},setup(e,s){const me=X(""),H=X(""),F=L(()=>{var i,g,r,A,U,V;return console.log(e.poolInfo,"===>props.poolInfo"),(i=e.poolInfo)!=null&&i.current_sqrt_price&&((g=e.poolInfo)!=null&&g.coinA.decimals)&&((r=e.poolInfo)!=null&&r.coinB.decimals)?l.sqrtPriceX64ToPrice((A=e.poolInfo)==null?void 0:A.current_sqrt_price,(U=e.poolInfo)==null?void 0:U.coinA.decimals,(V=e.poolInfo)==null?void 0:V.coinB.decimals).toString():"0"}),pe=L(()=>{let i=0;return e.direction?i=(Number(e.minPrice)/Number(F.value)-1)*100:i=(Number(e.minPrice)/Number(1/Number(F.value))-1)*100,i=i>0&&i<.1?.1:i,i=i<0&&i>-.1?-.1:i,i}),x=L(()=>{let i=0;return e.direction?i=(Number(e.maxPrice)/Number(F.value)-1)*100:i=(Number(e.maxPrice)/Number(1/Number(F.value))-1)*100,i=i>0&&i<.1?.1:i,i=i<0&&i>-.1?-.1:i,i}),I=ct(),k=L(()=>I),Q=L(()=>k.value.chainName?st(k.value.chainName):{}),{TickMath:l,getNearestTickByTick:n}=Q.value,Z=(i=[])=>{let g=6;const r=Math.abs(Number(i[0])-Number(i[i.length-1]));return r>=6?g=0:r>=1?g=1:r>=.1?g=2:r>=.01?g=3:r>=.001?g=4:r>=1e-4?g=5:r>=1e-5?g=6:r>=1e-6?g=7:r>=1e-7&&(g=8),g},re=(i,g=1)=>{if(i&&i.token_a&&!e.chartLoading&&e.minPrice&&e.maxPrice){const r=Number(e.poolInfo.current_tick_index);console.log("0117###dataProcessing###currentTick###",r),console.log("0117###dataProcessing###props.poolInfo###",e.poolInfo),console.log("0117###dataProcessing###minPrice###",e.minPrice),console.log("0117###dataProcessing###maxPrice###",e.maxPrice),console.log("0117###dataProcessing###poolInfo###",e.poolInfo);let A=r+100*g,U=r-100*g,V,ae;if(e.maxPrice==="∞")ae=Q.value.TickUtil.getMaxIndex(Number(e.poolInfo.tickSpacing));else try{e.direction?ae=l.priceToTickIndex(new u(e.maxPrice),e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals):ae=l.priceToTickIndex(new u(1).div(e.minPrice),e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals)}catch{ae=443636}if(e.minPrice==="0")V=Q.value.TickUtil.getMinIndex(Number(e.poolInfo.tickSpacing));else try{e.direction?V=l.priceToTickIndex(new u(e.minPrice),e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals):V=l.priceToTickIndex(new u(1).div(e.maxPrice),e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals)}catch{V=-443636}let ue=0;if(e.currentPriceTab!=="full range"){if(r>=V&&r<=ae){const T=r-V,ie=ae-r;ue=Math.max(Math.abs(T),Math.abs(ie))}else r<V?ue=Math.abs(ae-r):ue=Math.abs(r-V);A=r+ue+100*g,U=r-ue-100*g}else{const T=(Math.abs(r)>5e3,2e4);A=r+T*g,U=r-T*g}U<-443636&&(U=-443636),A>443636&&(A=443636);const m=new u(i.liquidity).div(Math.pow(10,8)).toString(),q=e.tickList;console.log("0117####drawChart####tick_info_array####",q);const R=[],C=[];let P={};for(let T=0;T<q.length;T++){if(P=q[T],P.index<=r&&P.index>=U){if(R.length<1&&T!==0){const ie=q[T-1];R.unshift({...ie,index:U})}R.unshift(P)}else if(P.index>r&&P.index<=A&&(C.push(P),R.length<1&&T!==0)){const ie=q[T-1];R.push({...ie,index:U})}if(P.index>A){const ie=q[T];if(C.push({...ie,index:A}),R.length<1&&T!==0){const Je=q[T-1];R.push({...Je,index:U})}break}}let D="0";for(let T=R.length-1;T>=0;T--)D=new u(D).plus(new u(R[T].liquidityNet.toString()).div(Math.pow(10,8))).toString(),R[T].liquityAmount=D;let M=m;for(let T=0;T<C.length;T++)M=new u(M).plus(new u(C[T].liquidityNet.toString()).div(Math.pow(10,8))).toString(),C[T].liquityAmount=M;let W=[];const $=q&&q.length>0?{index:r,liquityAmount:Number(m)}:{index:r,liquityAmount:0};(R.length>0||C.length>0)&&(W=[...R.reverse(),$,...C],e.direction||(W=W.reverse()));const Ae=[];q.forEach(T=>{Ae.push({...T,liquidityGross:T.liquidityGross.toString(),liquidityNet:T.liquidityNet.toString()})}),console.log("0117####drawChart####testTickInfoArray####",Ae),console.log("0117####drawChart####currentLiquity####",m),p(W,U,A,V,ae,r)}};let Y=X(!1);At(()=>{document.body.clientWidth<750?Y.value=!1:Y.value=!0,window.onresize=()=>{document.body.clientWidth<750?Y.value=!1:Y.value=!0,re(e.poolInfo,e.zoom)}});const p=(i,g,r,A,U,V)=>{console.log("0117####drawChart####chartData####",i),console.log("0117####drawChart####tickMin####",g),console.log("0117####drawChart####tickMax####",r),console.log("0117####drawChart####minPriceTick####",A),console.log("0117####drawChart####maxPriceTick####",U),console.log("0117####drawChart####currentTick####",V),console.log("0117####drawChart####props.direction####",e.direction),console.log("0518###newd3###props.before7dContractPriceLowest###",e.before7dContractPriceLowest),console.log("0518###newd3###props.before7dContractPriceHighest###",e.before7dContractPriceHighest);let ae,ue;e.direction?(ae=e.before7dContractPriceLowest?l.priceToTickIndex(new u(e.before7dContractPriceLowest),e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals):"",ue=e.before7dContractPriceHighest?l.priceToTickIndex(new u(e.before7dContractPriceHighest),e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals):""):(ae=e.before7dContractPriceLowest?l.priceToTickIndex(new u(1).div(e.before7dContractPriceLowest),e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals):"",ue=e.before7dContractPriceHighest?l.priceToTickIndex(new u(1).div(e.before7dContractPriceHighest),e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals):"");const m={top:30,right:35,bottom:20,left:55};let q,R;Y.value?(q=460-m.left-m.right,R=205-m.top-m.bottom):(q=340-m.left-m.right,R=205-m.top-m.bottom);const C=r-g,P=parseInt(String(C/4));let D=[g+P/4,g+P,g+2*P,r-P,r-P/4];const M=g,W=r,$=q/(W-M);e.currentPriceTab==="full range"&&(D=[g,g+2*P,r]),console.log("0117####drawChart####xArr####",D),console.log("0117####drawChart####utickMin####",M),console.log("0117####drawChart####utickMax####",W),console.log("0117####drawChart####unit####",$);const Ae=D.map(c=>e.direction?Nt(c,e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals).toString():new u(1).div(Nt(c,e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals)).toString()),T=Z(Ae);at("#chart").selectAll("*").remove();const ie=at("#chart").attr("width",q+m.left+m.right).attr("height",R+m.top+m.bottom).append("g").attr("transform",`translate(${m.left},${m.right})`),Je=to(i,function(c){return Number(Math.abs(c.liquityAmount))})||0,t=oo().range([0,R]).domain([Je,0]);io().rangeRound([0,q]).padding(.1);const B=ie.append("g").attr("id","barsBox").selectAll("rect").data(i).enter().append("rect");k.value.theme=="default"?B.attr("x",function(c,d){return d===0?0:e.direction?Math.abs(c.index-M)*$:Math.abs(W-c.index)*$}).attr("y",function(c,d){return e.direction?d===i.length-1?0:t(c.liquityAmount):d===i.length-1?0:t(i[d+1].liquityAmount)}).attr("width",function(c,d){return d===0&&i.length===1&&c.liquityAmount>0?q:(e.direction,d!==i.length-1?Math.abs(i[d+1].index-c.index)*$:0)}).attr("height",function(c,d){return d===0&&i.length===1&&c.liquityAmount>0?R:e.direction?d===i.length-1?0:R-t(c.liquityAmount):d===i.length-1?0:R-t(i[d+1].liquityAmount)}).attr("fill","#279477").attr("class","bars").attr("stroke-width",1).attr("stroke","#279477"):B.attr("x",function(c,d){return d===0?0:e.direction?Math.abs(c.index-M)*$:Math.abs(W-c.index)*$}).attr("y",function(c,d){return e.direction?d===i.length-1?0:t(Math.abs(c.liquityAmount)):d===i.length-1?0:t(Math.abs(i[d+1].liquityAmount))}).attr("width",function(c,d){return d===0&&i.length===1&&c.liquityAmount>0?q:(e.direction,d!==i.length-1?Math.abs(i[d+1].index-c.index)*$:0)}).attr("height",function(c,d){if(d===0&&i.length===1&&c.liquityAmount>0)return R;if(e.direction)return d===i.length-1?0:Number(c.liquityAmount)?R-t(Math.abs(c.liquityAmount)):0;{if(d===i.length-1)return 0;const Fe=R-t(Math.abs(i[d+1].liquityAmount));return Number(i[d+1].liquityAmount)?Fe:0}}).attr("fill","#407497").attr("class","bars").attr("stroke-width",1).attr("stroke","#407497");const j=ie.append("g");j.append("line").attr("x1",0).attr("y1",155).attr("x2",q).attr("y2",155).attr("stroke-width",1).attr("stroke","#50535D");const ke=j.append("g");let K=0;if(e.direction){for(let c=0;c<D.length;c++){const d=Pe(Ae[c],T)||"0";console.log("0423####price####",d),Ae.push(d);const Fe=Math.abs(D[c]-M)*$;let ve=0;for(let fe=0;fe<d.length;fe++)d[fe]==="1"?ve+=4.02:d[fe]==="."?ve+=2.64:d[fe]==="7"?ve+=5.48:ve+=6;console.log(Fe,"x=>>>"),ke.append("text").text(d).attr("x",Fe-ve/2).attr("y",168).attr("fill","rgba(255, 255, 255, 0.5").style("font-size","10")}K=Math.abs(V-M)*$}else{for(let c=D.length-1;c>=0;c--){const d=Pe(Ae[c],T)||0;Ae.push(d);const Fe=Math.abs(D[c]-W)*$;let ve=0;for(let fe=0;fe<d.length;fe++)d[fe]==="1"?ve+=4.02:d[fe]==="."?ve+=2.64:d[fe]==="7"?ve+=5.48:ve+=6;ke.append("text").text(d).attr("x",Fe-ve/2).attr("y",168).attr("fill","rgba(255, 255, 255, 0.5").style("font-size","10")}K=Math.abs(V-W)*$}(k.value.theme=="default"?ie.append("line").attr("x1",0).attr("y1",0).attr("x2",0).attr("y2",155).attr("stroke-width",2).attr("stroke","#68FFD8"):ie.append("line").attr("x1",0).attr("y1",0).attr("x2",0).attr("y2",155).attr("stroke-width",2).attr("stroke","#76C8FF")).attr("transform","translate("+K+", 0)");let we,He,Ze,Be;e.direction?(console.log("0525###d3###select###minPriceTick###",A),console.log("0525###d3###select###maxPriceTick###",U),console.log("0525###d3###select###props.minPrice###",e.minPrice),console.log("0525###d3###select###props.maxPrice###",e.maxPrice),we=A<M?-100:parseInt(String(Math.abs(A-M)*$)),He=U<M?-100:parseInt(String(Math.abs(U-M)*$)),Ze=ae<M?-100:Math.abs(ae-M)*$,Be=ue<M?-100:Math.abs(ue-M)*$):(He=A<M?-100:Math.abs(W-A)*$,we=U<M?-100:Math.abs(W-U)*$,Be=ae<M?-100:Math.abs(W-ae)*$,Ze=ue<M?-100:Math.abs(W-ue)*$),e.minPrice==="0"&&(we=0),e.maxPrice==="∞"&&(He=q),console.log(we,"==>minPriceTickX"),Y.value?me.value=q-we+155+"px":me.value=q-we+52+"px",H.value=He+74+"px",ae&&Ze<q&&ie.append("line").attr("x1",0).attr("y1",0).attr("x2",0).attr("y2",155).attr("stroke-width",1).attr("stroke-dasharray","5, 5").attr("stroke","rgba(255, 255, 255, 0.5)").attr("transform","translate("+Ze+", 0)"),ue&&Be<q&&ie.append("line").attr("x1",0).attr("y1",0).attr("x2",0).attr("y2",155).attr("stroke-width",1).attr("stroke-dasharray","5, 5").attr("stroke","rgba(255, 255, 255, 0.5)").attr("transform","translate("+Be+", 0)");const be=ie.append("g").attr("id","left-handle"),Oe=ie.append("g").attr("id","right-handle");k.value.theme=="default"?(be.append("line").attr("x1",0).attr("y1",0).attr("x2",0).attr("y2",155).attr("stroke-dasharray","5, 5").attr("stroke-width",2).attr("stroke","#68FFD8"),be.append("path").attr("d","M0 0 L12 0 L12 20 L0 20 Z").attr("fill","#333").attr("stroke","#333").attr("transform","translate(-1, 20) rotate(180)"),be.append("rect").attr("width",1).attr("height",7).attr("x",-9).attr("y",6).attr("fill","#68FFD8"),be.append("rect").attr("width",1).attr("height",10).attr("x",-7).attr("y",4.5).attr("fill","#68FFD8"),Oe.append("line").attr("x1",0).attr("y1",0).attr("x2",0).attr("y2",155).attr("stroke-dasharray","5, 5").attr("stroke-width",2).attr("stroke","#68FFD8"),Oe.append("path").attr("d","M0 0 L12 0 L12 20 L0 20 Z").attr("fill","#333").attr("stroke","#333").attr("transform","translate(1, 0)"),Oe.append("rect").attr("width",1).attr("height",7).attr("x",7).attr("y",6).attr("fill","#68FFD8"),Oe.append("rect").attr("width",1).attr("height",10).attr("x",5).attr("y",4.5).attr("fill","#68FFD8")):(be.append("line").attr("x1",0).attr("y1",0).attr("x2",0).attr("y2",155).attr("stroke-dasharray","5, 5").attr("stroke-width",2).attr("stroke","#76C8FF"),be.append("path").attr("d","M0 0 L12 0 L12 24 L0 24 Z").attr("fill","#333").attr("stroke","#333").attr("transform","translate(-1, 24) rotate(180)"),be.append("rect").attr("width",1).attr("height",7).attr("x",-9).attr("y",8).attr("fill","#76C8FF"),be.append("rect").attr("width",1).attr("height",10).attr("x",-7).attr("y",6.5).attr("fill","#76C8FF"),Oe.append("line").attr("x1",0).attr("y1",0).attr("x2",0).attr("y2",155).attr("stroke-dasharray","5, 5").attr("stroke-width",2).attr("stroke","#76C8FF"),Oe.append("path").attr("d","M0 0 L12 0 L12 24 L0 24 Z").attr("fill","#333").attr("stroke","#333").attr("transform","translate(1, 0)"),Oe.append("rect").attr("width",1).attr("height",7).attr("x",7).attr("y",8).attr("fill","#76C8FF"),Oe.append("rect").attr("width",1).attr("height",10).attr("x",5).attr("y",6.5).attr("fill","#76C8FF")),console.log("0525###d3###select###minPriceTickX###",we),console.log("0525###d3###select###maxPriceTickX###",He),be.attr("transform","translate("+we+", 0)"),Oe.attr("transform","translate("+He+", 0)");const Ye=no().extent([[0,0],[q,R]]).handleSize(30).on("end",rt);ie.append("g").attr("class","brush").call(Ye).call(Ye.move,[we,He]);function rt(c){if(!c.sourceEvent||!c.selection)return;be.attr("transform","translate("+c.selection[0]+", 0)"),Oe.attr("transform","translate("+c.selection[1]+", 0)"),Y.value?me.value=q-c.selection[0]+60+"px":me.value=q-c.selection[0]+52+"px",H.value=c.selection[1]+74+"px";let d,Fe;console.log("0525###d3###select###e.selection[0]###",c.selection[0]),console.log("0525###d3###select###e.selection[0]###",c.selection[1]),console.log("0525###d3###select###props.direction###",e.direction),console.log("0525###d3###select###width###",q),console.log("0525###d3###select###unit###",$),console.log("0525###d3###select###utickMin###",M),console.log("0525###d3###select###utickMax###",W),console.log("0525###d3###select###props.poolInfo###",e.poolInfo);let ve=0,fe=0;e.direction?(ve=n(parseInt(String(c.selection[0]/$+M)),Number(e.poolInfo.tickSpacing)),d=l.tickIndexToPrice(ve,e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals).toString(),fe=n(parseInt(String(c.selection[1]/$+M)),Number(e.poolInfo.tickSpacing)),Fe=l.tickIndexToPrice(fe,e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals).toString(),console.log("0525###d3###select###minTick###",ve),console.log("0525###d3###select###maxTick###",fe),console.log("0525###d3###select###minPrice###",d),console.log("0525###d3###select###maxPrice###",Fe)):(fe=n(W-c.selection[0]/$,Number(e.poolInfo.tickSpacing)),d=1/l.tickIndexToPrice(fe,e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals).toString(),ve=n(W-c.selection[1]/$,Number(e.poolInfo.tickSpacing)),Fe=1/l.tickIndexToPrice(ve,e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals).toString()),s.emit("onChangeMinPrice",String(Pe(String(d),6))),s.emit("onChangeMaxPrice",String(Pe(String(Fe),6)))}k.value.theme=="default"?at(".selection").attr("stroke","rgba(255, 255, 255, 0)").attr("fill","#15322C"):at(".selection").attr("stroke","rgba(255, 255, 255, 0)").attr("fill","#152632")};X(""),Me(()=>[e.poolInfo,e.minPrice,e.maxPrice,e.currentPriceTab,e.zoom],([i,g,r,A,U])=>{console.log(i,g,r,r>g,"poolInfo && minPrice && maxPrice && (maxPrice > minPrice)"),i&&g&&r&&(i!=null&&i.liquidity)&&(A!=="Custom"||console.log("绘制"),re(i,U))},{immediate:!0});const v=X(!1);return Me(()=>e.chartLoading,(i,g)=>{i!==g&&(v.value=i)},{immediate:!0,deep:!0}),console.log(e,"props===>"),{store:k,loading:v,rangeSizeLower:pe,rangeSizeUpper:x,rangeSizeLowerPosition:me,rangeSizeUpperPosition:H,decimalFormat:xt,numberformat:ft}}});const ko=e=>(It("data-v-a4488f02"),e=e(),qt(),e),wo={class:"chart-box"},yo={class:"chart"},_o=ko(()=>a("svg",{id:"chart"},null,-1));function Co(e,s,me,H,F,pe){const x=wt;return h(),O(ut,null,[e.tickList&&e.tickList.length>0&&e.loading?(h(),xe(x,{key:0})):te("",!0),a("div",wo,[Lt(a("div",yo,[e.currentPriceTab!=="full range"?(h(),O("div",{key:0,class:"range-size range-size-lower",style:pt({right:e.rangeSizeLowerPosition})},ge(("numberformat"in e?e.numberformat:Ne(ft))(e.rangeSizeLower.toFixed(1),1))+"% ",5)):te("",!0),e.currentPriceTab!=="full range"?(h(),O("div",{key:1,class:"range-size range-size-upper",style:pt({left:e.rangeSizeUpperPosition})},ge(("numberformat"in e?e.numberformat:Ne(ft))(e.rangeSizeUpper.toFixed(1),1))+"% ",5)):te("",!0),_o],512),[[Gt,!e.loading]])])],64)}const zt=nt(ho,[["render",Co],["__scopeId","data-v-a4488f02"]]),Po=it({props:{aprRewardsParameter:{type:Number,default:30},minPrice:{type:String,default:""},maxPrice:{type:String,default:""},fromCoin:{type:Object,default:()=>({})},toCoin:{type:Object,default:()=>({})},poolInfo:{type:Object,default:()=>({})},nameTab:{type:String,default:""}},setup(e){const s=[{label:"24H",value:24},{label:"7D",value:7},{label:"30D",value:30}],me=ct(),H=L(()=>me);L(()=>H.value.chainName);const F=kt(),pe=L(()=>F),x=L(()=>H.value.chainName?st(H.value.chainName):{}),I=X(),k=async n=>{var V,ae,ue;console.log("0607###detail###getAprMethod###poolInfo###",n),console.log("0607###detail###getAprMethod###props.fromCoin###",e.fromCoin),console.log("0607###detail###getAprMethod###props.toCoin###",e.toCoin),console.log("0607###detail###getAprMethod###props.nameTab###",e.nameTab);let Z;n.token_a.address.toLowerCase()===e.fromCoin.address.toLowerCase()&&n.token_b.address.toLowerCase()===e.toCoin.address.toLowerCase()?Z=!0:Z=!1,console.log("0607###detail###getAprMethod###directs###",Z),console.log("0607###detail###getAprMethod###props.minPrice###",e.minPrice),console.log("0607###detail###getAprMethod###props.maxPrice###",e.maxPrice);let re,Y;Z?(re=Number(e.minPrice),Y=Number(e.maxPrice)):e.maxPrice!=="∞"?(re=1/Number(e.maxPrice),Y=1/Number(e.minPrice)):(re=1/2**50,Y=2**50),console.log("0607###detail###getAprMethod###lowerUserPrice###",re),console.log("0607###detail###getAprMethod###upperUserPrice###",Y);let p=[];p=H.value&&H.value.addressHistTokens&&H.value.addressHistTokens[n.poolAddress]&&H.value.addressHistTokens[n.poolAddress].data&&H.value.addressHistTokens[n.poolAddress].data.length>0&&Object.fromEntries(H.value.addressHistTokens[n.poolAddress].data.map(m=>[m.key,m.value]));let v,i;console.log(p,"===>addressHistTokensList"),e.aprRewardsParameter==7?(v=Number(p==null?void 0:p.before_7_d_contract_price_lowest),i=Number(p==null?void 0:p.before_7_d_contract_price_highest)):e.aprRewardsParameter==24?(v=Number(p==null?void 0:p.before_24_h_contract_price_lowest),i=Number(p==null?void 0:p.before_24_h_contract_price_highest)):(v=Number(p==null?void 0:p.before_30_d_contract_price_lowest),i=Number(p==null?void 0:p.before_30_d_contract_price_highest));const g=pe.value.tokensObj;console.log("getEstPositionAPRWithMulti###params###lowerUserPrice###",re),console.log("getEstPositionAPRWithMulti###params###upperUserPrice###",Y),console.log("getEstPositionAPRWithMulti###params###lowerHistPrice###",v),console.log("getEstPositionAPRWithMulti###params###upperHistPrice###",i);const r=await x.value.getEstPositionAPRWithMulti(re,Y,v,i);console.log("getEstPositionAPRWithMulti###resMulti###",r.toString());const A=H.value.newTopPoolsObj[n.poolAddress];console.log(n,"#####stats");let U;if(A){e.aprRewardsParameter==7?U=Number(A.apr_7day.replace("%","")):e.aprRewardsParameter==24?U=Number(A.apr_24h.replace("%","")):U=Number(A.apr_30day.replace("%",""));const m=Number(A.rewarder_apr[0].replace("%","")),q=Number(A.rewarder_apr[1].replace("%","")),R=Number(A.rewarder_apr[2].replace("%","")),C=new u(r.toString()).mul(U).toNumber();console.log(r.toString(),"===>resMulti.toString()");const P=new u(r.toString()).mul(m).toNumber(),D=new u(r.toString()).mul(q).toNumber(),M=new u(r.toString()).mul(R).toNumber();console.log(P,D,M,"posRewarder2_apr##");const W=C+(n.rewarder_display1?P:0)+(n.rewarder_display2?D:0)+(n.rewarder_display3?M:0);console.log(W,"###aprPercentageTotal");const $=n.rewarder_infos[0]?(V=g[n.rewarder_infos[0].coinAddress])==null?void 0:V.symbol:"--",Ae=n.rewarder_infos[1]?(ae=g[n.rewarder_infos[1].coinAddress])==null?void 0:ae.symbol:"--",T=n.rewarder_infos[2]?(ue=g[n.rewarder_infos[2].coinAddress])==null?void 0:ue.symbol:"--",ie={aprFee:C==1/0||isNaN(C)?0:C,rewardAprList:[{rewarder_name:$,rewarder_apr:P==1/0||isNaN(P)?0:P,styleName:"one",rewarder_display:n.rewarder_display1},{rewarder_name:Ae,rewarder_apr:D==1/0||isNaN(D)?0:D,styleName:"two",rewarder_display:n.rewarder_display2},{rewarder_name:T,rewarder_apr:M==1/0||isNaN(M)?0:M,styleName:"three",rewarder_display:n.rewarder_display2}],aprPercentageTotal:W==1/0||isNaN(W)||W===0?0:W,aprPercentage:Zt(C/W,2),is_display_rewarder:n.is_display_rewarder};I.value=ie,console.log(I.value,"===>aprPercentageObj.value")}};Me(()=>[e.poolInfo,e.minPrice,e.maxPrice,H.value.addressHistTokens],([n,Z,re,Y])=>{n&&!qe(n)&&Y&&!qe(Y)&&k(n)},{immediate:!0});const Q=L(()=>so(e.poolInfo,pe,H));Me(()=>[e.aprRewardsParameter],()=>{k(e.poolInfo)});const l=L(()=>{const n=I.value;return n&&n.is_display_rewarder?(n==null?void 0:n.aprPercentageTotal)>1e4?">10000":n.aprPercentageTotal<.01&&n.aprPercentageTotal>0?"<0.01":Ee(n.aprPercentageTotal,2):n&&!n.is_display_rewarder?(n==null?void 0:n.aprFee)>1e4?">10000":n.aprFee<.01&&n.aprFee>0?"<0.01":Ee(n.aprFee,2):"--"});return{poolMoreInfo:Q,timeList:s,aprPercentageObj:I,totalApr:l}}}),To=""+globalThis.__publicAssetsURL("sui-image/farming.png");const _t=e=>(It("data-v-4e388208"),e=e(),qt(),e),So={class:"est-apr"},No=_t(()=>a("div",{class:"title"},"Estimated APR",-1)),Ao={class:"apr-total"},Lo={class:"apr-box"},Io={class:"apr-hover-content"},qo={key:0,class:"isFarming"},Mo=_t(()=>a("img",{src:To,alt:""},null,-1)),$o=_t(()=>a("div",{class:"hover-text"},"Farming rewards available",-1)),Ro=[Mo,$o],Bo={class:"time-list"},Oo=["onClick"];function Fo(e,s,me,H,F,pe){var I,k,Q,l;const x=lo;return h(),O("div",So,[No,a("div",Ao,[a("div",Lo,[a("span",null,ge(e.totalApr)+"%",1),a("div",Io,[ze(x,{"l-item":e.poolMoreInfo,"rewarder-info":(I=e.poolMoreInfo)==null?void 0:I.rewardes,class:"noHover apr-hover-con"},null,8,["l-item","rewarder-info"])])]),(k=e.poolInfo)!=null&&k.is_display_rewarder&&((Q=e.poolInfo)!=null&&Q.rewarderInfo)&&((l=e.poolInfo)==null?void 0:l.rewarderInfo.length)>0?(h(),O("div",qo,Ro)):te("",!0)]),a("div",Bo,[(h(!0),O(ut,null,Mt(e.timeList,n=>(h(),O("div",{key:n.value,class:Qe(["time-item",n.value==e.aprRewardsParameter?"time-item-active":""]),onClick:Z=>e.$emit("changeAprRewardsParameter",n.value)},ge(n.label),11,Oo))),128))])])}const Ht=nt(Po,[["render",Fo],["__scopeId","data-v-4e388208"]]),Uo=it({components:{NewLiquidityD3Chart:zt,NewLiquidityApr:Ht,NewLiquidityPrice:Bt},setup(){const{t:e,locale:s}=$t(),me=X("liquidity"),H=ct(),F=L(()=>H),pe=L(()=>F.value.chainName),x=kt(),I=L(()=>x),k=L(()=>F.value.chainName?st(F.value.chainName):{});At(()=>{ot.value=!1});const Q=yt(),l=L(()=>{let t=null;for(let b=0;b<I.value.poolConfigList.length;b++){const B=I.value.poolConfigList[b];B.address==Q.query.poolAddress&&(t=B)}return console.log(t,"===>basePoolInfo"),t}),n=L(()=>{let t=null;for(const b in I.value.poolsObj){const B=I.value.poolsObj[b];B.address==Q.query.poolAddress&&(console.log(B,"p===>"),t=B)}return t}),Z=X(),re=X(!0),Y=async(t,b)=>{if(b){re.value=!0;const B=t.token_a.decimals,j=t.token_b.decimals;console.log(t,"pool===>1111"),lt.value=Ct.sqrtPriceX64ToPrice(t==null?void 0:t.current_sqrt_price,B,j).toString(),ht.value=new u(1).div(Ct.sqrtPriceX64ToPrice(t==null?void 0:t.current_sqrt_price,B,j)).toString(),y.value=t.needReverse?t.token_b:t.token_a,_.value=t.needReverse?t.token_a:t.token_b,Z.value=t.needReverse,t.token_a.address.toLowerCase()===y.value.address.toLowerCase()&&t.token_b.address.toLowerCase()===_.value.address.toLowerCase()?$e.value=!0:$e.value=!1,console.log(t,"187===>"),console.log(t,"###pool===>");let ke={poolAddress:t.address,coinTypeA:t.coin_a_address,coinTypeB:t.coin_b_address};const K=await k.value.getTicks(ke);tt.value=K?k.value.getTickDataFromUrlData(K):[],console.log(tt.value,"===>chartLoadingtickList.value"),i(t)}re.value=!1,console.log(re.value,"==>chartLoading.value")},p=X([]),v=X(),i=t=>{const b=t.token_a.decimals,B=t.token_b.decimals;let j=I.value.poolPriceConfigObj&&I.value.poolPriceConfigObj[t.address]&&I.value.poolPriceConfigObj[t.address].recommend_ranges||{};const ke=I.value.poolPriceConfigObj&&I.value.poolPriceConfigObj[t.address]&&I.value.poolPriceConfigObj[t.address].type||"";console.log(j,"===>priceConfigList");let K,Re;const we=t.current_tick_index;v.value=t.current_tick_index,console.log(we,t.tickSpacing,"==>pool.tickSpacing"),K=we-Number(t.type=="unstable"?Number(t.tickSpacing)*2:Number(t.tickSpacing)*3),Re=we+Number(t.type=="unstable"?Number(t.tickSpacing)*2:Number(t.tickSpacing)*3);const He=k.value.TickMath.tickIndexToPrice(K,b,B).toString(),Ze=k.value.TickMath.tickIndexToPrice(Re,b,B).toString();j["full range"]={lower:k.value.TickUtil.getMinIndex(Number(n.value.tickSpacing)),upper:k.value.TickUtil.getMaxIndex(Number(n.value.tickSpacing))},j.custom={lower:K,upper:Re,minPrice:He,maxPrice:Ze};const Be=[];for(let be in j)j[be]&&(console.log(be,"j==>"),Be.push({...j[be],key:be}));console.log(Be,"priceList"),console.log(t,"###pool.type 504"),ke?t.isSelfBuilt?ee.value="custom":ke=="stable"?ee.value="suggested":ee.value="passive":ee.value="custom",p.value=Be,Ke.value=j,A({key:ee.value,...j[ee.value]})},g=X(""),r=X(""),A=t=>{console.log("priceTab====>",t),console.log("priceTab###poolInfo###",n.value),ee.value=t.key.toLowerCase();const b=n.value.token_a.decimals,B=n.value.token_b.decimals,{lower:j,upper:ke}=t;We.value=!1;const K=k.value.TickMath.tickIndexToPrice(j,b,B).toString(),Re=k.value.TickMath.tickIndexToPrice(ke,b,B).toString();if(t.key=="full range"){g.value=j,r.value=ke,U();return}console.log($e.value,"===>direct.value"),$e.value?(mt.value=String(K),E.value=String(K),vt.value=String(Re),z.value=String(Re),g.value=j,r.value=ke):(mt.value=String(1/Number(Re)),E.value=String(1/Number(Re)),vt.value=String(1/Number(K)),z.value=String(1/Number(K)),g.value=k.value.TickMath.priceToTickIndex(new u(1/Number(Re)),b,B),r.value=k.value.TickMath.priceToTickIndex(new u(1/Number(K)),b,B)),console.log(E.value,z.value,"===>111")},U=t=>{E.value="0",z.value="∞"};Me(()=>n.value,(t,b)=>{console.log(b,"===>oldVal"),console.log(t,"===>newVal"),(!b&&t&&!qe(t)||b&&t&&b.address!==t.address)&&(console.log("池子信息"),Y(t,!b||t.address!==b.address))},{immediate:!0}),Rt(()=>{tt.value=[]}),Me(()=>[l.value,n.value,I.value.recommendRangesObj],(t,b)=>{var B,j;console.log(t,"===>newValue369"),console.log(b,"===>oldValue369"),(!b||t[0]&&t[1]&&t[2]&&!qe(t[0])&&!qe(t[1]&&!qe(t[2]))||((B=t[0])==null?void 0:B.address)!==((j=b[0])==null?void 0:j.address))&&(console.log("3731111111"),t[0]&&t[2]&&!qe(t[0])&&!qe(t[2])&&(console.log(t[0],t[2],"======>374"),x.setSinglePool(t[0],t[2],pe.value)))},{immediate:!0,deep:!0});const V=t=>{if(pe.value=="Sui")switch(t){case"passive":return"/sui-image/icon_ conservative@2x.png";case"active":return"/sui-image/icon_active@2x.png";case"full range":return"/sui-image/icon_fullrange@2x.png";case"custom":return"/sui-image/icon_costom@2x.png";case"suggested":return"/sui-image/icon_stabel@2x.png"}else switch(t){case"passive":return"/image/icon_ conservative@2x.png";case"active":return"/image/icon_active@2x.png";case"full range":return"/image/icon_fullrange@2x.png";case"custom":return"/image/icon_costom@2x.png";case"suggested":return"/image/icon_stabel@2x.png"}},ae=t=>{switch(t){case"suggested":return e("newAdd.suggested");case"active":return e("newAdd.active");case"passive":return e("newAdd.conservative");case"full range":return e("newAdd.fullRange");case"custom":return e("newAdd.custom")}},ue=t=>{var B,j;const b=I.value.poolPriceConfigObj&&I.value.poolPriceConfigObj[(B=n.value)==null?void 0:B.address]&&I.value.poolPriceConfigObj[(j=n.value)==null?void 0:j.address].type||"";if(console.log(b,t,"==>poolType"),b=="unstable")switch(t){case"active":return{top:"35%"};case"passive":return{top:"10%"};case"full range":return{top:"60%"};case"custom":return{top:"85%"}}else switch(t){case"suggested":return{top:"23%"};case"full range":return{top:"48%"};case"custom":return{top:"73%"}}},m=X(1),q=()=>{const t=m.value/2;m.value=t},R=()=>{const t=m.value*2;m.value=t};console.log(p.value,"==>priceTablList");const C=L(()=>{var t,b,B;return!n.value||qe(F.value.addressHistTokens)||!F.value.addressHistTokens[(t=n.value)==null?void 0:t.poolAddress]?null:Object.fromEntries((B=F.value.addressHistTokens[(b=n.value)==null?void 0:b.poolAddress])==null?void 0:B.data.map(j=>[j.key,j.value]))}),P=X(30),D=X("30D"),M=L(()=>$e.value?C.value&&Pe(P.value==7?C.value.before_7_d_contract_price_lowest:P.value==24?C.value.before_24_h_contract_price_lowest:C.value.before_30_d_contract_price_lowest,6)||0:C.value&&Pe(new u(1).div(P.value==7?C.value.before_7_d_contract_price_highest:P.value==24?C.value.before_24_h_contract_price_highest:C.value.before_30_d_contract_price_highest).toString(),6)||0),W=L(()=>$e.value?C.value&&Pe(P.value==7?C.value.before_7_d_contract_price_highest:P.value==24?C.value.before_24_h_contract_price_highest:C.value.before_30_d_contract_price_highest,6)||0:(C.value&&Pe(1/Number(P.value==7?C.value.before_7_d_contract_price_lowest:P.value==24?C.value.before_24_h_contract_price_lowest:C.value.before_30_d_contract_price_lowest),6))==1/0?0:C.value&&Pe(1/Number(P.value==7?C.value.before_7_d_contract_price_lowest:P.value==24?C.value.before_24_h_contract_price_lowest:C.value.before_30_d_contract_price_lowest),6)||0),$=L(()=>{const t=Number(E.value),b=Number(z.value);return E.value&&z.value&&E.value!=="0"&&z.value!=="∞"?gt(1/(1-Number((t/b)**.25)),2)+"x":1}),Ae=L(()=>{var t,b,B,j,ke,K;return((t=y.value)==null?void 0:t.isSelfBuilt)||((b=_.value)==null?void 0:b.isSelfBuilt)||((j=I.value.tokensObj[(B=y.value)==null?void 0:B.address])==null?void 0:j.isSelfBuilt)||((K=I.value.tokensObj[(ke=_.value)==null?void 0:ke.address])==null?void 0:K.isSelfBuilt)}),T=t=>{console.log(t,"####0731 priceRangeChangeMin"),t!==E.value&&ee.value=="full range"?(console.log(p.value,"===>priceTablList"),A({key:"custom",...p.value.custom})):ee.value!=="full range"&&ee.value!=="custom"?(ee.value="custom",E.value=t):E.value=t},ie=t=>{t!==z.value&&ee.value=="full range"?A({key:"custom",...p.value.custom}):ee.value!=="full range"&&ee.value!=="custom"?(ee.value="custom",z.value=t):z.value=t};return console.log(E.value,z.value,"683==>"),Me(()=>[E.value,z.value],([t,b])=>{console.log(t,b,"minmax new-liquidity-left")},{deep:!0,immediate:!0}),{positionError:ot,getCoinIcon:t=>{var b;return(t==null?void 0:t.logoURI)||(t==null?void 0:t.logo_url)||((b=I.value.tokensObj[t==null?void 0:t.address])==null?void 0:b.logo_url)||(F.value.theme==="default"?bt("/image/coins/unknown.png"):bt("/image/coins/sui-unknown.png"))},chainName:pe,store:F,currentTab:me,currentPrice:lt,currentPriceReverse:ht,fromCoin:y,toCoin:_,direction:$e,needReverse:Z,addCommom:Ee,decimalUi:Pe,priceTablList:p,currentPriceTab:ee,sliderStyle:ue,poolInfo:n,tickList:tt,getPriceTabImage:V,getPriceTabText:ae,defaultMinPrice:mt,defaultMaxPrice:vt,minPrice:E,maxPrice:z,currentTick:v,chartLoading:re,zoomOut:q,zoomIn:R,zoom:m,priceTab:A,before7dContractPriceLowest:M,before7dContractPriceHighest:W,aprRewardsTime:D,lever:$,aprRewardsParameter:P,isSelfBuilt:Ae,priceRangeChangeMin:T,priceRangeChangeMax:ie,toggle:jt}}});const jo={class:"new-liquidity-left"},zo={class:"select-range"},Ho=a("span",null,"Select Range",-1),Do={class:"range-tab"},Wo=["src"],Eo=["src"],Xo=a("span",null,"Liquidity",-1),xo=["src"],Zo=["src"],Go=a("span",null,"Price",-1),Ko={class:"price-info"},Jo={class:"left"},Qo={class:"base-coin"},Yo={class:"base-coin-title"},Vo=a("svg",{class:"icon icon-up","aria-hidden":"true"},[a("use",{"xlink:href":"#icon-exchange_up1"})],-1),ei=a("svg",{class:"icon icon-down","aria-hidden":"true"},[a("use",{"xlink:href":"#icon-exchange_down1"})],-1),ti=[Vo,ei],oi={class:"base-coin-bottom"},ii={alt:""},ni={class:"leverage"},ri=a("div",{class:"leverage-title"},"Leverage",-1),ai={class:"laverage-value"},li={class:"current-price"},si=a("div",{class:"current-price-title"},"Current Price",-1),ui={key:0,class:"from-pre-to"},ci={class:"right"},di={class:"price-range"},mi={class:"left"},vi={class:"price-slider"},fi={class:"slider"},gi=a("div",{class:"slider-ratio-content"},null,-1),pi=[gi],bi={class:"price-tab-list"},hi=["onClick"],ki=["src"],wi={class:"right"},yi={class:"range-tab"},_i=["src"],Ci=["src"],Pi=a("span",null,"Liquidity",-1),Ti=["src"],Si=["src"],Ni=a("span",null,"Price",-1),Ai={class:"price-zoom"},Li={class:"current-price"},Ii=a("div",{class:"current-price-title"},"Current Price",-1),qi={key:0,class:"from-pre-to"},Mi={class:"price-zoom-right"},$i={class:"leverage"},Ri={class:"left"},Bi={key:0,class:"leverage-title"},Oi={key:1,class:"laverage-value"},Fi={class:"right"},Ui={key:0,class:"day-7-price-range"},ji=a("i",null,null,-1),zi={class:"gray"},Hi={class:"apr-and-price"},Di={key:0,class:"position-tips"},Wi=["src"],Ei={class:"error"};function Xi(e,s,me,H,F,pe){var n,Z,re,Y,p,v,i,g;const x=zt,I=wt,k=Ht,Q=Bt,l=Kt("image");return h(),O("div",jo,[a("div",zo,[Ho,a("div",Do,[a("div",{class:Qe(["liquidity",e.currentTab=="liquidity"?"liquidity-tab-active":""]),onClick:s[0]||(s[0]=r=>e.currentTab="liquidity")},[e.chainName=="Sui"?(h(),O("img",{key:0,src:e.currentTab=="liquidity"?"/sui-image/Liquidity-Sel.png":"/sui-image/Liquidity-Def.png",alt:""},null,8,Wo)):(h(),O("img",{key:1,src:e.currentTab=="liquidity"?"/image/green_chart.png":"/sui-image/Liquidity-Def.png",alt:""},null,8,Eo)),Xo],2),a("div",{class:Qe(["price",e.currentTab=="price"?"price-tab-active":""]),onClick:s[1]||(s[1]=r=>e.currentTab="price")},[e.chainName=="Sui"?(h(),O("img",{key:0,src:e.currentTab=="price"?"/sui-image/Price-Sel.png":"/sui-image/Price-Def.png",alt:""},null,8,xo)):(h(),O("img",{key:1,src:e.currentTab=="price"?"/image/price-chart.png":"/sui-image/Price-Def.png",alt:""},null,8,Zo)),Go],2)])]),a("div",Ko,[a("div",Jo,[a("div",Qo,[a("div",Yo,[a("span",null,"Base coin"+ge(!e.direction),1),a("div",{class:"change-price",onClick:s[2]||(s[2]=(...r)=>e.toggle&&e.toggle(...r))},ti)]),a("div",oi,[Lt(a("img",ii,null,512),[[l,e.getCoinIcon(e.fromCoin)]]),a("span",null,ge((n=e.fromCoin)==null?void 0:n.symbol),1)])]),a("div",ni,[ri,a("div",ai,ge(e.lever),1)]),a("div",li,[si,a("div",null,[a("span",null,ge(e.poolInfo?e.direction?("addCommom"in e?e.addCommom:Ne(Ee))(("decimalUi"in e?e.decimalUi:Ne(Pe))(e.currentPrice,6)):("addCommom"in e?e.addCommom:Ne(Ee))(("decimalUi"in e?e.decimalUi:Ne(Pe))(e.currentPriceReverse,6)):"--"),1),e.fromCoin&&e.toCoin?(h(),O("span",ui,ge((Z=e.toCoin)==null?void 0:Z.symbol)+" per "+ge((re=e.fromCoin)==null?void 0:re.symbol),1)):te("",!0)])])]),a("div",ci,[e.currentTab=="liquidity"?(h(),O("div",{key:0,class:"zoom-in",onClick:s[3]||(s[3]=(...r)=>e.zoomIn&&e.zoomIn(...r))}," - ")):te("",!0),e.currentTab=="liquidity"?(h(),O("div",{key:1,class:"zoom-out",onClick:s[4]||(s[4]=(...r)=>e.zoomOut&&e.zoomOut(...r))}," + ")):te("",!0)])]),a("div",di,[a("div",mi,[a("div",vi,[a("div",fi,[a("div",{class:"slider-ratio",style:pt(e.sliderStyle(e.currentPriceTab))},pi,4)])]),a("div",bi,[(h(!0),O(ut,null,Mt(e.priceTablList,r=>(h(),O("div",{key:r.key,class:Qe(["price-tab-item",e.currentPriceTab==r.key?"price-tab-item-active":""]),onClick:A=>e.priceTab(r)},[a("img",{src:e.getPriceTabImage(r.key),alt:""},null,8,ki),a("span",null,ge(e.getPriceTabText(r.key)),1)],10,hi))),128))])]),a("div",wi,[a("div",yi,[a("div",{class:Qe(["liquidity",e.currentTab=="liquidity"?"liquidity-tab-active":""]),onClick:s[5]||(s[5]=r=>e.currentTab="liquidity")},[e.chainName=="Sui"?(h(),O("img",{key:0,src:e.currentTab=="liquidity"?"/sui-image/Liquidity-Sel.png":"/sui-image/Liquidity-Def.png",alt:""},null,8,_i)):(h(),O("img",{key:1,src:e.currentTab=="liquidity"?"/image/green_chart.png":"/sui-image/Price-Def.png",alt:""},null,8,Ci)),Pi],2),a("div",{class:Qe(["price",e.currentTab=="price"?"price-tab-active":""]),onClick:s[6]||(s[6]=r=>e.currentTab="price")},[e.chainName=="sui"?(h(),O("img",{key:0,src:e.currentTab=="price"?"/sui-image/Price-Sel.png":"/sui-image/Price-Def.png",alt:""},null,8,Ti)):(h(),O("img",{key:1,src:e.currentTab=="price"?"/image/price-chart.png":"/sui-image/Liquidity-Def.png",alt:""},null,8,Si)),Ni],2)]),a("div",Ai,[a("div",Li,[Ii,a("div",null,[a("span",null,ge(e.poolInfo?e.direction&&!e.needReverse?("addCommom"in e?e.addCommom:Ne(Ee))(("decimalUi"in e?e.decimalUi:Ne(Pe))(e.currentPrice,6)):("addCommom"in e?e.addCommom:Ne(Ee))(("decimalUi"in e?e.decimalUi:Ne(Pe))(e.currentPriceReverse,6)):"--"),1),e.fromCoin&&e.toCoin?(h(),O("span",qi,ge(e.direction&&!e.needReverse?`${(Y=e.fromCoin)==null?void 0:Y.symbol} per ${(p=e.toCoin)==null?void 0:p.symbol}`:`${(v=e.toCoin)==null?void 0:v.symbol} per ${(i=e.fromCoin)==null?void 0:i.symbol}`),1)):te("",!0)])]),a("div",Mi,[e.currentTab=="liquidity"?(h(),O("div",{key:0,class:"zoom-in",onClick:s[7]||(s[7]=(...r)=>e.zoomIn&&e.zoomIn(...r))}," - ")):te("",!0),e.currentTab=="liquidity"?(h(),O("div",{key:1,class:"zoom-out",onClick:s[8]||(s[8]=(...r)=>e.zoomOut&&e.zoomOut(...r))}," + ")):te("",!0)])]),e.fromCoin&&e.toCoin&&e.poolInfo&&e.currentTab=="liquidity"?(h(),xe(x,{key:0,"pool-info":e.poolInfo,"min-price":e.minPrice,"max-price":e.maxPrice,direction:e.direction,"current-price-tab":e.currentPriceTab,"tick-list":e.tickList,"current-tick":e.currentTick,"chart-loading":e.chartLoading,zoom:e.zoom,"before7d-contract-price-lowest":e.before7dContractPriceLowest,"before7d-contract-price-highest":e.before7dContractPriceHighest,onOnChangeMinPrice:e.priceRangeChangeMin,onOnChangeMaxPrice:e.priceRangeChangeMax},null,8,["pool-info","min-price","max-price","direction","current-price-tab","tick-list","current-tick","chart-loading","zoom","before7d-contract-price-lowest","before7d-contract-price-highest","onOnChangeMinPrice","onOnChangeMaxPrice"])):te("",!0),((g=e.tickList)==null?void 0:g.length)<=0&&e.chartLoading?(h(),xe(I,{key:1})):te("",!0)])]),a("div",$i,[a("div",Ri,[e.currentPriceTab!=="full range"?(h(),O("div",Bi,"Leverage")):te("",!0),e.currentPriceTab!=="full range"?(h(),O("div",Oi,ge(e.lever),1)):te("",!0)]),a("div",Fi,[e.poolInfo&&(e.before7dContractPriceLowest||e.before7dContractPriceHighest)?(h(),O("div",Ui,[ji,a("span",zi,ge(e.aprRewardsParameter==7?"7D":e.aprRewardsParameter==24?"24H":"30D")+" Price Range",1),a("span",null,ge(("addCommom"in e?e.addCommom:Ne(Ee))(("decimalUi"in e?e.decimalUi:Ne(Pe))(e.before7dContractPriceLowest,6)))+" - "+ge(("addCommom"in e?e.addCommom:Ne(Ee))(("decimalUi"in e?e.decimalUi:Ne(Pe))(e.before7dContractPriceHighest,6))),1)])):te("",!0)])]),a("div",Hi,[ze(k,{"apr-rewards-parameter":e.aprRewardsParameter,"name-tab":"deposit","from-coin":e.fromCoin,"to-coin":e.toCoin,"pool-info":e.poolInfo,"min-price":e.minPrice,"max-price":e.maxPrice,onChangeAprRewardsParameter:s[9]||(s[9]=r=>{e.aprRewardsParameter=r})},null,8,["apr-rewards-parameter","from-coin","to-coin","pool-info","min-price","max-price"]),ze(Q,{min:e.minPrice,max:e.maxPrice,"from-coin":e.fromCoin,"to-coin":e.toCoin,direct:e.direction,"default-min-price":e.defaultMinPrice,"default-max-price":e.defaultMaxPrice,"pool-info":e.poolInfo,loading:e.chartLoading,"current-price-tab":e.currentPriceTab,onOnChangeMinPrice:e.priceRangeChangeMin,onOnChangeMaxPrice:e.priceRangeChangeMax},null,8,["min","max","from-coin","to-coin","direct","default-min-price","default-max-price","pool-info","loading","current-price-tab","onOnChangeMinPrice","onOnChangeMaxPrice"]),e.positionError&&e.poolInfo?(h(),O("div",Di,[a("img",{src:("importIcon"in e?e.importIcon:Ne(bt))("/image/icon-tips-error@2x.png"),alt:""},null,8,Wi),a("p",Ei,ge(e.$t("tips.positionError")),1)])):te("",!0)])])}const Dt=nt(Uo,[["render",Xi]]),xi=it({components:{NewLiquidityTitle:Ot,NewLiquidityAssetsCard:Ft,NewLiquidityDepositRatio:Ut},setup(){const{t:e,locale:s}=$t(),me=ct(),H=L(()=>me),F=L(()=>H.value.chainName),pe=kt(),x=L(()=>pe),I=ao(),k=L(()=>I),Q=yt(),l=L(()=>{let o=null;for(const f in x.value.poolsObj){const w=x.value.poolsObj[f];w.address==Q.query.poolAddress&&(console.log(w,"p===>"),o=w)}return o}),n=X(!1),Z=X(!1),re=L(()=>H.value.theme),Y=async(o,f)=>{y.value=o.needReverse?o.token_b:o.token_a,_.value=o.needReverse?o.token_a:o.token_b};Me(()=>l.value,(o,f)=>{console.log(f,"===>oldVal"),console.log(o,"===>newVal"),(!f&&o&&!qe(o)||f&&o&&f.address!==o.address)&&(console.log("池子信息"),Y(o,!f||o.address!==f.address))},{immediate:!0});const p=L(()=>k.value.assets&&y.value&&k.value.assets[y.value.address]?Pt(k.value.assets[y.value.address].balance,y.value.decimals):"0"),v=L(()=>k.value.assets&&_.value&&k.value.assets[_.value.address]?Pt(k.value.assets[_.value.address].balance,_.value.decimals):"0"),i=o=>{o==="fromCoin"?(Ce.value=!0,F.value==="Aptos"?S.value=Number(p.value)>0?y.value.symbol=="APT"?new u(Number(p.value)).sub(new u(.1)).lt(new u(0))?"0":new u(Number(p.value)).sub(new u(.1)).toString():String(p.value):"":S.value=Number(p.value)>0?y.value.symbol=="SUI"?new u(Number(p.value)).sub(new u(.05)).lt(new u(0))?"0":new u(Number(p.value)).sub(new u(.05)).toString():String(p.value):""):(Ce.value=!1,F.value==="Aptos"?N.value=Number(v.value)>0?_.value.symbol=="APT"?new u(Number(v.value)).sub(new u(.1)).lt(new u(0))?"0":new u(Number(v.value)).sub(new u(.1)).toString():String(v.value):"":N.value=Number(v.value)>0?_.value.symbol=="SUI"?new u(Number(v.value)).sub(new u(.05)).lt(new u(0))?"0":new u(Number(v.value)).sub(new u(.05)).toString():String(v.value):"")},g=o=>{o==="fromCoin"?(Ce.value=!0,S.value=Number(p.value)>0?gt(new u(Number(p.value)).div(2).toString(),y.value.decimals).toString():""):(Ce.value=!1,N.value=Number(v.value)>0?gt(new u(Number(v.value)).div(2).toString(),_.value.decimals).toString():"")},r=X(),A=X(),U=X(),V=X(!1),ae=o=>{var f,w,le,G;r.value=o,o==="fromCoin"?(A.value=((f=_.value)==null?void 0:f.address)||"",U.value=Q.query.actions=="new-position"?(w=y.value)==null?void 0:w.address:l.value.needReverse?l.value.token_b.address:l.value.token_a.address):(A.value=((le=y.value)==null?void 0:le.address)||"",U.value=Q.query.actions=="new-position"?(G=_.value)==null?void 0:G.address:l.value.needReverse?l.value.token_a.address:l.value.token_b.address),V.value=!0,console.log(V.value,"==>showCoinSelect.value ")},ue=o=>{var le,G,se,ce,de,ne,oe,ye;const f=l.value.needReverse?l.value.token_b:l.value.token_a,w=l.value.needReverse?l.value.token_a:l.value.token_b;r.value==="fromCoin"?(((le=y.value)==null?void 0:le.address)===(f==null?void 0:f.address)||!((G=y.value)!=null&&G.address)?(_.value&&o.address.toLowerCase()===((se=_)==null?void 0:se.value.address.toLowerCase())&&(_.value=null),y.value=o):(y.value&&o.address.toLowerCase()===((ce=y)==null?void 0:ce.value.address.toLowerCase())&&(y.value=null),_.value=o),Q.query.action||(Q.query.fee="")):((de=_.value)==null?void 0:de.address)===(w==null?void 0:w.address)||!((ne=_.value)!=null&&ne.address)?(y.value&&o.address.toLowerCase()===((oe=y)==null?void 0:oe.value.address.toLowerCase())&&(y.value=null),_.value=o):(_.value&&o.address.toLowerCase()===((ye=_)==null?void 0:ye.value.address.toLowerCase())&&(_.value=null),y.value=o),V.value=!1},m=L(()=>H.value.chainName?st(H.value.chainName):{}),q=L(()=>H.value.slippage),R=X(),C=async()=>{var Ue,Se,Le,Ie;if(We.value)return console.log("跳出"),!1;if(!E.value&&!z.value)return!1;if(!S.value&&!N.value&&!E.value&&!z.value)return;const o=l.value||{};if(qe(o))return;const{TickUtil:f,TickMath:w,getNearestTickByTick:le}=m.value,G=o==null?void 0:o.token_a.decimals,se=o==null?void 0:o.token_b.decimals;let ce,de,ne,oe,ye,Te,Xe,Ge,he=o==null?void 0:o.current_tick_index,J;if(o.token_a.address.toLowerCase()===y.value.address.toLowerCase()&&o.token_b.address.toLowerCase()===_.value.address.toLowerCase()?J=!0:J=!1,E.value==="0"&&z.value==="∞")ne=f.getMinIndex(Number(o.tickSpacing)),oe=f.getMaxIndex(Number(o.tickSpacing)),ye=w.tickIndexToSqrtPriceX64(ne),Te=w.tickIndexToSqrtPriceX64(oe),console.log(ne,oe,"#######updateAmounts 513");else if(ee.value=="custom"){console.log(J,"===>directs1866"),J?(ce=Number(E.value),de=Number(z.value)):(ce=new u(1).div(z.value).toString(),de=new u(1).div(E.value).toString());try{Xe=ce==0?-443636:w.priceToTickIndex(new u(ce),G,se)}catch{Xe=-443636}try{Ge=w.priceToTickIndex(new u(de),G,se)}catch{Ge=443636}ne=le(Xe,Number(o.tickSpacing)),oe=le(Ge,Number(o.tickSpacing)),ye=w.priceToSqrtPriceX64(new u(ce),G,se);try{Te=w.priceToSqrtPriceX64(new u(de),G,se)}catch{console.log("0523###test###max###",de),de===1/0&&(console.log("0523###test###max###11111"),Te=w.tickIndexToSqrtPriceX64(f.getMaxIndex(Number(o.tickSpacing))))}console.log("0518###pre###tick_lower###",ne,oe,he),console.log("0518###pre###tick_upper###",oe)}else ne=(Ue=Ke.value[ee.value])==null?void 0:Ue.lower,oe=(Se=Ke.value[ee.value])==null?void 0:Se.upper,ye=w.tickIndexToSqrtPriceX64(ne),Te=w.tickIndexToSqrtPriceX64(oe);if(z.value!=="∞"&&ne>=oe){n.value=!0,S.value="",Z.value=!0,N.value="";return}if(console.log(oe,he,ne,"1922"),z.value==="∞"||he>=ne&&he<=oe){n.value=!1,Z.value=!1;let _e;if(S.value||N.value){if(Ce.value){const dt=new u(S.value).mul(Math.pow(10,y.value.decimals)).toString();_e=new je(dt)}else{const dt=new u(N.value).mul(Math.pow(10,_.value.decimals)).toString();_e=new je(dt)}console.log(J,"======>directs");const{liquidityAmount:De,tokenMaxA:Ve,tokenMaxB:et,tokenMaxAOrigin:Et,tokenMaxBOrigin:Xt}=m.value.estLiquidityAndcoinAmountFromOneAmounts({tokenA:o.token_a,tokenB:o.token_b,lowerTick:ne,upperTick:oe,coinAmount:_e,iscoinA:J?Ce.value:!Ce.value,roundUp:!0,slippage:Number(q.value)/100,curSqrtPrice:new je(o.current_sqrt_price)});R.value={liquidityAmount:De,tokenMaxA:Ve,tokenMaxB:et,tokenMaxAOrigin:Et,tokenMaxBOrigin:Xt},console.log(Ve,et,"preAdd"),J?Ce.value?N.value=Number(et)>0?et:"":S.value=Number(Ve)>0?Ve:"":Ce.value?N.value=Ve:S.value=et}}else if(he>oe){if(J?S.value="":N.value="",n.value=J,Z.value=!J,S.value||N.value){let _e;if(J){const De=new u(N.value).mul(Math.pow(10,(Le=_.value)==null?void 0:Le.decimals)).toString();_e=new je(De),R.value={liquidityAmount:m.value.estimateLiquidityForCoinB(ye,Te,_e),tokenMaxA:0,tokenMaxB:N.value}}else{const De=new u(S.value).mul(Math.pow(10,(Ie=y.value)==null?void 0:Ie.decimals)).toString();_e=new je(De),R.value={liquidityAmount:m.value.estimateLiquidityForCoinB(ye,Te,_e),tokenMaxA:0,tokenMaxB:S.value}}}}else if(he<ne){if(n.value=!J,Z.value=J,J?N.value="":S.value="",S.value||N.value){let _e;if(J){const De=new u(S.value).mul(Math.pow(10,y.value.decimals)).toString();_e=new je(De),R.value={liquidityAmount:m.value.estimateLiquidityForCoinA(ye,Te,_e),tokenMaxA:S.value,tokenMaxB:0}}else{const De=new u(N.value).mul(Math.pow(10,_.value.decimals)).toString();_e=new je(De),R.value={liquidityAmount:m.value.estimateLiquidityForCoinA(ye,Te,_e),tokenMaxA:N.value,tokenMaxB:0}}}}else n.value=!0,S.value="",Z.value=!0,N.value=""};Me(S,(o,f)=>{console.log(S,"===>fromCoinAmount"),o==""&&Ce.value&&(N.value=""),o&&Ce.value&&!We.value&&C()}),Me(N,(o,f)=>{console.log(o,"===>>>>newValsda"),o==""&&!Ce.value&&(S.value=""),o&&!Ce.value&&!We.value&&C()});const P=X("--"),D=L(()=>x.value.RATES),M=()=>{const o=D.value&&D.value[y.value.address]&&D.value[y.value.address].price,f=D.value&&D.value[_.value.address]&&D.value[_.value.address].price;if(o&&f){const w=new u(S.value>0?S.value:0).mul(o),le=new u(N.value>0?N.value:0).mul(f),G=w.add(le).toNumber();P.value=G>0&&G<.01?"$<0.01":"$"+Ee(G,2)}else P.value="--"};Me(()=>[S.value,N.value,We.value],([o,f,w])=>{(o||f)&&!w?M():(!o||!f)&&!w&&(P.value="--")},{immediate:!0}),Me(()=>P,o=>{console.log(o,"71911111")},{immediate:!0});const W=X(),$=async()=>{var J,Ue;if(!E.value&&!z.value)return!1;if(!S.value&&!N.value&&!E.value&&!z.value)return;const o=l.value;if(qe(o))return;const{TickUtil:f,TickMath:w,getNearestTickByTick:le}=m.value,G=o==null?void 0:o.token_a.decimals,se=o==null?void 0:o.token_b.decimals;let ce,de,ne,oe,ye,Te,Xe;if(o.token_a.address.toLowerCase()===y.value.address.toLowerCase()&&o.token_b.address.toLowerCase()===_.value.address.toLowerCase()?Xe=!0:Xe=!1,E.value==="0"&&z.value==="∞")ne=f.getMinIndex(Number(o.tickSpacing)),oe=f.getMaxIndex(Number(o.tickSpacing));else if(ee.value=="custom"){Xe?(ce=Number(E.value),de=Number(z.value)):(ce=new u(1).div(z.value).toString(),de=new u(1).div(E.value).toString());try{ye=ce==0?-443636:w.priceToTickIndex(new u(ce),G,se)}catch{ye=-443636}try{Te=w.priceToTickIndex(new u(de),G,se)}catch{Te=443636}ne=le(ye,Number(o.tickSpacing)),oe=le(Te,Number(o.tickSpacing))}else ne=(J=Ke.value[ee.value])==null?void 0:J.lower,oe=(Ue=Ke.value[ee.value])==null?void 0:Ue.upper;const Ge=D.value[o==null?void 0:o.token_a.address].price,he=D.value[o==null?void 0:o.token_b.address].price;$e.value?new je(o.current_sqrt_price):new je(1/o.current_sqrt_price),console.log($e.value,"===>direction.value"),console.log(o,"poolInfos===>"),console.log(ne,oe,"####tick_lower tick_upper 889");try{const{amountA:Se,amountB:Le,tokenAmountsInfo:Ie}=await m.value.estCoinAmountsFromTotalAmount({lowerTick:ne,upperTick:oe,decimalsA:G,decimalsB:se,curSqrtPrice:new je(o.current_sqrt_price),totalAmount:P.value,tokenPriceA:Ge,tokenPriceB:he});console.log(Se,Le,"###estCoinAmountsFromTotalAmount 844"),console.log(o.needReverse,$e.value,"===>849"),W.value=Ie,o.needReverse?$e.value?(S.value=Se,N.value=Le):(S.value=Le,N.value=Se):(S.value=Se,N.value=Le)}catch(Se){console.log(Se,"e===>")}};Me([E,z],([o,f])=>{console.log(o,f,"==>minPrice,maxPrice"),We.value?We.value&&$():C(),f!=="∞"&&Number(o)!==0&&Number(f)!==0&&Number(o)>=Number(f)?ot.value=!0:ot.value=!1,Number(o)==0&&Number(f)==0&&lt.value&&(ot.value=!0,console.log("价格区间错误"))},{deep:!0,immediate:!0});const Ae=o=>{console.log(o,"e");const f=o.replace(/[^\d.]/g,""),w="$"+Ee(f);We.value=!0,P.value=w,o>0?$():(S.value="",N.value="")},T=X(!1),{setTransactionTxid:ie,setTransactionDesc:Je,setIsShowWaiting:t,setIsShowSuccess:b,setPositiomNum:B,setIsShowRejected:j}=me,ke=go(),K=L(()=>x.value.currentPositionInfo),Re=X(!1),we=async o=>{var ye,Te,Xe,Ge;console.log(l.value,"===> poolInfo.value"),T.value=!1,x.value.currentPositionInfo={},ie(""),Je(e("tips.increaseLiquiditySuccess",{from:n.value?"":`${S.value} ${(ye=y.value)==null?void 0:ye.symbol}`,and:!n.value&&!Z.value?"and":"",to:Z.value?"":`${N.value} ${(Te=_.value)==null?void 0:Te.symbol}`})),t(!0);const f=$e.value?Ce.value:!Ce.value;let w,le,G,se,ce,de;const ne=l.value.token_a.decimals,oe=l.value.token_b.decimals;if(E.value==="0"&&z.value==="∞")G=m.value.TickUtil.getMinIndex(Number(l.value.tickSpacing)),se=m.value.TickUtil.getMaxIndex(Number(l.value.tickSpacing));else if(ee.value=="custom"){$e.value?(w=Number(E.value),le=Number(z.value)):(w=new u(1).div(z.value).toString(),le=new u(1).div(E.value).toString()),console.log("0519###toAdd###min###",w),console.log("0519###toAdd###max###",le),console.log("0519###toAdd###minPrice.value###",E.value),console.log("0519###toAdd###maxPrice.value###",z.value);try{ce=w==0?m.value.TickUtil.getMinIndex(Number(l.value.tickSpacing)):m.value.TickMath.priceToTickIndex(new u(w),ne,oe)}catch{ce=m.value.TickUtil.getMinIndex(Number(l.value.tickSpacing))}try{de=m.value.TickMath.priceToTickIndex(new u(le),ne,oe)}catch{de=m.value.TickUtil.getMaxIndex(Number(l.value.tickSpacing))}G=m.value.getNearestTickByTick(ce,Number(l.value.tickSpacing)),se=m.value.getNearestTickByTick(de,Number(l.value.tickSpacing))}else G=Ke.value[ee.value].lower,se=Ke.value[ee.value].upper;console.log(G,se,"####tick_lower tick_upper 889"),console.log(l.value,"==>poolInfo.value.curSqrtPrice");try{let he;We.value?he=await m.value.getCreateAddLiquidityPayload({pool:l.value,curSqrtPrice:new je(l.value.current_sqrt_price),tickLower:G,tickUpper:se,slippage:Number(q.value)/100,tokenAmounts:W.value}):he=await m.value.getAddLiquidityTransactionPayload({pool:{poolAddress:l.value.poolAddress,token_a:l.value.token_a,token_b:l.value.token_b},amount:Ce.value?S.value:N.value,fix_amount_a:f,tick_lower:G,tick_upper:se,index:0,slippage:Number(q.value)/100,roundUp:!0,collect_fee:!1,curSqrtPrice:new je(l.value.current_sqrt_price)}),console.log(he,"payload===?");let J;if(F.value==="Aptos")J=await k.value.currentWallet.signAndSubmitTransaction(he);else{const Ue=await k.value.currentWallet.signAndExecuteTransactionBlock(he);J=m.value.handleTx(Ue)}if(console.log("0410###tx###",J),J&&J.hash){ie(J.hash),t(!1),b(!0);let Ue;l.value.needReverse?l.value.token_a.address.toLowerCase()===y.value.address.toLowerCase()&&l.value.token_b.address.toLowerCase()===_.value.address.toLowerCase()?Ue=!1:Ue=!0:l.value.token_a.address.toLowerCase()===y.value.address.toLowerCase()&&l.value.token_b.address.toLowerCase()===_.value.address.toLowerCase()?Ue=!0:Ue=!1,console.log(Ue,"===>directs");const Se={title:"Supplied",desc:e("tips.addLiquiditySuccessText",{from:n.value?"":`${S.value} ${(Xe=y.value)==null?void 0:Xe.symbol}`,and:!n.value&&!Z.value?"and":"",to:Z.value?"":`${N.value} ${(Ge=_.value)==null?void 0:Ge.symbol}`}),hash:J.hash,tit:"Position Created",icon:"icon-icon-Position-Created"};F.value!=="Aptos"&&(Se.res=J.res),m.value.showTransitionPending(Se);const Le=await m.value.watchTransaction(Se,!0);if(Le.status){if(b(!1),x.value.setCurrentPositionLoading(!0),Re.value=!0,console.log(Le.nftInfo,"===> watchInfo.nftInfo"),F.value==="Aptos"){if(await x.value.setCurrentPositionInfo(Le.nftInfo[0].data.id.creator,Le.nftInfo[0].data.id.collection,Le.nftInfo[0].data.name,F.value),o)try{await ke.subscribePosition({pool_address:K.value.poolAddress,position_index:K.value.index},K.value.nftHash)}catch(Ie){console.log(Ie,"e")}}else{const Ie=Le.nftInfo,_e=await Tt(2e3);if(await x.value.setCurrentPositionInfo(Ie==null?void 0:Ie.pool,"","",F.value,Ie==null?void 0:Ie.position),await Tt(1e3),console.log("0529###nftInfo###",Ie),console.log("0529###currentPositionInfo.value.index###",K.value.index),o)try{await ke.subscribePosition({pool_address:K.value.poolAddress,position_index:K.value.index},K.value.nftHash)}catch(De){console.log(De)}}setTimeout(()=>{pe.updateCurrentPools(l.value.poolAddress,F.value),m.value.getAccount(k.value.address)},3e3),setTimeout(async()=>{St(m,l)},3e3)}B()}else t(!1),j(!0);S.value="",N.value=""}catch(he){S.value="",N.value="",console.log("0330###Add liquidity Error###",he),t(!1),j(!0)}},He=L(()=>!S.value&&!N.value?(console.log("addLiquidityBtnDisabled11111"),!0):Number(S.value)>Number(p.value)||Number(N.value)>Number(v.value)?(console.log("addLiquidityBtnDisabled22222"),!0):Be.value!==e("button.addLiquidity")&&Be.value!==e("newAdd.preview")?(console.log("addLiquidityBtnDisabled33333###",Be.value),!0):l.value&&l.value&&l.value.is_pause?(console.log("addLiquidityBtnDisabled44444"),!0):Number(S.value)<=0&&Number(N.value)<=0||!n.value&&Number(S.value)==0||!Z.value&&Number(N.value)==0),Ze=L(()=>!y.value||!_.value),Be=L(()=>l.value&&l.value.is_pause?"Pool Closed":!y.value||!_.value||Ze.value?e("modal.selectTokenModalTitle"):Number(S.value)>Number(p.value)?e("button.insufficientBalance",{name:y.value.symbol}):Number(N.value)>Number(v.value)?e("button.insufficientBalance",{name:_.value.symbol}):!Number(S.value)&&!Number(N.value)?e("button.enterAmount"):z.value!=="∞"&&Number(E.value)>=Number(z.value)?e("newAdd.invalidRange"):e("button.addLiquidity")),be=X({}),Oe=X({}),Ye=X(!1),rt=(o,f)=>{console.log(r.value,"===>currentCoinKey.value"),console.log(o);const w=localStorage.getItem(o.address);console.log(x.value.tokensObj,"===>pools.value.tokensObj"),console.log(w,"===>coinLocak"),x.value.tokensObj&&x.value.tokensObj[o.address]&&x.value.tokensObj[o.address].isSelfBuilt&&!w&&(f=="fromCoin"&&(be.value=o),f=="toCoin"&&(Oe.value=o),Ye.value=!0)};Me(()=>[y.value,_.value],([o,f])=>{o&&!qe(o)&&rt(o,"fromCoin"),f&&!qe(f)&&rt(f,"toCoin")},{immediate:!0});const c=Jt(),d=()=>{F.value!=="Aptos"?c.push("/pool/list"):c.push("/pools")},Fe=o=>{We.value,we(o)},ve=()=>{Q.query.action!=="create-pool"&&Q.query.actions!=="new-position"&&(St(m,l),C(),pe.updateCurrentPools(l.value.poolAddress,F.value)),pe.setPoolConfigList(F.value,H.value.filterCoinsObj)},fe=L(()=>{var w,le,G,se,ce,de;const o=(G=D.value[(le=(w=y)==null?void 0:w.value)==null?void 0:le.address])==null?void 0:G.price,f=(de=D.value[(ce=(se=_)==null?void 0:se.value)==null?void 0:ce.address])==null?void 0:de.price;return!!(o&&f)});return{decimalUi:Pe,poolInfo:l,fromCoinAmount:S,toCoinAmount:N,fromCoin:y,toCoin:_,theme:re,showFromCoinLock:n,showToCoinLock:Z,fromCoinBlance:p,toCoinBlance:v,maxBtnSelect:i,halfBtnSelect:g,fixedFromCoin:Ce,openCoinSelect:ae,currentCoinKey:r,existingCoins:A,lastSelectCoin:U,showCoinSelect:V,onCoinSelect:ue,liquidityTotalAmount:P,toggle:jt,onInput:Ae,isInputTotalAmount:We,isViewDetail:Re,addLiquidityBtnDisabled:He,addLiquidityBtnText:Be,isShowTokenWarning:Ye,chainName:F,closeTokenWarning:d,warningFromCoin:be,warningToCoin:Oe,isShowLiquidityModal:T,currentPrice:lt,currentPriceReverse:ht,currentPriceTab:ee,minPrice:E,maxPrice:z,toAdd:we,direction:$e,wallet:k,getAddLiquidityType:Fe,clickRefresh:ve,isShowtotalAmount:fe}}});const Zi={class:"new-liquidity-right"},Gi={class:"deposit-title"},Ki={class:"card-container"},Ji={class:"card-item"},Qi={class:"card-item"},Yi={key:0,class:"total-amount"},Vi=a("span",null,"Total Amount",-1);function en(e,s,me,H,F,pe){const x=Ot,I=Ft,k=ro,Q=Vt,l=Ut,n=eo,Z=co,re=mo,Y=vo,p=fo;return h(),O("div",Zi,[a("div",Gi,[ze(x,{"pool-info":e.poolInfo,onClickRefresh:e.clickRefresh},null,8,["pool-info","onClickRefresh"])]),a("div",Ki,[a("div",Ji,[ze(I,{modelValue:e.fromCoinAmount,"onUpdate:modelValue":s[0]||(s[0]=v=>e.fromCoinAmount=v),"input-value":e.fromCoinAmount,"coin-symbol":e.fromCoin?e.fromCoin.symbol:null,"coin-name":e.fromCoin?e.fromCoin.name:null,balance:e.fromCoinBlance,"coin-icon":e.fromCoin?e.fromCoin.logoURI:"",address:e.fromCoin?e.fromCoin.address:"","swap-direct":"From","import-page":"deposit","has-arrow":!1,onOnMax:s[1]||(s[1]=v=>e.maxBtnSelect("fromCoin")),onOnHalf:s[2]||(s[2]=v=>e.halfBtnSelect("fromCoin")),onOnInput:s[3]||(s[3]=v=>{e.fromCoinAmount=v,e.fixedFromCoin=!0,e.isInputTotalAmount=!1}),onOnSelect:s[4]||(s[4]=v=>e.openCoinSelect("fromCoin"))},null,8,["modelValue","input-value","coin-symbol","coin-name","balance","coin-icon","address"]),e.showFromCoinLock?(h(),xe(k,{key:0,"from-coin":e.fromCoin,"to-coin":e.toCoin,"pool-info":e.poolInfo},null,8,["from-coin","to-coin","pool-info"])):te("",!0)]),a("div",Qi,[ze(I,{modelValue:e.toCoinAmount,"onUpdate:modelValue":s[5]||(s[5]=v=>e.toCoinAmount=v),"input-value":e.toCoinAmount,"coin-symbol":e.toCoin?e.toCoin.symbol:null,"coin-name":e.toCoin?e.toCoin.name:null,balance:e.toCoinBlance,"swap-direct":"To","coin-icon":e.toCoin?e.toCoin.logoURI:"",address:e.toCoin?e.toCoin.address:"","import-page":"deposit","has-arrow":!1,onOnMax:s[6]||(s[6]=v=>e.maxBtnSelect("toCoin")),onOnHalf:s[7]||(s[7]=v=>e.halfBtnSelect("toCoin")),onOnInput:s[8]||(s[8]=v=>{e.toCoinAmount=v,e.fixedFromCoin=!1,e.isInputTotalAmount=!1}),onOnSelect:s[9]||(s[9]=v=>e.openCoinSelect("toCoin"))},null,8,["modelValue","input-value","coin-symbol","coin-name","balance","coin-icon","address"]),e.showToCoinLock?(h(),xe(k,{key:0,"from-coin":e.fromCoin,"to-coin":e.toCoin,"pool-info":e.poolInfo},null,8,["from-coin","to-coin","pool-info"])):te("",!0)]),e.fromCoin&&e.toCoin&&!e.showToCoinLock&&!e.showFromCoinLock&&e.theme=="default"?(h(),O("img",{key:0,class:"add",src:po,alt:"",onClick:s[10]||(s[10]=(...v)=>e.toggle&&e.toggle(...v))})):te("",!0),e.fromCoin&&e.toCoin&&!e.showToCoinLock&&!e.showFromCoinLock&&e.theme!=="default"?(h(),O("img",{key:1,class:"add",src:bo,alt:"",onClick:s[11]||(s[11]=(...v)=>e.toggle&&e.toggle(...v))})):te("",!0)]),e.isShowtotalAmount?(h(),O("div",Yi,[Vi,a("span",null,[ze(Q,{value:e.liquidityTotalAmount,placeholder:e.isInputTotalAmount?"":e.liquidityTotalAmount,onInput:s[12]||(s[12]=v=>e.onInput(v.target.value))},null,8,["value","placeholder"])])])):te("",!0),ze(l,{"from-coin":e.fromCoin,"to-coin":e.toCoin,"from-coin-amount":e.fromCoinAmount,"to-coin-amount":e.toCoinAmount,"fixed-from-coin":e.fixedFromCoin,"is-input-total-amount":e.isInputTotalAmount,"min-price":e.minPrice,"max-price":e.maxPrice,"current-price-tab":e.currentPriceTab,"current-price":e.currentPrice,"current-price-reverse":e.currentPriceReverse},null,8,["from-coin","to-coin","from-coin-amount","to-coin-amount","fixed-from-coin","is-input-total-amount","min-price","max-price","current-price-tab","current-price","current-price-reverse"]),ze(n,{class:"add-liquidity-btn",disabled:e.wallet.connected?e.addLiquidityBtnDisabled:!1,onClick:s[13]||(s[13]=v=>e.wallet.connected?e.isShowLiquidityModal=!0:e.wallet.setIsShowWalletModal(!0))},{default:Qt(()=>[Yt(ge(e.wallet.connected?e.addLiquidityBtnText:e.$t("button.connectWallet")),1)]),_:1},8,["disabled"]),e.showCoinSelect?(h(),xe(Z,{key:1,"existing-coins":e.existingCoins,"last-select-coin":e.lastSelectCoin,onOnSelect:e.onCoinSelect,onOnClose:s[14]||(s[14]=v=>e.showCoinSelect=!1)},null,8,["existing-coins","last-select-coin","onOnSelect"])):te("",!0),e.isViewDetail?(h(),xe(re,{key:2,"pool-info":e.poolInfo,onOnClose:s[15]||(s[15]=v=>e.isViewDetail=!1)},null,8,["pool-info"])):te("",!0),e.chainName=="Sui"&&e.isShowTokenWarning?(h(),xe(Y,{key:3,"from-coin":e.warningFromCoin,"to-coin":e.warningToCoin,onClose:e.closeTokenWarning,onClickContinue:s[16]||(s[16]=v=>e.isShowTokenWarning=!1)},null,8,["from-coin","to-coin","onClose"])):te("",!0),e.isShowLiquidityModal?(h(),xe(p,{key:4,"pool-info":e.poolInfo,title:e.$t("button.addLiquidity"),"from-coin-amount":e.fromCoinAmount,"to-coin-amount":e.toCoinAmount,"from-coin":e.fromCoin,"to-coin":e.toCoin,"fixed-from-coin":e.fixedFromCoin,"current-price":e.currentPrice,"current-price-reverse":e.currentPriceReverse,"current-price-tab":e.currentPriceTab,"min-price":e.minPrice,"max-price":e.maxPrice,"show-from-coin-lock":e.showFromCoinLock,"show-to-coin-lock":e.showToCoinLock,"current-direct":e.direction,"is-increase":!1,onToAdd:e.getAddLiquidityType,onOnClose:s[17]||(s[17]=v=>e.isShowLiquidityModal=!1)},null,8,["pool-info","title","from-coin-amount","to-coin-amount","from-coin","to-coin","fixed-from-coin","current-price","current-price-reverse","current-price-tab","min-price","max-price","show-from-coin-lock","show-to-coin-lock","current-direct","onToAdd"])):te("",!0)])}const Wt=nt(xi,[["render",en]]),tn=it({components:{NewLiquidityLeft:Dt,NewLiquidityRight:Wt},setup(){Rt(()=>{uo()});const e=yt();return{tickList:tt,route:e}}});const on={key:0,class:"loading-spin-liquidity loading-global"},nn={class:"privide-liquidity"};function rn(e,s,me,H,F,pe){var Q,l;const x=wt,I=Dt,k=Wt;return h(),O(ut,null,[!e.tickList&&((l=(Q=e.route)==null?void 0:Q.query)!=null&&l.poolAddress)?(h(),O("div",on,[ze(x)])):te("",!0),a("div",nn,[ze(I),ze(k)])],64)}const Dn=nt(tn,[["render",rn],["__scopeId","data-v-9c3e932a"]]);export{Dn as default};
