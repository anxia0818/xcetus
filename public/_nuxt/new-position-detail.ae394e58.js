import{_ as Oo}from"./new-position-title.ca4b366e.js";import{_ as mo}from"./token-warning.57884278.js";import{_ as qo}from"./status-block.d2109d7c.js";import{j as Qo,n as Zo,d as ke,e as eo,u as oo,a as V,g as bo,c as ve,s as Me,r as Te,b as qe,p as So,J as Lo,K as Bo,T as $o,C as Ko,m as Vo}from"./pool.29982694.js";import{s as to,m as xo,l as en,b as on,a as nn}from"./transform.c672907f.js";import{D as b}from"./decimal.0bdeb344.js";import{u as ze,a as ao}from"./sha256.e607382f.js";import{a as Je,r as j,l as C,H as Mo,q as ye,e as Ye,o as I,f as N,t as Ne,N as Uo,h as n,p as vo,k as fo,m as po,s as Ao,i as de,u as Z,v as W,j as fe,x as me,y as Co,a4 as tn,b as lo,C as Ge,a8 as Po,O as To,w as Be,F as io,E as so,B as ro,A as wo,c as Le,D as sn,G as an,z as jo,P as ln,a1 as rn,S as un}from"./entry.bc47c957.js";import{i as xe}from"./import-icon.de3e6c66.js";import{_ as ho}from"./assets-card.5a36a013.js";import{_ as dn}from"./coin-lock.bc5db8cf.js";import{a as cn}from"./new-add-or-create.0962cb26.js";import{_ as mn,a as vn}from"./icon-Add-Liquidity_2x.0acb06cb.js";/* empty css              *//* empty css              */import{u as Do}from"./notifi.56a72d2a.js";import{_ as fn}from"./apr-tips.42d97c4b.js";import{u as Eo}from"./farms.ad791865.js";/* empty css              *//* empty css              */import"./back.1b95a29a.js";import"./swap-setting.43bbac66.js";/* empty css              */import"./icon-error_2x.254c19c2.js";/* empty css              */import"./img-lock_2x.a28135f4.js";import"./img-lock_2x.3afb8ec7.js";import"./useWhale.931a5f8a.js";import"./icon_rewards_2x.246398bf.js";const _o=Math.PI,yo=2*_o,Ze=1e-6,pn=yo-Ze;function Fo(e){this._+=e[0];for(let t=1,s=e.length;t<s;++t)this._+=arguments[t]+e[t]}function hn(e){let t=Math.floor(e);if(!(t>=0))throw new Error(`invalid digits: ${e}`);if(t>15)return Fo;const s=10**t;return function(a){this._+=a[0];for(let B=1,h=a.length;B<h;++B)this._+=Math.round(arguments[B]*s)/s+a[B]}}class gn{constructor(t){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=t==null?Fo:hn(t)}moveTo(t,s){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+s}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(t,s){this._append`L${this._x1=+t},${this._y1=+s}`}quadraticCurveTo(t,s,a,B){this._append`Q${+t},${+s},${this._x1=+a},${this._y1=+B}`}bezierCurveTo(t,s,a,B,h,q){this._append`C${+t},${+s},${+a},${+B},${this._x1=+h},${this._y1=+q}`}arcTo(t,s,a,B,h){if(t=+t,s=+s,a=+a,B=+B,h=+h,h<0)throw new Error(`negative radius: ${h}`);let q=this._x1,m=this._y1,o=a-t,l=B-s,v=q-t,d=m-s,k=v*v+d*d;if(this._x1===null)this._append`M${this._x1=t},${this._y1=s}`;else if(k>Ze)if(!(Math.abs(d*o-l*v)>Ze)||!h)this._append`L${this._x1=t},${this._y1=s}`;else{let X=a-q,se=B-m,oe=o*o+l*l,te=X*X+se*se,r=Math.sqrt(oe),f=Math.sqrt(k),$=h*Math.tan((_o-Math.acos((oe+k-te)/(2*r*f)))/2),i=$/f,g=$/r;Math.abs(i-1)>Ze&&this._append`L${t+i*v},${s+i*d}`,this._append`A${h},${h},0,0,${+(d*X>v*se)},${this._x1=t+g*o},${this._y1=s+g*l}`}}arc(t,s,a,B,h,q){if(t=+t,s=+s,a=+a,q=!!q,a<0)throw new Error(`negative radius: ${a}`);let m=a*Math.cos(B),o=a*Math.sin(B),l=t+m,v=s+o,d=1^q,k=q?B-h:h-B;this._x1===null?this._append`M${l},${v}`:(Math.abs(this._x1-l)>Ze||Math.abs(this._y1-v)>Ze)&&this._append`L${l},${v}`,a&&(k<0&&(k=k%yo+yo),k>pn?this._append`A${a},${a},0,1,${d},${t-m},${s-o}A${a},${a},0,1,${d},${this._x1=l},${this._y1=v}`:k>Ze&&this._append`A${a},${a},0,${+(k>=_o)},${d},${this._x1=t+a*Math.cos(h)},${this._y1=s+a*Math.sin(h)}`)}rect(t,s,a,B){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+s}h${a=+a}v${+B}h${-a}Z`}toString(){return this._}}function Ve(e){return function(){return e}}function kn(e){let t=3;return e.digits=function(s){if(!arguments.length)return t;if(s==null)t=null;else{const a=Math.floor(s);if(!(a>=0))throw new RangeError(`invalid digits: ${s}`);t=a}return e},()=>new gn(t)}function bn(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function Wo(e){this._context=e}Wo.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t);break}}};function wn(e){return new Wo(e)}function _n(e){return e[0]}function yn(e){return e[1]}function In(e,t){var s=Ve(!0),a=null,B=wn,h=null,q=kn(m);e=typeof e=="function"?e:e===void 0?_n:Ve(e),t=typeof t=="function"?t:t===void 0?yn:Ve(t);function m(o){var l,v=(o=bn(o)).length,d,k=!1,X;for(a==null&&(h=B(X=q())),l=0;l<=v;++l)!(l<v&&s(d=o[l],l,o))===k&&((k=!k)?h.lineStart():h.lineEnd()),k&&h.point(+e(d,l,o),+t(d,l,o));if(X)return h=null,X+""||null}return m.x=function(o){return arguments.length?(e=typeof o=="function"?o:Ve(+o),m):e},m.y=function(o){return arguments.length?(t=typeof o=="function"?o:Ve(+o),m):t},m.defined=function(o){return arguments.length?(s=typeof o=="function"?o:Ve(!!o),m):s},m.curve=function(o){return arguments.length?(B=o,a!=null&&(h=B(a)),m):B},m.context=function(o){return arguments.length?(o==null?a=h=null:h=B(a=o),m):a},m}function No(){}function Ho(e){this._context=e}Ho.prototype={areaStart:No,areaEnd:No,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}};function An(e){return new Ho(e)}function Ro(e,t,s){const a=new b(10).pow(t-s);return new b(1.0001).pow(e).mul(a)}const Cn=Je({props:{poolInfo:{type:Object,default:()=>({chartLoading:!1,token_a:{decimal:6},token_b:{decimal:6},currentLiquity:"50000000"})},minPrice:{type:String,default:""},maxPrice:{type:String,default:""},direction:{type:Boolean,default:!0},tickList:{type:Array,default:()=>[]},currentTick:{type:Number,default:0},chartLoading:{type:Boolean,default:!1},currentPriceTab:{type:String,default:""},before7dContractPriceLowest:{type:String,default:""},before7dContractPriceHighest:{type:String,default:""}},setup(e,t){const s=j(1),a=j(""),B=j(""),h=C(()=>{var i,g,y;return d.sqrtPriceX64ToPrice((i=e.poolInfo)==null?void 0:i.current_sqrt_price,(g=e.poolInfo)==null?void 0:g.coinA.decimals,(y=e.poolInfo)==null?void 0:y.coinB.decimals).toString()}),q=C(()=>{let i=0;return e.direction?i=(Number(e.minPrice)/Number(h.value)-1)*100:i=(Number(e.minPrice)/Number(1/Number(h.value))-1)*100,i=i>0&&i<.1?.1:i,i=i<0&&i>-.1?-.1:i,i}),m=C(()=>{let i=0;return e.direction?i=(Number(e.maxPrice)/Number(h.value)-1)*100:i=(Number(e.maxPrice)/Number(1/Number(h.value))-1)*100,i=i>0&&i<.1?.1:i,i=i<0&&i>-.1?-.1:i,i}),o=ze(),l=C(()=>o),v=C(()=>l.value.chainName?eo(l.value.chainName):{}),{TickMath:d,getNearestTickByTick:k}=v.value,X=()=>{const i=s.value/2;s.value=i,te(e.poolInfo,i)},se=()=>{const i=s.value*2;s.value=i,te(e.poolInfo,i)},oe=(i=[])=>{let g=6;const y=Math.abs(Number(i[0])-Number(i[i.length-1]));return y>=6?g=0:y>=1?g=1:y>=.1?g=2:y>=.01?g=3:y>=.001?g=4:y>=1e-4?g=5:y>=1e-5?g=6:y>=1e-6?g=7:y>=1e-7&&(g=8),g},te=(i,g=1)=>{if(i&&i.token_a&&!e.chartLoading&&e.minPrice&&e.maxPrice){console.log(e.poolInfo,"==>props.poolInfo");const y=Number(e.poolInfo.current_tick_index);console.log("0117###dataProcessing###currentTick###",y),console.log("0117###dataProcessing###props.poolInfo###",e.poolInfo),console.log("0117###dataProcessing###minPrice###",e.minPrice),console.log("0117###dataProcessing###maxPrice###",e.maxPrice),console.log("0117###dataProcessing###poolInfo###",e.poolInfo);let w=y+100*g,u=y-100*g,ne,J;if(e.maxPrice==="∞")J=v.value.TickUtil.getMaxIndex(Number(e.poolInfo.tickSpacing));else try{e.direction?J=d.priceToTickIndex(new b(e.maxPrice),e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals):J=d.priceToTickIndex(new b(1).div(e.minPrice),e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals)}catch{J=443636}if(e.minPrice==="0")ne=v.value.TickUtil.getMinIndex(Number(e.poolInfo.tickSpacing));else try{e.direction?ne=d.priceToTickIndex(new b(e.minPrice),e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals):ne=d.priceToTickIndex(new b(1).div(e.maxPrice),e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals)}catch{ne=-443636}let le=0;if(e.currentPriceTab!=="full range"){if(y>=ne&&y<=J){const F=y-ne,ge=J-y;le=Math.max(Math.abs(F),Math.abs(ge))}else y<ne?le=Math.abs(J-y):le=Math.abs(y-ne);w=y+le+100*g,u=y-le-100*g,console.log(g,y,"===>zooms")}else{const F=(Math.abs(y)>5e3,2e4);w=y+F*g,u=y-F*g}u<-443636&&(u=-443636),w>443636&&(w=443636),console.log(u,w,"===>201");const E=new b(i.liquidity).div(Math.pow(10,8)).toString();console.log(E,"==>currentLiquity");const S=e.tickList;console.log("0117####drawChart####tick_info_array####",S);const R=[],L=[];let D={};for(let F=0;F<S.length;F++){if(D=S[F],D.index<=y&&D.index>=u){if(R.length<1&&F!==0){const ge=S[F-1];R.unshift({...ge,index:u})}R.unshift(D)}else if(D.index>y&&D.index<=w&&(L.push(D),R.length<1&&F!==0)){const ge=S[F-1];R.push({...ge,index:u})}if(D.index>w){const ge=S[F];if(L.push({...ge,index:w}),R.length<1&&F!==0){const _e=S[F-1];R.push({..._e,index:u})}break}}console.log(y,u,w,"===>currentTick");let ie="0";for(let F=R.length-1;F>=0;F--)ie=new b(ie).plus(new b(R[F].liquidityNet.toString()).div(Math.pow(10,8))).toString(),R[F].liquityAmount=ie;let x=E;for(let F=0;F<L.length;F++)x=new b(x).plus(new b(L[F].liquidityNet.toString()).div(Math.pow(10,8))).toString(),L[F].liquityAmount=x;console.log(R.length,L.length,"leftArray");let ee=[];const K=S&&S.length>0?{index:y,liquityAmount:Number(E)}:{index:y,liquityAmount:0};(R.length>0||L.length>0)&&(console.log([K,...L],"279===>"),ee=[...R.reverse(),K,...L],e.direction||(ee=ee.reverse()));const pe=[];S.forEach(F=>{pe.push({...F,liquidityGross:F.liquidityGross.toString(),liquidityNet:F.liquidityNet.toString()})}),console.log("0117####drawChart####testTickInfoArray####",pe),console.log("0117####drawChart####currentLiquity####",E),console.log(ee,"===>chartData"),f(ee,u,w,ne,J,y)}};let r=j(!1);Mo(()=>{document.body.clientWidth<750?r.value=!1:r.value=!0,window.onresize=()=>{document.body.clientWidth<750?r.value=!1:r.value=!0,te(e.poolInfo,s.value)}});const f=(i,g,y,w,u,ne)=>{console.log("0117####drawChart####chartData####",i),console.log("0117####drawChart####tickMin####",g),console.log("0117####drawChart####tickMax####",y),console.log("0117####drawChart####minPriceTick####",w),console.log("0117####drawChart####maxPriceTick####",u),console.log("0117####drawChart####currentTick####",ne),console.log("0117####drawChart####props.direction####",e.direction),console.log("0518###newd3###props.before7dContractPriceLowest###",e.before7dContractPriceLowest),console.log("0518###newd3###props.before7dContractPriceHighest###",e.before7dContractPriceHighest);let J,le;e.direction?(J=e.before7dContractPriceLowest?d.priceToTickIndex(new b(e.before7dContractPriceLowest),e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals):"",le=e.before7dContractPriceHighest?d.priceToTickIndex(new b(e.before7dContractPriceHighest),e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals):""):(J=e.before7dContractPriceLowest?d.priceToTickIndex(new b(1).div(e.before7dContractPriceLowest),e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals):"",le=e.before7dContractPriceHighest?d.priceToTickIndex(new b(1).div(e.before7dContractPriceHighest),e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals):"");const E={top:30,right:35,bottom:20,left:55};let S,R;r.value,S=340-E.left-E.right,R=205-E.top-E.bottom;const L=y-g,D=parseInt(String(L/4));let ie=[g+D/4,g+D,g+2*D,y-D,y-D/4];const x=g,ee=y,K=S/(ee-x);e.currentPriceTab==="full range"&&(ie=[g,g+2*D,y]),console.log("0117####drawChart####xArr####",ie),console.log("0117####drawChart####utickMin####",x),console.log("0117####drawChart####utickMax####",ee),console.log("0117####drawChart####unit####",K);const pe=ie.map(O=>e.direction?Ro(O,e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals).toString():new b(1).div(Ro(O,e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals)).toString());oe(pe),to("#chart").selectAll("*").remove();const F=to("#chart").attr("width",S+E.left+E.right).attr("height",R+E.top+E.bottom).append("g").attr("transform",`translate(${E.left},${E.right})`),ge=xo(i,function(O){return Number(Math.abs(O.liquityAmount))})||0,_e=en().range([0,R]).domain([ge,0]);on().rangeRound([0,S]).padding(.1);const c=F.append("g").attr("id","barsBox").selectAll("rect").data(i).enter().append("rect");l.value.theme=="default"?c.attr("x",function(O,U){return U===0?0:e.direction?Math.abs(O.index-x)*K:Math.abs(ee-O.index)*K}).attr("y",function(O,U){return e.direction?U===i.length-1?0:_e(O.liquityAmount):U===i.length-1?0:_e(i[U+1].liquityAmount)}).attr("width",function(O,U){return U===0&&i.length===1&&O.liquityAmount>0?S:(e.direction,U!==i.length-1?Math.abs(i[U+1].index-O.index)*K:0)}).attr("height",function(O,U){return U===0&&i.length===1&&O.liquityAmount>0?R:e.direction?U===i.length-1?0:R-_e(O.liquityAmount):U===i.length-1?0:R-_e(i[U+1].liquityAmount)}).attr("fill","#279477").attr("class","bars").attr("stroke-width",1).attr("stroke","#279477"):c.attr("x",function(O,U){return U===0?0:e.direction?Math.abs(O.index-x)*K:Math.abs(ee-O.index)*K}).attr("y",function(O,U){return e.direction?U===i.length-1?0:_e(Math.abs(O.liquityAmount)):U===i.length-1?0:_e(Math.abs(i[U+1].liquityAmount))}).attr("width",function(O,U){return U===0&&i.length===1&&O.liquityAmount>0?S:(e.direction,U!==i.length-1?Math.abs(i[U+1].index-O.index)*K:0)}).attr("height",function(O,U){if(U===0&&i.length===1&&O.liquityAmount>0)return R;if(e.direction)return U===i.length-1?0:Number(O.liquityAmount)?R-_e(Math.abs(O.liquityAmount)):0;{if(U===i.length-1)return 0;const ue=R-_e(Math.abs(i[U+1].liquityAmount));return Number(i[U+1].liquityAmount)?ue:0}}).attr("fill","#407497").attr("class","bars").attr("stroke-width",1).attr("stroke","#407497");const p=F.append("g");p.append("line").attr("x1",0).attr("y1",155).attr("x2",S).attr("y2",155).attr("stroke-width",1).attr("stroke","#50535D"),p.append("g");let P=0;e.direction?P=Math.abs(ne-x)*K:P=Math.abs(ne-ee)*K,console.log(l.value.theme=="default","leftHandle#"),(l.value.theme=="default"?F.append("line").attr("x1",0).attr("y1",0).attr("x2",0).attr("y2",155).attr("stroke-width",2).attr("stroke","#68FFD8"):F.append("line").attr("x1",0).attr("y1",0).attr("x2",0).attr("y2",155).attr("stroke-width",2).attr("stroke","#76C8FF")).attr("transform","translate("+P+", 0)"),to("#triangle").attr("width",8).attr("height",4);let H=[[0,0],[4,4],[8,0]],G=In().x(function(O){return O[0]}).y(function(O){return O[1]}).curve(An);const M=P-4;F.append("path").attr("d",G(H)).style("fill",l.value.theme=="default"?"#68FFD8":"#76C8FF").attr("transform","translate("+M+", 0)");let z,Y,re,ce;e.direction?(console.log("0525###d3###select###minPriceTick###",w),console.log("0525###d3###select###maxPriceTick###",u),console.log("0525###d3###select###props.minPrice###",e.minPrice),console.log("0525###d3###select###props.maxPrice###",e.maxPrice),z=w<x?-100:parseInt(String(Math.abs(w-x)*K)),Y=u<x?-100:parseInt(String(Math.abs(u-x)*K)),re=J<x?-100:Math.abs(J-x)*K,ce=le<x?-100:Math.abs(le-x)*K):(Y=w<x?-100:Math.abs(ee-w)*K,z=u<x?-100:Math.abs(ee-u)*K,ce=J<x?-100:Math.abs(ee-J)*K,re=le<x?-100:Math.abs(ee-le)*K),e.minPrice==="0"&&(z=0),e.maxPrice==="∞"&&(Y=S),r.value?a.value=S-z+60+"px":a.value=S-z+52+"px",B.value=Y+74+"px",console.log(z,Y,"##minPriceTickX"),J&&re<S&&F.append("line").attr("x1",0).attr("y1",0).attr("x2",0).attr("y2",155).attr("stroke-width",1).attr("stroke-dasharray","5, 5").attr("stroke","rgba(255, 255, 255, 0.5)").attr("transform","translate("+re+", 0)"),le&&ce<S&&F.append("line").attr("x1",0).attr("y1",0).attr("x2",0).attr("y2",155).attr("stroke-width",1).attr("stroke-dasharray","5, 5").attr("stroke","rgba(255, 255, 255, 0.5)").attr("transform","translate("+ce+", 0)");const be=nn().extent([[0,0],[S,R]]).handleSize(30).on("end",Ie);F.append("g").attr("class","brush").call(be).call(be.move,[z,Y]);function Ie(O){if(!O.sourceEvent||!O.selection)return;r.value?a.value=S-O.selection[0]+60+"px":a.value=S-O.selection[0]+52+"px",B.value=O.selection[1]+74+"px";let U,ue;console.log("0525###d3###select###e.selection[0]###",O.selection[0]),console.log("0525###d3###select###e.selection[0]###",O.selection[1]),console.log("0525###d3###select###props.direction###",e.direction),console.log("0525###d3###select###width###",S),console.log("0525###d3###select###unit###",K),console.log("0525###d3###select###utickMin###",x),console.log("0525###d3###select###utickMax###",ee),console.log("0525###d3###select###props.poolInfo###",e.poolInfo);let we=0,_=0;e.direction?(we=k(parseInt(String(O.selection[0]/K+x)),Number(e.poolInfo.tickSpacing)),U=d.tickIndexToPrice(we,e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals).toString(),_=k(parseInt(String(O.selection[1]/K+x)),Number(e.poolInfo.tickSpacing)),ue=d.tickIndexToPrice(_,e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals).toString(),console.log("0525###d3###select###minTick###",we),console.log("0525###d3###select###maxTick###",_),console.log("0525###d3###select###minPrice###",U),console.log("0525###d3###select###maxPrice###",ue)):(_=k(ee-O.selection[0]/K,Number(e.poolInfo.tickSpacing)),U=1/d.tickIndexToPrice(_,e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals).toString(),we=k(ee-O.selection[1]/K,Number(e.poolInfo.tickSpacing)),ue=1/d.tickIndexToPrice(we,e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals).toString()),t.emit("onChangeMinPrice",String(ke(String(U),6))),t.emit("onChangeMaxPrice",String(ke(String(ue),6)))}l.value.theme=="default"?to(".selection").attr("stroke","rgba(255, 255, 255, 0)").attr("fill","#15322C"):to(".selection").attr("stroke","rgba(255, 255, 255, 0)").attr("fill","rgba(255,255,255,0.7)")};j(""),ye(()=>[e.poolInfo,e.minPrice,e.maxPrice,e.currentPriceTab,e.tickList],([i,g,y,w])=>{console.log(i,g,y,y>g,"poolInfo && minPrice && maxPrice && (maxPrice > minPrice)"),i&&g&&y&&te(i,s.value)},{immediate:!0});const $=j(!0);return ye(()=>e.chartLoading,(i,g)=>{i!==g&&($.value=i)},{immediate:!0,deep:!0}),{store:l,loading:$,zoomOut:X,zoomIn:se,rangeSizeLower:q,rangeSizeUpper:m,rangeSizeLowerPosition:a,rangeSizeUpperPosition:B,decimalFormat:Qo,numberformat:Zo}}});const Sn=e=>(vo("data-v-59ae7c8b"),e=e(),fo(),e),$n={class:"chart-box"},Pn={class:"chart"},Tn=Sn(()=>n("svg",{id:"chart"},null,-1)),Nn=[Tn];function Rn(e,t,s,a,B,h){return I(),N("div",$n,[Ne(n("div",Pn,Nn,512),[[Uo,!e.loading]])])}const Xo=Ye(Cn,[["render",Rn],["__scopeId","data-v-59ae7c8b"]]),On=Je({components:{StatusBlock:qo,NewPositionChart:Xo,TokenWarning:mo},setup(e){const t=j(),s=j(),a=C(()=>{var i,g;return(g=(i=d.value)==null?void 0:i.poolInfo)==null?void 0:g.needReverse}),B=ze(),h=C(()=>B),q=C(()=>h.value.currentExplorer),m=C(()=>h.value.theme),o=C(()=>h.value.chainName),l=oo(),v=C(()=>l),d=j({}),k=po();ye(()=>[v.value.currentPositionInfo,o.value],([i,g])=>{var y;g=="Aptos"&&i?(d.value=i,t.value=d.value.token_a,s.value=d.value.token_b):g=="Sui"&&i&&(i==null?void 0:i.nftHash)==((y=k==null?void 0:k.query)==null?void 0:y.pos)&&(console.log(i,"==>newVal"),d.value=i,t.value=d.value.token_a,s.value=d.value.token_b,console.log(t.value,s.value,"###fromCoin.value"))},{immediate:!0});const X=i=>{var g;return(i==null?void 0:i.logoURI)||(i==null?void 0:i.logo_url)||((g=v.value.tokensObj[i==null?void 0:i.address])==null?void 0:g.logo_url)||(m.value==="default"?xe("/image/coins/unknown.png"):xe("/image/coins/sui-unknown.png"))},se=C(()=>o.value?eo(o.value):{}),oe=j([]),te=async i=>{console.log(i,"===>positionInfo.value.poolInfo");const g=await se.value.getTicks(i),y=g?se.value.getTickDataFromUrlData(g):[];console.log(y,"list===>"),oe.value=y};ye(()=>[d.value,v.value.poolsObj],([i,g])=>{console.log(i,!ve(i),"177111"),i&&!ve(i)&&i.poolInfo&&g&&!ve(g)&&(console.log(i,g,"==>poolConfigObj"),te(g[i.poolAddress]))},{immediate:!0});const r=j(!0);console.log(d.value,"188---------->");const f=(i,g)=>i!=="0"&&g!=="∞"?Me(1/(1-Number((i/g)**.25)),2)+"x":"1x",$=C(()=>d.value.minPrice&&d.value.maxPrice?f(d.value.minPrice,d.value.maxPrice):"--");return{needReverse:a,getCoinIcon:X,theme:m,indexStore:B,direct:r,addCommom:V,decimalUi:ke,tickList:oe,positionInfo:d,fromCoin:t,toCoin:s,getExplorerUrl:bo,lever:$,currentExplorer:q}}}),qn=""+globalThis.__publicAssetsURL("image/aptos-price.png"),Ln=""+globalThis.__publicAssetsURL("sui-image/sui-price.png"),Bn=""+globalThis.__publicAssetsURL("image/icon-arrow@2x.png"),Mn=""+globalThis.__publicAssetsURL("sui-image/icon-arrow@2x.png");const We=e=>(vo("data-v-9c241bff"),e=e(),fo(),e),Un={class:"new-position-info"},jn={class:"pool-info"},Dn={class:"left"},En={class:"coin-a"},Fn={alt:""},Wn={class:"coin-b"},Hn={alt:""},Xn={class:"position-name"},Gn=["href"],zn=We(()=>n("use",{"xlink:href":"#icon-icon_copy1"},null,-1)),Jn=[zn],Yn={key:0,class:"pool-fee"},Qn=We(()=>n("span",null,"Fee tier",-1)),Zn={class:"right"},Kn={class:"h5-pool-info"},Vn={class:"coin-info"},xn={class:"coin-a"},et={alt:""},ot={class:"coin-b"},nt={alt:""},tt={class:"position-name"},it=["href"],st=We(()=>n("use",{"xlink:href":"#icon-icon_copy1"},null,-1)),at=[st],lt={key:0,class:"pool-fee"},rt={class:"price-info"},ut={class:"price-and-chart"},dt={class:"left"},ct={class:"current-price"},mt=We(()=>n("span",null,"Current Price",-1)),vt={class:"coin-rate"},ft=We(()=>n("div",null,[n("svg",{class:"icon icon-up","aria-hidden":"true"},[n("use",{"xlink:href":"#icon-exchange_up1"})])],-1)),pt=We(()=>n("div",null,[n("svg",{class:"icon icon-down","aria-hidden":"true"},[n("use",{"xlink:href":"#icon-exchange_down1"})])],-1)),ht=[ft,pt],gt={key:0},kt={key:1},bt={key:0,class:"position-range"},wt=We(()=>n("div",{class:"position-range-title"}," Position Range ",-1)),_t={key:0},yt={key:1},It={key:2,src:qn,alt:""},At={key:3,src:Ln,alt:""},Ct={key:4},St={key:5},$t={key:1,class:"position-range position-range-warp"},Pt={key:0,class:"position-range-title"},Tt={key:1,class:"position-range-title"},Nt={key:2},Rt={key:3},Ot={class:"price-img"},qt={key:0,src:Bn,alt:""},Lt={key:1,src:Mn,alt:""},Bt={key:4},Mt={key:5},Ut={class:"lever"},jt=We(()=>n("div",{class:"lever-title"},"Leverage",-1)),Dt={class:"lever-text"},Et={class:"right"},Ft=We(()=>n("div",{class:"chat-mask"},null,-1));function Wt(e,t,s,a,B,h){var v,d,k,X,se,oe,te,r,f,$,i,g,y,w,u,ne,J,le,E,S,R,L,D,ie,x,ee,K,pe,F,ge;const q=mo,m=qo,o=Xo,l=Ao("image");return I(),N("div",Un,[n("div",jn,[n("div",Dn,[n("div",En,[Ne(n("img",Fn,null,512),[[l,e.needReverse?e.getCoinIcon(e.positionInfo.token_b):e.getCoinIcon(e.positionInfo.token_a)]]),de(q,{address:e.needReverse?(X=(k=e.positionInfo)==null?void 0:k.token_b)==null?void 0:X.address:(d=(v=e.positionInfo)==null?void 0:v.token_a)==null?void 0:d.address,"style-params":{width:"12px",height:"12px",left:"18px",bottom:"4px"}},null,8,["address"])]),n("div",Wn,[Ne(n("img",Hn,null,512),[[l,e.needReverse?e.getCoinIcon(e.positionInfo.token_a):e.getCoinIcon(e.positionInfo.token_b)]]),de(q,{address:e.needReverse?(r=(te=e.positionInfo)==null?void 0:te.token_a)==null?void 0:r.address:(oe=(se=e.positionInfo)==null?void 0:se.token_b)==null?void 0:oe.address,"style-params":{width:"12px",height:"12px",left:"18px",bottom:"4px"}},null,8,["address"])]),n("div",Xn,[n("a",{href:("getExplorerUrl"in e?e.getExplorerUrl:Z(bo))(e.currentExplorer,"nftAddress",e.positionInfo.nftHash),target:"_blank"},W(($=(f=e.positionInfo)==null?void 0:f.name)==null?void 0:$.split("|")[1]),9,Gn)]),(I(),N("svg",{class:"copy-icon","aria-hidden":"true",onClick:t[0]||(t[0]=_e=>e.indexStore.copy(e.positionInfo.nftHash||e.positionInfo.clmm_position_id))},Jn)),e.positionInfo.fee?(I(),N("div",Yn,[Qn,fe(" "+W(e.positionInfo.fee*100)+"% ",1)])):me("",!0)]),n("div",Zn,[de(m,{"current-status":(i=e.positionInfo)==null?void 0:i.currentStatus},null,8,["current-status"])])]),n("div",Kn,[n("div",null,[n("div",Vn,[n("div",xn,[Ne(n("img",et,null,512),[[l,e.needReverse?e.getCoinIcon(e.positionInfo.token_b):e.getCoinIcon(e.positionInfo.token_a)]]),de(q,{address:e.needReverse?(u=(w=e.positionInfo)==null?void 0:w.token_b)==null?void 0:u.address:(y=(g=e.positionInfo)==null?void 0:g.token_a)==null?void 0:y.address,"style-params":{width:"12px",height:"12px",left:"18px",bottom:"4px"}},null,8,["address"])]),n("div",ot,[Ne(n("img",nt,null,512),[[l,e.needReverse?e.getCoinIcon(e.positionInfo.token_a):e.getCoinIcon(e.positionInfo.token_b)]]),de(q,{address:e.needReverse?(E=(le=e.positionInfo)==null?void 0:le.token_a)==null?void 0:E.address:(J=(ne=e.positionInfo)==null?void 0:ne.token_b)==null?void 0:J.address,"style-params":{width:"12px",height:"12px",left:"18px",bottom:"4px"}},null,8,["address"])])]),n("div",tt,[n("div",null,[n("a",{href:("getExplorerUrl"in e?e.getExplorerUrl:Z(bo))(e.currentExplorer,"nftAddress",e.positionInfo.nftHash),target:"_blank"},W((R=(S=e.positionInfo)==null?void 0:S.name)==null?void 0:R.split("|")[1]),9,it),(I(),N("svg",{class:"copy-icon","aria-hidden":"true",onClick:t[1]||(t[1]=_e=>e.indexStore.copy(e.positionInfo.nftHash))},at))]),e.positionInfo.fee?(I(),N("div",lt,W(e.positionInfo.fee*100)+"%",1)):me("",!0)])]),de(m,{"current-status":(L=e.positionInfo)==null?void 0:L.currentStatus},null,8,["current-status"])]),n("div",rt,[n("div",ut,[n("div",dt,[n("div",ct,[n("div",null,[mt,n("div",vt,[n("div",{onClick:t[2]||(t[2]=_e=>e.direct=!e.direct)},ht)])]),(e.needReverse?!e.direct:e.direct)?(I(),N("div",gt,[fe(W(("addCommom"in e?e.addCommom:Z(V))(("decimalUi"in e?e.decimalUi:Z(ke))(e.positionInfo.currentPrice,6)))+"   ",1),n("span",null,W((D=e.toCoin)==null?void 0:D.symbol)+" per "+W((ie=e.fromCoin)==null?void 0:ie.symbol),1)])):(I(),N("div",kt,[fe(W(("addCommom"in e?e.addCommom:Z(V))(("decimalUi"in e?e.decimalUi:Z(ke))(e.positionInfo.currentPriceReverse,6)))+"   ",1),n("span",null,W((x=e.fromCoin)==null?void 0:x.symbol)+" per "+W((ee=e.toCoin)==null?void 0:ee.symbol),1)]))]),e.positionInfo.minPrice&&e.positionInfo.minPrice.length<9&&e.positionInfo.maxPrice&&e.positionInfo.maxPrice.length?(I(),N("div",bt,[wt,n("div",null,[(e.needReverse?!e.direct:e.direct)?(I(),N("div",_t,[fe(W(("addCommom"in e?e.addCommom:Z(V))(("decimalUi"in e?e.decimalUi:Z(ke))(e.positionInfo.minPrice,6)))+" ",1),n("span",null,W(e.positionInfo&&e.positionInfo.token_b&&e.positionInfo.token_b.symbol),1)])):(I(),N("div",yt,[fe(W(((K=e.positionInfo)==null?void 0:K.minPrice)!=="0"?("addCommom"in e?e.addCommom:Z(V))(("decimalUi"in e?e.decimalUi:Z(ke))(1/e.positionInfo.minPrice,6)):0)+" ",1),n("span",null,W(e.positionInfo&&e.positionInfo.token_a&&e.positionInfo.token_a.symbol),1)])),e.theme=="default"?(I(),N("img",It)):(I(),N("img",At)),(e.needReverse?!e.direct:e.direct)?(I(),N("div",Ct,[fe(W(((pe=e.positionInfo)==null?void 0:pe.maxPrice)!=="∞"?("addCommom"in e?e.addCommom:Z(V))(("decimalUi"in e?e.decimalUi:Z(ke))(e.positionInfo.maxPrice,6)):"∞")+" ",1),n("span",null,W(e.positionInfo&&e.positionInfo.token_b&&e.positionInfo.token_b.symbol),1)])):(I(),N("div",St,[fe(W(((F=e.positionInfo)==null?void 0:F.maxPrice)!=="∞"?("addCommom"in e?e.addCommom:Z(V))(("decimalUi"in e?e.decimalUi:Z(ke))(1/e.positionInfo.maxPrice,6)):"∞")+" ",1),n("span",null,W(e.positionInfo&&e.positionInfo.token_a&&e.positionInfo.token_a.symbol),1)]))])])):(I(),N("div",$t,[(e.needReverse?!e.direct:e.direct)?(I(),N("span",Pt," Position Range ")):(I(),N("span",Tt," Position Range ")),(e.needReverse?!e.direct:e.direct)?(I(),N("div",Nt,[fe(W(("addCommom"in e?e.addCommom:Z(V))(("decimalUi"in e?e.decimalUi:Z(ke))(e.positionInfo.minPrice,6)))+" ",1),n("span",null,W(e.positionInfo&&e.positionInfo.token_b&&e.positionInfo.token_b.symbol),1)])):(I(),N("div",Rt,[fe(W(e.positionInfo.maxPrice!=="∞"?("addCommom"in e?e.addCommom:Z(V))(("decimalUi"in e?e.decimalUi:Z(ke))(1/e.positionInfo.maxPrice,6)):"∞")+" ",1),n("span",null,W(e.positionInfo&&e.positionInfo.token_a&&e.positionInfo.token_a.symbol),1)])),n("div",Ot,[e.theme=="default"?(I(),N("img",qt)):(I(),N("img",Lt))]),(e.needReverse?!e.direct:e.direct)?(I(),N("div",Bt,[fe(W(e.positionInfo.maxPrice!=="∞"?("addCommom"in e?e.addCommom:Z(V))(("decimalUi"in e?e.decimalUi:Z(ke))(e.positionInfo.maxPrice,6)):"∞")+" ",1),n("span",null,W(e.positionInfo&&e.positionInfo.token_b&&e.positionInfo.token_b.symbol),1)])):(I(),N("div",Mt,[fe(W(((ge=e.positionInfo)==null?void 0:ge.minPrice)!=="0"?("addCommom"in e?e.addCommom:Z(V))(("decimalUi"in e?e.decimalUi:Z(ke))(1/e.positionInfo.minPrice,6)):0)+" ",1),n("span",null,W(e.positionInfo&&e.positionInfo.token_a&&e.positionInfo.token_a.symbol),1),fe("   ")]))])),n("div",Ut,[jt,n("div",Dt,W(e.lever),1)])]),n("div",Et,[de(o,{"pool-info":e.positionInfo.poolInfo,"tick-list":e.tickList,"min-price":e.needReverse&&e.positionInfo.maxPrice!=="∞"?1/e.positionInfo.maxPrice:e.positionInfo.minPrice,"max-price":e.needReverse&&e.positionInfo.minPrice!=0?1/e.positionInfo.minPrice:e.positionInfo.maxPrice,direction:!e.needReverse,"current-price-tab":"custom","chart-loading":!1},null,8,["pool-info","tick-list","min-price","max-price","direction"]),Ft])])])])}const Go=Ye(On,[["render",Wt],["__scopeId","data-v-9c241bff"]]),Ht=Je({components:{TokenWarning:mo},setup(e,t){const{t:s}=Co(),{$notify:a}=tn(),B=ze(),h=C(()=>B),q=oo(),m=C(()=>q),o=j({}),l=j({}),v=j({}),d=C(()=>h.value.chainName),k=C(()=>d.value?eo(d.value):{}),X=po(),se=j(!1),oe=async(c=null)=>{const p=c||o.value;console.log(p,"===>posInfo");const P=m.value.addressLpTokens[p.poolAddress];if(P){const A=await k.value.getTickDataByIndex(P.ticks_handle,Number(p.tick_lower_index)),H=await k.value.getTickDataByIndex(P.ticks_handle,Number(p.tick_upper_index));let G={};d.value==="Aptos"?G=await k.value.getPosRewardersAmount({poolAddress:y.currentRoute.value.query.address,positionName:y.currentRoute.value.query.token,tickLowerData:A,tickUpperData:H}):(G=await k.value.fetchPosRewardersAmount({poolAddress:p.poolAddress,positionId:p.pos_object_id||p.clmm_position_id,coinTypeA:p.coin_type_a||p.coinTypeA,coinTypeB:p.coin_type_b||p.coinTypeB,rewarderInfo:p.poolInfo.rewarder_infos}),console.log(p,"##rewarderInfo"));const M=[];let z=new b(0);G.forEach((Y,re)=>{var O,U;const ce=(O=m.value.tokensObj[Y.coin_address])==null?void 0:O.decimals,be=Y.amount_owed.toString();let Ie=new b(be).div(Math.pow(10,ce)).toString();if(d.value=="Aptos"&&Number(Ie)>999999999&&(Ie="0"),console.log(p.poolInfo,"##posInfo.poolInfo"),p.poolInfo[`rewarder_display${re+1}`]||Number(Ie)>0){const ue=m.value.tokensObj[Y.coin_address],we=((U=m.value.RATES[Y.coin_address])==null?void 0:U.price)||0,_=new b(Ie).mul(we).toString();z=new b(z).plus(_),M.push({...Y,...ue,amount:Number(Ie)>0?Te(Ie,ce):0,amountUSD:Number(_)>0?Te(_,2):0,amountUSDText:_})}}),w.value=M,console.log(M,"====>result722")}};ye(()=>[m.value.currentPositionInfo,d.value],([c,p])=>{var P;p=="Aptos"&&c?(o.value=c,l.value=c==null?void 0:c.token_a,v.value=c==null?void 0:c.token_b):p=="Sui"&&c&&(c==null?void 0:c.nftHash)==((P=X==null?void 0:X.query)==null?void 0:P.pos)&&(console.log(c,"==>newVal"),o.value=c,l.value=c==null?void 0:c.token_a,v.value=c==null?void 0:c.token_b,se.value=!1)},{immediate:!0}),ye(()=>[o.value,m.value.addressLpTokens],([c,p])=>{!ve(c)&&!ve(p)&&oe(c)},{immediate:!0});const te=C(()=>{var c,p,P,A,H,G,M,z;if(o.value&&!ve(o.value)&&m.value.RATES){const Y=o.value.amountA*((p=m.value.RATES[(c=o.value)==null?void 0:c.token_a.address])==null?void 0:p.price),re=o.value.amountB*((A=m.value.RATES[(P=o.value)==null?void 0:P.token_b.address])==null?void 0:A.price);if((G=m.value.RATES[(H=o.value)==null?void 0:H.token_a.address])!=null&&G.price&&((z=m.value.RATES[(M=o.value)==null?void 0:M.token_b.address])!=null&&z.price)){const ce=Number(Y+re);return ce>0&&ce<.01?"<0.01":V(Me(Y+re,2),2)}else return" --"}else return" --"}),r=C(()=>{var c,p,P,A;return console.log((p=(c=o.value)==null?void 0:c.poolInfo)==null?void 0:p.needReverse,"===>positionInfo.value?.poolInfo?.needReverse"),(A=(P=o.value)==null?void 0:P.poolInfo)==null?void 0:A.needReverse}),f=C(()=>m.value.RATES),$=C(()=>{var c,p;if(f.value&&l.value&&v.value&&!ve(f.value)&&!ve(l.value)&&!ve(v.value)){const P=[],A=Number(o.value.feeOwedA)||0,H=Number(o.value.feeOwedB)||0;console.log(A,H,"===292"),console.log(f.value,l.value.address,"===293"),console.log(f.value[l.value.address],"===>RATES.value[fromCoin.value.address]"),console.log(f.value[v.value.address],"===>RATES.value[toCoin.value.address]");const G=new b(A).mul(((c=f.value[l.value.address])==null?void 0:c.price)||0),M=new b(H).mul(((p=f.value[v.value.address])==null?void 0:p.price)||0);return console.log(G.toString(),M.toString(),"====>292"),P.push({amount:A,amountUSD:G.toString()},{amount:H,amountUSD:M.toString()}),P}return[]}),i=C(()=>{var p,P;let c=new b(0);return(p=$.value)==null||p.forEach(A=>{c=c.add(new b(A.amountUSD))}),d.value=="Sui"&&((P=w.value)==null||P.forEach(A=>{c=c.add(new b(A.amountUSDText))})),console.log($.value,w.value,"===>pendingRewarderArr.value"),c.toNumber()}),g=C(()=>{var p;let c=new b(0);return(p=w.value)==null||p.forEach(P=>{c=c.add(new b(P.amountUSDText))}),c.toNumber()}),y=lo(),w=j([]),{setIsShowSuccess:u,setIsShowRejected:ne,setIsShowWaiting:J,setTransactionDesc:le,setTransactionTxid:E}=B,S=ao(),R=C(()=>S),L=async()=>{se.value=!0;let c={coinTypeA:o.value.poolInfo.coinTypeA,coinTypeB:o.value.poolInfo.coinTypeB,coinTypeC:"",coinTypeD:"",coinTypeE:"",pool_address:o.value.poolAddress,pos_index:o.value.index,rewarder_nums:w.value.length,collect_fee:!0};c.coinTypeC=w.value[0]?w.value[0].coin_address:"",c.coinTypeD=w.value[1]?w.value[1].coin_address:"",c.coinTypeE=w.value[2]?w.value[2].coin_address:"",J(!0),le(),console.log(c,o.value,"###collectRewarderParams");try{let p;if(d.value==="Aptos"){const P=await k.value.getCollectRewarderTransactionPayload(c);p=await R.value.currentWallet.signAndSubmitTransaction(P)}else{c.pos_index=o.value.pos_object_id;const P=await k.value.getCollectRewarderTransactionPayload(c,o.value),A=await R.value.currentWallet.signAndExecuteTransactionBlock(P);p=k.value.handleTx(A)}if(p&&p.hash){E(p.hash),J(!1),u(!0);const P={title:"Claim",desc:"",hash:p.hash,tit:"Rewards Claimed",icon:"icon-icon-Removed"};d.value!=="Aptos"&&(P.res=p.res),k.value.showTransitionPending(P);const A=await k.value.watchTransaction(P);console.log("0310###toClaimRewards###transitionStatus###",A),A&&t.emit("getDetails")}else console.log("0310###toClaimRewards###else###"),J(!1),ne(!0),se.value=!1}catch(p){J(!1),ne(!0),se.value=!1,console.log(p,"error===>")}},D=j(!1),ie=async()=>{console.log("0310###toClaimRewards##start###",o.value),D.value=!0;const c=w.value;let p={coinTypeA:o.value.poolInfo.coinTypeA,coinTypeB:o.value.poolInfo.coinTypeB,coinTypeC:"",coinTypeD:"",coinTypeE:"",pool_address:o.value.poolAddress,pos_index:o.value.index,rewarder_nums:c.length};p.coinTypeC=c[0]?c[0].coin_address:"",p.coinTypeD=c[1]?c[1].coin_address:"",p.coinTypeE=c[2]?c[2].coin_address:"",console.log(p,"===>collectRewarderParams");try{let P;if(d.value==="Aptos"){const A=await k.value.getCollectRewarderTransactionPayload(p);P=await R.value.currentWallet.signAndSubmitTransaction(A)}else{p.pos_index=o.value.pos_object_id;const A=await k.value.getCollectRewarderTransactionPayload(p),H=await R.value.currentWallet.signAndExecuteTransactionBlock(A);P=k.value.handleTx(H)}if(console.log("0310###toClaimRewards##tx###",P),P&&P.hash){E(P.hash),J(!1),u(!0);const A=c[0].amount+c[0].symbol,H=p.coinTypeD?" and "+c[1].amount+c[1].symbol:"",G=p.coinTypeE?" and "+c[2].amount+c[2].symbol:"",M={title:"Claim",desc:"",hash:P.hash,tit:"Rewards Claimed",icon:"icon-icon-Removed",tokenInfo:{tokena:c[0].address,numa:`+ ${Number(c[0].amount)}`,logoa:m.value.tokensObj&&c[0]&&c[0].address&&m.value.tokensObj[c[0].address]&&m.value.tokensObj[c[0].address].logoURI,tokenb:c[1]&&c[1].address,numb:p.coinTypeD?`+ ${Number(c[1].amount)}`:"",logob:p.coinTypeD?m.value.tokensObj&&c[1]&&c[1].address&&m.value.tokensObj[c[1].address]&&m.value.tokensObj[c[1].address].logoURI:"",tokenc:c[2]&&c[2].address,numc:p.coinTypeE?`+ ${Number(c[2].amount)}`:"",logoc:p.coinTypeE?m.value.tokensObj&&c[2]&&c[2].address&&m.value.tokensObj[c[2].address]&&m.value.tokensObj[c[2].address].logoURI:""},text:A+H+G};d.value!=="Aptos"&&(M.res=P.res),k.value.showTransitionPending(M);const z=await k.value.watchTransaction(M);console.log("0310###toClaimRewards###transitionStatus###",z),z&&setTimeout(()=>{t.emit("getDetails"),k.value.getAccount(R.value.address)},3e3)}else console.log("0310###toClaimRewards###else###"),J(!1),ne(!0);D.value=!1}catch(P){console.log("0310###collectRewarderParams Error###",P),D.value=!1,J(!1),ne(!0)}},x=C(()=>m.value.positionDetailCurrentTab),ee=C(()=>{var P,A,H,G,M,z;const c=ke(r.value?(A=o.value)==null?void 0:A.amountB:(P=o.value)==null?void 0:P.amountA,r.value?(z=(M=o.value)==null?void 0:M.token_b)==null?void 0:z.decimals:(G=(H=o.value)==null?void 0:H.token_a)==null?void 0:G.decimals),p=r.value?m.value.positionActionAmount.toCoinAmount||0:m.value.positionActionAmount.fromCoinAmount||0;if(x.value=="increase")return p?new b(c).add(new b(p)).toString():"";if(p){const Y=new b(c).minus(new b(p)).toString();return Y<0?"0":String(Y)}else return""}),K=C(()=>{var P,A,H,G,M,z;const c=ke(r.value?(A=o.value)==null?void 0:A.amountA:(P=o.value)==null?void 0:P.amountB,r.value?(z=(M=o.value)==null?void 0:M.token_a)==null?void 0:z.decimals:(G=(H=o.value)==null?void 0:H.token_b)==null?void 0:G.decimals),p=r.value?m.value.positionActionAmount.fromCoinAmount||0:m.value.positionActionAmount.toCoinAmount||0;if(console.log(c,p,"===>427"),x.value=="increase")return p?new b(c).add(new b(p)).toString():"";if(p){const Y=new b(c).minus(new b(p)).toString();return Y<0?"0":String(Y)}else return""}),pe=C(()=>r.value?m.value.positionActionAmount.toCoinAmount:m.value.positionActionAmount.fromCoinAmount),F=C(()=>r.value?m.value.positionActionAmount.fromCoinAmount:m.value.positionActionAmount.toCoinAmount),ge=c=>{var p;return(c==null?void 0:c.logoURI)||(c==null?void 0:c.logo_url)||((p=m.value.tokensObj[c==null?void 0:c.address])==null?void 0:p.logo_url)||(h.value.theme==="default"?xe("/image/coins/unknown.png"):xe("/image/coins/sui-unknown.png"))},_e=C(()=>{var G,M,z,Y,re,ce,be,Ie,O,U,ue,we;const{fromCoinAmount:c,toCoinAmount:p}=m.value.positionActionAmount,P=m.value.positionDetailCurrentTab,A=ke(r.value?(M=o.value)==null?void 0:M.amountB:(G=o.value)==null?void 0:G.amountA,r.value?(ce=(re=o.value)==null?void 0:re.token_b)==null?void 0:ce.decimals:(Y=(z=o.value)==null?void 0:z.token_a)==null?void 0:Y.decimals),H=ke(r.value?(Ie=o.value)==null?void 0:Ie.amountA:(be=o.value)==null?void 0:be.amountB,r.value?(we=(ue=o.value)==null?void 0:ue.token_a)==null?void 0:we.decimals:(U=(O=o.value)==null?void 0:O.token_b)==null?void 0:U.decimals);return console.log(A,H,c,p,"621===>"),d.value=="Sui"||P=="remove"&&d.value=="Aptos"&&c==A&&p==H});return{amountUSD:te,needReverse:r,decimalUi:ke,pendingFees:$,positionInfo:o,pendingRewarderArr:w,pendingYieldAmount:i,toClaim:async()=>{se.value=!0;const c=V(o.value.feeOwedA,o.value.token_a.decimals)==0?"":`${Te(o.value.feeOwedA,o.value.token_a.decimals)} ${o.value.token_a.symbol}`,p=V(o.value.feeOwedB,o.value.token_b.decimals)==0?"":`${Te(o.value.feeOwedB,o.value.token_b.decimals)} ${o.value.token_b.symbol}`;le(s("newAdd.claimWaitingText",{from:r.value?p:c,and:V(o.value.feeOwedA,o.value.token_a.decimals)==0||V(o.value.feeOwedB,o.value.token_b.decimals)==0?"":"and",to:r.value?c:p})),J(!0);let P;const A={pool:o.value.poolInfo,position:o.value};try{const H=await k.value.getCollectFeeTransactionPayload(A);if(d.value==="Aptos")P=await R.value.currentWallet.signAndSubmitTransaction(H);else{const G=await R.value.currentWallet.signAndExecuteTransactionBlock(H);P=k.value.handleTx(G)}if(P){E(P.hash),J(!1),u(!0);const G={title:"Claim",desc:"",hash:P.hash,tit:"Fees Claimed",icon:"icon-icon-Removed",tokenInfo:{tokena:`${o.value.token_a.address}`,numa:V(o.value.feeOwedA,o.value.token_a.decimals)==0?"":`${Te(o.value.feeOwedA,o.value.token_a.decimals)}`,logoa:V(o.value.feeOwedA,o.value.token_a.decimals)==0?"":m.value.tokensObj&&o.value&&o.value.token_a.address&&m.value.tokensObj[o.value.token_a.address]&&m.value.tokensObj[o.value.token_a.address].logoURI,tokenb:`${o.value.token_b.address}`,numb:V(o.value.feeOwedB,o.value.token_b.decimals)==0?"":`${Te(o.value.feeOwedB,o.value.token_b.decimals)}`,logob:V(o.value.feeOwedB,o.value.token_b.decimals)==0?"":m.value.tokensObj&&o.value&&o.value.token_b.address&&m.value.tokensObj[o.value.token_b.address]&&m.value.tokensObj[o.value.token_b.address].logoURI},text:`Claim ${V(o.value.feeOwedA,o.value.token_a.decimals)==0?"":`${Te(o.value.feeOwedA,o.value.token_a.decimals)} ${o.value.token_a.symbol}`}  
              ${V(o.value.feeOwedA,o.value.token_a.decimals)==0||V(o.value.feeOwedB,o.value.token_b.decimals)==0?"":"and"} ${V(o.value.feeOwedB,o.value.token_b.decimals)==0?"":`${Te(o.value.feeOwedB,o.value.token_b.decimals)} ${o.value.token_b.symbol}`}

            `};d.value!=="Aptos"&&(G.res=P.res),k.value.showTransitionPending(G);const M=await k.value.watchTransaction(G);console.log("0310##toClaim###transitionStatus####",M),M&&setTimeout(()=>{t.emit("getDetails")},1e3)}else J(!1),ne(!0),a.error({icon:Ge("svg",{class:{icon:!0},"aria-hidden":!0},[Ge("use",{"xlink:href":"#icon-a-icon-Shutdown"})]),duration:4.5,message:Ge("div",{class:"notification-title"},[Ge("span",{innerHTML:Po.global.t("newAdd.claimFailed")},null)]),description:s("newAdd.somethingWrong"),class:"ant-notification-copy ant-notification-error"});se.value=!1,console.log("claim####test###",P)}catch(H){console.log("claim###error####",H),se.value=!1,J(!1),ne(!0),a.error({icon:Ge("svg",{class:{icon:!0},"aria-hidden":!0},[Ge("use",{"xlink:href":"#icon-a-icon-Shutdown"})]),message:Ge("div",{class:"notification-title"},[Ge("span",{innerHTML:Po.global.t("newAdd.claimFailed")},null)]),duration:4.5,description:s("newAdd.somethingWrong"),class:"ant-notification-copy ant-notification-error"})}},claimAll:L,fromCoin:l,toCoin:v,showNum:Te,claimLoading:se,addCommom:V,afterBase:ee,afterQuote:K,fromCoinAmount:pe,toCoinAmount:F,checkNullObj:ve,getCoinIcon:ge,chainName:d,isShowAfterAmount:_e,pendingRewarderAmount:g,toClaimRewards:ie,rewarderLoading:D}}});const Xt={class:"liquidity-card"},Gt={class:"liquidity-title"},zt={class:"liquidity-usd"},Jt=n("span",null,"Liquidity",-1),Yt={class:"liquidity-ratio"},Qt={class:"coin-ratio"},Zt={class:"coin-a-ratio"},Kt={class:"coin-b-ratio"},Vt={class:"ratio-progress"},xt={class:"base-quote-num"},ei={class:"base-coin-num"},oi=n("span",null,"Base",-1),ni={alt:""},ti={key:0,class:"after"},ii={class:"quote-coin-num"},si=n("span",null,"Quote",-1),ai={alt:""},li={key:0,class:"after"},ri={class:"pending-yield"},ui={class:"left"},di={class:"pending-yield-title"},ci={key:0,class:"after"},mi={class:"right"},vi={class:"fees-rewards"},fi={class:"fees-rewards-item"},pi=n("span",null,"Fees",-1),hi={key:0,class:"after"},gi=n("span",null,"Fees",-1),ki={key:0,class:"after"},bi=n("span",null,"Bonus",-1),wi={alt:""},_i={key:0,class:"after"},yi={key:0,class:"pending-yield"},Ii={class:"left"},Ai=n("div",{class:"pending-yield-title"},"Pending rewards",-1),Ci={key:0,class:"after"},Si={class:"right"},$i={key:1,class:"fees-rewards"},Pi={class:"fees-rewards-item"},Ti=n("span",null,"Bonus",-1),Ni={alt:""},Ri={key:0,class:"after"};function Oi(e,t,s,a,B,h){var l,v,d,k,X,se,oe,te,r,f,$,i,g,y,w,u,ne,J,le,E,S,R,L,D,ie,x,ee,K,pe,F,ge,_e,Fe,c,p,P,A,H,G,M,z,Y,re,ce,be,Ie,O,U,ue,we,_,Q,T,ae,he,$e,Re,Ae,Pe,Ue,je,He,Oe,De;const q=mo,m=ro,o=Ao("image");return I(),N("div",Xt,[n("div",Gt,[n("div",zt,[Jt,n("div",null,"$"+W(e.amountUSD),1)]),n("div",Yt,[n("div",Qt,[n("div",Zt,[n("span",null,W(e.needReverse?(v=e.toCoin)==null?void 0:v.symbol:(l=e.fromCoin)==null?void 0:l.symbol),1),fe(" "+W(e.needReverse?(k=e.positionInfo)==null?void 0:k.toPercent:(d=e.positionInfo)==null?void 0:d.fromPercent)+"% ",1)]),n("div",Kt,[n("span",null,W(e.needReverse?(se=e.fromCoin)==null?void 0:se.symbol:(X=e.toCoin)==null?void 0:X.symbol),1),fe(" "+W(e.needReverse?(te=e.positionInfo)==null?void 0:te.fromPercent:(oe=e.positionInfo)==null?void 0:oe.toPercent)+"% ",1)])]),n("div",Vt,[n("div",{class:"from-percent",style:To({width:e.needReverse?((f=e.positionInfo)==null?void 0:f.toPercent)+"%":((r=e.positionInfo)==null?void 0:r.fromPercent)+"%"})},null,4),n("div",{class:"to-percent",style:To({width:e.needReverse?((i=e.positionInfo)==null?void 0:i.fromPercent)+"%":(($=e.positionInfo)==null?void 0:$.toPercent)+"%"})},null,4)])])]),n("div",xt,[n("div",ei,[oi,n("div",null,[Ne(n("img",ni,null,512),[[o,(e.needReverse?(y=e.toCoin)==null?void 0:y.logo_url:(g=e.fromCoin)==null?void 0:g.logo_url)||e.getCoinIcon(e.needReverse?(u=e.positionInfo)==null?void 0:u.token_b:(w=e.positionInfo)==null?void 0:w.token_a)]]),de(q,{address:e.needReverse?(E=(le=e.positionInfo)==null?void 0:le.token_b)==null?void 0:E.address:(J=(ne=e.positionInfo)==null?void 0:ne.token_a)==null?void 0:J.address,"style-params":{width:"10px",height:"10px",left:"15px",bottom:"8px"}},null,8,["address"]),n("span",null,W(("addCommom"in e?e.addCommom:Z(V))(("decimalUi"in e?e.decimalUi:Z(ke))(e.needReverse?(R=e.positionInfo)==null?void 0:R.amountB:(S=e.positionInfo)==null?void 0:S.amountA,e.needReverse?(x=(ie=e.positionInfo)==null?void 0:ie.token_b)==null?void 0:x.decimals:(D=(L=e.positionInfo)==null?void 0:L.token_a)==null?void 0:D.decimals))),1)]),e.afterBase&&!("checkNullObj"in e?e.checkNullObj:Z(ve))(e.positionInfo)?(I(),N("div",ti,W(("addCommom"in e?e.addCommom:Z(V))(e.afterBase))+" after ",1)):me("",!0)]),n("div",ii,[si,n("div",null,[Ne(n("img",ai,null,512),[[o,(e.needReverse?(K=e.fromCoin)==null?void 0:K.logo_url:(ee=e.toCoin)==null?void 0:ee.logo_url)||e.getCoinIcon(e.needReverse?(F=e.positionInfo)==null?void 0:F.token_a:(pe=e.positionInfo)==null?void 0:pe.token_b)]]),de(q,{address:e.needReverse?(c=(Fe=e.positionInfo)==null?void 0:Fe.token_a)==null?void 0:c.address:(_e=(ge=e.positionInfo)==null?void 0:ge.token_b)==null?void 0:_e.address,"style-params":{width:"10px",height:"10px",left:"15px",bottom:"8px"}},null,8,["address"]),n("span",null,W(("addCommom"in e?e.addCommom:Z(V))(("decimalUi"in e?e.decimalUi:Z(ke))(e.needReverse?(P=e.positionInfo)==null?void 0:P.amountA:(p=e.positionInfo)==null?void 0:p.amountB,e.needReverse?(M=(G=e.positionInfo)==null?void 0:G.token_a)==null?void 0:M.decimals:(H=(A=e.positionInfo)==null?void 0:A.token_b)==null?void 0:H.decimals))),1)]),e.afterQuote&&!("checkNullObj"in e?e.checkNullObj:Z(ve))(e.positionInfo)?(I(),N("div",li,W(("addCommom"in e?e.addCommom:Z(V))(e.afterQuote))+" after ",1)):me("",!0)])]),n("div",ri,[n("div",ui,[n("div",di,W(e.chainName=="Sui"?"Pending Yield":"Pending fees"),1),n("div",null,[fe(" $"+W(e.pendingYieldAmount>0&&e.pendingYieldAmount<.01?"<0.01":("addCommom"in e?e.addCommom:Z(V))(e.pendingYieldAmount,2))+" ",1),e.pendingYieldAmount>0?(I(),N("span",ci,"$0 after")):me("",!0)])]),n("div",mi,[de(m,{class:"claim-all",loading:e.claimLoading,disabled:e.claimLoading||e.pendingYieldAmount==0,onClick:t[0]||(t[0]=Ce=>e.chainName=="Sui"?e.claimAll():e.toClaim())},{default:Be(()=>[fe("Claim")]),_:1},8,["loading","disabled"])])]),n("div",vi,[n("div",fi,[n("div",null,[pi,n("div",null,[Ne(n("img",null,null,512),[[o,(e.needReverse?(Y=e.toCoin)==null?void 0:Y.logo_url:(z=e.fromCoin)==null?void 0:z.logo_url)||e.getCoinIcon(e.needReverse?(ce=e.positionInfo)==null?void 0:ce.token_b:(re=e.positionInfo)==null?void 0:re.token_a)]]),de(q,{address:e.needReverse?(U=(O=e.positionInfo)==null?void 0:O.token_b)==null?void 0:U.address:(Ie=(be=e.positionInfo)==null?void 0:be.token_a)==null?void 0:Ie.address,"style-params":{width:"10px",height:"10px",left:"15px",bottom:"8px"}},null,8,["address"]),n("span",null,W(e.needReverse?("showNum"in e?e.showNum:Z(Te))(e.positionInfo.feeOwedB,(Q=(_=e.positionInfo)==null?void 0:_.token_b)==null?void 0:Q.decimals):("showNum"in e?e.showNum:Z(Te))(e.positionInfo.feeOwedA,(we=(ue=e.positionInfo)==null?void 0:ue.token_a)==null?void 0:we.decimals)),1)]),(e.fromCoinAmount||e.toCoinAmount)&&!("checkNullObj"in e?e.checkNullObj:Z(ve))(e.positionInfo)&&e.isShowAfterAmount?(I(),N("div",hi," 0 after ")):me("",!0)]),n("div",null,[gi,n("div",null,[Ne(n("img",null,null,512),[[o,(e.needReverse?(ae=e.fromCoin)==null?void 0:ae.logo_url:(T=e.toCoin)==null?void 0:T.logo_url)||e.getCoinIcon(e.needReverse?($e=e.positionInfo)==null?void 0:$e.token_a:(he=e.positionInfo)==null?void 0:he.token_b)]]),de(q,{address:e.needReverse?(Ue=(Pe=e.positionInfo)==null?void 0:Pe.token_a)==null?void 0:Ue.address:(Ae=(Re=e.positionInfo)==null?void 0:Re.token_b)==null?void 0:Ae.address,"style-params":{width:"10px",height:"10px",left:"15px",bottom:"8px"}},null,8,["address"]),n("span",null,W(e.needReverse?("showNum"in e?e.showNum:Z(Te))(e.positionInfo.feeOwedA,(De=(Oe=e.positionInfo)==null?void 0:Oe.token_a)==null?void 0:De.decimals):("showNum"in e?e.showNum:Z(Te))(e.positionInfo.feeOwedB,(He=(je=e.positionInfo)==null?void 0:je.token_b)==null?void 0:He.decimals)),1)]),(e.fromCoinAmount||e.toCoinAmount)&&!("checkNullObj"in e?e.checkNullObj:Z(ve))(e.positionInfo)&&e.isShowAfterAmount?(I(),N("div",ki," 0 after ")):me("",!0)]),e.chainName=="Sui"?(I(!0),N(io,{key:0},so(e.pendingRewarderArr,Ce=>(I(),N("div",{key:Ce},[bi,n("div",null,[Ne(n("img",wi,null,512),[[o,Ce.logo_url]]),de(q,{address:Ce.address,"style-params":{width:"10px",height:"10px",left:"15px",bottom:"8px"}},null,8,["address"]),n("span",null,W(Ce.amount),1)]),(e.fromCoinAmount||e.toCoinAmount)&&!("checkNullObj"in e?e.checkNullObj:Z(ve))(e.positionInfo)&&e.isShowAfterAmount?(I(),N("div",_i," 0 after ")):me("",!0)]))),128)):me("",!0)])]),e.chainName=="Aptos"&&e.pendingRewarderAmount>0?(I(),N("div",yi,[n("div",Ii,[Ai,n("div",null,[fe(" $"+W(e.pendingRewarderAmount>0&&e.pendingRewarderAmount<.01?"<0.01":("addCommom"in e?e.addCommom:Z(V))(e.pendingRewarderAmount,2))+" ",1),e.pendingRewarderAmount>0?(I(),N("span",Ci,"$0 after")):me("",!0)])]),n("div",Si,[de(m,{class:"claim-all",loading:e.rewarderLoading,disabled:e.rewarderLoading||e.pendingRewarderAmount==0,onClick:e.toClaimRewards},{default:Be(()=>[fe("Claim")]),_:1},8,["loading","disabled","onClick"])])])):me("",!0),e.chainName=="Aptos"&&e.pendingRewarderAmount>0?(I(),N("div",$i,[n("div",Pi,[(I(!0),N(io,null,so(e.pendingRewarderArr,Ce=>(I(),N("div",{key:Ce},[Ti,n("div",null,[Ne(n("img",Ni,null,512),[[o,Ce.logo_url]]),de(q,{address:Ce.address,"style-params":{width:"10px",height:"10px",left:"15px",bottom:"8px"}},null,8,["address"]),n("span",null,W(Ce.amount),1)]),(e.fromCoinAmount||e.toCoinAmount)&&!("checkNullObj"in e?e.checkNullObj:Z(ve))(e.positionInfo)&&e.isShowAfterAmount?(I(),N("div",Ri," 0 after ")):me("",!0)]))),128))])])):me("",!0)])}const zo=Ye(Ht,[["render",Oi]]),qi=Je({components:{AssetsCard:ho},setup(e,t){const s=j(""),a=j(""),B=ze(),h=C(()=>B),q=C(()=>h.value.theme),m=oo(),o=C(()=>m),l=j(!1),v=j(!1),d=j(!0),k=C(()=>h.value.chainName),X=C(()=>k.value?eo(k.value):{}),se=ao(),oe=C(()=>se),te=C(()=>h.value.slippage),r=j(),f=j(),$=C(()=>oe.value.assets&&r.value&&oe.value.assets[r.value.address]?So(oe.value.assets[r.value.address].balance,r.value.decimals):0),i=C(()=>oe.value.assets&&f.value&&oe.value.assets[f.value.address]?So(oe.value.assets[f.value.address].balance,f.value.decimals):0),g=A=>{A==="fromCoin"?(d.value=!0,k.value==="Aptos"?s.value=$.value>0?r.value.symbol=="APT"?new b(Number($.value)).sub(new b(.1)).lt(new b(0))?"0":new b(Number($.value)).sub(new b(.1)).toString():String($.value):"":s.value=$.value>0?r.value.symbol=="SUI"?new b(Number($.value)).sub(new b(.05)).lt(new b(0))?"0":new b(Number($.value)).sub(new b(.05)).toString():String($.value):""):(d.value=!1,k.value==="Aptos"?a.value=i.value>0?f.value.symbol=="APT"?new b(Number(i.value)).sub(new b(.1)).lt(new b(0))?"0":new b(Number(i.value)).sub(new b(.1)).toString():String(i.value):"":a.value=i.value>0?f.value.symbol=="SUI"?new b(Number(i.value)).sub(new b(.05)).lt(new b(0))?"0":new b(Number(i.value)).sub(new b(.05)).toString():String(i.value):"")},y=A=>{A==="fromCoin"?(d.value=!0,s.value=Me(new b(Number($.value)).div(2).toString(),r.value.decimals).toString()):(d.value=!1,a.value=Me(new b(Number(i.value)).div(2).toString(),f.value.decimals).toString())},w=j({}),u=j(!0),ne=j({}),J=j(),le=j(),E=()=>{var U;if(!w.value||!s.value&&!a.value)return;const{TickMath:A,TickUtil:H}=X.value;console.log(s.value,a.value,"====>369"),console.log(w.value,"===>positionInfo.value339");let G=w.value.minPrice,M=w.value.maxPrice.indexOf("+")>0?"∞":w.value.maxPrice;console.log(w.value,"positionInfo.value====>");let z=Number(w.value.tick_lower_index),Y=Number(w.value.tick_upper_index);const re=Number(w.value.current_tick_index);let ce,be,Ie=Number(G).toString(),O=w.value.maxPrice.indexOf("+")>0||w.value.maxPrice==="∞"?"∞":Number(M);if(Ie=="0"&&O=="∞"?(z=Number(w.value.tick_lower_index),Y=Number(w.value.tick_upper_index)):(ce=A.priceToSqrtPriceX64(new b(G),r.value.decimals,f.value.decimals),be=A.priceToSqrtPriceX64(new b(M),r.value.decimals,f.value.decimals)),J.value=z,le.value=Y,console.log(z,Y,"tick_lowertick_lower"),M!=="∞"&&z>=Y){l.value=!0,s.value="",v.value=!0,a.value="";return}if(M=="∞"||re>=z&&re<=Y){console.log("0413###increase###11111"),l.value=!1,v.value=!1;let ue;if(s.value||a.value){if(d.value){const he=new b(s.value).mul(Math.pow(10,r.value.decimals)).toString();ue=new qe(he)}else{const he=new b(a.value).mul(Math.pow(10,f.value.decimals)).toString();ue=new qe(he)}const{liquidityAmount:we,tokenMaxA:_,tokenMaxB:Q,tokenMaxAOrigin:T,tokenMaxBOrigin:ae}=X.value.estLiquidityAndcoinAmountFromOneAmounts({tokenA:r.value,tokenB:f.value,lowerTick:z,upperTick:Y,coinAmount:ue,iscoinA:u.value?d.value:!d.value,roundUp:!0,slippage:Number(te.value)/100,curSqrtPrice:new qe(w.value.current_sqrt_price)});ne.value={liquidityAmount:we,tokenMaxA:_,tokenMaxB:Q,tokenMaxAOrigin:T,tokenMaxBOrigin:ae},u.value?d.value?a.value=Number(Q)>0?Q:"":s.value=Number(_)>0?_:"":d.value?a.value=_:s.value=Q}}else if(re>Y){if(console.log("0413###increase###22222"),s.value="",l.value=!0,v.value=!1,s.value||a.value){let ue;const we=new b(a.value).mul(Math.pow(10,(U=f.value)==null?void 0:U.decimals)).toString();ue=new qe(we),ne.value={liquidityAmount:Lo(ce,be,ue),tokenMaxA:0,tokenMaxB:a.value}}}else if(re<z){if(console.log("0413###increase###33333"),l.value=!1,v.value=!0,a.value="",s.value||a.value){let ue;const we=new b(s.value).mul(Math.pow(10,r.value.decimals)).toString();ue=new qe(we),ne.value={liquidityAmount:Bo(ce,be,ue),tokenMaxA:s.value,tokenMaxB:0}}}else console.log("0413###increase###4444"),l.value=!0,s.value="",v.value=!0,a.value="";m.setPositionActionAmount({fromCoinAmount:s,toCoinAmount:a}),console.log(ne.value.liquidityAmount,"====>liquidityInput.value.liquidityAmount")};ye(()=>o.value.currentPositionInfo,A=>{if(A&&!ve(A)){w.value=A,console.log(A,"newVal===>"),r.value=w.value.token_a,f.value=w.value.token_b;let H=Number(w.value.tick_lower_index),G=Number(w.value.tick_upper_index);const M=Number(w.value.current_tick_index);(A.maxPrice.indexOf("+")>0||A.maxPrice==="∞"?"∞":A.maxPrice)=="∞"||M>=H&&M<=G?(l.value=!1,v.value=!1):M>G?(s.value="",l.value=!0,v.value=!1):M<H?(l.value=!1,v.value=!0,a.value=""):(l.value=!0,s.value="",v.value=!0,a.value=""),E()}},{immediate:!0}),ye(s,(A,H)=>{A&&E(),A==""&&(a.value="")}),ye(a,(A,H)=>{A&&E(),A==""&&(s.value="")});const S=C(()=>{var A,H,G,M;return console.log((H=(A=w.value)==null?void 0:A.poolInfo)==null?void 0:H.needReverse,"===>positionInfo.value?.poolInfo?.needReverse"),(M=(G=w.value)==null?void 0:G.poolInfo)==null?void 0:M.needReverse}),R=C(()=>o.value.RATES),L=C(()=>{var Y,re,ce,be;const A=((re=R.value[(Y=r.value)==null?void 0:Y.address])==null?void 0:re.price)||0,H=((be=R.value[(ce=f.value)==null?void 0:ce.address])==null?void 0:be.price)||0,G=new b(A).mul(new b(s.value||0)),M=new b(H).mul(new b(a.value||0)),z=G.add(M);return console.log(A,H,G.toString(),M.toString(),"====>amount"),z.toNumber()?z.toNumber()>0&&z.toNumber()>.01?V(z.toString(),2):"<0.01":"--"}),D=j(!1),{t:ie,locale:x}=Co(),ee=C(()=>{const A=Number(s.value)>Number($.value),H=Number(a.value)>Number(i.value);return!s.value&&!a.value?ie("button.enterAmount"):A?ie("button.insufficientBalance",{name:r.value.symbol}):H?ie("button.insufficientBalance",{name:f.value.symbol}):ie("newAdd.addMore")}),K=C(()=>{const A=Number(s.value)>Number($.value),H=Number(a.value)>Number(i.value);return!!(!s.value&&!a.value||A||H)}),{setIsShowSuccess:pe,setIsShowRejected:F,setIsShowWaiting:ge,setTransactionDesc:_e,setTransactionTxid:Fe,setPositiomNum:c}=B,p=j(!1);return{theme:q,showFromCoinLock:l,showToCoinLock:v,toCoinAmount:a,fromCoinAmount:s,fromCoinBlance:$,toCoinBlance:i,fromCoin:r,toCoin:f,maxBtnSelect:g,halfBtnSelect:y,fixedFromCoin:d,needReverse:S,totalAmount:L,wallet:oe,addLiquidityBtnText:ee,isShowLiquidityModal:D,indexStore:B,positionInfo:w,actionLoading:p,toAdd:async()=>{var Y,re,ce,be,Ie,O,U,ue,we,_;D.value=!1,p.value=!0,Fe("");const A=l.value?"":`${s.value} ${(Y=r.value)==null?void 0:Y.symbol}`,H=v.value?"":`${a.value} ${(re=f.value)==null?void 0:re.symbol}`;_e(ie("tips.increaseLiquiditySuccess",{from:S.value?H:A,and:!l.value&&!v.value?"and":"",to:S.value?A:H})),ge(!0);const G=d.value;console.log(G,"===>fix_amount_a"),console.log(J.value,"tickLower.value===>"),console.log(le.value,"tickUpper.value,===>"),console.log("0222###increase###positionInfo###",w);const M=w.value.poolInfo.rewarder_infos;let z={};z.coinTypeC=M[0]?M[0].coinAddress:"",z.coinTypeD=M[1]?M[1].coinAddress:"",z.coinTypeE=M[2]?M[2].coinAddress:"",console.log("0103 toAdd positionInfo: ",w),console.log("0103 toAdd liquidityInput: ",ne);try{const Q=await X.value.getAddLiquidityTransactionPayload({pool:{poolAddress:w.value.poolAddress,token_a:w.value.token_a,token_b:w.value.token_b},amount:G?ne.value.tokenMaxA:ne.value.tokenMaxB,fix_amount_a:G,tick_lower:J.value,tick_upper:le.value,index:k.value==="Aptos"?w.value.index:w.value.pos_object_id,slippage:Number(te.value)/100,roundUp:!0,collect_fee:!0,...z,curSqrtPrice:new qe(w==null?void 0:w.value.poolInfo.current_sqrt_price),positionInfo:w});console.log(Q,"===>payloadAdd11111");let T;if(k.value==="Aptos")T=await oe.value.currentWallet.signAndSubmitTransaction(Q);else{const ae=await oe.value.currentWallet.signAndExecuteTransactionBlock(Q);T=X.value.handleTx(ae)}if(console.log("toAdd###tx###",T),T&&T.hash){Fe(T.hash),ge(!1),pe(!0),console.log(w,"===>positionInfo");const ae={title:"Supplied",desc:ie("tips.addLiquiditySuccessText",{from:l.value?"":`${s.value} ${(ce=r.value)==null?void 0:ce.symbol}`,and:!l.value&&!v.value?"and":"",to:v.value?"":`${a.value} ${(be=f.value)==null?void 0:be.symbol}`}),hash:T.hash,tit:"Liquidity Increased",icon:"icon-icon-Increased",tokenInfo:{tokena:S.value?`${(O=f.value)==null?void 0:O.address}`:`${(Ie=r.value)==null?void 0:Ie.address}`,numa:S.value?`- ${a.value}`:`- ${s.value}`,logoa:S.value?o.value.tokensObj&&f.value&&f.value.address&&o.value.tokensObj[f.value.address]&&o.value.tokensObj[f.value.address].logoURI:o.value.tokensObj&&r.value&&r.value.address&&o.value.tokensObj[r.value.address]&&o.value.tokensObj[r.value.address].logoURI,tokenb:S.value?`${(ue=r.value)==null?void 0:ue.address}`:`${(U=f.value)==null?void 0:U.address}`,numb:S.value?`- ${s.value}`:`- ${a.value}`,logob:S.value?o.value.tokensObj&&r.value&&r.value.address&&o.value.tokensObj[r.value.address]&&o.value.tokensObj[r.value.address].logoURI:o.value.tokensObj&&f.value&&f.value.address&&o.value.tokensObj[f.value.address]&&o.value.tokensObj[f.value.address].logoURI},text:`Deopsit ${l.value?"":`${s.value} ${(we=r.value)==null?void 0:we.symbol}`} ${!l.value&&!v.value?"and":""} ${v.value?"":`${a.value} ${(_=f.value)==null?void 0:_.symbol}`}`};k.value!=="Aptos"&&(ae.res=T.res),X.value.showTransitionPending(ae),await X.value.watchTransaction(ae)&&setTimeout(()=>{t.emit("getDetails"),X.value.getAccount(oe.value.address)},1e3),c()}else ge(!1),F(!0);s.value="",a.value="",p.value=!1}catch(Q){s.value="",a.value="",console.log("addError###",Q),p.value=!1,ge(!1),F(!0)}},addLiquidityBtnDisabled:K,poolStore:m}}});const Li={class:"new-position-asset"},Bi={class:"add-or-remove"},Mi={class:"liquidity-action-tab"},Ui=n("div",{class:"increase tab-active"}," Increase ",-1),ji={class:"card-item"},Di={class:"card-item"},Ei={key:0,class:"add",src:mn},Fi={key:1,class:"add",src:vn},Wi={class:"total-amount"},Hi=n("span",null,"Total Amount",-1);function Xi(e,t,s,a,B,h){var v;const q=ho,m=dn,o=ro,l=cn;return I(),N("div",Li,[n("div",Bi,[n("div",Mi,[Ui,n("div",{class:"remove",onClick:t[0]||(t[0]=d=>e.poolStore.setPositionDetailCurrentTab("remove"))}," Remove ")]),n("div",{class:wo(e.needReverse?"card-container reverse":"card-container")},[n("div",ji,[de(q,{modelValue:e.fromCoinAmount,"onUpdate:modelValue":t[1]||(t[1]=d=>e.fromCoinAmount=d),"input-value":e.fromCoinAmount,"coin-symbol":e.fromCoin?e.fromCoin.symbol:null,"coin-name":e.fromCoin?e.fromCoin.name:null,balance:e.fromCoinBlance,"coin-icon":e.fromCoin?e.fromCoin.logoURI:"",address:e.fromCoin?e.fromCoin.address:"","swap-direct":"From","import-page":"deposit","has-arrow":!1,onOnMax:t[2]||(t[2]=d=>e.maxBtnSelect("fromCoin")),onOnHalf:t[3]||(t[3]=d=>e.halfBtnSelect("fromCoin")),onOnInput:t[4]||(t[4]=d=>{e.fromCoinAmount=d}),onOnFocus:t[5]||(t[5]=()=>{e.fixedFromCoin=!0})},null,8,["modelValue","input-value","coin-symbol","coin-name","balance","coin-icon","address"]),e.showFromCoinLock?(I(),Le(m,{key:0,"from-coin":e.fromCoin,"to-coin":e.toCoin},null,8,["from-coin","to-coin"])):me("",!0)]),n("div",Di,[de(q,{modelValue:e.toCoinAmount,"onUpdate:modelValue":t[6]||(t[6]=d=>e.toCoinAmount=d),"input-value":e.toCoinAmount,"coin-symbol":e.toCoin?e.toCoin.symbol:null,"coin-name":e.toCoin?e.toCoin.name:null,balance:e.toCoinBlance,"swap-direct":"To","coin-icon":e.toCoin?e.toCoin.logoURI:"",address:e.toCoin?e.toCoin.address:"","import-page":"deposit","has-arrow":!1,onOnMax:t[7]||(t[7]=d=>e.maxBtnSelect("toCoin")),onOnHalf:t[8]||(t[8]=d=>e.halfBtnSelect("toCoin")),onOnInput:t[9]||(t[9]=d=>{e.toCoinAmount=d}),onOnFocus:t[10]||(t[10]=()=>{e.fixedFromCoin=!1})},null,8,["modelValue","input-value","coin-symbol","coin-name","balance","coin-icon","address"]),e.showToCoinLock?(I(),Le(m,{key:0,"from-coin":e.fromCoin,"to-coin":e.toCoin},null,8,["from-coin","to-coin"])):me("",!0)]),e.fromCoin&&e.toCoin&&!e.showToCoinLock&&!e.showFromCoinLock&&e.theme=="default"?(I(),N("img",Ei)):me("",!0),e.fromCoin&&e.toCoin&&!e.showToCoinLock&&!e.showFromCoinLock&&e.theme!=="default"?(I(),N("img",Fi)):me("",!0)],2),n("div",Wi,[Hi,n("span",null,"$"+W(e.totalAmount),1)])]),e.wallet.connected?(I(),Le(o,{key:0,class:"big-btn liquidity-btn",disabled:e.addLiquidityBtnDisabled,loading:e.actionLoading,onClick:t[11]||(t[11]=d=>e.isShowLiquidityModal=!0)},{default:Be(()=>[n("span",null,W(e.addLiquidityBtnText),1)]),_:1},8,["disabled","loading"])):(I(),Le(o,{key:1,class:"big-btn",onClick:t[12]||(t[12]=d=>e.wallet.connected?e.isShowLiquidityModal=!0:e.wallet.setIsShowWalletModal(!0))},{default:Be(()=>[n("span",null,W(e.$t("button.connectWallet")),1)]),_:1})),e.isShowLiquidityModal?(I(),Le(l,{key:2,title:e.$t("button.increase"),"is-increase":!0,"from-coin":e.needReverse?e.toCoin:e.fromCoin,"to-coin":e.needReverse?e.fromCoin:e.toCoin,"from-coin-amount":e.needReverse?e.toCoinAmount:e.fromCoinAmount,"to-coin-amount":e.needReverse?e.fromCoinAmount:e.toCoinAmount,"min-price":e.positionInfo.minPrice,"max-price":e.positionInfo.maxPrice,"current-price":e.positionInfo.currentPrice,"current-price-reverse":1/e.positionInfo.currentPrice,"pool-info":(v=e.positionInfo)==null?void 0:v.poolInfo,"show-from-coin-lock":e.showFromCoinLock,"show-to-coin-lock":e.showToCoinLock,"position-total-amount":e.positionInfo.totalAmountUSD,"fixed-from-coin":!0,"tick-lower":e.positionInfo.tick_lower_index,"tick-upper":e.positionInfo.tick_upper_index,"current-price-tab":"custom",onToAdd:e.toAdd,onOnClose:t[13]||(t[13]=d=>e.isShowLiquidityModal=!1)},null,8,["title","from-coin","to-coin","from-coin-amount","to-coin-amount","min-price","max-price","current-price","current-price-reverse","pool-info","show-from-coin-lock","show-to-coin-lock","position-total-amount","tick-lower","tick-upper","onToAdd"])):me("",!0)])}const Io=Ye(qi,[["render",Xi]]),Gi=Je({components:{AssetsCard:ho},setup(e,t){const s=j(""),a=j(""),B=ze(),h=C(()=>B),q=C(()=>h.value.theme),m=oo(),o=C(()=>m),l=j(!1),v=j(!1),d=j(!0),k=C(()=>h.value.chainName),X=C(()=>k.value?eo(k.value):{}),se=ao(),oe=C(()=>se),te=C(()=>h.value.slippage),r=j(),f=j(),$=C(()=>{var _,Q;return(Q=(_=u.value)==null?void 0:_.poolInfo)==null?void 0:Q.needReverse}),i=C(()=>{var _;return console.log(u==null?void 0:u.value,"==>positionInfo?.value"),console.log(!$.value,"===>!needReverse.value"),ke(u==null?void 0:u.value.amountA,(_=u==null?void 0:u.value.token_a)==null?void 0:_.decimals)}),g=C(()=>{var _;return ke(u==null?void 0:u.value.amountB,(_=u==null?void 0:u.value.token_b)==null?void 0:_.decimals)}),y=_=>{_==="fromCoin"?d.value=!0:d.value=!1,L.value=100,ie({value:1})},w=_=>{_==="fromCoin"?(d.value=!0,s.value=Me(new b(Number(i.value)).div(2).toString(),r.value.decimals).toString()):(d.value=!1,a.value=Me(new b(Number(g.value)).div(2).toString(),f.value.decimals).toString()),S.value=!1},u=j({}),ne=j(!0),J=j({}),le=j(),E=j(),S=j(!0),R=()=>{var He;if(S.value||!u.value||!s.value&&!a.value||(console.log(s.value>i.value,Number(a.value)>Number(g.value),"==>toCoinAmount.value"),Number(s.value)>Number(i.value)||Number(a.value)>Number(g.value)))return;if(s.value==i.value&&a.value==g.value){L.value=100,ie({value:1}),S.value=!0;return}const{TickMath:_,TickUtil:Q}=X.value;console.log(s.value,a.value,"====>369"),console.log(u.value,"===>positionInfo.value339");let T=u.value.minPrice,ae=u.value.maxPrice.indexOf("+")>0?"∞":u.value.maxPrice;console.log(u.value,"positionInfo.value====>");let he=Number(u.value.tick_lower_index),$e=Number(u.value.tick_upper_index);const Re=Number(u.value.current_tick_index);let Ae,Pe,Ue=Number(T).toString(),je=u.value.maxPrice.indexOf("+")>0||u.value.maxPrice==="∞"?"∞":Number(ae);if(Ue=="0"&&je=="∞"?(he=Number(u.value.tick_lower_index),$e=Number(u.value.tick_upper_index)):(Ae=_.priceToSqrtPriceX64(new b(T),r.value.decimals,f.value.decimals),Pe=_.priceToSqrtPriceX64(new b(ae),r.value.decimals,f.value.decimals)),le.value=he,E.value=$e,console.log(he,$e,"tick_lowertick_lower"),ae!=="∞"&&he>=$e){l.value=!0,s.value="",v.value=!0,a.value="";return}if(ae=="∞"||Re>=he&&Re<=$e){console.log("0413###increase###11111"),console.log(s.value,"==>341"),console.log(a.value,"==>341"),l.value=!1,v.value=!1;let Oe;if(s.value||a.value){if(d.value){const Qe=new b(s.value).mul(Math.pow(10,r.value.decimals)).toString();Oe=new qe(Qe)}else{const Qe=new b(a.value).mul(Math.pow(10,f.value.decimals)).toString();Oe=new qe(Qe)}const{liquidityAmount:De,tokenMaxA:Ce,tokenMaxB:Xe,tokenMaxAOrigin:uo,tokenMaxBOrigin:Se}=X.value.estLiquidityAndcoinAmountFromOneAmounts({tokenA:r.value,tokenB:f.value,lowerTick:he,upperTick:$e,coinAmount:Oe,iscoinA:ne.value?d.value:!d.value,roundUp:k.value!="Sui",slippage:Number(te.value)/100,curSqrtPrice:new qe(u.value.current_sqrt_price)});J.value={liquidityAmount:De,tokenMaxA:Ce,tokenMaxB:Xe,tokenMaxAOrigin:uo,tokenMaxBOrigin:Se},console.log(Xe,Ce,"362===>"),ne.value?d.value?a.value=Number(Xe)>0?Xe:"":s.value=Number(Ce)>0?Ce:"":d.value?a.value=Ce:s.value=Xe}}else if(Re>$e){if(console.log("0413###increase###22222"),s.value="",l.value=!0,v.value=!1,s.value||a.value){let Oe;const De=new b(a.value).mul(Math.pow(10,(He=f.value)==null?void 0:He.decimals)).toString();Oe=new qe(De),J.value={liquidityAmount:Lo(Ae,Pe,Oe),tokenMaxA:0,tokenMaxB:a.value}}}else if(Re<he){if(console.log("0413###increase###33333"),l.value=!1,v.value=!0,a.value="",s.value||a.value){let Oe;const De=new b(s.value).mul(Math.pow(10,r.value.decimals)).toString();Oe=new qe(De),J.value={liquidityAmount:Bo(Ae,Pe,Oe),tokenMaxA:s.value,tokenMaxB:0}}}else console.log("0413###increase###4444"),l.value=!0,v.value=!0;S.value=!1,L.value=new b(J.value.liquidityAmount.toString()).div(u.value.liquidity).mul(100).toNumber().toFixed(2),D.value=J.value.liquidityAmount,console.log(L.value,"===>sliderVal.value"),console.log(J.value.liquidityAmount,"====>liquidityInput.value.liquidityAmount"),m.setPositionActionAmount({fromCoinAmount:s,toCoinAmount:a}),console.log(L.value,"===>sliderVal.value")},L=j(50),D=j("0"),ie=_=>{if(!S.value)return;S.value=!0;const Q=u.value.token_a.decimals,T=u.value.token_b.decimals,ae=u.value.tick_lower_index,he=u.value.tick_upper_index,$e=$o.tickIndexToSqrtPriceX64(ae),Re=$o.tickIndexToSqrtPriceX64(he);let Ae="";_.value!==1?Ae=new b(u.value.liquidity).mul(_.value).toString():Ae=u.value.liquidity,Ae=Me(Ae,0)||"0",D.value=Ae;const Pe=Ko.getCoinAmountFromLiquidity(new qe(Ae),new qe(u.value.current_sqrt_price),$e,Re,k.value!="Sui");console.log(Pe.coinA.toString(),Pe.coinB.toString(),Q,T,"===>amountInfo");const Ue=new b(Pe.coinA.toString()).div(Math.pow(10,Q)).toString(),je=new b(Pe.coinB.toString()).div(Math.pow(10,T)).toString();console.log(Ue,je,"amountA121212"),s.value=Number(Ue)>0?Ue:"",a.value=Number(je)>0?je:"",m.setPositionActionAmount({fromCoinAmount:s,toCoinAmount:a})};ye(()=>o.value.currentPositionInfo,_=>{if(_&&!ve(_)){u.value=_,console.log(_,"newVal===>"),r.value=u.value.token_a,f.value=u.value.token_b,ie({value:L.value/100});let Q=Number(u.value.tick_lower_index),T=Number(u.value.tick_upper_index);const ae=Number(u.value.current_tick_index);(_.maxPrice.indexOf("+")>0||_.maxPrice==="∞"?"∞":_.maxPrice)=="∞"||ae>=Q&&ae<=T?(l.value=!1,v.value=!1):ae>T?(s.value="",l.value=!0,v.value=!1):ae<Q?(l.value=!1,v.value=!0,a.value=""):(l.value=!0,s.value="",v.value=!0,a.value=""),R()}},{immediate:!0}),ye(s,(_,Q)=>{_&&R(),_==""&&(a.value="",L.value=0)}),ye(a,(_,Q)=>{_&&R(),_==""&&(s.value="",L.value=0)});const x=C(()=>o.value.RATES),ee=C(()=>{var $e,Re,Ae,Pe;const _=((Re=x.value[($e=r.value)==null?void 0:$e.address])==null?void 0:Re.price)||0,Q=((Pe=x.value[(Ae=f.value)==null?void 0:Ae.address])==null?void 0:Pe.price)||0,T=new b(_).mul(new b(s.value||0)),ae=new b(Q).mul(new b(a.value||0)),he=T.add(ae);return console.log(_,Q,T.toString(),ae.toString(),"====>amount"),V(he.toString(),2)}),K=j(!1),{t:pe,locale:F}=Co(),ge=C(()=>{const _=Number(s.value)>Number(i.value),Q=Number(a.value)>Number(g.value);return!s.value&&!a.value?pe("button.enterAmount"):_||Q?"Invalid Amount":pe("button.remove")}),_e=C(()=>{const _=Number(s.value)>Number(i.value),Q=Number(a.value)>Number(g.value);return!!(!s.value&&!a.value||_||Q)}),{setIsShowSuccess:Fe,setIsShowRejected:c,setIsShowWaiting:p,setTransactionDesc:P,setTransactionTxid:A,setPositiomNum:H,setTransactionDescText:G}=B,M=j(!1);ye(L,sn((_,Q)=>{_!==Q&&(Number(_)>100?L.value=100:_&&u.value?(console.log("687===>"),L.value=_,ie({value:L.value/100})):(s.value="",a.value=""))},300)),ye(te,_=>{_&&u.value&&ie({value:L.value/100})});const z=[{name:"25%",value:25},{name:"50%",value:50},{name:"75%",value:75},{name:"MAX",value:100}],Y=Do(),re=C(()=>Y),ce=C(()=>re.value.status),be=j(!1),Ie=_=>{const Q=_.sources;Q.forEach(T=>{const{pool_address:ae,position_index:he}=JSON.parse(T.blockchainAddress);console.log(ae,he,"===>pool_address, position_index"),console.log(u.value.poolAddress,u.value.index,"===>positionInfo.value.index"),ae==u.value.poolAddress&&Number(he)==Number(u.value.index)&&(be.value=!0)}),console.log(Q,"===>sources")},O=async()=>{await Y.getSources();let _;re.value.allSources.forEach(Q=>{const{pool_address:T,position_index:ae}=JSON.parse(Q.blockchainAddress);T==u.value.poolAddress&&ae==u.value.index&&(_=Q.id)}),console.log(_,"sourceID649==>"),Y.deleteSource(_)};ye(()=>[re.value.sourceGroups,u.value],([_,Q])=>{_&&_.sources&&_.sources.length>0&&Q&&!ve(Q)&&Ie(_)},{immediate:!0,deep:!0});const U=lo(),ue=po();return{theme:q,showFromCoinLock:l,showToCoinLock:v,toCoinAmount:a,fromCoinAmount:s,fromCoinBlance:i,toCoinBlance:g,fromCoin:r,toCoin:f,maxBtnSelect:y,halfBtnSelect:w,fixedFromCoin:d,needReverse:$,totalAmount:ee,wallet:oe,addLiquidityBtnText:ge,isShowLiquidityModal:K,indexStore:B,positionInfo:u,actionLoading:M,addLiquidityBtnDisabled:_e,sliderVal:L,ratioArr:z,setPercent:ie,poolStore:m,isSlider:S,toRemove:async()=>{var he,$e,Re,Ae,Pe,Ue,je,He,Oe,De,Ce,Xe,uo;M.value=!0,A("");const _=V(s.value,r.value.decimals)==0?"":`${ke(s.value,r.value.decimals)} ${r.value.symbol}`,Q=V(a.value,f.value.decimals)==0?"":`${ke(a.value,f.value.decimals)} ${f.value.symbol}`;P(pe("tips.removeLiquidiyText",{from:$.value?Q:_,and:V(s.value,r.value.decimals)==0||V(a.value,f.value.decimals)==0?"":"and",to:$.value?_:Q})),p(!0),console.log(u.value,"==>positionInfo.value");const T=u.value.poolInfo.rewarder_infos,ae=T&&T.length>0&&k.value=="Sui"||T&&T.length>0&&L.value==100?pe("modal.removeLiquidityText1"):pe("modal.removeLiquidityText2");G(ae);try{let Se={};Se={pool:{...u.value.poolInfo,coinA:u.value.token_a,coinB:u.value.token_b},coinTypeA:u.value.poolInfo.coinTypeA,coinTypeB:u.value.poolInfo.coinTypeB,position:u.value,delta_liquidity:L.value==100?new qe(u.value.liquidity):new qe(Me(D.value,0)),slippage:Number(te.value),rewards_num:T.length,positionInfo:u.value},console.log(T,"===>pendingRewarderArr"),Se.coinTypeC=T[0]?T[0].coinAddress:"",Se.coinTypeD=T[1]?T[1].coinAddress:"",Se.coinTypeE=T[2]?T[2].coinAddress:"",console.log(Se,L.value,Se.delta_liquidity.toString(),"===>params");const Qe=await X.value.getRemoveLiquidityTransactionPayload(Se);console.log(Qe,"===>payload");let Ee;if(k.value==="Aptos")Ee=await oe.value.currentWallet.signAndSubmitTransaction(Qe);else{const no=await oe.value.currentWallet.signAndExecuteTransactionBlock(Qe);Ee=X.value.handleTx(no),console.log("0331###remove###tx####",Ee)}if(Ee&&Ee.hash){A(Ee.hash),p(!1),Fe(!0);const no={title:pe("common.removeLiquidity"),desc:"",hash:Ee.hash,descTransactions:`Remove ${s.value} ${(he=r.value)==null?void 0:he.symbol} and ${a.value} ${($e=f.value)==null?void 0:$e.symbol} 
             from the pool`,sender:oe.value.address,chainName:k.value,tit:"Liquidity Removed",icon:"icon-icon-Removed",tokenInfo:{tokena:$.value?`${(Ae=f.value)==null?void 0:Ae.address}`:`${(Re=r.value)==null?void 0:Re.address}`,numa:$.value?`+ ${a.value}`:`+ ${s.value}`,logoa:$.value?o.value.tokensObj&&f.value&&f.value.address&&o.value.tokensObj[f.value.address]&&o.value.tokensObj[f.value.address].logoURI:o.value.tokensObj&&r.value&&r.value.address&&o.value.tokensObj[r.value.address]&&o.value.tokensObj[r.value.address].logoURI,tokenb:$.value?`${(Pe=r.value)==null?void 0:Pe.address}`:`${(Ue=f.value)==null?void 0:Ue.address}`,numb:$.value?`+ ${s.value}`:`+ ${a.value}`,logob:$.value?o.value.tokensObj&&r.value&&r.value.address&&o.value.tokensObj[r.value.address]&&o.value.tokensObj[r.value.address].logoURI:o.value.tokensObj&&f.value&&f.value.address&&o.value.tokensObj[f.value.address]&&o.value.tokensObj[f.value.address].logoURI},text:`Withdraw ${s.value} ${(je=r.value)==null?void 0:je.symbol} and ${a.value} ${(He=f.value)==null?void 0:He.symbol}`};k.value!=="Aptos"&&(no.res=Ee.res),X.value.showTransitionPending(no);const co=await X.value.watchTransaction(no);if(T.value&&T.value.length>0&&(Number((Oe=T[0])==null?void 0:Oe.amount)!==0||Se.coinTypeD&&Number((De=T[1])==null?void 0:De.amount)!==0||Se.coinTypeE&&Number((Ce=T[2])==null?void 0:Ce.amount)!==0)){const go={title:pe("common.removeLiquidity"),desc:"",hash:Ee.hash,tit:"Rewards Claimed",icon:"icon-icon-Removed",tokenInfo:{tokena:T[0].symbol,numa:`+ ${Number(T[0].amount)}`,logoa:o.value.tokensObj&&T[0]&&T[0].address&&o.value.tokensObj[T[0].address]&&o.value.tokensObj[T[0].address].logoURI,tokenb:Se.coinTypeD?T[1].symbol:"",numb:Se.coinTypeD?`+ ${Number(T[1].amount)}`:"",logob:Se.coinTypeD?o.value.tokensObj&&T[1]&&T[1].address&&o.value.tokensObj[T[1].address]&&o.value.tokensObj[T[1].address].logoURI:"",tokenc:Se.coinTypeE?T[2].symbol:"",numc:Se.coinTypeE?`+ ${Number(T[2].amount)}`:"",logoc:Se.coinTypeE?o.value.tokensObj&&T[2]&&T[2].address&&o.value.tokensObj[T[2].address]&&o.value.tokensObj[T[2].address].logoURI:""},text:`Withdraw ${s.value} ${(Xe=r.value)==null?void 0:Xe.symbol} and ${a.value} ${(uo=f.value)==null?void 0:uo.symbol}`},ko=await X.value.setTransations(go);console.log("9999transitionStatusFees",co,ko)}if(Te(u.value.feeOwedA,u.value.token_a.decimals)!==0||Te(u.value.feeOwedB,u.value.token_b.decimals)!==0){const go={title:"Claim",desc:"",hash:Ee.hash,chainName:k.value,tit:"Fees Claimed",icon:"icon-icon-Removed",tokenInfo:{tokena:`${u.value.token_a.symbol}`,numa:V(u.value.feeOwedA,u.value.token_a.decimals)==0?"":`+ ${Te(u.value.feeOwedA,u.value.token_a.decimals)}`,logoa:V(u.value.feeOwedA,u.value.token_a.decimals)==0?"":o.value.tokensObj&&u.value&&u.value.token_a.address&&o.value.tokensObj[u.value.token_a.address]&&o.value.tokensObj[u.value.token_a.address].logoURI,tokenb:`${u.value.token_b.symbol}`,numb:V(u.value.feeOwedB,u.value.token_b.decimals)==0?"":`+ ${Te(u.value.feeOwedB,u.value.token_b.decimals)}`,logob:V(u.value.feeOwedB,u.value.token_b.decimals)==0?"":o.value.tokensObj&&u.value&&u.value.token_b.address&&o.value.tokensObj[u.value.token_b.address]&&o.value.tokensObj[u.value.token_b.address].logoURI}},ko=await X.value.setTransations(go);console.log("9999transitionStatusFees",co,ko)}co&&Number(L.value)==100&&ce.value=="authenticated"&&be.value&&(await Y.subscribePosition({pool_address:u.value.poolAddress,position_index:u.value.index},u.value.nftHash,!1),O()),co&&(s.value="",a.value="",setTimeout(()=>{t.emit("getDetails")},3e3),setTimeout(()=>{t.emit("getDetails")},6e3),console.log(L.value,ue.name,k.value,"998===>"),Number(L.value)==100&&ue.name=="new-position-detail"&&(k.value==="Aptos"?U.push("/position"):U.push("/pool/position")),L.value=0)}else p(!1),c(!0);M.value=!1}catch(Se){console.log("Remove error",Se),M.value=!1,p(!1),c(!0)}},sFixD:Me}}});const zi={class:"new-position-asset"},Ji={class:"add-or-remove"},Yi={class:"liquidity-action-tab"},Qi=n("div",{class:"remove tab-active"},"Remove",-1),Zi={class:"card-item"},Ki={key:0,class:"assets-card-mask"},Vi={class:"card-item"},xi={key:0,class:"assets-card-mask"},es={class:"remove-ratio"},os=n("div",{class:"remove-ratio-title"},"Amount",-1),ns={class:"remove-ratio-select"},ts={key:0,class:"ratio"},is={key:1,class:"ratio"},ss={class:"ratio-list"},as=["onClick"];function ls(e,t,s,a,B,h){const q=ho,m=an,o=ro;return I(),N("div",zi,[n("div",Ji,[n("div",Yi,[n("div",{class:"increase",onClick:t[0]||(t[0]=l=>e.poolStore.setPositionDetailCurrentTab("increase"))}," Increase "),Qi]),n("div",{class:wo(e.needReverse?"card-container reverse":"card-container")},[n("div",Zi,[de(q,{modelValue:e.fromCoinAmount,"onUpdate:modelValue":t[1]||(t[1]=l=>e.fromCoinAmount=l),"input-value":e.fromCoinAmount,"coin-symbol":e.fromCoin?e.fromCoin.symbol:null,"coin-name":e.fromCoin?e.fromCoin.name:null,balance:e.fromCoinBlance,"coin-icon":e.fromCoin?e.fromCoin.logoURI:"",address:e.fromCoin?e.fromCoin.address:"","swap-direct":"From","import-page":"deposit","has-arrow":!1,havehalf:!1,"amount-leabl":"Available",onOnMax:t[2]||(t[2]=l=>e.maxBtnSelect("fromCoin")),onOnHalf:t[3]||(t[3]=l=>e.halfBtnSelect("fromCoin")),onOnInput:t[4]||(t[4]=l=>{e.fromCoinAmount=l,e.fixedFromCoin=!0,e.isSlider=!1})},null,8,["modelValue","input-value","coin-symbol","coin-name","balance","coin-icon","address"]),e.fromCoinBlance==0?(I(),N("div",Ki)):me("",!0)]),n("div",Vi,[de(q,{modelValue:e.toCoinAmount,"onUpdate:modelValue":t[5]||(t[5]=l=>e.toCoinAmount=l),"input-value":e.toCoinAmount,"coin-symbol":e.toCoin?e.toCoin.symbol:null,"coin-name":e.toCoin?e.toCoin.name:null,balance:e.toCoinBlance,"swap-direct":"To","coin-icon":e.toCoin?e.toCoin.logoURI:"",address:e.toCoin?e.toCoin.address:"","import-page":"deposit","has-arrow":!1,havehalf:!1,"amount-leabl":"Available",onOnMax:t[6]||(t[6]=l=>e.maxBtnSelect("toCoin")),onOnHalf:t[7]||(t[7]=l=>e.halfBtnSelect("toCoin")),onOnInput:t[8]||(t[8]=l=>{e.toCoinAmount=l,e.fixedFromCoin=!1,e.isSlider=!1})},null,8,["modelValue","input-value","coin-symbol","coin-name","balance","coin-icon","address"]),e.toCoinBlance==0?(I(),N("div",xi)):me("",!0)])],2),n("div",es,[os,n("div",ns,[Number(e.fromCoinBlance)>=Number(e.fromCoinAmount)&&Number(e.toCoinBlance)>=Number(e.toCoinAmount)?(I(),N("div",ts,W(e.sliderVal>0&&Number(("sFixD"in e?e.sFixD:Z(Me))(e.sliderVal,2))<.01?"<0.01":("sFixD"in e?e.sFixD:Z(Me))(e.sliderVal,2))+"% ",1)):(I(),N("div",is," -- ")),n("div",ss,[(I(!0),N(io,null,so(e.ratioArr,(l,v)=>(I(),N("div",{key:v,class:wo(["ratio-item",e.sliderVal==l.value?"ratio-item-active":""]),onClick:()=>{e.isSlider=!0,e.sliderVal=l.value}},W(l.name),11,as))),128))])]),de(m,{value:e.sliderVal,"onUpdate:value":t[9]||(t[9]=l=>e.sliderVal=l)},null,8,["value"])])]),e.wallet.connected?(I(),Le(o,{key:0,class:"big-btn liquidity-btn",loading:e.actionLoading,disabled:e.addLiquidityBtnDisabled,onClick:e.toRemove},{default:Be(()=>[n("span",null,W(e.addLiquidityBtnText),1)]),_:1},8,["loading","disabled","onClick"])):(I(),Le(o,{key:1,class:"big-btn",onClick:t[10]||(t[10]=l=>e.wallet.connected?e.isShowLiquidityModal=!0:e.wallet.setIsShowWalletModal(!0))},{default:Be(()=>[n("span",null,W(e.$t("button.connectWallet")),1)]),_:1}))])}const rs=Ye(Gi,[["render",ls]]),us=Je({setup(){const e=oo(),t=C(()=>e),s=Eo(),a=C(()=>s),B=lo(),h=C(()=>t.value.currentPositionInfo),q=j(),m=E=>{var S;return((S=t.value.tokensObj[E])==null?void 0:S.logo_url)||xe("/image/coins/sui-unknown.png")},o=Vo("Sui"),l=j(),v=async E=>{l.value=0;try{const S=await o.calculateFarmingRewards([{pool_id:E.pool_id,position_nft_id:E.id}]),R=[];let L=new b(0);S[E.id].forEach((D,ie)=>{var pe;const x=(pe=t.value.tokensObj[D.rewarder_type])==null?void 0:pe.decimals;let ee=new b(D.rewarder_amount).div(Math.pow(10,x)).toString();const K=k.value.rewarders[ie].allocate_point;Number(ee)>0&&K>0&&(L=L.add(ee),R.push({...D,rewarderAmount:ee,rewarderAmountPer:ee}))}),l.value=L,q.value=R,console.log("getRewarder",E,R)}catch(S){console.log(S,"getRewarder")}},d=C(()=>a.value.farmsPoolObj),k=C(()=>d.value[h.value.poolAddress]);ye(()=>[h.value,d.value,k.value],([E,S,R])=>{var L;!ve(E)&&E.positionSource=="farming"&&!ve(R)?v(E):!ve(S)&&!ve(E)&&(console.log(S,"##farmsPoolObj"),q.value=(L=S[E.poolAddress])==null?void 0:L.rewarders)},{immediate:!0});const X=ao(),se=C(()=>X),oe=ze(),te=eo("Sui"),{setIsShowSuccess:r,setIsShowRejected:f,setIsShowWaiting:$,setTransactionDesc:i,setTransactionTxid:g}=oe,y=j(!1),w=async()=>{y.value=!0,g(""),i("Claim rewards"),$(!0);const E={pool_id:h.value.pool_id,position_nft_id:h.value.id};try{const S=await o.harvestFarms(E),R=await se.value.currentWallet.signAndExecuteTransactionBlock(S);console.log("0221###sui swap res###",R);let L=te.handleTx(R);if(L&&L.hash){g(L.hash),$(!1),r(!0);let D={title:"Claim",res:L.res,hash:L.hash};te.showTransitionPending(D),await te.watchTransaction(D)&&setTimeout(()=>{v(h.value)},2e3)}else $(!1),f(!0);y.value=!1}catch(S){console.log("farmsDeposit error",S),$(!1),f(!0),y.value=!1}},u=async()=>{y.value=!0,g(""),i(`Unstake ${h.value.name}`),$(!0);const E=h.value.pool_id,S=h.value.id;try{const R=await o.farmsWithdraw(E,S),L=await se.value.currentWallet.signAndExecuteTransactionBlock(R);console.log("0221###sui swap res###",L);let D=te.handleTx(L);if(console.log(D,"unStaketx##"),D&&D.hash){g(D.hash),$(!1),r(!0);let ie={res:D.res,title:"Unstake",hash:D.hash};te.showTransitionPending(ie),await te.watchTransaction(ie)&&setTimeout(()=>{console.log("unstake success"),B.replace(`/new-position-detail?name=${h.value.tokenName}address=${h.value.clmm_pool_id}&pos=${h.value.clmm_position_id}`),t.value.setCurrentPositionInfo(h.value.clmm_pool_id,"",h.value.tokenName,"Sui",h.value.clmm_position_id),l.value=0},2e3)}else $(!1),f(!0);y.value=!1}catch(R){console.log("farmsDeposit error",R),$(!1),f(!0),y.value=!1}},ne=async()=>{console.log(h.value,"currentPositionInfo.value"),y.value=!0,g(""),i(`Stake ${h.value.name}`),$(!0);const E={clmm_pool_id:h.value.poolAddress,clmm_position_id:h.value.pos_object_id,coinTypeA:h.value.coin_type_a,coinTypeB:h.value.coin_type_b},S=d.value[h.value.poolAddress].id;try{const R=await o.farmsDeposit(E,S),L=await se.value.currentWallet.signAndExecuteTransactionBlock(R);console.log("0221###sui swap res###",L);let D=te.handleTx(L);if(D&&D.hash){g(D.hash),$(!1),r(!0);let ie={res:D.res,title:"Staked",hash:D.hash};te.showTransitionPending(ie);const x=await te.watchTransaction(ie);let ee;console.log(D,"tx###"),x&&setTimeout(async()=>{D.res.events.forEach(K=>{K.type.indexOf("::pool::DepositEvent")>-1&&(ee=K.parsedJson.wrapped_position_id)}),B.replace(`/new-position-detail?position_nft_id=${ee}&positionSource=farming`),console.log(ee,"###farmPositionId"),await t.value.setCurrentPositionInfo("","","","Sui",ee,"farming"),y.value=!1},2e3)}else $(!1),f(!0)}catch(R){console.log("farmsDeposit error",R),$(!1),f(!0),y.value=!1}},J=C(()=>oe),le=C(()=>J.value.addressLpTokens);return{getCoinIcon:m,rewardList:q,sFixD:Me,addCommom:V,claim:w,unStake:u,loading:y,totalRewardAmount:l,currentPositionInfo:h,stake:ne,farmsPoolObj:d,addressLpTokens:le,farmsPoolInfo:k}}});const Ke=e=>(vo("data-v-f42bff97"),e=e(),fo(),e),ds={key:0,class:"farms-position-detail"},cs={class:"farms-top"},ms=Ke(()=>n("div",{class:"left"},[n("div",{class:"title"},"Farming"),n("div",{class:"desc"},"Stake Position to Earn")],-1)),vs={class:"right"},fs={class:"apr"},ps={class:"apr-tips-box"},hs=Ke(()=>n("span",null,"View",-1)),gs=Ke(()=>n("svg",{class:"arrow-icon","aria-hidden":"true"},[n("use",{"xlink:href":"#icon-icon_arrow"})],-1)),ks=[hs,gs],bs={class:"farms-bottom"},ws=Ke(()=>n("div",{class:"title"},"Earnings",-1)),_s={key:0,class:"reward-list"},ys={key:0,class:"rewards-item-bg"},Is={class:"rewards-item-box"},As={alt:""},Cs={key:1},Ss={class:"rewards-item-bg"},$s={class:"rewards-item-box"},Ps={alt:""},Ts=Ke(()=>n("span",null,"0",-1)),Ns={key:1,class:"reward-list"},Rs={key:0,class:"rewards-item-bg"},Os={class:"rewards-item-box"},qs={alt:""},Ls=Ke(()=>n("span",null,"0",-1)),Bs={key:1},Ms={class:"rewards-item-bg"},Us={class:"rewards-item-box"},js={alt:""},Ds=Ke(()=>n("span",null,"0",-1)),Es={class:"actions-box"};function Fs(e,t,s,a,B,h){const q=fn,m=ro,o=ln,l=Ao("image");return e.farmsPoolObj&&e.farmsPoolObj[e.currentPositionInfo.poolAddress]&&e.farmsPoolObj[e.currentPositionInfo.poolAddress].status=="Live"||e.currentPositionInfo.positionSource=="farming"?(I(),N("div",ds,[n("div",cs,[ms,n("div",vs,[n("div",fs,[fe(" APR "),n("span",null,[fe(W(("addCommom"in e?e.addCommom:Z(V))(e.farmsPoolInfo.total_apr*100,2))+"% ",1),n("div",ps,[de(q,{"l-item":e.farmsPoolInfo,"rewarder-info":e.farmsPoolInfo.rewarder.rewardList},null,8,["l-item","rewarder-info"])])])]),n("div",{class:"view",onClick:t[0]||(t[0]=v=>e.$router.push("/farms"))},ks)])]),n("div",bs,[ws,e.rewardList&&e.rewardList.length>0?(I(),N("div",_s,[(I(!0),N(io,null,so(e.rewardList,v=>(I(),N("div",{key:v,class:"rewards-item"},[e.currentPositionInfo.positionSource=="farming"?(I(),N("div",ys,[n("div",Is,[Ne(n("img",As,null,512),[[l,e.getCoinIcon(v.rewarder_type)]]),n("span",null,W(v.rewarderAmountPer>0&&v.rewarderAmountPer<.01?"<0.01":("addCommom"in e?e.addCommom:Z(V))(("sFixD"in e?e.sFixD:Z(Me))(v.rewarderAmount||0,4))),1)])])):(I(),N("div",Cs,[n("div",Ss,[n("div",$s,[Ne(n("img",Ps,null,512),[[l,e.getCoinIcon(v.reward_coin)]]),Ts])])]))]))),128))])):(I(),N("div",Ns,[(I(!0),N(io,null,so(e.currentPositionInfo.rewards,v=>(I(),N("div",{key:v,class:"rewards-item"},[e.currentPositionInfo.positionSource=="farming"?(I(),N("div",Rs,[n("div",Os,[Ne(n("img",qs,null,512),[[l,e.getCoinIcon(v.rewarder_type)]]),Ls])])):(I(),N("div",Bs,[n("div",Ms,[n("div",Us,[Ne(n("img",js,null,512),[[l,e.getCoinIcon(v.reward_coin)]]),Ds])])]))]))),128))])),n("div",Es,[e.currentPositionInfo&&e.currentPositionInfo.positionSource=="farming"?(I(),Le(m,{key:0,class:"unstake-btn",loading:e.loading,onClick:e.unStake},{default:Be(()=>[fe("Unstake")]),_:1},8,["loading","onClick"])):me("",!0),e.currentPositionInfo&&e.currentPositionInfo.positionSource=="clmm"&&e.currentPositionInfo.currentStatus!=="Active"?(I(),Le(o,{key:1},{title:Be(()=>[fe("Farming rewards are only available for active positions.")]),default:Be(()=>[de(m,{class:"unstake-btn",loading:e.loading,disabled:!0,onClick:e.stake},{default:Be(()=>[fe("Stake")]),_:1},8,["loading","onClick"])]),_:1})):e.currentPositionInfo&&e.currentPositionInfo.positionSource=="clmm"?(I(),Le(m,{key:2,class:"unstake-btn",loading:e.loading,onClick:e.stake},{default:Be(()=>[fe("Stake")]),_:1},8,["loading","onClick"])):me("",!0),de(m,{class:"unstake-btn btn-margin",loading:e.loading,disabled:e.totalRewardAmount==0||e.currentPositionInfo&&e.currentPositionInfo.positionSource!=="farming",onClick:jo(e.claim,["stop"])},{default:Be(()=>[fe("↑ Claim")]),_:1},8,["loading","disabled","onClick"])])])])):me("",!0)}const Jo=Ye(us,[["render",Fs],["__scopeId","data-v-f42bff97"]]),Ws=Je({props:{positionInfo:{type:Object,default:()=>({})}},setup(e){const t=Do(),s=C(()=>t),a=C(()=>s.value.status),B=ze();ye(()=>[s.value.targetGroups],v=>{console.log("0327###watch###newTargetGoups###",v)},{immediate:!0});const h=j(!1);ye(()=>a.value,v=>{v=="authenticated",h.value=!1},{immediate:!0});const q=j(!1),m=async()=>{q.value=!q.value,console.log(q.value,"===>checked.value"),console.log(e.positionInfo,"##props.positionInfo");const v={pool_address:e.positionInfo.poolAddress||e.positionInfo.clmm_pool_id,position_index:e.positionInfo.index||e.positionInfo.name.split("-")[1]},d=e.positionInfo.clmm_position_id||e.positionInfo.nftHash;console.log("0529###changeSwitch###positionInfo####",e.positionInfo);try{await t.subscribePosition(v,d,q.value)}catch{q.value=!q.value}},o=v=>{const d=v.sources;console.log(e.positionInfo,d,"getPositionNotifiStatus##"),q.value=d.some(k=>JSON.parse(k.blockchainAddress).pool_address==e.positionInfo.poolAddress&&Number(JSON.parse(k.blockchainAddress).position_index)==(Number(e.positionInfo.index)||Number(e.positionInfo.name.split("-")[1])))},l=lo();return console.log(l.currentRoute.value.query.token,"===>rouyter"),ye(()=>[s.value.sourceGroups,e.positionInfo],([v,d])=>{var k,X,se,oe,te,r;console.log(v,"==>newSourceGroups169"),console.log(d,"===>positionInfo170"),q.value=!1,v&&v.length>0&&v[0]&&d&&!ve(d)&&(((se=(X=(k=l==null?void 0:l.currentRoute)==null?void 0:k.value)==null?void 0:X.query)==null?void 0:se.token)==(d==null?void 0:d.name)||((r=(te=(oe=l==null?void 0:l.currentRoute)==null?void 0:oe.value)==null?void 0:te.query)==null?void 0:r.positionSource)=="farming")&&(console.log("触发"),console.log(v,"==>newSourceGroups"),console.log(d,"===>positionInfo"),o(v[0]))},{immediate:!0,deep:!0}),{importIcon:xe,isShowSetUp:h,changeSwitch:m,checked:q,notifiStatus:a,store:B}}});const Hs=e=>(vo("data-v-7878455d"),e=e(),fo(),e),Xs={class:"range-alerts"},Gs={class:"range-alerts-top"},zs={class:"title"},Js=Hs(()=>n("div",{class:"title-all"},[n("span",{class:"Range"},"Range Alerts")],-1)),Ys={key:1,class:"h5-switch-box"},Qs={class:"range-alerts-bottom"},Zs={key:0,class:"pc-switch-box"};function Ks(e,t,s,a,B,h){const q=ro,m=rn;return I(),N("div",Xs,[n("div",Gs,[n("div",zs,[Js,e.isShowSetUp||e.notifiStatus!=="authenticated"?(I(),Le(q,{key:0,class:"range-alerts-button",onClick:t[0]||(t[0]=jo(o=>e.store.setIsShowNotifi(!0),["stop"]))},{default:Be(()=>[fe(" Set up ")]),_:1})):me("",!0),!e.isShowSetUp&&e.notifiStatus=="authenticated"?(I(),N("div",Ys,[de(m,{class:"range-alerts-switch",checked:e.checked,disabled:e.notifiStatus!=="authenticated",onChange:e.changeSwitch},null,8,["checked","disabled","onChange"])])):me("",!0)])]),n("div",Qs,[fe(" Receive alerts via Telegram, SMS, or email when this position goes out of range. "),!e.isShowSetUp&&e.notifiStatus=="authenticated"?(I(),N("div",Zs,[de(m,{class:"range-alerts-switch",checked:e.checked,disabled:e.notifiStatus!=="authenticated",onChange:e.changeSwitch},null,8,["checked","disabled","onChange"])])):me("",!0)])])}const Yo=Ye(Ws,[["render",Ks],["__scopeId","data-v-7878455d"]]),Vs=Je({components:{NewPositionTitle:Oo,NewPositionInfo:Go,NewPositionLiquidity:zo,NewPositionAssetAdd:Io,NewPositionAssetRemove:Io,NewPositionNotifi:Yo,FarmsPositionDetail:Jo},setup(){const e=j(),t=j(),s=j(),a=ze(),B=C(()=>a),h=C(()=>B.value.chainName),q=oo(),m=C(()=>q),o=Eo(),l=lo();Mo(()=>{e.value={},q.setPositionActionAmount({fromCoinAmount:"",toCoinAmount:""}),m.value.setCurrentPositionLoading(!0),o.getFarmsPoolList()});const v=async()=>{m.value.setCurrentPositionLoading(!0);const r=l.currentRoute.value.query.token||"",f=l.currentRoute.value.query.collect||"",$=l.currentRoute.value.query.address||"",i=l.currentRoute.value.query.pos||"",g=l.currentRoute.value.query.id||"",y=l.currentRoute.value.query.positionSource||"",w=l.currentRoute.value.query.position_nft_id||"";h.value==="Aptos"?r&&f&&$&&m.value.setCurrentPositionInfo($,f,r,h.value):(console.log("0414###position-detail###id#####",g),console.log("0414###position-detail###name#####",r),console.log("0414###position-detail###pool_address#####",$),console.log("0414###position-detail###pos#####",i),r&&$&&i?m.value.setCurrentPositionInfo($,f,r,h.value,i):g&&!y?m.value.setCurrentPositionInfo("","","",h.value,g):m.value.setCurrentPositionInfo("","","",h.value,w,y))};ye(()=>m.value.poolConfigObj,r=>{r&&!ve(r)&&v()},{immediate:!0});const d=C(()=>m.value.currentPositionLoading),k=C(()=>{var f,$,i;const r=((i=($=(f=l==null?void 0:l.currentRoute)==null?void 0:f.value)==null?void 0:$.query)==null?void 0:i.address)||"";return r&&m.value.addressLpTokens&&!ve(m.value.addressLpTokens)&&m.value.addressLpTokens[r]?m.value.addressLpTokens[r]:null});ye(()=>k.value,(r,f)=>{r&&!ve(r)&&(e.value=r),r&&!ve(r)&&r.current_sqrt_price!==(f==null?void 0:f.current_sqrt_price)&&v()},{immediate:!0});const X=po();ye(()=>[m.value.currentPositionInfo,h.value],([r,f])=>{var $;f=="Aptos"&&r?(e.value=r,t.value=e.value.token_a,s.value=e.value.token_b):f=="Sui"&&r&&(r==null?void 0:r.nftHash)==(($=X==null?void 0:X.query)==null?void 0:$.pos)&&(console.log(r,"==>newVal"),e.value=r,t.value=e.value.token_a,s.value=e.value.token_b)},{immediate:!0});const se=C(()=>m.value.positionDetailCurrentTab),oe=ao();return C(()=>oe),C(()=>B.value.theme),console.log(JSON.stringify(e.value),"===>positionInfo.value135"),{positionInfo:e,fromCoin:t,toCoin:s,getDetails:v,currentPositionLoading:d,positionDetailCurrentTab:se,clickRefresh:()=>{v()},chainName:h}}});const xs={class:"new-position-detail"},ea={class:"new-position-content"},oa={class:"left"},na={class:"right"},ta={class:"loading-global"};function ia(e,t,s,a,B,h){const q=Oo,m=Go,o=zo,l=Io,v=rs,d=Jo,k=Yo,X=un;return I(),N("div",xs,[de(q,{onClickRefresh:e.clickRefresh},null,8,["onClickRefresh"]),n("div",ea,[n("div",oa,[de(m),de(o,{class:"pc-module",onGetDetails:e.getDetails},null,8,["onGetDetails"])]),n("div",na,[e.positionDetailCurrentTab=="increase"?(I(),Le(l,{key:0,onGetDetails:e.getDetails},null,8,["onGetDetails"])):(I(),Le(v,{key:1,onGetDetails:e.getDetails},null,8,["onGetDetails"])),de(o,{class:"h5-module",onGetDetails:e.getDetails},null,8,["onGetDetails"]),e.chainName=="Sui"?(I(),Le(d,{key:2})):me("",!0),e.positionInfo&&e.positionInfo.minPrice!=="0"&&e.positionInfo.maxPrice!=="∞"&&e.chainName=="Sui"?(I(),Le(k,{key:3,"position-info":e.positionInfo},null,8,["position-info"])):me("",!0)])]),Ne(n("div",ta,[de(X)],512),[[Uo,e.currentPositionLoading]])])}const La=Ye(Vs,[["render",ia],["__scopeId","data-v-06ff647d"]]);export{La as default};
