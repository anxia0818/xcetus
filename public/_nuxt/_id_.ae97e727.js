import{_ as Re}from"./new-position-title.990f3679.js";import{_ as ie}from"./token-warning.d4b177ba.js";import{_ as ye}from"./auto-pool-apy-tips.8fd00026.js";import{u as Lo,a as N,g as Qo,c as Mo,d as se,s as vo,p as pe,b as _e,e as G,T as No,f as qe}from"./pool.1fba4007.js";import{u as ae,a as me}from"./sha256.90c52a93.js";import{u as Do,a as be}from"./autoPool.3ab48b85.js";import{i as zo}from"./import-icon.de3e6c66.js";import{a as Uo,l as c,m as Fo,r as I,q as ho,e as Vo,s as ce,o as _,f as O,h as e,t as So,i as W,v,j as te,x as lo,u as L,p as Yo,k as Go,y as de,z as he,A as ge,C as ve,c as go,w as le,B as ke,D as Be,b as Oe,F as Ne,E as Me,G as Le,H as fe}from"./entry.05cabcfd.js";import{afterCurrentPrice as xo}from"./data.aefb77fc.js";import"./decimal.633e31ee.js";import{D as a}from"./decimal.0e8aa3f1.js";import{_ as we}from"./assets-card.5f3373b4.js";import{_ as Ie}from"./coin-lock.8a38d692.js";import{_ as $e,a as Ce}from"./auto-pool-remove-modal.3f1ed2ca.js";/* empty css              *//* empty css              */import{V as re}from"./index.590b1b44.js";import"./back.4e5305de.js";import"./swap-setting.440e938f.js";/* empty css              *//* empty css              *//* empty css              *//* empty css              */import"./img-lock_2x.a28135f4.js";import"./img-lock_2x.2c403427.js";const De=Uo({components:{AutoPoolApyTips:ye},setup(){const o=ae(),l=c(()=>o),Z=Lo(),j=c(()=>Z),X=Do(),$=c(()=>X),w=c(()=>l.value.theme),b=Fo(),r=I();ho(()=>[$.value.positionInfoObj,b.params.id],([i,u])=>{i&&!Mo(i)&&u&&(r.value=i[u],console.log(r.value,"##positionInfo.value"))},{immediate:!0,deep:!0});const C=c(()=>{var i;return(i=r.value)==null?void 0:i.needReverse}),t=i=>{var u;return(i==null?void 0:i.logoURI)||(i==null?void 0:i.logo_url)||((u=j.value.tokensObj[i==null?void 0:i.address])==null?void 0:u.logo_url)||(w.value==="default"?zo("/image/coins/unknown.png"):zo("/image/coins/sui-unknown.png"))},n=c(()=>{var i,u;return $.value.apyObj&&((u=$.value.apyObj[(i=r.value)==null?void 0:i.id])==null?void 0:u.tvl)||"--"}),g=c(()=>{var i,u;return $.value.apyObj&&((u=$.value.apyObj[(i=r.value)==null?void 0:i.id])==null?void 0:u.apr)||"--"});return{positionInfo:r,needReverse:C,getCoinIcon:t,tvl:n,apy:g,addCommom:N,getExplorerUrl:Qo}}});const ko=o=>(Yo("data-v-c5a991ac"),o=o(),Go(),o),Ue={class:"auto-pool-v2-info"},Fe={class:"pool-info"},Ve={class:"left"},Ee={class:"coin-a"},We={alt:""},je={class:"coin-b"},Xe={alt:""},He={class:"position-name"},ze={key:0,class:"pool-fee"},Ye=ko(()=>e("span",null,"Fee tier",-1)),Ge={class:"vault-address"},Ze=ko(()=>e("span",null,"Vault Address",-1)),Je=["href"],Ke=ko(()=>e("svg",{class:"icon","aria-hidden":"true"},[e("use",{"xlink:href":"#icon-icon-link"})],-1)),Qe=[Ke],xe={class:"pool-address"},on=ko(()=>e("span",null,"Pool Address",-1)),en=["href"],nn=ko(()=>e("svg",{class:"icon","aria-hidden":"true"},[e("use",{"xlink:href":"#icon-icon-link"})],-1)),tn=[nn],sn={class:"apy-and-tvl"},ln={class:"apy"},an=ko(()=>e("div",{class:"apy-title"},"APY",-1)),un={class:"apy-text"},rn={class:"tvl"},dn=ko(()=>e("div",{class:"tvl-title"},"TVL",-1)),vn={class:"tvl-text"},mn={class:"pool-info h5-pool-info"},cn={class:"left"},pn={class:"coin-a"},fn={alt:""},yn={class:"coin-b"},_n={alt:""},bn={class:"position-name"},hn={key:0,class:"pool-fee"},gn=ko(()=>e("span",null,"Fee tier",-1)),kn={class:"left"},wn={class:"vault-address"},In=ko(()=>e("span",null,"Vault Address",-1)),$n=["href"],Cn=ko(()=>e("svg",{class:"icon","aria-hidden":"true"},[e("use",{"xlink:href":"#icon-icon-link"})],-1)),An=[Cn],Sn={class:"pool-address"},Pn=ko(()=>e("span",null,"Pool Address",-1)),Tn=["href"],Rn=ko(()=>e("svg",{class:"icon","aria-hidden":"true"},[e("use",{"xlink:href":"#icon-icon-link"})],-1)),qn=[Rn],Bn={class:"apy-and-tvl"},On={class:"apy"},Nn=ko(()=>e("div",{class:"apy-title"},"APY",-1)),Mn={class:"apy-text"},Ln={class:"tvl"},Dn=ko(()=>e("div",{class:"tvl-title"},"TVL",-1)),Un={class:"tvl-text"};function Fn(o,l,Z,j,X,$){var C,t,n,g,i,u,p,d,T,S,R,H,h,f,k,U,z,K,q,y,Q,eo,no,to,Y,io,yo,M,ao,Eo,wo,Wo,To,Io,$o,Ro,qo,jo,Xo,so,mo,Jo,m,P,J,F,co,x;const w=ie,b=ye,r=ce("image");return _(),O("div",Ue,[e("div",Fe,[e("div",Ve,[e("div",Ee,[So(e("img",We,null,512),[[r,o.needReverse?o.getCoinIcon((t=o.positionInfo)==null?void 0:t.token_b):o.getCoinIcon((C=o.positionInfo)==null?void 0:C.token_a)]]),W(w,{address:o.needReverse?(u=(i=o.positionInfo)==null?void 0:i.token_b)==null?void 0:u.address:(g=(n=o.positionInfo)==null?void 0:n.token_a)==null?void 0:g.address,"style-params":{width:"12px",height:"12px",left:"18px",bottom:"4px"}},null,8,["address"])]),e("div",je,[So(e("img",Xe,null,512),[[r,o.needReverse?o.getCoinIcon((d=o.positionInfo)==null?void 0:d.token_a):o.getCoinIcon((p=o.positionInfo)==null?void 0:p.token_b)]]),W(w,{address:o.needReverse?(H=(R=o.positionInfo)==null?void 0:R.token_a)==null?void 0:H.address:(S=(T=o.positionInfo)==null?void 0:T.token_b)==null?void 0:S.address,"style-params":{width:"12px",height:"12px",left:"18px",bottom:"4px"}},null,8,["address"])]),e("div",He,v(o.needReverse?(f=(h=o.positionInfo)==null?void 0:h.token_b)==null?void 0:f.symbol:(U=(k=o.positionInfo)==null?void 0:k.token_a)==null?void 0:U.symbol)+" - "+v(o.needReverse?(K=(z=o.positionInfo)==null?void 0:z.token_a)==null?void 0:K.symbol:(y=(q=o.positionInfo)==null?void 0:q.token_b)==null?void 0:y.symbol),1),(Q=o.positionInfo)!=null&&Q.fee?(_(),O("div",ze,[Ye,te(" "+v(((eo=o.positionInfo)==null?void 0:eo.fee)*100)+"% ",1)])):lo("",!0),e("div",Ge,[Ze,e("a",{href:("getExplorerUrl"in o?o.getExplorerUrl:L(Qo))("poolAddress",(no=o.positionInfo)==null?void 0:no.id),target:"_blank"},Qe,8,Je)]),e("div",xe,[on,e("a",{href:("getExplorerUrl"in o?o.getExplorerUrl:L(Qo))("poolAddress",(to=o.positionInfo)==null?void 0:to.address),target:"_blank"},tn,8,en)])]),e("div",sn,[e("div",ln,[an,e("div",un,[te(v(o.apy)+" ",1),W(b)])]),e("div",rn,[dn,e("div",vn,"$"+v(("addCommom"in o?o.addCommom:L(N))(o.tvl,2)),1)])])]),e("div",mn,[e("div",cn,[e("div",pn,[So(e("img",fn,null,512),[[r,o.needReverse?o.getCoinIcon((io=o.positionInfo)==null?void 0:io.token_b):o.getCoinIcon((Y=o.positionInfo)==null?void 0:Y.token_a)]]),W(w,{address:o.needReverse?(Eo=(ao=o.positionInfo)==null?void 0:ao.token_b)==null?void 0:Eo.address:(M=(yo=o.positionInfo)==null?void 0:yo.token_a)==null?void 0:M.address,"style-params":{width:"12px",height:"12px",left:"18px",bottom:"4px"}},null,8,["address"])]),e("div",yn,[So(e("img",_n,null,512),[[r,o.needReverse?o.getCoinIcon((Wo=o.positionInfo)==null?void 0:Wo.token_a):o.getCoinIcon((wo=o.positionInfo)==null?void 0:wo.token_b)]]),W(w,{address:o.needReverse?(Ro=($o=o.positionInfo)==null?void 0:$o.token_a)==null?void 0:Ro.address:(Io=(To=o.positionInfo)==null?void 0:To.token_b)==null?void 0:Io.address,"style-params":{width:"12px",height:"12px",left:"18px",bottom:"4px"}},null,8,["address"])]),e("div",bn,v(o.needReverse?(jo=(qo=o.positionInfo)==null?void 0:qo.token_b)==null?void 0:jo.symbol:(so=(Xo=o.positionInfo)==null?void 0:Xo.token_a)==null?void 0:so.symbol)+" - "+v(o.needReverse?(Jo=(mo=o.positionInfo)==null?void 0:mo.token_a)==null?void 0:Jo.symbol:(P=(m=o.positionInfo)==null?void 0:m.token_b)==null?void 0:P.symbol),1),(J=o.positionInfo)!=null&&J.fee?(_(),O("div",hn,[gn,te(" "+v(((F=o.positionInfo)==null?void 0:F.fee)*100)+"% ",1)])):lo("",!0)]),e("div",kn,[e("div",wn,[In,e("a",{href:("getExplorerUrl"in o?o.getExplorerUrl:L(Qo))("poolAddress",(co=o.positionInfo)==null?void 0:co.id),target:"_blank"},An,8,$n)]),e("div",Sn,[Pn,e("a",{href:("getExplorerUrl"in o?o.getExplorerUrl:L(Qo))("poolAddress",(x=o.positionInfo)==null?void 0:x.address),target:"_blank"},qn,8,Tn)])]),e("div",Bn,[e("div",On,[Nn,e("div",Mn,[te(v(o.apy)+" ",1),W(b)])]),e("div",Ln,[Dn,e("div",Un,"$"+v(("addCommom"in o?o.addCommom:L(N))(o.tvl,2)),1)])])])])}const Ae=Vo(De,[["render",Fn],["__scopeId","data-v-c5a991ac"]]),Vn=Uo({setup(){const o=I(!0),l=Lo(),Z=c(()=>l),j=Do(),X=c(()=>j),$=Fo(),w=I();ho(()=>[X.value.positionInfoObj,$.params.id],([t,n])=>{t&&!Mo(t)&&n&&(w.value=t[n],console.log(w.value,"##positionInfo.value"))},{immediate:!0,deep:!0});const b=c(()=>{var t;return(t=w.value)==null?void 0:t.needReverse}),r=t=>{var n;return(t==null?void 0:t.logoURI)||(t==null?void 0:t.logo_url)||((n=Z.value.tokensObj[t==null?void 0:t.address])==null?void 0:n.logo_url)||zo("/image/coins/sui-unknown.png")},C=c(()=>{var g;const t=(g=w==null?void 0:w.value)==null?void 0:g.price,n=xo.value;return t&&n?50+new a(n).sub(new a(t)).div(new a(t)).mul(100).toNumber():50});return{direct:o,positionInfo:w,needReverse:b,getCoinIcon:r,decimalUi:se,addCommom:N,sFixD:vo,moveRatio:C}}}),En=""+globalThis.__publicAssetsURL("sui-image/icon_currentprice@2x.png");const Po=o=>(Yo("data-v-73e1fd26"),o=o(),Go(),o),Wn={class:"v2-position-range"},jn={class:"position-range-top"},Xn=Po(()=>e("div",null,"Position Range",-1)),Hn={class:"base-coin"},zn={key:0},Yn={alt:""},Gn={key:1},Zn={alt:""},Jn={key:2},Kn={key:3},Qn=Po(()=>e("p",null,"Base coin",-1)),xn={class:"coin-rate"},ot=Po(()=>e("div",null,[e("svg",{class:"icon icon-up","aria-hidden":"true"},[e("use",{"xlink:href":"#icon-exchange_up1"})])],-1)),et=Po(()=>e("div",null,[e("svg",{class:"icon icon-down","aria-hidden":"true"},[e("use",{"xlink:href":"#icon-exchange_down1"})])],-1)),nt=[ot,et],tt={class:"position-range-bottom"},st={class:"current-price"},lt=Po(()=>e("div",{class:"current-price-title"},"Current Price",-1)),it={key:0,class:"current-price-text"},at={key:1,class:"current-price-text"},ut={class:"price-range"},rt=Po(()=>e("div",{class:"price-range-bg"},[e("div",{class:"price-range-border"})],-1)),dt={class:"min-price"},vt=Po(()=>e("div",null,"Min Price",-1)),mt={class:"max-price"},ct=Po(()=>e("div",null,"Max Price",-1));function pt(o,l,Z,j,X,$){var r,C,t,n,g,i,u,p,d,T,S,R,H,h,f,k,U,z,K,q,y,Q,eo,no,to,Y;const w=ie,b=ce("image");return _(),O("div",Wn,[e("div",jn,[Xn,e("div",Hn,[o.needReverse?(_(),O("div",Gn,[So(e("img",Zn,null,512),[[b,o.direct?o.getCoinIcon((p=o.positionInfo)==null?void 0:p.token_b):o.getCoinIcon((u=o.positionInfo)==null?void 0:u.token_a)]]),W(w,{address:o.direct?(R=(S=o.positionInfo)==null?void 0:S.token_b)==null?void 0:R.address:(T=(d=o.positionInfo)==null?void 0:d.token_a)==null?void 0:T.address,"style-params":{width:"10px",height:"10px",right:"0",bottom:"0"}},null,8,["address"])])):(_(),O("div",zn,[So(e("img",Yn,null,512),[[b,o.direct?o.getCoinIcon((r=o.positionInfo)==null?void 0:r.token_a):o.getCoinIcon((C=o.positionInfo)==null?void 0:C.token_b)]]),W(w,{address:o.direct?(n=(t=o.positionInfo)==null?void 0:t.token_a)==null?void 0:n.address:(i=(g=o.positionInfo)==null?void 0:g.token_b)==null?void 0:i.address,"style-params":{width:"10px",height:"10px",right:"0",bottom:"0"}},null,8,["address"])])),o.needReverse?(_(),O("span",Kn,v(o.direct?(z=(U=o.positionInfo)==null?void 0:U.token_b)==null?void 0:z.symbol:(q=(K=o.positionInfo)==null?void 0:K.token_a)==null?void 0:q.symbol),1)):(_(),O("span",Jn,v(o.direct?(h=(H=o.positionInfo)==null?void 0:H.token_a)==null?void 0:h.symbol:(k=(f=o.positionInfo)==null?void 0:f.token_b)==null?void 0:k.symbol),1)),Qn,e("div",xn,[e("div",{onClick:l[0]||(l[0]=io=>o.direct=!o.direct)},nt)])])]),e("div",tt,[e("div",st,[lt,(o.needReverse?!o.direct:o.direct)?(_(),O("div",it,v(("addCommom"in o?o.addCommom:L(N))(("decimalUi"in o?o.decimalUi:L(se))((y=o.positionInfo)==null?void 0:y.price,6))),1)):(_(),O("div",at,v(("addCommom"in o?o.addCommom:L(N))(("decimalUi"in o?o.decimalUi:L(se))(1/((Q=o.positionInfo)==null?void 0:Q.price),6))),1))]),e("div",ut,[rt,e("img",{style:de({left:`${o.moveRatio}%`}),src:En,alt:""},null,4),e("div",dt,[vt,e("div",null,v(((eo=o.positionInfo)==null?void 0:eo.minPrice)&&("sFixD"in o?o.sFixD:L(vo))((no=o.positionInfo)==null?void 0:no.minPrice,6)),1)]),e("div",mt,[ct,e("div",null,v(((to=o.positionInfo)==null?void 0:to.maxPrice)&&("sFixD"in o?o.sFixD:L(vo))((Y=o.positionInfo)==null?void 0:Y.maxPrice,6)),1)])])])])}const Se=Vo(Vn,[["render",pt],["__scopeId","data-v-73e1fd26"]]),ft=Uo({setup(){const o=Lo(),l=c(()=>o),Z=Do(),j=c(()=>Z),X=Fo(),$=I();return ho(()=>[j.value.positionInfoObj,X.params.id],([r,C])=>{console.log(r,"##positionInfoObj"),r&&!Mo(r)&&C&&($.value=r[C],console.log($.value,"##positionInfo.value"))},{immediate:!0,deep:!0}),{needReverse:c(()=>{var r;return(r=$.value)==null?void 0:r.needReverse}),positionInfo:$,getCoinIcon:r=>{var C;return console.log(r,"info##"),(r==null?void 0:r.logoURI)||(r==null?void 0:r.logo_url)||((C=l.value.tokensObj[r==null?void 0:r.address])==null?void 0:C.logo_url)||zo("/image/coins/sui-unknown.png")},addCommom:N}}});const yt=o=>(Yo("data-v-16c5df57"),o=o(),Go(),o),_t={class:"pool-composition"},bt=yt(()=>e("div",{class:"pool-composition-top"},"Pool Composition",-1)),ht={class:"pool-composition-bottom"},gt={class:"token-ratio"},kt={class:"before-coin"},wt={alt:""},It={class:"after-coin"},$t={alt:""},Ct={class:"token-num"},At={class:"num-box"},St={class:"num-box"};function Pt(o,l,Z,j,X,$){var r,C,t,n,g,i,u,p,d,T,S,R,H,h,f,k,U,z,K,q,y,Q,eo,no,to,Y,io,yo;const w=ie,b=ce("image");return _(),O("div",_t,[bt,e("div",ht,[e("div",gt,[e("div",kt,[e("div",null,[W(w,{address:o.needReverse?(n=(t=o.positionInfo)==null?void 0:t.token_b)==null?void 0:n.address:(C=(r=o.positionInfo)==null?void 0:r.token_a)==null?void 0:C.address,"style-params":{width:"14px",height:"14px",right:"0",bottom:"0"}},null,8,["address"]),So(e("img",wt,null,512),[[b,o.needReverse?o.getCoinIcon((i=o.positionInfo)==null?void 0:i.token_b):o.getCoinIcon((g=o.positionInfo)==null?void 0:g.token_a)]])]),e("span",null,v((u=o.positionInfo)==null?void 0:u.poolCoinARatio)+"%",1)]),e("div",It,[e("span",null,v((p=o.positionInfo)==null?void 0:p.poolCoinBRatio)+"%",1),e("div",null,[So(e("img",$t,null,512),[[b,o.needReverse?o.getCoinIcon((T=o.positionInfo)==null?void 0:T.token_a):o.getCoinIcon((d=o.positionInfo)==null?void 0:d.token_b)]]),W(w,{address:o.needReverse?(h=(H=o.positionInfo)==null?void 0:H.token_a)==null?void 0:h.address:(R=(S=o.positionInfo)==null?void 0:S.token_b)==null?void 0:R.address,"style-params":{width:"14px",height:"14px",right:"0",bottom:"0"}},null,8,["address"])])])]),e("div",Ct,[e("div",{class:"token-a-bg",style:de({width:`${(f=o.positionInfo)==null?void 0:f.poolCoinARatio}%`})},null,4),e("div",{class:"token-b-bg",style:de({width:`${(k=o.positionInfo)==null?void 0:k.poolCoinBRatio}%`})},null,4),e("div",At,[e("div",null,v(("addCommom"in o?o.addCommom:L(N))((U=o.positionInfo)==null?void 0:U.poolCoinANum))+" "+v(o.needReverse?(y=(q=o.positionInfo)==null?void 0:q.token_b)==null?void 0:y.symbol:(K=(z=o.positionInfo)==null?void 0:z.token_a)==null?void 0:K.symbol),1),e("div",null,"$"+v(("addCommom"in o?o.addCommom:L(N))((Q=o.positionInfo)==null?void 0:Q.poolCoinBUSD)),1)]),e("div",St,[e("div",null,v(("addCommom"in o?o.addCommom:L(N))((eo=o.positionInfo)==null?void 0:eo.poolCoinBNum))+" "+v(o.needReverse?(io=(Y=o.positionInfo)==null?void 0:Y.token_a)==null?void 0:io.symbol:(to=(no=o.positionInfo)==null?void 0:no.token_b)==null?void 0:to.symbol),1),e("div",null,"$"+v(("addCommom"in o?o.addCommom:L(N))((yo=o.positionInfo)==null?void 0:yo.poolCoinBUSD)),1)])])])])}const Pe=Vo(ft,[["render",Pt],["__scopeId","data-v-16c5df57"]]),Tt=Uo({setup(){const o=Lo(),l=c(()=>o),Z=Do(),j=c(()=>Z),X=Fo(),$=I();ho(()=>[j.value.positionInfoObj,X.params.id],([t,n])=>{console.log(t,"##positionInfoObj"),t&&!Mo(t)&&n&&($.value=t[n],console.log($.value,"##positionInfo.value"))},{immediate:!0,deep:!0});const w=c(()=>{var t;return(t=$.value)==null?void 0:t.needReverse}),b=t=>{var n;return console.log(t,"info##"),(t==null?void 0:t.logoURI)||(t==null?void 0:t.logo_url)||((n=l.value.tokensObj[t==null?void 0:t.address])==null?void 0:n.logo_url)||zo("/image/coins/sui-unknown.png")},r=me(),C=c(()=>r);return{needReverse:w,positionInfo:$,getCoinIcon:b,addCommom:N,wallet:C}}});const oe=o=>(Yo("data-v-0b578037"),o=o(),Go(),o),Rt={class:"my-liquidity"},qt={class:"my-liquidity-top"},Bt=oe(()=>e("div",null,"My Liquidity",-1)),Ot=oe(()=>e("p",null,"My share of pool",-1)),Nt={class:"my-liquidity-bottom"},Mt={class:"lp-token"},Lt=oe(()=>e("div",null,[e("span",null,"LP Token Balance ")],-1)),Dt={class:"lp-balance"},Ut={class:"token-num-content"},Ft={class:"token-num token-a-num"},Vt={class:"logo"},Et=["src"],Wt={class:"text"},jt={class:"lp-logo"},Xt=["src"],Ht=oe(()=>e("div",null,"Pooled Assets",-1)),zt={class:"token-num"},Yt={class:"logo"},Gt=["src"],Zt={class:"text"},Jt=oe(()=>e("div",{class:"token-num-content-bg"},null,-1));function Kt(o,l,Z,j,X,$){var b,r,C,t,n,g,i,u,p,d,T,S,R,H,h,f,k,U,z,K,q,y,Q,eo,no,to,Y,io;const w=ie;return _(),O("div",Rt,[e("div",qt,[Bt,e("div",null,[Ot,e("p",null,v(o.wallet.connected?(b=o.positionInfo)==null?void 0:b.myShare:"--")+"%",1)])]),e("div",Nt,[e("div",Mt,[Lt,e("div",null,[e("span",Dt,v(o.wallet.connected?("addCommom"in o?o.addCommom:L(N))((r=o.positionInfo)==null?void 0:r.myLiquidity):"--")+" LP",1),e("span",null,"$"+v(o.wallet.connected?("addCommom"in o?o.addCommom:L(N))((C=o.positionInfo)==null?void 0:C.myLiquidityUSD):"--"),1)])]),e("div",Ut,[e("div",Ft,[e("div",Vt,[e("img",{src:o.needReverse?o.getCoinIcon((n=o.positionInfo)==null?void 0:n.token_b):o.getCoinIcon((t=o.positionInfo)==null?void 0:t.token_a),alt:""},null,8,Et),W(w,{address:o.needReverse?(p=(u=o.positionInfo)==null?void 0:u.token_b)==null?void 0:p.address:(i=(g=o.positionInfo)==null?void 0:g.token_a)==null?void 0:i.address,"style-params":{width:"14px",height:"14px",left:"18px",bottom:"0"}},null,8,["address"])]),e("div",Wt,[e("div",null,v(o.wallet.connected?("addCommom"in o?o.addCommom:L(N))((d=o.positionInfo)==null?void 0:d.amountA):"--")+" "+v(o.needReverse?(H=(R=o.positionInfo)==null?void 0:R.token_b)==null?void 0:H.symbol:(S=(T=o.positionInfo)==null?void 0:T.token_a)==null?void 0:S.symbol),1),e("div",null,v(o.wallet.connected?("addCommom"in o?o.addCommom:L(N))((h=o.positionInfo)==null?void 0:h.myAmountAUSD):"--"),1)])]),e("div",jt,[e("img",{src:o.getCoinIcon((f=o.positionInfo)==null?void 0:f.lpInfo),alt:""},null,8,Xt),Ht]),e("div",zt,[e("div",Yt,[e("img",{src:o.needReverse?o.getCoinIcon((U=o.positionInfo)==null?void 0:U.token_a):o.getCoinIcon((k=o.positionInfo)==null?void 0:k.token_b),alt:""},null,8,Gt),W(w,{address:o.needReverse?(y=(q=o.positionInfo)==null?void 0:q.token_a)==null?void 0:y.address:(K=(z=o.positionInfo)==null?void 0:z.token_b)==null?void 0:K.address,"style-params":{width:"14px",height:"14px",right:"0",bottom:"0"}},null,8,["address"])]),e("div",Zt,[e("div",null,v(o.wallet.connected?("addCommom"in o?o.addCommom:L(N))((Q=o.positionInfo)==null?void 0:Q.amountB):"--")+" "+v(o.needReverse?(Y=(to=o.positionInfo)==null?void 0:to.token_a)==null?void 0:Y.symbol:(no=(eo=o.positionInfo)==null?void 0:eo.token_b)==null?void 0:no.symbol),1),e("div",null,v(o.wallet.connected?("addCommom"in o?o.addCommom:L(N))((io=o.positionInfo)==null?void 0:io.myAmountBUSD):"--"),1)])]),Jt])])])}const Te=Vo(Tt,[["render",Kt],["__scopeId","data-v-0b578037"]]),Qt=Uo({components:{AutoPoolAddModal:$e},setup(){const o=me(),l=I(!1),Z=ae(),j=c(()=>Z),X=c(()=>j.value.chainName),$=c(()=>o),w=Do(),b=c(()=>w),r=Lo(),C=c(()=>r),t=I(),n=Fo();ho(()=>[b.value.positionInfoObj,n.params.id],([m,P])=>{m&&!Mo(m)&&P&&(t.value=m[P],console.log(t.value,"##positionInfo.value"))},{immediate:!0,deep:!0});const g=c(()=>{var m,P;return console.log((m=t.value)==null?void 0:m.needReverse,"##positionInfo.value?.needReverse"),(P=t.value)==null?void 0:P.needReverse}),i=I(),u=I(),p=I(),d=I(),T=I(!0),S=c(()=>$.value.assets&&i.value&&$.value.assets[i.value.address]?pe($.value.assets[i.value.address].balance,i.value.decimals):0),R=c(()=>$.value.assets&&u.value&&$.value.assets[u.value.address]?pe($.value.assets[u.value.address].balance,u.value.decimals):0),H=m=>{m==="fromCoin"?(T.value=!0,p.value=S.value>0?i.value.symbol=="SUI"?new a(Number(S.value)).sub(new a(.05)).lt(new a(0))?"0":new a(Number(S.value)).sub(new a(.05)).toString():String(S.value):""):(T.value=!1,d.value=R.value>0?u.value.symbol=="SUI"?new a(Number(R.value)).sub(new a(.05)).lt(new a(0))?"0":new a(Number(R.value)).sub(new a(.05)).toString():String(R.value):"")},h=m=>{m==="fromCoin"?(T.value=!0,p.value=S.value>0?vo(new a(Number(S.value)).div(2).toString(),i.value.decimals).toString():""):(T.value=!1,d.value=R.value>0?vo(new a(Number(R.value)).div(2).toString(),u.value.decimals).toString():"")},f=c(()=>X.value?_e(X.value):{}),k=c(()=>j.value.slippage),U=I("--"),z=I("--"),K=m=>{const P=new a(t.value.autoPoolPositionInfo.liquidity),J=new a(m.toString());if(P.toNumber()>0&&J.toNumber()>0){const F=J.add(P);console.log("totalLiquidity:",J.div(F).mul(100).toString());const co=J.div(F).mul(100).toNumber(),x=qe(co),uo=x==-1?2:x+2,_o=vo(J.div(F).mul(100).toNumber(),uo);console.log(t.value.decimals,"##positionInfo.value.decimal");const bo=new a(1).div(new a(Math.pow(10,t.value.lpInfo.decimals))).toString();console.log(_o,bo,"###288"),Number(_o)<Number(bo)?U.value=`<${bo}`:U.value=_o}else J.toNumber()>0&&P.toNumber()<=0?U.value="100":U.value="--"},q=m=>{const P=new a(m.toString());console.log(m.toString(),"##liquidityAmount.toString()");const J=P.mul(new a(k.value).div(100)),F=new a(Math.pow(10,t.value.lpInfo.decimals));console.log(P.minus(J).div(F).toString(),"##liquidity.minus(minimum).div(decimals).toString()"),z.value=vo(P.minus(J).div(F).toString(),t.value.lpInfo.decimals)},y=I(!1),Q=I(!1),eo=I(""),no=I(),to=async()=>{if(!t.value)return;const m=t.value.autoPoolPositionInfo.tick_lower_index,P=t.value.autoPoolPositionInfo.tick_upper_index,J=No.sqrtPriceX64ToTickIndex(new G(t.value.current_sqrt_price));J<m&&(g.value?y.value=!0:Q.value=!0),J>P&&(g.value?Q.value=!0:y.value=!0);let F;if(console.log(p.value||d.value,"#fromCoinAmount.value || toCoinAmount.value"),p.value||d.value){T.value?F=new a(p.value).mul(Math.pow(10,i.value.decimals)).toString():F=new a(d.value).mul(Math.pow(10,u.value.decimals)).toString();let co,x=T.value;if(console.log("执行##"),so.value||mo.value){console.log(g.value?T.value:!T.value,"#needReverse.value?fixedFromCoin.value:!fixedFromCoin.value");const s=await jo.calculateDepositSwapAmount({lowerTick:m,upperTick:P,curSqrtPrice:new G(t.value.current_sqrt_price),fix_amount_a:x,input_amount:F,coinTypeA:t.value.autoPoolPositionInfo.coin_type_a,coinTypeB:t.value.autoPoolPositionInfo.coin_type_b,clmm_pool:t.value.address});if(console.log(s,"###swapResult"),s){co=new G(s.afterSqrtPrice),F=new G(s.swapOutAmount),no.value={swap_amount:s.swapInAmount,a2b:x},x=!x;const A=t.value.token_a.decimals,E=t.value.token_b.decimals;xo.value=No.sqrtPriceX64ToPrice(s.afterSqrtPrice,A,E).toString(),console.log(xo.value,"##afterCurrentPrice.value");const B=new a(s.swapInAmount).div(new a(Math.pow(10,A))).toString(),V=new a(s.swapOutAmount).div(new a(Math.pow(10,E))).toString(),D=g.value?t.value.token_b.symbol:t.value.token_a.symbol,po=g.value?t.value.token_a.symbol:t.value.token_b.symbol;eo.value=`To deposit ${so.value?p.value:d.value} ${so.value?D:po}, 
          ${B} ${so.value?D:po}  will be traded for ${V} ${so.value?po:D} added to the pool.`}else co=t.value.current_sqrt_price,F=new G(F),xo.value=""}else co=t.value.current_sqrt_price,F=new G(F),xo.value="",eo.value="";console.log(no,"##swapParams");const{liquidityAmount:uo,tokenMaxA:_o,tokenMaxB:bo}=f.value.estLiquidityAndcoinAmountFromOneAmounts({tokenA:i.value,tokenB:u.value,lowerTick:m,upperTick:P,coinAmount:F,iscoinA:x,roundUp:!0,slippage:Number(k.value)/100,curSqrtPrice:new G(co)});console.log(t.value.current_sqrt_price,"##positionInfo.value.current_sqrt_price"),console.log(bo.toString(),_o.toString(),t.value,"###323"),!so.value&&!mo.value&&(T.value?d.value=Number(bo)>0?bo:"":p.value=Number(_o)>0?_o:""),K(uo),q(uo)}};ho(()=>t.value,m=>{m&&!Mo(m)&&(i.value=m==null?void 0:m.token_a,u.value=m==null?void 0:m.token_b,y.value=!1,Q.value=!1,to())},{immediate:!0});const Y=c(()=>C.value.RATES),io=c(()=>{var m,P,J,F,co,x,uo,_o,bo,s;if((P=Y.value[(m=i.value)==null?void 0:m.address])!=null&&P.price&&((F=Y.value[(J=u.value)==null?void 0:J.address])!=null&&F.price)){console.log((x=Y.value[(co=i.value)==null?void 0:co.address])==null?void 0:x.price,"RATES.value[fromCoin.value?.address]?.price");const A=new a(p.value||0).mul(new a((_o=Y.value[(uo=i.value)==null?void 0:uo.address])==null?void 0:_o.price)),E=new a(d.value||0).mul(new a((s=Y.value[(bo=u.value)==null?void 0:bo.address])==null?void 0:s.price));return se(A.add(E).toString(),2)}else return"--"});ho(()=>p.value,(m,P)=>{m?to():(U.value="--",d.value="",z.value="--")},{immediate:!0}),ho(()=>d.value,(m,P)=>{m?to():(p.value="",U.value="--",z.value="--")},{immediate:!0});const{t:yo,locale:M}=he(),ao=c(()=>{const m=Number(p.value)>Number(S.value),P=Number(d.value)>Number(R.value);return!p.value&&!d.value?yo("button.enterAmount"):m?yo("button.insufficientBalance",{name:i.value.symbol}):P?yo("button.insufficientBalance",{name:u.value.symbol}):"Add Liquidity"}),Eo=c(()=>{const m=Number(p.value)>Number(S.value),P=Number(d.value)>Number(R.value);return!!(!p.value&&!d.value||m||P||p.value<=0&&d.value<=0)}),wo=I(!0),{setIsShowSuccess:Wo,setIsShowRejected:To,setIsShowWaiting:Io,setTransactionDesc:$o,setTransactionTxid:Ro,setPositiomNum:qo}=Z,jo=be("Sui"),Xo=async()=>{var _o,bo;l.value=!1,wo.value=!0,Ro("");const m=`${N(p.value)} ${(_o=i.value)==null?void 0:_o.symbol}`,P=`${N(d.value)} ${(bo=u.value)==null?void 0:bo.symbol}`;$o(`Deposit ${p.value>0?m:""} ${d.value>0&&p.value>0?"and":""} ${d.value>0?P:""}`),Io(!0);const J=T.value,F=t.value.autoPoolPositionInfo.tick_lower_index,co=t.value.autoPoolPositionInfo.tick_upper_index;let x;T.value?x=new a(p.value).mul(Math.pow(10,i.value.decimals)).toString():x=new a(d.value).mul(Math.pow(10,u.value.decimals)).toString();const uo=t.value.rewarderInfo.map(s=>s.coinAddress);try{const s={lowerTick:F,upperTick:co,coinAmount:x,fix_amount_a:J,slippage:Number(k.value)/100,curSqrtPrice:new G(t.value.current_sqrt_price),id:t.value.id,clmm_pool:t.value.autoPoolPositionInfo.pool,lp_token_type:t.value.lp_token_type,coinTypeA:t.value.autoPoolPositionInfo.coin_type_a,coinTypeB:t.value.autoPoolPositionInfo.coin_type_b,rewarder_coin_types:uo,swapParams:no.value,isOnlyA:so.value,isOnlyB:mo.value},A=await jo.deposit(s);console.log(A,"===>payloadAdd11111");const E=await $.value.currentWallet.signAndExecuteTransactionBlock(A);let B=f.value.handleTx(E);if(console.log("toAdd###tx###",B),B&&B.hash){Ro(B.hash),Io(!1),Wo(!0),console.log(t,"===>positionInfo");const V={title:"Supplied",desc:`Deposit ${p.value>0?m:""} ${d.value>0&&p.value>0?"and":""} ${d.value>0?P:""}`,hash:B.hash,tit:"Liquidity Increased",icon:"icon-icon-Increased",text:`Deposit ${p.value>0?m:""} ${d.value>0&&p.value>0?"and":""} ${d.value>0?P:""}`};X.value!=="Aptos"&&(V.res=B.res),f.value.showTransitionPending(V),await f.value.watchTransaction(V)&&setTimeout(()=>{w.updatePositionItem(t.value.id),f.value.getAccount($.value.address)},1e3),qo()}else Io(!1),To(!0);p.value="",d.value="",wo.value=!1}catch(s){p.value="",d.value="",console.log("addError###",s),wo.value=!1,Io(!1),To(!0)}},so=I(!1),mo=I(!1);return{wallet:$,positionInfo:t,isShowAddModal:l,needReverse:g,fromCoin:i,toCoin:u,fromCoinAmount:p,toCoinAmount:d,fromCoinBlance:S,toCoinBlance:R,fixedFromCoin:T,maxBtnSelect:H,halfBtnSelect:h,totalAmountUSD:io,addCommom:N,shareOfPool:U,minimumReceivedLP:z,addLiquidityBtnText:ao,addLiquidityBtnDisabled:Eo,toAdd:Xo,showToCoinLock:Q,showFromCoinLock:y,isOnlyA:so,isOnlyB:mo,onlyToken:m=>{p.value="",d.value="",eo.value="",m=="only-a"?(so.value=!so.value,mo.value=!1):(mo.value=!mo.value,so.value=!1)},onlyText:eo}}});const Zo=o=>(Yo("data-v-c3ed683b"),o=o(),Go(),o),xt={class:"auto-pool-add"},os={class:"auto-pool-add-content"},es={class:"liquidity-action-tab"},ns=Zo(()=>e("div",{class:"increase tab-active"},"Add",-1)),ts={class:"only-token"},ss=Zo(()=>e("div",null,"Deposit Amounts",-1)),ls={key:0},is={key:0},as={key:0,class:"card-item"},us={key:1,class:"card-item"},rs=Zo(()=>e("span",null,"Pool Closed",-1)),ds={class:"add-info"},vs={key:0,class:"only-text"},ms={class:"total-amount"},cs=Zo(()=>e("span",null,"Total Amount",-1)),ps={class:"total-amount"},fs=Zo(()=>e("span",null,"Share of Pool",-1)),ys={class:"total-amount"},_s=Zo(()=>e("span",null,"Minimum Received LP",-1));function bs(o,l,Z,j,X,$){var t,n,g,i,u,p,d,T,S,R,H,h,f;const w=we,b=Ie,r=ke,C=$e;return _(),O("div",xt,[e("div",os,[e("div",es,[ns,e("div",{class:"remove",onClick:l[0]||(l[0]=ge(k=>o.$emit("changeCurrentTab"),["stop"]))},"Remove")]),e("div",ts,[ss,e("div",null,[e("div",{class:"only-a",onClick:l[1]||(l[1]=k=>o.onlyToken("only-a"))},[e("p",null,[o.isOnlyA?(_(),O("span",ls)):lo("",!0)]),e("span",null,v(o.needReverse?(i=(g=o.positionInfo)==null?void 0:g.token_b)==null?void 0:i.symbol:(n=(t=o.positionInfo)==null?void 0:t.token_a)==null?void 0:n.symbol)+" only",1)]),e("div",{class:"only-b",onClick:l[2]||(l[2]=k=>o.onlyToken("only-b"))},[e("p",null,[o.isOnlyB?(_(),O("span",is)):lo("",!0)]),e("span",null,v(o.needReverse?(T=(d=o.positionInfo)==null?void 0:d.token_a)==null?void 0:T.symbol:(p=(u=o.positionInfo)==null?void 0:u.token_b)==null?void 0:p.symbol)+" only",1)])])]),e("div",{class:ve(o.needReverse?"card-container reverse":"card-container")},[(o.needReverse?!o.isOnlyA:!o.isOnlyB)?(_(),O("div",as,[W(w,{modelValue:o.fromCoinAmount,"onUpdate:modelValue":l[3]||(l[3]=k=>o.fromCoinAmount=k),"input-value":o.fromCoinAmount,"coin-symbol":o.fromCoin?o.fromCoin.symbol:null,"coin-name":o.fromCoin?o.fromCoin.name:null,balance:o.fromCoinBlance,"coin-icon":o.fromCoin?o.fromCoin.logoURI:"",address:o.fromCoin?o.fromCoin.address:"","swap-direct":"From","import-page":"deposit","has-arrow":!1,onOnMax:l[4]||(l[4]=k=>o.maxBtnSelect("fromCoin")),onOnHalf:l[5]||(l[5]=k=>o.halfBtnSelect("fromCoin")),onOnInput:l[6]||(l[6]=k=>{o.fromCoinAmount=k}),onOnFocus:l[7]||(l[7]=()=>{o.fixedFromCoin=!0})},null,8,["modelValue","input-value","coin-symbol","coin-name","balance","coin-icon","address"]),o.showFromCoinLock?(_(),go(b,{key:0})):lo("",!0)])):lo("",!0),(o.needReverse?!o.isOnlyB:!o.isOnlyA)?(_(),O("div",us,[W(w,{modelValue:o.toCoinAmount,"onUpdate:modelValue":l[8]||(l[8]=k=>o.toCoinAmount=k),"input-value":o.toCoinAmount,"coin-symbol":o.toCoin?o.toCoin.symbol:null,"coin-name":o.toCoin?o.toCoin.name:null,balance:o.toCoinBlance,"swap-direct":"To","coin-icon":o.toCoin?o.toCoin.logoURI:"",address:o.toCoin?o.toCoin.address:"","import-page":"deposit","has-arrow":!1,onOnMax:l[9]||(l[9]=k=>o.maxBtnSelect("toCoin")),onOnHalf:l[10]||(l[10]=k=>o.halfBtnSelect("toCoin")),onOnInput:l[11]||(l[11]=k=>{o.toCoinAmount=k}),onOnFocus:l[12]||(l[12]=()=>{o.fixedFromCoin=!1})},null,8,["modelValue","input-value","coin-symbol","coin-name","balance","coin-icon","address"]),o.showToCoinLock?(_(),go(b,{key:0})):lo("",!0)])):lo("",!0)],2)]),(S=o.positionInfo)!=null&&S.is_pause?(_(),go(r,{key:0,class:"big-btn liquidity-btn",disabled:!0},{default:le(()=>[rs]),_:1})):(_(),go(r,{key:1,class:"big-btn liquidity-btn",disabled:o.addLiquidityBtnDisabled,onClick:l[13]||(l[13]=k=>o.wallet.connected?o.isShowAddModal=!0:o.wallet.setIsShowWalletModal(!0))},{default:le(()=>[e("span",null,v(o.addLiquidityBtnText),1)]),_:1},8,["disabled"])),e("div",ds,[o.onlyText?(_(),O("div",vs,v(o.onlyText),1)):lo("",!0),e("div",ms,[cs,e("span",null,"$"+v(("addCommom"in o?o.addCommom:L(N))(o.totalAmountUSD)),1)]),e("div",ps,[fs,e("span",null,v(o.shareOfPool)+"%",1)]),e("div",ys,[_s,e("span",null,v(("addCommom"in o?o.addCommom:L(N))(o.minimumReceivedLP))+" "+v(o.needReverse?(R=o.toCoin)==null?void 0:R.symbol:(H=o.fromCoin)==null?void 0:H.symbol)+"-"+v(o.needReverse?(h=o.fromCoin)==null?void 0:h.symbol:(f=o.toCoin)==null?void 0:f.symbol),1)])]),o.isShowAddModal?(_(),go(C,{key:2,"pool-info":o.positionInfo,"from-coin":o.needReverse?o.positionInfo.token_b:o.positionInfo.token_a,"to-coin":o.needReverse?o.positionInfo.token_a:o.positionInfo.token_b,"from-coin-amount":o.needReverse?o.toCoinAmount:o.fromCoinAmount,"to-coin-amount":o.needReverse?o.fromCoinAmount:o.toCoinAmount,"total-amount":o.totalAmountUSD,"share-of-pool":o.shareOfPool,"minimum-received-l-p":o.minimumReceivedLP,"is-only-a":o.isOnlyA,"is-only-b":o.isOnlyB,onOnClose:l[14]||(l[14]=k=>o.isShowAddModal=!1),onToAdd:o.toAdd},null,8,["pool-info","from-coin","to-coin","from-coin-amount","to-coin-amount","total-amount","share-of-pool","minimum-received-l-p","is-only-a","is-only-b","onToAdd"])):lo("",!0)])}const hs=Vo(Qt,[["render",bs],["__scopeId","data-v-c3ed683b"]]),gs=Uo({components:{AutoPoolRemoveModal:Ce},setup(){const o=me(),l=c(()=>o),Z=ae(),j=c(()=>Z),X=c(()=>j.value.slippage),$=c(()=>j.value.chainName),w=[{name:"25%",value:25},{name:"50%",value:50},{name:"75%",value:75},{name:"MAX",value:100}],b=I(25),r=Fo(),C=Do(),t=c(()=>C),n=c(()=>(console.log(t.value.positionInfoObj[r.params.id],"autoPool.value.positionInfoObj[route.params.id]###"),t.value.positionInfoObj[r.params.id])),g=c(()=>{var s;return(s=n.value)==null?void 0:s.needReverse}),i=I(),u=I(),p=I(!1),d=I(),T=c(()=>{var s;return(s=n.value)==null?void 0:s.myLiquidity}),S=I(!0),R=c(()=>$.value?_e($.value):{}),H=be("Sui"),h=I(""),f=I(""),k=I("--"),U=I(!1),z=I(!1),K=I(),q=I(!0),y=I(),Q=Lo(),eo=c(()=>Q),no=c(()=>eo.value.RATES),to=async()=>{if(S.value||!n.value)return;const s=n.value.autoPoolPositionInfo.tick_lower_index,A=n.value.autoPoolPositionInfo.tick_upper_index,E=No.sqrtPriceX64ToTickIndex(new G(n.value.current_sqrt_price));E<s&&(g.value?U.value=!0:z.value=!0),E>A&&(g.value?z.value=!0:U.value=!0);let B;if(console.log(h.value||f.value,"#fromCoinAmount.value || toCoinAmount.value"),h.value||f.value){q.value?B=new a(h.value).mul(Math.pow(10,i.value.decimals)).toString():B=new a(f.value).mul(Math.pow(10,u.value.decimals)).toString();let V,D=q.value;if(console.log("执行##"),M.value||ao.value){const oo=await H.calculateRemoveSwapAmount({lowerTick:s,upperTick:A,curSqrtPrice:new G(n.value.current_sqrt_price),fix_amount_a:D,receiveAmount:B,coinTypeA:n.value.autoPoolPositionInfo.coin_type_a,coinTypeB:n.value.autoPoolPositionInfo.coin_type_b,clmm_pool:n.value.address});if(console.log(oo,"###swapResult"),oo){V=new G(oo.afterSqrtPrice),B=new G(oo.swapOutAmount),K.value={swap_amount:oo.swapInAmount,liquidity:oo.liquidity,a2b:!D},D=!D;const Co=n.value.token_a.decimals,Oo=n.value.token_b.decimals,Ao=new a(oo.swapInAmount).div(new a(Math.pow(10,Co))).toString(),Ko=new a(oo.swapOutAmount).div(new a(Math.pow(10,Oo))).toString(),ne=g.value?n.value.token_b.symbol:n.value.token_a.symbol,ue=g.value?n.value.token_a.symbol:n.value.token_b.symbol;y.value=`To withdraw ${M.value?h.value:f.value} ${M.value?ne:ue}, 
          ${Ko} ${M.value?ue:ne}  in the pool will be traded for ${Ao} ${M.value?ne:ue}`}else V=n.value.current_sqrt_price,B=new G(B),y.value=""}else V=n.value.current_sqrt_price,B=new G(B);console.log("执行了吗##");const{liquidityAmount:po,tokenMaxA:ro,tokenMaxB:fo}=R.value.estLiquidityAndcoinAmountFromOneAmounts({tokenA:i.value,tokenB:u.value,lowerTick:s,upperTick:A,coinAmount:B,iscoinA:D,roundUp:!1,slippage:Number(X.value)/100,curSqrtPrice:new G(V)});console.log(n.value.current_sqrt_price,"##positionInfo.value.current_sqrt_price"),console.log(fo.toString(),ro.toString(),n.value,"###323"),!M.value&&!ao.value&&(q.value?f.value=Number(fo)>0?fo:"":h.value=Number(ro)>0?ro:"");const Bo=re.get_lp_amount_by_liquidity({liquidity:n.value.liquidity,total_supply:n.value.total_supply},po.toString());d.value=new a(Bo).div(new a(Math.pow(10,n.value.lpInfo.decimals))).toString();const Ho=new a(d.value).div(new a(T.value)).mul(100);k.value=Bo,Y.value=po.toString(),b.value=Ho.toNumber()}},Y=I(),io=c(()=>{var s;return(s=n==null?void 0:n.value)==null?void 0:s.amountA}),yo=c(()=>{var s;return(s=n==null?void 0:n.value)==null?void 0:s.amountB}),M=I(!1),ao=I(!1),Eo=c(()=>{var B,V,D,po;const s=(V=no.value[(B=i==null?void 0:i.value)==null?void 0:B.address])==null?void 0:V.price,A=(po=no.value[(D=u==null?void 0:u.value)==null?void 0:D.address])==null?void 0:po.price;console.log(s,A,h.value,f.value,"####totalWithdraw");let E;return s&&A&&(M.value||ao.value?E=new a(M.value?h.value||0:f.value||0).mul(new a(M.value?s:A)).toString():(E=new a(h.value||0).mul(new a(s)).add(new a(f.value||0).mul(new a(A))).toString(),console.log(E,"result##"))),E>0&&E<.01?"<$0.01":`$${N(vo(E,2))}`}),wo=async s=>{if(!S.value)return;S.value=!0,n.value.token_a.decimals,n.value.token_b.decimals;const A=n.value.tick_lower_index,E=n.value.tick_upper_index;No.tickIndexToSqrtPriceX64(A),No.tickIndexToSqrtPriceX64(E);let B="",V,D;console.log(s.value,"##item.value"),console.log(D,"##coinAmount");let po=q.value;if(console.log("执行##"),M.value||ao.value){if(M.value){const fo=new a(uo.value).mul(Math.pow(10,i.value.decimals)).mul(s.value).toString();console.log(fo,"##amount"),D=vo(fo,0),h.value=new a(uo.value).mul(s.value).toString()}if(ao.value){const fo=new a(uo.value).mul(s.value).mul(Math.pow(10,u.value.decimals)).toString();D=vo(fo,0),f.value=new a(uo.value).mul(s.value).toString()}const ro=await H.calculateRemoveSwapAmount({lowerTick:A,upperTick:E,curSqrtPrice:new G(n.value.current_sqrt_price),fix_amount_a:po,receiveAmount:D,coinTypeA:n.value.autoPoolPositionInfo.coin_type_a,coinTypeB:n.value.autoPoolPositionInfo.coin_type_b,clmm_pool:n.value.address});if(console.log(ro,"###swapResult"),ro){new G(ro.afterSqrtPrice),D=new G(ro.swapOutAmount),K.value={swap_amount:ro.swapInAmount,liquidity:ro.liquidity,a2b:!po},po=!po;const fo=n.value.token_a.decimals,Bo=n.value.token_b.decimals,Ho=new a(ro.swapInAmount).div(new a(Math.pow(10,fo))).toString(),oo=new a(ro.swapOutAmount).div(new a(Math.pow(10,Bo))).toString(),Co=g.value?n.value.token_b.symbol:n.value.token_a.symbol,Oo=g.value?n.value.token_a.symbol:n.value.token_b.symbol;y.value=`To withdraw ${M.value?h.value:f.value} ${M.value?Co:Oo}, 
          ${oo} ${M.value?Oo:Co}  in the pool will be traded for ${Ho} ${M.value?Co:Oo}`,B=ro.liquidity}else n.value.current_sqrt_price,D=new G(D),y.value="";k.value=re.get_lp_amount_by_liquidity({liquidity:n.value.liquidity,total_supply:n.value.total_supply},B),d.value=new a(k.value).div(Math.pow(10,n.value.lpInfo.decimals)),Y.value=B}else{const ro=new a(io.value).mul(Math.pow(10,i.value.decimals)).mul(s.value).toString();D=vo(ro,0),h.value=new a(io.value).mul(s.value).toString();const fo=new a(yo.value).mul(s.value).mul(Math.pow(10,u.value.decimals)).toString();D=vo(fo,0),f.value=new a(yo.value).mul(s.value).toString(),n.value.current_sqrt_price,D=new G(D),s.value!==1?V=new a(n.value.myLiquidity).mul(Math.pow(10,n.value.lpInfo.decimals)).mul(s.value).toString():V=new a(n.value.myLiquidity).mul(Math.pow(10,n.value.lpInfo.decimals)).toString(),d.value=new a(V).div(Math.pow(10,n.value.lpInfo.decimals)),B=re.get_share_liquidity_by_amount({liquidity:n.value.liquidity,total_supply:n.value.total_supply},V),k.value=vo(V,0),Y.value=vo(B,0)}};ho(b,Be((s,A)=>{s!==A&&(Number(s)>100?b.value=100:s&&n.value?(console.log("687===>"),b.value=s,wo({value:b.value/100})):(h.value="--",f.value="--"))},300)),ho(()=>h.value,(s,A)=>{s?to():f.value=""},{immediate:!0}),ho(()=>f.value,(s,A)=>{s?to():h.value=""},{immediate:!0});const Wo=Oe(),{setIsShowSuccess:To,setIsShowRejected:Io,setIsShowWaiting:$o,setTransactionDesc:Ro,setTransactionTxid:qo,setPositiomNum:jo,setTransactionDescText:Xo}=Z,so=I(!1),{t:mo}=he(),Jo=async()=>{var Bo,Ho;so.value=!0,qo("");const s=Number(h.value)>0?`${N(h.value,i.value.decimals)} ${i.value.symbol}`:"",A=Number(f.value)>0?`${N(f.value,u.value.decimals)} ${u.value.symbol}`:"";console.log(s,A,"###transactionDescTo"),Ro(mo("tips.removeLiquidiyText",{from:g.value?A:s,and:Number(h.value)>0&&Number(f.value)>0?"and":"",to:g.value?s:A})),$o(!0);const E=mo("modal.removeLiquidityText2");Xo(E);const B=n.value.autoPoolPositionInfo.tick_lower_index,V=n.value.autoPoolPositionInfo.tick_upper_index,D=No.tickIndexToSqrtPriceX64(B),po=No.tickIndexToSqrtPriceX64(V),ro=n.value.rewarderInfo.map(oo=>oo.coinAddress);console.log(Y.value,k.value,"##liquidityVal.value");let fo;q.value?fo=new a(h.value).mul(Math.pow(10,i.value.decimals)).toString():fo=new a(f.value).mul(Math.pow(10,u.value.decimals)).toString();try{const oo={lowerSqrtPrice:D,upperSqrtPrice:po,lpTokenAmount:new G(k.value),liquidity:new G(Y.value),curSqrtPrice:new G(n.value.object.current_sqrt_price),slippage:Number(X.value)/100,id:n.value.id,clmm_pool:n.value.autoPoolPositionInfo.pool,lp_token_type:n.value.lp_token_type,coinTypeA:n.value.autoPoolPositionInfo.coin_type_a,coinTypeB:n.value.autoPoolPositionInfo.coin_type_b,rewarder_coin_types:ro,swapParams:K.value,fix_amount_a:q.value,isOnlyA:M.value,isOnlyB:ao.value,lowerTick:B,upperTick:V,receiveAmount:fo},Co=await H.remove(oo);console.log(Co,"移除流动性payload");const Oo=await l.value.currentWallet.signAndExecuteTransactionBlock(Co);let Ao=R.value.handleTx(Oo);if(console.log("0331###remove###tx####",Ao),Ao&&Ao.hash){qo(Ao.hash),$o(!1),To(!0);const Ko={title:mo("common.removeLiquidity"),desc:"",hash:Ao.hash,descTransactions:`Remove ${s} ${Number(h.value)>0&&Number(f.value)>0?"and":""} ${A} from the pool`,sender:l.value.address,chainName:"Sui",tit:"Liquidity Removed",icon:"icon-icon-Removed",text:`Withdraw ${h.value} ${(Bo=i.value)==null?void 0:Bo.symbol} and ${f.value} ${(Ho=u.value)==null?void 0:Ho.symbol}`};Ko.res=Ao.res,R.value.showTransitionPending(Ko),await R.value.watchTransaction(Ko)&&(h.value="",f.value="",d.value="",b.value=0,setTimeout(()=>{C.updatePositionItem(n.value.id),R.value.getAccount(l.value.address)},1e3),Number(b.value)==100&&r.name=="auto-pool-detail"&&Wo.push("/pool/auto"))}else $o(!1),Io(!0);so.value=!1}catch(oo){console.log("Remove error",oo),so.value=!1,$o(!1),Io(!0)}};ho(()=>n.value,(s,A)=>{s&&!Mo(s)&&(i.value=s==null?void 0:s.token_a,u.value=s==null?void 0:s.token_b,console.log("触发###"),(!A||A&&A.address!==s.address)&&wo({value:b.value/100}))},{immediate:!0});const m=c(()=>{const s=Number(d.value)>Number(T.value);return!d.value||d.value<=0?mo("button.enterAmount"):s?"Invalid Amount":mo("button.remove")}),P=c(()=>!1),J=s=>(s==null?void 0:s.logoURI)||(s==null?void 0:s.logo_url)||zo("/image/coins/sui-unknown.png"),F=s=>{h.value="",f.value="",S.value=!0,y.value="",s=="only-a"?(M.value=!M.value,ao.value=!1,q.value=!0):(ao.value=!ao.value,M.value=!1,q.value=!1)},co=s=>{S.value=!0,b.value=100,s==="fromCoin"?q.value=!0:q.value=!1},x=s=>{S.value=!0,b.value=50,s==="fromCoin"?q.value=!0:q.value=!1},uo=I(),_o=async()=>{q.value;const s=n.value.token_a.decimals,A=n.value.token_b.decimals,E=M.value?yo.value:io.value;console.log(E,"###receiveAmount");const B=i.value.address===n.value.token_a.address&&u.value.address===n.value.token_b.address?0:1;if(M.value||ao.value){console.log(E,"##receiveAmount");let V=await R.value.preSwap({pool:{address:n.value.address,coinA:n.value.token_a,coinB:n.value.token_b},a2b:B==0,byAmountIn:q.value,amount:E});console.log(V,V.estimatedAmountOut,s,A,"##preSwapRes"),uo.value=new a(V.estimatedAmountOut).add(new a(M.value?io.value:yo.value)).toString(),console.log(uo.value,"###onlyTokenBalance.value"),wo({value:b.value/100})}};return ho(()=>[M.value,ao.value],([s,A])=>{(s||A)&&_o()},{immediate:!0}),{removeLiquidityBtnText:m,removeLiquidityBtnDisabled:P,wallet:l,ratioArr:w,positionInfo:n,isShowRemoveModal:p,needReverse:g,fromCoin:i,toCoin:u,lpAmount:d,lpBalance:T,sliderVal:b,sFixD:vo,isSlider:S,fromCoinAmount:h,toCoinAmount:f,setPercent:wo,toRemove:Jo,addCommom:N,getCoinIcon:J,isOnlyA:M,isOnlyB:ao,onlyToken:F,fixedFromCoin:q,maxBtnSelect:co,halfBtnSelect:x,fromCoinBlance:io,toCoinBlance:yo,showFromCoinLock:U,showToCoinLock:z,removeText:y,onlyTokenBalance:uo,totalWithdraw:Eo,formatter:s=>`${s}%`}}});const ee=o=>(Yo("data-v-1ab3d90d"),o=o(),Go(),o),ks={class:"auto-pool-add"},ws={class:"auto-pool-add-content"},Is={class:"liquidity-action-tab"},$s=ee(()=>e("div",{class:"remove tab-active"},"Remove",-1)),Cs={class:"only-token"},As=ee(()=>e("div",null,"Deposit Amounts",-1)),Ss={key:0},Ps={key:0},Ts={key:0,class:"card-item"},Rs={key:1,class:"card-item"},qs={class:"remove-ratio"},Bs={class:"remove-ratio-select"},Os={key:0,class:"ratio"},Ns={key:1,class:"ratio"},Ms={class:"ratio-list"},Ls=["onClick"],Ds=ee(()=>e("span",null,"Pool Closed",-1)),Us={class:"remove-info"},Fs={key:0,class:"remove-text total-amount"},Vs={class:"total-amount"},Es=ee(()=>e("span",null,"Total Withdraw",-1)),Ws={class:"total-amount"},js=ee(()=>e("span",null,"LP Burn Amount",-1)),Xs={key:0},Hs={key:1};function zs(o,l,Z,j,X,$){var n,g,i,u,p,d,T,S,R,H,h,f,k,U,z,K,q;const w=we,b=Ie,r=Le,C=ke,t=Ce;return _(),O("div",ks,[e("div",ws,[e("div",Is,[e("div",{class:"increase",onClick:l[0]||(l[0]=ge(y=>o.$emit("changeCurrentTab"),["stop"]))},"Add"),$s]),e("div",Cs,[As,e("div",null,[e("div",{class:"only-a",onClick:l[1]||(l[1]=y=>o.onlyToken("only-a"))},[e("p",null,[o.isOnlyA?(_(),O("span",Ss)):lo("",!0)]),e("span",null,v(o.needReverse?(u=(i=o.positionInfo)==null?void 0:i.token_b)==null?void 0:u.symbol:(g=(n=o.positionInfo)==null?void 0:n.token_a)==null?void 0:g.symbol)+" only",1)]),e("div",{class:"only-b",onClick:l[2]||(l[2]=y=>o.onlyToken("only-b"))},[e("p",null,[o.isOnlyB?(_(),O("span",Ps)):lo("",!0)]),e("span",null,v(o.needReverse?(S=(T=o.positionInfo)==null?void 0:T.token_a)==null?void 0:S.symbol:(d=(p=o.positionInfo)==null?void 0:p.token_b)==null?void 0:d.symbol)+" only",1)])])]),e("div",{class:ve(o.needReverse?"card-container reverse":"card-container")},[(o.needReverse?!o.isOnlyA:!o.isOnlyB)?(_(),O("div",Ts,[W(w,{modelValue:o.fromCoinAmount,"onUpdate:modelValue":l[3]||(l[3]=y=>o.fromCoinAmount=y),"input-value":o.fromCoinAmount,"coin-symbol":o.fromCoin?o.fromCoin.symbol:null,"coin-name":o.fromCoin?o.fromCoin.name:null,balance:o.isOnlyA?o.onlyTokenBalance:o.fromCoinBlance,"coin-icon":o.fromCoin?o.fromCoin.logoURI:"",address:o.fromCoin?o.fromCoin.address:"","swap-direct":"From","import-page":"deposit","has-arrow":!1,"amount-leabl":"Available",onOnMax:l[4]||(l[4]=y=>o.maxBtnSelect("fromCoin")),onOnHalf:l[5]||(l[5]=y=>o.halfBtnSelect("fromCoin")),onOnInput:l[6]||(l[6]=y=>{o.isSlider=!1,o.fromCoinAmount=y}),onOnFocus:l[7]||(l[7]=()=>{o.isSlider=!1,o.fixedFromCoin=!0})},null,8,["modelValue","input-value","coin-symbol","coin-name","balance","coin-icon","address"]),o.showFromCoinLock?(_(),go(b,{key:0})):lo("",!0)])):lo("",!0),(o.needReverse?!o.isOnlyB:!o.isOnlyA)?(_(),O("div",Rs,[W(w,{modelValue:o.toCoinAmount,"onUpdate:modelValue":l[8]||(l[8]=y=>o.toCoinAmount=y),"input-value":o.toCoinAmount,"coin-symbol":o.toCoin?o.toCoin.symbol:null,"coin-name":o.toCoin?o.toCoin.name:null,balance:o.isOnlyB?o.onlyTokenBalance:o.toCoinBlance,"swap-direct":"To","coin-icon":o.toCoin?o.toCoin.logoURI:"",address:o.toCoin?o.toCoin.address:"","import-page":"deposit","has-arrow":!1,"amount-leabl":"Available",onOnMax:l[9]||(l[9]=y=>o.maxBtnSelect("toCoin")),onOnHalf:l[10]||(l[10]=y=>o.halfBtnSelect("toCoin")),onOnInput:l[11]||(l[11]=y=>{o.isSlider=!1,o.toCoinAmount=y}),onOnFocus:l[12]||(l[12]=()=>{o.isSlider=!1,o.fixedFromCoin=!1})},null,8,["modelValue","input-value","coin-symbol","coin-name","balance","coin-icon","address"]),o.showToCoinLock?(_(),go(b,{key:0})):lo("",!0)])):lo("",!0)],2),e("div",qs,[e("div",Bs,[Number(o.lpBalance)>=Number(o.lpAmount)?(_(),O("div",Os,v(o.sliderVal>0&&Number(("sFixD"in o?o.sFixD:L(vo))(o.sliderVal,2))<.01?"<0.01":("sFixD"in o?o.sFixD:L(vo))(o.sliderVal,2))+"% ",1)):(_(),O("div",Ns,"--")),e("div",Ms,[(_(!0),O(Ne,null,Me(o.ratioArr,(y,Q)=>(_(),O("div",{key:Q,class:ve(["ratio-item",o.sliderVal==y.value?"ratio-item-active":""]),onClick:()=>{o.isSlider=!0,o.sliderVal=y.value}},v(y.name),11,Ls))),128))])]),W(r,{value:o.sliderVal,"onUpdate:value":l[13]||(l[13]=y=>o.sliderVal=y),"tip-formatter":o.formatter},null,8,["value","tip-formatter"])])]),(R=o.positionInfo)!=null&&R.is_pause?(_(),go(C,{key:0,class:"big-btn liquidity-btn",disabled:!0},{default:le(()=>[Ds]),_:1})):(_(),go(C,{key:1,class:"big-btn liquidity-btn",disabled:o.removeLiquidityBtnDisabled,onClick:l[14]||(l[14]=y=>o.wallet.connected?o.toRemove():o.wallet.setIsShowWalletModal(!0))},{default:le(()=>[e("span",null,v(o.removeLiquidityBtnText),1)]),_:1},8,["disabled"])),e("div",Us,[o.removeText?(_(),O("div",Fs,v(o.removeText),1)):lo("",!0),e("div",Vs,[Es,e("span",null,v(o.totalWithdraw),1)]),e("div",Ws,[js,o.fromCoinAmount||o.toCoinAmount?(_(),O("span",Xs,v(("addCommom"in o?o.addCommom:L(N))(o.lpAmount))+" "+v(o.needReverse?(H=o.toCoin)==null?void 0:H.symbol:(h=o.fromCoin)==null?void 0:h.symbol)+"-"+v(o.needReverse?(f=o.fromCoin)==null?void 0:f.symbol:(k=o.toCoin)==null?void 0:k.symbol),1)):(_(),O("span",Hs,v(("addCommom"in o?o.addCommom:L(N))(o.lpAmount))+" "+v(o.needReverse?(U=o.toCoin)==null?void 0:U.symbol:(z=o.fromCoin)==null?void 0:z.symbol)+"-"+v(o.needReverse?(K=o.fromCoin)==null?void 0:K.symbol:(q=o.toCoin)==null?void 0:q.symbol),1))])]),o.isShowRemoveModal?(_(),go(t,{key:2,"pool-info":o.positionInfo,"from-coin":o.positionInfo.token_a,"to-coin":o.positionInfo.token_b,onOnClose:l[15]||(l[15]=y=>o.isShowRemoveModal=!1)},null,8,["pool-info","from-coin","to-coin"])):lo("",!0)])}const Ys=Vo(gs,[["render",zs],["__scopeId","data-v-1ab3d90d"]]),Gs=Uo({components:{AutoPoolV2Info:Ae,AutoPoolV2PositionRange:Se,AutoPoolV2PoolComposition:Pe,AutoPoolV2PoolLiquidity:Te,AutoPoolV2PoolAdd:hs,AutoPoolV2PoolRemove:Ys},setup(){const o=Do(),l=Lo(),Z=ae(),j=c(()=>Z),X=()=>{o.getAutoPoolAPY(),o.getAutoPoolList(),l.setPoolConfigList(j.value.chainName,j.value.filterCoinsObj)},$=I(),w=Fo();return ho(()=>w.query.action,b=>{b&&($.value=b)},{immediate:!0}),{clickRefresh:X,currentTab:$}}});const Zs={class:"auto-pool-detail-v2"},Js={class:"detail-top"},Ks={class:"detail-bottom pc-detail"},Qs={class:"detail-bottom-left"},xs={class:"detail-bottom-right"},ol={class:"h5-detail"};function el(o,l,Z,j,X,$){const w=Re,b=Ae,r=Se,C=Pe,t=Te,n=fe("AutoPoolV2PoolAdd"),g=fe("AutoPoolV2PoolRemove");return _(),O("div",Zs,[e("div",Js,[W(w,{onClickRefresh:o.clickRefresh},null,8,["onClickRefresh"]),W(b)]),e("div",Ks,[e("div",Qs,[W(r),W(C),W(t)]),e("div",xs,[o.currentTab=="add"?(_(),go(n,{key:0,onChangeCurrentTab:l[0]||(l[0]=i=>o.currentTab="remove")})):(_(),go(g,{key:1,onChangeCurrentTab:l[1]||(l[1]=i=>o.currentTab="add")}))])]),e("div",ol,[o.currentTab=="add"?(_(),go(n,{key:0,onChangeCurrentTab:l[2]||(l[2]=i=>o.currentTab="remove")})):(_(),go(g,{key:1,onChangeCurrentTab:l[3]||(l[3]=i=>o.currentTab="add")})),W(r),W(C),W(t)])])}const Sl=Vo(Gs,[["render",el],["__scopeId","data-v-b226cf01"]]);export{Sl as default};
