import{_ as ln}from"./back.30e2f5b5.js";import{_ as an}from"./refresh-icon.84a23bfe.js";import{a as Xe,M as Lo,l as Po,r as _,m as un,e as Ee,q as io,o as a,c as x,w as $e,h as o,i as X,j as je,t as r,f,F as so,s as Uo,v as Le,x as U,y as rn,I as dn,B as So,p as Ge,k as He,z as fo,A as yo,C as g,D as Se,b as To,E as eo,G as Ro,H as Qe,u as C,J as Vo,K as Io,L as jo,N as $o}from"./entry.d8dcbfff.js";/* empty css              */import{_ as vn,a as mn,b as cn}from"./icon-error_2x.2b61ffc1.js";import{u as Je,a as Eo}from"./autoPool.1e727831.js";import{u as oo,c as xe,a as R,g as Co,d as We,s as T,f as pn,T as Ve,b as re,p as Oo,e as Wo,h as fn,i as yn,j as bn}from"./pool.8e020072.js";import{_ as bo}from"./token-warning.e8fb15cd.js";import{_ as Xo}from"./auto-pool-apy-tips.6e32ceaf.js";import{u as go,a as No}from"./sha256.81632fd3.js";import{i as ro}from"./import-icon.de3e6c66.js";import"./decimal.6f03adc8.js";import{D as l}from"./decimal.0bdeb344.js";import{_ as Go}from"./assets-card.28b5c899.js";import{_ as Ho}from"./coin-lock.d5f200f8.js";import{_ as Yo,a as zo}from"./auto-pool-remove-modal.cd449770.js";import{afterCurrentPrice as wo}from"./data.ebefb175.js";import{V as Ao}from"./index.fa8cb1a5.js";/* empty css              *//* empty css              */import{u as gn}from"./swapRouter.41b81394.js";/* empty css              *//* empty css              *//* empty css              */import"./img-lock_2x.a28135f4.js";import"./img-lock_2x.115dba0a.js";const hn=Xe({components:{Modal:Lo},setup(e,t){const{t:V,locale:W}=Po(),B=Je(),A=["0.1","0.5","1"],u=_(B.slippage||.1),{setSlippage:S}=B,h=un();console.log(u.value,"slippage.value");const d=_(!1);function s(M,n){d.value=!1,u.value=n}function D(){S(u.value),t.emit("onClose",!1)}return{settingArr:A,changeActiveIndex:s,confirm:D,emit:h,slippage:u,t:V,isInput:d}}});const Jo=e=>(Ge("data-v-405dfb5e"),e=e(),He(),e),kn=Jo(()=>o("svg",{class:"icon modal-icon-close","aria-hidden":"true"},[o("use",{"xlink:href":"#icon-a-icon-Shutdown"})],-1)),_n={class:"setting-container"},$n={class:"title"},wn=Jo(()=>o("img",{src:cn,alt:""},null,-1)),In={class:"tag-list"},Cn={key:0,src:vn,alt:""},An={key:1,src:mn,alt:""},Pn={class:"footer"};function Sn(e,t,V,W,B,A){const u=rn,S=dn,h=So,d=io("Modal");return a(),x(d,{title:"Settings",class:"setting",centered:"",visible:!0,width:"400px",onCancel:t[3]||(t[3]=s=>e.$emit("onClose"))},{closeIcon:$e(()=>[kn]),footer:$e(()=>[o("div",Pn,[X(h,{type:"cancel",class:"cancel-btn cancel-btn-new",onClick:t[2]||(t[2]=s=>e.$emit("onClose"))},{default:$e(()=>[je(r(e.$t("button.cancel")),1)]),_:1}),X(h,{class:"confirmbtn",disabled:Number(e.slippage)==0||Number(e.slippage)>1||Number(e.slippage)<.01,onClick:e.confirm},{default:$e(()=>[je(r(e.$t("button.confirm")),1)]),_:1},8,["disabled","onClick"])])]),default:$e(()=>[o("div",_n,[o("div",$n,[wn,o("span",null,r(e.$t("modal.slippageTolerance")),1)]),o("div",In,[(a(!0),f(so,null,Uo(e.settingArr,(s,D)=>(a(),x(u,{key:D,class:Le(!e.isInput&&s==e.slippage?"tag-active":""),onClick:M=>e.changeActiveIndex(D,s)},{default:$e(()=>[je(r(s)+"% ",1)]),_:2},1032,["class","onClick"]))),128)),X(u,{class:Le(["input-tag",e.isInput?"tag-active":""]),onClick:t[1]||(t[1]=s=>e.isInput=!0)},{default:$e(()=>[X(S,{value:e.slippage,"onUpdate:value":t[0]||(t[0]=s=>e.slippage=s),placeholder:"",suffix:"%",class:Le(["slippage-input",Number(e.slippage)>.5&&Number(e.slippage)<1?"slippage-input-waring":Number(e.slippage)>1?"slippage-input-error":""])},null,8,["value","class"])]),_:1},8,["class"])])]),Number(e.slippage)>.5&&Number(e.slippage)<1||Number(e.slippage)>1?(a(),f("div",{key:0,class:Le(["slippage-hint",Number(e.slippage)>.5&&Number(e.slippage)<1?"slippage-hint-waring":Number(e.slippage)>1?"slippage-hint-error":""])},[Number(e.slippage)>.5&&1>=Number(e.slippage)?(a(),f("img",Cn)):U("",!0),Number(e.slippage)>1?(a(),f("img",An)):U("",!0),o("p",null,r(Number(e.slippage)>.5&&1>=Number(e.slippage)?e.$t("tips.slippageTolerance2"):Number(e.slippage)>1?e.$t("tips.slippageTolerance1"):""),1)],2)):U("",!0)]),_:1})}const Tn=Ee(hn,[["render",Sn],["__scopeId","data-v-405dfb5e"]]),Rn=Xe({props:{poolInfo:{type:Object,default:()=>({})}},setup(e,t){const V=_(!1),W=_(null),B=_(0);let A=_(!1);const u=_(20),S=oo(),h=Je(),d=_(!1);fo(()=>{}),yo(()=>{clearInterval(W.value)});const s=()=>{A.value=!1,W.value=setInterval(()=>{var m;d.value||B.value<u.value&&(B.value+=1,B.value===u.value&&((m=e==null?void 0:e.poolInfo)!=null&&m.poolAddress&&S.updateCurrentPools(e.poolInfo.poolAddress,store.chainName),B.value=0))},1e3)},D=g(()=>h.slippage),M=()=>{t.emit("clearAll")},n=()=>{A.value=!0,B.value=0,t.emit("clickRefresh"),setTimeout(()=>{A.value=!1,s()},1e3)};Se(()=>e.poolInfo,m=>{m&&!W.value&&s()},{immediate:!0});const c=To(),v=eo();return console.log(v,"route"),{refresh:A,clickRefresh:n,isShowSwapSetting:V,countdown:B,autoRefreshTime:u,slippage:D,clearAll:M,checkNullObj:xe,router:c,route:v}}});const Nn=e=>(Ge("data-v-7418921d"),e=e(),He(),e),qn={class:"title"},Bn={class:"left"},Dn=Nn(()=>o("svg",{class:"icon","aria-hidden":"true"},[o("use",{"xlink:href":"#icon-a-icon-setslippage"})],-1)),Fn={key:0,class:"deposit-progress"};function Mn(e,t,V,W,B,A){const u=ln,S=an,h=Tn;return a(),f("div",qn,[o("div",Bn,[X(u)]),o("div",{class:Le(["right title-right deposit-setting",e.poolInfo?"havePoolInfo":"noPoolInfo"])},[o("div",{class:"slippage-icon",onClick:t[0]||(t[0]=d=>e.isShowSwapSetting=!0)},[Dn,o("span",null,r(e.slippage)+"%",1)]),e.route.name!=="liquidity-create"?(a(),f("div",Fn,[X(S,{loading:e.refresh,"auto-refresh-time":e.autoRefreshTime,countdown:e.countdown,onClickRefresh:e.clickRefresh},null,8,["loading","auto-refresh-time","countdown","onClickRefresh"])])):U("",!0)],2),e.isShowSwapSetting?(a(),x(h,{key:0,onOnClose:t[1]||(t[1]=d=>e.isShowSwapSetting=!1)})):U("",!0)])}const On=Ee(Rn,[["render",Mn],["__scopeId","data-v-7418921d"]]),Ln=Xe({components:{AutoPoolApyTips:Xo},setup(){const e=go(),t=g(()=>e),V=oo(),W=g(()=>V),B=Je(),A=g(()=>B),u=g(()=>t.value.theme),S=eo(),h=_();Se(()=>[A.value.positionInfoObj,S.params.id],([n,c])=>{n&&!xe(n)&&c&&(h.value=n[c],console.log(h.value,"##positionInfo.value"))},{immediate:!0,deep:!0});const d=g(()=>{var n;return(n=h.value)==null?void 0:n.needReverse}),s=n=>{var c;return(n==null?void 0:n.logoURI)||(n==null?void 0:n.logo_url)||((c=W.value.tokensObj[n==null?void 0:n.address])==null?void 0:c.logo_url)||(u.value==="default"?ro("/image/coins/unknown.png"):ro("/image/coins/sui-unknown.png"))},D=g(()=>{var n,c;return console.log((n=h==null?void 0:h.value)==null?void 0:n.poolUSD,"##positionInfo?.value?.poolUSD"),(c=h==null?void 0:h.value)==null?void 0:c.poolUSD}),M=g(()=>{var n,c;return A.value.apyObj&&((c=A.value.apyObj[(n=h.value)==null?void 0:n.id])==null?void 0:c.apr)||"--"});return{positionInfo:h,needReverse:d,getCoinIcon:s,tvl:D,apy:M,addCommom:R,getExplorerUrl:Co}}});const Ye=e=>(Ge("data-v-64d0287a"),e=e(),He(),e),Un={class:"auto-pool-v2-info"},Vn={class:"pool-info"},jn={class:"left"},En={class:"coin-a"},Wn={alt:""},Xn={class:"coin-b"},Gn={alt:""},Hn={class:"position-name"},Yn={key:0,class:"pool-fee"},zn=Ye(()=>o("span",null,"Fee tier",-1)),Jn={class:"vault-address"},Kn=["href"],Zn=Ye(()=>o("span",null,"Vault Address",-1)),Qn=Ye(()=>o("svg",{class:"icon","aria-hidden":"true"},[o("use",{"xlink:href":"#icon-icon-link"})],-1)),xn=[Zn,Qn],et={class:"apy-and-tvl"},ot={class:"apy"},nt=Ye(()=>o("div",{class:"apy-title"},"APY",-1)),tt={class:"apy-text"},st={class:"tvl"},it=Ye(()=>o("div",{class:"tvl-title"},"TVL",-1)),lt={class:"tvl-text"},at={class:"pool-info h5-pool-info"},ut={class:"left"},rt={class:"coin-a"},dt={alt:""},vt={class:"coin-b"},mt={alt:""},ct={class:"position-name"},pt={key:0,class:"pool-fee"},ft=Ye(()=>o("span",null,"Fee tier",-1)),yt={class:"left"},bt={class:"vault-address"},gt=["href"],ht=Ye(()=>o("span",null,"Vault Address",-1)),kt=Ye(()=>o("svg",{class:"icon","aria-hidden":"true"},[o("use",{"xlink:href":"#icon-icon-link"})],-1)),_t=[ht,kt],$t={class:"apy-and-tvl"},wt={class:"apy"},It=Ye(()=>o("div",{class:"apy-title"},"APY",-1)),Ct={class:"apy-text"},At={class:"tvl"},Pt=Ye(()=>o("div",{class:"tvl-title"},"TVL",-1)),St={class:"tvl-text"};function Tt(e,t,V,W,B,A){var d,s,D,M,n,c,v,m,k,p,q,N,L,H,Y,J,b,y,j,z,P,F,G,oe,ge,ye,ve,he,E,be,me,I,K,Te,ke,Be,Ae,De,we,Me,Re,vo,ue,Pe,Ne,no;const u=bo,S=Xo,h=Ro("image");return a(),f("div",Un,[o("div",Vn,[o("div",jn,[o("div",En,[Qe(o("img",Wn,null,512),[[h,e.needReverse?e.getCoinIcon((s=e.positionInfo)==null?void 0:s.token_b):e.getCoinIcon((d=e.positionInfo)==null?void 0:d.token_a)]]),X(u,{address:e.needReverse?(c=(n=e.positionInfo)==null?void 0:n.token_b)==null?void 0:c.address:(M=(D=e.positionInfo)==null?void 0:D.token_a)==null?void 0:M.address,"style-params":{width:"12px",height:"12px",left:"18px",bottom:"4px"}},null,8,["address"])]),o("div",Xn,[Qe(o("img",Gn,null,512),[[h,e.needReverse?e.getCoinIcon((m=e.positionInfo)==null?void 0:m.token_a):e.getCoinIcon((v=e.positionInfo)==null?void 0:v.token_b)]]),X(u,{address:e.needReverse?(N=(q=e.positionInfo)==null?void 0:q.token_a)==null?void 0:N.address:(p=(k=e.positionInfo)==null?void 0:k.token_b)==null?void 0:p.address,"style-params":{width:"12px",height:"12px",left:"18px",bottom:"4px"}},null,8,["address"])]),o("div",Hn,r(e.needReverse?(H=(L=e.positionInfo)==null?void 0:L.token_b)==null?void 0:H.symbol:(J=(Y=e.positionInfo)==null?void 0:Y.token_a)==null?void 0:J.symbol)+" - "+r(e.needReverse?(y=(b=e.positionInfo)==null?void 0:b.token_a)==null?void 0:y.symbol:(z=(j=e.positionInfo)==null?void 0:j.token_b)==null?void 0:z.symbol),1),(P=e.positionInfo)!=null&&P.fee?(a(),f("div",Yn,[zn,je(" "+r(((F=e.positionInfo)==null?void 0:F.fee)*100)+"% ",1)])):U("",!0),o("div",Jn,[o("a",{href:("getExplorerUrl"in e?e.getExplorerUrl:C(Co))("poolAddress",(G=e.positionInfo)==null?void 0:G.id),target:"_blank"},xn,8,Kn)])]),o("div",et,[o("div",ot,[nt,o("div",tt,[je(r(e.apy)+" ",1),X(S)])]),o("div",st,[it,o("div",lt,"$"+r(("addCommom"in e?e.addCommom:C(R))(e.tvl,2)),1)])])]),o("div",at,[o("div",ut,[o("div",rt,[Qe(o("img",dt,null,512),[[h,e.needReverse?e.getCoinIcon((ge=e.positionInfo)==null?void 0:ge.token_b):e.getCoinIcon((oe=e.positionInfo)==null?void 0:oe.token_a)]]),X(u,{address:e.needReverse?(E=(he=e.positionInfo)==null?void 0:he.token_b)==null?void 0:E.address:(ve=(ye=e.positionInfo)==null?void 0:ye.token_a)==null?void 0:ve.address,"style-params":{width:"12px",height:"12px",left:"18px",bottom:"4px"}},null,8,["address"])]),o("div",vt,[Qe(o("img",mt,null,512),[[h,e.needReverse?e.getCoinIcon((me=e.positionInfo)==null?void 0:me.token_a):e.getCoinIcon((be=e.positionInfo)==null?void 0:be.token_b)]]),X(u,{address:e.needReverse?(ke=(Te=e.positionInfo)==null?void 0:Te.token_a)==null?void 0:ke.address:(K=(I=e.positionInfo)==null?void 0:I.token_b)==null?void 0:K.address,"style-params":{width:"12px",height:"12px",left:"18px",bottom:"4px"}},null,8,["address"])]),o("div",ct,r(e.needReverse?(Ae=(Be=e.positionInfo)==null?void 0:Be.token_b)==null?void 0:Ae.symbol:(we=(De=e.positionInfo)==null?void 0:De.token_a)==null?void 0:we.symbol)+" - "+r(e.needReverse?(Re=(Me=e.positionInfo)==null?void 0:Me.token_a)==null?void 0:Re.symbol:(ue=(vo=e.positionInfo)==null?void 0:vo.token_b)==null?void 0:ue.symbol),1),(Pe=e.positionInfo)!=null&&Pe.fee?(a(),f("div",pt,[ft,je(" "+r(((Ne=e.positionInfo)==null?void 0:Ne.fee)*100)+"% ",1)])):U("",!0)]),o("div",yt,[o("div",bt,[o("a",{href:("getExplorerUrl"in e?e.getExplorerUrl:C(Co))("poolAddress",(no=e.positionInfo)==null?void 0:no.id),target:"_blank"},_t,8,gt)])]),o("div",$t,[o("div",wt,[It,o("div",Ct,[je(r(e.apy)+" ",1),X(S)])]),o("div",At,[Pt,o("div",St,"$"+r(("addCommom"in e?e.addCommom:C(R))(e.tvl,2)),1)])])])])}const Ko=Ee(Ln,[["render",Tt],["__scopeId","data-v-64d0287a"]]),Rt=Xe({components:{Slider:Vo},setup(){const e=_(!0),t=oo(),V=g(()=>t),W=Je(),B=g(()=>W),A=eo(),u=_();Se(()=>[B.value.positionInfoObj,A.params.id],([n,c])=>{n&&!xe(n)&&c&&(u.value=n[c],console.log(u.value,"##positionInfo.value"))},{immediate:!0,deep:!0});const S=g(()=>{var n;return(n=u.value)==null?void 0:n.needReverse}),h=n=>{var c;return(n==null?void 0:n.logoURI)||(n==null?void 0:n.logo_url)||((c=V.value.tokensObj[n==null?void 0:n.address])==null?void 0:c.logo_url)||ro("/image/coins/sui-unknown.png")},d=g(()=>{var k,p,q;const n=(k=u==null?void 0:u.value)==null?void 0:k.price,c=(p=u==null?void 0:u.value)==null?void 0:p.minPrice,v=(q=u==null?void 0:u.value)==null?void 0:q.maxPrice;let m;if(n>=c&&n<=v){const N=new l(c).add(new l(v)).div(2).toNumber();m=n>N?50+new l(n).sub(N).div(N).toNumber():50-new l(n).sub(N).div(N).toNumber()}else n<c?(m=new l(n).sub(new l(c)).mul(100).toNumber()+15,console.log(m,"##result")):n>v&&(m=new l(n).sub(new l(v)).div(new l(v)).mul(100).toNumber()+70+15);return Number(pn(m,0))}),s=g(()=>{var k,p,q,N,L,H,Y;const n=e.value?((k=u.value)==null?void 0:k.minPrice)&&T(u==null?void 0:u.value.minPrice,6):((p=u.value)==null?void 0:p.maxPrice)&&T(1/(u==null?void 0:u.value.maxPrice),6),c=e.value?((q=u.value)==null?void 0:q.maxPrice)&&T((N=u.value)==null?void 0:N.maxPrice,6):((L=u.value)==null?void 0:L.minPrice)&&T(1/(u==null?void 0:u.value.minPrice),6),v=(S.value?!e.value:e.value)?T((H=u.value)==null?void 0:H.price,6):T(1/((Y=u.value)==null?void 0:Y.price),6);let m={};return m[n]={label:"Min Price"},m[c]={label:"Max Price"},v>n&&v<c?m[v]={label:"Current Price"}:v<n?m[Number(n)+1e-9]={label:"Current Price"}:v>c&&(m[Number(c)-1e-9]={label:"Current Price"}),console.log(m,"obj###"),m}),D=g(()=>{var c,v;const n=(S.value?!e.value:e.value)?We((c=u.value)==null?void 0:c.price,6):We(1/((v=u.value)==null?void 0:v.price),6);return console.log(n,"result##"),n}),M=g(()=>{var c,v;const n=(S.value?!e.value:e.value)?We((c=u.value)==null?void 0:c.price,6):We(1/((v=u.value)==null?void 0:v.price),6);return console.log(n,"result##111"),n});return{direct:e,positionInfo:u,needReverse:S,getCoinIcon:h,decimalUi:We,addCommom:R,sFixD:T,moveRatio:d,marks:s,currentPrice:D,currentPriceResever:M}}});const ho=e=>(Ge("data-v-220133b5"),e=e(),He(),e),Nt={class:"v2-position-range"},qt={class:"position-range-top"},Bt=ho(()=>o("div",null,"Position Range",-1)),Dt={class:"base-coin"},Ft={key:0},Mt={alt:""},Ot={key:1},Lt={alt:""},Ut={key:2},Vt={key:3},jt=ho(()=>o("p",null,"Base coin",-1)),Et={class:"coin-rate"},Wt=ho(()=>o("div",null,[o("svg",{class:"icon icon-up","aria-hidden":"true"},[o("use",{"xlink:href":"#icon-exchange_up1"})])],-1)),Xt=ho(()=>o("div",null,[o("svg",{class:"icon icon-down","aria-hidden":"true"},[o("use",{"xlink:href":"#icon-exchange_down1"})])],-1)),Gt=[Wt,Xt],Ht={class:"position-range-bottom"},Yt={class:"price-range"},zt={class:"price-range-bg"},Jt={key:0,class:"min-price"},Kt={key:0},Zt={key:1},Qt={key:1,class:"max-price"},xt={key:0},es={key:1},os={key:0,class:"min-price"},ns={key:0},ts={key:1},ss={key:1,class:"max-price"},is={key:0},ls={key:1};function as(e,t,V,W,B,A){var d,s,D,M,n,c,v,m,k,p,q,N,L,H,Y,J,b,y,j,z,P,F,G,oe,ge,ye,ve,he;const u=bo,S=io("Slider"),h=Ro("image");return a(),f("div",Nt,[o("div",qt,[Bt,o("div",Dt,[e.needReverse?(a(),f("div",Ot,[Qe(o("img",Lt,null,512),[[h,e.direct?e.getCoinIcon((m=e.positionInfo)==null?void 0:m.token_b):e.getCoinIcon((v=e.positionInfo)==null?void 0:v.token_a)]]),X(u,{address:e.direct?(N=(q=e.positionInfo)==null?void 0:q.token_b)==null?void 0:N.address:(p=(k=e.positionInfo)==null?void 0:k.token_a)==null?void 0:p.address,"style-params":{width:"10px",height:"10px",right:"0",bottom:"0"}},null,8,["address"])])):(a(),f("div",Ft,[Qe(o("img",Mt,null,512),[[h,e.direct?e.getCoinIcon((d=e.positionInfo)==null?void 0:d.token_a):e.getCoinIcon((s=e.positionInfo)==null?void 0:s.token_b)]]),X(u,{address:e.direct?(M=(D=e.positionInfo)==null?void 0:D.token_a)==null?void 0:M.address:(c=(n=e.positionInfo)==null?void 0:n.token_b)==null?void 0:c.address,"style-params":{width:"10px",height:"10px",right:"0",bottom:"0"}},null,8,["address"])])),e.needReverse?(a(),f("span",Vt,r(e.direct?(y=(b=e.positionInfo)==null?void 0:b.token_b)==null?void 0:y.symbol:(z=(j=e.positionInfo)==null?void 0:j.token_a)==null?void 0:z.symbol),1)):(a(),f("span",Ut,r(e.direct?(H=(L=e.positionInfo)==null?void 0:L.token_a)==null?void 0:H.symbol:(J=(Y=e.positionInfo)==null?void 0:Y.token_b)==null?void 0:J.symbol),1)),jt,o("div",Et,[o("div",{onClick:t[0]||(t[0]=E=>e.direct=!e.direct)},Gt)])])]),o("div",Ht,[o("div",Yt,[o("div",zt,[e.direct?(a(),x(S,{key:0,value:e.currentPrice,class:Le(["position-slider",e.currentPrice<Number(("sFixD"in e?e.sFixD:C(T))((P=e.positionInfo)==null?void 0:P.minPrice,6))||e.currentPrice>Number(("sFixD"in e?e.sFixD:C(T))((F=e.positionInfo)==null?void 0:F.maxPrice,6))?"hide-handler":""]),step:1e-4,marks:e.marks,disabled:!0,min:Number(("sFixD"in e?e.sFixD:C(T))((G=e.positionInfo)==null?void 0:G.minPrice,6)),max:Number(("sFixD"in e?e.sFixD:C(T))((oe=e.positionInfo)==null?void 0:oe.maxPrice,6))},{mark:$e(({label:E})=>{var be,me,I,K,Te,ke,Be,Ae,De,we,Me,Re;return[E=="Min Price"?(a(),f("div",Jt,[o("div",null,r(E),1),e.direct?(a(),f("div",Kt,r(((be=e.positionInfo)==null?void 0:be.minPrice)&&("sFixD"in e?e.sFixD:C(T))((me=e.positionInfo)==null?void 0:me.minPrice,6)),1)):(a(),f("div",Zt,r(((I=e.positionInfo)==null?void 0:I.maxPrice)&&("sFixD"in e?e.sFixD:C(T))(1/((K=e.positionInfo)==null?void 0:K.maxPrice),6)),1))])):U("",!0),E=="Max Price"?(a(),f("div",Qt,[o("div",null,r(E),1),e.direct?(a(),f("div",xt,r(((Te=e.positionInfo)==null?void 0:Te.maxPrice)&&("sFixD"in e?e.sFixD:C(T))((ke=e.positionInfo)==null?void 0:ke.maxPrice,6)),1)):(a(),f("div",es,r(((Be=e.positionInfo)==null?void 0:Be.minPrice)&&("sFixD"in e?e.sFixD:C(T))(1/((Ae=e.positionInfo)==null?void 0:Ae.minPrice),6)),1))])):U("",!0),E=="Current Price"?(a(),f("div",{key:2,class:Le(["current-price",e.currentPrice<Number(("sFixD"in e?e.sFixD:C(T))((De=e.positionInfo)==null?void 0:De.minPrice,6))?"current-price-left":e.currentPrice>Number(("sFixD"in e?e.sFixD:C(T))((we=e.positionInfo)==null?void 0:we.maxPrice,6))?"current-price-right":""])},[o("div",null,r(E),1),o("div",null,[(e.needReverse?!e.direct:e.direct)?(a(),f(so,{key:0},[je(r(("addCommom"in e?e.addCommom:C(R))(("decimalUi"in e?e.decimalUi:C(We))((Me=e.positionInfo)==null?void 0:Me.price,6))),1)],64)):(a(),f(so,{key:1},[je(r(("addCommom"in e?e.addCommom:C(R))(("decimalUi"in e?e.decimalUi:C(We))(1/((Re=e.positionInfo)==null?void 0:Re.price),6))),1)],64))])],2)):U("",!0)]}),_:1},8,["value","class","marks","min","max"])):(a(),x(S,{key:1,value:e.currentPriceResever,class:Le(["position-slider",e.currentPriceResever<Number(("sFixD"in e?e.sFixD:C(T))(1/((ge=e.positionInfo)==null?void 0:ge.maxPrice),6))||e.currentPriceResever>Number(("sFixD"in e?e.sFixD:C(T))(1/((ye=e.positionInfo)==null?void 0:ye.minPrice),6))?"hide-handler":""]),step:null,min:Number(("sFixD"in e?e.sFixD:C(T))(1/((ve=e.positionInfo)==null?void 0:ve.maxPrice),6)),max:Number(("sFixD"in e?e.sFixD:C(T))(1/((he=e.positionInfo)==null?void 0:he.minPrice),6)),marks:e.marks,disabled:!0},{mark:$e(({label:E})=>{var be,me,I,K,Te,ke,Be,Ae,De,we,Me,Re;return[E=="Min Price"?(a(),f("div",os,[o("div",null,r(E),1),e.direct?(a(),f("div",ns,r(((be=e.positionInfo)==null?void 0:be.minPrice)&&("sFixD"in e?e.sFixD:C(T))((me=e.positionInfo)==null?void 0:me.minPrice,6)),1)):(a(),f("div",ts,r(((I=e.positionInfo)==null?void 0:I.maxPrice)&&("sFixD"in e?e.sFixD:C(T))(1/((K=e.positionInfo)==null?void 0:K.maxPrice),6)),1))])):U("",!0),E=="Max Price"?(a(),f("div",ss,[o("div",null,r(E),1),e.direct?(a(),f("div",is,r(((Te=e.positionInfo)==null?void 0:Te.maxPrice)&&("sFixD"in e?e.sFixD:C(T))((ke=e.positionInfo)==null?void 0:ke.maxPrice,6)),1)):(a(),f("div",ls,r(((Be=e.positionInfo)==null?void 0:Be.minPrice)&&("sFixD"in e?e.sFixD:C(T))(1/((Ae=e.positionInfo)==null?void 0:Ae.minPrice),6)),1))])):U("",!0),E=="Current Price"?(a(),f("div",{key:2,class:Le(["current-price current-price-direct",e.currentPriceResever<Number(("sFixD"in e?e.sFixD:C(T))(1/((De=e.positionInfo)==null?void 0:De.maxPrice),6))?"current-price-left":e.currentPriceResever>Number(("sFixD"in e?e.sFixD:C(T))(1/((we=e.positionInfo)==null?void 0:we.minPrice),6))?"current-price-right":""])},[o("div",null,r(E),1),o("div",null,[(e.needReverse?!e.direct:e.direct)?(a(),f(so,{key:0},[je(r(("addCommom"in e?e.addCommom:C(R))(("decimalUi"in e?e.decimalUi:C(We))((Me=e.positionInfo)==null?void 0:Me.price,6))),1)],64)):(a(),f(so,{key:1},[je(r(("addCommom"in e?e.addCommom:C(R))(("decimalUi"in e?e.decimalUi:C(We))(1/((Re=e.positionInfo)==null?void 0:Re.price),6))),1)],64))])],2)):U("",!0)]}),_:1},8,["value","class","min","max","marks"]))])])])])}const Zo=Ee(Rt,[["render",as],["__scopeId","data-v-220133b5"]]),us=Xe({components:{Modal:Lo},props:{positionInfo:{type:Object,default:()=>({})}},setup(e){const t=g(()=>{var W,B;const V=Math.ceil(((W=e.positionInfo)==null?void 0:W.poolUSD)/((B=e.positionInfo)==null?void 0:B.quoteUSD)*100);return console.log(V,"Pool Capacity Ratio"),Number(V)});return{sFixD:T,addCommom:R,ratio:t}}});const qo=e=>(Ge("data-v-f4b12696"),e=e(),He(),e),rs=qo(()=>o("svg",{class:"icon modal-icon-close","aria-hidden":"true"},[o("use",{"xlink:href":"#icon-a-icon-Shutdown"})],-1)),ds={class:"deposit-slider"},vs={class:"info-block"},ms=qo(()=>o("div",{class:"leabl"},"Current Deposit：",-1)),cs={class:"text"},ps={class:"info-block"},fs=qo(()=>o("div",{class:"leabl"},"Max Capacity：",-1)),ys={class:"text"};function bs(e,t,V,W,B,A){const u=io("Modal");return a(),x(u,{width:"440px",visible:!0,footer:null,title:"Vault Capacity",onCancel:t[0]||(t[0]=S=>e.$emit("onClose"))},{closeIcon:$e(()=>[rs]),default:$e(()=>{var S,h,d,s;return[o("div",ds,[o("div",{class:"current-deposit",style:Io({width:`${e.ratio>100?100:e.ratio}%`})},null,4)]),o("div",vs,[ms,o("div",cs,r(("addCommom"in e?e.addCommom:C(R))(("sFixD"in e?e.sFixD:C(T))((S=e.positionInfo)==null?void 0:S.poolUSD,2)))+" "+r((h=e.positionInfo)==null?void 0:h.quoteCoinInfo.symbol),1)]),o("div",ps,[fs,o("div",ys,r(("addCommom"in e?e.addCommom:C(R))(("sFixD"in e?e.sFixD:C(T))((d=e.positionInfo)==null?void 0:d.quoteUSD,2)))+" "+r((s=e.positionInfo)==null?void 0:s.quoteCoinInfo.symbol),1)])]}),_:1})}const Qo=Ee(us,[["render",bs],["__scopeId","data-v-f4b12696"]]),gs=Xe({components:{AutoPoolV2PoolCapacity:Qo},setup(){const e=oo(),t=g(()=>e),V=Je(),W=g(()=>V),B=eo(),A=_();Se(()=>[W.value.positionInfoObj,B.params.id],([d,s])=>{console.log(d,"##positionInfoObj"),d&&!xe(d)&&s&&(A.value=d[s],console.log(A.value,"##positionInfo.value"))},{immediate:!0,deep:!0});const u=g(()=>{var d;return(d=A.value)==null?void 0:d.needReverse}),S=d=>{var s;return console.log(d,"info##"),(d==null?void 0:d.logoURI)||(d==null?void 0:d.logo_url)||((s=t.value.tokensObj[d==null?void 0:d.address])==null?void 0:s.logo_url)||ro("/image/coins/sui-unknown.png")},h=_(!1);return{needReverse:u,positionInfo:A,getCoinIcon:S,addCommom:R,isShowModal:h}}});const hs=e=>(Ge("data-v-ad8a33e9"),e=e(),He(),e),ks={class:"pool-composition"},_s={class:"pool-composition-top"},$s=hs(()=>o("span",null,"Vault Composition",-1)),ws={class:"pool-composition-bottom"},Is={class:"token-ratio"},Cs={class:"before-coin"},As={alt:""},Ps={class:"after-coin"},Ss={alt:""},Ts={class:"token-num"},Rs={class:"num-box"},Ns={class:"num-box"};function qs(e,t,V,W,B,A){var d,s,D,M,n,c,v,m,k,p,q,N,L,H,Y,J,b,y,j,z,P,F,G,oe,ge,ye,ve,he,E;const u=bo,S=Qo,h=Ro("image");return a(),f("div",ks,[o("div",_s,[$s,Number((d=e.positionInfo)==null?void 0:d.quoteUSD)>0?(a(),f("div",{key:0,class:"pool-capacity",onClick:t[0]||(t[0]=be=>e.isShowModal=!0)},"Vault Capacity")):U("",!0)]),o("div",ws,[o("div",Is,[o("div",Cs,[o("div",null,[X(u,{address:e.needReverse?(n=(M=e.positionInfo)==null?void 0:M.token_b)==null?void 0:n.address:(D=(s=e.positionInfo)==null?void 0:s.token_a)==null?void 0:D.address,"style-params":{width:"14px",height:"14px",right:"0",bottom:"0"}},null,8,["address"]),Qe(o("img",As,null,512),[[h,e.needReverse?e.getCoinIcon((v=e.positionInfo)==null?void 0:v.token_b):e.getCoinIcon((c=e.positionInfo)==null?void 0:c.token_a)]])]),o("span",null,r((m=e.positionInfo)==null?void 0:m.poolCoinARatio)+"%",1)]),o("div",Ps,[o("span",null,r((k=e.positionInfo)==null?void 0:k.poolCoinBRatio)+"%",1),o("div",null,[Qe(o("img",Ss,null,512),[[h,e.needReverse?e.getCoinIcon((q=e.positionInfo)==null?void 0:q.token_a):e.getCoinIcon((p=e.positionInfo)==null?void 0:p.token_b)]]),X(u,{address:e.needReverse?(Y=(H=e.positionInfo)==null?void 0:H.token_a)==null?void 0:Y.address:(L=(N=e.positionInfo)==null?void 0:N.token_b)==null?void 0:L.address,"style-params":{width:"14px",height:"14px",right:"0",bottom:"0"}},null,8,["address"])])])]),o("div",Ts,[o("div",{class:"token-a-bg",style:Io({width:`${(J=e.positionInfo)==null?void 0:J.poolCoinARatio}%`})},null,4),o("div",{class:"token-b-bg",style:Io({width:`${(b=e.positionInfo)==null?void 0:b.poolCoinBRatio}%`})},null,4),o("div",Rs,[o("div",null,r(("addCommom"in e?e.addCommom:C(R))((y=e.positionInfo)==null?void 0:y.poolCoinANum))+" "+r(e.needReverse?(F=(P=e.positionInfo)==null?void 0:P.token_b)==null?void 0:F.symbol:(z=(j=e.positionInfo)==null?void 0:j.token_a)==null?void 0:z.symbol),1),o("div",null,"$"+r(("addCommom"in e?e.addCommom:C(R))((G=e.positionInfo)==null?void 0:G.poolCoinAUSD)),1)]),o("div",Ns,[o("div",null,r(("addCommom"in e?e.addCommom:C(R))((oe=e.positionInfo)==null?void 0:oe.poolCoinBNum))+" "+r(e.needReverse?(he=(ve=e.positionInfo)==null?void 0:ve.token_a)==null?void 0:he.symbol:(ye=(ge=e.positionInfo)==null?void 0:ge.token_b)==null?void 0:ye.symbol),1),o("div",null,"$"+r(("addCommom"in e?e.addCommom:C(R))((E=e.positionInfo)==null?void 0:E.poolCoinBUSD)),1)])])]),e.isShowModal?(a(),x(S,{key:0,"position-info":e.positionInfo,onOnClose:t[1]||(t[1]=be=>e.isShowModal=!1)},null,8,["position-info"])):U("",!0)])}const xo=Ee(gs,[["render",qs],["__scopeId","data-v-ad8a33e9"]]),Bs=Xe({setup(){const e=oo(),t=g(()=>e),V=Je(),W=g(()=>V),B=eo(),A=_();Se(()=>[W.value.positionInfoObj,B.params.id],([s,D])=>{console.log(s,"##positionInfoObj"),s&&!xe(s)&&D&&(A.value=s[D],console.log(A.value,"##positionInfo.value"))},{immediate:!0,deep:!0});const u=g(()=>{var s;return(s=A.value)==null?void 0:s.needReverse}),S=s=>{var D;return console.log(s,"info##"),(s==null?void 0:s.logoURI)||(s==null?void 0:s.logo_url)||((D=t.value.tokensObj[s==null?void 0:s.address])==null?void 0:D.logo_url)||ro("/image/coins/sui-unknown.png")},h=No(),d=g(()=>h);return{needReverse:u,positionInfo:A,getCoinIcon:S,addCommom:R,wallet:d}}});const mo=e=>(Ge("data-v-c9de826f"),e=e(),He(),e),Ds={class:"my-liquidity"},Fs={class:"my-liquidity-top"},Ms=mo(()=>o("div",null,"My Liquidity",-1)),Os=mo(()=>o("p",null,"My share of pool",-1)),Ls={class:"my-liquidity-bottom"},Us={class:"lp-token"},Vs=mo(()=>o("div",null,[o("span",null,"LP Token Balance ")],-1)),js={class:"lp-balance"},Es={class:"token-num-content"},Ws={class:"token-num token-a-num"},Xs={class:"logo"},Gs=["src"],Hs={class:"text"},Ys={class:"lp-logo"},zs=["src"],Js=mo(()=>o("div",null,"Pooled Assets",-1)),Ks={class:"token-num"},Zs={class:"logo"},Qs=["src"],xs={class:"text"},ei=mo(()=>o("div",{class:"token-num-content-bg"},null,-1));function oi(e,t,V,W,B,A){var S,h,d,s,D,M,n,c,v,m,k,p,q,N,L,H,Y,J,b,y,j,z,P,F,G,oe,ge,ye;const u=bo;return a(),f("div",Ds,[o("div",Fs,[Ms,o("div",null,[Os,o("p",null,r(e.wallet.connected?(S=e.positionInfo)==null?void 0:S.myShare:"--")+"%",1)])]),o("div",Ls,[o("div",Us,[Vs,o("div",null,[o("span",js,r(e.wallet.connected?("addCommom"in e?e.addCommom:C(R))((h=e.positionInfo)==null?void 0:h.myLiquidity):"--")+" LP",1),o("span",null,"$"+r(e.wallet.connected?("addCommom"in e?e.addCommom:C(R))((d=e.positionInfo)==null?void 0:d.myLiquidityUSD):"--"),1)])]),o("div",Es,[o("div",Ws,[o("div",Xs,[o("img",{src:e.needReverse?e.getCoinIcon((D=e.positionInfo)==null?void 0:D.token_b):e.getCoinIcon((s=e.positionInfo)==null?void 0:s.token_a),alt:""},null,8,Gs),X(u,{address:e.needReverse?(v=(c=e.positionInfo)==null?void 0:c.token_b)==null?void 0:v.address:(n=(M=e.positionInfo)==null?void 0:M.token_a)==null?void 0:n.address,"style-params":{width:"14px",height:"14px",left:"18px",bottom:"0"}},null,8,["address"])]),o("div",Hs,[o("div",null,r(e.wallet.connected?("addCommom"in e?e.addCommom:C(R))((m=e.positionInfo)==null?void 0:m.amountA):"--")+" "+r(e.needReverse?(N=(q=e.positionInfo)==null?void 0:q.token_b)==null?void 0:N.symbol:(p=(k=e.positionInfo)==null?void 0:k.token_a)==null?void 0:p.symbol),1),o("div",null,r(e.wallet.connected?("addCommom"in e?e.addCommom:C(R))((L=e.positionInfo)==null?void 0:L.myAmountAUSD):"--"),1)])]),o("div",Ys,[o("img",{src:e.getCoinIcon((H=e.positionInfo)==null?void 0:H.lpInfo),alt:""},null,8,zs),Js]),o("div",Ks,[o("div",Zs,[o("img",{src:e.needReverse?e.getCoinIcon((J=e.positionInfo)==null?void 0:J.token_a):e.getCoinIcon((Y=e.positionInfo)==null?void 0:Y.token_b),alt:""},null,8,Qs),X(u,{address:e.needReverse?(z=(j=e.positionInfo)==null?void 0:j.token_a)==null?void 0:z.address:(y=(b=e.positionInfo)==null?void 0:b.token_b)==null?void 0:y.address,"style-params":{width:"14px",height:"14px",right:"0",bottom:"0"}},null,8,["address"])]),o("div",xs,[o("div",null,r(e.wallet.connected?("addCommom"in e?e.addCommom:C(R))((P=e.positionInfo)==null?void 0:P.amountB):"--")+" "+r(e.needReverse?(ge=(oe=e.positionInfo)==null?void 0:oe.token_a)==null?void 0:ge.symbol:(G=(F=e.positionInfo)==null?void 0:F.token_b)==null?void 0:G.symbol),1),o("div",null,r(e.wallet.connected?("addCommom"in e?e.addCommom:C(R))((ye=e.positionInfo)==null?void 0:ye.myAmountBUSD):"--"),1)])]),ei])])])}const en=Ee(Bs,[["render",oi],["__scopeId","data-v-c9de826f"]]),ni=""+globalThis.__publicAssetsURL("image/icon-tips-error@2x.png");const ti={},on=e=>(Ge("data-v-fcbc716b"),e=e(),He(),e),si={class:"status"},ii=on(()=>o("img",{src:ni,alt:""},null,-1)),li=on(()=>o("span",null,"Rebalancing is in processing. New deposits and withdraws are paused and will be back in minutes. ",-1)),ai=[ii,li];function ui(e,t){return a(),f("div",si,ai)}const nn=Ee(ti,[["render",ui],["__scopeId","data-v-fcbc716b"]]),ri=Xe({components:{AutoPoolAddModal:Yo,AutoPoolV2PoolStatus:nn},setup(){const e=No(),t=_(!1),V=go(),W=g(()=>V),B=g(()=>W.value.chainName),A=g(()=>e),u=Je(),S=g(()=>u),h=oo(),d=g(()=>h),s=_(),D=eo(),M=_(!1),n=_(!1);Se(()=>[S.value.positionInfoObj,D.params.id],([w,O])=>{w&&!xe(w)&&O&&(s.value=w[O],console.log(s.value,"##positionInfo.value"))},{immediate:!0,deep:!0});const c=g(()=>{var w,O;return console.log((w=s.value)==null?void 0:w.needReverse,"##positionInfo.value?.needReverse"),(O=s.value)==null?void 0:O.needReverse}),v=_(),m=_(),k=_(),p=_(),q=_(!0),N=g(()=>A.value.assets&&v.value&&A.value.assets[v.value.address]?Oo(A.value.assets[v.value.address].balance,v.value.decimals):0),L=g(()=>A.value.assets&&m.value&&A.value.assets[m.value.address]?Oo(A.value.assets[m.value.address].balance,m.value.decimals):0),H=w=>{w==="fromCoin"?(q.value=!0,k.value=N.value>0?v.value.symbol=="SUI"?new l(Number(N.value)).sub(new l(.05)).lt(new l(0))?"0":new l(Number(N.value)).sub(new l(.05)).toString():String(N.value):""):(q.value=!1,p.value=L.value>0?m.value.symbol=="SUI"?new l(Number(L.value)).sub(new l(.05)).lt(new l(0))?"0":new l(Number(L.value)).sub(new l(.05)).toString():String(L.value):"")},Y=w=>{w==="fromCoin"?(q.value=!0,k.value=N.value>0?T(new l(Number(N.value)).div(2).toString(),v.value.decimals).toString():""):(q.value=!1,p.value=L.value>0?T(new l(Number(L.value)).div(2).toString(),m.value.decimals).toString():"")},J=g(()=>B.value?Wo(B.value):{}),b=g(()=>S.value.slippage),y=_("--"),j=_("--"),z=w=>{const O=new l(s.value.autoPoolPositionInfo.liquidity),ne=new l(w.toString());if(O.toNumber()>0&&ne.toNumber()>0){const ie=ne.add(O);console.log("totalLiquidity:",ne.div(ie).mul(100).toString());const Z=ne.div(ie).mul(100).toNumber(),te=bn(Z),Ie=te==-1?2:te+2,de=T(ne.div(ie).mul(100).toNumber(),Ie);console.log(s.value.decimals,"##positionInfo.value.decimal");const ce=new l(1).div(new l(Math.pow(10,s.value.lpInfo.decimals))).toString();console.log(de,ce,"###288"),Number(de)<Number(ce)?y.value=`<${ce}`:y.value=de}else ne.toNumber()>0&&O.toNumber()<=0?y.value="100":y.value="--"},P=w=>{const O=new l(w.toString()),ne=new l(b.value).div(100),ie=O.mul(ne),Z=O.sub(ie),te=Ao.get_lp_amount_by_liquidity({liquidity:s.value.liquidity,total_supply:s.value.total_supply},Z),Ie=new l(Math.pow(10,s.value.lpInfo.decimals)),de=new l(te).div(Ie).toString();j.value=de},F=_(!1),G=_(!1),oe=_(""),ge=_(),ye=async()=>{if(!s.value)return;console.log(k.value,p.value,"####updateAmounts"),n.value=!1;const w=s.value.autoPoolPositionInfo.tick_lower_index,O=s.value.autoPoolPositionInfo.tick_upper_index,ne=Ve.sqrtPriceX64ToTickIndex(new re(s.value.current_sqrt_price));let ie=Ve.tickIndexToSqrtPriceX64(w),Z=Ve.tickIndexToSqrtPriceX64(O);ne<w&&(c.value?F.value=!0:G.value=!0),ne>O&&(c.value?G.value=!0:F.value=!0);let te;if(console.log(k.value||p.value,"#fromCoinAmount.value || toCoinAmount.value"),k.value||p.value){q.value?te=new l(k.value).mul(Math.pow(10,v.value.decimals)).toString():te=new l(p.value).mul(Math.pow(10,m.value.decimals)).toString();let Ie,de=q.value;if(console.log("执行##"),ue.value||Pe.value){console.log(c.value?q.value:!q.value,"#needReverse.value?fixedFromCoin.value:!fixedFromCoin.value"),console.log("1106###needReverse.value####",c.value),console.log("1106###calculateDepositSwapAmount###params###",{lowerTick:w,upperTick:O,curSqrtPrice:new re(s.value.current_sqrt_price),fix_amount_a:de,input_amount:te,coinTypeA:s.value.autoPoolPositionInfo.coin_type_a,coinTypeB:s.value.autoPoolPositionInfo.coin_type_b,clmm_pool:s.value.address,slippage:Number(b.value)/100,decimals:ue.value?v.value.decimals:m.value.decimals});const $=await Re.calculateDepositSwapAmount({lowerTick:w,upperTick:O,curSqrtPrice:new re(s.value.current_sqrt_price),fix_amount_a:de,input_amount:te,coinTypeA:s.value.autoPoolPositionInfo.coin_type_a,coinTypeB:s.value.autoPoolPositionInfo.coin_type_b,clmm_pool:s.value.address,slippage:Number(b.value)/100,decimals:ue.value?v.value.decimals:m.value.decimals});if(console.log($,"###swapResult"),console.log("1106###calculateDepositSwapAmount###result###",$),$){M.value=$.is_exceed,Ie=new re($.afterSqrtPrice),te=$.fixAmountA===de?new re(new l(te).sub($.swapInAmount).toString()):new re($.swapOutAmount),ge.value={swap_amount:$.swapInAmount,route_obj:$.route_obj,a2b:de},de=$.fixAmountA;const _e=s.value.token_a.decimals,Q=s.value.token_b.decimals;wo.value=Ve.sqrtPriceX64ToPrice($.afterSqrtPrice,_e,Q).toString(),console.log(wo.value,"##afterCurrentPrice.value");const ee=new l($.swapInAmount).div(new l(Math.pow(10,_e))).toString(),pe=new l($.swapOutAmountLimit).div(new l(Math.pow(10,Q))).toString(),le=c.value?s.value.token_b.symbol:s.value.token_a.symbol,fe=c.value?s.value.token_a.symbol:s.value.token_b.symbol;oe.value=`To deposit ${R(ue.value?k.value:p.value)} ${ue.value?le:fe},
          ${R(ee)} ${ue.value?le:fe}  will be traded for ${R(pe)} ${ue.value?fe:le} added to the pool.`}else n.value=!0}else M.value=!1,Ie=s.value.current_sqrt_price,te=new re(te),wo.value="",oe.value="";console.log(ge,"##swapParams");let ce,Ue,i;if(ne>=w&&ne<=O){const $=J.value.estLiquidityAndcoinAmountFromOneAmounts({tokenA:v.value,tokenB:m.value,lowerTick:w,upperTick:O,coinAmount:te,iscoinA:de,roundUp:!0,slippage:Number(b.value)/100,curSqrtPrice:new re(Ie)});ce=$.liquidityAmount,Ue=$.tokenMaxA,i=$.tokenMaxB,!ue.value&&!Pe.value&&(q.value?p.value=Number(i)>0?i:"":k.value=Number(Ue)>0?Ue:"")}else ne<O?ce={liquidityAmount:fn(ie,Z,te),tokenMaxA:0,tokenMaxB:p.value}.liquidityAmount:ce={liquidityAmount:yn(ie,Z,te),tokenMaxA:k.value,tokenMaxB:0}.liquidityAmount;console.log(ce.toString(),"liquidityAmount###"),z(ce),P(ce)}};Se(()=>s.value,w=>{w&&!xe(w)&&(v.value=w==null?void 0:w.token_a,m.value=w==null?void 0:w.token_b,F.value=!1,G.value=!1,ye())},{immediate:!0});const ve=g(()=>d.value.RATES),he=g(()=>{var w,O,ne,ie,Z,te,Ie,de,ce,Ue;if((O=ve.value[(w=v.value)==null?void 0:w.address])!=null&&O.price&&((ie=ve.value[(ne=m.value)==null?void 0:ne.address])!=null&&ie.price)){console.log((te=ve.value[(Z=v.value)==null?void 0:Z.address])==null?void 0:te.price,"RATES.value[fromCoin.value?.address]?.price");const i=new l(k.value||0).mul(new l((de=ve.value[(Ie=v.value)==null?void 0:Ie.address])==null?void 0:de.price)),$=new l(p.value||0).mul(new l((Ue=ve.value[(ce=m.value)==null?void 0:ce.address])==null?void 0:Ue.price));return We(i.add($).toString(),2)}else return"--"});Se(()=>k.value,(w,O)=>{console.log(w,"##newVal"),w?ye():(y.value="--",p.value="",j.value="--")},{immediate:!0}),Se(()=>p.value,(w,O)=>{w?ye():(k.value="",y.value="--",j.value="--")},{immediate:!0});const{t:E,locale:be}=Po(),me=g(()=>{var w,O;if(ue.value||Pe.value){const ne=ue.value?k.value:p.value,ie=ue.value?v.value:m.value;if((w=ve.value[ie==null?void 0:ie.address])!=null&&w.price)return new l(ne||0).mul(new l((O=ve.value[ie==null?void 0:ie.address])==null?void 0:O.price)).toNumber()}return 0}),I=g(()=>{const w=Number(k.value)>Number(N.value),O=Number(p.value)>Number(L.value);return!k.value&&!p.value?E("button.enterAmount"):w?E("button.insufficientBalance",{name:v.value.symbol}):O?E("button.insufficientBalance",{name:m.value.symbol}):M.value?E("button.insufficientLiquidity"):Number(s.value.remainingTokenUSD)!==0&&Number(he.value)>Number(s.value.remainingTokenUSD)?"Exceeded the max capacity":n.value?E("button.enterAmount"):(console.log(me.value),"Add Liquidity")}),K=g(()=>{const w=Number(k.value)>Number(N.value),O=Number(p.value)>Number(L.value);return!!(!k.value&&!p.value||w||O||k.value<=0&&p.value<=0||M.value||no.value!=="STATUS_RUNNING"||(console.log(he.value,s.value.quoteUSD,"positionInfo.value.quoteUSD#"),Number(s.value.remainingTokenUSD)!==0&&Number(he.value)>Number(s.value.remainingTokenUSD))||n.value||me.value>1e4)}),Te=_(!0),{setIsShowSuccess:ke,setIsShowRejected:Be,setIsShowWaiting:Ae,setTransactionDesc:De,setTransactionTxid:we,setPositiomNum:Me}=V,Re=Eo("Sui"),vo=async()=>{var ce,Ue;t.value=!1,Te.value=!0,we("");const w=`${R(k.value)} ${(ce=v.value)==null?void 0:ce.symbol}`,O=`${R(p.value)} ${(Ue=m.value)==null?void 0:Ue.symbol}`;De(`Deposit ${k.value>0?w:""} ${p.value>0&&k.value>0?"and":""} ${p.value>0?O:""}`),Ae(!0);const ne=q.value,ie=s.value.autoPoolPositionInfo.tick_lower_index,Z=s.value.autoPoolPositionInfo.tick_upper_index,te=Ve.sqrtPriceX64ToTickIndex(new re(s.value.current_sqrt_price));let Ie;q.value?Ie=new l(k.value).mul(Math.pow(10,v.value.decimals)).toString():Ie=new l(p.value).mul(Math.pow(10,m.value.decimals)).toString();const de=s.value.rewarderInfo.map(i=>i.coinAddress);console.log("1109###deposit###positionInfo###",s);try{const i={lowerTick:ie,upperTick:Z,coinAmount:Ie,fix_amount_a:ne,slippage:Number(b.value)/100,curSqrtPrice:new re(s.value.current_sqrt_price),id:s.value.id,clmm_pool:s.value.autoPoolPositionInfo.pool,lp_token_type:s.value.lp_token_type,coinTypeA:s.value.autoPoolPositionInfo.coin_type_a,coinTypeB:s.value.autoPoolPositionInfo.coin_type_b,rewarder_coin_types:de,swapParams:ge.value,isOnlyA:ue.value,isOnlyB:Pe.value,currentTickIndex:te,decimal_b:s.value.coinB.decimals};console.log("1106###deposit###params###",i);const $=await Re.deposit(i);console.log($,"===>payloadAdd11111");const _e=await A.value.currentWallet.signAndExecuteTransactionBlock($);let Q=J.value.handleTx(_e);if(console.log("toAdd###tx###",Q),Q&&Q.hash){we(Q.hash),Ae(!1),ke(!0),console.log(s,"===>positionInfo");const ee={title:"Supplied",desc:`Deposit ${k.value>0?w:""} ${p.value>0&&k.value>0?"and":""} ${p.value>0?O:""}`,hash:Q.hash,tit:"Liquidity Increased",icon:"icon-icon-Increased",text:`Deposit ${k.value>0?w:""} ${p.value>0&&k.value>0?"and":""} ${p.value>0?O:""}`};B.value!=="Aptos"&&(ee.res=Q.res),J.value.showTransitionPending(ee),await J.value.watchTransaction(ee)&&setTimeout(()=>{u.updatePositionItem(s.value.id),J.value.getAccount(A.value.address)},1e3),Me()}else Ae(!1),Be(!0);k.value="",p.value="",Te.value=!1}catch(i){k.value="",p.value="",console.log("addError###",i),Te.value=!1,Ae(!1),Be(!0)}},ue=_(!1),Pe=_(!1),Ne=w=>{k.value="",p.value="",oe.value="",w=="only-a"?(ue.value=!ue.value,Pe.value=!1):(Pe.value=!Pe.value,ue.value=!1)},no=g(()=>S.value.currentAutoPoolStatus),po=_(),ko=()=>{po.value=window.setInterval(()=>{(k.value||p.value)&&ye()},2e4)};return fo(()=>{ko()}),yo(()=>{window.clearInterval(po.value)}),{currentAutoPoolStatus:no,wallet:A,positionInfo:s,isShowAddModal:t,needReverse:c,fromCoin:v,toCoin:m,fromCoinAmount:k,toCoinAmount:p,fromCoinBlance:N,toCoinBlance:L,fixedFromCoin:q,maxBtnSelect:H,halfBtnSelect:Y,totalAmountUSD:he,addCommom:R,shareOfPool:y,minimumReceivedLP:j,addLiquidityBtnText:I,addLiquidityBtnDisabled:K,toAdd:vo,showToCoinLock:G,showFromCoinLock:F,isOnlyA:ue,isOnlyB:Pe,onlyToken:Ne,onlyText:oe,onlyTokenUSD:me}}});const Ke=e=>(Ge("data-v-00ca7691"),e=e(),He(),e),di={class:"auto-pool-add"},vi={class:"auto-pool-add-content"},mi={class:"liquidity-action-tab"},ci=Ke(()=>o("div",{class:"increase tab-active"},"Add",-1)),pi={class:"only-token"},fi=Ke(()=>o("div",null,"Deposit Amounts",-1)),yi={key:0},bi=Ke(()=>o("div",{class:"hover-text"},"You can also choose to deposit in only one asset type. In that case, the vault will convert your asset to the required propositions using Cetus. Please note that trading fees & slippage will be applied. When slippage is involved, a certain amount of post-swap dust (no loss of funds) will be returned to you.",-1)),gi={key:0},hi=Ke(()=>o("div",{class:"hover-text"},"You can also choose to deposit in only one asset type. In that case, the vault will convert your asset to the required propositions using Cetus. Please note that trading fees & slippage will be applied. When slippage is involved, a certain amount of post-swap dust (no loss of funds) will be returned to you.",-1)),ki={key:0,class:"card-item"},_i={key:1,class:"card-item"},$i=Ke(()=>o("span",null,"Pool Closed",-1)),wi={key:0,class:"add-info"},Ii={key:0,class:"only-text"},Ci={class:"total-amount"},Ai=Ke(()=>o("span",null,"Total Amount",-1)),Pi={class:"total-amount"},Si=Ke(()=>o("span",null,"Share of Pool",-1)),Ti={key:0},Ri={key:1},Ni={class:"total-amount"},qi=Ke(()=>o("span",null,"Minimum Received LP",-1)),Bi={key:0},Di={key:1},Fi={key:1,class:"add-info only-add-info"},Mi=Ke(()=>o("div",{class:"only-text"},"Single-asset deposit can't be higher than $10,000 at a time.",-1)),Oi=[Mi];function Li(e,t,V,W,B,A){var D,M,n,c,v,m,k,p,q,N,L,H,Y,J,b,y,j,z,P;const u=Go,S=Ho,h=io("AutoPoolV2PoolStatus"),d=So,s=Yo;return a(),f("div",di,[o("div",vi,[o("div",mi,[ci,o("div",{class:"remove",onClick:t[0]||(t[0]=jo(F=>e.$emit("changeCurrentTab"),["stop"]))},"Remove")]),o("div",pi,[fi,o("div",null,[o("div",{class:"only-a",onClick:t[1]||(t[1]=F=>e.onlyToken("only-a"))},[o("p",null,[e.isOnlyA?(a(),f("span",yi)):U("",!0)]),o("span",null,r(e.needReverse?(c=(n=e.positionInfo)==null?void 0:n.token_b)==null?void 0:c.symbol:(M=(D=e.positionInfo)==null?void 0:D.token_a)==null?void 0:M.symbol)+" only",1),bi]),o("div",{class:"only-b",onClick:t[2]||(t[2]=F=>e.onlyToken("only-b"))},[o("p",null,[e.isOnlyB?(a(),f("span",gi)):U("",!0)]),o("span",null,r(e.needReverse?(p=(k=e.positionInfo)==null?void 0:k.token_a)==null?void 0:p.symbol:(m=(v=e.positionInfo)==null?void 0:v.token_b)==null?void 0:m.symbol)+" only",1),hi])])]),o("div",{class:Le(e.needReverse?"card-container reverse":"card-container")},[(e.needReverse?!e.isOnlyA:!e.isOnlyB)?(a(),f("div",ki,[X(u,{modelValue:e.fromCoinAmount,"onUpdate:modelValue":t[3]||(t[3]=F=>e.fromCoinAmount=F),"input-value":e.fromCoinAmount,"coin-symbol":e.fromCoin?e.fromCoin.symbol:null,"coin-name":e.fromCoin?e.fromCoin.name:null,balance:e.fromCoinBlance,"coin-icon":e.fromCoin?e.fromCoin.logoURI:"",address:e.fromCoin?e.fromCoin.address:"","swap-direct":"From","import-page":"deposit","has-arrow":!1,onOnMax:t[4]||(t[4]=F=>e.maxBtnSelect("fromCoin")),onOnHalf:t[5]||(t[5]=F=>e.halfBtnSelect("fromCoin")),onOnInput:t[6]||(t[6]=F=>{e.fromCoinAmount=F}),onOnFocus:t[7]||(t[7]=()=>{e.fixedFromCoin=!0})},null,8,["modelValue","input-value","coin-symbol","coin-name","balance","coin-icon","address"]),e.showFromCoinLock&&!e.isOnlyA?(a(),x(S,{key:0})):U("",!0)])):U("",!0),(e.needReverse?!e.isOnlyB:!e.isOnlyA)?(a(),f("div",_i,[X(u,{modelValue:e.toCoinAmount,"onUpdate:modelValue":t[8]||(t[8]=F=>e.toCoinAmount=F),"input-value":e.toCoinAmount,"coin-symbol":e.toCoin?e.toCoin.symbol:null,"coin-name":e.toCoin?e.toCoin.name:null,balance:e.toCoinBlance,"swap-direct":"To","coin-icon":e.toCoin?e.toCoin.logoURI:"",address:e.toCoin?e.toCoin.address:"","import-page":"deposit","has-arrow":!1,onOnMax:t[9]||(t[9]=F=>e.maxBtnSelect("toCoin")),onOnHalf:t[10]||(t[10]=F=>e.halfBtnSelect("toCoin")),onOnInput:t[11]||(t[11]=F=>{e.toCoinAmount=F}),onOnFocus:t[12]||(t[12]=()=>{e.fixedFromCoin=!1})},null,8,["modelValue","input-value","coin-symbol","coin-name","balance","coin-icon","address"]),e.showToCoinLock&&!e.isOnlyB?(a(),x(S,{key:0})):U("",!0)])):U("",!0)],2)]),e.currentAutoPoolStatus=="STATUS_REBALANCING"?(a(),x(h,{key:0})):U("",!0),(q=e.positionInfo)!=null&&q.is_pause?(a(),x(d,{key:1,class:"big-btn liquidity-btn",disabled:!0},{default:$e(()=>[$i]),_:1})):e.wallet.connected?(a(),x(d,{key:2,class:"big-btn liquidity-btn",disabled:e.addLiquidityBtnDisabled,onClick:t[13]||(t[13]=F=>e.isShowAddModal=!0)},{default:$e(()=>[o("span",null,r(e.addLiquidityBtnText),1)]),_:1},8,["disabled"])):(a(),x(d,{key:3,class:"big-btn liquidity-btn",onClick:t[14]||(t[14]=F=>e.wallet.setIsShowWalletModal(!0))},{default:$e(()=>[o("span",null,r(e.$t("button.connectWallet")),1)]),_:1})),Number((N=e.positionInfo)==null?void 0:N.remainingTokenUSD)!==0&&Number(e.totalAmountUSD)>Number((L=e.positionInfo)==null?void 0:L.remainingTokenUSD)?U("",!0):(a(),f(so,{key:4},[e.onlyTokenUSD<=1e4?(a(),f("div",wi,[e.onlyText&&(e.isOnlyA&&e.fromCoinAmount>0||e.isOnlyB&&e.toCoinAmount>0)?(a(),f("div",Ii,r(e.onlyText),1)):U("",!0),o("div",Ci,[Ai,o("span",null,"$"+r(("addCommom"in e?e.addCommom:C(R))(e.totalAmountUSD)),1)]),o("div",Pi,[Si,e.fromCoinAmount&&e.toCoinAmount||e.isOnlyA&&e.fromCoinAmount||e.isOnlyB&&e.toCoinAmount?(a(),f("span",Ti,r(e.shareOfPool)+"%",1)):(a(),f("span",Ri,"--%"))]),o("div",Ni,[qi,e.fromCoinAmount&&e.toCoinAmount||e.isOnlyA&&e.fromCoinAmount||e.isOnlyB&&e.toCoinAmount?(a(),f("span",Bi,r(("addCommom"in e?e.addCommom:C(R))(e.minimumReceivedLP))+" "+r(e.needReverse?(H=e.toCoin)==null?void 0:H.symbol:(Y=e.fromCoin)==null?void 0:Y.symbol)+"-"+r(e.needReverse?(J=e.fromCoin)==null?void 0:J.symbol:(b=e.toCoin)==null?void 0:b.symbol),1)):(a(),f("span",Di,"--"+r(e.needReverse?(y=e.toCoin)==null?void 0:y.symbol:(j=e.fromCoin)==null?void 0:j.symbol)+"-"+r(e.needReverse?(z=e.fromCoin)==null?void 0:z.symbol:(P=e.toCoin)==null?void 0:P.symbol),1))])])):(a(),f("div",Fi,Oi))],64)),e.isShowAddModal?(a(),x(s,{key:5,"pool-info":e.positionInfo,"from-coin":e.needReverse?e.positionInfo.token_b:e.positionInfo.token_a,"to-coin":e.needReverse?e.positionInfo.token_a:e.positionInfo.token_b,"from-coin-amount":e.needReverse?e.toCoinAmount:e.fromCoinAmount,"to-coin-amount":e.needReverse?e.fromCoinAmount:e.toCoinAmount,"total-amount":e.totalAmountUSD,"share-of-pool":e.shareOfPool,"minimum-received-l-p":e.minimumReceivedLP,"is-only-a":e.isOnlyA,"is-only-b":e.isOnlyB,onOnClose:t[15]||(t[15]=F=>e.isShowAddModal=!1),onToAdd:e.toAdd},null,8,["pool-info","from-coin","to-coin","from-coin-amount","to-coin-amount","total-amount","share-of-pool","minimum-received-l-p","is-only-a","is-only-b","onToAdd"])):U("",!0)])}const Ui=Ee(ri,[["render",Li],["__scopeId","data-v-00ca7691"]]),Vi=Xe({components:{AutoPoolRemoveModal:zo,AutoPoolV2PoolStatus:nn},setup(){const e=No(),t=g(()=>e),V=go(),W=g(()=>V),B=g(()=>M.value.slippage),A=g(()=>W.value.chainName),u=gn(),S=g(()=>u),h=[{name:"25%",value:25},{name:"50%",value:50},{name:"75%",value:75},{name:"MAX",value:100}],d=_(25),s=eo(),D=Je(),M=g(()=>D),n=g(()=>(console.log(M.value.positionInfoObj[s.params.id],"autoPool.value.positionInfoObj[route.params.id]###"),M.value.positionInfoObj[s.params.id])),c=g(()=>{var i;return(i=n.value)==null?void 0:i.needReverse}),v=_(),m=_(),k=_(!1),p=_(),q=g(()=>{var i;return(i=n.value)==null?void 0:i.myLiquidity}),N=_(!0),L=g(()=>A.value?Wo(A.value):{}),H=_(),Y=_(),J=Eo("Sui"),b=_(""),y=_(""),j=_("--"),z=_(!1),P=_(!1),F=_(),G=_(!0),oe=_(),ge=oo(),ye=g(()=>ge),ve=g(()=>ye.value.RATES),he=async()=>{if(N.value||!n.value)return;Y.value=!1;const i=n.value.autoPoolPositionInfo.tick_lower_index,$=n.value.autoPoolPositionInfo.tick_upper_index,_e=Ve.sqrtPriceX64ToTickIndex(new re(n.value.current_sqrt_price));_e<i&&(c.value?z.value=!0:P.value=!0),_e>$&&(c.value?P.value=!0:z.value=!0);let Q;if(console.log(b.value||y.value,"#fromCoinAmount.value || toCoinAmount.value"),b.value||y.value){G.value?Q=new l(b.value).mul(Math.pow(10,v.value.decimals)).toString():Q=new l(y.value).mul(Math.pow(10,m.value.decimals)).toString();let ee,pe=G.value;if(I.value||K.value){const se=await J.calculateRemoveSwapAmount({lowerTick:i,upperTick:$,curSqrtPrice:new re(n.value.current_sqrt_price),fix_amount_a:pe,receiveAmount:Q,coinTypeA:n.value.autoPoolPositionInfo.coin_type_a,coinTypeB:n.value.autoPoolPositionInfo.coin_type_b,clmm_pool:n.value.address,slippage:0,decimals:I.value?v.value.decimals:m.value.decimals});if(console.log(se,"###swapResult"),se){H.value=se.is_exceed,Q=new re(se.swapOutAmount),ee=n.value.current_sqrt_price,F.value={swap_amount:se.swapInAmount,liquidity:se.liquidity,a2b:!pe,route_obj:se.route_obj},pe=!pe;const ze=n.value.token_a.decimals,to=n.value.token_b.decimals,qe=new l(se.swapInAmount).div(new l(Math.pow(10,ze))).toString(),lo=new l(se.swapOutAmountLimit).div(new l(Math.pow(10,to))).toString(),Ce=c.value?n.value.token_b.symbol:n.value.token_a.symbol,Fe=c.value?n.value.token_a.symbol:n.value.token_b.symbol;oe.value=b.value==Z.value||y.value==Z.value?`To withdraw ${R(I.value?b.value:y.value)} ${I.value?Ce:Fe},
          ${R(I.value?n.value.amountB:n.value.amountA)} ${I.value?Fe:Ce} 
           in the pool will be traded for ${qe} ${I.value?Ce:Fe}`:`To withdraw ${R(I.value?b.value:y.value)} ${I.value?Ce:Fe},
          ${R(qe)} ${I.value?Fe:Ce}  in the pool will be traded for ${R(lo)} ${I.value?Ce:Fe}`}else{Y.value=!0,oe.value="";return}}else H.value=!1,ee=n.value.current_sqrt_price,Q=new re(Q);console.log(ee,"##curSqrtPrice"),console.log("执行了吗##");const{liquidityAmount:le,tokenMaxA:fe,tokenMaxB:ae}=L.value.estLiquidityAndcoinAmountFromOneAmounts({tokenA:v.value,tokenB:m.value,lowerTick:i,upperTick:$,coinAmount:Q,iscoinA:pe,roundUp:!1,slippage:Number(B.value)/100,curSqrtPrice:new re(ee)});if(console.log(n.value.current_sqrt_price,"##positionInfo.value.current_sqrt_price"),console.log(ae.toString(),fe.toString(),n.value,"###323"),!I.value&&!K.value&&(G.value?y.value=Number(ae)>0?ae:"":b.value=Number(fe)>0?fe:""),(I.value||K.value)&&(b.value>=Z.value||y.value>=Z.value)){p.value=n.value.myLiquidity;const se=new l(100);j.value=new l(n.value.myLiquidity).mul(new l(Math.pow(10,n.value.lpInfo.decimals))).toString(),E.value=le.toString(),d.value=se.toNumber()}else{const se=Ao.get_lp_amount_by_liquidity({liquidity:n.value.liquidity,total_supply:n.value.total_supply},le.toString());p.value=new l(se).div(new l(Math.pow(10,n.value.lpInfo.decimals))).toString();const ze=new l(p.value).div(new l(q.value)).mul(100);console.log(p.value,q.value,"####lpBalance.value"),j.value=se,E.value=le.toString(),d.value=ze.toNumber()}}},E=_(),be=g(()=>{var i;return(i=n==null?void 0:n.value)==null?void 0:i.amountA}),me=g(()=>{var i;return(i=n==null?void 0:n.value)==null?void 0:i.amountB}),I=_(!1),K=_(!1),Te=g(()=>{var pe,le,fe,ae;const i=(le=ve.value[(pe=v==null?void 0:v.value)==null?void 0:pe.address])==null?void 0:le.price,$=(ae=ve.value[(fe=m==null?void 0:m.value)==null?void 0:fe.address])==null?void 0:ae.price;console.log(i,$,b.value,y.value,"####totalWithdraw");let _e=b.value!=="--"&&b.value!==""?b.value:0,Q=y.value!=="--"&&y.value!==""?y.value:0,ee;return i&&$&&(I.value||K.value?ee=new l(I.value?_e:Q).mul(new l(I.value?i:$)).toString():(ee=new l(_e).mul(new l(i)).add(new l(Q).mul(new l($))).toString(),console.log(ee,"result##"))),ee>0&&ee<.01?"<$0.01":`$${R(T(ee,2))}`}),ke=async i=>{var ze,to,qe,lo,Ce,Fe,_o,Bo,Do,Fo;if(!N.value)return;N.value=!0,Y.value=!1,(to=(ze=n.value)==null?void 0:ze.token_a)==null||to.decimals,(lo=(qe=n.value)==null?void 0:qe.token_b)==null||lo.decimals;const $=(Ce=n.value)==null?void 0:Ce.tick_lower_index,_e=(Fe=n.value)==null?void 0:Fe.tick_upper_index;Ve.tickIndexToSqrtPriceX64($),Ve.tickIndexToSqrtPriceX64(_e);const Q=(Bo=(_o=n.value)==null?void 0:_o.autoPoolPositionInfo)==null?void 0:Bo.tick_lower_index,ee=(Fo=(Do=n.value)==null?void 0:Do.autoPoolPositionInfo)==null?void 0:Fo.tick_upper_index,pe=Ve.sqrtPriceX64ToTickIndex(new re(n.value.current_sqrt_price));pe<Q&&(c.value?z.value=!0:P.value=!0),pe>ee&&(c.value?P.value=!0:z.value=!0);let le="",fe,ae;console.log(i.value,"##item.value"),console.log(ae,"##coinAmount");let se=G.value;if(console.log("执行##"),I.value||K.value&&!z.value&&!P.value){if(I.value){const Ze=new l(Z.value).mul(Math.pow(10,v.value.decimals)).mul(i.value).toString();console.log(Ze,"##amount"),ae=T(Ze,0),b.value=T(new l(Z.value).mul(i.value).toString(),v.value.decimals)}if(K.value){const Ze=new l(Z.value).mul(i.value).mul(Math.pow(10,m.value.decimals)).toString();ae=T(Ze,0),y.value=T(new l(Z.value).mul(i.value).toString(),m.value.decimals)}console.log(b.value,"##fromCoinAmount.value");const Oe=await J.calculateRemoveSwapAmount({lowerTick:$,upperTick:_e,curSqrtPrice:new re(n.value.current_sqrt_price),fix_amount_a:se,receiveAmount:ae,coinTypeA:n.value.autoPoolPositionInfo.coin_type_a,coinTypeB:n.value.autoPoolPositionInfo.coin_type_b,clmm_pool:n.value.address,slippage:0,decimals:I.value?v.value.decimals:m.value.decimals});if(console.log(Oe,"###swapResult536"),Oe){H.value=Oe.is_exceed,ae=new re(Oe.swapOutAmount),n.value.current_sqrt_price,F.value={swap_amount:Oe.swapInAmount,liquidity:Oe.liquidity,route_obj:Oe.route_obj,a2b:!se},se=!se;const Ze=n.value.token_a.decimals,tn=n.value.token_b.decimals,sn=new l(Oe.swapInAmount).div(new l(Math.pow(10,Ze))).toString(),Mo=new l(Oe.swapOutAmountLimit).div(new l(Math.pow(10,tn))).toString(),ao=c.value?n.value.token_b.symbol:n.value.token_a.symbol,uo=c.value?n.value.token_a.symbol:n.value.token_b.symbol;oe.value=i.value==1?`To withdraw ${R(I.value?b.value:y.value)} ${I.value?ao:uo},
          ${R(I.value?n.value.amountB:n.value.amountA)} ${I.value?uo:ao}  in the pool will be traded for ${R(Mo)} ${I.value?ao:uo}`:`To withdraw ${R(I.value?b.value:y.value)} ${I.value?ao:uo},
          ${R(sn)} ${I.value?uo:ao}  in the pool will be traded for ${R(Mo)} ${I.value?ao:uo}`,le=Oe.liquidity}else n.value.current_sqrt_price,ae=new re(ae),oe.value="",Y.value=!0;console.log(fe,"result###"),j.value=new l(n.value.myLiquidity).mul(new l(i.value)).toString(),console.log(n.value,n.value.liquidity,le,j.value,"###positionInfo.value.liquidity"),console.log(j.value,"##lpTokenAmount.value"),p.value=new l(j.value),E.value=le}else{H.value=!1;const Oe=new l(be.value).mul(Math.pow(10,v.value.decimals)).mul(i.value).toString();ae=T(Oe,0),b.value=T(new l(be.value).mul(i.value).toString(),v.value.decimals);const Ze=new l(me.value).mul(i.value).mul(Math.pow(10,m.value.decimals)).toString();ae=T(Ze,0),y.value=T(new l(me.value).mul(i.value).toString(),m.value.decimals),n.value.current_sqrt_price,ae=new re(ae),i.value!==1?fe=new l(n.value.myLiquidity).mul(Math.pow(10,n.value.lpInfo.decimals)).mul(i.value).toString():fe=new l(n.value.myLiquidity).mul(Math.pow(10,n.value.lpInfo.decimals)).toString(),p.value=new l(fe).div(Math.pow(10,n.value.lpInfo.decimals)),le=Ao.get_share_liquidity_by_amount({liquidity:n.value.liquidity,total_supply:n.value.total_supply},fe),j.value=T(fe,0),E.value=T(le,0),console.log(le,"###newLiquidity525")}};Se(d,$o((i,$)=>{i!==$&&(Number(i)>100?d.value=100:i&&n.value?(console.log("687===>"),d.value=i,ke({value:d.value/100})):(b.value="",y.value=""))},300)),Se(()=>b.value,$o((i,$)=>{i?he():(y.value="",d.value=0)},500),{immediate:!0}),Se(()=>y.value,$o((i,$)=>{i?he():(b.value="",d.value=0)},500),{immediate:!0});const Be=To(),{setIsShowSuccess:Ae,setIsShowRejected:De,setIsShowWaiting:we,setTransactionDesc:Me,setTransactionTxid:Re,setPositiomNum:vo,setTransactionDescText:ue}=V,Pe=_(!1),{t:Ne}=Po(),no=async()=>{var ze,to;Pe.value=!0,Re("");const i=Number(b.value)>0?`${R(b.value,v.value.decimals)} ${v.value.symbol}`:"",$=Number(y.value)>0?`${R(y.value,m.value.decimals)} ${m.value.symbol}`:"";console.log(i,$,"###transactionDescTo"),Me(Ne("tips.removeLiquidiyText",{from:c.value?$:i,and:Number(b.value)>0&&Number(y.value)>0?"and":"",to:c.value?i:$})),we(!0);const _e=Ne("modal.removeLiquidityText2");ue(_e);const Q=n.value.autoPoolPositionInfo.tick_lower_index,ee=n.value.autoPoolPositionInfo.tick_upper_index,pe=Ve.tickIndexToSqrtPriceX64(Q),le=Ve.tickIndexToSqrtPriceX64(ee),fe=n.value.rewarderInfo.map(qe=>qe.coinAddress);console.log(j.value,"##lpTokenAmount.value431");let ae;G.value?ae=new l(b.value).mul(Math.pow(10,v.value.decimals)).toString():ae=new l(y.value).mul(Math.pow(10,m.value.decimals)).toString(),console.log();const se={lowerSqrtPrice:pe,upperSqrtPrice:le,lpTokenAmount:j.value,liquidity:E.value,curSqrtPrice:new re(n.value.object.current_sqrt_price),slippage:Number(B.value)/100,id:n.value.id,clmm_pool:n.value.autoPoolPositionInfo.pool,lp_token_type:n.value.lp_token_type,coinTypeA:n.value.autoPoolPositionInfo.coin_type_a,coinTypeB:n.value.autoPoolPositionInfo.coin_type_b,rewarder_coin_types:fe,swapParams:F.value,fix_amount_a:G.value,isOnlyA:!z.value&&!P.value?I.value:!1,isOnlyB:!P.value&&!z.value?K.value:!1,lowerTick:Q,upperTick:ee,receiveAmount:ae,sliderVal:d.value,positionInfo:n.value};try{const qe=await J.remove(se);console.log(qe,"移除流动性payload");const lo=await t.value.currentWallet.signAndExecuteTransactionBlock(qe);let Ce=L.value.handleTx(lo);if(console.log("0331###remove###tx####",Ce),Ce&&Ce.hash){Re(Ce.hash),we(!1),Ae(!0);const Fe={title:Ne("common.removeLiquidity"),desc:"",hash:Ce.hash,descTransactions:`Remove ${i} ${Number(b.value)>0&&Number(y.value)>0?"and":""} ${$} from the pool`,sender:t.value.address,chainName:"Sui",tit:"Liquidity Removed",icon:"icon-icon-Removed",text:`Withdraw ${b.value} ${(ze=v.value)==null?void 0:ze.symbol} and ${y.value} ${(to=m.value)==null?void 0:to.symbol}`};Fe.res=Ce.res,L.value.showTransitionPending(Fe),await L.value.watchTransaction(Fe)&&(b.value="",y.value="",p.value="",d.value=0,setTimeout(()=>{D.updatePositionItem(n.value.id),L.value.getAccount(t.value.address)},1e3),Number(d.value)==100&&s.name=="auto-pool-detail"&&Be.push("/pool/auto"))}else we(!1),De(!0);Pe.value=!1}catch(qe){console.log("Remove error",qe),Pe.value=!1,we(!1),De(!0)}};Se(()=>n.value,(i,$)=>{i&&!xe(i)&&(v.value=i==null?void 0:i.token_a,m.value=i==null?void 0:i.token_b,console.log("触发###"),(!$||$&&$.address!==i.address)&&(d.value=d.value>0?d.value:25,ke({value:d.value/100})))},{immediate:!0});const po=g(()=>{const i=Number(p.value)>Number(q.value);return!b.value&&!y.value||!p.value||p.value<=0||!b.value&&I.value||!y.value&&K.value?Ne("button.enterAmount"):i?"Invalid Amount":H.value?Ne("button.insufficientLiquidity"):Y.value?Ne("button.enterAmount"):(console.log(b.value,Z.value,y.value,"856##"),I.value&&Number(b.value)>Number(Z.value)||K.value&&Number(y.value)>Number(Z.value)?"Invalid Amount":Ne("button.remove"))}),ko=g(()=>{console.log(p.value.toString(),q.value,"###864");const i=Number(p.value)>Number(q.value);return!!(!b.value&&!y.value||Number(b.value)<=0&&I.value||Number(y.value)<=0&&K.value||!p.value||p.value<=0||i||H.value||de.value!=="STATUS_RUNNING"||Y.value||I.value&&Number(b.value)>Number(Z.value)||K.value&&Number(y.value)>Number(Z.value))}),w=i=>(i==null?void 0:i.logoURI)||(i==null?void 0:i.logo_url)||ro("/image/coins/sui-unknown.png"),O=i=>{b.value="",y.value="",N.value=!0,oe.value="",i=="only-a"?(I.value=!I.value,K.value=!1,G.value=!0):(K.value=!K.value,I.value=!1,G.value=!1)},ne=i=>{N.value=!0,d.value=100,i==="fromCoin"?G.value=!0:G.value=!1},ie=i=>{N.value=!0,d.value=50,i==="fromCoin"?G.value=!0:G.value=!1},Z=_(),te=async()=>{const i=n.value.token_a.decimals,$=n.value.token_b.decimals,_e=new l(be.value).mul(new l(Math.pow(10,i))).toString(),Q=new l(me.value).mul(new l(Math.pow(10,$))).toString(),ee=I.value?Q:_e;I.value?(m.value.address,n.value.token_a.address):(v.value.address,n.value.token_a.address);const pe=await S.value.swapRouterContract.getSwapRouter(v,m,ee.toString(),!0,Number(B.value)/100,"",""),le=new l(pe.amountOut);Z.value=le.sub(le.mul(Number(B.value)/100)).add(new l(I.value?be.value:me.value)).toString(),ke({value:d.value/100}),console.log(pe,"##swapRouter")};Se(()=>[I.value,K.value,be.value,me.value],([i,$])=>{i||$?te():ke({value:d.value/100})},{immediate:!0});const Ie=i=>`${i}%`,de=g(()=>M.value.currentAutoPoolStatus),ce=_(),Ue=()=>{ce.value=window.setInterval(()=>{(b.value||y.value)&&!N.value?he():ke({value:d.value/100})},2e4)};return fo(()=>{Ue()}),yo(()=>{window.clearInterval(ce.value)}),{removeLiquidityBtnText:po,removeLiquidityBtnDisabled:ko,wallet:t,ratioArr:h,positionInfo:n,isShowRemoveModal:k,needReverse:c,fromCoin:v,toCoin:m,lpAmount:p,lpBalance:q,sliderVal:d,sFixD:T,isSlider:N,fromCoinAmount:b,toCoinAmount:y,setPercent:ke,toRemove:no,addCommom:R,getCoinIcon:w,isOnlyA:I,isOnlyB:K,onlyToken:O,fixedFromCoin:G,maxBtnSelect:ne,halfBtnSelect:ie,fromCoinBlance:be,toCoinBlance:me,showFromCoinLock:z,showToCoinLock:P,removeText:oe,onlyTokenBalance:Z,totalWithdraw:Te,formatter:Ie,currentAutoPoolStatus:de}}});const co=e=>(Ge("data-v-5fc6ca80"),e=e(),He(),e),ji={class:"auto-pool-add"},Ei={class:"auto-pool-add-content"},Wi={class:"liquidity-action-tab"},Xi=co(()=>o("div",{class:"remove tab-active"},"Remove",-1)),Gi={key:0,class:"only-token"},Hi=co(()=>o("div",null,"Deposit Amounts",-1)),Yi={key:0},zi={key:0},Ji={key:0,class:"card-item"},Ki={key:1,class:"card-item"},Zi={class:"remove-ratio"},Qi={class:"remove-ratio-select"},xi={key:0,class:"ratio"},el={key:1,class:"ratio"},ol={class:"ratio-list"},nl=["onClick"],tl=co(()=>o("span",null,"Pool Closed",-1)),sl={key:4,class:"remove-info"},il={key:0,class:"remove-text total-amount"},ll={class:"total-amount"},al=co(()=>o("span",null,"Total Withdraw",-1)),ul={class:"total-amount"},rl=co(()=>o("span",null,"LP Burn Amount",-1)),dl={key:0},vl={key:1};function ml(e,t,V,W,B,A){var M,n,c,v,m,k,p,q,N,L,H,Y,J,b,y,j,z;const u=Go,S=Ho,h=Vo,d=io("AutoPoolV2PoolStatus"),s=So,D=zo;return a(),f("div",ji,[o("div",Ei,[o("div",Wi,[o("div",{class:"increase",onClick:t[0]||(t[0]=jo(P=>e.$emit("changeCurrentTab"),["stop"]))},"Add"),Xi]),!e.showFromCoinLock&&!e.showToCoinLock?(a(),f("div",Gi,[Hi,o("div",null,[o("div",{class:"only-a",onClick:t[1]||(t[1]=P=>e.onlyToken("only-a"))},[o("p",null,[e.isOnlyA?(a(),f("span",Yi)):U("",!0)]),o("span",null,r(e.needReverse?(v=(c=e.positionInfo)==null?void 0:c.token_b)==null?void 0:v.symbol:(n=(M=e.positionInfo)==null?void 0:M.token_a)==null?void 0:n.symbol)+" only",1)]),o("div",{class:"only-b",onClick:t[2]||(t[2]=P=>e.onlyToken("only-b"))},[o("p",null,[e.isOnlyB?(a(),f("span",zi)):U("",!0)]),o("span",null,r(e.needReverse?(q=(p=e.positionInfo)==null?void 0:p.token_a)==null?void 0:q.symbol:(k=(m=e.positionInfo)==null?void 0:m.token_b)==null?void 0:k.symbol)+" only",1)])])])):U("",!0),o("div",{class:Le(e.needReverse?"card-container reverse":"card-container")},[(e.needReverse?!e.isOnlyA:!e.isOnlyB)?(a(),f("div",Ji,[X(u,{modelValue:e.fromCoinAmount,"onUpdate:modelValue":t[3]||(t[3]=P=>e.fromCoinAmount=P),"input-value":e.fromCoinAmount,"coin-symbol":e.fromCoin?e.fromCoin.symbol:null,"coin-name":e.fromCoin?e.fromCoin.name:null,balance:e.isOnlyA?e.onlyTokenBalance:e.fromCoinBlance,"coin-icon":e.fromCoin?e.fromCoin.logoURI:"",address:e.fromCoin?e.fromCoin.address:"","swap-direct":"From","import-page":"deposit","amount-leabl":"Available","has-arrow":!1,onOnMax:t[4]||(t[4]=P=>e.maxBtnSelect("fromCoin")),onOnHalf:t[5]||(t[5]=P=>e.halfBtnSelect("fromCoin")),onOnInput:t[6]||(t[6]=P=>{e.isSlider=!1,e.fromCoinAmount=P}),onOnFocus:t[7]||(t[7]=()=>{e.isSlider=!1,e.fixedFromCoin=!0})},null,8,["modelValue","input-value","coin-symbol","coin-name","balance","coin-icon","address"]),e.showFromCoinLock?(a(),x(S,{key:0})):U("",!0)])):U("",!0),(e.needReverse?!e.isOnlyB:!e.isOnlyA)?(a(),f("div",Ki,[X(u,{modelValue:e.toCoinAmount,"onUpdate:modelValue":t[8]||(t[8]=P=>e.toCoinAmount=P),"input-value":e.toCoinAmount,"coin-symbol":e.toCoin?e.toCoin.symbol:null,"coin-name":e.toCoin?e.toCoin.name:null,balance:e.isOnlyB?e.onlyTokenBalance:e.toCoinBlance,"swap-direct":"To","coin-icon":e.toCoin?e.toCoin.logoURI:"",address:e.toCoin?e.toCoin.address:"","import-page":"deposit","amount-leabl":"Available","has-arrow":!1,onOnMax:t[9]||(t[9]=P=>e.maxBtnSelect("toCoin")),onOnHalf:t[10]||(t[10]=P=>e.halfBtnSelect("toCoin")),onOnInput:t[11]||(t[11]=P=>{e.isSlider=!1,e.toCoinAmount=P}),onOnFocus:t[12]||(t[12]=()=>{e.isSlider=!1,e.fixedFromCoin=!1})},null,8,["modelValue","input-value","coin-symbol","coin-name","balance","coin-icon","address"]),e.showToCoinLock?(a(),x(S,{key:0})):U("",!0)])):U("",!0)],2),o("div",Zi,[o("div",Qi,[Number(e.lpBalance)>=Number(e.lpAmount)?(a(),f("div",xi,r(e.sliderVal>0&&Number(("sFixD"in e?e.sFixD:C(T))(e.sliderVal,2))<.01?"<0.01":("sFixD"in e?e.sFixD:C(T))(e.sliderVal,2))+"% ",1)):(a(),f("div",el,"--")),o("div",ol,[(a(!0),f(so,null,Uo(e.ratioArr,(P,F)=>(a(),f("div",{key:F,class:Le(["ratio-item",e.sliderVal==P.value?"ratio-item-active":""]),onClick:()=>{e.isSlider=!0,e.sliderVal=P.value}},r(P.name),11,nl))),128))])]),X(h,{value:e.sliderVal,"onUpdate:value":t[13]||(t[13]=P=>e.sliderVal=P),"tip-formatter":e.formatter,onChange:t[14]||(t[14]=P=>e.isSlider=!0)},null,8,["value","tip-formatter"])])]),e.currentAutoPoolStatus=="STATUS_REBALANCING"?(a(),x(d,{key:0})):U("",!0),(N=e.positionInfo)!=null&&N.is_pause?(a(),x(s,{key:1,class:"big-btn liquidity-btn",disabled:!0},{default:$e(()=>[tl]),_:1})):e.wallet.connected?(a(),x(s,{key:2,class:"big-btn liquidity-btn",disabled:e.removeLiquidityBtnDisabled,onClick:t[15]||(t[15]=P=>e.toRemove())},{default:$e(()=>[o("span",null,r(e.removeLiquidityBtnText),1)]),_:1},8,["disabled"])):(a(),x(s,{key:3,class:"big-btn liquidity-btn",onClick:t[16]||(t[16]=P=>e.wallet.setIsShowWalletModal(!0))},{default:$e(()=>[o("span",null,r(e.$t("button.connectWallet")),1)]),_:1})),e.removeLiquidityBtnDisabled?U("",!0):(a(),f("div",sl,[e.removeText&&(e.isOnlyA&&Number(e.fromCoinAmount)>0||e.isOnlyB&&Number(e.toCoinAmount)>0)?(a(),f("div",il,r(e.removeText),1)):U("",!0),o("div",ll,[al,o("span",null,r(e.totalWithdraw),1)]),o("div",ul,[rl,e.fromCoinAmount||e.toCoinAmount?(a(),f("span",dl,r(("addCommom"in e?e.addCommom:C(R))(e.lpAmount))+" "+r(e.needReverse?(L=e.toCoin)==null?void 0:L.symbol:(H=e.fromCoin)==null?void 0:H.symbol)+"-"+r(e.needReverse?(Y=e.fromCoin)==null?void 0:Y.symbol:(J=e.toCoin)==null?void 0:J.symbol),1)):(a(),f("span",vl,"0 "+r(e.needReverse?(b=e.toCoin)==null?void 0:b.symbol:(y=e.fromCoin)==null?void 0:y.symbol)+"-"+r(e.needReverse?(j=e.fromCoin)==null?void 0:j.symbol:(z=e.toCoin)==null?void 0:z.symbol),1))])])),e.isShowRemoveModal?(a(),x(D,{key:5,"pool-info":e.positionInfo,"from-coin":e.positionInfo.token_a,"to-coin":e.positionInfo.token_b,onOnClose:t[17]||(t[17]=P=>e.isShowRemoveModal=!1)},null,8,["pool-info","from-coin","to-coin"])):U("",!0)])}const cl=Ee(Vi,[["render",ml],["__scopeId","data-v-5fc6ca80"]]),pl=Xe({components:{AutoPoolV2Info:Ko,AutoPoolV2PositionRange:Zo,AutoPoolV2PoolComposition:xo,AutoPoolV2PoolLiquidity:en,AutoPoolV2PoolAdd:Ui,AutoPoolV2PoolRemove:cl},setup(){const e=Je();oo();const t=go(),V=g(()=>t),W=()=>{e.getAutoPoolAPY(),e.getVault(A.params.id)},B=_(),A=eo();Se(()=>A.query.action,h=>{h&&(B.value=h)},{immediate:!0});const u=_(),S=()=>{u.value=window.setInterval(()=>{e.getVault(A.params.id)},6e4)};return fo(()=>{console.log(A,"route##"),S()}),yo(()=>{window.clearInterval(u.value)}),g(()=>V.value.chainName),To(),{clickRefresh:W,currentTab:B}}});const fl={class:"auto-pool-detail-v2"},yl={class:"detail-top"},bl={class:"detail-bottom pc-detail"},gl={class:"detail-bottom-left"},hl={class:"detail-bottom-right"},kl={class:"h5-detail"};function _l(e,t,V,W,B,A){const u=On,S=Ko,h=Zo,d=xo,s=en,D=io("AutoPoolV2PoolAdd"),M=io("AutoPoolV2PoolRemove");return a(),f("div",fl,[o("div",yl,[X(u,{onClickRefresh:e.clickRefresh},null,8,["onClickRefresh"]),X(S)]),o("div",bl,[o("div",gl,[X(h),X(d),X(s)]),o("div",hl,[e.currentTab=="add"?(a(),x(D,{key:0,onChangeCurrentTab:t[0]||(t[0]=n=>e.currentTab="remove")})):(a(),x(M,{key:1,onChangeCurrentTab:t[1]||(t[1]=n=>e.currentTab="add")}))])]),o("div",kl,[e.currentTab=="add"?(a(),x(D,{key:0,onChangeCurrentTab:t[2]||(t[2]=n=>e.currentTab="remove")})):(a(),x(M,{key:1,onChangeCurrentTab:t[3]||(t[3]=n=>e.currentTab="add")})),X(h),X(d),X(s)])])}const zl=Ee(pl,[["render",_l],["__scopeId","data-v-963ccb88"]]);export{zl as default};
