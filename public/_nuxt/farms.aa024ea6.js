import{m as jo,e as Lo,s as H,a as A,u as _o,d as so,o as qo,c as V,k as vo}from"./pool.ade63acd.js";import{a as G,l as c,r as E,e as K,o as n,f as t,h as s,v as b,u as w,c as O,w as R,B as $o,j as F,p as no,k as to,i as P,s as Oo,t as eo,x as D,b as Uo,A as fo,F as W,E as x,P as ds,q as bo,z as go,N as Jo,M as Wo,S as cs,H as zo,Q as us}from"./entry.06329c18.js";import{a as ao,u as Co}from"./sha256.05d9ba3f.js";import{u as lo}from"./farms.d4cb084b.js";import{R as Vo}from"./farms-range.3c04206a.js";import{_ as Qo}from"./apr-tips.e83e42ae.js";import{i as Ro}from"./import-icon.de3e6c66.js";/* empty css              *//* empty css              *//* empty css              */import{p as Go}from"./precision.a7a6c57b.js";import{_ as Ko}from"./img-connect-wallet_2x.19ab11ec.js";import{_ as Xo}from"./img-no-Positions_2x.ce4b1d62.js";import{_ as ms}from"./upgrade-loading.c94e60a8.js";import"./decimal.0bdeb344.js";import"./icon_rewards_2x.a9d24db2.js";/* empty css              */import"./icon-Amount-for-Sale_2x.b2e65df2.js";const ps=G({setup(){const o=ao(),r=c(()=>o),g=lo(),p=c(()=>g),_=c(()=>p.value.totalRwadrdUsd),a=c(()=>p.value.farmsPositionList),i=c(()=>p.value.farmsAllPositionLoading),d=Co(),$=jo("Sui"),I=Lo("Sui"),{setIsShowSuccess:h,setIsShowRejected:f,setIsShowWaiting:S,setTransactionDesc:j,setTransactionTxid:e}=d,k=E(!1);return{wallet:r,farms:p,totalRwadrdUsd:_,sFixD:H,claimAllPoolReward:async io=>{k.value=!0,console.log(a.value,"farmsRewardObj###");const X=[];a.value.forEach(B=>{console.log(io,B,"#position"),B.positionSource=="farming"&&X.push({pool_id:B.pool_id,position_nft_id:B.id})}),console.log(JSON.stringify(X),"##params"),e(""),j("Claim Rewards"),S(!0);try{const B=await $.batchHarvest(X),J=await r.value.currentWallet.signAndExecuteTransactionBlock(B);console.log("0221###sui swap res###",J);let C=I.handleTx(J);if(C&&C.hash){e(C.hash),S(!1),h(!0);let U={res:C.res,title:"Claim",hash:C.hash};I.showTransitionPending(U),await I.watchTransaction(U)&&setTimeout(()=>{g.getFarmsPoolList()},4e3)}else S(!1),f(!0);k.value=!1}catch(B){console.log("Claim all error",B),S(!1),f(!0),k.value=!1}},loading:k,addCommom:A,farmsAllPositionLoading:i}}});const Ho=o=>(no("data-v-75cd64ff"),o=o(),to(),o),fs={class:"farms-banner-bg"},_s={class:"farms-banner"},hs={class:"farms-banner-center"},vs=Ho(()=>s("div",{class:"title"},"Farms",-1)),gs=Ho(()=>s("div",{class:"desc"},"Stake your positions to earn higher yield.",-1)),bs={class:"claim-rewards"},$s={class:"claim-title"},ws=Ho(()=>s("span",null,"Unclaimed Rewards",-1)),ys={key:0},Is={key:1},ks={class:"claim-content"};function Ss(o,r,g,p,_,a){const i=$o;return n(),t("div",fs,[s("div",_s,[s("div",hs,[vs,gs,s("div",bs,[s("div",$s,[ws,o.wallet.address?(n(),t("span",ys,b(Number(o.totalRwadrdUsd)>0&&Number(o.totalRwadrdUsd)<.01?"<$0.01":`$${("addCommom"in o?o.addCommom:w(A))(("sFixD"in o?o.sFixD:w(H))(o.totalRwadrdUsd||0,2))}`),1)):(n(),t("span",Is,"--"))]),s("div",ks,[o.wallet.address?(n(),O(i,{key:0,class:"claim-btn",loading:o.loading,disabled:Number(o.totalRwadrdUsd)==0||o.farmsAllPositionLoading,onClick:o.claimAllPoolReward},{default:R(()=>[F("Claim All")]),_:1},8,["loading","disabled","onClick"])):(n(),O(i,{key:1,class:"claim-btn",onClick:r[0]||(r[0]=d=>o.wallet.setIsShowWalletModal(!0))},{default:R(()=>[F("Connect")]),_:1}))])])])])])}const Yo=K(ps,[["render",Ss],["__scopeId","data-v-75cd64ff"]]),Ps=G({props:{poolInfo:{type:Object,default:()=>({})}},setup(){const o=E(!0);return{sFixD:H,direct:o}}});const Ts=o=>(no("data-v-14f67ada"),o=o(),to(),o),js={class:"valid-range"},Ls=Ts(()=>s("div",{class:"title"},"Valid Range",-1));function Os(o,r,g,p,_,a){const i=Vo;return n(),t("div",js,[Ls,P(i,{"pool-info":o.poolInfo},null,8,["pool-info"])])}const Cs=K(Ps,[["render",Os],["__scopeId","data-v-14f67ada"]]),Us=G({props:{poolInfo:{type:Object,default:()=>({})}},setup(){return{}}});const Rs={class:"pool"},As={class:"pool-info"},Fs={class:"token-logo"},Ds={alt:""},Ns={alt:""},Bs={class:"token-symbol"},Es={class:"symbol"},Ms={class:"fee-rate"};function qs(o,r,g,p,_,a){var $,I,h,f;const i=Cs,d=Oo("image");return n(),t("div",Rs,[s("div",As,[s("div",Fs,[eo(s("img",Ds,null,512),[[d,($=o.poolInfo.coinA)==null?void 0:$.logo_url]]),eo(s("img",Ns,null,512),[[d,(I=o.poolInfo.coinB)==null?void 0:I.logo_url]])]),s("div",Bs,[s("div",Es,b((h=o.poolInfo.coinA)==null?void 0:h.symbol)+" - "+b((f=o.poolInfo.coinB)==null?void 0:f.symbol),1),s("div",Ms,b(o.poolInfo.fee),1)])]),P(i,{"pool-info":o.poolInfo},null,8,["pool-info"])])}const Zo=K(Us,[["render",qs],["__scopeId","data-v-c027f63c"]]),Ws=G({props:{currentTab:{type:String,default:""},rewardInfo:{type:Object,default:()=>({})}},setup(){const o=_o(),r=c(()=>o);return{sFixD:H,addCommom:A,getCoinIcon:p=>{var _;return((_=r.value.tokensObj[p])==null?void 0:_.logo_url)||Ro("/image/coins/sui-unknown.png")}}}});const Vs={key:0,class:"rewards-day"},Hs={class:"rewards-day-box"},Js={alt:""};function zs(o,r,g,p,_,a){const i=Oo("image");return o.rewardInfo.allocate_point>0||o.currentTab=="Ended"?(n(),t("div",Vs,[s("div",null,[s("div",Hs,[eo(s("img",Js,null,512),[[i,o.getCoinIcon(o.rewardInfo.reward_coin)]]),s("span",null,b(("addCommom"in o?o.addCommom:w(A))(("sFixD"in o?o.sFixD:w(H))(o.rewardInfo.emission_per_day,4))),1)])])])):D("",!0)}const xo=K(Ws,[["render",zs],["__scopeId","data-v-416b96fb"]]),Qs=G({props:{positionInfo:{type:Object,default:()=>({})}},setup(o){console.log(o.positionInfo,"props.positionInfo");const r=_o(),g=c(()=>r);return{addCommom:A,decimalUi:so,fixD:qo,getCoinIcon:_=>{var a;return((a=g.value.tokensObj[_])==null?void 0:a.logo_url)||Ro("/image/coins/sui-unknown.png")}}}});const Gs={class:"hover-rewarder"},Ks={class:"rewarder-info"},Xs={class:"left-rewarder"},Ys={alt:""},Zs={class:"right-rewarder"},xs={class:"amount"},oe={key:0,class:"amount-usd"},se={key:1,class:"amount-usd"},ee={class:"rewarder-info"},ne={class:"left-rewarder"},te={alt:""},ae={class:"right-rewarder"},ie={class:"amount"},le={key:0,class:"amount-usd"},re={key:1,class:"amount-usd"};function de(o,r,g,p,_,a){const i=Oo("image");return n(),t("div",Gs,[s("div",Ks,[s("div",Xs,[eo(s("img",Ys,null,512),[[i,o.getCoinIcon(o.positionInfo.needReverse?o.positionInfo.coinB.address:o.positionInfo.coinA.address)]]),s("span",null,b(o.positionInfo.needReverse?o.positionInfo.coinB.symbol:o.positionInfo.coinA.symbol),1)]),s("div",Zs,[s("div",xs,b(o.positionInfo.needReverse?("addCommom"in o?o.addCommom:w(A))(("decimalUi"in o?o.decimalUi:w(so))(o.positionInfo.amountB,o.positionInfo.coinB.decimals)):("addCommom"in o?o.addCommom:w(A))(("decimalUi"in o?o.decimalUi:w(so))(o.positionInfo.amountA,o.positionInfo.coinA.decimals))),1),o.positionInfo.needReverse?(n(),t("div",se,b(o.positionInfo.amountBUsd==0?"$0":o.positionInfo.amountBUsd>.01?"$"+("fixD"in o?o.fixD:w(qo))(o.positionInfo.amountBUsd,2):"<$0.01"),1)):(n(),t("div",oe,b(o.positionInfo.amountAUsd==0?"$0":o.positionInfo.amountAUsd>.01?"$"+("fixD"in o?o.fixD:w(qo))(o.positionInfo.amountAUsd,2):"<$0.01"),1))])]),s("div",ee,[s("div",ne,[eo(s("img",te,null,512),[[i,o.getCoinIcon(o.positionInfo.needReverse?o.positionInfo.coinA.address:o.positionInfo.coinB.address)]]),s("span",null,b(o.positionInfo.needReverse?o.positionInfo.coinA.symbol:o.positionInfo.coinB.symbol),1)]),s("div",ae,[s("div",ie,b(o.positionInfo.needReverse?("addCommom"in o?o.addCommom:w(A))(("decimalUi"in o?o.decimalUi:w(so))(o.positionInfo.amountA,o.positionInfo.coinA.decimals)):("addCommom"in o?o.addCommom:w(A))(("decimalUi"in o?o.decimalUi:w(so))(o.positionInfo.amountB,o.positionInfo.coinB.decimals))),1),o.positionInfo.needReverse?(n(),t("div",re,b(o.positionInfo.amountAUsd==0?"$0":o.positionInfo.amountAUsd>.01?"$"+("addCommom"in o?o.addCommom:w(A))(("decimalUi"in o?o.decimalUi:w(so))(o.positionInfo.amountAUsd,2)):"<$0.01"),1)):(n(),t("div",le,b(o.positionInfo.amountBUsd==0?"$0":o.positionInfo.amountBUsd>.01?"$"+("addCommom"in o?o.addCommom:w(A))(("decimalUi"in o?o.decimalUi:w(so))(o.positionInfo.amountBUsd,2)):"<$0.01"),1))])])])}const os=K(Qs,[["render",de],["__scopeId","data-v-d01301e5"]]),ce=G({components:{FarmsPositionAmountTips:os},props:{positionInfo:{type:Object,default:()=>({})},currentTab:{type:String,default:""}},setup(o){const r=ao(),g=c(()=>r);console.log(o.positionInfo,"positionInfo#");const p=lo(),_=c(()=>p),a=Lo("Sui"),i=jo("Sui"),d=E(!1),$=Co();c(()=>$);const I=Uo(),{setIsShowSuccess:h,setIsShowRejected:f,setIsShowWaiting:S,setTransactionDesc:j,setTransactionTxid:e}=$,k=async()=>{console.log(o.positionInfo,"props.positionInfo"),d.value=!0,e(""),j(`Stake ${o.positionInfo.name}`),S(!0);const y={clmm_pool_id:o.positionInfo.clmmPool,clmm_position_id:o.positionInfo.pos_object_id,coinTypeA:o.positionInfo.coin_type_a,coinTypeB:o.positionInfo.coin_type_b},T=o.positionInfo.farmsPoolId;try{const z=await i.farmsDeposit(y,T),q=await g.value.currentWallet.signAndExecuteTransactionBlock(z);console.log("0221###sui swap res###",q);let N=a.handleTx(q);if(N&&N.hash){e(N.hash),S(!1),h(!0);let Z={res:N.res,title:"Staked",hash:N.hash};a.showTransitionPending(Z),await a.watchTransaction(Z)&&setTimeout(()=>{p.getPositionByPool(g.value.address,o.positionInfo.clmm_pool_id,o.positionInfo.farmsPoolId),d.value=!1},2e3)}else S(!1),f(!0)}catch(z){console.log("farmsDeposit error",z),S(!1),f(!0),d.value=!1}},L=async()=>{console.log(o.positionInfo,"props.positionInfo"),d.value=!0,e(""),j(`Unstake ${o.positionInfo.name}`),S(!0);const y=o.positionInfo.farmsPoolId,T=o.positionInfo.id;try{const z=await i.farmsWithdraw(y,T),q=await g.value.currentWallet.signAndExecuteTransactionBlock(z);console.log("0221###sui swap res###",q);let N=a.handleTx(q);if(console.log(N,"unStaketx##"),N&&N.hash){e(N.hash),S(!1),h(!0);let Z={res:N.res,title:"Unstaked",hash:N.hash};a.showTransitionPending(Z),await a.watchTransaction(Z)&&setTimeout(()=>{console.log(o.positionInfo,"##props.positionInfo"),p.getPositionByPool(g.value.address,o.positionInfo.clmm_pool_id,o.positionInfo.farmsPoolId),d.value=!1},2e3)}else S(!1),f(!0)}catch(z){console.log("farmsDeposit error",z),S(!1),f(!0),d.value=!1}},io=async()=>{console.log(o.positionInfo,"props.positionInfo"),d.value=!0,e(""),j("Claim rewards"),S(!0);const y={pool_id:o.positionInfo.farmsPoolId,position_nft_id:o.positionInfo.id};try{const T=await i.harvestFarms(y),z=await g.value.currentWallet.signAndExecuteTransactionBlock(T);console.log("0221###sui swap res###",z);let q=a.handleTx(z);if(q&&q.hash){e(q.hash),S(!1),h(!0);let N={title:"Claim",res:q.res,hash:q.hash};a.showTransitionPending(N),await a.watchTransaction(N)&&setTimeout(()=>{p.getPositionByPool(g.value.address,o.positionInfo.clmm_pool_id,o.positionInfo.farmsPoolId)},2e3)}else S(!1),f(!0);d.value=!1}catch(T){console.log("farmsDeposit error",T),S(!1),f(!0),d.value=!1}},X=c(()=>_.value.farmsRewardObj),B=_o(),J=c(()=>B),C=c(()=>_.value.farmsLoadingObj);return{sFixD:H,stake:k,loading:d,unStake:L,router:I,claim:io,farmsRewardObj:X,getCoinIcon:y=>{var T;return((T=J.value.tokensObj[y])==null?void 0:T.logo_url)||Ro("/image/coins/sui-unknown.png")},toPositionDetails:y=>{console.log("toPositionDetails:",y),y.positionSource=="clmm"?I.push(`/new-position-detail?collect=${y.collectionName}&&token=${y.tokenName}&&address=${y.pool}&pos=${y.pos_object_id}`):I.push(`/new-position-detail?position_nft_id=${y.id}&positionSource=farming`)},farmsLoadingObj:C,addCommom:A}}}),ss=""+globalThis.__publicAssetsURL("sui-image/position-active.png");const Ao=o=>(no("data-v-e066300f"),o=o(),to(),o),ue={class:"farms-position-item"},me=Ao(()=>s("thead",null,[s("tr",null,[s("th"),s("th",null,"Liquidity"),s("th",null,"Earnings"),s("th")])],-1)),pe={class:"position-info"},fe={key:0,class:"status-bg"},_e=Ao(()=>s("img",{src:ss,alt:""},null,-1)),he=[_e],ve={class:"status-text"},ge={class:"name-range"},be=Ao(()=>s("span",null,"Details",-1)),$e=Ao(()=>s("svg",{class:"arrow-icon","aria-hidden":"true"},[s("use",{"xlink:href":"#icon-icon_arrow"})],-1)),we=[be,$e],ye={class:"liquidity"},Ie={class:"rewards-day-box"},ke={alt:""},Se={key:1,class:"rewards-day"},Pe={class:"action-btn"};function Te(o,r,g,p,_,a){const i=Vo,d=os,$=$o,I=ds,h=Oo("image");return n(),t("div",ue,[s("table",null,[me,s("tbody",null,[s("tr",null,[s("td",null,[s("div",pe,[s("div",{class:fo(["position-status",o.positionInfo.positionStatus!=="Active"?"position-status-inactive":""])},[o.positionInfo.positionStatus=="Active"?(n(),t("div",fe,he)):D("",!0),s("div",ve,b(o.positionInfo.positionStatus),1)],2),s("div",ge,[s("span",null,b(o.positionInfo.name),1),P(i,{"pool-info":o.positionInfo},null,8,["pool-info"])]),s("div",{class:"details",onClick:r[0]||(r[0]=f=>o.toPositionDetails(o.positionInfo))},we)])]),s("td",null,[s("div",ye,[P(d,{"position-info":o.positionInfo},null,8,["position-info"]),s("span",null,b(o.positionInfo.positionUSD>0&&o.positionInfo.positionUSD<.01?"<$0.01":`~$${("addCommom"in o?o.addCommom:w(A))(("sFixD"in o?o.sFixD:w(H))(o.positionInfo.positionUSD,2))}`),1)])]),s("td",null,[o.positionInfo.rewards&&o.positionInfo.rewards.length>0?(n(!0),t(W,{key:0},x(o.positionInfo.rewards,f=>(n(),t("div",{key:f.rewarder_type,class:"rewards-day"},[s("div",null,[s("div",Ie,[eo(s("img",ke,null,512),[[h,o.getCoinIcon(f.rewarder_type)]]),s("span",null,b(f.rewarderAmount),1)])])]))),128)):(n(),t("div",Se,"0"))]),s("td",null,[s("div",Pe,[o.positionInfo.positionSource=="clmm"?(n(),t(W,{key:0},[o.positionInfo&&o.positionInfo.positionStatus!=="Active"?(n(),O(I,{key:0},{title:R(()=>[F("Farming rewards are only available for active positions.")]),default:R(()=>[P($,{class:"unstake-btn",loading:o.loading,disabled:o.positionInfo.positionStatus!=="Active",onClick:o.stake},{default:R(()=>[F("Stake")]),_:1},8,["loading","disabled","onClick"])]),_:1})):(n(),O($,{key:1,class:"unstake-btn",loading:o.loading,disabled:o.positionInfo.positionStatus!=="Active",onClick:o.stake},{default:R(()=>[F("Stake")]),_:1},8,["loading","disabled","onClick"]))],64)):(n(),O($,{key:1,class:"unstake-btn",onClick:o.unStake},{default:R(()=>[F("Unstake")]),_:1},8,["onClick"])),o.positionInfo.positionSource=="clmm"?(n(),O($,{key:2,class:"claim-btn",disabled:!0},{default:R(()=>[F("↑ Claim")]),_:1})):(n(),O($,{key:3,class:"claim-btn",disabled:o.positionInfo.positionRewardAmount==0,onClick:o.claim},{default:R(()=>[F("↑ Claim")]),_:1},8,["disabled","onClick"]))])])])])])])}const es=K(ce,[["render",Te],["__scopeId","data-v-e066300f"]]),je=G({props:{noDataImg:{type:String,default:""},desc:{type:String,default:""},type:{type:String,default:""},addLiquidityUrl:{type:String,default:""}},setup(){return{walletStore:ao()}}});const Le={class:"no-data"},Oe=["src"],Ce={key:0,class:"desc"};function Ue(o,r,g,p,_,a){const i=$o;return n(),t("div",Le,[s("img",{src:o.noDataImg,alt:""},null,8,Oe),o.desc?(n(),t("div",Ce,b(o.desc),1)):D("",!0),o.type=="addLiquidity"?(n(),O(i,{key:1,class:"add-liquidity-btn",onClick:r[0]||(r[0]=d=>o.addLiquidityUrl?o.$router.push(o.addLiquidityUrl):"")},{default:R(()=>[F("Add Liquidity")]),_:1})):D("",!0),o.type=="connectWallet"?(n(),O(i,{key:2,class:"add-liquidity-btn",onClick:r[1]||(r[1]=d=>o.walletStore.setIsShowWalletModal(!0))},{default:R(()=>[F("Connect Wallet")]),_:1})):D("",!0)])}const ns=K(je,[["render",Ue],["__scopeId","data-v-130f9462"]]),Re=G({components:{FarmsPositionItem:es},props:{currentTab:{type:String,default:""},sortValue:{type:String,default:"APR"}},setup(o){const r=E({}),g=ao(),p=c(()=>g),_=lo(),a=c(()=>_),i=c(()=>a.value.farmsPoolList),d=c(()=>a.value.farmsPoolList),$=Co(),I=c(()=>$),h=c(()=>I.value.addressLpTokens),f=E([]),S=l=>{console.log(d.value,"###list.value");let u;o.currentTab=="My Farms"&&(u=p.value.address?a.value.myFarmsPoolList:[]),o.currentTab=="Ended"&&(u=a.value.farmsPoolList.filter(m=>(console.log(m.status,"##ele.status "),m.status=="Ended"))),o.currentTab=="Live"&&(u=a.value.farmsPoolList.filter(m=>m.status=="Live")),l=="APR"?f.value=u.sort((m,v)=>v.apr-m.apr):f.value=u.sort((m,v)=>v.tvl-m.tvl)};bo(()=>[d.value,o.sortValue,o.currentTab],([l,u])=>{console.log(u,"sortValue326"),l&&l.length>0&&u&&S(u)},{immediate:!0});const j=l=>{r.value[l.clmm_pool_id]?r.value[l.clmm_pool_id]=!1:(r.value[l.clmm_pool_id]=!0,console.log("执行了吗"),_.getPositionByPool(p.value.address,l.clmm_pool_id,l.id))},e=c(()=>a.value.farmsPositionObj),k=c(()=>(console.log(a.value.farmsLoadingObj,"##farms.value.farmsLoadingObj"),a.value.farmsLoadingObj)),L=c(()=>a.value.farmsUserUsd),io=c(()=>(console.log(a.value.farmsRewardObj,"##farmsRewardObj"),a.value.farmsRewardObj)),X=c(()=>a.value.farmsPositionList),B=c(()=>a.value.farmsAllPositionLoading),J=Uo(),C=jo("Sui"),U=Lo("Sui"),{setIsShowSuccess:M,setIsShowRejected:y,setIsShowWaiting:T,setTransactionDesc:z,setTransactionTxid:q}=$,N=async l=>{console.log(X.value,"farmsRewardObj###");const u=[];X.value.forEach(m=>{console.log(l,m,"#position"),l==m.clmm_pool_id&&u.push({pool_id:m.pool_id,position_nft_id:m.id})}),console.log(JSON.stringify(u),"##params"),q(""),z("Claim rewards"),T(!0);try{const m=await C.batchHarvest(u),v=await p.value.currentWallet.signAndExecuteTransactionBlock(m);console.log("0221###sui swap res###",v);let Q=U.handleTx(v);if(Q&&Q.hash){q(Q.hash),T(!1),M(!0);let oo={res:Q.res,title:"Claim",hash:Q.hash};U.showTransitionPending(oo),await U.watchTransaction(oo)&&setTimeout(()=>{_.getFarmsPoolList()},4e3)}else T(!1),y(!0)}catch(m){console.log("Claim all error",m),T(!1),y(!0)}},Z=_o(),co=c(()=>Z),ho=c(()=>(console.log(co.value.poolsObj,"##pools.value.poolsObj"),co.value.poolsObj)),Do=c(()=>co.value.tokensObj),uo=E({}),mo=(l,u)=>l&&u?Go.plus(vo(l),vo(u)):l||0,No=l=>{let u=0;return l&&l.forEach(m=>{u+=vo(String(m))}),String(so(String(u),2))},Bo=(l,u,m)=>{console.log(l,"poolsObj##473"),Object.keys(l).forEach(v=>{var po,wo,yo;const Q=(po=u[v])==null?void 0:po.apr_7day,oo=mo((wo=u[v])==null?void 0:wo.apr_7day,No((yo=u[v])==null?void 0:yo.rewarder_apr));uo.value[v]={...l[v],apr:String(Q).replace("%",""),aprTotal:oo},uo.value[v].rewards=[],l[v].rewarderInfo.forEach((Mo,Io)=>{var Po,To;const ko=(Po=m[Mo.coinAddress])==null?void 0:Po.symbol,So=(To=u[v])==null?void 0:To.rewarder_apr[Io];console.log(ko,So,"getRewardInfo:"),console.log(l[v],"## poolsObj[key]"),uo.value[v].rewards.push({symbol:ko,rewarderApr:So,rewarder_display:l[v][`rewarder_display${Io+1}`]})})}),console.log(uo.value,"##rewardInfoObj")};bo(()=>[ho.value,h.value,Do.value],([l,u,m])=>{l&&!V(l)&&u&&!V(u)&&m&&!V(m)&&Bo(l,u,m)},{immediate:!0});const Eo=c(()=>a.value.farmsPoolObj);return console.log(h.value,"addressLpTokens:"),{wallet:p,walletStore:g,farmsPoolList:i,openMore:j,openMoreObj:r,checkNullObj:V,router:J,farmsPositionObj:e,farmsLoadingObj:k,farmsUserUsd:L,sFixD:H,farmsRewardObj:io,claimPoolReward:N,farmsAllPositionLoading:B,addCommom:A,addressLpTokens:h,poolsObj:ho,rewardInfoObj:uo,pageList:f,farmsPoolObj:Eo}}});const ro=o=>(no("data-v-dcc99942"),o=o(),to(),o),Ae={class:"farms-table"},Fe=ro(()=>s("thead",null,[s("tr",null,[s("th",null,"Pools"),s("th",null,"Staked TVL"),s("th",null,"APR"),s("th",null,"Rewards / day"),s("th",null,"My Staked"),s("th",null,"Earned"),s("th",null,"Actions")]),s("tr",{style:{height:"4px"}})],-1)),De={key:0},Ne=["onClick"],Be={class:"staked-tvl"},Ee={class:"apr"},Me={key:0,class:"apr-hover-box"},qe={class:"farms-reward-box"},We={key:0,class:"my-staked"},Ve={key:0,class:"my-staked-loading"},He={key:0,class:"position-usd"},Je={key:1,class:"position-usd"},ze={key:2,class:"position-usd"},Qe={key:3,class:"position-num"},Ge={key:1,class:"my-staked"},Ke=ro(()=>s("div",{class:"position-usd"},"--",-1)),Xe=[Ke],Ye={class:"earned"},Ze={key:0,class:"my-staked-loading"},xe={key:0,class:"ratio-bg"},on=ro(()=>s("div",{class:"ratio"},null,-1)),sn=[on],en={key:1},nn={key:2},tn={key:3},an={key:2},ln={class:"actions"},rn={class:"actions-btn"},dn=["onClick"],cn=ro(()=>s("use",{"xlink:href":"#icon-icon_arrow"},null,-1)),un=[cn],mn={colspan:"7",style:{padding:"0 16px 16px"}},pn={key:0,class:"farm-position-list"},fn={key:0,class:"farm-position-loading"},_n={key:1,class:"farm-position-list"},hn=ro(()=>s("tr",{style:{height:"8px"}},null,-1)),vn={key:1},gn={colspan:"7"},bn={key:0,class:"no-data"},$n=ro(()=>s("img",{src:Ko,alt:""},null,-1)),wn={key:1,class:"no-data"},yn=ro(()=>s("img",{src:Xo,alt:""},null,-1)),In=ro(()=>s("span",null,"No farms found",-1)),kn=[yn,In];function Sn(o,r,g,p,_,a){const i=Zo,d=Qo,$=xo,I=Wo,h=$o,f=cs,S=es,j=ns;return n(),t("div",Ae,[s("table",null,[Fe,o.pageList&&o.pageList.length>0?(n(),t("tbody",De,[(n(!0),t(W,null,x(o.pageList,e=>(n(),t(W,{key:e.id},[s("tr",{onClick:k=>o.openMore(e)},[s("td",null,[P(i,{"pool-info":e},null,8,["pool-info"])]),s("td",null,[s("div",Be," $"+b(("addCommom"in o?o.addCommom:w(A))(o.addressLpTokens&&o.addressLpTokens[e.clmm_pool_id]&&o.addressLpTokens[e.clmm_pool_id].stable_farming&&o.addressLpTokens[e.clmm_pool_id].stable_farming.tvl,2)),1)]),s("td",null,[s("div",Ee,[o.rewardInfoObj[e.clmm_pool_id]&&o.rewardInfoObj[e.clmm_pool_id].rewards.length>0||o.farmsPoolObj[e.clmm_pool_id]&&o.farmsPoolObj[e.clmm_pool_id].status!=="Ended"?(n(),t("div",Me,[!("checkNullObj"in o?o.checkNullObj:w(V))(o.rewardInfoObj)&&o.rewardInfoObj[e.clmm_pool_id]?(n(),O(d,{key:0,"l-item":o.rewardInfoObj[e.clmm_pool_id],"rewarder-info":o.rewardInfoObj[e.clmm_pool_id].rewards,class:"noHover apr-hover-con"},null,8,["l-item","rewarder-info"])):D("",!0)])):D("",!0),s("span",null,b((e==null?void 0:e.stable_farming.apr)*100>0&&e.stable_farming.apr*100<.01?"<0.01%":`${("sFixD"in o?o.sFixD:w(H))(e.stable_farming.apr*100,2)}%`),1)])]),s("td",null,[s("div",qe,[(n(!0),t(W,null,x(e.rewarders,k=>(n(),O($,{key:k.reward_coin,"reward-info":k,"current-tab":o.currentTab},null,8,["reward-info","current-tab"]))),128))])]),s("td",null,[o.wallet.address?(n(),t("div",We,[o.farmsLoadingObj[e.clmm_pool_id]||o.farmsAllPositionLoading?(n(),t("div",Ve,[P(I,{class:"upgrade-title-skeleton",loading:!0,active:"",paragraph:!1})])):(n(),t(W,{key:1},[o.farmsUserUsd&&o.farmsUserUsd[e.clmm_pool_id]&&o.farmsUserUsd[e.clmm_pool_id].amount>0&&o.farmsUserUsd[e.clmm_pool_id].amount>.01?(n(),t("div",He," $"+b(("sFixD"in o?o.sFixD:w(H))(o.farmsUserUsd[e.clmm_pool_id].amount,2)),1)):o.farmsUserUsd&&o.farmsUserUsd[e.clmm_pool_id]&&o.farmsUserUsd[e.clmm_pool_id].amount>0&&o.farmsUserUsd[e.clmm_pool_id].amount<.01?(n(),t("div",Je," <$0.01 ")):(n(),t("div",ze,"0")),o.farmsUserUsd&&o.farmsUserUsd[e.clmm_pool_id]&&o.farmsUserUsd[e.clmm_pool_id].positionNum?(n(),t("div",Qe,b(o.farmsUserUsd[e.clmm_pool_id].positionNum)+" "+b(o.farmsUserUsd[e.clmm_pool_id].positionNum>1?"Positions":"Position"),1)):D("",!0)],64))])):(n(),t("div",Ge,Xe))]),s("td",null,[s("div",Ye,[o.farmsLoadingObj[e.clmm_pool_id]||o.farmsAllPositionLoading?(n(),t("div",Ze,[P(I,{class:"upgrade-title-skeleton",loading:!0,active:"",paragraph:!1})])):o.wallet.address&&o.farmsRewardObj&&o.farmsRewardObj[e.clmm_pool_id]&&o.farmsRewardObj[e.clmm_pool_id].amountUsd?(n(),t(W,{key:1},[o.wallet.address&&o.farmsRewardObj&&o.farmsRewardObj[e.clmm_pool_id]&&o.farmsRewardObj[e.clmm_pool_id].amountUsd>0?(n(),t("div",xe,sn)):D("",!0),Number(o.farmsRewardObj[e.clmm_pool_id].amountUsd)>.01?(n(),t("span",en,"$"+b(("addCommom"in o?o.addCommom:w(A))(("sFixD"in o?o.sFixD:w(H))(o.farmsRewardObj[e.clmm_pool_id].amountUsd||0,2))),1)):Number(o.farmsRewardObj[e.clmm_pool_id].amountUsd)>0&&Number(o.farmsRewardObj[e.clmm_pool_id].amountUsd)<.01?(n(),t("span",nn,"<$0.01")):(n(),t("span",tn,"0"))],64)):(n(),t("span",an,"0"))])]),s("td",null,[s("div",ln,[s("div",rn,[P(h,{class:"claim-btn",disabled:!o.wallet.address||!o.farmsRewardObj[e.clmm_pool_id]||o.farmsRewardObj[e.clmm_pool_id].amountUsd<=0,onClick:go(k=>o.claimPoolReward(e.clmm_pool_id),["stop"])},{default:R(()=>[F("Claim")]),_:2},1032,["disabled","onClick"]),P(h,{class:"add-liquidity-btn",onClick:go(k=>o.router.push(`/liquidity/deposit?poolAddress=${e.clmm_pool_id}`),["stop"])},{default:R(()=>[F("+ Add liquidity")]),_:2},1032,["onClick"])]),s("div",{class:"more",onClick:go(k=>o.openMore(e),["stop"])},[(n(),t("svg",{class:fo(["arrow-icon",o.openMoreObj[e.clmm_pool_id]?"open-more":""]),"aria-hidden":"true"},un,2))],8,dn)])])],8,Ne),eo(s("tr",null,[s("td",mn,[o.wallet.address?(n(),t("div",pn,[!("checkNullObj"in o?o.checkNullObj:w(V))(o.farmsLoadingObj)&&o.farmsLoadingObj[e.clmm_pool_id]||o.farmsAllPositionLoading?(n(),t("div",fn,[P(f)])):o.farmsPositionObj[e.clmm_pool_id]&&o.farmsPositionObj[e.clmm_pool_id].length>0?(n(!0),t(W,{key:1},x(o.farmsPositionObj[e.clmm_pool_id],k=>(n(),O(S,{key:k.clmm_position_id,"current-tab":o.currentTab,"position-info":{...k,clmm_pool_id:e.clmm_pool_id}},null,8,["current-tab","position-info"]))),128)):(n(),O(j,{key:2,"no-data-img":"/sui-image/img-no-Positions@2x.png",desc:"No Position Found",type:"addLiquidity","add-liquidity-url":`/liquidity/deposit?poolAddress=${e.clmm_pool_id}`},null,8,["add-liquidity-url"]))])):(n(),t("div",_n,[P(j,{"no-data-img":"/sui-image/img-connect-wallet@2x.png",type:"connectWallet"})]))])],512),[[Jo,!("checkNullObj"in o?o.checkNullObj:w(V))(o.openMoreObj)&&o.openMoreObj[e==null?void 0:e.clmm_pool_id]]]),hn],64))),128))])):(n(),t("tbody",vn,[s("tr",null,[s("td",gn,[!o.wallet.connected&&o.currentTab=="My Farms"?(n(),t("div",bn,[$n,P(h,{class:"connect-wallet",onClick:r[0]||(r[0]=e=>o.wallet.setIsShowWalletModal(!0))},{default:R(()=>[F(b(o.$t("button.connectWallet")),1)]),_:1})])):o.pageList.length==0?(n(),t("div",wn,kn)):D("",!0)])])]))])])}const ts=K(Re,[["render",Sn],["__scopeId","data-v-dcc99942"]]),Pn=G({props:{currentTab:{type:String,default:""}},setup(){const o=E(!1),r=ao(),g=c(()=>r),p=lo(),_=c(()=>p),a=c(()=>_.value.farmsPoolList);return{isShowMore:o,wallet:g,walletStore:r,farmsPoolList:a}}});const as=o=>(no("data-v-d863b1fb"),o=o(),to(),o),Tn={class:"farms-table"},jn=as(()=>s("thead",null,[s("tr",null,[s("th",null,"Pools"),s("th",null,"Staked TVL"),s("th",null,"APR"),s("th",null,"Rewards / day"),s("th",null,"My Staked"),s("th",null,"Earned"),s("th",null,"Actions")]),s("tr",{style:{height:"4px",background:"unset"}})],-1)),Ln={class:"pool"},On={class:"staked-tvl"},Cn={class:"apr"},Un={class:"my-staked"},Rn={class:"actions"},An={class:"actions"},Fn={class:"actions"},Dn=as(()=>s("tr",{style:{height:"8px",background:"unset !important"}},null,-1));function Nn(o,r,g,p,_,a){const i=Wo;return n(),t("div",Tn,[s("table",null,[jn,s("tbody",null,[(n(),t(W,null,x(4,(d,$)=>(n(),t(W,{key:$},[s("tr",null,[s("td",null,[s("div",Ln,[P(i,{class:"upgrade-title-skeleton",loading:!0,active:"",paragraph:!1}),P(i,{class:"upgrade-title-skeleton",loading:!0,active:"",paragraph:!1})])]),s("td",null,[s("div",On,[P(i,{class:"upgrade-title-skeleton",loading:!0,active:"",paragraph:!1})])]),s("td",null,[s("div",Cn,[s("span",null,[P(i,{class:"upgrade-title-skeleton",loading:!0,active:"",paragraph:!1})])])]),s("td",null,[s("div",Un,[P(i,{class:"upgrade-title-skeleton",loading:!0,active:"",paragraph:!1})])]),s("td",null,[s("div",Rn,[P(i,{class:"upgrade-title-skeleton",loading:!0,active:"",paragraph:!1})])]),s("td",null,[s("div",An,[P(i,{class:"upgrade-title-skeleton",loading:!0,active:"",paragraph:!1})])]),s("td",null,[s("div",Fn,[P(i,{class:"upgrade-title-skeleton",loading:!0,active:"",paragraph:!1})])])]),Dn],64))),64))])])])}const Bn=K(Pn,[["render",Nn],["__scopeId","data-v-d863b1fb"]]),En=G({props:{positionStatus:{type:String,default:"Active"},positionInfo:{type:Object,default:()=>({})}},setup(){return{}}});const Mn=o=>(no("data-v-882c76c0"),o=o(),to(),o),qn={class:"position-info"},Wn={key:0,class:"status-bg"},Vn=Mn(()=>s("img",{src:ss,alt:""},null,-1)),Hn=[Vn],Jn={class:"status-text"},zn={class:"name-range"};function Qn(o,r,g,p,_,a){const i=Vo;return n(),t("div",qn,[s("div",{class:fo(["position-status",o.positionStatus!=="Active"?"position-status-inactive":""])},[o.positionStatus=="Active"?(n(),t("div",Wn,Hn)):D("",!0),s("div",Jn,b(o.positionStatus),1)],2),s("div",zn,[s("span",null,b(o.positionInfo.name),1),o.positionStatus=="Active"?(n(),O(i,{key:0,"pool-info":o.positionInfo},null,8,["pool-info"])):D("",!0)])])}const Gn=K(En,[["render",Qn],["__scopeId","data-v-882c76c0"]]),Kn=G({props:{positionInfo:{type:Object,default:()=>({})},currentTab:{type:String,default:""}},setup(o){const r=_o(),g=c(()=>r),p=Uo(),_=J=>{var C;return((C=g.value.tokensObj[J])==null?void 0:C.logo_url)||Ro("/image/coins/sui-unknown.png")},a=Lo("Sui"),i=jo("Sui"),d=E(!1),$=Co(),I=ao(),h=lo(),f=c(()=>I),{setIsShowSuccess:S,setIsShowRejected:j,setIsShowWaiting:e,setTransactionDesc:k,setTransactionTxid:L}=$;return{getCoinIcon:_,router:p,claim:async()=>{console.log(o.positionInfo,"props.positionInfo"),d.value=!0,L(""),k("Claim rewards"),e(!0);const J={pool_id:o.positionInfo.farmsPoolId,position_nft_id:o.positionInfo.id};try{const C=await i.harvestFarms(J),U=await f.value.currentWallet.signAndExecuteTransactionBlock(C);console.log("0221###sui swap res###",U);let M=a.handleTx(U);if(M&&M.hash){L(M.hash),e(!1),S(!0);let y={title:"Claim",res:M.res,hash:M.hash};a.showTransitionPending(y),await a.watchTransaction(y)&&setTimeout(()=>{h.getPositionByPool(f.value.address,o.positionInfo.clmm_pool_id,o.positionInfo.farmsPoolId)},2e3)}else e(!1),j(!0);d.value=!1}catch(C){console.log("farmsDeposit error",C),e(!1),j(!0),d.value=!1}},unStake:async()=>{console.log(o.positionInfo,"props.positionInfo"),d.value=!0,L(""),k(`Unstake ${o.positionInfo.name}`),e(!0);const J=o.positionInfo.farmsPoolId,C=o.positionInfo.id;try{const U=await i.farmsWithdraw(J,C),M=await f.value.currentWallet.signAndExecuteTransactionBlock(U);console.log("0221###sui swap res###",M);let y=a.handleTx(M);if(y&&y.hash){L(y.hash),e(!1),S(!0);let T={res:y.res,title:"Unstaked",hash:y.hash};a.showTransitionPending(T),await a.watchTransaction(T)&&setTimeout(()=>{console.log(o.positionInfo,"##props.positionInfo"),h.getPositionByPool(f.value.address,o.positionInfo.clmm_pool_id,o.positionInfo.farmsPoolId),d.value=!1},2e3)}else e(!1),j(!0)}catch(U){console.log("farmsDeposit error",U),e(!1),j(!0),d.value=!1}},loading:d,stake:async()=>{console.log(o.positionInfo,"props.positionInfo"),d.value=!0,L(""),k(`Stake ${o.positionInfo.name}`),e(!0);const J={clmm_pool_id:o.positionInfo.clmmPool,clmm_position_id:o.positionInfo.pos_object_id,coinTypeA:o.positionInfo.coin_type_a,coinTypeB:o.positionInfo.coin_type_b},C=o.positionInfo.farmsPoolId;try{const U=await i.farmsDeposit(J,C),M=await f.value.currentWallet.signAndExecuteTransactionBlock(U);console.log("0221###sui swap res###",M);let y=a.handleTx(M);if(y&&y.hash){L(y.hash),e(!1),S(!0);let T={res:y.res,title:"Staked",hash:y.hash};a.showTransitionPending(T),await a.watchTransaction(T)&&setTimeout(()=>{h.getPositionByPool(f.value.address,o.positionInfo.clmm_pool_id,o.positionInfo.farmsPoolId),d.value=!1},2e3)}else e(!1),j(!0)}catch(U){console.log("farmsDeposit error",U),e(!1),j(!0),d.value=!1}},sFixD:H,addCommom:A}}});const is=o=>(no("data-v-beaeeb53"),o=o(),to(),o),Xn={class:"farms-position"},Yn={class:"farms-position-box"},Zn={class:"position-info-block"},xn={class:"block-item"},ot=is(()=>s("div",{class:"leabl"},"Liquidity",-1)),st={class:"text"},et={class:"earnings"},nt={class:"block-item"},tt=is(()=>s("div",{class:"leabl"},"Earnings",-1)),at={class:"text"},it={key:0},lt={alt:""},rt={key:1,class:"rewards-day"},dt={class:"unstake-btn-box"};function ct(o,r,g,p,_,a){const i=Gn,d=$o,$=Oo("image");return n(),t("div",Xn,[s("div",Yn,[P(i,{"position-info":o.positionInfo},null,8,["position-info"])]),s("div",Zn,[s("div",xn,[ot,s("div",st,b(o.positionInfo.positionUSD>0&&o.positionInfo.positionUSD<.01?"<$0.01":`~$${("addCommom"in o?o.addCommom:w(A))(("sFixD"in o?o.sFixD:w(H))(o.positionInfo.positionUSD,2))}`),1)])]),s("div",et,[s("div",nt,[tt,s("div",at,[o.positionInfo.rewards&&o.positionInfo.rewards.length>0?(n(!0),t(W,{key:0},x(o.positionInfo.rewards,I=>(n(),t("div",{key:I.rewarder_type,class:"rewards-day"},[I.rewarderAmount>0?(n(),t("div",it,[eo(s("img",lt,null,512),[[$,o.getCoinIcon(I.rewarder_type)]]),s("span",null,b(I.rewarderAmount),1)])):D("",!0)]))),128)):(n(),t("div",rt,"--"))])]),o.positionInfo.positionSource=="clmm"?(n(),O(d,{key:0,class:"add-liquidity-btn claim-btn",onClick:r[0]||(r[0]=I=>o.router.push(`/new-position-detail?collect=${o.positionInfo.collectionName}&&token=${o.positionInfo.tokenName}&&address=${o.positionInfo.pool}&pos=${o.positionInfo.pos_object_id}`))},{default:R(()=>[F("+ Add liquidity")]),_:1})):(n(),O(d,{key:1,class:"claim-btn",disabled:o.positionInfo.positionRewardAmount==0||o.currentTab=="Ended",onClick:o.claim},{default:R(()=>[F("↑ Claim")]),_:1},8,["disabled","onClick"]))]),s("div",dt,[s("div",null,[o.positionInfo.positionSource=="clmm"?(n(),O(d,{key:0,class:"unstake-btn",loading:o.loading,disabled:o.positionInfo.positionStatus!=="Active",onClick:o.stake},{default:R(()=>[F("Stake")]),_:1},8,["loading","disabled","onClick"])):(n(),O(d,{key:1,class:"unstake-btn",onClick:o.unStake},{default:R(()=>[F("Unstake")]),_:1},8,["onClick"]))])])])}const ls=K(Kn,[["render",ct],["__scopeId","data-v-beaeeb53"]]),ut=G({components:{FarmsH5Position:ls},props:{currentTab:{type:String,default:""},sortValue:{type:String,default:"APR"}},setup(o){const r=E(!1),g=ao(),p=c(()=>g),_=lo(),a=c(()=>_),i=c(()=>(console.log(a.value.farmsPoolList,"##farms.value.farmsPoolList"),o.currentTab=="My Farms"?p.value.address?a.value.myFarmsPoolList:[]:o.currentTab=="Ended"?a.value.farmsPoolList.filter(l=>l.status=="Ended"):a.value.farmsPoolList.filter(l=>l.status=="Live"))),d=E([]),$=Co(),I=c(()=>$),h=c(()=>I.value.addressLpTokens),f=l=>{const u=i.value.map(m=>{const{stable_farming:v}=h.value[m.clmm_pool_id];return{...m,apr:v.apr,tvl:v.tvl}});l=="APR"?d.value=u.sort((m,v)=>v.apr-m.apr):d.value=u.sort((m,v)=>v.tvl-m.tvl),console.log(d.value,"##farmsPoolList.value")};bo(()=>[i.value,o.sortValue,h.value],([l,u,m])=>{console.log(u,"sortValue326"),l&&l.length>0&&u&&m&&!V(m)&&f(u)},{immediate:!0});const S=c(()=>a.value.farmsUserUsd),j=c(()=>(console.log(a.value.farmsRewardObj,"##farmsRewardObj"),a.value.farmsRewardObj)),e=c(()=>a.value.farmsPositionObj),k=c(()=>a.value.farmsPoolListLoading),L=c(()=>a.value.farmsPositionList),io=c(()=>(console.log(a.value.farmsLoadingObj,"##farms.value.farmsLoadingObj"),a.value.farmsLoadingObj)),X=c(()=>a.value.farmsAllPositionLoading),B=E({}),J=l=>{B.value[l.clmm_pool_id]?B.value[l.clmm_pool_id]=!1:(B.value[l.clmm_pool_id]=!0,console.log("执行了吗"),_.getPositionByPool(p.value.address,l.clmm_pool_id,l.id))},C=jo("Sui"),U=Lo("Sui"),{setIsShowSuccess:M,setIsShowRejected:y,setIsShowWaiting:T,setTransactionDesc:z,setTransactionTxid:q}=$,N=async l=>{console.log(L.value,"farmsRewardObj###");const u=[];L.value.forEach(m=>{console.log(l,m,"#position"),l==m.clmm_pool_id&&u.push({pool_id:m.pool_id,position_nft_id:m.id})}),console.log(JSON.stringify(u),"##params"),q(""),z("Claim rewards"),T(!0);try{const m=await C.batchHarvest(u),v=await p.value.currentWallet.signAndExecuteTransactionBlock(m);console.log("0221###sui swap res###",v);let Q=U.handleTx(v);if(Q&&Q.hash){q(Q.hash),T(!1),M(!0);let oo={res:Q.res,title:"Claim",hash:Q.hash};U.showTransitionPending(oo),await U.watchTransaction(oo)&&setTimeout(()=>{_.getFarmsPoolList()},4e3)}else T(!1),y(!0)}catch(m){console.log("Claim all error",m),T(!1),y(!0)}},Z=Uo(),co=_o(),ho=c(()=>co),Do=c(()=>(console.log(ho.value.poolsObj,"##pools.value.poolsObj"),ho.value.poolsObj)),uo=c(()=>ho.value.tokensObj),mo=E({}),No=(l,u)=>l&&u?Go.plus(vo(l),vo(u)):l||0,Bo=l=>{let u=0;return l&&l.forEach(m=>{u+=vo(String(m))}),String(so(String(u),2))},Eo=(l,u,m)=>{console.log(l,"poolsObj##473"),Object.keys(l).forEach(v=>{var po,wo,yo;const Q=(po=u[v])==null?void 0:po.apr_7day,oo=No((wo=u[v])==null?void 0:wo.apr_7day,Bo((yo=u[v])==null?void 0:yo.rewarder_apr));mo.value[v]={...l[v],apr:String(Q).replace("%",""),aprTotal:oo},mo.value[v].rewards=[],l[v].rewarderInfo.forEach((Mo,Io)=>{var Po,To;const ko=(Po=m[Mo.coinAddress])==null?void 0:Po.symbol,So=(To=u[v])==null?void 0:To.rewarder_apr[Io];console.log(ko,So,"getRewardInfo:"),console.log(l[v],"## poolsObj[key]"),mo.value[v].rewards.push({symbol:ko,rewarderApr:So,rewarder_display:l[v][`rewarder_display${Io+1}`]})})}),console.log(mo.value,"##rewardInfoObj")};return bo(()=>[Do.value,h.value,uo.value],([l,u,m])=>{l&&!V(l)&&u&&!V(u)&&m&&!V(m)&&Eo(l,u,m)},{immediate:!0}),{isShowMore:r,wallet:p,farmsPoolList:d,farmsUserUsd:S,sFixD:H,farmsRewardObj:j,farmsPositionObj:e,openMore:J,checkNullObj:V,openMoreObj:B,farmsPoolListLoading:k,claimPoolReward:N,router:Z,addCommom:A,farmsLoadingObj:io,farmsAllPositionLoading:X,addressLpTokens:h,rewardInfoObj:mo}}});const Y=o=>(no("data-v-473bf854"),o=o(),to(),o),mt={key:0,class:"farms-pool-list"},pt={class:"farms-block"},ft={class:"item-block"},_t=Y(()=>s("div",{class:"leabl"},"Staked TVL",-1)),ht={class:"text"},vt={class:"item-block apr"},gt=Y(()=>s("div",{class:"leabl"},"APR",-1)),bt={class:"text"},$t={class:"apr-hover-box"},wt={class:"item-block"},yt=Y(()=>s("div",{class:"leabl"},"Rewards / day",-1)),It={class:"text"},kt={class:"item-block my-staked"},St=Y(()=>s("div",{class:"leabl"},"My Staked",-1)),Pt={key:0,class:"text"},Tt={class:"position-usd"},jt={key:0,class:"position-num"},Lt={key:1,class:"text"},Ot=Y(()=>s("div",{class:"position-usd"},"--",-1)),Ct=[Ot],Ut={class:"item-block"},Rt=Y(()=>s("div",{class:"leabl"},"Earned",-1)),At={class:"text earned-box"},Ft={class:"earned"},Dt={key:0,class:"my-staked-loading"},Nt=Y(()=>s("div",{class:"ratio-bg"},[s("div",{class:"ratio"})],-1)),Bt={key:0},Et={key:1},Mt={key:2},qt={key:2},Wt={class:"add-liquidity-box"},Vt=["onClick"],Ht=Y(()=>s("use",{"xlink:href":"#icon-icon_arrow"},null,-1)),Jt=[Ht],zt={key:1,class:"upgrade-loading"},Qt={key:2,class:"no-data"},Gt=Y(()=>s("img",{src:Ko,alt:""},null,-1)),Kt={key:3,class:"no-data"},Xt=Y(()=>s("img",{src:Xo,alt:""},null,-1)),Yt=Y(()=>s("span",null,"No Data",-1)),Zt=[Xt,Yt];function xt(o,r,g,p,_,a){const i=Zo,d=Qo,$=xo,I=Wo,h=$o,f=ls,S=ns,j=ms;return n(),t(W,null,[o.farmsPoolListLoading?o.farmsPoolListLoading?(n(),t("div",zt,[P(j,{type:"poolsCard",loading:!0})])):D("",!0):(n(),t("div",mt,[(n(!0),t(W,null,x(o.farmsPoolList,e=>(n(),t("div",{key:e.id,class:"farms-item"},[P(i,{"pool-info":e},null,8,["pool-info"]),s("div",pt,[s("div",ft,[_t,s("div",ht,"$"+b(("addCommom"in o?o.addCommom:w(A))(o.addressLpTokens&&o.addressLpTokens[e.clmm_pool_id]&&o.addressLpTokens[e.clmm_pool_id].stable_farming&&o.addressLpTokens[e.clmm_pool_id].stable_farming.tvl,2)),1)]),s("div",vt,[gt,s("div",bt,[F(b(e.stable_farming.apr*100>0&&e.stable_farming.apr*100<.01?"<0.01%":("sFixD"in o?o.sFixD:w(H))(e.stable_farming.apr*100,2))+"% ",1),s("div",$t,[!("checkNullObj"in o?o.checkNullObj:w(V))(o.rewardInfoObj)&&o.rewardInfoObj[e.clmm_pool_id]?(n(),O(d,{key:0,"l-item":o.rewardInfoObj[e.clmm_pool_id],"rewarder-info":o.rewardInfoObj[e.clmm_pool_id].rewards,class:"noHover apr-hover-con"},null,8,["l-item","rewarder-info"])):D("",!0)])])]),s("div",wt,[yt,s("div",It,[(n(!0),t(W,null,x(e.rewarders,k=>(n(),O($,{key:k.reward_coin,"reward-info":k,"current-tab":o.currentTab},null,8,["reward-info","current-tab"]))),128))])]),s("div",kt,[St,o.wallet.address?(n(),t("div",Pt,[s("div",Tt," $"+b(("sFixD"in o?o.sFixD:w(H))(o.farmsUserUsd&&o.farmsUserUsd[e.clmm_pool_id]&&o.farmsUserUsd[e.clmm_pool_id].amount||0,2)),1),o.farmsUserUsd&&o.farmsUserUsd[e.clmm_pool_id]&&o.farmsUserUsd[e.clmm_pool_id].positionNum?(n(),t("div",jt,b(o.farmsUserUsd[e.clmm_pool_id].positionNum)+" "+b(o.farmsUserUsd[e.clmm_pool_id].positionNum>1?"Positions":"Position"),1)):D("",!0)])):(n(),t("div",Lt,Ct))]),s("div",Ut,[Rt,s("div",At,[s("div",Ft,[o.farmsLoadingObj[e.clmm_pool_id]||o.farmsAllPositionLoading?(n(),t("div",Dt,[P(I,{class:"upgrade-title-skeleton",loading:!0,active:"",paragraph:!1})])):o.wallet.address&&o.farmsRewardObj&&o.farmsRewardObj[e.clmm_pool_id]&&o.farmsRewardObj[e.clmm_pool_id].amountUsd?(n(),t(W,{key:1},[Nt,o.farmsRewardObj[e.clmm_pool_id].amountUsd>.01?(n(),t("span",Bt,"$"+b(("addCommom"in o?o.addCommom:w(A))(("sFixD"in o?o.sFixD:w(H))(o.farmsRewardObj[e.clmm_pool_id].amountUsd||0,2))),1)):o.farmsRewardObj[e.clmm_pool_id].amountUsd>0&&o.farmsRewardObj[e.clmm_pool_id].amountUsd<.01?(n(),t("span",Et,"<$0.01")):(n(),t("span",Mt,"0"))],64)):(n(),t("span",qt,"--"))]),P(h,{class:"claim-btn",disabled:!o.wallet.address||!o.farmsRewardObj[e.clmm_pool_id]||o.farmsRewardObj[e.clmm_pool_id].amountUsd<=0,onClick:go(k=>o.claimPoolReward(e.clmm_pool_id),["stop"])},{default:R(()=>[F("Claim")]),_:2},1032,["disabled","onClick"])])])]),s("div",Wt,[P(h,{class:"add-liquidity-btn",onClick:go(k=>o.router.push(`/liquidity/deposit?poolAddress=${e.clmm_pool_id}`),["stop"])},{default:R(()=>[F("+ Add liquidity")]),_:2},1032,["onClick"])]),s("div",{class:"more-btn",onClick:k=>o.openMore(e)},[(n(),t("svg",{class:fo(["arrow-icon",!("checkNullObj"in o?o.checkNullObj:w(V))(o.openMoreObj)&&o.openMoreObj[e==null?void 0:e.clmm_pool_id]?"open-more":""]),"aria-hidden":"true"},Jt,2))],8,Vt),(n(!0),t(W,null,x(o.farmsPositionObj[e.clmm_pool_id],k=>eo((n(),O(f,{key:k.clmm_pool_id,"current-tab":o.currentTab,"position-info":{...k,clmm_pool_id:e.clmm_pool_id}},null,8,["current-tab","position-info"])),[[Jo,!("checkNullObj"in o?o.checkNullObj:w(V))(o.openMoreObj)&&o.openMoreObj[e==null?void 0:e.clmm_pool_id]]])),128)),o.farmsPositionObj&&o.farmsPositionObj[e.clmm_pool_id]&&o.farmsPositionObj[e.clmm_pool_id].length==0?(n(),O(S,{key:0,"no-data-img":"/sui-image/img-no-Positions@2x.png",desc:"No Position Found",type:"addLiquidity","add-liquidity-url":`/liquidity/deposit?poolAddress=${e.clmm_pool_id}`},null,8,["add-liquidity-url"])):D("",!0),o.wallet.address?D("",!0):(n(),O(S,{key:1,"no-data-img":"/sui-image/img-connect-wallet@2x.png",type:"connectWallet"},null,8,["no-data-img"]))]))),128))])),!o.wallet.connected&&o.currentTab=="My Farms"?(n(),t("div",Qt,[Gt,P(h,{class:"connect-wallet",onClick:r[0]||(r[0]=e=>o.wallet.setIsShowWalletModal(!0))},{default:R(()=>[F(b(o.$t("button.connectWallet")),1)]),_:1})])):o.farmsPoolList.length==0?(n(),t("div",Kt,Zt)):D("",!0)],64)}const rs=K(ut,[["render",xt],["__scopeId","data-v-473bf854"]]),oa=G({setup(o,r){const g=["Live","Ended","My Farms"],p=E("Live"),_=E("APR"),a=E(!1),i=E(!1),d=lo(),$=c(()=>d),I=ao(),h=c(()=>I),f=c(()=>p.value=="My Farms"?h.value.address?$.value.myFarmsPoolList:[]:p.value=="Ended"?$.value.farmsPoolList.filter(L=>L.status=="Ended"):$.value.farmsPoolList.filter(L=>L.status=="Live")),S=L=>f.value.length,j=()=>{a.value=!0,d.getFarmsPoolList(),setTimeout(()=>{a.value=!1},1e3)},e=L=>{p.value=L,r.emit("changeTab",L)},k=L=>{_.value=L,r.emit("changeSortValue",L)};return zo(()=>{document.addEventListener("click",()=>{i.value=!1})}),{isOpenList:i,tabList:g,currentTab:p,sortValue:_,clickRefresh:j,isRefresh:a,farmsPoolList:f,getListNum:S,changeTab:e,changeSortValue:k}}});const Fo=o=>(no("data-v-6becc19e"),o=o(),to(),o),sa={class:"farms-tab"},ea={class:"tab-left"},na=["onClick"],ta={key:0},aa={class:"tab-right"},ia={class:"sort-select"},la=Fo(()=>s("div",null,"Sort by",-1)),ra=Fo(()=>s("svg",{class:"sort-icon","aria-hidden":"true"},[s("use",{"xlink:href":"#icon-icon_on-pool"})],-1)),da=Fo(()=>s("use",{"xlink:href":"#icon-icon_arrow"},null,-1)),ca=[da],ua={key:0,class:"sort-list"},ma={class:"refresh"},pa=Fo(()=>s("use",{"xlink:href":"#icon-icon-refresh2"},null,-1)),fa=[pa];function _a(o,r,g,p,_,a){return n(),t("div",sa,[s("div",ea,[(n(!0),t(W,null,x(o.tabList,i=>(n(),t("div",{key:i,class:fo(["tab-item",o.currentTab==i?"tab-item-active":""]),onClick:d=>o.changeTab(i)},[s("span",null,b(i=="Ended"?"Finished":i),1),o.currentTab==i&&o.getListNum(i)?(n(),t("p",ta,b(o.getListNum(i)),1)):D("",!0)],10,na))),128))]),s("div",aa,[s("div",ia,[s("div",{class:"sort-select-box",onClick:r[0]||(r[0]=go(i=>o.isOpenList=!o.isOpenList,["stop"]))},[la,s("div",null,[s("span",null,b(o.sortValue),1),ra,(n(),t("svg",{class:fo(["arrow-icon",o.isOpenList?"arrow-icon-active":""]),"aria-hidden":"true"},ca,2))])]),o.isOpenList?(n(),t("div",ua,[s("div",{class:"sort-item",onClick:r[1]||(r[1]=i=>o.changeSortValue("APR"))},"APR"),s("div",{class:"sort-item",onClick:r[2]||(r[2]=i=>o.changeSortValue("TVL"))},"TVL")])):D("",!0)]),s("div",ma,[(n(),t("svg",{"aria-hidden":"true",class:fo(["refresh-icon",o.isRefresh?"refreshing":""]),onClick:r[3]||(r[3]=(...i)=>o.clickRefresh&&o.clickRefresh(...i))},fa,2))])])])}const ha=K(oa,[["render",_a],["__scopeId","data-v-6becc19e"]]),va=G({components:{FarmsBanner:Yo,FarmsTabs:ha,FarmsTable:ts,FarmsH5List:rs},setup(){const o=lo(),r=c(()=>o),g=c(()=>r.value.farmsPoolListLoading),p=E("APR"),_=c(()=>r.value.farmsPoolList),a=ao(),i=c(()=>a),d=_o(),$=c(()=>d);bo(()=>[i.value.address,_.value,$.value.tokensObj,$.value.RATES],([h,f,S,j])=>{h&&f.length>0&&!V(S)&&!V(j)&&o.getPositionByAllPool(h)},{immediate:!0}),zo(()=>{o.getFarmsPoolList()}),bo(()=>i.value.address,h=>{h||o.logOut()},{immediate:!0});const I=E("Live");return{farmsPoolListLoading:g,currentTab:I,sortValue:p}}});const ga={class:"farm-container"},ba={class:"farm-container-center"};function $a(o,r,g,p,_,a){const i=Yo,d=us("FarmsTabs"),$=ts,I=Bn,h=rs;return n(),t("div",ga,[P(i),s("div",ba,[P(d,{onChangeTab:r[0]||(r[0]=f=>{o.currentTab=f}),onChangeSortValue:r[1]||(r[1]=f=>{o.sortValue=f})}),o.farmsPoolListLoading?(n(),O(I,{key:1,"current-tab":o.currentTab},null,8,["current-tab"])):(n(),O($,{key:0,"current-tab":o.currentTab,"sort-value":o.sortValue},null,8,["current-tab","sort-value"])),P(h,{"current-tab":o.currentTab,"sort-value":o.sortValue},null,8,["current-tab","sort-value"])])])}const Ea=K(va,[["render",$a],["__scopeId","data-v-12d06cb2"]]);export{Ea as default};
