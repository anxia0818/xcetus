import{_ as tn}from"./back.e414888f.js";import{_ as sn}from"./refresh-icon.82675b95.js";import{a as je,M as Mo,l as Co,r as w,m as ln,e as Ue,q as to,o as a,c as te,w as he,h as o,i as z,j as Le,t as d,f,F as no,s as Oo,v as Fe,x as j,y as an,I as un,B as Ao,p as Ee,k as We,z as co,A as po,C as $,D as $e,b as Po,E as Qe,G as So,H as Ke,u as P,J as Lo,K as $o,L as Uo,N as ho}from"./entry.198f9d98.js";/* empty css              */import{_ as rn,a as dn,b as vn}from"./icon-error_2x.2fcdb740.js";import{u as He,a as Vo}from"./autoPool.8a1f9c9b.js";import{u as xe,c as Ze,a as R,g as wo,d as Ve,s as T,f as mn,T as Oe,b as de,p as Fo,e as jo,h as cn,i as pn,j as fn}from"./pool.52163722.js";import{_ as fo}from"./token-warning.74ea1c39.js";import{_ as Eo}from"./auto-pool-apy-tips.7af0aebf.js";import{u as yo,a as To}from"./sha256.c09cedd1.js";import{i as uo}from"./import-icon.de3e6c66.js";import"./decimal.6f03adc8.js";import{D as r}from"./decimal.0bdeb344.js";import{_ as Wo}from"./assets-card.65ae4fa7.js";import{_ as Xo}from"./coin-lock.4a356e98.js";import{_ as Go,a as Ho}from"./auto-pool-remove-modal.8e46503f.js";import{afterCurrentPrice as _o}from"./data.2996e95c.js";import{V as Io}from"./index.ad6a2549.js";/* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              */import"./img-lock_2x.a28135f4.js";import"./img-lock_2x.81fc0ee2.js";const yn=je({components:{Modal:Mo},setup(e,n){const{t:G,locale:H}=Co(),B=He(),S=["0.1","0.5","1"],u=w(B.slippage||.1),{setSlippage:c}=B,_=ln();console.log(u.value,"slippage.value");const y=w(!1);function s(N,i){y.value=!1,u.value=i}function t(){c(u.value),n.emit("onClose",!1)}return{settingArr:S,changeActiveIndex:s,confirm:t,emit:_,slippage:u,t:G,isInput:y}}});const Yo=e=>(Ee("data-v-405dfb5e"),e=e(),We(),e),bn=Yo(()=>o("svg",{class:"icon modal-icon-close","aria-hidden":"true"},[o("use",{"xlink:href":"#icon-a-icon-Shutdown"})],-1)),gn={class:"setting-container"},kn={class:"title"},hn=Yo(()=>o("img",{src:vn,alt:""},null,-1)),_n={class:"tag-list"},$n={key:0,src:rn,alt:""},wn={key:1,src:dn,alt:""},In={class:"footer"};function Cn(e,n,G,H,B,S){const u=an,c=un,_=Ao,y=to("Modal");return a(),te(y,{title:"Settings",class:"setting",centered:"",visible:!0,width:"400px",onCancel:n[3]||(n[3]=s=>e.$emit("onClose"))},{closeIcon:he(()=>[bn]),footer:he(()=>[o("div",In,[z(_,{type:"cancel",class:"cancel-btn cancel-btn-new",onClick:n[2]||(n[2]=s=>e.$emit("onClose"))},{default:he(()=>[Le(d(e.$t("button.cancel")),1)]),_:1}),z(_,{class:"confirmbtn",disabled:Number(e.slippage)==0||Number(e.slippage)>1||Number(e.slippage)<.01,onClick:e.confirm},{default:he(()=>[Le(d(e.$t("button.confirm")),1)]),_:1},8,["disabled","onClick"])])]),default:he(()=>[o("div",gn,[o("div",kn,[hn,o("span",null,d(e.$t("modal.slippageTolerance")),1)]),o("div",_n,[(a(!0),f(no,null,Oo(e.settingArr,(s,t)=>(a(),te(u,{key:t,class:Fe(!e.isInput&&s==e.slippage?"tag-active":""),onClick:N=>e.changeActiveIndex(t,s)},{default:he(()=>[Le(d(s)+"% ",1)]),_:2},1032,["class","onClick"]))),128)),z(u,{class:Fe(["input-tag",e.isInput?"tag-active":""]),onClick:n[1]||(n[1]=s=>e.isInput=!0)},{default:he(()=>[z(c,{value:e.slippage,"onUpdate:value":n[0]||(n[0]=s=>e.slippage=s),placeholder:"",suffix:"%",class:Fe(["slippage-input",Number(e.slippage)>.5&&Number(e.slippage)<1?"slippage-input-waring":Number(e.slippage)>1?"slippage-input-error":""])},null,8,["value","class"])]),_:1},8,["class"])])]),Number(e.slippage)>.5&&Number(e.slippage)<1||Number(e.slippage)>1?(a(),f("div",{key:0,class:Fe(["slippage-hint",Number(e.slippage)>.5&&Number(e.slippage)<1?"slippage-hint-waring":Number(e.slippage)>1?"slippage-hint-error":""])},[Number(e.slippage)>.5&&1>=Number(e.slippage)?(a(),f("img",$n)):j("",!0),Number(e.slippage)>1?(a(),f("img",wn)):j("",!0),o("p",null,d(Number(e.slippage)>.5&&1>=Number(e.slippage)?e.$t("tips.slippageTolerance2"):Number(e.slippage)>1?e.$t("tips.slippageTolerance1"):""),1)],2)):j("",!0)]),_:1})}const An=Ue(yn,[["render",Cn],["__scopeId","data-v-405dfb5e"]]),Pn=je({props:{poolInfo:{type:Object,default:()=>({})}},setup(e,n){const G=w(!1),H=w(null),B=w(0);let S=w(!1);const u=w(20),c=xe(),_=He(),y=w(!1);co(()=>{}),po(()=>{clearInterval(H.value)});const s=()=>{S.value=!1,H.value=setInterval(()=>{var m;y.value||B.value<u.value&&(B.value+=1,B.value===u.value&&((m=e==null?void 0:e.poolInfo)!=null&&m.poolAddress&&c.updateCurrentPools(e.poolInfo.poolAddress,store.chainName),B.value=0))},1e3)},t=$(()=>_.slippage),N=()=>{n.emit("clearAll")},i=()=>{S.value=!0,B.value=0,n.emit("clickRefresh"),setTimeout(()=>{S.value=!1,s()},1e3)};$e(()=>e.poolInfo,m=>{m&&!H.value&&s()},{immediate:!0});const v=Po(),g=Qe();return console.log(g,"route"),{refresh:S,clickRefresh:i,isShowSwapSetting:G,countdown:B,autoRefreshTime:u,slippage:t,clearAll:N,checkNullObj:Ze,router:v,route:g}}});const Sn=e=>(Ee("data-v-7418921d"),e=e(),We(),e),Tn={class:"title"},Rn={class:"left"},Nn=Sn(()=>o("svg",{class:"icon","aria-hidden":"true"},[o("use",{"xlink:href":"#icon-a-icon-setslippage"})],-1)),qn={key:0,class:"deposit-progress"};function Bn(e,n,G,H,B,S){const u=tn,c=sn,_=An;return a(),f("div",Tn,[o("div",Rn,[z(u)]),o("div",{class:Fe(["right title-right deposit-setting",e.poolInfo?"havePoolInfo":"noPoolInfo"])},[o("div",{class:"slippage-icon",onClick:n[0]||(n[0]=y=>e.isShowSwapSetting=!0)},[Nn,o("span",null,d(e.slippage)+"%",1)]),e.route.name!=="liquidity-create"?(a(),f("div",qn,[z(c,{loading:e.refresh,"auto-refresh-time":e.autoRefreshTime,countdown:e.countdown,onClickRefresh:e.clickRefresh},null,8,["loading","auto-refresh-time","countdown","onClickRefresh"])])):j("",!0)],2),e.isShowSwapSetting?(a(),te(_,{key:0,onOnClose:n[1]||(n[1]=y=>e.isShowSwapSetting=!1)})):j("",!0)])}const Dn=Ue(Pn,[["render",Bn],["__scopeId","data-v-7418921d"]]),Fn=je({components:{AutoPoolApyTips:Eo},setup(){const e=yo(),n=$(()=>e),G=xe(),H=$(()=>G),B=He(),S=$(()=>B),u=$(()=>n.value.theme),c=Qe(),_=w();$e(()=>[S.value.positionInfoObj,c.params.id],([i,v])=>{i&&!Ze(i)&&v&&(_.value=i[v],console.log(_.value,"##positionInfo.value"))},{immediate:!0,deep:!0});const y=$(()=>{var i;return(i=_.value)==null?void 0:i.needReverse}),s=i=>{var v;return(i==null?void 0:i.logoURI)||(i==null?void 0:i.logo_url)||((v=H.value.tokensObj[i==null?void 0:i.address])==null?void 0:v.logo_url)||(u.value==="default"?uo("/image/coins/unknown.png"):uo("/image/coins/sui-unknown.png"))},t=$(()=>{var i,v;return console.log((i=_==null?void 0:_.value)==null?void 0:i.poolUSD,"##positionInfo?.value?.poolUSD"),(v=_==null?void 0:_.value)==null?void 0:v.poolUSD}),N=$(()=>{var i,v;return S.value.apyObj&&((v=S.value.apyObj[(i=_.value)==null?void 0:i.id])==null?void 0:v.apr)||"--"});return{positionInfo:_,needReverse:y,getCoinIcon:s,tvl:t,apy:N,addCommom:R,getExplorerUrl:wo}}});const Xe=e=>(Ee("data-v-64d0287a"),e=e(),We(),e),Mn={class:"auto-pool-v2-info"},On={class:"pool-info"},Ln={class:"left"},Un={class:"coin-a"},Vn={alt:""},jn={class:"coin-b"},En={alt:""},Wn={class:"position-name"},Xn={key:0,class:"pool-fee"},Gn=Xe(()=>o("span",null,"Fee tier",-1)),Hn={class:"vault-address"},Yn=["href"],zn=Xe(()=>o("span",null,"Vault Address",-1)),Jn=Xe(()=>o("svg",{class:"icon","aria-hidden":"true"},[o("use",{"xlink:href":"#icon-icon-link"})],-1)),Kn=[zn,Jn],Zn={class:"apy-and-tvl"},Qn={class:"apy"},xn=Xe(()=>o("div",{class:"apy-title"},"APY",-1)),et={class:"apy-text"},ot={class:"tvl"},nt=Xe(()=>o("div",{class:"tvl-title"},"TVL",-1)),tt={class:"tvl-text"},st={class:"pool-info h5-pool-info"},it={class:"left"},lt={class:"coin-a"},at={alt:""},ut={class:"coin-b"},rt={alt:""},dt={class:"position-name"},vt={key:0,class:"pool-fee"},mt=Xe(()=>o("span",null,"Fee tier",-1)),ct={class:"left"},pt={class:"vault-address"},ft=["href"],yt=Xe(()=>o("span",null,"Vault Address",-1)),bt=Xe(()=>o("svg",{class:"icon","aria-hidden":"true"},[o("use",{"xlink:href":"#icon-icon-link"})],-1)),gt=[yt,bt],kt={class:"apy-and-tvl"},ht={class:"apy"},_t=Xe(()=>o("div",{class:"apy-title"},"APY",-1)),$t={class:"apy-text"},wt={class:"tvl"},It=Xe(()=>o("div",{class:"tvl-title"},"TVL",-1)),Ct={class:"tvl-text"};function At(e,n,G,H,B,S){var y,s,t,N,i,v,g,m,b,p,D,F,V,ee,k,h,W,E,Y,ie,I,M,ce,pe,fe,ve,le,ue,X,C,J,Ne,ge,we,qe,Ie,ye,Be,Ce,Me,Pe,ze,K,Se,so,eo;const u=fo,c=Eo,_=So("image");return a(),f("div",Mn,[o("div",On,[o("div",Ln,[o("div",Un,[Ke(o("img",Vn,null,512),[[_,e.needReverse?e.getCoinIcon((s=e.positionInfo)==null?void 0:s.token_b):e.getCoinIcon((y=e.positionInfo)==null?void 0:y.token_a)]]),z(u,{address:e.needReverse?(v=(i=e.positionInfo)==null?void 0:i.token_b)==null?void 0:v.address:(N=(t=e.positionInfo)==null?void 0:t.token_a)==null?void 0:N.address,"style-params":{width:"12px",height:"12px",left:"18px",bottom:"4px"}},null,8,["address"])]),o("div",jn,[Ke(o("img",En,null,512),[[_,e.needReverse?e.getCoinIcon((m=e.positionInfo)==null?void 0:m.token_a):e.getCoinIcon((g=e.positionInfo)==null?void 0:g.token_b)]]),z(u,{address:e.needReverse?(F=(D=e.positionInfo)==null?void 0:D.token_a)==null?void 0:F.address:(p=(b=e.positionInfo)==null?void 0:b.token_b)==null?void 0:p.address,"style-params":{width:"12px",height:"12px",left:"18px",bottom:"4px"}},null,8,["address"])]),o("div",Wn,d(e.needReverse?(ee=(V=e.positionInfo)==null?void 0:V.token_b)==null?void 0:ee.symbol:(h=(k=e.positionInfo)==null?void 0:k.token_a)==null?void 0:h.symbol)+" - "+d(e.needReverse?(E=(W=e.positionInfo)==null?void 0:W.token_a)==null?void 0:E.symbol:(ie=(Y=e.positionInfo)==null?void 0:Y.token_b)==null?void 0:ie.symbol),1),(I=e.positionInfo)!=null&&I.fee?(a(),f("div",Xn,[Gn,Le(" "+d(((M=e.positionInfo)==null?void 0:M.fee)*100)+"% ",1)])):j("",!0),o("div",Hn,[o("a",{href:("getExplorerUrl"in e?e.getExplorerUrl:P(wo))("poolAddress",(ce=e.positionInfo)==null?void 0:ce.id),target:"_blank"},Kn,8,Yn)])]),o("div",Zn,[o("div",Qn,[xn,o("div",et,[Le(d(e.apy)+" ",1),z(c)])]),o("div",ot,[nt,o("div",tt,"$"+d(("addCommom"in e?e.addCommom:P(R))(e.tvl,2)),1)])])]),o("div",st,[o("div",it,[o("div",lt,[Ke(o("img",at,null,512),[[_,e.needReverse?e.getCoinIcon((fe=e.positionInfo)==null?void 0:fe.token_b):e.getCoinIcon((pe=e.positionInfo)==null?void 0:pe.token_a)]]),z(u,{address:e.needReverse?(X=(ue=e.positionInfo)==null?void 0:ue.token_b)==null?void 0:X.address:(le=(ve=e.positionInfo)==null?void 0:ve.token_a)==null?void 0:le.address,"style-params":{width:"12px",height:"12px",left:"18px",bottom:"4px"}},null,8,["address"])]),o("div",ut,[Ke(o("img",rt,null,512),[[_,e.needReverse?e.getCoinIcon((J=e.positionInfo)==null?void 0:J.token_a):e.getCoinIcon((C=e.positionInfo)==null?void 0:C.token_b)]]),z(u,{address:e.needReverse?(qe=(we=e.positionInfo)==null?void 0:we.token_a)==null?void 0:qe.address:(ge=(Ne=e.positionInfo)==null?void 0:Ne.token_b)==null?void 0:ge.address,"style-params":{width:"12px",height:"12px",left:"18px",bottom:"4px"}},null,8,["address"])]),o("div",dt,d(e.needReverse?(ye=(Ie=e.positionInfo)==null?void 0:Ie.token_b)==null?void 0:ye.symbol:(Ce=(Be=e.positionInfo)==null?void 0:Be.token_a)==null?void 0:Ce.symbol)+" - "+d(e.needReverse?(Pe=(Me=e.positionInfo)==null?void 0:Me.token_a)==null?void 0:Pe.symbol:(K=(ze=e.positionInfo)==null?void 0:ze.token_b)==null?void 0:K.symbol),1),(Se=e.positionInfo)!=null&&Se.fee?(a(),f("div",vt,[mt,Le(" "+d(((so=e.positionInfo)==null?void 0:so.fee)*100)+"% ",1)])):j("",!0)]),o("div",ct,[o("div",pt,[o("a",{href:("getExplorerUrl"in e?e.getExplorerUrl:P(wo))("poolAddress",(eo=e.positionInfo)==null?void 0:eo.id),target:"_blank"},gt,8,ft)])]),o("div",kt,[o("div",ht,[_t,o("div",$t,[Le(d(e.apy)+" ",1),z(c)])]),o("div",wt,[It,o("div",Ct,"$"+d(("addCommom"in e?e.addCommom:P(R))(e.tvl,2)),1)])])])])}const zo=Ue(Fn,[["render",At],["__scopeId","data-v-64d0287a"]]),Pt=je({components:{Slider:Lo},setup(){const e=w(!0),n=xe(),G=$(()=>n),H=He(),B=$(()=>H),S=Qe(),u=w();$e(()=>[B.value.positionInfoObj,S.params.id],([i,v])=>{i&&!Ze(i)&&v&&(u.value=i[v],console.log(u.value,"##positionInfo.value"))},{immediate:!0,deep:!0});const c=$(()=>{var i;return(i=u.value)==null?void 0:i.needReverse}),_=i=>{var v;return(i==null?void 0:i.logoURI)||(i==null?void 0:i.logo_url)||((v=G.value.tokensObj[i==null?void 0:i.address])==null?void 0:v.logo_url)||uo("/image/coins/sui-unknown.png")},y=$(()=>{var b,p,D;const i=(b=u==null?void 0:u.value)==null?void 0:b.price,v=(p=u==null?void 0:u.value)==null?void 0:p.minPrice,g=(D=u==null?void 0:u.value)==null?void 0:D.maxPrice;let m;if(i>=v&&i<=g){const F=new r(v).add(new r(g)).div(2).toNumber();m=i>F?50+new r(i).sub(F).div(F).toNumber():50-new r(i).sub(F).div(F).toNumber()}else i<v?(m=new r(i).sub(new r(v)).mul(100).toNumber()+15,console.log(m,"##result")):i>g&&(m=new r(i).sub(new r(g)).div(new r(g)).mul(100).toNumber()+70+15);return Number(mn(m,0))}),s=$(()=>{var b,p,D,F,V,ee,k;const i=e.value?((b=u.value)==null?void 0:b.minPrice)&&T(u==null?void 0:u.value.minPrice,6):((p=u.value)==null?void 0:p.maxPrice)&&T(1/(u==null?void 0:u.value.maxPrice),6),v=e.value?((D=u.value)==null?void 0:D.maxPrice)&&T((F=u.value)==null?void 0:F.maxPrice,6):((V=u.value)==null?void 0:V.minPrice)&&T(1/(u==null?void 0:u.value.minPrice),6),g=(c.value?!e.value:e.value)?T((ee=u.value)==null?void 0:ee.price,6):T(1/((k=u.value)==null?void 0:k.price),6);let m={};return m[i]={label:"Min Price"},m[v]={label:"Max Price"},g>i&&g<v?m[g]={label:"Current Price"}:g<i?m[Number(i)+1e-9]={label:"Current Price"}:g>v&&(m[Number(v)-1e-9]={label:"Current Price"}),console.log(m,"obj###"),m}),t=$(()=>{var v,g;const i=(c.value?!e.value:e.value)?Ve((v=u.value)==null?void 0:v.price,6):Ve(1/((g=u.value)==null?void 0:g.price),6);return console.log(i,"result##"),i}),N=$(()=>{var v,g;const i=(c.value?!e.value:e.value)?Ve((v=u.value)==null?void 0:v.price,6):Ve(1/((g=u.value)==null?void 0:g.price),6);return console.log(i,"result##111"),i});return{direct:e,positionInfo:u,needReverse:c,getCoinIcon:_,decimalUi:Ve,addCommom:R,sFixD:T,moveRatio:y,marks:s,currentPrice:t,currentPriceResever:N}}});const bo=e=>(Ee("data-v-220133b5"),e=e(),We(),e),St={class:"v2-position-range"},Tt={class:"position-range-top"},Rt=bo(()=>o("div",null,"Position Range",-1)),Nt={class:"base-coin"},qt={key:0},Bt={alt:""},Dt={key:1},Ft={alt:""},Mt={key:2},Ot={key:3},Lt=bo(()=>o("p",null,"Base coin",-1)),Ut={class:"coin-rate"},Vt=bo(()=>o("div",null,[o("svg",{class:"icon icon-up","aria-hidden":"true"},[o("use",{"xlink:href":"#icon-exchange_up1"})])],-1)),jt=bo(()=>o("div",null,[o("svg",{class:"icon icon-down","aria-hidden":"true"},[o("use",{"xlink:href":"#icon-exchange_down1"})])],-1)),Et=[Vt,jt],Wt={class:"position-range-bottom"},Xt={class:"price-range"},Gt={class:"price-range-bg"},Ht={key:0,class:"min-price"},Yt={key:0},zt={key:1},Jt={key:1,class:"max-price"},Kt={key:0},Zt={key:1},Qt={key:0,class:"min-price"},xt={key:0},es={key:1},os={key:1,class:"max-price"},ns={key:0},ts={key:1};function ss(e,n,G,H,B,S){var y,s,t,N,i,v,g,m,b,p,D,F,V,ee,k,h,W,E,Y,ie,I,M,ce,pe,fe,ve,le,ue;const u=fo,c=to("Slider"),_=So("image");return a(),f("div",St,[o("div",Tt,[Rt,o("div",Nt,[e.needReverse?(a(),f("div",Dt,[Ke(o("img",Ft,null,512),[[_,e.direct?e.getCoinIcon((m=e.positionInfo)==null?void 0:m.token_b):e.getCoinIcon((g=e.positionInfo)==null?void 0:g.token_a)]]),z(u,{address:e.direct?(F=(D=e.positionInfo)==null?void 0:D.token_b)==null?void 0:F.address:(p=(b=e.positionInfo)==null?void 0:b.token_a)==null?void 0:p.address,"style-params":{width:"10px",height:"10px",right:"0",bottom:"0"}},null,8,["address"])])):(a(),f("div",qt,[Ke(o("img",Bt,null,512),[[_,e.direct?e.getCoinIcon((y=e.positionInfo)==null?void 0:y.token_a):e.getCoinIcon((s=e.positionInfo)==null?void 0:s.token_b)]]),z(u,{address:e.direct?(N=(t=e.positionInfo)==null?void 0:t.token_a)==null?void 0:N.address:(v=(i=e.positionInfo)==null?void 0:i.token_b)==null?void 0:v.address,"style-params":{width:"10px",height:"10px",right:"0",bottom:"0"}},null,8,["address"])])),e.needReverse?(a(),f("span",Ot,d(e.direct?(E=(W=e.positionInfo)==null?void 0:W.token_b)==null?void 0:E.symbol:(ie=(Y=e.positionInfo)==null?void 0:Y.token_a)==null?void 0:ie.symbol),1)):(a(),f("span",Mt,d(e.direct?(ee=(V=e.positionInfo)==null?void 0:V.token_a)==null?void 0:ee.symbol:(h=(k=e.positionInfo)==null?void 0:k.token_b)==null?void 0:h.symbol),1)),Lt,o("div",Ut,[o("div",{onClick:n[0]||(n[0]=X=>e.direct=!e.direct)},Et)])])]),o("div",Wt,[o("div",Xt,[o("div",Gt,[e.direct?(a(),te(c,{key:0,value:e.currentPrice,class:Fe(["position-slider",e.currentPrice<Number(("sFixD"in e?e.sFixD:P(T))((I=e.positionInfo)==null?void 0:I.minPrice,6))||e.currentPrice>Number(("sFixD"in e?e.sFixD:P(T))((M=e.positionInfo)==null?void 0:M.maxPrice,6))?"hide-handler":""]),step:1e-4,marks:e.marks,disabled:!0,min:Number(("sFixD"in e?e.sFixD:P(T))((ce=e.positionInfo)==null?void 0:ce.minPrice,6)),max:Number(("sFixD"in e?e.sFixD:P(T))((pe=e.positionInfo)==null?void 0:pe.maxPrice,6))},{mark:he(({label:X})=>{var C,J,Ne,ge,we,qe,Ie,ye,Be,Ce,Me,Pe;return[X=="Min Price"?(a(),f("div",Ht,[o("div",null,d(X),1),e.direct?(a(),f("div",Yt,d(((C=e.positionInfo)==null?void 0:C.minPrice)&&("sFixD"in e?e.sFixD:P(T))((J=e.positionInfo)==null?void 0:J.minPrice,6)),1)):(a(),f("div",zt,d(((Ne=e.positionInfo)==null?void 0:Ne.maxPrice)&&("sFixD"in e?e.sFixD:P(T))(1/((ge=e.positionInfo)==null?void 0:ge.maxPrice),6)),1))])):j("",!0),X=="Max Price"?(a(),f("div",Jt,[o("div",null,d(X),1),e.direct?(a(),f("div",Kt,d(((we=e.positionInfo)==null?void 0:we.maxPrice)&&("sFixD"in e?e.sFixD:P(T))((qe=e.positionInfo)==null?void 0:qe.maxPrice,6)),1)):(a(),f("div",Zt,d(((Ie=e.positionInfo)==null?void 0:Ie.minPrice)&&("sFixD"in e?e.sFixD:P(T))(1/((ye=e.positionInfo)==null?void 0:ye.minPrice),6)),1))])):j("",!0),X=="Current Price"?(a(),f("div",{key:2,class:Fe(["current-price",e.currentPrice<Number(("sFixD"in e?e.sFixD:P(T))((Be=e.positionInfo)==null?void 0:Be.minPrice,6))?"current-price-left":e.currentPrice>Number(("sFixD"in e?e.sFixD:P(T))((Ce=e.positionInfo)==null?void 0:Ce.maxPrice,6))?"current-price-right":""])},[o("div",null,d(X),1),o("div",null,[(e.needReverse?!e.direct:e.direct)?(a(),f(no,{key:0},[Le(d(("addCommom"in e?e.addCommom:P(R))(("decimalUi"in e?e.decimalUi:P(Ve))((Me=e.positionInfo)==null?void 0:Me.price,6))),1)],64)):(a(),f(no,{key:1},[Le(d(("addCommom"in e?e.addCommom:P(R))(("decimalUi"in e?e.decimalUi:P(Ve))(1/((Pe=e.positionInfo)==null?void 0:Pe.price),6))),1)],64))])],2)):j("",!0)]}),_:1},8,["value","class","marks","min","max"])):(a(),te(c,{key:1,value:e.currentPriceResever,class:Fe(["position-slider",e.currentPriceResever<Number(("sFixD"in e?e.sFixD:P(T))(1/((fe=e.positionInfo)==null?void 0:fe.maxPrice),6))||e.currentPriceResever>Number(("sFixD"in e?e.sFixD:P(T))(1/((ve=e.positionInfo)==null?void 0:ve.minPrice),6))?"hide-handler":""]),step:null,min:Number(("sFixD"in e?e.sFixD:P(T))(1/((le=e.positionInfo)==null?void 0:le.maxPrice),6)),max:Number(("sFixD"in e?e.sFixD:P(T))(1/((ue=e.positionInfo)==null?void 0:ue.minPrice),6)),marks:e.marks,disabled:!0},{mark:he(({label:X})=>{var C,J,Ne,ge,we,qe,Ie,ye,Be,Ce,Me,Pe;return[X=="Min Price"?(a(),f("div",Qt,[o("div",null,d(X),1),e.direct?(a(),f("div",xt,d(((C=e.positionInfo)==null?void 0:C.minPrice)&&("sFixD"in e?e.sFixD:P(T))((J=e.positionInfo)==null?void 0:J.minPrice,6)),1)):(a(),f("div",es,d(((Ne=e.positionInfo)==null?void 0:Ne.maxPrice)&&("sFixD"in e?e.sFixD:P(T))(1/((ge=e.positionInfo)==null?void 0:ge.maxPrice),6)),1))])):j("",!0),X=="Max Price"?(a(),f("div",os,[o("div",null,d(X),1),e.direct?(a(),f("div",ns,d(((we=e.positionInfo)==null?void 0:we.maxPrice)&&("sFixD"in e?e.sFixD:P(T))((qe=e.positionInfo)==null?void 0:qe.maxPrice,6)),1)):(a(),f("div",ts,d(((Ie=e.positionInfo)==null?void 0:Ie.minPrice)&&("sFixD"in e?e.sFixD:P(T))(1/((ye=e.positionInfo)==null?void 0:ye.minPrice),6)),1))])):j("",!0),X=="Current Price"?(a(),f("div",{key:2,class:Fe(["current-price current-price-direct",e.currentPriceResever<Number(("sFixD"in e?e.sFixD:P(T))(1/((Be=e.positionInfo)==null?void 0:Be.maxPrice),6))?"current-price-left":e.currentPriceResever>Number(("sFixD"in e?e.sFixD:P(T))(1/((Ce=e.positionInfo)==null?void 0:Ce.minPrice),6))?"current-price-right":""])},[o("div",null,d(X),1),o("div",null,[(e.needReverse?!e.direct:e.direct)?(a(),f(no,{key:0},[Le(d(("addCommom"in e?e.addCommom:P(R))(("decimalUi"in e?e.decimalUi:P(Ve))((Me=e.positionInfo)==null?void 0:Me.price,6))),1)],64)):(a(),f(no,{key:1},[Le(d(("addCommom"in e?e.addCommom:P(R))(("decimalUi"in e?e.decimalUi:P(Ve))(1/((Pe=e.positionInfo)==null?void 0:Pe.price),6))),1)],64))])],2)):j("",!0)]}),_:1},8,["value","class","min","max","marks"]))])])])])}const Jo=Ue(Pt,[["render",ss],["__scopeId","data-v-220133b5"]]),is=je({components:{Modal:Mo},props:{positionInfo:{type:Object,default:()=>({})}},setup(e){const n=$(()=>{var H,B;const G=Math.ceil(((H=e.positionInfo)==null?void 0:H.poolUSD)/((B=e.positionInfo)==null?void 0:B.quoteUSD)*100);return console.log(G,"Pool Capacity Ratio"),Number(G)});return{sFixD:T,addCommom:R,ratio:n}}});const Ro=e=>(Ee("data-v-f4b12696"),e=e(),We(),e),ls=Ro(()=>o("svg",{class:"icon modal-icon-close","aria-hidden":"true"},[o("use",{"xlink:href":"#icon-a-icon-Shutdown"})],-1)),as={class:"deposit-slider"},us={class:"info-block"},rs=Ro(()=>o("div",{class:"leabl"},"Current Deposit：",-1)),ds={class:"text"},vs={class:"info-block"},ms=Ro(()=>o("div",{class:"leabl"},"Max Capacity：",-1)),cs={class:"text"};function ps(e,n,G,H,B,S){const u=to("Modal");return a(),te(u,{width:"440px",visible:!0,footer:null,title:"Vault Capacity",onCancel:n[0]||(n[0]=c=>e.$emit("onClose"))},{closeIcon:he(()=>[ls]),default:he(()=>{var c,_,y,s;return[o("div",as,[o("div",{class:"current-deposit",style:$o({width:`${e.ratio>100?100:e.ratio}%`})},null,4)]),o("div",us,[rs,o("div",ds,d(("addCommom"in e?e.addCommom:P(R))(("sFixD"in e?e.sFixD:P(T))((c=e.positionInfo)==null?void 0:c.poolUSD,2)))+" "+d((_=e.positionInfo)==null?void 0:_.quoteCoinInfo.symbol),1)]),o("div",vs,[ms,o("div",cs,d(("addCommom"in e?e.addCommom:P(R))(("sFixD"in e?e.sFixD:P(T))((y=e.positionInfo)==null?void 0:y.quoteUSD,2)))+" "+d((s=e.positionInfo)==null?void 0:s.quoteCoinInfo.symbol),1)])]}),_:1})}const Ko=Ue(is,[["render",ps],["__scopeId","data-v-f4b12696"]]),fs=je({components:{AutoPoolV2PoolCapacity:Ko},setup(){const e=xe(),n=$(()=>e),G=He(),H=$(()=>G),B=Qe(),S=w();$e(()=>[H.value.positionInfoObj,B.params.id],([y,s])=>{console.log(y,"##positionInfoObj"),y&&!Ze(y)&&s&&(S.value=y[s],console.log(S.value,"##positionInfo.value"))},{immediate:!0,deep:!0});const u=$(()=>{var y;return(y=S.value)==null?void 0:y.needReverse}),c=y=>{var s;return console.log(y,"info##"),(y==null?void 0:y.logoURI)||(y==null?void 0:y.logo_url)||((s=n.value.tokensObj[y==null?void 0:y.address])==null?void 0:s.logo_url)||uo("/image/coins/sui-unknown.png")},_=w(!1);return{needReverse:u,positionInfo:S,getCoinIcon:c,addCommom:R,isShowModal:_}}});const ys=e=>(Ee("data-v-ad8a33e9"),e=e(),We(),e),bs={class:"pool-composition"},gs={class:"pool-composition-top"},ks=ys(()=>o("span",null,"Vault Composition",-1)),hs={class:"pool-composition-bottom"},_s={class:"token-ratio"},$s={class:"before-coin"},ws={alt:""},Is={class:"after-coin"},Cs={alt:""},As={class:"token-num"},Ps={class:"num-box"},Ss={class:"num-box"};function Ts(e,n,G,H,B,S){var y,s,t,N,i,v,g,m,b,p,D,F,V,ee,k,h,W,E,Y,ie,I,M,ce,pe,fe,ve,le,ue,X;const u=fo,c=Ko,_=So("image");return a(),f("div",bs,[o("div",gs,[ks,Number((y=e.positionInfo)==null?void 0:y.quoteUSD)>0?(a(),f("div",{key:0,class:"pool-capacity",onClick:n[0]||(n[0]=C=>e.isShowModal=!0)},"Vault Capacity")):j("",!0)]),o("div",hs,[o("div",_s,[o("div",$s,[o("div",null,[z(u,{address:e.needReverse?(i=(N=e.positionInfo)==null?void 0:N.token_b)==null?void 0:i.address:(t=(s=e.positionInfo)==null?void 0:s.token_a)==null?void 0:t.address,"style-params":{width:"14px",height:"14px",right:"0",bottom:"0"}},null,8,["address"]),Ke(o("img",ws,null,512),[[_,e.needReverse?e.getCoinIcon((g=e.positionInfo)==null?void 0:g.token_b):e.getCoinIcon((v=e.positionInfo)==null?void 0:v.token_a)]])]),o("span",null,d((m=e.positionInfo)==null?void 0:m.poolCoinARatio)+"%",1)]),o("div",Is,[o("span",null,d((b=e.positionInfo)==null?void 0:b.poolCoinBRatio)+"%",1),o("div",null,[Ke(o("img",Cs,null,512),[[_,e.needReverse?e.getCoinIcon((D=e.positionInfo)==null?void 0:D.token_a):e.getCoinIcon((p=e.positionInfo)==null?void 0:p.token_b)]]),z(u,{address:e.needReverse?(k=(ee=e.positionInfo)==null?void 0:ee.token_a)==null?void 0:k.address:(V=(F=e.positionInfo)==null?void 0:F.token_b)==null?void 0:V.address,"style-params":{width:"14px",height:"14px",right:"0",bottom:"0"}},null,8,["address"])])])]),o("div",As,[o("div",{class:"token-a-bg",style:$o({width:`${(h=e.positionInfo)==null?void 0:h.poolCoinARatio}%`})},null,4),o("div",{class:"token-b-bg",style:$o({width:`${(W=e.positionInfo)==null?void 0:W.poolCoinBRatio}%`})},null,4),o("div",Ps,[o("div",null,d(("addCommom"in e?e.addCommom:P(R))((E=e.positionInfo)==null?void 0:E.poolCoinANum))+" "+d(e.needReverse?(M=(I=e.positionInfo)==null?void 0:I.token_b)==null?void 0:M.symbol:(ie=(Y=e.positionInfo)==null?void 0:Y.token_a)==null?void 0:ie.symbol),1),o("div",null,"$"+d(("addCommom"in e?e.addCommom:P(R))((ce=e.positionInfo)==null?void 0:ce.poolCoinAUSD)),1)]),o("div",Ss,[o("div",null,d(("addCommom"in e?e.addCommom:P(R))((pe=e.positionInfo)==null?void 0:pe.poolCoinBNum))+" "+d(e.needReverse?(ue=(le=e.positionInfo)==null?void 0:le.token_a)==null?void 0:ue.symbol:(ve=(fe=e.positionInfo)==null?void 0:fe.token_b)==null?void 0:ve.symbol),1),o("div",null,"$"+d(("addCommom"in e?e.addCommom:P(R))((X=e.positionInfo)==null?void 0:X.poolCoinBUSD)),1)])])]),e.isShowModal?(a(),te(c,{key:0,"position-info":e.positionInfo,onOnClose:n[1]||(n[1]=C=>e.isShowModal=!1)},null,8,["position-info"])):j("",!0)])}const Zo=Ue(fs,[["render",Ts],["__scopeId","data-v-ad8a33e9"]]),Rs=je({setup(){const e=xe(),n=$(()=>e),G=He(),H=$(()=>G),B=Qe(),S=w();$e(()=>[H.value.positionInfoObj,B.params.id],([s,t])=>{console.log(s,"##positionInfoObj"),s&&!Ze(s)&&t&&(S.value=s[t],console.log(S.value,"##positionInfo.value"))},{immediate:!0,deep:!0});const u=$(()=>{var s;return(s=S.value)==null?void 0:s.needReverse}),c=s=>{var t;return console.log(s,"info##"),(s==null?void 0:s.logoURI)||(s==null?void 0:s.logo_url)||((t=n.value.tokensObj[s==null?void 0:s.address])==null?void 0:t.logo_url)||uo("/image/coins/sui-unknown.png")},_=To(),y=$(()=>_);return{needReverse:u,positionInfo:S,getCoinIcon:c,addCommom:R,wallet:y}}});const ro=e=>(Ee("data-v-c9de826f"),e=e(),We(),e),Ns={class:"my-liquidity"},qs={class:"my-liquidity-top"},Bs=ro(()=>o("div",null,"My Liquidity",-1)),Ds=ro(()=>o("p",null,"My share of pool",-1)),Fs={class:"my-liquidity-bottom"},Ms={class:"lp-token"},Os=ro(()=>o("div",null,[o("span",null,"LP Token Balance ")],-1)),Ls={class:"lp-balance"},Us={class:"token-num-content"},Vs={class:"token-num token-a-num"},js={class:"logo"},Es=["src"],Ws={class:"text"},Xs={class:"lp-logo"},Gs=["src"],Hs=ro(()=>o("div",null,"Pooled Assets",-1)),Ys={class:"token-num"},zs={class:"logo"},Js=["src"],Ks={class:"text"},Zs=ro(()=>o("div",{class:"token-num-content-bg"},null,-1));function Qs(e,n,G,H,B,S){var c,_,y,s,t,N,i,v,g,m,b,p,D,F,V,ee,k,h,W,E,Y,ie,I,M,ce,pe,fe,ve;const u=fo;return a(),f("div",Ns,[o("div",qs,[Bs,o("div",null,[Ds,o("p",null,d(e.wallet.connected?(c=e.positionInfo)==null?void 0:c.myShare:"--")+"%",1)])]),o("div",Fs,[o("div",Ms,[Os,o("div",null,[o("span",Ls,d(e.wallet.connected?("addCommom"in e?e.addCommom:P(R))((_=e.positionInfo)==null?void 0:_.myLiquidity):"--")+" LP",1),o("span",null,"$"+d(e.wallet.connected?("addCommom"in e?e.addCommom:P(R))((y=e.positionInfo)==null?void 0:y.myLiquidityUSD):"--"),1)])]),o("div",Us,[o("div",Vs,[o("div",js,[o("img",{src:e.needReverse?e.getCoinIcon((t=e.positionInfo)==null?void 0:t.token_b):e.getCoinIcon((s=e.positionInfo)==null?void 0:s.token_a),alt:""},null,8,Es),z(u,{address:e.needReverse?(g=(v=e.positionInfo)==null?void 0:v.token_b)==null?void 0:g.address:(i=(N=e.positionInfo)==null?void 0:N.token_a)==null?void 0:i.address,"style-params":{width:"14px",height:"14px",left:"18px",bottom:"0"}},null,8,["address"])]),o("div",Ws,[o("div",null,d(e.wallet.connected?("addCommom"in e?e.addCommom:P(R))((m=e.positionInfo)==null?void 0:m.amountA):"--")+" "+d(e.needReverse?(F=(D=e.positionInfo)==null?void 0:D.token_b)==null?void 0:F.symbol:(p=(b=e.positionInfo)==null?void 0:b.token_a)==null?void 0:p.symbol),1),o("div",null,d(e.wallet.connected?("addCommom"in e?e.addCommom:P(R))((V=e.positionInfo)==null?void 0:V.myAmountAUSD):"--"),1)])]),o("div",Xs,[o("img",{src:e.getCoinIcon((ee=e.positionInfo)==null?void 0:ee.lpInfo),alt:""},null,8,Gs),Hs]),o("div",Ys,[o("div",zs,[o("img",{src:e.needReverse?e.getCoinIcon((h=e.positionInfo)==null?void 0:h.token_a):e.getCoinIcon((k=e.positionInfo)==null?void 0:k.token_b),alt:""},null,8,Js),z(u,{address:e.needReverse?(ie=(Y=e.positionInfo)==null?void 0:Y.token_a)==null?void 0:ie.address:(E=(W=e.positionInfo)==null?void 0:W.token_b)==null?void 0:E.address,"style-params":{width:"14px",height:"14px",right:"0",bottom:"0"}},null,8,["address"])]),o("div",Ks,[o("div",null,d(e.wallet.connected?("addCommom"in e?e.addCommom:P(R))((I=e.positionInfo)==null?void 0:I.amountB):"--")+" "+d(e.needReverse?(fe=(pe=e.positionInfo)==null?void 0:pe.token_a)==null?void 0:fe.symbol:(ce=(M=e.positionInfo)==null?void 0:M.token_b)==null?void 0:ce.symbol),1),o("div",null,d(e.wallet.connected?("addCommom"in e?e.addCommom:P(R))((ve=e.positionInfo)==null?void 0:ve.myAmountBUSD):"--"),1)])]),Zs])])])}const Qo=Ue(Rs,[["render",Qs],["__scopeId","data-v-c9de826f"]]),xs=""+globalThis.__publicAssetsURL("image/icon-tips-error@2x.png");const ei={},xo=e=>(Ee("data-v-fcbc716b"),e=e(),We(),e),oi={class:"status"},ni=xo(()=>o("img",{src:xs,alt:""},null,-1)),ti=xo(()=>o("span",null,"Rebalancing is in processing. New deposits and withdraws are paused and will be back in minutes. ",-1)),si=[ni,ti];function ii(e,n){return a(),f("div",oi,si)}const en=Ue(ei,[["render",ii],["__scopeId","data-v-fcbc716b"]]),li=je({components:{AutoPoolAddModal:Go,AutoPoolV2PoolStatus:en},setup(){const e=To(),n=w(!1),G=yo(),H=$(()=>G),B=$(()=>H.value.chainName),S=$(()=>e),u=He(),c=$(()=>u),_=xe(),y=$(()=>_),s=w(),t=Qe(),N=w(!1),i=w(!1);$e(()=>[c.value.positionInfoObj,t.params.id],([A,O])=>{A&&!Ze(A)&&O&&(s.value=A[O],console.log(s.value,"##positionInfo.value"))},{immediate:!0,deep:!0});const v=$(()=>{var A,O;return console.log((A=s.value)==null?void 0:A.needReverse,"##positionInfo.value?.needReverse"),(O=s.value)==null?void 0:O.needReverse}),g=w(),m=w(),b=w(),p=w(),D=w(!0),F=$(()=>S.value.assets&&g.value&&S.value.assets[g.value.address]?Fo(S.value.assets[g.value.address].balance,g.value.decimals):0),V=$(()=>S.value.assets&&m.value&&S.value.assets[m.value.address]?Fo(S.value.assets[m.value.address].balance,m.value.decimals):0),ee=A=>{A==="fromCoin"?(D.value=!0,b.value=F.value>0?g.value.symbol=="SUI"?new r(Number(F.value)).sub(new r(.05)).lt(new r(0))?"0":new r(Number(F.value)).sub(new r(.05)).toString():String(F.value):""):(D.value=!1,p.value=V.value>0?m.value.symbol=="SUI"?new r(Number(V.value)).sub(new r(.05)).lt(new r(0))?"0":new r(Number(V.value)).sub(new r(.05)).toString():String(V.value):"")},k=A=>{A==="fromCoin"?(D.value=!0,b.value=F.value>0?T(new r(Number(F.value)).div(2).toString(),g.value.decimals).toString():""):(D.value=!1,p.value=V.value>0?T(new r(Number(V.value)).div(2).toString(),m.value.decimals).toString():"")},h=$(()=>B.value?jo(B.value):{}),W=$(()=>c.value.slippage),E=w("--"),Y=w("--"),ie=A=>{const O=new r(s.value.autoPoolPositionInfo.liquidity),L=new r(A.toString());if(O.toNumber()>0&&L.toNumber()>0){const ae=L.add(O);console.log("totalLiquidity:",L.div(ae).mul(100).toString());const Te=L.div(ae).mul(100).toNumber(),se=fn(Te),ke=se==-1?2:se+2,me=T(L.div(ae).mul(100).toNumber(),ke);console.log(s.value.decimals,"##positionInfo.value.decimal");const l=new r(1).div(new r(Math.pow(10,s.value.lpInfo.decimals))).toString();console.log(me,l,"###288"),Number(me)<Number(l)?E.value=`<${l}`:E.value=me}else L.toNumber()>0&&O.toNumber()<=0?E.value="100":E.value="--"},I=A=>{const O=new r(A.toString()),L=new r(W.value).div(100),ae=O.mul(L),Te=O.sub(ae),se=Io.get_lp_amount_by_liquidity({liquidity:s.value.liquidity,total_supply:s.value.total_supply},Te),ke=new r(Math.pow(10,s.value.lpInfo.decimals)),me=new r(se).div(ke).toString();Y.value=me},M=w(!1),ce=w(!1),pe=w(""),fe=w(),ve=async()=>{if(!s.value)return;console.log(b.value,p.value,"####updateAmounts"),i.value=!1;const A=s.value.autoPoolPositionInfo.tick_lower_index,O=s.value.autoPoolPositionInfo.tick_upper_index,L=Oe.sqrtPriceX64ToTickIndex(new de(s.value.current_sqrt_price));let ae=Oe.tickIndexToSqrtPriceX64(A),Te=Oe.tickIndexToSqrtPriceX64(O);L<A&&(v.value?M.value=!0:ce.value=!0),L>O&&(v.value?ce.value=!0:M.value=!0);let se;if(console.log(b.value||p.value,"#fromCoinAmount.value || toCoinAmount.value"),b.value||p.value){D.value?se=new r(b.value).mul(Math.pow(10,g.value.decimals)).toString():se=new r(p.value).mul(Math.pow(10,m.value.decimals)).toString();let ke,me=D.value;if(console.log("执行##"),K.value||Se.value){console.log(v.value?D.value:!D.value,"#needReverse.value?fixedFromCoin.value:!fixedFromCoin.value"),console.log("1106###needReverse.value####",v.value),console.log("1106###calculateDepositSwapAmount###params###",{lowerTick:A,upperTick:O,curSqrtPrice:new de(s.value.current_sqrt_price),fix_amount_a:me,input_amount:se,coinTypeA:s.value.autoPoolPositionInfo.coin_type_a,coinTypeB:s.value.autoPoolPositionInfo.coin_type_b,clmm_pool:s.value.address,slippage:Number(W.value)/100,decimals:K.value?g.value.decimals:m.value.decimals});const q=await Pe.calculateDepositSwapAmount({lowerTick:A,upperTick:O,curSqrtPrice:new de(s.value.current_sqrt_price),fix_amount_a:me,input_amount:se,coinTypeA:s.value.autoPoolPositionInfo.coin_type_a,coinTypeB:s.value.autoPoolPositionInfo.coin_type_b,clmm_pool:s.value.address,slippage:Number(W.value)/100,decimals:K.value?g.value.decimals:m.value.decimals});if(console.log(q,"###swapResult"),console.log("1106###calculateDepositSwapAmount###result###",q),q){N.value=q.is_exceed,ke=new de(q.afterSqrtPrice),se=q.fixAmountA===me?new de(new r(se).sub(q.swapInAmount).toString()):new de(q.swapOutAmount),fe.value={swap_amount:q.swapInAmount,route_obj:q.route_obj,a2b:me},me=q.fixAmountA;const oe=s.value.token_a.decimals,Q=s.value.token_b.decimals;_o.value=Oe.sqrtPriceX64ToPrice(q.afterSqrtPrice,oe,Q).toString(),console.log(_o.value,"##afterCurrentPrice.value");const re=new r(q.swapInAmount).div(new r(Math.pow(10,oe))).toString(),be=new r(q.swapOutAmountLimit).div(new r(Math.pow(10,Q))).toString(),ne=v.value?s.value.token_b.symbol:s.value.token_a.symbol,x=v.value?s.value.token_a.symbol:s.value.token_b.symbol;pe.value=`To deposit ${R(K.value?b.value:p.value)} ${K.value?ne:x},
          ${R(re)} ${K.value?ne:x}  will be traded for ${R(be)} ${K.value?x:ne} added to the pool.`}else i.value=!0}else N.value=!1,ke=s.value.current_sqrt_price,se=new de(se),_o.value="",pe.value="";console.log(fe,"##swapParams");let l,U,Z;if(L>=A&&L<=O){const q=h.value.estLiquidityAndcoinAmountFromOneAmounts({tokenA:g.value,tokenB:m.value,lowerTick:A,upperTick:O,coinAmount:se,iscoinA:me,roundUp:!0,slippage:Number(W.value)/100,curSqrtPrice:new de(ke)});l=q.liquidityAmount,U=q.tokenMaxA,Z=q.tokenMaxB,!K.value&&!Se.value&&(D.value?p.value=Number(Z)>0?Z:"":b.value=Number(U)>0?U:"")}else L<O?l={liquidityAmount:cn(ae,Te,se),tokenMaxA:0,tokenMaxB:p.value}.liquidityAmount:l={liquidityAmount:pn(ae,Te,se),tokenMaxA:b.value,tokenMaxB:0}.liquidityAmount;console.log(l.toString(),"liquidityAmount###"),ie(l),I(l)}};$e(()=>s.value,A=>{A&&!Ze(A)&&(g.value=A==null?void 0:A.token_a,m.value=A==null?void 0:A.token_b,M.value=!1,ce.value=!1,ve())},{immediate:!0});const le=$(()=>y.value.RATES),ue=$(()=>{var A,O,L,ae,Te,se,ke,me,l,U;if((O=le.value[(A=g.value)==null?void 0:A.address])!=null&&O.price&&((ae=le.value[(L=m.value)==null?void 0:L.address])!=null&&ae.price)){console.log((se=le.value[(Te=g.value)==null?void 0:Te.address])==null?void 0:se.price,"RATES.value[fromCoin.value?.address]?.price");const Z=new r(b.value||0).mul(new r((me=le.value[(ke=g.value)==null?void 0:ke.address])==null?void 0:me.price)),q=new r(p.value||0).mul(new r((U=le.value[(l=m.value)==null?void 0:l.address])==null?void 0:U.price));return Ve(Z.add(q).toString(),2)}else return"--"});$e(()=>b.value,(A,O)=>{console.log(A,"##newVal"),A?ve():(E.value="--",p.value="",Y.value="--")},{immediate:!0}),$e(()=>p.value,(A,O)=>{A?ve():(b.value="",E.value="--",Y.value="--")},{immediate:!0});const{t:X,locale:C}=Co(),J=$(()=>{var A,O;if(K.value||Se.value){const L=K.value?b.value:p.value,ae=K.value?g.value:m.value;if((A=le.value[ae==null?void 0:ae.address])!=null&&A.price)return new r(L||0).mul(new r((O=le.value[ae==null?void 0:ae.address])==null?void 0:O.price)).toNumber()}return 0}),Ne=$(()=>{const A=Number(b.value)>Number(F.value),O=Number(p.value)>Number(V.value);return!b.value&&!p.value?X("button.enterAmount"):A?X("button.insufficientBalance",{name:g.value.symbol}):O?X("button.insufficientBalance",{name:m.value.symbol}):N.value?X("button.insufficientLiquidity"):Number(s.value.remainingTokenUSD)!==0&&Number(ue.value)>Number(s.value.remainingTokenUSD)?"Exceeded the max capacity":i.value?X("button.enterAmount"):(console.log(J.value),"Add Liquidity")}),ge=$(()=>{const A=Number(b.value)>Number(F.value),O=Number(p.value)>Number(V.value);return!!(!b.value&&!p.value||A||O||b.value<=0&&p.value<=0||N.value||eo.value!=="STATUS_RUNNING"||(console.log(ue.value,s.value.quoteUSD,"positionInfo.value.quoteUSD#"),Number(s.value.remainingTokenUSD)!==0&&Number(ue.value)>Number(s.value.remainingTokenUSD))||i.value||J.value>1e4)}),we=w(!0),{setIsShowSuccess:qe,setIsShowRejected:Ie,setIsShowWaiting:ye,setTransactionDesc:Be,setTransactionTxid:Ce,setPositiomNum:Me}=G,Pe=Vo("Sui"),ze=async()=>{var l,U;n.value=!1,we.value=!0,Ce("");const A=`${R(b.value)} ${(l=g.value)==null?void 0:l.symbol}`,O=`${R(p.value)} ${(U=m.value)==null?void 0:U.symbol}`;Be(`Deposit ${b.value>0?A:""} ${p.value>0&&b.value>0?"and":""} ${p.value>0?O:""}`),ye(!0);const L=D.value,ae=s.value.autoPoolPositionInfo.tick_lower_index,Te=s.value.autoPoolPositionInfo.tick_upper_index,se=Oe.sqrtPriceX64ToTickIndex(new de(s.value.current_sqrt_price));let ke;D.value?ke=new r(b.value).mul(Math.pow(10,g.value.decimals)).toString():ke=new r(p.value).mul(Math.pow(10,m.value.decimals)).toString();const me=s.value.rewarderInfo.map(Z=>Z.coinAddress);console.log("1109###deposit###positionInfo###",s);try{const Z={lowerTick:ae,upperTick:Te,coinAmount:ke,fix_amount_a:L,slippage:Number(W.value)/100,curSqrtPrice:new de(s.value.current_sqrt_price),id:s.value.id,clmm_pool:s.value.autoPoolPositionInfo.pool,lp_token_type:s.value.lp_token_type,coinTypeA:s.value.autoPoolPositionInfo.coin_type_a,coinTypeB:s.value.autoPoolPositionInfo.coin_type_b,rewarder_coin_types:me,swapParams:fe.value,isOnlyA:K.value,isOnlyB:Se.value,currentTickIndex:se,decimal_b:s.value.coinB.decimals};console.log("1106###deposit###params###",Z);const q=await Pe.deposit(Z);console.log(q,"===>payloadAdd11111");const oe=await S.value.currentWallet.signAndExecuteTransactionBlock(q);let Q=h.value.handleTx(oe);if(console.log("toAdd###tx###",Q),Q&&Q.hash){Ce(Q.hash),ye(!1),qe(!0),console.log(s,"===>positionInfo");const re={title:"Supplied",desc:`Deposit ${b.value>0?A:""} ${p.value>0&&b.value>0?"and":""} ${p.value>0?O:""}`,hash:Q.hash,tit:"Liquidity Increased",icon:"icon-icon-Increased",text:`Deposit ${b.value>0?A:""} ${p.value>0&&b.value>0?"and":""} ${p.value>0?O:""}`};B.value!=="Aptos"&&(re.res=Q.res),h.value.showTransitionPending(re),await h.value.watchTransaction(re)&&setTimeout(()=>{u.updatePositionItem(s.value.id),h.value.getAccount(S.value.address)},1e3),Me()}else ye(!1),Ie(!0);b.value="",p.value="",we.value=!1}catch(Z){b.value="",p.value="",console.log("addError###",Z),we.value=!1,ye(!1),Ie(!0)}},K=w(!1),Se=w(!1),so=A=>{b.value="",p.value="",pe.value="",A=="only-a"?(K.value=!K.value,Se.value=!1):(Se.value=!Se.value,K.value=!1)},eo=$(()=>c.value.currentAutoPoolStatus),mo=w(),go=()=>{mo.value=window.setInterval(()=>{(b.value||p.value)&&ve()},2e4)};return co(()=>{go()}),po(()=>{window.clearInterval(mo.value)}),{currentAutoPoolStatus:eo,wallet:S,positionInfo:s,isShowAddModal:n,needReverse:v,fromCoin:g,toCoin:m,fromCoinAmount:b,toCoinAmount:p,fromCoinBlance:F,toCoinBlance:V,fixedFromCoin:D,maxBtnSelect:ee,halfBtnSelect:k,totalAmountUSD:ue,addCommom:R,shareOfPool:E,minimumReceivedLP:Y,addLiquidityBtnText:Ne,addLiquidityBtnDisabled:ge,toAdd:ze,showToCoinLock:ce,showFromCoinLock:M,isOnlyA:K,isOnlyB:Se,onlyToken:so,onlyText:pe,onlyTokenUSD:J}}});const Ye=e=>(Ee("data-v-00ca7691"),e=e(),We(),e),ai={class:"auto-pool-add"},ui={class:"auto-pool-add-content"},ri={class:"liquidity-action-tab"},di=Ye(()=>o("div",{class:"increase tab-active"},"Add",-1)),vi={class:"only-token"},mi=Ye(()=>o("div",null,"Deposit Amounts",-1)),ci={key:0},pi=Ye(()=>o("div",{class:"hover-text"},"You can also choose to deposit in only one asset type. In that case, the vault will convert your asset to the required propositions using Cetus. Please note that trading fees & slippage will be applied. When slippage is involved, a certain amount of post-swap dust (no loss of funds) will be returned to you.",-1)),fi={key:0},yi=Ye(()=>o("div",{class:"hover-text"},"You can also choose to deposit in only one asset type. In that case, the vault will convert your asset to the required propositions using Cetus. Please note that trading fees & slippage will be applied. When slippage is involved, a certain amount of post-swap dust (no loss of funds) will be returned to you.",-1)),bi={key:0,class:"card-item"},gi={key:1,class:"card-item"},ki=Ye(()=>o("span",null,"Pool Closed",-1)),hi={key:0,class:"add-info"},_i={key:0,class:"only-text"},$i={class:"total-amount"},wi=Ye(()=>o("span",null,"Total Amount",-1)),Ii={class:"total-amount"},Ci=Ye(()=>o("span",null,"Share of Pool",-1)),Ai={key:0},Pi={key:1},Si={class:"total-amount"},Ti=Ye(()=>o("span",null,"Minimum Received LP",-1)),Ri={key:0},Ni={key:1},qi={key:1,class:"add-info only-add-info"},Bi=Ye(()=>o("div",{class:"only-text"},"Single-asset deposit can't be higher than $10,000 at a time.",-1)),Di=[Bi];function Fi(e,n,G,H,B,S){var t,N,i,v,g,m,b,p,D,F,V,ee,k,h,W,E,Y,ie,I;const u=Wo,c=Xo,_=to("AutoPoolV2PoolStatus"),y=Ao,s=Go;return a(),f("div",ai,[o("div",ui,[o("div",ri,[di,o("div",{class:"remove",onClick:n[0]||(n[0]=Uo(M=>e.$emit("changeCurrentTab"),["stop"]))},"Remove")]),o("div",vi,[mi,o("div",null,[o("div",{class:"only-a",onClick:n[1]||(n[1]=M=>e.onlyToken("only-a"))},[o("p",null,[e.isOnlyA?(a(),f("span",ci)):j("",!0)]),o("span",null,d(e.needReverse?(v=(i=e.positionInfo)==null?void 0:i.token_b)==null?void 0:v.symbol:(N=(t=e.positionInfo)==null?void 0:t.token_a)==null?void 0:N.symbol)+" only",1),pi]),o("div",{class:"only-b",onClick:n[2]||(n[2]=M=>e.onlyToken("only-b"))},[o("p",null,[e.isOnlyB?(a(),f("span",fi)):j("",!0)]),o("span",null,d(e.needReverse?(p=(b=e.positionInfo)==null?void 0:b.token_a)==null?void 0:p.symbol:(m=(g=e.positionInfo)==null?void 0:g.token_b)==null?void 0:m.symbol)+" only",1),yi])])]),o("div",{class:Fe(e.needReverse?"card-container reverse":"card-container")},[(e.needReverse?!e.isOnlyA:!e.isOnlyB)?(a(),f("div",bi,[z(u,{modelValue:e.fromCoinAmount,"onUpdate:modelValue":n[3]||(n[3]=M=>e.fromCoinAmount=M),"input-value":e.fromCoinAmount,"coin-symbol":e.fromCoin?e.fromCoin.symbol:null,"coin-name":e.fromCoin?e.fromCoin.name:null,balance:e.fromCoinBlance,"coin-icon":e.fromCoin?e.fromCoin.logoURI:"",address:e.fromCoin?e.fromCoin.address:"","swap-direct":"From","import-page":"deposit","has-arrow":!1,onOnMax:n[4]||(n[4]=M=>e.maxBtnSelect("fromCoin")),onOnHalf:n[5]||(n[5]=M=>e.halfBtnSelect("fromCoin")),onOnInput:n[6]||(n[6]=M=>{e.fromCoinAmount=M}),onOnFocus:n[7]||(n[7]=()=>{e.fixedFromCoin=!0})},null,8,["modelValue","input-value","coin-symbol","coin-name","balance","coin-icon","address"]),e.showFromCoinLock&&!e.isOnlyA?(a(),te(c,{key:0})):j("",!0)])):j("",!0),(e.needReverse?!e.isOnlyB:!e.isOnlyA)?(a(),f("div",gi,[z(u,{modelValue:e.toCoinAmount,"onUpdate:modelValue":n[8]||(n[8]=M=>e.toCoinAmount=M),"input-value":e.toCoinAmount,"coin-symbol":e.toCoin?e.toCoin.symbol:null,"coin-name":e.toCoin?e.toCoin.name:null,balance:e.toCoinBlance,"swap-direct":"To","coin-icon":e.toCoin?e.toCoin.logoURI:"",address:e.toCoin?e.toCoin.address:"","import-page":"deposit","has-arrow":!1,onOnMax:n[9]||(n[9]=M=>e.maxBtnSelect("toCoin")),onOnHalf:n[10]||(n[10]=M=>e.halfBtnSelect("toCoin")),onOnInput:n[11]||(n[11]=M=>{e.toCoinAmount=M}),onOnFocus:n[12]||(n[12]=()=>{e.fixedFromCoin=!1})},null,8,["modelValue","input-value","coin-symbol","coin-name","balance","coin-icon","address"]),e.showToCoinLock&&!e.isOnlyB?(a(),te(c,{key:0})):j("",!0)])):j("",!0)],2)]),e.currentAutoPoolStatus=="STATUS_REBALANCING"?(a(),te(_,{key:0})):j("",!0),(D=e.positionInfo)!=null&&D.is_pause?(a(),te(y,{key:1,class:"big-btn liquidity-btn",disabled:!0},{default:he(()=>[ki]),_:1})):e.wallet.connected?(a(),te(y,{key:2,class:"big-btn liquidity-btn",disabled:e.addLiquidityBtnDisabled,onClick:n[13]||(n[13]=M=>e.isShowAddModal=!0)},{default:he(()=>[o("span",null,d(e.addLiquidityBtnText),1)]),_:1},8,["disabled"])):(a(),te(y,{key:3,class:"big-btn liquidity-btn",onClick:n[14]||(n[14]=M=>e.wallet.setIsShowWalletModal(!0))},{default:he(()=>[o("span",null,d(e.$t("button.connectWallet")),1)]),_:1})),Number((F=e.positionInfo)==null?void 0:F.remainingTokenUSD)!==0&&Number(e.totalAmountUSD)>Number((V=e.positionInfo)==null?void 0:V.remainingTokenUSD)?j("",!0):(a(),f(no,{key:4},[e.onlyTokenUSD<=1e4?(a(),f("div",hi,[e.onlyText&&(e.isOnlyA&&e.fromCoinAmount>0||e.isOnlyB&&e.toCoinAmount>0)?(a(),f("div",_i,d(e.onlyText),1)):j("",!0),o("div",$i,[wi,o("span",null,"$"+d(("addCommom"in e?e.addCommom:P(R))(e.totalAmountUSD)),1)]),o("div",Ii,[Ci,e.fromCoinAmount&&e.toCoinAmount||e.isOnlyA&&e.fromCoinAmount||e.isOnlyB&&e.toCoinAmount?(a(),f("span",Ai,d(e.shareOfPool)+"%",1)):(a(),f("span",Pi,"--%"))]),o("div",Si,[Ti,e.fromCoinAmount&&e.toCoinAmount||e.isOnlyA&&e.fromCoinAmount||e.isOnlyB&&e.toCoinAmount?(a(),f("span",Ri,d(("addCommom"in e?e.addCommom:P(R))(e.minimumReceivedLP))+" "+d(e.needReverse?(ee=e.toCoin)==null?void 0:ee.symbol:(k=e.fromCoin)==null?void 0:k.symbol)+"-"+d(e.needReverse?(h=e.fromCoin)==null?void 0:h.symbol:(W=e.toCoin)==null?void 0:W.symbol),1)):(a(),f("span",Ni,"--"+d(e.needReverse?(E=e.toCoin)==null?void 0:E.symbol:(Y=e.fromCoin)==null?void 0:Y.symbol)+"-"+d(e.needReverse?(ie=e.fromCoin)==null?void 0:ie.symbol:(I=e.toCoin)==null?void 0:I.symbol),1))])])):(a(),f("div",qi,Di))],64)),e.isShowAddModal?(a(),te(s,{key:5,"pool-info":e.positionInfo,"from-coin":e.needReverse?e.positionInfo.token_b:e.positionInfo.token_a,"to-coin":e.needReverse?e.positionInfo.token_a:e.positionInfo.token_b,"from-coin-amount":e.needReverse?e.toCoinAmount:e.fromCoinAmount,"to-coin-amount":e.needReverse?e.fromCoinAmount:e.toCoinAmount,"total-amount":e.totalAmountUSD,"share-of-pool":e.shareOfPool,"minimum-received-l-p":e.minimumReceivedLP,"is-only-a":e.isOnlyA,"is-only-b":e.isOnlyB,onOnClose:n[15]||(n[15]=M=>e.isShowAddModal=!1),onToAdd:e.toAdd},null,8,["pool-info","from-coin","to-coin","from-coin-amount","to-coin-amount","total-amount","share-of-pool","minimum-received-l-p","is-only-a","is-only-b","onToAdd"])):j("",!0)])}const Mi=Ue(li,[["render",Fi],["__scopeId","data-v-00ca7691"]]),Oi=je({components:{AutoPoolRemoveModal:Ho,AutoPoolV2PoolStatus:en},setup(){const e=To(),n=$(()=>e),G=yo(),H=$(()=>G),B=$(()=>s.value.slippage),S=$(()=>H.value.chainName),u=[{name:"25%",value:25},{name:"50%",value:50},{name:"75%",value:75},{name:"MAX",value:100}],c=w(25),_=Qe(),y=He(),s=$(()=>y),t=$(()=>(console.log(s.value.positionInfoObj[_.params.id],"autoPool.value.positionInfoObj[route.params.id]###"),s.value.positionInfoObj[_.params.id])),N=$(()=>{var l;return(l=t.value)==null?void 0:l.needReverse}),i=w(),v=w(),g=w(!1),m=w(),b=$(()=>{var l;return(l=t.value)==null?void 0:l.myLiquidity}),p=w(!0),D=$(()=>S.value?jo(S.value):{}),F=w(),V=w(),ee=Vo("Sui"),k=w(""),h=w(""),W=w("--"),E=w(!1),Y=w(!1),ie=w(),I=w(!0),M=w(),ce=xe(),pe=$(()=>ce),fe=$(()=>pe.value.RATES),ve=async()=>{if(p.value||!t.value)return;V.value=!1;const l=t.value.autoPoolPositionInfo.tick_lower_index,U=t.value.autoPoolPositionInfo.tick_upper_index,Z=Oe.sqrtPriceX64ToTickIndex(new de(t.value.current_sqrt_price));Z<l&&(N.value?E.value=!0:Y.value=!0),Z>U&&(N.value?Y.value=!0:E.value=!0);let q;if(console.log(k.value||h.value,"#fromCoinAmount.value || toCoinAmount.value"),k.value||h.value){I.value?q=new r(k.value).mul(Math.pow(10,i.value.decimals)).toString():q=new r(h.value).mul(Math.pow(10,v.value.decimals)).toString();let oe,Q=I.value;if(C.value||J.value){const x=await ee.calculateRemoveSwapAmount({lowerTick:l,upperTick:U,curSqrtPrice:new de(t.value.current_sqrt_price),fix_amount_a:Q,receiveAmount:q,coinTypeA:t.value.autoPoolPositionInfo.coin_type_a,coinTypeB:t.value.autoPoolPositionInfo.coin_type_b,clmm_pool:t.value.address,slippage:0,decimals:C.value?i.value.decimals:v.value.decimals});if(console.log(x,"###swapResult"),x){F.value=x.is_exceed,q=new de(x.swapOutAmount),oe=t.value.current_sqrt_price,ie.value={swap_amount:x.swapInAmount,liquidity:x.liquidity,a2b:!Q,route_obj:x.route_obj},Q=!Q;const Ge=t.value.token_a.decimals,oo=t.value.token_b.decimals,Ae=new r(x.swapInAmount).div(new r(Math.pow(10,Ge))).toString(),io=new r(x.swapOutAmountLimit).div(new r(Math.pow(10,oo))).toString(),_e=N.value?t.value.token_b.symbol:t.value.token_a.symbol,Re=N.value?t.value.token_a.symbol:t.value.token_b.symbol;M.value=k.value==L.value||h.value==L.value?`To withdraw ${R(C.value?k.value:h.value)} ${C.value?_e:Re},
          ${R(C.value?t.value.amountB:t.value.amountA)} ${C.value?Re:_e} 
           in the pool will be traded for ${Ae} ${C.value?_e:Re}`:`To withdraw ${R(C.value?k.value:h.value)} ${C.value?_e:Re},
          ${R(Ae)} ${C.value?Re:_e}  in the pool will be traded for ${R(io)} ${C.value?_e:Re}`}else{V.value=!0,M.value="";return}}else F.value=!1,oe=t.value.current_sqrt_price,q=new de(q);console.log(oe,"##curSqrtPrice"),console.log("执行了吗##");const{liquidityAmount:re,tokenMaxA:be,tokenMaxB:ne}=D.value.estLiquidityAndcoinAmountFromOneAmounts({tokenA:i.value,tokenB:v.value,lowerTick:l,upperTick:U,coinAmount:q,iscoinA:Q,roundUp:!1,slippage:Number(B.value)/100,curSqrtPrice:new de(oe)});if(console.log(t.value.current_sqrt_price,"##positionInfo.value.current_sqrt_price"),console.log(ne.toString(),be.toString(),t.value,"###323"),!C.value&&!J.value&&(I.value?h.value=Number(ne)>0?ne:"":k.value=Number(be)>0?be:""),(C.value||J.value)&&(k.value>=L.value||h.value>=L.value)){m.value=t.value.myLiquidity;const x=new r(100);W.value=new r(t.value.myLiquidity).mul(new r(Math.pow(10,t.value.lpInfo.decimals))).toString(),le.value=re.toString(),c.value=x.toNumber()}else{const x=Io.get_lp_amount_by_liquidity({liquidity:t.value.liquidity,total_supply:t.value.total_supply},re.toString());m.value=new r(x).div(new r(Math.pow(10,t.value.lpInfo.decimals))).toString();const Ge=new r(m.value).div(new r(b.value)).mul(100);console.log(m.value,b.value,"####lpBalance.value"),W.value=x,le.value=re.toString(),c.value=Ge.toNumber()}}},le=w(),ue=$(()=>{var l;return(l=t==null?void 0:t.value)==null?void 0:l.amountA}),X=$(()=>{var l;return(l=t==null?void 0:t.value)==null?void 0:l.amountB}),C=w(!1),J=w(!1),Ne=$(()=>{var Q,re,be,ne;const l=(re=fe.value[(Q=i==null?void 0:i.value)==null?void 0:Q.address])==null?void 0:re.price,U=(ne=fe.value[(be=v==null?void 0:v.value)==null?void 0:be.address])==null?void 0:ne.price;console.log(l,U,k.value,h.value,"####totalWithdraw");let Z=k.value!=="--"&&k.value!==""?k.value:0,q=h.value!=="--"&&h.value!==""?h.value:0,oe;return l&&U&&(C.value||J.value?oe=new r(C.value?Z:q).mul(new r(C.value?l:U)).toString():(oe=new r(Z).mul(new r(l)).add(new r(q).mul(new r(U))).toString(),console.log(oe,"result##"))),oe>0&&oe<.01?"<$0.01":`$${R(T(oe,2))}`}),ge=async l=>{var Ge,oo,Ae,io,_e,Re,ko,No,qo,Bo;if(!p.value)return;p.value=!0,V.value=!1,(oo=(Ge=t.value)==null?void 0:Ge.token_a)==null||oo.decimals,(io=(Ae=t.value)==null?void 0:Ae.token_b)==null||io.decimals;const U=(_e=t.value)==null?void 0:_e.tick_lower_index,Z=(Re=t.value)==null?void 0:Re.tick_upper_index;Oe.tickIndexToSqrtPriceX64(U),Oe.tickIndexToSqrtPriceX64(Z);const q=(No=(ko=t.value)==null?void 0:ko.autoPoolPositionInfo)==null?void 0:No.tick_lower_index,oe=(Bo=(qo=t.value)==null?void 0:qo.autoPoolPositionInfo)==null?void 0:Bo.tick_upper_index,Q=Oe.sqrtPriceX64ToTickIndex(new de(t.value.current_sqrt_price));Q<q&&(N.value?E.value=!0:Y.value=!0),Q>oe&&(N.value?Y.value=!0:E.value=!0);let re="",be,ne;console.log(l.value,"##item.value"),console.log(ne,"##coinAmount");let x=I.value;if(console.log("执行##"),C.value||J.value&&!E.value&&!Y.value){if(C.value){const Je=new r(L.value).mul(Math.pow(10,i.value.decimals)).mul(l.value).toString();console.log(Je,"##amount"),ne=T(Je,0),k.value=T(new r(L.value).mul(l.value).toString(),i.value.decimals)}if(J.value){const Je=new r(L.value).mul(l.value).mul(Math.pow(10,v.value.decimals)).toString();ne=T(Je,0),h.value=T(new r(L.value).mul(l.value).toString(),v.value.decimals)}console.log(k.value,"##fromCoinAmount.value");const De=await ee.calculateRemoveSwapAmount({lowerTick:U,upperTick:Z,curSqrtPrice:new de(t.value.current_sqrt_price),fix_amount_a:x,receiveAmount:ne,coinTypeA:t.value.autoPoolPositionInfo.coin_type_a,coinTypeB:t.value.autoPoolPositionInfo.coin_type_b,clmm_pool:t.value.address,slippage:0,decimals:C.value?i.value.decimals:v.value.decimals});if(console.log(De,"###swapResult536"),De){F.value=De.is_exceed,ne=new de(De.swapOutAmount),t.value.current_sqrt_price,ie.value={swap_amount:De.swapInAmount,liquidity:De.liquidity,route_obj:De.route_obj,a2b:!x},x=!x;const Je=t.value.token_a.decimals,on=t.value.token_b.decimals,nn=new r(De.swapInAmount).div(new r(Math.pow(10,Je))).toString(),Do=new r(De.swapOutAmountLimit).div(new r(Math.pow(10,on))).toString(),lo=N.value?t.value.token_b.symbol:t.value.token_a.symbol,ao=N.value?t.value.token_a.symbol:t.value.token_b.symbol;M.value=l.value==1?`To withdraw ${R(C.value?k.value:h.value)} ${C.value?lo:ao},
          ${R(C.value?t.value.amountB:t.value.amountA)} ${C.value?ao:lo}  in the pool will be traded for ${R(Do)} ${C.value?lo:ao}`:`To withdraw ${R(C.value?k.value:h.value)} ${C.value?lo:ao},
          ${R(nn)} ${C.value?ao:lo}  in the pool will be traded for ${R(Do)} ${C.value?lo:ao}`,re=De.liquidity}else t.value.current_sqrt_price,ne=new de(ne),M.value="",V.value=!0;console.log(be,"result###"),W.value=new r(t.value.myLiquidity).mul(new r(l.value)).toString(),console.log(t.value,t.value.liquidity,re,W.value,"###positionInfo.value.liquidity"),console.log(W.value,"##lpTokenAmount.value"),m.value=new r(W.value),le.value=re}else{F.value=!1;const De=new r(ue.value).mul(Math.pow(10,i.value.decimals)).mul(l.value).toString();ne=T(De,0),k.value=T(new r(ue.value).mul(l.value).toString(),i.value.decimals);const Je=new r(X.value).mul(l.value).mul(Math.pow(10,v.value.decimals)).toString();ne=T(Je,0),h.value=T(new r(X.value).mul(l.value).toString(),v.value.decimals),t.value.current_sqrt_price,ne=new de(ne),l.value!==1?be=new r(t.value.myLiquidity).mul(Math.pow(10,t.value.lpInfo.decimals)).mul(l.value).toString():be=new r(t.value.myLiquidity).mul(Math.pow(10,t.value.lpInfo.decimals)).toString(),m.value=new r(be).div(Math.pow(10,t.value.lpInfo.decimals)),re=Io.get_share_liquidity_by_amount({liquidity:t.value.liquidity,total_supply:t.value.total_supply},be),W.value=T(be,0),le.value=T(re,0),console.log(re,"###newLiquidity525")}};$e(c,ho((l,U)=>{l!==U&&(Number(l)>100?c.value=100:l&&t.value?(console.log("687===>"),c.value=l,ge({value:c.value/100})):(k.value="",h.value=""))},300)),$e(()=>k.value,ho((l,U)=>{l?ve():(h.value="",c.value=0)},500),{immediate:!0}),$e(()=>h.value,ho((l,U)=>{l?ve():(k.value="",c.value=0)},500),{immediate:!0});const we=Po(),{setIsShowSuccess:qe,setIsShowRejected:Ie,setIsShowWaiting:ye,setTransactionDesc:Be,setTransactionTxid:Ce,setPositiomNum:Me,setTransactionDescText:Pe}=G,ze=w(!1),{t:K}=Co(),Se=async()=>{var Ge,oo;ze.value=!0,Ce("");const l=Number(k.value)>0?`${R(k.value,i.value.decimals)} ${i.value.symbol}`:"",U=Number(h.value)>0?`${R(h.value,v.value.decimals)} ${v.value.symbol}`:"";console.log(l,U,"###transactionDescTo"),Be(K("tips.removeLiquidiyText",{from:N.value?U:l,and:Number(k.value)>0&&Number(h.value)>0?"and":"",to:N.value?l:U})),ye(!0);const Z=K("modal.removeLiquidityText2");Pe(Z);const q=t.value.autoPoolPositionInfo.tick_lower_index,oe=t.value.autoPoolPositionInfo.tick_upper_index,Q=Oe.tickIndexToSqrtPriceX64(q),re=Oe.tickIndexToSqrtPriceX64(oe),be=t.value.rewarderInfo.map(Ae=>Ae.coinAddress);console.log(W.value,"##lpTokenAmount.value431");let ne;I.value?ne=new r(k.value).mul(Math.pow(10,i.value.decimals)).toString():ne=new r(h.value).mul(Math.pow(10,v.value.decimals)).toString(),console.log();const x={lowerSqrtPrice:Q,upperSqrtPrice:re,lpTokenAmount:W.value,liquidity:le.value,curSqrtPrice:new de(t.value.object.current_sqrt_price),slippage:Number(B.value)/100,id:t.value.id,clmm_pool:t.value.autoPoolPositionInfo.pool,lp_token_type:t.value.lp_token_type,coinTypeA:t.value.autoPoolPositionInfo.coin_type_a,coinTypeB:t.value.autoPoolPositionInfo.coin_type_b,rewarder_coin_types:be,swapParams:ie.value,fix_amount_a:I.value,isOnlyA:!E.value&&!Y.value?C.value:!1,isOnlyB:!Y.value&&!E.value?J.value:!1,lowerTick:q,upperTick:oe,receiveAmount:ne,sliderVal:c.value,positionInfo:t.value};try{const Ae=await ee.remove(x);console.log(Ae,"移除流动性payload");const io=await n.value.currentWallet.signAndExecuteTransactionBlock(Ae);let _e=D.value.handleTx(io);if(console.log("0331###remove###tx####",_e),_e&&_e.hash){Ce(_e.hash),ye(!1),qe(!0);const Re={title:K("common.removeLiquidity"),desc:"",hash:_e.hash,descTransactions:`Remove ${l} ${Number(k.value)>0&&Number(h.value)>0?"and":""} ${U} from the pool`,sender:n.value.address,chainName:"Sui",tit:"Liquidity Removed",icon:"icon-icon-Removed",text:`Withdraw ${k.value} ${(Ge=i.value)==null?void 0:Ge.symbol} and ${h.value} ${(oo=v.value)==null?void 0:oo.symbol}`};Re.res=_e.res,D.value.showTransitionPending(Re),await D.value.watchTransaction(Re)&&(k.value="",h.value="",m.value="",c.value=0,setTimeout(()=>{y.updatePositionItem(t.value.id),D.value.getAccount(n.value.address)},1e3),Number(c.value)==100&&_.name=="auto-pool-detail"&&we.push("/pool/auto"))}else ye(!1),Ie(!0);ze.value=!1}catch(Ae){console.log("Remove error",Ae),ze.value=!1,ye(!1),Ie(!0)}};$e(()=>t.value,(l,U)=>{l&&!Ze(l)&&(i.value=l==null?void 0:l.token_a,v.value=l==null?void 0:l.token_b,console.log("触发###"),(!U||U&&U.address!==l.address)&&(c.value=c.value>0?c.value:25,ge({value:c.value/100})))},{immediate:!0});const so=$(()=>{const l=Number(m.value)>Number(b.value);return!k.value&&!h.value||!m.value||m.value<=0||!k.value&&C.value||!h.value&&J.value?K("button.enterAmount"):l?"Invalid Amount":F.value?K("button.insufficientLiquidity"):V.value?K("button.enterAmount"):(console.log(k.value,L.value,h.value,"856##"),C.value&&Number(k.value)>Number(L.value)||J.value&&Number(h.value)>Number(L.value)?"Invalid Amount":K("button.remove"))}),eo=$(()=>{console.log(m.value.toString(),b.value,"###864");const l=Number(m.value)>Number(b.value);return!!(!k.value&&!h.value||Number(k.value)<=0&&C.value||Number(h.value)<=0&&J.value||!m.value||m.value<=0||l||F.value||se.value!=="STATUS_RUNNING"||V.value||C.value&&Number(k.value)>Number(L.value)||J.value&&Number(h.value)>Number(L.value))}),mo=l=>(l==null?void 0:l.logoURI)||(l==null?void 0:l.logo_url)||uo("/image/coins/sui-unknown.png"),go=l=>{k.value="",h.value="",p.value=!0,M.value="",l=="only-a"?(C.value=!C.value,J.value=!1,I.value=!0):(J.value=!J.value,C.value=!1,I.value=!1)},A=l=>{p.value=!0,c.value=100,l==="fromCoin"?I.value=!0:I.value=!1},O=l=>{p.value=!0,c.value=50,l==="fromCoin"?I.value=!0:I.value=!1},L=w(),ae=async()=>{I.value;const l=t.value.token_a.decimals,U=t.value.token_b.decimals,Z=C.value?X.value:ue.value;console.log(Z,"###receiveAmount");const q=C.value?v.value.address===t.value.token_a.address:i.value.address===t.value.token_a.address;if(C.value||J.value){console.log(Z,"##receiveAmount");let oe=await D.value.preSwap({pool:{address:t.value.address,coinA:t.value.token_a,coinB:t.value.token_b},a2b:q,byAmountIn:!0,amount:Z});console.log(oe,oe.estimatedAmountOut,l,U,"##preSwapRes");const Q=new r(oe.estimatedAmountOut);L.value=Q.sub(Q.mul(Number(B.value)/100)).add(new r(C.value?ue.value:X.value)).toString(),console.log("转换之后数量:",oe.estimatedAmountOut),console.log("转换之后滑点数量:",Q.mul(Number(B.value)/100).toNumber()),console.log("原有数量减滑点数量:",Q.sub(Q.mul(Number(B.value)/100)).toNumber()),console.log("fromCoin原有数量:",ue.value),console.log(L.value,"###onlyTokenBalance.value"),ge({value:c.value/100})}};$e(()=>[C.value,J.value,ue.value,X.value],([l,U])=>{l||U?ae():ge({value:c.value/100})},{immediate:!0});const Te=l=>`${l}%`,se=$(()=>s.value.currentAutoPoolStatus),ke=w(),me=()=>{ke.value=window.setInterval(()=>{(k.value||h.value)&&!p.value?ve():ge({value:c.value/100})},2e4)};return co(()=>{me()}),po(()=>{window.clearInterval(ke.value)}),{removeLiquidityBtnText:so,removeLiquidityBtnDisabled:eo,wallet:n,ratioArr:u,positionInfo:t,isShowRemoveModal:g,needReverse:N,fromCoin:i,toCoin:v,lpAmount:m,lpBalance:b,sliderVal:c,sFixD:T,isSlider:p,fromCoinAmount:k,toCoinAmount:h,setPercent:ge,toRemove:Se,addCommom:R,getCoinIcon:mo,isOnlyA:C,isOnlyB:J,onlyToken:go,fixedFromCoin:I,maxBtnSelect:A,halfBtnSelect:O,fromCoinBlance:ue,toCoinBlance:X,showFromCoinLock:E,showToCoinLock:Y,removeText:M,onlyTokenBalance:L,totalWithdraw:Ne,formatter:Te,currentAutoPoolStatus:se}}});const vo=e=>(Ee("data-v-c45d66f9"),e=e(),We(),e),Li={class:"auto-pool-add"},Ui={class:"auto-pool-add-content"},Vi={class:"liquidity-action-tab"},ji=vo(()=>o("div",{class:"remove tab-active"},"Remove",-1)),Ei={key:0,class:"only-token"},Wi=vo(()=>o("div",null,"Deposit Amounts",-1)),Xi={key:0},Gi={key:0},Hi={key:0,class:"card-item"},Yi={key:1,class:"card-item"},zi={class:"remove-ratio"},Ji={class:"remove-ratio-select"},Ki={key:0,class:"ratio"},Zi={key:1,class:"ratio"},Qi={class:"ratio-list"},xi=["onClick"],el=vo(()=>o("span",null,"Pool Closed",-1)),ol={key:4,class:"remove-info"},nl={key:0,class:"remove-text total-amount"},tl={class:"total-amount"},sl=vo(()=>o("span",null,"Total Withdraw",-1)),il={class:"total-amount"},ll=vo(()=>o("span",null,"LP Burn Amount",-1)),al={key:0},ul={key:1};function rl(e,n,G,H,B,S){var N,i,v,g,m,b,p,D,F,V,ee,k,h,W,E,Y,ie;const u=Wo,c=Xo,_=Lo,y=to("AutoPoolV2PoolStatus"),s=Ao,t=Ho;return a(),f("div",Li,[o("div",Ui,[o("div",Vi,[o("div",{class:"increase",onClick:n[0]||(n[0]=Uo(I=>e.$emit("changeCurrentTab"),["stop"]))},"Add"),ji]),!e.showFromCoinLock&&!e.showToCoinLock?(a(),f("div",Ei,[Wi,o("div",null,[o("div",{class:"only-a",onClick:n[1]||(n[1]=I=>e.onlyToken("only-a"))},[o("p",null,[e.isOnlyA?(a(),f("span",Xi)):j("",!0)]),o("span",null,d(e.needReverse?(g=(v=e.positionInfo)==null?void 0:v.token_b)==null?void 0:g.symbol:(i=(N=e.positionInfo)==null?void 0:N.token_a)==null?void 0:i.symbol)+" only",1)]),o("div",{class:"only-b",onClick:n[2]||(n[2]=I=>e.onlyToken("only-b"))},[o("p",null,[e.isOnlyB?(a(),f("span",Gi)):j("",!0)]),o("span",null,d(e.needReverse?(D=(p=e.positionInfo)==null?void 0:p.token_a)==null?void 0:D.symbol:(b=(m=e.positionInfo)==null?void 0:m.token_b)==null?void 0:b.symbol)+" only",1)])])])):j("",!0),o("div",{class:Fe(e.needReverse?"card-container reverse":"card-container")},[(e.needReverse?!e.isOnlyA:!e.isOnlyB)?(a(),f("div",Hi,[z(u,{modelValue:e.fromCoinAmount,"onUpdate:modelValue":n[3]||(n[3]=I=>e.fromCoinAmount=I),"input-value":e.fromCoinAmount,"coin-symbol":e.fromCoin?e.fromCoin.symbol:null,"coin-name":e.fromCoin?e.fromCoin.name:null,balance:e.isOnlyA?e.onlyTokenBalance:e.fromCoinBlance,"coin-icon":e.fromCoin?e.fromCoin.logoURI:"",address:e.fromCoin?e.fromCoin.address:"","swap-direct":"From","import-page":"deposit","amount-leabl":"Available","has-arrow":!1,onOnMax:n[4]||(n[4]=I=>e.maxBtnSelect("fromCoin")),onOnHalf:n[5]||(n[5]=I=>e.halfBtnSelect("fromCoin")),onOnInput:n[6]||(n[6]=I=>{e.isSlider=!1,e.fromCoinAmount=I}),onOnFocus:n[7]||(n[7]=()=>{e.isSlider=!1,e.fixedFromCoin=!0})},null,8,["modelValue","input-value","coin-symbol","coin-name","balance","coin-icon","address"]),e.showFromCoinLock?(a(),te(c,{key:0})):j("",!0)])):j("",!0),(e.needReverse?!e.isOnlyB:!e.isOnlyA)?(a(),f("div",Yi,[z(u,{modelValue:e.toCoinAmount,"onUpdate:modelValue":n[8]||(n[8]=I=>e.toCoinAmount=I),"input-value":e.toCoinAmount,"coin-symbol":e.toCoin?e.toCoin.symbol:null,"coin-name":e.toCoin?e.toCoin.name:null,balance:e.isOnlyB?e.onlyTokenBalance:e.toCoinBlance,"swap-direct":"To","coin-icon":e.toCoin?e.toCoin.logoURI:"",address:e.toCoin?e.toCoin.address:"","import-page":"deposit","amount-leabl":"Available","has-arrow":!1,onOnMax:n[9]||(n[9]=I=>e.maxBtnSelect("toCoin")),onOnHalf:n[10]||(n[10]=I=>e.halfBtnSelect("toCoin")),onOnInput:n[11]||(n[11]=I=>{e.isSlider=!1,e.toCoinAmount=I}),onOnFocus:n[12]||(n[12]=()=>{e.isSlider=!1,e.fixedFromCoin=!1})},null,8,["modelValue","input-value","coin-symbol","coin-name","balance","coin-icon","address"]),e.showToCoinLock?(a(),te(c,{key:0})):j("",!0)])):j("",!0)],2),o("div",zi,[o("div",Ji,[Number(e.lpBalance)>=Number(e.lpAmount)?(a(),f("div",Ki,d(e.sliderVal>0&&Number(("sFixD"in e?e.sFixD:P(T))(e.sliderVal,2))<.01?"<0.01":("sFixD"in e?e.sFixD:P(T))(e.sliderVal,2))+"% ",1)):(a(),f("div",Zi,"--")),o("div",Qi,[(a(!0),f(no,null,Oo(e.ratioArr,(I,M)=>(a(),f("div",{key:M,class:Fe(["ratio-item",e.sliderVal==I.value?"ratio-item-active":""]),onClick:()=>{e.isSlider=!0,e.sliderVal=I.value}},d(I.name),11,xi))),128))])]),z(_,{value:e.sliderVal,"onUpdate:value":n[13]||(n[13]=I=>e.sliderVal=I),"tip-formatter":e.formatter,onChange:n[14]||(n[14]=I=>e.isSlider=!0)},null,8,["value","tip-formatter"])])]),e.currentAutoPoolStatus=="STATUS_REBALANCING"?(a(),te(y,{key:0})):j("",!0),(F=e.positionInfo)!=null&&F.is_pause?(a(),te(s,{key:1,class:"big-btn liquidity-btn",disabled:!0},{default:he(()=>[el]),_:1})):e.wallet.connected?(a(),te(s,{key:2,class:"big-btn liquidity-btn",disabled:e.removeLiquidityBtnDisabled,onClick:n[15]||(n[15]=I=>e.toRemove())},{default:he(()=>[o("span",null,d(e.removeLiquidityBtnText),1)]),_:1},8,["disabled"])):(a(),te(s,{key:3,class:"big-btn liquidity-btn",onClick:n[16]||(n[16]=I=>e.wallet.setIsShowWalletModal(!0))},{default:he(()=>[o("span",null,d(e.$t("button.connectWallet")),1)]),_:1})),e.removeLiquidityBtnDisabled?j("",!0):(a(),f("div",ol,[e.removeText&&(e.isOnlyA&&Number(e.fromCoinAmount)>0||e.isOnlyB&&Number(e.toCoinAmount)>0)?(a(),f("div",nl,d(e.removeText),1)):j("",!0),o("div",tl,[sl,o("span",null,d(e.totalWithdraw),1)]),o("div",il,[ll,e.fromCoinAmount||e.toCoinAmount?(a(),f("span",al,d(("addCommom"in e?e.addCommom:P(R))(e.lpAmount))+" "+d(e.needReverse?(V=e.toCoin)==null?void 0:V.symbol:(ee=e.fromCoin)==null?void 0:ee.symbol)+"-"+d(e.needReverse?(k=e.fromCoin)==null?void 0:k.symbol:(h=e.toCoin)==null?void 0:h.symbol),1)):(a(),f("span",ul,"0 "+d(e.needReverse?(W=e.toCoin)==null?void 0:W.symbol:(E=e.fromCoin)==null?void 0:E.symbol)+"-"+d(e.needReverse?(Y=e.fromCoin)==null?void 0:Y.symbol:(ie=e.toCoin)==null?void 0:ie.symbol),1))])])),e.isShowRemoveModal?(a(),te(t,{key:5,"pool-info":e.positionInfo,"from-coin":e.positionInfo.token_a,"to-coin":e.positionInfo.token_b,onOnClose:n[17]||(n[17]=I=>e.isShowRemoveModal=!1)},null,8,["pool-info","from-coin","to-coin"])):j("",!0)])}const dl=Ue(Oi,[["render",rl],["__scopeId","data-v-c45d66f9"]]),vl=je({components:{AutoPoolV2Info:zo,AutoPoolV2PositionRange:Jo,AutoPoolV2PoolComposition:Zo,AutoPoolV2PoolLiquidity:Qo,AutoPoolV2PoolAdd:Mi,AutoPoolV2PoolRemove:dl},setup(){const e=He();xe();const n=yo(),G=$(()=>n),H=()=>{e.getAutoPoolAPY(),e.getVault(S.params.id)},B=w(),S=Qe();$e(()=>S.query.action,_=>{_&&(B.value=_)},{immediate:!0});const u=w(),c=()=>{u.value=window.setInterval(()=>{e.getVault(S.params.id)},6e4)};return co(()=>{console.log(S,"route##"),c()}),po(()=>{window.clearInterval(u.value)}),$(()=>G.value.chainName),Po(),{clickRefresh:H,currentTab:B}}});const ml={class:"auto-pool-detail-v2"},cl={class:"detail-top"},pl={class:"detail-bottom pc-detail"},fl={class:"detail-bottom-left"},yl={class:"detail-bottom-right"},bl={class:"h5-detail"};function gl(e,n,G,H,B,S){const u=Dn,c=zo,_=Jo,y=Zo,s=Qo,t=to("AutoPoolV2PoolAdd"),N=to("AutoPoolV2PoolRemove");return a(),f("div",ml,[o("div",cl,[z(u,{onClickRefresh:e.clickRefresh},null,8,["onClickRefresh"]),z(c)]),o("div",pl,[o("div",fl,[z(_),z(y),z(s)]),o("div",yl,[e.currentTab=="add"?(a(),te(t,{key:0,onChangeCurrentTab:n[0]||(n[0]=i=>e.currentTab="remove")})):(a(),te(N,{key:1,onChangeCurrentTab:n[1]||(n[1]=i=>e.currentTab="add")}))])]),o("div",bl,[e.currentTab=="add"?(a(),te(t,{key:0,onChangeCurrentTab:n[2]||(n[2]=i=>e.currentTab="remove")})):(a(),te(N,{key:1,onChangeCurrentTab:n[3]||(n[3]=i=>e.currentTab="add")})),z(_),z(y),z(s)])])}const Xl=Ue(vl,[["render",gl],["__scopeId","data-v-963ccb88"]]);export{Xl as default};
